//>>built
(function(h,l){var a,d=function(){},b=function(a){for(var c in a)return 0;return 1},f={}.toString,k=function(a){return"[object Function]"==f.call(a)},m=function(a){return"[object String]"==f.call(a)},g=function(a){return"[object Array]"==f.call(a)},e=function(a,c){if(a)for(var e=0;e<a.length;)c(a[e++])},c=function(a,c){for(var e in c)a[e]=c[e];return a},n=function(a,e){return c(Error(a),{src:"dojoLoader",info:e})},q=1,r=function(){return"_"+q++},u=function(a,c,e){return ua(a,c,e,0,u)},v=this,t=v.document,
w=t&&t.createElement("DiV"),x=u.has=function(a){return k(y[a])?y[a]=y[a](v,t,w):y[a]},y=x.cache=l.hasCache;x.add=function(a,c,e,n){(void 0===y[a]||n)&&(y[a]=c);return e&&x(a)};x.add("host-webworker","undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope);x("host-webworker")&&(c(l.hasCache,{"host-browser":0,dom:0,"dojo-dom-ready-api":0,"dojo-sniff":0,"dojo-inject-api":1,"host-webworker":1,"dojo-guarantee-console":0}),l.loaderPatch={injectUrl:function(a,c){try{importScripts(a),c()}catch(e){console.error(e)}}});
for(var z in h.has)x.add(z,h.has[z],0,1);u.async=1;var A=x("csp-restrictions")?function(){}:new Function("return eval(arguments[0]);");u.eval=function(a,c){return A(a+"\r\n//# sourceURL\x3d"+c)};var B={},C=u.signal=function(a,c){var n=B[a];e(n&&n.slice(0),function(a){a.apply(null,g(c)?c:[c])})},D=u.on=function(a,c){var e=B[a]||(B[a]=[]);e.push(c);return{remove:function(){for(var a=0;a<e.length;a++)if(e[a]===c){e.splice(a,1);break}}}},E=[],F={},H=[],G={},K=u.map={},J=[],I={},L="",M={},N={};z={};var Q=
0,O=function(a){var c,e,n,b;for(c in N)e=N[c],(n=c.match(/^url\:(.+)/))?M["url:"+Pa(n[1],a)]=e:"*now"==c?b=e:"*noref"!=c&&(n=Ga(c,a,!0),M[n.mid]=M["url:"+n.url]=e);b&&b(qa(a));N={}},T=function(a){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(a){return"\\"+a})},S=function(a,c){c.splice(0,c.length);for(var e in a)c.push([e,a[e],new RegExp("^"+T(e)+"(/|$)"),e.length]);c.sort(function(a,c){return c[3]-a[3]});return c},R=function(a,c){e(a,function(a){c.push([m(a[0])?new RegExp("^"+T(a[0])+"$"):
a[0],a[1]])})},U=function(a){var e=a.name;e||(e=a,a={name:e});a=c({main:"main"},a);a.location=a.location?a.location:e;a.packageMap&&(K[e]=a.packageMap);a.main.indexOf("./")||(a.main=a.main.substring(2));G[e]=a},W=[],fa=function(a,n,b){for(var g in a){"waitSeconds"==g&&(u.waitms=1E3*(a[g]||0));"cacheBust"==g&&(L=a[g]?m(a[g])?a[g]:(new Date).getTime()+"":"");if("baseUrl"==g||"combo"==g)u[g]=a[g];a[g]!==y&&(u.rawConfig[g]=a[g],"has"!=g&&x.add("config-"+g,a[g],0,n))}u.baseUrl||(u.baseUrl="./");/\/$/.test(u.baseUrl)||
(u.baseUrl+="/");for(g in a.has)x.add(g,a.has[g],0,n);e(a.packages,U);for(var d in a.packagePaths)e(a.packagePaths[d],function(a){var c=d+"/"+a;m(a)&&(a={name:a});a.location=c;U(a)});S(c(K,a.map),J);e(J,function(a){a[1]=S(a[1],[]);"*"==a[0]&&(J.star=a)});S(c(F,a.paths),H);R(a.aliases,E);if(n)W.push({config:a.config});else for(g in a.config)n=Ka(g,b),n.config=c(n.config||{},a.config[g]);a.cache&&(O(),N=a.cache,a.cache["*noref"]&&O());C("config",[a,u.rawConfig])};x("dojo-cdn");var ea=t.getElementsByTagName("script");
a=0;for(var oa,pa,Aa,ta;a<ea.length;)if(oa=ea[a++],(Aa=oa.getAttribute("src"))&&(ta=Aa.match(/(((.*)\/)|^)dojo\.js(\W|$)/i))&&(pa=ta[3]||"",l.baseUrl=l.baseUrl||pa,Q=oa),Aa=oa.getAttribute("data-dojo-config")||oa.getAttribute("djConfig"))z=u.eval("({ "+Aa+" })","data-dojo-config"),Q=oa;u.rawConfig={};fa(l,1);x("dojo-cdn")&&((G.dojo.location=pa)&&(pa+="/"),G.dijit.location=pa+"../dijit/",G.dojox.location=pa+"../dojox/");fa(h,1);fa(z,1);var va=function(a){ma(function(){e(a.deps,rb)})},ua=function(a,
e,b,f,k){var t;if(m(a)){if((t=Ka(a,f,!0))&&t.executed)return t.result;throw n("undefinedModule",a);}g(a)||(fa(a,0,f),a=e,e=b);if(g(a))if(a.length){b="require*"+r();for(var q,v=[],w=0;w<a.length;)q=a[w++],v.push(Ka(q,f));t=c(wa("",b,0,""),{injected:2,deps:v,def:e||d,require:f?f.require:u,gc:1});I[t.mid]=t;va(t);var h=X&&0!="sync";ma(function(){xa(t,h)});t.executed||ca.push(t);P()}else e&&e();return k},qa=function(a){if(!a)return u;var e=a.require;e||(e=function(c,n,b){return ua(c,n,b,a,e)},a.require=
c(e,u),e.module=a,e.toUrl=function(c){return Pa(c,a)},e.toAbsMid=function(c){return Wa(c,a)});return e},ca=[],ja=[],la={},ka=function(a){a.injected=1;la[a.mid]=1;a.url&&(la[a.url]=a.pack||1);Jb()},sa=function(a){a.injected=2;delete la[a.mid];a.url&&delete la[a.url];b(la)&&xb()},Ea=u.idle=function(){return!ja.length&&b(la)&&!ca.length&&!X},ra=function(a,c){if(c)for(var e=0;e<c.length;e++)if(c[e][2].test(a))return c[e];return 0},za=function(a){var c=[],e,n;for(a=a.replace(/\\/g,"/").split("/");a.length;)e=
a.shift(),".."==e&&c.length&&".."!=n?(c.pop(),n=c[c.length-1]):"."!=e&&c.push(n=e);return c.join("/")},wa=function(a,c,e,n){return{pid:a,mid:c,pack:e,url:n,executed:0,def:0}},Ha=function(a,c,b,g,d,f,t,q,u){var m,r,v,w;w=/^\./.test(a);if(/(^\/)|(\:)|(\.js$)/.test(a)||w&&!c)return wa(0,a,0,a);a=za(w?c.mid+"/../"+a:a);if(/^\./.test(a))throw n("irrationalPath",a);c&&(v=ra(c.mid,f));(v=(v=v||f.star)&&ra(a,v[1]))&&(a=v[1]+a.substring(v[3]));c=(ta=a.match(/^([^\/]+)(\/(.+))?$/))?ta[1]:"";(m=b[c])?a=c+"/"+
(r=ta[3]||m.main):c="";var h=0;e(q,function(c){var e=a.match(c[0]);e&&0<e.length&&(h=k(c[1])?a.replace(c[0],c[1]):c[1])});if(h)return Ha(h,0,b,g,d,f,t,q,u);if(b=g[a])return u?wa(b.pid,b.mid,b.pack,b.url):g[a];g=(v=ra(a,t))?v[1]+a.substring(v[3]):c?m.location+"/"+r:a;/(^\/)|(\:)/.test(g)||(g=d+g);return wa(c,a,m,za(g+".js"))},Ga=function(a,c,e){return Ha(a,c,G,I,u.baseUrl,e?[]:J,e?[]:H,e?[]:E)},Ca=function(a,c,e){return a.normalize?a.normalize(c,function(a){return Wa(a,e)}):Wa(c,e)},Sa=0,Ka=function(a,
c,e){var n,b;(n=a.match(/^(.+?)\!(.*)$/))?(b=Ka(n[1],c,e),5!==b.executed||b.load||aa(b),b.load?(n=Ca(b,n[2],c),a=b.mid+"!"+(b.dynamic?++Sa+"!":"")+n):(n=n[2],a=b.mid+"!"+ ++Sa+"!waitingForPlugin"),a={plugin:b,mid:a,req:qa(c),prid:n}):a=Ga(a,c);return I[a.mid]||!e&&(I[a.mid]=a)},Wa=u.toAbsMid=function(a,c){return Ga(a,c).mid},Pa=u.toUrl=function(a,c){var e=Ga(a+"/x",c),n=e.url;return ha(0===e.pid?a:n.substring(0,n.length-5))},La={injected:2,executed:5,def:3,result:3};pa=function(a){return I[a]=c({mid:a},
La)};var Ta=pa("require"),Na=pa("exports"),Y=pa("module"),Ia={},Ya=0,aa=function(a){var c=a.result;a.dynamic=c.dynamic;a.normalize=c.normalize;a.load=c.load;return a},Ua=function(a){var n={};e(a.loadQ,function(e){var b=Ca(a,e.prid,e.req.module),g=a.dynamic?e.mid.replace(/waitingForPlugin$/,b):a.mid+"!"+b,b=c(c({},e),{mid:g,prid:b,injected:0});I[g]&&I[g].injected||ga(I[g]=b);n[e.mid]=I[g];sa(e);delete I[e.mid]});a.loadQ=0;var b=function(a){for(var c=a.deps||[],e=0;e<c.length;e++)(a=n[c[e].mid])&&(c[e]=
a)},g;for(g in I)b(I[g]);e(ca,b)},Ma=function(c){u.trace("loader-finish-exec",[c.mid]);c.executed=5;c.defOrder=Ya++;c.loadQ&&(aa(c),Ua(c));for(a=0;a<ca.length;)ca[a]===c?ca.splice(a,1):a++;/^require\*/.test(c.mid)&&delete I[c.mid]},ia=[],xa=function(a,c){if(4===a.executed)return u.trace("loader-circular-dependency",[ia.concat(a.mid).join("-\x3e")]),!a.def||c?Ia:a.cjs&&a.cjs.exports;if(!a.executed){if(!a.def)return Ia;var e=a.mid,n=a.deps||[],b,g=[],d=0;for(a.executed=4;b=n[d++];){b=b===Ta?qa(a):b===
Na?a.cjs.exports:b===Y?a.cjs:xa(b,c);if(b===Ia)return a.executed=0,u.trace("loader-exec-module",["abort",e]),Ia;g.push(b)}u.trace("loader-run-factory",[a.mid]);e=a.def;g=k(e)?e.apply(null,g):e;a.result=void 0===g&&a.cjs?a.cjs.exports:g;Ma(a)}return a.result},X=0,ma=function(a){try{X++,a()}catch(c){throw c;}finally{X--}Ea()&&C("idle",[])},P=function(){X||ma(function(){for(var a,c,e=0;e<ca.length;)a=Ya,c=ca[e],xa(c),a!=Ya?e=0:e++})};void 0===x("dojo-loader-eval-hint-url")&&x.add("dojo-loader-eval-hint-url",
1);var ha="function"==typeof h.fixupUrl?h.fixupUrl:function(a){a+="";return a+(L?(/\?/.test(a)?"\x26":"?")+L:"")},ga=function(a){var c=a.plugin;5!==c.executed||c.load||aa(c);var e=function(c){a.result=c;sa(a);Ma(a);P()};c.load?c.load(a.prid,a.req,e):c.loadQ?c.loadQ.push(a):(c.loadQ=[a],ca.unshift(c),rb(c))},na=0,ba=0,da=0,V=function(a,c){x("config-stripStrict")&&(a=a.replace(/(["'])use strict\1/g,""));da=1;a===na?na.call(null):u.eval(a,x("dojo-loader-eval-hint-url")?c.url:c.mid);da=0},rb=function(a){var e=
a.mid,b=a.url;if(!(a.executed||a.injected||la[e]||a.url&&(a.pack&&la[a.url]===a.pack||1==la[a.url])))if(ka(a),a.plugin)ga(a);else{var g=function(){gb(a);if(2!==a.injected){if(x("dojo-enforceDefine")){C("error",n("noDefine",a));return}sa(a);c(a,La);u.trace("loader-define-nonmodule",[a.url])}P()};(na=M[e]||M["url:"+a.url])?(u.trace("loader-inject",["cache",a.mid,b]),V(na,a),g()):(u.trace("loader-inject",["script",a.mid,b]),ba=a,u.injectUrl(ha(b),g,a),ba=0)}},hb=function(a,e,b){u.trace("loader-define-module",
[a.mid,e]);if(2===a.injected)return C("error",n("multipleDefine",a)),a;c(a,{deps:e,def:b,cjs:{id:a.mid,uri:a.url,exports:a.result={},setExports:function(c){a.cjs.exports=c},config:function(){return a.config}}});for(var g=0;e[g];g++)e[g]=Ka(e[g],a);sa(a);k(b)||e.length||(a.result=b,Ma(a));return a},gb=function(a,c){for(var n=[],b,g;ja.length;)g=ja.shift(),c&&(g[0]=c.shift()),b=g[0]&&Ka(g[0])||a,n.push([b,g[1],g[2]]);O(a);e(n,function(a){va(hb.apply(null,a))})},xb=d,Jb=d;x.add("ie-event-behavior",t.attachEvent&&
"undefined"===typeof Windows&&("undefined"===typeof opera||"[object Opera]"!=opera.toString()));var ib=function(a,c,e,n){if(x("ie-event-behavior"))return a.attachEvent(e,n),function(){a.detachEvent(e,n)};a.addEventListener(c,n,!1);return function(){a.removeEventListener(c,n,!1)}},jb=ib(window,"load","onload",function(){u.pageLoaded=1;try{"complete"!=t.readyState&&(t.readyState="complete")}catch(a){}jb()}),ea=t.getElementsByTagName("script");for(a=0;!Q;)/^dojo/.test((oa=ea[a++])&&oa.type)||(Q=oa);
u.injectUrl=function(a,c,e){e=e.node=t.createElement("script");var b=ib(e,"load","onreadystatechange",function(a){a=a||window.event;var e=a.target||a.srcElement;if("load"===a.type||/complete|loaded/.test(e.readyState))b(),g(),c&&c()}),g=ib(e,"error","onerror",function(c){b();g();C("error",n("scriptError",[a,c]))});e.type="text/javascript";e.charset="utf-8";e.src=a;Q.parentNode.insertBefore(e,Q);return e};u.log=d;u.trace=d;oa=function(a,c,e){var b=arguments.length,g=["require","exports","module"],
d=[0,a,c];1==b?d=[0,k(a)?g:[],a]:2==b&&m(a)?d=[a,k(c)?g:[],c]:3==b&&(d=[a,c,e]);u.trace("loader-define",d.slice(0,2));if((b=d[0]&&Ka(d[0]))&&!la[b.mid])va(hb(b,d[1],d[2]));else if(!x("ie-event-behavior")||da)ja.push(d);else{b=b||ba;if(!b)for(a in la)if((g=I[a])&&g.node&&"interactive"===g.node.readyState){b=g;break}b?(O(b),va(hb(b,d[1],d[2]))):C("error",n("ieDefineFailed",d[0]));P()}};oa.amd={vendor:"dojotoolkit.org"};c(c(u,l.loaderPatch),h.loaderPatch);D("error",function(a){try{if(console.error(a),
a instanceof Error)for(var c in a);}catch(e){}});c(u,{uid:r,cache:M,packs:G});v.define||(v.define=oa,v.require=u,e(W,function(a){fa(a)}),D=z.deps||h.deps||l.deps,z=z.callback||h.callback||l.callback,u.boot=D||z?[D||[],z]:0)})(this.dojoConfig||this.djConfig||this.require||{},{async:0,deps:["app/app"],hasCache:{"config-selectorEngine":"lite","config-tlmSiblingOfDojo":1,"dojo-built":1,"dojo-has-api":1,"dojo-loader":1,"dojo-undef-api":0,dom:1,"extend-esri":0,"host-browser":1},packages:[{location:"../app",
name:"app"},{location:"../cmv",name:"cmv"},{location:"../dijit",name:"dijit"},{location:".",name:"dojo"},{location:"../dojox",name:"dojox"},{location:"../dstore",main:"Store",name:"dstore"},{location:"../dgrid",main:"OnDemandGrid",name:"dgrid"},{location:"../dgrid1",main:"OnDemandGrid",name:"dgrid1"},{location:"../xstyle",name:"xstyle"},{location:"../put-selector",main:"put",name:"put-selector"},{location:"../flag-icon-css",name:"flag-icon-css"},{location:"../esri",name:"esri"},{location:"../moment",
main:"moment",name:"moment"}],parseOnLoad:!0});
require({cache:{"app/app":function(){define("dojo/_base/declare viewer/_ControllerBase ./_ConfigMixin viewer/_LayoutMixin viewer/_MapMixin viewer/_WidgetsMixin xstyle/css!./css/main.css".split(" "),function(h,l,a,d,b,f){return h([a,d,b,f,l])})},"dojo/_base/declare":function(){define(["./kernel","../has","./lang"],function(h,l,a){function d(a,c){throw Error("declare"+(c?" "+c:"")+": "+a);}function b(a,c){for(var e=[],n=[{cls:0,refs:[]}],b={},g=1,f=a.length,k=0,t,q,u,m,r;k<f;++k){(t=a[k])?"[object Function]"!=
A.call(t)&&d("mixin #"+k+" is not a callable constructor.",c):d("mixin #"+k+" is unknown. Did you use dojo.require to pull it in?",c);q=t._meta?t._meta.bases:[t];u=0;for(t=q.length-1;0<=t;--t)m=q[t].prototype,m.hasOwnProperty("declaredClass")||(m.declaredClass="uniqName_"+C++),m=m.declaredClass,b.hasOwnProperty(m)||(b[m]={count:0,refs:[],cls:q[t]},++g),m=b[m],u&&u!==m&&(m.refs.push(u),++u.count),u=m;++u.count;n[0].refs.push(u)}for(;n.length;){u=n.pop();e.push(u.cls);for(--g;r=u.refs,1==r.length;){u=
r[0];if(!u||--u.count){u=0;break}e.push(u.cls);--g}if(u)for(k=0,f=r.length;k<f;++k)u=r[k],--u.count||n.push(u)}g&&d("can't build consistent linearization",c);t=a[0];e[0]=t?t._meta&&t===e[e.length-t._meta.bases.length]?t._meta.bases.length:1:0;return e}function f(a,c,e){var n,b,g,f,t,k,q,u=this._inherited=this._inherited||{};"string"==typeof a&&(n=a,a=c,c=e);e=0;f=a.callee;(n=n||f.nom)||d("can't deduce a name to call inherited()",this.declaredClass);t=this.constructor._meta;g=t.bases;q=u.p;if("constructor"!=
n){if(u.c!==f&&(q=0,k=g[0],t=k._meta,t.hidden[n]!==f)){(b=t.chains)&&"string"==typeof b[n]&&d("calling chained method with inherited: "+n,this.declaredClass);do if(t=k._meta,b=k.prototype,t&&(b[n]===f&&b.hasOwnProperty(n)||t.hidden[n]===f))break;while(k=g[++q]);q=k?q:-1}if(k=g[++q])if(b=k.prototype,k._meta&&b.hasOwnProperty(n))e=b[n];else{f=z[n];do if(b=k.prototype,(e=b[n])&&(k._meta?b.hasOwnProperty(n):e!==f))break;while(k=g[++q])}e=k&&e||z[n]}else{if(u.c!==f&&(q=0,(t=g[0]._meta)&&t.ctor!==f)){for((b=
t.chains)&&"manual"===b.constructor||d("calling chained constructor with inherited",this.declaredClass);(k=g[++q])&&(!(t=k._meta)||t.ctor!==f););q=k?q:-1}for(;(k=g[++q])&&!(e=(t=k._meta)?t.ctor:k););e=k&&e}u.c=e;u.p=q;if(e)return!0===c?e:e.apply(this,c||a)}function k(a,c){return"string"==typeof a?this.__inherited(a,c,!0):this.__inherited(a,!0)}function m(a,c,e){var n=this.getInherited(a,c);if(n)return n.apply(this,e||c||a)}function g(a){for(var c=this.constructor._meta.bases,e=0,n=c.length;e<n;++e)if(c[e]===
a)return!0;return this instanceof a}function e(c,e){for(var n in e)"constructor"!=n&&e.hasOwnProperty(n)&&(c[n]=e[n]);if(l("bug-for-in-skips-shadowed"))for(var b=a._extraNames,g=b.length;g;)n=b[--g],"constructor"!=n&&e.hasOwnProperty(n)&&(c[n]=e[n])}function c(a){x.safeMixin(this.prototype,a);return this}function n(a,c){a instanceof Array||"function"==typeof a||(c=a,a=void 0);c=c||{};a=a||[];return x([this].concat(a),c)}function q(a,c){return function(){var e=arguments,n=e,b=e[0],g,d;d=a.length;var f;
if(!(this instanceof e.callee))return w(e);if(c&&(b&&b.preamble||this.preamble))for(f=Array(a.length),f[0]=e,g=0;;){(b=e[0])&&(b=b.preamble)&&(e=b.apply(this,e)||e);b=a[g].prototype;(b=b.hasOwnProperty("preamble")&&b.preamble)&&(e=b.apply(this,e)||e);if(++g==d)break;f[g]=e}for(g=d-1;0<=g;--g)b=a[g],(b=(d=b._meta)?d.ctor:b)&&b.apply(this,f?f[g]:e);(b=this.postscript)&&b.apply(this,n)}}function r(a,c){return function(){var e=arguments,n=e,b=e[0];if(!(this instanceof e.callee))return w(e);c&&(b&&(b=
b.preamble)&&(n=b.apply(this,n)||n),(b=this.preamble)&&b.apply(this,n));a&&a.apply(this,e);(b=this.postscript)&&b.apply(this,e)}}function u(a){return function(){var c=arguments,e=0,n,b;if(!(this instanceof c.callee))return w(c);for(;n=a[e];++e)if(n=(b=n._meta)?b.ctor:n){n.apply(this,c);break}(n=this.postscript)&&n.apply(this,c)}}function v(a,c,e){return function(){var n,b,g=0,d=1;e&&(g=c.length-1,d=-1);for(;n=c[g];g+=d)b=n._meta,(n=(b?b.hidden:n.prototype)[a])&&n.apply(this,arguments)}}function t(a){B.prototype=
a.prototype;a=new B;B.prototype=null;return a}function w(a){var c=a.callee,e=t(c);c.apply(e,a);return e}function x(m,w,h){"string"!=typeof m&&(h=w,w=m,m="");h=h||{};var C,B,J,I,L,M,N,Q=1,O=w;"[object Array]"==A.call(w)?(M=b(w,m),J=M[0],Q=M.length-J,w=M[Q]):(M=[0],w?"[object Function]"==A.call(w)?(J=w._meta,M=M.concat(J?J.bases:w)):d("base class is not a callable constructor.",m):null!==w&&d("unknown base class. Did you use dojo.require to pull it in?",m));if(w)for(B=Q-1;;--B){C=t(w);if(!B)break;J=
M[B];(J._meta?e:y)(C,J.prototype);I=l("csp-restrictions")?function(){}:new Function;I.superclass=w;I.prototype=C;w=C.constructor=I}else C={};x.safeMixin(C,h);J=h.constructor;J!==z.constructor&&(J.nom="constructor",C.constructor=J);for(B=Q-1;B;--B)(J=M[B]._meta)&&J.chains&&(N=y(N||{},J.chains));C["-chains-"]&&(N=y(N||{},C["-chains-"]));J=!N||!N.hasOwnProperty("constructor");M[0]=I=N&&"manual"===N.constructor?u(M):1==M.length?r(h.constructor,J):q(M,J);I._meta={bases:M,hidden:h,chains:N,parents:O,ctor:h.constructor};
I.superclass=w&&w.prototype;I.extend=c;I.createSubclass=n;I.prototype=C;C.constructor=I;C.getInherited=k;C.isInstanceOf=g;C.inherited=D;C.__inherited=f;m&&(C.declaredClass=m,a.setObject(m,I));if(N)for(L in N)C[L]&&"string"==typeof N[L]&&"constructor"!=L&&(J=C[L]=v(L,M,"after"===N[L]),J.nom=L);return I}var y=a.mixin,z=Object.prototype,A=z.toString,B,C=0;B=l("csp-restrictions")?function(){}:new Function;var D=h.config.isDebug?m:f;h.safeMixin=x.safeMixin=function(c,e){var n,b;for(n in e)b=e[n],b===z[n]&&
n in z||"constructor"==n||("[object Function]"==A.call(b)&&(b.nom=n),c[n]=b);if(l("bug-for-in-skips-shadowed")&&e)for(var g=a._extraNames,d=g.length;d;)n=g[--d],b=e[n],b===z[n]&&n in z||"constructor"==n||("[object Function]"==A.call(b)&&(b.nom=n),c[n]=b);return c};return h.declare=x})},"dojo/_base/kernel":function(){define(["../has","./config","require","module"],function(h,l,a,d){var b,f=function(){return this}(),k={},m={},g={config:l,global:f,dijit:k,dojox:m},k={dojo:["dojo",g],dijit:["dijit",k],
dojox:["dojox",m]};d=a.map&&a.map[d.id.match(/[^\/]+/)[0]];for(b in d)k[b]?k[b][0]=d[b]:k[b]=[d[b],{}];for(b in k)d=k[b],d[1]._scopeName=d[0],l.noGlobals||(f[d[0]]=d[1]);g.scopeMap=k;g.baseUrl=g.config.baseUrl=a.baseUrl;g.isAsync=a.async;g.locale=l.locale;l="$Rev: 91fa0cb $".match(/[0-9a-f]{7,}/);g.version={major:1,minor:11,patch:2,flag:"",revision:l?l[0]:NaN,toString:function(){var a=g.version;return a.major+"."+a.minor+"."+a.patch+a.flag+" ("+a.revision+")"}};h("csp-restrictions")||Function("d",
"d.eval \x3d function(){return d.global.eval ? d.global.eval(arguments[0]) : eval(arguments[0]);}")(g);g.exit=function(){};h("host-webworker");h.add("console-as-object",function(){return Function.prototype.bind&&console&&"object"===typeof console.log});"undefined"!=typeof console||(console={});a="assert count debug dir dirxml error group groupEnd info profile profileEnd time timeEnd trace warn log".split(" ");var e;for(l=0;e=a[l++];)console[e]?h("console-as-object")&&(console[e]=Function.prototype.bind.call(console[e],
console)):function(){var a=e+"";console[a]="log"in console?function(){var e=Array.prototype.slice.call(arguments);e.unshift(a+":");console.log(e.join(" "))}:function(){};console[a]._fake=!0}();g.deprecated=g.experimental=function(){};g._hasResource={};return g})},"dojo/has":function(){define(["require","module"],function(h,l){var a=h.has||function(){};a.add("dom-addeventlistener",!!document.addEventListener);a.add("touch","ontouchstart"in document||"onpointerdown"in document&&0<navigator.maxTouchPoints||
window.navigator.msMaxTouchPoints);a.add("touch-events","ontouchstart"in document);a.add("pointer-events","pointerEnabled"in window.navigator?window.navigator.pointerEnabled:"PointerEvent"in window);a.add("MSPointer",window.navigator.msPointerEnabled);a.add("device-width",screen.availWidth||innerWidth);var d=document.createElement("form");a.add("dom-attributes-explicit",0==d.attributes.length);a.add("dom-attributes-specified-flag",0<d.attributes.length&&40>d.attributes.length);a.clearElement=function(a){a.innerHTML=
"";return a};a.normalize=function(b,d){var k=b.match(/[\?:]|[^:\?]*/g),m=0,g=function(e){var c=k[m++];if(":"==c)return 0;if("?"==k[m++]){if(!e&&a(c))return g();g(!0);return g(e)}return c||0};return(b=g())&&d(b)};a.load=function(a,d,k){a?d([a],k):k()};return a})},"dojo/_base/config":function(){define(["../has","require"],function(h,l){var a={},d=l.rawConfig,b;for(b in d)a[b]=d[b];!a.locale&&"undefined"!=typeof navigator&&(d=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language||
navigator.userLanguage)&&(a.locale=d.toLowerCase());return a})},"dojo/_base/lang":function(){define(["./kernel","../has","../sniff"],function(h,l){l.add("bug-for-in-skips-shadowed",function(){for(var a in{toString:1})return 0;return 1});var a=l("bug-for-in-skips-shadowed")?"hasOwnProperty valueOf isPrototypeOf propertyIsEnumerable toLocaleString toString constructor".split(" "):[],d=a.length,b=function(a,c,n){n||(n=a[0]&&h.scopeMap[a[0]]?h.scopeMap[a.shift()][1]:h.global);try{for(var b=0;b<a.length;b++){var g=
a[b];if(!(g in n))if(c)n[g]={};else return;n=n[g]}return n}catch(d){}},f=Object.prototype.toString,k=function(a,c,n){return(n||[]).concat(Array.prototype.slice.call(a,c||0))},m=/\{([^\}]+)\}/g,g={_extraNames:a,_mixin:function(e,c,n){var b,g,f,k={};for(b in c)g=c[b],b in e&&(e[b]===g||b in k&&k[b]===g)||(e[b]=n?n(g):g);if(l("bug-for-in-skips-shadowed")&&c)for(f=0;f<d;++f)b=a[f],g=c[b],b in e&&(e[b]===g||b in k&&k[b]===g)||(e[b]=n?n(g):g);return e},mixin:function(a,c){a||(a={});for(var n=1,b=arguments.length;n<
b;n++)g._mixin(a,arguments[n]);return a},setObject:function(a,c,n){var g=a.split(".");a=g.pop();return(n=b(g,!0,n))&&a?n[a]=c:void 0},getObject:function(a,c,n){return a?b(a.split("."),c,n):n},exists:function(a,c){return void 0!==g.getObject(a,!1,c)},isString:function(a){return"string"==typeof a||a instanceof String},isArray:Array.isArray||function(a){return"[object Array]"==f.call(a)},isFunction:function(a){return"[object Function]"===f.call(a)},isObject:function(a){return void 0!==a&&(null===a||
"object"==typeof a||g.isArray(a)||g.isFunction(a))},isArrayLike:function(a){return!!a&&!g.isString(a)&&!g.isFunction(a)&&!(a.tagName&&"form"==a.tagName.toLowerCase())&&(g.isArray(a)||isFinite(a.length))},isAlien:function(a){return a&&!g.isFunction(a)&&/\{\s*\[native code\]\s*\}/.test(String(a))},extend:function(a,c){for(var n=1,b=arguments.length;n<b;n++)g._mixin(a.prototype,arguments[n]);return a},_hitchArgs:function(a,c){var n=g._toArray(arguments,2),b=g.isString(c);return function(){var d=g._toArray(arguments),
f=b?(a||h.global)[c]:c;return f&&f.apply(a||this,n.concat(d))}},hitch:function(a,c){if(2<arguments.length)return g._hitchArgs.apply(h,arguments);c||(c=a,a=null);if(g.isString(c)){a=a||h.global;if(!a[c])throw['lang.hitch: scope["',c,'"] is null (scope\x3d"',a,'")'].join("");return function(){return a[c].apply(a,arguments||[])}}return a?function(){return c.apply(a,arguments||[])}:c},delegate:function(){function a(){}return function(c,n){a.prototype=c;var b=new a;a.prototype=null;n&&g._mixin(b,n);return b}}(),
_toArray:l("ie")?function(){function a(c,e,b){b=b||[];for(e=e||0;e<c.length;e++)b.push(c[e]);return b}return function(c){return(c.item?a:k).apply(this,arguments)}}():k,partial:function(a){return g.hitch.apply(h,[null].concat(g._toArray(arguments)))},clone:function(a){if(!a||"object"!=typeof a||g.isFunction(a))return a;if(a.nodeType&&"cloneNode"in a)return a.cloneNode(!0);if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp)return new RegExp(a);var c,n,b;if(g.isArray(a))for(c=[],
n=0,b=a.length;n<b;++n)n in a&&(c[n]=g.clone(a[n]));else c=a.constructor?new a.constructor:{};return g._mixin(c,a,g.clone)},trim:String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replace:function(a,c,n){return a.replace(n||m,g.isFunction(c)?c:function(a,e){return g.getObject(e,!1,c)})}};g.mixin(h,g);return g})},"dojo/sniff":function(){define(["./has"],function(h){var l=navigator,a=l.userAgent,l=l.appVersion,d=parseFloat(l);h.add("air",
0<=a.indexOf("AdobeAIR"));h.add("wp",parseFloat(a.split("Windows Phone")[1])||void 0);h.add("msapp",parseFloat(a.split("MSAppHost/")[1])||void 0);h.add("khtml",0<=l.indexOf("Konqueror")?d:void 0);h.add("edge",parseFloat(a.split("Edge/")[1])||void 0);h.add("opr",parseFloat(a.split("OPR/")[1])||void 0);h.add("webkit",!h("wp")&&!h("edge")&&parseFloat(a.split("WebKit/")[1])||void 0);h.add("chrome",!h("edge")&&!h("opr")&&parseFloat(a.split("Chrome/")[1])||void 0);h.add("android",!h("wp")&&parseFloat(a.split("Android ")[1])||
void 0);h.add("safari",!(0<=l.indexOf("Safari"))||h("wp")||h("chrome")||h("android")||h("edge")||h("opr")?void 0:parseFloat(l.split("Version/")[1]));h.add("mac",0<=l.indexOf("Macintosh"));h.add("quirks","BackCompat"==document.compatMode);if(!h("wp")&&a.match(/(iPhone|iPod|iPad)/)){var b=RegExp.$1.replace(/P/,"p"),f=a.match(/OS ([\d_]+)/)?RegExp.$1:"1",f=parseFloat(f.replace(/_/,".").replace(/_/g,""));h.add(b,f);h.add("ios",f)}h.add("bb",(0<=a.indexOf("BlackBerry")||0<=a.indexOf("BB10"))&&parseFloat(a.split("Version/")[1])||
void 0);h.add("trident",parseFloat(l.split("Trident/")[1])||void 0);h.add("svg","undefined"!==typeof SVGAngle);h("webkit")||(0<=a.indexOf("Opera")&&h.add("opera",9.8<=d?parseFloat(a.split("Version/")[1])||d:d),!(0<=a.indexOf("Gecko"))||h("wp")||h("khtml")||h("trident")||h("edge")||h.add("mozilla",d),h("mozilla")&&h.add("ff",parseFloat(a.split("Firefox/")[1]||a.split("Minefield/")[1])||void 0),document.all&&!h("opera")&&(a=parseFloat(l.split("MSIE ")[1])||void 0,(l=document.documentMode)&&5!=l&&Math.floor(a)!=
l&&(a=l),h.add("ie",a)),h.add("wii","undefined"!=typeof opera&&opera.wiiremote));return h})},"cmv/viewer/js/viewer/_ControllerBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred"],function(h,l,a){return h(null,{loadConfig:function(){return this.inherited(arguments)},postConfig:function(){return this.inherited(arguments)},startup:function(){var a=this.getInherited(arguments);this.startupDeferred=this.executeSync([this.loadConfig,this.postConfig]);this.startupDeferred.then(l.hitch(this,
function(){a.apply(this)}))},executeSync:function(d,b){b=b||new a;if(!d||!d.length)return b.resolve(),b;var f=l.hitch(this,d.splice(0,1)[0])();f?f.then(l.hitch(this,"executeSync",d,b)):this.executeSync(d,b);return b},handleError:function(a){if(this.config.isDebug&&"object"===typeof console)for(var b in a)a.hasOwnProperty(b)},mixinDeep:function(a,b){var f={},k;for(k in b)if(!(k in a&&(a[k]===b[k]||k in f&&f[k]===b[k])))try{a[k]=b[k].constructor===Object?this.mixinDeep(a[k],b[k]):b[k]}catch(m){a[k]=
b[k]}return a}})})},"dojo/Deferred":function(){define(["./has","./_base/lang","./errors/CancelError","./promise/Promise","require"],function(h,l,a,d,b){var f=Object.freeze||function(){},k=function(a,c,e,b,g){for(g=0;g<a.length;g++)m(a[g],c,e,b)},m=function(a,c,b,d){d=a[c];var f=a.deferred;if(d)try{var k=d(b);0===c?"undefined"!==typeof k&&e(f,c,k):k&&"function"===typeof k.then?(a.cancel=k.cancel,k.then(g(f,1),g(f,2),g(f,0))):e(f,1,k)}catch(m){e(f,2,m)}else e(f,c,b)},g=function(a,c){return function(b){e(a,
c,b)}},e=function(a,c,e){if(!a.isCanceled())switch(c){case 0:a.progress(e);break;case 1:a.resolve(e);break;case 2:a.reject(e)}},c=function(e){var b=this.promise=new d,g=this,u,v,t=!1,w=[];this.isResolved=b.isResolved=function(){return 1===u};this.isRejected=b.isRejected=function(){return 2===u};this.isFulfilled=b.isFulfilled=function(){return!!u};this.isCanceled=b.isCanceled=function(){return t};this.progress=function(a,c){if(u){if(!0===c)throw Error("This deferred has already been fulfilled.");return b}k(w,
0,a,null,g);return b};this.resolve=function(a,c){if(u){if(!0===c)throw Error("This deferred has already been fulfilled.");return b}k(w,u=1,v=a,null,g);w=null;return b};var h=this.reject=function(a,c){if(u){if(!0===c)throw Error("This deferred has already been fulfilled.");return b}k(w,u=2,v=a,void 0,g);w=null;return b};this.then=b.then=function(a,e,n){var g=[n,a,e];g.cancel=b.cancel;g.deferred=new c(function(a){return g.cancel&&g.cancel(a)});u&&!w?m(g,u,v,void 0):w.push(g);return g.deferred.promise};
this.cancel=b.cancel=function(c,b){if(!u){if(e){var g=e(c);c="undefined"===typeof g?c:g}t=!0;if(!u)return"undefined"===typeof c&&(c=new a),h(c),c;if(2===u&&v===c)return c}else if(!0===b)throw Error("This deferred has already been fulfilled.");};f(b)};c.prototype.toString=function(){return"[object Deferred]"};b&&b(c);return c})},"dojo/errors/CancelError":function(){define(["./create"],function(h){return h("CancelError",null,null,{dojoType:"cancel"})})},"dojo/errors/create":function(){define(["../_base/lang"],
function(h){return function(l,a,d,b){d=d||Error;var f=function(b){if(d===Error){Error.captureStackTrace&&Error.captureStackTrace(this,f);var m=Error.call(this,b),g;for(g in m)m.hasOwnProperty(g)&&(this[g]=m[g]);this.message=b;this.stack=m.stack}else d.apply(this,arguments);a&&a.apply(this,arguments)};f.prototype=h.delegate(d.prototype,b);f.prototype.name=l;return f.prototype.constructor=f}})},"dojo/promise/Promise":function(){define(["../_base/lang"],function(h){function l(){throw new TypeError("abstract");
}return h.extend(function(){},{then:function(a,d,b){l()},cancel:function(a,d){l()},isResolved:function(){l()},isRejected:function(){l()},isFulfilled:function(){l()},isCanceled:function(){l()},always:function(a){return this.then(a,a)},otherwise:function(a){return this.then(null,a)},trace:function(){return this},traceRejected:function(){return this},toString:function(){return"[object Promise]"}})})},"app/_ConfigMixin":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred"],function(h,
l,a){return h(null,{loadConfig:function(d){var b;d?(b=new a,d.then(l.hitch(this,function(){this.initConfigAsync().then(l.hitch(this,function(){this.initConfigSuccess(arguments);b.resolve()}),l.hitch(this,"initConfigError"))}))):(b=this.initConfigAsync(),b.then(l.hitch(this,"initConfigSuccess"),l.hitch(this,"initConfigError")));return this.inherited(arguments,[b])||b},initConfigAsync:function(){var d=new a,b="app/config/viewer",f=window.location.search.match(/config=([^&]*)/i);f&&0<f.length&&(b=f[1],
0>b.indexOf("/")&&(b="app/config/"+b));require([b],function(a){d.resolve(a)});return d},initConfigSuccess:function(a){this.config=a;a.isDebug&&(window.app=this);this.mapClickMode={current:a.defaultMapClickMode,defaultMode:a.defaultMapClickMode}},initConfigError:function(a){this.handleError({source:"Controller",error:a})}})})},"cmv/viewer/js/viewer/_LayoutMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/topic dojo/_base/array dojo/on dojo/aspect dojo/dom dojo/query dojo/dom-style dojo/dom-class dojo/dom-geometry dojo/sniff dojo/Deferred put-selector dijit/layout/BorderContainer dijit/layout/ContentPane esri/dijit/PopupMobile dojo/text!./templates/mapOverlay.html".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w){return h(null,{panes:{left:{id:"sidebarLeft",placeAt:"outer",collapsible:!0,region:"left"},center:{id:"mapCenter",placeAt:"outer",region:"center",content:w}},collapseButtons:{},postConfig:function(){this.layoutDeferred=new q;return this.inherited(arguments)},startup:function(){this.config.layout=this.config.layout||{};this.addTopics();this.addTitles();this.detectTouchDevices();this.initPanes();this.mapDeferred.then(l.hitch(this,"createPanes"));this.layoutDeferred.resolve();
this.inherited(arguments)},addTopics:function(){a.subscribe("viewer/togglePane",l.hitch(this,function(a){this.togglePane(a.pane,a.show,a.suppressEvent)}));a.subscribe("viewer/loadWidget",l.hitch(this,function(a){this.widgetLoader(a.options,a.position)}));this.config.isDebug&&a.subscribe("viewer/handleError",l.hitch(this,"handleError"));a.subscribe("mapClickMode/setCurrent",l.hitch(this,function(c){this.mapClickMode.current=c;a.publish("mapClickMode/currentSet",c)}));a.subscribe("mapClickMode/setDefault",
l.hitch(this,function(){a.publish("mapClickMode/setCurrent",this.mapClickMode.defaultMode)}))},addTitles:function(){if(this.config.titles){var a=this.config.titles;if(a.header){var c=k.byId("headerTitleSpan");c&&(c.innerHTML=a.header)}a.subHeader&&(c=k.byId("subHeaderTitleSpan"))&&(c.innerHTML=a.subHeader);a.pageTitle&&(document.title=a.pageTitle)}},initPanes:function(){var a,c=this.config.panes||{};this.defaultPanes=l.clone(this.panes);for(a in this.panes)this.defaultPanes.hasOwnProperty(a)&&(c[a]=
l.mixin(this.defaultPanes[a],c[a]));var e=k.byId(this.config.layout.container)||document.body;this.panes.outer=(new u({id:"borderContainerOuter",design:"sidebar",gutters:!1})).placeAt(e);var n,b;for(a in c)c.hasOwnProperty(a)&&(e=l.clone(c[a]),n=this.panes[e.placeAt]||this.panes.outer,e.id=e.id||a,b=e.type,delete e.placeAt,delete e.type,delete e.collapsible,n&&("border"===b?this.panes[a]=(new u(e)).placeAt(n):e.region&&(this.panes[a]=(new v(e)).placeAt(n))));this.panes.outer.startup()},createPanes:function(){var a,
c=this.config.panes||{};for(a in this.panes)this.defaultPanes.hasOwnProperty(a)&&(c[a]=l.mixin(this.defaultPanes[a],c[a]));this.collapseButtonsPane=this.config.collapseButtonsPane||"outer";for(a in c)if(c.hasOwnProperty(a)){if(c[a].collapsible&&(this.collapseButtons[a]=r(this.panes[this.collapseButtonsPane].domNode,"div.sidebarCollapseButton.sidebar"+a+"CollapseButton.sidebarCollapseButton"+("bottom"===a||"top"===a?"Vert":"Horz")+" div.dijitIcon.button.close").parentNode,b(this.collapseButtons[a],
"click",l.hitch(this,"togglePane",a,null,!1)),this.positionSideBarToggle(a),"outer"===this.collapseButtonsPane)){var n=this.panes[a]._splitterWidget;n&&(f.after(n,"_startDrag",l.hitch(this,"_splitterStartDrag",a)),f.after(n,"_stopDrag",l.hitch(this,"_splitterStopDrag",a)))}void 0!==c[a].open&&this.togglePane(a,c[a].open,!0);"center"!==a&&this.panes[a]._splitterWidget&&(e.add(this.map.root.parentNode,"pane"+a),"right"===a&&this.panes.top&&e.add(this.panes.top.domNode,"pane"+a),"right"===a&&this.panes.bottom&&
e.add(this.panes.bottom.domNode,"pane"+a),"left"===a&&this.panes.top&&e.add(this.panes.top.domNode,"pane"+a),"left"===a&&this.panes.bottom&&e.add(this.panes.bottom.domNode,"pane"+a))}this.resizeLayout()},togglePane:function(c,e,n){if(this.panes[c]){var b=this.panes[c].domNode;if(b){var d=g.get(b,"display"),f;if("string"!==typeof e||"none"!==e&&"block"!==e)if("boolean"===typeof e)f=e?"block":"none";else if(void 0===e||null===e)f="none"===d?"block":"none";else{this.handleError({source:"_LayoutMixin",
error:'Invalid type passed as "show" property of "togglePane" function : '+typeof e});return}else f=e;e="block"===f;f!==d&&(g.set(b,"display",f),this.panes[c]._splitterWidget&&g.set(this.panes[c]._splitterWidget.domNode,"display",f),this.positionSideBarToggle(c),this.panes.outer&&this.panes.outer.resize(),n||a.publish("viewer/onTogglePane",{pane:c,show:e}))}}},positionSideBarToggle:function(a){var n=this.panes[a],b=this.collapseButtons[a];if(n&&b){var d=g.get(n.domNode,"display"),f="none"===d?"open":
"close";e.remove(b.children[0],"none"===d?"close":"open");e.add(b.children[0],f);if("outer"===this.collapseButtonsPane){var f=n._splitterWidget?0:-1,k="bottom"===a||"top"===a?"h":"w";"block"===d&&(f+=c.getMarginBox(n.domNode)[k]);n._splitterWidget&&(f+=c.getMarginBox(n._splitterWidget.domNode)[k]);g.set(b,a,f.toString()+"px");g.set(b,"display","block")}}},repositionSideBarButtons:function(){d.forEach(["left","right","top","bottom"],l.hitch(this,function(a){this.positionSideBarToggle(a)}))},resizeLayout:function(){this.panes.outer.resize()},
_splitterStartDrag:function(a){g.set(this.collapseButtons[a],"display","none")},_splitterStopDrag:function(a){this.positionSideBarToggle(a)},detectTouchDevices:function(){n("touch")&&(n("ios")||n("android")||n("bb"))&&(n.add("mobile",!0),500>screen.availWidth||500>screen.availHeight?n.add("phone",!0):n.add("tablet",!0),n("phone")&&!this.config.mapOptions.infoWindow&&(this.config.mapOptions.infoWindow=new t(null,r("div"))))}})})},"dojo/topic":function(){define(["./Evented"],function(h){var l=new h;
return{publish:function(a,d){return l.emit.apply(l,arguments)},subscribe:function(a,d){return l.on.apply(l,arguments)}}})},"dojo/Evented":function(){define(["./aspect","./on"],function(h,l){function a(){}var d=h.after;a.prototype={on:function(a,f){return l.parse(this,a,f,function(a,b){return d(a,"on"+b,f,!0)})},emit:function(a,d){var k=[this];k.push.apply(k,arguments);return l.emit.apply(l,k)}};return a})},"dojo/aspect":function(){define([],function(){function h(a,b,g,e){var c=a[b],n="around"==b,
d;if(n){var f=g(function(){return c.advice(this,arguments)});d={remove:function(){f&&(f=a=g=null)},advice:function(a,e){return f?f.apply(a,e):c.advice(a,e)}}}else d={remove:function(){if(d.advice){var c=d.previous,e=d.next;e||c?(c?c.next=e:a[b]=e,e&&(e.previous=c)):delete a[b];a=g=d.advice=null}},id:a.nextId++,advice:g,receiveArguments:e};if(c&&!n)if("after"==b){for(;c.next&&(c=c.next););c.next=d;d.previous=c}else"before"==b&&(a[b]=d,d.next=c,c.previous=d);else a[b]=d;return d}function l(b){return function(d,
g,e,c){var n=d[g],f;n&&n.target==d||(d[g]=f=function(){for(var c=f.nextId,e=arguments,b=f.before;b;)b.advice&&(e=b.advice.apply(this,e)||e),b=b.next;if(f.around)var n=f.around.advice(this,e);for(b=f.after;b&&b.id<c;){if(b.advice)if(b.receiveArguments)var g=b.advice.apply(this,e),n=g===a?n:g;else n=b.advice.call(this,n,e);b=b.next}return n},n&&(f.around={advice:function(a,c){return n.apply(a,c)}}),f.target=d,f.nextId=f.nextId||0);d=h(f||n,b,e,c);e=null;return d}}var a,d=l("after"),b=l("before"),f=
l("around");return{before:b,around:f,after:d}})},"dojo/on":function(){define(["./has!dom-addeventlistener?:./aspect","./_base/kernel","./sniff"],function(h,l,a){function d(c,e,b,d,f){if(d=e.match(/(.*):(.*)/))return e=d[2],d=d[1],m.selector(d,e).call(f,c,b);a("touch")&&(g.test(e)&&(b=B(b)),a("event-orientationchange")||"orientationchange"!=e||(e="resize",c=window,b=B(b)));r&&(b=r(b));if(c.addEventListener){var k=e in n,t=k?n[e]:e;c.addEventListener(t,b,k);return{remove:function(){c.removeEventListener(t,
b,k)}}}if(w&&c.attachEvent)return w(c,"on"+e,b);throw Error("Target must be an event emitter");}function b(){this.cancelable=!1;this.defaultPrevented=!0}function f(){this.bubbles=!1}var k=window.ScriptEngineMajorVersion;a.add("jscript",k&&k()+ScriptEngineMinorVersion()/10);a.add("event-orientationchange",a("touch")&&!a("android"));a.add("event-stopimmediatepropagation",window.Event&&!!window.Event.prototype&&!!window.Event.prototype.stopImmediatePropagation);a.add("event-focusin",function(a,c,e){return"onfocusin"in
e});a("touch")&&a.add("touch-can-modify-event-delegate",function(){var a=function(){};a.prototype=document.createEvent("MouseEvents");try{var c=new a;c.target=null;return null===c.target}catch(e){return!1}});var m=function(a,c,e,b){return"function"!=typeof a.on||"function"==typeof c||a.nodeType?m.parse(a,c,e,d,b,this):a.on(c,e)};m.pausable=function(a,c,e,b){var n;a=m(a,c,function(){if(!n)return e.apply(this,arguments)},b);a.pause=function(){n=!0};a.resume=function(){n=!1};return a};m.once=function(a,
c,e,b){var n=m(a,c,function(){n.remove();return e.apply(this,arguments)});return n};m.parse=function(a,c,e,b,n,g){var d;if(c.call)return c.call(g,a,e);c instanceof Array?d=c:-1<c.indexOf(",")&&(d=c.split(/\s*,\s*/));if(d){var f=[];c=0;for(var k;k=d[c++];)f.push(m.parse(a,k,e,b,n,g));f.remove=function(){for(var a=0;a<f.length;a++)f[a].remove()};return f}return b(a,c,e,n,g)};var g=/^touch/;m.matches=function(a,c,e,b,n){n=n&&"function"==typeof n.matches?n:l.query;b=!1!==b;1!=a.nodeType&&(a=a.parentNode);
for(;!n.matches(a,c,e);)if(a==e||!1===b||!(a=a.parentNode)||1!=a.nodeType)return!1;return a};m.selector=function(a,c,e){return function(b,n){function g(c){return m.matches(c,a,b,e,d)}var d="function"==typeof a?{matches:a}:this,f=c.bubble;return f?m(b,f(g),n):m(b,c,function(a){var c=g(a.target);if(c)return a.selectorTarget=c,n.call(c,a)})}};var e=[].slice,c=m.emit=function(a,c,n){var g=e.call(arguments,2),d="on"+c;if("parentNode"in a){var k=g[0]={},t;for(t in n)k[t]=n[t];k.preventDefault=b;k.stopPropagation=
f;k.target=a;k.type=c;n=k}do a[d]&&a[d].apply(a,g);while(n&&n.bubbles&&(a=a.parentNode));return n&&n.cancelable&&n},n=a("event-focusin")?{}:{focusin:"focus",focusout:"blur"};if(!a("event-stopimmediatepropagation"))var q=function(){this.modified=this.immediatelyStopped=!0},r=function(a){return function(c){if(!c.immediatelyStopped)return c.stopImmediatePropagation=q,a.apply(this,arguments)}};if(a("dom-addeventlistener"))m.emit=function(a,e,b){if(a.dispatchEvent&&document.createEvent){var n=(a.ownerDocument||
document).createEvent("HTMLEvents");n.initEvent(e,!!b.bubbles,!!b.cancelable);for(var g in b)g in n||(n[g]=b[g]);return a.dispatchEvent(n)&&n}return c.apply(m,arguments)};else{m._fixEvent=function(a,c){a||(a=(c&&(c.ownerDocument||c.document||c).parentWindow||window).event);if(!a)return a;try{u&&a.type==u.type&&a.srcElement==u.target&&(a=u)}catch(e){}if(!a.target)switch(a.target=a.srcElement,a.currentTarget=c||a.srcElement,"mouseover"==a.type&&(a.relatedTarget=a.fromElement),"mouseout"==a.type&&(a.relatedTarget=
a.toElement),a.stopPropagation||(a.stopPropagation=x,a.preventDefault=y),a.type){case "keypress":var b="charCode"in a?a.charCode:a.keyCode;10==b?(b=0,a.keyCode=13):13==b||27==b?b=0:3==b&&(b=99);a.charCode=b;b=a;b.keyChar=b.charCode?String.fromCharCode(b.charCode):"";b.charOrCode=b.keyChar||b.keyCode}return a};var u,v=function(a){this.handle=a};v.prototype.remove=function(){delete _dojoIEListeners_[this.handle]};var t=function(a){return function(c){c=m._fixEvent(c,this);var e=a.call(this,c);c.modified&&
(u||setTimeout(function(){u=null}),u=c);return e}},w=function(c,e,b){b=t(b);if(((c.ownerDocument?c.ownerDocument.parentWindow:c.parentWindow||c.window||window)!=top||5.8>a("jscript"))&&!a("config-_allow_leaks")){"undefined"==typeof _dojoIEListeners_&&(_dojoIEListeners_=[]);var n=c[e];if(!n||!n.listeners){var g=n,n=Function("event","var callee \x3d arguments.callee; for(var i \x3d 0; i\x3ccallee.listeners.length; i++){var listener \x3d _dojoIEListeners_[callee.listeners[i]]; if(listener){listener.call(this,event);}}");
n.listeners=[];c[e]=n;n.global=this;g&&n.listeners.push(_dojoIEListeners_.push(g)-1)}n.listeners.push(c=n.global._dojoIEListeners_.push(b)-1);return new v(c)}return h.after(c,e,b,!0)},x=function(){this.cancelBubble=!0},y=m._preventDefault=function(){this.bubbledKeyCode=this.keyCode;if(this.ctrlKey)try{this.keyCode=0}catch(a){}this.defaultPrevented=!0;this.returnValue=!1;this.modified=!0}}if(a("touch"))var z=function(){},A=window.orientation,B=function(c){return function(e){var b=e.corrected;if(!b){var n=
e.type;try{delete e.type}catch(g){}if(e.type){if(a("touch-can-modify-event-delegate"))z.prototype=e,b=new z;else{var b={},d;for(d in e)b[d]=e[d]}b.preventDefault=function(){e.preventDefault()};b.stopPropagation=function(){e.stopPropagation()}}else b=e,b.type=n;e.corrected=b;if("resize"==n){if(A==window.orientation)return null;A=window.orientation;b.type="orientationchange";return c.call(this,b)}"rotation"in b||(b.rotation=0,b.scale=1);var n=b.changedTouches[0],f;for(f in n)delete b[f],b[f]=n[f]}return c.call(this,
b)}};return m})},"dojo/_base/array":function(){define(["./kernel","../has","./lang"],function(h,l,a){function d(a){return k[a]=new Function("item","index","array",a)}function b(a){var c=!a;return function(b,g,f){var u=0,m=b&&b.length||0,t;m&&"string"==typeof b&&(b=b.split(""));"string"==typeof g&&(g=k[g]||d(g));if(f)for(;u<m;++u){if(t=!g.call(f,b[u],u,b),a^t)return!t}else for(;u<m;++u)if(t=!g(b[u],u,b),a^t)return!t;return c}}function f(a){var c=1,b=0,d=0;a||(c=b=d=-1);return function(f,k,v,t){if(t&&
0<c)return g.lastIndexOf(f,k,v);t=f&&f.length||0;var w=a?t+d:b;v===m?v=a?b:t+d:0>v?(v=t+v,0>v&&(v=b)):v=v>=t?t+d:v;for(t&&"string"==typeof f&&(f=f.split(""));v!=w;v+=c)if(f[v]==k)return v;return-1}}var k={},m,g={every:b(!1),some:b(!0),indexOf:f(!0),lastIndexOf:f(!1),forEach:function(a,c,b){var g=0,f=a&&a.length||0;f&&"string"==typeof a&&(a=a.split(""));"string"==typeof c&&(c=k[c]||d(c));if(b)for(;g<f;++g)c.call(b,a[g],g,a);else for(;g<f;++g)c(a[g],g,a)},map:function(a,c,b,g){var f=0,u=a&&a.length||
0;g=new (g||Array)(u);u&&"string"==typeof a&&(a=a.split(""));"string"==typeof c&&(c=k[c]||d(c));if(b)for(;f<u;++f)g[f]=c.call(b,a[f],f,a);else for(;f<u;++f)g[f]=c(a[f],f,a);return g},filter:function(a,c,b){var g=0,f=a&&a.length||0,u=[],m;f&&"string"==typeof a&&(a=a.split(""));"string"==typeof c&&(c=k[c]||d(c));if(b)for(;g<f;++g)m=a[g],c.call(b,m,g,a)&&u.push(m);else for(;g<f;++g)m=a[g],c(m,g,a)&&u.push(m);return u},clearCache:function(){k={}}};a.mixin(h,g);return g})},"dojo/dom":function(){define(["./sniff",
"./_base/window","./_base/kernel"],function(h,l,a){if(7>=h("ie"))try{document.execCommand("BackgroundImageCache",!1,!0)}catch(d){}var b={};h("ie")?b.byId=function(a,b){if("string"!=typeof a)return a;var g=b||l.doc,e=a&&g.getElementById(a);if(!e||e.attributes.id.value!=a&&e.id!=a){g=g.all[a];if(!g||g.nodeName)g=[g];for(var c=0;e=g[c++];)if(e.attributes&&e.attributes.id&&e.attributes.id.value==a||e.id==a)return e}else return e}:b.byId=function(a,b){return("string"==typeof a?(b||l.doc).getElementById(a):
a)||null};a=a.global.document||null;h.add("dom-contains",!(!a||!a.contains));b.isDescendant=h("dom-contains")?function(a,d){return!(!(d=b.byId(d))||!d.contains(b.byId(a)))}:function(a,d){try{for(a=b.byId(a),d=b.byId(d);a;){if(a==d)return!0;a=a.parentNode}}catch(g){}return!1};h.add("css-user-select",function(a,b,g){if(!g)return!1;a=g.style;b=["Khtml","O","Moz","Webkit"];g=b.length;var e="userSelect";do if("undefined"!==typeof a[e])return e;while(g--&&(e=b[g]+"UserSelect"));return!1});var f=h("css-user-select");
b.setSelectable=f?function(a,d){b.byId(a).style[f]=d?"":"none"}:function(a,d){a=b.byId(a);var g=a.getElementsByTagName("*"),e=g.length;if(d)for(a.removeAttribute("unselectable");e--;)g[e].removeAttribute("unselectable");else for(a.setAttribute("unselectable","on");e--;)g[e].setAttribute("unselectable","on")};return b})},"dojo/_base/window":function(){define(["./kernel","./lang","../sniff"],function(h,l,a){var d={global:h.global,doc:h.global.document||null,body:function(a){a=a||h.doc;return a.body||
a.getElementsByTagName("body")[0]},setContext:function(a,f){h.global=d.global=a;h.doc=d.doc=f},withGlobal:function(a,f,k,m){var g=h.global;try{return h.global=d.global=a,d.withDoc.call(null,a.document,f,k,m)}finally{h.global=d.global=g}},withDoc:function(b,f,k,m){var g=d.doc,e=a("quirks"),c=a("ie"),n,q,r;try{return h.doc=d.doc=b,h.isQuirks=a.add("quirks","BackCompat"==h.doc.compatMode,!0,!0),a("ie")&&(r=b.parentWindow)&&r.navigator&&(n=parseFloat(r.navigator.appVersion.split("MSIE ")[1])||void 0,
(q=b.documentMode)&&5!=q&&Math.floor(n)!=q&&(n=q),h.isIE=a.add("ie",n,!0,!0)),k&&"string"==typeof f&&(f=k[f]),f.apply(k,m||[])}finally{h.doc=d.doc=g,h.isQuirks=a.add("quirks",e,!0,!0),h.isIE=a.add("ie",c,!0,!0)}}};l.mixin(h,d);return d})},"dojo/query":function(){define("./_base/kernel ./has ./dom ./on ./_base/array ./_base/lang ./selector/_loader ./selector/_loader!default".split(" "),function(h,l,a,d,b,f,k,m){function g(c,e){var n=function(b,n){if("string"==typeof n&&(n=a.byId(n),!n))return new e([]);
var g="string"==typeof b?c(b,n):b?b.end&&b.on?b:[b]:[];return g.end&&g.on?g:new e(g)};n.matches=c.match||function(a,c,e){return 0<n.filter([a],c,e).length};n.filter=c.filter||function(a,c,e){return n(c,e).filter(function(c){return-1<b.indexOf(a,c)})};if("function"!=typeof c){var g=c.search;c=function(a,c){return g(c||document,a)}}return n}l.add("array-extensible",function(){return 1==f.delegate([],{length:1}).length&&!l("bug-for-in-skips-shadowed")});var e=Array.prototype,c=e.slice,n=e.concat,q=b.forEach,
r=function(a,e,b){e=[0].concat(c.call(e,0));b=b||h.global;return function(c){e[0]=c;return a.apply(b,e)}},u=function(a){var c=this instanceof v&&l("array-extensible");"number"==typeof a&&(a=Array(a));var e=a&&"length"in a?a:arguments;if(c||!e.sort){for(var b=c?this:[],n=b.length=e.length,g=0;g<n;g++)b[g]=e[g];if(c)return b;e=b}f._mixin(e,t);e._NodeListCtor=function(a){return v(a)};return e},v=u,t=v.prototype=l("array-extensible")?[]:{};v._wrap=t._wrap=function(a,c,e){a=new (e||this._NodeListCtor||
v)(a);return c?a._stash(c):a};v._adaptAsMap=function(a,c){return function(){return this.map(r(a,arguments,c))}};v._adaptAsForEach=function(a,c){return function(){this.forEach(r(a,arguments,c));return this}};v._adaptAsFilter=function(a,c){return function(){return this.filter(r(a,arguments,c))}};v._adaptWithCondition=function(a,c,e){return function(){var b=arguments,n=r(a,b,e);if(c.call(e||h.global,b))return this.map(n);this.forEach(n);return this}};q(["slice","splice"],function(a){var c=e[a];t[a]=
function(){return this._wrap(c.apply(this,arguments),"slice"==a?this:null)}});q(["indexOf","lastIndexOf","every","some"],function(a){var e=b[a];t[a]=function(){return e.apply(h,[this].concat(c.call(arguments,0)))}});f.extend(u,{constructor:v,_NodeListCtor:v,toString:function(){return this.join(",")},_stash:function(a){this._parent=a;return this},on:function(a,c){var e=this.map(function(e){return d(e,a,c)});e.remove=function(){for(var a=0;a<e.length;a++)e[a].remove()};return e},end:function(){return this._parent?
this._parent:new this._NodeListCtor(0)},concat:function(a){var e=c.call(this,0),g=b.map(arguments,function(a){return c.call(a,0)});return this._wrap(n.apply(e,g),this)},map:function(a,c){return this._wrap(b.map(this,a,c),this)},forEach:function(a,c){q(this,a,c);return this},filter:function(a){var c=arguments,e=this,n=0;if("string"==typeof a){e=w._filterResult(this,c[0]);if(1==c.length)return e._stash(this);n=1}return this._wrap(b.filter(e,c[n],c[n+1]),this)},instantiate:function(a,c){var e=f.isFunction(a)?
a:f.getObject(a);c=c||{};return this.forEach(function(a){new e(c,a)})},at:function(){var a=new this._NodeListCtor(0);q(arguments,function(c){0>c&&(c=this.length+c);this[c]&&a.push(this[c])},this);return a._stash(this)}});var w=g(m,u);h.query=g(m,function(a){return u(a)});w.load=function(a,c,e){k.load(a,c,function(a){e(g(a,u))})};h._filterQueryResult=w._filterResult=function(a,c,e){return new u(w.filter(a,c,e))};h.NodeList=w.NodeList=u;return w})},"dojo/selector/_loader":function(){define(["../has",
"require"],function(h,l){if("undefined"!==typeof document){var a=document.createElement("div");h.add("dom-qsa2.1",!!a.querySelectorAll);h.add("dom-qsa3",function(){try{return a.innerHTML="\x3cp class\x3d'TEST'\x3e\x3c/p\x3e",1==a.querySelectorAll(".TEST:empty").length}catch(b){}})}var d;return{load:function(a,f,k,m){if(m&&m.isBuild)k();else{m=l;a="default"==a?h("config-selectorEngine")||"css3":a;a="css2"==a||"lite"==a?"./lite":"css2.1"==a?h("dom-qsa2.1")?"./lite":"./acme":"css3"==a?h("dom-qsa3")?
"./lite":"./acme":"acme"==a?"./acme":(m=f)&&a;if("?"==a.charAt(a.length-1)){a=a.substring(0,a.length-1);var g=!0}if(g&&(h("dom-compliant-qsa")||d))return k(d);m([a],function(e){"./lite"!=a&&(d=e);k(e)})}}}})},"dojo/selector/lite":function(){define(["../has","../_base/kernel"],function(h,l){var a=document.createElement("div"),d=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector,b=a.querySelectorAll,f=/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g;
h.add("dom-matches-selector",!!d);h.add("dom-qsa",!!b);var k=function(a,n){if(e&&-1<a.indexOf(","))return e(a,n);var d=n?n.ownerDocument||n:l.doc||document,f=(b?/^([\w]*)#([\w\-]+$)|^(\.)([\w\-\*]+$)|^(\w+$)/:/^([\w]*)#([\w\-]+)(?:\s+(.*))?$|(?:^|(>|.+\s+))([\w\-\*]+)(\S*$)/).exec(a);n=n||d;if(f){var u=8===h("ie")&&h("quirks")?n.nodeType===d.nodeType:null!==n.parentNode&&9!==n.nodeType&&n.parentNode===d;if(f[2]&&u){var v=l.byId?l.byId(f[2],d):d.getElementById(f[2]);if(!v||f[1]&&f[1]!=v.tagName.toLowerCase())return[];
if(n!=d)for(d=v;d!=n;)if(d=d.parentNode,!d)return[];return f[3]?k(f[3],v):[v]}if(f[3]&&n.getElementsByClassName)return n.getElementsByClassName(f[4]);if(f[5])if(v=n.getElementsByTagName(f[5]),f[4]||f[6])a=(f[4]||"")+f[6];else return v}if(b)return 1===n.nodeType&&"object"!==n.nodeName.toLowerCase()?m(n,a,n.querySelectorAll):n.querySelectorAll(a);v||(v=n.getElementsByTagName("*"));f=[];d=0;for(u=v.length;d<u;d++){var t=v[d];1==t.nodeType&&g(t,a,n)&&f.push(t)}return f},m=function(a,e,b){var g=a,d=a.getAttribute("id"),
k=d||"__dojo__",t=a.parentNode,m=/^\s*[+~]/.test(e);if(m&&!t)return[];d?k=k.replace(/'/g,"\\$\x26"):a.setAttribute("id",k);m&&t&&(a=a.parentNode);e=e.match(f);for(t=0;t<e.length;t++)e[t]="[id\x3d'"+k+"'] "+e[t];e=e.join(",");try{return b.call(a,e)}finally{d||g.removeAttribute("id")}};if(!h("dom-matches-selector"))var g=function(){function c(a,c,e){var b=c.charAt(0);if('"'==b||"'"==b)c=c.slice(1,-1);c=c.replace(/\\/g,"");var n=t[e||""];return function(e){return(e=e.getAttribute(a))&&n(e,c)}}function e(a){return function(c,
e){for(;(c=c.parentNode)!=e;)if(a(c,e))return!0}}function b(a){return function(c,e){c=c.parentNode;return a?c!=e&&a(c,e):c==e}}function g(a,c){return a?function(e,b){return c(e)&&a(e,b)}:c}var d="div"==a.tagName?"toLowerCase":"toUpperCase",f={"":function(a){a=a[d]();return function(c){return c.tagName==a}},".":function(a){var c=" "+a+" ";return function(e){return-1<e.className.indexOf(a)&&-1<(" "+e.className+" ").indexOf(c)}},"#":function(a){return function(c){return c.id==a}}},t={"^\x3d":function(a,
c){return 0==a.indexOf(c)},"*\x3d":function(a,c){return-1<a.indexOf(c)},"$\x3d":function(a,c){return a.substring(a.length-c.length,a.length)==c},"~\x3d":function(a,c){return-1<(" "+a+" ").indexOf(" "+c+" ")},"|\x3d":function(a,c){return 0==(a+"-").indexOf(c+"-")},"\x3d":function(a,c){return a==c},"":function(a,c){return!0}},k={};return function(a,d,t){var u=k[d];if(!u){if(d.replace(/(?:\s*([> ])\s*)|(#|\.)?((?:\\.|[\w-])+)|\[\s*([\w-]+)\s*(.?=)?\s*("(?:\\.|[^"])+"|'(?:\\.|[^'])+'|(?:\\.|[^\]])*)\s*\]/g,
function(a,d,t,k,m,w,h){k?u=g(u,f[t||""](k.replace(/\\/g,""))):d?u=(" "==d?e:b)(u):m&&(u=g(u,c(m,h,w)));return""}))throw Error("Syntax error in query");if(!u)return!0;k[d]=u}return u(a,t)}}();if(!h("dom-qsa"))var e=function(a,e){for(var b=a.match(f),g=[],d=0;d<b.length;d++){a=new String(b[d].replace(/\s*$/,""));a.indexOf=escape;for(var m=k(a,e),t=0,w=m.length;t<w;t++){var h=m[t];g[h.sourceIndex]=h}}b=[];for(d in g)b.push(g[d]);return b};k.match=d?function(a,e,b){return b&&9!=b.nodeType?m(b,e,function(e){return d.call(a,
e)}):d.call(a,e)}:g;return k})},"dojo/dom-style":function(){define(["./sniff","./dom"],function(h,l){function a(a,b,n){b=b.toLowerCase();if("auto"==n){if("height"==b)return a.offsetHeight;if("width"==b)return a.offsetWidth}if("fontweight"==b)switch(n){case 700:return"bold";default:return"normal"}b in e||(e[b]=c.test(b));return e[b]?f(a,n):n}var d,b={};d=h("webkit")?function(a){var c;if(1==a.nodeType){var e=a.ownerDocument.defaultView;c=e.getComputedStyle(a,null);!c&&a.style&&(a.style.display="",c=
e.getComputedStyle(a,null))}return c||{}}:h("ie")&&(9>h("ie")||h("quirks"))?function(a){return 1==a.nodeType&&a.currentStyle?a.currentStyle:{}}:function(a){return 1==a.nodeType?a.ownerDocument.defaultView.getComputedStyle(a,null):{}};b.getComputedStyle=d;var f;f=h("ie")?function(a,c){if(!c)return 0;if("medium"==c)return 4;if(c.slice&&"px"==c.slice(-2))return parseFloat(c);var e=a.style,b=a.runtimeStyle,n=e.left,g=b.left;b.left=a.currentStyle.left;try{e.left=c,c=e.pixelLeft}catch(d){c=0}e.left=n;b.left=
g;return c}:function(a,c){return parseFloat(c)||0};b.toPixelValue=f;var k=function(a,c){try{return a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(e){return c?{}:null}},m=9>h("ie")||10>h("ie")&&h("quirks")?function(a){try{return k(a).Opacity/100}catch(c){return 1}}:function(a){return d(a).opacity},g=9>h("ie")||10>h("ie")&&h("quirks")?function(a,c){""===c&&(c=1);var e=100*c;1===c?(a.style.zoom="",k(a)&&(a.style.filter=a.style.filter.replace(/\s*progid:DXImageTransform.Microsoft.Alpha\([^\)]+?\)/i,
""))):(a.style.zoom=1,k(a)?k(a,1).Opacity=e:a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity\x3d"+e+")",k(a,1).Enabled=!0);if("tr"==a.tagName.toLowerCase())for(e=a.firstChild;e;e=e.nextSibling)"td"==e.tagName.toLowerCase()&&g(e,c);return c}:function(a,c){return a.style.opacity=c},e={left:!0,top:!0},c=/margin|padding|width|height|max|min|offset/,n={cssFloat:1,styleFloat:1,"float":1};b.get=function(c,e){var g=l.byId(c),d=arguments.length;if(2==d&&"opacity"==e)return m(g);e=n[e]?"cssFloat"in
g.style?"cssFloat":"styleFloat":e;var f=b.getComputedStyle(g);return 1==d?f:a(g,e,f[e]||g.style[e])};b.set=function(a,c,e){var d=l.byId(a),f=arguments.length,k="opacity"==c;c=n[c]?"cssFloat"in d.style?"cssFloat":"styleFloat":c;if(3==f)return k?g(d,e):d.style[c]=e;for(var m in c)b.set(a,m,c[m]);return b.getComputedStyle(d)};return b})},"dojo/dom-class":function(){define(["./_base/lang","./_base/array","./dom"],function(h,l,a){function d(a){if("string"==typeof a||a instanceof String){if(a&&!f.test(a))return k[0]=
a,k;a=a.split(f);a.length&&!a[0]&&a.shift();a.length&&!a[a.length-1]&&a.pop();return a}return a?l.filter(a,function(a){return a}):[]}var b,f=/\s+/,k=[""],m={};return b={contains:function(b,e){return 0<=(" "+a.byId(b).className+" ").indexOf(" "+e+" ")},add:function(b,e){b=a.byId(b);e=d(e);var c=b.className,n,c=c?" "+c+" ":" ";n=c.length;for(var f=0,k=e.length,m;f<k;++f)(m=e[f])&&0>c.indexOf(" "+m+" ")&&(c+=m+" ");n<c.length&&(b.className=c.substr(1,c.length-2))},remove:function(b,e){b=a.byId(b);var c;
if(void 0!==e){e=d(e);c=" "+b.className+" ";for(var n=0,f=e.length;n<f;++n)c=c.replace(" "+e[n]+" "," ");c=h.trim(c)}else c="";b.className!=c&&(b.className=c)},replace:function(g,e,c){g=a.byId(g);m.className=g.className;b.remove(m,c);b.add(m,e);g.className!==m.className&&(g.className=m.className)},toggle:function(g,e,c){g=a.byId(g);if(void 0===c){e=d(e);for(var n=0,f=e.length,k;n<f;++n)k=e[n],b[b.contains(g,k)?"remove":"add"](g,k)}else b[c?"add":"remove"](g,e);return c}}})},"dojo/dom-geometry":function(){define(["./sniff",
"./_base/window","./dom","./dom-style"],function(h,l,a,d){function b(a,c,b,g,d,f){f=f||"px";a=a.style;isNaN(c)||(a.left=c+f);isNaN(b)||(a.top=b+f);0<=g&&(a.width=g+f);0<=d&&(a.height=d+f)}function f(a){return"button"==a.tagName.toLowerCase()||"input"==a.tagName.toLowerCase()&&"button"==(a.getAttribute("type")||"").toLowerCase()}function k(a){return"border-box"==m.boxModel||"table"==a.tagName.toLowerCase()||f(a)}var m={boxModel:"content-box"};h("ie")&&(m.boxModel="BackCompat"==document.compatMode?
"border-box":"content-box");m.getPadExtents=function(e,c){e=a.byId(e);var b=c||d.getComputedStyle(e),g=d.toPixelValue,f=g(e,b.paddingLeft),k=g(e,b.paddingTop),m=g(e,b.paddingRight),b=g(e,b.paddingBottom);return{l:f,t:k,r:m,b:b,w:f+m,h:k+b}};m.getBorderExtents=function(e,c){e=a.byId(e);var b=d.toPixelValue,g=c||d.getComputedStyle(e),f="none"!=g.borderLeftStyle?b(e,g.borderLeftWidth):0,k="none"!=g.borderTopStyle?b(e,g.borderTopWidth):0,m="none"!=g.borderRightStyle?b(e,g.borderRightWidth):0,b="none"!=
g.borderBottomStyle?b(e,g.borderBottomWidth):0;return{l:f,t:k,r:m,b:b,w:f+m,h:k+b}};m.getPadBorderExtents=function(e,c){e=a.byId(e);var b=c||d.getComputedStyle(e),g=m.getPadExtents(e,b),b=m.getBorderExtents(e,b);return{l:g.l+b.l,t:g.t+b.t,r:g.r+b.r,b:g.b+b.b,w:g.w+b.w,h:g.h+b.h}};m.getMarginExtents=function(e,c){e=a.byId(e);var b=c||d.getComputedStyle(e),g=d.toPixelValue,f=g(e,b.marginLeft),k=g(e,b.marginTop),m=g(e,b.marginRight),b=g(e,b.marginBottom);return{l:f,t:k,r:m,b:b,w:f+m,h:k+b}};m.getMarginBox=
function(e,c){e=a.byId(e);var b=c||d.getComputedStyle(e),g=m.getMarginExtents(e,b),f=e.offsetLeft-g.l,k=e.offsetTop-g.t,v=e.parentNode,t=d.toPixelValue;if(h("mozilla")){var w=parseFloat(b.left),b=parseFloat(b.top);isNaN(w)||isNaN(b)?v&&v.style&&(v=d.getComputedStyle(v),"visible"!=v.overflow&&(f+="none"!=v.borderLeftStyle?t(e,v.borderLeftWidth):0,k+="none"!=v.borderTopStyle?t(e,v.borderTopWidth):0)):(f=w,k=b)}else(h("opera")||8==h("ie")&&!h("quirks"))&&v&&(v=d.getComputedStyle(v),f-="none"!=v.borderLeftStyle?
t(e,v.borderLeftWidth):0,k-="none"!=v.borderTopStyle?t(e,v.borderTopWidth):0);return{l:f,t:k,w:e.offsetWidth+g.w,h:e.offsetHeight+g.h}};m.getContentBox=function(e,c){e=a.byId(e);var b=c||d.getComputedStyle(e),g=e.clientWidth,f=m.getPadExtents(e,b),k=m.getBorderExtents(e,b);g?(b=e.clientHeight,k.w=k.h=0):(g=e.offsetWidth,b=e.offsetHeight);h("opera")&&(f.l+=k.l,f.t+=k.t);return{l:f.l,t:f.t,w:g-f.w-k.w,h:b-f.h-k.h}};m.setContentSize=function(e,c,n){e=a.byId(e);var g=c.w;c=c.h;k(e)&&(n=m.getPadBorderExtents(e,
n),0<=g&&(g+=n.w),0<=c&&(c+=n.h));b(e,NaN,NaN,g,c)};var g={l:0,t:0,w:0,h:0};m.setMarginBox=function(e,c,n){e=a.byId(e);var q=n||d.getComputedStyle(e);n=c.w;var r=c.h,u=k(e)?g:m.getPadBorderExtents(e,q),q=m.getMarginExtents(e,q);if(h("webkit")&&f(e)){var v=e.style;0<=n&&!v.width&&(v.width="4px");0<=r&&!v.height&&(v.height="4px")}0<=n&&(n=Math.max(n-u.w-q.w,0));0<=r&&(r=Math.max(r-u.h-q.h,0));b(e,c.l,c.t,n,r)};m.isBodyLtr=function(a){a=a||l.doc;return"ltr"==(l.body(a).dir||a.documentElement.dir||"ltr").toLowerCase()};
m.docScroll=function(a){a=a||l.doc;var c=l.doc.parentWindow||l.doc.defaultView;return"pageXOffset"in c?{x:c.pageXOffset,y:c.pageYOffset}:(c=h("quirks")?l.body(a):a.documentElement)&&{x:m.fixIeBiDiScrollLeft(c.scrollLeft||0,a),y:c.scrollTop||0}};m.getIeDocumentElementOffset=function(a){return{x:0,y:0}};m.fixIeBiDiScrollLeft=function(a,c){c=c||l.doc;var b=h("ie");if(b&&!m.isBodyLtr(c)){var g=h("quirks"),d=g?l.body(c):c.documentElement,f=l.global;6==b&&!g&&f.frameElement&&d.scrollHeight>d.clientHeight&&
(a+=d.clientLeft);return 8>b||g?a+d.clientWidth-d.scrollWidth:-a}return a};m.position=function(e,c){e=a.byId(e);var b=l.body(e.ownerDocument),g=e.getBoundingClientRect(),g={x:g.left,y:g.top,w:g.right-g.left,h:g.bottom-g.top};9>h("ie")&&(g.x-=h("quirks")?b.clientLeft+b.offsetLeft:0,g.y-=h("quirks")?b.clientTop+b.offsetTop:0);c&&(b=m.docScroll(e.ownerDocument),g.x+=b.x,g.y+=b.y);return g};m.getMarginSize=function(e,c){e=a.byId(e);var b=m.getMarginExtents(e,c||d.getComputedStyle(e)),g=e.getBoundingClientRect();
return{w:g.right-g.left+b.w,h:g.bottom-g.top+b.h}};m.normalizeEvent=function(a){"layerX"in a||(a.layerX=a.offsetX,a.layerY=a.offsetY);if(!("pageX"in a)){var c=a.target,c=c&&c.ownerDocument||document,b=h("quirks")?c.body:c.documentElement;a.pageX=a.clientX+m.fixIeBiDiScrollLeft(b.scrollLeft||0,c);a.pageY=a.clientY+(b.scrollTop||0)}};return m})},"put-selector/put":function(){(function(h){var l,a=/[-+,> ]/;h([],l=function(d,b){function f(c){function b(){t&&v&&t!=v&&(v==c&&(q||(q=a.test(z)&&d.createDocumentFragment()))?
q:v).insertBefore(t,u||null)}for(var q,r,u,v,t,w=arguments,h=w[0],l=0;l<w.length;l++){var z=w[l];if("object"==typeof z){r=!1;if(z instanceof Array){t=d.createDocumentFragment();for(var A=0;A<z.length;A++)t.appendChild(f(z[A]));z=t}if(z.nodeType)t=z,b(),v=z,u=0;else for(A in z)t[A]=z[A]}else if(r)r=!1,t.appendChild(d.createTextNode(z));else{1>l&&(c=null);r=!0;if(h=z.replace(k,function(a,k,q,r,h,x){k&&(b(),"-"==k||"+"==k?(v=(u=t||v).parentNode,t=null,"+"==k&&(u=u.nextSibling)):("\x3c"==k?v=t=(t||v).parentNode:
(","==k?v=c:t&&(v=t),t=null),u=0),t&&(v=t));if((a=!q&&r)||!t&&(q||h))"$"==a?(a=w[++l],v.appendChild(d.createTextNode(a))):(a=a||f.defaultTag,(k=e&&w[l+1]&&w[l+1].name)&&(a="\x3c"+a+' name\x3d"'+k+'"\x3e'),t=g&&~(m=a.indexOf("|"))?d.createElementNS(g[a.slice(0,m)],a.slice(m+1)):d.createElement(a));if(q)if("$"==r&&(r=w[++l]),"#"==q)t.id=r;else if(k=(a=t.className)&&(" "+a+" ").replace(" "+r+" "," "),"."==q)t.className=a?(k+r).substring(1):r;else if("!"==z){var A;e?f("div",t,"\x3c").innerHTML="":(A=
t.parentNode)&&A.removeChild(t)}else k=k.substring(1,k.length-1),k!=a&&(t.className=k);h&&("$"==x&&(x=w[++l]),"style"==h?t.style.cssText=x:(q="!"==h.charAt(0)?(h=h.substring(1))&&"removeAttribute":"setAttribute",x=""===x?h:x,g&&~(m=h.indexOf("|"))?t[q+"NS"](g[h.slice(0,m)],h.slice(m+1),x):t[q](h,x)));return""}))throw new SyntaxError("Unexpected char "+h+" in "+z);b();v=h=t||v}}c&&q&&c.appendChild(q);return h}a=b||a;var k=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w\u00A0-\uFFFF%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,
m,g=!1;d=d||document;var e="object"==typeof d.createElement;f.addNamespace=function(a,e){d.createElementNS?(g||(g={}))[a]=e:d.namespaces.add(a,e)};f.defaultTag="div";f.forDocument=l;return f})})(function(h,l,a){a=a||l;"function"===typeof define?define([],function(){return a()}):"undefined"==typeof window?require("./node-html")(module,a):put=a()})},"dijit/layout/BorderContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/touch ../_WidgetBase ../_Widget ../_TemplatedMixin ./LayoutContainer ./utils".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v){var t=a("dijit.layout._Splitter",[q,r],{live:!0,templateString:'\x3cdiv class\x3d"dijitSplitter" data-dojo-attach-event\x3d"onkeydown:_onKeyDown,press:_startDrag,onmouseenter:_onMouse,onmouseleave:_onMouse" tabIndex\x3d"0" role\x3d"separator"\x3e\x3cdiv class\x3d"dijitSplitterThumb"\x3e\x3c/div\x3e\x3c/div\x3e',constructor:function(){this._handlers=[]},postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);
this._factor=/top|left/.test(this.region)?1:-1;this._cookieName=this.container.id+"_"+this.region},buildRendering:function(){this.inherited(arguments);d.add(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));if(this.container.persist){var a=l(this._cookieName);a&&(this.child.domNode.style[this.horizontal?"height":"width"]=a)}},_computeMaxSize:function(){var a=this.horizontal?"h":"w",c=f.getMarginBox(this.child.domNode)[a],e=h.filter(this.container.getChildren(),function(a){return"center"==a.region})[0],
a=f.getContentBox(e.domNode)[a]-10;return Math.min(this.child.maxSize,c+a)},_startDrag:function(a){this.cover||(this.cover=b.place("\x3cdiv class\x3ddijitSplitterCover\x3e\x3c/div\x3e",this.child.domNode,"after"));d.add(this.cover,"dijitSplitterCoverActive");this.fake&&b.destroy(this.fake);(this._resize=this.live)||((this.fake=this.domNode.cloneNode(!0)).removeAttribute("id"),d.add(this.domNode,"dijitSplitterShadow"),b.place(this.fake,this.domNode,"after"));d.add(this.domNode,"dijitSplitterActive dijitSplitter"+
(this.horizontal?"H":"V")+"Active");this.fake&&d.remove(this.fake,"dijitSplitterHover dijitSplitter"+(this.horizontal?"H":"V")+"Hover");var n=this._factor,t=this.horizontal,m=t?"pageY":"pageX",u=a[m],q=this.domNode.style,t=t?"h":"w",r=k.getComputedStyle(this.child.domNode),v=f.getMarginBox(this.child.domNode,r)[t],w=this._computeMaxSize(),h=Math.max(this.child.minSize,f.getPadBorderExtents(this.child.domNode,r)[t]+10),t=this.region,l="top"==t||"bottom"==t?"top":"left",K=parseInt(q[l],10),J=this._resize,
I=g.hitch(this.container,"_layoutChildren",this.child.id),t=this.ownerDocument;this._handlers=this._handlers.concat([e(t,c.move,this._drag=function(a,c){var e=a[m]-u,b=n*e+v,g=Math.max(Math.min(b,w),h);(J||c)&&I(g);q[l]=e+K+n*(g-b)+"px"}),e(t,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),e(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();a.preventDefault()}),e(t,c.release,g.hitch(this,"_stopDrag"))]);a.stopPropagation();a.preventDefault()},_onMouse:function(a){a=
"mouseover"==a.type||"mouseenter"==a.type;d.toggle(this.domNode,"dijitSplitterHover",a);d.toggle(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V")+"Hover",a)},_stopDrag:function(a){try{this.cover&&d.remove(this.cover,"dijitSplitterCoverActive"),this.fake&&b.destroy(this.fake),d.remove(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active dijitSplitterShadow"),this._drag(a),this._drag(a,!0)}finally{this._cleanupHandlers(),delete this._drag}this.container.persist&&
l(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365})},_cleanupHandlers:function(){for(var a;a=this._handlers.pop();)a.remove()},_onKeyDown:function(a){this._resize=!0;var c=this.horizontal,e=1;switch(a.keyCode){case c?m.UP_ARROW:m.LEFT_ARROW:e*=-1;case c?m.DOWN_ARROW:m.RIGHT_ARROW:break;default:return}c=f.getMarginSize(this.child.domNode)[c?"h":"w"]+this._factor*e;this.container._layoutChildren(this.child.id,Math.max(Math.min(c,this._computeMaxSize()),this.child.minSize));
a.stopPropagation();a.preventDefault()},destroy:function(){this._cleanupHandlers();delete this.child;delete this.container;delete this.cover;delete this.fake;this.inherited(arguments)}}),w=a("dijit.layout._Gutter",[q,r],{templateString:'\x3cdiv class\x3d"dijitGutter" role\x3d"presentation"\x3e\x3c/div\x3e',postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region)},buildRendering:function(){this.inherited(arguments);d.add(this.domNode,"dijitGutter"+(this.horizontal?
"H":"V"))}});a=a("dijit.layout.BorderContainer",u,{gutters:!0,liveSplitters:!0,persist:!1,baseClass:"dijitBorderContainer",_splitterClass:t,postMixInProperties:function(){this.gutters||(this.baseClass+="NoGutter");this.inherited(arguments)},_setupChild:function(a){this.inherited(arguments);var c=a.region,e=a.isLeftToRight();"leading"==c&&(c=e?"left":"right");"trailing"==c&&(c=e?"right":"left");c&&"center"!=c&&(a.splitter||this.gutters)&&!a._splitterWidget&&(e=a.splitter?this._splitterClass:w,g.isString(e)&&
(e=g.getObject(e)),e=new e({id:a.id+"_splitter",container:this,child:a,region:c,live:this.liveSplitters}),e.isSplitter=!0,a._splitterWidget=e,c="bottom"==c||c==(this.isLeftToRight()?"right":"left"),b.place(e.domNode,a.domNode,c?"before":"after"),e.startup())},layout:function(){this._layoutChildren()},removeChild:function(a){var c=a._splitterWidget;c&&(c.destroy(),delete a._splitterWidget);this.inherited(arguments)},getChildren:function(){return h.filter(this.inherited(arguments),function(a){return!a.isSplitter})},
getSplitter:function(a){return h.filter(this.getChildren(),function(c){return c.region==a})[0]._splitterWidget},resize:function(a,c){if(!this.cs||!this.pe){var e=this.domNode;this.cs=k.getComputedStyle(e);this.pe=f.getPadExtents(e,this.cs);this.pe.r=k.toPixelValue(e,this.cs.paddingRight);this.pe.b=k.toPixelValue(e,this.cs.paddingBottom);k.set(e,"padding","0px")}this.inherited(arguments)},_layoutChildren:function(a,c){if(this._borderBox&&this._borderBox.h){var e=[];h.forEach(this._getOrderedChildren(),
function(a){e.push(a);a._splitterWidget&&e.push(a._splitterWidget)});v.layoutChildren(this.domNode,{l:this.pe.l,t:this.pe.t,w:this._borderBox.w-this.pe.w,h:this._borderBox.h-this.pe.h},e,a,c)}},destroyRecursive:function(){h.forEach(this.getChildren(),function(a){var c=a._splitterWidget;c&&c.destroy();delete a._splitterWidget});this.inherited(arguments)}});a.ChildWidgetProperties={splitter:!1,minSize:0,maxSize:Infinity};g.mixin(a.ChildWidgetProperties,u.ChildWidgetProperties);g.extend(n,a.ChildWidgetProperties);
a._Splitter=t;a._Gutter=w;return a})},"dojo/cookie":function(){define(["./_base/kernel","./regexp"],function(h,l){h.cookie=function(a,d,b){var f=document.cookie,k;if(1==arguments.length)k=(k=f.match(new RegExp("(?:^|; )"+l.escapeString(a)+"\x3d([^;]*)")))?decodeURIComponent(k[1]):void 0;else{b=b||{};f=b.expires;if("number"==typeof f){var m=new Date;m.setTime(m.getTime()+864E5*f);f=b.expires=m}f&&f.toUTCString&&(b.expires=f.toUTCString());d=encodeURIComponent(d);var f=a+"\x3d"+d,g;for(g in b)f+="; "+
g,m=b[g],!0!==m&&(f+="\x3d"+m);document.cookie=f}return k};h.cookie.isSupported=function(){"cookieEnabled"in navigator||(this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled="CookiesAllowed"==this("__djCookieTest__"),navigator.cookieEnabled&&this("__djCookieTest__","",{expires:-1}));return navigator.cookieEnabled};return h.cookie})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(h,l){var a={};l.setObject("dojo.regexp",a);a.escapeString=function(a,b){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,
function(a){return b&&-1!=b.indexOf(a)?a:"\\"+a})};a.buildGroupRE=function(d,b,f){if(!(d instanceof Array))return b(d);for(var k=[],m=0;m<d.length;m++)k.push(b(d[m]));return a.group(k.join("|"),f)};a.group=function(a,b){return"("+(b?"?:":"")+a+")"};return a})},"dojo/dom-construct":function(){define("exports ./_base/kernel ./sniff ./_base/window ./dom ./dom-attr".split(" "),function(h,l,a,d,b,f){function k(a,c){var e=c.parentNode;e&&e.insertBefore(a,c)}function m(a){if("innerHTML"in a)try{a.innerHTML=
"";return}catch(c){}for(var e;e=a.lastChild;)a.removeChild(e)}var g={option:["select"],tbody:["table"],thead:["table"],tfoot:["table"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","thead","tr"],legend:["fieldset"],caption:["table"],colgroup:["table"],col:["table","colgroup"],li:["ul"]},e=/<\s*([\w\:]+)/,c={},n=0,q="__"+l._scopeName+"ToDomId",r;for(r in g)g.hasOwnProperty(r)&&(l=g[r],l.pre="option"==r?'\x3cselect multiple\x3d"multiple"\x3e':"\x3c"+l.join("\x3e\x3c")+"\x3e",l.post="\x3c/"+
l.reverse().join("\x3e\x3c/")+"\x3e");var u;8>=a("ie")&&(u=function(a){a.__dojo_html5_tested="yes";var c=v("div",{innerHTML:"\x3cnav\x3ea\x3c/nav\x3e",style:{visibility:"hidden"}},a.body);1!==c.childNodes.length&&"abbr article aside audio canvas details figcaption figure footer header hgroup mark meter nav output progress section summary time video".replace(/\b\w+\b/g,function(c){a.createElement(c)});t(c)});h.toDom=function(b,f){f=f||d.doc;var k=f[q];k||(f[q]=k=++n+"",c[k]=f.createElement("div"));
8>=a("ie")&&!f.__dojo_html5_tested&&f.body&&u(f);b+="";var t=b.match(e),m=t?t[1].toLowerCase():"",k=c[k];if(t&&g[m])for(t=g[m],k.innerHTML=t.pre+b+t.post,t=t.length;t;--t)k=k.firstChild;else k.innerHTML=b;if(1==k.childNodes.length)return k.removeChild(k.firstChild);for(m=f.createDocumentFragment();t=k.firstChild;)m.appendChild(t);return m};h.place=function(a,c,e){c=b.byId(c);"string"==typeof a&&(a=/^\s*</.test(a)?h.toDom(a,c.ownerDocument):b.byId(a));if("number"==typeof e){var g=c.childNodes;!g.length||
g.length<=e?c.appendChild(a):k(a,g[0>e?0:e])}else switch(e){case "before":k(a,c);break;case "after":e=a;(g=c.parentNode)&&(g.lastChild==c?g.appendChild(e):g.insertBefore(e,c.nextSibling));break;case "replace":c.parentNode.replaceChild(a,c);break;case "only":h.empty(c);c.appendChild(a);break;case "first":if(c.firstChild){k(a,c.firstChild);break}default:c.appendChild(a)}return a};var v=h.create=function(a,c,e,g){var n=d.doc;e&&(e=b.byId(e),n=e.ownerDocument);"string"==typeof a&&(a=n.createElement(a));
c&&f.set(a,c);e&&h.place(a,e,g);return a};h.empty=function(a){m(b.byId(a))};var t=h.destroy=function(c){if(c=b.byId(c)){var e=c;c=c.parentNode;e.firstChild&&m(e);c&&(a("ie")&&c.canHaveChildren&&"removeNode"in e?e.removeNode(!1):c.removeChild(e))}}})},"dojo/dom-attr":function(){define("exports ./sniff ./_base/lang ./dom ./dom-style ./dom-prop".split(" "),function(h,l,a,d,b,f){function k(a,c){var b=a.getAttributeNode&&a.getAttributeNode(c);return!!b&&b.specified}var m={innerHTML:1,textContent:1,className:1,
htmlFor:l("ie"),value:1},g={classname:"class",htmlfor:"for",tabindex:"tabIndex",readonly:"readOnly"};h.has=function(a,c){var b=c.toLowerCase();return m[f.names[b]||c]||k(d.byId(a),g[b]||c)};h.get=function(e,c){e=d.byId(e);var b=c.toLowerCase(),q=f.names[b]||c,r=e[q];if(m[q]&&"undefined"!=typeof r)return r;if("textContent"==q)return f.get(e,q);if("href"!=q&&("boolean"==typeof r||a.isFunction(r)))return r;b=g[b]||c;return k(e,b)?e.getAttribute(b):null};h.set=function(e,c,n){e=d.byId(e);if(2==arguments.length){for(var k in c)h.set(e,
k,c[k]);return e}k=c.toLowerCase();var r=f.names[k]||c,u=m[r];if("style"==r&&"string"!=typeof n)return b.set(e,n),e;if(u||"boolean"==typeof n||a.isFunction(n))return f.set(e,c,n);e.setAttribute(g[k]||c,n);return e};h.remove=function(a,c){d.byId(a).removeAttribute(g[c.toLowerCase()]||c)};h.getNodeProp=function(a,c){a=d.byId(a);var b=c.toLowerCase(),m=f.names[b]||c;if(m in a&&"href"!=m)return a[m];b=g[b]||c;return k(a,b)?a.getAttribute(b):null}})},"dojo/dom-prop":function(){define("exports ./_base/kernel ./sniff ./_base/lang ./dom ./dom-style ./dom-construct ./_base/connect".split(" "),
function(h,l,a,d,b,f,k,m){function g(a){var c="";a=a.childNodes;for(var e=0,b;b=a[e];e++)8!=b.nodeType&&(c=1==b.nodeType?c+g(b):c+b.nodeValue);return c}var e={},c=1,n=l._scopeName+"attrid";a.add("dom-textContent",function(a,c,e){return"textContent"in e});h.names={"class":"className","for":"htmlFor",tabindex:"tabIndex",readonly:"readOnly",colspan:"colSpan",frameborder:"frameBorder",rowspan:"rowSpan",textcontent:"textContent",valuetype:"valueType"};h.get=function(c,e){c=b.byId(c);var n=e.toLowerCase(),
n=h.names[n]||e;return"textContent"!=n||a("dom-textContent")?c[n]:g(c)};h.set=function(g,r,u){g=b.byId(g);if(2==arguments.length&&"string"!=typeof r){for(var v in r)h.set(g,v,r[v]);return g}v=r.toLowerCase();v=h.names[v]||r;if("style"==v&&"string"!=typeof u)return f.set(g,u),g;if("innerHTML"==v)return a("ie")&&g.tagName.toLowerCase()in{col:1,colgroup:1,table:1,tbody:1,tfoot:1,thead:1,tr:1,title:1}?(k.empty(g),g.appendChild(k.toDom(u,g.ownerDocument))):g[v]=u,g;if("textContent"==v&&!a("dom-textContent"))return k.empty(g),
g.appendChild(g.ownerDocument.createTextNode(u)),g;if(d.isFunction(u)){var t=g[n];t||(t=c++,g[n]=t);e[t]||(e[t]={});var w=e[t][v];if(w)m.disconnect(w);else try{delete g[v]}catch(x){}u?e[t][v]=m.connect(g,v,u):g[v]=null;return g}g[v]=u;return g}})},"dojo/_base/connect":function(){define("./kernel ../on ../topic ../aspect ./event ../mouse ./sniff ./lang ../keys".split(" "),function(h,l,a,d,b,f,k,m){function g(a,c,e,b,g){b=m.hitch(e,b);if(!a||!a.addEventListener&&!a.attachEvent)return d.after(a||h.global,
c,b,!0);"string"==typeof c&&"on"==c.substring(0,2)&&(c=c.substring(2));a||(a=h.global);if(!g)switch(c){case "keypress":c=r;break;case "mouseenter":c=f.enter;break;case "mouseleave":c=f.leave}return l(a,c,b,g)}function e(a){a.keyChar=a.charCode?String.fromCharCode(a.charCode):"";a.charOrCode=a.keyChar||a.keyCode}k.add("events-keypress-typed",function(){var a={charCode:0};try{a=document.createEvent("KeyboardEvent"),(a.initKeyboardEvent||a.initKeyEvent).call(a,"keypress",!0,!0,null,!1,!1,!1,!1,9,3)}catch(c){}return 0==
a.charCode&&!k("opera")});var c={106:42,111:47,186:59,187:43,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39,229:113},n=k("mac")?"metaKey":"ctrlKey",q=function(a,c){var b=m.mixin({},a,c);e(b);b.preventDefault=function(){a.preventDefault()};b.stopPropagation=function(){a.stopPropagation()};return b},r;r=k("events-keypress-typed")?function(a,e){var b=l(a,"keydown",function(a){var b=a.keyCode,g=13!=b&&32!=b&&(27!=b||!k("ie"))&&(48>b||90<b)&&(96>b||111<b)&&(186>b||192<b)&&(219>b||222<b)&&
229!=b;if(g||a.ctrlKey){g=g?0:b;if(a.ctrlKey){if(3==b||13==b)return e.call(a.currentTarget,a);g=95<g&&106>g?g-48:!a.shiftKey&&65<=g&&90>=g?g+32:c[g]||g}b=q(a,{type:"keypress",faux:!0,charCode:g});e.call(a.currentTarget,b);if(k("ie"))try{a.keyCode=b.keyCode}catch(n){}}}),g=l(a,"keypress",function(a){var c=a.charCode;a=q(a,{charCode:32<=c?c:0,faux:!0});return e.call(this,a)});return{remove:function(){b.remove();g.remove()}}}:k("opera")?function(a,c){return l(a,"keypress",function(a){var e=a.which;3==
e&&(e=99);e=32>e&&!a.shiftKey?0:e;a.ctrlKey&&!a.shiftKey&&65<=e&&90>=e&&(e+=32);return c.call(this,q(a,{charCode:e}))})}:function(a,c){return l(a,"keypress",function(a){e(a);return c.call(this,a)})};var u={_keypress:r,connect:function(a,c,e,b,n){var d=arguments,f=[],k=0;f.push("string"==typeof d[0]?null:d[k++],d[k++]);var m=d[k+1];f.push("string"==typeof m||"function"==typeof m?d[k++]:null,d[k++]);for(m=d.length;k<m;k++)f.push(d[k]);return g.apply(this,f)},disconnect:function(a){a&&a.remove()},subscribe:function(c,
e,b){return a.subscribe(c,m.hitch(e,b))},publish:function(c,e){return a.publish.apply(a,[c].concat(e))},connectPublisher:function(a,c,e){var b=function(){u.publish(a,arguments)};return e?u.connect(c,e,b):u.connect(c,b)},isCopyKey:function(a){return a[n]}};u.unsubscribe=u.disconnect;m.mixin(h,u);return u})},"dojo/_base/event":function(){define(["./kernel","../on","../has","../dom-geometry"],function(h,l,a,d){if(l._fixEvent){var b=l._fixEvent;l._fixEvent=function(a,f){(a=b(a,f))&&d.normalizeEvent(a);
return a}}var f={fix:function(a,b){return l._fixEvent?l._fixEvent(a,b):a},stop:function(b){a("dom-addeventlistener")||b&&b.preventDefault?(b.preventDefault(),b.stopPropagation()):(b=b||window.event,b.cancelBubble=!0,l._preventDefault.call(b))}};h.fixEvent=f.fix;h.stopEvent=f.stop;return f})},"dojo/mouse":function(){define(["./_base/kernel","./on","./has","./dom","./_base/window"],function(h,l,a,d,b){function f(a,b){var g=function(e,c){return l(e,a,function(a){if(b)return b(a,c);if(!d.isDescendant(a.relatedTarget,
e))return c.call(this,a)})};g.bubble=function(e){return f(a,function(a,b){var g=e(a.target),d=a.relatedTarget;if(g&&g!=(d&&1==d.nodeType&&e(d)))return b.call(g,a)})};return g}a.add("dom-quirks",b.doc&&"BackCompat"==b.doc.compatMode);a.add("events-mouseenter",b.doc&&"onmouseenter"in b.doc.createElement("div"));a.add("events-mousewheel",b.doc&&"onmousewheel"in b.doc);b=a("dom-quirks")&&a("ie")||!a("dom-addeventlistener")?{LEFT:1,MIDDLE:4,RIGHT:2,isButton:function(a,b){return a.button&b},isLeft:function(a){return a.button&
1},isMiddle:function(a){return a.button&4},isRight:function(a){return a.button&2}}:{LEFT:0,MIDDLE:1,RIGHT:2,isButton:function(a,b){return a.button==b},isLeft:function(a){return 0==a.button},isMiddle:function(a){return 1==a.button},isRight:function(a){return 2==a.button}};h.mouseButtons=b;h=a("events-mousewheel")?"mousewheel":function(a,b){return l(a,"DOMMouseScroll",function(a){a.wheelDelta=-a.detail;b.call(this,a)})};return{_eventHandler:f,enter:f("mouseover"),leave:f("mouseout"),wheel:h,isLeft:b.isLeft,
isMiddle:b.isMiddle,isRight:b.isRight}})},"dojo/_base/sniff":function(){define(["./kernel","./lang","../sniff"],function(h,l,a){h._name="browser";l.mixin(h,{isBrowser:!0,isFF:a("ff"),isIE:a("ie"),isKhtml:a("khtml"),isWebKit:a("webkit"),isMozilla:a("mozilla"),isMoz:a("mozilla"),isOpera:a("opera"),isSafari:a("safari"),isChrome:a("chrome"),isMac:a("mac"),isIos:a("ios"),isAndroid:a("android"),isWii:a("wii"),isQuirks:a("quirks"),isAir:a("air")});return a})},"dojo/keys":function(){define(["./_base/kernel",
"./sniff"],function(h,l){return h.keys={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:l("webkit")?91:224,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,
NUMPAD_MINUS:109,NUMPAD_PERIOD:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,NUM_LOCK:144,SCROLL_LOCK:145,UP_DPAD:175,DOWN_DPAD:176,LEFT_DPAD:177,RIGHT_DPAD:178,copyKey:l("mac")&&!l("air")?l("safari")?91:224:17}})},"dojo/touch":function(){define("./_base/kernel ./aspect ./dom ./dom-class ./_base/lang ./on ./has ./mouse ./domReady ./_base/window".split(" "),function(h,l,a,d,b,f,k,m,g,e){function c(a,c,e){return u&&
e?function(a,c){return f(a,e,c)}:t?function(e,b){var g=f(e,c,function(a){b.call(this,a);F=(new Date).getTime()}),n=f(e,a,function(a){(!F||(new Date).getTime()>F+1E3)&&b.call(this,a)});return{remove:function(){g.remove();n.remove()}}}:function(c,e){return f(c,a,e)}}function n(a){do if(void 0!==a.dojoClick)return a;while(a=a.parentNode)}function q(c,b,g){if(!m.isRight(c)){var k=n(c.target);if(x=!c.target.disabled&&k&&k.dojoClick)if(z=(y="useTarget"==x)?k:c.target,y&&c.preventDefault(),A=c.changedTouches?
c.changedTouches[0].pageX-e.global.pageXOffset:c.clientX,B=c.changedTouches?c.changedTouches[0].pageY-e.global.pageYOffset:c.clientY,C=("object"==typeof x?x.x:"number"==typeof x?x:0)||4,D=("object"==typeof x?x.y:"number"==typeof x?x:0)||4,!w){c=function(a){e.doc.addEventListener(a,function(c){var e=c.target;x&&!c._dojo_click&&(new Date).getTime()<=E+1E3&&("INPUT"!=e.tagName||!d.contains(e,"dijitOffScreen"))&&(c.stopPropagation(),c.stopImmediatePropagation&&c.stopImmediatePropagation(),"click"==a&&
("INPUT"!=e.tagName||"radio"==e.type&&(d.contains(e,"dijitCheckBoxInput")||d.contains(e,"mblRadioButton"))||"checkbox"==e.type&&(d.contains(e,"dijitCheckBoxInput")||d.contains(e,"mblCheckBox")))&&"TEXTAREA"!=e.tagName&&"AUDIO"!=e.tagName&&"VIDEO"!=e.tagName&&c.preventDefault())},!0)};var t=function(c){x=y?a.isDescendant(e.doc.elementFromPoint(c.changedTouches?c.changedTouches[0].pageX-e.global.pageXOffset:c.clientX,c.changedTouches?c.changedTouches[0].pageY-e.global.pageYOffset:c.clientY),z):x&&(c.changedTouches?
c.changedTouches[0].target:c.target)==z&&Math.abs((c.changedTouches?c.changedTouches[0].pageX-e.global.pageXOffset:c.clientX)-A)<=C&&Math.abs((c.changedTouches?c.changedTouches[0].pageY-e.global.pageYOffset:c.clientY)-B)<=D};w=!0;e.doc.addEventListener(b,function(a){m.isRight(a)||(t(a),y&&a.preventDefault())},!0);e.doc.addEventListener(g,function(c){if(!m.isRight(c)&&(t(c),x)){var e=function(a){var e=document.createEvent("MouseEvents");e._dojo_click=!0;e.initMouseEvent(a,!0,!0,c.view,c.detail,g.screenX,
g.screenY,g.clientX,g.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,0,null);return e};E=(new Date).getTime();var b=y?z:c.target;"LABEL"===b.tagName&&(b=a.byId(b.getAttribute("for"))||b);var g=c.changedTouches?c.changedTouches[0]:c,n=e("mousedown"),d=e("mouseup"),k=e("click");setTimeout(function(){f.emit(b,"mousedown",n);f.emit(b,"mouseup",d);f.emit(b,"click",k);E=(new Date).getTime()},0)}},!0);c("click");c("mousedown");c("mouseup")}}}var r=5>k("ios"),u=k("pointer-events")||k("MSPointer"),v=function(){var a=
{},c;for(c in{down:1,move:1,up:1,cancel:1,over:1,out:1})a[c]=k("MSPointer")?"MSPointer"+c.charAt(0).toUpperCase()+c.slice(1):"pointer"+c;return a}(),t=k("touch-events"),w,x,y=!1,z,A,B,C,D,E,F,H;k("touch")&&(u?g(function(){e.doc.addEventListener(v.down,function(a){q(a,v.move,v.up)},!0)}):g(function(){function a(c){var e=b.delegate(c,{bubbles:!0});6<=k("ios")&&(e.touches=c.touches,e.altKey=c.altKey,e.changedTouches=c.changedTouches,e.ctrlKey=c.ctrlKey,e.metaKey=c.metaKey,e.shiftKey=c.shiftKey,e.targetTouches=
c.targetTouches);return e}H=e.body();e.doc.addEventListener("touchstart",function(a){F=(new Date).getTime();var c=H;H=a.target;f.emit(c,"dojotouchout",{relatedTarget:H,bubbles:!0});f.emit(H,"dojotouchover",{relatedTarget:c,bubbles:!0});q(a,"touchmove","touchend")},!0);f(e.doc,"touchmove",function(c){F=(new Date).getTime();var b=e.doc.elementFromPoint(c.pageX-(r?0:e.global.pageXOffset),c.pageY-(r?0:e.global.pageYOffset));b&&(H!==b&&(f.emit(H,"dojotouchout",{relatedTarget:b,bubbles:!0}),f.emit(b,"dojotouchover",
{relatedTarget:H,bubbles:!0}),H=b),f.emit(b,"dojotouchmove",a(c))||c.preventDefault())});f(e.doc,"touchend",function(c){F=(new Date).getTime();var b=e.doc.elementFromPoint(c.pageX-(r?0:e.global.pageXOffset),c.pageY-(r?0:e.global.pageYOffset))||e.body();f.emit(b,"dojotouchend",a(c))})}));l={press:c("mousedown","touchstart",v.down),move:c("mousemove","dojotouchmove",v.move),release:c("mouseup","dojotouchend",v.up),cancel:c(m.leave,"touchcancel",u?v.cancel:null),over:c("mouseover","dojotouchover",v.over),
out:c("mouseout","dojotouchout",v.out),enter:m._eventHandler(c("mouseover","dojotouchover",v.over)),leave:m._eventHandler(c("mouseout","dojotouchout",v.out))};return h.touch=l})},"dojo/domReady":function(){define(["./has"],function(h){function l(c){g.push(c);m&&a()}function a(){if(!e){for(e=!0;g.length;)try{g.shift()(b)}catch(a){console.error(a,"in domReady callback",a.stack)}e=!1;l._onQEmpty()}}var d=function(){return this}(),b=document,f={loaded:1,complete:1},k="string"!=typeof b.readyState,m=!!f[b.readyState],
g=[],e;l.load=function(a,c,e){l(e)};l._Q=g;l._onQEmpty=function(){};k&&(b.readyState="loading");if(!m){var c=[],n=function(c){c=c||d.event;m||"readystatechange"==c.type&&!f[b.readyState]||(k&&(b.readyState="complete"),m=1,a())},q=function(a,c){a.addEventListener(c,n,!1);g.push(function(){a.removeEventListener(c,n,!1)})};if(!h("dom-addeventlistener")){var q=function(a,c){c="on"+c;a.attachEvent(c,n);g.push(function(){a.detachEvent(c,n)})},r=b.createElement("div");try{r.doScroll&&null===d.frameElement&&
c.push(function(){try{return r.doScroll("left"),1}catch(a){}})}catch(u){}}q(b,"DOMContentLoaded");q(d,"load");"onreadystatechange"in b?q(b,"readystatechange"):k||c.push(function(){return f[b.readyState]});if(c.length){var v=function(){if(!m){for(var a=c.length;a--;)if(c[a]()){n("poller");return}setTimeout(v,30)}};v()}}return l})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B){function C(a){return function(c){m[c?"set":"remove"](this.domNode,a,c);this._set(a,c)}}q.add("dijit-legacy-requires",!r.isAsync);q.add("dojo-bidi",!1);q("dijit-legacy-requires")&&t(0,function(){h(["dijit/_base/manager"])});var D={};d=f("dijit._WidgetBase",[w,z],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:C("lang"),dir:"",_setDirAttr:C("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",a)},attributeMap:{},_blankGif:d.blankGif||h.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var c=a.prototype,e=a._setterAttrs=[],a=a._onMap={},b;for(b in c.attributeMap)e.push(b);for(b in c)/^on/.test(b)&&(a[b.substring(2).toLowerCase()]=b),/^_set[A-Z](.*)Attr$/.test(b)&&(b=b.charAt(4).toLowerCase()+
b.substr(5,b.length-9),c.attributeMap&&b in c.attributeMap||e.push(b))}},postscript:function(a,c){this.create(a,c)},create:function(a,c){this._introspect();this.srcNodeRef=k.byId(c);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&this.srcNodeRef.id&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);a&&(this.params=a,u.mixin(this,a));this.postMixInProperties();this.id||(this.id=B.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=
this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=y.body(this.ownerDocument);B.add(this);this.buildRendering();var e;if(this.domNode){this._applyAttributes();var b=this.srcNodeRef;b&&b.parentNode&&this.domNode!==b&&(b.parentNode.replaceChild(this.domNode,b),e=!0);this.domNode.setAttribute("widgetId",this.id)}this.postCreate();e&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},c;for(c in this.params||{})a[c]=this._get(c);
l.forEach(this.constructor._setterAttrs,function(c){if(!(c in a)){var e=this._get(c);e&&this.set(c,e)}},this);for(c in a)this.set(c,a[c])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var a=this.baseClass.split(" ");this.isLeftToRight()||(a=a.concat(l.map(a,function(a){return a+"Rtl"})));g.add(this.domNode,a)}},postCreate:function(){},startup:function(){this._started||(this._started=
!0,l.forEach(this.getChildren(),function(a){a._started||a._destroyed||!u.isFunction(a.startup)||(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function c(e){e.destroyRecursive?e.destroyRecursive(a):e.destroy&&e.destroy(a)}this._beingDestroyed=!0;this.uninitialize();l.forEach(this._connects,u.hitch(this,"disconnect"));l.forEach(this._supportingWidgets,c);this.domNode&&l.forEach(B.findWidgets(this.domNode,
this.containerNode),c);this.destroyRendering(a);B.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);this.domNode&&(a?m.remove(this.domNode,"widgetId"):e.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||e.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){l.forEach(this.getChildren(),function(c){c.destroyRecursive&&c.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(a){var c=
this.domNode;u.isObject(a)?n.set(c,a):c.style.cssText=c.style.cssText?c.style.cssText+("; "+a):a;this._set("style",a)},_attrToDom:function(a,c,e){e=3<=arguments.length?e:this.attributeMap[a];l.forEach(u.isArray(e)?e:[e],function(e){var b=this[e.node||e||"domNode"];switch(e.type||"attribute"){case "attribute":u.isFunction(c)&&(c=u.hitch(this,c));e=e.attribute?e.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;b.tagName?m.set(b,e,c):b.set(e,c);break;case "innerText":b.innerHTML="";b.appendChild(this.ownerDocument.createTextNode(c));
break;case "innerHTML":b.innerHTML=c;break;case "class":g.replace(b,c,this[a]);break;case "toggleClass":g.toggle(b,e.className||a,c)}},this)},get:function(a){var c=this._getAttrNames(a);return this[c.g]?this[c.g]():this._get(a)},set:function(a,c){if("object"===typeof a){for(var e in a)this.set(e,a[e]);return this}e=this._getAttrNames(a);var b=this[e.s];if(u.isFunction(b))var g=b.apply(this,Array.prototype.slice.call(arguments,1));else{var b=this.focusNode&&!u.isFunction(this.focusNode)?"focusNode":
"domNode",n=this[b]&&this[b].tagName,d;if((d=n)&&!(d=D[n])){d=this[b];var f={},k;for(k in d)f[k.toLowerCase()]=!0;d=D[n]=f}k=d;e=a in this.attributeMap?this.attributeMap[a]:e.s in this?this[e.s]:k&&e.l in k&&"function"!=typeof c||/^aria-|^data-|^role$/.test(a)?b:null;null!=e&&this._attrToDom(a,c,e);this._set(a,c)}return g||this},_attrPairNames:{},_getAttrNames:function(a){var c=this._attrPairNames;if(c[a])return c[a];var e=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});
return c[a]={n:a+"Node",s:"_set"+e+"Attr",g:"_get"+e+"Attr",l:e.toLowerCase()}},_set:function(a,c){var e=this[a];this[a]=c;!this._created||e===c||e!==e&&c!==c||(this._watchCallbacks&&this._watchCallbacks(a,e,c),this.emit("attrmodified-"+a,{detail:{prevValue:e,newValue:c}}))},_get:function(a){return this[a]},emit:function(a,c,e){c=c||{};void 0===c.bubbles&&(c.bubbles=!0);void 0===c.cancelable&&(c.cancelable=!0);c.detail||(c.detail={});c.detail.widget=this;var b,g=this["on"+a];g&&(b=g.apply(this,e?
e:[c]));this._started&&!this._beingDestroyed&&v.emit(this.domNode,a.toLowerCase(),c);return b},on:function(c,e){var b=this._onMap(c);return b?a.after(this,b,e,!0):this.own(v(this.domNode,c,e))[0]},_onMap:function(a){var c=this.constructor,e=c._onMap;if(!e){var e=c._onMap={},b;for(b in c.prototype)/^on/.test(b)&&(e[b.replace(/^on/,"").toLowerCase()]=b)}return e["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?
B.findWidgets(this.containerNode):[]},getParent:function(){return B.getEnclosingWidget(this.domNode.parentNode)},connect:function(a,c,e){return this.own(b.connect(a,c,this,e))[0]},disconnect:function(a){a.remove()},subscribe:function(a,c){return this.own(x.subscribe(a,u.hitch(this,c)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():c.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=n.get(this.domNode,"display")},
placeAt:function(a,c){var b=!a.tagName&&B.byId(a);!b||!b.addChild||c&&"number"!==typeof c?(b=b&&"domNode"in b?b.containerNode&&!/after|before|replace/.test(c||"")?b.containerNode:b.domNode:k.byId(a,this.ownerDocument),e.place(this.domNode,b,c),!this._started&&(this.getParent()||{})._started&&this.startup()):b.addChild(this,c);return this},defer:function(a,c){var e=setTimeout(u.hitch(this,function(){e&&(e=null,this._destroyed||u.hitch(this,a)())}),c||0);return{remove:function(){e&&(clearTimeout(e),
e=null);return null}}}});q("dojo-bidi")&&d.extend(A);return d})},"dojo/ready":function(){define(["./_base/kernel","./has","require","./domReady","./_base/lang"],function(h,l,a,d,b){var f=0,k=[],m=0;l=function(){f=1;h._postLoad=h.config.afterOnLoad=!0;g()};var g=function(){if(!m){for(m=1;f&&(!d||0==d._Q.length)&&(a.idle?a.idle():1)&&k.length;){var c=k.shift();try{c()}catch(e){if(e.info=e.message,a.signal)a.signal("error",e);else throw e;}}m=0}};a.on&&a.on("idle",g);d&&(d._onQEmpty=g);var e=h.ready=
h.addOnLoad=function(a,c,e){var d=b._toArray(arguments);"number"!=typeof a?(e=c,c=a,a=1E3):d.shift();e=e?b.hitch.apply(h,d):function(){c()};e.priority=a;for(d=0;d<k.length&&a>=k[d].priority;d++);k.splice(d,0,e);g()},c=h.config.addOnLoad;if(c)e[b.isArray(c)?"apply":"call"](h,c);d?d(l):l();return e})},"dojo/Stateful":function(){define(["./_base/declare","./_base/lang","./_base/array","./when"],function(h,l,a,d){return h("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(a){var d=this._attrPairNames;
return d[a]?d[a]:d[a]={s:"_"+a+"Setter",g:"_"+a+"Getter"}},postscript:function(a){a&&this.set(a)},_get:function(a,d){return"function"===typeof this[d.g]?this[d.g]():this[a]},get:function(a){return this._get(a,this._getAttrNames(a))},set:function(a,f){if("object"===typeof a){for(var k in a)a.hasOwnProperty(k)&&"_watchCallbacks"!=k&&this.set(k,a[k]);return this}k=this._getAttrNames(a);var m=this._get(a,k);k=this[k.s];var g;"function"===typeof k?g=k.apply(this,Array.prototype.slice.call(arguments,1)):
this[a]=f;if(this._watchCallbacks){var e=this;d(g,function(){e._watchCallbacks(a,m,f)})}return this},_changeAttrValue:function(a,d){var k=this.get(a);this[a]=d;this._watchCallbacks&&this._watchCallbacks(a,k,d);return this},watch:function(b,d){var k=this._watchCallbacks;if(!k)var m=this,k=this._watchCallbacks=function(a,e,b,g){var d=function(g){if(g){g=g.slice();for(var d=0,f=g.length;d<f;d++)g[d].call(m,a,e,b)}};d(k["_"+a]);g||d(k["*"])};d||"function"!==typeof b?b="_"+b:(d=b,b="*");var g=k[b];"object"!==
typeof g&&(g=k[b]=[]);g.push(d);var e={};e.unwatch=e.remove=function(){var c=a.indexOf(g,d);-1<c&&g.splice(c,1)};return e}})})},"dojo/when":function(){define(["./Deferred","./promise/Promise"],function(h,l){return function(a,d,b,f){var k=a&&"function"===typeof a.then,m=k&&a instanceof l;if(!k)return 1<arguments.length?d?d(a):a:(new h).resolve(a);m||(k=new h(a.cancel),a.then(k.resolve,k.reject,k.progress),a=k.promise);return d||b||f?a.then(d,b,f):a}})},"dijit/Destroyable":function(){define(["dojo/_base/array",
"dojo/aspect","dojo/_base/declare"],function(h,l,a){return a("dijit.Destroyable",null,{destroy:function(a){this._destroyed=!0},own:function(){var a=["destroyRecursive","destroy","remove"];h.forEach(arguments,function(b){function f(){m.remove();h.forEach(g,function(a){a.remove()})}var k,m=l.before(this,"destroy",function(a){b[k](a)}),g=[];b.then?(k="cancel",b.then(f,f)):h.forEach(a,function(a){"function"===typeof b[a]&&(k||(k=a),g.push(l.after(b,a,f,!0)))})},this);return arguments}})})},"dijit/registry":function(){define(["dojo/_base/array",
"dojo/_base/window","./main"],function(h,l,a){var d={},b={},f={length:0,add:function(a){if(b[a.id])throw Error("Tried to register widget with id\x3d\x3d"+a.id+" but that id is already registered");b[a.id]=a;this.length++},remove:function(a){b[a]&&(delete b[a],this.length--)},byId:function(a){return"string"==typeof a?b[a]:a},byNode:function(a){return b[a.getAttribute("widgetId")]},toArray:function(){var a=[],d;for(d in b)a.push(b[d]);return a},getUniqueId:function(f){var m;do m=f+"_"+(f in d?++d[f]:
d[f]=0);while(b[m]);return"dijit"==a._scopeName?m:a._scopeName+"_"+m},findWidgets:function(a,d){function g(a){for(a=a.firstChild;a;a=a.nextSibling)if(1==a.nodeType){var n=a.getAttribute("widgetId");n?(n=b[n])&&e.push(n):a!==d&&g(a)}}var e=[];g(a);return e},_destroyAll:function(){a._curFocus=null;a._prevFocus=null;a._activeStack=[];h.forEach(f.findWidgets(l.body()),function(a){a._destroyed||(a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy())})},getEnclosingWidget:function(a){for(;a;){var d=
1==a.nodeType&&a.getAttribute("widgetId");if(d)return b[d];a=a.parentNode}return null},_hash:b};return a.registry=f})},"dijit/main":function(){define(["dojo/_base/kernel"],function(h){return h.dijit})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q){function r(){}
function u(c){return function(e,b,g,n){return e&&"string"==typeof b&&e[b]==r?e.on(b.substring(2).toLowerCase(),k.hitch(g,n)):c.apply(a,arguments)}}h.around(a,"connect",u);f.connect&&h.around(f,"connect",u);h=d("dijit._Widget",[c,n,q],{onClick:r,onDblClick:r,onKeyDown:r,onKeyPress:r,onKeyUp:r,onMouseDown:r,onMouseMove:r,onMouseOut:r,onMouseOver:r,onMouseLeave:r,onMouseEnter:r,onMouseUp:r,constructor:function(a){this._toConnect={};for(var c in a)this[c]===r&&(this._toConnect[c.replace(/^on/,"").toLowerCase()]=
a[c],delete a[c])},postCreate:function(){this.inherited(arguments);for(var a in this._toConnect)this.on(a,this._toConnect[a]);delete this._toConnect},on:function(c,e){return this[this._onMap(c)]===r?a.connect(this.domNode,c.toLowerCase(),this,e):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(a,c){f.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(a,c)},attr:function(a,
c){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,arguments):this.get(a)},getDescendants:function(){f.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?m("[widgetId]",this.containerNode).map(e.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});b("dijit-legacy-requires")&&g(0,function(){require(["dijit/_base"])});return h})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),
function(h,l,a,d,b,f){h=d("dijit._OnDijitClickMixin",null,{connect:function(a,b,g){return this.inherited(arguments,[a,"ondijitclick"==b?f:b,g])}});h.a11yclick=f;return h})},"dijit/a11yclick":function(){define(["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(h,l,a,d){function b(a){if((a.keyCode===h.ENTER||a.keyCode===h.SPACE)&&!/input|button|textarea/i.test(a.target.nodeName))for(a=a.target;a;a=a.parentNode)if(a.dojoClick)return!0}var f;a(document,"keydown",function(a){b(a)?(f=a.target,a.preventDefault()):
f=null});a(document,"keyup",function(d){b(d)&&d.target==f&&(f=null,a.emit(d.target,"click",{cancelable:!0,bubbles:!0,ctrlKey:d.ctrlKey,shiftKey:d.shiftKey,metaKey:d.metaKey,altKey:d.altKey,_origType:d.type}))});var k=function(b,g){b.dojoClick=!0;return a(b,"click",g)};k.click=k;k.press=function(b,g){var e=a(b,d.press,function(a){("mousedown"!=a.type||l.isLeft(a))&&g(a)}),c=a(b,"keydown",function(a){a.keyCode!==h.ENTER&&a.keyCode!==h.SPACE||g(a)});return{remove:function(){e.remove();c.remove()}}};
k.release=function(b,g){var e=a(b,d.release,function(a){("mouseup"!=a.type||l.isLeft(a))&&g(a)}),c=a(b,"keyup",function(a){a.keyCode!==h.ENTER&&a.keyCode!==h.SPACE||g(a)});return{remove:function(){e.remove();c.remove()}}};k.move=d.move;return k})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(h,l,a,d){d.extend(l,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});
return a("dijit._FocusMixin",null,{_focusManager:h})})},"dijit/focus":function(){define("dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Evented dojo/_base/lang dojo/on dojo/domReady dojo/sniff dojo/Stateful dojo/_base/window dojo/window ./a11y ./registry ./main".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t){var w,x,y=new (l([n,k],{curNode:null,activeStack:[],constructor:function(){var c=m.hitch(this,function(c){a.isDescendant(this.curNode,c)&&
this.set("curNode",null);a.isDescendant(this.prevNode,c)&&this.set("prevNode",null)});h.before(f,"empty",c);h.before(f,"destroy",c)},registerIframe:function(a){return this.registerWin(a.contentWindow,a)},registerWin:function(a,e){var b=this,n=a.document&&a.document.body;if(n){var d=c("pointer-events")?"pointerdown":c("MSPointer")?"MSPointerDown":c("touch-events")?"mousedown, touchstart":"mousedown",f=g(a.document,d,function(a){a&&a.target&&null==a.target.parentNode||b._onTouchNode(e||a.target,"mouse")}),
k=g(n,"focusin",function(a){if(a.target.tagName){var c=a.target.tagName.toLowerCase();"#document"!=c&&"body"!=c&&(u.isFocusable(a.target)?b._onFocusNode(e||a.target):b._onTouchNode(e||a.target))}}),t=g(n,"focusout",function(a){b._onBlurNode(e||a.target)});return{remove:function(){f.remove();k.remove();t.remove();n=f=k=t=null}}}},_onBlurNode:function(a){a=(new Date).getTime();a<w+100||(this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),this._clearFocusTimer=setTimeout(m.hitch(this,function(){this.set("prevNode",
this.curNode);this.set("curNode",null)}),0),this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),a<x+100||(this._clearActiveWidgetsTimer=setTimeout(m.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([])}),0)))},_onTouchNode:function(a,c){x=(new Date).getTime();this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer);b.contains(a,"dijitPopup")&&(a=a.firstChild);var e=[];try{for(;a;){var g=d.get(a,
"dijitPopupParent");if(g)a=v.byId(g).domNode;else if(a.tagName&&"body"==a.tagName.toLowerCase()){if(a===q.body())break;a=r.get(a.ownerDocument).frameElement}else{var n=a.getAttribute&&a.getAttribute("widgetId"),f=n&&v.byId(n);!f||"mouse"==c&&f.get("disabled")||e.unshift(n);a=a.parentNode}}}catch(k){}this._setStack(e,c)},_onFocusNode:function(a){a&&9!=a.nodeType&&(w=(new Date).getTime(),this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),delete this._clearFocusTimer),this._onTouchNode(a),a!=
this.curNode&&(this.set("prevNode",this.curNode),this.set("curNode",a)))},_setStack:function(a,c){var e=this.activeStack,b=e.length-1,g=a.length-1;if(a[g]!=e[b]){this.set("activeStack",a);var n;for(n=b;0<=n&&e[n]!=a[n];n--)if(b=v.byId(e[n]))b._hasBeenBlurred=!0,b.set("focused",!1),b._focusManager==this&&b._onBlur(c),this.emit("widget-blur",b,c);for(n++;n<=g;n++)if(b=v.byId(a[n]))b.set("focused",!0),b._focusManager==this&&b._onFocus(c),this.emit("widget-focus",b,c)}},focus:function(a){if(a)try{a.focus()}catch(c){}}}));
e(function(){var a=y.registerWin(r.get(document));c("ie")&&g(window,"unload",function(){a&&(a.remove(),a=null)})});t.focus=function(a){y.focus(a)};for(var z in y)/^_/.test(z)||(t.focus[z]="function"==typeof y[z]?m.hitch(y,z):y[z]);y.watch(function(a,c,e){t.focus[a]=e});return y})},"dojo/window":function(){define("./_base/lang ./sniff ./_base/window ./dom ./dom-geometry ./dom-style ./dom-construct".split(" "),function(h,l,a,d,b,f,k){l.add("rtl-adjust-position-for-verticalScrollBar",function(g,e){var c=
a.body(e),n=k.create("div",{style:{overflow:"scroll",overflowX:"visible",direction:"rtl",visibility:"hidden",position:"absolute",left:"0",top:"0",width:"64px",height:"64px"}},c,"last"),d=k.create("div",{style:{overflow:"hidden",direction:"ltr"}},n,"last"),f=0!=b.position(d).x;n.removeChild(d);c.removeChild(n);return f});l.add("position-fixed-support",function(g,e){var c=a.body(e),n=k.create("span",{style:{visibility:"hidden",position:"fixed",left:"1px",top:"1px"}},c,"last"),d=k.create("span",{style:{position:"fixed",
left:"0",top:"0"}},n,"last"),f=b.position(d).x!=b.position(n).x;n.removeChild(d);c.removeChild(n);return f});var m={getBox:function(g){g=g||a.doc;var e="BackCompat"==g.compatMode?a.body(g):g.documentElement,c=b.docScroll(g);if(l("touch")){var n=m.get(g);g=n.innerWidth||e.clientWidth;e=n.innerHeight||e.clientHeight}else g=e.clientWidth,e=e.clientHeight;return{l:c.x,t:c.y,w:g,h:e}},get:function(a){if(l("ie")&&m!==document.parentWindow){a.parentWindow.execScript("document._parentWindow \x3d window;",
"Javascript");var e=a._parentWindow;a._parentWindow=null;return e}return a.parentWindow||a.defaultView},scrollIntoView:function(g,e){try{g=d.byId(g);var c=g.ownerDocument||a.doc,n=a.body(c),k=c.documentElement||n.parentNode,m=l("ie")||l("trident"),u=l("webkit");if(g!=n&&g!=k)if(!(l("mozilla")||m||u||l("opera")||l("trident")||l("edge"))&&"scrollIntoView"in g)g.scrollIntoView(!1);else{var v="BackCompat"==c.compatMode,t=Math.min(n.clientWidth||k.clientWidth,k.clientWidth||n.clientWidth),h=Math.min(n.clientHeight||
k.clientHeight,k.clientHeight||n.clientHeight),c=u||v?n:k,x=e||b.position(g),y=g.parentNode,u=function(a){return 6>=m||7==m&&v?!1:l("position-fixed-support")&&"fixed"==f.get(a,"position").toLowerCase()},z=this,A=function(a,c,e){"BODY"==a.tagName||"HTML"==a.tagName?z.get(a.ownerDocument).scrollBy(c,e):(c&&(a.scrollLeft+=c),e&&(a.scrollTop+=e))};if(!u(g))for(;y;){y==n&&(y=c);var B=b.position(y),C=u(y),D="rtl"==f.getComputedStyle(y).direction.toLowerCase();if(y==c)B.w=t,B.h=h,c==k&&(m||l("trident"))&&
D&&(B.x+=c.offsetWidth-B.w),B.x=0,B.y=0;else{var E=b.getPadBorderExtents(y);B.w-=E.w;B.h-=E.h;B.x+=E.l;B.y+=E.t;var F=y.clientWidth,H=B.w-F;0<F&&0<H&&(D&&l("rtl-adjust-position-for-verticalScrollBar")&&(B.x+=H),B.w=F);F=y.clientHeight;H=B.h-F;0<F&&0<H&&(B.h=F)}C&&(0>B.y&&(B.h+=B.y,B.y=0),0>B.x&&(B.w+=B.x,B.x=0),B.y+B.h>h&&(B.h=h-B.y),B.x+B.w>t&&(B.w=t-B.x));var G=x.x-B.x,K=x.y-B.y,J=G+x.w-B.w,I=K+x.h-B.h,L,M;0<J*G&&(y.scrollLeft||y==c||y.scrollWidth>y.offsetHeight)&&(L=Math[0>G?"max":"min"](G,J),
D&&(8==m&&!v||5<=l("trident"))&&(L=-L),M=y.scrollLeft,A(y,L,0),L=y.scrollLeft-M,x.x-=L);0<I*K&&(y.scrollTop||y==c||y.scrollHeight>y.offsetHeight)&&(L=Math.ceil(Math[0>K?"max":"min"](K,I)),M=y.scrollTop,A(y,0,L),L=y.scrollTop-M,x.y-=L);y=y!=c&&!C&&y.parentNode}}}catch(N){console.error("scrollIntoView: "+N),g.scrollIntoView(!1)}}};h.setObject("dojo.window",m);return m})},"dijit/a11y":function(){define("dojo/_base/array dojo/dom dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/sniff ./main".split(" "),
function(h,l,a,d,b,f,k){var m={_isElementShown:function(b){var e=d.get(b);return"hidden"!=e.visibility&&"collapsed"!=e.visibility&&"none"!=e.display&&"hidden"!=a.get(b,"type")},hasDefaultTabStop:function(b){switch(b.nodeName.toLowerCase()){case "a":return a.has(b,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return!0;case "iframe":var e;try{var c=b.contentDocument;if("designMode"in c&&"on"==c.designMode)return!0;e=c.body}catch(n){try{e=b.contentWindow.document.body}catch(d){return!1}}return e&&
("true"==e.contentEditable||e.firstChild&&"true"==e.firstChild.contentEditable);default:return"true"==b.contentEditable}},effectiveTabIndex:function(b){return a.get(b,"disabled")?void 0:a.has(b,"tabIndex")?+a.get(b,"tabIndex"):m.hasDefaultTabStop(b)?0:void 0},isTabNavigable:function(a){return 0<=m.effectiveTabIndex(a)},isFocusable:function(a){return-1<=m.effectiveTabIndex(a)},_getTabNavigable:function(b){function e(a){return a&&"input"==a.tagName.toLowerCase()&&a.type&&"radio"==a.type.toLowerCase()&&
a.name&&a.name.toLowerCase()}function c(a){return h[e(a)]||a}var n,d,k,u,v,t,h={},x=m._isElementShown,l=m.effectiveTabIndex,z=function(c){for(c=c.firstChild;c;c=c.nextSibling)if(!(1!=c.nodeType||9>=f("ie")&&"HTML"!==c.scopeName)&&x(c)){var b=l(c);if(0<=b){if(0==b)n||(n=c),d=c;else if(0<b){if(!k||b<u)u=b,k=c;if(!v||b>=t)t=b,v=c}b=e(c);a.get(c,"checked")&&b&&(h[b]=c)}"SELECT"!=c.nodeName.toUpperCase()&&z(c)}};x(b)&&z(b);return{first:c(n),last:c(d),lowest:c(k),highest:c(v)}},getFirstInTabbingOrder:function(a,
e){var c=m._getTabNavigable(l.byId(a,e));return c.lowest?c.lowest:c.first},getLastInTabbingOrder:function(a,e){var c=m._getTabNavigable(l.byId(a,e));return c.last?c.last:c.highest}};b.mixin(k,m);return m})},"dojo/uacss":function(){define(["./dom-geometry","./_base/lang","./domReady","./sniff","./_base/window"],function(h,l,a,d,b){var f=b.doc.documentElement;b=d("ie");var k=d("trident"),m=d("opera"),g=Math.floor,e=d("ff"),c=h.boxModel.replace(/-/,""),m={dj_quirks:d("quirks"),dj_opera:m,dj_khtml:d("khtml"),
dj_webkit:d("webkit"),dj_safari:d("safari"),dj_chrome:d("chrome"),dj_edge:d("edge"),dj_gecko:d("mozilla"),dj_ios:d("ios"),dj_android:d("android")};b&&(m.dj_ie=!0,m["dj_ie"+g(b)]=!0,m.dj_iequirks=d("quirks"));k&&(m.dj_trident=!0,m["dj_trident"+g(k)]=!0);e&&(m["dj_ff"+g(e)]=!0);m["dj_"+c]=!0;var n="",q;for(q in m)m[q]&&(n+=q+" ");f.className=l.trim(f.className+" "+n);a(function(){if(!h.isBodyLtr()){var a="dj_rtl dijitRtl "+n.replace(/ /g,"-rtl ");f.className=l.trim(f.className+" "+a+"dj_rtl dijitRtl "+
n.replace(/ /g,"-rtl "))}});return d})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(h,l,a,d){a(function(){l("highcontrast")&&h.add(d.body(),"dijit_a11y")});return l})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),function(h,l,a,d,b,f,k){b.add("highcontrast",function(){var a=k.doc.createElement("div");try{a.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+
(l.blankGif||h.toUrl("./resources/blank.gif"))+'");';k.body().appendChild(a);var g=d.getComputedStyle(a),e=g.backgroundImage;return g.borderTopColor==g.borderRightColor||e&&("none"==e||"url(invalid-url:)"==e)}catch(c){return console.warn("hccss: exception detecting high-contrast mode, document is likely hidden: "+c.toString()),!1}finally{8>=b("ie")?a.outerHTML="":k.body().removeChild(a)}});f(function(){b("highcontrast")&&a.add(k.body(),"dj_a11y")});return b})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),
function(h,l,a,d,b,f,k,m){var g=l("dijit._TemplatedMixin",m,{templateString:null,templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(a){var c=this.declaredClass,b=this;return k.substitute(a,this,function(a,e){"!"==e.charAt(0)&&(a=d.getObject(e.substr(1),!1,b));if("undefined"==typeof a)throw Error(c+" template:"+e);return null==a?"":"!"==e.charAt(0)?a:this._escapeValue(""+a)},this)},_escapeValue:function(a){return a.replace(/["'<>&]/g,function(a){return{"\x26":"\x26amp;",
"\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[a]})},buildRendering:function(){if(!this._rendered){this.templateString||(this.templateString=h(this.templatePath,{sanitize:!0}));var e=g.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),c;if(d.isString(e)){if(c=a.toDom(this._stringRepl(e),this.ownerDocument),1!=c.nodeType)throw Error("Invalid template: "+e);}else c=e.cloneNode(!0);this.domNode=c}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);
this._rendered=!0},_fillContent:function(a){var c=this.containerNode;if(a&&c)for(;a.hasChildNodes();)c.appendChild(a.firstChild)}});g._templateCache={};g.getCachedTemplate=function(e,c,b){var d=g._templateCache,f=e,m=d[f];if(m){try{if(!m.ownerDocument||m.ownerDocument==(b||document))return m}catch(v){}a.destroy(m)}e=k.trim(e);if(c||e.match(/\$\{([^\}]+)\}/g))return d[f]=e;c=a.toDom(e,b);if(1!=c.nodeType)throw Error("Invalid template: "+e);return d[f]=c};f("ie")&&b(window,"unload",function(){var e=
g._templateCache,c;for(c in e){var b=e[c];"object"==typeof b&&a.destroy(b);delete e[c]}});return g})},"dojo/cache":function(){define(["./_base/kernel","./text"],function(h){return h.cache})},"dojo/text":function(){define(["./_base/kernel","require","./has","./request"],function(h,l,a,d){var b;b=function(a,c,b){d(a,{sync:!!c,headers:{"X-Requested-With":null}}).then(b)};var f={},k=function(a){if(a){a=a.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var c=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);
c&&(a=c[1])}else a="";return a},m={},g={};h.cache=function(a,c,g){var d;"string"==typeof a?/\//.test(a)?(d=a,g=c):d=l.toUrl(a.replace(/\./g,"/")+(c?"/"+c:"")):(d=a+"",g=c);a=void 0!=g&&"string"!=typeof g?g.value:g;g=g&&g.sanitize;if("string"==typeof a)return f[d]=a,g?k(a):a;if(null===a)return delete f[d],null;d in f||b(d,!0,function(a){f[d]=a});return g?k(f[d]):f[d]};return{dynamic:!0,normalize:function(a,c){var b=a.split("!"),g=b[0];return(/^\./.test(g)?c(g):g)+(b[1]?"!"+b[1]:"")},load:function(a,
c,d){a=a.split("!");var q=1<a.length,r=a[0],u=c.toUrl(a[0]);a="url:"+u;var v=m,t=function(a){d(q?k(a):a)};r in f?v=f[r]:c.cache&&a in c.cache?v=c.cache[a]:u in f&&(v=f[u]);if(v===m)if(g[u])g[u].push(t);else{var h=g[u]=[t];b(u,!c.async,function(a){f[r]=f[u]=a;for(var c=0;c<h.length;)h[c++](a);delete g[u]})}else t(v)}}})},"dojo/request":function(){define(["./request/default!"],function(h){return h})},"dojo/request/default":function(){define(["exports","require","../has"],function(h,l,a){var d=a("config-requestProvider");
d||(d="./xhr");h.getPlatformDefaultId=function(){return"./xhr"};h.load=function(a,f,k,m){l(["platform"==a?"./xhr":d],function(a){k(a)})}})},"dojo/string":function(){define(["./_base/kernel","./_base/lang"],function(h,l){var a=/[&<>'"\/]/g,d={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;","/":"\x26#x2F;"},b={};l.setObject("dojo.string",b);b.escape=function(b){return b?b.replace(a,function(a){return d[a]}):""};b.rep=function(a,b){if(0>=b||!a)return"";for(var d=[];;){b&
1&&d.push(a);if(!(b>>=1))break;a+=a}return d.join("")};b.pad=function(a,d,m,g){m||(m="0");a=String(a);d=b.rep(m,Math.ceil((d-a.length)/m.length));return g?a+d:d+a};b.substitute=function(a,b,d,g){g=g||h.global;d=d?l.hitch(g,d):function(a){return a};return a.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,function(a,c,n){if(""==c)return"$";a=l.getObject(c,!1,b);n&&(a=l.getObject(n,!1,g).call(g,a,c));return d(a,c).toString()})};b.trim=String.prototype.trim?l.trim:function(a){a=a.replace(/^\s+/,"");
for(var b=a.length-1;0<=b;b--)if(/\S/.test(a.charAt(b))){a=a.substring(0,b+1);break}return a};return b})},"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(h,l,a,d,b,f,k,m,g){var e=b.delegate(m,{mouseenter:f.enter,mouseleave:f.leave,keypress:a._keypress}),c;a=d("dijit._AttachMixin",null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);
this._attachTemplateNodes(this.domNode);this._beforeFillContent()},_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var c=a;;)if(1==c.nodeType&&(this._processTemplateNode(c,function(a,c){return a.getAttribute(c)},this._attach)||this.searchContainerNode)&&c.firstChild)c=c.firstChild;else{if(c==a)break;for(;!c.nextSibling;)if(c=c.parentNode,c==a)return;c=c.nextSibling}},_processTemplateNode:function(a,c,e){var g=!0,d=this.attachScope||this,f=c(a,"dojoAttachPoint")||c(a,"data-dojo-attach-point");
if(f)for(var k=f.split(/\s*,\s*/);f=k.shift();)b.isArray(d[f])?d[f].push(a):d[f]=a,g="containerNode"!=f,this._attachPoints.push(f);if(c=c(a,"dojoAttachEvent")||c(a,"data-dojo-attach-event"))for(f=c.split(/\s*,\s*/),k=b.trim;c=f.shift();)if(c){var m=null;-1!=c.indexOf(":")?(m=c.split(":"),c=k(m[0]),m=k(m[1])):c=k(c);m||(m=c);this._attachEvents.push(e(a,c,b.hitch(d,m)))}return g},_attach:function(a,b,g){b=b.replace(/^on/,"").toLowerCase();b="dijitclick"==b?c||(c=h("./a11yclick")):e[b]||b;return k(a,
b,g)},_detachTemplateNodes:function(){var a=this.attachScope||this;l.forEach(this._attachPoints,function(c){delete a[c]});this._attachPoints=[];l.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});b.extend(g,{dojoAttachEvent:"",dojoAttachPoint:""});return a})},"dijit/layout/LayoutContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-style dojo/_base/lang ../_WidgetBase ./_LayoutWidget ./utils".split(" "),
function(h,l,a,d,b,f,k,m){l=l("dijit.layout.LayoutContainer",k,{design:"headline",baseClass:"dijitLayoutContainer",startup:function(){this._started||(h.forEach(this.getChildren(),this._setupChild,this),this.inherited(arguments))},_setupChild:function(b){this.inherited(arguments);b.region&&a.add(b.domNode,this.baseClass+"Pane")},_getOrderedChildren:function(){var a=h.map(this.getChildren(),function(a,c){return{pane:a,weight:["center"==a.region?Infinity:0,a.layoutPriority,("sidebar"==this.design?1:
-1)*(/top|bottom/.test(a.region)?1:-1),c]}},this);a.sort(function(a,c){for(var b=a.weight,g=c.weight,d=0;d<b.length;d++)if(b[d]!=g[d])return b[d]-g[d];return 0});return h.map(a,function(a){return a.pane})},layout:function(){m.layoutChildren(this.domNode,this._contentBox,this._getOrderedChildren())},addChild:function(a,e){this.inherited(arguments);this._started&&this.layout()},removeChild:function(b){this.inherited(arguments);this._started&&this.layout();a.remove(b.domNode,this.baseClass+"Pane");d.set(b.domNode,
{top:"auto",bottom:"auto",left:"auto",right:"auto",position:"static"});d.set(b.domNode,/top|bottom/.test(b.region)?"width":"height","auto")}});l.ChildWidgetProperties={region:"",layoutAlign:"",layoutPriority:0};b.extend(f,l.ChildWidgetProperties);return l})},"dijit/layout/_LayoutWidget":function(){define("dojo/_base/lang ../_Widget ../_Container ../_Contained ../Viewport dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style".split(" "),function(h,l,a,d,b,f,k,m,g){return f("dijit.layout._LayoutWidget",
[l,a,d],{baseClass:"dijitLayoutContainer",isLayoutContainer:!0,_setTitleAttr:null,buildRendering:function(){this.inherited(arguments);k.add(this.domNode,"dijitContainer")},startup:function(){if(!this._started){this.inherited(arguments);var a=this.getParent&&this.getParent();a&&a.isLayoutContainer||(this.resize(),this.own(b.on("resize",h.hitch(this,"resize"))))}},resize:function(a,c){var b=this.domNode;a&&m.setMarginBox(b,a);var d=c||{};h.mixin(d,a||{});"h"in d&&"w"in d||(d=h.mixin(m.getMarginBox(b),
d));var f=g.getComputedStyle(b),k=m.getMarginExtents(b,f),v=m.getBorderExtents(b,f),d=this._borderBox={w:d.w-(k.w+v.w),h:d.h-(k.h+v.h)},k=m.getPadExtents(b,f);this._contentBox={l:g.toPixelValue(b,f.paddingLeft),t:g.toPixelValue(b,f.paddingTop),w:d.w-k.w,h:d.h-k.h};this.layout()},layout:function(){},_setupChild:function(a){k.add(a.domNode,this.baseClass+"-child "+(a.baseClass?this.baseClass+"-"+a.baseClass:""))},addChild:function(a,c){this.inherited(arguments);this._started&&this._setupChild(a)},removeChild:function(a){k.remove(a.domNode,
this.baseClass+"-child"+(a.baseClass?" "+this.baseClass+"-"+a.baseClass:""));this.inherited(arguments)}})})},"dijit/_Container":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/kernel"],function(h,l,a,d){return l("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode)},addChild:function(b,d){var k=this.containerNode;if(0<d){for(k=k.firstChild;0<d;)1==k.nodeType&&d--,k=k.nextSibling;
k?d="before":(k=this.containerNode,d="last")}a.place(b.domNode,k,d);this._started&&!b._started&&b.startup()},removeChild:function(a){"number"==typeof a&&(a=this.getChildren()[a]);a&&(a=a.domNode)&&a.parentNode&&a.parentNode.removeChild(a)},hasChildren:function(){return 0<this.getChildren().length},_getSiblingOfChild:function(a,d){var k=this.getChildren(),m=h.indexOf(k,a);return k[m+d]},getIndexOfChild:function(a){return h.indexOf(this.getChildren(),a)}})})},"dijit/_Contained":function(){define(["dojo/_base/declare",
"./registry"],function(h,l){return h("dijit._Contained",null,{_getSibling:function(a){var d=this.getParent();return d&&d._getSiblingOfChild&&d._getSiblingOfChild(this,"previous"==a?-1:1)||null},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var a=this.getParent();return a&&a.getIndexOfChild?a.getIndexOfChild(this):-1}})})},"dijit/Viewport":function(){define(["dojo/Evented","dojo/on","dojo/domReady",
"dojo/sniff","dojo/window"],function(h,l,a,d,b){var f=new h,k;a(function(){var a=b.getBox();f._rlh=l(window,"resize",function(){var e=b.getBox();if(a.h!=e.h||a.w!=e.w)a=e,f.emit("resize")});if(8==d("ie")){var g=screen.deviceXDPI;setInterval(function(){screen.deviceXDPI!=g&&(g=screen.deviceXDPI,f.emit("resize"))},500)}d("ios")&&(l(document,"focusin",function(a){k=a.target}),l(document,"focusout",function(a){k=null}))});f.getEffectiveBox=function(a){a=b.getBox(a);var g=k&&k.tagName&&k.tagName.toLowerCase();
d("ios")&&k&&!k.readOnly&&("textarea"==g||"input"==g&&/^(color|email|number|password|search|tel|text|url)$/.test(k.type))&&(a.h*=0==orientation||180==orientation?.66:.4,g=k.getBoundingClientRect(),a.h=Math.max(a.h,g.top+g.height));return a};return f})},"dijit/layout/utils":function(){define(["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],function(h,l,a,d,b){function f(a){return a.substring(0,1).toUpperCase()+a.substring(1)}function k(g,e){var c=g.resize?
g.resize(e):a.setMarginBox(g.domNode,e);c?b.mixin(g,c):(b.mixin(g,a.getMarginBox(g.domNode)),b.mixin(g,e))}var m={marginBox2contentBox:function(b,e){var c=d.getComputedStyle(b),n=a.getMarginExtents(b,c),f=a.getPadBorderExtents(b,c);return{l:d.toPixelValue(b,c.paddingLeft),t:d.toPixelValue(b,c.paddingTop),w:e.w-(n.w+f.w),h:e.h-(n.h+f.h)}},layoutChildren:function(a,e,c,d,m){e=b.mixin({},e);l.add(a,"dijitLayoutContainer");c=h.filter(c,function(a){return"center"!=a.region&&"client"!=a.layoutAlign}).concat(h.filter(c,
function(a){return"center"==a.region||"client"==a.layoutAlign}));h.forEach(c,function(a){var c=a.domNode,b=a.region||a.layoutAlign;if(!b)throw Error("No region setting for "+a.id);var g=c.style;g.left=e.l+"px";g.top=e.t+"px";g.position="absolute";l.add(c,"dijitAlign"+f(b));c={};d&&d==a.id&&(c["top"==a.region||"bottom"==a.region?"h":"w"]=m);"leading"==b&&(b=a.isLeftToRight()?"left":"right");"trailing"==b&&(b=a.isLeftToRight()?"right":"left");"top"==b||"bottom"==b?(c.w=e.w,k(a,c),e.h-=a.h,"top"==b?
e.t+=a.h:g.top=e.t+e.h+"px"):"left"==b||"right"==b?(c.h=e.h,k(a,c),e.w-=a.w,"left"==b?e.l+=a.w:g.left=e.l+e.w+"px"):"client"!=b&&"center"!=b||k(a,e)})}};b.setObject("dijit.layout.utils",m);return m})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when dojo/i18n!../nls/loading".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v){return g("dijit.layout.ContentPane",[a,d,b],{href:"",content:"",extractContent:!1,parseOnLoad:!0,parserScope:h._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",
isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(a,c,e){var b=new e(a,c);return!b.href&&b._contentSetter&&b._contentSetter.parseDeferred&&!b._contentSetter.parseDeferred.isFulfilled()?b._contentSetter.parseDeferred.then(function(){return b}):b},create:function(a,e){if(!(a&&a.template||!e||"href"in a||"content"in a)){e=c.byId(e);for(var b=e.ownerDocument.createDocumentFragment();e.firstChild;)b.appendChild(e.firstChild);
a=l.delegate(a,{content:b})}this.inherited(arguments,[a,e])},postMixInProperties:function(){this.inherited(arguments);var a=u.getLocalization("dijit","loading",this.lang);this.loadingMessage=f.substitute(this.loadingMessage,a);this.errorMessage=f.substitute(this.errorMessage,a)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&m.forEach(this._contentSetter.parseResults,
function(a){a._started||a._destroyed||!l.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},_startChildren:function(){m.forEach(this.getChildren(),function(a){a._started||a._destroyed||!l.isFunction(a.startup)||(a.startup(),a._started=!0)});this._contentSetter&&m.forEach(this._contentSetter.parseResults,function(a){a._started||a._destroyed||!l.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},setHref:function(a){h.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.",
"","2.0");return this.set("href",a)},_setHrefAttr:function(a){this.cancel();this.onLoadDeferred=new e(l.hitch(this,"cancel"));this.onLoadDeferred.then(l.hitch(this,"onLoad"));this._set("href",a);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(a){h.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",a)},_setContentAttr:function(a){this._set("href",
"");this.cancel();this.onLoadDeferred=new e(l.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(l.hitch(this,"onLoad"));this._setContent(a||"");this._isDownloaded=!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(a){this._beingDestroyed||
this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},refresh:function(){this.cancel();this.onLoadDeferred=new e(l.hitch(this,"cancel"));this.onLoadDeferred.then(l.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var a=this,c={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};
l.isObject(this.ioArgs)&&l.mixin(c,this.ioArgs);var e=this._xhrDfd=(this.ioMethod||r.get)(c),b;e.then(function(c){b=c;try{return a._isDownloaded=!0,a._setContent(c,!1)}catch(e){a._onError("Content",e)}},function(c){e.canceled||a._onError("Download",c);delete a._xhrDfd;return c}).then(function(){a.onDownloadEnd();delete a._xhrDfd;return b});delete this._hrefChanged},_onLoadHandler:function(a){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(a)}catch(c){console.error("Error "+this.widgetId+
" running custom onLoad code: "+c.message)}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(a){console.error("Error "+this.widgetId+" running custom onUnload code: "+a.message)}},destroyDescendants:function(a){this.isLoaded&&this._onUnloadHandler();var c=this._contentSetter;m.forEach(this.getChildren(),function(c){c.destroyRecursive?c.destroyRecursive(a):c.destroy&&c.destroy(a);c._destroyed=!0});c&&(m.forEach(c.parseResults,function(c){c._destroyed||(c.destroyRecursive?
c.destroyRecursive(a):c.destroy&&c.destroy(a),c._destroyed=!0)}),delete c.parseResults);a||q.empty(this.containerNode);delete this._singleChild},_setContent:function(a,c){a=this.preprocessContent(a);this.destroyDescendants();var e=this._contentSetter;e&&e instanceof k._ContentSetter||(e=this._contentSetter=new k._ContentSetter({node:this.containerNode,_onError:l.hitch(this,this._onError),onContentError:l.hitch(this,function(a){a=this.onContentError(a);try{this.containerNode.innerHTML=a}catch(c){console.error("Fatal "+
this.id+" could not change content due to "+c.message,c)}})}));var b=l.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!a.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{}),b=e.set(l.isObject(a)&&a.domNode?a.domNode:a,b),g=this;return v(b&&b.then?b:e.parseDeferred,function(){delete g._contentSetterParams;c||(g._started&&(g._startChildren(),g._scheduleLayout()),g._onLoadHandler(a))})},
preprocessContent:function(a){return a},_onError:function(a,c,e){this.onLoadDeferred.reject(c);a=this["on"+a+"Error"].call(this,c);e?console.error(e,c):a&&this._setContent(a,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),
function(h,l,a,d,b,f,k,m,g,e){return l("dijit.layout._ContentPaneResizeMixin",null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var a=this.getParent();this._childOfLayoutWidget=a&&a.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(g.on("resize",f.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var c=[],e=!1;k("\x3e *",this.containerNode).some(function(a){var b=
m.byNode(a);b&&b.resize?c.push(b):!/script|link|style/i.test(a.nodeName)&&a.offsetHeight&&(e=!0)});this._singleChild=1!=c.length||e?null:c[0];a.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(a,e){this._resizeCalled=!0;this._scheduleLayout(a,e)},_scheduleLayout:function(a,e){this._isShown()?this._layout(a,e):(this._needLayout=!0,this._changeSize=a,this._resultSize=e)},_layout:function(a,b){delete this._needLayout;this._wasShown||!1===this.open||this._onShow();
a&&d.setMarginBox(this.domNode,a);var g=this.containerNode;if(g===this.domNode){var k=b||{};f.mixin(k,a||{});"h"in k&&"w"in k||(k=f.mixin(d.getMarginBox(g),k));this._contentBox=e.marginBox2contentBox(g,k)}else this._contentBox=d.getContentBox(g);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var a=this._contentBox||d.getContentBox(this.containerNode);this._singleChild.resize({w:a.w,h:a.h})}else for(var a=this.getChildren(),
e,b=0;e=a[b++];)e.resize&&e.resize()},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var c=this.domNode,e=this.domNode.parentNode;return"none"!=c.style.display&&"hidden"!=c.style.visibility&&!a.contains(c,"dijitHidden")&&e&&e.style&&"none"!=e.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),
function(h,l,a,d,b,f,k){var m=0,g={_secureForInnerHtml:function(a){return a.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,"")},_emptyNode:f.empty,_setNodeContent:function(a,c){f.empty(a);if(c)if("number"==typeof c&&(c=c.toString()),"string"==typeof c&&(c=f.toDom(c,a.ownerDocument)),!c.nodeType&&l.isArrayLike(c))for(var b=c.length,g=0;g<c.length;g=b==c.length?g+1:0)f.place(c[g],a,"last");else f.place(c,a,"last");return a},_ContentSetter:d("dojo.html._ContentSetter",null,{node:"",
content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:h._scopeName,startup:!0,constructor:function(a,c){l.mixin(this,a||{});c=this.node=b.byId(this.node||c);this.id||(this.id=["Setter",c?c.id||c.tagName:"",m++].join("_"))},set:function(a,c){void 0!==a&&(this.content=a);c&&this._mixin(c);this.onBegin();this.setContent();var b=this.onEnd();return b&&b.then?b:this.node},setContent:function(){var a=this.node;if(!a)throw Error(this.declaredClass+": setContent given no node");try{a=
g._setNodeContent(a,this.content)}catch(c){var b=this.onContentError(c);try{a.innerHTML=b}catch(d){console.error("Fatal "+this.declaredClass+".setContent could not change content due to "+d.message,d)}}this.node=a},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(a.forEach(this.parseResults,function(a){a.destroy&&a.destroy()}),delete this.parseResults);f.empty(this.node)},onBegin:function(){var a=
this.content;if(l.isString(a)&&(this.cleanContent&&(a=g._secureForInnerHtml(a)),this.extractContent)){var c=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);c&&(a=c[1])}this.empty();this.content=a;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(a){return"Error occurred setting content: "+a},onExecError:function(a){return"Error occurred executing scripts: "+
a},_mixin:function(a){var c={},b;for(b in a)b in c||(this[b]=a[b])},_parse:function(){var e=this.node;try{var c={};a.forEach(["dir","lang","textDir"],function(a){this[a]&&(c[a]=this[a])},this);var b=this;this.parseDeferred=k.parse({rootNode:e,noStart:!this.startup,inherited:c,scope:this.parserScope}).then(function(a){return b.parseResults=a},function(a){b._onError("Content",a,"Error parsing in _ContentSetter#"+this.id)})}catch(g){this._onError("Content",g,"Error parsing in _ContentSetter#"+this.id)}},
_onError:function(a,c,b){a=this["on"+a+"Error"].call(this,c);b?console.error(b,c):a&&g._setNodeContent(this.node,a,!0)}}),set:function(a,c,b){void 0==c&&(console.warn("dojo.html.set: no cont argument provided, using empty string"),c="");"number"==typeof c&&(c=c.toString());return b?(new g._ContentSetter(l.mixin(b,{content:c,node:a}))).set():g._setNodeContent(a,c,!0)}};l.setObject("dojo.html",g);return g})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v){function t(a){return eval("("+a+")")}function w(a){var c=a._nameCaseMap,e=a.prototype;if(!c||c._extendCnt<y){var c=a._nameCaseMap={},b;for(b in e)"_"!==b.charAt(0)&&(c[b.toLowerCase()]=b);c._extendCnt=y}return c}function x(c,e){e||(e=h);var b=e._dojoParserCtorMap||(e._dojoParserCtorMap={}),g=c.join();if(!b[g]){for(var d=[],n=0,f=c.length;n<f;n++){var k=c[n];d[d.length]=b[k]=b[k]||a.getObject(k)||~k.indexOf("/")&&e(k)}n=d.shift();b[g]=d.length?n.createSubclass?
n.createSubclass(d):n.extend.apply(n,d):n}return b[g]}new Date("X");var y=0;g.after(a,"extend",function(){y++},!0);var z={_clearCache:function(){y++;_ctorMap={}},_functionFromScript:function(a,c){var e="",b="",g=a.getAttribute(c+"args")||a.getAttribute("args"),n=a.getAttribute("with"),g=(g||"").split(/\s*,\s*/);n&&n.length&&d.forEach(n.split(/\s*,\s*/),function(a){e+="with("+a+"){";b+="}"});return new Function(g,e+a.innerHTML+b)},instantiate:function(a,c,e){c=c||{};e=e||{};var b=(e.scope||l._scopeName)+
"Type",g="data-"+(e.scope||l._scopeName)+"-",n=g+"type",f=g+"mixins",k=[];d.forEach(a,function(a){var e=b in c?c[b]:a.getAttribute(n)||a.getAttribute(b);if(e){var g=a.getAttribute(f),e=g?[e].concat(g.split(/\s*,\s*/)):[e];k.push({node:a,types:e})}});return this._instantiate(k,c,e)},_instantiate:function(a,c,b,g){function n(a){c._started||b.noStart||d.forEach(a,function(a){"function"!==typeof a.startup||a._started||a.startup()});return a}a=d.map(a,function(a){var e=a.ctor||x(a.types,b.contextRequire);
if(!e)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(e,a.node,c,b,a.scripts,a.inherited)},this);return g?e(a).then(n):n(a)},construct:function(e,b,n,f,k,v){function h(c){Q&&a.setObject(Q,c);for(M=0;M<U.length;M++)g[U[M].advice||"after"](c,U[M].method,a.hitch(c,U[M].func),!0);for(M=0;M<W.length;M++)W[M].call(c);for(M=0;M<fa.length;M++)c.watch(fa[M].prop,fa[M].func);for(M=0;M<ea.length;M++)u(c,ea[M].event,ea[M].func);return c}var x=e&&e.prototype;f=f||{};
var y={};f.defaults&&a.mixin(y,f.defaults);v&&a.mixin(y,v);var z;q("dom-attributes-explicit")?z=b.attributes:q("dom-attributes-specified-flag")?z=d.filter(b.attributes,function(a){return a.specified}):(v=(/^input$|^img$/i.test(b.nodeName)?b:b.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),z=d.map(v.split(/\s+/),function(a){var c=a.toLowerCase();return{name:a,value:"LI"==b.nodeName&&"value"==a||"enctype"==c?b.getAttribute(c):
b.getAttributeNode(c).value}}));var I=f.scope||l._scopeName;v="data-"+I+"-";var L={};"dojo"!==I&&(L[v+"props"]="data-dojo-props",L[v+"type"]="data-dojo-type",L[v+"mixins"]="data-dojo-mixins",L[I+"type"]="dojotype",L[v+"id"]="data-dojo-id");for(var M=0,N,I=[],Q,O;N=z[M++];){var T=N.name,S=T.toLowerCase();N=N.value;switch(L[S]||S){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":O=N;break;case "data-dojo-id":case "jsid":Q=N;break;case "data-dojo-attach-point":case "dojoattachpoint":y.dojoAttachPoint=
N;break;case "data-dojo-attach-event":case "dojoattachevent":y.dojoAttachEvent=N;break;case "class":y["class"]=b.className;break;case "style":y.style=b.style&&b.style.cssText;break;default:if(T in x||(T=w(e)[S]||T),T in x)switch(typeof x[T]){case "string":y[T]=N;break;case "number":y[T]=N.length?Number(N):NaN;break;case "boolean":y[T]="false"!=N.toLowerCase();break;case "function":""===N||-1!=N.search(/[^\w\.]+/i)?y[T]=new Function(N):y[T]=a.getObject(N,!1)||new Function(N);I.push(T);break;default:S=
x[T],y[T]=S&&"length"in S?N?N.split(/\s*,\s*/):[]:S instanceof Date?""==N?new Date(""):"now"==N?new Date:c.fromISOString(N):S instanceof m?l.baseUrl+N:t(N)}else y[T]=N}}for(z=0;z<I.length;z++)L=I[z].toLowerCase(),b.removeAttribute(L),b[L]=null;if(O)try{O=t.call(f.propsThis,"{"+O+"}"),a.mixin(y,O)}catch(R){throw Error(R.toString()+" in data-dojo-props\x3d'"+O+"'");}a.mixin(y,n);k||(k=e&&(e._noScript||x._noScript)?[]:r("\x3e script[type^\x3d'dojo/']",b));var U=[],W=[],fa=[],ea=[];if(k)for(M=0;M<k.length;M++)L=
k[M],b.removeChild(L),n=L.getAttribute(v+"event")||L.getAttribute("event"),f=L.getAttribute(v+"prop"),O=L.getAttribute(v+"method"),I=L.getAttribute(v+"advice"),z=L.getAttribute("type"),L=this._functionFromScript(L,v),n?"dojo/connect"==z?U.push({method:n,func:L}):"dojo/on"==z?ea.push({event:n,func:L}):y[n]=L:"dojo/aspect"==z?U.push({method:O,advice:I,func:L}):"dojo/watch"==z?fa.push({prop:f,func:L}):W.push(L);e=(k=e.markupFactory||x.markupFactory)?k(y,b,e):new e(y,b);return e.then?e.then(h):h(e)},
scan:function(a,c){function e(a){if(!a.inherited){a.inherited={};var c=a.node,b=e(a.parent),c={dir:c.getAttribute("dir")||b.dir,lang:c.getAttribute("lang")||b.lang,textDir:c.getAttribute(u)||b.textDir},g;for(g in c)c[g]&&(a.inherited[g]=c[g])}return a.inherited}var b=[],g=[],f={},k=(c.scope||l._scopeName)+"Type",t="data-"+(c.scope||l._scopeName)+"-",m=t+"type",u=t+"textdir",t=t+"mixins",v=a.firstChild,r=c.inherited;if(!r){var q=function(a,c){return a.getAttribute&&a.getAttribute(c)||a.parentNode&&
q(a.parentNode,c)},r={dir:q(a,"dir"),lang:q(a,"lang"),textDir:q(a,u)},w;for(w in r)r[w]||delete r[w]}for(var r={inherited:r},y,z;;)if(v)if(1!=v.nodeType)v=v.nextSibling;else if(y&&"script"==v.nodeName.toLowerCase())(T=v.getAttribute("type"))&&/^dojo\/\w/i.test(T)&&y.push(v),v=v.nextSibling;else if(z)v=v.nextSibling;else{var T=v.getAttribute(m)||v.getAttribute(k);w=v.firstChild;if(T||w&&(3!=w.nodeType||w.nextSibling)){z=null;if(T){var S=v.getAttribute(t);y=S?[T].concat(S.split(/\s*,\s*/)):[T];try{z=
x(y,c.contextRequire)}catch(R){}z||d.forEach(y,function(a){~a.indexOf("/")&&!f[a]&&(f[a]=!0,g[g.length]=a)});S=z&&!z.prototype._noScript?[]:null;r={types:y,ctor:z,parent:r,node:v,scripts:S};r.inherited=e(r);b.push(r)}else r={node:v,scripts:y,parent:r};y=S;z=v.stopParser||z&&z.prototype.stopParser&&!c.template;v=w}else v=v.nextSibling}else{if(!r||!r.node)break;v=r.node.nextSibling;z=!1;r=r.parent;y=r.scripts}var U=new n;g.length?(c.contextRequire||h)(g,function(){U.resolve(d.filter(b,function(a){if(!a.ctor)try{a.ctor=
x(a.types,c.contextRequire)}catch(e){}for(var b=a.parent;b&&!b.types;)b=b.parent;var g=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(g&&g.stopParser&&!c.template);a.instantiate=!b||b.instantiate&&b.instantiateChildren;return a.instantiate}))}):U.resolve(b);return U.promise},_require:function(c,e){var b=t("{"+c.innerHTML+"}"),g=[],d=[],f=new n,k=e&&e.contextRequire||h,m;for(m in b)g.push(m),d.push(b[m]);k(d,function(){for(var c=0;c<g.length;c++)a.setObject(g[c],arguments[c]);f.resolve(arguments)});
return f.promise},_scanAmd:function(a,c){var e=new n,b=e.promise;e.resolve(!0);var g=this;r("script[type\x3d'dojo/require']",a).forEach(function(a){b=b.then(function(){return g._require(a,c)});a.parentNode.removeChild(a)});return b},parse:function(c,e){!c||"string"==typeof c||"nodeType"in c||(e=c,c=e.rootNode);var b=c?f.byId(c):k.body();e=e||{};var g=e.template?{template:!0}:{},d=[],n=this,t=this._scanAmd(b,e).then(function(){return n.scan(b,e)}).then(function(a){return n._instantiate(a,g,e,!0)}).then(function(a){return d=
d.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});a.mixin(d,t);return d}};l.parser=z;b.parseOnLoad&&v(100,z,"parse");return z})},"dojo/_base/url":function(){define(["./kernel"],function(h){var l=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,a=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,d=function(){for(var b=arguments,f=[b[0]],k=1;k<b.length;k++)if(b[k]){var m=new d(b[k]+""),f=new d(f[0]+"");if(""==m.path&&!m.scheme&&
!m.authority&&!m.query)null!=m.fragment&&(f.fragment=m.fragment),m=f;else if(!m.scheme&&(m.scheme=f.scheme,!m.authority&&(m.authority=f.authority,"/"!=m.path.charAt(0)))){for(var f=(f.path.substring(0,f.path.lastIndexOf("/")+1)+m.path).split("/"),g=0;g<f.length;g++)"."==f[g]?g==f.length-1?f[g]="":(f.splice(g,1),g--):0<g&&(1!=g||""!=f[0])&&".."==f[g]&&".."!=f[g-1]&&(g==f.length-1?(f.splice(g,1),f[g-1]=""):(f.splice(g-1,2),g-=2));m.path=f.join("/")}f=[];m.scheme&&f.push(m.scheme,":");m.authority&&f.push("//",
m.authority);f.push(m.path);m.query&&f.push("?",m.query);m.fragment&&f.push("#",m.fragment)}this.uri=f.join("");b=this.uri.match(l);this.scheme=b[2]||(b[1]?"":null);this.authority=b[4]||(b[3]?"":null);this.path=b[5];this.query=b[7]||(b[6]?"":null);this.fragment=b[9]||(b[8]?"":null);null!=this.authority&&(b=this.authority.match(a),this.user=b[3]||null,this.password=b[4]||null,this.host=b[6]||b[7],this.port=b[9]||null)};d.prototype.toString=function(){return this.uri};return h._Url=d})},"dojo/promise/all":function(){define(["../_base/array",
"../Deferred","../when"],function(h,l,a){var d=h.some;return function(b){var f,k;b instanceof Array?k=b:b&&"object"===typeof b&&(f=b);var m,g=[];if(f){k=[];for(var e in f)Object.hasOwnProperty.call(f,e)&&(g.push(e),k.push(f[e]));m={}}else k&&(m=[]);if(!k||!k.length)return(new l).resolve(m);var c=new l;c.promise.always(function(){m=g=null});var n=k.length;d(k,function(e,b){f||g.push(b);a(e,function(a){c.isFulfilled()||(m[g[b]]=a,0===--n&&c.resolve(m))},c.reject);return c.isFulfilled()});return c.promise}})},
"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(h,l){var a={};h.setObject("dojo.date.stamp",a);a.fromISOString=function(d,b){a._isoRegExp||(a._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var f=a._isoRegExp.exec(d),k=null;if(f){f.shift();f[1]&&f[1]--;f[6]&&(f[6]*=1E3);b&&(b=new Date(b),l.forEach(l.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),function(a){return b["get"+
a]()}),function(a,c){f[c]=f[c]||a}));k=new Date(f[0]||1970,f[1]||0,f[2]||1,f[3]||0,f[4]||0,f[5]||0,f[6]||0);100>f[0]&&k.setFullYear(f[0]||1970);var m=0,g=f[7]&&f[7].charAt(0);"Z"!=g&&(m=60*(f[8]||0)+(Number(f[9])||0),"-"!=g&&(m*=-1));g&&(m-=k.getTimezoneOffset());m&&k.setTime(k.getTime()+6E4*m)}return k};a.toISOString=function(a,b){var f=function(a){return 10>a?"0"+a:a};b=b||{};var k=[],m=b.zulu?"getUTC":"get",g="";"time"!=b.selector&&(g=a[m+"FullYear"](),g=["0000".substr((g+"").length)+g,f(a[m+"Month"]()+
1),f(a[m+"Date"]())].join("-"));k.push(g);if("date"!=b.selector){g=[f(a[m+"Hours"]()),f(a[m+"Minutes"]()),f(a[m+"Seconds"]())].join(":");m=a[m+"Milliseconds"]();b.milliseconds&&(g+="."+(100>m?"0":"")+f(m));if(b.zulu)g+="Z";else if("time"!=b.selector)var m=a.getTimezoneOffset(),e=Math.abs(m),g=g+((0<m?"-":"+")+f(Math.floor(e/60))+":"+f(e%60));k.push(g)}return k.join("T")};return a})},"dojo/_base/Deferred":function(){define("./kernel ../Deferred ../promise/Promise ../errors/CancelError ../has ./lang ../when".split(" "),
function(h,l,a,d,b,f,k){var m=function(){},g=Object.freeze||function(){},e=h.Deferred=function(c){function n(a){if(u)throw Error("This deferred has already been resolved");r=a;u=!0;k()}function k(){for(var a;!a&&y;){var c=y;y=y.next;if(a=c.progress==m)u=!1;var e=h?c.error:c.resolved;b("config-useDeferredInstrumentation")&&h&&l.instrumentRejected&&l.instrumentRejected(r,!!e);if(e)try{var g=e(r);g&&"function"===typeof g.then?g.then(f.hitch(c.deferred,"resolve"),f.hitch(c.deferred,"reject"),f.hitch(c.deferred,
"progress")):(e=a&&void 0===g,a&&!e&&(h=g instanceof Error),c.deferred[e&&h?"reject":"resolve"](e?r:g))}catch(d){c.deferred.reject(d)}else h?c.deferred.reject(r):c.deferred.resolve(r)}}var r,u,v,t,h,x,y,z=this.promise=new a;this.isResolved=z.isResolved=function(){return 0==t};this.isRejected=z.isRejected=function(){return 1==t};this.isFulfilled=z.isFulfilled=function(){return 0<=t};this.isCanceled=z.isCanceled=function(){return v};this.resolve=this.callback=function(a){this.fired=t=0;this.results=
[a,null];n(a)};this.reject=this.errback=function(a){h=!0;this.fired=t=1;b("config-useDeferredInstrumentation")&&l.instrumentRejected&&l.instrumentRejected(a,!!y);n(a);this.results=[null,a]};this.progress=function(a){for(var c=y;c;){var e=c.progress;e&&e(a);c=c.next}};this.addCallbacks=function(a,c){this.then(a,c,m);return this};z.then=this.then=function(a,c,b){var g=b==m?this:new e(z.cancel);a={resolved:a,error:c,progress:b,deferred:g};y?x=x.next=a:y=x=a;u&&k();return g.promise};var A=this;z.cancel=
this.cancel=function(){if(!u){var a=c&&c(A);u||(a instanceof Error||(a=new d(a)),a.log=!1,A.reject(a))}v=!0};g(z)};f.extend(e,{addCallback:function(a){return this.addCallbacks(f.hitch.apply(h,arguments))},addErrback:function(a){return this.addCallbacks(null,f.hitch.apply(h,arguments))},addBoth:function(a){var e=f.hitch.apply(h,arguments);return this.addCallbacks(e,e)},fired:-1});e.when=h.when=k;return e})},"dojo/_base/xhr":function(){define("./kernel ./sniff require ../io-query ../dom ../dom-form ./Deferred ./config ./json ./lang ./array ../on ../aspect ../request/watch ../request/xhr ../request/util".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v){h._xhrObj=u._create;var t=h.config;h.objectToQuery=d.objectToQuery;h.queryToObject=d.queryToObject;h.fieldToObject=f.fieldToObject;h.formToObject=f.toObject;h.formToQuery=f.toQuery;h.formToJson=f.toJson;h._blockAsync=!1;l.add("native-xhr2-blob",function(){if(l("native-xhr2")){var a=new XMLHttpRequest;a.open("GET","/",!0);a.responseType="blob";var c=a.responseType;a.abort();return"blob"===c}});var w=h._contentHandlers=h.contentHandlers={text:function(a){return a.responseText},
json:function(a){return g.fromJson(a.responseText||null)},"json-comment-filtered":function(a){m.useCommentedJson||console.warn("Consider using the standard mimetype:application/json. json-commenting can introduce security issues. To decrease the chances of hijacking, use the standard the 'json' handler and prefix your json with: {}\x26\x26\nUse djConfig.useCommentedJson\x3dtrue to turn off this message.");a=a.responseText;var c=a.indexOf("/*"),e=a.lastIndexOf("*/");if(-1==c||-1==e)throw Error("JSON was not comment filtered");
return g.fromJson(a.substring(c+2,e))},javascript:function(a){return h.eval(a.responseText)},xml:function(a){var e=a.responseXML;e&&l("dom-qsa2.1")&&!e.querySelectorAll&&l("dom-parser")&&(e=(new DOMParser).parseFromString(a.responseText,"application/xml"));if(l("ie")&&(!e||!e.documentElement)){var b=function(a){return"MSXML"+a+".DOMDocument"},b=["Microsoft.XMLDOM",b(6),b(4),b(3),b(2)];c.some(b,function(c){try{var b=new ActiveXObject(c);b.async=!1;b.loadXML(a.responseText);e=b}catch(g){return!1}return!0})}return e},
"json-comment-optional":function(a){return a.responseText&&/^[^{\[]*\/\*/.test(a.responseText)?w["json-comment-filtered"](a):w.json(a)}};l("native-xhr2")&&(w.arraybuffer=w.blob=w.document=function(a,c){return"blob"!==c.args.handleAs||l("native-xhr2-blob")?a.response:new Blob([a.response],{type:a.getResponseHeader("Content-Type")})});h._ioSetArgs=function(a,c,g,n){var m={args:a,url:a.url},u=null;if(a.form){var u=b.byId(a.form),v=u.getAttributeNode("action");m.url=m.url||(v?v.value:h.doc?h.doc.URL:
null);u=f.toObject(u)}v=[{}];u&&v.push(u);a.content&&v.push(a.content);a.preventCache&&v.push({"dojo.preventCache":(new Date).valueOf()});m.query=d.objectToQuery(e.mixin.apply(null,v));m.handleAs=a.handleAs||"text";var r=new k(function(a){a.canceled=!0;c&&c(a);var e=a.ioArgs.error;e||(e=Error("request cancelled"),e.dojoType="cancel",a.ioArgs.error=e);return e});r.addCallback(g);var q=a.load;q&&e.isFunction(q)&&r.addCallback(function(c){return q.call(a,c,m)});var w=a.error;w&&e.isFunction(w)&&r.addErrback(function(c){return w.call(a,
c,m)});var x=a.handle;x&&e.isFunction(x)&&r.addBoth(function(c){return x.call(a,c,m)});r.addErrback(function(a){return n(a,r)});t.ioPublish&&h.publish&&!1!==m.args.ioPublish&&(r.addCallbacks(function(a){h.publish("/dojo/io/load",[r,a]);return a},function(a){h.publish("/dojo/io/error",[r,a]);return a}),r.addBoth(function(a){h.publish("/dojo/io/done",[r,a]);return a}));r.ioArgs=m;return r};var x=function(a){a=w[a.ioArgs.handleAs](a.ioArgs.xhr,a.ioArgs);return void 0===a?null:a},y=function(a,c){c.ioArgs.args.failOk||
console.error(a);return a},z=function(a){0>=A&&(A=0,t.ioPublish&&h.publish&&(!a||a&&!1!==a.ioArgs.args.ioPublish)&&h.publish("/dojo/io/stop"))},A=0;q.after(r,"_onAction",function(){--A});q.after(r,"_onInFlight",z);h._ioCancelAll=r.cancelAll;h._ioNotifyStart=function(a){t.ioPublish&&h.publish&&!1!==a.ioArgs.args.ioPublish&&(A||h.publish("/dojo/io/start"),A+=1,h.publish("/dojo/io/send",[a]))};h._ioWatch=function(a,c,b,g){a.ioArgs.options=a.ioArgs.args;e.mixin(a,{response:a.ioArgs,isValid:function(e){return c(a)},
isReady:function(c){return b(a)},handleResponse:function(c){return g(a)}});r(a);z(a)};h._ioAddQueryToUrl=function(a){a.query.length&&(a.url+=(-1==a.url.indexOf("?")?"?":"\x26")+a.query,a.query=null)};h.xhr=function(a,c,e){var b,g=h._ioSetArgs(c,function(a){b&&b.cancel()},x,y),d=g.ioArgs;"postData"in c?d.query=c.postData:"putData"in c?d.query=c.putData:"rawBody"in c?d.query=c.rawBody:(2<arguments.length&&!e||-1==="POST|PUT".indexOf(a.toUpperCase()))&&h._ioAddQueryToUrl(d);var n;l("native-xhr2")&&(n=
{arraybuffer:1,blob:1,document:1});n=l("native-xhr2")&&n[c.handleAs]?c.handleAs:"text";"blob"!==n||l("native-xhr2-blob")||(n="arraybuffer");n={method:a,handleAs:n,responseType:c.responseType,timeout:c.timeout,withCredentials:c.withCredentials,ioArgs:d};"undefined"!==typeof c.headers&&(n.headers=c.headers);"undefined"!==typeof c.contentType&&(n.headers||(n.headers={}),n.headers["Content-Type"]=c.contentType);"undefined"!==typeof d.query&&(n.data=d.query);"undefined"!==typeof c.sync&&(n.sync=c.sync);
h._ioNotifyStart(g);try{b=u(d.url,n,!0)}catch(f){return g.cancel(),g}g.ioArgs.xhr=b.response.xhr;b.then(function(){g.resolve(g)}).otherwise(function(a){d.error=a;a.response&&(a.status=a.response.status,a.responseText=a.response.text,a.xhr=a.response.xhr);g.reject(a)});return g};h.xhrGet=function(a){return h.xhr("GET",a)};h.rawXhrPost=h.xhrPost=function(a){return h.xhr("POST",a,!0)};h.rawXhrPut=h.xhrPut=function(a){return h.xhr("PUT",a,!0)};h.xhrDelete=function(a){return h.xhr("DELETE",a)};h._isDocumentOk=
function(a){return v.checkStatus(a.status)};h._getText=function(a){var c;h.xhrGet({url:a,sync:!0,load:function(a){c=a}});return c};e.mixin(h.xhr,{_xhrObj:h._xhrObj,fieldToObject:f.fieldToObject,formToObject:f.toObject,objectToQuery:d.objectToQuery,formToQuery:f.toQuery,formToJson:f.toJson,queryToObject:d.queryToObject,contentHandlers:w,_ioSetArgs:h._ioSetArgs,_ioCancelAll:h._ioCancelAll,_ioNotifyStart:h._ioNotifyStart,_ioWatch:h._ioWatch,_ioAddQueryToUrl:h._ioAddQueryToUrl,_isDocumentOk:h._isDocumentOk,
_getText:h._getText,get:h.xhrGet,post:h.xhrPost,put:h.xhrPut,del:h.xhrDelete});return h.xhr})},"dojo/io-query":function(){define(["./_base/lang"],function(h){var l={};return{objectToQuery:function(a){var d=encodeURIComponent,b=[],f;for(f in a){var k=a[f];if(k!=l[f]){var m=d(f)+"\x3d";if(h.isArray(k))for(var g=0,e=k.length;g<e;++g)b.push(m+d(k[g]));else b.push(m+d(k))}}return b.join("\x26")},queryToObject:function(a){var d=decodeURIComponent;a=a.split("\x26");for(var b={},f,k,m=0,g=a.length;m<g;++m)if(k=
a[m],k.length){var e=k.indexOf("\x3d");0>e?(f=d(k),k=""):(f=d(k.slice(0,e)),k=d(k.slice(e+1)));"string"==typeof b[f]&&(b[f]=[b[f]]);h.isArray(b[f])?b[f].push(k):b[f]=k}return b}}})},"dojo/dom-form":function(){define(["./_base/lang","./dom","./io-query","./json"],function(h,l,a,d){var b={fieldToObject:function(a){var b=null;if(a=l.byId(a)){var d=a.name,g=(a.type||"").toLowerCase();if(d&&g&&!a.disabled)if("radio"==g||"checkbox"==g)a.checked&&(b=a.value);else if(a.multiple)for(b=[],a=[a.firstChild];a.length;)for(d=
a.pop();d;d=d.nextSibling)if(1==d.nodeType&&"option"==d.tagName.toLowerCase())d.selected&&b.push(d.value);else{d.nextSibling&&a.push(d.nextSibling);d.firstChild&&a.push(d.firstChild);break}else b=a.value}return b},toObject:function(a){var d={};a=l.byId(a).elements;for(var m=0,g=a.length;m<g;++m){var e=a[m],c=e.name,n=(e.type||"").toLowerCase();if(c&&n&&0>"file|submit|image|reset|button".indexOf(n)&&!e.disabled){var q=d,r=c,e=b.fieldToObject(e);if(null!==e){var u=q[r];"string"==typeof u?q[r]=[u,e]:
h.isArray(u)?u.push(e):q[r]=e}"image"==n&&(d[c+".x"]=d[c+".y"]=d[c].x=d[c].y=0)}}return d},toQuery:function(d){return a.objectToQuery(b.toObject(d))},toJson:function(a,k){return d.stringify(b.toObject(a),null,k?4:0)}};return b})},"dojo/json":function(){define(["./has"],function(h){var l="undefined"!=typeof JSON;h.add("json-parse",l);h.add("json-stringify",l&&'{"a":1}'==JSON.stringify({a:0},function(a,b){return b||1}));if(h("json-stringify"))return JSON;var a=function(a){return('"'+a.replace(/(["\\])/g,
"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")};return{parse:h("json-parse")?JSON.parse:function(a,b){if(b&&!/^([\s\[\{]*(?:"(?:\\.|[^"])*"|-?\d[\d\.]*(?:[Ee][+-]?\d+)?|null|true|false|)[\s\]\}]*(?:,|:|$))+$/.test(a))throw new SyntaxError("Invalid characters in JSON");return eval("("+a+")")},stringify:function(d,b,f){function k(g,e,c){b&&(g=b(c,g));var d;d=typeof g;if("number"==d)return isFinite(g)?g+"":"null";if("boolean"==
d)return g+"";if(null===g)return"null";if("string"==typeof g)return a(g);if("function"==d||"undefined"==d)return m;if("function"==typeof g.toJSON)return k(g.toJSON(c),e,c);if(g instanceof Date)return'"{FullYear}-{Month+}-{Date}T{Hours}:{Minutes}:{Seconds}Z"'.replace(/\{(\w+)(\+)?\}/g,function(a,c,e){a=g["getUTC"+c]()+(e?1:0);return 10>a?"0"+a:a});if(g.valueOf()!==g)return k(g.valueOf(),e,c);var q=f?e+f:"",r=f?" ":"",u=f?"\n":"";if(g instanceof Array){var r=g.length,v=[];for(c=0;c<r;c++)d=k(g[c],q,
c),"string"!=typeof d&&(d="null"),v.push(u+q+d);return"["+v.join(",")+u+e+"]"}v=[];for(c in g){var t;if(g.hasOwnProperty(c)){if("number"==typeof c)t='"'+c+'"';else if("string"==typeof c)t=a(c);else continue;d=k(g[c],q,c);"string"==typeof d&&v.push(u+q+t+":"+r+d)}}return"{"+v.join(",")+u+e+"}"}var m;"string"==typeof b&&(f=b,b=null);return k(d,"","")}}})},"dojo/_base/json":function(){define(["./kernel","../json"],function(h,l){h.fromJson=function(a){return eval("("+a+")")};h._escapeString=l.stringify;
h.toJsonIndentStr="\t";h.toJson=function(a,d){return l.stringify(a,function(a,d){if(d){var k=d.__json__||d.json;if("function"==typeof k)return k.call(d)}return d},d&&h.toJsonIndentStr)};return h})},"dojo/request/watch":function(){define("./util ../errors/RequestTimeoutError ../errors/CancelError ../_base/array ../_base/window ../has!host-browser?dom-addeventlistener?:../on:".split(" "),function(h,l,a,d,b,f){function k(){for(var a=+new Date,b=0,d;b<e.length&&(d=e[b]);b++){var f=d.response,k=f.options;
d.isCanceled&&d.isCanceled()||d.isValid&&!d.isValid(f)?(e.splice(b--,1),m._onAction&&m._onAction()):d.isReady&&d.isReady(f)?(e.splice(b--,1),d.handleResponse(f),m._onAction&&m._onAction()):d.startTime&&d.startTime+(k.timeout||0)<a&&(e.splice(b--,1),d.cancel(new l("Timeout exceeded",f)),m._onAction&&m._onAction())}m._onInFlight&&m._onInFlight(d);e.length||(clearInterval(g),g=null)}function m(a){a.response.options.timeout&&(a.startTime=+new Date);a.isFulfilled()||(e.push(a),g||(g=setInterval(k,50)),
a.response.options.sync&&k())}var g=null,e=[];m.cancelAll=function(){try{d.forEach(e,function(c){try{c.cancel(new a("All requests canceled."))}catch(e){}})}catch(c){}};b&&f&&b.doc.attachEvent&&f(b.global,"unload",function(){m.cancelAll()});return m})},"dojo/request/util":function(){define("exports ../errors/RequestError ../errors/CancelError ../Deferred ../io-query ../_base/array ../_base/lang ../promise/Promise".split(" "),function(h,l,a,d,b,f,k,m){function g(a){return c(a)}function e(a){return void 0!==
a.data?a.data:a.text}h.deepCopy=function(a,c){for(var e in c){var b=a[e],g=c[e];b!==g&&(b&&"object"===typeof b&&g&&"object"===typeof g?h.deepCopy(b,g):a[e]=g)}return a};h.deepCreate=function(a,c){c=c||{};var e=k.delegate(a),b,g;for(b in a)(g=a[b])&&"object"===typeof g&&(e[b]=h.deepCreate(g,c[b]));return h.deepCopy(e,c)};var c=Object.freeze||function(a){return a};h.deferred=function(b,f,r,u,v,t){var w=new d(function(c){f&&f(w,b);return c&&(c instanceof l||c instanceof a)?c:new a("Request canceled",
b)});w.response=b;w.isValid=r;w.isReady=u;w.handleResponse=v;r=w.then(g).otherwise(function(a){a.response=b;throw a;});h.notify&&r.then(k.hitch(h.notify,"emit","load"),k.hitch(h.notify,"emit","error"));u=r.then(e);v=new m;for(var x in u)u.hasOwnProperty(x)&&(v[x]=u[x]);v.response=r;c(v);t&&w.then(function(a){t.call(w,a)},function(a){t.call(w,b,a)});w.promise=v;w.then=v.then;return w};h.addCommonMethods=function(a,c){f.forEach(c||["GET","POST","PUT","DELETE"],function(c){a[("DELETE"===c?"DEL":c).toLowerCase()]=
function(e,b){b=k.delegate(b||{});b.method=c;return a(e,b)}})};h.parseArgs=function(a,c,e){var g=c.data,d=c.query;!g||e||"object"!==typeof g||g instanceof ArrayBuffer||g instanceof Blob||(c.data=b.objectToQuery(g));d?("object"===typeof d&&(d=b.objectToQuery(d)),c.preventCache&&(d+=(d?"\x26":"")+"request.preventCache\x3d"+ +new Date)):c.preventCache&&(d="request.preventCache\x3d"+ +new Date);a&&d&&(a+=(~a.indexOf("?")?"\x26":"?")+d);return{url:a,options:c,getHeader:function(a){return null}}};h.checkStatus=
function(a){a=a||0;return 200<=a&&300>a||304===a||1223===a||!a}})},"dojo/errors/RequestError":function(){define(["./create"],function(h){return h("RequestError",function(h,a){this.response=a})})},"dojo/errors/RequestTimeoutError":function(){define(["./create","./RequestError"],function(h,l){return h("RequestTimeoutError",null,l,{dojoType:"timeout"})})},"dojo/request/xhr":function(){define(["../errors/RequestError","./watch","./handlers","./util","../has"],function(h,l,a,d,b){function f(c,e){var b=
c.xhr;c.status=c.xhr.status;try{c.text=b.responseText}catch(g){}"xml"===c.options.handleAs&&(c.data=b.responseXML);if(!e)try{a(c)}catch(n){e=n}var f;if(e)this.reject(e);else{try{a(c)}catch(k){f=k}d.checkStatus(b.status)?f?this.reject(f):this.resolve(c):(e=f?new h("Unable to load "+c.url+" status: "+b.status+" and an error in handleAs: transformation of response",c):new h("Unable to load "+c.url+" status: "+b.status,c),this.reject(e))}}function k(a){return this.xhr.getResponseHeader(a)}function m(a,
t,v){var z=b("native-formdata")&&t&&t.data&&t.data instanceof FormData,A=d.parseArgs(a,d.deepCreate(u,t),z);a=A.url;t=A.options;var B,C=d.deferred(A,q,e,c,f,function(){B&&B()}),D=A.xhr=m._create();if(!D)return C.cancel(new h("XHR was not created")),v?C:C.promise;A.getHeader=k;n&&(B=n(D,C,A));var E=t.data,F=!t.sync,H=t.method;try{D.open(H,a,F,t.user||r,t.password||r);t.withCredentials&&(D.withCredentials=t.withCredentials);b("native-response-type")&&t.handleAs in g&&(D.responseType=g[t.handleAs]);
var G=t.headers;a=z?!1:"application/x-www-form-urlencoded";if(G)for(var K in G)"content-type"===K.toLowerCase()?a=G[K]:G[K]&&D.setRequestHeader(K,G[K]);a&&!1!==a&&D.setRequestHeader("Content-Type",a);G&&"X-Requested-With"in G||D.setRequestHeader("X-Requested-With","XMLHttpRequest");d.notify&&d.notify.emit("send",A,C.promise.cancel);D.send(E)}catch(J){C.reject(J)}l(C);D=null;return v?C:C.promise}b.add("native-xhr",function(){return"undefined"!==typeof XMLHttpRequest});b.add("dojo-force-activex-xhr",
function(){return b("activex")&&"file:"===window.location.protocol});b.add("native-xhr2",function(){if(b("native-xhr")&&!b("dojo-force-activex-xhr")){var a=new XMLHttpRequest;return"undefined"!==typeof a.addEventListener&&("undefined"===typeof opera||"undefined"!==typeof a.upload)}});b.add("native-formdata",function(){return"undefined"!==typeof FormData});b.add("native-response-type",function(){return b("native-xhr")&&"undefined"!==typeof(new XMLHttpRequest).responseType});b.add("native-xhr2-blob",
function(){if(b("native-response-type")){var a=new XMLHttpRequest;a.open("GET","/",!0);a.responseType="blob";var c=a.responseType;a.abort();return"blob"===c}});var g={blob:b("native-xhr2-blob")?"blob":"arraybuffer",document:"document",arraybuffer:"arraybuffer"},e,c,n,q;b("native-xhr2")?(e=function(a){return!this.isFulfilled()},q=function(a,c){c.xhr.abort()},n=function(a,c,e){function b(a){c.handleResponse(e)}function g(a){a=new h("Unable to load "+e.url+" status: "+a.target.status,e);c.handleResponse(e,
a)}function d(a){a.lengthComputable?(e.loaded=a.loaded,e.total=a.total,c.progress(e)):3===e.xhr.readyState&&(e.loaded="loaded"in a?a.loaded:a.position,c.progress(e))}a.addEventListener("load",b,!1);a.addEventListener("error",g,!1);a.addEventListener("progress",d,!1);return function(){a.removeEventListener("load",b,!1);a.removeEventListener("error",g,!1);a.removeEventListener("progress",d,!1);a=null}}):(e=function(a){return a.xhr.readyState},c=function(a){return 4===a.xhr.readyState},q=function(a,
c){var e=c.xhr,b=typeof e.abort;"function"!==b&&"object"!==b&&"unknown"!==b||e.abort()});var r,u={data:null,query:null,sync:!1,method:"GET"};m._create=function(){throw Error("XMLHTTP not available");};if(b("native-xhr")&&!b("dojo-force-activex-xhr"))m._create=function(){return new XMLHttpRequest};else if(b("activex"))try{new ActiveXObject("Msxml2.XMLHTTP"),m._create=function(){return new ActiveXObject("Msxml2.XMLHTTP")}}catch(v){try{new ActiveXObject("Microsoft.XMLHTTP"),m._create=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}catch(t){}}d.addCommonMethods(m);
return m})},"dojo/request/handlers":function(){define(["../json","../_base/kernel","../_base/array","../has","../selector/_loader"],function(h,l,a,d){function b(a){var b=e[a.options.handleAs];a.data=b?b(a):a.data||a.text;return a}d.add("activex","undefined"!==typeof ActiveXObject);d.add("dom-parser",function(a){return"DOMParser"in a});var f;if(d("activex")){var k=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML.DOMDocument"],m;f=function(c){function e(a){try{var c=
new ActiveXObject(a);c.async=!1;c.loadXML(g);b=c;m=a}catch(d){return!1}return!0}var b=c.data,g=c.text;b&&d("dom-qsa2.1")&&!b.querySelectorAll&&d("dom-parser")&&(b=(new DOMParser).parseFromString(g,"application/xml"));b&&b.documentElement||m&&e(m)||a.some(k,e);return b}}var g=function(a){return d("native-xhr2-blob")||"blob"!==a.options.handleAs||"undefined"===typeof Blob?a.xhr.response:new Blob([a.xhr.response],{type:a.xhr.getResponseHeader("Content-Type")})},e={javascript:function(a){return l.eval(a.text||
"")},json:function(a){return h.parse(a.text||null)},xml:f,blob:g,arraybuffer:g,document:g};b.register=function(a,b){e[a]=b};return b})},"dojo/i18n":function(){define("./_base/kernel require ./has ./_base/array ./_base/config ./_base/lang ./_base/xhr ./json module".split(" "),function(h,l,a,d,b,f,k,m,g){a.add("dojo-preload-i18n-Api",1);k=h.i18n={};var e=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,c=function(a,c,e,b){var g=[e+b];c=c.split("-");for(var d="",n=0;n<c.length;n++)if(d+=(d?"-":"")+c[n],!a||
a[d])g.push(e+d+"/"+b),g.specificity=d;return g},n={},q=function(a,c,e){e=e?e.toLowerCase():h.locale;a=a.replace(/\./g,"/");c=c.replace(/\./g,"/");return/root/i.test(e)?a+"/nls/"+c:a+"/nls/"+e+"/"+c},r=h.getL10nName=function(a,c,e){return g.id+"!"+q(a,c,e)},u=function(a,e,b,g,d,k){a([e],function(t){var m=f.clone(t.root||t.ROOT),u=c(!t._v1x&&t,d,b,g);a(u,function(){for(var a=1;a<u.length;a++)m=f.mixin(f.clone(m),arguments[a]);n[e+"/"+d]=m;m.$locale=u.specificity;k()})})},v=function(a){var c=b.extraLocale||
[],c=f.isArray(c)?c:[c];c.push(a);return c},t=function(c,b,g){var k=c.split("*"),t="preload"==k[1];if(a("dojo-preload-i18n-Api")){if(t&&(n[c]||(n[c]=1,z(k[2],m.parse(k[3]),1,b)),g(1)),(k=t)||(x&&y.push([c,b,g]),k=x),k)return}else if(t){g(1);return}c=e.exec(c);var r=c[1]+"/",q=c[5]||c[4],w=r+q,k=(c=c[5]&&c[4])||h.locale||"",l=w+"/"+k;c=c?[k]:v(k);var I=c.length,L=function(){--I||g(f.delegate(n[l]))};d.forEach(c,function(c){var e=w+"/"+c;a("dojo-preload-i18n-Api")&&A(e);n[e]?L():u(b,w,r,q,c,L)})};a("dojo-preload-i18n-Api");
var w=k.normalizeLocale=function(a){a=a?a.toLowerCase():h.locale;return"root"==a?"ROOT":a},x=0,y=[],z=k._preloadLocalizations=function(a,c,e,b){function g(a,c){b([a],c)}function k(a,c){for(var e=a.split("-");e.length;){if(c(e.join("-")))return;e.pop()}c("ROOT")}function m(){for(--x;!x&&y.length;)t.apply(null,y.shift())}function u(e){e=w(e);k(e,function(t){if(0<=d.indexOf(c,t)){var u=a.replace(/\./g,"/")+"_"+t;x++;g(u,function(a){for(var c in a){var g=a[c],d=c.match(/(.+)\/([^\/]+)$/),u;if(d&&(u=d[2],
d=d[1]+"/",g._localized)){var r;if("ROOT"===t){var v=r=g._localized;delete g._localized;v.root=g;n[l.toAbsMid(c)]=v}else r=g._localized,n[l.toAbsMid(d+u+"/"+t)]=g;t!==e&&function(a,c,g,d){var t=[],u=[];k(e,function(e){d[e]&&(t.push(l.toAbsMid(a+e+"/"+c)),u.push(l.toAbsMid(a+c+"/"+e)))});t.length?(x++,b(t,function(){for(var b=t.length-1;0<=b;b--)g=f.mixin(f.clone(g),arguments[b]),n[u[b]]=g;n[l.toAbsMid(a+c+"/"+e)]=f.clone(g);m()})):n[l.toAbsMid(a+c+"/"+e)]=g}(d,u,g,r)}}m()});return!0}return!1})}b=
b||l;u();d.forEach(h.config.extraLocale,u)},A=function(){};new Function("__bundle","__checkForLegacyModules","__mid","__amdValue","var define \x3d function(mid, factory){define.called \x3d 1; __amdValue.result \x3d factory || mid;},\t   require \x3d function(){define.called \x3d 1;};try{define.called \x3d 0;eval(__bundle);if(define.called\x3d\x3d1)return __amdValue;if((__checkForLegacyModules \x3d __checkForLegacyModules(__mid)))return __checkForLegacyModules;}catch(e){}try{return eval('('+__bundle+')');}catch(e){return e;}");
A=function(a){for(var c,e=a.split("/"),b=h.global[e[0]],g=1;b&&g<e.length-1;b=b[e[g++]]);b&&((c=b[e[g]])||(c=b[e[g].replace(/-/g,"_")]),c&&(n[a]=c));return c};k.getLocalization=function(a,c,e){var b;a=q(a,c,e);t(a,l,function(a){b=a});return b};return f.mixin(k,{dynamic:!0,normalize:function(a,c){return/^\./.test(a)?c(a):a},load:t,cache:n,getL10nName:r})})},"dijit/nls/loading":function(){define({root:{loadingState:"Loading...",errorState:"Sorry, an error occurred"},bs:!0,mk:!0,sr:!0,zh:!0,"zh-tw":!0,
vi:!0,uk:!0,tr:!0,th:!0,sv:!0,sl:!0,sk:!0,ru:!0,ro:!0,pt:!0,"pt-pt":!0,pl:!0,nl:!0,nb:!0,lv:!0,lt:!0,ko:!0,kk:!0,ja:!0,it:!0,id:!0,hu:!0,hr:!0,he:!0,fr:!0,fi:!0,eu:!0,et:!0,es:!0,el:!0,de:!0,da:!0,cs:!0,ca:!0,bg:!0,az:!0,ar:!0})},"esri/dijit/PopupMobile":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style ../InfoWindowBase ../PopupBase ./InfoView ./NavigationBar ../kernel ../domUtils dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A){h=l([v,t],{declaredClass:"esri.dijit.PopupMobile",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:10,marginTop:10,highlight:!0,popupNavigationBar:null,popupInfoView:null,location:null,xIcon:h.toUrl("./images/whitex.png"),dArrowIcon:h.toUrl("./images/whitedown.png"),lArrowIcon:h.toUrl("./images/whitel.png"),rArrowIcon:h.toUrl("./images/whiter.png"),constructor:function(b,g){this.initialize();a.mixin(this,b);this.domNode=e.byId(g);this._nls=a.mixin({},
A.widgets.popup);var f=this.domNode;n.add(f,"esriPopupMobile");c.set(f,"innerHTML","\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv style\x3d'text-align:center'\x3e\x3cdiv class\x3d'titleButton prev hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'footer' style\x3d'display:inline-block;width:60px;height:15px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton arrow hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer top hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer bottom hidden'\x3e\x3c/div\x3e");
var t=k.query(".titlePane",f)[0];this._arrowButton=k.query(".arrow",t)[0];this._pointerTop=k.query(".top",f)[0];this._pointerBottom=k.query(".bottom",f)[0];this._title=k.query(".title",t)[0];this._footer=k.query(".footer",t)[0];this._prev=k.query(".prev",t)[0];this._next=k.query(".next",t)[0];this._spinner=k.query(".spinner",t)[0];this._eventConnections=[d.connect(k.query(".close",t)[0],"onclick",this,this.hide),d.connect(this._arrowButton,"onclick",this,this._toggleView),d.connect(this._prev,"onclick",
this,function(){this.selectPrevious();this._updateUI()}),d.connect(this._next,"onclick",this,function(){this.selectNext();this._updateUI()})];this._initPopupNavigationBar();this._initPopupInfoView();z.hide(f);this.isShowing=!1},setMap:function(a){this.inherited(arguments);q.place(this.domNode,a.root);this.highlight&&this.enableHighlight(a)},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(a,c){this.destroyDijits(this._title);this.place(a,this._title);
this.destroyDijits(this._footer);this.place(c,this._footer);this.isShowing&&(this.startupDijits(this._title),this.startupDijits(this._footer))},setContent:function(a){this.destroyDijits(this._contentPane);this.place(a,this._contentPane);this.startupDijits(this._contentPane)},show:function(a){if(!a)return z.show(this.domNode),void(this.isShowing=!0);var c,e=this.map;a.spatialReference?(this.location=a,c=e.toScreen(a)):(this.location=e.toMap(a),c=a);this._maximized?this.restore():this._setPosition(c);
this.isShowing||(z.show(this.domNode),this.isShowing=!0,this.onShow())},hide:function(){this.isShowing&&(z.hide(this.domNode),this.isShowing=!1,this.onHide())},onShow:function(){this._followMap();this.startupDijits(this._title);this.showHighlight()},onHide:function(){this._unfollowMap();this.hideHighlight()},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);this.destroyDijits(this._footer);b.forEach(this._eventConnections,d.disconnect);
q.destroy(this.domNode)},selectNext:function(){this.select(this.selectedIndex+1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(){this.inherited(arguments);this._updateUI()},onSetFeatures:function(){},onClearFeatures:function(){this.setTitle("\x26nbsp;","\x26nbsp;");n.add(this._arrowButton,"hidden");this._updateUI();this.hideHighlight()},onSelectionChange:function(){var a=this.selectedIndex;this._updateUI();0<=a&&(this.setContent(this.features[a].getContent()),
this.updateHighlight(this.map,this.features[a]),this.isShowing&&this.showHighlight())},onDfdComplete:function(){this._updateUI()},_followMap:function(){this._unfollowMap();var a=this.map;this._handles=[d.connect(a,"onPanStart",this,this._onPanStart),d.connect(a,"onPan",this,this._onPan),d.connect(a,"onZoomStart",this,this._onZoomStart),d.connect(a,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var a=this._handles;a&&(b.forEach(a,d.disconnect),this._handles=null)},_onPanStart:function(){var a=
this.domNode.style;this._panOrigin={left:a.left,top:a.top,right:a.right,bottom:a.bottom}},_onPan:function(a,c){var e=this._panOrigin,b=c.x,g=c.y,d=e.left,n=e.top,f=e.right,e=e.bottom;d&&(d=parseFloat(d)+b+"px");n&&(n=parseFloat(n)+g+"px");f&&(f=parseFloat(f)-b+"px");e&&(e=parseFloat(e)-g+"px");u.set(this.domNode,{left:d,top:n,right:f,bottom:e})},_onZoomStart:function(){z.hide(this.domNode)},_onExtentChange:function(a,c,e){e&&(z.show(this.domNode),this.show(this._targetLocation||this.location),this._targetLocation=
null)},_setPosition:function(a){var c=a.x;a=a.y;var e=r.getContentBox(this.map.container),b=e.w,e=e.h,g=0,d=a+10,f=118,k=b-18;18<c&&k>c?(g=c-130,0>g?g=0:g>b-260&&(g=b-260)):18>=c?g=c-18:c>=k&&(g=b-260+(c-k));118<c&&b-130>c?f=118:118>=c?18<c?f=c-12:18>=c&&(f=6):c>=b-130&&(k>c?f=118+c-(b-130):c>=k&&(f=118+k-(b-130)));e/2>=a?(u.set(this.domNode,{left:g+"px",top:d+"px",bottom:null}),u.set(this._pointerTop,{left:f+"px"}),n.add(this._pointerBottom,"hidden"),n.remove(this._pointerTop,"hidden")):(u.set(this.domNode,
{left:g+"px",top:d-64+"px",bottom:null}),u.set(this._pointerBottom,{left:f+"px"}),n.add(this._pointerTop,"hidden"),n.remove(this._pointerBottom,"hidden"))},_showPointer:function(a){b.forEach(["topLeft","topRight","bottomRight","bottomLeft"],function(c){c===a?k.query(".pointer."+c,this.domNode).removeClass("hidden"):k.query(".pointer."+c,this.domNode).addClass("hidden")},this)},_toggleView:function(){this.popupNavigationBar||this._initPopupNavigationBar();this.popupInfoView||this._initPopupInfoView();
this.hide();z.show(this.popupNavigationBar.container);z.show(this.popupInfoView.container);0<=this.selectedIndex&&this.setContent(this.features[this.selectedIndex].getContent())},_handleNavigationBar:function(a){switch(this.popupInfoView.animateTo(0),a.name){case "CloseButton":z.hide(this.popupNavigationBar.container);z.hide(this.popupInfoView.container);this.hide();break;case "ToggleButton":z.hide(this.popupNavigationBar.container);z.hide(this.popupInfoView.container);this.show(this.location);break;
case "PreviousButton":this.selectPrevious();this._updateUI();break;case "NextButton":this.selectNext(),this._updateUI()}},_initPopupNavigationBar:function(){var a={};a.items=[{name:"CloseButton",type:"img",src:this.xIcon,srcAlt:this.xIcon,position:"left"},{name:"Title",type:"span",text:"",position:"center"},{name:"ToggleButton",type:"img",src:this.dArrowIcon,srcAlt:this.dArrowIcon,position:"right",toggleGroup:"toggle"},{name:"PreviousButton",type:"img",src:this.lArrowIcon,srcAlt:this.lArrowIcon,position:"right2",
toggleGroup:"previous"},{name:"NextButton",type:"img",src:this.rArrowIcon,srcAlt:this.rArrowIcon,position:"right1",toggleGroup:"next"}];this.popupNavigationBar=new x(a,q.create("div",{},f.body()));d.connect(this.popupNavigationBar,"onCreate",this,function(a){this._prevFeatureButton=a[3]._node;this._nextFeatureButton=a[4]._node});d.connect(this.popupNavigationBar,"onSelect",this,this._handleNavigationBar);d.connect(this.popupNavigationBar,"onUnSelect",this,this._handleNavigationBar);this.popupNavigationBar.startup();
z.hide(this.popupNavigationBar.container)},_initPopupInfoView:function(){this.popupInfoView=new w({items:[{name:"Navigator",type:"div",text:""},{name:"content",type:"div",text:""},{name:"attachment",type:"div",text:""}]},q.create("div",{},f.body()));n.add(this.popupInfoView.container,"esriMobilePopupInfoView");this.popupInfoView.enableTouchScroll();d.connect(this.popupInfoView,"onCreate",this,function(a){this._contentPane=a[1]._node;0<=this.selectedIndex&&this.setContent(this.features[this.selectedIndex].getContent())});
d.connect(this.popupInfoView,"onSwipeLeft",this,function(){});d.connect(this.popupInfoView,"onSwipeRight",this,function(){});this.popupInfoView.startup()},_updateUI:function(){var a="\x26nbsp;",c="\x26nbsp;",e=this.selectedIndex,b=this.features,g=this.deferreds,d=this._prevFeatureButton.parentNode,f=this._nextFeatureButton.parentNode,k=this._spinner,t=this._nls;b&&1<=b.length?(a=b[e].getTitle(),c=e+1+" of "+b.length,n.remove(this._arrowButton,"hidden"),0===e?(n.add(d,"hidden"),n.add(this._prev,"hidden")):
(n.remove(d,"hidden"),n.remove(this._prev,"hidden")),e===b.length-1?(n.add(f,"hidden"),n.add(this._next,"hidden")):(n.remove(f,"hidden"),n.remove(this._next,"hidden"))):(n.add(this._arrowButton,"hidden"),n.add(d,"hidden"),n.add(f,"hidden"),n.add(this._prev,"hidden"),n.add(this._next,"hidden"));this.setTitle(a,c);this.popupNavigationBar.getItems()[1]._node.innerHTML=c;g&&g.length?(n.remove(k,"hidden"),this.setTitle(t.NLS_searching+"...","\x26nbsp;")):(n.add(k,"hidden"),b&&b.length||this.setTitle("No Information",
"\x26nbsp;"))}});return m("extend-esri")&&a.setObject("dijit.PopupMobile",h,y),h})},"esri/InfoWindowBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/dom-construct dojo/has dijit/registry ./kernel ./lang ./geometry/ScreenPoint".split(" "),function(h,l,a,d,b,f,k,m,g,e,c){h=h(null,{declaredClass:"esri.InfoWindowBase",constructor:function(){var a=l.hitch;this.__set_title=a(this,this.__set_title);this.__err_title=a(this,this.__err_title);
this.__set_content=a(this,this.__set_content);this.__err_content=a(this,this.__err_content)},setMap:function(a){this.map=a},unsetMap:function(a){delete this.map},setTitle:function(){},setContent:function(){},show:function(){},hide:function(){},resize:function(){},onShow:function(){},onHide:function(){},place:function(a,c){e.isDefined(a)?l.isObject(a)?f.place(a,c,"only"):c.innerHTML=a:c.innerHTML=""},startupDijits:function(a){this._processDijits(a)},destroyDijits:function(a){this._processDijits(a,
!0)},_processDijits:function(c,e){if(c&&1===c.children.length){var b=c.children[0];if(b){var g=m.byNode(b),b=g?[g]:m.findWidgets(b);a.forEach(b,function(a){if(e){if(a._started&&!a._destroyed)try{a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy()}catch(c){}}else if(!a._started)try{a.startup()}catch(b){}})}}},__registerMapListeners:function(){this.__unregisterMapListeners();var a=this.map;this.__handles=[d.connect(a,"onPan",this,this.__onMapPan),d.connect(a,"onZoomStart",this,this.__onMapZmStart),
d.connect(a,"onExtentChange",this,this.__onMapExtChg)]},__unregisterMapListeners:function(){var c=this.__handles;c&&(a.forEach(c,d.disconnect,d),this.__handles=null)},__onMapPan:function(a,c){this.move(c,!0)},__onMapZmStart:function(){this.__mcoords=this.mapCoords||this.map.toMap(new c(this.coords));this.hide(null,!0)},__onMapExtChg:function(a,c,e){a=this.map;var b=this.mapCoords;b?this.show(b,null,!0):(c=e?a.toScreen(this.__mcoords):this.coords.offset(c&&c.x||0,c&&c.y||0),this.show(c,null,!0))},
__setValue:function(a,c){this[a].innerHTML="";var g="_dfd"+a,d=this[g];d&&-1===d.fired&&(d.cancel(),this[g]=null);e.isDefined(c)&&(c instanceof b?(this[g]=c,c.addCallbacks(this["__set"+a],this["__err"+a])):this.__render(a,c))},__set_title:function(a){this._dfd_title=null;this.__render("_title",a)},__err_title:function(a){this._dfd_title=null},__set_content:function(a){this._dfd_content=null;this.__render("_content",a)},__err_content:function(a){this._dfd_content=null},__render:function(a,c){var e=
this[a];this.place(c,e);this.isShowing&&(this.startupDijits(e),"_title"===a&&this._adjustContentArea&&this._adjustContentArea())}});return k("extend-esri")&&(g.InfoWindowBase=h),h})},"esri/kernel":function(){define(["dojo/_base/kernel","dojo/_base/config","dojo/has"],function(h,l,a){var d=function(){return this}(),b=d.location,f=b.pathname,k=b.protocol,b={version:"3.19",_appBaseUrl:k+"//"+b.host+f.substring(0,f.lastIndexOf(f.split("/")[f.split("/").length-1]))};l.noGlobals||(d.esri=b);h.isAsync||
a.add("extend-esri",1);return(b.dijit=b.dijit||{})._arcgisUrl=("http:"===k||"https:"===k?k:"http:")+"//www.arcgis.com/sharing/rest",b})},"esri/lang":function(){define("dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date dojo/has dojo/number dojo/date/locale ./kernel".split(" "),function(h,l,a,d,b,f,k,m,g){function e(c,e,b){return[d.isString(c)?c.split(""):c,e||a.global,d.isString(b)?new Function("item","index","array",b):b]}function c(a){return void 0!==a&&null!==a}function n(a){return c(a)?
a:""}function q(a,e,g){var f,t=g.match(/([^\(]+)(\([^\)]+\))?/i),v=d.trim(t[1]);g=e[a];var t=l.fromJson((t[2]?d.trim(t[2]):"()").replace(/^\(/,"({").replace(/\)$/,"})")),r=t.utcOffset;if(-1===h.indexOf(u,v))f=d.getObject(v),d.isFunction(f)&&(g=f(g,a,e,t));else if("number"==typeof g||"string"==typeof g&&g&&!isNaN(Number(g)))switch(g=Number(g),v){case "NumberFormat":return k.format(g,t);case "DateString":return f=new Date(g),t.local||t.systemLocale?t.systemLocale?f.toLocaleDateString()+(t.hideTime?
"":" "+f.toLocaleTimeString()):f.toDateString()+(t.hideTime?"":" "+f.toTimeString()):(f=f.toUTCString(),t.hideTime&&(f=f.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,"")),f);case "DateFormat":return f=new Date(g),c(r)&&(f=b.add(f,"minute",f.getTimezoneOffset()-r)),m.format(f,t)}return n(g)}function r(a,c){var e;if(c)for(e in a)a.hasOwnProperty(e)&&(void 0===a[e]?delete a[e]:a[e]instanceof Object&&r(a[e],!0));else for(e in a)a.hasOwnProperty(e)&&void 0===a[e]&&delete a[e];return a}var u=["NumberFormat",
"DateString","DateFormat"],v=/<\/?[^>]+>/g,t={valueOf:function(a,c){for(var e in a)if(a[e]==c)return e;return null},stripTags:function(a){if(a){var c=typeof a;if("string"===c)a=a.replace(v,"");else if("object"===c)for(var e in a)(c=a[e])&&"string"==typeof c&&(c=c.replace(v,"")),a[e]=c}return a},substitute:function(a,e,b){var g,f,k;if(c(b)&&(d.isObject(b)?(g=b.first,f=b.dateFormat,k=b.numberFormat):g=b),e&&"${*}"!==e)return d.replace(e,d.hitch({obj:a},function(a,c){var e=c.split(":");return 1<e.length?
(c=e[0],e.shift(),q(c,this.obj,e.join(":"))):f&&-1!==h.indexOf(f.properties||"",c)?q(c,this.obj,f.formatter||"DateString"):k&&-1!==h.indexOf(k.properties||"",c)?q(c,this.obj,k.formatter||"NumberFormat"):n(this.obj[c])}),/\$\{([^\}]+)\}/g);var t,m;e=[];for(m in a)if(t=a[m],f&&-1!==h.indexOf(f.properties||"",m)?t=q(m,a,f.formatter||"DateString"):k&&-1!==h.indexOf(k.properties||"",m)&&(t=q(m,a,k.formatter||"NumberFormat")),e.push(m+" \x3d "+n(t)+"\x3cbr/\x3e"),g)break;return e.join("")},filter:function(a,
c,b){var g;c=e(a,b,c);b={};a=c[0];for(g in a)c[2].call(c[g],a[g],g,a)&&(b[g]=a[g]);return b},startsWith:function(a,c,e){return e=e||0,a.indexOf(c,e)===e},endsWith:function(a,c,e){("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>a.length)&&(e=a.length);e-=c.length;a=a.indexOf(c,e);return-1!==a&&a===e},isDefined:c,fixJson:r};return f("extend-esri")&&(d.mixin(g,t),g._isDefined=c,g._getParts=e,g._sanitize=r),t})},"dojo/date":function(){define(["./has","./_base/lang"],function(h,l){var a={getDaysInMonth:function(d){var b=
d.getMonth();return 1==b&&a.isLeapYear(d)?29:[31,28,31,30,31,30,31,31,30,31,30,31][b]},isLeapYear:function(a){a=a.getFullYear();return!(a%400)||!(a%4)&&!!(a%100)},getTimezoneName:function(a){var b=a.toString(),f="",k=b.indexOf("(");if(-1<k)f=b.substring(++k,b.indexOf(")"));else if(k=/([A-Z\/]+) \d{4}$/,b=b.match(k))f=b[1];else if(b=a.toLocaleString(),k=/ ([A-Z\/]+)$/,b=b.match(k))f=b[1];return"AM"==f||"PM"==f?"":f},compare:function(a,b,f){a=new Date(+a);b=new Date(+(b||new Date));"date"==f?(a.setHours(0,
0,0,0),b.setHours(0,0,0,0)):"time"==f&&(a.setFullYear(0,0,0),b.setFullYear(0,0,0));return a>b?1:a<b?-1:0},add:function(a,b,f){var k=new Date(+a),m=!1,g="Date";switch(b){case "day":break;case "weekday":var e;(b=f%5)?e=parseInt(f/5):(b=0<f?5:-5,e=0<f?(f-5)/5:(f+5)/5);var c=a.getDay(),n=0;6==c&&0<f?n=1:0==c&&0>f&&(n=-1);c+=b;if(0==c||6==c)n=0<f?2:-2;f=7*e+b+n;break;case "year":g="FullYear";m=!0;break;case "week":f*=7;break;case "quarter":f*=3;case "month":m=!0;g="Month";break;default:g="UTC"+b.charAt(0).toUpperCase()+
b.substring(1)+"s"}if(g)k["set"+g](k["get"+g]()+f);m&&k.getDate()<a.getDate()&&k.setDate(0);return k},difference:function(d,b,f){b=b||new Date;f=f||"day";var k=b.getFullYear()-d.getFullYear(),m=1;switch(f){case "quarter":d=d.getMonth();b=b.getMonth();d=Math.floor(d/3)+1;b=Math.floor(b/3)+1;m=b+4*k-d;break;case "weekday":k=Math.round(a.difference(d,b,"day"));f=parseInt(a.difference(d,b,"week"));m=k%7;if(0==m)k=5*f;else{var g=0,e=d.getDay();b=b.getDay();f=parseInt(k/7);m=k%7;d=new Date(d);d.setDate(d.getDate()+
7*f);d=d.getDay();if(0<k)switch(!0){case 6==e:g=-1;break;case 0==e:g=0;break;case 6==b:g=-1;break;case 0==b:g=-2;break;case 5<d+m:g=-2}else if(0>k)switch(!0){case 6==e:g=0;break;case 0==e:g=1;break;case 6==b:g=2;break;case 0==b:g=1;break;case 0>d+m:g=2}k=k+g-2*f}m=k;break;case "year":m=k;break;case "month":m=b.getMonth()-d.getMonth()+12*k;break;case "week":m=parseInt(a.difference(d,b,"day")/7);break;case "day":m/=24;case "hour":m/=60;case "minute":m/=60;case "second":m/=1E3;case "millisecond":m*=
b.getTime()-d.getTime()}return Math.round(m)}};l.mixin(l.getObject("dojo.date",!0),a);return a})},"dojo/number":function(){define(["./_base/lang","./i18n","./i18n!./cldr/nls/number","./string","./regexp"],function(h,l,a,d,b){var f={};h.setObject("dojo.number",f);f.format=function(a,b){b=h.mixin({},b||{});var e=l.normalizeLocale(b.locale),e=l.getLocalization("dojo.cldr","number",e);b.customs=e;e=b.pattern||e[(b.type||"decimal")+"Format"];return isNaN(a)||Infinity==Math.abs(a)?null:f._applyPattern(a,
e,b)};f._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;f._applyPattern=function(a,b,e){e=e||{};var c=e.customs.group,d=e.customs.decimal;b=b.split(";");var k=b[0];b=b[0>a?1:0]||"-"+k;if(-1!=b.indexOf("%"))a*=100;else if(-1!=b.indexOf("\u2030"))a*=1E3;else if(-1!=b.indexOf("\u00a4"))c=e.customs.currencyGroup||c,d=e.customs.currencyDecimal||d,b=b.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/,function(a,c,b,g){return(a=e[["symbol","currency","displayName"][b.length-1]]||e.currency||"")?c+a+g:""});else if(-1!=
b.indexOf("E"))throw Error("exponential notation not supported");var r=f._numberPatternRE,k=k.match(r);if(!k)throw Error("unable to find a number expression in pattern: "+b);!1===e.fractional&&(e.places=0);return b.replace(r,f._formatAbsolute(a,k[0],{decimal:d,group:c,places:e.places,round:e.round}))};f.round=function(a,b,e){e=10/(e||10);return(e*+a).toFixed(b)/e};if(0==(.9).toFixed()){var k=f.round;f.round=function(a,b,e){var c=Math.pow(10,-b||0),d=Math.abs(a);if(!a||d>=c)c=0;else if(d/=c,.5>d||
.95<=d)c=0;return k(a,b,e)+(0<a?c:-c)}}f._formatAbsolute=function(a,b,e){e=e||{};!0===e.places&&(e.places=0);Infinity===e.places&&(e.places=6);b=b.split(".");var c="string"==typeof e.places&&e.places.indexOf(","),n=e.places;c?n=e.places.substring(c+1):0<=n||(n=(b[1]||[]).length);0>e.round||(a=f.round(a,n,e.round));a=String(Math.abs(a)).split(".");var k=a[1]||"";b[1]||e.places?(c&&(e.places=e.places.substring(0,c)),c=void 0!==e.places?e.places:b[1]&&b[1].lastIndexOf("0")+1,c>k.length&&(a[1]=d.pad(k,
c,"0",!0)),n<k.length&&(a[1]=k.substr(0,n))):a[1]&&a.pop();n=b[0].replace(",","");c=n.indexOf("0");-1!=c&&(c=n.length-c,c>a[0].length&&(a[0]=d.pad(a[0],c)),-1==n.indexOf("#")&&(a[0]=a[0].substr(a[0].length-c)));var n=b[0].lastIndexOf(","),r,u;-1!=n&&(r=b[0].length-n-1,b=b[0].substr(0,n),n=b.lastIndexOf(","),-1!=n&&(u=b.length-n-1));b=[];for(n=a[0];n;)c=n.length-r,b.push(0<c?n.substr(c):n),n=0<c?n.slice(0,c):"",u&&(r=u,delete u);a[0]=b.reverse().join(e.group||",");return a.join(e.decimal||".")};f.regexp=
function(a){return f._parseInfo(a).regexp};f._parseInfo=function(a){a=a||{};var g=l.normalizeLocale(a.locale),g=l.getLocalization("dojo.cldr","number",g),e=a.pattern||g[(a.type||"decimal")+"Format"],c=g.group,d=g.decimal,k=1;if(-1!=e.indexOf("%"))k/=100;else if(-1!=e.indexOf("\u2030"))k/=1E3;else{var r=-1!=e.indexOf("\u00a4");r&&(c=g.currencyGroup||c,d=g.currencyDecimal||d)}g=e.split(";");1==g.length&&g.push("-"+g[0]);g=b.buildGroupRE(g,function(e){e="(?:"+b.escapeString(e,".")+")";return e.replace(f._numberPatternRE,
function(e){var b={signed:!1,separator:a.strict?c:[c,""],fractional:a.fractional,decimal:d,exponent:!1};e=e.split(".");var g=a.places;1==e.length&&1!=k&&(e[1]="###");1==e.length||0===g?b.fractional=!1:(void 0===g&&(g=a.pattern?e[1].lastIndexOf("0")+1:Infinity),g&&void 0==a.fractional&&(b.fractional=!0),!a.places&&g<e[1].length&&(g+=","+e[1].length),b.places=g);e=e[0].split(",");1<e.length&&(b.groupSize=e.pop().length,1<e.length&&(b.groupSize2=e.pop().length));return"("+f._realNumberRegexp(b)+")"})},
!0);r&&(g=g.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(c,e,g,d){c=b.escapeString(a[["symbol","currency","displayName"][g.length-1]]||a.currency||"");if(!c)return"";e=e?"[\\s\\xa0]":"";d=d?"[\\s\\xa0]":"";return a.strict?e+c+d:(e&&(e+="*"),d&&(d+="*"),"(?:"+e+c+d+")?")}));return{regexp:g.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:c,decimal:d,factor:k}};f.parse=function(a,b){var e=f._parseInfo(b),c=(new RegExp("^"+e.regexp+"$")).exec(a);if(!c)return NaN;var d=c[1];if(!c[1]){if(!c[2])return NaN;
d=c[2];e.factor*=-1}d=d.replace(new RegExp("["+e.group+"\\s\\xa0]","g"),"").replace(e.decimal,".");return d*e.factor};f._realNumberRegexp=function(a){a=a||{};"places"in a||(a.places=Infinity);"string"!=typeof a.decimal&&(a.decimal=".");"fractional"in a&&!/^0/.test(a.places)||(a.fractional=[!0,!1]);"exponent"in a||(a.exponent=[!0,!1]);"eSigned"in a||(a.eSigned=[!0,!1]);var g=f._integerRegexp(a),e=b.buildGroupRE(a.fractional,function(c){var e="";c&&0!==a.places&&(e="\\"+a.decimal,e=Infinity==a.places?
"(?:"+e+"\\d+)?":e+("\\d{"+a.places+"}"));return e},!0),c=b.buildGroupRE(a.exponent,function(c){return c?"([eE]"+f._integerRegexp({signed:a.eSigned})+")":""}),g=g+e;e&&(g="(?:(?:"+g+")|(?:"+e+"))");return g+c};f._integerRegexp=function(a){a=a||{};"signed"in a||(a.signed=[!0,!1]);"separator"in a?"groupSize"in a||(a.groupSize=3):a.separator="";var g=b.buildGroupRE(a.signed,function(a){return a?"[-+]":""},!0),e=b.buildGroupRE(a.separator,function(c){if(!c)return"(?:\\d+)";c=b.escapeString(c);" "==c?
c="\\s":"\u00a0"==c&&(c="\\s\\xa0");var e=a.groupSize,g=a.groupSize2;return g?(c="(?:0|[1-9]\\d{0,"+(g-1)+"}(?:["+c+"]\\d{"+g+"})*["+c+"]\\d{"+e+"})",0<e-g?"(?:"+c+"|(?:0|[1-9]\\d{0,"+(e-1)+"}))":c):"(?:0|[1-9]\\d{0,"+(e-1)+"}(?:["+c+"]\\d{"+e+"})*)"},!0);return g+e};return f})},"dojo/cldr/nls/number":function(){define({root:{scientificFormat:"#E0","currencySpacing-afterCurrency-currencyMatch":"[:^S:]",infinity:"\u221e",superscriptingExponent:"\u00d7",list:";",percentSign:"%",minusSign:"-","currencySpacing-beforeCurrency-surroundingMatch":"[:digit:]",
"decimalFormat-short":"000T","currencySpacing-afterCurrency-insertBetween":"\u00a0",nan:"NaN",plusSign:"+","currencySpacing-afterCurrency-surroundingMatch":"[:digit:]","currencySpacing-beforeCurrency-currencyMatch":"[:^S:]",currencyFormat:"\u00a4\u00a0#,##0.00",perMille:"\u2030",group:",",percentFormat:"#,##0%","decimalFormat-long":"000T",decimalFormat:"#,##0.###",decimal:".","currencySpacing-beforeCurrency-insertBetween":"\u00a0",exponential:"E"},ar:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,"en-au":!0,
es:!0,et:!0,fi:!0,fr:!0,"fr-ch":!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,mk:!0,lt:!0,lv:!0,mk:!0,nb:!0,nl:!0,pl:!0,pt:!0,"pt-pt":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,vi:!0,zh:!0,"zh-hant":!0,"zh-hk":!0,"zh-tw":!0})},"dojo/cldr/nls/en/number":function(){define({group:",",percentSign:"%",exponential:"E",scientificFormat:"#E0",percentFormat:"#,##0%",list:";",infinity:"\u221e",minusSign:"-",decimal:".",superscriptingExponent:"\u00d7",nan:"NaN",perMille:"\u2030",decimalFormat:"#,##0.###",
currencyFormat:"\u00a4#,##0.00;(\u00a4#,##0.00)",plusSign:"+","decimalFormat-long":"000 trillion","decimalFormat-short":"000T"})},"dojo/date/locale":function(){define("../_base/lang ../_base/array ../date ../cldr/supplemental ../i18n ../regexp ../string ../i18n!../cldr/nls/gregorian module".split(" "),function(h,l,a,d,b,f,k,m,g){function e(a,c,e,b){return b.replace(/([a-z])\1*/ig,function(g){var f,n,m=g.charAt(0);g=g.length;var u=["abbr","wide","narrow"];switch(m){case "G":f=c[4>g?"eraAbbr":"eraNames"][0>
a.getFullYear()?0:1];break;case "y":f=a.getFullYear();switch(g){case 1:break;case 2:if(!e.fullYear){f=String(f);f=f.substr(f.length-2);break}default:n=!0}break;case "Q":case "q":f=Math.ceil((a.getMonth()+1)/3);n=!0;break;case "M":case "L":f=a.getMonth();3>g?(f+=1,n=!0):(m=["months","L"==m?"standAlone":"format",u[g-3]].join("-"),f=c[m][f]);break;case "w":f=q._getWeekOfYear(a,0);n=!0;break;case "d":f=a.getDate();n=!0;break;case "D":f=q._getDayOfYear(a);n=!0;break;case "e":case "c":if(f=a.getDay(),2>
g){f=(f-d.getFirstDayOfWeek(e.locale)+8)%7;break}case "E":f=a.getDay();3>g?(f+=1,n=!0):(m=["days","c"==m?"standAlone":"format",u[g-3]].join("-"),f=c[m][f]);break;case "a":m=12>a.getHours()?"am":"pm";f=e[m]||c["dayPeriods-format-wide-"+m];break;case "h":case "H":case "K":case "k":n=a.getHours();switch(m){case "h":f=n%12||12;break;case "H":f=n;break;case "K":f=n%12;break;case "k":f=n||24}n=!0;break;case "m":f=a.getMinutes();n=!0;break;case "s":f=a.getSeconds();n=!0;break;case "S":f=Math.round(a.getMilliseconds()*
Math.pow(10,g-3));n=!0;break;case "v":case "z":if(f=q._getZone(a,!0,e))break;g=4;case "Z":m=q._getZone(a,!1,e);m=[0>=m?"+":"-",k.pad(Math.floor(Math.abs(m)/60),2),k.pad(Math.abs(m)%60,2)];4==g&&(m.splice(0,0,"GMT"),m.splice(3,0,":"));f=m.join("");break;default:throw Error("dojo.date.locale.format: invalid pattern char: "+b);}n&&(f=k.pad(f,g));return f})}function c(a,c,e,b){var g=function(a){return a};c=c||g;e=e||g;b=b||g;var d=a.match(/(''|[^'])+/g),f="'"==a.charAt(0);l.forEach(d,function(a,b){a?
(d[b]=(f?e:c)(a.replace(/''/g,"'")),f=!f):d[b]=""});return b(d.join(""))}function n(a,c,e,b){b=f.escapeString(b);e.strict||(b=b.replace(" a"," ?a"));return b.replace(/([a-z])\1*/ig,function(b){var g;g=b.charAt(0);var d=b.length,f="",n="";e.strict?(1<d&&(f="0{"+(d-1)+"}"),2<d&&(n="0{"+(d-2)+"}")):(f="0?",n="0{0,2}");switch(g){case "y":g="\\d{2,4}";break;case "M":case "L":g=2<d?"\\S+?":"1[0-2]|"+f+"[1-9]";break;case "D":g="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+f+"[1-9][0-9]|"+n+"[1-9]";break;case "d":g=
"3[01]|[12]\\d|"+f+"[1-9]";break;case "w":g="[1-4][0-9]|5[0-3]|"+f+"[1-9]";break;case "E":case "e":case "c":g=".+?";break;case "h":g="1[0-2]|"+f+"[1-9]";break;case "k":g="1[01]|"+f+"\\d";break;case "H":g="1\\d|2[0-3]|"+f+"\\d";break;case "K":g="1\\d|2[0-4]|"+f+"[1-9]";break;case "m":case "s":g="[0-5]\\d";break;case "S":g="\\d{"+d+"}";break;case "a":d=e.am||c["dayPeriods-format-wide-am"];f=e.pm||c["dayPeriods-format-wide-pm"];g=d+"|"+f;e.strict||(d!=d.toLowerCase()&&(g+="|"+d.toLowerCase()),f!=f.toLowerCase()&&
(g+="|"+f.toLowerCase()),-1!=g.indexOf(".")&&(g+="|"+g.replace(/\./g,"")));g=g.replace(/\./g,"\\.");break;default:g=".*"}a&&a.push(b);return"("+g+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var q={};h.setObject(g.id.replace(/\//g,"."),q);q._getZone=function(c,e,b){return e?a.getTimezoneName(c):c.getTimezoneOffset()};q.format=function(a,g){g=g||{};var d=b.normalizeLocale(g.locale),f=g.formatLength||"short",d=q._getGregorianBundle(d),n=[],k=h.hitch(this,e,a,d,g);if("year"==g.selector)return c(d["dateFormatItem-yyyy"]||
"yyyy",k);var m;"date"!=g.selector&&(m=g.timePattern||d["timeFormat-"+f])&&n.push(c(m,k));"time"!=g.selector&&(m=g.datePattern||d["dateFormat-"+f])&&n.push(c(m,k));return 1==n.length?n[0]:d["dateTimeFormat-"+f].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(a,c){return n[c]})};q.regexp=function(a){return q._parseInfo(a).regexp};q._parseInfo=function(a){a=a||{};var e=b.normalizeLocale(a.locale),e=q._getGregorianBundle(e),g=a.formatLength||"short",d=a.datePattern||e["dateFormat-"+g],f=a.timePattern||
e["timeFormat-"+g],g="date"==a.selector?d:"time"==a.selector?f:e["dateTimeFormat-"+g].replace(/\{(\d+)\}/g,function(a,c){return[f,d][c]}),k=[];return{regexp:c(g,h.hitch(this,n,k,e,a)),tokens:k,bundle:e}};q.parse=function(c,e){var b=/[\u200E\u200F\u202A\u202E]/g,g=q._parseInfo(e),d=g.tokens,f=g.bundle,b=(new RegExp("^"+g.regexp.replace(b,"")+"$",g.strict?"":"i")).exec(c&&c.replace(b,""));if(!b)return null;var n=["abbr","wide","narrow"],k=[1970,0,1,0,0,0,0],m="",b=l.every(b,function(a,c){if(!c)return!0;
var b=d[c-1],g=b.length,b=b.charAt(0);switch(b){case "y":if(2!=g&&e.strict)k[0]=a;else if(100>a)a=Number(a),b=""+(new Date).getFullYear(),g=100*b.substring(0,2),b=Math.min(Number(b.substring(2,4))+20,99),k[0]=a<b?g+a:g-100+a;else{if(e.strict)return!1;k[0]=a}break;case "M":case "L":if(2<g){if(g=f["months-"+("L"==b?"standAlone":"format")+"-"+n[g-3]].concat(),e.strict||(a=a.replace(".","").toLowerCase(),g=l.map(g,function(a){return a.replace(".","").toLowerCase()})),a=l.indexOf(g,a),-1==a)return!1}else a--;
k[1]=a;break;case "E":case "e":case "c":g=f["days-"+("c"==b?"standAlone":"format")+"-"+n[g-3]].concat();e.strict||(a=a.toLowerCase(),g=l.map(g,function(a){return a.toLowerCase()}));a=l.indexOf(g,a);if(-1==a)return!1;break;case "D":k[1]=0;case "d":k[2]=a;break;case "a":g=e.am||f["dayPeriods-format-wide-am"];b=e.pm||f["dayPeriods-format-wide-pm"];if(!e.strict){var u=/\./g;a=a.replace(u,"").toLowerCase();g=g.replace(u,"").toLowerCase();b=b.replace(u,"").toLowerCase()}if(e.strict&&a!=g&&a!=b)return!1;
m=a==b?"p":a==g?"a":"";break;case "K":24==a&&(a=0);case "h":case "H":case "k":if(23<a)return!1;k[3]=a;break;case "m":k[4]=a;break;case "s":k[5]=a;break;case "S":k[6]=a}return!0}),g=+k[3];"p"===m&&12>g?k[3]=g+12:"a"===m&&12==g&&(k[3]=0);g=new Date(k[0],k[1],k[2],k[3],k[4],k[5],k[6]);e.strict&&g.setFullYear(k[0]);var u=d.join(""),r=-1!=u.indexOf("d"),u=-1!=u.indexOf("M");if(!b||u&&g.getMonth()>k[1]||r&&g.getDate()>k[2])return null;if(u&&g.getMonth()<k[1]||r&&g.getDate()<k[2])g=a.add(g,"hour",1);return g};
var r=[],u={};q.addCustomFormats=function(a,c){r.push({pkg:a,name:c});u={}};q._getGregorianBundle=function(a){if(u[a])return u[a];var c={};l.forEach(r,function(e){e=b.getLocalization(e.pkg,e.name,a);c=h.mixin(c,e)},this);return u[a]=c};q.addCustomFormats(g.id.replace(/\/date\/locale$/,".cldr"),"gregorian");q.getNames=function(a,c,e,b){var g;b=q._getGregorianBundle(b);a=[a,e,c];"standAlone"==e&&(e=a.join("-"),g=b[e],1==g[0]&&(g=void 0));a[1]="format";return(g||b[a.join("-")]).concat()};q.isWeekend=
function(a,c){var e=d.getWeekend(c),b=(a||new Date).getDay();e.end<e.start&&(e.end+=7,b<e.start&&(b+=7));return b>=e.start&&b<=e.end};q._getDayOfYear=function(c){return a.difference(new Date(c.getFullYear(),0,1,c.getHours()),c)+1};q._getWeekOfYear=function(a,c){1==arguments.length&&(c=0);var e=(new Date(a.getFullYear(),0,1)).getDay(),b=(e-c+7)%7,b=Math.floor((q._getDayOfYear(a)+b-1)/7);e==c&&b++;return b};return q})},"dojo/cldr/supplemental":function(){define(["../_base/lang","../i18n"],function(h,
l){var a={};h.setObject("dojo.cldr.supplemental",a);a.getFirstDayOfWeek=function(d){d={bd:5,mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,jo:6,kw:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0}[a._region(d)];return void 0===
d?1:d};a._region=function(a){a=l.normalizeLocale(a);a=a.split("-");var b=a[1];b?4==b.length&&(b=a[2]):b={aa:"et",ab:"ge",af:"za",ak:"gh",am:"et",ar:"eg",as:"in",av:"ru",ay:"bo",az:"az",ba:"ru",be:"by",bg:"bg",bi:"vu",bm:"ml",bn:"bd",bo:"cn",br:"fr",bs:"ba",ca:"es",ce:"ru",ch:"gu",co:"fr",cr:"ca",cs:"cz",cv:"ru",cy:"gb",da:"dk",de:"de",dv:"mv",dz:"bt",ee:"gh",el:"gr",en:"us",es:"es",et:"ee",eu:"es",fa:"ir",ff:"sn",fi:"fi",fj:"fj",fo:"fo",fr:"fr",fy:"nl",ga:"ie",gd:"gb",gl:"es",gn:"py",gu:"in",gv:"gb",
ha:"ng",he:"il",hi:"in",ho:"pg",hr:"hr",ht:"ht",hu:"hu",hy:"am",ia:"fr",id:"id",ig:"ng",ii:"cn",ik:"us","in":"id",is:"is",it:"it",iu:"ca",iw:"il",ja:"jp",ji:"ua",jv:"id",jw:"id",ka:"ge",kg:"cd",ki:"ke",kj:"na",kk:"kz",kl:"gl",km:"kh",kn:"in",ko:"kr",ks:"in",ku:"tr",kv:"ru",kw:"gb",ky:"kg",la:"va",lb:"lu",lg:"ug",li:"nl",ln:"cd",lo:"la",lt:"lt",lu:"cd",lv:"lv",mg:"mg",mh:"mh",mi:"nz",mk:"mk",ml:"in",mn:"mn",mo:"ro",mr:"in",ms:"my",mt:"mt",my:"mm",na:"nr",nb:"no",nd:"zw",ne:"np",ng:"na",nl:"nl",nn:"no",
no:"no",nr:"za",nv:"us",ny:"mw",oc:"fr",om:"et",or:"in",os:"ge",pa:"in",pl:"pl",ps:"af",pt:"br",qu:"pe",rm:"ch",rn:"bi",ro:"ro",ru:"ru",rw:"rw",sa:"in",sd:"in",se:"no",sg:"cf",si:"lk",sk:"sk",sl:"si",sm:"ws",sn:"zw",so:"so",sq:"al",sr:"rs",ss:"za",st:"za",su:"id",sv:"se",sw:"tz",ta:"in",te:"in",tg:"tj",th:"th",ti:"et",tk:"tm",tl:"ph",tn:"za",to:"to",tr:"tr",ts:"za",tt:"ru",ty:"pf",ug:"cn",uk:"ua",ur:"pk",uz:"uz",ve:"za",vi:"vn",wa:"be",wo:"sn",xh:"za",yi:"il",yo:"ng",za:"cn",zh:"cn",zu:"za",ace:"id",
ady:"ru",agq:"cm",alt:"ru",amo:"ng",asa:"tz",ast:"es",awa:"in",bal:"pk",ban:"id",bas:"cm",bax:"cm",bbc:"id",bem:"zm",bez:"tz",bfq:"in",bft:"pk",bfy:"in",bhb:"in",bho:"in",bik:"ph",bin:"ng",bjj:"in",bku:"ph",bqv:"ci",bra:"in",brx:"in",bss:"cm",btv:"pk",bua:"ru",buc:"yt",bug:"id",bya:"id",byn:"er",cch:"ng",ccp:"in",ceb:"ph",cgg:"ug",chk:"fm",chm:"ru",chp:"ca",chr:"us",cja:"kh",cjm:"vn",ckb:"iq",crk:"ca",csb:"pl",dar:"ru",dav:"ke",den:"ca",dgr:"ca",dje:"ne",doi:"in",dsb:"de",dua:"cm",dyo:"sn",dyu:"bf",
ebu:"ke",efi:"ng",ewo:"cm",fan:"gq",fil:"ph",fon:"bj",fur:"it",gaa:"gh",gag:"md",gbm:"in",gcr:"gf",gez:"et",gil:"ki",gon:"in",gor:"id",grt:"in",gsw:"ch",guz:"ke",gwi:"ca",haw:"us",hil:"ph",hne:"in",hnn:"ph",hoc:"in",hoj:"in",ibb:"ng",ilo:"ph",inh:"ru",jgo:"cm",jmc:"tz",kaa:"uz",kab:"dz",kaj:"ng",kam:"ke",kbd:"ru",kcg:"ng",kde:"tz",kdt:"th",kea:"cv",ken:"cm",kfo:"ci",kfr:"in",kha:"in",khb:"cn",khq:"ml",kht:"in",kkj:"cm",kln:"ke",kmb:"ao",koi:"ru",kok:"in",kos:"fm",kpe:"lr",krc:"ru",kri:"sl",krl:"ru",
kru:"in",ksb:"tz",ksf:"cm",ksh:"de",kum:"ru",lag:"tz",lah:"pk",lbe:"ru",lcp:"cn",lep:"in",lez:"ru",lif:"np",lis:"cn",lki:"ir",lmn:"in",lol:"cd",lua:"cd",luo:"ke",luy:"ke",lwl:"th",mad:"id",mag:"in",mai:"in",mak:"id",man:"gn",mas:"ke",mdf:"ru",mdh:"ph",mdr:"id",men:"sl",mer:"ke",mfe:"mu",mgh:"mz",mgo:"cm",min:"id",mni:"in",mnk:"gm",mnw:"mm",mos:"bf",mua:"cm",mwr:"in",myv:"ru",nap:"it",naq:"na",nds:"de","new":"np",niu:"nu",nmg:"cm",nnh:"cm",nod:"th",nso:"za",nus:"sd",nym:"tz",nyn:"ug",pag:"ph",pam:"ph",
pap:"bq",pau:"pw",pon:"fm",prd:"ir",raj:"in",rcf:"re",rej:"id",rjs:"np",rkt:"in",rof:"tz",rwk:"tz",saf:"gh",sah:"ru",saq:"ke",sas:"id",sat:"in",saz:"in",sbp:"tz",scn:"it",sco:"gb",sdh:"ir",seh:"mz",ses:"ml",shi:"ma",shn:"mm",sid:"et",sma:"se",smj:"se",smn:"fi",sms:"fi",snk:"ml",srn:"sr",srr:"sn",ssy:"er",suk:"tz",sus:"gn",swb:"yt",swc:"cd",syl:"bd",syr:"sy",tbw:"ph",tcy:"in",tdd:"cn",tem:"sl",teo:"ug",tet:"tl",tig:"er",tiv:"ng",tkl:"tk",tmh:"ne",tpi:"pg",trv:"tw",tsg:"ph",tts:"th",tum:"mw",tvl:"tv",
twq:"ne",tyv:"ru",tzm:"ma",udm:"ru",uli:"fm",umb:"ao",unr:"in",unx:"in",vai:"lr",vun:"tz",wae:"ch",wal:"et",war:"ph",xog:"ug",xsr:"np",yao:"mz",yap:"fm",yav:"cm",zza:"tr"}[a[0]];return b};a.getWeekend=function(d){var b=a._region(d);d={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5}[b];b={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6}[b];void 0===d&&(d=6);void 0===b&&(b=0);return{start:d,end:b}};
return a})},"dojo/cldr/nls/gregorian":function(){define({root:{"dateFormatItem-Ehm":"E h:mm a","days-standAlone-short":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"months-format-narrow":"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),"field-second-relative+0":"now","quarters-standAlone-narrow":["1","2","3","4"],"field-weekday":"Day of the Week","dateFormatItem-yQQQ":"y QQQ","dateFormatItem-yMEd":"y-MM-dd, E","field-wed-relative+0":"this Wednesday","field-wed-relative+1":"next Wednesday","dateFormatItem-GyMMMEd":"G y MMM d, E",
"dateFormatItem-MMMEd":"MMM d, E",eraNarrow:["BCE","CE"],"field-tue-relative+-1":"last Tuesday","days-format-short":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dateTimeFormats-appendItem-Day-Of-Week":"{0} {1}","dateFormat-long":"y MMMM d","field-fri-relative+-1":"last Friday","field-wed-relative+-1":"last Wednesday","months-format-wide":"M01 M02 M03 M04 M05 M06 M07 M08 M09 M10 M11 M12".split(" "),"dateTimeFormat-medium":"{1} {0}","dayPeriods-format-wide-pm":"PM","dateFormat-full":"y MMMM d, EEEE","field-thu-relative+-1":"last Thursday",
"dateFormatItem-Md":"MM-dd","dayPeriods-format-abbr-am":"AM","dateTimeFormats-appendItem-Second":"{0} ({2}: {1})","dayPeriods-format-wide-noon":"noon","dateFormatItem-yMd":"y-MM-dd","field-era":"Era","dateFormatItem-yM":"y-MM","months-standAlone-wide":"M01 M02 M03 M04 M05 M06 M07 M08 M09 M10 M11 M12".split(" "),"timeFormat-short":"HH:mm","quarters-format-wide":["Q1","Q2","Q3","Q4"],"dateFormatItem-yQQQQ":"y QQQQ","timeFormat-long":"HH:mm:ss z","field-year":"Year","dateFormatItem-yMMM":"y MMM","dateTimeFormats-appendItem-Era":"{1} {0}",
"field-hour":"Hour","months-format-abbr":"M01 M02 M03 M04 M05 M06 M07 M08 M09 M10 M11 M12".split(" "),"field-sat-relative+0":"this Saturday","field-sat-relative+1":"next Saturday","timeFormat-full":"HH:mm:ss zzzz","dateTimeFormats-appendItem-Week":"{0} ({2}: {1})","field-day-relative+0":"today","field-thu-relative+0":"this Thursday","field-day-relative+1":"tomorrow","field-thu-relative+1":"next Thursday","dateFormatItem-GyMMMd":"G y MMM d","dateFormatItem-H":"HH","months-standAlone-abbr":"M01 M02 M03 M04 M05 M06 M07 M08 M09 M10 M11 M12".split(" "),
"quarters-format-abbr":["Q1","Q2","Q3","Q4"],"quarters-standAlone-wide":["Q1","Q2","Q3","Q4"],"dateFormatItem-Gy":"G y","dateFormatItem-M":"L","days-standAlone-wide":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dayPeriods-format-abbr-noon":"noon","timeFormat-medium":"HH:mm:ss","field-sun-relative+0":"this Sunday","dateFormatItem-Hm":"HH:mm","field-sun-relative+1":"next Sunday","quarters-standAlone-abbr":["Q1","Q2","Q3","Q4"],eraAbbr:["BCE","CE"],"field-minute":"Minute","field-dayperiod":"Dayperiod",
"days-standAlone-abbr":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dateFormatItem-d":"d","dateFormatItem-ms":"mm:ss","quarters-format-narrow":["1","2","3","4"],"field-day-relative+-1":"yesterday","dateTimeFormat-long":"{1} {0}","dayPeriods-format-narrow-am":"a","dateFormatItem-h":"h a","dateFormatItem-MMMd":"MMM d","dateFormatItem-MEd":"MM-dd, E","dateTimeFormat-full":"{1} {0}","field-fri-relative+0":"this Friday","field-fri-relative+1":"next Friday","field-day":"Day","days-format-wide":"Sun Mon Tue Wed Thu Fri Sat".split(" "),
"field-zone":"Zone","months-standAlone-narrow":"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),"dateFormatItem-y":"y","dateTimeFormats-appendItem-Day":"{0} ({2}: {1})","field-year-relative+-1":"last year","field-month-relative+-1":"last month","dateTimeFormats-appendItem-Year":"{1} {0}","dateFormatItem-hm":"h:mm a","dateTimeFormats-appendItem-Hour":"{0} ({2}: {1})","dayPeriods-format-abbr-pm":"PM","days-format-abbr":"Sun Mon Tue Wed Thu Fri Sat".split(" "),eraNames:["BCE","CE"],"dateFormatItem-yMMMd":"y MMM d",
"days-format-narrow":"SMTWTFS".split(""),"field-month":"Month","days-standAlone-narrow":"SMTWTFS".split(""),"dateFormatItem-MMM":"LLL","field-tue-relative+0":"this Tuesday","dateTimeFormats-appendItem-Quarter":"{0} ({2}: {1})","field-tue-relative+1":"next Tuesday","dayPeriods-format-wide-am":"AM","dateTimeFormats-appendItem-Month":"{0} ({2}: {1})","dateTimeFormats-appendItem-Minute":"{0} ({2}: {1})","dateFormatItem-EHm":"E HH:mm","field-mon-relative+0":"this Monday","field-mon-relative+1":"next Monday",
"dateFormat-short":"y-MM-dd","dateFormatItem-EHms":"E HH:mm:ss","dateFormatItem-Ehms":"E h:mm:ss a","dayPeriods-format-narrow-noon":"n","field-second":"Second","field-sat-relative+-1":"last Saturday","dateFormatItem-yMMMEd":"y MMM d, E","field-sun-relative+-1":"last Sunday","field-month-relative+0":"this month","field-month-relative+1":"next month","dateTimeFormats-appendItem-Timezone":"{0} {1}","dateFormatItem-Ed":"d, E","field-week":"Week","dateFormat-medium":"y MMM d","field-week-relative+-1":"last week",
"field-year-relative+0":"this year","field-year-relative+1":"next year","dayPeriods-format-narrow-pm":"p","dateTimeFormat-short":"{1} {0}","dateFormatItem-Hms":"HH:mm:ss","dateFormatItem-hms":"h:mm:ss a","dateFormatItem-GyMMM":"G y MMM","field-mon-relative+-1":"last Monday","field-week-relative+0":"this week","field-week-relative+1":"next week"},ar:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,"en-au":!0,"en-ca":!0,"en-gb":!0,es:!0,et:!0,fi:!0,fr:!0,"fr-ch":!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,
mk:!0,lt:!0,lv:!0,mk:!0,nb:!0,nl:!0,pl:!0,pt:!0,"pt-pt":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,vi:!0,zh:!0,"zh-hant":!0,"zh-hk":!0,"zh-tw":!0})},"dojo/cldr/nls/en/gregorian":function(){define({"dateFormatItem-Ehm":"E h:mm a","days-standAlone-short":"Su Mo Tu We Th Fr Sa".split(" "),"months-format-narrow":"JFMAMJJASOND".split(""),"field-second-relative+0":"now","quarters-standAlone-narrow":["1","2","3","4"],"field-weekday":"Day of the Week","dateFormatItem-yQQQ":"QQQ y","dateFormatItem-yMEd":"E, M/d/y",
"field-wed-relative+0":"this Wednesday","field-wed-relative+1":"next Wednesday","dateFormatItem-GyMMMEd":"E, MMM d, y G","dateFormatItem-MMMEd":"E, MMM d",eraNarrow:["B","A"],"field-tue-relative+-1":"last Tuesday","days-format-short":"Su Mo Tu We Th Fr Sa".split(" "),"dateTimeFormats-appendItem-Day-Of-Week":"{0} {1}","dateFormat-long":"MMMM d, y","field-fri-relative+-1":"last Friday","field-wed-relative+-1":"last Wednesday","months-format-wide":"January February March April May June July August September October November December".split(" "),
"dateTimeFormat-medium":"{1}, {0}","dayPeriods-format-wide-pm":"PM","dateFormat-full":"EEEE, MMMM d, y","field-thu-relative+-1":"last Thursday","dateFormatItem-Md":"M/d","dateTimeFormats-appendItem-Second":"{0} ({2}: {1})","dayPeriods-format-wide-noon":"noon","dateFormatItem-yMd":"M/d/y","field-era":"Era","dateFormatItem-yM":"M/y","months-standAlone-wide":"January February March April May June July August September October November December".split(" "),"timeFormat-short":"h:mm a","quarters-format-wide":["1st quarter",
"2nd quarter","3rd quarter","4th quarter"],"dateFormatItem-yQQQQ":"QQQQ y","timeFormat-long":"h:mm:ss a z","field-year":"Year","dateFormatItem-yMMM":"MMM y","dateTimeFormats-appendItem-Era":"{0} {1}","field-hour":"Hour","months-format-abbr":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),"field-sat-relative+0":"this Saturday","field-sat-relative+1":"next Saturday","timeFormat-full":"h:mm:ss a zzzz","dateTimeFormats-appendItem-Week":"{0} ({2}: {1})","field-day-relative+0":"today","field-thu-relative+0":"this Thursday",
"field-day-relative+1":"tomorrow","field-thu-relative+1":"next Thursday","dateFormatItem-GyMMMd":"MMM d, y G","dateFormatItem-H":"HH","months-standAlone-abbr":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),"quarters-format-abbr":["Q1","Q2","Q3","Q4"],"quarters-standAlone-wide":["1st quarter","2nd quarter","3rd quarter","4th quarter"],"dateFormatItem-Gy":"y G","dateFormatItem-M":"L","days-standAlone-wide":"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),"timeFormat-medium":"h:mm:ss a",
"field-sun-relative+0":"this Sunday","dateFormatItem-Hm":"HH:mm","field-sun-relative+1":"next Sunday",eraAbbr:["BC","AD"],"field-minute":"Minute","field-dayperiod":"AM/PM","dateFormatItem-d":"d","dateFormatItem-ms":"mm:ss","field-day-relative+-1":"yesterday","dateFormatItem-h":"h a","dateTimeFormat-long":"{1} 'at' {0}","dayPeriods-format-narrow-am":"a","dateFormatItem-MMMd":"MMM d","dateFormatItem-MEd":"E, M/d","dateTimeFormat-full":"{1} 'at' {0}","field-fri-relative+0":"this Friday","field-fri-relative+1":"next Friday",
"field-day":"Day","days-format-wide":"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),"field-zone":"Time Zone","dateTimeFormats-appendItem-Day":"{0} ({2}: {1})","dateFormatItem-y":"y","months-standAlone-narrow":"JFMAMJJASOND".split(""),"field-year-relative+-1":"last year","field-month-relative+-1":"last month","dateFormatItem-hm":"h:mm a","dateTimeFormats-appendItem-Year":"{0} {1}","dateTimeFormats-appendItem-Hour":"{0} ({2}: {1})","days-format-abbr":"Sun Mon Tue Wed Thu Fri Sat".split(" "),
"dateFormatItem-yMMMd":"MMM d, y",eraNames:["Before Christ","Anno Domini"],"days-standAlone-narrow":"SMTWTFS".split(""),"dateFormatItem-MMM":"LLL","field-month":"Month","field-tue-relative+0":"this Tuesday","dateTimeFormats-appendItem-Quarter":"{0} ({2}: {1})","field-tue-relative+1":"next Tuesday","dayPeriods-format-wide-am":"AM","dateTimeFormats-appendItem-Month":"{0} ({2}: {1})","dateTimeFormats-appendItem-Minute":"{0} ({2}: {1})","dateFormatItem-EHm":"E HH:mm","field-mon-relative+0":"this Monday",
"field-mon-relative+1":"next Monday","dateFormat-short":"M/d/yy","dateFormatItem-EHms":"E HH:mm:ss","dateFormatItem-Ehms":"E h:mm:ss a","dayPeriods-format-narrow-noon":"n","field-second":"Second","field-sat-relative+-1":"last Saturday","dateFormatItem-yMMMEd":"E, MMM d, y","field-sun-relative+-1":"last Sunday","field-month-relative+0":"this month","field-month-relative+1":"next month","dateFormatItem-Ed":"d E","dateTimeFormats-appendItem-Timezone":"{0} {1}","field-week":"Week","dateFormat-medium":"MMM d, y",
"field-year-relative+0":"this year","field-week-relative+-1":"last week","field-year-relative+1":"next year","dayPeriods-format-narrow-pm":"p","dateTimeFormat-short":"{1}, {0}","dateFormatItem-Hms":"HH:mm:ss","dateFormatItem-hms":"h:mm:ss a","dateFormatItem-GyMMM":"MMM y G","field-mon-relative+-1":"last Monday","field-week-relative+0":"this week","field-week-relative+1":"next week"})},"esri/geometry/ScreenPoint":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Point"],
function(h,l,a,d,b){h=h(b,{declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}});return a("extend-esri")&&l.setObject("geometry.ScreenPoint",h,d),h})},"esri/geometry/Point":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ../srUtils".split(" "),function(h,l,a,d,b,f,k,m){function g(a,e){89.99999<e?e=89.99999:-89.99999>e&&(e=-89.99999);var b=e*r;return[a*r*c,c/2*Math.log((1+Math.sin(b))/(1-Math.sin(b)))]}function e(a,e,b){a=
a/c*q;b?(e=n/2-2*Math.atan(Math.exp(-1*e/c)),e=[a,e*q]):(b=a-360*Math.floor((a+180)/360),e=n/2-2*Math.atan(Math.exp(-1*e/c)),e=[b,e*q]);return e}var c=6378137,n=3.141592653589793,q=57.29577951308232,r=.017453292519943,u={type:"point",x:0,y:0};h=h(k,{declaredClass:"esri.geometry.Point",constructor:function(a,c,e){l.mixin(this,u);l.isArray(a)?(this.x=a[0],this.y=a[1],this.spatialReference=c):l.isObject(a)?(l.mixin(this,a),b.isDefined(this.latitude)&&(this.y=this.latitude),b.isDefined(this.longitude)&&
(this.x=this.longitude),this.spatialReference&&(this.spatialReference=m.createSpatialReference(this.spatialReference))):(this.x=a,this.y=c,this.spatialReference=e);this.verifySR()},offset:function(a,c){return new this.constructor(this.x+a,this.y+c,this.spatialReference)},setX:function(a){return this.x=a,this.clearCache(),this},setY:function(a){return this.y=a,this.clearCache(),this},setLongitude:function(a){var c=this.spatialReference;return c&&(c._isWebMercator()?this.setX(g(a,this.y)[0]):4326===
c.wkid&&this.setX(a)),this},setLatitude:function(a){var c=this.spatialReference;return c&&(c._isWebMercator()?this.setY(g(this.x,a)[1]):4326===c.wkid&&this.setY(a)),this},getLongitude:function(){var a,c=this.spatialReference;return c&&(c._isWebMercator()?a=e(this.x,this.y)[0]:4326===c.wkid&&(a=this.x)),a},getLatitude:function(){var a,c=this.spatialReference;return c&&(c._isWebMercator()?a=e(this.x,this.y)[1]:4326===c.wkid&&(a=this.y)),a},update:function(a,c){return this.x=a,this.y=c,this.clearCache(),
this},normalize:function(){var a=this.x,c=this.spatialReference;if(c){var e=c._getInfo();if(e){var b,g=e.valid[0],e=e.valid[1],d=2*e;a>e?(b=Math.ceil(Math.abs(a-e)/d),a-=b*d):g>a&&(b=Math.ceil(Math.abs(a-g)/d),a+=b*d)}}return new this.constructor(a,this.y,c)},toJson:function(){var a={x:this.x,y:this.y},c=this.spatialReference;return c&&(a.spatialReference=c.toJson()),a}});return h.lngLatToXY=g,h.xyToLngLat=e,h.defaultProps=u,a("extend-esri")&&(l.setObject("geometry.Point",h,d),d.geometry.defaultPoint=
u),h})},"esri/SpatialReference":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ./kernel ./lang".split(" "),function(h,l,a,d,b,f){var k=[-2.0037508342788905E7,2.0037508342788905E7],m=[-2.0037508342787E7,2.0037508342787E7];h=h(null,{declaredClass:"esri.SpatialReference",constructor:function(b){b&&(a.isObject(b)?a.mixin(this,b):a.isString(b)?this.wkt=b:this.wkid=b)},wkid:null,wkt:null,_info:{102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:k,origin:m,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:k,origin:m,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:k,origin:m,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:k,origin:m,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",${Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}},_isWebMercator:function(){return-1!==l.indexOf([102113,102100,3857,3785],this.wkid)},_isWrappable:function(){return-1!==l.indexOf([102113,102100,3857,3785,4326],this.wkid)},_getInfo:function(){return this.wkid?this._info[this.wkid]:null},_canProject:function(a){var e=!1;return a&&(e=this.isWebMercator()&&4326===a.wkid||a.isWebMercator()&&4326===this.wkid),e},isWebMercator:function(){return this._isWebMercator()},equals:function(a){var e=!1;return a&&(this===
a&&(e=!0),this.wkid||a.wkid?e=this.wkid===a.wkid||this.isWebMercator()&&a.isWebMercator()||this.wkid===a.latestWkid||a.wkid===this.latestWkid:this.wkt&&a.wkt&&(e=this.wkt.toUpperCase()===a.wkt.toUpperCase())),e},toJson:function(){var a=null,e=f.isDefined;return e(this.wkid)?a={wkid:this.wkid}:e(this.wkt)&&(a={wkt:this.wkt}),a&&e(this.latestWkid)&&(a.latestWkid=this.latestWkid),a}});return d("extend-esri")&&(b.SpatialReference=h),h})},"esri/geometry/Geometry":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../SpatialReference"],function(h,l,a,d,b){h=h(null,{declaredClass:"esri.geometry.Geometry",spatialReference:null,type:null,cache:void 0,setSpatialReference:function(a){return this.spatialReference=a,this},verifySR:function(){this.spatialReference||this.setSpatialReference(new b(4326))},getExtent:function(){return null},clearCache:function(){this.cache=void 0},getCacheValue:function(a){return this.cache&&this.cache[a]},setCacheValue:function(a,b){this.cache||
(this.cache={});this.cache[a]=b}});return a("extend-esri")&&l.setObject("geometry.Geometry",h,d),h})},"esri/srUtils":function(){define(["./SpatialReference","./ImageSpatialReference","./kernel","./sniff","dojo/_base/lang"],function(h,l,a,d,b){function f(a){var b=!1;return a&&(a.ics||a.icsid)&&(b=!0),b}var k={isICS:f,createSpatialReference:function(a){var b=null;return a&&(b=f(a)?new l(a):new h(a)),b}};return d("extend-esri")&&b.mixin(a,k),k})},"esri/ImageSpatialReference":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./lang ./SpatialReference".split(" "),
function(h,l,a,d,b,f){h=h(f,{declaredClass:"esri.ImageSpatialReference",constructor:function(a){a&&(l.isObject(a)&&l.mixin(this,a),this.url||console.error("ImageSpatialReference: must provide image service URL."))},icsid:null,ics:null,_isWebMercator:function(){return!1},_isWrappable:function(){return!1},equals:function(a){var b=!1;return a&&(this.icsid&&a.icsid?b=this.icsid===a.icsid:this.ics&&a.ics&&(b=this.ics===a.ics)),b},toJson:function(a){var d=null,g=b.isDefined;return a=g(a)?a:!0,g(this.icsid)?
d={icsid:this.icsid}:g(this.ics)&&(d={ics:this.ics}),g(this.url)&&g(d)&&a&&(d.url=this.url),d}});return a("extend-esri")&&(d.ImageSpatialReference=h),h})},"esri/sniff":function(){define(["dojo/_base/sniff","./kernel"],function(h,l){var a,d=function(){return this}(),b=h("ff"),f=h("ie"),k=void 0===f&&7<=h("trident"),m=h("edge"),g=h("webkit"),e=h("opera"),c=h("chrome"),n=h("safari"),q=navigator.userAgent;return a=q.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+\_\d+)/i),a&&h.add("esri-iphone",parseFloat(a[2].replace("_",
"."))),a=q.match(/Android\s+(\d+\.\d+)/i),a&&h.add("esri-android",parseFloat(a[1])),a=q.match(/Fennec\/(\d+\.\d+)/i),a&&h.add("esri-fennec",parseFloat(a[1])),0<=q.indexOf("BlackBerry")&&0<=q.indexOf("WebKit")&&h.add("esri-blackberry",1),h.add("esri-touch",h("esri-iphone")||h("esri-android")||h("esri-blackberry")||6<=h("esri-fennec")||(b||g)&&document.createTouch?!0:!1),a=q.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i),a&&h.add("esri-mobile",a),h.add("esri-pointer",navigator.pointerEnabled||
navigator.msPointerEnabled),l._getDOMAccessor=function(a){var c="";return b?c="Moz":g?c="Webkit":f?c="ms":e&&(c="O"),c+a.charAt(0).toUpperCase()+a.substr(1)},h.add("esri-phonegap",!!d.cordova),h.add("esri-cors",h("esri-phonegap")||d.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),h.add("esri-file-upload",d.FormData&&d.FileList?!0:!1),h.add("esri-workers",d.Worker?!0:!1),h.add("esri-transforms",k||m||9<=f||3.5<=b||4<=c||3.1<=n||10.5<=e||3.2<=h("esri-iphone")||2.1<=h("esri-android")),h.add("esri-transitions",
k||m||10<=f||4<=b||4<=c||3.1<=n||10.5<=e||3.2<=h("esri-iphone")||2.1<=h("esri-android")),h.add("esri-transforms3d",k||m||10<=b||12<=c||4<=n||3.2<=h("esri-iphone")||3<=h("esri-android")),h.add("esri-url-encodes-apostrophe",function(){if(d.document)return!1;var a=d.document.createElement("a");return a.href="?'",-1<a.href.indexOf("?%27")}),3>h("esri-android")&&(h.add("esri-transforms",!1,!1,!0),h.add("esri-transitions",!1,!1,!0),h.add("esri-transforms3d",!1,!1,!0)),h.add("esri-will-change",h("esri-transforms")&&
(52<=c||9.1<=n)),l._css=function(a){var d=h("esri-transforms3d");void 0!==a&&null!==a?d=a:d&&(c||n&&!h("esri-iphone"))&&(d=!1);var k=d?"translate3d(":"translate(",t=d?c?",-1px)":",0px)":")",m=d?"scale3d(":"scale(",q=d?",1)":")",l=d?"rotate3d(0,0,1,":"rotate(",z=d?"matrix3d(":"matrix(",A=d?",0,0,":",",B=d?",0,0,0,0,1,0,":",",C=d?",0,1)":")";return{names:{transition:g&&"-webkit-transition"||b&&"MozTransition"||e&&"OTransition"||f&&"msTransition"||"transition",transform:g&&"-webkit-transform"||b&&"MozTransform"||
e&&"OTransform"||f&&"msTransform"||"transform",transformName:g&&"-webkit-transform"||b&&"-moz-transform"||e&&"-o-transform"||f&&"-ms-transform"||"transform",origin:g&&"-webkit-transform-origin"||b&&"MozTransformOrigin"||e&&"OTransformOrigin"||f&&"msTransformOrigin"||"transformOrigin",endEvent:g&&"webkitTransitionEnd"||b&&"transitionend"||e&&"oTransitionEnd"||f&&"MSTransitionEnd"||"transitionend"},translate:function(a,c){return k+a+"px,"+c+"px"+t},scale:function(a){return m+a+","+a+q},rotate:function(a){return l+
a+"deg)"},matrix:function(a){return z+a.xx+","+a.xy+A+a.yx+","+a.yy+B+a.dx.toFixed(10)+(b?"px,":",")+a.dy.toFixed(10)+(b?"px":"")+C},getScaleFromMatrix:function(a){if(!a)return 1;a=a.toLowerCase();var c=-1<a.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(a.substring(c.length,a.indexOf(",")))}}},h("extend-esri")&&(l.isiPhone=h("esri-iphone"),l.isAndroid=h("esri-android"),l.isFennec=h("esri-fennec"),l.isBlackBerry=h("esri-blackberry"),l.isTouchEnabled=h("esri-touch"),l.isPointerEnabled=h("esri-pointer"),
l._hasCors=h("esri-cors"),l._hasFileUpload=h("esri-file-upload"),l._hasTransforms=h("esri-transforms"),l._hasTransitions=h("esri-transitions"),l._has3DTransforms=h("esri-transforms3d")),h})},"esri/PopupBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/Deferred dojo/has ./kernel ./graphic ./geometry/Point ./geometry/jsonUtils ./geometry/mathUtils ./geometry/webMercatorUtils ./symbols/SimpleMarkerSymbol ./symbols/SimpleLineSymbol ./symbols/CartographicLineSymbol ./symbols/SimpleFillSymbol ./tasks/query ./Evented require".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w){function x(a){return"sizeInfo"===a.type}h=h(w,{declaredClass:"esri.PopupBase",_featureLayers:{},_updateEndHandles:[],_evtMap:{"set-features":!0,"clear-features":!0,"selection-change":!0,"dfd-complete":!0},onSetFeatures:function(){},onClearFeatures:function(){},onSelectionChange:function(){},onDfdComplete:function(){},initialize:function(){this.count=0;this.selectedIndex=-1;this.on("clear-features",l.hitch(this,this._resetUpdateEndListeners));this.on("dfd-complete",
l.hitch(this,this._processFeatures));this.on("set-features",l.hitch(this,this._processFeatures))},cleanup:function(){this.features=this.deferreds=null;this._resetUpdateEndListeners()},setFeatures:function(c){if(c&&c.length){this.clearFeatures();var e,g;c[0]instanceof b?g=c:e=c;e?this._updateFeatures(null,e):(this.deferreds=g,g=g.slice(0),a.forEach(g,function(a){a.addBoth(l.hitch(this,this._updateFeatures,a))},this))}},clearFeatures:function(){this.features=this.deferreds=this._marked=null;this.count=
0;var a=this.selectedIndex;this.selectedIndex=-1;-1<a&&this.onSelectionChange();this.onClearFeatures()},getSelectedFeature:function(){var a=this.features;return a?a[this.selectedIndex]:void 0},select:function(a){0>a||a>=this.count||(this.selectedIndex=a,this.onSelectionChange())},enableHighlight:function(a){(this._highlighted=a.graphics.add(new m(new g(0,0,a.spatialReference))),this._highlighted.hide(),this.markerSymbol)||(a=this.markerSymbol=new q,a.setStyle(q.STYLE_TARGET),a._setDim(16,16,0),a.setOutline(new u(r.STYLE_SOLID,
new d([0,255,255]),2,u.CAP_ROUND,u.JOIN_ROUND)),a.setColor(new d([0,0,0,0])));this.lineSymbol||(this.lineSymbol=new r(r.STYLE_SOLID,new d([0,255,255]),2));this.fillSymbol||(this.fillSymbol=new v(v.STYLE_NULL,new r(r.STYLE_SOLID,new d([0,255,255]),2),new d([0,0,0,0])))},disableHighlight:function(a){var c=this._highlighted;c&&(c.hide(),a.graphics.remove(c),delete this._highlighted);this.markerSymbol=this.lineSymbol=this.fillSymbol=null},showHighlight:function(){var a=this.features&&this.features[this.selectedIndex];
this._highlighted&&a&&a.geometry&&this._highlighted.show()},hideHighlight:function(){this._highlighted&&this._highlighted.hide()},updateHighlight:function(a,c){var b=c.geometry,g=this._highlighted;if(!b||!g)return void(g&&g.hide());g.hide();!g._graphicsLayer&&a&&a.graphics.add(g);g.setGeometry(e.fromJson(b.toJson()));var d;switch(b.type){case "point":case "multipoint":var f=c.getLayer(),b=c.symbol||f&&f._getSymbol(c);if(f&&b){var n,k,t=0,m=0,u=0;d=c.symbol?null:f._getRenderer(c);if(f=this._getSizeInfo(d))n=
k=d.getSize(c,{sizeInfo:f,shape:b.style,resolution:a&&a.getResolutionInMeters&&a.getResolutionInMeters()});else switch(b.type){case "simplemarkersymbol":n=k=b.size||0;break;case "picturemarkersymbol":n=b.width||0,k=b.height||0}t=b.xoffset||0;m=b.yoffset||0;u=b.angle||0;d=this.markerSymbol;d.setOffset(0,0);d.setAngle(0);n&&k&&d._setDim(n+1,k+1,0);d.setOffset(t,m);d.setAngle(u)}break;case "polyline":d=this.lineSymbol;break;case "polygon":d=this.fillSymbol}g.setSymbol(d)},showClosestFirst:function(a){var e=
this.features;if(e&&e.length){if(1<e.length){var b,g,d,f,k,t=1/0,m=-1,u=c.getLength,r=a.spatialReference;a=a.normalize();for(b=e.length-1;0<=b;b--)if(g=e[b].geometry){f=g.spatialReference;d=0;try{k="point"===g.type?g:g.getExtent().getCenter(),k=k.normalize(),r&&f&&!r.equals(f)&&r._canProject(f)&&(k=r.isWebMercator()?n.geographicToWebMercator(k):n.webMercatorToGeographic(k)),d=u(a,k)}catch(q){}0<d&&t>d&&(t=d,m=b)}0<m&&(e.splice(0,0,e.splice(m,1)[0]),this.select(0))}}else this.deferreds&&(this._marked=
a)},_unbind:function(c){c=a.indexOf(this.deferreds,c);if(-1!==c)return this.deferreds.splice(c,1),this.deferreds.length?1:(this.deferreds=null,2)},_fireComplete:function(a){var c=this._marked;c&&(this._marked=null,this.showClosestFirst(c));this.onDfdComplete(a)},_updateFeatures:function(c,e){if(c){if(this.deferreds){var b=this._unbind(c);if(b){if(e&&e instanceof Error)return this._fireComplete(e),void(2===b&&this.onSetFeatures());if(e&&e.length)if(this.features){var g=a.filter(e,function(c){return-1===
a.indexOf(this.features,c)},this);this.features=this.features.concat(g);this.count=this.features.length;this._fireComplete();2===b&&this.onSetFeatures()}else this.features=e,this.count=e.length,this.selectedIndex=0,this._fireComplete(),2===b&&this.onSetFeatures(),this.select(0);else this._fireComplete(),2===b&&this.onSetFeatures()}}}else this.features=e,this.count=e.length,this.selectedIndex=0,this.onSetFeatures(),this.select(0)},_getSizeInfo:function(c){return c?c.sizeInfo||a.filter(c.visualVariables,
x)[0]:null},_resetUpdateEndListeners:function(){this._featureLayers={};a.forEach(this._updateEndHandles,function(a){a.remove()});this._updateEndHandles=[]},_processFeatures:function(){a.forEach(this.features,function(a){(a=a.getLayer())&&!this._featureLayers[a.id]&&(1===a.currentMode||0===a.currentMode&&6===a.mode)&&a.objectIdField&&a.hasXYFootprint&&a.queryFeatures&&("esriGeometryPolygon"===a.geometryType||"esriGeometryPolyline"===a.geometryType||a.hasXYFootprint())&&(this._featureLayers[a.id]=a,
a=a.on("update-end",l.hitch(this,this._fLyrUpdateEndHandler)),this._updateEndHandles.push(a))},this)},_fLyrUpdateEndHandler:function(c){if(!c.error){var e=this,b=c.target,g=b.getSelectedFeatures(),d=0===b.currentMode&&6===b.mode,f={},n=[];if(a.forEach(this.features,function(a){if(a.getLayer()===b){var c=a.attributes[b.objectIdField];f[c]=a;n.push(c)}}),n.length)c=new t,c.objectIds=n,b.queryFeatures(c,function(c){a.forEach(c.features,function(c){var e=f[c.attributes[b.objectIdField]],n=!1;e.geometry!==
c.geometry?(e.setGeometry(c.geometry),n=!0):d&&g&&-1!==a.indexOf(g,c)&&(n=!0);n&&this._highlighted&&e===this.getSelectedFeature()&&this._highlighted.setGeometry(c.geometry)},e)})}}});return f("extend-esri")&&(k.PopupBase=h),h})},"dojo/_base/Color":function(){define(["./kernel","./lang","./array","./config"],function(h,l,a,d){var b=h.Color=function(a){a&&this.setColor(a)};b.named={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,
128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],transparent:d.transparentColor||[0,0,0,0]};l.extend(b,{r:255,g:255,b:255,a:1,_set:function(a,b,d,g){this.r=a;this.g=b;this.b=d;this.a=g},setColor:function(a){l.isString(a)?b.fromString(a,this):l.isArray(a)?b.fromArray(a,this):(this._set(a.r,a.g,a.b,a.a),a instanceof b||this.sanitize());return this},sanitize:function(){return this},toRgb:function(){return[this.r,
this.g,this.b]},toRgba:function(){return[this.r,this.g,this.b,this.a]},toHex:function(){return"#"+a.map(["r","g","b"],function(a){a=this[a].toString(16);return 2>a.length?"0"+a:a},this).join("")},toCss:function(a){var b=this.r+", "+this.g+", "+this.b;return(a?"rgba("+b+", "+this.a:"rgb("+b)+")"},toString:function(){return this.toCss(!0)}});b.blendColors=h.blendColors=function(d,k,m,g){var e=g||new b;a.forEach(["r","g","b","a"],function(a){e[a]=d[a]+(k[a]-d[a])*m;"a"!=a&&(e[a]=Math.round(e[a]))});
return e.sanitize()};b.fromRgb=h.colorFromRgb=function(a,d){var m=a.toLowerCase().match(/^rgba?\(([\s\.,0-9]+)\)/);return m&&b.fromArray(m[1].split(/\s*,\s*/),d)};b.fromHex=h.colorFromHex=function(d,k){var m=k||new b,g=4==d.length?4:8,e=(1<<g)-1;d=Number("0x"+d.substr(1));if(isNaN(d))return null;a.forEach(["b","g","r"],function(a){var b=d&e;d>>=g;m[a]=4==g?17*b:b});m.a=1;return m};b.fromArray=h.colorFromArray=function(a,d){var m=d||new b;m._set(Number(a[0]),Number(a[1]),Number(a[2]),Number(a[3]));
isNaN(m.a)&&(m.a=1);return m.sanitize()};b.fromString=h.colorFromString=function(a,d){var m=b.named[a];return m&&b.fromArray(m,d)||b.fromRgb(a,d)||b.fromHex(a,d)};return b})},"esri/graphic":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./domUtils ./lang ./InfoTemplate ./geometry/jsonUtils ./symbols/jsonUtils".split(" "),function(h,l,a,d,b,f,k,m,g){h=h(null,{declaredClass:"esri.Graphic",constructor:function(a,c,b,d){a&&!a.declaredClass?(this.geometry=a.geometry?m.fromJson(a.geometry):
null,this.symbol=a.symbol?g.fromJson(a.symbol):null,this.attributes=a.attributes||null,this.infoTemplate=a.infoTemplate?new k(a.infoTemplate):null):(this.geometry=a,this.symbol=c,this.attributes=b,this.infoTemplate=d)},_shape:null,_graphicsLayer:null,_visible:!0,visible:!0,getDojoShape:function(){return this._shape},getShapes:function(){var a=[];return this._shape&&a.push(this._shape),this._bgShape&&a.push(this._bgShape),a},getNode:function(){var a=this._shape&&this._shape.getNode();return a&&a.nodeType?
a:null},getNodes:function(){var a,c,b=this.getShapes(),g=b.length,d=[];for(c=0;g>c;c++)(a=b[c]&&b[c].getNode())&&a.nodeType&&d.push(a);return d},getLayer:function(){return this._layer},draw:function(){var a=this._graphicsLayer;return a&&a._draw(this,!0),this},setGeometry:function(a){this.geometry=a;a=this._graphicsLayer;return a&&(a._updateExtent(this),a._draw(this,!0)),this},setSymbol:function(a,c){var b=this._graphicsLayer,g=this._shape;return this.symbol=a,b&&(c&&g&&b._removeShape(this),b._draw(this,
!0)),this},setAttributes:function(a){return this.attributes=a,this._clearCache(),this},setInfoTemplate:function(a){return this.infoTemplate=a,this},getInfoTemplate:function(){return this._getEffInfoTemplate()},_getEffInfoTemplate:function(){var a=this.getLayer();return this.infoTemplate||a&&a.infoTemplate},getTitle:function(){var a=this.getInfoTemplate(),c=a&&a.title;if(l.isFunction(c))c=c.call(a,this);else if(l.isString(c))var b=(a=this.getLayer())&&a._getDateOpts,c=f.substitute(this.attributes,
c,{first:!0,dateFormat:b&&b.call(a)});return c},getContent:function(){var a=this.getInfoTemplate(),c=a&&a.content;if(l.isFunction(c))c=c.call(a,this);else if(l.isString(c))var b=(a=this.getLayer())&&a._getDateOpts,c=f.substitute(this.attributes,c,{dateFormat:b&&b.call(a)});return c},attr:function(a,c){var b,g=this.getNodes(),d=g.length;for(b=0;d>b;b++)null==c?g[b].removeAttribute(a):g[b].setAttribute(a,c);return this},show:function(){this.visible=this._visible=!0;var a,c,g;if(this.getShapes().length)for(a=
this.getNodes(),g=a.length,this.attr("data-hidden"),c=0;g>c;c++)b.show(a[c]);else this._graphicsLayer&&this._graphicsLayer._draw(this,!0);return this},hide:function(){this.visible=this._visible=!1;var a,c,g;if(c=this._graphicsLayer)if("canvas-2d"===c.surfaceType)c._removeShape(this);else if(a=this.getNodes(),g=a.length)for(this.attr("data-hidden",""),c=0;g>c;c++)b.hide(a[c]);return this},toJson:function(){var a={};return this.geometry&&(a.geometry=this.geometry.toJson()),this.attributes&&(a.attributes=
l.mixin({},this.attributes)),this.symbol&&(a.symbol=this.symbol.toJson()),this.infoTemplate&&(a.infoTemplate=this.infoTemplate.toJson()),a},_getView:function(a){return(a=(a=a||this.getLayer())&&a.getMap())&&a._getView()},_getDataValue:function(a,c,b,g){var d=this._getCacheItem(a,c);if(void 0===d.value){var f=null,k=this.attributes,t=a.field;c.hasExpr?f=b.executeFunction(c.compiledFunc,b.createExecContext(this,this._getView(g))):l.isFunction(t)?f=t(this):k&&(f=k[t],(a=a.normalizationField)&&this._isValidNumber(f)&&
(k=parseFloat(k[a]),this._isValidNumber(k)&&0!==k?f/=k:f=null));this._isValidNumber(f)||(f=null);d.value=f}return d.value},_isValidNumber:function(a){return"number"==typeof a&&!isNaN(a)&&a!==1/0&&a!==-(1/0)},_getCacheItem:function(a,c){var b=this._findCacheItem(a);return b?b.version!==c.version&&(b.version=c.version,b.value=void 0):b=this._createCacheItem(a,c),b},_findCacheItem:function(a){var c,b=this._cache;if(b){var g,d=b.length;for(g=0;d>g;g++){var f=b[g];if(f.variable===a){c=f;break}}}return c},
_createCacheItem:function(a,c){var b=this._cache;b||(b=this._cache=[]);var g={variable:a,version:c.version,value:void 0};return b.push(g),g},_clearCache:function(){this._cache=null}});return h.prototype.getShape=h.prototype.getDojoShape,a("extend-esri")&&(d.Graphic=h),h})},"esri/domUtils":function(){define(["./kernel","dojo/_base/connect","dojo/_base/lang","dojo/dom-style","dojo/has"],function(h,l,a,d,b){var f={show:function(a){(a=f.getNode(a))&&(a.style.display="block")},getNode:function(a){return a&&
a.domNode||a},hide:function(a){(a=f.getNode(a))&&(a.style.display="none")},toggle:function(a){(a=f.getNode(a))&&(a.style.display="none"===a.style.display?"block":"none")},documentBox:8>=b("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight},setScrollable:function(a){if(a=this.getNode(a)){var b=0,g=0,e=0,c=0,f=0,q=0;return[l.connect(a,"ontouchstart",function(d){b=d.touches[0].screenX;g=d.touches[0].screenY;e=a.scrollWidth;
c=a.scrollHeight;f=a.clientWidth;q=a.clientHeight}),l.connect(a,"ontouchmove",function(r){r.preventDefault();var u=a.firstChild;u instanceof Text&&(u=a.childNodes[1]);var v=u._currentX||0,t=u._currentY||0,v=v+(r.touches[0].screenX-b);0<v?v=0:0>v&&Math.abs(v)+f>e&&(v=-1*(e-f));u._currentX=v;t+=r.touches[0].screenY-g;0<t?t=0:0>t&&Math.abs(t)+q>c&&(t=-1*(c-q));u._currentY=t;d.set(u,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+v+"px, "+t+"px)"});b=r.touches[0].screenX;
g=r.touches[0].screenY})]}}};return b("extend-esri")&&a.mixin(h,f),f})},"esri/InfoTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(h,l,a,d,b){h=h(null,{declaredClass:"esri.InfoTemplate",constructor:function(a,b){a&&l.isObject(a)&&!l.isFunction(a)?l.mixin(this,a):(this.title=a||"${*}",this.content=b||"${*}")},setTitle:function(a){return this.title=a,this},setContent:function(a){return this.content=a,this},toJson:function(){return b.fixJson({title:this.title,
content:this.content})}});return a("extend-esri")&&(d.InfoTemplate=h),h})},"esri/geometry/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./Point ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(h,l,a,d,b,f,k,m){var g={fromJson:function(a){return void 0!==a.x&&void 0!==a.y?new d(a):void 0!==a.paths?new b(a):void 0!==a.rings?new f(a):void 0!==a.points?new k(a):void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax?new m(a):void 0},getJsonType:function(a){return a instanceof
d?"esriGeometryPoint":a instanceof b?"esriGeometryPolyline":a instanceof f?"esriGeometryPolygon":a instanceof m?"esriGeometryEnvelope":a instanceof k?"esriGeometryMultipoint":null},getGeometryType:function(a){return"esriGeometryPoint"===a?d:"esriGeometryPolyline"===a?b:"esriGeometryPolygon"===a?f:"esriGeometryEnvelope"===a?m:"esriGeometryMultipoint"===a?k:null}};return l("extend-esri")&&h.mixin(h.getObject("geometry",!0,a),g),g})},"esri/geometry/Polyline":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c){var n={type:"polyline",paths:null};h=h(m,{declaredClass:"esri.geometry.Polyline",constructor:function(e){a.mixin(this,n);this.paths=[];this._path=0;e&&(a.isArray(e)?this.paths=a.isArray(e[0][0])?e:[e]:e.paths?a.mixin(this,e):this.spatialReference=e,this.spatialReference&&(this.spatialReference=c.createSpatialReference(this.spatialReference)));this.verifySR()},addPath:function(c){return this.clearCache(),this._path=this.paths.length,this.paths[this._path]=[],a.isArray(c[0])?
l.forEach(c,this._addPointArr,this):l.forEach(c,this._addPoint,this),this},_addPointArr:function(a){this.paths[this._path].push(a)},_addPoint:function(a){this.paths[this._path].push([a.x,a.y])},_insertPoints:function(a,c){this.clearCache();this._path=c;this.paths[this._path]||(this.paths[this._path]=[]);l.forEach(a,this._addPoint,this)},_validateInputs:function(a,c){return null!==a&&void 0!==a&&(0>a||a>=this.paths.length)?!1:null!==c&&void 0!==a&&(0>c||c>=this.paths[a].length)?!1:!0},getPoint:function(a,
c){return this._validateInputs(a,c)?new g(this.paths[a][c],this.spatialReference):void 0},setPoint:function(a,c,e){return this._validateInputs(a,c)?(this.clearCache(),this.paths[a][c]=[e.x,e.y],this):void 0},insertPoint:function(a,c,e){return this._validateInputs(a)&&f.isDefined(c)&&0<=c&&c<=this.paths[a].length?(this.clearCache(),this.paths[a].splice(c,0,[e.x,e.y]),this):void 0},removePath:function(a){if(this._validateInputs(a,null)){this.clearCache();var c=this.paths.splice(a,1)[0],e=c.length,b=
this.spatialReference;for(a=0;e>a;a++)c[a]=new g(c[a],b);return c}},removePoint:function(a,c){return this._validateInputs(a,c)?(this.clearCache(),new g(this.paths[a].splice(c,1)[0],this.spatialReference)):void 0},getExtent:function(){var a,c=this.getCacheValue("_extent"),b=this.getCacheValue("_partwise");if(c)return a=new e(c),a._partwise=b,a;var g=this.paths,d=g.length;if(d&&g[0].length){var f,n,k,m,h,l,C,D,E,F,H,G,K=m=g[0][0][0],J=h=g[0][0][1],I=Math.min,L=Math.max,M=this.spatialReference,N=[];
for(l=0;d>l;l++){f=g[l];E=F=f[0]&&f[0][0];H=G=f[0]&&f[0][1];D=f.length;for(C=0;D>C;C++)n=f[C],k=n[0],n=n[1],K=I(K,k),J=I(J,n),m=L(m,k),h=L(h,n),E=I(E,k),H=I(H,n),F=L(F,k),G=L(G,n);N.push(new e({xmin:E,ymin:H,xmax:F,ymax:G,spatialReference:M?M.toJson():null}))}return c={xmin:K,ymin:J,xmax:m,ymax:h,spatialReference:M?M.toJson():null},b=1<N.length?N:null,this.setCacheValue("_extent",c),this.setCacheValue("_partwise",b),a=new e(c),a._partwise=b,a}},toJson:function(){var c={paths:a.clone(this.paths)},
e=this.spatialReference;return e&&(c.spatialReference=e.toJson()),c}});return h.defaultProps=n,d("extend-esri")&&(a.setObject("geometry.Polyline",h,b),b.geometry.defaultPolyline=n),h})},"esri/geometry/Extent":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./webMercatorUtils ./mathUtils ../srUtils".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n){var q={type:"extent",xmin:0,ymin:0,xmax:0,ymax:0},r=h(m,{declaredClass:"esri.geometry.Extent",
constructor:function(c,e,b,g,d){a.mixin(this,q);a.isObject(c)?(a.mixin(this,c),this.spatialReference&&(this.spatialReference=n.createSpatialReference(this.spatialReference))):this.update(c,e,b,g,d);this.verifySR()},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-this.ymin)},getCenter:function(){return new g((this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2,this.spatialReference)},centerAt:function(a){var c=this.getCenter(),e=a.x-c.x;a=a.y-c.y;
return new r(this.xmin+e,this.ymin+a,this.xmax+e,this.ymax+a,this.spatialReference)},update:function(a,c,e,b,g){return this.xmin=a,this.ymin=c,this.xmax=e,this.ymax=b,this.spatialReference=g,this.clearCache(),this},offset:function(a,c){return new r(this.xmin+a,this.ymin+c,this.xmax+a,this.ymax+c,this.spatialReference)},expand:function(a){var c=(1-a)/2;a=this.getWidth()*c;c*=this.getHeight();return new r(this.xmin+a,this.ymin+c,this.xmax-a,this.ymax-c,this.spatialReference)},intersects:function(a){if(!a)return!1;
var c=a.type,b=this.spatialReference,g=a.spatialReference;switch(b&&g&&!b.equals(g)&&b._canProject(g)&&(a=b.isWebMercator()?e.geographicToWebMercator(a):e.webMercatorToGeographic(a,!0)),c){case "point":return this.contains(a);case "multipoint":return this._intersectsMultipoint(a);case "extent":return this._intersectsExtent(a);case "polygon":return this._intersectsPolygon(a);case "polyline":return this._intersectsPolyline(a)}},normalize:function(){var c=this._normalize(!1,!0);return a.isArray(c)||
(c=[c]),c},shiftCentralMeridian:function(){return this._normalize(!0)},bisect:function(){var a=this.spatialReference,c=a&&a._getInfo(),e=[],b=0;if(c&&this._isOutOfBounds(c)){var g=this,b=g.xmin,d=g.ymin,f=g.ymax,n=c.valid[0],m=c.valid[1];g.getWidth()>2*m&&(g=g.getCenter(),g=new r(g.x-m,d,g.x+m,f,new k(a.toJson())));var b=g.xmin-b,q=this._normalizeX(g.xmin,c),c=this._normalizeX(g.xmax,c);q.frameId===c.frameId?e.push(new r(q.x,d,c.x,f,new k(a.toJson()))):e.push(new r(q.x,d,m,f,new k(a.toJson())),new r(n,
d,c.x,f,new k(a.toJson())))}else e.push(this.getExtent());return{extents:e,marginLeft:b}},_intersectsMultipoint:function(a){var c,e=a.points.length;for(c=0;e>c;c++)if(this.contains(a.getPoint(c)))return!0;return!1},_intersectsExtent:function(a){var c,e,b,g,d=!1;return this.xmin<=a.xmin?(c=a.xmin,this.xmax<c?d=!0:b=Math.min(this.xmax,a.xmax)-c):(c=this.xmin,a.xmax<c?d=!0:b=Math.min(this.xmax,a.xmax)-c),this.ymin<=a.ymin?(e=a.ymin,this.ymax<e?d=!0:g=Math.min(this.ymax,a.ymax)-e):(e=this.ymin,a.ymax<
e?d=!0:g=Math.min(this.ymax,a.ymax)-e),d?null:new r(c,e,c+b,e+g,this.spatialReference)},_intersectsPolygon:function(a){var c,e,b;c=[this.xmin,this.ymax];b=[this.xmax,this.ymax];var d=[this.xmin,this.ymin],f=[this.xmax,this.ymin],n=[c,b,d,f],d=[[d,c],[c,b],[b,f],[f,d]],f=a.rings,k=f.length,m=new g(0,0,this.spatialReference);b=n.length;for(c=0;b>c;c++)if(m.update(n[c][0],n[c][1]),a.contains(m))return!0;m.setSpatialReference(a.spatialReference);var r,q;for(c=0;k>c;c++)if(e=f[c],b=e.length){if(r=e[0],
m.update(r[0],r[1]),this.contains(m))return!0;for(a=1;b>a;a++){if(q=e[a],m.update(q[0],q[1]),this.contains(m)||this._intersectsLine([r,q],d))return!0;r=q}}return!1},_intersectsPolyline:function(a){var c,e,b,d,f,n=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],k=a.paths,m=k.length,r=new g(0,0,a.spatialReference);for(a=0;m>a;a++)if(e=k[a],b=e.length){if(d=e[0],r.update(d[0],
d[1]),this.contains(r))return!0;for(c=1;b>c;c++){if(f=e[c],r.update(f[0],f[1]),this.contains(r)||this._intersectsLine([d,f],n))return!0;d=f}}return!1},_intersectsLine:function(a,e){var b,g=c._getLineIntersection2,d=e.length;for(b=0;d>b;b++)if(g(a,e[b]))return!0;return!1},contains:function(a){if(!a)return!1;var c=a.type;if("point"===c){var e,c=this.spatialReference,b=a.spatialReference,d=a.x;a=a.y;return c&&b&&!c.equals(b)&&c._canProject(b)&&(e=c.isWebMercator()?g.lngLatToXY(d,a):g.xyToLngLat(d,a,
!0),d=e[0],a=e[1]),d>=this.xmin&&d<=this.xmax&&a>=this.ymin&&a<=this.ymax}return"extent"===c?this._containsExtent(a):!1},_containsExtent:function(a){var c=a.xmin,e=a.ymin,b=a.xmax,d=a.ymax,f=a.spatialReference;a=new g(c,e,f);c=new g(c,d,f);d=new g(b,d,f);e=new g(b,e,f);return this.contains(a)&&this.contains(c)&&this.contains(d)&&this.contains(e)?!0:!1},union:function(a){return new r(Math.min(this.xmin,a.xmin),Math.min(this.ymin,a.ymin),Math.max(this.xmax,a.xmax),Math.max(this.ymax,a.ymax),this.spatialReference)},
getExtent:function(){var a=this.spatialReference;return new r(this.xmin,this.ymin,this.xmax,this.ymax,a&&new k(a.toJson()))},_shiftCM:function(a){var c=this.getCacheValue("_shifted");if(!c){var c=new r(this.toJson()),b=c.spatialReference;if(a=a||b._getInfo()){var g=this._getCM(a);if(g){var d=b._isWebMercator()?e.webMercatorToGeographic(g):g;c.xmin-=g.x;c.xmax-=g.x;b._isWebMercator()||(d.x=this._normalizeX(d.x,a).x);c.setSpatialReference(new k(f.substitute({Central_Meridian:d.x},4326===b.wkid?a.altTemplate:
a.wkTemplate)))}}this.setCacheValue("_shifted",c)}return c},_getCM:function(a){var c;return this._isOutOfBounds(a)&&(c=this.getCenter()),c},_isOutOfBounds:function(a){var c=a.valid[0];a=a.valid[1];var e=this.xmin,b=this.xmax;return!(e>=c&&a>=e&&b>=c&&a>=b)},_normalize:function(a,c,e){var b=new r(this.toJson()),g=b.spatialReference;if(g&&(e=e||g._getInfo())){var d=l.map(this._getParts(e),function(a){return a.extent});return 2<d.length?a?this._shiftCM(e):b.update(e.valid[0],b.ymin,e.valid[1],b.ymax,
g):2===d.length?a?this._shiftCM(e):c?d:{rings:l.map(d,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:g}:d[0]||b}return b},_getParts:function(a){var c=this.getCacheValue("_parts");if(!c){var c=[],e,b,g,d,f=this.xmin,n=this.xmax,k=this.ymin,m=this.ymax,q=this.spatialReference,h=this.getWidth(),l=f,H=n,G=0,K=0;if(a=a||q._getInfo(),b=a.valid[0],g=a.valid[1],e=this._normalizeX(f,a),f=e.x,G=e.frameId,e=this._normalizeX(n,a),n=e.x,K=
e.frameId,d=f===n&&0<h,h>2*g){a=new r(H>l?f:n,k,g,m,q);f=new r(b,k,H>l?n:f,m,q);g=new r(0,k,g,m,q);k=new r(b,k,0,m,q);m=[];q=[];a.contains(g)&&m.push(G);a.contains(k)&&q.push(G);f.contains(g)&&m.push(K);f.contains(k)&&q.push(K);for(b=G+1;K>b;b++)m.push(b),q.push(b);c.push({extent:a,frameIds:[G]},{extent:f,frameIds:[K]},{extent:g,frameIds:m},{extent:k,frameIds:q})}else f>n||d?c.push({extent:new r(f,k,g,m,q),frameIds:[G]},{extent:new r(b,k,n,m,q),frameIds:[K]}):c.push({extent:new r(f,k,n,m,q),frameIds:[G]});
this.setCacheValue("_parts",c)}return c},_normalizeX:function(a,c){var e,b=0,g=c.valid[0],d=c.valid[1],f=2*d;return a>d?(e=Math.ceil(Math.abs(a-d)/f),a-=e*f,b=e):g>a&&(e=Math.ceil(Math.abs(a-g)/f),a+=e*f,b=-e),{x:a,frameId:b}},toJson:function(){var a={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax},c=this.spatialReference;return c&&(a.spatialReference=c.toJson()),a}});return r.defaultProps=q,d("extend-esri")&&(a.setObject("geometry.Extent",r,b),b.geometry.defaultExtent=q),r})},"esri/geometry/webMercatorUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point".split(" "),
function(h,l,a,d,b,f){function k(a,c,g,d){if("point"===a.type){var f=c(a.x,a.y,d);return new a.constructor(f[0],f[1],new b(g))}if("extent"===a.type){var f=c(a.xmin,a.ymin,d),k=c(a.xmax,a.ymax,d);return new a.constructor(f[0],f[1],k[0],k[1],new b(g))}if("polyline"===a.type||"polygon"===a.type){var m,f="polyline"===a.type,t=[];return h.forEach(f?a.paths:a.rings,function(a){t.push(m=[]);h.forEach(a,function(a){m.push(c(a[0],a[1],d))})}),f?new a.constructor({paths:t,spatialReference:new b(g)}):new a.constructor({rings:t,
spatialReference:new b(g)})}if("multipoint"===a.type){var w=[];return h.forEach(a.points,function(a){w.push(c(a[0],a[1],d))}),new a.constructor({points:w,spatialReference:new b(g)})}}function m(a,c){var b=a&&(null!=a.wkid?a:a.spatialReference),g=c&&(null!=c.wkid?c:c.spatialReference);return b&&g?g.equals(b)?!0:g._canProject(b):!1}var g={canProject:m,project:function(a,c){var b=a&&a.spatialReference,g=c&&(null!=c.wkid?c:c.spatialReference);return b&&g?b.equals(g)?a=new a.constructor(a.toJson()):m(b,
g)?g.isWebMercator()?a=k(a,f.lngLatToXY,{wkid:102100}):4326===g.wkid&&(a=k(a,f.xyToLngLat,{wkid:4326})):a=null:a=null,a},lngLatToXY:f.lngLatToXY,xyToLngLat:f.xyToLngLat,geographicToWebMercator:function(a){return k(a,f.lngLatToXY,{wkid:102100})},webMercatorToGeographic:function(a,c){return k(a,f.xyToLngLat,{wkid:4326},c)}};return a("extend-esri")&&l.mixin(l.getObject("geometry",!0,d),g),g})},"esri/geometry/mathUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","./Point"],function(h,
l,a,d){function b(a,b,c){return a instanceof d?new d(a.x+c*(b.x-a.x),a.y+c*(b.y-a.y)):[a[0]+c*(b[0]-a[0]),a[1]+c*(b[1]-a[1])]}function f(a,b){return 1E-8>Math.abs(a-b)}function k(a,b,c,d){var k,m,u=f(a[0],b[0])?1E10:(a[1]-b[1])/(a[0]-b[0]),v=f(c[0],d[0])?1E10:(c[1]-d[1])/(c[0]-d[0]),t=a[1]-u*a[0],h=c[1]-v*c[0];if(f(u,v)){if(f(t,h)){if(f(a[0],b[0])){if(!(Math.min(a[1],b[1])<Math.max(c[1],d[1])||Math.max(a[1],b[1])>Math.min(c[1],d[1])))return null;m=(a[1]+b[1]+c[1]+d[1]-Math.min(a[1],b[1],c[1],d[1])-
Math.max(a[1],b[1],c[1],d[1]))/2;k=(m-t)/u}else{if(!(Math.min(a[0],b[0])<Math.max(c[0],d[0])||Math.max(a[0],b[0])>Math.min(c[0],d[0])))return null;k=(a[0]+b[0]+c[0]+d[0]-Math.min(a[0],b[0],c[0],d[0])-Math.max(a[0],b[0],c[0],d[0]))/2;m=u*k+t}return[k,m]}return null}return f(u,1E10)?(k=a[0],m=v*k+h):f(v,1E10)?(k=c[0],m=u*k+t):(k=-(t-h)/(u-v),m=a[1]===b[1]?a[1]:c[1]===d[1]?c[1]:u*k+t),[k,m]}var m={getLength:function(a,b){var c=b.x-a.x,d=b.y-a.y;return Math.sqrt(c*c+d*d)},_getLength:function(a,b){var c=
b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)},getPointOnLine:b,getMidpoint:function(a,e){return b(a,e,.5)},_equals:f,_getLineIntersection:k,getLineIntersection:function(a,b,c,f,m){a=k([a.x,a.y],[b.x,b.y],[c.x,c.y],[f.x,f.y]);return a&&(a=new d(a[0],a[1],m)),a},_getLineIntersection2:function(a,b){var c,d,f,k,m=a[0],v=a[1],t=b[0],h=b[1],l=m[0],m=m[1],y=v[0],v=v[1],z=t[0],A=t[1],t=h[0]-z,z=l-z,B=y-l,h=h[1]-A,A=m-A,C=v-m,D=h*B-t*C;return 0===D?!1:(c=(t*A-h*z)/D,d=(B*A-C*z)/D,0<=c&&1>=c&&0<=d&&1>=d?
(f=l+c*(y-l),k=m+c*(v-m),[f,k]):!1)},_pointLineDistance:function(a,b){var c=b[0],d=b[1],f=c[0],k=c[1],c=a[0],m=a[1],v=d[0]-f,t=d[1]-k,h=c-f,l=m-k,d=Math.sqrt,y=Math.pow,z=d(y(v,2)+y(t,2)),h=(h*v+l*t)/(z*z),k=k+h*t;return d(y(c-(f+h*v),2)+y(m-k,2))}};return l("extend-esri")&&h.mixin(h.getObject("geometry",!0,a),m),m})},"esri/geometry/Polygon":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ./mathUtils ../srUtils".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n){var q={type:"polygon",rings:null},r=h(m,{declaredClass:"esri.geometry.Polygon",constructor:function(c){a.mixin(this,q);this.rings=[];this._ring=0;c&&(a.isArray(c)?this.rings=a.isArray(c[0][0])?c:[c]:c.rings?a.mixin(this,c):this.spatialReference=c,this.spatialReference&&(this.spatialReference=n.createSpatialReference(this.spatialReference)));this.verifySR()},addRing:function(c){return this.clearCache(),this._ring=this.rings.length,this.rings[this._ring]=[],a.isArray(c[0])?
l.forEach(c,this._addPointArr,this):l.forEach(c,this._addPoint,this),this},_addPointArr:function(a){this.rings[this._ring].push(a)},_addPoint:function(a){this.rings[this._ring].push([a.x,a.y])},_insertPoints:function(a,c){this.clearCache();this._ring=c;this.rings[this._ring]||(this.rings[this._ring]=[]);l.forEach(a,this._addPoint,this)},_validateInputs:function(a,c){return null!==a&&void 0!==a&&(0>a||a>=this.rings.length)?!1:null!==c&&void 0!==a&&(0>c||c>=this.rings[a].length)?!1:!0},getPoint:function(a,
c){return this._validateInputs(a,c)?new g(this.rings[a][c],this.spatialReference):void 0},setPoint:function(a,c,b){return this._validateInputs(a,c)?(this.clearCache(),this.rings[a][c]=[b.x,b.y],this):void 0},insertPoint:function(a,c,b){return this._validateInputs(a)&&f.isDefined(c)&&0<=c&&c<=this.rings[a].length?(this.clearCache(),this.rings[a].splice(c,0,[b.x,b.y]),this):void 0},removeRing:function(a){if(this._validateInputs(a,null)){this.clearCache();var c=this.rings.splice(a,1)[0],b=c.length,e=
this.spatialReference;for(a=0;b>a;a++)c[a]=new g(c[a],e);return c}},removePoint:function(a,c){return this._validateInputs(a,c)?(this.clearCache(),new g(this.rings[a].splice(c,1)[0],this.spatialReference)):void 0},getExtent:function(){var a,c=this.getCacheValue("_extent"),b=this.getCacheValue("_partwise");if(c)return a=new e(c),a._partwise=b,a;var g=this.rings,d=g.length;if(d&&g[0].length){var f,k,n,m,r,q,h,l,H,G,K,J,I=m=g[0][0][0],L=r=g[0][0][1],M=Math.min,N=Math.max,Q=this.spatialReference,O=[];
for(q=0;d>q;q++){f=g[q];H=G=f[0]&&f[0][0];K=J=f[0]&&f[0][1];l=f.length;for(h=0;l>h;h++)k=f[h],n=k[0],k=k[1],I=M(I,n),L=M(L,k),m=N(m,n),r=N(r,k),H=M(H,n),K=M(K,k),G=N(G,n),J=N(J,k);O.push(new e({xmin:H,ymin:K,xmax:G,ymax:J,spatialReference:Q?Q.toJson():null}))}return c={xmin:I,ymin:L,xmax:m,ymax:r,spatialReference:Q?Q.toJson():null},b=1<O.length?O:null,this.setCacheValue("_extent",c),this.setCacheValue("_partwise",b),a=new e(c),a._partwise=b,a}},contains:function(a){var c,b,e,d,f,k,n,m=this.rings,
r=!1,q=m.length;b=this.spatialReference;e=a.spatialReference;var h=a.x;a=a.y;b&&e&&!b.equals(e)&&b._canProject(e)&&(c=b.isWebMercator()?g.lngLatToXY(h,a):g.xyToLngLat(h,a,!0),h=c[0],a=c[1]);for(n=0;q>n;n++)for(c=m[n],d=c.length,k=f=0;d>k;k++)f++,f===d&&(f=0),b=c[k],e=c[f],(b[1]<a&&e[1]>=a||e[1]<a&&b[1]>=a)&&b[0]+(a-b[1])/(e[1]-b[1])*(e[0]-b[0])<h&&(r=!r);return r},getCentroid:function(){var a=this.getCacheValue("_centroid");if(void 0!==a)return a;var c,b,e,d,f,k,n=this.rings,m=[],r=1/0,q=-(1/0),h=
1/0,F=-(1/0);(l.forEach(n,function(a){c=b=e=0;l.forEach(a,function(g,d){d<a.length-1&&(f=a[d+1],k=g[0]*f[1]-f[0]*g[1],c+=(g[0]+f[0])*k,b+=(g[1]+f[1])*k,e+=k,g[0]<r&&(r=g[0]),g[0]>q&&(q=g[0]),g[1]<h&&(h=g[1]),g[1]>F&&(F=g[1]))});0<e&&(e*=-1);e&&m.push([c,b,e/2])}),m.sort(function(a,c){return a[2]-c[2]}),c=b=void 0,m[0]&&(d=6*m[0][2],c=m[0][0]/d,b=m[0][1]/d,(r>c||c>q||h>b||b>F)&&(c=b=void 0)),void 0===c||void 0===b)&&(d=n[0]&&n[0].length?this._getLineCentroid(n[0]):null)&&(c=d.x,b=d.y);return a=isNaN(c)||
isNaN(b)?null:new g(c,b,this.spatialReference),this.setCacheValue("_centroid",a),a},_getLineCentroid:function(a){var b,e,g,d,f,k,n=0,m=0,r=0,q={x:0,y:0},h={x:0,y:0},l=a.length;for(d=0;l-1>d;d++)e=a[d],g=a[d+1],e&&g&&(q.x=e[0],q.y=e[1],h.x=g[0],h.y=g[1],b=c.getLength(q,h),0<b&&(n+=b,f=c.getMidpoint(e,g),m+=b*f[0],r+=b*f[1]));return 0<n?k={x:m/n,y:r/n}:a[0]&&(k={x:a[0][0],y:a[0][1]}),k},isClockwise:function(c){var b,e=0,g=c.length,d=a.isArray(c[0])?function(a,c){return a[0]*c[1]-c[0]*a[1]}:function(a,
c){return a.x*c.y-c.x*a.y};for(b=0;g>b;b++)e+=d(c[b],c[(b+1)%g]);return 0>=e/2},isSelfIntersecting:function(a){a=a||this;var b,e,g,d,f,k,n,m,r=a.rings.length;for(g=0;r>g;g++){for(b=0;b<a.rings[g].length-1;b++)for(f=[[a.rings[g][b][0],a.rings[g][b][1]],[a.rings[g][b+1][0],a.rings[g][b+1][1]]],e=g+1;r>e;e++)for(d=0;d<a.rings[e].length-1;d++)if(k=[[a.rings[e][d][0],a.rings[e][d][1]],[a.rings[e][d+1][0],a.rings[e][d+1][1]]],n=c._getLineIntersection2(f,k),n&&!(n[0]===f[0][0]&&n[1]===f[0][1]||n[0]===k[0][0]&&
n[1]===k[0][1]||n[0]===f[1][0]&&n[1]===f[1][1]||n[0]===k[1][0]&&n[1]===k[1][1]))return!0;if(m=a.rings[g].length,!(4>=m))for(b=0;m-3>b;b++)for(d=m-1,0===b&&(d=m-2),f=[[a.rings[g][b][0],a.rings[g][b][1]],[a.rings[g][b+1][0],a.rings[g][b+1][1]]],e=b+2;d>e;e++)if(k=[[a.rings[g][e][0],a.rings[g][e][1]],[a.rings[g][e+1][0],a.rings[g][e+1][1]]],n=c._getLineIntersection2(f,k),n&&!(n[0]===f[0][0]&&n[1]===f[0][1]||n[0]===k[0][0]&&n[1]===k[0][1]||n[0]===f[1][0]&&n[1]===f[1][1]||n[0]===k[1][0]&&n[1]===k[1][1]))return!0}return!1},
toJson:function(){var c={rings:a.clone(this.rings)},b=this.spatialReference;return b&&(c.spatialReference=b.toJson()),c}});return r.defaultProps=q,r.createEllipse=function(a){var c,b,e,g=a.center.x,d=a.center.y,f=a.longAxis,k=a.shortAxis,n=a.numberOfPoints,m=a.map,q=[],h=2*Math.PI/n;for(a=0;n>a;a++)c=Math.cos(a*h),b=Math.sin(a*h),c=m.toMap({x:f*c+g,y:k*b+d}),q.push(c);return q.push(q[0]),e=new r(m.spatialReference),e.addRing(q),e},r.createCircle=function(a){return r.createEllipse({center:a.center,
longAxis:a.r,shortAxis:a.r,numberOfPoints:a.numberOfPoints,map:a.map})},r.fromExtent=function(a){var c=a.normalize();a=a.spatialReference;return new r({rings:l.map(c,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:a?a.toJson():null})},d("extend-esri")&&(a.setObject("geometry.Polygon",r,b),b.geometry.defaultPolygon=q,b.geometry.createEllipse=r.createEllipse,b.geometry.createCircle=r.createCircle,b.geometry.isClockwise=r.prototype.isClockwise,
b.geometry.polygonSelfIntersecting=r.prototype.isSelfIntersecting),r})},"esri/geometry/Multipoint":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(h,l,a,d,b,f,k,m,g){var e={type:"multipoint",points:null};h=h(f,{declaredClass:"esri.geometry.Multipoint",constructor:function(a){l.mixin(this,e);this.points=[];a&&(a.points?l.mixin(this,a):this.spatialReference=a,this.spatialReference&&(this.spatialReference=
g.createSpatialReference(this.spatialReference)));this.verifySR()},addPoint:function(a){return this.clearCache(),l.isArray(a)?this.points.push(a):this.points.push([a.x,a.y]),this},removePoint:function(a){return this._validateInputs(a)?(this.clearCache(),new k(this.points.splice(a,1)[0],this.spatialReference)):void 0},getExtent:function(){var a=this.getCacheValue("_extent");if(a)return new m(a);var b=this.points,e=b.length;if(e){var g,d,f,k,h;k=b[0];var l=g=k[0],y=d=k[1],z=Math.min,A=Math.max,B=this.spatialReference;
for(h=0;e>h;h++)k=b[h],f=k[0],k=k[1],l=z(l,f),y=z(y,k),g=A(g,f),d=A(d,k);return a={xmin:l,ymin:y,xmax:g,ymax:d,spatialReference:B?B.toJson():null},this.setCacheValue("_extent",a),new m(a)}},_validateInputs:function(a){return null===a||0>a||a>=this.points.length?!1:!0},getPoint:function(a){if(this._validateInputs(a))return a=this.points[a],new k(a[0],a[1],this.spatialReference)},setPoint:function(a,b){return this._validateInputs(a)?(this.clearCache(),this.points[a]=[b.x,b.y],this):void 0},toJson:function(){var a=
{points:l.clone(this.points)},b=this.spatialReference;return b&&(a.spatialReference=b.toJson()),a}});return h.defaultProps=e,a("extend-esri")&&(l.setObject("geometry.Multipoint",h,d),d.geometry.defaultMultipoint=e),h})},"esri/symbols/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./SimpleMarkerSymbol ./PictureMarkerSymbol ./SimpleLineSymbol ./CartographicLineSymbol ./SimpleFillSymbol ./PictureFillSymbol ./TextSymbol".split(" "),function(h,l,a,d,b,f,k,m,g,e){var c={fromJson:function(a){var c=
null;switch(a.type){case "esriSMS":c=new d(a);break;case "esriPMS":c=new b(a);break;case "esriTS":c=new e(a);break;case "esriSLS":c=void 0!==a.cap?new k(a):new f(a);break;case "esriCLS":c=new k(a);break;case "esriSFS":c=new m(a);break;case "esriPFS":c=new g(a)}return c},getShapeDescriptors:function(a){return a&&a.getShapeDescriptors?a.getShapeDescriptors():{defaultShape:null,fill:null,stroke:null}}};return l("extend-esri")&&h.mixin(h.getObject("symbol",!0,a),c),c})},"esri/symbols/SimpleMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./MarkerSymbol ./SimpleLineSymbol".split(" "),
function(h,l,a,d,b,f,k,m,g){var e={STYLE_CIRCLE:"circle",STYLE_SQUARE:"square",STYLE_CROSS:"cross",STYLE_X:"x",STYLE_DIAMOND:"diamond",STYLE_PATH:"path",STYLE_TARGET:"target"},c={style:e.STYLE_CIRCLE,color:[255,255,255,.25],size:12,angle:0,xoffset:0,yoffset:0};h=h(m,{declaredClass:"esri.symbol.SimpleMarkerSymbol",type:"simplemarkersymbol",_styles:{circle:"esriSMSCircle",square:"esriSMSSquare",cross:"esriSMSCross",x:"esriSMSX",diamond:"esriSMSDiamond",path:"esriSMSPath"},constructor:function(d,f,m,
u){d?l.isString(d)?(this.style=d,f&&(this.size=f),m&&(this.outline=m),u&&(this.color=u)):(this.style=k.valueOf(this._styles,this.style),d.outline&&(this.outline=new g(d.outline))):(l.mixin(this,c),this.size=b.pt2px(this.size),this.outline=new g(this.outline),this.color=new a(this.color));this.style||(this.style=e.STYLE_CIRCLE)},setStyle:function(a){return this.style=a,this},setPath:function(a){return this.path=a,this.setStyle(e.STYLE_PATH),this},setOutline:function(a){return this.outline=a,this},
getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return this.color},_setDim:function(a,c,b){this._targetWidth=a;this._targetHeight=c;this._spikeSize=b},getShapeDescriptors:function(){var a,g,d,f=this.style,k=(this.size||b.pt2px(c.size))/2,m=0-k,h=0+k,l=0-k,y=0+k;switch(f){case e.STYLE_CIRCLE:a={type:"circle",cx:0,cy:0,r:k};g=this.getFill();(d=this.getStroke())&&(d.style=d.style||"Solid");break;case e.STYLE_CROSS:a={type:"path",path:"M "+m+",0 L "+h+",0 M 0,"+
l+" L 0,"+y+" E"};g=null;d=this.getStroke();break;case e.STYLE_DIAMOND:a={type:"path",path:"M "+m+",0 L 0,"+l+" L "+h+",0 L 0,"+y+" L "+m+",0 Z"};g=this.getFill();d=this.getStroke();break;case e.STYLE_SQUARE:a={type:"path",path:"M "+m+","+y+" L "+m+","+l+" L "+h+","+l+" L "+h+","+y+" L "+m+","+y+" Z"};g=this.getFill();d=this.getStroke();break;case e.STYLE_X:a={type:"path",path:"M "+m+","+y+" L "+h+","+l+" M "+m+","+l+" L "+h+","+y+" E"};g=null;d=this.getStroke();break;case e.STYLE_PATH:a={type:"path",
path:this.path||""},g=this.getFill(),d=this.getStroke()}return{defaultShape:a,fill:g,stroke:d}},toJson:function(){var a=this.style,c=this.outline,b=l.mixin(this.inherited("toJson",arguments),{type:"esriSMS",style:this._styles[a]});return c&&(b.outline=c.toJson()),("x"===a||"cross"===a)&&delete b.color,b.path=this.path,k.fixJson(b)}});return l.mixin(h,e),h.defaultProps=c,d("extend-esri")&&(l.setObject("symbol.SimpleMarkerSymbol",h,f),f.symbol.defaultSimpleMarkerSymbol=c),h})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),
function(h,l,a,d,b,f,k,m,g){var e=l.getObject("dojox.gfx",!0),c=e._base={};e._hasClass=function(a,c){var b=a.getAttribute("className");return b&&0<=(" "+b+" ").indexOf(" "+c+" ")};e._addClass=function(a,c){var b=a.getAttribute("className")||"";(!b||0>(" "+b+" ").indexOf(" "+c+" "))&&a.setAttribute("className",b+(b?" ":"")+c)};e._removeClass=function(a,c){var b=a.getAttribute("className");b&&a.setAttribute("className",b.replace(new RegExp("(^|\\s+)"+c+"(\\s+|$)"),"$1$2"))};c._getFontMeasurements=function(){var a=
{"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},c,e;d("ie")&&(e=b.doc.documentElement.style.fontSize||"",e||(b.doc.documentElement.style.fontSize="100%"));var g=m.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},b.body());for(c in a)g.style.fontSize=c,a[c]=16*Math.round(12*g.offsetHeight/16)/12/1E3;
d("ie")&&(b.doc.documentElement.style.fontSize=e);b.body().removeChild(g);return a};var n=null;c._getCachedFontMeasurements=function(a){if(a||!n)n=c._getFontMeasurements();return n};var q=null,r={};c._getTextBox=function(a,c,e){var d,f,k=arguments.length,n;q||(q=m.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},b.body()));d=q;d.className="";f=d.style;f.borderWidth="0";f.margin="0";f.padding="0";f.outline="0";if(1<k&&c)for(n in c)n in r||(f[n]=c[n]);2<k&&e&&(d.className=
e);d.innerHTML=a;d.getBoundingClientRect?(f=d.getBoundingClientRect(),f={l:f.left,t:f.top,w:f.width||f.right-f.left,h:f.height||f.bottom-f.top}):f=g.getMarginBox(d);d.innerHTML="";return f};c._computeTextLocation=function(a,c,b,e){var g={};switch(a.align){case "end":g.x=a.x-c;break;case "middle":g.x=a.x-c/2;break;default:g.x=a.x}g.y=a.y-b*(e?.75:1);return g};c._computeTextBoundingBox=function(a){if(!e._base._isRendered(a))return{x:0,y:0,width:0,height:0};var b;b=a.getShape();var g=a.getFont()||e.defaultFont;
a=a.getTextWidth();g=e.normalizedLength(g.size);b=c._computeTextLocation(b,a,g,!0);return{x:b.x,y:b.y,width:a,height:g}};c._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var u=0;c._getUniqueId=function(){var a;do a=h._scopeName+"xUnique"+ ++u;while(k.byId(a));return a};var v=d("pointer-events")?"touchAction":d("MSPointer")?"msTouchAction":null;c._fixMsTouchAction=v?function(a){a.rawNode.style[v]="none"}:function(){};l.mixin(e,{defaultPath:{type:"path",path:""},
defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},
defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a=
{};return function(c){var b=a[c];if(b)return new b;b=a[c]=new Function;b.prototype=e["default"+c];return new b}}(),normalizeColor:function(c){return c instanceof a?c:new a(c)},normalizeParameters:function(a,c){var b;if(c){var e={};for(b in a)b in c&&!(b in e)&&(a[b]=c[b])}return a},makeParameters:function(a,c){var b=null;if(!c)return l.delegate(a);var e={};for(b in a)b in e||(e[b]=l.clone(b in c?c[b]:a[b]));return e},formatNumber:function(a,c){var b=a.toString();if(0<=b.indexOf("e"))b=a.toFixed(4);
else{var e=b.indexOf(".");0<=e&&5<b.length-e&&(b=a.toFixed(4))}return 0>a?b:c?" "+b:b},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var c=e.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){c.style=a[0];c.variant=a[1];c.weight=a[2];var b=a[3].indexOf("/");c.size=0>b?a[3]:a[3].substring(0,b);var g=4;0>b&&("/"==a[4]?g=6:"/"==a[4].charAt(0)&&(g=5));g<a.length&&(c.family=a.slice(g).join(" "))}return c},cm_in_pt:72/2.54,mm_in_pt:7.2/
2.54,px_in_pt:function(){return e._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(a){return a*e.px_in_pt()},px2pt:function(a){return a/e.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var c=e.px_in_pt(),b=parseFloat(a);switch(a.slice(-2)){case "px":return b;case "pt":return b*c;case "in":return 72*b*c;case "pc":return 12*b*c;case "mm":return b*e.mm_in_pt*c;case "cm":return b*e.cm_in_pt*c}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,
pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(a,c){return a&&c&&a===c},switchTo:function(a){var c="string"==typeof a?e[a]:a;c&&(f.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),function(a){e[a]=c[a]}),"string"==typeof a?e.renderer=a:f.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return e.renderer=e[a]&&e[a].Surface===e.Surface?a:null}))}});return e})},
"esri/symbols/MarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),function(h,l,a,d,b,f){h=h(f,{declaredClass:"esri.symbol.MarkerSymbol",angle:0,xoffset:0,yoffset:0,size:12,constructor:function(a){a&&l.isObject(a)&&(this.size="auto"===this.size?this.size:d.pt2px(this.size),this.xoffset=d.pt2px(this.xoffset),this.yoffset=d.pt2px(this.yoffset),this.angle&&(this.angle*=-1))},setAngle:function(a){return this.angle=a,this},setSize:function(a){return this.size=
a,this},setOffset:function(a,b){return this.xoffset=a,this.yoffset=b,this},toJson:function(){var a=d.px2pt(this.size),a=isNaN(a)?void 0:a,b=d.px2pt(this.xoffset),b=isNaN(b)?void 0:b,g=d.px2pt(this.yoffset);return g=isNaN(g)?void 0:g,l.mixin(this.inherited("toJson",arguments),{size:"auto"===this.size?this.size:a,angle:this.angle&&-1*this.angle,xoffset:b,yoffset:g})}});return a("extend-esri")&&l.setObject("symbol.MarkerSymbol",h,b),h})},"esri/symbols/Symbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../Color".split(" "),
function(h,l,a,d,b,f){h=h(null,{declaredClass:"esri.symbol.Symbol",color:new f([0,0,0,1]),type:null,constructor:function(a){a&&l.isObject(a)&&(l.mixin(this,a),this.color&&b.isDefined(this.color[0])&&(this.color=f.toDojoColor(this.color)),(a=this.type)&&0===a.indexOf("esri")&&(this.type={esriSMS:"simplemarkersymbol",esriPMS:"picturemarkersymbol",esriSLS:"simplelinesymbol",esriCLS:"cartographiclinesymbol",esriSFS:"simplefillsymbol",esriPFS:"picturefillsymbol",esriTS:"textsymbol",esriSHD:"shieldlabelsymbol"}[a]))},
setColor:function(a){return this.color=a,this},toJson:function(){return{color:f.toJsonColor(this.color)}}});return a("extend-esri")&&l.setObject("symbol.Symbol",h,d),h})},"esri/Color":function(){define(["dojo/_base/declare","dojo/_base/Color","dojo/has","./kernel"],function(h,l,a,d){h=h([l],{declaredClass:"esri.Color"});h.toJsonColor=function(a){return a&&[a.r,a.g,a.b,1<a.a?a.a:Math.round(255*a.a)]};h.toDojoColor=function(a){return a&&new l([a[0],a[1],a[2],a[3]/255])};var b,f="named blendColors fromRgb fromHex fromArray fromString".split(" ");
for(b=0;b<f.length;b++)h[f[b]]=l[f[b]];return a("extend-esri")&&(d.Color=h),h})},"esri/symbols/SimpleLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./LineSymbol".split(" "),function(h,l,a,d,b,f,k,m){var g={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",
STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot"},e={color:[0,0,0,1],style:g.STYLE_SOLID,width:1};h=h(m,{declaredClass:"esri.symbol.SimpleLineSymbol",type:"simplelinesymbol",_styles:{solid:"esriSLSSolid",dash:"esriSLSDash",dot:"esriSLSDot",dashdot:"esriSLSDashDot",longdashdotdot:"esriSLSDashDotDot",none:"esriSLSNull",insideframe:"esriSLSInsideFrame",shortdash:"esriSLSShortDash",shortdot:"esriSLSShortDot",shortdashdot:"esriSLSShortDashDot",shortdashdotdot:"esriSLSShortDashDotDot",
longdash:"esriSLSLongDash",longdashdot:"esriSLSLongDashDot"},constructor:function(c,d,f){c?l.isString(c)?(this.style=c,d&&(this.color=d),f&&(this.width=f)):this.style=k.valueOf(this._styles,c.style)||g.STYLE_SOLID:(l.mixin(this,e),this.color=new a(this.color),this.width=b.pt2px(this.width))},setStyle:function(a){return this.style=a,this},getStroke:function(){return this.style===g.STYLE_NULL||0===this.width?null:{color:this.color,style:this.style,width:this.width}},getFill:function(){return null},
getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){return k.fixJson(l.mixin(this.inherited("toJson",arguments),{type:"esriSLS",style:this._styles[this.style]}))}});return l.mixin(h,g),h.defaultProps=e,d("extend-esri")&&(l.setObject("symbol.SimpleLineSymbol",h,f),f.symbol.defaultSimpleLineSymbol=e),h})},"esri/symbols/LineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),
function(h,l,a,d,b,f){h=h(f,{declaredClass:"esri.symbol.LineSymbol",constructor:function(a){l.isObject(a)?this.width=d.pt2px(this.width):this.width=12},setWidth:function(a){return this.width=a,this},toJson:function(){var a=d.px2pt(this.width);return a=isNaN(a)?void 0:a,l.mixin(this.inherited("toJson",arguments),{width:a})}});return a("extend-esri")&&l.setObject("symbol.LineSymbol",h,b),h})},"esri/symbols/PictureMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol".split(" "),
function(h,l,a,d,b,f,k,m){var g={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};h=h(m,{declaredClass:"esri.symbol.PictureMarkerSymbol",type:"picturemarkersymbol",constructor:function(b,c,f){b?l.isString(b)?(this.url=b,c&&(this.width=c),f&&(this.height=f)):(this.width=d.pt2px(b.width),this.height=d.pt2px(b.height),c=b.imageData,9>a("ie")||!c||(f=this.url,this.url="data:"+(b.contentType||"image")+";base64,"+c,this.imageData=f)):(l.mixin(this,g),this.width=d.pt2px(this.width),this.height=d.pt2px(this.height))},
getStroke:function(){return null},getFill:function(){return null},setWidth:function(a){return this.width=a,this},setHeight:function(a){return this.height=a,this},setUrl:function(a){return a!==this.url&&(delete this.imageData,delete this.contentType),this.url=a,this},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var a=this.url,c=
this.imageData;if(0===a.indexOf("data:"))var b=a,a=c,c=b.indexOf(";base64,")+8,c=b.substr(c);!l.isString(a)||0!==a.indexOf("/")&&0!==a.indexOf("//")&&0!==a.indexOf("./")&&0!==a.indexOf("../")||(a=k.getAbsoluteUrl(a));var b=d.px2pt(this.width),b=isNaN(b)?void 0:b,g=d.px2pt(this.height),g=isNaN(g)?void 0:g,a=f.fixJson(l.mixin(this.inherited("toJson",arguments),{type:"esriPMS",url:a,imageData:c,contentType:this.contentType,width:b,height:g}));return delete a.color,delete a.size,a.imageData||delete a.imageData,
a}});return h.defaultProps=g,a("extend-esri")&&(l.setObject("symbol.PictureMarkerSymbol",h,b),b.symbol.defaultPictureMarkerSymbol=g),h})},"esri/urlUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/url dojo/io-query ./kernel ./lang ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),function(h,l,a,d,b,f,k,m,g){var e=function(){return this}(),c={},n=k.defaults.io,q=/^[a-z][a-z0-9\+\-\.]*:/i,r=/^\s*http:/i;return c.isHTTP=function(a){var c=e.location.protocol;return null==a?"http:"===
c||"https:"===c:a?"https:"===c:"http:"===c},c.getProtocolForWebResource=function(a){return c.isHTTP()?e.location.protocol:a?"https:":"http:"},c.urlToObject=function(c){var b={},e=new a(c),g=c.indexOf("?");return null===e.query?b={path:c,query:null}:(b.path=c.substring(0,g),b.query=d.queryToObject(e.query)),e.fragment&&(b.hash=e.fragment,null===e.query&&(b.path=b.path.substring(0,b.path.length-(e.fragment.length+1)))),b},c.getProxyUrl=function(a,b){var d,f,k,m,r=h.isString(a)?0===h.trim(a).toLowerCase().indexOf("https:"):
a,q=n.proxyUrl,l=g.io.proxyNotSet;if(h.isString(a)&&(m=c.getProxyRule(a),m&&(q=m.proxyUrl)),!q)throw Error(l);return r&&!1!==b&&0!==e.location.href.toLowerCase().indexOf("https:")&&(f=q,0!==f.toLowerCase().indexOf("http")&&(f=c.getAbsoluteUrl(f)),f=f.replace(/^http:/i,"https:"),c.canUseXhr(f)&&(q=f,k=1)),d=c.urlToObject(q),d._xo=k,d},c.addProxy=function(a){var b,e,g,f=c.getProxyRule(a);return f?b=c.urlToObject(f.proxyUrl):n.alwaysUseProxy&&(b=c.getProxyUrl()),b&&(e=c.urlToObject(a),a=b.path+"?"+e.path,
g=d.objectToQuery(h.mixin(b.query||{},e.query)),g&&(a+="?"+g)),a},c.addProxyRule=function(a){var b,e,g=a.urlPrefix=c.urlToObject(a.urlPrefix).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//gi,"").toLowerCase(),d=n.proxyRules,f=d.length,k=f;for(b=0;f>b;b++){if(e=d[b].urlPrefix,0===g.indexOf(e)){if(g.length===e)return-1;k=b;break}0===e.indexOf(g)&&(k=b+1)}return d.splice(k,0,a),k},c.getProxyRule=function(a){var b,e=n.proxyRules,g=e.length,d=c.urlToObject(a).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//gi,
"").toLowerCase();for(a=0;g>a;a++)if(0===d.indexOf(e[a].urlPrefix)){b=e[a];break}return b},c.hasSameOrigin=function(c,b,g){c=c.toLowerCase();b=b.toLowerCase();var d=e.location.href.toLowerCase();return c=0===c.indexOf("http")?new a(c):d=new a(d),b=0===b.indexOf("http")?new a(b):h.isString(d)?new a(d):d,(g||c.scheme===b.scheme)&&c.host===b.host&&c.port===b.port},c.canUseXhr=function(a,b){var e,g=m("esri-phonegap")?!0:!1,d=c.hasSameOrigin,f=n.corsEnabledServers,k=-1;return!g&&m("esri-cors")&&f&&f.length&&
(g=l.some(f,function(c,b){var g=c&&"object"==typeof c?c.host:c;return g&&(e=0!==h.trim(g).toLowerCase().indexOf("http"),d(a,e?"http://"+g:g)||e&&d(a,"https://"+g))?(k=b,!0):!1})),b?k:g},c.getAbsoluteUrl=function(a){var g=c.getProtocolForWebResource();return h.isString(a)&&!q.test(a)?0===a.indexOf("//")?g+a:0===a.indexOf("/")?g+"//"+e.location.host+a:b._appBaseUrl+a:a},c.fixUrl=function(a){return a=c.getAbsoluteUrl(a),a=c.upgradeToHTTPS(a),a.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")},c.normalize=
function(a){return c.fixUrl(a)},c.upgradeToHTTPS=function(a){var b=k.defaults.io.httpsDomains,g=c.isHTTP(!1),d=c.isHTTP(!0);if(!r.test(a)||g)return a;var g=a.indexOf("/",7),g=-1===g?a:a.slice(0,g),n=!1;if(d&&e.location&&f.endsWith(g,e.location.host))n=!0;else if(b)for(d=0;d<b.length;d++)if(f.endsWith(g,b[d])){n=!0;break}return n&&(a=a.replace(r,"https:")),a},m("extend-esri")&&(h.mixin(b,c),b._getProxyUrl=c.getProxyUrl,b._getProxiedUrl=c.addProxy,b._hasSameOrigin=c.hasSameOrigin,b._canDoXOXHR=c.canUseXhr,
b._getAbsoluteUrl=c.getAbsoluteUrl,b.fixUrl=c.fixUrl),c})},"esri/config":function(){define(["dojo/_base/config","dojo/topic","dojo/has","./kernel"],function(h,l,a,d){var b=function(){return this}(),f={defaults:{screenDPI:96,geometryService:null,kmlService:null,map:{width:400,height:400,layerNamePrefix:"layer",graphicsLayerNamePrefix:"graphicsLayer",slider:{left:"30px",top:"30px",width:null,height:"200px"},sliderLabel:{tick:5,labels:null,style:"width:2em; font-family:Verdana; font-size:75%;"},sliderChangeImmediate:!0,
zoomSymbol:{color:[0,0,0,64],outline:{color:[255,0,0,255],width:1.25,style:"esriSLSSolid"},style:"esriSFSSolid"},zoomDuration:500,zoomRate:25,panDuration:350,panRate:25,logoLink:"http://www.esri.com"},autoSpatialIndexing:b.Worker&&!1,io:{errorHandler:function(a,b){l.publish("esri.Error",[a])},proxyUrl:null,alwaysUseProxy:!1,useCors:"with-credentials",corsEnabledServers:"server.arcgisonline.com services.arcgisonline.com www.arcgis.com tiles.arcgis.com tiles1.arcgis.com tiles2.arcgis.com tiles3.arcgis.com tiles4.arcgis.com basemaps.arcgis.com elevation3d.arcgis.com services.arcgis.com services1.arcgis.com services2.arcgis.com services3.arcgis.com services4.arcgis.com services5.arcgis.com services6.arcgis.com services7.arcgis.com static.arcgis.com utility.arcgisonline.com geocode.arcgis.com geoenrich.arcgis.com qaext.arcgis.com tilesqa.arcgis.com servicesqa.arcgis.com servicesqa1.arcgis.com servicesqa2.arcgis.com servicesqa3.arcgis.com geocodeqa.arcgis.com geoenrichqa.arcgis.com dev.arcgis.com devext.arcgis.com staticdev.arcgis.com tilesdevext.arcgis.com elevation3ddev.arcgis.com servicesdev.arcgis.com servicesdev1.arcgis.com servicesdev2.arcgis.com servicesdev3.arcgis.com geocodedev.arcgis.com geoenrichdev.arcgis.com basemapsdev.arcgis.com".split(" "),
corsDetection:b.cordova?!1:!0,corsStatus:{},webTierAuthServers:[],proxyRules:[],postLength:2E3,timeout:6E4,useWorkers:"on-request",maxRequestWorkers:5,httpsDomains:"arcgis.com arcgisonline.com esrikr.com premiumservices.blackbridge.com esripremium.accuweather.com gbm.digitalglobe.com firstlook.digitalglobe.com msi.digitalglobe.com".split(" ")}}};return a("extend-esri")&&(d.config=f),h.noGlobals||(b.esriConfig=f),f})},"esri/nls/jsapi":function(){define({root:{io:{proxyNotSet:"esri.config.defaults.io.proxyUrl is not set. If making a request to a CORS enabled server, please push the domain into esri.config.defaults.io.corsEnabledServers."},
map:{deprecateReorderLayerString:"Map.reorderLayer(/*String*/ id, /*Number*/ index) deprecated. Use Map.reorderLayer(/*Layer*/ layer, /*Number*/ index).",deprecateShiftDblClickZoom:"Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported."},basemaps:{streets:"Streets",satellite:"Imagery",hybrid:"Imagery with Labels",terrain:"Terrain with Labels",topo:"Topographic",gray:"Light Gray Canvas","dark-gray":"Dark Gray Canvas",oceans:"Oceans","national-geographic":"National Geographic",
osm:"OpenStreetMap","streets-night-vector":"World Street Map (Night)","streets-relief-vector":"World Street Map (with Relief)","streets-navigation-vector":"World Navigation Map"},geometry:{deprecateToScreenPoint:"esri.geometry.toScreenPoint deprecated. Use esri.geometry.toScreenGeometry.",deprecateToMapPoint:"esri.geometry.toMapPoint deprecated. Use esri.geometry.toMapGeometry."},layers:{tiled:{tileError:"Unable to load tile"},dynamic:{imageError:"Unable to load image"},graphics:{drawingError:"Unable to draw graphic "},
agstiled:{deprecateRoundrobin:"Constructor option 'roundrobin' deprecated. Use option 'tileServers'."},imageParameters:{deprecateBBox:"Property 'bbox' deprecated. Use property 'extent'."},FeatureLayer:{noOIDField:"objectIdField is not set [url: ${url}]",fieldNotFound:"unable to find '${field}' field in the layer 'fields' information [url: ${url}]",noGeometryField:"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]",
invalidParams:"query contains one or more unsupported parameters",updateError:"an error occurred while updating the layer",createUserSeconds:"Created by ${userId} seconds ago",createUserMinute:"Created by ${userId} a minute ago",editUserSeconds:"Edited by ${userId} seconds ago",editUserMinute:"Edited by ${userId} a minute ago",createSeconds:"Created seconds ago",createMinute:"Created a minute ago",editSeconds:"Edited seconds ago",editMinute:"Edited a minute ago",createUserMinutes:"Created by ${userId} ${minutes} minutes ago",
createUserHour:"Created by ${userId} an hour ago",createUserHours:"Created by ${userId} ${hours} hours ago",createUserWeekDay:"Created by ${userId} on ${weekDay} at ${formattedTime}",createUserFull:"Created by ${userId} on ${formattedDate} at ${formattedTime}",editUserMinutes:"Edited by ${userId} ${minutes} minutes ago",editUserHour:"Edited by ${userId} an hour ago",editUserHours:"Edited by ${userId} ${hours} hours ago",editUserWeekDay:"Edited by ${userId} on ${weekDay} at ${formattedTime}",editUserFull:"Edited by ${userId} on ${formattedDate} at ${formattedTime}",
createUser:"Created by ${userId}",editUser:"Edited by ${userId}",createMinutes:"Created ${minutes} minutes ago",createHour:"Created an hour ago",createHours:"Created ${hours} hours ago",createWeekDay:"Created on ${weekDay} at ${formattedTime}",createFull:"Created on ${formattedDate} at ${formattedTime}",editMinutes:"Edited ${minutes} minutes ago",editHour:"Edited an hour ago",editHours:"Edited ${hours} hours ago",editWeekDay:"Edited on ${weekDay} at ${formattedTime}",editFull:"Edited on ${formattedDate} at ${formattedTime}"}},
tasks:{gp:{gpDataTypeNotHandled:"GP Data type not handled."},na:{route:{routeNameNotSpecified:"'RouteName' not specified for at least 1 stop in stops FeatureSet."}},query:{invalid:"Unable to perform query. Please check your parameters."}},toolbars:{draw:{convertAntiClockwisePolygon:"Polygons drawn in anti-clockwise direction will be reversed to be clockwise.",addPoint:"Click to add a point",addShape:"Click to add a shape, or press down to start and let go to finish",addMultipoint:"Click to start adding points",
freehand:"Press down to start and let go to finish",start:"Click to start drawing",resume:"Click to continue drawing",complete:"Double-click to complete",finish:"Double-click to finish",invalidType:"Unsupported geometry type"},edit:{invalidType:"Unable to activate the tool. Check if the tool is valid for the given geometry type.",deleteLabel:"Delete"}},virtualearth:{vetiledlayer:{bingMapsKeyNotSpecified:"BingMapsKey must be provided."},vegeocode:{bingMapsKeyNotSpecified:"BingMapsKey must be provided.",
requestQueued:"Server token not retrieved. Queing request to be executed after server token retrieved."}},widgets:{appProxySettings:{premiumContent:"Subscriber Content",untitled:"Untitled (${url})"},attributeInspector:{NLS_first:"First",NLS_previous:"Previous",NLS_next:"Next",NLS_last:"Last",NLS_deleteFeature:"Delete",NLS_title:"Edit Attributes",NLS_errorInvalid:"Invalid",NLS_validationInt:"Value must be an integer.",NLS_validationFlt:"Value must be a float.",NLS_of:"of",NLS_noFeaturesSelected:"No features selected"},
basemapToggle:{toggle:"Toggle basemap"},homeButton:{home:{button:"Home",title:"Default extent"}},layerSwipe:{title:"Drag to see underlying layer"},locateButton:{locate:{button:"My Location",title:"Find my location",tracking:"Track location",stopTracking:"Stop tracking location"}},overviewMap:{NLS_drag:"Drag To Change The Map Extent",NLS_show:"Show Map Overview",NLS_hide:"Hide Map Overview",NLS_maximize:"Maximize",NLS_restore:"Restore",NLS_noMap:"'map' not found in input parameters",NLS_noLayer:"main map does not have a base layer",
NLS_invalidSR:"spatial reference of the given layer is not compatible with the main map",NLS_invalidType:"unsupported layer type. Valid types are 'TiledMapServiceLayer' and 'DynamicMapServiceLayer'"},timeSlider:{NLS_first:"First",NLS_previous:"Previous",NLS_next:"Next",NLS_play:"Play/Pause",NLS_invalidTimeExtent:"TimeExtent not specified, or in incorrect format."},mdSlider:{NLS_play:"Play/Pause",NLS_previous:"Previous",NLS_next:"Next"},attachmentEditor:{NLS_attachments:"Attachments:",NLS_add:"Add",
NLS_none:"None",NLS_error:"There was an error.",NLS_fileNotSupported:"This file type is not supported."},directions:{error:{notEnoughStops:"Enter an origin and a destination.",notReady:"Directions Widget is not done loading, or there was an error during initialization.",unknownStop:"Location '\x3cname\x3e' could not be found.",routeTask:"Unable to route to these addresses.",locator:"Location could not be found.",invalidStopType:"Invalid stop type",locatorUndefined:"Unable to reverse geocode. Locator URL is undefined.",
noAddresses:"No addresses were returned.",noStops:"No stops were given to be added.",maximumStops:"The maximum number of stops has been reached.",cantFindRouteServiceDescription:"Route service description was not reached or recognized. Please check service URL and/or user credentials, if specified.",maxWalkingDistance:"The distance between any inputs must be less than 50 miles (80 kilometers) when walking.",nonNAmTruckingMode:"Calculating trucking routes outside of North and Central America is not currently supported.",
cantRemoveStop:"Failed to remove stop.",waypointShouldBeInBetweenStops:"A waypoint can only be inserted in between existing stops or other waypoints.",couldNotUpdateStop:"Could not update stop.",cantSaveRoute:"An error happened while saving the route.",accessDenied:"You do not have access to this route layer. You are currently signed in as: ",loadError:"Error loading route layer."},time:{min:"min",hr:"hr"},units:{esriKilometers:{name:"kilometers",abbr:"km"},esriMeters:{name:"meters",abbr:"m"},esriMiles:{name:"miles",
abbr:"mi"},esriNauticalMiles:{name:"nautical miles",abbr:"nm"}},travelMode:{car:"By Car",truck:"By Truck",walking:"Walking"},impedance:{fastest:"Fastest",shortest:"Shortest"},unlocatedStop:"\x3cunknown location\x3e",leaveNow:"Leave Now",departAt:"Depart At",GMT:"GMT",showOptions:"Options",hideOptions:"Close",findOptimalOrder:"Optimize order",useTraffic:"Show traffic",trafficLabelLive:"As of now",trafficLabelDepartAt:"As of departure",seeTrafficAvailability:"See availability",onAverage:"typically",
noTraffic:"No Traffic info",heavyTraffic:"Heavy Traffic",ligthTraffic:"Light Traffic",returnToStart:"Return to start",addDestination:"Add",viewFullRoute:"Zoom to full route",getDirections:"Get Directions",clearDirections:"Clear",reverseDirections:"Reverse directions",activate:"Add stops by clicking on the map or modify route with waypoints",print:"Print",printNotes:"Enter notes here",printDisclaimer:"Directions are provided for planning purposes only and are subject to \x3ca href\x3d'http://www.esri.com/legal/software-license' target\x3d'_blank'\x3eEsri's terms of use\x3c/a\x3e. Dynamic road conditions can exist that cause accuracy to differ from your directions and must be taken into account along with signs and legal restrictions. You assume all risk of use.",
retrievingMyLocation:"Retrieving location...",myLocationError:"Cannot retrieve location",setToMyLocation:"Use my current location",setToMyLocationTitle:"Depart from my current location",stopNoTitle:"Stop #",maneuver:"Route Maneuver",stop:"Location",waypoint:"Waypoint",dragRoute:"Drag to change route",dragStop:"Drag to change location or click to see details",dragWaypoint:"Drag to change location or click to remove",toNearbyStops:"to nearby stop(s)",saveTitle:"Save and share route",layerName:"Result layer name",
save:"Save",saveAs:"Save as new",routeIsSaved:"Route was successfully saved.",share:"Share the route",serviceTime:"Service time",serviceDistance:"Service distance",routeLayerEmpty:"Loaded layer is empty.",routeLayerStopsOnly:"Loaded layer has stops only. Click GET DIRECTIONS to build route."},editor:{tools:{NLS_attributesLbl:"Attributes",NLS_cutLbl:"Cut",NLS_deleteLbl:"Delete",NLS_extentLbl:"Extent",NLS_freehandPolygonLbl:"Freehand Polygon",NLS_freehandPolylineLbl:"Freehand Polyline",NLS_pointLbl:"Point",
NLS_polygonLbl:"Polygon",NLS_polylineLbl:"Polyline",NLS_reshapeLbl:"Reshape",NLS_selectionNewLbl:"New selection",NLS_selectionAddLbl:"Add to selection",NLS_selectionClearLbl:"Clear selection",NLS_selectionRemoveLbl:"Subtract from selection",NLS_selectionUnionLbl:"Union",NLS_autoCompleteLbl:"Auto Complete",NLS_unionLbl:"Union",NLS_rectangleLbl:"Rectangle",NLS_circleLbl:"Circle",NLS_ellipseLbl:"Ellipse",NLS_triangleLbl:"Triangle",NLS_arrowLbl:"Arrow",NLS_arrowLeftLbl:"Left Arrow",NLS_arrowUpLbl:"Up Arrow",
NLS_arrowDownLbl:"Down Arrow",NLS_arrowRightLbl:"Right Arrow",NLS_undoLbl:"Undo",NLS_redoLbl:"Redo"}},Search:{main:{searchButtonTitle:"Search",clearButtonTitle:"Clear search",placeholder:"Find address or place",searchIn:"Search in",lonlat:"Longitude, Latitude",reverseLonLatHeader:"Did you mean?",all:"All",allPlaceholder:"Find address or place",emptyValue:"Please enter a search term.",untitledResult:"Untitled",untitledSource:"Untitled source",noResults:"No results",noResultsFound:"There were no results found for ${value}.",
showMoreResults:"Show more results",hideMoreResults:"Hide",searchResult:"Search result",moreResultsHeader:"More results",esriLocatorName:"Esri World Geocoder"}},Geocoder:{main:{clearButtonTitle:"Clear Search",searchButtonTitle:"Search",geocoderMenuButtonTitle:"Change Geocoder",geocoderMenuHeader:"Search in",geocoderMenuCloseTitle:"Close Menu",untitledGeocoder:"Untitled geocoder"},esriGeocoderName:"Esri World Geocoder"},geocodeMatch:{match:{mapAllCandidatesLabel:"Map All Suggestions",defaultSortOrderLabel:"Default Sort Order",
tableOptionsLabel:"Options",columnLabelAddress:"Address",columnLabelType:"Type",columnLabelScore:"Score",noDataMsg:"No Results.",userCreatedLabel:"User Created",defaultMatchType:"DefaultMatch"},popup:{noAddress:"No Address Found.",matchButtonLabel:"Match",discardButtonLabel:"Discard",checkBoxLocation:"Location (X, Y)",checkBoxAddress:"Suggested Address",addressTitle:"Suggested Address",optionsTitle:"Match Options:",loadingPH:"Searching...",locationTitle:"Location",xTitle:"X: ",yTitle:"Y: "},customLabel:"Custom",
idProperty:"id",gridTitle:"Suggestions",matchedLC:"matched",matchedUC:"Matched",unmatchedLC:"unmatched",unmatchedUC:"Unmatched"},geocodeReview:{review:{noDataMsg1:"No Unmatched Features",noDataMsg2:"No Matched Features",noDataMsg3:"No Reviewed Features",columnOriginalLocation:"Original Location",columnSelectedLocation:"Selected Location",columnOriginalAddress:"Original Address",columnSelectedAddress:"Selected Address"},customLabel:"Custom",unmatchedLC:"unmatched",matchedLC:"matched",unmatchedUC:"Unmatched",
matchedUC:"Matched",totalUC:"Total",remainingUC:"Remaining",idProperty:"id",reviewedUC:"Reviewed",columnLabelAddress:"Address",of:"of",unmatchedTotal:"Unmatched (${count} Total)",unmatchedRemaining:"Unmatched (${count1} of ${count2} Remaining)",matchedTotal:"Matched (${count} Total)",reviewedTotal:"Reviewed (${count} Total)"},FeatureTable:{options:"Options",sortAsc:"Sort Ascending",sortDesc:"Sort Descending",defaultSort:"Default Sort Order",showSelected:"Show Selected Records",clearSelection:"Clear Selection",
toggleColumns:"Show/Hide Columns",statistics:"Statistics",close:"Close",untitled:"Untitled",loadingData:"Loading Feature Data...",noData:"No Data Found",dataError:"Data Error",gridHeader:"${gridTitle} (${featureCount} features, ${featureSelectedCount} selected)",add:"Add",show:"Show",hide:"Hide",relatedRecords:"Related Records",photosAndFiles:"Photos and Files",attachments:"Attachments",owners:"Owners",parenValue:"(${value})",date:"Date",number:"Number",string:"String",centerOnSelection:"Center on Selection",
numberOfValues:"Number of Values",sumOfValues:"Sum of Values",minimum:"Minimum",maximum:"Maximum",average:"Average",standardDeviation:"Standard Deviation",fieldLabel:"Field: ${fieldName}",view:"View",upload:"Upload",uploading:"Uploading...",uploadFail:"Upload Failed.",uploadSuccess:"Upload Successful!",deleting:"Deleting...",deleteSuccess:"Delete Successful.",deleteFail:"Delete Failed.",empty:"- empty -",showDetailedView:"Show Detailed View",B:"${fileSize} B",kB:"${fileSize} kB",MB:"${fileSize} MB",
GB:"${fileSize} GB",TB:"${fileSize} TB",errorApplyFilter:"Unable to apply filter.",errorGetStats:"Could not get statistics.",errorSelectFeatures:"Could not select features.",errorLoadRow:"Could not load the row. Selection failed.",errorValidExtent:"Could not generate valid extent.",errorRollback:"Could not rollback value.",errorUpdateFailed:"Update failed.",errorDomainType:"Domain type is not supported.",errorFeatureInfo:"Could not get feature information.",errorGenerateStore:"Could not generate store.",
errorAccessingData:"Accessing data failed",showAllRecords:"Show All Records",selected:"${num} selected",saveSelectionAsFilter:"Save Selection as Filter",allColums:"All Columns",selectVisibleRasters:"Select Visible Images",zeroRasters:"0 images",oneRaster:"1 image",moreRasters:"${num} images",lockRaster:"Display Selected Images",unlockRaster:"Display All Images",tableOptions:"Table Options",hideTable:"Hide Table",accessingData:"Please wait... Accessing data.",layerNotResponding:"Unable to display table. The layer is not responding."},
FeatureAttachments:{add:"Add",view:"View",upload:"Upload",close:"Close",uploading:"Uploading...",uploadFail:"Upload Failed.",uploadSuccess:"Upload Successful!",deleting:"Deleting...",deleteSuccess:"Delete Successful.",deleteFail:"Delete Failed.",error:"Error.",B:"${fileSize} B",kB:"${fileSize} kB",MB:"${fileSize} MB",GB:"${fileSize} GB",TB:"${fileSize} TB",fileNotSupported:"File type is not supported."},HistogramTimeSlider:{count:"Count: ${count}",dateRange:"Date Range: ${start} - ${end}"},layerList:{legend:"Legend",
sublayers:"Sublayers",opacity:"Opacity",expand:"Expand",collapse:"Collapse",noSublayers:"No sublayers to display",noLayers:"No layers to display."},legend:{NLS_points:"Points",NLS_lines:"Lines",NLS_areas:"Areas",NLS_creatingLegend:"Creating legend",NLS_noLegend:"No legend",NLS_dotValue:"1 Dot \x3d ${value} ${unit}",NLS_currentObservations:"Current observations",NLS_previousObservations:"Previous observations",high:"High",low:"Low",NLS_esriMetersPerSecond:"m/s",NLS_esriKilometersPerHour:"km/h",NLS_esriKnots:"knots",
NLS_esriFeetPerSecond:"ft/sec",NLS_esriMilesPerHour:"mph",showField:"${field}",showNormField:"${field} divided by ${normField}",showNormPct:"${field} as a percent of the total",showRatio:"Ratio of ${field} to ${normField}",showRatioPercent:"${field} as a percent of ${normField}",showRatioPercentTotal:"${field} as a percent of ${field} and ${normField}"},popup:{NLS_moreInfo:"More info",NLS_searching:"Searching",NLS_prevFeature:"Previous feature",NLS_nextFeature:"Next feature",NLS_close:"Close",NLS_prevMedia:"Previous media",
NLS_nextMedia:"Next media",NLS_noInfo:"No information available",NLS_noAttach:"No attachments found",NLS_maximize:"Maximize",NLS_restore:"Restore",NLS_zoomTo:"Zoom to",NLS_pagingInfo:"(${index} of ${total})",NLS_attach:"Attachments"},measurement:{NLS_distance:"Distance",NLS_area:"Area",NLS_location:"Location",NLS_resultLabel:"Measurement Result",NLS_length_miles:"Miles",NLS_length_kilometers:"Kilometers",NLS_length_feet:"Feet",NLS_length_meters:"Meters",NLS_length_yards:"Yards",NLS_length_nautical_miles:"Nautical Miles",
NLS_area_acres:"Acres",NLS_area_sq_miles:"Sq Miles",NLS_area_sq_kilometers:"Sq Kilometers",NLS_area_hectares:"Hectares",NLS_area_sq_yards:"Sq Yards",NLS_area_sq_feet:"Sq Feet",NLS_area_sq_meters:"Sq Meters",NLS_area_sq_nautical_miles:"Sq Nautical Miles",NLS_deg_min_sec:"DMS",NLS_decimal_degrees:"Degrees",NLS_map_coordinate:"Map Coordinate",NLS_longitude:"Longitude",NLS_latitude:"Latitude",NLS_MGRS:"MGRS",NLS_USNG:"USNG",NLS_UTM:"UTM",NLS_GeoRef:"GeoRef",NLS_GARS:"GARS",NLS_geometry_service_error:"Geometry Service Error",
NLS_calculating:"Calculating...",NLS_length_miles_us:"Miles (US)",NLS_area_sq_miles_us:"Sq Miles (US)",NLS_length_feet_us:"Feet (US)",NLS_area_sq_feet_us:"Sq Feet (US)",NLS_length_yards_us:"Yards (US)",NLS_area_sq_yards_us:"Sq Yards (US)",NLS_area_acres_us:"Acres (US)"},bookmarks:{NLS_add_bookmark:"Add Bookmark",NLS_new_bookmark:"Untitled",NLS_bookmark_edit:"Edit",NLS_bookmark_remove:"Remove"},print:{NLS_print:"Print",NLS_printing:"Printing",NLS_printout:"Printout"},textSymbolEditor:{symbolConfiguration:"Symbol Configuration",
alignment:"Alignment",color:"Color",halo:"Halo"},scalebar:{km:"km",mi:"mi",ft:"ft",m:"m"},templatePicker:{creationDisabled:"Feature creation is disabled for all layers.",loading:"Loading.."},renderingRule:{rendererLabelTitle:"Renderer",bandCombinationLabelTitle:"RGB composite",userDefinedRendererTitle:"User Defined Renderer",userDefinedRendererDesc:"A user defined renderer. Use different bands for inputs to the Red, Green, and Blue channels (multi-band services only). Apply different radiometric enhancement algorithms to make image look better.",
imageEnhancementLabelTitle:"Image Enhancement",stretchDescLabel:"Apply contrast enhancements to improve the image display.",stretchMethodLabel:"Stretch Type:",stretchMethodNoneDesc:"No additional enhancements applied.",stretchMethodMinMaxDesc:"Stretch to the entire range of pixel values.",numStdDevLabelTitle:"Trim extreme pixel values beyond",numStdDevEndLabelTitle:"standard deviations.",draLabelTitle:"Dynamic range adjustment",minMaxDescLabelTitle:"Trim extreme pixel values",minPercentLabelTitle:"Exclude bottom:",
maxPercentLabelTitle:"Exclude top:",percentLabelTitle:"%",gammaLabelTitle:"Gamma:",bandNamesRequestMsg:"Requesting band information...",noneStretchAlias:"None",minMaxStretchAlias:"Minimum and Maximum",stdDevStretchAlias:"Standard Deviation",percentClipStretchAlias:"Percent Clip",minGammaLabel:"0.1",maxGammaLabel:"10",colorRampTitle:"Color Ramp"},colorRampSelector:{colorRamps:{none:"None",blackToWhite_predefined:"Black to White",yellowToRed_predefined:"Yellow to Red",slope_predefined:"Slope",aspect_predefined:"Aspect",
errors_predefined:"Errors",heatmap1_predefined:"Heatmap #1",elevation1_predefined:"Elevation #1",elevation2_predefined:"Elevation #2",blueBright_predefined:"Blue Bright",blueLightToDark_predefined:"Blue Light to Dark",blueGreenBright_predefined:"Blue-Green Bright",blueGreenLightToDark_predefined:"Blue-Green Light to Dark",brownLightToDark_predefined:"Brown Light to Dark",brownToBlueGreenDivergingBright_predefined:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark_predefined:"Brown to Blue Green Diverging, Dark",
coefficientBias_predefined:"Coefficient Bias",coldToHotDiverging_predefined:"Cold to Hot Diverging",conditionNumber_predefined:"Condition Number",cyanToPurple_predefined:"Cyan to Purple",cyanLightToBlueDark_predefined:"Cyan-Light to Blue-Dark",distance_predefined:"Distance",grayLightToDark_predefined:"Gray Light to Dark",greenBright_predefined:"Green Bright",greenLightToDark_predefined:"Green Light to Dark",greenToBlue_predefined:"Green to Blue",orangeBright_predefined:"Orange Bright",orangeLightToDark_predefined:"Orange Light to Dark",
partialSpectrum_predefined:"Partial Spectrum",partialSpectrum1Diverging_predefined:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging_predefined:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright_predefined:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark_predefined:"Pink to YellowGreen Diverging, Dark",precipitation_predefined:"Precipitation",prediction_predefined:"Prediction",purpleBright_predefined:"Purple Bright",purpleToGreenDivergingBright_predefined:"Purple to Green Diverging, Bright",
purpleToGreenDivergingDark_predefined:"Purple to Green Diverging, Dark",purpleBlueBright_predefined:"Purple-Blue Bright",purpleBlueLightToDark_predefined:"Purple-Blue Light to Dark",purpleRedBright_predefined:"Purple-Red Bright",purpleRedLightToDark_predefined:"Purple-Red Light to Dark",redBright_predefined:"Red Bright",redLightToDark_predefined:"Red Light to Dark",redToBlueDivergingBright_predefined:"Red to Blue Diverging, Bright",redToBlueDivergingDark_predefined:"Red to Blue Diverging, Dark",redToGreen_predefined:"Red to Green",
redToGreenDivergingBright_predefined:"Red to Green Diverging, Bright",redToGreenDivergingDark_predefined:"Red to Green Diverging, Dark",spectrumFullBright_predefined:"Spectrum-Full Bright",spectrumFullDark_predefined:"Spectrum-Full Dark",spectrumFullLight_predefined:"Spectrum-Full Light",surface_predefined:"Surface",temperature_predefined:"Temperature",whiteToBlack_predefined:"White to Black",yellowToDarkRed_predefined:"Yellow to Dark Red",yellowToGreenToDarkBlue_predefined:"Yellow to Green to Dark Blue",
yellowGreenBright_predefined:"Yellow-Green Bright",yellowGreenLightToDark_predefined:"Yellow-Green Light to Dark"}},vectorFieldRenderer:{symbolTypeLabelTitle:"Symbol:",simpleScalarLabelTitle:"Simple Scalar",simpleScalarDesc:"Symbolizes the magnitude of the data using graduated symbol sizes.",singleArrowLabelTitle:"Single Arrow",singleArrowDesc:"Symbolizes the magnitude and direction of flow with an arrow. The size of the arrow represents flow magnitude and the direction of the arrow indicates direction of flow.",
windBarbsLabelTitle:"Wind Barbs",windBarbsDesc:"Symbolizes the magnitude and direction of wind using wind barbs. A long barb represents 10 knots, a short barb indicates 5 knots, and a black pennant represents 50 knots. The barb points to the direction where the wind originates.",beaufortLabelTitle:"Beaufort Wind Scale",beaufortDesc:"Symbolizes the magnitude and direction of wind using the Beaufort Wind Scale. The magnitude is categorized into levels 0 through 12, where 0 represents a calm wind (displayed in blue), and 12 represents a hurricane (red). The arrow points to the direction where the wind originates.",
oceanCurrentKnotsLabelTitle:"Ocean Current (Nine classes)",oceanCurrentKnotsDesc:"Symbolizes the magnitude and direction of ocean current using nine predefined categories that range from 0 to 4 knots. The arrows point to the current direction of flow.",oceanCurrentMpsLabelTitle:"Ocean Current (Four classes)",oceanCurrentMpsDesc:"Symbolizes the magnitude and direction of ocean current using four predefined categories that range from 0 to 2 m/s. The arrows point to the current direction of flow.",classifiedArrowLabelTitle:"Classified Arrow",
classifiedArrowDesc:"Symbolizes the magnitude and direction of flow, using categories calculated based on magnitude limits. Magnitude is represented using graduated symbol sizes and colors, ranging from green (low) to red (high).",dataTypeLabelTile:"Direction represents flow:",angleFromAlias:"From (Meteorological)",angleToAlias:"To (Oceanographic)",unitLabelTitle:"Convert magnitude ",outputUnitLabelTitle:"To: ",inputUnitLabelTitle:"From: ",symbolDensityLabelTitle:"Symbol density: ",sparseTileSizeAlias:"Sparse",
denseTileSizeAlias:"Dense",symbolSizeLabelTitle:"Symbol scaling:",minSymbolSizeAlias:"Minimum",maxSymbolSizeAlias:"Maximum",advancedOptionsTitle:"Advanced Settings",magnitudeLabelTitle:"Magnitude",minAlias:"Minimum:",maxAlias:"Maximum:",invalidNumberMessage:"Please enter a numeric value.",dataValueRangeLabelTitle:"Symbol sizes represent magnitude range. Define magnitude range",applyLabelTitle:"Apply",esriMetersPerSecond:"m/s",esriKilometersPerHour:"km/h",esriKnots:"knots",esriFeetPerSecond:"ft/sec",
esriMilesPerHour:"mph"},mosaicRule:{mosaicMethodLabel:"Prioritize imagery based on:",orderFieldLabel:"Attribute:",orderValueLabel:"Highest priority value:",lockRasterIdLabel:"Image IDs:",mosaicOperatorLabel:"Resolve overlapping pixels by:",descendingLabel:"Reverse the order",queryLabel:"Filter your images:",queryFieldLabel:"Field:",queryOperatorLabel:"Operator:",queryValueLabel:"Value:",selectAllLabel:"Select All",mosaicruleNotApplicable:"The image layer contains only one image and does not support changing image display order.",
lockRasterRequestMsg:"Searching...",lockRasterRequestDoneMsg:"Done...",lockRasterRequestErrorMsg:"Error searching...",lockRasterRequestNoRasterMsg:"No rasters found...",refreshLockRasterIdsLabel:"Refresh",orderFieldNotFound:"Not Available",byAttributeAlias:"An attribute",centerAlias:"Image center closest to view center",lockRasterAlias:"A list of images",nadirAlias:"Sensor location closest to view center",northWestAlias:"Fixed order with most North West on top",seamlineAlias:"Defined Seamlines",viewPointAlias:"View point",
noneAlias:"Only scale",firstAlias:"Only highest priority",lastAlias:"Only Lowest priority",minAlias:"Minimum of pixel values",maxAlias:"Maximum of pixel values",averageAlias:"Average of pixel values",blendAlias:"Blend pixel values",sumAlias:"Sum of pixel values"},multidimensionalFilter:{variableFilter:"Variable",filterByDimensionalValues:"Dimensions",fromTimeText:"Start Time:",toTimeText:"End Time:",fromNumericText:"From:",toNumericText:"To:",sliceTimeText:"Time:",sliceNumberText:"Value:",rangeText:"Define a range",
hasRangesInfoText1:"Data points are in the form of ranges.",hasRangesInfoText2:"Please select predefined range values.",defaultVariableText:"Default",dateSnapText:"Snapped to closest date",numSnapText:"Snapped to closest value",disabledNumericDimensionText:"*Disabled because dimension slider is active.",disabledTimeDimensionText:"*Disabled because time slider is active.",applyLabelTitle:"Apply",startNumberButtonTooltip:"First",nextButtonTooltip:"Next",previousButtonTooltip:"Previous",endNumberButtonTooltip:"Last",
startDateButtonTooltip:"Earliest",endDateButtonTooltip:"Latest",tooltipNumberFromValueText:"Minimum:",tooltipNumberToValueText:"Maximum:",tooltipCountText:"Count:",tooltipDateFromValueText:"Earliest:",tooltipDateToValueText:"Latest:"},imageServiceMeasure:{measureBtnText:"Measure",angularUnits:"Angular Units",linearUnits:"Linear Units",areaUnits:"Area Units",infoWindowTitle:"Measure Result",measure3DLabel:"Measure in 3D",settings:"Settings",mensurationCapabilitiesAbsentText:"Mensuration capabilities not supported by the layer.",
measurementErrorGeneric:"Unable to perform measurement. Invalid or missing input parameters.",operationLabel:{OPERATION_POINT:"Location",OPERATION_DISTANCE_ANGLE:"Distance and Angle",OPERATION_AREA_PERIMETER:"Area and Perimeter",OPERATION_BASE_TOP:"Height: Base to Top",OPERATION_BASE_TOP_SHADOW:"Height: Base to Top-Shadow",OPERATION_TOP_TOP_SHADOW:"Height: Top to Top-Shadow",OPERATION_CENTROID:"Centroid",OPERATION_POINT_3D:"Location (3D)",OPERATION_DISTANCE_ANGLE_3D:"Distance and Angle (3D)",OPERATION_AREA_PERIMETER_3D:"Area and Perimeter (3D)",
OPERATION_CENTROID_3D:"Centroid (3D)"},unitLabel:{INCHES:"Inches",FEET:"Feet",YARDS:"Yards",MILES:"Miles",NAUTICAL_MILES:"Nautical Miles",MILLIMETERS:"Millimeters",CENTIMETERS:"Centimeters",DECIMETERS:"Decimeters",METERS:"Meters",KILOMETERS:"Kilometers",RADIANS:"Radians",DECIMAL_DEGREES:"Degrees",SQUARE_INCHES:"Sq Inches",SQUARE_FEET:"Sq Feet",SQUARE_YARDS:"Sq Yards",ACRES:"Acres",SQUARE_MILES:"Sq Miles",SQUARE_MILLIMETERS:"Sq Millimeters",SQUARE_CENTIMETERS:"Sq Centimeters",SQUARE_DECIMETERS:"Sq Decimeters",
SQUARE_METERS:"Sq Meters",ARES:"Ares",HECTARES:"Hectares",SQUARE_KILOMETERS:"Sq Kilometers"},measureDialog:{Point:"Location",Centroid:"Centroid",X:"X",Y:"Y",Distance:"Distance",AzimuthAngle:"Azimuth Angle",ElevationAngle:"Elevation Angle",Area:"Area",Perimeter:"Perimeter",Height:"Height"}},obliqueViewer:{northTooltip:"Viewing angle towards north",southTooltip:"Viewing angle towards south",eastTooltip:"Viewing angle towards east",westTooltip:"Viewing angle towards west",nadirTooltip:"Center as viewed from above"},
tags:{addTags:"Add tag(s)",noTagsFound:"No existing tags match.",required:"One ore more tags are required."},rendererSlider:{statsAvg:"Average : ${avg}",count:"Count : ${count}",percent:"${num}%",high:"High",low:"Low",color:{changeMinMaxToolTIp:"Type in a value.",handleToolTip:"Match data values to colors.",maxValueToolTip:"Type in the largest expected data value.",minValueToolTip:"Type in the smallest expected data value.",changeSymbol:"Change symbol"},size:{handleToolTip:"Match data values to symbol size.",
sizeInputBoxLines:"Set line thickness from 0 to 18 pixels.",sizeInputBoxPoints:"Set symbol size from 1 to 120 pixels"}},histogram:{statsAvg:"Average : ${avg}",statsSD:"Standard Deviation : ${sd}",count:"Count : ${count}",percent:"${num}%"},zoomSlider:{zoomIn:"Zoom In",zoomOut:"Zoom Out"},colorPicker:{transparency:"Transparency",suggested:"Suggested",recent:"Recent",more:"More",moreColorsTooltip:"See more colors.",paletteTooltip:"Select a color.",noColorTooltip:"No color",hexInputTooltip:"A custom color in hexadecimal notation (#FFFF00)."},
visibleScaleRangeSlider:{noLimit:"No Limit",preview:"Preview",currentScaleTooltip:"Current map scale (${scaleLabel})",customScaleInputTooltip:"Type in a scale.",current:"Current",setTo:"Set to",selectOne:"(select one)",setToSelectOne:"${setTo} ${selectOne}",useSameAs:"Use same as",layerNameAndType:"${name} (${type})",layer:"Layer",basemap:"Basemap",scaleRangeLabels:{world:"World",continent:"Continent",countries:"Countries",country:"Country",states:"States",state:"State",counties:"Counties",county:"County",
metropolitanArea:"Metropolitan Area",cities:"Cities",city:"City",town:"Town",neighborhood:"Neighborhood",streets:"Streets",street:"Street",buildings:"Buildings",building:"Building",smallBuilding:"Small Building",rooms:"Rooms",room:"Room"},featuredScaleLabels:{current:"Current Map View (${scaleLabel})",world:"World (${scaleLabel})",continent:"Continent (${scaleLabel})",countriesBig:"Countries - Big (${scaleLabel})",countriesSmall:"Countries - Small (${scaleLabel})",statesProvinces:"States / Provinces (${scaleLabel})",
stateProvince:"State/Province (${scaleLabel})",counties:"Counties (${scaleLabel})",county:"County (${scaleLabel})",metropolitanArea:"Metropolitan Area (${scaleLabel})",cities:"Cities (${scaleLabel})",city:"City (${scaleLabel})",town:"Town (${scaleLabel})",neighborhood:"Neighborhood (${scaleLabel})",streets:"Streets (${scaleLabel})",street:"Street (${scaleLabel})",buildings:"Buildings (${scaleLabel})",building:"Building (${scaleLabel})",smallBuilding:"Small Building (${scaleLabel})",rooms:"Rooms (${scaleLabel})",
room:"Room (${scaleLabel})"}},symbolEditor:{customImages:"Custom Images",preview:"Preview",shape:"Shape",fill:"Fill",outline:"Outline",px:"px",symbolSize:"Symbol Size",symbolSizeTooltip:"Set symbol size from ${min} to ${max} pixels.",useImage:"Use an Image",useImageTooltip:"Use a custom image.",imageUrlInputTooltip:"For best results, use a square image (PNG, GIF, or JPEG) no greater than 120 x 120 pixels. Other sizes will be adjusted to fit.",imageUrlInputPlaceholder:"https://\x3cimage URL\x3e",selectCategoryTooltip:"Select a category.",
imageLoadError:"Unable to load image.",symbolLoadError:"Unable to load symbols.",noFillTooltip:"No fill",symbolTransparencyTooltip:"Symbol transparency",lineWidth:"Line Width",lineWidthTooltip:"Set a line width from ${min} to ${max} pixels.",pattern:"Pattern",patternTooltip:"Line type",flipColors:"Flip Colors",flipColorsTooltip:"Invert color ramp.",noOutlineTooltip:"No outline",autoAdjustOutline:"Adjust outline automatically",saturation:"Saturation",saturationTooltip:"Adjust color intensity.",selectRampTooltip:"Select a color ramp."}},
arcgis:{utils:{baseLayerError:"Unable to load the base map layer",geometryServiceError:"Provide a geometry service to open Web Map.",showing:"Showing ${fieldAlias}"}},identity:{lblItem:"item",title:"Sign In",info:"Please sign in to access the item on ${server} ${resource}",oAuthInfo:"Please sign in to continue.",lblUser:"Username:",lblPwd:"Password:",lblOk:"OK",lblSigning:"Signing in...",lblCancel:"Cancel",errorMsg:"Invalid username/password. Please try again.",invalidUser:"The username or password you entered is incorrect.",
forbidden:"The username and password are valid, but you don't have access to this resource.",noAuthService:"Unable to access the authentication service."},common:{cancel:"Cancel",ok:"OK",create:"Create",close:"Close",done:"Done",apply:"Apply",remove:"Remove",open:"Open",edit:"Edit",share:"Share",save:"Save",help:"Help",warning:"Warning",deleteLabel:"Delete",titleLabel:"Title:",newLabel:"New",arcgis:"ArcGIS",previous:"Previous",submit:"Submit",next:"Next",yesLabel:"Yes",noLabel:"No",errorTitle:"Error",
upload:"Upload",sum:"Sum",minimum:"Minimum",maximum:"Maximum",mean:"Mean",average:"Average",median:"Median",standardDeviation:"Standard Deviation",variety:"Variety",standardDev:"Std Deviation",statistic:"Statistic",attribute:"Field",selectAttribute:"Select attribute",runAnalysis:"Run Analysis",oneLabel:"1",twoLabel:"2",threeLabel:"3",fourLabel:"4",fiveLabel:"5",sixLabel:"6",sevenLabel:"7",eightLabel:"8",nineLabel:"9",tenLabel:"10",elevenLabel:"11",outputnameMissingMsg:"Output name is required",miles:"Miles",
kilometers:"Kilometers",meters:"Meters",feet:"Feet",degree:"Decimal Degrees",inches:"Inches",nautMiles:"Nautical Miles",pointsUnit:"Point(s)",yards:"Yards",comingSoonLabel:"Coming Soon!",sqMiles:"Square Miles",sqFeet:"Square Feet",sqIn:"Square Inches",sqMapUnits:"Square Map Units",sqYards:"Square Yards",sqCm:"Square Centimeters",sqKm:"Square Kilometers",sqMeters:"Square Meters",hectares:"Hectares",acres:"Acres",seconds:"Seconds",minutes:"Minutes",hours:"Hours",count:"Count",min:"Min",max:"Max",stddev:"STDDEV",
variance:"Variance",range:"Range",days:"Days",weeks:"Weeks",years:"Years",months:"Months",today:"Today",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sunday:"Sunday",chooseSummarizeLabel:"Choose a layer to summarize",creditTitle:"Credit Usage Report",analysisLayers:"Analysis layers:",showCredits:"Show credits",learnMore:"Learn More",hoursSmall:"hr",minutesSmall:"min",secondsSmall:"sec",statsRequiredMsg:"At least one of the statistics parameters is required.",
nowLabel:"Now",hrsLabel:"hrs",groupLabel:"Group",ungroupLabel:"Ungroup",and:"and",or:"or",add:"Add",polygons:"Polygons",points:"Points",lines:"Lines",input:"Input",areas:"Areas",validateRouteIdMsg:"Layers must have the same number of records, or one layer must have one record only.",straightLineDistance:"Line distance",outputLabel:"Output:",addPoint:"Click to add a point",movePoint:"Click to move the point",selectAll:"Select All",unselectAll:"Unselect All",selectLabel:"Select",queryLabel:"Query",
drawnBoundary:"Drawn Boundary",basic:"Basic",intermediate:"Intermediate",advanced:"Advanced",majority:"Majority",minority:"Minority",addMinMajorityLable:"Add minority, majority",addPercentageLabel:"Add percentages",drivingMode:"Driving",truckingMode:"Trucking",walkingMode:"Walking",distanceMsg:"Only numeric values are allowed.",analysisLayerLabel:"Select the analysis layer",selectPointLayer:"You need to select a point feature layer to run ${toolName}.",selectPolyLayer:"You need to select an area (polygon) feature layer to run ${toolName}.",
hotspotsLineFeatureMsg:"Line features are not supported as input to ${toolName}.",areaFeatureInvalidMsg:"Area features are not supported as input to ${toolName}.",overlayValidationMsg:"You need to have two feature layers in the map to perform ${toolName}.",aggregatePolyMsg:"You need to have at least one area (polygon) feature layer to run ${toolName}.",odPointMsg:"You need to have at least two point feature layers to run ${toolName}.",mapNotesAllMsg:"Map note contains points, lines and areas.  Only areas will be used for ${toolName}.",
mapNotesPtsPoly:"Map note contains points and areas.  Only areas will be used for ${toolName}.",mapNotesLinesPoly:"Map note contains lines and areas.  Only areas will be used for ${toolName}.",mapNotesLinesPts:"Map note contains points and lines.  Only lines will be used for ${toolName}.",mergeValidationMsg:"Merge Layers requires at least two layers of the same feature type (point, line, area).",runAnalysisMsg:"Data is being extracted and will be available in My Content.",extractValidationMsg:"There is no data in the map that can be extracted. Data owner(s) must first allow others to export.",
analysisSignInErrorMsg:"Unable to access the analysis service.",addBufExp:"Add Buffer Expession",drawLabel:"Draw",noneLabel:"None",chooseLabel:"Choose ...",browseAnalysisTitle:"Choose Living Atlas Analysis Layer",addLayer:"Add layer to map",withinMapArea:"Within map area",back:"Back",insufficientCreditsMsg:"You do not have enough credits to perform this operation. Contact your ArcGIS System Administrator for assistance.",decimeters:"Decimeters",millimeters:"Millimeters",centimeters:"Centimeters",
noImageServiceMsg:"You need to have at least one image service layer to run ${toolName}.",noSingleBandISMsg:"You need to have a single band image service layer to run ${toolName}.",noMultiBandISMsg:"You need to have a multi-band image service layer to run ${toolName}.",browseLayers:"Browse Layers",addLayerBtnLabel:"Add Layer",timeEnabled:"Time Enabled",milliseconds:"Milliseconds",browseAnalysisLayers:"Choose Analysis Layer",listLabel:"Fields",allLabel:"All",geodesicLabel:"Geodesic",planarLabel:"Planar",
spatialReference:"Spatial Reference (WKID)",enterCoords:"Enter coordinates in Web Mercator",addStatsLabel:"Add statistics (optional)",fieldExpLabel:"Expression",datastoreLabel:"Choose datastore",relationalDS:"Relational",spatialDS:"Spatiotemporal",greaterThanZeroMsg:"Value must be numeric greater than zero.",any:"Any",hexagon:"Hexagon",square:"Square",polygon:"Polygon",createSpaceRunMsg:"Create Space Time cube analysis result will be available in My Content.",fill:"Fill",zeroes:"Zeroes",spatialneighbhors:"Spatial Neighbors",
spacetimeneighbors:"Space Time Neighbors",temporaltrend:"Temporal Trend",aggTimeStepsLabel:"Aggregate using time steps (optional)",intervalLabel:"Time step interval",repeatLabel:"How often to repeat the time step",timeRefLabel:"Time to align time steps to",choosePolyLayer:"Choose the polygon layer",selectSqBinSizeLbl:"Select the size for the square bins",selectHexBinSizeLbl:"Select the size for the hexagon bins",standard:"Standard Tools",bigData:"GeoAnalytics Tools",raster:"Raster Analysis",mostSimilar:"most",
leastSimilar:"least",both:"most and least",numItemsFound:"${total} items found",checkCriteria:"Checking items for required criteria",settings:"Settings",spatial:"Spatial",temporal:"Temporal",attributeLbl:"Attribute",chooseSpatialJoin:"Choose a spatial relationship",chooseAttrJoin:"Choose the fields to match",chooseTemporalJoin:"Choose a temporal relationship",theLabel:"the",outputCellsize:"Output cell size",table:"Table",optimizeFor:"Optimize for",speed:"Speed",accuracy:"Accuracy",precision:"precision",
outputType:"Output type",featureLayer:"Feature Layer",routeLayers:"Route Layers",includeRouteLayers:"Include route layers"},analysisTools:{performAnalysis:"Perform Analysis",summarizeData:"Summarize Data",findLocations:"Find Locations",aggregateTool:"Aggregate Points",bufferTool:"Buffer Data",dataEnrichment:"Data Enrichment",analyzePatterns:"Analyze Patterns",useProximity:"Use Proximity",manageData:"Manage Data",aggregateToolName:"Aggregate Points",bufferToolName:"Create Buffers",aggregatePoints:"Aggregate Points",
summarizeWithin:"Summarize Within",summarizeNearby:"Summarize Nearby",reconstructTracks:"Reconstruct Tracks",enrichLayer:"Enrich Layer",findNearest:"Find Nearest",findHotSpots:"Find Hot Spots",createBuffers:"Create Buffers",dissolveBoundaries:"Dissolve Boundaries",mergeLayers:"Merge Layers",extractData:"Extract Data",overlayLayers:"Overlay Layers",fieldCalculator:"Field Calculator",createDriveTimeAreas:"Create Drive-Time Areas",deriveNewLocations:"Derive New Locations",findExistingLocations:"Find Existing Locations",
findSimilarLocations:"Find Similar Locations",exploreCorrelations:"Explore Correlations",findRoute:"Find Route",generateFleetPlan:"Generate Fleet-routing plan",createDensitySurface:"Create density surface",interpolatePoints:"Interpolate Points",orgUsrMsg:"You must be a member of an organization to run this service.",pubRoleMsg:"Your online account has not been assigned to the Publisher role.",servNameExists:"A result layer already exists with this name. Result layers must be named uniquely across the organization. Please use a different name.",
outputLayerLabel:"Result layer name",outputFileName:"Output file name",emptyResultInfoMsg:"The result of your analysis did not return any features. No layer will be created.",invalidServiceName:'The result layer name contains one or more invalid characters (\x3c, \x3e, #, %, :, ", ?, \x26, +, /, or \\).',invalidServiceNameLength:"The result layer name length should be less than 98 characters.",invalidEncodedServiceNameLength:"The encoded result layer name length should be less than 170 characters.",
requiredValue:"This value is required.",saveResultIn:"Save result in",useMapExtent:"Use current map extent",connectOriginsToDestinations:"Connect Origins to Destinations",planRoutes:"Plan Routes",calculateDensity:"Calculate Density",traceDownstream:"Trace Downstream",createWatershed:"Create Watersheds",createViewshed:"Create Viewshed",createWatersheds:"Create Watersheds",filterNoResults:"Filter did not return any results.",chooseBestFacilities:"Choose Best Facilities",createPanel:"Create Panel",createSpaceTimeCube:"Create Space Time Cube",
joinFeatures:"Join Features",analyzeImage:"Analyze Image",analyzeTerrain:"Analyze Terrain",summarizeRasterWithin:"Summarize Raster Within",histogramRasterWithin:"Histogram Raster Within",findSuitableLocations:"Find Suitable Locations",filterLocations:"Filter Locations",calculateDistance:"Calculate Distance",findShortestPath:"Find Shortest Path",segmentImage:"Segment Image",classifyImage:"Classify Image",detectDifferences:"Detect Differences",monitorVegetation:"Monitor Vegetation",calculateSlope:"Calculate Slope",
deriveAspect:"Derive Aspect",extractRaster:"Extract Raster",remapValues:"Remap Values",interpolatePointsRaster:"Interpolate Points",convertFeatureToRaster:"Convert Feature to Raster",convertRasterToFeature:"Convert Raster to Feature",rasterCalculator:"Raster Calculator",saveLayerType:"Output layer type",dynamicLayer:"Dynamic layer",permanentLayer:"Web Image layer",copytoDatastore:"Copy to Data Store",summarizeAttributes:"Summarize Attributes",findOutliers:"Find Outliers"},aggregatePointsTool:{aggregateDefine:"Count \x3cb\x3e${layername}\x3c/b\x3e within",
outputLayerName:"Aggregation of ${pointlayername} to ${polygonlayername}",groupByLabel:"Choose field to group by (optional)",itemDescription:"Feature layer generated from running the Aggregate Points solutions. Points from ${pointlayername} were aggregated to ${polygonlayername}",itemTags:"Analysis Result, Aggregate Points, ${pointlayername}, ${polygonlayername}",itemSnippet:"Feature layer generated from Aggregate Points",removeAttrStats:"Remove Attribute Statistics",keepPolygonLabel:"Keep areas with no points",
chooseAreaLabel:"Choose layer containing aggregation areas",analysisLayerLabel:"Choose layer containing points to aggregate into areas",binsLabel:"Choose a distance to generate bins and aggregate into",polygonLabel:"Choose a polygon layer to aggregate into",aggOption:"Choose an area layer to aggregate into",bins:"Bins",outputSquareType:"Aggregation of ${pointlayername} by square bins",outputHexType:"Aggregation of ${pointlayername} by hexagon bins"},findHotSpotsTool:{hotspotsPolyDefine:"Analyze \x3cb\x3e${layername}\x3c/b\x3e  to find statistically significant hot and cold spots of ",
hotspotsPointDefine:"Analyze \x3cb\x3e${layername}\x3c/b\x3e  to find statistically significant hot and cold spots ",fieldLabel:"with or without an analysis field",noAnalysisField:"No Analysis Field",hotspots:"Hot Spots",outputLayerName:"Hot Spots ${layername}",Options:"Options",defineBoundingLabel:"Define where points are possible",provideAggLabel:"Count points within",defaultBoundingOption:"None",defaultAggregationOption:"Fishnet Grid",itemDescription:"Feature layer generated from running the Find Hot Spots solution.",
itemTags:"Analysis Result, Hot Spots, ${layername}, ${fieldname}",itemSnippet:"Feature layer generated from Find Hot Spots",chooseAttributeLabel:"Find clusters of high and low",divideByLabel:"Divide by (optional)",blayerName:"Drawn Boundaries",analysisLayerLabel:"Choose layer for which hot spots will be calculated",pointCounts:"Point Counts",enrichLabel:"Esri Population (uses credits)",binSizeLabel:"Select the bin size for aggregation",neighborhoodLabel:"Select the neighborhood size for hot spot calculations",
aggTimeStepsLabel:"Find hot spots using time steps (optional)",intervalLabel:"Time step interval",repeatLabel:"Time step to aggregate into",timeRefLabel:"Reference time to align time step to",timeAlignLabel:"Choose how to align time steps",startTime:"Start Time",endTime:"End Time",referenceTime:"Reference Time",referenceTimeLabel:"Select the reference time",overrideOptions:"Override Options",distanceBand:"Distance Band",cellSize:"Cell Size",hexagonGrid:"Hexagon Grid"},overlayLayersTool:{overlayDefine:"Overlay \x3cb\x3e${layername}\x3c/b\x3e with",
chooseOverlayLayer:"Choose overlay layer",chooseOverlayMethod:"Choose overlay method",chooseOutputType:"Choose output type",itemDescription:"Feature layer generated from running the Overlay layers solution.",itemTags:"Analysis Result, Overlay layers, ${layername}",itemSnippet:"Feature layer generated from Overlay layers",unionOutputLyrName:"Union of ${layername} and ${overlayname}",intersectOutputLyrName:"Intersect of ${layername} and ${overlayname}",eraseOutputLyrName:"Erase ${layername} with ${overlayname}",
overlayLayerPolyMsg:"The Overlay layer should be a Polygon Layer for Union overlay",notSupportedEraseOverlayMsg:"This Overlay layer is not supported for Erase overlay. Defaults to Intersect overlay.",intersect:"Intersect",union:"Union",erase:"Erase",analysisLayerLabel:"Choose input layer"},bufferTool:{bufferDefine:"Create buffers from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"Buffer of ${layername}",sizeLabel:"Enter buffer size",sizeHelp:"To create multiple buffers, enter distances separated by spaces (2 3 5).",
typeLabel:"Buffer type",resultLabel:"Result layer name",optionsLabel:"Options",itemDescription:"Feature layer generated from running the Buffer Features solution. Input from ${layername} were buffered by ${distance_field} ${units}",itemTags:"Analysis Result, Buffer, ${layername}",itemSnippet:"Feature layer generated from Buffer",overlap:"Overlap",dissolve:"Dissolve",include:"Include",exclude:"Exclude",around:"Around",sideType:"Side type",endType:"End type",left:"Left",right:"Right",round:"Round",
flat:"Flat",multipleDistance:"Multiple distance buffers should be",rings:"Rings",disks:"Disks",areaofInputPoly:"Area of input polygons in buffer polygons",distance:"Distance",field:"Field",analysisLayerLabel:"Choose layer containing features to buffer",dissolveType:"Select the type of dissolve method",method:"Select the buffer method",allowMulitipart:"Allow multipart features",bufferDefineBd:"Choose layer to apply buffer to",bufferTypeBd:"Select the type of buffer to apply",selectFieldToDissLabel:"Select the fields to dissolve on",
enterBufDist:"Enter the buffer distance",selectBufField:"Select a field to buffer by",createBufExp:"Create an expression to buffer by"},driveTimes:{toolDefine:"Create areas around \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"Drive from ${layername} (${breakValues} ${breakUnits})",outputModeLayerName:"${mode} from ${layername} (${breakValues} ${breakUnits})",driving:"Drive",trucking:"Truck",walking:"Walk",other:"Travel",measureLabel:"Measure",measureHelp:"To output multiple areas for each point, type sizes separated by spaces (2 3.5 5).",
areaLabel:"Areas from different points",trafficLabel:"Use traffic",typicalTraffCdtnLabel:"Traffic based on typical conditions for",resultLabel:"Result layer name",liveTrafficLabel:"Live traffic",itemDescription:"Feature layer generated from running the Create Drive Times solution.",itemTags:"Analysis Result, Drive Times, ${layername}",itemSnippet:"Feature layer generated from Create Drive Times",split:"Split",seeAvailability:"See availability.",timeOfDeparture:"Time of departure",drivingDistance:"Driving Distance",
drivingTime:"Driving Time",truckingTime:"Trucking Time",truckingDistance:"Trucking Distance",walkingDistance:"Walking Distance",walkingTime:"Walking Time",liveSingularTimeLabel:"Live traffic +1 hr ${minute} min",liveSingularHourTimeLabel:"Live traffic +1 hr",liveTimeLabel:"Live traffic +${hour} hr ${minute} min",liveTimeHoursLabel:"Live traffic +${hour} hr",liveTimeMinutesLabel:"Live traffic +${minute} min",analysisLayerLabel:"Choose point layer to calculate drive-time areas around"},routeOriginDestinationPairsTool:{toolDefine:"Route between pairs of points originating from \x3cb\x3e${layername}\x3c/b\x3e",
labelOne:"Route to destinations in",pairPoints:"Points with matching IDs will connect:",originTripId:"ID field in origins",destnTripId:"Matching ID field in destinations",includeSegments:"Include individual road segments.",inValidNumberRecordsMsg:"Layers must have the same number of records, or one layer must have one record only.",outputLayerName:"${layername} to ${destnlayername}",itemDescription:"Feature layer generated from running the Connect Origins to Destinations solution.",itemTags:"Analysis Result, Connect Origins to Destinations, ${layername}, ${destnlayername}",
itemSnippet:"Feature layer generated from Connect Origins to Destinations",analysisLayerLabel:"Choose point layer representing the origin locations:"},planRoutesTool:{toolDefine:"Route vehicles to stops in \x3cb\x3e${layername}\x3c/b\x3e",timeSpentLabel:"Time spent at each stop",defineRoutesLabel:"Define routes",startRoutesLabel:"Routes begin at",endRoutesLabel:"Routes end at",routes:"Routes",stops:"Stops",numRoutes:"Maximum number of vehicles to route",maxPtsRoute:"Maximum number of stops per vehicle",
limitMaxTime:"Limit the total route time per vehicle",returnToStart:"Return to start",specifyStartTime:"Start time for all routes",createStartLoc:"Add point to map",createEndLoc:"Add point to map",selectStartLoc:"Select starting location",selectEndLoc:"Select ending location",vehicles:"Vehicles",routeId:"Route ID field",selectRouteId:"Select RouteID",stopsLabel:"Your layer has ${numStops} stops.",stopsLabelByExtent:"The current map extent shows ${numStops} stops.",outputLayerName:"Routes to ${layername}",
itemDescription:"Feature layer generated from running the Plan Routes solution.",itemTags:"Analysis Result, Plan Routes, ${layername}",itemSnippet:"Feature layer generated from Plan Routes",startEndPtsValidMsg:"Start or end points not set",travelModeLabel:"Travel mode for routes",analysisLayerLabel:"Choose point layer representing stops to visit",resultLabel:"Result layer name",routeLayerTypeMsg:"Route Layers are being created and will be available in ${folderName} within My Content."},extractDataTool:{layersToExtract:"Layers to extract",
studyArea:"Study area",outputDataFormat:"Output data format",filegdb:"File Geodatabase (.zip)",shpFile:"Shapefile (.zip)",lyrpkg:"Layer Package (.lpk)",selectFtrs:"Select features",clipFtrs:"Clip features",sameAsDisplay:"Same as Display",sameAsLayer:"Same as ${layername}",outputfileName:"Extract Data ${datetime}",itemDescription:"File generated from running the Extract Data solution.",itemTags:"Analysis Result, Extract Data",itemSnippet:"Analysis File item generated from Extract Data",kml:"KML (.kmz or .zip)",
csvPoints:"CSV (.csv or .zip)  ",linesCSVValidationMsg:"Line and area layers cannot be extracted to CSV.  Choose a different format or uncheck all line and area layers.",runAnalysisMsg:"Data is being extracted and will be available in My Content."},summarizeWithinTool:{summarizeDefine:"For Features within \x3cb\x3e${sumWithinLayerName}\x3c/b\x3e",outputLayerName:"Summarize ${summaryLayerName} within ${sumWithinLayerName}",groupByLabel:"Choose field to group by (optional)",itemDescription:"Feature layer generated from running the Summarize Within solution. ${summaryLayerName} were summarized within ${sumWithinLayerName}",
itemTags:"Analysis Result, Summarize Within, ${sumWithinLayerName}, ${summaryLayerName}",itemSnippet:"Feature layer generated from Summarize Within",removeAttrStats:"Remove Attribute Statistics",summarizeMetricPoint:"Count of points",summarizeMetricLine:"Length of lines in",summarizeMetricPoly:"Sum Area in",addStatsLabel:"Attribute statistics",addStats:"Add statistics from the layer to summarize",sumLabel:"Summarize",analysisLayerLabel:"Choose an area layer to summarize other features within its boundaries",
summDefineAnalysisLabel:"Choose type of area layer to summarize other features within its boundaries",addNonWightLabel:"Add non-weighted statistics from the layer to summarize",addWeightLabel:"Add weighted statistics from the layer to summarize",aggTimeStepsLabel:"Summarize using time slices (optional)",intervalLabel:"Time interval to be summarize into",repeatLabel:"Time step to summarize into",outputSquareType:"Summarize ${summaryLayerName} within square bins",outputHexType:"Summarize ${summaryLayerName} within hexagon bins"},
summarizeNearbyTool:{summarizeDefine:"Summarize what is nearby \x3cb\x3e${sumNearbyLayerName}\x3c/b\x3e",findNearLabel:"Summarize nearest features using a",outputLayerName:"Summarize ${summaryLayerName} in ${sumNearbyLayerName}",groupByLabel:"Choose field to group by (optional)",itemDescription:"Feature layer generated from running the Summarize Nearby solution. ${sumNearbyLayerName} were summarized nearby ${summaryLayerName}",itemTags:"Analysis Result, Summarize Nearby, ${sumNearbyLayerName}, ${summaryLayerName}",
itemSnippet:"Feature layer generated from Summarize Nearby",removeAttrStats:"Remove Attribute Statistics",summarizeMetricPoint:"Count of points",summarizeMetricLine:"Total Length",summarizeMetricPoly:"Total Area",addStatsLabel:"Attribute statistics",addStats:"Add statistics from the layer to summarize",sumLabel:"Summarize",chooseLayer:"Choose layer to summarize",returnBdrycCheckLabel:"Return bounding areas",analysisLayerLabel:"Choose layer from which distances will be measured to features in the layer to summarize"},
creditEstimator:{analysisLayersLabel:"Analysis layers:",totalRecordsLabel:"Total records:",creditsAvailLabel:"Credits available:",creditsReqLabel:"Credits required:",ntwCreditsReqLabel:"Network credits required:",EnrichCreditsLabel:"Enrichment credits required",maxCreditsLabel:"Maximum credits required:"},enrichLayerTool:{selectCountryLabel:"Select country",enrichDefine:"Enrich \x3cb\x3e${inputLayerName}\x3c/b\x3e",chooseDataCollectionLabel:"Show available data for:",defAreasLabel:"Define areas to enrich",
outputLayerName:"Enriched ${layername}",itemDescription:"Feature layer generated from running the Enrich layer solution. ${inputLayerName} were enriched",itemTags:"Analysis Result, Enrich Layer, ${inputLayerName}",itemSnippet:"Feature layer generated from Enrich layer",straightLineDistance:"Line distance",selectDataVar:"Select Variables",clickDataVar:"Click Select Variables to open Data Browser and browse for variables",selectedVars:"Selected Variables",usCountryCode:"United States",canadaCountryCode:"Canada",
albaniaCountryCode:"Albania",australiaCountryCode:"Australia",austriaCountryCode:"Austria",bahrainCountryCode:"Bahrain",belarusCountryCode:"Belarus",bosniaCountryCode:"Bosnia and Herzegovina",botswanaCountryCode:"Botswana",belgiumCountryCode:"Belgium",brazilCountryCode:"Brazil",bulgariaCountryCode:"Bulgaria",chinaCountryCode:"China",colombiaCountryCode:"Colombia",croatiaCountryCode:"Croatia",cyprusCountryCode:"Cyprus",czechCountryCode:"Czech Republic",coteCountryCode:"Cote d'Ivoire",denmarkCountryCode:"Denmark",
finlandCountryCode:"Finland",franceCountryCode:"France",germanyCountryCode:"Germany",ghanaCountryCode:"Ghana",greeceCountryCode:"Greece",hungaryCountryCode:"Hungary",icelandCountryCode:"Iceland",indiaCountryCode:"India",indonesiaCountryCode:"Indonesia",irelandCountryCode:"Ireland",israelCountryCode:"Israel",italyCountryCode:"Italy",japanCountryCode:"Japan",kazakhstanCountryCode:"Kazakhstan",kenyaCountryCode:"Kenya",latviaCountryCode:"Latvia",liechtensteinCountryCode:"Liechtenstein",lithuaniaCountryCode:"Lithuania",
luxembourgCountryCode:"Luxembourg",malawiCountryCode:"Malawi",malaysiaCountryCode:"Malaysia",maltaCountryCode:"Malta",mauritiusCountryCode:"Mauritius",mexicoCountryCode:"Mexico",moldovaCountryCode:"Moldova",montenegroCountryCode:"Montenegro",mozambiqueCountryCode:"Mozambique",namibiaCountryCode:"Namibia",netherlandsCountryCode:"Netherlands",nzCountryCode:"New Zealand",nigeriaCountryCode:"Nigeria",norwayCountryCode:"Norway",peruCountryCode:"Peru",polandCountryCode:"Poland",portugalCountryCode:"Portugal",
puertoCountryCode:"Puerto Rico",romaniaCountryCode:"Romania",reunionCountryCode:"Reunion",spainCountryCode:"Spain",switzerlandCountryCode:"Switzerland",swedenCountryCode:"Sweden",turkeyCountryCode:"Turkey",ukCountryCode:"United Kingdom",zmCountryCode:"Zambia",ugandaCountryCode:"Uganda",mkCountryCode:"The Former Yugoslav Republic of Macedonia",uaeCountryCode:"United Arab Emirates",thCountryCode:"Thailand",twCountryCode:"Taiwan",szCountryCode:"Swaziland",krCountryCode:"South Korea",siCountryCode:"Slovenia",
sgCountryCode:"Singapore",rsCountryCode:"Serbia",saCountryCode:"Saudi Arabia",tzCountryCode:"Tanzania",ukrCountryCode:"Ukraine",globalCode:"Global",russiaCountryCode:"Russia",algCountryCode:"Algeria",andCountryCode:"Andorra",argCountryCode:"Argentina",azCountryCode:"Azerbaijan",baCountryCode:"Bangladesh",chCountryCode:"Chile",coCountryCode:"Costa Rica",egCountryCode:"Egypt",elCountryCode:"El Salvador",eeCountryCode:"Estonia",grCountryCode:"Georgia",gtCountryCode:"Guatemala",hoCountryCode:"Honduras",
joCountryCode:"Jordan",kwCountryCode:"Kuwait",kzCountryCode:"Kyrgyzstan",lbCountryCode:"Lebanon",leCountryCode:"Lesotho",mgCountryCode:"Mongolia",moCountryCode:"Morocco",niCountryCode:"Nicaragua",omCountryCode:"Oman",pkCountryCode:"Pakistan",phCountryCode:"Philippines",qaCountryCode:"Qatar",slCountryCode:"Slovakia",safCountryCode:"South Africa",sriCountryCode:"Sri Lanka",sdCountryCode:"Sudan",tnCountryCode:"Tunisia",ugCountryCode:"Uruguay",syCountryCode:"Syria",vzCountryCode:"Venezuela",vtCountryCode:"Vietnam",
keyGlobalFacts:"Key Global Facts",age:"Age",husByOccupancy:"Housing Units By Occupancy",householdsByIncome:"Households by Income",keyUSFacts:"Key US Facts",policy:"Policy Facts",raceAndEthnicity:"Race And Ethnicity",wealth:"Wealth Facts",keyCanFacts:"Key Canada Facts",aTSpend:"Austria Spending",aTFacts:"Austria Facts",bESpend:"Belgium Spending",bEFacts:"Belgium Facts",bRSpend:"Brazil Spending",bRFacts:"Brazil Facts",dKSpend:"Denmark Spending",dKFacts:"Denmark Facts",fISpend:"Finland Spending",fIFacts:"Finland Facts",
fRSpend:"France Spending",fRFacts:"France Facts",dESpend:"Germany Spending",dEFacts:"Germany Facts",gRSpend:"Greece Spending",gRFacts:"Greece Facts",iEFacts:"Ireland Facts",iESpend:"Ireland Spending",iNFacts:"India Facts",iNSpend:"India Spending",iTFacts:"Italy Facts",iTSpend:"Italy Spending",keyWEFacts:"Key Western Europe Facts",keyWESpend:"Key Western Europe Spending",jPFacts:"Japan Facts",jPSpend:"Japan Spending",lIFacts:"Liechtenstein Facts",lISpend:"Liechtenstein Spending",lUFacts:"Luxembourg Facts",
lUSpend:"Luxembourg Spending",nLFacts:"Netherlands Facts",nLSpend:"Netherlands Spending",nOFacts:"Norway Facts",nOSpend:"Norway Spending",pTFacts:"Portugal Facts",pTSpend:"Portugal Spending",eSSpend:"Spain Spending",eSFacts:"Spain Facts",sEFacts:"Sweden Facts",sESpend:"Sweden Spending",cHFacts:"Switzerland Facts",cHSpend:"Switzerland Spending",tRFacts:"Turkey Facts",tRSpend:"Turkey Spending",gBFacts:"United Kingdom Facts",gBSpend:"United Kigdom Spending",tapestry:"Tapestry",infrastructure:"Infrastructure",
landCover:"Land Cover",landscapeFacts:"Landscape Facts",publicLands:"Public Lands",soils:"Soils",waterWetlands:"Water Wetlands",rUFacts:"Russia Facts",rUSpend:"Russia Spending",analysisLayerLabel:"Choose layer to enrich with new data",returnBoundingAreas:"Return result as bounding areas"},dissolveBoundaries:{dissolveBoundariesDefine:"Dissolve \x3cb\x3e${layername}\x3c/b\x3e",chooseDissolveLabel:"Choose dissolve method",overlappingAreasLabel:"Areas that overlap or are adjacent",sameAttributeAreasLabel:"Areas with same field value",
summarizeLabel:"Add statistic (optional)",itemDescription:"Feature layer generated from running the Dissolve Boundaries solution.",itemTags:"Analysis Result, Dissolve Boundaries, ${layername}",itemSnippet:"Feature layer generated from Dissolve Boundaries",resultLabel:"Result layer name",outputLayerName:"Dissolve ${layername}",analysisLayerLabel:"Choose area layer whose boundaries will be dissolved"},FindNearestTool:{summarizeDefine:"For each location in \x3cb\x3e${sumNearbyLayerName}\x3c/b\x3e, find its nearest locations.",
findNearLabel:"Find the nearest locations by measuring",outputLayerName:"Nearest ${layer} to ${sumNearbyLayerName}",groupByLabel:"Choose field to group by (optional)",itemDescription:"Feature layer generated from running the Find Nearest solution. Nearest ${sumNearbyLayerName}",itemTags:"Analysis Result, Find Nearest, ${sumNearbyLayerName}, ${summaryLayerName}",itemSnippet:"Feature layer generated from Find Nearest",removeAttrStats:"Remove Attribute Statistics",forEachLocationLabel:"For each location in the input layer",
findNearestLabel:"Limit the number of nearest locations to:",limitSearchRangeCheck:"Limit the search range to",addStats:"For each location in \x3cb\x3e${summaryLayerName}\x3c/b\x3e",chooseLayer:"Choose a layer",findLocationsIn:"Find the nearest locations in:",outputLayersLabel:"Result layer names",straightLineDistance:"Line distance",resultLabel1:"Nearest locations layer",resultLabel2:"Connecting lines layer",outputConnectingLayerName:"Nearest ${layer} to ${sumNearbyLayerName} (Lines)",chooseLayerInfoLabel:"Both input layers must contain points to enable Driving distance and Driving time options",
analysisLayerLabel:"Choose the layer from which the nearest locations are found:"},mergeLayers:{mergeLayersDefine:"Merge \x3cb\x3e${layername}\x3c/b\x3e with",outputLayerName:"Merge ${layername} ${mergelayername}",chooseMergeLayer:"Choose layer to merge",mergeFieldsLabel:"Modify merging fields (optional)",itemDescription:"Feature layer generated from running the Merge Layers solution.",itemTags:"Analysis Result, Merge Layers, ${layername}",itemSnippet:"Feature layer generated from Merge Layers",resultLabel:"Result layer name",
rename:"Rename",remove:"Remove",match:"Match",operation:"Operation",fieldTypeMatchValidationMsg:"Fields to be matched must have the same type.  Transformation of types is supported (for example, double to integer, integer to string) except for string to numeric.",analysisLayerLabel:"Choose layer"},findExistingLocations:{findExpLabel:"Build a query to find features",outputLayerName:"Find Locations in ${analysisLayerName}",itemDescription:"Feature layer generated from running the Find Existing Locations solutions for  ${analysisLayerName}.",
itemTags:"Analysis Result, Find Existing Locations, ${analysisLayerName}",itemSnippet:"Feature layer generated from Find Existing Locations",analysisLayerLabel:"Choose layer containing features you want to find using attribute and spatial queries"},deriveNewLocations:{findExpLabel:"Derive new locations that match the following expression(s)",outputLayerName:"New Locations",itemDescription:"Feature layer generated from running the Derive New Locations solutions.",itemTags:"Analysis Result, Derive New Locations, ${analysisLayerName}",
itemSnippet:"Feature layer generated from Find Existing Locations"},findSimilarLocations:{toolDefine:"Find locations that are similar to: \x3cb\x3e${layername}\x3c/b\x3e",labelOneText:"You may use all locations or make a selection",labelTwoText:"Search for similar locations in",labelThreeText:"Base similarity on",labelFourText:"Show me",outputLayerName:"Most Similar ${analysisLayerName}",selectTargetFtrs:"Select one or more target features",useAllFtrs:"Use all features",itemDescription:"Feature layer generated from running the Find Similar Locations solutions for  ${analysisLayerName}.",
itemTags:"Analysis Result, Find Similar Locations, ${analysisLayerName}",itemSnippet:"Feature layer generated from Find Similar Locations",allResults:"all locations from most to least similar",justShowTop:"the top",selectSearchLayer:"Select the search layer",query:"Query",noFieldMatchMsg:"Search layer and input layer do not have any fields in common.",reqSelectionMsg:"You must select the feature(s) to match by making an interactive selection or by constructing a query.",selectedFeaturesLabel:"${total} feature(s) selected",
analysisLayerLabel:"Choose layer containing the reference locations",most:"most",least:"least",mostLeast:"most and least",chooseFldAdd:"Choose fields to add to results",determineLbl:"Determine the most and least similar using",fieldValues:"field values",fieldProfiles:"field profiles",similarLocations:"similar locations",fieldProfilesValidCheck:"You must provide at least two fields to base similarity on for the field profile method."},expressionGrid:{addExpr:"Add Expression",expression:"Expression",
editExpr:"Edit Expression",viewText:"View Text",viewGrid:"View Grid",addExprDescription:"Click Add Expression to begin building your query.",duplicateExpression:"This Expression already exists"},expressionForm:{where:"where (attribute query)",whereLabel:"where",intersects:"intersects",notIntersects:"does not intersect",withinDistance:"within a distance of",notWithinDistance:"not within a distance of",contains:"completely contains",notContains:"does not completely contain",completelyContains:"completely contains",
notCompletelyContains:"does not completely contain",within:"completely within",notWithin:"not completely within",completelyWithin:"completely within",notCompletelyWithin:"not completely within",identical:"are identical to",notIdentical:"are not identical to",touches:"touches",notTouches:"does not touch",crossesOutline:"crossed by the outline of",notCrossesOutline:"not crossed by the outline of",from:"from",inValidAttributeFilterMessage:"Layer ${layername} does not contain any attributes that can be used in an attribute query."},
interpolatePointsTool:{toolDefine:"Interpolate values from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"${layername} Prediction",interpolationMethod:"Interpolation method",selectAttributesLabel:"Choose field to interpolate",classifyLabel:"Classify by",classesCountLabel:"Number of classes",equalInterval:"Equal Interval",manual:"Manual",quantile:"Equal Area",geometricInterval:"Geometric Interval",outputPredictionErrors:"Output prediction errors",interpolateWithin:"Clip output to",predictLocLabel:"Predict at these locations",
choosePointLayer:"Choose point layer",pointlayerName:"Drawn Prediction Points",classBreakValues:"Class break values",defaultBoundingOption:"Choose study area",classBreaksHelp:"Enter break values separated by spaces: (10 20 30)",itemDescription:"Feature layer generated from running the Interpolate Points solution.",itemTags:"Analysis Result, Interpolate Points, ${layername}, ${fieldname}",itemSnippet:"Feature layer generated from Interpolate Points",analysisLayerLabel:"Choose point layer containing locations with known values"},
calculateDensityTool:{toolDefine:"Calculate density values from \x3cb\x3e${layername}\x3c/b\x3e",selectAttributesLabel:"Use a count field (optional)",outputAerealUnits:"Output area units",itemDescription:"Feature layer generated from running the Calculate Density solution.",itemTags:"Analysis Result, Calculate Density, ${layername}, ${fieldname}",itemSnippet:"Feature layer generated from Calculate Density",outputLayerName:"${layername} Density",searchDistance:"Search Distance",naturalBreaks:"Natural Breaks",
standardDeviation:"Standard Deviation",chooseCountField:"No count field",analysisLayerLabel:"Choose point or line layer from which to calculate density",analysisLayerLabelBigData:"Choose a point layer from which to calculate density",selectAttributesLabelBigData:"Choose one or more fields to calculate density on (optional)",binTypeLabel:"Choose a bin shape",square:"Square",hexagon:"Hexagon",chooseBinSizeLabel:"Select the bin size for aggregation",weightLabel:"Select the density weighting to apply",
uniform:"Uniform",kernel:"Kernel",selectNeighborhoodLabel:"Select the neighborhood size",areaLabel:"Choose the output units for density",calTimeSliceLabel:"Calculate density using time steps (optional)",intervalLabel:"Time step interval",repeatLabel:"How often to repeat the time step",timeRefLabel:"Time to align time steps to",smallBinErrorMsg:"Neighborhood size must be greater than bin size."},traceDownstreamTool:{toolDefine:"Trace downstream from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"${layername} Trace",
choosePointLayer:"Choose point layer",pointlayerName:"Drawn Input Points",defaultBoundingOption:"Choose study area",itemDescription:"Feature layer generated from running the Trace Downstream solution.",itemTags:"Analysis Result, Trace Downstream, ${layername}",itemSnippet:"Feature layer generated from Trace Downstream",clipOutputToLabel:"Clip output to",traceOptionsLabel:"Trace downstream settings (optional)",splitTraceLabel:"Split the trace into line segments",maxTraceLabel:"Maximum distance of the trace",
analysisLayerLabel:"Point features used as the starting locations for each downstream trace"},createWatershedTool:{toolDefine:"Create Watersheds from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"${layername} Watersheds",choosePointLayer:"Choose point layer",pointlayerName:"Drawn Input Points",defaultBoundingOption:"Choose study area",itemDescription:"Feature layer generated from running the Create Watershed solution.",itemTags:"Analysis Result, Create Watersheds, ${layername}",itemSnippet:"Feature layer generated from Create Watershed",
searchDistanceLabel:"Search distance to nearest drainage (optional)",analysisLayerLabel:"Point features to use for calculating watersheds"},chooseBestFacilitiesTool:{goalLabel:"Goal",facTodemLabel:"Facility to Demand",demTofacLabel:"Demand to Facility",demandLayer:"Demand Locations Layer",demandLabel:"Your layer has ${numberOf} demand locations.",demandExtentLabel:"The current map extent shows ${numberOf} demand locations.",facilitiesNumLabel:"Your layer has ${numberOf} required facilities.",facilitiesExtentLabel:"The current map extent shows ${numberOf} required facilities.",
candidateNumLabel:"Your layer has ${numberOf} candidate facilities.",candidateExtentLabel:"The current map extent shows ${numberOf} candidate facilities.",demandAmountLabel:"Amount of demand at each demand location:",constLabel:"Constant",maxTravelLabel:"Maximum travel range:",unlimitedLabel:"Unlimited",reqdFacilities:"Required Facilities Layer",candFacilities:"Candidate Facilities Layer",capacityLabel:"Capacity",minimizeImpedance:"Minimize travel",allocate:"Allocate to existing facilities",maximizeCoverage:"Maximize coverage",
maximizeCapacitatedCoverage:"Maximize coverage with capacity",percentCoverage:"Cover a percentage of demand",numberCandidates:"Number of candidates to choose:",travelDirection:"Travel Direction:",reqFacLayerLabel:"Required facilities point layer:",outputLayerName:"Assigned facilities for ${demandLayer}",delieveries:"Delieveries",demand:"Demand",pickups:"Pickups",weight:"Weight",demandPercentCover:"Percent of Demand to cover:",selectGoal:"Select the option that best fits your goal",allocateDesc:"Allocate demand locations to existing facilities based on the supply at the facility and the amount of demand from the surrounding area.",
minimizeImpedanceDesc:"Locate facilities such that the overall travel time or travel distance between the demand locations and facilities is minimized.",maximizeCoverageDesc:"Locate facilities such that the maximum amount of demand is allocated, with all the demand from each demand location allocated to the single facility closest to it.",maximizeCapacitatedCoverageDesc:"Locate facilities such that the maximum amount of demand is allocated, with all the demand from each demand location allocated to the single facility closest to it without exceeding the capacity of the facility.",
percentCoverageDesc:"Locate the minimum number of facilities that are required to cover the given percentage of demand.",candidateLayerLabel:"Candidate facilities point layer:",noneReqOption:"There are no facilities that must be always used",maxDemandLocationMsg:"Number of features in demand locations layer cannot be greater than ${maximumDemandPoints}.",maxFacilitiesMsg:"Number of features in required facilities layer  cannot be greater than ${maximumFacilities}.",candidateCountMsg:"Number of features in candidate facilities layer should be greater than number of candidates to choose.",
candidateCountValidMsg:"Sum of candidates to choose and number of features in required facilities layer cannot be greater than ${maximumFacilitiesToFind}."},createViewshedTool:{toolDefine:"Create areas that are visible from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"${layername} visible areas",itemDescription:"Feature layer generated from running the Create Viewshed solution.",itemTags:"Analysis Result, Create Viewshed, ${layername}",itemSnippet:"Feature layer generated from Create Viewshed",
maxDistanceLabel:"Maximum viewing distance",observerHghtLabel:"Height of observer locations",targetHghtLabel:"Height of other objects on the ground",viewshedOptionlabel:"Visibility settings (optional)",maxDistanceValidMsg:"The maximum viewing distance cannot be more than ${limit} ${units}.",maxdistanceInValidMsg:"Only integer values are allowed",analysisLayerLabel:"Point features that represent observer locations",pointlayerName:"Drawn Input Points"},calculateSlopeTool:{toolDefine:"Calculate Slope from \x3cb\x3e${layername}\x3c/b\x3e",
outputLayerName:"${layername} Slope",defaultBoundingOption:"Choose study area",itemDescription:"Analysis Image Service generated from Calculate Slope",itemTags:"Analysis Result, Calculate Slope, ${layername}",itemSnippet:"Analysis Image Service generated from Calculate Slope",zFactorInputLabel:"Specify scaling factor for elevation",analysisLayerLabel:"Choose input data to calculate slope"},deriveAspectTool:{toolDefine:"Derive Aspect from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"Aspect of ${layername}",
defaultBoundingOption:"Choose study area",itemDescription:"Analysis Image Service generated from Derive Aspect",itemTags:"Analysis Result, Derive Aspect, ${layername}",itemSnippet:"Analysis Image Service generated from Derive Aspect",analysisLayerLabel:"Choose input data to derive aspect"},monitorVegetationTool:{monitorVegetation:"Monitor Vegetation",toolDefine:"Monitor vegetation in \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"Monitor Vegetation of ${layername}",indexType:"Choose method to monitor vegetation",
bandIndexes:"Specify indexes of NIR band and Red band",nirBandIndex:"NIR band index",redBandIndex:"Red band index",greenVegetativeCover:"Amount of green vegetation cover",slopeOfSoilLine:"Slope of soil line",gradientOfSoilLine:"Intercept of soil line",adjustmentFactor:"Adjustment factor",NDVI:"Normalized Difference Vegetation Index",SAVI:"Soil-Adjusted Vegetation Index",TSAVI:"Transformed Soil-Adjusted Vegetation Index",GEMI:"Global Environmental Monitoring Index",PVI:"Perpendicular Vegetation Index",
MSAVI:"Modified Soil Adjusted Vegetation Index",GVITM:"Green Vegetation Index - Landsat TM",Sultan:"Sultan's Formula",Options:"Remap pixel values to new values",minimum:"Minimum",maximum:"Maximum",output:"Output",addItemLabel:"Add an entry",removeItemLabel:"Remove selected entry",analysisLayerLabel:"Select the input data",itemDescription:"Analysis Image Service generated from Monitor Vegetation",itemTags:"Analysis Result, Monitor Vegetation, ${layername}",itemSnippet:"Analysis Image Service generated from Monitor Vegetation"},
remapValuesTool:{toolDefine:"Remap Pixel Values in ${layername}",outputLayerName:"Remapped Raster from ${layername}",remapList:"Remap pixel values to new values",analysisLayerLabel:"Choose input data to remap values",itemDescription:"Analysis Image Service generated from Remap",itemTags:"Raster Analysis Result, Remap",itemSnippet:"Analysis Image Service generated from Remap",clipping:"Specify the area to be remapped",add:"Add",remove:"Remove",viewText:"View"},extractRasterTool:{toolDefine:"Extract Data from ${layername}",
outputLayerName:"Data extracted from ${layername}",clipping:"Specify clipping geometry",clippingInside:"Data inside the geometry",clippingOutside:"Data outside the geometry",clippingExtent:"Use current extent",clippingGeometry:"Choose study area",analysisLayerLabel:"Choose input data to extract",itemDescription:"Analysis Image Service generated from Extract Raster Data",itemTags:"Raster Analysis Result, Extract Raster Data",itemSnippet:"Analysis Image Service generated from Extract Raster Data"},
reconstructTracksTool:{inputFeatures:"Choose features to reconstruct tracks from",trackField:"Choose one or more fields to identify tracks",bufField:"Create an expression to buffer input features by (optional)",durSplit:"Select a time to split tracks by (optional)",methodLabel:"Choose method used to reconstruct tracks",itemDescription:"Feature layer generated from running the Reconstruct Tracks solution for ${inputLayername}.",itemTags:"Analysis Result, Reconstruct Tracks, ${inputLayername}",itemSnippet:"Feature layer generated from Reconstruct Tracks",
outputLayerName:"Reconstruct Tracks for ${inputLayername}"},summarizeAttributesTool:{inputFeatures:"Choose the input to summarize",fieldLabel:"Choose the fields to summarize",addStatsLabel:"Add statistics (optional)",itemDescription:"Feature layer generated from running the Summarize Attributes solution for ${inputLayername}.",itemTags:"Analysis Result, Summarize Attributes, ${inputLayername}",itemSnippet:"Feature layer generated from Summarize Attributes.",outputLayerName:"Summarize Attributes for ${inputLayername}"},
summarizeRasterWithinTool:{toolDefine:"Summarize Raster Within ${layername}",outputLayerName:"Summarize within ${layername}",outputLayerNameFull:"Summarize ${valuelayername} within ${layername}",statsLabel:"Choose statistic to calculate",fieldLabel:"Choose field to define the boundaries",summarizeLayerLabel:"Choose raster layer to summarize",ignoreNDLabel:"Ignore missing values in calculation",ignoreLabel:"Ignore",analysisLayerLabel:"Choose area layer to summarize a raster layer within defined boundaries",
itemDescription:"Analysis Image Service generated from Summarize Raster Within",itemTags:"Raster Analysis Result, Summarize Raster Within, ${layername}, ${valuelayername}",itemSnippet:"Analysis Image Service generated from Summarize Raster Within"},createSpaceTimeCubeTool:{inputLabel:"Choose input points to create a space time cube from",binSizeLabel:"Choose the bin size",binShapeLabel:"Choose a bin shape",timeIntervalSizeLabel:"Choose the time interval size",timeAlignLabel:"Choose how the time will be aligned",
startTime:"Start Time",endTime:"End Time",referenceTime:"Reference Time",referenceTimeLabel:"Select the reference time",summaryFieldsLabel:"Select the statistics you would like to calculate, and how to fill empty bins",itemDescription:"Feature layer generated from running the Create Space Time Cube solution for ${pointLayername}.",itemTags:"Analysis Result, Create Space Time Cube, ${pointLayername}",itemSnippet:"Feature layer generated from Create Space Time Cube.",outputLayerName:"Create Space Time Cube for ${pointLayername}"},
joinFeaturesTool:{joinFeaturesTitle:"Join Features",targetLayerLabel:"Choose target layer",joinLayerLabel:"Choose layer to join to target layer",joinTypeLabel:"Choose join operation",joinOptionsLabel:"Select one or more joins",spatialJoinLabel:"Spatial Join",temporalJoinLabel:"Temporal Join",attributeJoinLabel:"Attribute Join",statisticsLabel:"Add statistics (optional)",resultLabel:"Result layer name",runAnalysis:"Run Analysis",showCredits:"Show Credits",oneToOneLabel:"Join one to one",oneToManyLabel:"Join one to many",
selectJoinField:"Join field",selectTargetField:"Target field",near:"Near",equalsLabel:"Equals",intersectsLabel:"Intersects",crossesLabel:"Crosses",withinLabel:"Within",containsLabel:"Contains",touchesLabel:"Touches",overlapsLabel:"Overlaps",duringLabel:"During",finishesLabel:"Finishes",finishedByLabel:"Finished By",overlappedByLabel:"Overlapped By",startsLabel:"Starts",startedByLabel:"Started By",meetsLabel:"Meets",metByLabel:"Met By",equalSign:"\x3d",notEqualSign:"!\x3d",selectField:"Field",selectStats:"Statistic",
itemDescription:"Feature layer generated from running the Join Features solution",itemTags:"Analysis Result, Join Features",itemSnippet:"Feature layer generated from Join Features",saveResultIn:"Save result in",useMapExtent:"Use current map extent",selectTargetLayer:"Select the target layer",joinOperationLbl:"Build an expression to join features by (optional)",selectJoinLayer:"Select the join layer",selectJoinOpLabel:"Select the join operation",joinTypesErrorMsg:"Please select at least one type of join from Step 3.",
joinOpErrorMsg:"Please select a join operation from Step 3.",joinLayerErrorMsg:"Please select a valid layer from Step 2.",addJoinCondition:"Join Condition",joinOptionsStdLabel:"Select the type(s) of join",identical:"Identical to",withinDistance:"Within a distance of",completelyContains:"Completely contains",completelyWithin:"Completely within",outputLayerName:"Join Features to ${targetLayerName}"},copytoDatastoreTool:{inputLabel:"Choose layer to copy",dataStoreCopyLabel:"Choose the Data Store to copy to",
itemDescription:"Feature layer generated from running the Copy to Data Store solution for ${inputLayerName}.",itemTags:"Analysis Result, Copy to Data Store, ${inputLayerName}",itemSnippet:"Feature layer generated from Copy to Data Store.",outputLayerName:"Copy to Data Store for ${inputLayerName}"},convertFeatureToRasterTool:{toolDefine:"Convert Features in ${layername} To Raster",outputLayerName:"Rasterization ${layername}",pixelSize:"Output cell size",valueField:"Choose field",backgroundValue:"Background value (optional)",
analysisLayerLabel:"Choose feature layer to convert",itemDescription:"Analysis Image Service generated from Convert Feature To Raster",itemTags:"Raster Analysis Result, Convert Feature To Raster, ${layername}",itemSnippet:"Analysis Image Service generated from Convert Feature To Raster"},convertRasterToFeatureTool:{toolDefine:"Convert ${layername} To Feature",outputLayerName:"Vectorization of ${layername}",valueField:"Choose field",outputType:"Choose output type",point:"Point",line:"Line",polygon:"Polygon",
simplify:"Simplify lines or polygons",analysisLayerLabel:"Choose raster layer to convert",itemDescription:"Feature layer generated from Convert Raster To Feature",itemTags:"Raster Analysis Result, Convert Raster to Feature, ${layername}",itemSnippet:"Feature layer generated from Convert Raster To Feature"},calculateDensityRasterTool:{toolDefine:"Calculate density values from \x3cb\x3e${layername}\x3c/b\x3e",selectAttributesLabel:"Use a count field (optional)",outputAreaUnits:"Output area units (optional)",
searchDistance:"Search distance (optional)",searchDistanceHint:"Search distance",itemDescription:"Analysis Image Service generated from Calculate Density",itemTags:"Analysis Result, Calculate Density, ${layername}, ${fieldname}",itemSnippet:"Analysis Image Service generated from Calculate Density",outputLayerName:"${layername} Density",outputCellSize:"Output cell size (optional)",cellSizeHint:"Cell size",chooseCountField:"No count field",analysisLayerLabel:"Choose input point or line layer from which to calculate density"},
createViewshedRasterTool:{toolDefine:"Create areas that are visible from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"${layername} visible areas",outputAgLayerName:"${layername} height to become visible",itemDescription:"Analysis Image Service generated from Create Viewshed",itemTags:"Analysis Result, Create Viewshed, ${layername}",itemSnippet:"Analysis Image Service generated from Create Viewshed",elevationSurfaceLabel:"Elevation surface",inputObserverLabel:"Point feature that represent observer locations",
options:"Options",maxDistanceLabel:"Maximum viewing distance",minDistanceLabel:"Minimum viewing distance",observerEleLabel:"Elevation of observer locations",observerHghtLabel:"Height of observer",targetHghtLabel:"Height of target",resultAgLayer:"Output height to become visible (optional)",distance:"Distance",elevation:"Elevation",field:"Field",height:"Height",optimizeFor:"Optimize for",dist3D:"Distance is 3D",speed:"Speed",accuracy:"Accuracy",maxDistanceValidMsg:"The maximum viewing distance cannot be more than ${limit} ${units}.",
maxdistanceInValidMsg:"Only integer values are allowed",analysisLayerLabel:"Point features that represent observer locations"},interpolatePointsEBKTool:{toolDefine:"Interpolate values from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"${layername} Prediction",outputErrorLayerName:"${layername} Error",outputTableName:"${layername} Diag",interpolationMethod:"Interpolation method",optimizeFor:"Optimize for",selectAttributesLabel:"Choose field to interpolate",outputPredictionErrors:"Output prediction errors",
outputDiagnosticTable:"Output diagnostic table",choosePointLayer:"Choose point layer",itemDescription:"Analysis Raster Service generated from Interpolate Points",itemTags:"Analysis Result, Interpolate Points, ${layername}, ${fieldname}",itemSnippet:"Analysis Raster Service generated from Interpolate Points",speed:"Speed",accuracy:"Accuracy",options:"Options",optionalOutputs:"Optional outputs",outputCellsize:"Output cell size (optional)",enterDistance:"Enter distance",chooseField:"Choose field",transform:"Transform data to normal distribution",
sizeOfLocalModels:"Size of local models",numberOfNeighbors:"Number of neighbors",analysisLayerLabel:"Choose point layer containing locations with known values",sizeOfLocalModelsInValidMsg:"Size of local models must be in [30,500]",numberOfNeighborsInValidMsg:"Number of neighbors must be in [1,64]",cellsizeInValidMsg:"Cell Size must be \x3e 0"},analysisSettings:{overwriteResultLayer:"Overwrite result layer",closeAnalysisWisget:"Close analysis widget after running analysis",storeAnalysisResults:"Store feature analysis results as a Features",
analysisEnv:"Analysis Environments",CoordinateSys:"Coordinate Systems",outSR:"Output coordinate system",processSR:"Processing coordinate system",processExtent:"Processing Extent",extent:"Extent",defaultExtentLabel:"Same as input",extentSpecfiedBelow:"As specified",extentBelow:"As specified Below",xMin:"X min",xMax:"X max",yMin:"Y min",yMax:"Y max",rasterLabel:"Raster Analysis",cellSize:"Cell size",mask:"Mask",coordSysDialogTitle:"Coordinate System",geographicCS:"Geographic coordinate system",projCS:"Projected coordinate system",
spatiaReferences:"Spatial References",layers:"Layers",favorites:"Favorites",defaultLabel:"Default",extentAsDisplay:"Same as display",extentAsLayer:"Same as ${layername}",maxInputs:"Maximum of Inputs",minInputs:"Minimum of Inputs",extentUnion:"union of inputs",extentInter:"Intersection of inputs",snapRaster:"Snap Raster"},findOutliersTool:{chooseLayerLabel:"Choose the layer for which outliers will be calculated",chooseAttributeLabel:"Find outliers of",outputLayerName:"Find Outliers ${layername}",itemDescription:"Feature layer generated from running the Find Outliers solution.",
itemTags:"Analysis Result, Find Outliers, ${layername}, ${fieldname}",itemSnippet:"Feature layer generated from Find Outliers",cellSizeMsg:"Cell size should be less than distance band."},analysisMsgCodes:{RA_120101:"The following table contains cross validation statistics:",RA_120102:"Mean Error",RA_120103:"Root Mean Square",RA_120104:"Average Standard",RA_120105:"Mean Standardized",RA_120106:"Root Mean Square Standardized",SS_84493:"There was 1 outlier location; it was not used to compute ${AggregationType}.",
SS_84492:"The total study area was ${Area}.",SS_84491:"There were ${NumFeatures} valid input aggregation areas.",SS_84490:"The aggregation process resulted in ${AggNumFeatures} weighted areas.",SS_84489:"Analysis was performed on all aggregation areas.",SS_84485:"There were ${NumFeatures} valid input features.",SS_84477:"Blue output features represent cold spots where low ${FieldName} cluster.",SS_84476:"Red output features represent hot spots where high ${FieldName} cluster.",SS_84471:"Output",SS_84470:"There are ${NumSignificant} output features statistically significant based on a FDR correction for multiple testing and spatial dependence.",
SS_84466:"Hot Spot Analysis",SS_84465:"The optimal fixed distance band was based on one standard distance of the features from the geometric mean: ${DistanceInfo}.",SS_84464:"The optimal fixed distance band was based on the average distance to ${NumNeighs} nearest neighbors: ${DistanceInfo}.",SS_84461:"The optimal fixed distance band selected was based on peak clustering found at ${DistanceInfo}.",SS_84459:"Scale of Analysis",SS_84458:"Analysis was based on the number of points in each polygon cell.",
SS_84457:"Points were aggregated to the fishnet polygon cells falling within the bounding areas provided.",SS_84453:"Analysis was performed on all fishnet polygon cells within the bounding area layer.",SS_84452:"Analysis was performed on all fishnet polygon cells containing at least one point.",SS_84451:"Analysis was based on the number of points in each fishnet polygon cell.",SS_84450:"The polygon cell size was ${SnapInfo}.",SS_84449:"A fishnet polygon mesh was created for aggregating points.",SS_84446:"${VarName} Properties:",
SS_84444:"Incident Aggregation",SS_84437:"There were no locational outliers.",SS_84434:"There were ${NumOutliers} outlier locations; these were not used to compute ${AggregationType}.",SS_84428:"Initial Data Assessment.",SS_84271_0:"Min",SS_84272_0:"Max",SS_84261_0:"Mean",SS_84262_0:"Std. Dev.",SS_00002:"The following report outlines the workflow used to optimize your Find Hot Spots result:",AO_100001:"Aggregate Points failed.",AO_100002:"The geometry type of Point Layer must be points.",AO_100003:"The geometry type of  Polygon Layer must be polygons.",
AO_100004:"The field  ${fieldName} provided for Summary Fields does not exist.",AO_100005:"The field  ${fieldName} provided for Summary Fields is not numeric.",AO_100006:"The summary type ${summary} provided for field ${fieldName} is invalid.",AO_100007:"Find Hot Spots failed.",AO_100008:"The geometry type for the boundingPolygonLayer must be polygon.",AO_100009:"The geometry type of Analysis Layer must be points or polygons.",AO_100010:"The geometry type of Aggregation Polygon Layer must be polygon.",
AO_100011:"Must provide an Analysis Field for polygon Analysis Layer.",AO_100012:"Create Buffers failed.",AO_100013:"Overlay Layers failed.",AO_100014:"Summarize Within failed.",AO_100015:"The geometry type of Summarize Layer input must be point, line, or polygons.",AO_100016:"The geometry type of Summarize Layer input must be point or line.",AO_100017:"The geometry type of Summarize Layer input must be point.",AO_100018:"Sum Units ${sumUnits} is not applicable for ${shapeType} shape type.",AO_100019:"At least one of the parameters, Summarize Shape or  Summary Fields is required.",
AO_468:"Input shape types are not equal.",AO_1156:"A field value was incompatible with the field type.",AO_800:"The value is not a member of SUM | MEAN | MIN | MAX | RANGE | STD | COUNT | FIRST | LAST.",AO_728:"The analysisField ${fieldName} you specified does not exist in the analysisLayer.",AO_12:"Field to add already exists.",AO_539:"Expression is invalid.",AO_1115:"Layer description property must be set for ${layerName}.",AO_366:"Invalid geometry type.",AO_641:"This tool requires at least ${numFeatures} feature(s) to compute results.",
AO_906:"Zero variance: all of the values for your input field are likely the same.",AO_1533:"We were not able to compute hot and cold spots for the data provided. If appropriate, try specifying an Analysis Field.",AO_1534:"Hot and cold spots cannot be computed when the number of points in every polygon area is identical. Try different polygon areas or different analysis options.",AO_1535:"The analysis option you selected requires a minimum of ${minNumFeatures} aggregation areas.",AO_1536:"The analysis options you selected require a minimum of ${minNumIncidents} points to compute hot and cold spots.",
AO_1570:"The analysis option you selected requires a minimum of ${minNumIncidents} points to be inside the bounding polygon area(s).",AO_1571:"The analysis options you selected require a minimum of ${minNumFeatures} features with valid data in the analysis field in order to compute hot and cold spots.\t",AO_1572:"There is not enough variation in point locations to compute hot and cold spots. Coincident points, for example, reduce spatial variation. You can try providing a bounding area, aggregation areas (a minimum of 30), or an Analysis Field.",
AO_1573:"There is not enough variation among the points within the bounding polygon area(s). You can try providing larger boundaries.",AO_1574:"The analysis option you selected requires a minimum of ${minNumIncidents} points to be inside the aggregation polygons.",AO_1575:"All of the values for your analysis field are likely the same. Hot and cold spots cannot be computed when there is no variation in the field being analyzed.",AO_84426:"Must provide polygons for aggregating incidents into counts for this incident data aggregation method.",
AO_26:"Buffer distance is zero.",AO_109:"The buffer distance cannot be negative for lines and points.",AO_385:"The LINE option is not valid with point features.",AO_438:"Overlay not polygon.",AO_100020:"Enrich Layer failed.",AO_100021:"The geometry type of Input Layer must be point, line or polygon.",AO_100022:"Units ${units} is not supported for Buffer type ${bufferType}.",AO_100023:"Unable to enrich layer for input spatial reference ${spref}.",AO_100024:"The number of features in ${inputLayer} is zero.",
AO_100025:"Summarize Nearby failed.",AO_100026:"Extract Data failed.",AO_100027:"Dissolve Boundaries failed.",AO_100028:"Create Drive Time Areas failed.",AO_100029:"Merge Layers failed.",AO_100030:"Find Nearest failed.",AO_100031:"The number of nearest locations to find can not be greater than 100.",AO_100032:"The number of features in ${analysisLayer} is zero.",AO_100033:"The number of features in ${nearLayer} is zero.",AO_100034:"The number of features in ${analysisLayer} can not be greater than 1000.",
AO_100035:"The number of features in ${nearLayer} can not be greater than 1000.",AO_100036:"The ${analysisLayer} layer must have a point geometry type when using ${measurementType} as the measurement type.",AO_100037:"The ${nearLayer} layer must have a point geometry type when using ${measurementType} as the measurement type.",AO_100038:"The search cutoff cannot be less than zero.",AO_100039:"The ${inputLayer} must have a point geometry type.",AO_100040:"The number of features in ${inputLayer} can not be greater than ${max}.",
AO_100041:"Buffer type parameter is supported only for layers containing points or lines.",AO_100042:"The geometry type ${shapeType} of Nearby Layer is not supported for Near type ${nearType}",AO_100043:"Units ${units} is not supported for Near type ${nearType}.",AO_100044:"Distance value should be greater than 0",AO_100045:"Distance and units are required when Buffer type is specified",AO_100046:"Failed to access GeoEnrichment server.",AO_100047:"Enrichment may not be available for some features.",
AO_100048:"The input layer ${inputLayer} contains multipoint geometry and has been converted to single point geometry.",AO_100049:"No features in the processing extent for any input layers.",AO_100050:"No fields exist in the input layer for data extraction.",AO_100051:"No features in the processing extent for any input layers and none of the input layers have fields for data extraction. ",AO_100052:"The field name ${fieldName} does not exist in the ${paramName}.",AO_100053:"Required keys ${missingKeys} are missing in attribute expression ${expression}.",
AO_100054:"Required keys ${missingKeys} are missing in spatial relationship expression ${expression}.",AO_100055:"Invalid expression; malformed JSON.",AO_100056:"Invalid layer index in expression ${expression}.",AO_100057:"Layer index exceeds the number of input layers in expression ${expression}.",AO_100058:"${spatialRel} spatial relationship does not support ${lyrGeomType}/${selLyrGeomType} geometry types for layer/selectingLayer in expression ${expression}.",AO_100059:"Invalid spatial relationship {spatialRel} in expression ${expression}.",
AO_100060:"Query expression failed in expression ${expression}.",AO_100061:"FindExistingLocations failed.",AO_100062:"Invalid distance and/or units in expression ${expression}",AO_100063:"PlanRoutes failed.",AO_100064:"The number of features in ${stopsLayer} is zero.",AO_100065:"The number of features in ${startLayer} is zero.",AO_100066:"The maximum number of vehicles to route cannot be less than zero and greater than ${max}.",AO_100067:"The maximum number of stops per vehicle cannot be less than zero and greater than ${max}.",
AO_100068:"The number of features in ${stopsLayer} cannot be greater than ${max}.",AO_100069:"The number of features in ${startLayer} cannot be greater than ${max}.",AO_100070:"The number of features in ${endLayer} cannot be greater than ${max}.",AO_100071:"The ${stopsLayer} layer must have a point geometry type.",AO_100072:"The ${startLayer} layer must have a point geometry.",AO_100073:"The ${endLayer} layer must have a point geometry.",AO_100074:"The time spent at each stop cannot be less than zero.",
AO_100075:"The total route time per vehicle should be greater than zero and less than one year (525600 minutes).",AO_100076:"The ${endLayer} should not be specified if return to start is true.",AO_100077:"Find Similar Locations failed.",AO_100078:"Invalid field name in expression ${expression}",AO_100079:"Derive New Locations failed.",AO_100080:"Connect Origins To Destinations failed.",AO_100081:"Field Calculator failed.",AO_735:"Please provide at least one valid analysis field to base similarity on.",
AO_1589:"This tool requires a minimum of 2 locations to search.",AO_100082:"A field name and an expression are required.",AO_100083:"A field type is required for creating a new field.",AO_100084:"Field type is required to be String, Integer, Double or Date.",AO_1599:"Too few records for analysis. This tool requires at least 1 reference  location in the Input Layer to compute results.",AO_100088:"Field(s) ${attribute} must be in both the reference and candidate search layers.",AO_100089:"The following fields lack sufficient variation for use in this analysis: ${attribute}.",
AO_100090:"This tool requires at least 2 candidate search locations that are not also reference locations.",AO_100094:"The maximum number of vehicles to route must be equal to the number of features in ${startLayer}.",AO_100104:"InterpolatePoints failed.",AO_40039:"Not enough data to compute method. At least 10 points are required.",AO_40040:"Data is distributed along a straight line and cannot be processed.",AO_40069:"The variance of the data is too small to be calculated.",AO_100091:"The geometry type of ${paramName} must be Points",
AO_100092:"The geometry type of boundingPolygonLayer must be Polygons",AO_100093:"The classification type Manual requires classbreaks value.",AO_100095:"The number of features in ${endLayer} must be equal to the number of features in ${startLayer}.",AO_100096:"The ${startLayerRouteIDField} in ${startLayer} does not have unique values.",AO_100097:"The ${endLayerRouteIDField} in ${endLayer} does not have unique values.",AO_100098:"The values in ${startLayerRouteIDField} in ${startLayer} do not have a one-to-one match with the values in ${endLayerRouteIDField} in ${endLayer}.",
AO_100099:"All break values must be greater than zero.",AO_100100:"The features in ${inputLayer} are not within the data coverage area. See availability at ${url}.",AO_100101:"No features in ${inputLayer} are within a distance of ${max} kilometers from streets.",AO_100102:"All features in ${inputLayer} must be in the same time zone when using traffic and creating areas with dissolve or split options.",AO_100103:"The ${measureType} value cannot be greater than ${max} ${breakUnits}.",AO_100105:"CalculateDensity failed",
AO_100106:"Field ${fieldName} is not numeric.",AO_100107:"Field ${fieldName} does not have any positive values.",AO_100108:"Field ${fieldName} has negative values, only positive values will be considered for calculating density.",AO_100109:"The geometry type for the input layer must be points or lines.",AO_100110:"Your user role doesn't include the geoEnrichment privilege",AO_100111:"Your user role doesn't include the network analysis privilege",AO_100112:"Your user role doesn't include the publish hosted features privilege",
AO_100113:"None of the stops were assigned to any routes. Check the Status and Violated Constraints fields in the output unassigned stops layer for more information.",AO_100114:"The time spent at each stop, ${stopServiceTime} minutes, must be less than the total route time per vehicle, ${maxRouteTime} minutes.",AO_100115:"Some stops were not assigned to any routes. Check the Violated Constraints field in the output unassigned stops layer for more information.",AO_100116:"Only ${routesUsed} out of ${routeCount} routes are needed to reach all stops. If you want to use more routes, run Plan Routes again but reduce the limits on the maximum number of stops or the total route time per vehicle.",
AO_100117:"Driving a truck is currently not supported outside of North America and Central America.",AO_100118:"Your user role doesn't include the create, update and delete content privilege.",GPEXT_001:"Invalid parameter ${name} value",GPEXT_002:"Parameter missing ${name}",GPEXT_003:"Invalid parameter ${name}:property ${propname} is missing",GPEXT_004:"Invalid layer parameter property ${propname} is missing",GPEXT_005:"Failed to access url ${url}.",GPEXT_006:"Accessing url ${url} returned error ${error}.",
GPEXT_007:"Invalid item ${id}",GPEXT_008:"Failed to create service ${name}",GPEXT_009:"Failed to add layer ${lname} to service ${name}",GPEXT_010:"Failed to parse layer JSON",GPEXT_011:"Layer ${url} does not have Extract capability",GPEXT_012:"Invalid External Operation",GPEXT_013:"This tool uses the Geoenrichment Service.  Please refer to ArcGIS Online Service Credit Estimator for more details.",GPEXT_014:"This tool uses Network Analysis Services.  Please refer to ArcGIS Online Service Credit Estimator for more details.",
GPEXT_015:"Select appropriate helper services url from Portal for requested operation.",GPEXT_016:"Invalid layer object.",GPEXT_017:"Service ${name} already exists.",GPEXT_018:"Number of features in ${url} exceeds the limit of 100,000 features. Use a hosted feature layer as input to analyze large dataset.",GPEXT_019:"Invalid filter for layer ${url}.",SS_00003:"The following report outlines the summary of your Find Similar Locations result:",SS_00004:"The following report outlines the workflow used to optimize your Find Outliers result:",
SS_84698:"Using a hexagon of width ${HexWidth} and height ${HexHeight}",SS_84703:"The Neighborhood Distance used was ${NeiborDistance}.",SS_84705:"Creating the random reference distribution with ${NumPermutation} permutations.",SS_84708:"There are ${NumLowOutliers} statistically significant low outlier features.",SS_84709:"There are ${NumHighOutliers} statistically significant high outlier features.",SS_84710:"There are ${NumLowClusters} features part of statistically significant low clusters.",SS_84711:"There are ${NumHighClusters} features part of statistically significant high clusters.",
SS_84503:"Summary of Input Features to Match",SS_89997:'["Attribute", "Min", "Max", "SD", "Mean"]',SS_84504:"Summary of Attributes of Interest",SS_84512:'["Attribute", "Min", "Max", "SD", "Mean", "Input"]',SS_84505:"Top ${numResults} Most Similar Locations (Values)",SS_84506:" Top 10 of ${numResults} Most Similar Locations (Values)",SS_84510:'["OID", "SIMRANK", "SIMINDEX"]',SS_89998:' ["", "Total", ${sumIndex}] ',AO_100119:"The geometry type of WithinLayer input must be polygons",AO_100120:"The features in the layer are beyond max request size limit and cannot be enriched",
AO_100121:"CreateViewshed Failed",AO_100122:"TraceDownstream Failed",AO_100123:"CreateWatersheds Failed",AO_100124:"The geometry type of Input Layer must be point for buffer type ${bufferType}",AO_100125:"The groupby field ${fieldName} must be integers, text or date.",AO_100126:"The features in the input layer are beyond max request size and hence simplified",AO_100127:"All input points fall outside of the data coverage area.",AO_100128:"The point field provided must be string or integer",AO_100129:"The point falls outside the catchment extent",
AO_100130:"The point falls outside the processing unit extent",AO_100131:"The maximum viewing distance parameter cannot be more than ${max}${units}",AO_100132:"The DEM source data is not available in the input points area.",AO_100133:"The input DEM resolution is not supported at the specified maximum distance value. Specify a smaller maximum distance value.",AO_100136:"The geometry type for Extent Layer must be polygon.",AO_100137:"A value for the  ${parameterName} is required.",AO_100138:"Some origins were not connected to their paired destinations. Check the Status field in output unassigned origins and unassigned destinations layers for more information.",
AO_100139:"None of the origins could be connected to destinations.",AO_100140:"The features in the Extent Layer are beyond max request size and hence simplified.",AO_100141:"The features in the Extent Layer are beyond max request size limit and cannot be extracted.",AO_100142:"The extent of the input point features exceeds the allowed maximum extent.",AO_100143:"Your user role doesn't include the elevation analysis privilege.",AO_100144:"The ${serviceName} utility is not registered for the portal.",
AO_100145:"The following travel mode is invalid: ${travelMode}.",AO_100146:"The chosen break units, ${breakUnits}, and travel mode, ${travelMode}, are incompatible. They are not mutually time or distance values.",AO_100147:"The travel mode does not specify a time-based impedance attribute.",AO_100148:"You do not have permissions to access the utility ${serviceName}",AO_100149:"Unable to access registered url for utility ${serviceName}: ${msg}",AO_100150:"Choose Best Facilities failed.",AO_100151:"The chosen travel range units, ${travelRangeUnits}, and travel mode, ${travelMode}, are incompatible. They are not mutually time or distance values.",
AO_100152:"The combined count of features in ${requiredFacilitiesLayer} and ${candidateFacilitiesLayer} cannot be greater than ${max}.",AO_100153:"The value for the ${paramName} parameter must be greater than zero.",AO_100154:"Either specify a value for ${paramName1} or ${paramName2} parameter.",AO_100155:"The candidate facilities layer, ${candidateFacilitiesLayer}, should not be specified for Allocate goal.",AO_100156:"The percentage of demand to cover must be greater than zero and less than or equal to one hundred.",
AO_100157:"The number of candidates to choose cannot be less than the number of features in the required facilities layer.",AO_100158:"The number of candidates to choose cannot be greater than ${max}.",AO_100159:"The number of datacollections is greater than the max limit of ${maxDataCollections}.",BD_109:"Buffer distance cannot be negative for lines and points.",BD_101018:"One or more features were skipped because a negative or very small distance resulted in no geometry.",BD_110047:"The value for the Time Step Interval parameter must be positive and greater than zero.",
BD_110064:"Failed to create the Output Space Time Cube due to the Summary Field ${variableName}. Reconsider the chosen Statistic and Fill Type for this field.",BD_800:"The value is not a member of ${value}.",BD_101010:"The result of your analysis did not return any features. No layer will be created.",BD_101000:"Unable to perform query operation.",BD_101008:"Field '${requiredField}' is required.",BD_101001:"This operation requires time to be set on the source features, missing in '${paramName}'.",
BD_101028:"Starting new distributed job with ${totalTasks} tasks.",BD_101002:"This operation requires geometry to be set on the source features, missing in '${paramName}'.",BD_101003:"The distance interval type is not supported.",BD_101039:"The input ${paramName} is in a geographic coordinate system, but this operation requires a projected coordinate system. Please use a projected dataset or set the processing coordinate system for analysis to be a projected coordinate system.",BD_101004:"The given feature relationship '${targetType} ${relationshipType} ${joinType}' is not valid.",
BD_101005:"Field '${requiredField}' is required if '${setField}' is set.",BD_101006:"The time interval type is not supported. Only whole numbers are allowed.",BD_101007:"At least one relationship is required.",BD_101009:"Field(s) not found in dataset: ${fields}",BD_101011:"One of either '${firstField}' or '${secondField}' is required.",BD_101012:"Both '${firstField}' and '${secondField}' cannot be set at the same time.",BD_101013:"Wrong time type for '${paramName}'. Expected '${expectedType}', got '${actualType}'.",
BD_101014:"The given spatial relationship '${targetGeometryType} ${relationshipType} ${joinGeometryType}' is not valid.",BD_101015:"The set of relationships defined is not valid.",BD_101016:"A spatial reference is required when the GEODESIC option is selected.",BD_101017:"Some planar buffer results may exceed valid extent. Consider using a geodesic buffer to account for the shape of the earth.",BD_26:"Buffer distance is zero.",BD_101019:"One or more features were skipped because of a zero distance field value.",
BD_101020:"One or more features were skipped because of a NULL or EMPTY distance field value.",BD_101021:"One or more features were skipped because of an invalid buffer distance field value.",BD_101031:"Job has been cancelled.",BD_101022:"One or more features were skipped because of a non-linear buffer distance field value.",BD_101023:"One or more features were skipped because the buffer distance type is invalid.",BD_101024:"Using geodesic method for geographic coordinate system.",BD_101025:"Invalid buffer expression.",
BD_308:"Invalid field type.",BD_101026:"Parameter '${paramName}' is not valid.",BD_101027:"'${outputName}' is not a valid output name.",BD_101029:"${completedTasks}/${totalTasks} distributed tasks completed.",BD_101030:"Failed to execute ${toolName}. Please contact your administrator with job ID '${jobID}'.",BD_101032:"Value '${paramValue}' in parameter '${paramName}' does not fall within the valid range [${expectedRange}]",BD_101033:"'${paramName}' will be projected into the processing spatial reference.",
BD_101034:"'${paramName}' does not have a spatial reference and could not be projected to the processing spatial reference.",BD_101035:"'${paramName}' will be limited to the output extent.",BD_101036:"The '${statistic}' statistic is not valid for field '${fieldName}'.",BD_101037:"Neighborhood size must be greater than bin size.",BD_101038:"An error occurred while returning the result, however, the result should still be available in your Portal.",BD_110004:"A Space Time Cube must have at least 10 time slices.",
BD_641:"Too few records for analysis. This tool requires at least ${minFeatures} feature(s) to compute results.",BD_1022:"This tool requires a projected coordinate system.",BD_110005:"This Space Time cube cannot be created because it would have more than the maximum two billion bins.",BD_101041:"Failed to connect to data store. Please verify that the connection info is correct.",BD_101053:"Some records have time values that are not of type ${timeType}.",BD_101060:"There were ${numErrors} time steps that could not be calculated. The first ${numDisplay} errors have been displayed.",
BD_100090:"This tool requires at least 2 candidate search locations that are not also reference locations.",BD_84505:"Top '${numResults}' Most Similar Locations (Values).",BD_101057:"Unable to start distributed job. Please check your GeoAnalyticsTools service settings and ensure that there are enough resources available for the job to run.",BD_101046:"No results to return. Specify the number of results.",BD_84504:"Summary of Attributes of Interest,",BD_89997:'["Attribute", "Min", "Max", "SD", "Mean"].',
BD_3:"The following report outlines the summary of your Find Similar Locations result.",BD_101042:"Unable to access file share. Please verify that your ArcGIS Server user account has access to the file share.",BD_1599:"Too few records for analysis. This tool requires at least 1 reference location in the Input Layer to compute results.",BD_101052:"Some records have either missing or invalid time values.",BD_101063:"There is zero variance. All of the values for your input field are likely the same.",
BD_100084:"Field type is required to be String, Integer, Double or Date.",BD_101061:"The time step from ${startTime} to ${endTime} has too few records for analysis. Each time step requires at least ${minFeatures} feature(s) to compute results.",BD_101045:"You must provide at least two Attributes Of Interest for the Attribute Profile Match Method.",BD_100089:"The following fields lack sufficient variation for use in this analysis: ${attribute}.",BD_84506:"Top 10 of '${numResults}' Most Similar Locations (Values).",
BD_101049:"The number of results requested is greater than the number of results returned.",BD_84503:"Summary of Input Features to Match,",BD_101056:"Invalid summary shape unit ${unit} for geometry ${geomType}.",BD_84510:'["OID", "SIMRANK", "SIMINDEX"]',BD_101059:"No time steps could be calculated.",BD_84512:'["Attribute", "Min", "Max", "SD", "Mean", "Input"].',BD_101048:"Attributes of Interest has duplicates.",BD_1589:"Too few records for analysis. This tool requires at least 2 Candidate Features to compute results.",
BD_101062:"The time step from ${startTime} to ${endTime} has zero variance. All of the values for your input field in this time step are likely the same.",BD_101055:"Some records have geometries that are not of type ${geometryType}.",BD_101040:"A web layer named '${outputName}' already exists. Please choose a different name that is unique within your organization.",BD_100088:'Field(s) "${attribute}" must be in both the reference and candidate search layers.',BD_101050:"Selected attributes of interest field type is required to be Integer, Double.",
BD_101044:"${attribute}, ${min}, ${max}, ${sd}, ${mean}, ${input}.",BD_101054:"Some records have either missing or invalid geometries.",BD_101058:"Analysis requires more memory than is allocated. Please increase the memory allocated to your GeoAnalytics toolbox in ArcGIS Server Manager.",BD_100082:"A field name and an expression are required.",BD_89998:'["", "Total", ${sumIndex}]',BD_101047:"Number of results must be greater than 0.",BD_101051:"Possible issues were found while reading '${paramName}'.",
BD_101043:"${attribute}, ${min}, ${max}, ${sd}, ${mean}.",AO_100160:"Some of the features have invalid geometry and have been removed from the result",AO_100161:"Batch Geocode failed.",AO_100162:"Analyze Geocode Input failed.",AO_100163:"Your text qualifier is invalid.",AO_100164:"You must enter either inputTable, inputFileItem or columnNames. All three cannot be empty.",AO_100165:"If your header row does not exist, you must enter columnNames.",AO_100166:"If your fileType is table, then you must enter an inputTable.",
AO_100167:"CSV Collection is not a supported input type. Please input a CSV or Microsoft Excel spreadsheet.",AO_100168:"Your filename or extension is too long.",AO_100169:"Your zip file cannot be opened.",AO_100170:"There is no file of the specified format in your zip file.",AO_100171:"Invalid geocodeServiceURL.",AO_100172:"The Geoprocessing service and Geocoding service must have the same level of security on the same federated server.",AO_100173:"The user does not have geocoding privileges.",AO_100174:"The geocoding service must be on a federated server.",
AO_100175:"Invalid token.",AO_100176:"Your file has a corrupt or empty header.",AO_100177:"Your Excel file is corrupted and cannot be opened.",AO_100178:"Your file's first row is empty. Please edit your file and resubmit.",AO_100179:"You must define column widths if your file is fixed width.",AO_100180:"Your column widths must be integers separated by commas like so: 5,7,13.",AO_100181:"The file's header row could not be parsed.",AO_100182:"Field ${field} could map to 2 possible alias fields ${field_one} and ${field_two}.",
AO_100183:"Field mapping entered in an incorrect format.",AO_100184:"Incorrect outputFields. Enter outputFields like so: x,y,score,match_addr.",AO_100185:"chars_per_row must be an integer.",AO_100186:"Incorrect widths_of_cols. Enter widths_of_cols like so: 10,15,6.",AO_100187:"Your outputName must be blank to get out a Feature Collection.",AO_100188:"Your outputName cannot be empty.",AO_100189:"Incorrect geocodeServiceURL, verify that the geocoding service is online and has a valid geocodeAddresses REST endpoint.",
AO_100190:"There were more lines read than there are lines. Check your header_rows_to_skip parameter.",AO_100191:"Unable to write header: check to see if your headerRowsToSkip is incorrect or if the geocoding service is down.",AO_100192:"If your header row exists, you must provide the headerRowsToSkip.",AO_100193:"Your headerRowsToSkip must be a positive number less than the number of rows in the inputTable or inputFileItem.",AO_100194:"Results file is being edited by another program.",AO_100195:"File entered was empty, returning an empty file.",
AO_100196:"Field mapping must be a list of lists.",AO_100197:"Your geocodingServiceURL may be incorrect, it does not have a maxBatchSize on the info page.",AO_100198:"Edit your field mapping and resubmit, none of your fields are mapped to valid locator fields.",AO_100199:"Edit your field mapping and resubmit, your mapping includes a locator field that is not supported.",AO_100200:"Edit your field mapping and resubmit, your mapping includes an unsupported locator field. Supported locator fields are ${supported_fields}.",
AO_100201:"Your field_mapping includes an input field ${field} not present in your input file: ${supported_fields}.",AO_100202:"Could not make a REST request from the server machine verify that the server machine can connect to the internet.",AO_100203:"The geocodeServiceURL entered should be https instead of http.",AO_100204:"The inputTable has over 100,000 records and is not supported.",AO_100205:"Your column delimiter is invalid.",AO_100206:"Create Replica failed for the Url(s): ${failedUrls}",
AO_100207:"The total number of input fields and enrichment variables exceed the maximum limitation of ${maxCountOfFields}",AO_100208:"Your header row is not the same length as the number of lists in your field mapping.",AO_100209:"Your headerRowsToSkip must be a positive number less than the number of rows in the inputTable or inputFileItem.",AO_100210:"Your input file has too many rows. xls only supports up to 65536 rows. Please submit a different outputType.",AO_100211:"Create Route Layers failed.",
AO_100212:"Input route data file is not a valid zip file.",AO_100213:"Input route data does not contain the required Stops feature class.",AO_100214:"Input route data does not contain at least two stops.",AO_100215:"JoinFeatures failed.",AO_100216:"Find Outliers failed.",AO_100217:"Failed to save the result as route layers since the analysis did not produce any routes.",AO_100218:"RouteLayers is not a valid value for outputType when measurementType is StraightLine.",AO_192:"Cell size should be smaller than Distance Band.",
AO_100219:"Invalid input for parameter ${paramName}",AO_100220:"The geometry type ${geomType} for ${paramName} is not supported for spatial relationship: ${spatialRel}.",AO_100221:"Attribute or Spatial Relationship must be specified.",AO_100222:"Spatial relationship is not supported for table inputs."},geoenrichment:{task:{GeoenrichmentTask:{noData:"There is no data for the selected area"}},dijit:{AgePyramid:{maxLabel:"The largest group:",minLabel:"The smallest group:",compLabel:"Dots show comparison to",
menLabel:"Men",womenLabel:"Women"},BufferOptions:{studyArea:"Show data for:",ring:"Ring",driveTime:"Drive Times",driveDistance:"Drive Distance",radius:"Radius:",time:"Time:",distance:"Distance:",buffer:"Buffer:",units:{esriDriveTimeUnitsMinutes:"minutes",esriMiles:"miles",esriKilometers:"kilometers",esriFeet:"feet",esriMeters:"meters"}},bufferTitle:{pointRing:{esriFeet:"${radius}-feet ring",esriKilometers:"${radius}-km ring",esriMeters:"${radius}-meter ring",esriMiles:"${radius}-mile ring"},pointDriveTime:{esriFeet:"${radius}-feet drive distance",
esriKilometers:"${radius}-km drive distance",esriMeters:"${radius}-meter drive distance",esriMiles:"${radius}-mile drive distance",esriDriveTimeUnitsMinutes:"${radius}-minute drive time"},lineBuffer:{esriFeet:"${radius}-feet buffer",esriKilometers:"${radius}-km buffer",esriMeters:"${radius}-meter buffer",esriMiles:"${radius}-mile buffer"},polygon:"This area",stdGeo:"Intersecting ${level} feature"},VariableStore:{global:"Global",number:"#",percent:"%",average:"Avg",index:"Index",reliability:"Reliability"},
DataCategoriesPage:{loading:"Loading...",search:"Search for a variable name",noResults:"No results found for '${seachKey}'.",showFavorites:"Show Favorite Variables",allHierarchies:"All Data",hierarchy_census:"Standard Data",hierarchy_landscape:"Landscape Data",premiumHierarchy:"${name} Data"},DataCollectionsPage:{categoryName:"${categoryName} Variables",mapPopVar:"Choose a Popular Variable",keepBrowse:"Keep Browsing",showAll:"Show all ${categoryName} Variables",noResults:"No results found for '${seachKey}'.",
search:"Search within the current category"},DataVariablesPage:{allVariablesTitle:"All Variables",favoriteVariablesTitle:"Favorite Variables",groupVariables:"${groupName} variables",searchVariables:"'${searchKey}' variables",allVariables:"All variables",searchInGroupVariables:"'${searchKey}' variables from ${groupName}",favoriteVariables:"Favorite variables"},ShoppingCart:{selectedVars:"Selected Variables",noVariables:"No variables have yet been selected"},VariableInfo:{name:"Name",variable:"Variable",
source:"Source",vintage:"Vintage"},EnrichOptionsPage:{bufferRing:"1 mile circle around locations",bufferPolygon:"input polygons (buffer unavailable)",selectedVariables:"Selected Variables:",customize:"customize",bufferOptions:"Show data for:",edit:"edit",totalVars:"Total Variables: ${varCount} (${credits})",varsPerRow:"Variables per Row: ${varCount} (${credits})",credits:"${credits} credits",creditsCalc:"calculating...",totalVarsTooltip:"This operation will enrich ${rowCount} rows with ${varCount} variables and will cost ${credits}.",
varsPerRowTooltip:"This operation will enrich each row with ${varCount} variables and will cost ${credits} per row.",overwriteExisting:"Existing column values will be overwritten",varName:"Variable Name",column:"Column",newColumn:"\x3cCreate New\x3e",noColumn:"\x3cNone\x3e",back:"Back",finish:"Add data to system"},InfographicsMainPage:{mainTitle:"Configure Infographics",loading:"Loading...",chooseCountry:"Show available data for: ",chooseDataCollection:"Choose from popular data collections: ",chooseTheme:"Select color theme:",
dark:"Dark",light:"Light",addVariables:"Add more variables...",ok:"OK",add:"Add",cancel:"Cancel"},OneVar:{subtitleSite2:"for this area ",subtitleVar2:"${alias} is ",lessThan:"which is less than the average for ${site}",moreThan:"which is more than the average for ${site}",same:"which is the same as the average for ${site}",areaCol:"Area",valueCol:"Value"},RelatedVariables:{highLabel2:"The largest group: ${alias}",lowLabel2:"The smallest group: ${alias}",indicatorCol:"Indicator",valueCol:"Value",difCol:"Difference",
chartLabel:"Bars show deviation from"},Tapestry:{hhTypeLabel:"Household Type:",medianAgeLabel:"Median Age:",incomeLabel:"Income:",employmentLabel:"Employment:",educationLabel:"Education:",residentialLabel:"Residential:",raceEthnicityLabel:"Race / Ethnicity:",hhLabel:"households",adultsLabel:"adults",prtHhLabel:"of Households"},WizardButtons:{back:"Back",ok:"OK",apply:"Apply",cancel:"Cancel",next:"Next"},EnrichConfig:{title:"Enrich Layer"},DataBrowser:{title:"Data Browser"}}},filterDlg:{expressionTemplate:"${field_dropdown} ${operator_dropdown} ${values_input}",
filter:"Filter",applyFilter:"Apply Filter",applyFilterBtn:"Apply Filter",removeFilterBtn:"Remove Filter",view:"View",change:"Change",edit:"Edit",create:"Create",match1Msg:"Display features in the layer that match the following expression",matchMsg:"Display features in the layer that match ${any_or_all} of the following expressions",matchMsgSet:"${any_or_all} of the following expressions in this set are true",all:"All",any:"Any",andBetweenValues:"and",and:"and",or:"or",friendlyAnd:"All of these expressions must be true:",
friendlyOr:"Any of these expressions must be true:",friendlyDatePattern:"MM/dd/yyyy",addAnotherExpression:"Add another expression",addSet:"Add a set",askForValues:"Ask for values",value:"Value",valueTooltip:"Enter value",field:"Field",fieldTooltip:"Pick from existing field",uniqueValues:"Unique",uniqueValueTooltip:"Pick from unique values in selected field",toThisLayer:"To this layer",toNewLayer:"To a new layer",newLayerName:"New layer name",showFilterExpression:"Show filter's expressions",deleteExpression:"Delete this expression",
deleteSet:"Delete this set",addExpression:"Add an expression to this set",addSetTooltip:"Add a set to contain expressions",promptMsg:"Provide a prompt and some hint text to present this filter interactively to others",prompt:"Prompt",hint:"Hint",stringOperatorIs:"is",stringOperatorIsNot:"is not",stringOperatorStartsWith:"starts with",stringOperatorEndsWith:"ends with",stringOperatorContains:"contains",stringOperatorDoesNotContain:"does not contain",stringOperatorIsBlank:"is blank",stringOperatorIsNotBlank:"is not blank",
dateOperatorIsOn:"is on",dateOperatorIsNotOn:"is not on",dateOperatorIsBefore:"is before",dateOperatorIsAfter:"is after",dateOperatorDays:"days",dateOperatorWeeks:"weeks",dateOperatorMonths:"months",dateOperatorInTheLast:"in the last",dateOperatorNotInTheLast:"not in the last",dateOperatorIsBetween:"is between",dateOperatorIsNotBetween:"is not between",dateOperatorIsBlank:"is blank",dateOperatorIsNotBlank:"is not blank",numberOperatorIs:"is",numberOperatorIsNot:"is not",numberOperatorIsAtLeast:"is at least",
numberOperatorIsLessThan:"is less than",numberOperatorIsAtMost:"is at most",numberOperatorIsGreaterThan:"is greater than",numberOperatorIsBetween:"is between",numberOperatorIsNotBetween:"is not between",numberOperatorIsBlank:"is blank",numberOperatorIsNotBlank:"is not blank",emptyString:"empty string",error:{noUniqueValues:"The specified field has has no values.",generateRendererFailed:"Unique values could not be determined for the selected field.",missingValue:"there's a missing value in one of the expressions",
cantParseExpression:"Filter cannot be shown because one or more of its expressions cannot be parsed. To edit the filter expressions, clear the filter and create a new filter interactively."}},calculateFields:{addFieldTitle:"Add Field",nameLabel:"Name:",aliasLabel:"Alias:",typeLabel:"Type:",lengthLabel:"Length:",defaultValueLabel:"Default Value:",optional:"(Optional)",stringLabel:"String",integerLabel:"Integer",doubleLabel:"Double",dateLabel:"Date",expBuilderTitle:"Expression Builder",operators:"Operators",
availableFields:"Available Fields",helpers:"Helpers",functions:"Functions",numeric:"Numeric",clear:"Clear",validate:"Validate",addNewField:"Add New Field",add:"Add",close:"Close",calculate:"Calculate",deleteLabel:"Delete",exprLabel:"${fieldName} \x3d",layerReqMsg:"A layer is required parameter for calculate field",fieldReqMsg:"A calculate field has not been provided",lyrSupportCalMsg:"This layer ${layername} does not support calculate fields",lyrUpdateCapMsg:"Either update capability is not enabled on the layer ${layername} or, you do not have access to update features on this layer",
selectCalField:"Choose field to calculate:",firstOperatorMsg:"Operator '${operator}' cannot start an expression",completeHelperMsg:"Complete the helper method added previously",successMsg:"Successfully updated ${count} features ",deleteField:"Delete Field",deleteFieldConfirm:"Are you sure you want to delete '${field}' field from this layer?",fields:"Fields",exprFailedMsg:"Calculate for the expression '${expr}' failed.",inValidFielNameCharMsg:"The field name contains one or more invalid characters \x3cbr/\x3e(`~@#$%^\x26*()-+\x3d|\\\x3c\x3e?/{.!'[]:\n\r).",
inValidFieldStartCharMsg:"The field name cannot start with one of these invalid characters \x3cbr/\x3e(`~@#$%^\x26*()-+\x3d|\\\x3c\x3e?/{}.!'[]:;\n\r_012356789).",invalidSqlkeywordsMsg:"The field name cannot be the same as an SQL keyword.",invalidExpression:"The calculate expression is not valid",validExpression:"The expression was successfully verified.",sameFielNameMsg:"The field name cannot be same as an existing field name",invalidFieldLengthMsg:"The field name length should be less than 128 characters.",
errorCodes:{3001:"Sql expression is not supported.",3002:"Sql expression syntax error.",3004:"Sql expression semantic error.",3007:"Invalid table name ${tableName}.",3008:"Invalid field name ${fieldName}.",3009:"Unsafe sql expression is not allowed."},absFunc:"${functionName}: Returns the absolute (positive) value of ${num}.",castFunc:"${functionName}: Converts a ${num} to a different type. FLOAT converts ${num} to a double and INT converts to an integer.",ceilingFunc:"${functionName}: Returns the smallest integer greater than or equal to  ${num}.",
cosFunc:"${functionName}: Returns the trigonometric cosine of ${num}. ${num} is assumed to be an angle in radians.",floorFunc:"${functionName}: Returns the largest integer that is less than or equal to ${num}.",logFunc:"${functionName}: Returns the natural logarithm (base E) of ${num}.",log10Func:"${functionName}: Returns the base-10 logarithm of ${num}.",modFunc:"${functionName}: Returns the remainder after the division of n is performed on ${num}. Both ${n} and ${num} must be integer.",powerFunc:"${functionName}: Returns the value of ${num} raised to the specified power ${y}.",
roundFunc:"${functionName}: Rounds ${num} to the specified ${length}.",sinFunc:"${functionName}: Returns the trigonometric sine of ${num}. ${num} is assumed to be an angle in radians.",tanFunc:"${functionName}: Returns the tangent of ${num}. ${num} is assumed to be an angle in radians.",truncateFunc:"${functionName}: Truncates ${num} at the specified ${decimal_place}. A positive ${decimal_place} truncates while a negative ${decimal_place} rounds.",nullifFunc:"${functionName}: Returns null if ${num} equals ${value}. Commonly used to prevent divide-by-zero errors by setting ${value} to 0.",
char_lengthFunc:"${functionName}: Returns the number of characters in ${str}. The result is an integer.",concatFunc:"${functionName}: Concatenates two strings.",positionFunc:"${functionName}: Returns the position of the first occurrence of substring in ${str}. If substring is not found, the result is 0.",lowerFunc:"${functionName}: Returns a string where all characters in ${str} are converted to lowercase.",substringFunc:"${functionName}: Returns a part of ${str}. ${start} is an integer index specifying where the returned characters start. ${length} is the number of characters to be returned.",
trimFunc:"${functionName}: Returns a string where all leading or trailing spaces are removed from ${str}.",upperFunc:"${functionName}: Returns a string where all characters in ${str} are converted to uppercase.",current_dateFunc:"${functionName}: Returns the current date.",current_timeFunc:"${functionName}: Returns the current time (hours, minutes, seconds).",current_timestampFunc:"${functionName}: Returns the current time (hours, minutes, seconds, milliseconds).",asMetersFunc:"${functionName}: Applies the calculation assuming the value of ${num} is in meters.",
asKilometersFunc:"${functionName}: Applies the calculation assuming the value of ${num} is in kilometers.",asFeetFunc:"${functionName}: Applies the calculation assuming the value of ${num} is in feet.",asYardsFunc:"${functionName}: Applies the calculation assuming the value of ${num} is in yards.",asMilesFunc:"${functionName}: Applies the calculation assuming the value of ${num} is in miles.",asNuaticalMilesFunc:"${functionName}: Applies the calculation assuming the value of ${num} is in nautical miles.",
squareRootFunc:"${functionName}: Returns the square root of ${num}.",minFunc:"${functionName}: Returns the lowest valued ${num} in the array.",maxFunc:"${functionName}: Returns the highest valued ${num} in the array.",constrainFunc:"${functionName}: Returns the input value if it's within the constraining bounds. If the value is less than ${low}, it returns ${low}, if the value is greater than ${high} it returns the ${high} value.",iffFunc:"${functionName}: Returns one value if a condition evaluates to True, and another value if that condition evaluates to False",
whenFunc:"${functionName}: Evaluates a series of expressions in turn, until one evaluates to true.",decodeFunc:"${functionName}: Evaluates an expression, and then compares its value with subsequent parameters. If the expression matches it returns the next parameter value. If none match, there is the option for the last parameter to be a default return value.",extractFunc:"${functionName}: Returns a single part of a date/time, such as year, month, day, hour, minute, etc."},smartMapping:{other:"Other",
minToMax:"to",sumOfCategories:"Sum of categories",predominantCategory:"Predominant category",strengthOfPredominance:"Strength of predominance",ageInfo_years:"Age, in years, from ${startTime} to ${endTime}",ageInfo_months:"Age, in months, from ${startTime} to ${endTime}",ageInfo_days:"Age, in days, from ${startTime} to ${endTime}",ageInfo_hours:"Age, in hours, from ${startTime} to ${endTime}",ageInfo_minutes:"Age, in minutes, from ${startTime} to ${endTime}",ageInfo_seconds:"Age, in seconds, from ${startTime} to ${endTime}"},
networkAnalysis:{enums:{esriNAObjectStatus:{esriNAObjectStatusOK:"OK",esriNAObjectStatusNotLocated:"Not Located on Network",esriNAObjectStatusElementNotLocated:"Network Unbuilt",esriNAObjectStatusElementNotTraversable:"Prohibited Street",esriNAObjectStatusInvalidFieldValues:"Invalid Field Values",esriNAObjectStatusNotReached:"Cannot Reach",esriNAObjectStatusTimeWindowViolation:"Time Window Violation"},esriNACurbApproachType:{esriNAEitherSideOfVehicle:"Either side",esriNARightSideOfVehicle:"From the right",
esriNALeftSideOfVehicle:"From the left",esriNANoUTurn:"Depart in the same direction"},esriNALocationType:{stop:"Stop",waypoint:"Waypoint"},esriDirectionsManeuverType:{esriDMTBearLeft:"Bear left",esriDMTBearRight:"Bear right",esriDMTDepart:"Depart stop",esriDMTDoorPassage:"Door passage",esriDMTElevator:"Elevator",esriDMTEndOfFerry:"End of ferry",esriDMTEscalator:"Escalator",esriDMTFerry:"Take ferry",esriDMTForkCenter:"At fork keep center",esriDMTForkLeft:"At fork keep left",esriDMTForkRight:"At fork keep right",
esriDMTHighwayChange:"Go on another highway",esriDMTHighwayExit:"Exit highway",esriDMTHighwayMerge:"Merge to highway",esriDMTPedestrianRamp:"Pedestrian ramp",esriDMTRampLeft:"Ramp left",esriDMTRampRight:"Ramp right",esriDMTRoundabout:"Take roundabout",esriDMTSharpLeft:"Make sharp left",esriDMTSharpRight:"Make sharp right",esriDMTStairs:"Stairs",esriDMTStop:"Arrive at stop",esriDMTStraight:"Go straight",esriDMTTripItem:"Trip planning item",esriDMTTurnLeft:"Turn left",esriDMTTurnLeftLeft:"Turn left and immediately turn left",
esriDMTTurnLeftRight:"Turn left and immediately turn right",esriDMTTurnRight:"Turn right",esriDMTTurnRightLeft:"Turn right and immediately turn left",esriDMTTurnRightRight:"Turn right and immediately turn right",esriDMTUnknown:"Unknown",esriDMTUTurn:"Make U-turn"},esriNABarrierType:{esriNABTRestriction:"Restriction",esriNABTScaledCost:"Scaled Cost",esriNABTAddedCost:"Added Cost"},esriNAIntYesNo:{No:"No",Yes:"Yes"}},fields:{RouteId:"Route ID",stops:{CurbApproach:"Curb Approach",ArrivalCurbApproach:"Arrival Curb Approach",
DepartureCurbApproach:"Departure Curb Approach",Name:"Name",Sequence:"Sequence",Status:"Status",LocationType:"Location Type",TimeWindowStart:"Time Window Start",TimeWindowEnd:"Time Window End",ArrivalTime:"Arrival Time",DepartureTime:"Departure Time",ArrivalUTCOffset:"Arrival Time: Offset from UTC in Minutes",DepartureUTCOffset:"Departure Time: Offset from UTC in Minutes",ServiceMinutes:"Service Minutes",ServiceMeters:"Service Meters",ServiceCosts:"Service Costs",CumulativeMinutes:"Cumulative Minutes",
CumulativeMeters:"Cumulative Meters",CumulativeCosts:"Cumulative Costs",LateMinutes:"Minutes Late",WaitMinutes:"Minutes Early",Properties:"Additional Properties"},directions:{Sequence:"Sequence",StopSequence:"Sequence of Associated Stop",ArrivalTime:"Maneuver Starts at",UTCOffset:"Offset from UTC in Minutes",ManeuverType:"Maneuver",Meters:"Length in Meters",Minutes:"Duration in Minutes",DirectionText:"Direction Text",ManeuverMessages:"Maneuver Messages"},directionEvents:{DirectionSequence:"Direction Sequence",
Sequence:"Sequence",ArrivalTime:"Event Time",UTCOffset:"Offset from UTC in Minutes",EventText:"Event Text",EventMessages:"Event Messages"},barriers:{BarrierType:"Barrier Type",FullEdge:"Affects Entire Street Segment",AddedCost:"Added Cost",Costs:"Costs",Status:"Status",CurbApproach:"Curb Approach",Name:"Name"},polylineBarriers:{BarrierType:"Barrier Type",ScaleCost:"Scale Factor",Costs:"Costs",Name:"Name"},polygonBarriers:{BarrierType:"Barrier Type",ScaleCost:"Scale Factor",Costs:"Costs",Name:"Name"},
routeInfo:{Version:"Version",RouteName:"Route Name",TotalMinutes:"Total Minutes",TotalMeters:"Total Meters",TotalLateMinutes:"Total Late Minutes",TotalWaitMinutes:"Total Wait Minutes",TotalCosts:"Total Costs",StartTime:"Start Time",StartUTCOffset:"Start Time: Offset from UTC in Minutes",EndTime:"End Time",EndUTCOffset:"End Time: Offset from UTC in Minutes",Messages:"Analysis Messages",AnalysisSettings:"Analysis Settings",Properties:"Additional Properties"}},sharing:{stopsLayer:"Stops",directionsLayer:"Directions",
directionEventsLayer:"Direction Events",barriersLayer:"Barriers",polylineBarriersLayer:"Line Barriers",polygonBarriersLayer:"Polygon Barriers",routeInfoLayer:"Route Details",itemDescription:"Add an in-depth description of the item.",itemTags:"route, route layer",itemSnippet:"Route and directions for",rootFolder:"Home",Minutes:"minutes",Meters:"meters",Miles:"miles",StartTime:"Route start time:",costAttributeMissing:"Loaded Route Layer does not match the Route Service: cost attribute is missing.",
differentVersion:"A newer version of Route Layer is detected, not all data could have been loaded."}},browseLayersDlg:{browseTitle:"Browse Living Atlas Layers",categoryAll:"All Categories",categoryImagery:"Imagery",subCategoryBasemapImagery:"Basemap Imagery",subCategoryMultiSpectral:"Multispectral Imagery",subCategoryTemporal:"Temporal Imagery",subCategoryEvent:"Event Imagery",categoryBasemaps:"Basemaps",subCategoryEsriBasemaps:"Esri Basemaps",subCategoryPartnerBasemaps:"Partner Basemaps",subCategoryUserBasemaps:"User Basemaps",
categoryHistoricalMaps:"Historical Maps",categoryDemographics:"Demographics \x26 Lifestyle",subCategoryIncome:"Income \x26 Spending",subCategoryPopulation:"Population \x26 Housing",subCategorySegmentation:"Segmentation \x26 Behaviors",subCategoryBusiness:"Business \x26 Jobs",subCategoryAtRisk:"At Risk",categoryLandscape:"Landscape",subCategoryClimate:"Climate \x26 Weather",subCategoryEcology:"Ecology",subCategorySpecies:"Species Biology",subCategoryDisturbance:"Disturbance \x26 Impact",subCategoryElevation:"Elevation",
subCategoryLand:"Land Cover",subCategoryHazards:"Natural Hazards",subCategoryOceans:"Oceans",subCategorySoils:"Soils/Geology",subCategorySubsurface:"Subsurface",subCategoryWater:"Water",subCategoryWeather:"Weather",categoryEarthObservations:"Earth Observations",categoryUrbanSystems:"Urban Systems",subCategory3DCities:"3D Cities",subCategoryMovement:"Movement",subCategoryParcels:"Parcels",subCategoryPeople:"People",subCategoryPlanning:"Planning",subCategoryPublic:"Public",subCategoryWork:"Work",categoryTransportation:"Transportation",
categoryBoundaries:"Boundaries \x26 Places",subCategoryBoundaries:"Boundaries",subCategoryPlaces:"Places",categoryHexBins:"Hexbins",searchFor:"Search for",errorLabel:"Error",searchTitle:"Search",error:{wildCardSearchError:"Wildcard searches are not supported."}},gallery:{noFilterFields:"Layer ${name} has no fields that can be used for filtering.",addToViewer:"Add layer to map",noItemsToDisplay:"There are no items currently available to display.",searchFor:"Search for",searching:"Searching"},browseItems:{items:{organizationLabel:"My Organization",
onlineLabel:"ArcGIS Online",contentLabel:"My Content",favoritesLabel:"My Favorites",portalOrg:"Portal for ArcGIS"},title:"Select Web Map",searchTitle:"Search",ok:"Ok",cancel:"Cancel",placeholder:"Enter search term",instructionsLeft:"What do you want to do?",instructionsRight:"Select a configurable app.",go:"Go",selectDetails:"SELECT",configure:"Create",learnMoreConfigurableApps:"Learn more about configurable apps",noValidLayerMsg:"No layers meet the criteria of the input parameter."}},ar:1,bs:1,cs:1,
da:1,de:1,el:1,es:1,et:1,fi:1,fr:1,he:1,hr:1,id:1,it:1,ja:1,ko:1,lv:1,lt:1,nl:1,nb:1,pl:1,"pt-br":1,"pt-pt":1,ro:1,ru:1,sr:1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1})},"esri/symbols/CartographicLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./SimpleLineSymbol".split(" "),function(h,l,a,d,b,f,k,m){var g={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",
STYLE_NULL:"none",STYLE_INSIDE_FRAME:"insideframe",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},e={color:[0,0,0,1],style:g.STYLE_SOLID,width:1,cap:g.CAP_BUTT,join:g.JOIN_MITER,miterLimit:10};h=h(m,{declaredClass:"esri.symbol.CartographicLineSymbol",
type:"cartographiclinesymbol",_caps:{butt:"esriLCSButt",round:"esriLCSRound",square:"esriLCSSquare"},_joins:{miter:"esriLJSMiter",round:"esriLJSRound",bevel:"esriLJSBevel"},constructor:function(c,g,d,f,m,v){c?l.isString(c)?(this.style=c,g&&(this.color=g),void 0!==d&&(this.width=d),f&&(this.cap=f),m&&(this.join=m),void 0!==v&&(this.miterLimit=v)):(this.cap=k.valueOf(this._caps,c.cap),this.join=k.valueOf(this._joins,c.join),this.width=b.pt2px(c.width),this.miterLimit=b.pt2px(c.miterLimit)):(l.mixin(this,
e),this.color=new a(this.color),this.width=b.pt2px(this.width),this.miterLimit=b.pt2px(this.miterLimit))},setCap:function(a){return this.cap=a,this},setJoin:function(a){return this.join=a,this},setMiterLimit:function(a){return this.miterLimit=a,this},getStroke:function(){return l.mixin(this.inherited("getStroke",arguments),{cap:this.cap,join:this.join===g.JOIN_MITER?this.miterLimit:this.join})},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},
fill:null,stroke:this.getStroke()}},toJson:function(){var a=b.px2pt(this.miterLimit);return a=isNaN(a)?void 0:a,k.fixJson(l.mixin(this.inherited("toJson",arguments),{type:"esriCLS",cap:this._caps[this.cap],join:this._joins[this.join],miterLimit:a}))}});return l.mixin(h,g),h.defaultProps=e,d("extend-esri")&&(l.setObject("symbol.CartographicLineSymbol",h,f),f.symbol.defaultCartographicLineSymbol=e),h})},"esri/symbols/SimpleFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./FillSymbol ./SimpleLineSymbol require".split(" "),
function(h,l,a,d,b,f,k,m,g,e){var c={STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forwarddiagonal",STYLE_BACKWARD_DIAGONAL:"backwarddiagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonalcross",STYLE_FORWARDDIAGONAL:"forwarddiagonal",STYLE_BACKWARDDIAGONAL:"backwarddiagonal",STYLE_DIAGONALCROSS:"diagonalcross"},n={style:c.STYLE_SOLID,color:[0,0,0,.25]};h=h(m,{declaredClass:"esri.symbol.SimpleFillSymbol",type:"simplefillsymbol",
_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical",forwarddiagonal:"esriSFSForwardDiagonal",backwarddiagonal:"esriSFSBackwardDiagonal",cross:"esriSFSCross",diagonalcross:"esriSFSDiagonalCross"},constructor:function(c,b,e){c?l.isString(c)?(this.style=c,void 0!==b&&(this.outline=b),void 0!==e&&(this.color=e)):this.style=k.valueOf(this._styles,c.style):(l.mixin(this,n),this.outline=new g(this.outline),this.color=new a(this.color))},setStyle:function(a){return this.style=
a,this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){var a=this.style;return a===c.STYLE_NULL?null:a===c.STYLE_SOLID?this.color:l.mixin({},b.defaultPattern,{src:e.toUrl("../images/symbol/sfs/"+a+".png"),width:10,height:10})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){return k.fixJson(l.mixin(this.inherited("toJson",arguments),
{type:"esriSFS",style:this._styles[this.style]}))}});return l.mixin(h,c),h.defaultProps=n,d("extend-esri")&&(l.setObject("symbol.SimpleFillSymbol",h,f),f.symbol.defaultSimpleFillSymbol=n),h})},"esri/symbols/FillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./Symbol ./SimpleLineSymbol".split(" "),function(h,l,a,d,b,f){h=h(b,{declaredClass:"esri.symbol.FillSymbol",constructor:function(a){a&&l.isObject(a)&&a.outline&&(this.outline=new f(a.outline))},setOutline:function(a){return this.outline=
a,this},toJson:function(){var a=this.inherited("toJson",arguments);return this.outline&&(a.outline=this.outline.toJson()),a}});return a("extend-esri")&&l.setObject("symbol.FillSymbol",h,d),h})},"esri/symbols/PictureFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./FillSymbol".split(" "),function(h,l,a,d,b,f,k,m){var g={xoffset:0,yoffset:0,width:12,height:12};h=h(m,{declaredClass:"esri.symbol.PictureFillSymbol",type:"picturefillsymbol",
xscale:1,yscale:1,xoffset:0,yoffset:0,constructor:function(b,c,f,k){b?l.isString(b)?(this.url=b,void 0!==c&&(this.outline=c),void 0!==f&&(this.width=f),void 0!==k&&(this.height=k)):(this.xoffset=d.pt2px(b.xoffset),this.yoffset=d.pt2px(b.yoffset),this.width=d.pt2px(b.width),this.height=d.pt2px(b.height),c=b.imageData,9>a("ie")||!c||(f=this.url,this.url="data:"+(b.contentType||"image")+";base64,"+c,this.imageData=f)):(l.mixin(this,g),this.width=d.pt2px(this.width),this.height=d.pt2px(this.height))},
setWidth:function(a){return this.width=a,this},setHeight:function(a){return this.height=a,this},setOffset:function(a,c){return this.xoffset=a,this.yoffset=c,this},setUrl:function(a){return a!==this.url&&(delete this.imageData,delete this.contentType),this.url=a,this},setXScale:function(a){return this.xscale=a,this},setYScale:function(a){return this.yscale=a,this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return l.mixin({},d.defaultPattern,{src:this.url,
width:this.width*this.xscale,height:this.height*this.yscale,x:this.xoffset,y:this.yoffset})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var a=this.url,c=this.imageData;if(0===a.indexOf("data:"))var b=a,a=c,c=b.indexOf(";base64,")+8,c=b.substr(c);!l.isString(a)||0!==a.indexOf("/")&&0!==a.indexOf("//")&&0!==a.indexOf("./")&&0!==a.indexOf("../")||(a=k.getAbsoluteUrl(a));
var b=d.px2pt(this.width),b=isNaN(b)?void 0:b,g=d.px2pt(this.height),g=isNaN(g)?void 0:g,m=d.px2pt(this.xoffset),m=isNaN(m)?void 0:m,u=d.px2pt(this.yoffset),u=isNaN(u)?void 0:u,a=f.fixJson(l.mixin(this.inherited("toJson",arguments),{type:"esriPFS",url:a,imageData:c,contentType:this.contentType,width:b,height:g,xoffset:m,yoffset:u,xscale:this.xscale,yscale:this.yscale}));return a.imageData||delete a.imageData,a}});return h.defaultProps=g,a("extend-esri")&&(l.setObject("symbol.PictureFillSymbol",h,
b),b.symbol.defaultPictureFillSymbol=g),h})},"esri/symbols/TextSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Symbol ./Font".split(" "),function(h,l,a,d,b,f,k,m,g){var e={type:"textsymbol",x:0,y:0,text:"",rotated:!1,kerning:!0,color:[0,0,0,1],font:d.defaultFont,angle:0,xoffset:0,yoffset:0,horizontalAlignment:"center"},c={start:"left",middle:"center",end:"right"},n={left:"start",center:"middle",right:"end",justify:"start"},q={top:"text-before-edge",
middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},r=document.createElement("canvas");h=h(m,{declaredClass:"esri.symbol.TextSymbol",angle:0,xoffset:0,yoffset:0,constructor:function(a,c,b){l.mixin(this,e);this.font=new g(this.font);this.color=new k(this.color);a&&(l.isObject(a)?(l.mixin(this,a),this.color&&f.isDefined(this.color[0])&&(this.color=k.toDojoColor(this.color)),this.type="textsymbol",this.font=new g(this.font),this.xoffset=d.pt2px(this.xoffset),this.yoffset=d.pt2px(this.yoffset),
this.angle&&(this.angle*=-1),this.haloSize&&(this.haloSize=d.pt2px(this.haloSize)),this.haloColor&&(this.haloColor=k.toDojoColor(this.haloColor))):(this.text=a,c&&(this.font=c),b&&(this.color=b)));this.setAlign(this.align||this.getSVGAlign())},setFont:function(a){return this.font=a,this},setSize:function(a){return this.font.size=a,this},setAngle:function(a){return this.angle=a,this},setOffset:function(a,c){return this.xoffset=a,this.yoffset=c,this},setHaloColor:function(a){return this.haloColor=a,
this},setHaloSize:function(a){return this.haloSize=a,this},setAlign:function(a){return this.align=a,this.setHorizontalAlignment(a&&c[a.toLowerCase()]||"center"),this},setHorizontalAlignment:function(a){return this.horizontalAlignment=a,this},getSVGAlign:function(){var a=this.horizontalAlignment;return a&&n[a.toLowerCase()]||"middle"},setVerticalAlignment:function(a){return this.verticalAlignment=a,this},getSVGBaseline:function(){var a=this.verticalAlignment;return a&&q[a.toLowerCase()]||"alphabetic"},
getSVGBaselineShift:function(){return"bottom"===this.verticalAlignment?"super":null},setDecoration:function(a){return this.decoration=a,this.font||this.setFont(new g),this.font.setDecoration(a),this},setRotated:function(a){return this.rotated=a,this},setKerning:function(a){return this.kerning=a,this},setText:function(a){return this.text=a,this},getStroke:function(){return null},getFill:function(){return this.color},getWidth:function(){var a=r&&r.getContext&&r.getContext("2d");if(a){var c=this.font;
return a.font=(c.style?c.style:d.defaultFont.style)+" "+(c.weight?c.weight:d.defaultFont.weight)+" "+(c.size?c.size:d.defaultFont.size)+"px "+(c.family?c.family:d.defaultFont.family),a.measureText(this.text).width}for(var b=this.getHeight(),e=0,a=0;a<this.text.length;a++)c=this.text.charAt(a),e+=c==c.toUpperCase()?.7*b:.5*b;return e},getHeight:function(){return d.normalizedLength(this.font.size)},getShapeDescriptors:function(){var a,c=this.font;return c&&(a={},c.size&&(a.size=c.size),c.style&&(a.style=
c.style),c.variant&&(a.variant=c.variant),c.decoration&&(a.decoration=c.decoration),c.weight&&(a.weight=c.weight),c.family&&(a.family=c.family)),{defaultShape:{type:"text",text:this.text,x:0,y:this.getHeight()/4,align:"middle",decoration:this.decoration||c&&c.decoration,rotated:this.rotated,kerning:this.kerning},font:a,fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var a=d.px2pt(this.xoffset),c=d.px2pt(this.yoffset),b=d.px2pt(this.haloSize);return a=isNaN(a)?void 0:a,c=isNaN(c)?void 0:
c,b=isNaN(b)?void 0:b,f.fixJson(l.mixin(this.inherited("toJson",arguments),{type:"esriTS",backgroundColor:this.backgroundColor,borderLineColor:this.borderLineColor,borderLineSize:this.borderLineSize,haloSize:b,haloColor:this.haloColor&&k.toJsonColor(this.haloColor),verticalAlignment:this.verticalAlignment,horizontalAlignment:this.horizontalAlignment,rightToLeft:this.rightToLeft,width:this.width,angle:this.angle&&-1*this.angle,xoffset:a,yoffset:c,text:this.text,rotated:this.rotated,kerning:this.kerning,
font:this.font.toJson()}))}});return l.mixin(h,{ALIGN_START:"start",ALIGN_MIDDLE:"middle",ALIGN_END:"end",DECORATION_NONE:"none",DECORATION_UNDERLINE:"underline",DECORATION_OVERLINE:"overline",DECORATION_LINETHROUGH:"line-through"}),h.defaultProps=e,a("extend-esri")&&(l.setObject("symbol.TextSymbol",h,b),b.symbol.defaultTextSymbol=e),h})},"esri/symbols/Font":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang".split(" "),function(h,l,a,d,b,f){h=h(null,
{declaredClass:"esri.symbol.Font",constructor:function(b,f,g,e,c){b?l.isObject(b)?l.mixin(this,b):(this.size=b,parseFloat(this.size)==this.size&&(this.size+="px"),void 0!==f&&(this.style=f),void 0!==g&&(this.variant=g),void 0!==e&&(this.weight=e),void 0!==c&&(this.family=c)):l.mixin(this,d.defaultFont);parseFloat(this.size)==this.size&&(this.size+="pt");9>a("ie")&&this.size&&l.isString(this.size)&&-1<this.size.indexOf("em")&&(this.size=d.pt2px(12*parseFloat(this.size))+"px");this.size=this._convert2PxSize(this.size)},
setSize:function(a){return this.size=this._convert2PxSize(a),this},_convert2PxSize:function(a){var b;return parseFloat(a)==a?b=a:l.isString(a)&&(-1<a.indexOf("pt")?b=d.pt2px(parseFloat(a)):-1<a.indexOf("px")?b=parseFloat(a):-1<a.indexOf("em")?b=d.pt2px(12*parseFloat(a)):-1<a.indexOf("%")&&(b=d.pt2px(.12*parseFloat(a)))),b},setStyle:function(a){return this.style=a,this},setVariant:function(a){return this.variant=a,this},setWeight:function(a){return this.weight=a,this},setFamily:function(a){return this.family=
a,this},setDecoration:function(a){return this.decoration=a,this},toJson:function(){return f.fixJson({size:d.px2pt(this.size),style:this.style,variant:this.variant,decoration:this.decoration,weight:this.weight,family:this.family})}});return l.mixin(h,{STYLE_NORMAL:"normal",STYLE_ITALIC:"italic",STYLE_OBLIQUE:"oblique",VARIANT_NORMAL:"normal",VARIANT_SMALLCAPS:"small-caps",WEIGHT_NORMAL:"normal",WEIGHT_BOLD:"bold",WEIGHT_BOLDER:"bolder",WEIGHT_LIGHTER:"lighter"}),a("extend-esri")&&l.setObject("symbol.Font",
h,b),h})},"esri/tasks/query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils ./SpatialRelationship require require require".split(" "),function(h,l,a,d,b,f,k,m){var g=h(null,{declaredClass:"esri.tasks.Query",constructor:function(){this.spatialRelationship=g.SPATIAL_REL_INTERSECTS},text:null,where:"",geometry:null,groupByFieldsForStatistics:null,objectIds:null,returnGeometry:!1,returnDistinctValues:!1,orderByFields:null,
outSpatialReference:null,outFields:null,outStatistics:null,timeExtent:null,relationParam:null,pixelSize:null,distance:null,units:null,resultOffset:null,resultRecordCount:null,resultType:null,sqlFormat:null,quantizationParameters:null,_units:{meters:"esriSRUnit_Meter",kilometers:"esriSRUnit_Kilometer",feet:"esriSRUnit_Foot",miles:"esriSRUnit_StatuteMile","nautical-miles":"esriSRUnit_NauticalMile","us-nautical-miles":"esriSRUnit_USNauticalMile"},toJson:function(b){var c={text:this.text,where:this.where,
returnGeometry:this.returnGeometry,spatialRel:this.spatialRelationship,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision,sqlFormat:this.sqlFormat},f=b&&b.geometry||this.geometry,m=this.objectIds,r=this.outFields,u=this.outSpatialReference,h=this.groupByFieldsForStatistics,t=this.orderByFields,l=this.outStatistics;b=this.distance;if(f&&(c.geometry=f,c.geometryType=k.getJsonType(f),c.inSR=f.spatialReference.wkid||d.toJson(f.spatialReference.toJson())),m&&(c.objectIds=
m.join(",")),r&&(c.outFields=r.join(",")),this.returnDistinctValues&&(c.returnDistinctValues=!0),h&&(c.groupByFieldsForStatistics=h.join(",")),t&&(c.orderByFields=t.join(",")),l){var x=[];a.forEach(l,function(a){x.push(a.toJson())});c.outStatistics=d.toJson(x)}u?c.outSR=u.wkid||d.toJson(u.toJson()):f&&(c.outSR=f.spatialReference.wkid||d.toJson(f.spatialReference.toJson()));f=this.timeExtent;c.time=f?f.toJson().join(","):null;f=this.relationParam;return f&&this.spatialRelationship===g.SPATIAL_REL_RELATION&&
(c.relationParam=f),b&&(c.distance=this.distance,this.hasOwnProperty("units")?c.units=this._units[this.units]||this._units.meters:(console.warn("esri/tasks/query::no distance unit provided, defaulting to meters"),c.units=this._units.meters)),this.hasOwnProperty("start")&&(c.resultOffset=this.start,c.resultRecordCount=10,""===c.where&&(c.where="1\x3d1")),this.hasOwnProperty("num")&&(c.resultRecordCount=this.num),c.resultType=this.resultType,c.pixelSize=this.pixelSize?d.toJson(this.pixelSize.toJson()):
null,c.multipatchOption=this.multipatchOption,this.quantizationParameters&&(c.quantizationParameters=d.toJson(this.quantizationParameters)),c._ts=this._ts,c}});return l.mixin(g,m),b("extend-esri")&&l.setObject("tasks.Query",g,f),g})},"esri/tasks/SpatialRelationship":function(){define(["dojo/_base/lang","dojo/has","../kernel"],function(h,l,a){var d={SPATIAL_REL_INTERSECTS:"esriSpatialRelIntersects",SPATIAL_REL_CONTAINS:"esriSpatialRelContains",SPATIAL_REL_CROSSES:"esriSpatialRelCrosses",SPATIAL_REL_ENVELOPEINTERSECTS:"esriSpatialRelEnvelopeIntersects",
SPATIAL_REL_INDEXINTERSECTS:"esriSpatialRelIndexIntersects",SPATIAL_REL_OVERLAPS:"esriSpatialRelOverlaps",SPATIAL_REL_TOUCHES:"esriSpatialRelTouches",SPATIAL_REL_WITHIN:"esriSpatialRelWithin",SPATIAL_REL_RELATION:"esriSpatialRelRelation"};return l("extend-esri")&&h.setObject("tasks._SpatialRelationship",d,a),d})},"esri/Evented":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/Evented dojo/has ./kernel".split(" "),function(h,l,a,d,b,f){h=h([d],{declaredClass:"esri.Evented",registerConnectEvents:function(){var a,
b,g,e,c=this.constructor;a=this.constructor._meta.parents;var d=[{}],f={},r=function(a,c){l.isArray(a)||(a=[a]);for(var b=0;b<a.length;b++){var e=a[b];e._meta&&e._meta.parents&&r(e._meta.parents,c);e.prototype._eventMap&&c.push(l.mixin({},e.prototype._eventMap))}return c};if(!c._onMap){r(a,d);d.push(this._eventMap);a=l.mixin.apply(this,d);for(b in this)/^on\w/.test(b)&&l.isFunction(this[b])&&(g=this._hyphenLower(b).toLowerCase(),a[g]||(f[g]={method:b}));for(e in a)b=this._onCamelCase(e),f[e]={method:b,
argKeys:a[e]};return c._onMap=f,c._onMap}},on:function(b,d){if(-1<b.indexOf(",")){for(var g=b.split(/\s*,\s*/),e=g.length,c=[];e--;)c.push(this.on(g[e],d));return c.remove=function(){for(var a=0;a<c.length;a++)c[a].remove()},c}var e=this.constructor._onMap||this.registerConnectEvents(),f="string"==typeof b&&b.toLowerCase(),q=this._onCamelCase(f),r=e&&e[f];return(q=r&&r.method||this[q]&&l.isFunction(this[q])&&q)?r&&l.isArray(r.argKeys)?(g=this._onArr2Obj(d,e[f].argKeys),a.after(this,q,g,!0)):a.after(this,
q,function(a){a=a||{};a.target||(a.target=this);d.call(this,a)},!0):this.inherited(arguments)},emit:function(a,b){var g,e,c,d,f,r=a.toLowerCase(),u=this._onCamelCase(a),h=this.constructor._onMap||this.registerConnectEvents();return c=h&&h[r]&&h[r].method||l.isFunction(this[u])&&u,d=c&&this[c],c&&h&&h[r]&&this._onObj2Arr(function(){e=Array.prototype.slice.call(arguments)},h[r].argKeys)(b),b=b||{},b.target||(b.target=this),d&&(f=e&&e.length?e:[b],g=d.apply(this,f)),this.inherited(arguments,[a,b]),g},
_onObj2Arr:function(a,b){if(b){var g=this;return function(e){var c,d=[],f=b.length;for(c=0;f>c;c++)d[c]=e[b[c]];a.apply(g,d)}}return a},_onArr2Obj:function(a,b){if(b){var g=this;return function(){var e,c={},d=arguments.length;for(e=0;d>e;e++)c[b[e]]=arguments[e];c.target||(c.target=g);a.call(g,c)}}return a},_hyphenLower:function(a){return a.replace(/^on/,"").replace(/[A-Z](?=[a-z])/g,function(a,b){return(b?"-":"")+a.toLowerCase()})},_onCamelCase:function(a){return"on"+a.substr(0,1).toUpperCase()+
a.substr(1).replace(/\-([a-z])/g,function(a,b){return b.toUpperCase()})}});return b("extend-esri")&&(f.Evented=h),h})},"esri/dijit/InfoView":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-geometry ../kernel ./_TouchBase".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q){h=h(null,{declaredClass:"esri.dijit.InfoView",_items:[],_top:null,_sections:[],_isDecelerate:!1,constructor:function(a,
c){var b;if(this.container=m.byId(c),this._touchBase=q(this.container,null),this._slideDiv=e.create("div",null,this.container,"first"),this.events=[],this._items=a.items,a.sections&&(this._sections=a.sections),g.add(this.container,"esriMobileInfoView"),0===this._sections.length)e.create("div",{},this._slideDiv);else for(b=0;b<this._sections.length;b++){var d=e.create("div",{"class":"esriMobileInfoViewSection"},this._slideDiv);e.create("div",{innerHTML:this._sections[b].title},d)}for(b=0;b<this._items.length;b++){var f,
d=0;switch(this._items[b].section&&(d=this._items[b].section),this._items[b].type){case "div":f=e.create("div",{"class":"esriMobileInfoViewItem",style:this._items[b].style},this._slideDiv.childNodes[d]),f=e.create("div",{innerHTML:this._items[b].text},f)}this._items[b].className&&g.add(f,this._items[b].className);f._index=b;f._item=this._items[b];this._items[b]._node=f}this.startTouchY=0},startup:function(){this.onCreate(this._items);this._animateTo(0)},destroy:function(){a.forEach(this.events,d.disconnect);
this._touchBase=null;b.query("img",this.container).forEach(function(a){a._index=null;a._item=null;e.destroy(a)});this._items=null;e.destroy(this._slideDiv);e.destroy(this.container);this.container=this._slideDiv=null},getItems:function(){return this._items},setPreventDefault:function(a){this._touchBase.setPreventDefault(a)},enableTouchScroll:function(){this._touchBase.setPreventDefault(!0);this.events.push(d.connect(this._touchBase,"onTouchStart",this,this._onTouchStartHandler));this.events.push(d.connect(this._touchBase,
"onTouchMove",this,this._onTouchMoveHandler));this.events.push(d.connect(this._touchBase,"onTouchEnd",this,this._onTouchEndHandler));this._slideDiv.style.webkitTransform="translate3d(0,"+this._top+"px, 0)"},disableTouchScroll:function(){d.disconnect(this.events.pop());d.disconnect(this.events.pop());d.disconnect(this.events.pop());this._touchBase.setPreventDefault(!1);this._slideDiv.style.webkitTransform="translate3d(0, 0px, 0)"},animateTo:function(){this._slideDiv.style.WebkitTransitionDuration=
"0s";this._animateTo(0)},onSelect:function(a){},onUnSelect:function(a){},onCreate:function(a){},onClick:function(a){},onSwipeLeft:function(){},onSwipeRight:function(){},_onTouchStartHandler:function(a){this._slideDiv.style.WebkitTransitionDuration="0s";this._moveDirection=null;this._startTime=new Date;this.startTouchY=a.touches[0].clientY;this.contentStartOffsetY=this.contentOffsetY},_onTouchMoveHandler:function(a){(this._moveDirection||(Math.abs(a.curY)>Math.abs(a.curX)?this._moveDirection="vertical":
this._moveDirection="horizontal"),"horizontal"!==this._moveDirection&&"vertical"===this._moveDirection)&&this._animateTo(a.touches[0].clientY-this.startTouchY+this.contentStartOffsetY)},_onTouchEndHandler:function(a){this._endTime=new Date;this._deltaMovement=a.curY;"vertical"===this._moveDirection?this._shouldStartMomentum()?this._doMomentum():this._snapToBounds():"horizontal"===this._moveDirection&&("left"===a.swipeDirection?this.onSwipeLeft():"right"===a.swipeDirection&&this.onSwipeRight())},_shouldStartMomentum:function(){return this._diff=
this._endTime-this._startTime,this._velocity=this._deltaMovement/this._diff,.2<Math.abs(this._velocity)&&200>this._diff?!0:!1},_doMomentum:function(){var a,b;a=c.getContentBox(this.container);var e=0>this._velocity?.001:-.001;b=-(this._velocity*this._velocity)/(2*e);var g=-this._velocity/e,e=3*.6-0,d=1-e,f=3*.3,f=(1-f-(3*.7-f),0),k=0;if(a.h>this._slideDiv.scrollHeight)this.contentOffsetY=0,k=300;else if(0<this.contentOffsetY+b){a=0;for(b=Math.floor(g/20);b>a;a++)if(f=(20*d*a^3)+(20*e*a^2)+0*a+0,f=
0>this._velocity?-f:f,0<this.contentOffsetY+f){k=20*a;break}0===k&&(k=300);this.contentOffsetY=0}else if(Math.abs(this.contentOffsetY+b)+a.h>this._slideDiv.scrollHeight)for(this.contentOffsetY=a.h-this._slideDiv.scrollHeight,a=0,b=Math.floor(g/20);b>a;a++){if(f=(20*d*a^3)+(20*e*a^2)+0*a+0,f=0>this._velocity?-f:f,Math.abs(this.contentOffsetY+f)>this._slideDiv.scrollHeight){k=20*a;break}}else k=g,this.contentOffsetY+=b;this._slideDiv.style.webkitTransition="-webkit-transform "+k+"ms cubic-bezier(0, 0.3, 0.6, 1)";
this._animateTo(this.contentOffsetY)},_snapToBounds:function(){var a=c.getContentBox(this.container);a.h>this._slideDiv.scrollHeight?this.contentOffsetY=0:0<this.contentOffsetY?this.contentOffsetY=0:Math.abs(this.contentOffsetY)+a.h>this._slideDiv.scrollHeight&&(this.contentOffsetY=a.h-this._slideDiv.scrollHeight);this._slideDiv.style.WebkitTransitionDuration="0.5s";this._animateTo(this.contentOffsetY)},_animateTo:function(a){this.contentOffsetY=a;this._slideDiv.style.webkitTransform="translate3d(0, "+
a+"px, 0)"},_stopMomentum:function(){if(this._isDecelerating()){var a=document.defaultView.getComputedStyle(this._slideDiv,null),a=new WebKitCSSMatrix(a.webkitTransform);this._slideDiv.style.webkitTransition="";this.animateTo(a.m42)}},_isDecelerating:function(){return this.isDecelerate?!0:!1},_toggleNode:function(a,c){"ON"===c.toggleState?(c.toggleState="OFF",c.src&&(a.src=c.src.toString()),this.onUnSelect(c)):(c.toggleState="ON",c.srcAlt&&(a.src=c.srcAlt),this.onSelect(c))}});return f("extend-esri")&&
l.setObject("dijit.InfoView",h,n),h})},"esri/dijit/_TouchBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/dom dojo/has ../kernel".split(" "),function(h,l,a,d,b,f){h=h(null,{declaredClass:"esri.dijit._TouchBase",_preventDefault:!0,_swipeThreshold:20,constructor:function(b,f){this.domNode=d.byId(b);this.events=[a.connect(this.domNode,"touchstart",this,this._touchStartHandler),a.connect(this.domNode,"touchmove",this,this._touchMoveHandler),a.connect(this.domNode,"touchend",
this,this._touchEndHandler),a.connect(this.domNode,"onclick",this,this._clickHandler)]},setPreventDefault:function(a){this._preventDefault=a},disableOnClick:function(){a.disconnect(this.events.pop())},_clickHandler:function(a){this._moved?a.preventDefault():this.onclick(a)},_touchStartHandler:function(a){this._moved=!1;this.client_x=a.targetTouches[0].clientX;this.client_y=a.targetTouches[0].clientY;this.down_x=a.targetTouches[0].pageX;this.down_y=a.targetTouches[0].pageY;a.downX=this.down_x;a.downY=
this.down_y;this.onTouchStart(a)},_touchMoveHandler:function(a){this._preventDefault&&a.preventDefault();this._moved=!0;this.up_x=a.targetTouches[0].pageX;this.cur_x=a.targetTouches[0].pageX-this.down_x;this.cur_y=a.targetTouches[0].pageY-this.down_y;a.curX=this.cur_x;a.curY=this.cur_y;this.onTouchMove(a)},_touchEndHandler:function(a){this._moved?(a.curX=this.cur_x,a.curY=this.cur_y,this.down_x-this.up_x>this._swipeThreshold?a.swipeDirection="left":this.up_x-this.down_x>this._swipeThreshold&&(a.swipeDirection=
"right")):(a.clientX=this.client_x,a.clientY=this.client_y);this.onTouchEnd(a)},onTouchStart:function(a){},onTouchMove:function(a){},onTouchEnd:function(a){},onclick:function(a){}});return b("extend-esri")&&l.setObject("dijit._TouchBase",h,f),h})},"esri/dijit/NavigationBar":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct ./_TouchBase ../kernel".split(" "),function(h,l,a,d,b,f,
k,m,g,e,c,n){h=h(null,{declaredClass:"esri.dijit.NavigationBar",_items:[],constructor:function(b,d){var f;this.container=m.byId(d);this._touchBase=c(this.container,null);this._slideDiv=e.create("div",{},this.container,"first");this.events=[a.connect(this._touchBase,"onclick",this,this._onClickHandler)];this._items=b.items;g.add(this.container,"esriMobileNavigationBar");var k=e.create("div",{},this._slideDiv);for(f=0;f<this._items.length;f++){var n,h;switch(this._items[f].type){case "img":h=e.create("div",
{"class":"esriMobileNavigationItem"},k);n=e.create("img",{src:this._items[f].src.toString(),style:{width:"100%",height:"100%"}},h);break;case "span":h=e.create("div",{"class":"esriMobileNavigationItem"},k);n=e.create("span",{innerHTML:this._items[f].text},h);break;case "div":h=e.create("div",{"class":"esriMobileNavigationInfoPanel"},k),n=e.create("div",{innerHTML:this._items[f].text},h)}g.add(h,this._items[f].position);this._items[f].className&&g.add(n,this._items[f].className);n._index=f;n._item=
this._items[f];this._items[f]._node=n}},startup:function(){this.onCreate(this._items)},destroy:function(){d.forEach(this.events,a.disconnect);this._touchBase=null;b.query("img",this.container).forEach(function(a){a._index=null;a._item=null;e.destroy(a)});this._items=null;e.destroy(this._slideDiv);e.destroy(this.container);this.container=this._slideDiv=null},getItems:function(){return this._items},select:function(a){this._markSelected(a._node,a)},onSelect:function(a){},onUnSelect:function(a){},onCreate:function(a){},
_onClickHandler:function(a){if("img"===a.target.tagName.toLowerCase()){var c=a.target,e=(c._index,c._item);b.query("img",this.container).forEach(function(a){a!==c&&a._item.toggleGroup===e.toggleGroup&&this._markUnSelected(a,a._item)},this);this._toggleNode(c,e)}},_toggleNode:function(a,c){"ON"===c.toggleState?(c.toggleState="OFF",c.src&&(a.src=c.src.toString()),this.onUnSelect(c)):(c.toggleState="ON",c.srcAlt&&(a.src=c.srcAlt),this.onSelect(c))},_markSelected:function(a,c){c.toggleState="ON";c.srcAlt&&
(a.src=c.srcAlt);this.onSelect(c)},_markUnSelected:function(a,c){"ON"===c.toggleState&&(c.toggleState="OFF",c.src&&(a.src=c.src.toString()),this.onUnSelect(c))}});return f("extend-esri")&&l.setObject("dijit.NavigationBar",h,n),h})},"dojo/NodeList-dom":function(){define("./_base/kernel ./query ./_base/array ./_base/lang ./dom-class ./dom-construct ./dom-geometry ./dom-attr ./dom-style".split(" "),function(h,l,a,d,b,f,k,m,g){function e(a){return function(c,b,e){return 2==arguments.length?a["string"==
typeof b?"get":"set"](c,b):a.set(c,b,e)}}var c=function(a){return 1==a.length&&"string"==typeof a[0]},n=function(a){var c=a.parentNode;c&&c.removeChild(a)},q=l.NodeList,r=q._adaptWithCondition,u=q._adaptAsForEach,v=q._adaptAsMap;d.extend(q,{_normalize:function(a,c){var b=!0===a.parse;if("string"==typeof a.template){var e=a.templateFunc||h.string&&h.string.substitute;a=e?e(a.template,a):a}e=typeof a;"string"==e||"number"==e?(a=f.toDom(a,c&&c.ownerDocument),a=11==a.nodeType?d._toArray(a.childNodes):
[a]):d.isArrayLike(a)?d.isArray(a)||(a=d._toArray(a)):a=[a];b&&(a._runParse=!0);return a},_cloneNode:function(a){return a.cloneNode(!0)},_place:function(a,c,b,e){if(1==c.nodeType||"only"!=b)for(var g,d=a.length,k=d-1;0<=k;k--){var n=e?this._cloneNode(a[k]):a[k];if(a._runParse&&h.parser&&h.parser.parse)for(g||(g=c.ownerDocument.createElement("div")),g.appendChild(n),h.parser.parse(g),n=g.firstChild;g.firstChild;)g.removeChild(g.firstChild);k==d-1?f.place(n,c,b):c.parentNode.insertBefore(n,c);c=n}},
position:v(k.position),attr:r(e(m),c),style:r(e(g),c),addClass:u(b.add),removeClass:u(b.remove),toggleClass:u(b.toggle),replaceClass:u(b.replace),empty:u(f.empty),removeAttr:u(m.remove),marginBox:v(k.getMarginBox),place:function(a,c){var b=l(a)[0];return this.forEach(function(a){f.place(a,b,c)})},orphan:function(a){return(a?l._filterResult(this,a):this).forEach(n)},adopt:function(a,c){return l(a).place(this[0],c)._stash(this)},query:function(a){if(!a)return this;var c=new q;this.map(function(b){l(a,
b).forEach(function(a){void 0!==a&&c.push(a)})});return c._stash(this)},filter:function(c){var b=arguments,e=this,g=0;if("string"==typeof c){e=l._filterResult(this,b[0]);if(1==b.length)return e._stash(this);g=1}return this._wrap(a.filter(e,b[g],b[g+1]),this)},addContent:function(a,c){a=this._normalize(a,this[0]);for(var b=0,e;e=this[b];b++)a.length?this._place(a,e,c,0<b):f.empty(e);return this}});return q})},"cmv/viewer/js/viewer/_MapMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/dom dojo/_base/array dojo/Deferred esri/map esri/IdentityManager".split(" "),
function(h,l,a,d,b,f,k){return h(null,{postConfig:function(){this.mapDeferred=new f;return this.inherited(arguments)},startup:function(){this.inherited(arguments);this.layoutDeferred.then(l.hitch(this,"initMapAsync"))},initMapAsync:function(){var a=new f,b=[];this.createMap(b).then(l.hitch(this,"_createMapResult",a,b));a.then(l.hitch(this,"initMapComplete"));return a},createMap:function(a){var b=this.inherited(arguments);if(b)return b;var e=new f,b=d.byId(this.config.layout.map)||"mapCenter";this.map=
new k(b,this.config.mapOptions);(b=this.inherited(arguments))?b.then(function(c){c&&(a=a.concat(c));e.resolve(a)}):e.resolve(a);return e},_createMapResult:function(b,g){if(this.map){if(!this.config.webMapId&&this.config.mapOptions&&this.config.mapOptions.basemap)this.map.on("load",l.hitch(this,"_initLayers",g));else this._initLayers(g);if(this.config.operationalLayers&&0<this.config.operationalLayers.length)a.once(this.map,"layers-add-result",l.hitch(this,"_onLayersAddResult",b,g));else b.resolve(g)}else b.resolve(g);
return b},_onLayersAddResult:function(a,g,e){b.forEach(e.layers,function(a){!0!==a.success&&g.push(a.error)},this);a.resolve(g)},_initLayers:function(a){this.layers=[];var g={csv:"esri/layers/CSVLayer",dataadapter:"esri/layers/DataAdapterFeatureLayer",dynamic:"esri/layers/ArcGISDynamicMapServiceLayer",feature:"esri/layers/FeatureLayer",georss:"esri/layers/GeoRSSLayer",image:"esri/layers/ArcGISImageServiceLayer",imagevector:"esri/layers/ArcGISImageServiceVectorLayer",kml:"esri/layers/KMLLayer",label:"esri/layers/LabelLayer",
mapimage:"esri/layers/MapImageLayer",osm:"esri/layers/OpenStreetMapLayer",raster:"esri/layers/RasterLayer",stream:"esri/layers/StreamLayer",tiled:"esri/layers/ArcGISTiledMapServiceLayer",vectortile:"esri/layers/VectorTileLayer",webtiled:"esri/layers/WebTiledLayer",wfs:"esri/layers/WFSLayer",wms:"esri/layers/WMSLayer",wmts:"esri/layers/WMTSLayer"},g=l.mixin(g,this.config.layerTypes||{}),e=[];b.forEach(this.config.operationalLayers,function(c){var b=g[c.type];b?e.push(b):a.push('Layer type "'+c.type+
'" is not supported: ')},this);require(e,l.hitch(this,function(){b.forEach(this.config.operationalLayers,function(a){var b=g[a.type];b&&require([b],l.hitch(this,"_initLayer",a))},this);this.map.addLayers(this.layers)}))},_initLayer:function(a,b){var e;e=a.url?new b(a.url,a.options):new b(a.options);this.layers.unshift(e);var c=!1;"undefined"!==typeof a.legendLayerInfos&&"undefined"!==typeof a.legendLayerInfos.exclude&&(c=a.legendLayerInfos.exclude);c||(c={},"undefined"!==typeof a.legendLayerInfos&&
"undefined"!==typeof a.legendLayerInfos.layerInfo&&(c=a.legendLayerInfos.layerInfo),c=l.mixin({layer:e,title:a.title||null},c),this.legendLayerInfos.unshift(c));this.layerControlLayerInfos.unshift({layer:e,type:a.type,title:a.title,controlOptions:a.layerControlLayerInfos});"feature"===a.type&&(c={featureLayer:e},a.editorLayerInfos&&l.mixin(c,a.editorLayerInfos),!0!==c.exclude&&this.editorLayerInfos.push(c));if("dynamic"===a.type||"feature"===a.type)e={layer:e,title:a.title},a.identifyLayerInfos&&
l.mixin(e,a.identifyLayerInfos),!0!==e.exclude&&this.identifyLayerInfos.push(e)},initMapComplete:function(a){a&&0<a.length&&this.handleError({source:"Controller",error:a.join(", ")});this.map&&(this.map.on("resize",function(a){var b=a.target.extent.getCenter();setTimeout(function(){a.target.centerAt(b)},100)}),this.mapDeferred.resolve(this.map))},initMapError:function(a){this.handleError({source:"Controller",error:a})},resizeMap:function(){this.map&&this.map.resize()},getMapHeight:function(){return this.map?
this.map.height:0}})})},"esri/map":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/event dojo/on dojo/aspect dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/a11yclick dijit/registry ./kernel ./config ./sniff ./lang ./_coremap ./MapNavigationManager dojo/i18n!./nls/jsapi".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C){var D={up:"panUp",right:"panRight",
down:"panDown",left:"panLeft"},E={upperRight:"panUpperRight",lowerRight:"panLowerRight",lowerLeft:"panLowerLeft",upperLeft:"panUpperLeft"},F=d.connect,H=d.disconnect,G=q.create,K=u.set,J=b.hitch,I=r.getMarginBox,L=l.deprecated,M=b.mixin,N=0;l=a(A,{declaredClass:"esri.Map",constructor:function(a,c){M(this,{_slider:null,_navDiv:null,_mapParams:M({attributionWidth:.45,slider:!0,nav:!1,logo:!0,sliderStyle:"small",sliderPosition:"top-left",sliderOrientation:"vertical",autoResize:!0},c||{})});M(this,{isDoubleClickZoom:!1,
isShiftDoubleClickZoom:!1,isClickRecenter:!1,isScrollWheelZoom:!1,isPan:!1,isRubberBandZoom:!1,isKeyboardNavigation:!1,isPanArrows:!1,isZoomSlider:!1});b.isFunction(w._css)&&(w._css=w._css(this._mapParams.force3DTransforms),this.force3DTransforms=this._mapParams.force3DTransforms);var e=y("esri-transforms")&&y("esri-transitions");if(this.navigationMode=this._mapParams.navigationMode||e&&"css-transforms"||"classic","css-transforms"!==this.navigationMode||e||(this.navigationMode="classic"),this.fadeOnZoom=
z.isDefined(this._mapParams.fadeOnZoom)?this._mapParams.fadeOnZoom:"css-transforms"===this.navigationMode,"css-transforms"!==this.navigationMode&&(this.fadeOnZoom=!1),this.setMapCursor("default"),this.smartNavigation=c&&c.smartNavigation,!(z.isDefined(this.smartNavigation)||!y("mac")||y("esri-touch")||y("esri-pointer")||3.5>=y("ff"))){var d=navigator.userAgent.match(/Mac\s+OS\s+X\s+([\d]+)(\.|\_)([\d]+)\D/i);d&&z.isDefined(d[1])&&z.isDefined(d[3])&&(e=parseInt(d[1],10),d=parseInt(d[3],10),this.smartNavigation=
10<e||10===e&&6<=d)}this.showAttribution=z.isDefined(this._mapParams.showAttribution)?this._mapParams.showAttribution:!0;this._onLoadHandler_connect=F(this,"onLoad",this,"_onLoadInitNavsHandler");var k=G("div",{"class":"esriControlsBR"+(this._mapParams.nav?" withPanArrows":"")},this.root);if(this.showAttribution)if(e=b.getObject("esri.dijit.Attribution",!1))this._initAttribution(e,k);else{var n=N++,t=this;this._rids&&this._rids.push(n);h(["./dijit/Attribution"],function(a){var c=t._rids?f.indexOf(t._rids,
n):-1;-1!==c&&(t._rids.splice(c,1),t._initAttribution(a,k))})}this._mapParams.logo&&(e={},6===y("ie")&&(e.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+h.toUrl("./images/map/logo-med.png")+"')"),this._ogol=G("div",{style:e,tabIndex:"0",title:"Esri"},k),this._setLogoSize(),this._onMapResizeLogo_connect=F(this,"onResize",this,"_setLogoSize"),this._ogol_connect=F(this._ogol,v,this,"_openLogoLink"));if(this.navigationManager=new B(this),
c&&c.basemap&&(this._onLoadFix=!0,this.setBasemap(c.basemap),this._onLoadFix=!1),this.autoResize=this._mapParams.autoResize,this.autoResize)e=this._getEnclosingResizableWidget(this.container)||window,d=this.resize,this._rszSignal=m.pausable(e,"resize",d),this._oriSignal=m.pausable(window,"orientationchange",d),g.after(e,"resize",d,!0),this._startResizeTimer()},_startResizeTimer:function(){clearTimeout(this._persistentTimer);this._persistentTimer=setTimeout(this._timedResize,2*this.resizeDelay)},_getEnclosingResizableWidget:function(a){var c=
t.getEnclosingWidget(a);return c?c.resize?c:this._getEnclosingResizableWidget(a.parentNode):c},_setLogoSize:function(){this._ogol&&(25E4>this.root.clientWidth*this.root.clientHeight?(n.remove(this._ogol,"logo-med"),n.add(this._ogol,"logo-sm")):(n.remove(this._ogol,"logo-sm"),n.add(this._ogol,"logo-med")))},_initAttribution:function(a,c){var b=G("span",{"class":"esriAttribution"},c,"first");K(b,"maxWidth",Math.floor(this.width*this._mapParams.attributionWidth)+"px");this._connects.push(F(b,v,function(){n.contains(this,
"esriAttributionOpen")?n.remove(this,"esriAttributionOpen"):this.scrollWidth>this.clientWidth&&n.add(this,"esriAttributionOpen")}));this.attribution=new a({map:this},b)},_cleanUp:function(){this.disableMapNavigation();this.navigationManager.destroy();var a=this._slider;a&&a.destroy&&!a._destroyed&&a.destroy();var a=this._navDiv,c=this.attribution;a&&q.destroy(a);c&&c.destroy();this._connects.push(this._slider_connect,this._ogol_connect,this._rszSignal,this._oriSignal);f.forEach(this._connects,H);
clearInterval(this._persistentTimer);this.attribution=this.navigationManager=this._rids=this._connects=this._slider_connect=this._ogol_connect=this._rszSignal=this._oriSignal=this._persistentTimer=null;this.inherited("_cleanUp",arguments)},_isPanningOrZooming:function(){return this.__panning||this.__zooming},_canZoom:function(a){var c=this.getLevel();return!this.__tileInfo||!(c===this.getMinZoom()&&0>a||c===this.getMaxZoom()&&0<a)},_onLoadInitNavsHandler:function(){if(this.enableMapNavigation(),this._createNav(),
"small"!==this._mapParams.sliderStyle&&this._createSlider){if(this._mapParams.slider){var a=-1!==this._getSliderClass(!0).indexOf("Horizontal"),a=[a?"dijit.form.HorizontalSlider":"dijit.form.VerticalSlider",a?"dijit.form.HorizontalRule":"dijit.form.VerticalRule",a?"dijit.form.HorizontalRuleLabels":"dijit.form.VerticalRuleLabels"];if(f.some(a,function(a){return!b.getObject(a,!1)})){var a=f.map(a,function(a){return a.replace(/\./g,"/")}),c=N++,e=this;this._rids&&this._rids.push(c);h(a,function(){var a=
e._rids?f.indexOf(e._rids,c):-1;-1!==a&&(e._rids.splice(a,1),e._createSlider.apply(e,arguments))})}else a=f.map(a,function(a){return b.getObject(a,!1)}),this._createSlider.apply(this,a)}}else this._createSimpleSlider();H(this._onLoadHandler_connect)},_createNav:function(){if(this._mapParams.nav){var a,c,b,e=n.add,g=this.id;this._navDiv=G("div",{id:g+"_navdiv"},this.root);e(this._navDiv,"navDiv");var d,f=this.width/2,k=this.height/2;for(b in D)c=D[b],a=G("div",{id:g+"_pan_"+b},this._navDiv),e(a,"fixedPan "+
c),"up"===b||"down"===b?(d=parseInt(I(a).w,10)/2,K(a,{left:f-d+"px",zIndex:30})):(d=parseInt(I(a).h,10)/2,K(a,{top:k-d+"px",zIndex:30})),this._connects.push(F(a,"onclick",J(this,this[c])));this._onMapResizeNavHandler_connect=F(this,"onResize",this,"_onMapResizeNavHandler");for(b in E)c=E[b],a=G("div",{id:g+"_pan_"+b,style:{zIndex:30}},this._navDiv),e(a,"fixedPan "+c),this._connects.push(F(a,"onclick",J(this,this[c])));this.isPanArrows=!0}},_onMapResizeNavHandler:function(a,c,b){var g,d;a=this.id;
c/=2;var f=b/2,k=e.byId;for(g in D)b=k(a+"_pan_"+g),"up"===g||"down"===g?(d=parseInt(I(b).w,10)/2,K(b,"left",c-d+"px")):(d=parseInt(I(b).h,10)/2,K(b,"top",f-d+"px"))},_createSimpleSlider:function(){if(this._mapParams.slider){var a=this._slider=G("div",{id:this.id+"_zoom_slider","class":this._getSliderClass(),style:{zIndex:30}}),c=G("div",{"class":"esriSimpleSliderIncrementButton",tabIndex:"0",role:"button"},a),b=G("div",{"class":"esriSimpleSliderDecrementButton",tabIndex:"0",role:"button"},a);this._addZoomButtonTooltips(c,
b);this._incButton=c;this._decButton=b;this._simpleSliderZoomHandler(null,null,null,this.getLevel());var g=C.widgets.zoomSlider;this._addZoomButtonIcon(c,"+",g.zoomIn);this._addZoomButtonIcon(b,"\x26minus;",g.zoomOut);8>y("ie")&&n.add(b,"dj_ie67Fix");this._connects.push(F(c,v,this,this._simpleSliderChangeHandler));this._connects.push(F(b,v,this,this._simpleSliderChangeHandler));(-1<this.getMaxZoom()||-1<this.getMinZoom())&&this._connects.push(F(this,"onZoomEnd",this,this._simpleSliderZoomHandler));
10>y("ie")&&e.setSelectable(a,!1);this.root.appendChild(a);this.isZoomSlider=!0}},_simpleSliderChangeHandler:function(a){k.stop(a);a=-1!==a.currentTarget.className.indexOf("IncrementButton")?!0:!1;this._extentUtil({numLevels:a?1:-1})},_simpleSliderZoomHandler:function(a,c,b,e){var g;a=this._incButton;c=this._decButton;-1<e&&e===this.getMaxZoom()?g=a:-1<e&&e===this.getMinZoom()&&(g=c);g?(n.add(g,"esriSimpleSliderDisabledButton"),n.remove(g===a?c:a,"esriSimpleSliderDisabledButton")):(n.remove(a,"esriSimpleSliderDisabledButton"),
n.remove(c,"esriSimpleSliderDisabledButton"))},_getSliderClass:function(a){a=a?"Large":"Simple";var c=this._mapParams.sliderOrientation,b=this._mapParams.sliderPosition||"";if(c=c&&"horizontal"===c.toLowerCase()?"esri"+a+"SliderHorizontal":"esri"+a+"SliderVertical",b)switch(b.toLowerCase()){case "top-left":b="esri"+a+"SliderTL";break;case "top-right":b="esri"+a+"SliderTR";break;case "bottom-left":b="esri"+a+"SliderBL";break;case "bottom-right":b="esri"+a+"SliderBR"}return"esri"+a+"Slider "+c+" "+
b},_addZoomButtonIcon:function(a,c,b){q.create("span",{"aria-hidden":"true",role:"presentation",innerHTML:c},a);q.create("span",{"class":"esriIconFallbackText",innerHTML:b},a)},_addZoomButtonTooltips:function(a,b){var e=C.widgets.zoomSlider;c.set(a,"title",e.zoomIn);c.set(b,"title",e.zoomOut)},_createSlider:function(a,c,b){if(this._mapParams.slider){var e,g=G("div",{id:this.id+"_zoom_slider"},this.root);e=x.defaults.map;var d=this._getSliderClass(!0),k=-1!==d.indexOf("Horizontal"),n=this.getNumLevels();
if(0<n){var m,t,r=this._mapParams.sliderLabels,q=!!r,u=!1!==r;if(u){var h=k?"bottomDecoration":"rightDecoration";if(!r)for(r=[],e=0;n>e;e++)r[e]="";f.forEach([{"class":"esriLargeSliderTicks",container:h,count:n,dijitClass:c},{"class":q&&"esriLargeSliderLabels",container:h,count:n,labels:r,dijitClass:b}],function(a){var b=G("div"),e=a.dijitClass;delete a.dijitClass;g.appendChild(b);e===c?m=new e(a,b):t=new e(a,b)})}a=this._slider=new a({id:g.id,"class":d,minimum:this.getMinZoom(),maximum:this.getMaxZoom(),
discreteValues:n,value:this.getLevel(),clickSelect:!0,intermediateChanges:!0,style:"z-index:30;"},g);a.startup();u&&(m.startup(),t.startup());this._slider_connect=F(a,"onChange",this,"_onSliderChangeHandler");this._connects.push(F(this,"onExtentChange",this,"_onExtentChangeSliderHandler"));this._connects.push(F(a._movable,"onFirstMove",this,"_onSliderMoveStartHandler"))}else{a=this._slider=new a({id:g.id,"class":d,minimum:0,maximum:2,discreteValues:3,value:1,clickSelect:!0,intermediateChanges:e.sliderChangeImmediate,
style:"height:50px; z-index:30;"},g);b=a.domNode.firstChild.childNodes;for(e=1;3>=e;e++)K(b[e],"visibility","hidden");a.startup();this._slider_connect=F(a,"onChange",this,"_onDynSliderChangeHandler");this._connects.push(F(this,"onExtentChange",this,"_onExtentChangeDynSliderHandler"))}e=a.incrementButton;b=a.decrementButton;k?this._addZoomButtonTooltips(e,b):this._addZoomButtonTooltips(b,e);e.style.outline="none";b.style.outline="none";a.sliderHandle.style.outline="none";a._onKeyPress=function(){};
if(k=a._movable){var v=k.onMouseDown;k.onMouseDown=function(a){9>y("ie")&&1!==a.button||v.apply(this,arguments)}}this.isZoomSlider=!0}},_onSliderMoveStartHandler:function(){H(this._slider_connect);H(this._slidermovestop_connect);this._slider_connect=F(this._slider,"onChange",this,"_onSliderChangeDragHandler");this._slidermovestop_connect=F(this._slider._movable,"onMoveStop",this,"_onSliderMoveEndHandler")},_onSliderChangeDragHandler:function(a){this._extentUtil({targetLevel:a})},_onSliderMoveEndHandler:function(){H(this._slider_connect);
H(this._slidermovestop_connect)},_onSliderChangeHandler:function(a){this.setLevel(a)},_updateSliderValue:function(a,c){H(this._slider_connect);var b=this._slider,e=b._onChangeActive;b._onChangeActive=!1;b.set("value",a);b._onChangeActive=e;this._slider_connect=F(b,"onChange",this,c)},_onExtentChangeSliderHandler:function(a,c,b,e){H(this._slidermovestop_connect);this._updateSliderValue(e.level,"_onSliderChangeHandler")},_onDynSliderChangeHandler:function(a){this._extentUtil({numLevels:0<a?1:-1})},
_onExtentChangeDynSliderHandler:function(){this._updateSliderValue(1,"_onDynSliderChangeHandler")},_openLogoLink:function(a){window.open(x.defaults.map.logoLink,"_blank");k.stop(a)},enableMapNavigation:function(){this.navigationManager.enableNavigation()},disableMapNavigation:function(){this.navigationManager.disableNavigation()},enableDoubleClickZoom:function(){this.isDoubleClickZoom||(this.navigationManager.enableDoubleClickZoom(),this.isDoubleClickZoom=!0)},disableDoubleClickZoom:function(){this.isDoubleClickZoom&&
(this.navigationManager.disableDoubleClickZoom(),this.isDoubleClickZoom=!1)},enableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom||(L(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.enableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=!0)},disableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom&&(L(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",
null,"v2.0"),this.navigationManager.disableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=!1)},enableClickRecenter:function(){this.isClickRecenter||(this.navigationManager.enableClickRecenter(),this.isClickRecenter=!0)},disableClickRecenter:function(){this.isClickRecenter&&(this.navigationManager.disableClickRecenter(),this.isClickRecenter=!1)},enablePan:function(){this.isPan||(this.navigationManager.enablePan(),this.isPan=!0)},disablePan:function(){this.isPan&&(this.navigationManager.disablePan(),
this.isPan=!1)},enableRubberBandZoom:function(){this.isRubberBandZoom||(this.navigationManager.enableRubberBandZoom(),this.isRubberBandZoom=!0)},disableRubberBandZoom:function(){this.isRubberBandZoom&&(this.navigationManager.disableRubberBandZoom(),this.isRubberBandZoom=!1)},enableKeyboardNavigation:function(){this.isKeyboardNavigation||(this.navigationManager.enableKeyboardNavigation(),this.isKeyboardNavigation=!0)},disableKeyboardNavigation:function(){this.isKeyboardNavigation&&(this.navigationManager.disableKeyboardNavigation(),
this.isKeyboardNavigation=!1)},enableScrollWheelZoom:function(){this.isScrollWheelZoom||(this.navigationManager.enableScrollWheelZoom(),this.isScrollWheelZoom=!0)},disableScrollWheelZoom:function(){this.isScrollWheelZoom&&(this.navigationManager.disableScrollWheelZoom(),this.isScrollWheelZoom=!1)},showPanArrows:function(){this._navDiv&&(this._navDiv.style.display="block",this.isPanArrows=!0)},hidePanArrows:function(){this._navDiv&&(this._navDiv.style.display="none",this.isPanArrows=!1)},showZoomSlider:function(){this._slider&&
(K(this._slider.domNode||this._slider,"visibility","inherit"),this.isZoomSlider=!0)},hideZoomSlider:function(){this._slider&&(K(this._slider.domNode||this._slider,"visibility","hidden"),this.isZoomSlider=!1)}});return y("extend-esri")&&(w.Map=l),l})},"esri/_coremap":function(){define("require module dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/_base/event dojo/_base/unload dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/sniff dijit/registry dojox/gfx/matrix ./kernel ./config ./basemaps ./lang ./Evented ./fx ./deferredUtils ./tileUtils ./urlUtils ./PluginTarget ./arcade/Dictionary ./geometry/Point ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./geometry/scaleUtils ./geometry/screenUtils ./geometry/webMercatorUtils ./layers/GraphicsLayer ./layers/TileInfo ./layers/LOD ./layers/ArcGISTiledMapServiceLayer ./layers/MapImageLayer ./layers/OpenStreetMapLayer ./layers/VectorTileLayer ./dijit/Popup ./plugins/popupManager dojo/uacss".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K,J,I,L,M,N,Q,O,T,S,R,U,W,fa,ea,oa,pa){function Aa(a,c){var b=a.lods;b.sort(function(a,c){return a.scale>c.scale?-1:a.scale<c.scale?1:0});var e=[],b=m.filter(b,function(a){return-1===ka(e,a.scale)?(e.push(a.scale),!0):void 0}),g,d=c.lods=[];m.forEach(b,function(a,c){g=d[c]=new U(a);g.level=c});c.tileInfo=new R(sa(a,{lods:d}))}var ta,va=O.toMapPoint,ua=O.toScreenPoint,qa=b.connect,ca=b.disconnect,ja=k.hitch,la=v.set,ka=m.indexOf,sa=
k.mixin,Ea=0,ra=z.defaults.map,za=ra.layerNamePrefix,wa=ra.graphicsLayerNamePrefix,Ha=new RegExp("^"+za+"(\\d+)$"),Ga=new RegExp("^"+wa+"(\\d+)$"),Ca=function(){};d=d([C,G],{declaredClass:"esri._CoreMap",resizeDelay:300,invalidExtent:"Map does not have a valid extent.",invalidGeometry:"Geometry (wkid: ${geometry}) cannot be converted to spatial reference of the map (wkid: ${map})",unknownBasemap:'Unable to find basemap definition for: "${basemapName}". Try one of these: ${list}',invalidBasemap:'Unable to add basemap: "${basemapName}".',
unknownLayerType:'Unknown basemap layer type: "${type}" found in basemap definition for: "${basemapName}".',visible:!0,_eventMap:{"basemap-change":!0,"extent-change":["extent","delta","levelChange","lod"],"layer-add":["layer"],"layer-add-result":["layer","error"],"layer-remove":["layer"],"layer-reorder":["layer","index"],"layer-resume":["layer"],"layer-suspend":["layer"],"layers-add-result":["layers"],"layers-removed":!0,"layers-reordered":["layerIds"],load:["map"],pan:["extent","delta"],"pan-end":["extent",
"delta"],"pan-start":["extent","screenPoint"],reposition:["x","y"],resize:["extent","width","height"],scale:["matrix","immediate"],"time-extent-change":["timeExtent"],"before-unload":["map"],unload:["map"],"update-end":["error"],"update-start":!0,zoom:["extent","zoomFactor","anchor"],"zoom-end":["extent","zoomFactor","anchor","level"],"zoom-start":["extent","zoomFactor","anchor","level"],click:!0,"dbl-click":!0,"key-down":!0,"key-up":!0,"mouse-down":!0,"mouse-drag":!0,"mouse-drag-end":!0,"mouse-drag-start":!0,
"mouse-move":!0,"mouse-out":!0,"mouse-over":!0,"mouse-up":!0,"mouse-wheel":!0,"basic-tap":!0,"double-tap":!0,"pinch-end":!0,"pinch-move":!0,"pinch-start":!0,"processed-double-tap":!0,"processed-tap":!0,"swipe-end":!0,"swipe-move":!0,"swipe-start":!0,tap:!0,"two-finger-tap":!0},constructor:function(a,b){var g=this;this.registerConnectEvents();sa(this,{_internalLayerIds:[],_layers:[],_layerDivs:[],_layerSize:0,_connects:[],_zoomAnimDiv:null,_zoomAnim:null,_layersDiv:null,_firstLayerId:null,_delta:null,
_cursor:null,_ratioW:1,_ratioH:1,_params:null,cursor:null,layerIds:[],graphicsLayerIds:[],graphics:null,_labels:null,loaded:!1,__panning:!1,__zooming:!1,__container:null,root:null,__LOD:null,__tileInfo:null,__visibleRect:null,__visibleDelta:null,_rids:[]});var d=this.container=c.byId(a),f=this.id=n.get(d,"id")||w.getUniqueId(this.declaredClass);q.add(d,"map");var k=u.getContentBox(d),m=q.add,t=r.create;this.position=new I(0,0);this._reposition();var v=this.width=0<k.w?k.w:ra.width,l=this.height=0<
k.h?k.h:ra.height,x=this.root=t("div",{id:f+"_root",style:{width:v+"px",height:l+"px",direction:"ltr"}});m(x,"esriMapContainer");k=this.__container=t("div",{id:f+"_container"},x);la(k,"position","absolute");m(k,"esriMapContainer");d.appendChild(x);d=this._params=sa({slider:!0,nav:!1,zoom:-1,minZoom:-1,maxZoom:-1,scale:-1,minScale:0,maxScale:0,showInfoWindowOnClick:!0,displayGraphicsOnPan:!0,wrapAround180:!0,fitExtent:!1,optimizePanAnimation:!0},b||{});this.wrapAround180=d.wrapAround180;this.optimizePanAnimation=
d.optimizePanAnimation;B.isDefined(d.resizeDelay)&&(this.resizeDelay=d.resizeDelay);d.lods&&(Aa({rows:512,cols:512,dpi:96,format:"JPEG",compressionQuality:75,origin:{x:-180,y:90},spatialReference:{wkid:4326},lods:d.lods},d),this.__tileInfo=d.tileInfo);this.extent=d.extent;this._extentUtil({mapCenter:d.center,targetLevel:d.zoom,targetScale:d.scale});this.__visibleRect=new M(0,0,v,l);this.__visibleDelta=new M(0,0,v,l);f=this._layersDiv=t("div",{id:f+"_layers"});(m(f,"esriMapLayers"),k.appendChild(f),
this._zoomAnimDiv=t("div",{style:{position:"absolute"}}),d.infoWindow)?this.infoWindow=d.infoWindow:(m=this.infoWindow=new pa(d.popupOptions,t("div")),m.startup(),m._ootb=!0,la(m.domNode,"zIndex",40));d.showLabels&&(h(["./layers/LabelLayer"],function(a){ta=a;g._createLabelLayer()}),this.on("load",function(){g._createLabelLayer()}));this.addPlugin(this._getAbsMid("./plugins/popupManager"),{enabled:d.showInfoWindowOnClick});this._zoomStartHandler=ja(this,this._zoomStartHandler);this._zoomingHandler=
ja(this,this._zoomingHandler);this._zoomEndHandler=ja(this,this._zoomEndHandler);this._panningHandler=ja(this,this._panningHandler);this._panEndHandler=ja(this,this._panEndHandler);this._endTranslate=ja(this,this._endTranslate);this._timedResize=ja(this,this._timedResize);this._execResize=ja(this,this._execResize);this._processLabelLayers=ja(this,this._processLabelLayers);this._updateLabelLayers=ja(this,this._updateLabelLayers);this.resize=ja(this,this.resize);e.addOnWindowUnload(this,this.destroy)},
_getAbsMid:function(a){return h.toAbsMid?h.toAbsMid(a):l.id.replace(/\/[^\/]*$/gi,"/")+a},_cleanUp:function(){var a=this.infoWindow;a&&(a._ootb&&a.destroy?a.destroy():a.unsetMap(this),delete this.infoWindow);ca(this._tsTimeExtentChange_connect);this.removePlugin("./plugins/popupManager");r.destroy(this.root);this.root=null},_addLayer:function(a,c,b){if(a.id){var e=a.id.match(a instanceof S?Ga:Ha);e&&e[1]&&(e=Number(e[1]),e>=Ea&&(Ea=e+1))}var g=a.id||(a instanceof S?wa:za)+Ea++;a.id=g;this._layers[g]=
a;var d,f;if((c===this.layerIds||c===this.graphicsLayerIds)&&(d=this._layerSize,this._layerSize++),a._isRefLayer="top"===b,b=!B.isDefined(b)||0>b||b>c.length||"top"===b?c.length:b,0===d&&(this._firstLayerId=g),!a._isRefLayer)for(;(f=this.getLayer(c[b-1]))&&f._isRefLayer;)b--;c.splice(b,0,g);var k=ja(this,this._addLayerHandler),n=this;b=this._connects;e=function(){a.loaded?n._onLoadFix?(n._onLoadFix=!1,setTimeout(function(){k(a)},0)):k(a):(n["_"+g+"_addtoken_load"]=qa(a,"onLoad",n,"_addLayerHandler"),
n["_"+g+"_addtoken_err"]=qa(a,"onError",n,function(b){k(a,b,c)}))};return this.loaded||0===d||a.loaded&&-1===ka(this.graphicsLayerIds,g)?e():b.push(qa(this,"onLoad",e)),a},_addLayerHandler:function(a,c,b){var e,g,d,f,k=this.id,n=a.id,m=ka(a instanceof S?this.graphicsLayerIds:this.layerIds,n),t=m,r=!1,q=this._params;if(ca(this["_"+n+"_addtoken_load"]),ca(this["_"+n+"_addtoken_err"]),c)return delete this._layers[n],void(-1!==m&&(b.splice(m,1),this.onLayerAddResult(a,c)));if(-1===m&&(m=ka(this._internalLayerIds,
n),t=20+m,r=!0),n===this._firstLayerId){if(g=a.spatialReference,d=this.extent&&this.extent.spatialReference,!d||d.equals(g)||!a.tileInfo&&a.url||(d=null),e=this.spatialReference=d||g,this.wrapAround180=this.wrapAround180&&e&&e._isWrappable()?!0:!1,a.tileInfo&&(this.__tileInfo?(f=this.__tileInfo.lods,this.__tileInfo=sa({},a.tileInfo),this.__tileInfo.lods=f):(Aa(sa({},a.tileInfo),q),this.__tileInfo=q.tileInfo)),this.wrapAround180)c=this.__tileInfo,e=e._getInfo(),(!c||Math.abs(e.origin[0]-c.origin.x)>
e.dx)&&(this.wrapAround180=!1),this.wrapAround180&&c&&F._addFrameInfo(c,e);if(q.units=a.units,f=this.__tileInfo&&this.__tileInfo.lods,f&&f.length){c=q.minScale;b=q.maxScale;d=g=-1;var u=m=!1;for(e=0;e<f.length;e++)0<c&&!m&&c>=f[e].scale&&(g=f[e].level,m=!0),0<b&&!u&&b>=f[e].scale&&(d=0<e?f[e-1].level:-1,u=!0);-1===q.minZoom&&(q.minZoom=0===c?f[0].level:g);-1===q.maxZoom&&(q.maxZoom=0===b?f[f.length-1].level:d);for(e=0;e<f.length;e++)q.minZoom===f[e].level&&(q.minScale=f[e].scale),q.maxZoom===f[e].level&&
(q.maxScale=f[e].scale)}else q.minZoom=q.maxZoom=q.zoom=-1}a instanceof S?(this._gc||(this._gc=new S._GraphicsContainer,this._gc._setMap(this,this._layersDiv).id=k+"_gc"),f=a._setMap(this,this._gc._surface),f.id=k+"_"+n,this._layerDivs[n]=f,this._reorderLayers(this.graphicsLayerIds)):(f=a._setMap(this,this._layersDiv,t,this.__LOD),f.id=k+"_"+n,this._layerDivs[n]=f,this._reorderLayers(this.layerIds),r||-1===a.declaredClass.indexOf("VETiledLayer")||this._onBingLayerAdd(a));if(n===this._firstLayerId&&
(this.graphics=new S({id:k+"_graphics",displayOnPan:q.displayGraphicsOnPan}),this._addLayer(this.graphics,this._internalLayerIds,20)),a===this.graphics){var h;e=this._layers[this._firstLayerId];k=q.zoom;f=q.scale;t=q.center;e=e.initialExtent||e.fullExtent;if(this._firstLayerId=null,this.extent&&(this.extent=this._convertGeometry(this,this.extent)),!this.extent&&e&&(t&&(t=this._convertGeometry(e,t)),t&&(e=e.centerAt(t))),h=this.extent||e&&new L(e.toJson()),h&&(-1<k?h=this.__getExtentForLevel(k,null,
h).extent:0<f&&(h=Q.getExtentForScale(this,f,h))),!h)return;q=this._fixExtent(h,q.fitExtent);this.extent=q.extent;this.__LOD=q.lod;this.__setExtent(this.extent);this.loaded=!0;this.attr("data-loaded","");this.infoWindow.setMap(this);this.onLoad(this)}r||(this.onLayerAdd(a),this.onLayerAddResult(a));ca(this[n+"_addLayerHandler_connect"])},_convertGeometry:function(a,c){var b=a&&a.spatialReference,e=c&&c.spatialReference;return b&&e&&!b.equals(e)&&(b._canProject(e)?b.isWebMercator()?c=T.geographicToWebMercator(c):
4326===b.wkid&&(c=T.webMercatorToGeographic(c,!0)):c=null),c},_reorderLayers:function(a){var c=this.onLayerReorder,b=r.place,e=this._layerDivs,g=this._layers,d=this._gc?this._gc._surface.getEventSource():null;if(a===this.graphicsLayerIds)m.forEach(a,function(a,f){var k=e[a];k&&(b(k.getEventSource(),d,f),c(g[a],f))});else{var f,k=this.graphics,n=k?k.id:null,q=this._layersDiv;m.forEach(a,function(a,d){f=e[a];a!==n&&f&&(b(f,q,d),c(g[a],d))});this._mapImageLyr&&this._placeMapImageLyr();d&&(d=9>t("ie")?
d.parentNode:d,b(d,d.parentNode,a.length))}this.onLayersReordered([].concat(a))},_zoomStartHandler:function(){this.__zoomStart(this._zoomAnimDiv.startingExtent,this._zoomAnimDiv.anchor)},_zoomingHandler:function(a){var c=parseFloat(a.left),b=parseFloat(a.top);a=new L(c,b-parseFloat(a.height),c+parseFloat(a.width),b,this.spatialReference);c=this.extent.getWidth()/a.getWidth();this.__zoom(a,c,this._zoomAnimDiv.anchor)},_zoomEndHandler:function(){var a=this._zoomAnimDiv,c=a.extent,b=this.extent.getWidth()/
c.getWidth(),e=a.anchor,g=a.newLod,d=a.levelChange;a.extent=a.anchor=a.levelChange=a.startingExtent=a.newLod=this._delta=this._zoomAnim=null;this.__zoomEnd(c,b,e,g,d)},_panningHandler:function(a){if(isNaN(parseFloat(a.left))||isNaN(parseFloat(a.top))){var c=Math.round,b=this._panAnim.node;a.left=-1*(this._delta.x-c(this.width/2))+"px";a.top=-1*(this._delta.y-c(this.height/2))+"px";v.set(b,"left",a.left);v.set(b,"top",a.top)}a=new I(parseFloat(a.left),parseFloat(a.top));c=this.toMap(a);this.onPan(this.extent.offset(this.extent.xmin-
c.x,this.extent.ymax-c.y),a)},_panEndHandler:function(a){this.__panning=!1;var c=Math.round;a=new I(-c(parseFloat(a.style.left)),-c(parseFloat(a.style.top)));var c=a.x,b=a.y,e=this.__visibleRect,g=this.__visibleDelta;e.x+=-c;e.y+=-b;g.x+=-c;g.y+=-b;la(this._zoomAnimDiv,{left:"0px",top:"0px"});var e=this.extent,g=this._ratioW,d=this._ratioH,e=new L(e.xmin+c/g,e.ymin-b/d,e.xmax+c/g,e.ymax-b/d,this.spatialReference);a.setX(-a.x);a.setY(-a.y);this._delta=this._panAnim=null;this._updateExtent(e);this.onPanEnd(e,
a);this._fireExtChg([e,a,!1,this.__LOD])},_fixExtent:function(a,c){for(var b=this._reshapeExtent(a),e=1.25;!0===c&&(b.extent.getWidth()<a.getWidth()||b.extent.getHeight()<a.getHeight())&&0<b.lod.level&&3>=e;)b=this._reshapeExtent(a.expand(e)),e+=.25;return b},_getFrameWidth:function(){var a=-1,c=this.spatialReference._getInfo();this.__LOD?(c=this.__LOD._frameInfo)&&(a=c[3]):c&&(a=Math.round(2*c.valid[1]/(this.extent.getWidth()/this.width)));return a},_fixAspectRatio:function(a){var c=a.getWidth(),
b=a.getHeight(),e=c/b,g=this.width/this.height,d=0,f=0;return this.width>this.height?c>b?g>e?d=b*g-c:f=c/g-b:d=b*g-c:this.width<this.height?b>c&&g>e?d=b*g-c:f=c/g-b:b>c?d=b-c:c>b&&(f=c/g-b),d&&(a.xmin-=d/2,a.xmax+=d/2),f&&(a.ymin-=f/2,a.ymax+=f/2),a},_reshapeExtent:function(a){return a=this._fixAspectRatio(a),this._getAdjustedExtent(a)},_getAdjustedExtent:function(a){if(this.__tileInfo)return F.getCandidateTileInfo(this,this.__tileInfo,a);var c=Q.getScale(this,a),b=this.getMinScale(),e=this.getMaxScale();
return!b||b>=c?!e||c>=e||(a=Q.getExtentForScale(this,e,a)):a=Q.getExtentForScale(this,b,a),{extent:a}},_onBingLayerAdd:function(a){this["__"+a.id+"_vis_connect"]=b.connect(a,"onVisibilityChange",this,"_toggleBingLogo");this._toggleBingLogo(a.visible)},_onBingLayerRemove:function(a){b.disconnect(this["__"+a.id+"_vis_connect"]);delete this["__"+a.id+"_vis_connect"];var c=m.some(this.layerIds,function(c){return a=this._layers[c],a&&a.visible&&-1!==a.declaredClass.indexOf("VETiledLayer")},this);this._toggleBingLogo(c)},
_toggleBingLogo:function(a){a&&!this._bingLogo?(a={left:this._mapParams&&this._mapParams.nav?"25px":""},6===t("ie")&&(a.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+h.toUrl("./images/map/bing-logo-lg.png")+"')"),a=this._bingLogo=r.create("div",{style:a},this.root),q.add(a,"bingLogo-lg")):!a&&this._bingLogo&&(r.destroy(this._bingLogo),delete this._bingLogo)},__panStart:function(a,c){var b=this._zoomAnim,e=this._panAnim;if(b&&b._active)b.stop(),
b._fire("onEnd",[b.node]);else if(e&&e._active){e.stop();this._panAnim=null;var e=e.curve.getValue(e._getStep()),b=Math.round(parseFloat(e.left)),e=Math.round(parseFloat(e.top)),g=this.navigationManager._dragOrigin;return this.__pan(b,e),void(g&&(g.x-=b,g.y-=e))}this.__panning=!0;this.onPanStart(this.extent,new I(a,c))},__pan:function(a,c){var b=this.extent,e=this._ratioW,g=this._ratioH;this.onPan(new L(b.xmin-a/e,b.ymin+c/g,b.xmax-a/e,b.ymax+c/g,this.spatialReference),new I(a,c))},__panEnd:function(a,
c){var b=this.__visibleRect,e=this.__visibleDelta;b.x+=a;b.y+=c;e.x+=a;e.y+=c;var b=new I(a,c),e=this.extent,g=this._ratioW,d=this._ratioH,e=new L(e.xmin-a/g,e.ymin+c/d,e.xmax-a/g,e.ymax+c/d,this.spatialReference);this.__panning=!1;this._updateExtent(e);this.onPanEnd(e,b);this._fireExtChg([e,b,!1,this.__LOD])},__zoomStart:function(a,c){this.__zooming=!0;this.onZoomStart(a,1,c,this.__LOD?this.__LOD.level:null)},__zoom:function(a,c,b){this.onZoom(a,c,b)},__zoomEnd:function(a,c,b,e,g){la(this._layersDiv,
{left:"0px",top:"0px"});this._delta=new I(0,0);this.__visibleRect.x=this.__visibleRect.y=0;a=new L(a);this.__LOD=e;this._ratioW=this.width/a.getWidth();this._ratioH=this.height/a.getHeight();var d=this._delta;this._delta=null;this.__zooming=!1;this._updateExtent(a,g);this.onZoomEnd(a,c,b,e?e.level:null);this._fireExtChg([a,d,g,e])},_extentUtil:function(a,c,b,e,g){var d,n,m,t,r,q,u,h,v,l,w,x,y,C=new f,A=this.width,z=this.height;a&&(d=a.numLevels,n=a.targetLevel,w=B.isDefined(n),m=a.factor,t=a.mapAnchor,
r=a.screenAnchor,q=a.mapCenter,x=a.levelOrFactor,u=a.targetScale,h=B.isDefined(u)&&0<u);c&&(v=c.dx,l=c.dy,q=c.mapCenter);k.isArray(q)&&(q=new J(q));var D=this._panAnim;c=(a=this._stopAnim())?a.divExtent:this.extent;var E=this.__tileInfo,F=this._params;if(!this.loaded)return b?(c&&(b=this._convertGeometry(c,b)),b&&(this.extent=b,F.zoom=F.scale=-1,F.center=null)):(q||w||h)&&(q&&(c?(q=this._convertGeometry(c,q),q&&(this.extent=c.centerAt(q),F.center=null)):F.center=q),w&&-1<n?(F.zoom=n,F.scale=-1):h&&
(F.scale=u,F.zoom=-1)),C.resolve(),C;if(q&&(q=this._convertGeometry(this,q),!q)||t&&(t=this._convertGeometry(this,t),!t)||b&&(b=this._convertGeometry(this,b),!b))return C.reject(),C;if(D&&t&&r&&(t=va(this.extent,A,z,r)),a&&t&&r&&(t=va(a.divExtent,A,z,r)),w)E?(d=this.getMinZoom(),w=this.getMaxZoom(),d>n?n=d:n>w&&(n=w),d=n-(a?a.level:this.getLevel())):(d=0<n?-1:1,y=x?n:null);if(!b)if(B.isDefined(d))E?(A=a?a.level:this.getLevel(),A=this.__getExtentForLevel(A+d,q,c).extent):(A=(a?a.end:this.extent).expand(y||
(0<d?.5*d:2*-d)),y&&q&&(A=A.centerAt(q))),A&&(q?b=A:(v=t||c.getCenter(),z=A.getWidth(),l=A.getHeight(),A=v.x>=c.xmin&&v.x<=c.xmax?(v.x-c.xmin)/c.getWidth():.5,b=v.y>=c.ymin&&v.y<=c.ymax?(v.y-c.ymin)/c.getHeight():.5,A=v.x-A*z,v=v.y-b*l,b=new L(A,v,A+z,v+l,this.spatialReference)));else if(h)b=Q.getExtentForScale(this,u,c);else if(B.isDefined(m))b=c.expand(m);else if(v||l)a?(b=a.end,t=b.getCenter(),y=ua(b,A,z,t),y.x+=v,y.y+=l,y=va(b,A,z,y),b=b.offset(y.x-t.x,y.y-t.y)):(v=new I(A/2+v,z/2+l),v=va(c,A,
z,v),z=c.getWidth(),l=c.getHeight(),A=v.x-z/2,v=v.y-l/2,b=new L(A,v,A+z,v+l,this.spatialReference));b||(q?(c=a?a.end:c,z=c.getWidth(),l=c.getHeight(),A=q.x-z/2,v=q.y-l/2,b=new L(A,v,A+z,v+l,this.spatialReference)):a&&(b=a.end));return b?(this._extentDfd&&-1===this._extentDfd.fired&&(this._extentDfd.then(null,Ca),this._extentDfd.reject()),this._extentDfd=C,this.__setExtent(b,null,r,e,a,g)):C.reject(),C},__setExtent:function(a,c,b,e,g,d){try{if(this._firstLayerId)return void(this.extent=a);var f=!0,
k=this.spatialReference,n=g?g.divExtent:this.extent,m=this._fixExtent(a,e||!1);a=m.extent;var t=a.getWidth(),r=a.getHeight(),q=Math.round;if(n)var u=q(1E6*n.getWidth()),h=q(1E6*t),v=q(1E6*n.getHeight()),l=q(1E6*r),f=u!==h||v!==l;var w,x,y=g&&g.rect,C=g&&g.divExtent;if(ra.zoomDuration&&f&&n){C=C||new L(n);y=y||{left:n.xmin,top:n.ymax,width:n.getWidth(),height:n.getHeight()};x={left:a.xmin,top:a.ymax,width:t,height:r};var A=new J(a.xmin,a.ymax,k),z=new J(a.xmin,a.ymin,k),B=new J(this.extent.xmin,this.extent.ymax,
k),E=new J(this.extent.xmin,this.extent.ymin,k);(w=N.getLineIntersection(B,A,E,z,k))||g||(f=!1)}this._ratioW=this.width/t;this._ratioH=this.height/r;var F=this._zoomAnimDiv;if(f)if(la(this._layersDiv,{left:"0px",top:"0px"}),c=new I(0,0),this.__visibleRect.x=this.__visibleRect.y=0,y&&x){this._delta=c;F.id="_zAD";F.startingExtent=C;F.extent=a;F.levelChange=f;F.newLod=m.lod;b?F.anchor=b:!w&&g?F.anchor=g.anchor:F.anchor=ua(this.extent,this.width,this.height,w);var H=this.extent.getWidth()/a.getWidth();
1024<(1>H?1/H:H)?(this.__zoomStart(C,F.anchor),this.__zoom(C,1,F.anchor),this._fireOnScale(1,F.anchor,!0),this.__zoomEnd(a,H,F.anchor,m.lod,f)):(this._zoomAnim=D.resize({node:F,start:y,end:x,duration:ra.zoomDuration,rate:ra.zoomRate,beforeBegin:g?null:this._zoomStartHandler,onAnimate:this._zoomingHandler,onEnd:this._zoomEndHandler}).play(),this._fireOnScale(H,F.anchor,d))}else this._updateExtent(a,f,d),this._fireExtChg([this.extent,c,f,this.__LOD=m.lod]);else if(!this.__panning)if(!1===this.loaded||
d)this._updateExtent(a,f,d),this._fireExtChg([this.extent,c,f,this.__LOD=m.lod]);else{this.__panning=!0;y=(new M(0,0,this.width,this.height,this.spatialReference)).getCenter();y.x=q(y.x);y.y=q(y.y);var ea=this._delta=this.toScreen(a.getCenter()),fa=Math.abs(y.x-ea.x),G=Math.abs(y.y-ea.y);this.optimizePanAnimation&&(fa>2*this.width||G>2*this.height)?(this.__panStart(0,0),this.__pan(0,0),this.__visibleRect.x=this.__visibleRect.y=this.__visibleDelta.x=this.__visibleDelta.y=0,this.__panning=!1,this._delta=
null,this._updateExtent(a,!1,d),this.onPanEnd(this.extent,new I(0,0)),this._fireExtChg([this.extent,new I(0,0),!0,this.__LOD])):(this.onPanStart(this.extent,new I(0,0)),this._panAnim=D.slideTo({node:F,left:y.x-ea.x,top:y.y-ea.y,duration:ra.panDuration,rate:ra.panRate,onAnimate:this._panningHandler,onEnd:this._panEndHandler}),this._panAnim.play())}}catch(Q){console.error(Q)}},_fireOnScale:function(a,c,b){if("css-transforms"===this.navigationMode){var e=this.__visibleDelta;this.onScale(x.scaleAt(a,
{x:-1*(this.width/2-(c.x-e.x)),y:-1*(this.height/2-(c.y-e.y))}),b)}},_stopAnim:function(){var a=this._zoomAnim,c=this._panAnim;if(a&&a._active){a.stop();var c=a.curve.getValue(a._getStep()),b=parseFloat(c.left),e=parseFloat(c.top),a=a.node;return{anchor:a.anchor,start:a.startingExtent,end:a.extent,level:a.newLod&&a.newLod.level,rect:c,divExtent:new L(b,e-parseFloat(c.height),b+parseFloat(c.width),e,this.spatialReference)}}c&&c._active&&(c.stop(),c._fire("onEnd",[c.node]))},__getExtentForLevel:function(a,
c,b){var e=this.__tileInfo,e=e&&e.lods;if(a=B.isDefined(a)?a:0,b=b||this.extent,c=c||b&&b.getCenter(),e){if(!c)return;b=this.getMinZoom();var g=this.getMaxZoom();a>g&&(a=g);b>a&&(a=b);a=e[a];e=this.width*a.resolution/2;b=this.height*a.resolution/2;return{extent:new L(c.x-e,c.y-b,c.x+e,c.y+b,c.spatialReference),lod:a}}return b?(a=!a||1>a?1:a,{extent:b.expand(a).centerAt(c)}):void 0},_jobs:0,_incr:function(){1===++this._jobs&&(this.updating=!0,this.attr("data-updating",""),this.onUpdateStart())},_decr:function(){var a=
--this._jobs;a?0>a&&(this._jobs=0):(this.updating=!1,this.attr("data-updating"),this.onUpdateEnd())},_fireEvent:function(a,c){this[a]&&this[a].apply(this,c)},_updateExtent:function(a,c,b){this.extent=a;this._view=new K({viewingMode:"map",scale:this.getScale()});(c||b)&&this._setClipRect();(a=this.spatialReference)&&(a.isWebMercator()?this.geographicExtent=T.webMercatorToGeographic(this._getAvailExtent(),!0):4326===a.wkid&&(this.geographicExtent=new L(this._getAvailExtent().toJson())))},_fireExtChg:function(a){this.attr("data-zoom",
this.getZoom());this.attr("data-scale",this.getScale());this._fireEvent("onExtentChange",a);(a=this._extentDfd)&&(delete this._extentDfd,a.resolve())},attr:function(a,c){var b=this.container;return b&&(null==c?b.removeAttribute(a):b.setAttribute(a,c)),this},onUpdateStart:function(){},onUpdateEnd:function(){},onLoad:function(){this._setClipRect()},onBeforeUnload:function(){},onUnload:function(){},onExtentChange:function(a,c,b){},onTimeExtentChange:function(){},onLayerAdd:function(){},onLayerAddResult:function(){},
onLayersAddResult:function(){},onLayerRemove:function(){},onLayersRemoved:function(){},onLayerReorder:function(){},onLayersReordered:function(){},onLayerSuspend:function(){},onLayerResume:function(){},onPanStart:function(){},onPan:function(){},onPanEnd:function(){},onScale:function(){},onZoomStart:function(){},onZoom:function(){},onZoomEnd:function(){},onResize:function(){this._setClipRect()},onReposition:function(){},destroy:function(){this._destroyed||(this.onBeforeUnload(this),this.removeAllLayers(),
this._cleanUp(),clearTimeout(this._resizeT),this._gc&&this._gc._cleanUp(),this._destroyed=!0,this.onUnload(this))},setCursor:function(a){la(this.__container,"cursor",this.cursor=a)},setMapCursor:function(a){this.setCursor(this._cursor=a)},resetMapCursor:function(){this.setCursor(this._cursor)},setInfoWindow:function(a){var c=this.infoWindow;c&&c.unsetMap(this);this.infoWindow=a;this.loaded&&a&&a.setMap(this)},setInfoWindowOnClick:function(a){this._params.showInfoWindowOnClick=a;this.popupManager&&
this.popupManager.set("enabled",a)},getInfoWindowAnchor:function(a){return this.infoWindow&&this.infoWindow._getAnchor&&this.infoWindow._getAnchor(a)||"upperright"},toScreen:function(a,c){return ua(this.extent,this.width,this.height,a,c)},toMap:function(a){return va(this.extent,this.width,this.height,a)},addLayer:function(a,c){return a&&!this.getLayer(a.id)&&this._addLayer(a,a instanceof S?this.graphicsLayerIds:this.layerIds,c),a},addLayers:function(a){var c,e,g=[],d=a.length,f=a.length;c=b.connect(this,
"onLayerAddResult",function(e,f){-1!==m.indexOf(a,e)&&(d--,g.push({layer:e,success:!f,error:f}),d||(b.disconnect(c),this.onLayersAddResult(g)))});for(e=0;f>e;e++)this.addLayer(a[e]);return this},removeLayer:function(a,c){var b=a.id,e=a instanceof S?this.graphicsLayerIds:this.layerIds,g=ka(e,b);0<=g&&(e.splice(g,1),a instanceof S?(ca(this["_gl_"+a.id+"_click_connect"]),a.loaded&&a._unsetMap(this,this._gc._surface)):a.loaded&&(a._unsetMap(this,this._layersDiv),-1!==a.declaredClass.indexOf("VETiledLayer")&&
this._onBingLayerRemove(a)),delete this._layers[b],delete this._layerDivs[b],c||this._reorderLayers(e),this.onLayerRemove(a))},removeAllLayers:function(){var a,c=this.layerIds;for(a=c.length-1;0<=a;a--)this.removeLayer(this._layers[c[a]],1);c=this.graphicsLayerIds;for(a=c.length-1;0<=a;a--)this.removeLayer(this._layers[c[a]],1);this.onLayersRemoved()},reorderLayer:function(c,b){k.isString(c)&&(a.deprecated(this.declaredClass+": Map.reorderLayer(/*String*/ id, /*Number*/ index) deprecated. Use Map.reorderLayer(/*Layer*/ layer, /*Number*/ index).",
null,"v2.0"),c=this.getLayer(c));var e,g=c.id,d=c instanceof S?this.graphicsLayerIds:this.layerIds;0>b?b=0:b>=d.length&&(b=d.length-1);e=ka(d,g);-1!==e&&e!==b&&(d.splice(e,1),d.splice(b,0,g),this._reorderLayers(d))},getLayer:function(a){return this._layers[a]},setExtent:function(a,c){a=new L(a.toJson());var b=a.getWidth(),e=a.getHeight();return 0===b&&0===e?this.centerAt(new J({x:a.xmin,y:a.ymin,spatialReference:a.spatialReference&&a.spatialReference.toJson()})):this._extentUtil(null,null,a,c)},centerAt:function(a){return this._extentUtil(null,
{mapCenter:a})},centerAndZoom:function(a,c){return this._extentUtil({targetLevel:c,mapCenter:a,levelOrFactor:!0})},getScale:function(){return this.__LOD?this.__LOD.scale:Q.getScale(this)},getResolution:function(){return this.__LOD?this.__LOD.resolution:this.extent?this.extent.getWidth()/this.width:0},getResolutionInMeters:function(){return this.getResolution()*Q.getUnitValueForSR(this.spatialReference)},getMinScale:function(){return this._params.minScale},getMaxScale:function(){return this._params.maxScale},
_getView:function(){return this._view},setScale:function(a){return this._extentUtil({targetScale:a})},getLayersVisibleAtScale:function(a){var c=[];return a=a||this.getScale(),a&&m.forEach(this.layerIds.concat(this.graphicsLayerIds),function(b){b=this.getLayer(b);b.isVisibleAtScale(a)&&c.push(b)},this),c},getNumLevels:function(){var a=this.getMinZoom(),c=this.getMaxZoom();return a===c&&0>a?0:c-a+1},getLevel:function(){return this.__LOD?this.__LOD.level:-1},setLevel:function(a){return-1<a?this._extentUtil({targetLevel:a}):
void 0},getZoom:function(){return this.getLevel()},setZoom:function(a){return this.setLevel(a)},getMinZoom:function(){return this._params.minZoom},getMaxZoom:function(){return this._params.maxZoom},setBasemap:function(a){var c;if(k.isObject(a)?(c=a,a=c.title):c=A&&A[a],c){this._basemapDfd&&-1===this._basemapDfd.fired&&this._basemapDfd.cancel();var e=[],g=[],d=0;if(m.forEach(c.baseMapLayers||c.layers,function(a){var c,b={id:a.id,displayLevels:a.displayLevels,opacity:B.isDefined(a.opacity)?a.opacity:
null,visible:B.isDefined(a.visibility)?a.visibility:null};if(a.type)switch(a.type){case "OpenStreetMap":c=new ea(b);break;case "VectorTile":c=H.normalize(a.url),c=new oa(c,b)}else c=H.normalize(a.url),c=new W(c,b);c&&(e.push(c),g.push(a),a.isReference||d++)},this),e.length&&d){var n={basemapName:a,infos:g,layers:e};if(!this.loaded)return void this._basemapLoaded(n);var t=this,r=new f(E._dfdCanceller),q=function(a){r._pendingLayers--;a=m.indexOf(n.layers,this);-1<a&&(a=r._layerEvents[a])&&(b.disconnect(a[0]),
b.disconnect(a[1]));0>=r._pendingLayers&&(delete r._layerEvents,delete t._basemapDfd,0>r.fired&&r.callback(n))};this._basemapDfd=r;r._pendingLayers=0;r._layerEvents={};m.forEach(e,function(a,c){a&&(r._pendingLayers++,a.loaded?q(a):r._layerEvents[c]=[b.connect(a,"onLoad",a,q),b.connect(a,"onError",a,q)])});r.addCallback(ja(this,this._basemapLoaded))}}else{var u;a=[];for(u in A)a.push(u)}},_basemapLoaded:function(a){var c,b=a.layers,e=a.infos,g=0,d=!0;this.loaded&&(m.forEach(b,function(a,c){a.loaded&&
(e[c].isReference||g++)}),d=g);d&&(this.basemapLayerIds&&(c={basemapName:this._basemap,infos:A&&A[this._basemap]&&A[this._basemap].baseMapLayers},c.basemapName||(m.forEach(this.basemapLayerIds,function(a){return this.getLayer(a)instanceof ea?(c.basemapName="osm",c.infos=A&&A.osm&&A.osm.baseMapLayers,!1):void 0},this),c.basemapName||(c=null))),this._removeBasemap(),this._basemap=a.basemapName,this.basemapLayerIds=this._addBasemap(b,e),this.attr("data-basemap",this.getBasemap()),this.emit("basemap-change",
{current:a,previous:c}))},_addBasemap:function(a,c){var b=[],e=[],g=0;return m.forEach(a,function(a,d){c[d].isReference?b.push(a):(this.addLayer(a,g++),e.push(a.id))},this),b.length&&m.forEach(b,function(a){a.attr("data-reference",!0);this.addLayer(a,"top");e.push(a.id)},this),e},_removeBasemap:function(){var a,c=this.basemapLayerIds;c&&c.length&&m.forEach(c,function(c){(a=this.getLayer(c))&&this.removeLayer(a)},this)},getBasemap:function(){return this._basemap||""},translate:function(a,c){if(a=a||
0,c=c||0,!this._txTimer){this._tx=this._ty=0;var b=this.toScreen(this.extent.getCenter());this.__panStart(b.x,b.y)}this._tx+=a;this._ty+=c;this.__pan(this._tx,this._ty);clearTimeout(this._txTimer);this._txTimer=setTimeout(this._endTranslate,150)},_endTranslate:function(){clearTimeout(this._txTimer);this._txTimer=null;var a=this._tx,c=this._ty;this._tx=this._ty=0;this.__panEnd(a,c)},setTimeExtent:function(a){a=(this.timeExtent=a)?new a.constructor(a.toJson()):null;this.onTimeExtentChange(a)},setTimeSlider:function(a){this.timeSlider&&
(ca(this._tsTimeExtentChange_connect),this._tsTimeExtentChange_connect=null,this.timeSlider=null);a&&(this.timeSlider=a,this.setTimeExtent(a.getCurrentTimeExtent()),this._tsTimeExtentChange_connect=qa(a,"onTimeExtentChange",this,"setTimeExtent"))},setVisibility:function(a){if(this.visible!==a){if(this.visible=a,a||(this._display=this.container.style.display),this.container.style.display=a?this._display:"none",this.autoResize){var c=a?"resume":"pause";this._rszSignal[c]();this._oriSignal[c]()}a&&this.resize()}return this},
resize:function(a){clearTimeout(this._resizeT);this._destroyed||(!0===a?this._execResize():this._resizeT=setTimeout(this._execResize,this.resizeDelay))},_timedResize:function(){this._resizeT||this._execResize()},_execResize:function(){clearTimeout(this._resizeT);this._resizeT=null;this.reposition();this._resize();this.autoResize&&this._startResizeTimer()},_resize:function(){var a=this.width,c=this.height,b=v.get(this.container,"display"),e=u.getContentBox(this.container);if(!("none"===b||0>=e.w||
0>=e.h||a===e.w&&c===e.h)){(b=this._zoomAnim||this._panAnim)&&(b.stop(),b._fire("onEnd",[b.node]));la(this.root,{width:(this.width=e.w)+"px",height:(this.height=e.h)+"px"});e=this.width;b=this.height;this.attribution&&this.attribution.domNode&&v.set(this.attribution.domNode,"maxWidth",Math.floor(e*this._mapParams.attributionWidth)+"px");this.__visibleRect.update(this.__visibleRect.x,this.__visibleRect.y,e,b);this.__visibleDelta.update(this.__visibleDelta.x,this.__visibleDelta.y,e,b);var g=new M(this.extent),
a=(new M(g.x,g.y,e/a*g.width,b/c*g.height,this.spatialReference)).getExtent();this.onResize(a,e,b);this._extentUtil(null,null,a,null,!0)}},reposition:function(){var a=this.position,c=a.x,b=a.y;this._reposition();a=this.position;c===a.x&&b===a.y||this.onReposition(a.x,a.y)},_reposition:function(){var a=u.position(this.container,!0),c=u.getPadBorderExtents(this.container);this.position.update(a.x+c.l,a.y+c.t)},_setClipRect:function(){delete this._clip;var a=7>=t("ie")||void 0===t("ie")&&7<=t("trident")?
"rect(auto,auto,auto,auto)":"auto";if(this.wrapAround180){var c=this.width,b=this.height,e=this._getFrameWidth(),g=c-e;0<g&&(a=g/2,a="rect(0px,"+(a+e)+"px,"+b+"px,"+a+"px)",b=this.extent.getWidth(),c=e/c*b,this._clip=[(b-c)/2,c])}la(this.__container,"clip",a)},_getAvailExtent:function(){var a=this.extent,c=this._clip;if(c){if(!a._clip){var b=new M(a);b.width=c[1];b.x+=c[0];a._clip=b.getExtent()}return a._clip}return a},_fixedPan:function(a,c){return this._extentUtil(null,{dx:a,dy:c})},panUp:function(){return this._fixedPan(0,
-.75*this.height)},panUpperRight:function(){return this._fixedPan(.75*this.width,-.75*this.height)},panRight:function(){return this._fixedPan(.75*this.width,0)},panLowerRight:function(){return this._fixedPan(.75*this.width,.75*this.height)},panDown:function(){return this._fixedPan(0,.75*this.height)},panLowerLeft:function(){return this._fixedPan(-.75*this.width,.75*this.height)},panLeft:function(){return this._fixedPan(-.75*this.width,0)},panUpperLeft:function(){return this._fixedPan(-.75*this.width,
-.75*this.height)},enableSnapping:function(a){if(a=a||{},"esri.SnappingManager"===a.declaredClass)this.snappingManager=a;else{var c=Ea++,b=this;this._rids&&this._rids.push(c);h(["./SnappingManager"],function(e){var g=b._rids?m.indexOf(b._rids,c):-1;-1!==g&&(b._rids.splice(g,1),b.snappingManager=new e(k.mixin({map:b},a)))})}return this.snappingManager},disableSnapping:function(){this.snappingManager&&this.snappingManager.destroy();this.snappingManager=null},_createLabelLayer:function(){!this._labels&&
ta&&this.loaded&&(this._labels=new ta({id:"_internal_LabelLayer"}),this._labels._setMap(this,this._gc._surface),this._processLabelLayers(),this.on("layers-reordered",this._processLabelLayers))},_processLabelLayers:function(){null==this._labelProcessor&&(this._labelProcessor=setTimeout(this._updateLabelLayers,0))},_updateLabelLayers:function(){this._labelProcessor=null;this._labels&&(this._labels.removeAllFeatureLayers(),m.forEach(this.graphicsLayerIds,function(a){a=this.getLayer(a);"function"==typeof a.applyEdits?
this._labels.addFeatureLayer(a):"esri.layers.WFSLayer"===a.declaredClass&&this._labels.addFeatureLayer(a)},this))},_getMapImageLyr:function(){return this.loaded&&!this._mapImageLyr&&(this._mapImageLyr=new fa,this._mapImageLyr._setMap(this,this._layersDiv),this._placeMapImageLyr()),this._mapImageLyr},_placeMapImageLyr:function(){for(var a,c,b=this.layerIds,e=this._layerDivs,g=!1,d=b.length-1;0<=d;d--){var f=b[d];if(c=this.getLayer(f),a=e[f],c&&a&&!c._isReference){r.place(this._mapImageLyr._div,a,"after");
g=!0;break}}g||r.place(this._mapImageLyr._div,this._layersDiv,"first")}});return t("extend-esri")&&(y._CoreMap=d),d})},"dojo/_base/unload":function(){define(["./kernel","./lang","../on"],function(h,l,a){var d=window,b={addOnWindowUnload:function(b,k){h.windowUnloaded||a(d,"unload",h.windowUnloaded=function(){});a(d,"unload",l.hitch(b,k))},addOnUnload:function(b,k){a(d,"beforeunload",l.hitch(b,k))}};h.addOnWindowUnload=b.addOnWindowUnload;h.addOnUnload=b.addOnUnload;return b})},"dojox/gfx/matrix":function(){define(["./_base",
"dojo/_base/lang"],function(h,l){var a=h.matrix={},d={};a._degToRad=function(a){return d[a]||(d[a]=Math.PI*a/180)};a._radToDeg=function(a){return a/Math.PI*180};a.Matrix2D=function(b){if(b)if("number"==typeof b)this.xx=this.yy=b;else if(b instanceof Array){if(0<b.length){for(var d=a.normalize(b[0]),k=1;k<b.length;++k){var m=d,g=a.normalize(b[k]),d=new a.Matrix2D;d.xx=m.xx*g.xx+m.xy*g.yx;d.xy=m.xx*g.xy+m.xy*g.yy;d.yx=m.yx*g.xx+m.yy*g.yx;d.yy=m.yx*g.xy+m.yy*g.yy;d.dx=m.xx*g.dx+m.xy*g.dy+m.dx;d.dy=m.yx*
g.dx+m.yy*g.dy+m.dy}l.mixin(this,d)}}else l.mixin(this,b)};l.extend(a.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});l.mixin(a,{identity:new a.Matrix2D,flipX:new a.Matrix2D({xx:-1}),flipY:new a.Matrix2D({yy:-1}),flipXY:new a.Matrix2D({xx:-1,yy:-1}),translate:function(b,d){return 1<arguments.length?new a.Matrix2D({dx:b,dy:d}):new a.Matrix2D({dx:b.x,dy:b.y})},scale:function(b,d){return 1<arguments.length?new a.Matrix2D({xx:b,yy:d}):"number"==typeof b?new a.Matrix2D({xx:b,yy:b}):new a.Matrix2D({xx:b.x,yy:b.y})},
rotate:function(b){var d=Math.cos(b);b=Math.sin(b);return new a.Matrix2D({xx:d,xy:-b,yx:b,yy:d})},rotateg:function(b){return a.rotate(a._degToRad(b))},skewX:function(b){return new a.Matrix2D({xy:Math.tan(b)})},skewXg:function(b){return a.skewX(a._degToRad(b))},skewY:function(b){return new a.Matrix2D({yx:Math.tan(b)})},skewYg:function(b){return a.skewY(a._degToRad(b))},reflect:function(b,d){1==arguments.length&&(d=b.y,b=b.x);var k=b*b,m=d*d,g=k+m,e=2*b*d/g;return new a.Matrix2D({xx:2*k/g-1,xy:e,yx:e,
yy:2*m/g-1})},project:function(b,d){1==arguments.length&&(d=b.y,b=b.x);var k=b*b,m=d*d,g=k+m,e=b*d/g;return new a.Matrix2D({xx:k/g,xy:e,yx:e,yy:m/g})},normalize:function(b){return b instanceof a.Matrix2D?b:new a.Matrix2D(b)},isIdentity:function(a){return 1==a.xx&&0==a.xy&&0==a.yx&&1==a.yy&&0==a.dx&&0==a.dy},clone:function(b){var d=new a.Matrix2D,k;for(k in b)"number"==typeof b[k]&&"number"==typeof d[k]&&d[k]!=b[k]&&(d[k]=b[k]);return d},invert:function(b){b=a.normalize(b);var d=b.xx*b.yy-b.xy*b.yx;
return b=new a.Matrix2D({xx:b.yy/d,xy:-b.xy/d,yx:-b.yx/d,yy:b.xx/d,dx:(b.xy*b.dy-b.yy*b.dx)/d,dy:(b.yx*b.dx-b.xx*b.dy)/d})},_multiplyPoint:function(a,d,k){return{x:a.xx*d+a.xy*k+a.dx,y:a.yx*d+a.yy*k+a.dy}},multiplyPoint:function(b,d,k){b=a.normalize(b);return"number"==typeof d&&"number"==typeof k?a._multiplyPoint(b,d,k):a._multiplyPoint(b,d.x,d.y)},multiplyRectangle:function(b,d){var k=a.normalize(b);d=d||{x:0,y:0,width:0,height:0};if(a.isIdentity(k))return{x:d.x,y:d.y,width:d.width,height:d.height};
var m=a.multiplyPoint(k,d.x,d.y),g=a.multiplyPoint(k,d.x,d.y+d.height),e=a.multiplyPoint(k,d.x+d.width,d.y),c=a.multiplyPoint(k,d.x+d.width,d.y+d.height),k=Math.min(m.x,g.x,e.x,c.x),n=Math.min(m.y,g.y,e.y,c.y),q=Math.max(m.x,g.x,e.x,c.x),m=Math.max(m.y,g.y,e.y,c.y);return{x:k,y:n,width:q-k,height:m-n}},multiply:function(b){for(var d=a.normalize(b),k=1;k<arguments.length;++k){var m=d,g=a.normalize(arguments[k]),d=new a.Matrix2D;d.xx=m.xx*g.xx+m.xy*g.yx;d.xy=m.xx*g.xy+m.xy*g.yy;d.yx=m.yx*g.xx+m.yy*
g.yx;d.yy=m.yx*g.xy+m.yy*g.yy;d.dx=m.xx*g.dx+m.xy*g.dy+m.dx;d.dy=m.yx*g.dx+m.yy*g.dy+m.dy}return d},_sandwich:function(b,d,k){return a.multiply(a.translate(d,k),b,a.translate(-d,-k))},scaleAt:function(b,d,k,m){switch(arguments.length){case 4:return a._sandwich(a.scale(b,d),k,m);case 3:return"number"==typeof k?a._sandwich(a.scale(b),d,k):a._sandwich(a.scale(b,d),k.x,k.y)}return a._sandwich(a.scale(b),d.x,d.y)},rotateAt:function(b,d,k){return 2<arguments.length?a._sandwich(a.rotate(b),d,k):a._sandwich(a.rotate(b),
d.x,d.y)},rotategAt:function(b,d,k){return 2<arguments.length?a._sandwich(a.rotateg(b),d,k):a._sandwich(a.rotateg(b),d.x,d.y)},skewXAt:function(b,d,k){return 2<arguments.length?a._sandwich(a.skewX(b),d,k):a._sandwich(a.skewX(b),d.x,d.y)},skewXgAt:function(b,d,k){return 2<arguments.length?a._sandwich(a.skewXg(b),d,k):a._sandwich(a.skewXg(b),d.x,d.y)},skewYAt:function(b,d,k){return 2<arguments.length?a._sandwich(a.skewY(b),d,k):a._sandwich(a.skewY(b),d.x,d.y)},skewYgAt:function(b,d,k){return 2<arguments.length?
a._sandwich(a.skewYg(b),d,k):a._sandwich(a.skewYg(b),d.x,d.y)}});h.Matrix2D=a.Matrix2D;return a})},"esri/basemaps":function(){define(["require","dojo/has","./kernel","dojo/i18n!./nls/jsapi"],function(h,l,a,d){h={streets:{title:d.basemaps.streets,thumbnailUrl:h.toUrl("./images/basemap/streets.jpg"),itemId:"d8855ee4d3d74413babfb0f41203b168",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]},satellite:{title:d.basemaps.satellite,thumbnailUrl:h.toUrl("./images/basemap/satellite.jpg"),
itemId:"86de95d4e0244cba80f0fa2c9403a7b2",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]},hybrid:{title:d.basemaps.hybrid,thumbnailUrl:h.toUrl("./images/basemap/hybrid.jpg"),itemId:"413fd05bbd7342f5991d5ec96f4f8b18",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",isReference:!0}]},terrain:{title:d.basemaps.terrain,
thumbnailUrl:h.toUrl("./images/basemap/terrain.jpg"),itemId:"aab054ab883c4a4094c72e949566ad40",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer"},{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",isReference:!0}]},topo:{title:d.basemaps.topo,thumbnailUrl:h.toUrl("./images/basemap/topo.jpg"),itemId:"6e03e8c26aad4b9c92a87c1063ddb0e3",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer"}]},
gray:{title:d.basemaps.gray,thumbnailUrl:h.toUrl("./images/basemap/gray.jpg"),itemId:"8b3b470883a744aeb60e5fff0a319ce7",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer"},{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",isReference:!0}]},"dark-gray":{title:d.basemaps["dark-gray"],thumbnailUrl:h.toUrl("./images/basemap/dark-gray.jpg"),itemId:"da65bacab5bd4defb576f839b6b28098",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer"},
{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",isReference:!0}]},oceans:{title:d.basemaps.oceans,thumbnailUrl:h.toUrl("./images/basemap/oceans.jpg"),itemId:"48b8cec7ebf04b5fbdcaf70d09daff21",baseMapLayers:[{url:"http://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{url:"http://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",isReference:!0}]},"national-geographic":{title:d.basemaps["national-geographic"],
thumbnailUrl:h.toUrl("./images/basemap/national-geographic.jpg"),itemId:"509e2d6b034246d692a461724ae2d62c",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer"}]},osm:{title:d.basemaps.osm,thumbnailUrl:h.toUrl("./images/basemap/osm.jpg"),itemId:"5d2bfa736f8448b3a1708e1f6be23eed",baseMapLayers:[{type:"OpenStreetMap"}]},"dark-gray-vector":{title:d.basemaps["dark-gray"],thumbnailUrl:h.toUrl("./images/basemap/dark-gray.jpg"),itemId:"850db44b9eb845d3bd42b19e8aa7a024",
baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/850db44b9eb845d3bd42b19e8aa7a024/resources/styles/root.json",type:"VectorTile"}]},"gray-vector":{title:d.basemaps.gray,thumbnailUrl:h.toUrl("./images/basemap/gray.jpg"),itemId:"0e02e6f86d02455091796eaae811d9b5",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/0e02e6f86d02455091796eaae811d9b5/resources/styles/root.json",type:"VectorTile"}]},"streets-vector":{title:d.basemaps.streets,thumbnailUrl:h.toUrl("./images/basemap/streets.jpg"),
itemId:"4e1133c28ac04cca97693cf336cd49ad",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/4e1133c28ac04cca97693cf336cd49ad/resources/styles/root.json",type:"VectorTile"}]},"topo-vector":{title:d.basemaps.topo,thumbnailUrl:h.toUrl("./images/basemap/topo.jpg"),itemId:"6f65bc1351b7411588a8cb43fe23dad7",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/6f65bc1351b7411588a8cb43fe23dad7/resources/styles/root.json",type:"VectorTile"}]},"streets-night-vector":{title:d.basemaps["streets-night-vector"],
thumbnailUrl:h.toUrl("./images/basemap/streets-night.jpg"),itemId:"bf79e422e9454565ae0cbe9553cf6471",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/bf79e422e9454565ae0cbe9553cf6471/resources/styles/root.json",type:"VectorTile"}]},"streets-relief-vector":{title:d.basemaps["streets-relief-vector"],thumbnailUrl:h.toUrl("./images/basemap/streets-relief.jpg"),itemId:"2e063e709e3446459f8538ed6743f879",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/2e063e709e3446459f8538ed6743f879/resources/styles/root.json",
type:"VectorTile"}]},"streets-navigation-vector":{title:d.basemaps["streets-navigation-vector"],thumbnailUrl:h.toUrl("./images/basemap/streets-navigation.jpg"),itemId:"dcbbba0edf094eaa81af19298b9c6247",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/dcbbba0edf094eaa81af19298b9c6247/resources/styles/root.json",type:"VectorTile"}]}};return l("extend-esri")&&(a.basemaps=h),h})},"esri/fx":function(){define("dojo/_base/connect dojo/_base/fx dojo/_base/lang dojo/dom dojo/dom-geometry dojo/dom-style dojo/fx dojo/has ./kernel".split(" "),
function(h,l,a,d,b,f,k,m,g){var e={animateRange:function(c){var b=c.range;return new l.Animation(a.mixin({curve:new l._Line(b.start,b.end)},c))},resize:function(c){var e=c.node=d.byId(c.node),g=c.start,f=c.end;g||(g=b.getMarginBox(e),e=b.getPadBorderExtents(e),g=c.start={left:g.l+e.l,top:g.t+e.t,width:g.w-e.w,height:g.h-e.h});f||(f=c.anchor?c.anchor:{x:g.left,y:g.top},e=c.size,f=c.end={left:g.left-(e.width-g.width)*(f.x-g.left)/g.width,top:g.top-(e.height-g.height)*(f.y-g.top)/g.height,width:e.width,
height:e.height});return l.animateProperty(a.mixin({properties:{left:{start:g.left,end:f.left},top:{start:g.top,end:f.top},width:{start:g.width,end:f.width},height:{start:g.height,end:f.height}}},c))},slideTo:function(c){var e=c.node=d.byId(c.node),g=f.getComputedStyle,k=null,m=null,v=function(){return function(){var a="absolute"==e.style.position?"absolute":"relative";if(k="absolute"==a?e.offsetTop:parseInt(g(e).top)||0,m="absolute"==a?e.offsetLeft:parseInt(g(e).left)||0,"absolute"!=a&&"relative"!=
a)a=b.position(e,!0),k=a.y,m=a.x,e.style.position="absolute",e.style.top=k+"px",e.style.left=m+"px"}}();v();c=l.animateProperty(a.mixin({properties:{top:{start:k,end:c.top||0},left:{start:m,end:c.left||0}}},c));return h.connect(c,"beforeBegin",c,v),c},flash:function(c){c=a.mixin({end:"#f00",duration:500,count:1},c);c.duration/=2*c.count;var b=d.byId(c.node),e=c.start;e||(e=f.getComputedStyle(b).backgroundColor);var g=c.end,m=[],h=c.count,b={node:b,duration:c.duration};for(c=0;h>c;c++)m.push(l.animateProperty(a.mixin({properties:{backgroundColor:{start:e,
end:g}}},b))),m.push(l.animateProperty(a.mixin({properties:{backgroundColor:{start:g,end:e}}},b)));return k.chain(m)}};return m("extend-esri")&&a.mixin(a.getObject("fx",!0,g),e),e})},"dojo/_base/fx":function(){define("./kernel ./config ./lang ../Evented ./Color ../aspect ../sniff ../dom ../dom-style".split(" "),function(h,l,a,d,b,f,k,m,g){var e=a.mixin,c={},n=c._Line=function(a,c){this.start=a;this.end=c};n.prototype.getValue=function(a){return(this.end-this.start)*a+this.start};var q=c.Animation=
function(c){e(this,c);a.isArray(this.curve)&&(this.curve=new n(this.curve[0],this.curve[1]))};q.prototype=new d;a.extend(q,{duration:350,repeat:0,rate:20,_percent:0,_startRepeatCount:0,_getStep:function(){var a=this._percent,c=this.easing;return c?c(a):a},_fire:function(a,c){var b=c||[];if(this[a])if(l.debugAtAllCosts)this[a].apply(this,b);else try{this[a].apply(this,b)}catch(e){console.error("exception in animation handler for:",a),console.error(e)}return this},play:function(c,b){this._delayTimer&&
this._clearTimer();if(b)this._stopTimer(),this._active=this._paused=!1,this._percent=0;else if(this._active&&!this._paused)return this;this._fire("beforeBegin",[this.node]);var e=c||this.delay,d=a.hitch(this,"_play",b);if(0<e)return this._delayTimer=setTimeout(d,e),this;d();return this},_play:function(a){this._delayTimer&&this._clearTimer();this._startTime=(new Date).valueOf();this._paused&&(this._startTime-=this.duration*this._percent);this._active=!0;this._paused=!1;a=this.curve.getValue(this._getStep());
this._percent||(this._startRepeatCount||(this._startRepeatCount=this.repeat),this._fire("onBegin",[a]));this._fire("onPlay",[a]);this._cycle();return this},pause:function(){this._delayTimer&&this._clearTimer();this._stopTimer();if(!this._active)return this;this._paused=!0;this._fire("onPause",[this.curve.getValue(this._getStep())]);return this},gotoPercent:function(a,c){this._stopTimer();this._active=this._paused=!0;this._percent=a;c&&this.play();return this},stop:function(a){this._delayTimer&&this._clearTimer();
if(!this._timer)return this;this._stopTimer();a&&(this._percent=1);this._fire("onStop",[this.curve.getValue(this._getStep())]);this._active=this._paused=!1;return this},destroy:function(){this.stop()},status:function(){return this._active?this._paused?"paused":"playing":"stopped"},_cycle:function(){if(this._active){var a=(new Date).valueOf(),a=0===this.duration?1:(a-this._startTime)/this.duration;1<=a&&(a=1);this._percent=a;this.easing&&(a=this.easing(a));this._fire("onAnimate",[this.curve.getValue(a)]);
1>this._percent?this._startTimer():(this._active=!1,0<this.repeat?(this.repeat--,this.play(null,!0)):-1==this.repeat?this.play(null,!0):this._startRepeatCount&&(this.repeat=this._startRepeatCount,this._startRepeatCount=0),this._percent=0,this._fire("onEnd",[this.node]),!this.repeat&&this._stopTimer())}return this},_clearTimer:function(){clearTimeout(this._delayTimer);delete this._delayTimer}});var r=0,u=null,v={run:function(){}};a.extend(q,{_startTimer:function(){this._timer||(this._timer=f.after(v,
"run",a.hitch(this,"_cycle"),!0),r++);u||(u=setInterval(a.hitch(v,"run"),this.rate))},_stopTimer:function(){this._timer&&(this._timer.remove(),this._timer=null,r--);0>=r&&(clearInterval(u),u=null,r=0)}});var t=k("ie")?function(a){var c=a.style;c.width.length||"auto"!=g.get(a,"width")||(c.width="auto")}:function(){};c._fade=function(b){b.node=m.byId(b.node);var d=e({properties:{}},b);b=d.properties.opacity={};b.start="start"in d?d.start:function(){return+g.get(d.node,"opacity")||0};b.end=d.end;b=c.animateProperty(d);
f.after(b,"beforeBegin",a.partial(t,d.node),!0);return b};c.fadeIn=function(a){return c._fade(e({end:1},a))};c.fadeOut=function(a){return c._fade(e({end:0},a))};c._defaultEasing=function(a){return.5+Math.sin((a+1.5)*Math.PI)/2};var w=function(a){this._properties=a;for(var c in a){var e=a[c];e.start instanceof b&&(e.tempColor=new b)}};w.prototype.getValue=function(c){var e={},d;for(d in this._properties){var g=this._properties[d],f=g.start;f instanceof b?e[d]=b.blendColors(f,g.end,c,g.tempColor).toCss():
a.isArray(f)||(e[d]=(g.end-f)*c+f+("opacity"!=d?g.units||"px":0))}return e};c.animateProperty=function(c){var d=c.node=m.byId(c.node);c.easing||(c.easing=h._defaultEasing);c=new q(c);f.after(c,"beforeBegin",a.hitch(c,function(){var c={},f;for(f in this.properties){var k=function(a,c){var b={height:a.offsetHeight,width:a.offsetWidth}[c];if(void 0!==b)return b;b=g.get(a,c);return"opacity"==c?+b:m?b:parseFloat(b)};if("width"==f||"height"==f)this.node.display="block";var n=this.properties[f];a.isFunction(n)&&
(n=n(d));n=c[f]=e({},a.isObject(n)?n:{end:n});a.isFunction(n.start)&&(n.start=n.start(d));a.isFunction(n.end)&&(n.end=n.end(d));var m=0<=f.toLowerCase().indexOf("color");"end"in n?"start"in n||(n.start=k(d,f)):n.end=k(d,f);m?(n.start=new b(n.start),n.end=new b(n.end)):n.start="opacity"==f?+n.start:parseFloat(n.start)}this.curve=new w(c)}),!0);f.after(c,"onAnimate",a.hitch(g,"set",c.node),!0);return c};c.anim=function(a,b,e,d,g,f){return c.animateProperty({node:a,duration:e||q.prototype.duration,properties:b,
easing:d,onEnd:g}).play(f||0)};e(h,c);h._Animation=q;return c})},"dojo/fx":function(){define("./_base/lang ./Evented ./_base/kernel ./_base/array ./aspect ./_base/fx ./dom ./dom-style ./dom-geometry ./ready require".split(" "),function(h,l,a,d,b,f,k,m,g,e,c){a.isAsync||e(0,function(){c(["./fx/Toggler"])});a=a.fx={};e={_fire:function(a,c){this[a]&&this[a].apply(this,c||[]);return this}};var n=function(a){this._index=-1;this._animations=a||[];this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=
0;d.forEach(this._animations,function(a){a&&("undefined"!=typeof a.duration&&(this.duration+=a.duration),a.delay&&(this.duration+=a.delay))},this)};n.prototype=new l;h.extend(n,{_onAnimate:function(){this._fire("onAnimate",arguments)},_onEnd:function(){this._onAnimateCtx.remove();this._onEndCtx.remove();this._onAnimateCtx=this._onEndCtx=null;this._index+1==this._animations.length?this._fire("onEnd"):(this._current=this._animations[++this._index],this._onAnimateCtx=b.after(this._current,"onAnimate",
h.hitch(this,"_onAnimate"),!0),this._onEndCtx=b.after(this._current,"onEnd",h.hitch(this,"_onEnd"),!0),this._current.play(0,!0))},play:function(a,c){this._current||(this._current=this._animations[this._index=0]);if(!c&&"playing"==this._current.status())return this;var e=b.after(this._current,"beforeBegin",h.hitch(this,function(){this._fire("beforeBegin")}),!0),d=b.after(this._current,"onBegin",h.hitch(this,function(a){this._fire("onBegin",arguments)}),!0),g=b.after(this._current,"onPlay",h.hitch(this,
function(a){this._fire("onPlay",arguments);e.remove();d.remove();g.remove()}));this._onAnimateCtx&&this._onAnimateCtx.remove();this._onAnimateCtx=b.after(this._current,"onAnimate",h.hitch(this,"_onAnimate"),!0);this._onEndCtx&&this._onEndCtx.remove();this._onEndCtx=b.after(this._current,"onEnd",h.hitch(this,"_onEnd"),!0);this._current.play.apply(this._current,arguments);return this},pause:function(){if(this._current){var a=b.after(this._current,"onPause",h.hitch(this,function(c){this._fire("onPause",
arguments);a.remove()}),!0);this._current.pause()}return this},gotoPercent:function(a,c){this.pause();var b=this.duration*a;this._current=null;d.some(this._animations,function(a,c){if(b<=a.duration)return this._current=a,this._index=c,!0;b-=a.duration;return!1},this);this._current&&this._current.gotoPercent(b/this._current.duration);c&&this.play();return this},stop:function(a){if(this._current){if(a){for(;this._index+1<this._animations.length;++this._index)this._animations[this._index].stop(!0);this._current=
this._animations[this._index]}var c=b.after(this._current,"onStop",h.hitch(this,function(a){this._fire("onStop",arguments);c.remove()}),!0);this._current.stop()}return this},status:function(){return this._current?this._current.status():"stopped"},destroy:function(){this.stop();this._onAnimateCtx&&this._onAnimateCtx.remove();this._onEndCtx&&this._onEndCtx.remove()}});h.extend(n,e);a.chain=function(a){return new n(h.isArray(a)?a:Array.prototype.slice.call(a,0))};var q=function(a){this._animations=a||
[];this._connects=[];this.duration=this._finished=0;d.forEach(a,function(a){var c=a.duration;a.delay&&(c+=a.delay);this.duration<c&&(this.duration=c);this._connects.push(b.after(a,"onEnd",h.hitch(this,"_onEnd"),!0))},this);this._pseudoAnimation=new f.Animation({curve:[0,1],duration:this.duration});var c=this;d.forEach("beforeBegin onBegin onPlay onAnimate onPause onStop onEnd".split(" "),function(a){c._connects.push(b.after(c._pseudoAnimation,a,function(){c._fire(a,arguments)},!0))})};h.extend(q,
{_doAction:function(a,c){d.forEach(this._animations,function(b){b[a].apply(b,c)});return this},_onEnd:function(){++this._finished>this._animations.length&&this._fire("onEnd")},_call:function(a,c){var b=this._pseudoAnimation;b[a].apply(b,c)},play:function(a,c){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this},gotoPercent:function(a,c){var b=this.duration*a;d.forEach(this._animations,
function(a){a.gotoPercent(a.duration<b?1:b/a.duration,c)});this._call("gotoPercent",arguments);return this},stop:function(a){this._doAction("stop",arguments);this._call("stop",arguments);return this},status:function(){return this._pseudoAnimation.status()},destroy:function(){this.stop();d.forEach(this._connects,function(a){a.remove()})}});h.extend(q,e);a.combine=function(a){return new q(h.isArray(a)?a:Array.prototype.slice.call(a,0))};a.wipeIn=function(a){var c=a.node=k.byId(a.node),e=c.style,d;a=
f.animateProperty(h.mixin({properties:{height:{start:function(){d=e.overflow;e.overflow="hidden";if("hidden"==e.visibility||"none"==e.display)return e.height="1px",e.display="",e.visibility="",1;var a=m.get(c,"height");return Math.max(a,1)},end:function(){return c.scrollHeight}}}},a));var g=function(){e.height="auto";e.overflow=d};b.after(a,"onStop",g,!0);b.after(a,"onEnd",g,!0);return a};a.wipeOut=function(a){var c=(a.node=k.byId(a.node)).style,e;a=f.animateProperty(h.mixin({properties:{height:{end:1}}},
a));b.after(a,"beforeBegin",function(){e=c.overflow;c.overflow="hidden";c.display=""},!0);var d=function(){c.overflow=e;c.height="auto";c.display="none"};b.after(a,"onStop",d,!0);b.after(a,"onEnd",d,!0);return a};a.slideTo=function(a){var c=null,e=null,d=function(a){return function(){var b=m.getComputedStyle(a),d=b.position;c="absolute"==d?a.offsetTop:parseInt(b.top)||0;e="absolute"==d?a.offsetLeft:parseInt(b.left)||0;"absolute"!=d&&"relative"!=d&&(b=g.position(a,!0),c=b.y,e=b.x,a.style.position=
"absolute",a.style.top=c+"px",a.style.left=e+"px")}}(a.node=k.byId(a.node));d();a=f.animateProperty(h.mixin({properties:{top:a.top||0,left:a.left||0}},a));b.after(a,"beforeBegin",d,!0);return a};return a})},"esri/deferredUtils":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(h,l,a){var d={_dfdCanceller:function(a){a.canceled=!0;var d=a._pendingDfd;-1===a.fired&&d&&-1===d.fired&&d.cancel();a._pendingDfd=null},_fixDfd:function(a){var d=a.then;return a.then=function(a,b,g){if(a){var e=
a;a=function(a){return a&&a._argsArray?e.apply(null,a):e(a)}}return d.call(this,a,b,g)},a},_resDfd:function(a,d,k){var m=d.length;1===m?k?a.errback(d[0]):a.callback(d[0]):1<m?(d._argsArray=!0,a.callback(d)):a.callback()}};return l("extend-esri")&&h.mixin(a,d),d})},"esri/tileUtils":function(){define(["dojo/_base/array","dojo/has","./kernel","./geometry/Point","./geometry/Extent"],function(h,l,a,d,b){var f={_addFrameInfo:function(a,b){var d,e,c,f=2*b.origin[1],q=b.origin[0],r=a.origin.x,u=a.width;h.forEach(a.lods,
function(a){d=Math.round(f/a.resolution);e=Math.ceil(d/u);c=Math.floor((q-r)/(u*a.resolution));a._frameInfo||(a._frameInfo=[e,c,c+e-1,d])})},getContainingTileCoords:function(a,b,d){var e=a.origin;d=d.resolution;return{row:Math.floor((e.y-b.y)/(a.height*d)),col:Math.floor((b.x-e.x)/(a.width*d))}},getCandidateTileInfo:function(a,f,g){var e,c,n,q,r=a.width,u=a.height,h=g.xmax-g.xmin,t=g.ymax-g.ymin,l=a.__tileInfo===f;c=l?a.getMinZoom():-1;var l=l?a.getMaxZoom():-1,x=-1,y=f.lods,z=Math.abs,l=-1<l?l:y.length-
1;for(c=-1<c?c:0;l>=c;c++)if(n=y[c]){if(q=z(h>t?t-u*n.resolution:h-r*n.resolution),!(0>x||x>=q))break;e=n;x=q}h=e.resolution;q=(g.xmin+g.xmax)/2;r=(g.ymin+g.ymax)/2;u=a.width/2*h;h*=a.height/2;q=new b(q-u,r-h,q+u,r+h,g.spatialReference);g=new d(q.xmin,q.ymax,g.spatialReference);t=e.resolution;u=f.width;r=f.height;f=f.origin;a=a.__visibleDelta;h=Math.floor;x=u*t;y=r*t;t=h((f.y-g.y)/y);l=h((g.x-f.x)/x);z=f.y-t*y;f=h(Math.abs((g.x-(f.x+l*x))*u/x))+a.x;a=h(Math.abs((g.y-z)*r/y))+a.y;return{tile:{point:g,
coords:{row:t,col:l},offsets:{x:f,y:a}},lod:e,extent:q}},getTileExtent:function(a,d,g,e){var c=a.origin;d=a.lods[d].resolution;var f=a.width,q=a.height;return new b(e*d*f+c.x,c.y-(g+1)*d*q,(e+1)*d*f+c.x,c.y-g*d*q,a.spatialReference)}};return l("extend-esri")&&(a.TileUtils=f),f})},"esri/PluginTarget":function(){define("require dojo/aspect dojo/_base/array dojo/_base/lang dojo/Deferred dojo/when".split(" "),function(h,l,a,d,b,f){function k(){l.after(this.constructor._meta,"ctor",this._pluginsHandler,
!0);this._plugins={}}return k.prototype={addPlugin:function(a,d){var e=this,c=this._plugins,k=new b;try{h([a],function(b){a in c?k.resolve({id:c[a].declaredId||a.replace(/\//g,".")}):(c[a]=b,f(b.add(e,d),function(){var c={id:b.declaredId||a.replace(/\//g,".")};e.emit("plugin-add",c);k.resolve(c)},function(a){k.reject(a)}))})}catch(q){k.reject(q)}return k.promise},removePlugin:function(a){if(a in this._plugins){var b=this._plugins[a];b.remove(this);delete this._plugins[a];this.emit("plugin-remove",
{id:b.declaredId||a.replace(/\//g,".")})}},_pluginsHandler:function(){var b=this;a.some(arguments,function(a){if(a&&a.plugins&&a.plugins instanceof Array){var e,c,d=a.plugins;for(c=0;c<d.length;c++)a=d[c],e=a instanceof Object?a.id:a,b.addPlugin(e,a.options);return!0}})}},k})},"esri/arcade/Dictionary":function(){define(["require","exports","./languageUtils","../geometry/Geometry","./ImmutableArray"],function(h,l,a,d,b){return function(){function f(a){this.attributes=null;this.plain=!1;this.immutable=
!0;a instanceof f?this.attributes=a.attributes:void 0===a?this.attributes={}:null===a?this.attributes={}:this.attributes=a}return f.prototype.field=function(a){var b=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var d in this.attributes)if(d.toLowerCase()===b)return this.attributes[d];throw Error("Field not Found");},f.prototype.setField=function(a,b){if(this.immutable)throw Error("Dictionary is Immutable");var d=a.toLowerCase();if(void 0!==this.attributes[a])return void(this.attributes[a]=
b);for(var e in this.attributes)if(e.toLowerCase()===d)return void(this.attributes[e]=b);this.attributes[a]=b},f.prototype.hasField=function(a){var b=a.toLowerCase();if(void 0!==this.attributes[a])return!0;for(var d in this.attributes)if(d.toLowerCase()===b)return!0;return!1},f.prototype.keys=function(){var a=[],b;for(b in this.attributes)a.push(b);return a.sort()},f.prototype.castToText=function(){var f="",m;for(m in this.attributes){""!==f&&(f+=",");var g=this.attributes[m];null==g||(a.isBoolean(g)||
a.isNumber(g)||a.isString(g)?f+=JSON.stringify(m)+":"+JSON.stringify(g):g instanceof d?f+=JSON.stringify(m)+":"+a.toStringExplicit(g):g instanceof b?f+=JSON.stringify(m)+":"+a.toStringExplicit(g):g instanceof Array?f+=JSON.stringify(m)+":"+a.toStringExplicit(g):g instanceof Date?f+=JSON.stringify(m)+":"+JSON.stringify(g):null!==g&&"object"==typeof g&&void 0!==g.castToText&&(f+=JSON.stringify(m)+":"+g.castToText()))}return"{"+f+"}"},f}()})},"esri/arcade/languageUtils":function(){define("require exports ../geometry/Geometry ../moment dojo/number ./ImmutableArray ../kernel ./ImmutablePointArray ./ImmutablePathArray dojo/_base/array ../geometry/Point ./FunctionWrapper".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n){function q(a,c,b){if(""===c||null===c||void 0===c||c===b||c===b)return a;do a=a.replace(c,b);while(-1!==a.indexOf(c));return a}function r(a){return a instanceof J||a instanceof n||a instanceof I}function u(a){return"string"==typeof a||a instanceof String}function v(a){return"boolean"==typeof a}function t(a){return"number"==typeof a}function w(a){return a instanceof Array}function x(a){return a instanceof Date}function y(a,c){return!1===isNaN(a)?void 0===c||null===
c||""===c?a.toString():(c=q(c,"\u2030",""),c=q(c,"\u00a4",""),b.format(a,{pattern:c})):a.toString()}function z(a,c){var b=d(a);return void 0===c||null===c||""===c?b.format():b.format(A(c))}function A(a){return a.replace(/(LTS)|L|l/g,function(a){return"["+a+"]"})}function B(a,c,b){switch(b){case "\x3e":return a>c;case "\x3c":return c>a;case "\x3e\x3d":return a>=c;case "\x3c\x3d":return c>=a}return!1}function C(a,b){if(a===b||null===a&&b===l.voidOperation||null===b&&a===l.voidOperation)return!0;if(x(a)&&
x(b))return a.getTime()===b.getTime();if(a instanceof g||a instanceof m)return a.equalityTest(b);if(a instanceof c&&b instanceof c){var e=void 0,d=void 0;if(l.isVersion4?(e=a.cache._arcadeCacheId,d=b.cache._arcadeCacheId):(e=a.getCacheValue("_arcadeCacheId"),d=b.getCacheValue("_arcadeCacheId")),void 0!==e&&null!==e)return e===d}return void 0!==a&&void 0!==b&&null!==a&&null!==b&&"object"==typeof a&&"object"==typeof b&&(a._arcadeCacheId===b._arcadeCacheId&&void 0!==a._arcadeCacheId&&null!==a._arcadeCacheId||
a._underlyingGraphic===b._underlyingGraphic&&void 0!==a._underlyingGraphic&&null!==a._underlyingGraphic)?!0:!1}function D(c,b){if(u(c))return c;if(null===c)return"";if(t(c))return y(c,b);if(v(c))return c.toString();if(x(c))return z(c,b);if(c instanceof a)return JSON.stringify(c.toJson());if(w(c)){for(var e=[],d=0;d<c.length;d++)e[d]=F(c[d]);return"["+e.join(",")+"]"}if(c instanceof f){e=[];for(d=0;d<c.length();d++)e[d]=F(c.get(d));return"["+e.join(",")+"]"}return null!==c&&"object"==typeof c&&void 0!==
c.castToText?c.castToText():r(c)?"object, Function":(c===l.voidOperation,"")}function E(c,b){if(u(c))return c;if(null===c)return"";if(t(c))return y(c,b);if(v(c))return c.toString();if(x(c))return z(c,b);if(c instanceof a)return JSON.stringify(c.toJson());if(w(c)){for(var e=[],d=0;d<c.length;d++)e[d]=F(c[d]);return"["+e.join(",")+"]"}if(c instanceof f){e=[];for(d=0;d<c.length();d++)e[d]=F(c.get(d));return"["+e.join(",")+"]"}return null!==c&&"object"==typeof c&&void 0!==c.castToText?c.castToText():
r(c)?"object, Function":(c===l.voidOperation,"")}function F(c){return null===c?"null":v(c)||t(c)||u(c)?JSON.stringify(c):c instanceof a||c instanceof f||c instanceof Array?E(c):c instanceof Date?JSON.stringify(z(c,"")):null!==c&&"object"==typeof c&&void 0!==c.castToText?c.castToText():"null"}function H(a,c){return t(a)?a:null===a?0:""===a?0:x(a)?NaN:v(a)?a?1:0:""===a?NaN:void 0===a?NaN:void 0!==c&&u(a)?(c=q(c,"\u2030",""),c=q(c,"\u00a4",""),b.parse(a,{pattern:c})):a===l.voidOperation?0:Number(a)}
function G(a,c){var b;return e.some(c.fields,function(c){return c.name===a&&(b=c.domain),!!b}),b}h=function(){return function(a){this.value=a}}();var K=function(){return function(a){this.value=a}}(),J=function(){return function(a){this.fn=a}}(),I=function(){return function(a){this.fn=a}}();l.NativeFunction=J;l.ImplicitResult=K;l.ReturnResult=h;l.SizzleFunction=I;l.isVersion4=0===k.version.indexOf("4.");l.voidOperation={type:"VOID"};l.breakResult={type:"BREAK"};l.continueResult={type:"CONTINUE"};l.multiReplace=
q;l.isFunctionParameter=r;l.isSimpleType=function(a){return u(a)?!0:t(a)?!0:x(a)?!0:v(a)?!0:null===a?!0:a===l.voidOperation?!0:"number"==typeof a?!0:!1};l.defaultUndefined=function(a,c){return void 0===a?c:a};l.isString=u;l.isBoolean=v;l.isNumber=t;l.isArray=w;l.isFeatureCursor=function(a){return a&&void 0!==a.isFeatureCursor};l.isImmutableArray=function(a){return a instanceof f};l.isDate=x;l.pcCheck=function(a,c,b){if(a.length<c||a.length>b)throw Error("Function called with wrong number of Parameters");
};l.generateUUID=function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var b=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"===c?b:3&b|8).toString(16)})};l.formatNumber=y;l.formatDate=z;l.standardiseDateFormat=A;l.greaterThanLessThan=function(a,c,b){if(null===a){if(null===c||c===l.voidOperation)return B(null,null,b);if(t(c))return B(0,c,b);if(u(c)||v(c))return B(0,H(c),b);if(x(c))return B(0,c.getTime(),b)}if(a===l.voidOperation){if(null===
c||c===l.voidOperation)return B(null,null,b);if(t(c))return B(0,c,b);if(u(c)||v(c))return B(0,H(c),b);if(x(c))return B(0,c.getTime(),b)}else if(t(a)){if(t(c))return B(a,c,b);if(v(c))return B(a,H(c),b);if(null===c||c===l.voidOperation)return B(a,0,b);if(u(c))return B(a,H(c),b);if(x(c))return B(a,c.getTime(),b)}else if(u(a)){if(u(c))return B(D(a),D(c),b);if(x(c))return B(H(a),c.getTime(),b);if(t(c))return B(H(a),c,b);if(null===c||c===l.voidOperation)return B(H(a),0,b);if(v(c))return B(H(a),H(c),b)}else if(x(a)){if(x(c))return B(a,
c,b);if(null===c||c===l.voidOperation)return B(a.getTime(),0,b);if(t(c))return B(a.getTime(),c,b);if(v(c)||u(c))return B(a.getTime(),H(c),b)}else if(v(a)){if(v(c))return B(a,c,b);if(t(c))return B(H(a),H(c),b);if(x(c))return B(H(a),c.getTime(),b);if(null===c||c===l.voidOperation)return B(H(a),0,b);if(u(c))return B(H(a),H(c),b)}return!C(a,c)||"\x3c\x3d"!==b&&"\x3e\x3d"!==b?!1:!0};l.equalityTest=C;l.toString=D;l.toNumberArray=function(a){var c=[];if(!1===w(a))return null;if(a instanceof f){for(var b=
0;b<a.length();b++)c[b]=H(a.get(b));return c}for(b=0;b<a.length;b++)c[b]=H(a[b]);return c};l.toStringExplicit=E;l.toNumber=H;l.toDate=function(a,c){if(x(a))return a;if(u(a)){var b=d(a,[void 0===c||null===c||""===c?d.ISO_8601:c]);if(b.isValid())return b.toDate()}return null};l.toDateM=function(a,c){if(x(a))return d(a);if(u(a)){var b=d(a,[void 0===c||null===c||""===c?d.ISO_8601:c]);if(b.isValid())return b}return null};l.toBoolean=function(a){return v(a)?a:u(a)?(a=a.toLowerCase(),"true"===a?!0:!1):t(a)?
0===a?!1:isNaN(a)?!1:!0:!1};l.fixSpatialReference=function(a,c){return null===a?null:((null===a.spatialReference||void 0===a.spatialReference)&&(a.spatialReference=c),a)};l.getDomainValue=function(a,c){if(!a||!a.domain)return null;var b=null;c="string"===a.field.type||"esriFieldTypeString"===a.field.type?D(c):H(c);for(var e=0;e<a.domain.codedValues.length;e++){var d=a.domain.codedValues[e];d.code===c&&(b=d)}return null===b?null:b.name};l.getDomainCode=function(a,c){if(!a||!a.domain)return null;var b=
null;c=D(c);for(var e=0;e<a.domain.codedValues.length;e++){var d=a.domain.codedValues[e];d.name===c&&(b=d)}return null===b?null:b.code};l.getDomain=function(a,c,b,d){if((void 0===b&&(b=null),!c)||!c.fields)return null;for(var g=null,f=0;f<c.fields.length;f++){var n=c.fields[f];n.name.toLowerCase()===a.toString().toLowerCase()&&(g=n)}if(null===g)return null;var k,m;return d||(d=b&&c.typeIdField&&b._field(c.typeIdField)),null!=d&&e.some(c.types,function(a){return a.id===d?(k=a.domains&&a.domains[g.name],
k&&"inherited"===k.type&&(k=G(g.name,c),m=!0),!0):!1}),m||k||(k=G(a,c)),{field:g,domain:k}}})},"esri/moment":function(){define(["require","exports","./plugins/moment!"],function(h,l,a){return a})},"esri/plugins/moment":function(){define(["require","exports","dojo/_base/kernel","moment/moment"],function(h,l,a,d){var b={ar:1,"ar-ly":1,"ar-ma":1,"ar-sa":1,"ar-tn":1,bs:1,cs:1,da:1,de:1,"de-at":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,"en-ie":1,"en-nz":1,es:1,"es-do":1,et:1,fi:1,fr:1,"fr-ca":1,"fr-ch":1,he:1,
hr:1,id:1,it:1,ja:1,ko:1,lt:1,lv:1,nb:1,nl:1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,sr:1,"sr-cyrl":1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1};l.load=function(f,k,m){f=a.locale;var g=f in b;if(!g){var e=f.split("-");1<e.length&&e[0]in b&&(f=e[0],g=!0)}g?k(["moment/locale/"+f],function(){m(d)}):m(d)}})},"moment/moment":function(){(function(h,l){"object"===typeof exports&&"undefined"!==typeof module?module.exports=l():"function"===typeof define&&define.amd?define(l):h.moment=l()})(this,function(){function h(){return vb.apply(null,
arguments)}function l(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}function a(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)}function d(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function b(a,c){var b=[],e;for(e=0;e<a.length;++e)b.push(c(a[e],e));return b}function f(a,c){return Object.prototype.hasOwnProperty.call(a,c)}function k(a,c){for(var b in c)f(c,b)&&(a[b]=c[b]);f(c,"toString")&&(a.toString=
c.toString);f(c,"valueOf")&&(a.valueOf=c.valueOf);return a}function m(a,c,b,e){return Ya(a,c,b,e,!0).utc()}function g(a){null==a._pf&&(a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null});return a._pf}function e(a){if(null==a._isValid){var c=g(a),b=wb.call(c.parsedDateParts,function(a){return null!=a}),b=!isNaN(a._d.getTime())&&0>c.overflow&&!c.empty&&!c.invalidMonth&&
!c.invalidWeekday&&!c.nullInput&&!c.invalidFormat&&!c.userInvalidated&&(!c.meridiem||c.meridiem&&b);a._strict&&(b=b&&0===c.charsLeftOver&&0===c.unusedTokens.length&&void 0===c.bigHour);if(null!=Object.isFrozen&&Object.isFrozen(a))return b;a._isValid=b}return a._isValid}function c(a){var c=m(NaN);null!=a?k(g(c),a):g(c).userInvalidated=!0;return c}function n(a){return void 0===a}function q(a,c){var b,e,d;n(c._isAMomentObject)||(a._isAMomentObject=c._isAMomentObject);n(c._i)||(a._i=c._i);n(c._f)||(a._f=
c._f);n(c._l)||(a._l=c._l);n(c._strict)||(a._strict=c._strict);n(c._tzm)||(a._tzm=c._tzm);n(c._isUTC)||(a._isUTC=c._isUTC);n(c._offset)||(a._offset=c._offset);n(c._pf)||(a._pf=g(c));n(c._locale)||(a._locale=c._locale);if(0<yb.length)for(b in yb)e=yb[b],d=c[e],n(d)||(a[e]=d);return a}function r(a){q(this,a);this._d=new Date(null!=a._d?a._d.getTime():NaN);!1===sb&&(sb=!0,h.updateOffset(this),sb=!1)}function u(a){return a instanceof r||null!=a&&null!=a._isAMomentObject}function v(a){return 0>a?Math.ceil(a)||
0:Math.floor(a)}function t(a){a=+a;var c=0;0!==a&&isFinite(a)&&(c=v(a));return c}function w(a,c,b){var e=Math.min(a.length,c.length),d=Math.abs(a.length-c.length),g=0,f;for(f=0;f<e;f++)(b&&a[f]!==c[f]||!b&&t(a[f])!==t(c[f]))&&g++;return g+d}function x(a){!1===h.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+a)}function y(a,c){var b=!0;return k(function(){null!=h.deprecationHandler&&h.deprecationHandler(null,a);if(b){for(var e=[],d,g=0;g<
arguments.length;g++){d="";if("object"===typeof arguments[g]){d+="\n["+g+"] ";for(var f in arguments[0])d+=f+": "+arguments[0][f]+", ";d=d.slice(0,-2)}else d=arguments[g];e.push(d)}x(a+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+Error().stack);b=!1}return c.apply(this,arguments)},c)}function z(a,c){null!=h.deprecationHandler&&h.deprecationHandler(a,c);Kb[a]||(x(c),Kb[a]=!0)}function A(a){return a instanceof Function||"[object Function]"===Object.prototype.toString.call(a)}function B(c,
b){var e=k({},c),d;for(d in b)f(b,d)&&(a(c[d])&&a(b[d])?(e[d]={},k(e[d],c[d]),k(e[d],b[d])):null!=b[d]?e[d]=b[d]:delete e[d]);for(d in c)f(c,d)&&!f(b,d)&&a(c[d])&&(e[d]=k({},e[d]));return e}function C(a){null!=a&&this.set(a)}function D(a,c){var b=a.toLowerCase();fb[b]=fb[b+"s"]=fb[c]=a}function E(a){return"string"===typeof a?fb[a]||fb[a.toLowerCase()]:void 0}function F(a){var c={},b,e;for(e in a)f(a,e)&&(b=E(e))&&(c[b]=a[e]);return c}function H(a){var c=[],b;for(b in a)c.push({unit:b,priority:Fa[b]});
c.sort(function(a,c){return a.priority-c.priority});return c}function G(a,c){return function(b){if(null!=b){if(this.isValid())this._d["set"+(this._isUTC?"UTC":"")+a](b);h.updateOffset(this,c);return this}return K(this,a)}}function K(a,c){return a.isValid()?a._d["get"+(a._isUTC?"UTC":"")+c]():NaN}function J(a,c,b){var e=""+Math.abs(a);return(0<=a?b?"+":"":"-")+Math.pow(10,Math.max(0,c-e.length)).toString().substr(1)+e}function I(a,c,b,e){var d=e;"string"===typeof e&&(d=function(){return this[e]()});
a&&(Za[a]=d);c&&(Za[c[0]]=function(){return J(d.apply(this,arguments),c[1],c[2])});b&&(Za[b]=function(){return this.localeData().ordinal(d.apply(this,arguments),a)})}function L(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function M(a){var c=a.match(Ab),b,e;b=0;for(e=c.length;b<e;b++)c[b]=Za[c[b]]?Za[c[b]]:L(c[b]);return function(b){var d="",g;for(g=0;g<e;g++)d+=c[g]instanceof Function?c[g].call(b,a):c[g];return d}}function N(a,c){if(!a.isValid())return a.localeData().invalidDate();
c=Q(c,a.localeData());Bb[c]=Bb[c]||M(c);return Bb[c](a)}function Q(a,c){function b(a){return c.longDateFormat(a)||a}var e=5;for(kb.lastIndex=0;0<=e&&kb.test(a);)a=a.replace(kb,b),kb.lastIndex=0,--e;return a}function O(a,c,b){Ub[a]=A(c)?c:function(a,e){return a&&b?b:c}}function T(a,c){return f(Ub,a)?Ub[a](c._strict,c._locale):new RegExp(S(a))}function S(a){return R(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,c,b,e,d){return c||b||e||d}))}function R(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,
"\\$\x26")}function U(a,c){var b,e=c;"string"===typeof a&&(a=[a]);"number"===typeof c&&(e=function(a,b){b[c]=t(a)});for(b=0;b<a.length;b++)Vb[a[b]]=e}function W(a,c){U(a,function(a,b,e,d){e._w=e._w||{};c(a,e._w,e,d)})}function fa(a,c){return(new Date(Date.UTC(a,c+1,0))).getUTCDate()}function ea(a,c){var b;if(!a.isValid())return a;if("string"===typeof c)if(/^\d+$/.test(c))c=t(c);else if(c=a.localeData().monthsParse(c),"number"!==typeof c)return a;b=Math.min(a.date(),fa(a.year(),c));a._d["set"+(a._isUTC?
"UTC":"")+"Month"](c,b);return a}function oa(a){return null!=a?(ea(this,a),h.updateOffset(this,!0),this):K(this,"Month")}function pa(){function a(c,b){return b.length-c.length}var c=[],b=[],e=[],d,g;for(d=0;12>d;d++)g=m([2E3,d]),c.push(this.monthsShort(g,"")),b.push(this.months(g,"")),e.push(this.months(g,"")),e.push(this.monthsShort(g,""));c.sort(a);b.sort(a);e.sort(a);for(d=0;12>d;d++)c[d]=R(c[d]),b[d]=R(b[d]);for(d=0;24>d;d++)e[d]=R(e[d]);this._monthsShortRegex=this._monthsRegex=new RegExp("^("+
e.join("|")+")","i");this._monthsStrictRegex=new RegExp("^("+b.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+c.join("|")+")","i")}function Aa(a){return 0===a%4&&0!==a%100||0===a%400}function ta(a,c,b,e,d,g,f){c=new Date(a,c,b,e,d,g,f);100>a&&0<=a&&isFinite(c.getFullYear())&&c.setFullYear(a);return c}function va(a){var c=new Date(Date.UTC.apply(null,arguments));100>a&&0<=a&&isFinite(c.getUTCFullYear())&&c.setUTCFullYear(a);return c}function ua(a,c,b){b=7+c-b;return-((7+va(a,0,b).getUTCDay()-
c)%7)+b-1}function qa(a,c,b,e,d){b=(7+b-e)%7;e=ua(a,e,d);e=1+7*(c-1)+b+e;0>=e?(c=a-1,a=(Aa(c)?366:365)+e):e>(Aa(a)?366:365)?(c=a+1,a=e-(Aa(a)?366:365)):(c=a,a=e);return{year:c,dayOfYear:a}}function ca(a,c,b){var e=ua(a.year(),c,b),e=Math.floor((a.dayOfYear()-e-1)/7)+1;1>e?(a=a.year()-1,c=e+ja(a,c,b)):e>ja(a.year(),c,b)?(c=e-ja(a.year(),c,b),a=a.year()+1):(a=a.year(),c=e);return{week:c,year:a}}function ja(a,c,b){var e=ua(a,c,b);c=ua(a+1,c,b);return((Aa(a)?366:365)-e+c)/7}function la(a,c,b){var e,d;
a=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],e=0;7>e;++e)d=m([2E3,1]).day(e),this._minWeekdaysParse[e]=this.weekdaysMin(d,"").toLocaleLowerCase(),this._shortWeekdaysParse[e]=this.weekdaysShort(d,"").toLocaleLowerCase(),this._weekdaysParse[e]=this.weekdays(d,"").toLocaleLowerCase();if(b)c="dddd"===c?Oa.call(this._weekdaysParse,a):"ddd"===c?Oa.call(this._shortWeekdaysParse,a):Oa.call(this._minWeekdaysParse,a);else if("dddd"===
c){c=Oa.call(this._weekdaysParse,a);if(-1!==c)return c;c=Oa.call(this._shortWeekdaysParse,a);if(-1!==c)return c;c=Oa.call(this._minWeekdaysParse,a)}else if("ddd"===c){c=Oa.call(this._shortWeekdaysParse,a);if(-1!==c)return c;c=Oa.call(this._weekdaysParse,a);if(-1!==c)return c;c=Oa.call(this._minWeekdaysParse,a)}else{c=Oa.call(this._minWeekdaysParse,a);if(-1!==c)return c;c=Oa.call(this._weekdaysParse,a);if(-1!==c)return c;c=Oa.call(this._shortWeekdaysParse,a)}return-1!==c?c:null}function ka(){function a(c,
b){return b.length-c.length}var c=[],b=[],e=[],d=[],g,f,n,k;for(g=0;7>g;g++)f=m([2E3,1]).day(g),n=this.weekdaysMin(f,""),k=this.weekdaysShort(f,""),f=this.weekdays(f,""),c.push(n),b.push(k),e.push(f),d.push(n),d.push(k),d.push(f);c.sort(a);b.sort(a);e.sort(a);d.sort(a);for(g=0;7>g;g++)b[g]=R(b[g]),e[g]=R(e[g]),d[g]=R(d[g]);this._weekdaysMinRegex=this._weekdaysShortRegex=this._weekdaysRegex=new RegExp("^("+d.join("|")+")","i");this._weekdaysStrictRegex=new RegExp("^("+e.join("|")+")","i");this._weekdaysShortStrictRegex=
new RegExp("^("+b.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+c.join("|")+")","i")}function sa(){return this.hours()%12||12}function Ea(a,c){I(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),c)})}function ra(a,c){return c._meridiemParse}function za(a){return a?a.toLowerCase().replace("_","-"):a}function wa(a){var c=null;if(!Ja[a]&&"undefined"!==typeof module&&module&&module.exports)try{c=Qb._abbr,require("./locale/"+a),Ha(c)}catch(b){}return Ja[a]}
function Ha(a,c){var b;a&&(b=n(c)?Ca(a):Ga(a,c))&&(Qb=b);return Qb._abbr}function Ga(a,c){if(null!==c){var b=Zb;c.abbr=a;null!=Ja[a]?(z("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),b=Ja[a]._config):null!=c.parentLocale&&(null!=Ja[c.parentLocale]?b=Ja[c.parentLocale]._config:z("parentLocaleUndefined",
"specified parentLocale is not defined yet. See http://momentjs.com/guides/#/warnings/parent-locale/"));Ja[a]=new C(B(b,c));Ha(a);return Ja[a]}delete Ja[a];return null}function Ca(a){var c;a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr);if(!a)return Qb;if(!l(a)){if(c=wa(a))return c;a=[a]}a:{c=0;for(var b,e,d,g;c<a.length;){g=za(a[c]).split("-");b=g.length;for(e=(e=za(a[c+1]))?e.split("-"):null;0<b;){if(d=wa(g.slice(0,b).join("-"))){a=d;break a}if(e&&e.length>=b&&w(g,e,!0)>=b-1)break;b--}c++}a=
null}return a}function Sa(a){var c;(c=a._a)&&-2===g(a).overflow&&(c=0>c[lb]||11<c[lb]?lb:1>c[cb]||c[cb]>fa(c[$a],c[lb])?cb:0>c[Qa]||24<c[Qa]||24===c[Qa]&&(0!==c[ab]||0!==c[mb]||0!==c[Cb])?Qa:0>c[ab]||59<c[ab]?ab:0>c[mb]||59<c[mb]?mb:0>c[Cb]||999<c[Cb]?Cb:-1,g(a)._overflowDayOfYear&&(c<$a||c>cb)&&(c=cb),g(a)._overflowWeeks&&-1===c&&(c=ec),g(a)._overflowWeekday&&-1===c&&(c=fc),g(a).overflow=c);return a}function Ka(a){var c,b;c=a._i;var e=gc.exec(c)||hc.exec(c),d,f,n,k;if(e){g(a).iso=!0;c=0;for(b=Rb.length;c<
b;c++)if(Rb[c][1].exec(e[1])){f=Rb[c][0];d=!1!==Rb[c][2];break}if(null==f)a._isValid=!1;else{if(e[3]){c=0;for(b=Wb.length;c<b;c++)if(Wb[c][1].exec(e[3])){n=(e[2]||" ")+Wb[c][0];break}if(null==n){a._isValid=!1;return}}if(d||null==n){if(e[4])if(ic.exec(e[4]))k="Z";else{a._isValid=!1;return}a._f=f+(n||"")+(k||"");Ta(a)}else a._isValid=!1}}else a._isValid=!1}function Wa(a){var c=jc.exec(a._i);null!==c?a._d=new Date(+c[1]):(Ka(a),!1===a._isValid&&(delete a._isValid,h.createFromInputFallback(a)))}function Pa(a,
c,b){return null!=a?a:null!=c?c:b}function La(a){var c,b=[],e;if(!a._d){e=new Date(h.now());e=a._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()];if(a._w&&null==a._a[cb]&&null==a._a[lb]){var d,f,n,k,m,t;d=a._w;if(null!=d.GG||null!=d.W||null!=d.E){if(m=1,t=4,f=Pa(d.GG,a._a[$a],ca(aa(),1,4).year),n=Pa(d.W,1),k=Pa(d.E,1),1>k||7<k)c=!0}else if(m=a._locale._week.dow,t=a._locale._week.doy,f=Pa(d.gg,a._a[$a],ca(aa(),m,t).year),n=Pa(d.w,1),null!=d.d){if(k=
d.d,0>k||6<k)c=!0}else if(null!=d.e){if(k=d.e+m,0>d.e||6<d.e)c=!0}else k=m;1>n||n>ja(f,m,t)?g(a)._overflowWeeks=!0:null!=c?g(a)._overflowWeekday=!0:(c=qa(f,n,k,m,t),a._a[$a]=c.year,a._dayOfYear=c.dayOfYear)}a._dayOfYear&&(c=Pa(a._a[$a],e[$a]),a._dayOfYear>(Aa(c)?366:365)&&(g(a)._overflowDayOfYear=!0),c=va(c,0,a._dayOfYear),a._a[lb]=c.getUTCMonth(),a._a[cb]=c.getUTCDate());for(c=0;3>c&&null==a._a[c];++c)a._a[c]=b[c]=e[c];for(;7>c;c++)a._a[c]=b[c]=null==a._a[c]?2===c?1:0:a._a[c];24===a._a[Qa]&&0===
a._a[ab]&&0===a._a[mb]&&0===a._a[Cb]&&(a._nextDay=!0,a._a[Qa]=0);a._d=(a._useUTC?va:ta).apply(null,b);null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm);a._nextDay&&(a._a[Qa]=24)}}function Ta(a){if(a._f===h.ISO_8601)Ka(a);else{a._a=[];g(a).empty=!0;var c=""+a._i,b,e,d,n,k,m=c.length,t=0;d=Q(a._f,a._locale).match(Ab)||[];for(b=0;b<d.length;b++){n=d[b];if(e=(c.match(T(n,a))||[])[0])k=c.substr(0,c.indexOf(e)),0<k.length&&g(a).unusedInput.push(k),c=c.slice(c.indexOf(e)+e.length),t+=e.length;
if(Za[n]){if(e?g(a).empty=!1:g(a).unusedTokens.push(n),k=a,null!=e&&f(Vb,n))Vb[n](e,k._a,k,n)}else a._strict&&!e&&g(a).unusedTokens.push(n)}g(a).charsLeftOver=m-t;0<c.length&&g(a).unusedInput.push(c);12>=a._a[Qa]&&!0===g(a).bigHour&&0<a._a[Qa]&&(g(a).bigHour=void 0);g(a).parsedDateParts=a._a.slice(0);g(a).meridiem=a._meridiem;c=a._a;b=Qa;m=a._locale;d=a._a[Qa];t=a._meridiem;null!=t&&(null!=m.meridiemHour?d=m.meridiemHour(d,t):null!=m.isPM&&((m=m.isPM(t))&&12>d&&(d+=12),m||12!==d||(d=0)));c[b]=d;La(a);
Sa(a)}}function Na(a){if(!a._d){var c=F(a._i);a._a=b([c.year,c.month,c.day||c.date,c.hour,c.minute,c.second,c.millisecond],function(a){return a&&parseInt(a,10)});La(a)}}function Y(a){var b=a._i,f=a._f;a._locale=a._locale||Ca(a._l);if(null===b||void 0===f&&""===b)return c({nullInput:!0});"string"===typeof b&&(a._i=b=a._locale.preparse(b));if(u(b))return new r(Sa(b));if(l(f)){var n,m,t;if(0===a._f.length)g(a).invalidFormat=!0,a._d=new Date(NaN);else{for(b=0;b<a._f.length;b++)if(f=0,n=q({},a),null!=
a._useUTC&&(n._useUTC=a._useUTC),n._f=a._f[b],Ta(n),e(n)&&(f+=g(n).charsLeftOver,f+=10*g(n).unusedTokens.length,g(n).score=f,null==t||f<t))t=f,m=n;k(a,m||n)}}else d(b)?a._d=b:f?Ta(a):Ia(a);e(a)||(a._d=null);return a}function Ia(a){var c=a._i;void 0===c?a._d=new Date(h.now()):d(c)?a._d=new Date(c.valueOf()):"string"===typeof c?Wa(a):l(c)?(a._a=b(c.slice(0),function(a){return parseInt(a,10)}),La(a)):"object"===typeof c?Na(a):"number"===typeof c?a._d=new Date(c):h.createFromInputFallback(a)}function Ya(c,
b,e,d,g){var f={};"boolean"===typeof e&&(d=e,e=void 0);var n;if(n=a(c))a:{n=c;for(var k in n){n=!1;break a}n=!0}if(n||l(c)&&0===c.length)c=void 0;f._isAMomentObject=!0;f._useUTC=f._isUTC=g;f._l=e;f._i=c;f._f=b;f._strict=d;c=new r(Sa(Y(f)));c._nextDay&&(c.add(1,"d"),c._nextDay=void 0);return c}function aa(a,c,b,e){return Ya(a,c,b,e,!1)}function Ua(a,c){var b,e;1===c.length&&l(c[0])&&(c=c[0]);if(!c.length)return aa();b=c[0];for(e=1;e<c.length;++e)if(!c[e].isValid()||c[e][a](b))b=c[e];return b}function Ma(a){a=
F(a);var c=a.year||0,b=a.quarter||0,e=a.month||0,d=a.week||0,g=a.day||0;this._milliseconds=+(a.millisecond||0)+1E3*(a.second||0)+6E4*(a.minute||0)+36E5*(a.hour||0);this._days=+g+7*d;this._months=+e+3*b+12*c;this._data={};this._locale=Ca();this._bubble()}function ia(a){return a instanceof Ma}function xa(a){return 0>a?-1*Math.round(-1*a):Math.round(a)}function X(a,c){I(a,0,0,function(){var a=this.utcOffset(),b="+";0>a&&(a=-a,b="-");return b+J(~~(a/60),2)+c+J(~~a%60,2)})}function ma(a,c){var b=(c||"").match(a)||
[],b=((b[b.length-1]||[])+"").match(kc)||["-",0,0],e=+(60*b[1])+t(b[2]);return"+"===b[0]?e:-e}function P(a,c){var b,e;return c._isUTC?(b=c.clone(),e=(u(a)||d(a)?a.valueOf():aa(a).valueOf())-b.valueOf(),b._d.setTime(b._d.valueOf()+e),h.updateOffset(b,!1),b):aa(a).local()}function ha(){return this.isValid()?this._isUTC&&0===this._offset:!1}function ga(a,c){var b=a,e=null;ia(a)?b={ms:a._milliseconds,d:a._days,M:a._months}:"number"===typeof a?(b={},c?b[c]=a:b.milliseconds=a):(e=lc.exec(a))?(b="-"===e[1]?
-1:1,b={y:0,d:t(e[cb])*b,h:t(e[Qa])*b,m:t(e[ab])*b,s:t(e[mb])*b,ms:t(xa(1E3*e[Cb]))*b}):(e=mc.exec(a))?(b="-"===e[1]?-1:1,b={y:na(e[2],b),M:na(e[3],b),w:na(e[4],b),d:na(e[5],b),h:na(e[6],b),m:na(e[7],b),s:na(e[8],b)}):null==b?b={}:"object"===typeof b&&("from"in b||"to"in b)&&(e=aa(b.from),b=aa(b.to),e.isValid()&&b.isValid()?(b=P(b,e),e.isBefore(b)?b=ba(e,b):(b=ba(b,e),b.milliseconds=-b.milliseconds,b.months=-b.months),e=b):e={milliseconds:0,months:0},b={},b.ms=e.milliseconds,b.M=e.months);b=new Ma(b);
ia(a)&&f(a,"_locale")&&(b._locale=a._locale);return b}function na(a,c){var b=a&&parseFloat(a.replace(",","."));return(isNaN(b)?0:b)*c}function ba(a,c){var b={milliseconds:0,months:0};b.months=c.month()-a.month()+12*(c.year()-a.year());a.clone().add(b.months,"M").isAfter(c)&&--b.months;b.milliseconds=+c-+a.clone().add(b.months,"M");return b}function da(a,c){return function(b,e){var d;null===e||isNaN(+e)||(z(c,"moment()."+c+"(period, number) is deprecated. Please use moment()."+c+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),
d=b,b=e,e=d);d=ga("string"===typeof b?+b:b,e);V(this,d,a);return this}}function V(a,c,b,e){var d=c._milliseconds,g=xa(c._days);c=xa(c._months);if(a.isValid()){e=null==e?!0:e;d&&a._d.setTime(a._d.valueOf()+d*b);if(g&&(d=K(a,"Date")+g*b,a.isValid()))a._d["set"+(a._isUTC?"UTC":"")+"Date"](d);c&&ea(a,K(a,"Month")+c*b);e&&h.updateOffset(a,g||c)}}function rb(a){if(void 0===a)return this._locale._abbr;a=Ca(a);null!=a&&(this._locale=a);return this}function hb(){return this._locale}function gb(a,c){I(0,[a,
a.length],0,c)}function xb(a,c,b,e,d){var g;if(null==a)return ca(this,e,d).year;g=ja(a,e,d);c>g&&(c=g);a=qa(a,c,b,e,d);a=va(a.year,0,a.dayOfYear);this.year(a.getUTCFullYear());this.month(a.getUTCMonth());this.date(a.getUTCDate());return this}function Jb(a,c){c[Cb]=t(1E3*("0."+a))}function ib(a){return a}function jb(a,c,b,e){var d=Ca();c=m().set(e,c);return d[b](c,a)}function Mb(a,c,b){"number"===typeof a&&(c=a,a=void 0);a=a||"";if(null!=c)return jb(a,c,b,"month");var e=[];for(c=0;12>c;c++)e[c]=jb(a,
c,b,"month");return e}function qb(a,c,b,e){"boolean"!==typeof a&&(b=c=a,a=!1);"number"===typeof c&&(b=c,c=void 0);c=c||"";var d=Ca();a=a?d._week.dow:0;if(null!=b)return jb(c,(b+a)%7,e,"day");d=[];for(b=0;7>b;b++)d[b]=jb(c,(b+a)%7,e,"day");return d}function Va(a,c,b,e){c=ga(c,b);a._milliseconds+=e*c._milliseconds;a._days+=e*c._days;a._months+=e*c._months;return a._bubble()}function Nb(a){return 0>a?Math.floor(a):Math.ceil(a)}function Xa(a){return function(){return this.as(a)}}function bb(a){return function(){return this._data[a]}}
function Pb(a,c,b,e,d){return d.relativeTime(c||1,!!b,a,e)}function eb(){var a=Xb(this._milliseconds)/1E3,c=Xb(this._days),b=Xb(this._months),e,d,g;e=v(a/60);d=v(e/60);a%=60;e%=60;g=v(b/12);var b=b%12,f=this.asSeconds();return f?(0>f?"-":"")+"P"+(g?g+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(d||e||a?"T":"")+(d?d+"H":"")+(e?e+"M":"")+(a?a+"S":""):"P0D"}var vb,wb;wb=Array.prototype.some?Array.prototype.some:function(a){for(var c=Object(this),b=c.length>>>0,e=0;e<b;e++)if(e in c&&a.call(this,c[e],e,c))return!0;
return!1};var yb=h.momentProperties=[],sb=!1,Kb={};h.suppressDeprecationWarnings=!1;h.deprecationHandler=null;var zb;zb=Object.keys?Object.keys:function(a){var c,b=[];for(c in a)f(a,c)&&b.push(c);return b};var fb={},Fa={},Ab=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,kb=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Bb={},Za={},Db=/\d/,Ra=/\d\d/,Eb=/\d{3}/,Fb=/\d{4}/,
nb=/[+-]?\d{6}/,Ba=/\d\d?/,Gb=/\d\d\d\d?/,Hb=/\d\d\d\d\d\d?/,ob=/\d{1,3}/,Ib=/\d{1,4}/,Lb=/[+-]?\d{1,6}/,Yb=/\d+/,Sb=/[+-]?\d+/,$b=/Z|[+-]\d\d:?\d\d/gi,Tb=/Z|[+-]\d\d(?::?\d\d)?/gi,Ob=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ub={},Vb={},$a=0,lb=1,cb=2,Qa=3,ab=4,mb=5,Cb=6,ec=7,fc=8,Oa;Oa=Array.prototype.indexOf?Array.prototype.indexOf:function(a){var c;for(c=0;c<this.length;++c)if(this[c]===a)return c;return-1};I("M",["MM",2],
"Mo",function(){return this.month()+1});I("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)});I("MMMM",0,0,function(a){return this.localeData().months(this,a)});D("month","M");Fa.month=8;O("M",Ba);O("MM",Ba,Ra);O("MMM",function(a,c){return c.monthsShortRegex(a)});O("MMMM",function(a,c){return c.monthsRegex(a)});U(["M","MM"],function(a,c){c[lb]=t(a)-1});U(["MMM","MMMM"],function(a,c,b,e){e=b._locale.monthsParse(a,e,b._strict);null!=e?c[lb]=e:g(b).invalidMonth=a});var ac=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;
I("Y",0,0,function(){var a=this.year();return 9999>=a?""+a:"+"+a});I(0,["YY",2],0,function(){return this.year()%100});I(0,["YYYY",4],0,"year");I(0,["YYYYY",5],0,"year");I(0,["YYYYYY",6,!0],0,"year");D("year","y");Fa.year=1;O("Y",Sb);O("YY",Ba,Ra);O("YYYY",Ib,Fb);O("YYYYY",Lb,nb);O("YYYYYY",Lb,nb);U(["YYYYY","YYYYYY"],$a);U("YYYY",function(a,c){c[$a]=2===a.length?h.parseTwoDigitYear(a):t(a)});U("YY",function(a,c){c[$a]=h.parseTwoDigitYear(a)});U("Y",function(a,c){c[$a]=parseInt(a,10)});h.parseTwoDigitYear=
function(a){return t(a)+(68<t(a)?1900:2E3)};var bc=G("FullYear",!0);I("w",["ww",2],"wo","week");I("W",["WW",2],"Wo","isoWeek");D("week","w");D("isoWeek","W");Fa.week=5;Fa.isoWeek=5;O("w",Ba);O("ww",Ba,Ra);O("W",Ba);O("WW",Ba,Ra);W(["w","ww","W","WW"],function(a,c,b,e){c[e.substr(0,1)]=t(a)});I("d",0,"do","day");I("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)});I("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)});I("dddd",0,0,function(a){return this.localeData().weekdays(this,
a)});I("e",0,0,"weekday");I("E",0,0,"isoWeekday");D("day","d");D("weekday","e");D("isoWeekday","E");Fa.day=11;Fa.weekday=11;Fa.isoWeekday=11;O("d",Ba);O("e",Ba);O("E",Ba);O("dd",function(a,c){return c.weekdaysMinRegex(a)});O("ddd",function(a,c){return c.weekdaysShortRegex(a)});O("dddd",function(a,c){return c.weekdaysRegex(a)});W(["dd","ddd","dddd"],function(a,c,b,e){e=b._locale.weekdaysParse(a,e,b._strict);null!=e?c.d=e:g(b).invalidWeekday=a});W(["d","e","E"],function(a,c,b,e){c[e]=t(a)});I("H",["HH",
2],0,"hour");I("h",["hh",2],0,sa);I("k",["kk",2],0,function(){return this.hours()||24});I("hmm",0,0,function(){return""+sa.apply(this)+J(this.minutes(),2)});I("hmmss",0,0,function(){return""+sa.apply(this)+J(this.minutes(),2)+J(this.seconds(),2)});I("Hmm",0,0,function(){return""+this.hours()+J(this.minutes(),2)});I("Hmmss",0,0,function(){return""+this.hours()+J(this.minutes(),2)+J(this.seconds(),2)});Ea("a",!0);Ea("A",!1);D("hour","h");Fa.hour=13;O("a",ra);O("A",ra);O("H",Ba);O("h",Ba);O("HH",Ba,
Ra);O("hh",Ba,Ra);O("hmm",Gb);O("hmmss",Hb);O("Hmm",Gb);O("Hmmss",Hb);U(["H","HH"],Qa);U(["a","A"],function(a,c,b){b._isPm=b._locale.isPM(a);b._meridiem=a});U(["h","hh"],function(a,c,b){c[Qa]=t(a);g(b).bigHour=!0});U("hmm",function(a,c,b){var e=a.length-2;c[Qa]=t(a.substr(0,e));c[ab]=t(a.substr(e));g(b).bigHour=!0});U("hmmss",function(a,c,b){var e=a.length-4,d=a.length-2;c[Qa]=t(a.substr(0,e));c[ab]=t(a.substr(e,2));c[mb]=t(a.substr(d));g(b).bigHour=!0});U("Hmm",function(a,c,b){b=a.length-2;c[Qa]=
t(a.substr(0,b));c[ab]=t(a.substr(b))});U("Hmmss",function(a,c,b){b=a.length-4;var e=a.length-2;c[Qa]=t(a.substr(0,b));c[ab]=t(a.substr(b,2));c[mb]=t(a.substr(e))});var nc=G("Hours",!0),Zb={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",
ordinal:"%d",ordinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),week:{dow:0,doy:6},weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),meridiemParse:/[ap]\.?m?\.?/i},Ja={},Qb,gc=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,hc=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,ic=/Z|[+-]\d\d(?::?\d\d)?/,Rb=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],
["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Wb=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],
["HHmm",/\d\d\d\d/],["HH",/\d\d/]],jc=/^\/?Date\((\-?\d+)/i;h.createFromInputFallback=y("value provided is not in a recognized ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))});h.ISO_8601=function(){};var oc=y("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",
function(){var a=aa.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:c()}),pc=y("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=aa.apply(null,arguments);return this.isValid()&&a.isValid()?a>this?this:a:c()});X("Z",":");X("ZZ","");O("Z",Tb);O("ZZ",Tb);U(["Z","ZZ"],function(a,c,b){b._useUTC=!0;b._tzm=ma(Tb,a)});var kc=/([\+\-]|\d\d)/gi;h.updateOffset=function(){};var lc=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,
mc=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;ga.fn=Ma.prototype;var qc=da(1,"add"),rc=da(-1,"subtract");h.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";h.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var cc=y("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});
I(0,["gg",2],0,function(){return this.weekYear()%100});I(0,["GG",2],0,function(){return this.isoWeekYear()%100});gb("gggg","weekYear");gb("ggggg","weekYear");gb("GGGG","isoWeekYear");gb("GGGGG","isoWeekYear");D("weekYear","gg");D("isoWeekYear","GG");Fa.weekYear=1;Fa.isoWeekYear=1;O("G",Sb);O("g",Sb);O("GG",Ba,Ra);O("gg",Ba,Ra);O("GGGG",Ib,Fb);O("gggg",Ib,Fb);O("GGGGG",Lb,nb);O("ggggg",Lb,nb);W(["gggg","ggggg","GGGG","GGGGG"],function(a,c,b,e){c[e.substr(0,2)]=t(a)});W(["gg","GG"],function(a,c,b,e){c[e]=
h.parseTwoDigitYear(a)});I("Q",0,"Qo","quarter");D("quarter","Q");Fa.quarter=7;O("Q",Db);U("Q",function(a,c){c[lb]=3*(t(a)-1)});I("D",["DD",2],"Do","date");D("date","D");Fa.date=9;O("D",Ba);O("DD",Ba,Ra);O("Do",function(a,c){return a?c._ordinalParse:c._ordinalParseLenient});U(["D","DD"],cb);U("Do",function(a,c){c[cb]=t(a.match(Ba)[0],10)});var dc=G("Date",!0);I("DDD",["DDDD",3],"DDDo","dayOfYear");D("dayOfYear","DDD");Fa.dayOfYear=4;O("DDD",ob);O("DDDD",Eb);U(["DDD","DDDD"],function(a,c,b){b._dayOfYear=
t(a)});I("m",["mm",2],0,"minute");D("minute","m");Fa.minute=14;O("m",Ba);O("mm",Ba,Ra);U(["m","mm"],ab);var sc=G("Minutes",!1);I("s",["ss",2],0,"second");D("second","s");Fa.second=15;O("s",Ba);O("ss",Ba,Ra);U(["s","ss"],mb);var tc=G("Seconds",!1);I("S",0,0,function(){return~~(this.millisecond()/100)});I(0,["SS",2],0,function(){return~~(this.millisecond()/10)});I(0,["SSS",3],0,"millisecond");I(0,["SSSS",4],0,function(){return 10*this.millisecond()});I(0,["SSSSS",5],0,function(){return 100*this.millisecond()});
I(0,["SSSSSS",6],0,function(){return 1E3*this.millisecond()});I(0,["SSSSSSS",7],0,function(){return 1E4*this.millisecond()});I(0,["SSSSSSSS",8],0,function(){return 1E5*this.millisecond()});I(0,["SSSSSSSSS",9],0,function(){return 1E6*this.millisecond()});D("millisecond","ms");Fa.millisecond=16;O("S",ob,Db);O("SS",ob,Ra);O("SSS",ob,Eb);var db;for(db="SSSS";9>=db.length;db+="S")O(db,Yb);for(db="S";9>=db.length;db+="S")U(db,Jb);var uc=G("Milliseconds",!1);I("z",0,0,"zoneAbbr");I("zz",0,0,"zoneName");
var Z=r.prototype;Z.add=qc;Z.calendar=function(a,c){var b=a||aa(),e=P(b,this).startOf("day"),e=h.calendarFormat(this,e)||"sameElse",d=c&&(A(c[e])?c[e].call(this,b):c[e]);return this.format(d||this.localeData().calendar(e,this,aa(b)))};Z.clone=function(){return new r(this)};Z.diff=function(a,c,b){var e;if(!this.isValid())return NaN;a=P(a,this);if(!a.isValid())return NaN;e=6E4*(a.utcOffset()-this.utcOffset());c=E(c);if("year"===c||"month"===c||"quarter"===c){e=12*(a.year()-this.year())+(a.month()-this.month());
var d=this.clone().add(e,"months"),g;0>a-d?(g=this.clone().add(e-1,"months"),a=(a-d)/(d-g)):(g=this.clone().add(e+1,"months"),a=(a-d)/(g-d));a=-(e+a)||0;"quarter"===c?a/=3:"year"===c&&(a/=12)}else a=this-a,a="second"===c?a/1E3:"minute"===c?a/6E4:"hour"===c?a/36E5:"day"===c?(a-e)/864E5:"week"===c?(a-e)/6048E5:a;return b?a:v(a)};Z.endOf=function(a){a=E(a);if(void 0===a||"millisecond"===a)return this;"date"===a&&(a="day");return this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")};Z.format=
function(a){a||(a=this.isUtc()?h.defaultFormatUtc:h.defaultFormat);a=N(this,a);return this.localeData().postformat(a)};Z.from=function(a,c){return this.isValid()&&(u(a)&&a.isValid()||aa(a).isValid())?ga({to:this,from:a}).locale(this.locale()).humanize(!c):this.localeData().invalidDate()};Z.fromNow=function(a){return this.from(aa(),a)};Z.to=function(a,c){return this.isValid()&&(u(a)&&a.isValid()||aa(a).isValid())?ga({from:this,to:a}).locale(this.locale()).humanize(!c):this.localeData().invalidDate()};
Z.toNow=function(a){return this.to(aa(),a)};Z.get=function(a){a=E(a);return A(this[a])?this[a]():this};Z.invalidAt=function(){return g(this).overflow};Z.isAfter=function(a,c){var b=u(a)?a:aa(a);if(!this.isValid()||!b.isValid())return!1;c=E(n(c)?"millisecond":c);return"millisecond"===c?this.valueOf()>b.valueOf():b.valueOf()<this.clone().startOf(c).valueOf()};Z.isBefore=function(a,c){var b=u(a)?a:aa(a);if(!this.isValid()||!b.isValid())return!1;c=E(n(c)?"millisecond":c);return"millisecond"===c?this.valueOf()<
b.valueOf():this.clone().endOf(c).valueOf()<b.valueOf()};Z.isBetween=function(a,c,b,e){e=e||"()";return("("===e[0]?this.isAfter(a,b):!this.isBefore(a,b))&&(")"===e[1]?this.isBefore(c,b):!this.isAfter(c,b))};Z.isSame=function(a,c){var b=u(a)?a:aa(a);if(!this.isValid()||!b.isValid())return!1;c=E(c||"millisecond");if("millisecond"===c)return this.valueOf()===b.valueOf();b=b.valueOf();return this.clone().startOf(c).valueOf()<=b&&b<=this.clone().endOf(c).valueOf()};Z.isSameOrAfter=function(a,c){return this.isSame(a,
c)||this.isAfter(a,c)};Z.isSameOrBefore=function(a,c){return this.isSame(a,c)||this.isBefore(a,c)};Z.isValid=function(){return e(this)};Z.lang=cc;Z.locale=rb;Z.localeData=hb;Z.max=pc;Z.min=oc;Z.parsingFlags=function(){return k({},g(this))};Z.set=function(a,c){if("object"===typeof a){a=F(a);for(var b=H(a),e=0;e<b.length;e++)this[b[e].unit](a[b[e].unit])}else if(a=E(a),A(this[a]))return this[a](c);return this};Z.startOf=function(a){a=E(a);switch(a){case "year":this.month(0);case "quarter":case "month":this.date(1);
case "week":case "isoWeek":case "day":case "date":this.hours(0);case "hour":this.minutes(0);case "minute":this.seconds(0);case "second":this.milliseconds(0)}"week"===a&&this.weekday(0);"isoWeek"===a&&this.isoWeekday(1);"quarter"===a&&this.month(3*Math.floor(this.month()/3));return this};Z.subtract=rc;Z.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]};Z.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),
hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}};Z.toDate=function(){return new Date(this.valueOf())};Z.toISOString=function(){var a=this.clone().utc();return 0<a.year()&&9999>=a.year()?A(Date.prototype.toISOString)?this.toDate().toISOString():N(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):N(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")};Z.toJSON=function(){return this.isValid()?this.toISOString():null};Z.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")};
Z.unix=function(){return Math.floor(this.valueOf()/1E3)};Z.valueOf=function(){return this._d.valueOf()-6E4*(this._offset||0)};Z.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}};Z.year=bc;Z.isLeapYear=function(){return Aa(this.year())};Z.weekYear=function(a){return xb.call(this,a,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)};Z.isoWeekYear=function(a){return xb.call(this,a,this.isoWeek(),this.isoWeekday(),
1,4)};Z.quarter=Z.quarters=function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)};Z.month=oa;Z.daysInMonth=function(){return fa(this.year(),this.month())};Z.week=Z.weeks=function(a){var c=this.localeData().week(this);return null==a?c:this.add(7*(a-c),"d")};Z.isoWeek=Z.isoWeeks=function(a){var c=ca(this,1,4).week;return null==a?c:this.add(7*(a-c),"d")};Z.weeksInYear=function(){var a=this.localeData()._week;return ja(this.year(),a.dow,a.doy)};Z.isoWeeksInYear=function(){return ja(this.year(),
1,4)};Z.date=dc;Z.day=Z.days=function(a){if(!this.isValid())return null!=a?this:NaN;var c=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=a){var b=this.localeData();"string"===typeof a&&(isNaN(a)?(a=b.weekdaysParse(a),a="number"===typeof a?a:null):a=parseInt(a,10));return this.add(a-c,"d")}return c};Z.weekday=function(a){if(!this.isValid())return null!=a?this:NaN;var c=(this.day()+7-this.localeData()._week.dow)%7;return null==a?c:this.add(a-c,"d")};Z.isoWeekday=function(a){if(!this.isValid())return null!=
a?this:NaN;if(null!=a){var c=this.localeData();a="string"===typeof a?c.weekdaysParse(a)%7||7:isNaN(a)?null:a;return this.day(this.day()%7?a:a-7)}return this.day()||7};Z.dayOfYear=function(a){var c=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864E5)+1;return null==a?c:this.add(a-c,"d")};Z.hour=Z.hours=nc;Z.minute=Z.minutes=sc;Z.second=Z.seconds=tc;Z.millisecond=Z.milliseconds=uc;Z.utcOffset=function(a,c){var b=this._offset||0,e;return this.isValid()?null!=a?("string"===typeof a?
a=ma(Tb,a):16>Math.abs(a)&&(a*=60),!this._isUTC&&c&&(e=15*-Math.round(this._d.getTimezoneOffset()/15)),this._offset=a,this._isUTC=!0,null!=e&&this.add(e,"m"),b!==a&&(!c||this._changeInProgress?V(this,ga(a-b,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,h.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?b:15*-Math.round(this._d.getTimezoneOffset()/15):null!=a?this:NaN};Z.utc=function(a){return this.utcOffset(0,a)};Z.local=function(a){this._isUTC&&(this.utcOffset(0,
a),this._isUTC=!1,a&&this.subtract(15*-Math.round(this._d.getTimezoneOffset()/15),"m"));return this};Z.parseZone=function(){this._tzm?this.utcOffset(this._tzm):"string"===typeof this._i&&(0===ma($b,this._i)?this.utcOffset(0,!0):this.utcOffset(ma($b,this._i)));return this};Z.hasAlignedHourOffset=function(a){if(!this.isValid())return!1;a=a?aa(a).utcOffset():0;return 0===(this.utcOffset()-a)%60};Z.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()};
Z.isLocal=function(){return this.isValid()?!this._isUTC:!1};Z.isUtcOffset=function(){return this.isValid()?this._isUTC:!1};Z.isUtc=ha;Z.isUTC=ha;Z.zoneAbbr=function(){return this._isUTC?"UTC":""};Z.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""};Z.dates=y("dates accessor is deprecated. Use date instead.",dc);Z.months=y("months accessor is deprecated. Use month instead",oa);Z.years=y("years accessor is deprecated. Use year instead",bc);Z.zone=y("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",
function(a,c){return null!=a?("string"!==typeof a&&(a=-a),this.utcOffset(a,c),this):-this.utcOffset()});Z.isDSTShifted=y("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!n(this._isDSTShifted))return this._isDSTShifted;var a={};q(a,this);a=Y(a);if(a._a){var c=a._isUTC?m(a._a):aa(a._a);this._isDSTShifted=this.isValid()&&0<w(a._a,c.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var Da=C.prototype;Da.calendar=function(a,
c,b){a=this._calendar[a]||this._calendar.sameElse;return A(a)?a.call(c,b):a};Da.longDateFormat=function(a){var c=this._longDateFormat[a],b=this._longDateFormat[a.toUpperCase()];if(c||!b)return c;this._longDateFormat[a]=b.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)});return this._longDateFormat[a]};Da.invalidDate=function(){return this._invalidDate};Da.ordinal=function(a){return this._ordinal.replace("%d",a)};Da.preparse=ib;Da.postformat=ib;Da.relativeTime=function(a,c,b,e){var d=this._relativeTime[b];
return A(d)?d(a,c,b,e):d.replace(/%d/i,a)};Da.pastFuture=function(a,c){var b=this._relativeTime[0<a?"future":"past"];return A(b)?b(c):b.replace(/%s/i,c)};Da.set=function(a){var c,b;for(b in a)c=a[b],A(c)?this[b]=c:this["_"+b]=c;this._config=a;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)};Da.months=function(a,c){return a?l(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||ac).test(c)?"format":"standalone"][a.month()]:this._months};Da.monthsShort=
function(a,c){return a?l(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[ac.test(c)?"format":"standalone"][a.month()]:this._monthsShort};Da.monthsParse=function(a,c,b){var e,d;if(this._monthsParseExact){a:{a=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],e=0;12>e;++e)d=m([2E3,e]),this._shortMonthsParse[e]=this.monthsShort(d,"").toLocaleLowerCase(),this._longMonthsParse[e]=this.months(d,"").toLocaleLowerCase();
if(b)c="MMM"===c?Oa.call(this._shortMonthsParse,a):Oa.call(this._longMonthsParse,a);else if("MMM"===c){c=Oa.call(this._shortMonthsParse,a);if(-1!==c)break a;c=Oa.call(this._longMonthsParse,a)}else{c=Oa.call(this._longMonthsParse,a);if(-1!==c)break a;c=Oa.call(this._shortMonthsParse,a)}c=-1!==c?c:null}return c}this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(e=0;12>e;e++)if(d=m([2E3,e]),b&&!this._longMonthsParse[e]&&(this._longMonthsParse[e]=new RegExp("^"+
this.months(d,"").replace(".","")+"$","i"),this._shortMonthsParse[e]=new RegExp("^"+this.monthsShort(d,"").replace(".","")+"$","i")),b||this._monthsParse[e]||(d="^"+this.months(d,"")+"|^"+this.monthsShort(d,""),this._monthsParse[e]=new RegExp(d.replace(".",""),"i")),b&&"MMMM"===c&&this._longMonthsParse[e].test(a)||b&&"MMM"===c&&this._shortMonthsParse[e].test(a)||!b&&this._monthsParse[e].test(a))return e};Da.monthsRegex=function(a){if(this._monthsParseExact)return f(this,"_monthsRegex")||pa.call(this),
a?this._monthsStrictRegex:this._monthsRegex;f(this,"_monthsRegex")||(this._monthsRegex=Ob);return this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex};Da.monthsShortRegex=function(a){if(this._monthsParseExact)return f(this,"_monthsRegex")||pa.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex;f(this,"_monthsShortRegex")||(this._monthsShortRegex=Ob);return this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex};Da.week=function(a){return ca(a,
this._week.dow,this._week.doy).week};Da.firstDayOfYear=function(){return this._week.doy};Da.firstDayOfWeek=function(){return this._week.dow};Da.weekdays=function(a,c){return a?l(this._weekdays)?this._weekdays[a.day()]:this._weekdays[this._weekdays.isFormat.test(c)?"format":"standalone"][a.day()]:this._weekdays};Da.weekdaysMin=function(a){return a?this._weekdaysMin[a.day()]:this._weekdaysMin};Da.weekdaysShort=function(a){return a?this._weekdaysShort[a.day()]:this._weekdaysShort};Da.weekdaysParse=function(a,
c,b){var e,d;if(this._weekdaysParseExact)return la.call(this,a,c,b);this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]);for(e=0;7>e;e++)if(d=m([2E3,1]).day(e),b&&!this._fullWeekdaysParse[e]&&(this._fullWeekdaysParse[e]=new RegExp("^"+this.weekdays(d,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[e]=new RegExp("^"+this.weekdaysShort(d,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[e]=new RegExp("^"+this.weekdaysMin(d,
"").replace(".",".?")+"$","i")),this._weekdaysParse[e]||(d="^"+this.weekdays(d,"")+"|^"+this.weekdaysShort(d,"")+"|^"+this.weekdaysMin(d,""),this._weekdaysParse[e]=new RegExp(d.replace(".",""),"i")),b&&"dddd"===c&&this._fullWeekdaysParse[e].test(a)||b&&"ddd"===c&&this._shortWeekdaysParse[e].test(a)||b&&"dd"===c&&this._minWeekdaysParse[e].test(a)||!b&&this._weekdaysParse[e].test(a))return e};Da.weekdaysRegex=function(a){if(this._weekdaysParseExact)return f(this,"_weekdaysRegex")||ka.call(this),a?this._weekdaysStrictRegex:
this._weekdaysRegex;f(this,"_weekdaysRegex")||(this._weekdaysRegex=Ob);return this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex};Da.weekdaysShortRegex=function(a){if(this._weekdaysParseExact)return f(this,"_weekdaysRegex")||ka.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;f(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ob);return this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex};Da.weekdaysMinRegex=function(a){if(this._weekdaysParseExact)return f(this,
"_weekdaysRegex")||ka.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;f(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ob);return this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex};Da.isPM=function(a){return"p"===(a+"").toLowerCase().charAt(0)};Da.meridiem=function(a,c,b){return 11<a?b?"pm":"PM":b?"am":"AM"};Ha("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var c=a%10,c=1===t(a%100/10)?"th":1===c?"st":2===c?"nd":3===c?"rd":"th";
return a+c}});h.lang=y("moment.lang is deprecated. Use moment.locale instead.",Ha);h.langData=y("moment.langData is deprecated. Use moment.localeData instead.",Ca);var pb=Math.abs,vc=Xa("ms"),wc=Xa("s"),xc=Xa("m"),yc=Xa("h"),zc=Xa("d"),Ac=Xa("w"),Bc=Xa("M"),Cc=Xa("y"),Dc=bb("milliseconds"),Ec=bb("seconds"),Fc=bb("minutes"),Gc=bb("hours"),Hc=bb("days"),Ic=bb("months"),Jc=bb("years"),tb=Math.round,ub={s:45,m:45,h:22,d:26,M:11},Xb=Math.abs,ya=Ma.prototype;ya.abs=function(){var a=this._data;this._milliseconds=
pb(this._milliseconds);this._days=pb(this._days);this._months=pb(this._months);a.milliseconds=pb(a.milliseconds);a.seconds=pb(a.seconds);a.minutes=pb(a.minutes);a.hours=pb(a.hours);a.months=pb(a.months);a.years=pb(a.years);return this};ya.add=function(a,c){return Va(this,a,c,1)};ya.subtract=function(a,c){return Va(this,a,c,-1)};ya.as=function(a){var c,b=this._milliseconds;a=E(a);if("month"===a||"year"===a)return c=this._days+b/864E5,c=this._months+4800*c/146097,"month"===a?c:c/12;c=this._days+Math.round(146097*
this._months/4800);switch(a){case "week":return c/7+b/6048E5;case "day":return c+b/864E5;case "hour":return 24*c+b/36E5;case "minute":return 1440*c+b/6E4;case "second":return 86400*c+b/1E3;case "millisecond":return Math.floor(864E5*c)+b;default:throw Error("Unknown unit "+a);}};ya.asMilliseconds=vc;ya.asSeconds=wc;ya.asMinutes=xc;ya.asHours=yc;ya.asDays=zc;ya.asWeeks=Ac;ya.asMonths=Bc;ya.asYears=Cc;ya.valueOf=function(){return this._milliseconds+864E5*this._days+this._months%12*2592E6+31536E6*t(this._months/
12)};ya._bubble=function(){var a=this._milliseconds,c=this._days,b=this._months,e=this._data;0<=a&&0<=c&&0<=b||0>=a&&0>=c&&0>=b||(a+=864E5*Nb(146097*b/4800+c),b=c=0);e.milliseconds=a%1E3;a=v(a/1E3);e.seconds=a%60;a=v(a/60);e.minutes=a%60;a=v(a/60);e.hours=a%24;c+=v(a/24);a=v(4800*c/146097);b+=a;c-=Nb(146097*a/4800);a=v(b/12);e.days=c;e.months=b%12;e.years=a;return this};ya.get=function(a){a=E(a);return this[a+"s"]()};ya.milliseconds=Dc;ya.seconds=Ec;ya.minutes=Fc;ya.hours=Gc;ya.days=Hc;ya.weeks=function(){return v(this.days()/
7)};ya.months=Ic;ya.years=Jc;ya.humanize=function(a){var c=this.localeData(),b;b=!a;var e=ga(this).abs(),d=tb(e.as("s")),g=tb(e.as("m")),f=tb(e.as("h")),n=tb(e.as("d")),k=tb(e.as("M")),e=tb(e.as("y")),d=d<ub.s&&["s",d]||1>=g&&["m"]||g<ub.m&&["mm",g]||1>=f&&["h"]||f<ub.h&&["hh",f]||1>=n&&["d"]||n<ub.d&&["dd",n]||1>=k&&["M"]||k<ub.M&&["MM",k]||1>=e&&["y"]||["yy",e];d[2]=b;d[3]=0<+this;d[4]=c;b=Pb.apply(null,d);a&&(b=c.pastFuture(+this,b));return c.postformat(b)};ya.toISOString=eb;ya.toString=eb;ya.toJSON=
eb;ya.locale=rb;ya.localeData=hb;ya.toIsoString=y("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",eb);ya.lang=cc;I("X",0,0,"unix");I("x",0,0,"valueOf");O("x",Sb);O("X",/[+-]?\d+(\.\d{1,3})?/);U("X",function(a,c,b){b._d=new Date(1E3*parseFloat(a,10))});U("x",function(a,c,b){b._d=new Date(t(a))});h.version="2.15.2";vb=aa;h.fn=Z;h.min=function(){var a=[].slice.call(arguments,0);return Ua("isBefore",a)};h.max=function(){var a=[].slice.call(arguments,0);return Ua("isAfter",
a)};h.now=function(){return Date.now?Date.now():+new Date};h.utc=m;h.unix=function(a){return aa(1E3*a)};h.months=function(a,c){return Mb(a,c,"months")};h.isDate=d;h.locale=Ha;h.invalid=c;h.duration=ga;h.isMoment=u;h.weekdays=function(a,c,b){return qb(a,c,b,"weekdays")};h.parseZone=function(){return aa.apply(null,arguments).parseZone()};h.localeData=Ca;h.isDuration=ia;h.monthsShort=function(a,c){return Mb(a,c,"monthsShort")};h.weekdaysMin=function(a,c,b){return qb(a,c,b,"weekdaysMin")};h.defineLocale=
Ga;h.updateLocale=function(a,c){if(null!=c){var b;b=Zb;null!=Ja[a]&&(b=Ja[a]._config);c=B(b,c);b=new C(c);b.parentLocale=Ja[a];Ja[a]=b;Ha(a)}else null!=Ja[a]&&(null!=Ja[a].parentLocale?Ja[a]=Ja[a].parentLocale:null!=Ja[a]&&delete Ja[a]);return Ja[a]};h.locales=function(){return zb(Ja)};h.weekdaysShort=function(a,c,b){return qb(a,c,b,"weekdaysShort")};h.normalizeUnits=E;h.relativeTimeRounding=function(a){return void 0===a?tb:"function"===typeof a?(tb=a,!0):!1};h.relativeTimeThreshold=function(a,c){if(void 0===
ub[a])return!1;if(void 0===c)return ub[a];ub[a]=c;return!0};h.calendarFormat=function(a,c){var b=a.diff(c,"days",!0);return-6>b?"sameElse":-1>b?"lastWeek":0>b?"lastDay":1>b?"sameDay":2>b?"nextDay":7>b?"nextWeek":"sameElse"};h.prototype=Z;return h})},"esri/arcade/ImmutableArray":function(){define(["require","exports"],function(h,l){return function(){function a(a){void 0===a&&(a=[]);this._elements=a}return a.prototype.length=function(){return this._elements.length},a.prototype.get=function(a){return this._elements[a]},
a.prototype.toArray=function(){for(var a=[],b=0;b<this.length();b++)a.push(this.get(b));return a},a}()})},"esri/arcade/ImmutablePointArray":function(){define("require exports ../core/tsSupport/extendsHelper ./ImmutableArray ../geometry/Point ../kernel".split(" "),function(h,l,a,d,b,f){var k=0===f.version.indexOf("4.");return function(d){function g(a,c,b,g,f,k){d.call(this,a);this._lazyPt=[];this._hasM=this._hasZ=!1;this._spRef=c;this._hasZ=b;this._hasM=g;this._cacheId=f;this._partId=k}return a(g,
d),g.prototype.get=function(a){if(void 0===this._lazyPt[a]){var c=this._elements[a];if(void 0===c)return;var d=this._hasZ,g=this._hasM,f=null,f=d&&!g?new b(c[0],c[1],c[2],void 0,this._spRef):g&&d?new b(c[0],c[1],void 0,c[2],this._spRef):d&&g?new b(c[0],c[1],c[2],c[3],this._spRef):new b(c[0],c[1],this._spRef);k?f.cache._arcadeCacheId=this._cacheId.toString()+"-"+this._partId.toString()+"-"+a.toString():f.setCacheValue("_arcadeCacheId",this._cacheId.toString()+"-"+this._partId.toString()+"-"+a.toString());
this._lazyPt[a]=f}return this._lazyPt[a]},g.prototype.equalityTest=function(a){return a===this?!0:null===a?!1:0==a instanceof g?!1:a.getUniqueHash()===this.getUniqueHash()},g.prototype.getUniqueHash=function(){return this._cacheId.toString()+"-"+this._partId.toString()},g}(d)})},"esri/core/tsSupport/extendsHelper":function(){define([],function(){return function(h,l){function a(){this.constructor=h}for(var d in l)l.hasOwnProperty(d)&&(h[d]=l[d]);h.prototype=null===l?Object.create(l):(a.prototype=l.prototype,
new a)}})},"esri/arcade/ImmutablePathArray":function(){define(["require","exports","../core/tsSupport/extendsHelper","./ImmutableArray","./ImmutablePointArray"],function(h,l,a,d,b){return function(d){function k(a,b,e,c,n){d.call(this,a);this._lazyPath=[];this._hasM=this._hasZ=!1;this._hasZ=e;this._hasM=c;this._spRef=b;this._cacheId=n}return a(k,d),k.prototype.get=function(a){if(void 0===this._lazyPath[a]){var d=this._elements[a];if(void 0===d)return;this._lazyPath[a]=new b(d,this._spRef,this._hasZ,
this._hasM,this._cacheId,a)}return this._lazyPath[a]},k.prototype.equalityTest=function(a){return a===this?!0:null===a?!1:0==a instanceof k?!1:a.getUniqueHash()===this.getUniqueHash()},k.prototype.getUniqueHash=function(){return this._cacheId.toString()},k}(d)})},"esri/arcade/FunctionWrapper":function(){define(["require","exports"],function(h,l){return function(){return function(a,d){this.context=this.definition=null;this.definition=a;this.context=d}}()})},"esri/geometry/Rect":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),
function(h,l,a,d,b,f,k,m,g,e){function c(a){return new g(parseFloat(a.x),parseFloat(a.y)-parseFloat(a.height),parseFloat(a.x)+parseFloat(a.width),parseFloat(a.y),a.spatialReference)}var n=h(k,{declaredClass:"esri.geometry.Rect",constructor:function(a,c,b,g,f){l.mixin(this,d.defaultRect);l.isObject(a)&&"extent"===a.type&&(c=a.ymax,b=a.getWidth(),g=a.getHeight(),f=a.spatialReference,a=a.xmin);l.isObject(a)?(l.mixin(this,a),this.spatialReference&&(this.spatialReference=e.createSpatialReference(this.spatialReference))):
(this.x=a,this.y=c,this.width=b,this.height=g,this.spatialReference=f);this.verifySR()},getCenter:function(){return new m(this.x+this.width/2,this.y+this.height/2,this.spatialReference)},offset:function(a,c){return new n(this.x+a,this.y+c,this.width,this.height,this.spatialReference)},intersects:function(a){return a.x+a.width<=this.x?!1:a.y+a.height<=this.y?!1:a.y>=this.y+this.height?!1:a.x>=this.x+this.width?!1:!0},getExtent:function(){return c(this)},update:function(a,c,b,e,d){return this.x=a,this.y=
c,this.width=b,this.height=e,this.spatialReference=d,this.clearCache(),this}});return a("extend-esri")&&(l.setObject("geometry.Rect",n,b),b.geometry._rectToExtent=c,b.geometry._extentToRect=function(a){return new n(a)}),n})},"esri/geometry/scaleUtils":function(){define("dojo/_base/lang dojo/has ../kernel ../config ../lang ../WKIDUnitConversion".split(" "),function(h,l,a,d,b,f){function k(a,b,d){return a&&b?a.getWidth()/b*(d||e)*g*c.screenDPI:0}function m(a,b,d,f,k){var m;return m=k?d:n.values[n[d]],
a.expand(f*b/((m||e)*g*c.screenDPI)/a.getWidth())}var g=39.37,e=6370997*Math.PI/180,c=d.defaults,n=f,q={getUnitValueForSR:function(a){return this.getUnitValue(a)||e},getUnitValue:function(a){var c,b,e;(a&&("object"==typeof a?(c=a.wkid,b=a.wkt):"number"==typeof a?c=a:"string"==typeof a&&(b=a)),c)?e=n.values[n[c]]:b&&-1!==b.search(/^PROJCS/i)&&(a=/UNIT\[([^\]]+)\]\]$/i.exec(b))&&a[1]&&(e=parseFloat(a[1].split(",")[1]));return e},getScale:function(a,c,e){var d,g,f;return 1<arguments.length&&b.isDefined(c)&&
!c.declaredClass?(d=a,g=c,c=null,f=q.getUnitValue(e)):(d=c||a.extent,g=a.width,f=q.getUnitValue(d&&d.spatialReference)),k(d,g,f)},getExtentForScale:function(a,c,b){return m(b||a.extent,a.width,q.getUnitValue(a.spatialReference),c,!0)}};return l("extend-esri")&&(h.mixin(h.getObject("geometry",!0,a),q),a.geometry._getScale=k,a.geometry._getExtentForScale=m),q})},"esri/WKIDUnitConversion":function(){define(["dojo/has","./kernel"],function(h,l){var a,d={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,
.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5E4,15E4],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,
3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,
3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,
3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,
4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,
6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,
6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,
6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,
6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,
6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,
7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,
22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,
29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53034:0,53048:0,53049:0,54034:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,
102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,
103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,
103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,
103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103695:2};for(a=2E3;2045>=a;a++)d[a]=
0;for(a=2056;2065>=a;a++)d[a]=0;for(a=2067;2135>=a;a++)d[a]=0;for(a=2137;2154>=a;a++)d[a]=0;for(a=2161;2170>=a;a++)d[a]=0;for(a=2172;2193>=a;a++)d[a]=0;for(a=2195;2198>=a;a++)d[a]=0;for(a=2200;2203>=a;a++)d[a]=0;for(a=2205;2217>=a;a++)d[a]=0;for(a=2222;2224>=a;a++)d[a]=1;for(a=2225;2250>=a;a++)d[a]=2;for(a=2251;2253>=a;a++)d[a]=1;for(a=2257;2264>=a;a++)d[a]=2;for(a=2274;2279>=a;a++)d[a]=2;for(a=2280;2282>=a;a++)d[a]=1;for(a=2283;2289>=a;a++)d[a]=2;for(a=2290;2292>=a;a++)d[a]=0;for(a=2308;2313>=a;a++)d[a]=
0;for(a=2315;2491>=a;a++)d[a]=0;for(a=2494;2866>=a;a++)d[a]=0;for(a=2867;2869>=a;a++)d[a]=1;for(a=2870;2888>=a;a++)d[a]=2;for(a=2891;2895>=a;a++)d[a]=2;for(a=2896;2898>=a;a++)d[a]=1;for(a=2902;2908>=a;a++)d[a]=2;for(a=2915;2920>=a;a++)d[a]=2;for(a=2921;2923>=a;a++)d[a]=1;for(a=2924;2930>=a;a++)d[a]=2;for(a=2931;2962>=a;a++)d[a]=0;for(a=2964;2968>=a;a++)d[a]=2;for(a=2969;2973>=a;a++)d[a]=0;for(a=2975;2991>=a;a++)d[a]=0;for(a=2995;3051>=a;a++)d[a]=0;for(a=3054;3079>=a;a++)d[a]=0;for(a=3081;3088>=a;a++)d[a]=
0;for(a=3092;3101>=a;a++)d[a]=0;for(a=3106;3138>=a;a++)d[a]=0;for(a=3146;3151>=a;a++)d[a]=0;for(a=3153;3166>=a;a++)d[a]=0;for(a=3168;3172>=a;a++)d[a]=0;for(a=3174;3203>=a;a++)d[a]=0;for(a=3294;3358>=a;a++)d[a]=0;for(a=3367;3403>=a;a++)d[a]=0;for(a=3408;3416>=a;a++)d[a]=0;for(a=3417;3438>=a;a++)d[a]=2;for(a=3441;3446>=a;a++)d[a]=2;for(a=3447;3450>=a;a++)d[a]=0;for(a=3451;3459>=a;a++)d[a]=2;for(a=3460;3478>=a;a++)d[a]=0;for(a=3554;3559>=a;a++)d[a]=0;for(a=3560;3570>=a;a++)d[a]=2;for(a=3571;3581>=a;a++)d[a]=
0;for(a=3594;3597>=a;a++)d[a]=0;for(a=3601;3604>=a;a++)d[a]=0;for(a=3637;3639>=a;a++)d[a]=0;for(a=3665;3667>=a;a++)d[a]=0;for(a=3693;3695>=a;a++)d[a]=0;for(a=3701;3727>=a;a++)d[a]=0;for(a=3728;3739>=a;a++)d[a]=2;for(a=3740;3751>=a;a++)d[a]=0;for(a=3753;3760>=a;a++)d[a]=2;for(a=3761;3773>=a;a++)d[a]=0;for(a=3775;3777>=a;a++)d[a]=0;for(a=3779;3781>=a;a++)d[a]=0;for(a=3783;3785>=a;a++)d[a]=0;for(a=3788;3791>=a;a++)d[a]=0;for(a=3797;3802>=a;a++)d[a]=0;for(a=3814;3816>=a;a++)d[a]=0;for(a=3825;3829>=a;a++)d[a]=
0;for(a=3832;3841>=a;a++)d[a]=0;for(a=3844;3852>=a;a++)d[a]=0;for(a=3873;3885>=a;a++)d[a]=0;for(a=3890;3893>=a;a++)d[a]=0;for(a=3907;3912>=a;a++)d[a]=0;for(a=3942;3950>=a;a++)d[a]=0;for(a=3968;3970>=a;a++)d[a]=0;for(a=3973;3976>=a;a++)d[a]=0;for(a=3986;3989>=a;a++)d[a]=0;for(a=3994;3997>=a;a++)d[a]=0;for(a=4048;4051>=a;a++)d[a]=0;for(a=4056;4063>=a;a++)d[a]=0;for(a=4093;4096>=a;a++)d[a]=0;for(a=4390;4398>=a;a++)d[a]=0;for(a=4399;4413>=a;a++)d[a]=2;for(a=4418;4433>=a;a++)d[a]=2;for(a=4455;4457>=a;a++)d[a]=
2;for(a=4484;4489>=a;a++)d[a]=0;for(a=4491;4554>=a;a++)d[a]=0;for(a=4568;4589>=a;a++)d[a]=0;for(a=4652;4656>=a;a++)d[a]=0;for(a=4766;4800>=a;a++)d[a]=0;for(a=5014;5016>=a;a++)d[a]=0;for(a=5069;5072>=a;a++)d[a]=0;for(a=5105;5130>=a;a++)d[a]=0;for(a=5173;5188>=a;a++)d[a]=0;for(a=5253;5259>=a;a++)d[a]=0;for(a=5269;5275>=a;a++)d[a]=0;for(a=5292;5311>=a;a++)d[a]=0;for(a=5329;5331>=a;a++)d[a]=0;for(a=5343;5349>=a;a++)d[a]=0;for(a=5355;5357>=a;a++)d[a]=0;for(a=5387;5389>=a;a++)d[a]=0;for(a=5459;5463>=a;a++)d[a]=
0;for(a=5479;5482>=a;a++)d[a]=0;for(a=5518;5520>=a;a++)d[a]=0;for(a=5530;5539>=a;a++)d[a]=0;for(a=5550;5552>=a;a++)d[a]=0;for(a=5562;5583>=a;a++)d[a]=0;for(a=5623;5625>=a;a++)d[a]=2;for(a=5631;5639>=a;a++)d[a]=0;for(a=5649;5653>=a;a++)d[a]=0;for(a=5663;5680>=a;a++)d[a]=0;for(a=5682;5685>=a;a++)d[a]=0;for(a=5875;5877>=a;a++)d[a]=0;for(a=5921;5940>=a;a++)d[a]=0;for(a=6050;6125>=a;a++)d[a]=0;for(a=6244;6275>=a;a++)d[a]=0;for(a=6328;6348>=a;a++)d[a]=0;for(a=6350;6356>=a;a++)d[a]=0;for(a=6366;6372>=a;a++)d[a]=
0;for(a=6381;6387>=a;a++)d[a]=0;for(a=6393;6404>=a;a++)d[a]=0;for(a=6480;6483>=a;a++)d[a]=0;for(a=6511;6514>=a;a++)d[a]=0;for(a=6579;6581>=a;a++)d[a]=0;for(a=6619;6624>=a;a++)d[a]=0;for(a=6625;6627>=a;a++)d[a]=2;for(a=6628;6632>=a;a++)d[a]=0;for(a=6634;6637>=a;a++)d[a]=0;for(a=6669;6692>=a;a++)d[a]=0;for(a=6707;6709>=a;a++)d[a]=0;for(a=6720;6723>=a;a++)d[a]=0;for(a=6732;6738>=a;a++)d[a]=0;for(a=6931;6933>=a;a++)d[a]=0;for(a=6956;6959>=a;a++)d[a]=0;for(a=7005;7007>=a;a++)d[a]=0;for(a=7057;7070>=a;a++)d[a]=
2;for(a=7074;7082>=a;a++)d[a]=0;for(a=7109;7118>=a;a++)d[a]=0;for(a=7119;7127>=a;a++)d[a]=1;for(a=7374;7376>=a;a++)d[a]=0;for(a=7528;7586>=a;a++)d[a]=0;for(a=7587;7645>=a;a++)d[a]=2;for(a=7845;7859>=a;a++)d[a]=0;for(a=20002;20032>=a;a++)d[a]=0;for(a=20062;20092>=a;a++)d[a]=0;for(a=20135;20138>=a;a++)d[a]=0;for(a=20248;20258>=a;a++)d[a]=0;for(a=20348;20358>=a;a++)d[a]=0;for(a=20436;20440>=a;a++)d[a]=0;for(a=20822;20824>=a;a++)d[a]=0;for(a=20934;20936>=a;a++)d[a]=0;for(a=21035;21037>=a;a++)d[a]=0;for(a=
21095;21097>=a;a++)d[a]=0;for(a=21148;21150>=a;a++)d[a]=0;for(a=21413;21423>=a;a++)d[a]=0;for(a=21473;21483>=a;a++)d[a]=0;for(a=21780;21782>=a;a++)d[a]=0;for(a=21891;21894>=a;a++)d[a]=0;for(a=21896;21899>=a;a++)d[a]=0;for(a=22171;22177>=a;a++)d[a]=0;for(a=22181;22187>=a;a++)d[a]=0;for(a=22191;22197>=a;a++)d[a]=0;for(a=22234;22236>=a;a++)d[a]=0;for(a=22521;22525>=a;a++)d[a]=0;for(a=22991;22994>=a;a++)d[a]=0;for(a=23028;23038>=a;a++)d[a]=0;for(a=23830;23853>=a;a++)d[a]=0;for(a=23866;23872>=a;a++)d[a]=
0;for(a=23877;23884>=a;a++)d[a]=0;for(a=23886;23894>=a;a++)d[a]=0;for(a=23946;23948>=a;a++)d[a]=0;for(a=24311;24313>=a;a++)d[a]=0;for(a=24342;24347>=a;a++)d[a]=0;for(a=24370;24374>=a;a++)d[a]=10;for(a=24375;24381>=a;a++)d[a]=0;for(a=24718;24721>=a;a++)d[a]=0;for(a=24817;24821>=a;a++)d[a]=0;for(a=24877;24882>=a;a++)d[a]=0;for(a=24891;24893>=a;a++)d[a]=0;for(a=25391;25395>=a;a++)d[a]=0;for(a=25828;25838>=a;a++)d[a]=0;for(a=26191;26195>=a;a++)d[a]=0;for(a=26391;26393>=a;a++)d[a]=0;for(a=26701;26722>=
a;a++)d[a]=0;for(a=26729;26799>=a;a++)d[a]=2;for(a=26801;26803>=a;a++)d[a]=2;for(a=26811;26813>=a;a++)d[a]=2;for(a=26847;26870>=a;a++)d[a]=2;for(a=26891;26899>=a;a++)d[a]=0;for(a=26901;26923>=a;a++)d[a]=0;for(a=26929;26946>=a;a++)d[a]=0;for(a=26948;26998>=a;a++)d[a]=0;for(a=27037;27040>=a;a++)d[a]=0;for(a=27205;27232>=a;a++)d[a]=0;for(a=27258;27260>=a;a++)d[a]=0;for(a=27391;27398>=a;a++)d[a]=0;for(a=27561;27564>=a;a++)d[a]=0;for(a=27571;27574>=a;a++)d[a]=0;for(a=27581;27584>=a;a++)d[a]=0;for(a=27591;27594>=
a;a++)d[a]=0;for(a=28191;28193>=a;a++)d[a]=0;for(a=28348;28358>=a;a++)d[a]=0;for(a=28402;28432>=a;a++)d[a]=0;for(a=28462;28492>=a;a++)d[a]=0;for(a=29118;29122>=a;a++)d[a]=0;for(a=29168;29172>=a;a++)d[a]=0;for(a=29177;29185>=a;a++)d[a]=0;for(a=29187;29195>=a;a++)d[a]=0;for(a=29900;29903>=a;a++)d[a]=0;for(a=30161;30179>=a;a++)d[a]=0;for(a=30491;30494>=a;a++)d[a]=0;for(a=30729;30732>=a;a++)d[a]=0;for(a=31251;31259>=a;a++)d[a]=0;for(a=31265;31268>=a;a++)d[a]=0;for(a=31275;31279>=a;a++)d[a]=0;for(a=31281;31297>=
a;a++)d[a]=0;for(a=31461;31469>=a;a++)d[a]=0;for(a=31491;31495>=a;a++)d[a]=0;for(a=31917;31922>=a;a++)d[a]=0;for(a=31965;32E3>=a;a++)d[a]=0;for(a=32001;32003>=a;a++)d[a]=2;for(a=32005;32031>=a;a++)d[a]=2;for(a=32033;32060>=a;a++)d[a]=2;for(a=32064;32067>=a;a++)d[a]=2;for(a=32074;32077>=a;a++)d[a]=2;for(a=32081;32086>=a;a++)d[a]=0;for(a=32107;32130>=a;a++)d[a]=0;for(a=32133;32158>=a;a++)d[a]=0;for(a=32164;32167>=a;a++)d[a]=2;for(a=32180;32199>=a;a++)d[a]=0;for(a=32201;32260>=a;a++)d[a]=0;for(a=32301;32360>=
a;a++)d[a]=0;for(a=32601;32662>=a;a++)d[a]=0;for(a=32664;32667>=a;a++)d[a]=2;for(a=32701;32761>=a;a++)d[a]=0;for(a=53001;53004>=a;a++)d[a]=0;for(a=53008;53019>=a;a++)d[a]=0;for(a=53021;53032>=a;a++)d[a]=0;for(a=53042;53046>=a;a++)d[a]=0;for(a=53074;53080>=a;a++)d[a]=0;for(a=54001;54004>=a;a++)d[a]=0;for(a=54008;54019>=a;a++)d[a]=0;for(a=54021;54032>=a;a++)d[a]=0;for(a=54042;54046>=a;a++)d[a]=0;for(a=54048;54053>=a;a++)d[a]=0;for(a=54074;54080>=a;a++)d[a]=0;for(a=102001;102040>=a;a++)d[a]=0;for(a=
102042;102063>=a;a++)d[a]=0;for(a=102065;102067>=a;a++)d[a]=0;for(a=102070;102117>=a;a++)d[a]=0;for(a=102122;102216>=a;a++)d[a]=0;for(a=102221;102377>=a;a++)d[a]=0;for(a=102382;102388>=a;a++)d[a]=0;for(a=102389;102398>=a;a++)d[a]=2;for(a=102399;102444>=a;a++)d[a]=0;for(a=102445;102447>=a;a++)d[a]=2;for(a=102448;102458>=a;a++)d[a]=0;for(a=102459;102468>=a;a++)d[a]=2;for(a=102469;102496>=a;a++)d[a]=0;for(a=102500;102519>=a;a++)d[a]=1;for(a=102520;102524>=a;a++)d[a]=0;for(a=102525;102529>=a;a++)d[a]=
2;for(a=102530;102561>=a;a++)d[a]=0;for(a=102570;102588>=a;a++)d[a]=0;for(a=102590;102598>=a;a++)d[a]=0;for(a=102601;102603>=a;a++)d[a]=0;for(a=102605;102628>=a;a++)d[a]=0;for(a=102629;102646>=a;a++)d[a]=2;for(a=102648;102700>=a;a++)d[a]=2;for(a=102701;102703>=a;a++)d[a]=0;for(a=102707;102730>=a;a++)d[a]=2;for(a=102733;102758>=a;a++)d[a]=2;for(a=102767;102798>=a;a++)d[a]=0;for(a=102965;102969>=a;a++)d[a]=0;for(a=102971;102973>=a;a++)d[a]=0;for(a=102975;102989>=a;a++)d[a]=0;for(a=102990;102992>=a;a++)d[a]=
1;for(a=102997;103002>=a;a++)d[a]=0;for(a=103003;103008>=a;a++)d[a]=2;for(a=103009;103011>=a;a++)d[a]=0;for(a=103012;103014>=a;a++)d[a]=2;for(a=103019;103021>=a;a++)d[a]=0;for(a=103022;103024>=a;a++)d[a]=2;for(a=103029;103031>=a;a++)d[a]=0;for(a=103032;103034>=a;a++)d[a]=2;for(a=103065;103068>=a;a++)d[a]=0;for(a=103074;103076>=a;a++)d[a]=0;for(a=103077;103079>=a;a++)d[a]=1;for(a=103080;103082>=a;a++)d[a]=0;for(a=103083;103085>=a;a++)d[a]=2;for(a=103090;103093>=a;a++)d[a]=0;for(a=103097;103099>=a;a++)d[a]=
0;for(a=103100;103102>=a;a++)d[a]=2;for(a=103107;103109>=a;a++)d[a]=0;for(a=103110;103112>=a;a++)d[a]=2;for(a=103113;103116>=a;a++)d[a]=0;for(a=103117;103120>=a;a++)d[a]=2;for(a=103153;103157>=a;a++)d[a]=0;for(a=103158;103162>=a;a++)d[a]=2;for(a=103163;103165>=a;a++)d[a]=0;for(a=103166;103168>=a;a++)d[a]=1;for(a=103169;103171>=a;a++)d[a]=2;for(a=103186;103188>=a;a++)d[a]=0;for(a=103189;103191>=a;a++)d[a]=2;for(a=103192;103195>=a;a++)d[a]=0;for(a=103196;103199>=a;a++)d[a]=2;for(a=103200;103224>=a;a++)d[a]=
0;for(a=103225;103227>=a;a++)d[a]=1;for(a=103232;103237>=a;a++)d[a]=0;for(a=103238;103243>=a;a++)d[a]=2;for(a=103244;103246>=a;a++)d[a]=0;for(a=103247;103249>=a;a++)d[a]=2;for(a=103254;103256>=a;a++)d[a]=0;for(a=103257;103259>=a;a++)d[a]=2;for(a=103264;103266>=a;a++)d[a]=0;for(a=103267;103269>=a;a++)d[a]=2;for(a=103300;103375>=a;a++)d[a]=0;for(a=103381;103383>=a;a++)d[a]=0;for(a=103384;103386>=a;a++)d[a]=1;for(a=103387;103389>=a;a++)d[a]=0;for(a=103390;103392>=a;a++)d[a]=2;for(a=103397;103399>=a;a++)d[a]=
0;for(a=103400;103471>=a;a++)d[a]=2;for(a=103476;103478>=a;a++)d[a]=0;for(a=103479;103481>=a;a++)d[a]=2;for(a=103486;103488>=a;a++)d[a]=0;for(a=103489;103491>=a;a++)d[a]=2;for(a=103492;103495>=a;a++)d[a]=0;for(a=103496;103499>=a;a++)d[a]=2;for(a=103528;103543>=a;a++)d[a]=0;for(a=103544;103548>=a;a++)d[a]=2;for(a=103549;103551>=a;a++)d[a]=0;for(a=103552;103554>=a;a++)d[a]=1;for(a=103555;103557>=a;a++)d[a]=2;for(a=103558;103560>=a;a++)d[a]=0;for(a=103571;103573>=a;a++)d[a]=0;for(a=103574;103576>=a;a++)d[a]=
2;for(a=103577;103580>=a;a++)d[a]=0;for(a=103581;103583>=a;a++)d[a]=2;for(a=103600;103694>=a;a++)d[a]=0;for(a=103700;103793>=a;a++)d[a]=2;for(a=103794;103871>=a;a++)d[a]=0;for(a=103900;103971>=a;a++)d[a]=2;return h("extend-esri")&&(l.WKIDUnitConversion=d),d})},"esri/geometry/screenUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/sniff ../kernel ./Point ./ScreenPoint ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(h,l,a,d,b,f,k,m,g,e){var c=function(){return 9>a("ie")?
function(a,c,b,e,d,g,f,n,k){var m,h,l,D,E,F,H,G=[],K=Math.round,J=f.length;for(m=0;J>m;m++)if(h=f[m],E=n?n(h[0][0],h[0][1],k):h[0],1<(D=h.length))for(F=K((E[0]-a)*b+d),H=K((c-E[1])*e+g),E=n?n(h[1][0],h[1][1],k):h[1],l=K((E[0]-a)*b+d),E=K((c-E[1])*e+g),G.push("M",F+","+H,"L",l+","+E),l=2;D>l;l++)E=n?n(h[l][0],h[l][1],k):h[l],F=K((E[0]-a)*b+d),H=K((c-E[1])*e+g),G.push(F+","+H);else F=K((E[0]-a)*b+d),H=K((c-E[1])*e+g),G.push("M",F+","+H);return G}:function(a,c,b,e,d,g,f,n,k,m){var h,l,D,E,F,H,G=[],K=
Math.round;h=0;for(D=f?f.length:0;D>h;h++){F=f[h];G.push("M");l=0;for(E=F?F.length:0;E>l;l++)H=n?n(F[l][0],F[l][1],k):F[l],G.push(K((H[0]-a)*b+d)+","+K((c-H[1])*e+g));m||G.push("Z")}return G}}(),n={toScreenPoint:function(a,c,e,d,g){var n,k=a.spatialReference,m=d.spatialReference,h=d.x;d=d.y;return k&&m&&!k.equals(m)&&k._canProject(m)&&(n=k.isWebMercator()?b.lngLatToXY(h,d):b.xyToLngLat(h,d,!0),h=n[0],d=n[1]),h=(h-a.xmin)*(c/a.getWidth()),d=(a.ymax-d)*(e/a.getHeight()),g||(h=Math.round(h),d=Math.round(d)),
new f(h,d)},toScreenGeometry:function(a,c,d,f){var n=a.xmin,l=a.ymax,x=c/a.getWidth(),y=d/a.getHeight(),z=h.forEach,A=Math.round;if(f instanceof b)return new b(A((f.x-n)*x),A((l-f.y)*y));if(f instanceof g){a=new g;var B=a.points;return z(f.points,function(a,c){B[c]=[A((a[0]-n)*x),A((l-a[1])*y)]}),a}if(f instanceof e)return new e(A((f.xmin-n)*x),A((l-f.ymin)*y),A((f.xmax-n)*x),A((l-f.ymax)*x));if(f instanceof k){var C;a=new k;var D=a.paths;return z(f.paths,function(a,c){C=D[c]=[];z(a,function(a,c){C[c]=
[A((a[0]-n)*x),A((l-a[1])*y)]})}),a}if(f instanceof m){var E;a=new m;var F=a.rings;return z(f.rings,function(a,c){E=F[c]=[];z(a,function(a,c){E[c]=[A((a[0]-n)*x),A((l-a[1])*y)]})}),a}},_toScreenPath:function(a,e,d,g,f,n){var m,h,l=g instanceof k,A=a.spatialReference,B=g.spatialReference;return A&&B&&!A.equals(B)&&A._canProject(B)&&(A.isWebMercator()?m=b.lngLatToXY:(m=b.xyToLngLat,h=!0)),c(a.xmin,a.ymax,e/a.getWidth(),d/a.getHeight(),f,n,l?g.paths:g.rings,m,h,l)},toMapPoint:function(a,c,e,d){return new b(a.xmin+
d.x/(c/a.getWidth()),a.ymax-d.y/(e/a.getHeight()),a.spatialReference)},toMapGeometry:function(a,c,d,f){var n=a.xmin,l=a.ymax,x=a.spatialReference,y=c/a.getWidth(),z=d/a.getHeight(),A=h.forEach;if(f instanceof b)return new b(n+f.x/y,l-f.y/z,x);if(f instanceof g){a=new g(x);var B=a.points;return A(f.points,function(a,c){B[c]=[n+a[0]/y,l-a[1]/z]}),a}if(f instanceof e)return new e(n+f.xmin/y,l-f.ymin/z,n+f.xmax/y,l-f.ymax/z,x);if(f instanceof k){var C;a=new k(x);var D=a.paths;return A(f.paths,function(a,
c){C=D[c]=[];A(a,function(a,c){C[c]=[n+a[0]/y,l-a[1]/z]})}),a}if(f instanceof m){var E;a=new m(x);var F=a.rings;return A(f.rings,function(a,c){E=F[c]=[];A(a,function(a,c){E[c]=[n+a[0]/y,l-a[1]/z]})}),a}}};return a("extend-esri")&&l.mixin(l.getObject("geometry",!0,d),n),n})},"esri/layers/GraphicsLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom dojox/gfx dojox/gfx/matrix ./gfxSniff!esri-svg?dojox/gfx/filters ./layer ../kernel ../lang ../sniff ../Color ../domUtils ../symbols/MarkerSymbol ../symbols/SimpleMarkerSymbol ../geometry/Point ../geometry/ScreenPoint ../geometry/Extent ../geometry/mathUtils ../geometry/screenUtils ../PluginTarget ./gfxSniff!esri-svg?dojox/gfx/svgext".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D){var E,F=-1!==g.renderer.toLowerCase().indexOf("svg"),H=-1!==g.renderer.toLowerCase().indexOf("canvas"),G=9>u("ie"),K=u("esri-touch");w=h(null,{declaredClass:"esri.layers._GraphicsContainer",_setMap:function(a,c){var b,e=this._connects=[];(this._map=a,this._useWillChange="css-transforms"===a.navigationMode&&F&&u("esri-will-change"),H)?(b=f.create("div",{style:"overflow: visible; position: absolute;"},c),this._surface={getEventSource:function(){return b}},
e.push(l.connect(b,"onmousedown",this,this._canvasDownHandler)),e.push(l.connect(b,"onmouseup",this,this._canvasUpHandler)),e.push(l.connect(b,"onclick",this,this._canvasClickHandler)),E.prototype._canvas=!0):(b=(this._surface=g.createSurface(c,a.width,a.height)).getEventSource(),this._useWillChange&&k.set(b,"will-change","transform"),k.set(b=G?b.parentNode:b,{overflow:"visible",position:"absolute"}));return e.push(l.connect(a,"onResize",this,"_onResizeHandler")),this._useWillChange&&(e.push(l.connect(a,
"onPan",this,"_onPanHandler")),e.push(l.connect(a,"onPanEnd",this,"_onPanEndHandler")),e.push(l.connect(a,"onExtentChange",this,"_onExtentChangeHandler"))),b},_onPanHandler:function(a,c){var b=this._map.__visibleRect,e=b.x+c.x,b=b.y+c.y;this._panDx=e;this._panDy=b;k.set(this._surface.getEventSource(),q._css.names.transform,q._css.translate(e,b))},_onPanEndHandler:function(a,c){var b=this._map.__visibleRect,e=b.x,b=b.y;this._panDx=e;this._panDy=b;k.set(this._surface.getEventSource(),q._css.names.transform,
q._css.translate(e,b))},_onExtentChangeHandler:function(a,c,b,e){b&&(this._panDy=this._panDx=0,k.set(this._surface.getEventSource(),q._css.names.transform,q._css.translate(0,0)))},_getTransform:function(){return{dx:this._panDx||0,dy:this._panDy||0}},_onResizeHandler:function(a,c,e){var g;a=this._surface.getEventSource();var f=this._map;G&&k.set(a=a.parentNode,{width:c+"px",height:e+"px",clip:"rect(0px "+c+"px "+e+"px 0px)"});b.set(a,"width",c);b.set(a,"height",e);this._surface.declaredClass||d.forEach(a.childNodes,
function(a){b.set(a,"width",c);b.set(a,"height",e)});f.loaded&&(f.graphics.suspended||(f.graphics._resized=!0),d.forEach(f.graphicsLayerIds,function(a){g=f.getLayer(a);g.suspended||(g._resized=!0,g._childLayer&&(g._childLayer._resized=!0));g._updateSVGFilters(null,null,c,e)}))},_cleanUp:function(){d.forEach(this._connects,l.disconnect,l);this._map=this._surface=null},_processEvent:function(a){var c=this._map;a.screenPoint=new z(a.pageX-c.position.x,a.pageY-c.position.y);a.mapPoint=c.toMap(a.screenPoint)},
_canvasDownHandler:function(a){this._processEvent(a);this._downPt=a.screenPoint.x+","+a.screenPoint.y},_canvasUpHandler:function(a){this._processEvent(a);this._upPt=a.screenPoint.x+","+a.screenPoint.y},_tolerance:15,_isPrimaryMatch:function(a,c,b,e){if(!a.visible||!c)return!1;var g,f=c.getTransformedBoundingBox();return f?(g=new A(f[0].x,f[0].y,f[2].x,f[2].y),delete g.spatialReference,K?g.intersects(b):g.contains(e)):d.some(c.children||[],function(a){return f=a.getTransformedBoundingBox(),g=new A(f[0].x,
f[0].y,f[2].x,f[2].y),delete g.spatialReference,K?g.intersects(b):g.contains(e)})},_canvasClickHandler:function(a){if(this._downPt&&this._upPt&&this._downPt===this._upPt){this._processEvent(a);var c=this._map,b=d.map(c.graphicsLayerIds,function(a){return c.getLayer(a)});b.push(c.graphics);b.reverse();var b=d.filter(b,function(a){return a.loaded&&a._mouseEvents&&!a.suspended&&(!r.isDefined(a.opacity)||0<a.opacity)}),e,g=a.screenPoint,f=this._tolerance,n=g.x-f,k=g.y+f,m=g.x+f,f=g.y-f,t=new A(n,f,m,
k),n=c.toMap(new z(n,k)),m=c.toMap(new z(m,f)),k=n.spatialReference._getInfo(),q=new A(A.prototype._normalizeX(n.x,k).x,n.y,A.prototype._normalizeX(m.x,k).x,m.y,n.spatialReference);(delete t.spatialReference,d.some(b,function(a){a=d.filter(a.graphics,function(a){return this._isPrimaryMatch(a,a.getDojoShape(),t,g)||!(!a._bgShape||!this._isPrimaryMatch(a,a._bgShape,t,g))},this);if(a.reverse(),0<a.length){var c;if(d.some(a,function(a){return a.geometry&&q.intersects(a.geometry)?(c=a,!0):!1}),c)return e=
c,!0}return!1},this),e)&&(b=e.getLayer())&&(a.graphic=e,b.onClick(a))}}});E=h(n,{declaredClass:"esri.layers._GraphicsLayer",managedSuspension:!0,surfaceType:H?"canvas-2d":g.renderer,_eventMap:{"graphic-add":["graphic"],"graphic-remove":["graphic"],"renderer-change":["renderer"]},constructor:function(c,b){c&&(a.isString(c)||a.isObject(c)&&(c.layerDefinition||c.query))&&(c=b);this._params=a.mixin({displayOnPan:!0,drawMode:!0,styling:!0},c||{});var e=this._params.dataAttributes;"string"==typeof e&&(e=
[e]);this.styling=F?this._params.styling:!0;this.dataAttributes=e;this.infoTemplate=c&&c.infoTemplate;this.graphics=[];this._draw=a.hitch(this,this._draw);this._refresh=a.hitch(this,this._refresh);this.registerConnectEvents()},getNode:function(){return this._div&&this._div.getEventSource()},setDrawMode:function(a){this._params.drawMode=a},renderer:null,_setMap:function(c,b){return this.inherited(arguments),this._map=c,this._wrap=c.wrapAround180,this._srInfo=c.spatialReference._getInfo(),this._svgFilters=
{},this._canvas?(b=g.createSurface(b.getEventSource(),c.width,c.height),k.set(b.rawNode,"position","absolute"),this._div=b.createGroup(),this._renderProto=this._div.constructor.prototype._render,this._div._render=a.hitch(this,this._canvasRender)):this._div=b.createGroup(),this._bgGroup=this._div.createGroup(),this._div.getEventSource().id=this.id+"_layer",this._initOpacity(),this._div},_unsetMap:function(a,c){d.forEach(this.graphics,function(a){a._shape=null});this._canvas?(c=this._div.getParent(),
c._parent={},f.destroy(c.rawNode),c.destroy()):(this._div.clear(),c.remove(this._div),f.destroy(this._div.getEventSource()));this._map=this._div=this._svgFilters=null;clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();this.inherited(arguments)},_initOpacity:function(){var a=this.opacity;r.isDefined(a)&&1>a&&this.setOpacity(a,!0)},_onZoomStartHandler:function(){t.hide(this._div.getEventSource())},_onExtentChangeHandler:function(a,c,b,e){(clearTimeout(this._wakeTimer),
this._wakeTimer=null,b)?(a=this._map.__visibleRect,c=this._div,this._evalSDRenderer(),this._refresh(!0),this._updateTransform(c,a.x,a.y,!0),this._renderProto&&c.surface.pendingRender?this._dirty=!0:this.suspended||t.show(c.getEventSource())):this._resized&&(this._resized=!1,this._refresh(!1));0<this.graphics.length&&this.onUpdate()},_canvasRender:function(){var a=this._div;return this._dirty&&(delete this._dirty,this.suspended||t.show(a.getEventSource())),this._renderProto.apply(a,arguments)},_refresh:function(a){var c,
b=this.graphics,e=b.length,d=this._draw;for(c=0;e>c;c++)d(b[c],a)},refresh:function(){this._refresh(!0)},redraw:function(){this._refresh(!0)},_getTransform:function(){var a={dx:0,dy:0};return this._map&&(this._map._gc._useWillChange?a=this._map._gc._getTransform():this._div&&(a=this._div.getTransform())),a},_onPanHandler:function(a,c){this._panDx=c.x;this._panDy=c.y;var b=this._map.__visibleRect;this._updateTransform(this._div,b.x+c.x,b.y+c.y)},_onPanEndUpdateHandler:function(a,c){var b=this._map.__visibleRect;
this._params._child||c.x===this._panDx&&c.y===this._panDy?this._updateSVGFilters(-b.x,-b.y):this._updateTransform(this._div,b.x,b.y,!0);this._refresh(!1);this.graphics.length&&this.onUpdate()},_onPanStartHandler:function(){t.hide(this._div.getEventSource())},_onPanEndHandler:function(){var a=this._map.__visibleRect,c=this._div;this._updateTransform(c,a.x,a.y,!0);this._refresh(!1);this._renderProto&&c.surface.pendingRender?this._dirty=!0:t.show(c.getEventSource());this.graphics.length&&this.onUpdate()},
_updateTransform:function(a,c,b,d){this._map._gc._useWillChange||a.setTransform(e.translate({x:c,y:b}));d&&this._updateSVGFilters(-c,-b)},onSuspend:function(){this.inherited(arguments);t.hide(this._div.getEventSource());clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(c){this.inherited(arguments);c.firstOccurrence&&this._evalSDRenderer();this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(a.hitch(this,function(){this.suspended||
this._map.__zooming||this._onExtentChangeHandler(null,null,!0)}),0)},_enableDrawConnectors:function(){var a=this._map,c=l.connect;this._disableDrawConnectors();this._params.displayOnPan?(this._params._child||(this._onPanHandler_connect=c(a,"onPan",this,"_onPanHandler")),this._onPanEndHandler_connect=c(a,"onPanEnd",this,"_onPanEndUpdateHandler")):(this._onPanStartHandler_connect=c(a,"onPanStart",this,"_onPanStartHandler"),this._onPanEndHandler_connect=c(a,"onPanEnd",this,"_onPanEndHandler"));this._onZoomStartHandler_connect=
c(a,"onZoomStart",this,"_onZoomStartHandler");this._onExtentChangeHandler_connect=c(a,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=l.disconnect;a(this._onExtentChangeHandler_connect);a(this._onZoomStartHandler_connect);a(this._onPanHandler_connect);a(this._onPanStartHandler_connect);a(this._onPanEndHandler_connect);this._onExtentChangeHandler_connect=this._onZoomStartHandler_connect=this._onPanHandler_connect=this._onPanStartHandler_connect=this._onPanEndHandler_connect=
null},_updateExtent:function(a){var c=a.geometry;if(!c)return void(a._extent=null);if(!(a._extent=c.getExtent())){var b,e;if("esri.geometry.Point"===c.declaredClass)b=c.x,e=c.y;else{if("esri.geometry.Multipoint"!==c.declaredClass)return void(a._extent=null);b=c.points[0][0];e=c.points[0][1]}a._extent=new A(b,e,b,e,c.spatialReference)}},_intersects:function(a,c,b){var e=a.spatialReference,g=c.spatialReference,f=e&&g&&!e.equals(g)&&e._canProject(g)&&4326===g.wkid;if(this._wrap&&!b){var n,k,m,t,r,q;
b=[];e=a._getFrameWidth();n=this._srInfo;m=a._clip?a._getAvailExtent():a.extent;var u=[];k=c._partwise;if(f&&(m=a.geographicExtent,n=g._getInfo()),a=m._getParts(n),k&&k.length)for(c=[],g=0,f=k.length;f>g;g++)c=c.concat(k[g]._getParts(n));else c=c._getParts(n);g=0;for(f=c.length;f>g;g++)for(r=c[g],n=0,m=a.length;m>n;n++)if(q=a[n],q.extent.intersects(r.extent))for(k=0,t=r.frameIds.length;t>k;k++)b.push((q.frameIds[0]-r.frameIds[k])*e);g=0;for(f=b.length;f>g;g++)k=b[g],d.indexOf(b,k)===g&&u.push(k);
return u.length?u:null}return(f?a.geographicExtent:a.extent).intersects(c)?[0]:null},_defaultMarker:{type:"simplemarkersymbol",style:"square",size:1,xoffset:0,yoffset:0,angle:0},_draw:function(a,c){if(this._params.drawMode&&this._map&&!this.suspended&&!this._map.__zooming&&!this._resized)try{var b,e,d,g=a._extent,f=!F||this.styling,n=F&&this.dataAttributes,k=a.getDojoShape();if(a.visible&&g&&(b=this._intersects(this._map,g,a.geometry._originOnly))&&(e=f?this._getSymbol(a):this._defaultMarker)){if(a._offsets&&
a._offsets.join(",")===b.join(",")?d=!0:a._offsets=b,!k||c||!d){var m=a.geometry.type;d={graphic:a};var t=a._bgShape,r=f&&!a.symbol?this._getRenderer(a):null,q=r&&r.backgroundFillSymbol;if("point"===m)this._isInvalidShape(e,k)&&this._removeShape(a),a._shape=this._drawPoint(this._div,a.geometry,e,a.getDojoShape(),b,r,a),f&&this._symbolizePoint(a.getDojoShape(),e,r,a);else if("multipoint"===m)this._drawMarkers(a,e,b,r),f&&this._symbolizeMarkers(a,e,r);else{var u,h,v,m=e;if(f&&(u="simplemarkersymbol"===
e.type||"picturemarkersymbol"===e.type||"textsymbol"===e.type?e:null,m=u?q:e),m&&m===q&&(h=this._bgGroup),t&&!h&&this._removeBgShape(a),m&&(!h&&this._isInvalidShape(m,a._shape)&&this._removeShape(a,!1),v=this._drawShape(a,b,h||this._div,h?t:a.getDojoShape()),f&&this._symbolizeShape(v,m,r,!!q,a),a[h?"_bgShape":"_shape"]=v),u){this._isInvalidShape(u,a._shape)&&this._removeShape(a,!1);var l=a.geometry.getCentroid();(v=l&&this._drawPoint(this._div,l,u,a._shape,b,r,a))&&this._symbolizePoint(v,u,r,a);a._shape=
v}}H||(a._bgShape&&this._initNode(a,a._bgShape,a._bgShape!==t,d,n),a._shape&&this._initNode(a,a._shape,a._shape!==k,d,n));d.node=a.getNode();this.onGraphicDraw(d)}}else k&&this._removeShape(a)}catch(w){this._errorHandler(w,a)}},_initNode:function(a,c,b,e,d){(c=c&&c.getNode())&&(c.e_graphic=a,this._addDataAttrs(a,d,c),b&&(e.node=c,this.onGraphicNodeAdd(e)))},_removeShape:function(a,c,b){var e=a.getDojoShape(),d=e&&e.getNode();e&&!b&&(e.removeShape(),e.destroy());a._shape=a._offsets=null;!1!==c&&this._removeBgShape(a,
b);d&&(d.e_graphic=null,H||this.onGraphicNodeRemove({graphic:a,node:d}))},_removeBgShape:function(a,c){var b=a._bgShape,e=b&&b.getNode();b&&!c&&(b.removeShape(),b.destroy());a._bgShape=null;e&&(e.e_graphic=null,H||this.onGraphicNodeRemove({graphic:a,node:e}))},_addDataAttrs:function(a,c,b){var e,d,g=a.attributes,f=c?c.length:0,n=this._getRenderer(a);if(b&&g){for(e=0;f>e;e++)(b=c[e])&&a.attr("data-"+b,g[b]);!this.styling&&n&&(n.getBreakIndex?(d=n.getBreakIndex(a),a.attr("data-class-break",-1!==d?d:
null)):n.getUniqueValueInfo&&(d=n.getUniqueValueInfo(a),a.attr("data-unique-value",d?d.value:null)))}},_drawShape:function(a,c,b,e){var d,g,f,n;a=a.geometry;n=a.type;var k=this._map,m=k.extent,t=k.width,r=k.height,k=k.__visibleRect;f=[];d="extent"===n;if("rect"===n||d)f={x:0,y:0,spatialReference:a.spatialReference},f.x=d?a.xmin:a.x,f.y=d?a.ymax:a.y,n=C.toScreenPoint(m,t,r,f),f.x=d?a.xmax:a.x+a.width,f.y=d?a.ymin:a.y+a.height,a=C.toScreenPoint(m,t,r,f),c={x:n.x-k.x+c[0],y:n.y-k.y,width:Math.abs(a.x-
n.x),height:Math.abs(a.y-n.y)},0===c.width&&(c.width=1),0===c.height&&(c.height=1),e=this._drawRect(b,e,c);else if("polyline"===n||"polygon"===n){d=0;for(g=c.length;g>d;d++)f=f.concat(C._toScreenPath(m,t,r,a,-k.x+c[d],-k.y));e=this._drawPath(b,e,f);this._rendererLimits&&("polyline"===n?this._clipPolyline(e,a):this._clipPolygon(e,a))}return e},_drawRect:function(a,c,b){return c?c.setShape(b):a.createRect(b)},_drawImage:function(a,c,b){return c?c.setShape(b):a.createImage(b)},_drawCircle:function(a,
c,b){return c?c.setShape(b):a.createCircle(b)},_drawPath:function(){return G?function(a,c,b,e){if(b=e?b:b.join(" "),c)return c.setShape(b);c=a.createObject(e?g.Path:g.EsriPath,b);return a._overrideSize(c.getEventSource()),c}:function(a,c,b,e){return b=e?b:b.join(" "),c?c.setShape(b):a.createPath(b)}}(),_drawText:function(a,c,b){return c?c.setShape(b):a.createText(b)},_evalSDRenderer:function(a){var c,b=this._map,e=this.renderer,d=this._rndForScale;b&&b.loaded&&e&&e.getRendererInfo&&(c="zoom"===e.rangeType?
e.getRendererInfoByZoom(b.getZoom()):e.getRendererInfoByScale(b.getScale()));this._rndForScale=c&&c.renderer;(c=this._getRenderer())&&c.prepareForViewChange();a||this._rndForScale==d||this.emit("renderer-change",{renderer:this._rndForScale})},_getRenderer:function(a){var c=this._rndForScale||this.renderer;return a&&c&&c.getObservationRenderer&&(c=c.getObservationRenderer(a)),c},_getSymbol:function(a){var c=this._getRenderer();return a.symbol||c&&c.getSymbol(a)},_getVariable:function(a,c,b){var e,
d;return a&&(e=a.getVisualVariablesForType(c,b),d=e&&e[0]),d},_applyOpacity:function(a,c,b,e){c=c.getOpacity(e,{opacityInfo:b});return null!=c&&(a=new v(a),a.a=c),a},_symbolizeShape:function(c,b,e,d,g){var f,n,k=b.getStroke(),m=b.getFill(),t=b.type,r=this._getVariable(e,"sizeInfo",!1),q=this._getVariable(e,"colorInfo",!1),u=this._getVariable(e,"opacityInfo",!1),h=-1!==t.indexOf("linesymbol");b=h?"none"!==b.style:b.outline&&"none"!==b.outline.style;var v=h?null:this._getVariable(e,"sizeInfo","outline"),
r=(r=d?v:v||r)?e.getSize(g,{sizeInfo:r,resolution:this._map.getResolutionInMeters(),scale:this._map.getScale()}):null;d&&(q=u=null);(q||u)&&"picturefillsymbol"!==t&&(h?(f=k&&k.color,q&&(f=e.getColor(g,{colorInfo:q})||f),f&&u&&(f=this._applyOpacity(f,e,u,g))):m&&m.toCss&&(n=m,q&&(n=e.getColor(g,{colorInfo:q})||n),n&&u&&(n=this._applyOpacity(n,e,u,g))));c.setStroke(!b||null==r&&!f?k:a.mixin({},k,null!=r?{width:r}:null,f&&{color:f})).setFill(n||m)},_smsToPath:function(){return G?function(a,c,b,e,d,g,
f,n,k){switch(c){case a.STYLE_SQUARE:return["M",d+","+f,"L",g+","+f,g+","+n,d+","+n,"X","E"];case a.STYLE_CROSS:return["M",b+","+f,"L",b+","+n,"M",d+","+e,"L",g+","+e,"E"];case a.STYLE_X:return["M",d+","+f,"L",g+","+n,"M",d+","+n,"L",g+","+f,"E"];case a.STYLE_DIAMOND:return["M",b+","+f,"L",g+","+e,b+","+n,d+","+e,"X","E"];case a.STYLE_TARGET:return["M",d+","+f,"L",g+","+f,g+","+n,d+","+n,d+","+f,"M",d-k+","+e,"L",d+","+e,"M",b+","+(f-k),"L",b+","+f,"M",g+k+","+e,"L",g+","+e,"M",b+","+(n+k),"L",b+
","+n,"E"]}}:function(a,c,b,e,d,g,f,n,k){switch(c){case a.STYLE_SQUARE:return["M",d+","+f,g+","+f,g+","+n,d+","+n,"Z"];case a.STYLE_CROSS:return["M",b+","+f,b+","+n,"M",d+","+e,g+","+e];case a.STYLE_X:return["M",d+","+f,g+","+n,"M",d+","+n,g+","+f];case a.STYLE_DIAMOND:return["M",b+","+f,g+","+e,b+","+n,d+","+e,"Z"];case a.STYLE_TARGET:return["M",d+","+f,g+","+f,g+","+n,d+","+n,d+","+f,"M",d-k+","+e,d+","+e,"M",b+","+(f-k),b+","+f,"M",g+k+","+e,g+","+e,"M",b+","+(n+k),b+","+n]}}}(),_pathStyles:{square:1,
cross:1,x:1,diamond:1,target:1},_typeMaps:{picturemarkersymbol:"image",picturefillsymbol:"path",simplefillsymbol:"path",simplelinesymbol:"path",cartographiclinesymbol:"path",textsymbol:"text"},_isInvalidShape:function(a,c){var b=c&&c.shape&&c.shape.type,e=a&&a.type,d=a&&a.style;return"rect"===b&&(b="path"),e&&(d=this._typeMaps[e]||d),this._pathStyles[d]&&(d="path"),"shieldlabelsymbol"===e?!0:!(!b||!d||b===d)},_drawPoint:function(a,c,b,d,g,f,n){var k,m,t,r,q=b.type,u=this._map,h=u.__visibleRect,v=
C.toScreenPoint(u.extent,u.width,u.height,c).offset(-h.x+g[0],-h.y),h=v.x,l=v.y;c=[];var w=this._getVariable(f,"rotationInfo",!1),w=w?f.getRotationAngle(n,{rotationInfo:w}):null,y=this._getVariable(f,"sizeInfo",!1),u=y?f.getSize(n,{sizeInfo:y,shape:b.style,resolution:u.getResolutionInMeters(),scale:u.getScale()}):null;if(w&&c.push(e.rotategAt(w,v)),(0!==b.xoffset||0!==b.yoffset)&&(r=e.translate(b.xoffset,-b.yoffset),c.push(r)),0!==b.angle&&c.push(e.rotategAt(b.angle,v)),"simplemarkersymbol"===q)switch(k=
b.style,f=Math.round,u=null!=u?u:b.size,k){case x.STYLE_SQUARE:case x.STYLE_CROSS:case x.STYLE_X:case x.STYLE_DIAMOND:b=isNaN(u)?16:u/2;k=this._drawPath(a,d,this._smsToPath(x,k,h,l,f(h-b),f(h+b),f(l-b),f(l+b)));break;case x.STYLE_TARGET:n=b._targetWidth/2;v=b._targetHeight/2;k=this._drawPath(a,d,this._smsToPath(x,k,h,l,f(h-n),f(h+n),f(l-v),f(l+v),b._spikeSize));break;case x.STYLE_PATH:k=this._drawPath(a,d,b.path,!0);b=k.getBoundingBox();a=this._getScaleMatrix(b,u);1===a.xx&&1===a.yy||c.push(e.scaleAt(a.xx,
a.yy,v));c.push(e.translate(-(b.x+b.width/2)+h,-(b.y+b.height/2)+l));break;default:b=isNaN(u)?16:u/2,k=this._drawCircle(a,d,{cx:h,cy:l,r:b})}else if("shieldlabelsymbol"===q){if(m=b.width,t=b.height,k=a.createGroup(),d=a.createImage({x:h-m/2,y:l-t/2,width:m,height:t,src:b.url}),k.add(d),null!=b.font)l+=.2*b.getHeight(),a=a.createText({type:"text",text:b.text,x:h,y:l,align:"middle",decoration:b.decoration,rotated:b.rotated,kerning:b.kerning}),a.setFont(b.font),a.setFill(b.color),k.add(a)}else if("picturemarkersymbol"===
q){if(null==u?(m=b.width,t=b.height):(t=u,m=b.width/b.height*t,r&&(null!=r.dx&&(r.dx=r.dx/b.width*m),null!=r.dy&&(r.dy=r.dy/b.height*t))),k=this._drawImage(a,d,{x:h-m/2,y:l-t/2,width:m,height:t,src:b.url}),F)if(a=k.getNode())b=(b=this._getVariable(f,"opacityInfo",!1))?f.getOpacity(n,{opacityInfo:b}):null,null!=b?a.setAttribute("opacity",b):a.setAttribute("opacity",1)}else"textsymbol"===q&&(f=b.font,null!=u&&f&&(f=new f.constructor(f.toJson()),f.setSize(u)),k=this._drawText(a,d,{type:"text",text:b.text,
x:h,y:l,align:b.getSVGAlign(),decoration:b.decoration||f&&f.decoration,rotated:b.rotated,kerning:b.kerning}),f&&k.setFont(f),F)&&(a=k.getNode(),h=b.getSVGBaseline(),l=b.getSVGBaselineShift(),a&&(a.setAttribute("dominant-baseline",h),l&&a.setAttribute("baseline-shift",l),this._applyHalo(k,b.haloColor,b.haloSize)));return k.setTransform(e.multiply(c)),k._wrapOffsets=g,k},_applyHalo:function(a,c,b){var e=c&&b?this._getHaloId(c,b):null;a.setFilter(c&&b?u("webkit")||u("ff")?this._getDilateFilter(c,b,e):
this._getOffsetFilter(c,b,e):null)},_getDilateFilter:function(a,b,e){var d=this._getSVGFilter(e);return d||(d=this._createSVGFilter({id:e},[c.feMorphology({operator:"dilate",radius:b,result:"dilated"}),c.feFlood({"flood-color":a.toCss(!0)}),c.feComposite({in2:"dilated",operator:"in",result:"composite"}),c.feMerge("composite","SourceGraphic")])),d},_getOffsetFilter:function(a,b,e){var d=this._getSVGFilter(e);if(!d){var d=a.toCss(!0),g=this._offsetPrimitives,f=g.length,n=[],k=[];for(a=0;f>a;a++){var m=
g[a],t="offset"+m.dir,r="composite"+m.dir;k.push(r);n.push(c.feOffset({dx:m.dx*b,dy:m.dy*b,"in":"SourceAlpha",result:t}),c.feFlood({"flood-color":d}),c.feComposite({in2:t,operator:"in",result:r}))}k.push("SourceGraphic");n.push(c.feMerge.apply(c.feMerge,k));d=this._createSVGFilter({id:e},n)}return d},_offsetPrimitives:[{dir:"L",dx:-1,dy:0},{dir:"TL",dx:-1,dy:-1},{dir:"T",dx:0,dy:-1},{dir:"TR",dx:1,dy:-1},{dir:"R",dx:1,dy:0},{dir:"BR",dx:1,dy:1},{dir:"B",dx:0,dy:1},{dir:"BL",dx:-1,dy:1}],_getHaloId:function(a,
c){return"halo_"+this._map.id+"_"+this.id+"_"+a.r+"_"+a.g+"_"+a.b+"_"+a.a+"_"+c},_getSVGFilter:function(a){return this._svgFilters[a]},_createSVGFilter:function(a,b){var e=c.createFilter(a,b),d=this._map,g=d.__visibleRect;return e.x=-g.x,e.y=-g.y,e.width=d.width,e.height=d.height,this._svgFilters[a.id]=e,e},_updateSVGFilters:function(a,c,b,e){var d,g,f,n=this._svgFilters;for(g in n)(d=n[g])&&(f=m.byId(g),f&&(null!=a&&f.setAttribute("x",a),null!=c&&f.setAttribute("y",c),null!=b&&f.setAttribute("width",
b),null!=e&&f.setAttribute("height",e)),null!=a&&(d.x=a),null!=c&&(d.y=c),null!=b&&(d.width=b),null!=e&&(d.height=e))},_getScaleMatrix:function(a,c){var b=a.width/a.height,e=1,d=1;return isNaN(c)||(1<b?(e=c/a.width,d=c/b/a.height):(d=c/a.height,e=c*b/a.width)),{xx:e,yy:d}},_symbolizePoint:function(c,b,e,d){var g=b.type,f=b.style;if("shieldlabelsymbol"!==g&&"picturemarkersymbol"!==g){var n=b.getStroke();b=b.getFill();var f=f===x.STYLE_X||f===x.STYLE_CROSS,k=n&&n.color,m=f?k:b;if(e){var t=this._getVariable(e,
"colorInfo",!1),r=this._getVariable(e,"opacityInfo",!1);t&&(m=e.getColor(d,{colorInfo:t})||m);m&&r&&(m=this._applyOpacity(m,e,r,d));m&&(f?m!==k&&(n=n?a.mixin({},n):{},n.color=m):m!==b&&(b=m))}"textsymbol"===g?c.setFill(b):"simplemarkersymbol"===g&&c.setFill(b).setStroke(n)}},_drawMarkers:function(a,c,b,e){var d,g,f,n=a.geometry,k=n.points,m=a.getDojoShape()||this._div.createGroup(),t=k.length,r=[],q=0,u=b?b.length:0;m.children[0]&&this._isInvalidShape(c,m.children[0])&&m.clear();for(g=0;t>g;g++)for(d=
k[g],f=0;u>f;f++)r[0]=b[f],this._drawPoint(m,{x:d[0],y:d[1],spatialReference:n.spatialReference},c,m.children[q++],r,e,a);c=m.children.length;if(t*b.length<c)for(g=c-1;g>=t*b.length;g--)m.children[g].removeShape();a._shape=m},_symbolizeMarkers:function(a,c,b){var e,d=a.getDojoShape().children,g=d.length;for(e=0;g>e;e++)this._symbolizePoint(d[e],c,b,a)},_errorHandler:function(a,c){c?a.message="Unable to draw graphic (geometry:"+(c.geometry?c.geometry.declaredClass:null)+", symbol:"+(c.symbol?c.symbol.declaredClass:
null)+"): "+a.message:a.message="Unable to draw graphic (null): "+a.message;this.inherited(arguments)},_rendererLimits:function(){var a,c,b;if(u("ff")?(a=16125,c=-32250,b=32250):G?(a=1E5,c=-1E5,b=1E5):u("chrome")&&6>u("chrome")&&(a=8150,c=-1E4,b=1E4),a){var e,d;return e=[-a,-a,a,a],d=[[[-a,-a],[a,-a]],[[a,-a],[a,a]],[[a,a],[-a,a]],[[-a,a],[-a,-a]]],{clipLimit:a,rangeMin:c,rangeMax:b,clipBBox:e,clipSegments:d}}}(),_clipPolyline:function(a,c){var b=this._getCorners(a,c),e=b.br,g=this._rendererLimits,
f=g.rangeMin,n=g.rangeMax,k=g.clipBBox,m=g.clipSegments,g=this._isPointWithinRange,t=this._isPointWithinBBox,r=this._getClipperIntersection,q=this._getPlaneIndex;if(!g(b.tl,f,n)||!g(e,f,n)){G&&this._createSegments(a);var u=[];d.forEach(a.segments,function(a){var c=a.args,b=c.length,e=[];for(a=0;b>a;a+=2){var d=[c[a],c[a+1]],g=[c[a+2],c[a+3]],f=t(d,k),n=t(g,k);f^n?(n=r([d,g],m))&&(f?(a?e.push(n[1]):e.push(d,n[1]),u.push(e),e=[]):e.push(n[1],g)):f?a?e.push(g):e.push(d,g):(n=q(d,k),f=q(g,k),-1!==n&&
-1!==f&&n!==f&&(d=r([d,g],m,!0),0<d.length&&(d[n]||(n=d[n[0]]?n[0]:n[1]),d[f]||(f=d[f[0]]?f[0]:f[1]),g=d[n],d=d[f],g&&e.push(g),d&&(e.push(d),u.push(e),e=[]))))}u.push(e)});a.setShape(this._getPathStringFromPaths(u))}},_clipPolygon:function(c,b){var e=this._getCorners(c,b),g=e.br,f=this._rendererLimits,n=f.clipLimit,k=f.rangeMin,m=f.rangeMax,t=f.clipBBox,r=f.clipSegments,f=this._isPointWithinRange,q=this._isPointWithinBBox,u=this._getClipperIntersection,h=this._getPlaneIndex,v=B._pointLineDistance;
f(e.tl,k,m)&&f(g,k,m)||(G&&this._createSegments(c),e=d.map(c.segments,function(c){var b,e=c.args,g=e.length,f=[];c=[];for(b=0;g>b;b+=2){var k=[e[b],e[b+1]],m=[e[b+2],e[b+3]];if(b===g-2){f.push(k);break}var l,w=q(k,t),x=q(m,t);if(f.push(k),w^x){if(l=u([k,m],r))k=l[1],k[w?"inOut":"outIn"]=!0,f.push(k),c.push([w?"INOUT":"OUTIN",f.length-1,l[0]])}else w||(w=h(k,t),x=h(m,t),-1===w||-1===x||w===x)||((l=u([k,m],r,!0),0<l.length)?(l[w]||(w=l[w[0]]?w[0]:w[1]),l[x]||(x=l[x[0]]?x[0]:x[1]),k=l[w],m=l[x],k&&(k.outIn=
!0,f.push(k),c.push(["OUTIN",f.length-1,w])),m&&(m.inOut=!0,f.push(m),c.push(["INOUT",f.length-1,x]))):a.isArray(w)&&a.isArray(x)&&(x=w.concat(x),x.sort(),"0123"===x.join(""))&&(x=[],3===w[0]+w[1]?x.push([n,-n],[-n,n]):x.push([-n,-n],[n,n]),w=v(x[0],[k,m]),k=v(x[1],[k,m]),f.push(k>w?x[0]:x[1])))}var y=t[0],A=t[1],C=t[2],z=t[3];d.forEach(f,function(a){a[0]<y&&(a[1]>=A&&a[1]<=z?a[0]=y:(a[0]=y,a[1]=a[1]<A?A:z))});d.forEach(f,function(a){a[1]<A&&(a[0]>=y&&a[0]<=C?a[1]=A:(a[1]=A,a[0]=a[0]<y?y:C))});d.forEach(f,
function(a){a[0]>C&&(a[1]>=A&&a[1]<=z?a[0]=C:(a[0]=C,a[1]=a[1]<A?A:z))});d.forEach(f,function(a){a[1]>z&&(a[0]>=y&&a[0]<=C?a[1]=z:(a[1]=z,a[0]=a[0]<y?y:C))});var D,B;l=0;if(g=c.length,0<g){do{if(D=c[l],B=c[(l+1)%g],D[2]===B[2]&&"INOUT"===D[0]&&"OUTIN"===B[0])if(e=D[1],b=B[1],b>e)for(e+=1;b>e;e++)f[e][2]=!0;else if(e>b){for(e+=1;e<f.length;e++)f[e][2]=!0;for(e=0;b>e;e++)f[e][2]=!0}l=(l+1)%g}while(0!==l)}g=f[0];b=f[f.length-1];g[2]&&(b[2]=!0,d.some(c,function(c){return 1===c[1]?(f.splice(f.length-1,
0,a.clone(f[1])),!0):!1}));f=d.filter(f,function(a){return a[2]?!1:!0});for(l=0;l<f.length-1;l++)D=f[l],(B=f[l+1])&&D[0]===B[0]&&D[1]===B[1]&&(B.outIn?D.outIn=!0:B.inOut&&(D.inOut=!0),f.splice(l+1,1));e=Math.abs;c=[];for(l=0;l<f.length-1;l++){D=f[l];k=D[0];D=D[1];m=e(k)===n;w=e(D)===n;B=f[l+1];x=B[0];B=B[1];var E=e(x)===n,F=e(B)===n;m&&F?c.push([l+1,[k,B]]):w&&E&&c.push([l+1,[x,D]])}for(l=c.length-1;0<=l;l--)B=c[l],e=f[B[0]-1],D=f[B[0]],e.outIn||e.inOut||D.outIn||D.inOut||f.splice(B[0],0,B[1]);return g=
f[0],b=f[f.length-1],(g[0]!==b[0]||g[1]!==b[1])&&f.push(g),f}),c.setShape(this._getPathStringFromPaths(e)))},_getCorners:function(a,c){if(G){var b=this._map,e=c.getExtent(),d=e.spatialReference,g=b.toScreen(new y(e.xmin,e.ymax,d)),b=b.toScreen(new y(e.xmax,e.ymin,d));return{tl:g,br:b}}g=a.getTransformedBoundingBox();return{tl:g[0],br:g[2]}},_createSegments:function(a){a.shape.path=a.vmlPath;a.segmented=!1;a._confirmSegmented();var c=a.segments;1<c.length&&(a.segments=d.filter(c,function(a,c,b){c=
b[c+1];return"M"===a.action&&c&&"L"===c.action?(a.args=a.args.concat(c.args),!0):!1}))},_getPathStringFromPaths:function(a){return G?(a=d.map(a,function(a){return"m "+d.map(a,function(a,c){return(1===c?"l ":"")+a.join(",")}).join(" ")}),a.push("e")):a=d.map(a,function(a){return"M "+d.map(a,function(a){return a.join(",")}).join(" ")}),a.join(" ")},_isPointWithinBBox:function(a,c){var b=c[1],e=c[2],d=c[3],g=a[0],f=a[1];return g>c[0]&&e>g&&f>b&&d>f?!0:!1},_isPointWithinRange:function(a,c,b){var e=a.x;
a=a.y;return c>e||c>a||e>b||a>b?!1:!0},_getClipperIntersection:function(a,c,b){var e,d=B._getLineIntersection2,g=Math.round,f={length:0};for(e=0;4>e;e++){var n=d(a,c[e]);if(n){if(n[0]=g(n[0]),n[1]=g(n[1]),!b)return[e,n];f[e]=n;f.length++}}return b?f:null},_getPlaneIndex:function(a,c){var b=a[0],e=a[1],d=c[0],g=c[1],f=c[2],n=c[3];return d>=b?e>=g&&n>=e?3:g>e?[0,3]:[2,3]:g>=e?b>=d&&f>=b?0:d>b?[3,0]:[1,0]:b>=f?e>=g&&n>=e?1:g>e?[0,1]:[2,1]:e>=n?b>=d&&f>=b?2:d>b?[3,2]:[1,2]:-1},onGraphicAdd:function(){},
onGraphicRemove:function(){},onGraphicNodeAdd:function(){},onGraphicNodeRemove:function(){},onGraphicDraw:function(){},onGraphicsClear:function(){},onRendererChange:function(){},onOpacityChange:function(){},setInfoTemplate:function(a){this.infoTemplate=a},add:function(a,c){return a._graphicsLayer===this?a:(c||this.graphics.push(a),a._graphicsLayer=this,a._layer=this,this._updateExtent(a),this._draw(a),c||this.onGraphicAdd(a),a)},remove:function(a,c,b){if(!c&&!b){c=this.graphics;if(-1===(a=d.indexOf(c,
a)))return null;a=c.splice(a,1)[0]}return a.getDojoShape()&&this._removeShape(a,null,b),a._shape=a._graphicsLayer=null,this.onGraphicRemove(a),a},clear:function(a,c){var b,e=this.graphics,d=!G;for(b=e.length-1;0<=b;b--)this.remove(e[b],null,d);if(this.graphics=[],d&&this._div){var g;this._childLayer&&(g=this._childLayer.getNode(),g&&g.parentNode&&g.parentNode.removeChild(g));this._bgGroup.clear();this._div.clear();this._bgGroup=this._div.createGroup();g&&this._div.getEventSource().appendChild(g);
this._initOpacity()}c||this.onGraphicsClear()},_setIEOpacity:function(a,c){var b=a&&a.getNode();if(b){var e=a.strokeStyle,d=b.stroke;e&&d&&(d.opacity=e.color.a*c);e=a.fillStyle;d=b.fill;e&&d&&("tile"===d.type?k.set(b,"opacity",c):d.opacity=e.a*c)}},setOpacity:function(a,c){if(c||this.opacity!=a){var b=this._div;b&&(G?(d.forEach(this.graphics,function(c){this._setIEOpacity(c._shape,a);this._setIEOpacity(c._bgShape,a)},this),b._esriIeOpacity=a,this._bgGroup._esriIeOpacity=a):this._canvas?k.set(b.getEventSource(),
"opacity",a):b.getEventSource().setAttribute("opacity",a));this.opacity=a;c||this.onOpacityChange(a)}},setRenderer:function(a){this.renderer=a;this._evalSDRenderer(!0);this.emit("renderer-change",{renderer:this._rndForScale||a})}});h=h([E,D],{declaredClass:"esri.layers.GraphicsLayer",constructor:function(){this.enableMouseEvents=a.hitch(this,this.enableMouseEvents);this.disableMouseEvents=a.hitch(this,this.disableMouseEvents);this._processEvent=a.hitch(this,this._processEvent);this._initLayer()},
_initLayer:function(){this.loaded=!0;this.onLoad(this)},_setMap:function(){var a=this.inherited("_setMap",arguments);return this.enableMouseEvents(),a},_unsetMap:function(){this.disableMouseEvents();this.inherited("_unsetMap",arguments)},_processEvent:function(a){var c,b=this._map,e=a.target;a.screenPoint=new z(a.pageX-b.position.x,a.pageY-b.position.y);for(a.mapPoint=b.toMap(a.screenPoint);e&&!(c=e.e_graphic);)e=e.parentNode;return c?(a.graphic=c,a):void 0},_onMouseOverHandler:function(a){this._processEvent(a)&&
this.onMouseOver(a)},_onMouseMoveHandler:function(a){this._processEvent(a)&&this.onMouseMove(a)},_onMouseDragHandler:function(a){this._processEvent(a)&&this.onMouseDrag(a)},_onMouseOutHandler:function(a){this._processEvent(a)&&this.onMouseOut(a)},_onMouseDownHandler:function(a){this._downGr=this._downPt=null;this._processEvent(a)&&(l.disconnect(this._onmousemove_connect),l.disconnect(this._onmousedrag_connect),this._onmousedrag_connect=l.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseDragHandler"),
this._downGr=a.graphic,this._downPt=a.screenPoint.x+","+a.screenPoint.y,this.onMouseDown(a))},_onMouseUpHandler:function(a){this._upGr=this._upPt=null;this._processEvent(a)&&(l.disconnect(this._onmousedrag_connect),l.disconnect(this._onmousemove_connect),this._onmousemove_connect=l.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseMoveHandler"),this._upGr=a.graphic,this._upPt=a.screenPoint.x+","+a.screenPoint.y,this.onMouseUp(a))},_onClickHandler:function(a){if(this._processEvent(a)){var c=
this._downGr,b=this._upGr;c&&b&&c===b&&this._downPt===this._upPt&&(G&&(q._ieGraphic=a.graphic),this.onClick(a))}},_onDblClickHandler:function(a){this._processEvent(a)&&this.onDblClick(a)},onMouseOver:function(){},onMouseMove:function(){},onMouseDrag:function(){},onMouseOut:function(){},onMouseDown:function(){},onMouseUp:function(){},onClick:function(){},onDblClick:function(){},enableMouseEvents:function(){if(!this._mouseEvents){var a=l.connect,c=this._div.getEventSource();H||(this._onmouseover_connect=
a(c,"onmouseover",this,"_onMouseOverHandler"),this._onmousemove_connect=a(c,"onmousemove",this,"_onMouseMoveHandler"),this._onmouseout_connect=a(c,"onmouseout",this,"_onMouseOutHandler"),this._onmousedown_connect=a(c,"onmousedown",this,"_onMouseDownHandler"),this._onmouseup_connect=a(c,"onmouseup",this,"_onMouseUpHandler"),this._onclick_connect=a(c,"onclick",this,"_onClickHandler"),this._ondblclick_connect=a(c,"ondblclick",this,"_onDblClickHandler"));this._mouseEvents=!0}},disableMouseEvents:function(){if(this._mouseEvents){var a=
l.disconnect;a(this._onmouseover_connect);a(this._onmousemove_connect);a(this._onmousedrag_connect);a(this._onmouseout_connect);a(this._onmousedown_connect);a(this._onmouseup_connect);a(this._onclick_connect);a(this._ondblclick_connect);this._mouseEvents=!1}}});return h._GraphicsContainer=w,h._GraphicsLayer=E,u("extend-esri")&&(a.setObject("layers.GraphicsLayer",h,q),a.setObject("layers._GraphicsContainer",w,q),a.setObject("layers._GraphicsLayer",E,q)),h})},"dojox/gfx":function(){define(["dojo/_base/lang",
"./gfx/_base","./gfx/renderer!"],function(h,l,a){l.switchTo(a);return l})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(h,l,a,d,b){var f=null;a.add("vml",function(a,b,d){d.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';a="adj"in d.firstChild;d.innerHTML="";return a});return{load:function(k,m,g){function e(){m(["dojox/gfx/"+c],function(a){h.renderer=c;f=a;g(a)})}if(f&&"force"!=k)g(f);else{var c=b.forceGfxRenderer;
k=!c&&(l.isString(b.gfxRenderer)?b.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var n,q;!c&&k.length;)switch(k.shift()){case "svg":"SVGAngle"in d.global&&(c="svg");break;case "vml":a("vml")&&(c="vml");break;case "silverlight":try{a("ie")?(n=new ActiveXObject("AgControl.AgControl"))&&n.IsVersionSupported("1.0")&&(q=!0):navigator.plugins["Silverlight Plug-In"]&&(q=!0)}catch(r){q=!1}finally{n=null}q&&(c="silverlight");break;case "canvas":d.global.CanvasRenderingContext2D&&(c="canvas")}"canvas"===
c&&!1!==b.canvasEvents&&(c="canvasWithEvents");"svg"==c&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(e):e()}}}})},"esri/layers/gfxSniff":function(){define(["dojo/has","dojox/gfx"],function(h,l){return h.add("esri-svg",function(){return-1!==l.renderer.toLowerCase().indexOf("svg")}),h})},"esri/layers/layer":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/Deferred dojo/_base/json dojo/has ../Evented ../kernel ../lang ../request ../deferredUtils ../urlUtils ../SpatialReference ../geometry/Extent".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u){var v=h([m],{declaredClass:"esri.layers.Layer",_eventMap:{error:["error"],load:["layer"],"opacity-change":["opacity"],"update-end":["error"],"visibility-change":["visible"]},constructor:function(c,b){if(this._attrs={},c&&d.isString(c)?this._url=q.urlToObject(this.url=c):(this.url=this._url=null,b=b||c,b&&(b.layerDefinition||b.query)&&(b=null)),this.spatialReference=new r(4326),this.initialExtent=new u(-180,-90,180,90,new r(4326)),this._map=this._div=null,this.normalization=
!0,b&&(b.id&&(this.id=b.id),!1===b.visible&&(this.visible=!1),e.isDefined(b.opacity)&&(this.opacity=b.opacity),e.isDefined(b.minScale)&&this.setMinScale(b.minScale),e.isDefined(b.maxScale)&&this.setMaxScale(b.maxScale),this.attributionDataUrl=b.attributionDataUrl||"",this.hasAttributionData=!!this.attributionDataUrl,e.isDefined(b.showAttribution)&&(this.showAttribution=b.showAttribution),this.className=b.className,this.refreshInterval=b.refreshInterval||0),this._errorHandler=d.hitch(this,this._errorHandler),
this.refresh=d.hitch(this,this.refresh),this.managedSuspension){var g=this._setMap;this._setMap=function(c){var b=g.apply(this,arguments);if(this.evaluateSuspension(),this.suspended&&!c.loaded)var e=a.connect(c,"onLoad",this,function(){a.disconnect(e);e=null;this.evaluateSuspension()});return b}}this.registerConnectEvents()},id:null,visible:!0,opacity:1,loaded:!1,loadError:null,minScale:0,maxScale:0,visibleAtMapScale:!1,suspended:!0,attributionDataUrl:"",hasAttributionData:!1,showAttribution:!0,refreshInterval:0,
_errorHandler:function(a){this.loaded||(this.loadError=a);this.onError(a)},_setMap:function(c,b,e,d){if(this._map=c,this._lyrZEHandle=a.connect(c,"onZoomEnd",this,this._processMapScale),c.loaded)this.visibleAtMapScale=this._isMapAtVisibleScale();else var g=a.connect(c,"onLoad",this,function(){a.disconnect(g);g=null;this._processMapScale()})},_unsetMap:function(c,b){a.disconnect(this._lyrZEHandle);this._toggleRT();this._map=this._lyrZEHandle=null;this._resumedOnce=void 0;this.suspended=!0},_cleanUp:function(){this._map=
this._div=null},_fireUpdateStart:function(){this.updating||(this.updating=!0,this.attr("data-updating",""),this._toggleRT(),this.onUpdateStart(),this._map&&this._map._incr())},_fireUpdateEnd:function(a,c){this.updating&&(this.updating=!1,this.attr("data-updating"),this._toggleRT(!0),this.onUpdateEnd(a,c),this._map&&this._map._decr())},_getToken:function(){var a=this._url,c=this.credential;return a&&a.query&&a.query.token||c&&c.token||void 0},_findCredential:function(){this.credential=g.id&&this._url&&
g.id.findCredential(this._url.path)},_useSSL:function(){var a=this._url,c=/^http:/i;this.url&&(this.url=this.url.replace(c,"https:"));a&&a.path&&(a.path=a.path.replace(c,"https:"))},refresh:function(){},show:function(){this.setVisibility(!0)},hide:function(){this.setVisibility(!1)},setMinScale:function(a){this.setScaleRange(a)},setMaxScale:function(a){this.setScaleRange(null,a)},setScaleRange:function(a,c){var b=e.isDefined(a),d=e.isDefined(c);this.loaded||(this._hasMin=this._hasMin||b,this._hasMax=
this._hasMax||d);var g=this.minScale,f=this.maxScale;this.minScale=(b?a:this.minScale)||0;this.maxScale=(d?c:this.maxScale)||0;g===this.minScale&&f===this.maxScale||(this.onScaleRangeChange(),this._processMapScale())},suspend:function(){this._suspended=!0;this.evaluateSuspension()},resume:function(){this._suspended=!1;this.evaluateSuspension()},canResume:function(){return this.loaded&&this._map&&this._map.loaded&&this.visible&&this.visibleAtMapScale&&!this._suspended},evaluateSuspension:function(){this.canResume()?
this.suspended&&this._resume():this.suspended||this._suspend()},_suspend:function(){this.suspended=!0;this.attr("data-suspended","");this._toggleRT();this.onSuspend();this._map&&this._map.onLayerSuspend(this)},_resume:function(){this.suspended=!1;this.attr("data-suspended");var a,c=void 0===this._resumedOnce,b=this.className,e=this._attrs,d=this.getNode();if(c){if(this._resumedOnce=!0,b&&d){var g=d.getAttribute("class")||"";(new RegExp("(^|\\s)"+b+"(\\s|$)","i")).test(g)||(g+=(g?" ":"")+b,d.setAttribute("class",
g))}if(e&&d)for(a in e)e.hasOwnProperty(a)&&d.setAttribute(a,e[a])}this._toggleRT(!0);this.onResume({firstOccurrence:c});this._map&&this._map.onLayerResume(this)},_processMapScale:function(){var a=this.visibleAtMapScale;this.visibleAtMapScale=this._isMapAtVisibleScale();a!==this.visibleAtMapScale&&(this.onScaleVisibilityChange(),this.evaluateSuspension())},isVisibleAtScale:function(a){return a?v.prototype._isMapAtVisibleScale.apply(this,arguments):!1},_isMapAtVisibleScale:function(a,c){if(!(a||this._map&&
this._map.loaded))return!1;var b=this._map;a=a||b.getScale();var e,d=this.minScale,g=this.maxScale,f=!d,n=!g;return c&&(e=b.width>b.height?b.width:b.height),f||(d>=a?f=!0:c&&(f=Math.abs(d-a)/d<1/e)),n||(a>=g?n=!0:c&&(n=Math.abs(g-a)/g<1/e)),f&&n},getAttributionData:function(){var a=this.attributionDataUrl,e=new b(n._dfdCanceller);this.hasAttributionData&&a?(e._pendingDfd=c({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),e._pendingDfd.then(function(a){e.callback(a)},function(a){e.errback(a)})):
(a=Error("Layer does not have attribution data"),a.log=l.isDebug,e.errback(a));return e},getResourceInfo:function(){var a=this.resourceInfo;return d.isString(a)?f.fromJson(a):d.clone(a)},getMap:function(){return this._map},getNode:function(){return this._div},attr:function(a,c){var b=this.getNode();return"data-reference"===a&&11>k("ie")?this:(b&&(null==c?b.removeAttribute(a):b.setAttribute(a,c)),this._attrs&&(null==c?delete this._attrs[a]:this._attrs[a]=c),this)},setRefreshInterval:function(a){var c=
this.refreshInterval;return this.refreshInterval=a,this._toggleRT(),a&&(this.updating||this.suspended||this._toggleRT(!0)),c!==a&&this.onRefreshIntervalChange(),this},_toggleRT:function(a){a&&this.refreshInterval?(clearTimeout(this._refreshT),this._refreshT=setTimeout(this.refresh,6E4*this.refreshInterval)):this._refreshT&&(clearTimeout(this._refreshT),this._refreshT=null)},setNormalization:function(a){this.normalization=a},setVisibility:function(a){this.visible!==a&&(this.visible=a,this.onVisibilityChange(this.visible),
this.evaluateSuspension());this.attr("data-hidden",a?null:"")},onLoad:function(){},onVisibilityChange:function(){},onScaleRangeChange:function(){},onScaleVisibilityChange:function(){},onSuspend:function(){},onResume:function(){},onUpdate:function(){},onUpdateStart:function(){},onUpdateEnd:function(){},onRefreshIntervalChange:function(){},onError:function(){}});return k("extend-esri")&&d.setObject("layers.Layer",v,g),v})},"esri/request":function(){define("require dojo/_base/array dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/_base/url dojo/_base/xhr dojo/io/script dojo/io/iframe dojo/dom-construct dojo/io-query ./kernel ./config ./sniff ./lang ./urlUtils ./deferredUtils".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t){function w(a){return a=new f(a),(a.host+(a.port?":"+a.port:"")).toLowerCase()}function x(a){return this._xhr?this._xhr.getResponseHeader(a):null}function y(f,t,q,h){var w,x=!1,y=!1;u.isDefined(t)&&(b.isObject(t)?(x=!!t.useProxy,y=!!t.usePost,w=t.crossOrigin):x=!!t);f=b.mixin({},f);f._ssl&&(f.url=f.url.replace(/^http:/i,"https:"));t=f.content;var C=f.url,A=q&&f.form,z=F;w=u.isDefined(w)?w:z.useCors;f.load=function(c){var e;return c&&(c.error?(e=b.mixin(Error(),
c.error),e.log=a.isDebug):"error"===c.status&&(e=b.mixin(Error(),c),e.log=a.isDebug),e&&!u.isDefined(e.httpCode)&&(e.httpCode=e.code)),e||c};f.error=function(c,e){return e&&e.xhr&&e.xhr.abort(),c instanceof Error||(c=b.mixin(Error(),c)),c.log=a.isDebug,z.errorHandler(c,e),c};f._token&&(f.content=f.content||{},f.content.token=f._token);var B,E=0;t&&C&&(B=c.objectToQuery(t),E=B.length+C.length+1,r("esri-url-encodes-apostrophe")&&(E=B.replace(/'/g,"%27").length+C.length+1));f.timeout=u.isDefined(f.timeout)?
f.timeout:z.timeout;f.handleAs=f.handleAs||"json";try{var H,fa,ea=w&&v.canUseXhr(f.url)&&!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(f.url),oa=v.hasSameOrigin(f.url,window.location.href)||ea,pa=y||q||E>z.postLength?!0:!1,Aa=oa||-1===f.handleAs.indexOf("json")||!f.callbackParamName||q?!1:!0,ta=v.getProxyRule(f.url)||z.alwaysUseProxy||x||(!Aa||pa)&&!oa?!0:!1;if(q&&!r("esri-file-upload")&&!ta&&ea&&(ta=!0),ta)if(H=v.getProxyUrl(C,w),fa=H.path,H._xo&&(ea=!0),!pa&&fa.length+1+E>z.postLength&&(pa=
!0),f.url=fa+"?"+C,pa)f.content=b.mixin(H.query||{},t);else{var va=c.objectToQuery(b.mixin(H.query||{},t));va&&(f.url+="?"+va);f.content=null}if(Aa&&!pa)return!u.isDefined(f.isAsync)&&4>r("ff")&&(f.isAsync=!0),m.get(D?D(f):f);var ua=f.headers;if(!ea||ua&&ua.hasOwnProperty("X-Requested-With")||(ua=f.headers=ua||{},ua["X-Requested-With"]=null),q){var qa,ca,ja,la,ka,sa=f.callbackParamName||"callback.html",Ea=f.callbackElementName||"textarea",ra=A.elements?A.elements.length:0;if(t=f.content)for(qa in t)if(ja=
t[qa],u.isDefined(ja)){ca=null;for(la=0;ra>la;la++)if(ka=A.elements[la],ka.name===qa){ca=ka;break}ca?ca.value=ja:h?A.append(qa,ja):A.appendChild(e.create("input",{type:"hidden",name:qa,value:ja}))}r("esri-file-upload")?(l.forEach(A.elements,function(a){a.name===sa&&A.removeChild(a)}),f.contentType=!1,f.postData=h?A:new FormData(A),delete f.form):(A.enctype="multipart/form-data",9>r("ie")&&(A.encoding="multipart/form-data"),A.method="post",l.some(A.elements,function(a){return a.name===sa})||A.appendChild(e.create("input",
{type:"hidden",name:sa,value:Ea})),(-1!==C.toLowerCase().indexOf("addattachment")||-1!==C.toLowerCase().indexOf("updateattachment"))&&(f.url=C+(-1===C.indexOf("?")?"?":"\x26")+sa+"\x3d"+Ea,ta&&(f.url=fa+"?"+f.url)),delete f.content)}if(ea&&!f.hasOwnProperty("withCredentials")&&"with-credentials"===F.useCors){h=ta?fa:C;var za=v.canUseXhr(h,!0),wa=-1<za?F.corsEnabledServers[za]:null;if(wa&&wa.hasOwnProperty("withCredentials"))wa.withCredentials&&(f.withCredentials=!0);else if(n.id){var Ha=n.id.findServerInfo(h);
Ha&&Ha.webTierAuth&&(f.withCredentials=!0)}}return f=D?D(f):f,pa?q&&!r("esri-file-upload")?g.send(f):(!ta&&r("safari")&&(f.url+=(-1===f.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+G++),k.post(f)):k.get(f)}catch(Ga){return q=new d,q.errback(f.error(Ga)),q}}function z(a){var c=F.corsStatus,b=v.canUseXhr(a,!0);return-1<b&&F.corsEnabledServers.splice(b,1),c[w(a)]=1,b}function A(a){var c=F.corsStatus;if(F.corsDetection&&F.useCors)try{var b=w(a);!r("esri-cors")||!a||-1===a.toLowerCase().indexOf("/rest/services")||
v.hasSameOrigin(a,window.location.href)||v.canUseXhr(a)||c[b]||(c[b]=-1,k.get({url:a.substring(0,a.toLowerCase().indexOf("/rest/")+6)+"info",content:{f:"json"},failOk:!0,handleAs:"json",headers:{"X-Requested-With":null}}).then(function(e){e?(c[b]=2,v.canUseXhr(a)||F.corsEnabledServers.push(b)):c[b]=1},function(a){c[b]=1}))}catch(e){}}function B(a){D=a}function C(c,b){function e(d){if(d._pendingDfd=y(c,b,R,G),!d._pendingDfd){d.ioArgs=d._pendingDfd&&d._pendingDfd.ioArgs;var g=Error("Deferred object is missing");
return g.log=a.isDebug,c._usrDfd=null,d.errback(g),d._pendingDfd=null,d}d._pendingDfd.addCallback(function(a){d.ioArgs=d._pendingDfd&&d._pendingDfd.ioArgs;c._usrDfd=null;b.returnFullResponse&&(a={data:a,_xhr:d.ioArgs&&d.ioArgs.xhr,getHeader:x});d.callback(a);d._pendingDfd=null}).addErrback(function(a){var e,g,f;if(a&&(e=a.code,g=a.subcode,f=a.messageCode,f=f&&f.toUpperCase()),a&&403==e&&(4==g||a.message&&-1<a.message.toLowerCase().indexOf("ssl")&&-1===a.message.toLowerCase().indexOf("permission"))){if(!c._ssl)return c._ssl=
c._sslFromServer=!0,c._usrDfd=d,void C(c,b)}else if(a&&415==a.status){if(z(c.url),!c._err415)return c._err415=1,c._usrDfd=d,void C(c,b)}else if(n.id&&-1!==l.indexOf(n.id._errorCodes,e)&&!n.id._isPublic(c.url)&&!m&&(403!=e||-1===l.indexOf(H,f)&&(!u.isDefined(g)||2==g&&c._token)))return d._pendingDfd=n.id.getCredential(c.url,{token:c._token,error:a}),void d._pendingDfd.addCallback(function(a){c._token=a.token;c._usrDfd=d;c._credential=a;c._ssl=c._sslFromServer||a.ssl;C(c,b)}).addErrback(function(a){c._usrDfd=
null;d.errback(a);d._pendingDfd=null});d.ioArgs=d._pendingDfd&&d._pendingDfd.ioArgs;c._usrDfd=null;d.errback(a);d._pendingDfd=null})}c.url=v.fixUrl(c.url);b=b||{};var g,f=c.form,m=b.disableIdentityLookup,q=b._preLookup,D=!1;if(r("esri-workers")&&!1!==F.useWorkers)if(!0===b.useWorkers||!0===F.useWorkers)D=!0;else if(b.workerOptions){var B=b.workerOptions;(B.callback||B.worker&&B.worker.worker instanceof Worker)&&(D=!0)}var G=f&&r("esri-file-upload")&&f instanceof FormData,R=f&&(f.elements?l.some(f.elements,
function(a){return"file"===a.type}):G),U=-1!==c.url.toLowerCase().indexOf("token\x3d")||c.content&&c.content.token||R&&l.some(f.elements,function(a){return"token"===a.name})?1:0;if(A(c.url),c._usrDfd)g=c._usrDfd;else{g=new d(t._dfdCanceller);g.addCallback(function(a){if((/\/sharing\/rest\/accounts\/self/i.test(c.url)||/\/sharing\/rest\/portals\/self/i.test(c.url))&&!U&&!c._token&&a.user&&a.user.username){F.webTierAuthServers.push(w(c.url));a=F.corsEnabledServers;var b=v.canUseXhr(c.url,!0),e={host:w(c.url),
withCredentials:!0};if(-1===b)a.push(e);else{var d=a[b];"object"==typeof d?d.withCredentials=!0:a.splice(b,1,e)}}if(a=c._credential){var g;(b=(b=n.id.findServerInfo(a.server))&&b.owningSystemUrl)&&(b=b.replace(/\/?$/,"/sharing"),g=n.id.findCredential(b,a.userId),g&&-1===n.id._getIdenticalSvcIdx(b,g)&&g.resources.splice(0,0,b))}});g.addBoth(function(a){delete c._credential;!a||r("ie")&&a.nodeType||(a._ssl=c._ssl)});var W=c.load,fa=c.error;W&&g.addCallback(function(a){var c=g._pendingDfd,c=c&&c.ioArgs;
return W.call(c&&c.args,a,c)});fa&&g.addErrback(function(a){var c=g._pendingDfd,c=c&&c.ioArgs;return fa.call(c&&c.args,a,c)})}!n.id||U||c._token||n.id._isPublic(c.url)||m&&!q||(f=n.id.findCredential(c.url))&&(c._token=f.token,c._ssl=f.ssl);return D?b.workerOptions&&b.workerOptions.worker?(E||(E=k),k=b.workerOptions.worker,e(g)):h(["./workers/RequestClient"],function(a){if(E||(E=k),b.workerOptions){var c=b.workerOptions;k=a.getClient(c.callback,c.cbFunction)}else k=a.getClient();e(g)}):(E&&(k=E,E=
null),e(g)),g}var D,E=null,F=q.defaults.io,H=["COM_0056","COM_0057"],G=0;return C._request=y,C._disableCors=z,C._detectCors=A,C.setRequestPreCallback=B,r("extend-esri")&&(n.request=C,n._request=y,n._disableCors=z,n._detectCors=A,n.setRequestPreCallback=B),C})},"dojo/io/script":function(){define("../_base/connect ../_base/kernel ../_base/lang ../sniff ../_base/window ../_base/xhr ../dom ../dom-construct ../request/script ../aspect".split(" "),function(h,l,a,d,b,f,k,m,g,e){l.deprecated("dojo/io/script",
"Use dojo/request/script.","2.0");var c={get:function(a){var b,d=this._makeScriptDeferred(a,function(a){b&&b.cancel()}),k=d.ioArgs;f._ioAddQueryToUrl(k);f._ioNotifyStart(d);b=g.get(k.url,{timeout:a.timeout,jsonp:k.jsonp,checkString:a.checkString,ioArgs:k,frameDoc:a.frameDoc,canAttach:function(a){k.requestId=a.id;k.scriptId=a.scriptId;k.canDelete=a.canDelete;return c._canAttach(k)}},!0);e.around(b,"isValid",function(a){return function(b){c._validCheck(d);return a.call(this,b)}});b.then(function(){d.resolve(d)}).otherwise(function(a){d.ioArgs.error=
a;d.reject(a)});return d},attach:g._attach,remove:g._remove,_makeScriptDeferred:function(a,b){var e=f._ioSetArgs(a,b||this._deferredCancel,this._deferredOk,this._deferredError),d=e.ioArgs;d.id=l._scopeName+"IoScript"+(a.callbackSuffix||this._counter++);d.canDelete=!1;d.jsonp=a.callbackParamName||a.jsonp;d.jsonp&&(d.query=d.query||"",0<d.query.length&&(d.query+="\x26"),d.query+=d.jsonp+"\x3d"+(a.frameDoc?"parent.":"")+l._scopeName+".io.script.jsonp_"+d.id+"._jsonpCallback",d.frameDoc=a.frameDoc,d.canDelete=
!0,e._jsonpCallback=this._jsonpCallback,this["jsonp_"+d.id]=e);e.addBoth(function(a){d.canDelete&&(a instanceof Error?c["jsonp_"+d.id]._jsonpCallback=function(){delete c["jsonp_"+d.id];if(d.requestId)l.global[g._callbacksProperty][d.requestId]()}:c._addDeadScript(d))});return e},_deferredCancel:function(a){a.canceled=!0},_deferredOk:function(a){a=a.ioArgs;return a.json||a.scriptLoaded||a},_deferredError:function(a,c){return a},_deadScripts:[],_counter:1,_addDeadScript:function(a){c._deadScripts.push({id:a.id,
frameDoc:a.frameDoc});a.frameDoc=null},_validCheck:function(a){if((a=c._deadScripts)&&0<a.length){for(var b=0;b<a.length;b++)c.remove(a[b].id,a[b].frameDoc),delete c["jsonp_"+a[b].id],a[b].frameDoc=null;c._deadScripts=[]}return!0},_ioCheck:function(a){a=a.ioArgs;return a.json||a.scriptLoaded&&!a.args.checkString?!0:(a=a.args.checkString)&&eval("typeof("+a+") !\x3d 'undefined'")},_resHandle:function(a){c._ioCheck(a)?a.callback(a):a.errback(Error("inconceivable dojo.io.script._resHandle error"))},_canAttach:function(){return!0},
_jsonpCallback:function(a){this.ioArgs.json=a;if(this.ioArgs.requestId)l.global[g._callbacksProperty][this.ioArgs.requestId](a)}};a.setObject("dojo.io.script",c);return c})},"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),function(h,l,a,d,b,f,k,m,g,e,c){function n(a,c){a.canDelete&&t._remove(a.id,c.options.frameDoc,!0)}function q(a){B&&B.length&&(b.forEach(B,function(a){t._remove(a.id,
a.frameDoc);a.frameDoc=null}),B=[]);return a.options.jsonp?!a.data:!0}function r(a){return!!this.scriptLoaded}function u(a){return(a=a.options.checkString)&&eval("typeof("+a+') !\x3d\x3d "undefined"')}function v(a,c){if(this.canDelete){var b=this.response.options;B.push({id:this.id,frameDoc:b.ioArgs?b.ioArgs.frameDoc:b.frameDoc});b.ioArgs&&(b.ioArgs.frameDoc=null);b.frameDoc=null}c?this.reject(c):this.resolve(a)}function t(c,b,e){var d=a.parseArgs(c,a.deepCopy({},b));c=d.url;b=d.options;var g=a.deferred(d,
n,q,b.jsonp?null:b.checkString?u:r,v);f.mixin(g,{id:w+x++,canDelete:!1});b.jsonp&&((new RegExp("[?\x26]"+b.jsonp+"\x3d")).test(c)||(c+=(~c.indexOf("?")?"\x26":"?")+b.jsonp+"\x3d"+(b.frameDoc?"parent.":"")+w+"_callbacks."+g.id),g.canDelete=!0,A[g.id]=function(a){d.data=a;g.handleResponse(d)});a.notify&&a.notify.emit("send",d,g.promise.cancel);if(!b.canAttach||b.canAttach(g)){var m=t._attach(g.id,c,b.frameDoc);if(!b.jsonp&&!b.checkString)var h=k(m,y,function(a){if("load"===a.type||z.test(m.readyState))h.remove(),
g.scriptLoaded=a})}k.once(m,"error",function(a){g.reject(a);t._remove(g.id,b.frameDoc,!0)});l(g);return e?g:g.promise}e.add("script-readystatechange",function(a,c){return"undefined"!==typeof c.createElement("script").onreadystatechange&&("undefined"===typeof a.opera||"[object Opera]"!==a.opera.toString())});var w=h.id.replace(/[\/\.\-]/g,"_"),x=0,y=e("script-readystatechange")?"readystatechange":"load",z=/complete|loaded/,A=d.global[w+"_callbacks"]={},B=[];t.get=t;t._attach=function(a,b,e){e=e||c.doc;
var d=e.createElement("script");d.type="text/javascript";d.src=b;d.id=a;d.async=!0;d.charset="utf-8";return e.getElementsByTagName("head")[0].appendChild(d)};t._remove=function(a,c,b){g.destroy(m.byId(a,c));A[a]&&(b?A[a]=function(){delete A[a]}:delete A[a])};t._callbacksProperty=w+"_callbacks";return t})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q){a.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");f=q._iframeName;f=f.substring(0,f.lastIndexOf("_"));var r=d.delegate(q,{create:function(){return r._frame=q.create.apply(q,arguments)},get:null,post:null,send:function(c){var e,d=b._ioSetArgs(c,function(a){e&&e.cancel()},function(c){var b=null;c=c.ioArgs;try{var d=c.handleAs;"xml"===d||"html"===d?b=e.response.data:(b=e.response.text,"json"===d?b=l.fromJson(b):"javascript"===d&&(b=a.eval(b)))}catch(g){b=
g}return b},function(a,c){c.ioArgs._hasError=!0;return a}),g=d.ioArgs,f="GET",k=m.byId(c.form);c.method&&"POST"===c.method.toUpperCase()&&k&&(f="POST");c={method:f,handleAs:"json"===c.handleAs||"javascript"===c.handleAs?"text":c.handleAs,form:c.form,query:k?null:c.content,data:k?c.content:null,timeout:c.timeout,ioArgs:g};c.method&&(c.method=c.method.toUpperCase());if(h.ioPublish&&a.publish&&!1!==g.args.ioPublish)var r=n.after(q,"_notifyStart",function(a){a.options.ioArgs===g&&(r.remove(),b._ioNotifyStart(d))},
!0);e=q(g.url,c,!0);g._callNext=e._callNext;e.then(function(){d.resolve(d)}).otherwise(function(a){d.ioArgs.error=a;d.reject(a)});return d},_iframeOnload:k.global[f+"_onload"]});d.setObject("dojo.io.iframe",r);return r})},"dojo/request/iframe":function(){define("module require ./watch ./util ./handlers ../_base/lang ../io-query ../query ../has ../dom ../dom-construct ../_base/window ../NodeList-dom".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n){function q(a){return!this.isFulfilled()}function r(a){return!!this._finished}
function u(a,c){if(!c)try{var e=a.options,d=t.doc(t._frame),g=e.handleAs;if("html"!==g){if("xml"===g)if("html"===d.documentElement.tagName.toLowerCase()){m("a",d.documentElement).orphan();var n=d.documentElement.innerText||d.documentElement.textContent,n=n.replace(/>\s+</g,"\x3e\x3c");a.text=f.trim(n)}else a.data=d;else a.text=d.getElementsByTagName("textarea")[0].value;b(a)}else a.data=d}catch(k){c=k}c?this.reject(c):this._finished?this.resolve(a):this.reject(Error("Invalid dojo/request/iframe request state"))}
function v(a){this._callNext()}function t(c,b,e){var g=d.parseArgs(c,d.deepCreate(y,b),!0);c=g.url;b=g.options;if("GET"!==b.method&&"POST"!==b.method)throw Error(b.method+" not supported by dojo/request/iframe");t._frame||(t._frame=t.create(t._iframeName,x+"();"));c=d.deferred(g,null,q,r,u,v);c._callNext=function(){this._calledNext||(this._calledNext=!0,t._currentDfd=null,t._fireNextRequest())};c._legacy=e;t._dfdQueue.push(c);t._fireNextRequest();a(c);return e?c:c.promise}var w=h.id.replace(/[\/\.\-]/g,
"_"),x=w+"_onload";n.global[x]||(n.global[x]=function(){var a=t._currentDfd;if(a){var b=e.byId(a.response.options.form)||a._tmpForm;if(b){for(var d=a._contentToClean,g=0;g<d.length;g++)for(var f=d[g],n=0;n<b.childNodes.length;n++){var k=b.childNodes[n];if(k.name===f){c.destroy(k);break}}a._originalAction&&b.setAttribute("action",a._originalAction);a._originalMethod&&(b.setAttribute("method",a._originalMethod),b.method=a._originalMethod);a._originalTarget&&(b.setAttribute("target",a._originalTarget),
b.target=a._originalTarget)}a._tmpForm&&(c.destroy(a._tmpForm),delete a._tmpForm);a._finished=!0}else t._fireNextRequest()});var y={method:"POST"};t.create=function(a,b,e){if(n.global[a])return n.global[a];if(n.global.frames[a])return n.global.frames[a];e||(g("config-useXDomain")&&!g("config-dojoBlankHtmlUrl")&&console.warn("dojo/request/iframe: When using cross-domain Dojo builds, please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl to the path on your domain to blank.html"),
e=g("config-dojoBlankHtmlUrl")||l.toUrl("dojo/resources/blank.html"));b=c.place('\x3ciframe id\x3d"'+a+'" name\x3d"'+a+'" src\x3d"'+e+'" onload\x3d"'+b+'" style\x3d"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden"\x3e',n.body());return n.global[a]=b};t.doc=function(a){if(a.contentDocument)return a.contentDocument;var c=a.name;if(c){var b=n.doc.getElementsByTagName("iframe");if(a.document&&b[c].contentWindow&&b[c].contentWindow.document)return b[c].contentWindow.document;
if(n.doc.frames[c]&&n.doc.frames[c].document)return n.doc.frames[c].document}return null};t.setSrc=function(a,c,b){a=n.global.frames[a.name];a.contentWindow&&(a=a.contentWindow);try{b?a.location.replace(c):a.location=c}catch(e){}};t._iframeName=w+"_IoIframe";t._notifyStart=function(){};t._dfdQueue=[];t._currentDfd=null;t._fireNextRequest=function(){var a;try{if(!t._currentDfd&&t._dfdQueue.length){do a=t._currentDfd=t._dfdQueue.shift();while(a&&(a.canceled||a.isCanceled&&a.isCanceled())&&t._dfdQueue.length);
if(!a||a.canceled||a.isCanceled&&a.isCanceled())t._currentDfd=null;else{var b=a.response,g=b.options,m=a._contentToClean=[],r=e.byId(g.form),q=d.notify,h=g.data||null,u;a._legacy||"POST"!==g.method||r?"GET"===g.method&&r&&-1<b.url.indexOf("?")&&(u=b.url.slice(b.url.indexOf("?")+1),h=f.mixin(k.queryToObject(u),h)):r=a._tmpForm=c.create("form",{name:w+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},n.body());if(r){if(!a._legacy){var v=r;do v=v.parentNode;while(v&&v!==n.doc.documentElement);
v||(r.style.position="absolute",r.style.left="-1000px",r.style.top="-1000px",n.body().appendChild(r));r.name||(r.name=w+"_form")}if(h){var v=function(a,b){c.create("input",{type:"hidden",name:a,value:b},r);m.push(a)},l;for(l in h){var x=h[l];if(f.isArray(x)&&1<x.length)for(u=0;u<x.length;u++)v(l,x[u]);else r[l]?r[l].value=x:v(l,x)}}var y=r.getAttributeNode("action"),L=r.getAttributeNode("method"),M=r.getAttributeNode("target");b.url&&(a._originalAction=y?y.value:null,y?y.value=b.url:r.setAttribute("action",
b.url));a._legacy?L&&L.value||(L?L.value=g.method:r.setAttribute("method",g.method)):(a._originalMethod=L?L.value:null,L?L.value=g.method:r.setAttribute("method",g.method));a._originalTarget=M?M.value:null;M?M.value=t._iframeName:r.setAttribute("target",t._iframeName);r.target=t._iframeName;q&&q.emit("send",b,a.promise.cancel);t._notifyStart(b);r.submit()}else g="",b.options.data&&(g=b.options.data,"string"!==typeof g&&(g=k.objectToQuery(g))),v=b.url+(-1<b.url.indexOf("?")?"\x26":"?")+g,q&&q.emit("send",
b,a.promise.cancel),t._notifyStart(b),t.setSrc(t._frame,v,!0)}}}catch(N){a.reject(N)}};d.addCommonMethods(t,["GET","POST"]);return t})},"esri/layers/TileInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../SpatialReference ../geometry/Point ./LOD".split(" "),function(h,l,a,d,b,f,k,m,g){h=h(null,{declaredClass:"esri.layers.TileInfo",constructor:function(b){l.mixin(this,b);this.width=this.cols;this.height=this.rows;b=this.spatialReference;var c=
this.origin;b&&(b=this.spatialReference=new k(b.toJson?b.toJson():b));c&&(this.origin=new m(c.toJson?c.toJson():c),!c.spatialReference&&b&&this.origin.setSpatialReference(new k(b.toJson())));this.lods=a.map(this.lods,function(a){return new g(a)})},toJson:function(){return f.fixJson({rows:this.rows,cols:this.cols,dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin&&this.origin.toJson(),spatialReference:this.spatialReference&&this.spatialReference.toJson(),
lods:this.lods&&a.map(this.lods,function(a){return a.toJson()})})}});return d("extend-esri")&&l.setObject("layers.TileInfo",h,b),h})},"esri/layers/LOD":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(h,l,a,d,b){h=h(null,{declaredClass:"esri.layers.LOD",constructor:function(a){l.mixin(this,a)},toJson:function(){return b.fixJson({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})}});return a("extend-esri")&&
l.setObject("layers.LOD",h,d),h})},"esri/layers/ArcGISTiledMapServiceLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has dojo/io-query ../kernel ../urlUtils ../SpatialReference ./TiledMapServiceLayer ./ArcGISMapServiceLayer ./TileInfo ./TimeInfo ./TileMap".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u){l=l([c,n],{declaredClass:"esri.layers.ArcGISTiledMapServiceLayer",_agolAttrs:"Canvas/World_Dark_Gray_Base Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Base Canvas/World_Light_Gray_Reference Elevation/World_Hillshade Ocean/World_Ocean_Base Ocean/World_Ocean_Reference Ocean_Basemap Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Transportation World_Imagery World_Street_Map World_Topo_Map".split(" "),
_isReference:!1,_referenceLayers:"Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Reference Ocean/World_Ocean_Reference Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Reference_Overlay Reference/World_Transportation".split(" "),constructor:function(c,b){b&&(b.roundrobin&&(h.deprecated(this.declaredClass+" : Constructor option 'roundrobin' deprecated. Use option 'tileServers'."),b.tileServers=b.roundrobin),this._setTileServers(b.tileServers),
this._loadCallback=b.loadCallback);this._params=a.mixin({},this._url.query);this._initLayer=a.hitch(this,this._initLayer);var e=b&&b.resourceInfo;e?this._initLayer(e):(this._load=a.hitch(this,this._load),this._load())},_TILE_FORMATS:{PNG:"png",PNG8:"png",PNG24:"png",PNG32:"png",JPG:"jpg",JPEG:"jpg",GIF:"gif"},_setTileServers:function(a){if(a&&0<a.length){this.tileServers=a;var c,b=a.length;for(c=0;b>c;c++)a[c]=g.urlToObject(a[c]).path}},_initLayer:function(a,c){if(this.inherited(arguments),this.resourceInfo=
b.toJson(a),this.tileInfo=new q(a.tileInfo),!1!==this.resampling)a.capabilities&&-1<a.capabilities.indexOf("Tilemap")?(this.resampling=!0,this.tileMap=new u(this)):this.resampling=!!a.resampling;!this.spatialReference&&this.tileInfo.spatialReference&&(this.spatialReference=new e(this.tileInfo.spatialReference.toJson()));this.isPNG32="PNG24"===this.tileInfo.format||"PNG32"===this.tileInfo.format;a.timeInfo&&(this.timeInfo=new r(a.timeInfo));a.mensurationCapabilities&&(this.mensurationCapabilities=
a.mensurationCapabilities);var d=this._url.path,f=this._loadCallback,n=g.getProtocolForWebResource(!0),k=d.match(/^https?\:\/\/(server|services)\.arcgisonline\.com\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i),k=k&&k[2];if(!this.tileServers)if(a.tileServers)this._setTileServers(a.tileServers);else{var m=-1!==d.search(/^https?\:\/\/server\.arcgisonline\.com/i),h=-1!==d.search(/^https?\:\/\/services\.arcgisonline\.com/i);(m||h)&&this._setTileServers([d,d.replace(m?/server\.arcgisonline/i:
/services\.arcgisonline/i,m?"services.arcgisonline":"server.arcgisonline")])}if(k){for(var k=k.toLowerCase(),l,d=0;d<this._agolAttrs.length;d++)if(l=this._agolAttrs[d],l.toLowerCase()===k){this.hasAttributionData=!0;this.attributionDataUrl=this.attributionDataUrl||n+"//static.arcgis.com/attribution/"+l;break}for(d=0;d<this._referenceLayers.length;d++)if(l=this._referenceLayers[d],l.toLowerCase()===k){this._isReference=!0;break}}this.loaded=!0;this.onLoad(this);f&&(delete this._loadCallback,f(this))},
getTileUrl:function(a,c,b){var e=this.tileServers,d=this._getToken(),f=this._url.query;a=(e?e[c%e.length]:this._url.path)+"/tile/"+a+"/"+c+"/"+b;return a=g.upgradeToHTTPS(a),this.resampling&&!this.tileMap&&(a+="?blankTile\x3dfalse"),f&&(a+=this.resampling&&!this.tileMap?"\x26"+k.objectToQuery(f):"?"+k.objectToQuery(f)),!d||f&&f.token||(a+=(-1===a.indexOf("?")?"?":"\x26")+"token\x3d"+d),a=this.addTimestampToURL(a),g.addProxy(a)}});return f("extend-esri")&&a.setObject("layers.ArcGISTiledMapServiceLayer",
l,m),l})},"esri/layers/TiledMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/url dojo/dom-construct dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/dom dojox/collections/ArrayList dojox/gfx/matrix ../kernel ../config ../sniff ../domUtils ../tileUtils ../geometry/Point ../geometry/Rect ../geometry/Extent ./layer".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z){h=h(z,{declaredClass:"esri.layers.TiledMapServiceLayer",
constructor:function(c,b){l.connect(this,"onLoad",this,"_initTiledLayer");this._lowestLevel=(this._displayLevels=b?b.displayLevels:null)?this._displayLevels[0]:0;this.resampling=b?b.resampling:void 0;this._resamplingTolerance=b?b.resamplingTolerance:null;this.exclusionAreas=b?b.exclusionAreas:null;var e=a.hitch;this._addImage=e(this,this._addImage);this._tileLoadHandler=e(this,this._tileLoadHandler);this._tileErrorHandler=e(this,this._tileErrorHandler);this._popTile=e(this,this._popTile);this._cleanUpRemovedImages=
e(this,this._cleanUpRemovedImages);this._fireOnUpdateEvent=e(this,this._fireOnUpdateEvent);this._transitionEnd=e(this,this._transitionEnd);this._tileMapCallback=e(this,this._tileMapCallback)},opacity:1,isPNG32:!1,_multiple:1,isResampling:!1,_initTiledLayer:function(){var a=this.tileInfo,c=a.lods;this.resampling=null!=this.resampling?this.resampling:!1;this._tileW=a.width;this._tileH=a.height;var b,e,g,f=this.scales=[],n=this._displayLevels,k=-(1/0),m=1/0;b=this.fullExtent;var r=new w(b.xmin,b.ymax),
q=new w(b.xmax,b.ymin),h=t.getContainingTileCoords,v=c.length;for(g=0;v>g;g++)e=c[g],b=h(a,r,e),e.startTileRow=0>b.row?0:b.row,e.startTileCol=0>b.col?0:b.col,b=h(a,q,e),e.endTileRow=b.row,e.endTileCol=b.col,n&&-1===d.indexOf(n,e.level)||(f[g]=e.scale,k=e.scale>k?e.scale:k,m=e.scale<m?e.scale:m);k===-(1/0)||this._hasMin||this.setMinScale(k);m===1/0||this._hasMax||this.setMaxScale(m);this.setExclusionAreas(this.exclusionAreas);this._patchIE=6<=u("ie")&&7>u("ie")&&(this.isPNG32||"Mixed"===a.format)},
isVisibleAtScale:function(a){return a?z.prototype._isMapAtVisibleScale.call(this,a,!0):!1},_isMapAtVisibleScale:function(a){var c=this.inherited(arguments,[a,!0]);if(c){var b;b=this._map;var c=this.scales,e=b.getScale(),d=!1,g=b.width>b.height?b.width:b.height;for(b=0;b<c.length;b++)if(Math.abs(c[b]-e)/c[b]<1/g){d=!0;break}c=d}return c},_setMap:function(a,c,b,e){this.inherited(arguments);this._map=a;var d=this._div=f.create("div",null,c),n=a.__visibleDelta,k=l.connect,m=q._css.names,h={position:"absolute",
width:a.width+"px",height:a.height+"px",overflow:"visible"},u=r.defaults.map.zoomDuration;"css-transforms"===a.navigationMode?(h[m.transform]=q._css.translate(-n.x,-n.y),g.set(d,h),delete h[m.transform],h[m.transition]=m.transformName+" "+u+"ms ease",g.set(this._active=f.create("div",null,d),h),this._active._remove=0,this._passives=[]):(h.left=-n.x+"px",h.top=-n.y+"px",g.set(d,h));this._onResizeHandler_connect=k(a,"onResize",this,"_onResizeHandler");this._opacityChangeHandler_connect=k(this,"onOpacityChange",
this,"_opacityChangeHandler");n=this.tileInfo;k=n.spatialReference;m=k._getInfo();if(this._wrap=a.wrapAround180&&k._isWrappable()&&Math.abs(m.origin[0]-n.origin.x)<=m.dx,this._wrap&&t._addFrameInfo(n,m),this.setExclusionAreas(this.exclusionAreas),this.evaluateSuspension(),this.suspended&&!a.loaded)var v=l.connect(a,"onLoad",this,function(){l.disconnect(v);v=null;this.setExclusionAreas(this.exclusionAreas);this.evaluateSuspension()});return d},_unsetMap:function(a,c){this.suspended||this._suspendImpl();
f.destroy(this._div);this._map=this._div=null;var b=l.disconnect;b(this._onResizeHandler_connect);b(this._opacityChangeHandler_connect);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._suspendImpl()},_suspendImpl:function(){v.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();var a,c,b,e=this._tiles,d=this._tileIds;c=this._loadingList;var g=l.disconnect,n=f.destroy;c&&0<c.count&&(c.forEach(function(c){(a=e[c])&&(g(a._onload_connect),
g(a._onerror_connect),g(a._onabort_connect),a._onload_connect=a._onerror_connect=a._onabort_connect=null)}),c.clear(),this._fireUpdateEnd());this._removeList.clear();for(c=d.length-1;0<=c;c--)(a=(b=d[c])&&e[b])&&n(a);if("css-transforms"===this._map.navigationMode){b=this._active;var k=this._passives;this._noDom=0;for(c=k.length-1;0<=c;c--)d=k[c],d._endHandle&&g(d._endHandle),d._matrix=d._multiply=d._endHandle=null,d._marked=d._remove=0,k.splice(c,1),n(d);b._matrix=b._multiply=null;b._marked=b._remove=
0}this._tileIds=this._tiles=this._tileBounds=this._ct=this._loadingList=this._removeList=this._standby=null},onResume:function(){this.inherited(arguments);this._tileIds=[];this._tiles=[];this._tileBounds=[];this._ct=null;this._removeList=new c;this._loadingList=new c;v.show(this._div);this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(a.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD)}),0)},_enableDrawConnectors:function(){var a=
this._map,c=l.connect;if("css-transforms"===a.navigationMode){if(this._onScaleHandler_connect=c(a,"onScale",this,this._onScaleHandler),u("esri-mobile")){this._standby=[];var b=this,e=function(){b._noDom=1};this._onPanStartHandler_connect=c(a,"onPanStart",e);this._onZoomStartHandler_connect=c(a,"onZoomStart",e)}}else this._onZoomHandler_connect=c(a,"onZoom",this,"_onZoomHandler");this._onPanHandler_connect=c(a,"onPan",this,"_onPanHandler");this._onExtentChangeHandler_connect=c(a,"onExtentChange",this,
"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=l.disconnect;a(this._onPanHandler_connect);a(this._onZoomHandler_connect);a(this._onScaleHandler_connect);a(this._onExtentChangeHandler_connect);a(this._onPanStartHandler_connect);a(this._onZoomStartHandler_connect);this._onPanHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=this._onExtentChangeHandler_connect=this._onPanStartHandler_connect=this._onZoomStartHandler_connect=null},_onResizeHandler:function(a,
c,b){c={width:c+"px",height:b+"px"};b=g.set;if(b(this._div,c),"css-transforms"===this._map.navigationMode)for(this._active&&b(this._active,c),a=this._passives.length-1;0<=a;a--)b(this._passives[a],c)},_onExtentChangeHandler:function(a,c,b,e){var d,k;c=this._map;var r=this._standby;if(clearTimeout(this._wakeTimer),this._wakeTimer=null,!c._isPanningOrZooming()){if("css-transforms"===c.navigationMode){if(b)for(e=this._passives.length-1;0<=e;e--)k=this._passives[e],g.set(k,q._css.names.transition,"none"),
k._marked?(this._passives.splice(e,1),k.parentNode&&k.parentNode.removeChild(k),f.destroy(k)):0<k.childNodes.length&&(k._multiply=k._multiply?n.multiply(k._matrix,k._multiply):k._matrix);if(this._noDom=0,r&&r.length)for(e=r.length-1;0<=e;e--)d=r[e],g.set(d,"visibility","inherit"),this._popTile(d),r.splice(e,1)}this._fireUpdateStart();this._rrIndex=0;e=t.getCandidateTileInfo(c,this.tileInfo,a);a=c.__visibleDelta;if(!this._ct||e.lod.level!==this._ct.lod.level||b){r=e&&this._ct&&e.lod.level!==this._ct.lod.level;
this._ct=e;var h,u=this._tiles,v=this._tileIds,l=this._tileBounds,w=this._removeList,y=v.length;this._cleanUpRemovedImages();for(e=0;y>e;e++)k=v[e],h=u[k],l[k]=v[e]=null,"css-transforms"===c.navigationMode&&r&&h.parentNode&&c.fadeOnZoom&&(h._fadeOut=r,h.parentNode._remove++),w.add(h);b&&(this._tileIds=[],this._tiles=[],this._tileBounds=[])}b=a.x;e=a.y;"css-transforms"===c.navigationMode?(k={},k[q._css.names.transform]=q._css.translate(b,e),g.set(this._div,k)):g.set(this._div,{left:b+"px",top:e+"px"});
this.__coords_dx=b;this.__coords_dy=e;this._updateImages(new x(0,0,a.width,a.height));0===this._loadingList.count?(this._cleanUpRemovedImages(),this.onUpdate(),this._fireUpdateEnd()):this._fireOnUpdate=!0;var z,Q;b=this._tileW;r=this._tileH;a=new x(-a.x,-a.y,a.width,a.height);for(e=this._tileIds.length-1;0<=e;e--)(k=this._tileIds[e])?(d=this._tiles[k],z=m.getMarginBox(d),Q=new x(z.l,z.t,b,r),"css-transforms"===c.navigationMode&&(Q.x=d._left,Q.y=d._top),a.intersects(Q)?this._tileBounds[k]=Q:(this._loadingList.contains(k)&&
this._popTile(d),f.destroy(d),this._tileIds.splice(e,1),delete this._tileBounds[k],delete this._tiles[k])):(this._tileIds.splice(e,1),delete this._tileBounds[k],delete this._tiles[k])}},_onPanHandler:function(a,c){var b=this._map,e=b.__visibleDelta.offset(c.x,c.y);(this.__coords_dx=this.__coords_dy=0,"css-transforms"===b.navigationMode)?(b={},b[q._css.names.transform]=q._css.translate(e.x,e.y),g.set(this._div,b),u("esri-mobile")||this._updateImages({x:-e.x,y:-e.y,width:e.width,height:e.height})):
(g.set(this._div,{left:e.x+"px",top:e.y+"px"}),this._updateImages({x:-e.x,y:-e.y,width:e.width,height:e.height}));0<this._loadingList.count&&(this._fireUpdateStart(),this._fireOnUpdate=!0)},_onScaleHandler:function(a,c){var b,e={},d=q._css.names,k=this._map,m=r.defaults.map.zoomDuration;for(b=this._passives.length-1;0<=b;b--){var t=this._passives[b];0===t.childNodes.length?(this._passives.splice(b,1),f.destroy(t)):("none"===t.style[d.transition]&&g.set(t,d.transition,d.transformName+" "+m+"ms ease"),
g.set(t,d.transition,c?"none":d.transformName+" "+m+"ms ease"),t._matrix=a,e[d.transform]=q._css.matrix(t._multiply?n.multiply(a,t._multiply):a),g.set(t,e))}this._active&&0===this._active.childNodes.length||(g.set(this._active,d.transition,c?"none":d.transformName+" "+m+"ms ease"),this._active._matrix=a,e[d.transform]=q._css.matrix(this._active._matrix),g.set(this._active,e),this._passives.push(this._active),e={position:"absolute",width:k.width+"px",height:k.height+"px",overflow:"visible"},e[d.transition]=
d.transformName+" "+m+"ms ease",g.set(this._active=f.create("div",null,this._div),e),this._active._remove=0,k.fadeOnZoom&&f.place(this._active,this._div,"first"))},_onZoomHandler:function(a,c,b){a=m.getMarginBox(this._div);b=b.offset(-a.l,-a.t);this._previousScale&&1!==c||(this._previousScale=1);var e,f,k,n=this._tileW*c,t=this._tileH*c,r=this._tileBounds,q=this._tiles,h=this._previousScale,v=this._multiple,l=g.set;if((a=u("ie"))&&8>a)d.forEach(this._tileIds,function(a){k="";e=r[a];f=q[a].style.margin.split(" ");
d.forEach(f,function(a){""!==k&&(k+=" ");a=parseFloat(a);k+=a/h*c+"px"});l(q[a],{left:e.x-(n-e.width)*(b.x-e.x)/e.width+"px",top:e.y-(t-e.height)*(b.y-e.y)/e.height+"px",margin:1!==v&&-1===k.indexOf("NaN")?k:"",zoom:c})});else{var w,x,y=n*v,z=t*v;d.forEach(this._tileIds,function(a){k="";e=r[a];w=e.x-(n-e.width)*(b.x-e.x)/e.width;x=e.y-(t-e.height)*(b.y-e.y)/e.height;f=q[a].style.margin.split(" ");d.forEach(f,function(a){""!==k&&(k+=" ");a=parseFloat(a);k+=a/h*c+"px"});l(q[a],{left:w+"px",top:x+"px",
margin:1!==v&&-1===k.indexOf("NaN")?k:"",width:y+"px",height:z+"px"})})}this._previousScale=c},_updateImages:function(a){if(this._ct){var c,b,e,g,f,k,n,m,t=this._tileW,r=this._tileH,q=this._ct;e=q.lod;var q=q.tile,h=q.offsets,u=q.coords,v=u.row,u=u.col,l=e.level,w=this.opacity,x=this._tileIds,y=this._loadingList,z=this._addImage,W=this._map.id,fa=this.id,ea=a.x,oa=a.y,pa=e.startTileRow,Aa=e.endTileRow,ta=e.startTileCol,va=e.endTileCol,ua=d.indexOf,qa=h.x-this.__coords_dx,ca=h.y-this.__coords_dy;m=
t-qa+-a.x;var ja=r-ca+-a.y;n=Math.ceil;m=0<m?m%t:t-Math.abs(m)%t;ja=0<ja?ja%r:r-Math.abs(ja)%r;ea=0<ea?Math.floor((ea+qa)/t):n((ea-(t-qa))/t);oa=0<oa?Math.floor((oa+ca)/r):n((oa-(r-ca))/r);ca=ea+n((a.width-m)/t);a=oa+n((a.height-ja)/r);this._wrap&&(b=e._frameInfo,g=b[0],f=b[1],k=b[2]);for(n=ea;ca>=n;n++)for(m=oa;a>=m;m++)b=v+m,e=u+n,this._wrap&&(f>e?(e%=g,e=f>e?e+g:e):e>k&&(e%=g)),!this._isExcluded(l,b,e)&&b>=pa&&Aa>=b&&e>=ta&&va>=e&&(c=W+"_"+fa+"_tile_"+l+"_"+m+"_"+n,-1===ua(x,c)&&(y.add(c),x.push(c),
z(l,m,b,n,e,c,t,r,w,q,h)))}},_cleanUpRemovedImages:function(){var a,c=this._removeList,b=f.destroy,e=q._css.names;if(c.forEach(function(a){a._fadeOut||(a.style.filter="",a.style.zoom=1,b(a))}),"css-transforms"===this._map.navigationMode)for(a=this._passives.length-1;0<=a;a--){var d=this._passives[a];0===d.childNodes.length?(this._passives.splice(a,1),b(d)):this._map.fadeOnZoom&&!d._marked&&d._remove===d.childNodes.length&&(d._marked=1,2048>q._css.getScaleFromMatrix(g.get(d,e.transform))?(g.set(d,
e.transition,"opacity 0.65s"),g.set(d,"opacity",0),l.disconnect(d._endHandle),d._endHandle=l.connect(d,e.endEvent,this._transitionEnd)):this._transitionEnd({propertyName:"opacity",target:d}))}c.clear()},_transitionEnd:function(a){var c,b=a.target;"opacity"===a.propertyName&&(l.disconnect(b._endHandle),b._endHandle=null,c=d.indexOf(this._passives,b),-1<c&&this._passives.splice(c,1),b.parentNode&&b.parentNode.removeChild(b),f.destroy(b))},_addImage:function(c,b,e,d,n,m,t,r,h,u,v){if(this._patchIE)u=
this._tiles[m]=f.create("div"),u.id=m,k.add(u,"layerTile"),g.set(u,{left:t*d-v.x+"px",top:r*b-v.y+"px",width:t+"px",height:r+"px",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this.getTileUrl(c,e,n)+"', sizingMethod\x3d'scale')"}),1>h&&g.set(u,"opacity",h),c=u.appendChild(f.create("div")),g.set(c,{opacity:0,width:t+"px",height:r+"px"}),this._div.appendChild(u),this._loadingList.remove(m),this._fireOnUpdateEvent();else{u=this._tiles[m]=f.create("img");var w=l.connect;u.id=m;
u._uid=c+"_"+e+"_"+n;u.alt="";k.add(u,"layerTile");d=t*d-v.x;v=r*b-v.y;b=this._map;var x=q._css.names;t={width:t+"px",height:r+"px",visibility:"hidden"};("css-transforms"===b.navigationMode?(t[x.transform]=q._css.translate(d,v),g.set(u,t),u._left=d,u._top=v):(t.left=d+"px",t.top=v+"px",g.set(u,t)),1>h&&g.set(u,"opacity",h),u._onload_connect=w(u,"onload",this,"_tileLoadHandler"),u._onerror_connect=w(u,"onerror",a.hitch(this,"_tileErrorHandler",e,n)),u._onabort_connect=w(u,"onabort",this,"_tileAbortHandler"),
this.tileMap)?this.tileMap.getTile(c,e,n,m,this._tileMapCallback):(m=this.getTileUrl(c,e,n,u))&&(this._failedRequests&&this._failedRequests[m]?(g.set(u,this._failedRequests[m].css),u.src=this._failedRequests[m].src,this._multiple=parseInt(this._failedRequests[m].css.width)/this._tileW,this.isResampling=1!==this._multiple):(this._multiple=1,this.isResampling=!1,u.src=m));"css-transforms"===b.navigationMode?this._active.appendChild(u):this._div.appendChild(u)}},_tileMapCallback:function(a,c){var b,
d;if(!this.suspended){d=this._tiles[c.id]||e.byId(c.id);var f=c.level+"_"+c.row+"_"+c.col;d&&d._uid===f?(this._multiple=2*(c.level-a.level)||1,this.isResampling=1!==this._multiple,b=this.tileMap.style(a,c),g.set(d,b),d.src=this.getTileUrl(a.level,a.row,a.col)):this._popTile(c)}},getTileUrl:function(a,c,b){},_reCheckTS:/[\?\&]_ts=/gi,_reReplaceTS:/([\?\&]_ts=)[0-9]+/gi,addTimestampToURL:function(a){var c=this._refreshTS;return c&&(this._reCheckTS.test(a)?a=a.replace(this._reReplaceTS,"$$$1"+c):a+=
(-1===a.indexOf("?")?"?":"\x26")+"_ts\x3d"+c),a},refresh:function(){this.suspended||(this._refreshTS=(new Date).getTime(),this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD))},_popTile:function(a){var c=l.disconnect;c(a._onload_connect);c(a._onerror_connect);c(a._onabort_connect);a._onload_connect=a._onerror_connect=a._onabort_connect=null;this._loadingList.remove(a.id);this._fireOnUpdateEvent()},_tileLoadHandler:function(a){a=a.currentTarget;return this._noDom?void this._standby.push(a):
(g.set(a,"visibility","inherit"),void this._popTile(a))},_tileAbortHandler:function(a){a=a.currentTarget;this.onError(Error("Unable to load tile: "+a.src));g.set(a,"visibility","hidden");this._popTile(a)},_tileErrorHandler:function(a,c,e){var d,f,k,n;e=e.currentTarget;var m=!0;this.tileMap||!this.resampling?m=!1:(d=new b(e.src),f=d.path.split("/"),k=parseInt(f[f.length-3]),n=this._ct.lod.level-k+1,this._multiple=Math.pow(2,n),(k===this._lowestLevel||0===this._resamplingTolerance||this._resamplingTolerance&&
Math.log(this._multiple)/Math.LN2>this._resamplingTolerance)&&(m=!1));m?(this.isResampling=!0,this._resample(e,a,c)):(this.onError(Error("Unable to load tile: "+e.src)),g.set(e,"visibility","hidden"),this._popTile(e))},_resample:function(a,c,e){var d=(new b(a.src)).path.split("/"),f=this._multiple,k=parseInt(d[d.length-3])-1,n=parseInt(c/f),m=parseInt(e/f),d=e%f,t=c%f,n=this.getTileUrl(k,n,m);c=this.getTileUrl(k+Math.log(f)/Math.LN2,c,e);f={width:this._tileW*f+"px",height:this._tileH*f+"px",margin:"-"+
this._tileW*t+"px 0 0 "+("-"+this._tileH*d+"px")};this._failedRequests||(this._failedRequests={});this._failedRequests[c]={src:n,css:f};g.set(a,f);u("chrome")&&a.setAttribute("src",null);a.src=n},_fireOnUpdateEvent:function(){0===this._loadingList.count&&(this._cleanUpRemovedImages(),this._fireOnUpdate&&(this._fireOnUpdate=!1,this.onUpdate(),this._fireUpdateEnd()))},setOpacity:function(a){this.opacity!=a&&this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_opacityChangeHandler:function(a){var c,
b,e,d=g.set;if("css-transforms"!==this._map.navigationMode)for(e=this._div.childNodes,c=e.length-1;0<=c;c--)d(e[c],"opacity",a);else{if(this._active)for(e=this._active.childNodes,c=e.length-1;0<=c;c--)d(e[c],"opacity",a);for(c=this._passives.length-1;0<=c;c--)for(e=this._passives[c].childNodes,b=e.length-1;0<=b;b--)d(e[b],"opacity",a)}},setExclusionAreas:function(a){if(this.exclusionAreas=a,this.loaded&&this._map&&this._map.loaded){var c,b,e,d,g,f,k,n,m,t,r,q,h,u=this._map.spatialReference,v=this.tileInfo,
l=v.origin,x=v.lods,z=x[0].level,U=x[x.length-1].level;if(this.exclusionAreas&&this.exclusionAreas.length)for(this._exclusionsPerZoom=[],b=0,e=a.length;e>b;b++){if(c=a[b],r=c.geometry,r&&"extent"===r.type&&r.xmin<=r.xmax&&r.ymin<=r.ymax){if(!u.equals(r.spatialReference)){if(!u._canProject(r.spatialReference))continue;u.isWebMercator()?(q=w.lngLatToXY(r.xmin,r.ymin),h=w.lngLatToXY(r.xmax,r.ymax)):(q=w.xyToLngLat(r.xmin,r.ymin,!0),h=w.xyToLngLat(r.xmax,r.ymax,!0));r=new y(q[0],q[1],h[0],h[1],u)}if(f=
-1,c.minZoom&&-1!==c.minZoom)f=c.minZoom;else if(c.minScale&&-1!==c.minScale)for(d=0,g=x.length;g>d;d++)if(x[d].scale<=c.minScale){f=x[d].level;break}if(f=Math.max(f,z),n=-1,c.maxZoom&&-1!==c.maxZoom)n=c.maxZoom;else if(c.maxScale&&-1!==c.maxScale)for(d=0,g=x.length;g>d;d++){if(x[d].scale<c.maxScale){n=x[d-1].level;break}if(x[d].scale===c.maxScale){n=x[d].level;break}}for(n=-1===n?U:Math.min(n,U);n>=f;f++){d=0;for(g=x.length;g>d;d++)if(x[d].level===f){k=x[d];break}k&&(this._exclusionsPerZoom[f]||
(this._exclusionsPerZoom[f]=[]),m=1/k.resolution/v.rows,t=1/k.resolution/v.cols,this._exclusionsPerZoom[f].push({rowFrom:Math.floor((l.y-r.ymax)*m),rowTo:Math.ceil((l.y-r.ymin)*m),colFrom:Math.floor((r.xmin-l.x)*t),colTo:Math.ceil((r.xmax-l.x)*t)}))}}}else this._exclusionsPerZoom=null;this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD)}},_isExcluded:function(a,c,b){var e,d,g;if(!this._exclusionsPerZoom||(d=this._exclusionsPerZoom[a],!d))return!1;a=0;for(g=d.length;g>
a;a++)if(e=d[a],c>=e.rowFrom&&c<e.rowTo&&b>=e.colFrom&&b<e.colTo)return!0;return!1}});return u("extend-esri")&&a.setObject("layers.TiledMapServiceLayer",h,q),h})},"dojox/collections/ArrayList":function(){define(["dojo/_base/kernel","dojo/_base/array","./_base"],function(h,l,a){a.ArrayList=function(d){var b=[];d&&(b=b.concat(d));this.count=b.length;this.add=function(a){b.push(a);this.count=b.length};this.addRange=function(a){if(a.getIterator)for(a=a.getIterator();!a.atEnd();)this.add(a.get());else for(var d=
0;d<a.length;d++)b.push(a[d]);this.count=b.length};this.clear=function(){b.splice(0,b.length);this.count=0};this.clone=function(){return new a.ArrayList(b)};this.contains=function(a){for(var d=0;d<b.length;d++)if(b[d]==a)return!0;return!1};this.forEach=function(a,d){h.forEach(b,a,d)};this.getIterator=function(){return new a.Iterator(b)};this.indexOf=function(a){for(var d=0;d<b.length;d++)if(b[d]==a)return d;return-1};this.insert=function(a,d){b.splice(a,0,d);this.count=b.length};this.item=function(a){return b[a]};
this.remove=function(a){a=this.indexOf(a);0<=a&&b.splice(a,1);this.count=b.length};this.removeAt=function(a){b.splice(a,1);this.count=b.length};this.reverse=function(){b.reverse()};this.sort=function(a){a?b.sort(a):b.sort()};this.setByIndex=function(a,d){b[a]=d;this.count=b.length};this.toArray=function(){return[].concat(b)};this.toString=function(a){return b.join(a||",")}};return a.ArrayList})},"dojox/collections/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array"],
function(h,l,a){h=l.getObject("dojox.collections",!0);h.DictionaryEntry=function(a,b){this.key=a;this.value=b;this.valueOf=function(){return this.value};this.toString=function(){return String(this.value)}};h.Iterator=function(d){var b=0;this.element=d[b]||null;this.atEnd=function(){return b>=d.length};this.get=function(){return this.atEnd()?null:this.element=d[b++]};this.map=function(b,k){return a.map(d,b,k)};this.reset=function(){b=0;this.element=d[b]}};h.DictionaryIterator=function(d){var b=[],
f={},k;for(k in d)f[k]||b.push(d[k]);var m=0;this.element=b[m]||null;this.atEnd=function(){return m>=b.length};this.get=function(){return this.atEnd()?null:this.element=b[m++]};this.map=function(d,e){return a.map(b,d,e)};this.reset=function(){m=0;this.element=b[m]}};return h})},"esri/layers/ArcGISMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../request ../SpatialReference ../geometry/Extent ./LayerInfo".split(" "),function(h,l,a,
d,b,f,k,m,g,e){h=h(null,{declaredClass:"esri.layers.ArcGISMapServiceLayer",infoTemplates:null,constructor:function(a,b){this.layerInfos=[];b&&(this.infoTemplates=b.infoTemplates||null);var e=this._params={},d=this._url.query?this._url.query.token:null;d&&(e.token=d)},setInfoTemplates:function(a){this.infoTemplates=a},_load:function(){k({url:this._url.path,content:l.mixin({f:"json"},this._params),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler})},spatialReference:null,initialExtent:null,
fullExtent:null,description:null,units:null,_initLayer:function(c,b){try{this._findCredential();(this.credential&&this.credential.ssl||c&&c._ssl)&&this._useSSL();this.description=c.description;this.copyright=c.copyrightText;this.spatialReference=c.spatialReference&&new m(c.spatialReference);this.initialExtent=c.initialExtent&&new g(c.initialExtent);this.fullExtent=c.fullExtent&&new g(c.fullExtent);this.units=c.units;this.maxRecordCount=c.maxRecordCount;this.maxImageHeight=c.maxImageHeight;this.maxImageWidth=
c.maxImageWidth;this.supportsDynamicLayers=c.supportsDynamicLayers;var d=this.layerInfos=[],k=c.layers,h=this._defaultVisibleLayers=[];(a.forEach(k,function(a,c){d[c]=new e(a);a.defaultVisibility&&h.push(a.id)}),this.visibleLayers||(this.visibleLayers=h),this.version=c.currentVersion,this.version)||(this.version="capabilities"in c||"tables"in c?10:"supportedImageFormatTypes"in c?9.31:9.3);this.capabilities=c.capabilities;f.isDefined(c.minScale)&&!this._hasMin&&this.setMinScale(c.minScale);f.isDefined(c.maxScale)&&
!this._hasMax&&this.setMaxScale(c.maxScale)}catch(v){this._errorHandler(v)}}});return d("extend-esri")&&l.setObject("layers.ArcGISMapServiceLayer",h,b),h})},"esri/layers/LayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(h,l,a,d,b){h=h(null,{declaredClass:"esri.layers.LayerInfo",constructor:function(a){l.mixin(this,a)},toJson:function(){return b.fixJson({defaultVisibility:this.defaultVisibility,id:this.id,maxScale:this.maxScale,minScale:this.minScale,
name:this.name,parentLayerId:this.parentLayerId,subLayerIds:this.subLayerIds})}});return a("extend-esri")&&l.setObject("layers.LayerInfo",h,d),h})},"esri/layers/TimeInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../TimeExtent ./TimeReference ./LayerTimeOptions".split(" "),function(h,l,a,d,b,f,k){h=h(null,{declaredClass:"esri.layers.TimeInfo",constructor:function(a){null!==a&&(l.mixin(this,a),a.exportOptions&&(this.exportOptions=new k(a.exportOptions)),this.timeExtent=
null,a.timeExtent&&2===a.timeExtent.length&&(this.timeExtent=new b(a.timeExtent)),this.timeReference=new f(a.timeReference))}});return l.mixin(h,{UNIT_CENTURIES:"esriTimeUnitsCenturies",UNIT_DAYS:"esriTimeUnitsDays",UNIT_DECADES:"esriTimeUnitsDecades",UNIT_HOURS:"esriTimeUnitsHours",UNIT_MILLISECONDS:"esriTimeUnitsMilliseconds",UNIT_MINUTES:"esriTimeUnitsMinutes",UNIT_MONTHS:"esriTimeUnitsMonths",UNIT_SECONDS:"esriTimeUnitsSeconds",UNIT_UNKNOWN:"esriTimeUnitsUnknown",UNIT_WEEKS:"esriTimeUnitsWeeks",
UNIT_YEARS:"esriTimeUnitsYears"}),a("extend-esri")&&l.setObject("layers.TimeInfo",h,d),h})},"esri/TimeExtent":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel"],function(h,l,a,d){var b=h(null,{declaredClass:"esri.TimeExtent",constructor:function(a){if(1<arguments.length)this._create(arguments[0],arguments[1]);else if(a)if(l.isArray(a)){var b=a[0],d=a[1];this.startTime=null===b||"null"===b?null:new Date(b);this.endTime=null===d||"null"===d?null:new Date(d)}else a instanceof
Date&&this._create(a,null)},offset:function(a,d){var m=new b,g=this.startTime,e=this.endTime;return g&&(m.startTime=this._getOffsettedDate(g,a,d)),e&&(m.endTime=this._getOffsettedDate(e,a,d)),m},intersection:function(a){return this._intersection(this,a)},toJson:function(){var a=[],b=this.startTime;a.push(b?b.getTime():"null");b=this.endTime;return a.push(b?b.getTime():"null"),a},_create:function(a,b){this.startTime=a?new Date(a.getTime()):null;this.endTime=b?new Date(b.getTime()):null},_refData:{esriTimeUnitsMilliseconds:{getter:"getUTCMilliseconds",
setter:"setUTCMilliseconds",multiplier:1},esriTimeUnitsSeconds:{getter:"getUTCSeconds",setter:"setUTCSeconds",multiplier:1},esriTimeUnitsMinutes:{getter:"getUTCMinutes",setter:"setUTCMinutes",multiplier:1},esriTimeUnitsHours:{getter:"getUTCHours",setter:"setUTCHours",multiplier:1},esriTimeUnitsDays:{getter:"getUTCDate",setter:"setUTCDate",multiplier:1},esriTimeUnitsWeeks:{getter:"getUTCDate",setter:"setUTCDate",multiplier:7},esriTimeUnitsMonths:{getter:"getUTCMonth",setter:"setUTCMonth",multiplier:1},
esriTimeUnitsYears:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:1},esriTimeUnitsDecades:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:10},esriTimeUnitsCenturies:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:100}},_intersection:function(a,d){if(a&&d){var m=a.startTime,g=a.endTime,e=d.startTime,c=d.endTime,m=m?m.getTime():-(1/0),e=e?e.getTime():-(1/0),g=g?g.getTime():1/0,c=c?c.getTime():1/0,n,q;if(e>=m&&g>=e?n=e:m>=e&&c>=m&&(n=m),g>=e&&c>=g?q=g:c>=m&&g>=c&&
(q=c),isNaN(n)||isNaN(q))return null;m=new b;return m.startTime=n===-(1/0)?null:new Date(n),m.endTime=q===1/0?null:new Date(q),m}return null},_getOffsettedDate:function(a,b,d){var g=this._refData;a=new Date(a.getTime());return b&&d&&(g=g[d],a[g.setter](a[g.getter]()+b*g.multiplier)),a}});return a("extend-esri")&&(d.TimeExtent=b),b})},"esri/layers/TimeReference":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.layers.TimeReference",
constructor:function(a){a&&l.mixin(this,a)}});return a("extend-esri")&&l.setObject("layers.TimeReference",h,d),h})},"esri/layers/LayerTimeOptions":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(h,l,a,d,b){h=h(null,{declaredClass:"esri.layers.LayerTimeOptions",constructor:function(a){a&&l.mixin(this,a)},toJson:function(){return b.fixJson({timeDataCumulative:this.timeDataCumulative,timeOffset:this.timeOffset,timeOffsetUnits:this.timeOffsetUnits,
useTime:this.useTime})}});return a("extend-esri")&&l.setObject("layers.LayerTimeOptions",h,d),h})},"esri/layers/TileMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/io-query ../request ../urlUtils ../sniff".split(" "),function(h,l,a,d,b,f,k,m){var g=m("esri-iphone");return h(null,{declaredClass:"esri.layers.TileMap",constructor:function(a){this.layer=a;this._tileMaps={}},getTile:function(a,c,b,d,g){a={id:d,level:a,row:c,col:b};c=this._getResamplingBudget();
0<c?this._process({tile:a,requestedTile:a,callback:g,resamplingBudget:c}):(g||this.callback).call(this,a,a)},statusOf:function(a,c,b){var d,g=this._getResamplingBudget();a={level:a,row:c,col:b};if(0===g)return 1;for(;0<=g;){if((d=this._tileToTileMap(a),!this._tileMaps[d.uid])||(d=this._tileMaps[d.uid],!d.promise.isFulfilled()))return-1;if(this._isTileAvailable(a,d))return 1;if(a=this._parentTile(a),!a)break;g--}return 0},style:function(a,c){if(a.level!==c.level||a.row!==c.row||a.col!==c.col){for(var b,
d,f=this.layer.tileInfo,k=f.lods,m=f.cols,f=f.rows,t=k.length-1;!b||!d;)b||k[t].level!==a.level||(b=k[t]),d||k[t].level!==c.level||(d=k[t]),t--;d=Math.round(b.resolution/d.resolution);k=c.col%d*-1*m;b=c.row%d*-1*f;d={width:m*d+"px",height:f*d+"px",margin:b+"px 0 0 "+k+"px","will-change":"transform"};g&&(k=0===k?0:-1*k,b=0===b?0:-1*b,d.clip="rect("+b+"px,"+(k+m)+"px,"+(b+f)+"px,"+k+"px)");return d}},_process:function(a){var c=a.tile,b=this._tileToTileMap(c),d=this._parentTile(c);this._getTileMap(b).then(l.hitch(this,
function(g){b=g;this._isTileAvailable(c,b)?(a.callback||this.callback).call(this,c,a.requestedTile):0<a.resamplingBudget&&d?(a.resamplingBudget--,a.tile=d,this._process(a)):(a.callback||this.callback).call(this,a.requestedTile,a.requestedTile)}),l.hitch(this,function(){(a.callback||this.callback).call(this,a.requestedTile,a.requestedTile)}))},_getTileMap:function(a){var c,b,g,k,m=null;return this._tileMaps[a.uid]?(a=this._tileMaps[a.uid],c=a.promise):(this._tileMaps[a.uid]=a,b=new d,f({url:this._getTileMapUrl(a.level,
a.row,a.col),handleAs:"json",callbackParamName:"callback",timeout:3E3,load:function(c){if(l.mixin(a,c),a.data&&0<a.data.length){if(k=a.data.length,1===k)m=a.data[0];else for(m=a.data[0],g=1;k>g;g++)if(a.data[g]!==m){m=null;break}null!==m&&(delete a.data,a.value=m)}b.resolve(a)},error:function(a){b.reject()}}),c=a.promise=b.promise),c},_parentTile:function(b){var c,d,g,f=this.layer.tileInfo.lods,k=null;return a.some(f,function(a,g){return b.level===a.level?(c=a,d=g,!0):!1}),0<d&&(g=f[d-1],k={id:b.id,
level:g.level,row:Math.floor(b.row*c.resolution/g.resolution+.01),col:Math.floor(b.col*c.resolution/g.resolution+.01)}),k},_tileToTileMap:function(a){var c=8*Math.floor(a.row/8),b=8*Math.floor(a.col/8);return{uid:a.level+"_"+c+"_"+b,level:a.level,row:c,col:b}},_isTileAvailable:function(a,c){var b,d,g;return c.valid?void 0!==c.value?g=c.value:(b=c.location.left,d=c.location.top,g=(a.row-d)*c.location.width+(a.col-b),g=g<c.data.length?c.data[g]:0):g=0,g},_getTileMapUrl:function(a,c,d){var g=this.layer,
f=g.tileServers,k=g._getToken(),m=g._url.query;a=(f?f[c%f.length]:g._url.path)+"/tilemap/"+a+"/"+c+"/"+d+"/8/8";return m&&(a+="?"+b.objectToQuery(m)),!k||m&&m.token||(a+=(-1===a.indexOf("?")?"?":"\x26")+"token\x3d"+k),g.addTimestampToURL(a)},_getResamplingBudget:function(){var a=this.layer,c=0;return a.resampling&&(c=a._resamplingTolerance,(null===c||void 0===c)&&(c=a.tileInfo.lods.length)),c}})})},"esri/layers/MapImageLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style ../kernel ../config ../sniff ../domUtils ../geometry/Point ../geometry/webMercatorUtils ./layer".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q){var r=h([q],{declaredClass:"esri.layers.MapImageLayer","-chains-":{constructor:"manual"},constructor:function(c){this.inherited(arguments,[null,c]);this._mapImages=[];var b=a.hitch;this._panStart=b(this,this._panStart);this._pan=b(this,this._pan);this._extentChange=b(this,this._extentChange);this._zoom=b(this,this._zoom);this._zoomStart=b(this,this._zoomStart);this._scale=b(this,this._scale);this._resize=b(this,this._resize);l.connect(this,"onSuspend",this,this._onSuspend);
l.connect(this,"onResume",this,this._onResume);this.loaded=!0;this.onLoad(this)},opacity:1,addImage:function(a){var c=this._mapImages.push(a);--c;a._idx=c;a._layer=this;this._div&&this._createImage(a,c)},removeImage:function(a){if(a){var c=a._idx,e=this._mapImages;e[c]===a&&(delete e[c],(c=a._node)&&(this._clearEvents(c),c.e_idx=c.e_bl=c.e_tr=c.e_l=c.e_t=c.e_w=c.e_h=null,c.parentNode&&(c.parentNode.removeChild(c),b.destroy(c))),a._node=a._idx=a._layer=null)}},removeAllImages:function(){var a,c=this._mapImages,
b=c.length;for(a=0;b>a;a++){var e=c[a];e&&this.removeImage(e)}this._mapImages=[]},getImages:function(){var a,c=this._mapImages,b=[],e=c.length;for(a=0;e>a;a++)c[a]&&b.push(c[a]);return b},setOpacity:function(a){this.opacity!=a&&(this._opacityChanged(this.opacity=a),this.onOpacityChange())},onOpacityChange:function(){},_opacityChanged:function(a){var c,b,e;if(c=this._div)if(!g("ie")||8<g("ie"))f.set(c,"opacity",a);else for(e=c.childNodes,b=e.length,c=0;b>c;c++)f.set(e[c],"opacity",a)},_createImage:function(a,
c){var e=b.create("img");f.set(e,{position:"absolute"});1>a.opacity?f.set(e,"opacity",a.opacity):8>=g("ie")&&f.set(e,"opacity",this.opacity);a.rotation&&(9>g("ie")||f.set(e,k._css.names.transform,k._css.rotate(360-a.rotation)));a._node=e;e.e_idx=c;e.e_layer=this;e.e_load=l.connect(e,"onload",r.prototype._imageLoaded);e.e_error=l.connect(e,"onerror",r.prototype._imageError);e.e_abort=l.connect(e,"onabort",r.prototype._imageError);e.src=a.href},_imageLoaded:function(a,c){var b=c||a.target||a.currentTarget,
e=b.e_layer,d=e._mapImages[b.e_idx],g=e._map;return g&&(g.__zooming||g.__panning||!e._sr)?void e._standby.push(b):(e._clearEvents(b),void(d&&d._node===b&&g&&e._attach(d)))},_imageError:function(a){a=a.target||a.currentTarget;var c=a.e_layer,b=c._mapImages[a.e_idx];c._clearEvents(a);b&&(b._node=null)},_clearEvents:function(a){var c=l.disconnect;c(a.e_load);c(a.e_error);c(a.e_abort);a.e_load=a.e_error=a.e_abort=a.e_layer=null},_attach:function(a){var b=a.extent,e=b.spatialReference,d=this._sr,g=this._div,
f=a._node,k=new c({x:b.xmin,y:b.ymin,spatialReference:e}),b=new c({x:b.xmax,y:b.ymax,spatialReference:e});d.equals(e)||(d.isWebMercator()&&4326===e.wkid?(k=n.geographicToWebMercator(k),b=n.geographicToWebMercator(b)):e.isWebMercator()&&4326===d.wkid&&(k=n.webMercatorToGeographic(k),b=n.webMercatorToGeographic(b)));f.e_bl=k;f.e_tr=b;a.visible&&(this._setPos(f,g._left,g._top),(this._active||g).appendChild(f))},_setPos:function(a,c,b){var e=a.e_bl,d=a.e_tr,g=this._map,e=g.toScreen(e),d=g.toScreen(d);
c=e.x-c;b=d.y-b;var n=Math.abs(d.x-e.x),e=Math.abs(e.y-d.y),d={width:n+"px",height:e+"px"},m=this._mapImages[a.e_idx];"css-transforms"===g.navigationMode?d[k._css.names.transform]=k._css.translate(c,b)+(m.rotation?" "+k._css.rotate(360-m.rotation):""):(d.left=c+"px",d.top=b+"px");f.set(a,d);a.e_l=c;a.e_t=b;a.e_w=n;a.e_h=e},managedSuspension:!0,_setMap:function(a,c){this.inherited(arguments);var d=this._div=b.create("div",null,c),n=k._css.names,m={position:"absolute"},r=a.__visibleDelta;(!g("ie")||
8<g("ie"))&&(m.opacity=this.opacity);"css-transforms"===a.navigationMode?(m[n.transform]=k._css.translate(r.x,r.y),f.set(d,m),d._left=r.x,d._top=r.y,m={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible"},this._active=b.create("div",null,d),f.set(this._active,m),this._passive=b.create("div",null,d),f.set(this._passive,m)):(d._left=0,d._top=0,f.set(d,m));this._standby=[];m=this._mapImages;r=m.length;for(n=0;r>n;n++){var h=m[n];h._node||this._createImage(h,h._idx)}return e.hide(d),
d},_unsetMap:function(a,c){this._disconnect();var e=this._div;if(e){var d,g=this._mapImages,f=g.length;for(d=0;f>d;d++){var k=g[d];if(k){var n=k._node;n&&(this._clearEvents(n),n.e_idx=n.e_bl=n.e_tr=n.e_l=n.e_t=n.e_w=n.e_h=null);k._node=null}}c.removeChild(e);b.destroy(e)}this._map=this._div=this._sr=this._active=this._passive=this._standby=null;this.inherited(arguments)},_onSuspend:function(){this._disconnect();e.hide(this._div)},_onResume:function(a){a.firstOccurrence&&(this._sr=this._map.spatialReference,
this._processStandbyList());a=this._map;var c=this._div,b=a.__visibleDelta;"css-transforms"===a.navigationMode&&(c._left=b.x,c._top=b.y,f.set(c,k._css.names.transform,k._css.translate(c._left,c._top)));this._redraw("css-transforms"===a.navigationMode);this._connect(a);e.show(c)},_connect:function(a){if(!this._connections){var c=l.connect,b="css-transforms"===a.navigationMode;this._connections=[c(a,"onPanStart",this._panStart),c(a,"onPan",this._pan),c(a,"onExtentChange",this._extentChange),b&&c(a,
"onZoomStart",this._zoomStart),b?c(a,"onScale",this._scale):c(a,"onZoom",this._zoom),b&&c(a,"onResize",this._resize)]}},_disconnect:function(){this._connections&&(d.forEach(this._connections,l.disconnect),this._connections=null)},_panStart:function(){this._panL=this._div._left;this._panT=this._div._top},_pan:function(a,c){var b=this._div;b._left=this._panL+c.x;b._top=this._panT+c.y;"css-transforms"===this._map.navigationMode?f.set(b,k._css.names.transform,k._css.translate(b._left,b._top)):f.set(b,
{left:b._left+"px",top:b._top+"px"})},_extentChange:function(a,c,b){b?this._redraw("css-transforms"===this._map.navigationMode):c&&this._pan(a,c);this._processStandbyList()},_processStandbyList:function(){var a,c=this._standby;if(c&&c.length)for(a=c.length-1;0<=a;a--)this._imageLoaded(null,c[a]),c.splice(a,1)},_redraw:function(a){if(a){a=this._passive;var c=k._css.names;f.set(a,c.transition,"none");this._moveImages(a,this._active);f.set(a,c.transform,"none")}var b=this._active||this._div,e=this._div._left,
d=this._div._top,g=b.childNodes.length;for(a=0;g>a;a++)c=b.childNodes[a],this._setPos(c,e,d)},_zoom:function(a,c,b){var e,d=this._div,g=d._left,k=d._top,n=d.childNodes.length;for(a=0;n>a;a++){e=d.childNodes[a];var m=e.e_w*c,r=e.e_h*c,h=(b.x-g-e.e_l)*(m-e.e_w)/e.e_w,q=(b.y-k-e.e_t)*(r-e.e_h)/e.e_h,h=isNaN(h)?0:h,q=isNaN(q)?0:q;f.set(e,{left:e.e_l-h+"px",top:e.e_t-q+"px",width:m+"px",height:r+"px"})}},_zoomStart:function(){this._moveImages(this._active,this._passive)},_moveImages:function(a,c){var b,
e=a.childNodes;b=e.length;if(0<b)for(--b;0<=b;b--)c.appendChild(e[b])},_scale:function(a,c){var b=k._css.names,e=this._passive;f.set(e,b.transition,c?"none":b.transformName+" "+m.defaults.map.zoomDuration+"ms ease");k._css.matrix(a);f.set(e,b.transform,k._css.matrix(a))},_resize:function(a,c,b){f.set(this._active,{width:c+"px",height:b+"px"});f.set(this._passive,{width:c+"px",height:b+"px"})}});return g("extend-esri")&&a.setObject("layers.MapImageLayer",r,k),r})},"esri/layers/OpenStreetMapLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),
function(h,l,a,d,b,f,k,m,g){h=h(m,{declaredClass:"esri.layers.OpenStreetMapLayer",constructor:function(a){this.spatialReference=new f({wkid:102100});this.tileInfo=new g({rows:256,cols:256,dpi:96,format:"PNG8",compressionQuality:0,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,scale:5.91657527591555E8,resolution:156543.033928},{level:1,scale:2.95828763795777E8,resolution:78271.5169639999},{level:2,scale:1.47914381897889E8,resolution:39135.7584820001},
{level:3,scale:7.3957190948944E7,resolution:19567.8792409999},{level:4,scale:3.6978595474472E7,resolution:9783.93962049996},{level:5,scale:1.8489297737236E7,resolution:4891.96981024998},{level:6,scale:9244648.868618,resolution:2445.98490512499},{level:7,scale:4622324.434309,resolution:1222.99245256249},{level:8,scale:2311162.217155,resolution:611.49622628138},{level:9,scale:1155581.108577,resolution:305.748113140558},{level:10,scale:577790.554289,resolution:152.874056570411},{level:11,scale:288895.277144,
resolution:76.4370282850732},{level:12,scale:144447.638572,resolution:38.2185141425366},{level:13,scale:72223.819286,resolution:19.1092570712683},{level:14,scale:36111.909643,resolution:9.55462853563415},{level:15,scale:18055.954822,resolution:4.77731426794937},{level:16,scale:9027.977411,resolution:2.38865713397468},{level:17,scale:4513.988705,resolution:1.19432856685505},{level:18,scale:2256.994353,resolution:.597164283559817},{level:19,scale:1128.497176,resolution:.298582141647617}]});this.fullExtent=
new k({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.initialExtent=new k({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.tileServers=a&&a.tileServers||["//a.tile.openstreetmap.org","//b.tile.openstreetmap.org","//c.tile.openstreetmap.org"];this.serversLength=this.tileServers.length;this._displayLevels=a?a.displayLevels:null;this.copyright=a&&a.copyright||"Map data \u00a9 OpenStreetMap contributors, CC-BY-SA";
this.loaded=!0;this.onLoad(this);(a=a&&a.loadCallback)&&a(this)},getTileUrl:function(a,c,d){a=this.tileServers[c%this.serversLength]+"/"+a+"/"+d+"/"+c+".png";return a=b.normalize(a),a=this.addTimestampToURL(a),b.addProxy(a)}});return a("extend-esri")&&l.setObject("layers.OpenStreetMapLayer",h,d),h})},"esri/layers/VectorTileLayer":function(){!function(){var h=function(){var a;try{a=window.WebGLRenderingContext}catch(d){a=!1}var b;try{for(var f=document.createElement("canvas"),k=["webgl","experimental-webgl",
"webkit-3d","moz-webgl"],m=null,g=0;g<k.length;++g){try{m=f.getContext(k[g])}catch(e){}if(m)break}b=m}catch(c){b=!1}return a&&b?!0:!1}(),l=["dojo/_base/lang","dojo/has","dojo/Deferred","../sniff","./layer"];h&&l.push("./VectorTileLayerImpl");define(l,function(a,d,b,f,k,m){var g;return g=m?m:k.createSubclass({declaredClass:"esri.layers.VectorTileLayer",constructor:function(){var e=new b;e.reject(Error("esri.layers.VectorTileLayer is not supported"));e.promise.otherwise(a.hitch(this,function(a){this._errorHandler(a)}))}}),
g.ACCESS_TOKEN=null,g.supported=function(){return h},d("extend-esri")&&a.setObject("layers.VectorTileLayer",g,f),g})}()},"esri/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/window dojo/Stateful dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/registry ../kernel ../lang ../domUtils ../geometry/Polyline ../geometry/Polygon ../geometry/normalizeUtils ../InfoWindowBase ../PopupBase dojo/i18n!../nls/jsapi dojo/NodeList-dom require require".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D){h=h([B,C,m],{declaredClass:"esri.dijit.Popup",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:25,marginTop:25,highlight:!0,pagingControls:!0,pagingInfo:!0,keepHighlightOnHide:!1,popupWindow:!0,titleInBody:!0,anchor:"auto",visibleWhenEmpty:!0,hideDelay:1E3,location:null,constructor:function(a,g){this.initialize();l.mixin(this,a);this.domNode=e.byId(g);var k=this._nls=l.mixin({},D.widgets.popup),m=this.domNode;n.add(m,"esriPopup");(this._isRTL=
!r.isBodyLtr())&&u.set(m,"direction","rtl");c.set(m,"innerHTML","\x3cdiv class\x3d'esriPopupWrapper' style\x3d'position: absolute;'\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden' title\x3d'"+k.NLS_searching+"...'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton prev hidden' title\x3d'"+k.NLS_prevFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden' title\x3d'"+k.NLS_nextFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton maximize' title\x3d'"+
k.NLS_maximize+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close' title\x3d'"+k.NLS_close+"'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer content'\x3e\x3cdiv class\x3d'contentPane'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'actionsPane'\x3e\x3cdiv class\x3d'actionList hidden'\x3e\x3ca title\x3d"+k.NLS_zoomTo+" class\x3d'action zoomTo' href\x3d'javascript:void(0);'\x3e\x3cspan\x3e"+k.NLS_zoomTo+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'outerPointer hidden'\x3e\x3c/div\x3e");
this._sizers=b.query(".sizer",m);k=b.query(".titlePane",m)[0];if(e.setSelectable(k,!1),this._title=b.query(".title",k)[0],this._prevFeatureButton=b.query(".prev",k)[0],this._nextFeatureButton=b.query(".next",k)[0],this._maxButton=b.query(".maximize",k)[0],this._spinner=b.query(".spinner",k)[0],this._contentPane=b.query(".contentPane",m)[0],this._positioner=b.query(".esriPopupWrapper",m)[0],this._pointer=b.query(".pointer",m)[0],this._outerPointer=b.query(".outerPointer",m)[0],this._actionList=b.query(".actionsPane .actionList",
m)[0],this._eventConnections=[d.connect(b.query(".close",k)[0],"onclick",this,this.hide),d.connect(this._prevFeatureButton,"onclick",this,this.selectPrevious),d.connect(this._nextFeatureButton,"onclick",this,this.selectNext),d.connect(this._maxButton,"onclick",this,this._toggleSize),d.connect(b.query(".zoomTo",this._actionList)[0],"onclick",this,this._zoomToFeature),d.connect(this,"onClearFeatures",this,this._featuresCleared),d.connect(this,"onSelectionChange",this,this._featureSelected),d.connect(this,
"onDfdComplete",this,this._updateUI)],f("esri-touch"))m=x.setScrollable(this._contentPane),this._eventConnections.push(m[0],m[1]);this._toggleVisibility(!1)},onMaximize:function(){},onRestore:function(){},setMap:function(a){this.inherited(arguments);q.place(this.domNode,a.root);this.highlight&&this.enableHighlight(a);this._maxHeight=u.get(this._contentPane,"maxHeight")},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(a){this.popupWindow&&(w.isDefined(a)&&
""!==a||(a="\x26nbsp;"),this.destroyDijits(this._title),this.place(a,this._title),this.isShowing&&(this.startupDijits(this._title),this.reposition()))},setContent:function(a){this.popupWindow&&(w.isDefined(a)&&""!==a||(a="\x26nbsp;"),this.destroyDijits(this._contentPane),this.place(a,this._contentPane),this.isShowing&&(this.startupDijits(this._contentPane),this.reposition()))},show:function(a,c){if(this.popupWindow){if(this._delayHide=!1,!a)return void this._toggleVisibility(!0);var b,e=this.map;
a.spatialReference?(this.location=a,b=e.toScreen(a)):(this.location=e.toMap(a),b=a);var d=e._getFrameWidth();if(-1!==d&&(b.x%=d,0>b.x&&(b.x+=d),e.width>d))for(e=(e.width-d)/2;b.x<e;)b.x+=d;this._maximized?this.restore():this._setPosition(b);c&&c.closestFirst&&this.showClosestFirst(this.location);this.isShowing||(this._toggleVisibility(!0),this._followMap(),this.startupDijits(this._title),this.startupDijits(this._contentPane),this.reposition(),this.showHighlight(),this.onShow())}},hide:function(){this.isShowing&&
(this._toggleVisibility(!1),this._unfollowMap(),this.keepHighlightOnHide||this.hideHighlight(),this.onHide())},resize:function(a,c){this.popupWindow&&(this._sizers.style({width:a+"px"}),u.set(this._contentPane,"maxHeight",c+"px"),this._maxHeight=c,this.isShowing&&this.reposition())},reposition:function(){this.popupWindow&&this.map&&this.location&&!this._maximized&&this.isShowing&&this._setPosition(this.map.toScreen(this.location))},maximize:function(){var a=this.map;if(a&&!this._maximized&&this.popupWindow){this._maximized=
!0;var b=this._maxButton;n.remove(b,"maximize");n.add(b,"restore");c.set(b,"title",this._nls.NLS_restore);var b=this.marginLeft,e=this.marginTop,d=a.width-2*b,a=a.height-2*e;u.set(this.domNode,{left:this._isRTL?null:b+"px",right:this._isRTL?b+"px":null,top:e+"px",bottom:null});u.set(this._positioner,{left:null,right:null,top:null,bottom:null});this._savedWidth=u.get(this._sizers[0],"width");this._savedHeight=u.get(this._contentPane,"maxHeight");this._sizers.style({width:d+"px"});u.set(this._contentPane,
{maxHeight:a-65+"px",height:a-65+"px"});this._showPointer("");this._unfollowMap();n.add(this.domNode,"esriPopupMaximized");this.onMaximize()}},restore:function(){if(this.map&&this._maximized&&this.popupWindow){this._maximized=!1;var a=this._maxButton;n.remove(a,"restore");n.add(a,"maximize");c.set(a,"title",this._nls.NLS_maximize);u.set(this._contentPane,"height",null);this.resize(this._savedWidth,this._savedHeight);this._savedWidth=this._savedHeight=null;this.show(this.location);this._followMap();
n.remove(this.domNode,"esriPopupMaximized");this.onRestore()}},startup:function(){},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);this.destroyDijits(this._content);a.forEach(this._eventConnections,d.disconnect);q.destroy(this.domNode);this._sizers=this._contentPane=this._actionList=this._positioner=this._pointer=this._outerPointer=this._title=this._prevFeatureButton=this._nextFeatureButton=this._spinner=this._eventConnections=
this._pagerScope=this._targetLocation=this._nls=this._maxButton=null},selectNext:function(){this.select(this.selectedIndex+1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(){this.inherited(arguments);this._updateUI()},postscript:null,_highlightSetter:function(a){var c=this.highlight,b=this.map;if(this.highlight=a,b&&a!==c)a?(this.enableHighlight(b),(a=this.features&&this.features[this.selectedIndex])&&(this.updateHighlight(b,a),this.showHighlight())):this.disableHighlight(b)},
_pagingControlsSetter:function(a){var c=this.pagingControls,b=this.map;this.pagingControls=a;b&&a!==c&&this._updatePagingControls()},_pagingInfoSetter:function(a){var c=this.pagingInfo,b=this.map;this.pagingInfo=a;b&&a!==c&&this.features&&this.features.length&&this._updatePagingInfo()},_popupWindowSetter:function(a){var c=this.popupWindow,b=this.map;this.popupWindow=a;b&&a!==c&&(a?(this._updateUI(),this._updateWindow()):(this.hide(),this.showHighlight()))},_anchorSetter:function(a){var c=this.anchor;
this.anchor=a;this.map&&a!==c&&this.reposition()},_featuresCleared:function(){this.setTitle("\x26nbsp;");this.setContent("\x26nbsp;");this._setPagerCallbacks(this);this._updateUI();this.hideHighlight()},_featureSelected:function(){this._updateUI();this._updateWindow()},_updateWindow:function(){var a=this.selectedIndex;if(0<=a){var c,b=this.features[a].getContent();!this.titleInBody&&b&&l.isString(b.id)&&(c=v.byId(b.id),c&&c.set&&/_PopupRenderer/.test(c.declaredClass)&&c.set("showTitle",!1));this.setContent(b);
this.updateHighlight(this.map,this.features[a]);this.showHighlight()}},_toggleVisibility:function(a){this._setVisibility(a);this.isShowing=a},_setVisibility:function(a){n.toggle(this.domNode,"esriPopupVisible",a);n.toggle(this.domNode,"esriPopupHidden",!a)},_waitAndHide:function(a){var c=this;this._delayHide=!0;setTimeout(function(){c._delayHide&&(c._delayHide=!1,c.hide())},a)},_followMap:function(){this._unfollowMap();var a=this.map;this._handles=[d.connect(a,"onPanStart",this,this._onPanStart),
d.connect(a,"onPan",this,this._onPan),d.connect(a,"onZoomStart",this,this._onZoomStart),d.connect(a,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var c=this._handles;c&&(a.forEach(c,d.disconnect),this._handles=null)},_onPanStart:function(){var a=this.domNode.style;this._panOrigin={left:a.left,top:a.top,right:a.right,bottom:a.bottom}},_onPan:function(a,c){var b=this._panOrigin,e=c.x,d=c.y,g=b.left,f=b.top,k=b.right,b=b.bottom;g&&(g=parseFloat(g)+e+"px");f&&(f=parseFloat(f)+
d+"px");k&&(k=parseFloat(k)-e+"px");b&&(b=parseFloat(b)-d+"px");u.set(this.domNode,{left:g,top:f,right:k,bottom:b})},_onZoomStart:function(){this._setVisibility(!1)},_onExtentChange:function(a,c,b){b&&(this._setVisibility(!0),this.show(this._targetLocation||this.location));this._targetLocation=null},_toggleSize:function(){this._maximized?this.restore():this.maximize()},_setPosition:function(a){var c=a.x,b=a.y;a=this.offsetX||0;var e=this.offsetY||0,d=0,g=0,f=r.position(this.map.container,!0),n=f.w,
m=f.h,t="Left",h="bottom",q=r.getContentBox(this._positioner),v=q.w/2,l=q.h/2,w=u.get(this._sizers[0],"height")+this._maxHeight+u.get(this._sizers[2],"height"),x=w/2,y=0,C=0,z=c,A=b,D=this.anchor.toLowerCase();"auto"===D?((D=k.getBox)&&(D=D(),y=Math.max(D.l,f.x),n=Math.min(D.l+D.w,f.x+f.w),C=Math.max(D.t,f.y),m=Math.min(D.t+D.h,f.y+f.h),z+=f.x,A+=f.y),f=A-C>=w,w=m-A>=w,D=n-z>=q.w,q=z-y>=q.w,A-C>x&&m-A>=x&&(D?(h="",t="Left"):q&&(h="",t="Right")),t&&h&&z-y>v&&n-z>=v&&(f?(t="",h="bottom"):w&&(t="",h=
"top")),t&&h&&(D&&f?(t="Left",h="bottom"):D&&w?(t="Left",h="top"):q&&w?(t="Right",h="top"):q&&f&&(t="Right",h="bottom"))):(h=t="",-1!==D.indexOf("top")?h="bottom":-1!==D.indexOf("bottom")&&(h="top"),-1!==D.indexOf("left")?t="Right":-1!==D.indexOf("right")&&(t="Left"));x=h+t;switch(x){case "top":case "bottom":g=14;break;case "Left":case "Right":d=13;break;case "topLeft":case "topRight":case "bottomLeft":case "bottomRight":g=14,d=-16}u.set(this.domNode,{left:c+"px",top:b+"px",right:null,bottom:null});
c={left:null,right:null,top:null,bottom:null};t?c[t.toLowerCase()]=d+a+"px":c.left=-v+"px";h?c[h]=g+e+"px":c.top=-l+"px";u.set(this._positioner,c);this._showPointer(x)},_showPointer:function(a){n.remove(this._pointer,"top bottom right left topLeft topRight bottomRight bottomLeft hidden".split(" "));n.remove(this._outerPointer,["right","left","hidden"]);"Right"===a||"Left"===a?(a=a.toLowerCase(),n.add(this._outerPointer,a)):n.add(this._pointer,a)},_setPagerCallbacks:function(a,c,b){if(this.pagingControls&&
(a!==this||this._pagerScope&&this._pagerScope!==this)&&a!==this._pagerScope){this._pagerScope=a;a===this&&(c=this.selectPrevious,b=this.selectNext);var e=this._eventConnections;d.disconnect(e[1]);d.disconnect(e[2]);c&&(e[1]=d.connect(this._prevFeatureButton,"onclick",a,c));b&&(e[2]=d.connect(this._nextFeatureButton,"onclick",a,b))}},_getLocation:function(a){var c,b;if(a=a&&a.geometry)switch(a.type){case "point":c=a;break;case "multipoint":c=a.getPoint(0);b=A.getDenormalizedExtent(a);break;case "polyline":case "polygon":c=
a.getPoint(0,0),b=A.getDenormalizedExtent(a)}return[c,b]},_zoomToFeature:function(a){a.preventDefault();var c=this.features,b=this.selectedIndex;a=this.map;if(c)if(b=this._getLocation(c[b]),c=b[0],b=b[1],c||(c=this.location),b&&b.intersects(this.location)||(this.location=c),b&&b.getWidth()&&b.getHeight())a.setExtent(b,!0);else{var e=a.getNumLevels(),b=a.getLevel(),d=a.getMaxZoom(),g=this.zoomFactor||1;0<e?b!==d&&(e=b+g,e>d&&(e=d),a.navigationManager._wheelZoom({value:e-b,mapPoint:c},!0)):a.navigationManager._wheelZoom({value:1/
Math.pow(2,g)*2,mapPoint:c},!0)}},_updatePagingControls:function(){var a=this._prevFeatureButton,c=this._nextFeatureButton,b=this.selectedIndex,e=this.features?this.features.length:0;this.pagingControls&&1<e?(0===b?n.add(a,"hidden"):n.remove(a,"hidden"),b===e-1?n.add(c,"hidden"):n.remove(c,"hidden")):(n.add(a,"hidden"),n.add(c,"hidden"))},_updatePagingInfo:function(){var a,c,b,e=this.features?this.features.length:0,d=this._nls,g="\x26nbsp;";this.pagingInfo&&1<e&&d.NLS_pagingInfo&&(g=w.substitute({index:this.selectedIndex+
1,total:e},d.NLS_pagingInfo));e&&(a=this.getSelectedFeature(),c=a.getInfoTemplate(),b=a.getTitle(),c&&!/esri\.InfoTemplate/.test(c.declaredClass)&&this.titleInBody||!b||(g=b+("\x26nbsp;"===g?"":" "+g)));this.setTitle(g)},_updateUI:function(){if(this.popupWindow){var a=this.features,c=this.deferreds,b=a?a.length:0,e=this._spinner,d=this._actionList,g=this._nls;this._updatePagingControls();this._updatePagingInfo();b?n.remove(d,"hidden"):n.add(d,"hidden");c&&c.length?a?n.remove(e,"hidden"):this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+
g.NLS_searching+"...\x3c/div\x3e"):(n.add(e,"hidden"),b||(this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+g.NLS_noInfo+".\x3c/div\x3e"),this.visibleWhenEmpty||this._waitAndHide(this.hideDelay)))}}});return f("extend-esri")&&l.setObject("dijit.Popup",h,t),h})},"esri/geometry/normalizeUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/has ../kernel ../config ../deferredUtils ./Extent ./Polyline ./Polygon ./webMercatorUtils ./jsonUtils".split(" "),function(h,
l,a,d,b,f,k,m,g,e,c,n){function q(a,c){return Math.ceil((a-c)/(2*c))}function r(a,c){var b,e,d,g=a.paths||a.rings,f=g.length;for(b=0;f>b;b++)for(d=g[b].length,e=0;d>e;e++){var k=a.getPoint(b,e);a.setPoint(b,e,k.offset(c,0))}return a}function u(a,c){if(!(a instanceof g||a instanceof e))throw console.error("_straightLineDensify: the input geometry is neither polyline nor polygon"),Error("_straightLineDensify: the input geometry is neither polyline nor polygon");var b,d=a instanceof g,f=[];return h.forEach(d?
a.paths:a.rings,function(a){f.push(b=[]);b.push([a[0][0],a[0][1]]);var e,d,g,k,n,m,t,r,h,q,u,v;for(n=0;n<a.length-1;n++){if(e=a[n][0],d=a[n][1],g=a[n+1][0],k=a[n+1][1],t=Math.sqrt((g-e)*(g-e)+(k-d)*(k-d)),r=(k-d)/t,h=(g-e)/t,q=t/c,1<q){for(m=1;q-1>=m;m++)v=m*c,u=h*v+e,v=r*v+d,b.push([u,v]);m=(t+Math.floor(q-1)*c)/2;u=h*m+e;v=r*m+d;b.push([u,v])}b.push([g,k])}}),d?new g({paths:f,spatialReference:a.spatialReference}):new e({rings:f,spatialReference:a.spatialReference})}function v(a,b,e){b&&(a=u(a,1E6),
a=c.webMercatorToGeographic(a,!0));return e&&(a=r(a,e)),a}function t(a,c,b){var e,d=a.x||a[0];return d>c?(e=q(d,c),a.x?a=a.offset(-2*e*c,0):a[0]=d+-2*e*c):b>d&&(e=q(d,b),a.x?a=a.offset(-2*e*b,0):a[0]=d+-2*e*b),a}function w(a,c){var b=-1;return h.forEach(c.cutIndexes,function(e,d){var g=c.geometries[d];h.forEach(g.rings||g.paths,function(a,c){h.some(a,function(b){if(180>b[0])return!0;var e,d=0,f=a.length;for(b=0;f>b;b++)e=a[b][0],d=e>d?e:d;d=Number(d.toFixed(9));e=-360*q(d,180);d=a.length;for(b=0;d>
b;b++)f=g.getPoint(c,b),g.setPoint(c,b,f.offset(e,0));return!0})});e===b?g.rings?h.forEach(g.rings,function(c){a[e]=a[e].addRing(c)}):h.forEach(g.paths,function(c){a[e]=a[e].addPath(c)}):(b=e,a[e]=g)}),a}function x(b,d,k,m){var u=new a;u.addCallbacks(k,m);d=d||f.defaults.geometryService;var l,x,y,C,z,A,B,O,T=[],S=[],R=0;h.forEach(b,function(a){if(!a||(l||(l=a.spatialReference,x=l._getInfo(),y=l._isWebMercator(),C=y?2.0037508342788905E7:180,z=y?-2.0037508342788905E7:-180,A=y?102100:4326,B=new g({paths:[[[C,
z],[C,C]]],spatialReference:{wkid:A}}),O=new g({paths:[[[z,z],[z,C]]],spatialReference:{wkid:A}})),!x))return void T.push(a);var c=n.fromJson(a.toJson()),b=a.getExtent();"point"===a.type?T.push(t(c,C,z)):"multipoint"===a.type?(c.points=h.map(c.points,function(a){return t(a,C,z)}),T.push(c)):"extent"===a.type?(c=b._normalize(null,null,x),T.push(c.rings?new e(c):c)):b?(a=2*q(b.xmin,z)*C,c=0===a?c:r(c,a),b=b.offset(a,0),b.intersects(B)&&b.xmax!==C?(R=b.xmax>R?b.xmax:R,c=v(c,y),S.push(c),T.push("cut")):
b.intersects(O)&&b.xmin!==z?(R=2*b.xmax*C>R?2*b.xmax*C:R,c=v(c,y,360),S.push(c),T.push("cut")):T.push(c)):T.push(c)});k=new g;m=q(R,C);for(var U=-90,W=m;0<m;){var fa=-180+360*m;k.addPath([[fa,U],[fa,-1*U]]);U*=-1;m--}return 0<S.length&&0<W?d?d.cut(S,k,function(a){S=w(S,a);var e=[];h.forEach(T,function(a,d){if("cut"===a){var g=S.shift();b[d].rings&&1<b[d].rings.length&&g.rings.length>=b[d].rings.length?(T[d]="simplify",e.push(g)):T[d]=!0===y?c.geographicToWebMercator(g):g}});0<e.length?d.simplify(e,
function(a){h.forEach(T,function(b,e){"simplify"===b&&(T[e]=!0===y?c.geographicToWebMercator(a.shift()):a.shift())});u.callback(T)},function(a){u.errback(a)}):u.callback(T)},function(a){u.errback(a)}):u.errback(Error("esri.geometry.normalizeCentralMeridian: 'geometryService' argument is missing.")):(h.forEach(T,function(a,b){if("cut"===a){var e=S.shift();T[b]=!0===y?c.geographicToWebMercator(e):e}}),u.callback(T)),u}function y(a,c,b,e){var d,g=!1;l.isObject(a)&&a&&(l.isArray(a)?a.length&&(d=a[0]&&
a[0].declaredClass,d&&-1!==d.indexOf("Graphic")?(a=h.map(a,function(a){return a.geometry}),g=a.length?!0:!1):d&&-1!==d.indexOf("esri.geometry.")&&(g=!0)):(d=a.declaredClass,d&&-1!==d.indexOf("FeatureSet")?(a=h.map(a.features||[],function(a){return a.geometry}),g=a.length?!0:!1):d&&-1!==d.indexOf("esri.geometry.")&&(g=!0)));g&&c.push({index:b,property:e,value:a})}function z(a,c){var b=[];return h.forEach(c,function(c){var e,d=c.i,g=a[d];c=c.p;if(l.isObject(g)&&g)if(c)if("*"===c[0])for(e in g)g.hasOwnProperty(e)&&
y(g[e],b,d,e);else h.forEach(c,function(a){y(l.getObject(a,!1,g),b,d,a)});else y(g,b,d)}),b}function A(a,c){var b=0,e={};return h.forEach(c,function(c){var d=c.index,g=c.property,f=c.value,k=f.length||1,n=a.slice(b,b+k);l.isArray(f)||(n=n[0]);b+=k;delete c.value;g?(e[d]=e[d]||{},e[d][g]=n):e[d]=n}),e}function B(a){for(var c=[],b=0,e=0,d=Math.min,g=Math.max,f=0;f<a.length;f++){for(var k=a[f],n=null,m=0;m<k.length;m++)n=k[m],c.push(n),0===m?(b=n[0],e=b):(b=d(b,n[0]),e=g(e,n[0]));n&&c.push([(b+e)/2,
0])}return c}var C={normalizeCentralMeridian:x,_foldCutResults:w,_prepareGeometryForCut:v,_offsetMagnitude:q,_pointNormalization:t,_updatePolyGeometry:r,_straightLineDensify:u,_createWrappers:function(c){var b=l.isObject(c)?c.prototype:l.getObject(c+".prototype");h.forEach(b.__msigns,function(c){var e=b[c.n];b[c.n]=function(){var b,d=this,g=[],f=new a(k._dfdCanceller);c.f&&k._fixDfd(f);for(b=0;b<c.c;b++)g[b]=arguments[b];var n={dfd:f};g.push(n);var m,t,r=[];return d.normalization&&!d._isTable&&(m=
z(g,c.a),h.forEach(m,function(a){r=r.concat(a.value)}),r.length&&(t=x(r))),t?(f._pendingDfd=t,t.addCallbacks(function(a){f.canceled||(n.assembly=A(a,m),f._pendingDfd=e.apply(d,g))},function(a){var b=d.declaredClass;b&&-1!==b.indexOf("FeatureLayer")?d._resolve([a],null,g[c.e],f,!0):d._errorHandler(a,g[c.e],f)})):f._pendingDfd=e.apply(d,g),f}})},_disassemble:z,_addToBucket:y,_reassemble:A,getDenormalizedExtent:function(a){if(!a)return null;var c=a.getExtent();if(!c)return null;var b=a.spatialReference&&
a.spatialReference._getInfo();if(!b)return c;var e=b.valid[0],b=b.valid[1],d=2*b,g=c.getWidth(),f=c.xmax,k=c.xmin;if("extent"===a.type||0===g||b>=g||g>d||e>f||k>b)return c;var n;switch(a.type){case "polygon":if(!(1<a.rings.length))return c;n=B(a.rings);break;case "polyline":if(!(1<a.paths.length))return c;n=B(a.paths);break;case "multipoint":n=a.points}a=Math.min;for(var e=Math.max,d=new m(c.toJson()),t=0;t<n.length;t++){var r=n[t][0];0>r?(r+=b,k=e(r,k)):(r-=b,f=a(r,f))}return d.xmin=f,d.xmax=k,d.getWidth()<
g?(d.xmin-=b,d.xmax-=b,d):c}};return d("extend-esri")&&l.mixin(l.getObject("geometry",!0,b),C),C})},"esri/plugins/popupManager":function(){define(["../PopupManager"],function(h){return{add:function(l,a){l.popupManager||(l.popupManager=new h(a),l.popupManager.setMap(l))},remove:function(h){var a=h.popupManager;a&&(a.unsetMap(),h.popupManager=void 0)}}})},"esri/PopupManager":function(){define("./geometry/Extent ./geometry/ScreenPoint ./kernel ./layerUtils ./tasks/query dijit/registry dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/_base/lang dojo/has dojo/on dojo/promise/all dojo/Stateful require".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u){var v;m=m(r,{declaredClass:"esri.PopupManager",enabled:!1,map:null,_mapClickHandle:null,_featureLayersCache:{},constructor:function(a){this._mapClickHandler=e.hitch(this,this._mapClickHandler)},setMap:function(a){if(this.map){if(a===this.map)return;this.unsetMap()}this.map=a;this._setupClickHandler()},unsetMap:function(){this.map&&(this.map=null);this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null)},getMapLayer:function(a){var c;if(a&&
(c=a.getLayer())&&(a=c.id,this._featureLayersCache[a])){var b=a.lastIndexOf("_");-1<b&&(a=a.substring(0,b),c=this.map.getLayer(a))}return c},_enabledSetter:function(a){this.enabled=a;this._setupClickHandler()},_setupClickHandler:function(){this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null);this.enabled&&this.map&&(this._mapClickHandle=this.map.on("click",this._mapClickHandler))},_mapClickHandler:function(a){var c=this.map.infoWindow,b=a.graphic;c&&this.map.loaded&&(c.clearFeatures&&
c.setFeatures?this._showPopup(a):b&&b.getInfoTemplate()&&this._showInfoWindow(b,a.mapPoint))},_showPopup:function(a){var c=this.map,e=c.infoWindow,d=this,f=[],n=[c.graphics].concat(k.map(c.graphicsLayerIds,c.getLayer,c));k.forEach(n,function(a){a&&a.loaded&&a.infoTemplate&&!a.suspended&&f.push(a)});var m=[];k.forEach(c.layerIds,function(a){(a=c.getLayer(a))&&a.loaded&&!a.suspended&&(d._isImageServiceLayer(a)&&a.infoTemplate?f.push(a):"esri.layers.WMSLayer"===a.declaredClass&&a.getFeatureInfoURL?f.push(a):
"esri.layers.ArcGISDynamicMapServiceLayer"!==a.declaredClass&&"esri.layers.ArcGISTiledMapServiceLayer"!==a.declaredClass||!a.infoTemplates||m.push(a))});this._getSubLayerFeatureLayers(m).then(function(n){f=f.concat(n);n=null;if(a.graphic&&a.graphic.getInfoTemplate()&&!d._isImageServiceLayer(a.graphic._layer)&&(n=a.graphic),f.length||n){var m=d._calculateClickTolerance(f),r=a.screenPoint,q=c.toMap(new l(r.x-m,r.y+m)),m=c.toMap(new l(r.x+m,r.y-m)),u=new h(q.x,q.y,m.x,m.y,c.spatialReference);if(u=u.intersects(c.extent)){var v=
new b,A=!!n,B=!0,q=k.map(f,function(b){var e;if(v.timeExtent=b.useMapTime?c.timeExtent:null,d._isImageServiceLayer(b))v.geometry=a.mapPoint,B=!1,e=b.queryVisibleRasters(v,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),e.addCallback(function(){var a=b.getVisibleRasters();return A=A||0<a.length,a});else if("esri.layers.WMSLayer"===b.declaredClass){e=new g;var f=b._getPopupGraphic(c,a.screenPoint);f?(e.resolve([f]),A=!0):e.resolve([])}else d._featureLayersCache[b.id]||"function"==
typeof b.queryFeatures&&(0===b.currentMode||1===b.currentMode)?(v.geometry=u,e=b.queryFeatures(v),e.addCallback(function(a){a=a.features;return a=k.filter(a,function(a){return a.visible}),A=A||0<a.length,a})):(e=new g,f=k.filter(b.graphics,function(a){return a&&a.visible&&u.intersects(a.geometry)}),A=A||0<f.length,e.resolve(f));return e});n&&(m=new g,m.resolve([n]),q.unshift(m));if(!k.some(q,function(a){return!a.isFulfilled()})&&!A)return e.hide(),void e.clearFeatures();e.setFeatures(q);e.show(a.mapPoint,
{closestFirst:B})}}})},_getSubLayerFeatureLayers:function(a,c){var b=c||new g,e=[],f=a.length,m=Math.floor(this.map.extent.getWidth()/this.map.width),r=this.map.getScale(),h=!1,l=this,E=0;a:for(;f>E;E++){var F=a[E],H=F.dynamicLayerInfos||F.layerInfos;if(H){var G=null;F._params&&(F._params.layers||F._params.dynamicLayers)&&(G=F.visibleLayers);for(var G=d._getVisibleLayers(H,G),K=d._getLayersForScale(r,H),J=H.length,I=0;J>I;I++){var L=H[I],M=L.id,N=F.infoTemplates[M];if(!L.subLayerIds&&N&&N.infoTemplate&&
-1<k.indexOf(G,M)&&-1<k.indexOf(K,M)){if(!v){h=!0;break a}var Q=F.id+"_"+M,O=this._featureLayersCache[Q];O&&O.loadError||(O||((O=N.layerUrl)||(O=L.source?this._getLayerUrl(F.url,"/dynamicLayer"):this._getLayerUrl(F.url,M)),O=new v(O,{id:Q,drawMode:!1,mode:v.MODE_SELECTION,outFields:this._getOutFields(N.infoTemplate),resourceInfo:N.resourceInfo,source:L.source}),this._featureLayersCache[Q]=O),O.setDefinitionExpression(F.layerDefinitions&&F.layerDefinitions[M]),O.setGDBVersion(F.gdbVersion),O.setInfoTemplate(N.infoTemplate),
O.setMaxAllowableOffset(m),O.setUseMapTime(!!F.useMapTime),F.layerDrawingOptions&&F.layerDrawingOptions[M]&&F.layerDrawingOptions[M].renderer&&O.setRenderer(F.layerDrawingOptions[M].renderer),e.push(O))}}}}if(h){var T=new g;u(["./layers/FeatureLayer"],function(a){v=a;T.resolve()});T.then(function(){l._getSubLayerFeatureLayers(a,b)})}else{var S=[];k.forEach(e,function(a){if(!a.loaded){var c=new g;n.once(a,"load, error",function(){c.resolve()});S.push(c.promise)}});S.length?q(S).then(function(){e=k.filter(e,
function(a){return!a.loadError&&a.isVisibleAtScale(r)});b.resolve(e)}):(e=k.filter(e,function(a){return a.isVisibleAtScale(r)}),b.resolve(e))}return b.promise},_getLayerUrl:function(a,c){var b=a.indexOf("?");return-1===b?a+"/"+c:a.substring(0,b)+"/"+c+a.substring(b)},_getOutFields:function(a){var c;return a.info&&"esri.dijit.PopupTemplate"===a.declaredClass?(c=[],k.forEach(a.info.fieldInfos,function(a){var b=a.fieldName&&a.fieldName.toLowerCase();b&&"shape"!==b&&0!==b.indexOf("relationships/")&&c.push(a.fieldName)})):
c=["*"],c},_calculateClickTolerance:function(a){var c,b,e=6;return k.forEach(a,function(a){(c=a.renderer)&&("esri.renderer.SimpleRenderer"===c.declaredClass?(b=c.symbol,b&&b.xoffset&&(e=Math.max(e,Math.abs(b.xoffset))),b&&b.yoffset&&(e=Math.max(e,Math.abs(b.yoffset)))):("esri.renderer.UniqueValueRenderer"===c.declaredClass||"esri.renderer.ClassBreaksRenderer"===c.declaredClass)&&k.forEach(c.infos,function(a){(b=a.symbol)&&b.xoffset&&(e=Math.max(e,Math.abs(b.xoffset)));b&&b.yoffset&&(e=Math.max(e,
Math.abs(b.yoffset)))}))}),e},_showInfoWindow:function(a,c){var b=this.map.infoWindow,d=a.geometry,d=d&&"point"===d.type?d:c,g=a.getContent();if(b.setTitle(a.getTitle()),g&&e.isString(g.id)){var k=f.byId(g.id);k&&k.set&&/_PopupRenderer/.test(k.declaredClass)&&k.set("showTitle",!1)}b.setContent(g);b.show(d)},_isImageServiceLayer:function(a){return"esri.layers.ArcGISImageServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass}});return c("extend-esri")&&(a.PopupManager=
m),m})},"esri/layerUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/has","./kernel"],function(h,l,a,d,b){var f={_serializeLayerDefinitions:function(b){var d=[],g=!1,e=/[:;]/;if(b&&(l.forEach(b,function(a,c){a&&(d.push([c,a]),!g&&e.test(a)&&(g=!0))}),0<d.length)){var c;return g?(c={},l.forEach(d,function(a){c[a[0]]=a[1]}),c=a.toJson(c)):(c=[],l.forEach(d,function(a){c.push(a[0]+":"+a[1])}),c=c.join(";")),c}return null},_serializeTimeOptions:function(b,d){if(b){var g=
[];return l.forEach(b,function(b,c){if(b){var f=b.toJson();d&&-1!==l.indexOf(d,c)&&(f.useTime=!1);g.push('"'+c+'":'+a.toJson(f))}}),g.length?"{"+g.join(",")+"}":void 0}},_getVisibleLayers:function(a,b){var d,e,c,f=[];if(!a)return f;if(b)for(f=b.concat(),c=0;c<a.length;c++)d=a[c],e=l.indexOf(a,d.id),d.subLayerIds&&-1<e&&(f.splice(e,1),f=f.concat(d.subLayerIds));else f=this._getDefaultVisibleLayers(a);return f},_getDefaultVisibleLayers:function(a){var b,d=[];if(!a)return d;for(b=0;b<a.length;b++)0<=
a[b].parentLayerId&&-1===l.indexOf(d,a[b].parentLayerId)&&l.some(a,function(e){return e.id===a[b].parentLayerId})||a[b].defaultVisibility&&d.push(a[b].id);return d},_getLayersForScale:function(a,b){var d=[];if(0<a&&b){var e;for(e=0;e<b.length;e++)if(!(0<=b[e].parentLayerId&&-1===l.indexOf(d,b[e].parentLayerId)&&l.some(b,function(a){return a.id===b[e].parentLayerId}))&&0<=b[e].id){var c=!0,f=b[e].maxScale,h=b[e].minScale;(0<f||0<h)&&(0<f&&0<h?c=a>=f&&h>=a:0<f?c=a>=f:0<h&&(c=h>=a));c&&d.push(b[e].id)}}return d}};
return d("extend-esri")&&h.mixin(b,f),f})},"esri/MapNavigationManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/event dojo/mouse dojo/keys dijit/focus ./kernel ./MouseEvents ./TouchEvents ./PointerEvents ./config ./sniff ./lang ./fx ./graphic ./tileUtils ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./symbols/SimpleFillSymbol".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B){var C=d.connect,
D=d.disconnect,E=r("chrome"),F=r("safari"),H=[k.NUMPAD_PLUS,61,187,k.NUMPAD_MINUS,173,189,k.UP_ARROW,k.NUMPAD_8,k.RIGHT_ARROW,k.NUMPAD_6,k.DOWN_ARROW,k.NUMPAD_2,k.LEFT_ARROW,k.NUMPAD_4,k.PAGE_UP,k.NUMPAD_9,k.PAGE_DOWN,k.NUMPAD_3,k.END,k.NUMPAD_1,k.HOME,k.NUMPAD_7];h=h(null,{declaredClass:"esri.MapNavigationManager",eventModel:"",constructor:function(a,b){this.map=a;l.mixin(this,b);var d=a.__container;r("esri-pointer")?(this.pointerEvents=new n(d,{map:a}),this.eventModel="pointer"):r("esri-touch")?
(r("ios")||(this.mouseEvents=new e(d,{map:a})),this.touchEvents=new c(d,{map:a,mouseEvents:this.mouseEvents}),this.eventModel="touch"):(this.mouseEvents=new e(d,{map:a}),this.eventModel="mouse");this._zoomRect=new t(null,new B(q.defaults.map.zoomSymbol));this._keyDx=this._keyDy=0;this._adjustPinch=l.hitch(this,this._adjustPinch);this._adjustPinchEnd=l.hitch(this,this._adjustPinchEnd)},_panInit:function(a){var c=this.mouseEvents;f.isLeft(a)&&this.map.isPan&&!a.shiftKey&&(this._dragOrigin=new x(0,0),
l.mixin(this._dragOrigin,a.screenPoint),D(this._panStartHandle),D(this._panHandle),D(this._panEndHandle),this._panStartHandle=C(c,"onMouseDragStart",this,this._panStart),this._panHandle=C(c,"onMouseDrag",this,this._pan),this._panEndHandle=C(c,"onMouseUp",this,this._panEnd),(E||F)&&(a.preventDefault(),m.curNode&&m.curNode.blur()))},_panStart:function(a){this.map.setCursor("move");this.map.__panStart(a.screenPoint.x,a.screenPoint.y)},_pan:function(a){this.map.__pan(a.screenPoint.x-this._dragOrigin.x,
a.screenPoint.y-this._dragOrigin.y)},_panEnd:function(a){D(this._panStartHandle);D(this._panHandle);D(this._panEndHandle);this._panStartHandle=this._panHandle=this._panEndHandle=null;var c=this.map;c.__panning&&(c.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y),c.resetMapCursor())},_zoomInit:function(a){var c=this.map,b=this.pointerEvents||this.mouseEvents;(f.isLeft(a)||a.pointerType)&&c.isRubberBandZoom&&a.shiftKey&&(c.setCursor("crosshair"),this._dragOrigin=l.mixin({},
a.screenPoint),this._zoomDir=a.ctrlKey||a.metaKey?-1:1,this.pointerEvents?(this._zoomHandle=C(b,"onSwipeMove",this,this._zoom),this._zoomEndHandle=C(b,"onSwipeEnd",this,this._zoomEnd)):(this._zoomHandle=C(b,"onMouseDrag",this,this._zoom),this._zoomEndHandle=C(b,"onMouseUp",this,this._zoomEnd)),E&&a.preventDefault())},_zoom:function(a){var c=this.map,b=this._normalizeRect(a).offset(c.__visibleRect.x,c.__visibleRect.y);a=c.graphics;var e=this._zoomRect;e.geometry||c.setCursor("crosshair");e.geometry&&
a.remove(e,!0);var d=c.toMap(new x(b.x,b.y)),b=c.toMap(new x(b.x+b.width,b.y+b.height)),b=new z(d.x,d.y,b.x-d.x,d.y-b.y,c.spatialReference);b._originOnly=!0;e.setGeometry(b);a.add(e,!0)},_zoomEnd:function(a){var c=this._zoomRect,b=this.map,e=b.extent,d=b.spatialReference;if(D(this._zoomHandle),D(this._zoomEndHandle),this._zoomHandle=this._zoomEndHandle=null,b._canZoom(this._zoomDir)&&c.getDojoShape()){b.graphics.remove(c);c.geometry=null;a=this._normalizeRect(a);a.x+=b.__visibleRect.x;a.y+=b.__visibleRect.y;
if(-1===this._zoomDir){var g=e.getWidth();a=(g*b.width/a.width-g)/2;d=new y(e.xmin-a,e.ymin-a,e.xmax+a,e.ymax+a,d)}else e=b.toMap({x:a.x,y:a.y+a.height}),a=b.toMap({x:a.x+a.width,y:a.y}),d=new y(e.x,e.y,a.x,a.y,d);b._extentUtil(null,null,d)}c.getDojoShape()&&b.graphics.remove(c,!0);this._zoomDir=0;b.resetMapCursor()},_wheelZoom:function(a,c){var b=this.map;if(!c){if(b.smartNavigation&&!a.shiftKey&&!b._isPanningOrZooming())return b.disableScrollWheelZoom(),this._setScrollWheelPan(!0),void this._wheelPan(a);
var e=a.timeStamp;(!u.isDefined(e)||0>=e)&&(e=(new Date).getTime());if(100>(this._mwts?e-this._mwts:e))return;this._mwts=e}b._canZoom(a.value)&&b._extentUtil({numLevels:a.value,mapAnchor:a.mapPoint,screenAnchor:a.screenPoint})},_wheelPan:function(a){var c=this.map;if(a.shiftKey&&!c._isPanningOrZooming())return this._setScrollWheelPan(!1),c.enableScrollWheelZoom(),void this._wheelZoom(a);var b=0,e=0;r("ff")?a.axis===a.HORIZONTAL_AXIS?b=-a.detail:e=-a.detail:(b=a.wheelDeltaX,e=a.wheelDeltaY);c.translate(b,
e)},_setScrollWheelPan:function(a){this.map.isScrollWheelPan=a;this.mouseEvents.enableMouseWheel(a);D(this._mwMacHandle);this._mwMacHandle=null;a&&(this._mwMacHandle=C(this.mouseEvents,"onMouseWheel",this,this._wheelPan))},_recenter:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&this.map.centerAt(a.mapPoint)},_recenterZoom:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&(a.value=a.ctrlKey||a.metaKey?-1:1,this._wheelZoom(a,!0))},_dblClickZoom:function(a){this.map._isPanningOrZooming()||
(a.value=1,this._wheelZoom(a,!0))},_twoFingerTap:function(a){this.map._isPanningOrZooming()||(a.value=-1,this._wheelZoom(a,!0))},_keyDown:function(c){var e=c.keyCode,d=this.map;if(-1!==a.indexOf(H,e)){if(e===k.NUMPAD_PLUS||61===e||187===e)d._extentUtil({numLevels:1});else if(e===k.NUMPAD_MINUS||173===e||189===e)d._extentUtil({numLevels:-1});else{switch(d.__panning||d.__panStart(0,0),e){case k.UP_ARROW:case k.NUMPAD_8:this._keyDy+=10;break;case k.RIGHT_ARROW:case k.NUMPAD_6:this._keyDx-=10;break;case k.DOWN_ARROW:case k.NUMPAD_2:this._keyDy-=
10;break;case k.LEFT_ARROW:case k.NUMPAD_4:this._keyDx+=10;break;case k.PAGE_UP:case k.NUMPAD_9:this._keyDx-=10;this._keyDy+=10;break;case k.PAGE_DOWN:case k.NUMPAD_3:this._keyDx-=10;this._keyDy-=10;break;case k.END:case k.NUMPAD_1:this._keyDx+=10;this._keyDy-=10;break;case k.HOME:case k.NUMPAD_7:this._keyDx+=10;this._keyDy+=10;break;default:return}d.__pan(this._keyDx,this._keyDy)}b.stop(c)}},_keyEnd:function(a){var c=this.map;c.__panning&&a.keyCode!==k.SHIFT&&(c.__panEnd(this._keyDx,this._keyDy),
this._keyDx=this._keyDy=0)},_swipeInit:function(a){var c=this.map,c=c._zoomAnim||c._panAnim;return a.shiftKey?!1:(c&&c._active&&(c.stop(),c._fire("onEnd",[c.node])),this._dragOrigin=new x(0,0),l.mixin(this._dragOrigin,a.screenPoint),D(this._swipeHandle),D(this._swipeEndHandle),this._swipeHandle=C(this.touchEvents||this.pointerEvents,"onSwipeMove",this,this._swipe),void(this._swipeEndHandle=C(this.touchEvents||this.pointerEvents,"onSwipeEnd",this,this._swipeEnd)))},_swipe:function(a){var c=this.map;
c.__panning?(this._panX=a.screenPoint.x,this._panY=a.screenPoint.y,c.__pan(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y)):(c.setCursor("move"),c.__panStart(a.screenPoint.x,a.screenPoint.y))},_swipeEnd:function(a){D(this._swipeHandle);D(this._swipeEndHandle);this._swipeHandle=this._swipeEndHandle=null;var c=this.map;c.__panning&&(c.resetMapCursor(),c.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y))},_pinchInit:function(a){var c=this.map,b=c._zoomAnim||
c._panAnim;b&&b._active?(b.stop(),b._fire("onEnd",[b.node])):c.__panning&&(a.screenPoint=new x(this._panX,this._panY),a.mapPoint=c.toMap(a.screenPoint),this._swipeEnd(a));D(this._pinchHandle);D(this._pinchEndHandle);this._pinchHandle=C(this.touchEvents||this.pointerEvents,"onPinchMove",this,this._pinch);this._pinchEndHandle=C(this.touchEvents||this.pointerEvents,"onPinchEnd",this,this._pinchEnd)},_pinch:function(a){var c=this.map;if(a.screenPoints){this.currLength=A.getLength(a.screenPoints[0],a.screenPoints[1]);
var b;c.__zooming?(b=this.currLength/this._length,this._zoomStartExtent=this.__scaleExtent(c.extent,b,this._dragOrigin),c.__zoom(this._zoomStartExtent,b,this._dragOrigin)):(this._dragOrigin=new x((a.screenPoints[0].x+a.screenPoints[1].x)/2,(a.screenPoints[0].y+a.screenPoints[1].y)/2),this._length=this.currLength,c.__zoomStart(c.extent,this._dragOrigin));this._pinchScale=b;c._fireOnScale(this.currLength/this._length,this._dragOrigin,!0)}},_pinchEnd:function(a){a=this.map;if(D(this._pinchHandle),D(this._pinchEndHandle),
this._pinchHandle=this._pinchEndHandle=null,this._pinchScale=0,a.__zooming&&null===a._zoomAnim){var c=this.currLength/this._length,b=a.extent.getWidth();if(this._zoomAnimAnchor=a.toMap(this._dragOrigin),this._zoomStartExtent=this.__scaleExtent(a.extent,1/c,this._zoomAnimAnchor),a.__tileInfo){var e=w.getCandidateTileInfo(a,a.__tileInfo,this._zoomStartExtent),d=a.__getExtentForLevel(e.lod.level,this._zoomAnimAnchor),g=a.getMinZoom(),f=a.getMaxZoom(),k=d.extent,n=d.lod,m=b/k.getWidth(),t=e.lod.level;
1>c?m>c&&t--:c>m&&t++;g>t?t=g:t>f&&(t=f);t!==e.lod.level&&(d=a.__getExtentForLevel(t,this._zoomAnimAnchor),k=d.extent,n=d.lod);this._zoomEndExtent=k;this._zoomEndLod=n;a._zoomAnim=v.animateRange({range:{start:b/this._zoomStartExtent.getWidth(),end:m},duration:q.defaults.map.zoomDuration,rate:q.defaults.map.zoomRate,onAnimate:this._adjustPinch,onEnd:this._adjustPinchEnd});a._zoomAnim.play();a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin)}else this._zoomEndExtent=
this._zoomStartExtent,a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin),this._adjustPinchEnd()}},_adjustPinch:function(a){var c=this.__scaleExtent(this.map.extent,a,this._zoomAnimAnchor);this.map.__zoom(c,a,this._dragOrigin)},_adjustPinchEnd:function(){var a=this.map,c=a.extent.getWidth()/this._zoomEndExtent.getWidth(),b=this.__scaleExtent(a.extent,1/c,this._zoomAnimAnchor),e=this._dragOrigin,d=this._zoomEndLod;this._zoomStartExtent=this._zoomEndExtent=this._zoomEndLod=
this._dragOrigin=a._zoomAnim=this._zoomAnimAnchor=null;a.__zoomEnd(b,c,e,d,!0)},__scaleExtent:function(a,c,b){b=b||a.getCenter();c=a.expand(c);var e=a.xmin-(c.getWidth()-a.getWidth())*(b.x-a.xmin)/a.getWidth();b=a.ymax-(c.getHeight()-a.getHeight())*(b.y-a.ymax)/a.getHeight();return new y(e,b-c.getHeight(),e+c.getWidth(),b,a.spatialReference)},_normalizeRect:function(a){a=a.screenPoint;var c=this._dragOrigin.x,b=this._dragOrigin.y;a=new z((a.x<c?a.x:c)-this.map.__visibleRect.x,(a.y<b?a.y:b)-this.map.__visibleRect.y,
Math.abs(a.x-c),Math.abs(a.y-b));return delete a.spatialReference,0===a.width&&(a.width=1),0===a.height&&(a.height=1),a},setImmediateClick:function(a){switch(this.eventModel){case "mouse":this.mouseEvents.setImmediateClick(a);break;case "touch":this.touchEvents.setImmediateTap(a);this.mouseEvents&&this.mouseEvents.setImmediateClick(a);break;case "pointer":this.pointerEvents.setImmediateTap(a)}},enablePan:function(){switch(this.disablePan(),this.eventModel){case "mouse":this._panInitHandle=C(this.mouseEvents,
"onMouseDown",this,this._panInit);break;case "touch":this._panInitHandle=C(this.mouseEvents,"onMouseDown",this,this._panInit);this._swipeInitHandle=C(this.touchEvents,"onSwipeStart",this,this._swipeInit);break;case "pointer":this._swipeInitHandle=C(this.pointerEvents,"onSwipeStart",this,this._swipeInit)}},disablePan:function(){D(this._panInitHandle);this._panInitHandle=null;D(this._swipeInitHandle);this._swipeInitHandle=null},enableRubberBandZoom:function(){this.disableRubberBandZoom();this._zoomInitHandle=
this.pointerEvents?C(this.pointerEvents,"onSwipeStart",this,this._zoomInit):C(this.mouseEvents,"onMouseDown",this,this._zoomInit)},disableRubberBandZoom:function(){D(this._zoomInitHandle);this._zoomInitHandle=null},enablePinchZoom:function(){this.disablePinchZoom();"touch"!==this.eventModel&&"pointer"!==this.eventModel||(this._pinchInitHandle=C(this.touchEvents||this.pointerEvents,"onPinchStart",this,this._pinchInit))},disablePinchZoom:function(){D(this._pinchInitHandle);this._pinchInitHandle=null},
enableScrollWheelZoom:function(){this.disableScrollWheelZoom();this._wheelHandle=C(this.mouseEvents||this.pointerEvents,"onMouseWheel",this,this._wheelZoom)},disableScrollWheelZoom:function(){D(this._wheelHandle);this._wheelHandle=null},enableDoubleClickZoom:function(){switch(this.disableDoubleClickZoom(),this.eventModel){case "mouse":this._dblClickHandle=C(this.mouseEvents,"onDblClick",this,this._dblClickZoom);break;case "touch":this._dblClickHandle=C(this.mouseEvents,"onDblClick",this,this._dblClickZoom);
this._dblTapHandle=C(this.touchEvents,"onDoubleTap",this,this._dblClickZoom);this._zoomOutHandle=C(this.touchEvents,"onTwoFingerTap",this,this._twoFingerTap);break;case "pointer":this._dblTapHandle=C(this.pointerEvents,"onDoubleTap",this,this._dblClickZoom),this._zoomOutHandle=C(this.pointerEvents,"onTwoFingerTap",this,this._twoFingerTap)}},disableDoubleClickZoom:function(){D(this._dblClickHandle);D(this._zoomOutHandle);this._dblTapHandle&&D(this._dblTapHandle);this._dblClickHandle=this._zoomOutHandle=
this._dblTapHandle=null},enableShiftDoubleClickZoom:function(){this.disableShiftDoubleClickZoom();this._sDblClickHandle=C(this.pointerEvents||this.mouseEvents,"onDblClick",this,this._recenterZoom)},disableShiftDoubleClickZoom:function(){D(this._sDblClickHandle);this._sDblClickHandle=null},enableClickRecenter:function(){this.disableClickRecenter();this._recenterHandle=C(this.pointerEvents||this.mouseEvents,"onClick",this,this._recenter)},disableClickRecenter:function(){D(this._recenterHandle);this._recenterHandle=
null},enableKeyboardNavigation:function(){this.disableKeyboardNavigation();this._keyHandle=C(this.pointerEvents||this.mouseEvents,"onKeyDown",this,this._keyDown);this._keyEndHandle=C(this.pointerEvents||this.mouseEvents,"onKeyUp",this,this._keyEnd)},disableKeyboardNavigation:function(){D(this._keyHandle);D(this._keyEndHandle);this._keyHandle=this._keyEndHandle=null},enableNavigation:function(){var a=this.map;a&&a.loaded&&(a.enableDoubleClickZoom(),a.enableClickRecenter(),a.enablePan(),a.enableRubberBandZoom(),
this.enablePinchZoom(),a.enableKeyboardNavigation(),a.smartNavigation?this._setScrollWheelPan(!0):a.enableScrollWheelZoom())},disableNavigation:function(){var a=this.map;a&&a.loaded&&(a.disableDoubleClickZoom(),a.disableClickRecenter(),a.disablePan(),a.disableRubberBandZoom(),this.disablePinchZoom(),a.disableKeyboardNavigation(),a.disableScrollWheelZoom(),a.smartNavigation&&this._setScrollWheelPan(!1))},destroy:function(){this.touchEvents&&this.touchEvents.destroy();this.mouseEvents&&this.mouseEvents.destroy();
this.pointerEvents&&this.pointerEvents.destroy();var a,c=[this._panInitHandle,this._panStartHandle,this._panHandle,this._panEndHandle,this._zoomInitHandle,this._zoomHandle,this._zoomEndHandle,this._wheelHandle,this._mwMacHandle,this._dblClickHandle,this._zoomOutHandle,this._recenterHandle,this._sDblClickHandle,this._dblTapHandle,this._keyHandle,this._keyEndHandle,this._swipeInitHandle,this._swipeHandle,this._swipeEndHandle,this._pinchInitHandle,this._pinchHandle,this._pinchEndHandle];for(a=0;a<c.length;a++)D(c[a]);
this.map=this.touchEvents=this.mouseEvents=this.eventModel=this.pointerEvents=this._zoomRect=this._dragOrigin=this._panInitHandle=this._panStartHandle=this._panHandle=this._panEndHandle=this._zoomInitHandle=this._zoomHandle=this._zoomEndHandle=this._wheelHandle=this._mwMacHandle=this._dblClickHandle=this._zoomOutHandle=this._recenterHandle=this._sDblClickHandle=this._dblTapHandle=this._keyHandle=this._keyEndHandle=this._swipeInitHandle=this._swipeHandle=this._swipeEndHandle=this._pinchInitHandle=
this._pinchHandle=this._pinchEndHandle=null}});return r("extend-esri")&&(g.MapNavigationManager=h),h})},"esri/MouseEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/_base/connect dojo/_base/event ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(h,l,a,d,b,f,k,m,g,e){var c=b.connect,n=b.disconnect;h=h([m],{declaredClass:"esri.MouseEvents",doubleClickDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==d("mac")?
1:3,wheelDivisor:2>d("chrome")?360:120,preventPageScroll:!0,map:null,constructor:function(b,e){this.node=b;a.mixin(this,e);var g=function(a){return f.stop(a),!1};d("mozilla")&&l.style(b,"MozUserSelect","none");this._handles=[c(b,"onselectstart",g),c(b,"ondragstart",g),c(b,"onmouseenter",this,this._onMouseEnterHandler),c(b,"onmouseleave",this,this._onMouseLeaveHandler),c(b,"onmousedown",this,this._onMouseDownHandler),c(b,"onclick",this,this._onClickHandler),c(b,"ondblclick",this,this._onDblClickHandler)];
this._onMouseMoveHandler_connect=c(b,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=c(b,"onmouseup",this,this._onMouseUpHandler);this._fireClickEvent=a.hitch(this,this._fireClickEvent);this._initialDuration=this.doubleClickDuration;this.preventPageScroll=(g=this.map)?g.isScrollWheelZoom||g.isScrollWheelPan:this.preventPageScroll;this.enableMouseWheel(!1)},_fire:function(a,c){(!this._preventClick||"onClick"!==a&&"onDblClick"!==a)&&(this[a]&&this[a](c),this.map&&this.map[a]&&
this.map[a](c))},_processEvent:function(a){a=f.fix(a,a.target);var c=this.map,b=c&&c.position;return b&&("DOMMouseScroll"===a.type&&3>d("ff")?a.screenPoint=new e(window.scrollX+a.screenX-b.x,window.scrollY+a.screenY-b.y):a.screenPoint=new e(a.pageX-b.x,a.pageY-b.y),a.mapPoint=c.extent?c.toMap(a.screenPoint):new g),a.numPoints=0,a},_onMouseEnterHandler:function(a){n(this._onKeyDown_connect);n(this._onKeyUp_connect);this._onKeyDown_connect=c(document,"onkeydown",this,this._onKeyDownHandler);this._onKeyUp_connect=
c(document,"onkeyup",this,this._onKeyUpHandler);this._fire("onMouseOver",this._processEvent(a))},_onMouseLeaveHandler:function(a){n(this._onKeyDown_connect);n(this._onKeyUp_connect);this._onKeyDown_connect=this._onKeyUp_connect=null;this._fire("onMouseOut",this._processEvent(a))},_onMouseMoveHandler:function(a){return this._dragEnd?void(this._dragEnd=!1):void this._fire("onMouseMove",this._processEvent(a))},_onMouseDownHandler:function(a){n(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=
null;this.node.setCapture&&this.node.setCapture(!1);n(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=c(document,"onmousemove",this,this._onMouseDragHandler);this._startX=a.pageX;this._startY=a.pageY;this._fire("onMouseDown",this._processEvent(a))},_onMouseUpHandler:function(a){var b=this.node;b.releaseCapture&&b.releaseCapture();n(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=null;n(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=c(b,"onmousemove",
this,this._onMouseMoveHandler);this._fire("onMouseUp",this._processEvent(a))},_onMouseDragHandler:function(a){n(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=c(document,"onmousemove",this,this._onMouseDraggingHandler);n(this._onMouseUpHandler_connect);this._onMouseUpHandler_connect=c(document,"onmouseup",this,this._onDragMouseUpHandler);this._docLeaveConnect=c(document,"onmouseout",this,this._onDocMouseOut);this._fire("onMouseDragStart",this._processEvent(a))},_onMouseDraggingHandler:function(a){f.stop(a);
this._fire("onMouseDrag",this._processEvent(a))},_onDragMouseUpHandler:function(a){var b=this.node;b.releaseCapture&&b.releaseCapture();this._dragEnd=!0;n(this._docLeaveConnect);n(this._onMouseDragHandler_connect);n(this._onMouseUpHandler_connect);this._docLeaveConnect=this._onMouseDragHandler_connect=null;this._onMouseMoveHandler_connect=c(b,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=c(b,"onmouseup",this,this._onMouseUpHandler);a=this._processEvent(a);this._fire("onMouseDragEnd",
a);this._fire("onMouseUp",a)},_onDocMouseOut:function(a){var c=9>d("ie")?a.toElement:a.relatedTarget,b=c&&c.nodeName.toLowerCase();(!c||d("chrome")&&"html"===b)&&this._onDragMouseUpHandler(a)},_onClickHandler:function(a){if(a=this._processEvent(a),a.pageX===this._startX&&a.pageY===this._startY){clearTimeout(this._clickTimer);var c={},b="movementX"in a,e;for(e in a)(!b||"webkitMovementX"!==e&&"webkitMovementY"!==e)&&(c[e]=a[e]);this._clickEvent=c;this._clickTimer=setTimeout(this._fireClickEvent,this.doubleClickDuration)}},
_fireClickEvent:function(){clearTimeout(this._clickTimer);9>d("ie")&&(this._clickEvent.graphic=k._ieGraphic,delete k._ieGraphic);this._fire("onClick",this._clickEvent)},_onDblClickHandler:function(a){clearTimeout(this._clickTimer);this._fire("onDblClick",this._processEvent(a))},_onMouseWheelHandler:function(a){var c=this.map;(c?c.isScrollWheelZoom||c.isScrollWheelPan:this.preventPageScroll)&&f.stop(a);var c=d("ff")||d("mozilla")?-a.detail/this.mozWheelDivisor:a.wheelDelta/this.wheelDivisor,b=Math.abs(c),
b=b<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;a.value=0>c?-b:b;this._fire("onMouseWheel",this._processEvent(a))},_onKeyDownHandler:function(a){this._fire("onKeyDown",a)},_onKeyUpHandler:function(a){this._fire("onKeyUp",a)},enableMouseWheel:function(a){n(this._scrollHandle);this._scrollHandle=c(this.node,d("ff")||d("mozilla")?a?"MozMousePixelScroll":"DOMMouseScroll":"onmousewheel",this,this._onMouseWheelHandler)},setImmediateClick:function(a){this.doubleClickDuration=a?0:this._initialDuration},
preventClickEvents:function(a){this._preventClick=a},destroy:function(){var a,c=this._handles.concat([this._onMouseMoveHandler_connect,this._onMouseUpHandler_connect,this._onMouseDragHandler_connect,this._scrollHandle,this._onKeyDown_connect,this._onKeyUp_connect,this._docLeaveConnect]);for(a=0;a<c.length;a++)n(c[a]);clearTimeout(this._clickTimer);this.node=this.map=this._handles=this._clickEvent=this._onMouseMoveHandler_connect=this._onMouseUpHandler_connect=this._onMouseDragHandler_connect=this._scrollHandle=
this._onKeyDown_connect=this._onKeyUp_connect=this._docLeaveConnect=null}});return d("extend-esri")&&(k.MouseEvents=h),h})},"dojo/_base/html":function(){define("./kernel ../dom ../dom-style ../dom-attr ../dom-prop ../dom-class ../dom-construct ../dom-geometry".split(" "),function(h,l,a,d,b,f,k,m){h.byId=l.byId;h.isDescendant=l.isDescendant;h.setSelectable=l.setSelectable;h.getAttr=d.get;h.setAttr=d.set;h.hasAttr=d.has;h.removeAttr=d.remove;h.getNodeProp=d.getNodeProp;h.attr=function(a,b,c){return 2==
arguments.length?d["string"==typeof b?"get":"set"](a,b):d.set(a,b,c)};h.hasClass=f.contains;h.addClass=f.add;h.removeClass=f.remove;h.toggleClass=f.toggle;h.replaceClass=f.replace;h._toDom=h.toDom=k.toDom;h.place=k.place;h.create=k.create;h.empty=function(a){k.empty(a)};h._destroyElement=h.destroy=function(a){k.destroy(a)};h._getPadExtents=h.getPadExtents=m.getPadExtents;h._getBorderExtents=h.getBorderExtents=m.getBorderExtents;h._getPadBorderExtents=h.getPadBorderExtents=m.getPadBorderExtents;h._getMarginExtents=
h.getMarginExtents=m.getMarginExtents;h._getMarginSize=h.getMarginSize=m.getMarginSize;h._getMarginBox=h.getMarginBox=m.getMarginBox;h.setMarginBox=m.setMarginBox;h._getContentBox=h.getContentBox=m.getContentBox;h.setContentSize=m.setContentSize;h._isBodyLtr=h.isBodyLtr=m.isBodyLtr;h._docScroll=h.docScroll=m.docScroll;h._getIeDocumentElementOffset=h.getIeDocumentElementOffset=m.getIeDocumentElementOffset;h._fixIeBiDiScrollLeft=h.fixIeBiDiScrollLeft=m.fixIeBiDiScrollLeft;h.position=m.position;h.marginBox=
function(a,b){return b?m.setMarginBox(a,b):m.getMarginBox(a)};h.contentBox=function(a,b){return b?m.setContentSize(a,b):m.getContentBox(a)};h.coords=function(b,e){h.deprecated("dojo.coords()","Use dojo.position() or dojo.marginBox().");b=l.byId(b);var c=a.getComputedStyle(b),c=m.getMarginBox(b,c),d=m.position(b,e);c.x=d.x;c.y=d.y;return c};h.getProp=b.get;h.setProp=b.set;h.prop=function(a,e,c){return 2==arguments.length?b["string"==typeof e?"get":"set"](a,e):b.set(a,e,c)};h.getStyle=a.get;h.setStyle=
a.set;h.getComputedStyle=a.getComputedStyle;h.__toPixelValue=h.toPixelValue=a.toPixelValue;h.style=function(b,e,c){switch(arguments.length){case 1:return a.get(b);case 2:return a["string"==typeof e?"get":"set"](b,e)}return a.set(b,e,c)};return h})},"esri/TouchEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/dom ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(h,l,a,d,b,f,k,m,g){h=h([k],{declaredClass:"esri.TouchEvents",
tapRadius:8,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,map:null,constructor:function(b,c){this.node=b;a.mixin(this,c);l.setSelectable(b,!1);this._touchStart=a.hitch(this,this._touchStart);this._touchMove=a.hitch(this,this._touchMove);this._touchEnd=a.hitch(this,this._touchEnd);this._touchCancel=a.hitch(this,this._touchCancel);b.addEventListener("touchstart",this._touchStart,!1);b.addEventListener("touchmove",this._touchMove,!1);b.addEventListener("touchend",this._touchEnd,!1);b.addEventListener("touchcancel",
this._touchCancel,!1);this.map&&d("ios")&&(this._mouseOver=a.hitch(this,this._mouseOver),this._mouseOut=a.hitch(this,this._mouseOut),this._mouseDown=a.hitch(this,this._mouseDown),this._mouseUp=a.hitch(this,this._mouseUp),this._mouseClick=a.hitch(this,this._mouseClick),b.addEventListener("mouseover",this._mouseOver,!1),b.addEventListener("mouseout",this._mouseOut,!1),b.addEventListener("mousedown",this._mouseDown,!1),b.addEventListener("mouseup",this._mouseUp,!1),b.addEventListener("click",this._mouseClick,
!1));this._numTouches=0;this._nodeTouches=[];this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_touchStart:function(a){var c,b,g,f,k,m=this._touches,t=a.changedTouches.length,h=(new Date).getTime();if(!(d("android")&&d("safari")&&1===a.targetTouches.length&&a.touches.length===a.targetTouches.length&&a.targetTouches.length===a.changedTouches.length&&0===a.changedTouches[0].identifier&&m[a.changedTouches[0].identifier])){this._addTouch(a);for(c=0;t>c;c++)b=a.changedTouches[c],g=m[b.identifier]=
{},g.startX=b.pageX,g.startY=b.pageY,g.startTS=h,-1===this._touchIds.indexOf(b.identifier)&&this._touchIds.push(b.identifier);this._swipeActive&&(f=this._nodeTouches[0]);this._pinchActive&&(k=this._nodeTouches[1]);1===this._numTouches?this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(a,f))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(a,[f,k]))):2===this._numTouches?this._swipeActive&&(f&&(g=m[this._touchIds[0]],g.startX=
f.pageX,g.startY=f.pageY,g.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(a,f))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(a,f))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(a,[f,k])))}},_touchMove:function(a){a.preventDefault();this._updateTouch(a);var c,b,g,f,k,m,t=this._touches,h=a.changedTouches.length;if(!(d("android")&&d("safari")&&1===a.targetTouches.length&&a.touches.length===
a.targetTouches.length&&a.targetTouches.length===a.changedTouches.length&&0===a.changedTouches[0].identifier&&t[a.changedTouches[0].identifier]&&1<this._touchIds.length)){for(c=0;h>c;c++)b=a.changedTouches[c],(g=t[b.identifier])&&(f=Math.abs(b.pageX-g.startX),k=Math.abs(b.pageY-g.startY),!g.moved&&(f>=this.tapRadius||k>=this.tapRadius)&&(g.moved=g.absMoved=!0),m=m?m:g.moved);1===this._numTouches?(c=a.changedTouches[0],this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(a,c)):m&&(this._swipeActive=
!0,this._fire("onSwipeStart",this._processTouchEvent(a,c)))):2===this._numTouches&&(c=this._nodeTouches[0],b=this._nodeTouches[1],this._pinchActive?this._fire("onPinchMove",this._processTouchEvent(a,[c,b])):m&&(m=t[c.identifier],g=t[b.identifier],t=Math.abs(m.startX-g.startX),m=Math.abs(m.startY-g.startY),m=Math.sqrt(t*t+m*m),t=Math.abs(c.pageX-b.pageX),g=Math.abs(c.pageY-b.pageY),t=Math.sqrt(t*t+g*g),Math.abs(t-m)>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(a,
[c,b])))))}},_touchEnd:function(a){this._removeTouch(a);var c,b,d,g=this._touches,f=a.changedTouches,k=f.length,m=(new Date).getTime(),h=this._touchIds;for(c=0;k>c;c++)(d=g[f[c].identifier])&&(d.absMoved&&(b=!0),d.pageX=f[c].pageX,d.pageY=f[c].pageY,d.endTS=m);if(0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(a,f[0]));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(a,
f));else{if(!b){b=1/0;var k=-(1/0),m=1/0,l=-(1/0),y=this.tapStartTolerance,z=[],A=!0;for(c=0;c<h.length;c++)d=g[h[c]],z.push(d),d.startTS<b&&(b=d.startTS),d.startTS>k&&(k=d.startTS),d.endTS<m&&(m=d.endTS),d.endTS>l&&(l=d.endTS),delete g[h[c]];1===z.length&&f[0]&&(d=Math.abs(f[0].pageX-z[0].startX),f=Math.abs(f[0].pageY-z[0].startY),(d>=this.tapRadius||f>=this.tapRadius)&&(A=!1));A&&Math.abs(k-b)<=y&&Math.abs(l-m)<=y&&this._basicTap(a,z)}}else 1===this._numTouches&&this._pinchActive&&(c=this._nodeTouches[0],
d=g[c.identifier],d.startX=c.pageX,d.startY=c.pageY,this._pinchActive=d.moved=!1,this._fire("onPinchEnd",this._processTouchEvent(a,[f[0],c])))},_touchCancel:function(a){this._numTouches&&this._touchEnd(a)},_basicTap:function(a,c){var b=(new Date).getTime(),d=this;(a=this._processTouchEvent(a,c),this._taps.push({touchInfos:c,ts:b,event:a}),2<this._taps.length&&this._taps.shift(),this._fire("onBasicTap",a),clearTimeout(this._tapTimer),this._immediate)?this._analyzeTap(!0):this._tapTimer=setTimeout(function(){var a=
d;d=null;clearTimeout(a._tapTimer);a._analyzeTap()},2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration)},_analyzeTap:function(a){var c=this._taps,b=c[0],d=c[1],g=b.touchInfos,f=d&&d.touchInfos;if(c.length)if(a||(this._taps=[]),b&&d)if(g.length===f.length)if(d.ts-b.ts<=this.doubleTapDuration){var k,m,h;1===g.length?(m=Math.abs(g[0].startX-f[0].startX),h=Math.abs(g[0].startY-f[0].startY),k=m<=this.doubleTapRadius&&h<=this.doubleTapRadius):k=!0;k?this._processedDoubleTap(c):this._processedTap(d)}else this._processedTap(d);
else this._processedTap(d);else this._processedTap(b||d)},_processedTap:function(a){var c=a.event;this._fire("onProcessedTap",c);1===a.touchInfos.length?this._fire("onTap",this._fixEvent(c)):2===a.touchInfos.length&&this._fire("onTwoFingerTap",c)},_processedDoubleTap:function(a){var c,b=1===a[1].touchInfos.length;b&&(c=[this._fixEvent(a[0].event),this._fixEvent(a[1].event)],c[1].relatedEvents=c);a=[a[0].event,a[1].event];a[1].relatedEvents=a;this._fire("onProcessedDoubleTap",a[1]);b&&(this._fire("onDoubleTap",
c[1]),this._fire("onDblClick",c[1]))},_addTouch:function(a){var c,d,g,f=a.changedTouches,k=this._nodeTouches;this._numTouches+=f.length;for(a=0;a<f.length;a++){d=k.length;g=!1;for(c=0;d>c&&!(g=k[c].identifier===f[a].identifier);c++);g?this._numTouches--:k.push(f[a])}for(a=k.length-1;0<=a;a--)b.isDescendant(k[a].target,document.body)||(k.splice(a,1),this._numTouches--);0>this._numTouches&&(this._numTouches=0)},_removeTouch:function(a){var c=[],b=[],d=a.changedTouches,g=this._nodeTouches;this._numTouches-=
d.length;0>this._numTouches&&(this._numTouches=0);for(a=0;a<d.length;a++)c.push(d[a].identifier);for(a=g.length-1;0<=a;a--)-1!==c.indexOf(g[a].identifier)&&b.push(g.splice(a,1)[0]);return b},_updateTouch:function(a){var c,b=[],d=a.changedTouches,g=this._nodeTouches;for(a=0;a<d.length;a++)b.push(d[a].identifier);for(a=0;a<g.length;a++)c=b.indexOf(g[a].identifier),-1!==c&&g.splice(a,1,d[c])},_mouseOver:function(a){this._fire("onMouseOver",this._processMouseEvent(a))},_mouseOut:function(a){this._fire("onMouseOut",
this._processMouseEvent(a))},_mouseDown:function(a){this._fire("onMouseDown",this._processMouseEvent(a))},_mouseUp:function(a){this._fire("onMouseUp",this._processMouseEvent(a))},_mouseClick:function(a){this._fire("onClick",this._processMouseEvent(a))},_fire:function(a,c){if("onDblClick"===a&&this.mouseEvents){this.mouseEvents.preventClickEvents(!0);var b=this;setTimeout(function(){b.mouseEvents.preventClickEvents(!1)},350)}this[a]&&this[a](c);this.map&&this.map[a]&&this.map[a](c)},_fixEvent:function(a){var c,
b={};for(c in a)b[c]=a[c];return this.map&&(b.screenPoint=b.screenPoints[0],b.mapPoint=b.mapPoints[0]),b},_processTouchEvent:function(b,c){var d=this.map,f=d&&d.position,k=0;if(f&&c)if(a.isArray(c)){var h,v;b.screenPoints=[];b.mapPoints=[];for(h=0;h<c.length;h++)c[h]?(v=new g(c[h].pageX-f.x,c[h].pageY-f.y),b.screenPoints.push(v),b.mapPoints.push(d.extent?d.toMap(v):new m)):k++}else b.screenPoint=new g(c.pageX-f.x,c.pageY-f.y),b.mapPoint=d.extent?d.toMap(b.screenPoint):new m;return b.numPoints=c?a.isArray(c)?
c.length-k:1:0,b},_processMouseEvent:function(a){var c=this.map,b=c&&c.position;return b&&(a.screenPoint=new g(a.pageX-b.x,a.pageY-b.y),a.mapPoint=c.extent?c.toMap(a.screenPoint):new m),a},setImmediateTap:function(a){this._immediate=a},destroy:function(){var a=this.node;a.removeEventListener("touchstart",this._touchStart,!1);a.removeEventListener("touchmove",this._touchMove,!1);a.removeEventListener("touchend",this._touchEnd,!1);a.removeEventListener("touchcancel",this._touchCancel,!1);this.map&&
(a.removeEventListener("mouseover",this._mouseOver,!1),a.removeEventListener("mouseout",this._mouseOut,!1),a.removeEventListener("mousedown",this._mouseDown,!1),a.removeEventListener("mouseup",this._mouseUp,!1),a.removeEventListener("click",this._mouseClick,!1));l.setSelectable(a,!0);clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._nodeTouches=this._touches=this._touchIds=this._taps=null}});return d("extend-esri")&&(f.TouchEvents=h),h})},"esri/PointerEvents":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),
function(h,l,a,d,b,f,k,m){h=h([f],{declaredClass:"esri.PointerEvents",tapRadius:8,clickRadius:2,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==d("mac")?1:3,wheelDivisor:120,preventPageScroll:!0,_dragging:!1,constructor:function(a,b){this.node=a;l.mixin(this,b);void 0!==a.style.msTouchAction?a.style.msTouchAction="none":void 0!==a.style.touchAction&&(a.style.touchAction="none");var c=navigator.msPointerEnabled,d=function(a){a.preventDefault()};
a.addEventListener("selectstart",d,!1);a.addEventListener("dragstart",d,!1);this._pointerDown=l.hitch(this,this._pointerDown);this._pointerMove=l.hitch(this,this._pointerMove);this._pointerUp=l.hitch(this,this._pointerUp);this._pointerCancel=l.hitch(this,this._pointerCancel);a.addEventListener(c?"MSPointerDown":"pointerdown",this._pointerDown,!1);a.addEventListener(c?"MSPointerMove":"pointermove",this._pointerMove,!1);a.addEventListener(c?"MSPointerUp":"pointerup",this._pointerUp,!1);a.addEventListener(c?
"MSPointerCancel":"pointercancel",this._pointerCancel,!1);this.map&&(this._mouseOver=l.hitch(this,this._mouseOver),this._mouseOut=l.hitch(this,this._mouseOut),this._mouseLeave=l.hitch(this,this._mouseLeave),this._mouseDown=l.hitch(this,this._mouseDown),this._mouseUp=l.hitch(this,this._mouseUp),this._mouseClick=l.hitch(this,this._mouseClick),this._mouseWheel=l.hitch(this,this._mouseWheel),this._mouseMove=l.hitch(this,this._mouseMove),this._mouseEnter=l.hitch(this,this._mouseEnter),this._onKeyDown=
l.hitch(this,this._onKeyDown),this._onKeyUp=l.hitch(this,this._onKeyUp),a.addEventListener("mouseover",this._mouseOver,!1),a.addEventListener("mouseout",this._mouseOut,!1),a.addEventListener("mouseleave",this._mouseLeave,!1),a.addEventListener("mousedown",this._mouseDown,!1),a.addEventListener("mouseup",this._mouseUp,!1),a.addEventListener("click",this._mouseClick,!1),a.addEventListener("mousewheel",this._mouseWheel,!1),a.addEventListener("mousemove",this._mouseMove,!1),a.addEventListener("mouseenter",
this._mouseEnter,!1));this._numTouches=0;this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_pointerDown:function(b){if(-1<a.indexOf(this._touchIds,b.pointerId))return void this._pointerUp(b);var e,c;c=this._touches;var d=b.target,f=b.pointerId,k=this._touchIds,m=(new Date).getTime();e=c[f]={};e.pointerId=f;e.startX=e.pageX=b.pageX;e.startY=e.pageY=b.pageY;e.startTS=m;k.push(f);this._numTouches++;d.setPointerCapture?d.setPointerCapture(f):d.msSetPointerCapture&&d.msSetPointerCapture(f);
e=c[k[0]];c=c[k[1]];1===this._numTouches||(2===this._numTouches?this._swipeActive&&(e&&(e.startX=e.pageX,e.startY=e.pageY,e.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(b,e))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(b,e))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(b,[e,c]))))},_pointerMove:function(a){var b,c,d,f=this._touches,k=this._touchIds;if(b=f[a.pointerId],b&&(b.pageX!==
a.pageX||b.pageY!==a.pageY))if(b.pageX=a.pageX,b.pageY=a.pageY,c=Math.abs(b.pageX-b.startX),d=Math.abs(b.pageY-b.startY),!b.moved&&(c>=this.tapRadius||d>=this.tapRadius)&&(b.moved=b.absMoved=!0),1===this._numTouches)this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(a,a)):b.moved&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(a,a)));else if(2===this._numTouches)if(b=f[k[0]],f=f[k[1]],this._pinchActive)this._fire("onPinchMove",this._processTouchEvent(a,[b,
f]));else if(b.moved||f.moved)k=Math.abs(b.startX-f.startX),c=Math.abs(b.startY-f.startY),k=Math.sqrt(k*k+c*c),c=Math.abs(b.pageX-f.pageX),d=Math.abs(b.pageY-f.pageY),c=Math.sqrt(c*c+d*d),Math.abs(c-k)>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(a,[b,f])))},_pointerUp:function(b){var e,c=this._touches,d=this.node,f=b.target,k=b.pointerId,m=this._touchIds,h=m.slice(0),t=a.map(h,function(a){return c[a]}),l=(new Date).getTime();if(e=c[k])if(e.pageX=b.pageX,
e.pageY=b.pageY,e.endTS=l,this._numTouches--,f.releasePointerCapture?f.releasePointerCapture(k):f.msReleasePointerCapture&&f.msReleasePointerCapture(k),0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(b,b));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(b,b));else{if(!e.absMoved){for(var k=1/0,m=-(1/0),l=1/0,x=-(1/0),y=this.tapStartTolerance,f=0;f<h.length;f++)e=
t[f],e.startTS<k&&(k=e.startTS),e.startTS>m&&(m=e.startTS),e.endTS<l&&(l=e.endTS),e.endTS>x&&(x=e.endTS);Math.abs(m-k)<=y&&Math.abs(x-l)<=y&&this._basicTap(b,t)}}else if(1===this._numTouches&&this._pinchActive){m.splice(a.indexOf(m,b.pointerId),1);delete c[b.pointerId];e=c[m[0]];if(e.startX=e.pageX,e.startY=e.pageY,e.moved=!1,document.msElementsFromPoint)h=document.msElementsFromPoint(e.pageX,e.pageY),a.some(h,function(a){return a===d})||(this._touches={},this._touchIds=[],this._numTouches=0);this._pinchActive=
!1;this._fire("onPinchEnd",this._processTouchEvent(b,[b,e]))}},_pointerCancel:function(a){this._numTouches&&this._pointerUp(a)},_basicTap:function(a,b){var c=(new Date).getTime(),d=this,f=this._immediate;a=this._processTouchEvent(a,b);this._taps.push({touchInfos:b,ts:c,event:a});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",a);clearTimeout(this._tapTimer);c=2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration;this._tapTimer=setTimeout(function(){var a=d;d=null;clearTimeout(a._tapTimer);
a._analyzeTap(f)},f?0:c)},_analyzeTap:function(a){var b=this._taps,c=b[0],d=b[1],f=c.touchInfos,k=d&&d.touchInfos;if(b.length)if(a||(this._taps=[]),c&&d)if(f.length===k.length)if(d.ts-c.ts<=this.doubleTapDuration){var m,h,t;1===f.length?(h=Math.abs(f[0].startX-k[0].startX),t=Math.abs(f[0].startY-k[0].startY),m=h<=this.doubleTapRadius&&t<=this.doubleTapRadius):m=!0;m?this._processedDoubleTap(b):this._processedTap(d)}else this._processedTap(d);else this._processedTap(d);else this._processedTap(c||d)},
_processedTap:function(a){var b=a.event;this._fire("onProcessedTap",b);1===a.touchInfos.length?this._fire("onTap",this._fixEvent(b)):2===a.touchInfos.length&&this._fire("onTwoFingerTap",b)},_processedDoubleTap:function(a){var b,c=1===a[1].touchInfos.length;c&&(b=[this._fixEvent(a[0].event),this._fixEvent(a[1].event)],b[1].relatedEvents=b);a=[a[0].event,a[1].event];a[1].relatedEvents=a;this._fire("onProcessedDoubleTap",a[1]);c&&(this._fire("onDoubleTap",b[1]),this._fire("onDblClick",b[1]))},_mouseOver:function(a){this._fire("onMouseOver",
this._processMouseEvent(a))},_mouseMove:function(a){this._dragging?this._fire("onMouseDrag",this._processMouseEvent(a)):this._fire("onMouseMove",this._processMouseEvent(a))},_mouseOut:function(a){this._fire("onMouseOut",this._processMouseEvent(a))},_mouseLeave:function(a){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseOut",this._processMouseEvent(event))},_mouseDown:function(a){this._downX=a.pageX;this._downY=a.pageY;
this._fire("onMouseDown",this._processMouseEvent(a));0===a.button&&(this._dragging=!0,this._fire("onMouseDragStart",this._processMouseEvent(a)))},_mouseUp:function(a){this._dragging&&(this._dragging=!1,this._fire("onMouseDragEnd",this._processMouseEvent(a)));this._fire("onMouseUp",this._processMouseEvent(a))},_mouseClick:function(a){Math.abs(a.pageX-this._downX)<=this.clickRadius&&Math.abs(a.pageY-this._downY)<=this.clickRadius&&this._fire("onClick",this._processMouseEvent(a))},_mouseWheel:function(a){var b=
this.map;(b?b.isScrollWheelZoom||b.isScrollWheelPan:this.preventPageScroll)&&a.preventDefault();var b=a.wheelDelta?a.wheelDelta/this.wheelDivisor:-a.detail/this.mozWheelDivisor,c=Math.abs(b),c=c<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;a.value=0>b?-c:c;this._fire("onMouseWheel",this._processMouseEvent(a))},_mouseEnter:function(a){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);document.addEventListener("keydown",this._onKeyDown,
!1);document.addEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseEnter",this._processMouseEvent(a))},_onKeyDown:function(a){this._fire("onKeyDown",a)},_onKeyUp:function(a){this._fire("onKeyUp",a)},_fire:function(a,b){this[a]&&this[a](b);this.map&&this.map[a]&&this.map[a](b)},_fixEvent:function(a){var b,c={};for(b in a)c[b]=a[b];return c.preventDefault=function(){a.preventDefault()},c.stopPropagation=function(){a.stopPropagation()},this.map&&(c.screenPoint=c.screenPoints[0],c.mapPoint=c.mapPoints[0]),
c},_processTouchEvent:function(a,b){var c=this.map,d=c&&c.position,f=0;if(d&&b)if(l.isArray(b)){var h,u;a.screenPoints=[];a.mapPoints=[];for(h=0;h<b.length;h++)b[h]?(u=new m(b[h].pageX-d.x,b[h].pageY-d.y),a.screenPoints.push(u),a.mapPoints.push(c.extent?c.toMap(u):new k)):f++}else a.screenPoint=new m(b.pageX-d.x,b.pageY-d.y),a.mapPoint=c.extent?c.toMap(a.screenPoint):new k;return a.numPoints=b?l.isArray(b)?b.length-f:1:0,a},_processMouseEvent:function(a){var b=this.map,c=b&&b.position;return c&&(a.screenPoint=
new m(a.pageX-c.x,a.pageY-c.y),a.mapPoint=b.extent?b.toMap(a.screenPoint):new k),a},setImmediateTap:function(a){this._immediate=a},destroy:function(){var a=this.node;a.removeEventListener("MSPointerDown",this._pointerDown,!1);a.removeEventListener("MSPointerMove",this._pointerMove,!1);a.removeEventListener("MSPointerUp",this._pointerUp,!1);a.removeEventListener("MSPointerCancel",this._pointerCancel,!1);this.map&&(a.removeEventListener("mouseover",this._mouseOver,!1),a.removeEventListener("mousemove",
this._mouseMove,!1),a.removeEventListener("mouseout",this._mouseOut,!1),a.removeEventListener("mouseleave",this._mouseLeave,!1),a.removeEventListener("mousedown",this._mouseDown,!1),a.removeEventListener("mouseup",this._mouseUp,!1),a.removeEventListener("click",this._mouseClick,!1),a.removeEventListener("mouseenter",this._mouseEnter,!1));clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._touches=this._touchIds=this._taps=null}});return d("extend-esri")&&(b.PointerEvents=h),h})},
"esri/IdentityManager":function(){define(["./IdentityManagerDialog","./kernel","./OAuthSignInHandler","dojo/_base/declare"],function(h,l,a,d){h=new h;return l.id=d.safeMixin(h,a),l.id})},"esri/IdentityManagerDialog":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/has dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ./kernel ./lang ./domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/jsapi dojo/query dijit/form/Button dijit/form/Form dijit/form/ValidationTextBox".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v){l=l([u],{declaredClass:"esri.IdentityManager",_eventMap:{"dialog-cancel":["info"]},constructor:function(a){b.mixin(this,a);this.registerConnectEvents()},_dialogContent:"\x3cdiv data-dojo-type\x3d'dijit.form.Form' data-dojo-props\x3d'\"class\":\"esriIdForm\"'\x3e\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblUser}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblPwd}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
onDialogCreate:function(){},onDialogCancel:function(){},signIn:function(c,b,e){this._nls||(this._nls=v.identity);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.onDialogCreate());var g=this._loginDialog,f=e&&e.error,n=e&&e.token,m=new d(function(){g.onCancel()});return g.open?(c=Error("BUSY"),c.code="IdentityManager.1",c.log=a.isDebug,m.errback(c),m):(q.hide(g.errMsg_),f&&403==f.code&&n&&(k.set(g.errMsg_,"innerHTML",this._nls.forbidden),q.show(g.errMsg_)),g.dfd_=m,
g.serverInfo_=b,g.resUrl_=c,g.admin_=e&&e.isAdmin,k.set(g.resLink_,{title:c,innerHTML:"("+(this.getResourceName(c)||this._nls.lblItem)+")"}),k.set(g.serverLink_,{title:b.server,innerHTML:(-1!==b.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":b.server)+" "}),g.txtPwd_.set("value",""),g.show(),m)},_createLoginDialog:function(){var b=this._nls,d=n.substitute(b,this._dialogContent),d=n.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},
d),f=new e({title:b.title,content:d,"class":"esriSignInDialog",style:"width: 18em;",esriIdMgr_:this,keypressed_:function(a){a.charOrCode===m.ENTER&&this.execute_()},execute_:function(){var a=this.txtUser_.get("value"),d=this.txtPwd_.get("value"),g=this.dfd_,f=this;if(this.form_.validate()&&a&&d){this.btnSubmit_.set("label",b.lblSigning);var m=c.id.findCredential(f.resUrl_,a),h=function(c){f.btnSubmit_.set("label",b.lblOk);f.btnSubmit_.set("disabled",!1);q.hide(f.errMsg_);f.hide();e._DialogLevelManager.hide(f);
var d=f.serverInfo_;f.dfd_=f.serverInfo_=f.generateDfd_=f.resUrl_=null;var k,h,u,v=m;c&&(k=c.token,h=n.isDefined(c.expires)?Number(c.expires):null,u=!!c.ssl,v?(v.userId=a,v.token=k,v.expires=h,v.validity=c.validity,v.ssl=u,v.creationTime=(new Date).getTime()):v=new r({userId:a,server:d.server,token:k,expires:h,ssl:u,isAdmin:f.admin_,validity:c.validity}));g.callback(v)};if(m&&!m._enqueued)return void h();f.btnSubmit_.set("disabled",!0);f.generateDfd_=c.id.generateToken(this.serverInfo_,{username:a,
password:d},{isAdmin:this.admin_}).addCallback(h).addErrback(function(a){f.btnSubmit_.set("disabled",!1);f.generateDfd_=null;f.btnSubmit_.set("label",b.lblOk);k.set(f.errMsg_,"innerHTML",a&&a.code?b.invalidUser:b.noAuthService);q.show(f.errMsg_)})}},cancel_:function(){f.generateDfd_&&f.generateDfd_.cancel();var c=f.dfd_,b=f.resUrl_,d=f.serverInfo_;f.btnSubmit_.set("disabled",!1);f.dfd_=f.serverInfo_=f.generateDfd_=f.resUrl_=null;q.hide(f.errMsg_);e._DialogLevelManager.hide(f);f.esriIdMgr_.onDialogCancel({resourceUrl:b,
serverInfo:d});b=Error("ABORTED");b.code="IdentityManager.2";b.log=a.isDebug;c.errback(b)}}),d=f.domNode;return f.form_=g.byNode(h.query(".esriIdForm",d)[0]),f.txtUser_=g.byNode(h.query(".esriIdUser",d)[0]),f.txtPwd_=g.byNode(h.query(".esriIdPwd",d)[0]),f.btnSubmit_=g.byNode(h.query(".esriIdSubmit",d)[0]),f.btnCancel_=g.byNode(h.query(".esriIdCancel",d)[0]),f.resLink_=h.query(".resLink",d)[0],f.serverLink_=h.query(".serverLink",d)[0],f.errMsg_=h.query(".esriErrorMsg",d)[0],f.connect(f.txtUser_,"onKeyPress",
f.keypressed_),f.connect(f.txtPwd_,"onKeyPress",f.keypressed_),f.connect(f.btnSubmit_,"onClick",f.execute_),f.connect(f.btnCancel_,"onClick",f.onCancel),f.connect(f,"onCancel",f.cancel_),f}});return f("extend-esri")&&(c.IdentityManagerDialog=c.IdentityManager=l),l})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K){function J(){}var I=new b;I.resolve(!0);z=d("dijit._DialogBase"+(v("dojo-bidi")?"_NoBidi":""),[B,D,E,C],{templateString:K,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:z.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(a){this._set("draggable",a)},maxRatio:.9,
closable:!0,_setClosableAttr:function(a){this.closeButtonNode.style.display=a?"":"none";this._set("closable",a)},postMixInProperties:function(){var a=c.getLocalization("dijit","common");q.mixin(this,a);this.inherited(arguments)},postCreate:function(){g.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);a.after(this,"onExecute",q.hitch(this,"hide"),!0);a.after(this,"onCancel",q.hitch(this,"hide"),!0);this._modalconnects=
[]},onLoad:function(){this.resize();this._position();this.autofocus&&M.isTop(this)&&(this._getFocusItems(),y.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();y.focus(this._firstFocusItem)},_endDrag:function(){var a=m.position(this.domNode),c=t.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,0),c.h-a.h);a.x=Math.min(Math.max(a.x,0),c.w-a.w);this._relativePosition=a;this._position()},_setup:function(){var c=this.domNode;this.titleBar&&this.draggable?
(this._moveable=new (6==v("ie")?x:w)(c,{handle:this.titleBar}),a.after(this._moveable,"onMoveStop",q.hitch(this,"_endDrag"),!0)):k.add(c,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":l.map(this["class"].split(/\s/),function(a){return a+"_underlay"}).join(" "),_onKeyDown:q.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!k.contains(this.ownerDocumentBody,"dojoMove")){var a=this.domNode,c=t.getBox(this.ownerDocument),
b=this._relativePosition,e=m.position(a),d=Math.floor(c.l+(b?Math.min(b.x,c.w-e.w):(c.w-e.w)/2)),c=Math.floor(c.t+(b?Math.min(b.y,c.h-e.h):(c.h-e.h)/2));g.set(a,{left:d+"px",top:c+"px"})}},_onKey:function(a){if(a.keyCode==n.TAB){this._getFocusItems();var c=a.target;this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):c==this._firstFocusItem&&a.shiftKey?(y.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):c!=this._lastFocusItem||a.shiftKey||(y.focus(this._firstFocusItem),
a.stopPropagation(),a.preventDefault())}else this.closable&&a.keyCode==n.ESCAPE&&(this.onCancel(),a.stopPropagation(),a.preventDefault())},show:function(){if(this.open)return I.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),M.hide(this));var a=t.get(this.ownerDocument);this._modalconnects.push(r(a,"scroll",q.hitch(this,"resize",null)));this._modalconnects.push(r(this.domNode,"keydown",
q.hitch(this,"_onKey")));g.set(this.domNode,{opacity:0,display:""});this._set("open",!0);this._onShow();this.resize();this._position();var c;this._fadeInDeferred=new b(q.hitch(this,function(){c.stop();delete this._fadeInDeferred}));this._fadeInDeferred.then(void 0,J);a=this._fadeInDeferred.promise;c=e.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:q.hitch(this,function(){M.show(this,this.underlayAttrs)}),onEnd:q.hitch(this,function(){this.autofocus&&M.isTop(this)&&(this._getFocusItems(),
y.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();return a},hide:function(){if(!this._alreadyInitialized||!this.open)return I.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();var a;this._fadeOutDeferred=new b(q.hitch(this,function(){a.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(void 0,J);this._fadeOutDeferred.then(q.hitch(this,"onHide"));var c=this._fadeOutDeferred.promise;a=e.fadeOut({node:this.domNode,duration:this.duration,
onEnd:q.hitch(this,function(){this.domNode.style.display="none";M.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();this._scrollConnected&&(this._scrollConnected=!1);for(var d;d=this._modalconnects.pop();)d.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return c},resize:function(a){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!a){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&
(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),l.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode],function(a){a&&g.set(a,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var c=t.getBox(this.ownerDocument);c.w*=this.maxRatio;c.h*=this.maxRatio;var b=m.position(this.domNode);b.w>=c.w||b.h>=c.h?(a={w:Math.min(b.w,c.w),h:Math.min(b.h,c.h)},this._shrunk=!0):this._shrunk=!1}if(a){m.setMarginBox(this.domNode,
a);c=[];this.titleBar&&c.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&c.push({domNode:this.actionBarNode,region:"bottom"});b={domNode:this.containerNode,region:"center"};c.push(b);var e=G.marginBox2contentBox(this.domNode,a);G.layoutChildren(this.domNode,e,c);this._singleChild?(c=G.marginBox2contentBox(this.containerNode,b),this._singleChild.resize({w:c.w,h:c.h})):(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();v("touch")||a||this._position()}},
_layoutChildren:function(){l.forEach(this.getChildren(),function(a){a.resize&&a.resize()})},destroy:function(){this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var a;a=this._modalconnects.pop();)a.remove();M.hide(this);this.inherited(arguments)}});v("dojo-bidi")&&(z=d("dijit._DialogBase",z,{_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},
_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title))}}));var L=d("dijit.Dialog",[H,z],{});L._DialogBase=z;var M=L._DialogLevelManager={_beginZIndex:950,show:function(a,c){N[N.length-1].focus=y.curNode;var b=N[N.length-1].dialog?N[N.length-1].zIndex+2:L._DialogLevelManager._beginZIndex;g.set(a.domNode,"zIndex",b);F.show(c,b-1);N.push({dialog:a,underlayAttrs:c,zIndex:b})},hide:function(a){if(N[N.length-1].dialog==a){N.pop();var c=N[N.length-
1];1==N.length?F.hide():F.show(c.underlayAttrs,c.zIndex-1);if(a.refocus&&(a=c.focus,!c.dialog||a&&f.isDescendant(a,c.dialog.domNode)||(c.dialog._getFocusItems(),a=c.dialog._firstFocusItem),a))try{a.focus()}catch(b){}}else c=l.indexOf(l.map(N,function(a){return a.dialog}),a),-1!=c&&N.splice(c,1)},isTop:function(a){return N[N.length-1].dialog==a}},N=L._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];y.watch("curNode",function(a,c,b){a=N[N.length-1].dialog;if(b&&a&&!a._fadeOutDeferred&&b.ownerDocument==
a.ownerDocument){do if(b==a.domNode||k.contains(b,"dijitPopup"))return;while(b=b.parentNode);a.focus()}});v("dijit-legacy-requires")&&u(0,function(){h(["dijit/TooltipDialog"])});return L})},"dojo/dnd/Moveable":function(){define("../_base/array ../_base/declare ../_base/lang ../dom ../dom-class ../Evented ../on ../topic ../touch ./common ./Mover ../_base/window".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n){return l("dojo.dnd.Moveable",[f],{handle:"",delay:0,skip:!1,constructor:function(b,e){this.node=
d.byId(b);e||(e={});this.handle=e.handle?d.byId(e.handle):null;this.handle||(this.handle=this.node);this.delay=0<e.delay?e.delay:0;this.skip=e.skip;this.mover=e.mover?e.mover:c;this.events=[k(this.handle,g.press,a.hitch(this,"onMouseDown")),k(this.handle,"dragstart",a.hitch(this,"onSelectStart")),k(this.handle,"selectstart",a.hitch(this,"onSelectStart"))]},markupFactory:function(a,c,b){return new b(c,a)},destroy:function(){h.forEach(this.events,function(a){a.remove()});this.events=this.node=this.handle=
null},onMouseDown:function(c){if(!this.skip||!e.isFormElement(c)){if(this.delay)this.events.push(k(this.handle,g.move,a.hitch(this,"onMouseMove")),k(this.handle.ownerDocument,g.release,a.hitch(this,"onMouseUp"))),this._lastX=c.pageX,this._lastY=c.pageY;else this.onDragDetected(c);c.stopPropagation();c.preventDefault()}},onMouseMove:function(a){if(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)this.onMouseUp(a),this.onDragDetected(a);a.stopPropagation();a.preventDefault()},
onMouseUp:function(a){for(var c=0;2>c;++c)this.events.pop().remove();a.stopPropagation();a.preventDefault()},onSelectStart:function(a){this.skip&&e.isFormElement(a)||(a.stopPropagation(),a.preventDefault())},onDragDetected:function(a){new this.mover(this.node,a,this)},onMoveStart:function(a){m.publish("/dnd/move/start",a);b.add(n.body(),"dojoMove");b.add(this.node,"dojoMoveItem")},onMoveStop:function(a){m.publish("/dnd/move/stop",a);b.remove(n.body(),"dojoMove");b.remove(this.node,"dojoMoveItem")},
onFirstMove:function(){},onMove:function(a,c){this.onMoving(a,c);var b=a.node.style;b.left=c.l+"px";b.top=c.t+"px";this.onMoved(a,c)},onMoving:function(){},onMoved:function(){}})})},"dojo/dnd/common":function(){define(["../sniff","../_base/kernel","../_base/lang","../dom"],function(h,l,a,d){var b=a.getObject("dojo.dnd",!0);b.getCopyKeyState=function(a){return a[h("mac")?"metaKey":"ctrlKey"]};b._uniqueId=0;b.getUniqueId=function(){var a;do a=l._scopeName+"Unique"+ ++b._uniqueId;while(d.byId(a));return a};
b._empty={};b.isFormElement=function(a){a=a.target;3==a.nodeType&&(a=a.parentNode);return 0<=" a button textarea input select option ".indexOf(" "+a.tagName.toLowerCase()+" ")};return b})},"dojo/dnd/Mover":function(){define("../_base/array ../_base/declare ../_base/lang ../sniff ../_base/window ../dom ../dom-geometry ../dom-style ../Evented ../on ../touch ./common ./autoscroll".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q){return l("dojo.dnd.Mover",[g],{constructor:function(b,d,g){function k(a){a.preventDefault();
a.stopPropagation()}this.node=f.byId(b);this.marginBox={l:d.pageX,t:d.pageY};this.mouseButton=d.button;d=this.host=g;b=b.ownerDocument;this.events=[e(b,c.move,a.hitch(this,"onFirstMove")),e(b,c.move,a.hitch(this,"onMouseMove")),e(b,c.release,a.hitch(this,"onMouseUp")),e(b,"dragstart",k),e(b.body,"selectstart",k)];q.autoScrollStart(b);if(d&&d.onMoveStart)d.onMoveStart(this)},onMouseMove:function(a){q.autoScroll(a);var c=this.marginBox;this.host.onMove(this,{l:c.l+a.pageX,t:c.t+a.pageY},a);a.preventDefault();
a.stopPropagation()},onMouseUp:function(a){(d("webkit")&&d("mac")&&2==this.mouseButton?0==a.button:this.mouseButton==a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var c=this.node.style,e,d=this.host;switch(c.position){case "relative":case "absolute":e=Math.round(parseFloat(c.left))||0;c=Math.round(parseFloat(c.top))||0;break;default:c.position="absolute";c=k.getMarginBox(this.node);e=b.doc.body;var g=m.getComputedStyle(e),f=k.getMarginBox(e,g),g=k.getContentBox(e,
g);e=c.l-(g.l-f.l);c=c.t-(g.t-f.t)}this.marginBox.l=e-this.marginBox.l;this.marginBox.t=c-this.marginBox.t;if(d&&d.onFirstMove)d.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){h.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"dojo/dnd/autoscroll":function(){define("../_base/lang ../sniff ../_base/window ../dom-geometry ../dom-style ../window".split(" "),function(h,l,a,d,b,f){var k=
{};h.setObject("dojo.dnd.autoscroll",k);k.getViewport=f.getBox;k.V_TRIGGER_AUTOSCROLL=32;k.H_TRIGGER_AUTOSCROLL=32;k.V_AUTOSCROLL_VALUE=16;k.H_AUTOSCROLL_VALUE=16;var m,g=a.doc,e=Infinity,c=Infinity;k.autoScrollStart=function(b){g=b;m=f.getBox(g);b=a.body(g).parentNode;e=Math.max(b.scrollHeight-m.h,0);c=Math.max(b.scrollWidth-m.w,0)};k.autoScroll=function(b){var d=m||f.getBox(g),h=a.body(g).parentNode,u=0,v=0;b.clientX<k.H_TRIGGER_AUTOSCROLL?u=-k.H_AUTOSCROLL_VALUE:b.clientX>d.w-k.H_TRIGGER_AUTOSCROLL&&
(u=Math.min(k.H_AUTOSCROLL_VALUE,c-h.scrollLeft));b.clientY<k.V_TRIGGER_AUTOSCROLL?v=-k.V_AUTOSCROLL_VALUE:b.clientY>d.h-k.V_TRIGGER_AUTOSCROLL&&(v=Math.min(k.V_AUTOSCROLL_VALUE,e-h.scrollTop));window.scrollBy(u,v)};k._validNodes={div:1,p:1,td:1};k._validOverflow={auto:1,scroll:1};k.autoScrollNodes=function(c){for(var e,g,f,m,t,h,x=0,y=0,z=c.target;z;){if(1==z.nodeType&&z.tagName.toLowerCase()in k._validNodes){f=b.getComputedStyle(z);m=f.overflow.toLowerCase()in k._validOverflow;t=f.overflowX.toLowerCase()in
k._validOverflow;h=f.overflowY.toLowerCase()in k._validOverflow;if(m||t||h)e=d.getContentBox(z,f),g=d.position(z,!0);if(m||t){f=Math.min(k.H_TRIGGER_AUTOSCROLL,e.w/2);t=c.pageX-g.x;if(l("webkit")||l("opera"))t+=a.body().scrollLeft;x=0;0<t&&t<e.w&&(t<f?x=-f:t>e.w-f&&(x=f),z.scrollLeft+=x)}if(m||h){m=Math.min(k.V_TRIGGER_AUTOSCROLL,e.h/2);h=c.pageY-g.y;if(l("webkit")||l("opera"))h+=a.body().scrollTop;y=0;0<h&&h<e.h&&(h<m?y=-m:h>e.h-m&&(y=m),z.scrollTop+=y)}if(x||y)return}try{z=z.parentNode}catch(A){z=
null}}k.autoScroll(c)};return k})},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(h,l){var a=l.prototype.onMove;return h("dojo.dnd.TimedMoveable",l,{timeout:40,constructor:function(a,b){b||(b={});b.timeout&&"number"==typeof b.timeout&&0<=b.timeout&&(this.timeout=b.timeout)},onMoveStop:function(d){d._timer&&(clearTimeout(d._timer),a.call(this,d,d._leftTop));l.prototype.onMoveStop.apply(this,arguments)},onMove:function(d,b){d._leftTop=b;if(!d._timer){var f=this;
d._timer=setTimeout(function(){d._timer=null;a.call(f,d,d._leftTop)},this.timeout)}}})})},"dijit/_base/manager":function(){define(["dojo/_base/array","dojo/_base/config","dojo/_base/lang","../registry","../main"],function(h,l,a,d,b){var f={};h.forEach("byId getUniqueId findWidgets _destroyAll byNode getEnclosingWidget".split(" "),function(a){f[a]=d[a]});a.mixin(f,{defaultDuration:l.defaultDuration||200});a.mixin(b,f);return b})},"dijit/_CssStateMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-class dojo/has dojo/_base/lang dojo/on dojo/domReady dojo/touch dojo/_base/window ./a11yclick ./registry".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n){l=l("dijit._CssStateMixin",[],{hovering:!1,active:!1,_applyAttributes:function(){this.inherited(arguments);h.forEach("disabled readOnly checked selected focused state hovering active _opened".split(" "),function(a){this.watch(a,f.hitch(this,"_setStateClass"))},this);for(var a in this.cssStateNodes||{})this._trackMouseState(this[a],this.cssStateNodes[a]);this._trackMouseState(this.domNode,this.baseClass);this._setStateClass()},_cssMouseEvent:function(a){if(!this.disabled)switch(a.type){case "mouseover":case "MSPointerOver":case "pointerover":this._set("hovering",
!0);this._set("active",this._mouseDown);break;case "mouseout":case "MSPointerOut":case "pointerout":this._set("hovering",!1);this._set("active",!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":this._set("active",!0);break;case "mouseup":case "dojotouchend":case "MSPointerUp":case "pointerup":case "keyup":this._set("active",!1)}},_setStateClass:function(){function a(b){c=c.concat(h.map(c,function(a){return a+b}),"dijit"+b)}var c=this.baseClass.split(" ");
this.isLeftToRight()||a("Rtl");var b="mixed"==this.checked?"Mixed":this.checked?"Checked":"";this.checked&&a(b);this.state&&a(this.state);this.selected&&a("Selected");this._opened&&a("Opened");this.disabled?a("Disabled"):this.readOnly?a("ReadOnly"):this.active?a("Active"):this.hovering&&a("Hover");this.focused&&a("Focused");var b=this.stateNode||this.domNode,e={};h.forEach(b.className.split(" "),function(a){e[a]=!0});"_stateClasses"in this&&h.forEach(this._stateClasses,function(a){delete e[a]});h.forEach(c,
function(a){e[a]=!0});var d=[],g;for(g in e)d.push(g);b.className=d.join(" ");this._stateClasses=c},_subnodeCssMouseEvent:function(a,c,b){function e(b){d.toggle(a,c+"Active",b)}if(!this.disabled&&!this.readOnly)switch(b.type){case "mouseover":case "MSPointerOver":case "pointerover":d.toggle(a,c+"Hover",!0);break;case "mouseout":case "MSPointerOut":case "pointerout":d.toggle(a,c+"Hover",!1);e(!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":e(!0);
break;case "mouseup":case "MSPointerUp":case "pointerup":case "dojotouchend":case "keyup":e(!1);break;case "focus":case "focusin":d.toggle(a,c+"Focused",!0);break;case "blur":case "focusout":d.toggle(a,c+"Focused",!1)}},_trackMouseState:function(a,c){a._cssState=c}});m(function(){function b(c,e,d){if(!d||!a.isDescendant(d,e))for(;e&&e!=d;e=e.parentNode)if(e._cssState){var g=n.getEnclosingWidget(e);g&&(e==g.domNode?g._cssMouseEvent(c):g._subnodeCssMouseEvent(e,e._cssState,c))}}var d=e.body(),f;k(d,
g.over,function(a){b(a,a.target,a.relatedTarget)});k(d,g.out,function(a){b(a,a.target,a.relatedTarget)});k(d,c.press,function(a){f=a.target;b(a,f)});k(d,c.release,function(a){b(a,f);f=null});k(d,"focusin, focusout",function(a){var c=a.target;if(c._cssState&&!c.getAttribute("widgetId")){var b=n.getEnclosingWidget(c);b&&b._subnodeCssMouseEvent(c,c._cssState,a)}})});return l})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),
function(h,l,a,d,b,f){return l("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(a){var b=[];h.forEach(a||this.getChildren(),function(a){"value"in a?b.push(a):b=b.concat(this._getDescendantFormWidgets(a.getChildren()))},this);return b},reset:function(){h.forEach(this._getDescendantFormWidgets(),function(a){a.reset&&a.reset()})},validate:function(){var a=!1;return h.every(h.map(this._getDescendantFormWidgets(),function(b){b._hasBeenBlurred=!0;var d=b.disabled||!b.validate||
b.validate();d||a||(f.scrollIntoView(b.containerNode||b.domNode),b.focus(),a=!0);return d}),function(a){return a})},setValues:function(b){a.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",b)},_setValueAttr:function(a){var b={};h.forEach(this._getDescendantFormWidgets(),function(a){a.name&&(b[a.name]||(b[a.name]=[])).push(a)});for(var g in b)if(b.hasOwnProperty(g)){var e=b[g],c=d.getObject(g,!1,a);void 0!==c&&(c=[].concat(c),
"boolean"==typeof e[0].checked?h.forEach(e,function(a){a.set("value",-1!=h.indexOf(c,a._get("value")))}):e[0].multiple?e[0].set("value",c):h.forEach(e,function(a,b){a.set("value",c[b])}))}},getValues:function(){a.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},_getValueAttr:function(){var a={};h.forEach(this._getDescendantFormWidgets(),function(b){var g=b.name;if(g&&!b.disabled){var e=b.get("value");"boolean"==typeof b.checked?
/Radio/.test(b.declaredClass)?!1!==e?d.setObject(g,e,a):(e=d.getObject(g,!1,a),void 0===e&&d.setObject(g,null,a)):(b=d.getObject(g,!1,a),b||(b=[],d.setObject(g,b,a)),!1!==e&&b.push(e)):(b=d.getObject(g,!1,a),"undefined"!=typeof b?d.isArray(b)?b.push(e):d.setObject(g,[b,e],a):d.setObject(g,e,a))}});return a},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var a=h.map(this._descendants,function(a){return a.get("state")||""});return 0<=h.indexOf(a,"Error")?
"Error":0<=h.indexOf(a,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(a){this._descendants=this._getDescendantFormWidgets();h.forEach(this._descendants,function(a){a._started||a.startup()});a||this._onChildChange()},_onChildChange:function(a){a&&"state"!=a&&"disabled"!=a||this._set("state",this._getState());a&&"value"!=a&&"disabled"!=a&&"checked"!=a||(this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;
this._set("value",this.get("value"))},10))},startup:function(){this.inherited(arguments);this._descendants=this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var a=this;this.own(b(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(b){b.target!=a.domNode&&a._onChildChange(b.type.replace("attrmodified-",""))}));this.watch("state",function(a,b,e){this.onValidStateChange(""==e)})},destroy:function(){this.inherited(arguments)}})})},
"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(h,l){return h("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var a=l._getTabNavigable(this.domNode);this._firstFocusItem=a.lowest||a.first||this.closeButtonNode||this.domNode;this._lastFocusItem=a.last||a.highest||this._firstFocusItem}})})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n){var q=h("dijit.DialogUnderlay",[m,g],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(a){d.set(this.node,"id",a+"_underlay");this._set("dialogId",a)},_setClassAttr:function(a){this.node.className="dijitDialogUnderlay "+a;this._set("class",a)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(f(this.domNode,"keydown",l.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var a=this.node.style,c=this.domNode.style;c.display="none";var b=k.getBox(this.ownerDocument);c.top=b.t+"px";c.left=b.l+"px";a.width=b.w+"px";a.height=b.h+"px";c.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new e(this.domNode);var a=k.get(this.ownerDocument);this._modalConnects=[c.on("resize",l.hitch(this,"layout")),f(a,"scroll",
l.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});q.show=function(a,c){var e=q._singleton;!e||e._destroyed?e=n._underlay=q._singleton=new q(a):a&&e.set(a);b.set(e.domNode,"zIndex",c);e.open||e.show()};q.hide=function(){var a=
q._singleton;a&&!a._destroyed&&a.hide()};return q})},"dijit/BackgroundIframe":function(){define("require ./main dojo/_base/config dojo/dom-construct dojo/dom-style dojo/_base/lang dojo/on dojo/sniff".split(" "),function(h,l,a,d,b,f,k,m){m.add("config-bgIframe",m("ie")&&!/IEMobile\/10\.0/.test(navigator.userAgent)||m("trident")&&/Windows NT 6.[01]/.test(navigator.userAgent));var g=new function(){var e=[];this.pop=function(){var c;e.length?(c=e.pop(),c.style.display=""):(9>m("ie")?(c="\x3ciframe src\x3d'"+
(a.dojoBlankHtmlUrl||h.toUrl("dojo/resources/blank.html")||'javascript:""')+"' role\x3d'presentation' style\x3d'position: absolute; left: 0px; top: 0px;z-index: -1; filter:Alpha(Opacity\x3d\"0\");'\x3e",c=document.createElement(c)):(c=d.create("iframe"),c.src='javascript:""',c.className="dijitBackgroundIframe",c.setAttribute("role","presentation"),b.set(c,"opacity",.1)),c.tabIndex=-1);return c};this.push=function(a){a.style.display="none";e.push(a)}};l.BackgroundIframe=function(a){if(!a.id)throw Error("no id");
if(m("config-bgIframe")){var c=this.iframe=g.pop();a.appendChild(c);7>m("ie")||m("quirks")?(this.resize(a),this._conn=k(a,"resize",f.hitch(this,"resize",a))):b.set(c,{width:"100%",height:"100%"})}};f.extend(l.BackgroundIframe,{resize:function(a){this.iframe&&b.set(this.iframe,{width:a.offsetWidth+"px",height:a.offsetHeight+"px"})},destroy:function(){this._conn&&(this._conn.remove(),this._conn=null);this.iframe&&(this.iframe.parentNode.removeChild(this.iframe),g.push(this.iframe),delete this.iframe)}});
return l.BackgroundIframe})},"dijit/nls/common":function(){define({root:{buttonOk:"OK",buttonCancel:"Cancel",buttonSave:"Save",itemClose:"Close"},bs:!0,mk:!0,sr:!0,zh:!0,"zh-tw":!0,vi:!0,uk:!0,tr:!0,th:!0,sv:!0,sl:!0,sk:!0,ru:!0,ro:!0,pt:!0,"pt-pt":!0,pl:!0,nl:!0,nb:!0,lv:!0,lt:!0,ko:!0,kk:!0,ja:!0,it:!0,id:!0,hu:!0,hr:!0,he:!0,fr:!0,fi:!0,eu:!0,et:!0,es:!0,el:!0,de:!0,da:!0,cs:!0,ca:!0,bg:!0,az:!0,ar:!0})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],
function(h,l,a,d){h=h(d.Credential,{});return l("extend-esri")&&(a.Credential=h),h})},"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/regexp ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z){var A,B={},C=
function(a){var c=(new k(a.owningSystemUrl)).host;a=(new k(a.server)).host;var b=/.+\.arcgis\.com$/i;return b.test(c)&&b.test(a)},D=function(a,c){return!!(C(a)&&c&&d.some(c,function(c){return c.test(a.server)}))},E=h(x,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=a.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=[];this._getOAuthHash()},defaultOAuthInfo:null,defaultTokenValidity:60,
tokenValidity:null,signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,_busy:null,_oAuthHash:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/dev\.arcgis\.com/i,tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},
{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/gi,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer|VectorTileServer)).*/gi,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_createDefaultOAuthInfo:!0,_hasTestedIfAppIsOnPortal:!1,registerServers:function(a){var c=this.serverInfos;c?(a=d.filter(a,function(a){return!this.findServerInfo(a.server)},this),this.serverInfos=c.concat(a)):
this.serverInfos=a;d.forEach(a,function(a){if(a.owningSystemUrl&&this._portals.push(a.owningSystemUrl),a.hasPortal){this._portals.push(a.server);var c=q.defaults.io.corsEnabledServers,b=this._getOrigin(a.tokenServiceUrl);v.canUseXhr(a.server)||c.push(a.server.replace(/^https?:\/\//i,""));v.canUseXhr(b)||c.push(b.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(a){var c=this.oAuthInfos;c?(a=d.filter(a,function(a){return!this.findOAuthInfo(a.portalUrl)},this),this.oAuthInfos=c.concat(a)):
this.oAuthInfos=a},registerToken:function(c){var b,e=this._sanitizeUrl(c.server),d=this.findServerInfo(e),g=!0;d||(d=new u,d.server=this._getServerInstanceRoot(e),d.tokenServiceUrl=this._getTokenSvcUrl(e),d.hasPortal=!0,this.registerServers([d]));(b=this.findCredential(e,c.userId))?(a.mixin(b,c),g=!1):(b=new A({userId:c.userId,server:d.server,token:c.token,expires:c.expires,ssl:c.ssl,scope:this._isServerRsrc(e)?"server":"portal"}),b.resources=[e],this.credentials.push(b));b.onTokenChange(!1);g||b.refreshServerTokens()},
toJson:function(){return r.fixJson({serverInfos:d.map(this.serverInfos,function(a){return a.toJson()}),oAuthInfos:d.map(this.oAuthInfos,function(a){return a.toJson()}),credentials:d.map(this.credentials,function(a){return a.toJson()})})},initialize:function(c){if(c){a.isString(c)&&(c=f.fromJson(c));var b=c.serverInfos,e=c.oAuthInfos;c=c.credentials;if(b){var g=[];d.forEach(b,function(a){a.server&&a.tokenServiceUrl&&g.push(a.declaredClass?a:new u(a))});g.length&&this.registerServers(g)}if(e){var k=
[];d.forEach(e,function(a){a.appId&&k.push(a.declaredClass?a:new z(a))});k.length&&this.registerOAuthInfos(k)}c&&d.forEach(c,function(a){a.userId&&a.server&&a.token&&a.expires&&a.expires>(new Date).getTime()&&(a=a.declaredClass?a:new A(a),a.onTokenChange(),this.credentials.push(a))},this)}},findServerInfo:function(a){var c;return a=this._sanitizeUrl(a),d.some(this.serverInfos,function(b){return this._hasSameServerInstance(b.server,a)&&(c=b),!!c},this),c},findOAuthInfo:function(a){var c;return a=this._sanitizeUrl(a),
d.some(this.oAuthInfos,function(b){return this._hasSameServerInstance(b.portalUrl,a)&&(c=b),!!c},this),c},findCredential:function(a,c){var b,e;return a=this._sanitizeUrl(a),e=this._isServerRsrc(a)?"server":"portal",c?d.some(this.credentials,function(d){return this._hasSameServerInstance(d.server,a)&&c===d.userId&&d.scope===e&&(b=d),!!b},this):d.some(this.credentials,function(c){return this._hasSameServerInstance(c.server,a)&&-1!==this._getIdenticalSvcIdx(a,c)&&c.scope===e&&(b=c),!!b},this),b},getCredential:function(c,
e){var d,g,f=!0;r.isDefined(e)&&(a.isObject(e)?(d=!!e.token,g=e.error,f=!1!==e.prompt):d=e);c=this._sanitizeUrl(c);var k,n=new b(t._dfdCanceller),m=this._isAdminResource(c),h=d&&this._doPortalSignIn(c)?this._getEsriAuthCookie():null;d=d?this.findCredential(c):null;if(h||d)return k=Error("You are currently signed in as: '"+(h&&h.email||d&&d.userId)+"'. You do not have access to this resource: "+c),k.code="IdentityManagerBase.1",k.httpCode=g&&g.httpCode,k.messageCode=g?g.messageCode:null,k.subcode=
g?g.subcode:null,k.details=g?g.details:null,k.log=l.isDebug,n.errback(k),n;if(g=this._findCredential(c,e))return n.callback(g),n;if(g=this.findServerInfo(c))!g.hasServer&&this._isServerRsrc(c)&&(g._restInfoDfd=this._getTokenSvcUrl(c,!0),g.hasServer=!0);else{h=this._getTokenSvcUrl(c);if(!h)return k=Error("Unknown resource - could not find token service endpoint."),k.code="IdentityManagerBase.2",k.log=l.isDebug,n.errback(k),n;g=new u;g.server=this._getServerInstanceRoot(c);a.isString(h)?(g.tokenServiceUrl=
h,g.hasPortal=!0):(g._restInfoDfd=h,g.hasServer=!0);this.registerServers([g])}return f&&g.hasPortal&&void 0===g._selfReq&&!this._findOAuthInfo(c)&&(g._selfReq={owningTenant:e&&e.owningTenant,selfDfd:this._getPortalSelf(g.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),c)}),this._enqueue(c,g,e,n,m)},getResourceName:function(a){return this._isRESTService(a)?a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,
"$1")||this._gwItem.test(a)&&a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""},generateToken:function(c,b,e){var d,g,f,m,t,h,r,u,q=this._rePortalTokenSvc.test(c.tokenServiceUrl),x=new k(window.location.href.toLowerCase()),y=this._getEsriAuthCookie(),C=!b,z=c.shortLivedTokenValidity;b&&(u=n.id.tokenValidity||z||n.id.defaultTokenValidity,u>z&&(u=z));e&&(d=e.isAdmin,g=e.serverUrl,f=e.token,h=e.ssl,c.customParameters=e.customParameters);d?m=c.adminTokenServiceUrl:
(m=c.tokenServiceUrl,t=new k(m.toLowerCase()),y&&(r=y.auth_tier,r=r&&r.toLowerCase()),("web"===r||c.webTierAuth)&&e&&e.serverUrl&&!h&&"http"===x.scheme&&(v.hasSameOrigin(x.uri,m,!0)||"https"===t.scheme&&x.host===t.host&&"7080"===x.port&&"7443"===t.port)&&(m=m.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),C&&q&&(m=m.replace(/\/rest/i,"")));d=a.mixin({url:m,content:a.mixin({request:"getToken",username:b&&b.username,password:b&&b.password,serverUrl:g,token:f,expiration:u,referer:d||q?window.location.host:
null,client:d?"referer":null,f:"json"},c.customParameters),handleAs:"json",callbackParamName:C?"callback":void 0},e&&e.ioArgs);e={usePost:!C,disableIdentityLookup:!0,useProxy:this._useProxy(c,e)};q||(d.withCredentials=!1);q=w(d,e);return q.addCallback(function(a){if(!a||!a.token)return a=Error("Unable to generate token"),a.code="IdentityManagerBase.3",a.log=l.isDebug,a;var e=c.server;return B[e]||(B[e]={}),b&&(B[e][b.username]=b.password),a.validity=u,a}),q.addErrback(function(a){}),q},isBusy:function(){return!!this._busy},
checkSignInStatus:function(a){return this.getCredential(a,{prompt:!1})},setRedirectionHandler:function(a){this._redirectFunc=a},setProtocolErrorHandler:function(a){this._protocolFunc=a},signIn:function(){},oAuthSignIn:function(){},onCredentialCreate:function(){},onCredentialsDestroy:function(){},destroyCredentials:function(){if(this.credentials){var a=this.credentials.slice();d.forEach(a,function(a){a.destroy()})}this.onCredentialsDestroy()},_getOAuthHash:function(){var a=window.location.hash;if(a){"#"===
a.charAt(0)&&(a=a.substring(1));var a=e.queryToObject(a),c=!1;a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username")?(a.state=f.fromJson(a.state),this._oAuthHash=a,c=!0):a.error&&a.error_description&&"access_denied"===a.error&&(c=!0);c&&(!m("ie")||8<m("ie"))&&(window.location.hash="")}},_findCredential:function(a,c){var b,e,g,f,k=-1,n=c&&c.token,m=c&&c.resource,t=this._isServerRsrc(a)?"server":"portal",h=d.filter(this.credentials,function(c){return this._hasSameServerInstance(c.server,
a)&&c.scope===t},this);if(a=m||a,h.length)if(1===h.length){if(b=h[0],f=this.findServerInfo(b.server),e=f&&f.owningSystemUrl,g=e&&this.findCredential(e,b.userId),k=this._getIdenticalSvcIdx(a,b),!n)return-1===k&&b.resources.push(a),this._addResource(a,g),b;-1!==k&&(b.resources.splice(k,1),this._removeResource(a,g))}else{var r,u;if(d.some(h,function(c){return u=this._getIdenticalSvcIdx(a,c),-1!==u?(r=c,f=this.findServerInfo(r.server),e=f&&f.owningSystemUrl,g=e&&this.findCredential(e,r.userId),k=u,!0):
!1},this),n)r&&(r.resources.splice(k,1),this._removeResource(a,g));else if(r)return this._addResource(a,g),r}},_findOAuthInfo:function(a){var c=this.findOAuthInfo(a);return c||d.some(this.oAuthInfos,function(b){return this._isIdProvider(b.portalUrl,a)&&(c=b),!!c},this),c},_addResource:function(a,c){c&&-1===this._getIdenticalSvcIdx(a,c)&&c.resources.push(a)},_removeResource:function(a,c){var b=-1;c&&(b=this._getIdenticalSvcIdx(a,c),-1<b&&c.resources.splice(b,1))},_useProxy:function(a,c){return c&&
c.isAdmin&&!v.hasSameOrigin(a.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(a.tokenServiceUrl)&&10.1==a.currentVersion&&!v.hasSameOrigin(a.tokenServiceUrl,window.location.href)},_getOrigin:function(a){a=new k(a);return a.scheme+"://"+a.host+(r.isDefined(a.port)?":"+a.port:"")},_getServerInstanceRoot:function(a){var c=a.toLowerCase(),b=c.indexOf(this._agsRest);return-1===b&&this._isAdminResource(a)&&(b=c.indexOf("/admin")),-1===b&&(b=c.indexOf("/sharing")),-1===b&&"/"===c.substr(-1)&&
(b=c.length-1),-1<b?a.substring(0,b):a},_hasSameServerInstance:function(a,c){return a=a.toLowerCase(),c=this._getServerInstanceRoot(c).toLowerCase(),a=a.substr(a.indexOf(":")),c=c.substr(c.indexOf(":")),a===c},_sanitizeUrl:function(c){c=v.fixUrl(a.trim(c));var b=(q.defaults.io.proxyUrl||"").toLowerCase(),e=b?c.toLowerCase().indexOf(b+"?"):-1;return-1!==e&&(c=c.substring(e+b.length+1)),v.urlToObject(c).path},_isRESTService:function(a){return-1<a.indexOf(this._agsRest)},_isAdminResource:function(a){return this._agsAdmin.test(a)||
this._adminSvcs.test(a)},_isServerRsrc:function(a){return this._isRESTService(a)||this._isAdminResource(a)},_isIdenticalService:function(a,c){var b;if(this._isRESTService(a)&&this._isRESTService(c)){var e=this._getSuffix(a).toLowerCase(),d=this._getSuffix(c).toLowerCase();(b=e===d,b)||(b=/(.*)\/(MapServer|FeatureServer).*/gi,b=e.replace(b,"$1")===d.replace(b,"$1"))}else this._isAdminResource(a)&&this._isAdminResource(c)?b=!0:this._isServerRsrc(a)||this._isServerRsrc(c)||!this._isPortalDomain(a)||
(b=!0);return b},_isPortalDomain:function(c){c=c.toLowerCase();var b=(new k(c)).authority,e=this._portalConfig,g=-1!==b.indexOf(this._agolSuffix);(!g&&e&&(g=this._hasSameServerInstance(this._getServerInstanceRoot(e.restBaseUrl),c)),g)||(this._arcgisUrl||(e=a.getObject("esri.arcgis.utils.arcgisUrl"))&&(this._arcgisUrl=(new k(e)).authority),this._arcgisUrl&&(g=this._arcgisUrl.toLowerCase()===b));return g||(g=d.some(this._portals,function(a){return this._hasSameServerInstance(a,c)},this)),g=g||this._agsPortal.test(c)},
_isIdProvider:function(a,c){var b=-1,e=-1;d.forEach(this._gwDomains,function(d,g){-1===b&&d.regex.test(a)&&(b=g);-1===e&&d.regex.test(c)&&(e=g)});var g=!1;if(-1<b&&-1<e&&(0===b||4===b?(0===e||4===e)&&(g=!0):1===b?(1===e||2===e)&&(g=!0):2===b?2===e&&(g=!0):3===b&&3===e&&(g=!0)),!g){var f=this.findServerInfo(c),k=f&&f.owningSystemUrl;k&&C(f)&&this._isPortalDomain(k)&&this._isIdProvider(a,k)&&(g=!0)}return g},_isPublic:function(a){return a=this._sanitizeUrl(a),d.some(this._publicUrls,function(c){return c.test(a)})},
_getIdenticalSvcIdx:function(a,c){var b=-1;return d.some(c.resources,function(c,e){return this._isIdenticalService(a,c)?(b=e,!0):!1},this),b},_getSuffix:function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(a){var c,b,e,g=this._isRESTService(a);if(g||this._isAdminResource(a))return e=a.toLowerCase().indexOf(g?this._agsRest:"/admin/"),c=a.substring(0,e)+"/admin/generateToken",a=a.substring(0,e)+"/rest/info",b=w({url:a,content:{f:"json"},handleAs:"json",
callbackParamName:"callback"}),b.adminUrl_=c,b;if(this._isPortalDomain(a)){var f="";if(d.some(this._gwDomains,function(c){return c.regex.test(a)&&(f=c.tokenServiceUrl),!!f}),f||d.some(this._portals,function(c){return this._hasSameServerInstance(c,a)&&(f=c+this._gwTokenUrl),!!f},this),f||(e=a.toLowerCase().indexOf("/sharing"),-1!==e&&(f=a.substring(0,e)+this._gwTokenUrl)),f||(f=this._getOrigin(a)+this._gwTokenUrl),f)c=(new k(a)).port,/^http:\/\//i.test(a)&&"7080"===c&&(f=f.replace(/:7080/i,":7443")),
f=f.replace(/http:/i,"https:");return f}return-1!==a.toLowerCase().indexOf("premium.arcgisonline.com")?"https://premium.arcgisonline.com/server/tokens":void 0},_getPortalSelf:function(a,c){return"https:"===window.location.protocol?a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(c)&&(a=a.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),w({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{crossOrigin:!1,disableIdentityLookup:!0})},_hasPortalSession:function(){return!!this._getEsriAuthCookie()},
_getEsriAuthCookie:function(){var a;if(g.isSupported()){var c,b=this._getAllCookies("esri_auth");for(c=0;c<b.length;c++){var e=f.fromJson(b[c]);if(e.portalApp){a=e;break}}}return a},_getAllCookies:function(a){var b=[],e=document.cookie.match(new RegExp("(?:^|; )"+c.escapeString(a)+"\x3d([^;]*)","g"));if(e)for(a=0;a<e.length;a++){var d=e[a],g=d.indexOf("\x3d");-1<g&&(d=d.substring(g+1),b.push(decodeURIComponent(d)))}return b},_doPortalSignIn:function(a){if(g.isSupported()){var c=this._getEsriAuthCookie(),
b=this._portalConfig,e=window.location.href,d=this.findServerInfo(a);if(this.useSignInPage&&(b||this._isPortalDomain(e)||c)&&(d?d.hasPortal||d.owningSystemUrl&&this._isPortalDomain(d.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(e,a)||b&&(this._hasSameServerInstance(this._getServerInstanceRoot(b.restBaseUrl),a)||this._isIdProvider(b.restBaseUrl,a))||v.hasSameOrigin(e,a,!0)))return!0}return!1},_checkProtocol:function(c,b,e,d){var g=!0;d=d?b.adminTokenServiceUrl:b.tokenServiceUrl;0!==
a.trim(d).toLowerCase().indexOf("https:")||0===window.location.href.toLowerCase().indexOf("https:")||q.defaults.io.useCors&&(v.canUseXhr(d)||v.canUseXhr(v.getProxyUrl(!0).path))||(g=this._protocolFunc?!!this._protocolFunc({resourceUrl:c,serverInfo:b}):!1)||(c=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),c.code="IdentityManagerBase.4",c.log=l.isDebug,e(c));return g},_enqueue:function(a,c,e,d,g,f){return d||(d=new b(t._dfdCanceller)),d.resUrl_=a,d.sinfo_=
c,d.options_=e,d.admin_=g,d.refresh_=f,this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(a),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(d)):this._xoReqs.push(d):this._doSignIn(d),d},_doSignIn:function(c){this._busy=c;var b=this,e=function(a){var e=c.options_&&c.options_.resource,g=c.resUrl_,f=c.refresh_,k=!1;-1===d.indexOf(b.credentials,a)&&(f&&-1!==d.indexOf(b.credentials,f)?(f.userId=a.userId,f.token=a.token,
f.expires=a.expires,f.validity=a.validity,f.ssl=a.ssl,f.creationTime=a.creationTime,k=!0,a=f):b.credentials.push(a));a.resources||(a.resources=[]);a.resources.push(e||g);a.scope=b._isServerRsrc(g)?"server":"portal";a.onTokenChange();var e=b._soReqs,n={};b._soReqs=[];d.forEach(e,function(c){if(!this._isIdenticalService(g,c.resUrl_)){var b=this._getSuffix(c.resUrl_);n[b]||(n[b]=!0,a.resources.push(c.resUrl_))}},b);c.callback(a);d.forEach(e,function(c){c.callback(a)});b._busy=c.resUrl_=c.sinfo_=c.refresh_=
null;k||b.onCredentialCreate({credential:a});b._soReqs.length&&b._doSignIn(b._soReqs.shift());b._xoReqs.length&&b._doSignIn(b._xoReqs.shift())},g=function(a){c.errback(a);b._busy=c.resUrl_=c.sinfo_=c.refresh_=null;b._soReqs.length&&b._doSignIn(b._soReqs.shift());b._xoReqs.length&&b._doSignIn(b._xoReqs.shift())},f=function(a,d,f,k){var n,m;n=c.sinfo_;var t=!c.options_||!1!==c.options_.prompt,h=n.hasPortal&&b._findOAuthInfo(c.resUrl_);if(b._doPortalSignIn(c.resUrl_)){a=b._getEsriAuthCookie();h=b._portalConfig;
if(a)return void e(new A({userId:a.email,server:n.server,token:a.token,expires:null}));if(t)return t="",a=window.location.href,t=b.signInPage?b.signInPage:h?h.baseUrl+h.signin:b._isIdProvider(a,c.resUrl_)?b._getOrigin(a)+"/home/signin.html":n.tokenServiceUrl.replace(b._rePortalTokenSvc,"")+"/home/signin.html",t=t.replace(/http:/i,"https:"),h&&!1===h.useSSL&&(t=t.replace(/https:/i,"http:")),void(0===a.toLowerCase().replace("https","http").indexOf(t.toLowerCase().replace("https","http"))?(m=Error("Cannot redirect to Sign-In page from within Sign-In page. URL of the resource that triggered this workflow: "+
c.resUrl_),m.code="IdentityManagerBase.5",m.log=l.isDebug,g(m)):b._redirectFunc?b._redirectFunc({signInPage:t,returnUrlParamName:"returnUrl",returnUrl:a,resourceUrl:c.resUrl_,serverInfo:n}):window.location=t+"?returnUrl\x3d"+window.escape(a));m=Error("User is not signed in.");m.code="IdentityManagerBase.6";m.log=l.isDebug;g(m)}else a?e(new A({userId:a,server:n.server,token:f,expires:r.isDefined(k)?Number(k):null,ssl:!!d})):h?(a=h._oAuthCred,a||(d=new y(h,window.localStorage),f=new y(h,window.sessionStorage),
d.isValid()&&f.isValid()?d.expires>f.expires?(a=d,f.destroy()):(a=f,d.destroy()):a=d.isValid()?d:f,h._oAuthCred=a),a.isValid()?e(new A({userId:a.userId,server:n.server,token:a.token,expires:a.expires,ssl:a.ssl,_oAuthCred:a})):b._oAuthHash&&b._oAuthHash.state.portalUrl===h.portalUrl?(m=b._oAuthHash,n=new A({userId:m.username,server:n.server,token:m.access_token,expires:(new Date).getTime()+1E3*Number(m.expires_in),ssl:"true"===m.ssl,oAuthState:m.state,_oAuthCred:a}),a.storage=m.persist?window.localStorage:
window.sessionStorage,a.token=n.token,a.expires=n.expires,a.userId=n.userId,a.ssl=n.ssl,a.save(),b._oAuthHash=null,e(n)):t?c._pendingDfd=b.oAuthSignIn(c.resUrl_,n,h,c.options_).addCallbacks(e,g):(m=Error("User is not signed in."),m.code="IdentityManagerBase.6",m.log=l.isDebug,g(m))):t?b._checkProtocol(c.resUrl_,n,g,c.admin_)&&(m=c.options_,c.admin_&&(m=m||{},m.isAdmin=!0),c._pendingDfd=b.signIn(c.resUrl_,n,m).addCallbacks(e,g)):(m=Error("User is not signed in."),m.code="IdentityManagerBase.6",m.log=
l.isDebug,g(m))},k=function(){var a,f,k,n,m=c.sinfo_,t=m.owningSystemUrl,h=c.options_;(h&&(a=h.token,f=h.error,k=h.prompt),n=b._findCredential(t,{token:a,resource:c.resUrl_}),!n&&C(m)&&d.some(b.credentials,function(a){return this._isIdProvider(t,a.server)&&(n=a),!!n},b),n)?(a=b.findCredential(c.resUrl_,n.userId))?e(a):D(m,b._legacyFed)?(a=n.toJson(),a.server=m.server,a.resources=null,e(new A(a))):(c._pendingDfd=b.generateToken(b.findServerInfo(n.server),null,{serverUrl:c.resUrl_,token:n.token,ssl:n.ssl})).addCallbacks(function(a){e(new A({userId:n.userId,
server:m.server,token:a.token,expires:r.isDefined(a.expires)?Number(a.expires):null,ssl:!!a.ssl,isAdmin:c.admin_,validity:a.validity}))},g):(b._busy=null,a&&(c.options_.token=null),(c._pendingDfd=b.getCredential(t.replace(/\/?$/,"/sharing"),{resource:c.resUrl_,owningTenant:m.owningTenant,token:a,error:f,prompt:k})).addCallbacks(function(a){b._enqueue(c.resUrl_,c.sinfo_,c.options_,c,c.admin_)},function(a){g(a)}))},n=c.sinfo_.owningSystemUrl,m=this._isServerRsrc(c.resUrl_),t=c.sinfo_._restInfoDfd;t?
t.addCallbacks(function(e){var d=c.sinfo_;d.adminTokenServiceUrl=d._restInfoDfd.adminUrl_;d._restInfoDfd=null;d.tokenServiceUrl=a.getObject("authInfo.tokenServicesUrl",!1,e)||a.getObject("authInfo.tokenServiceUrl",!1,e)||a.getObject("tokenServiceUrl",!1,e);d.shortLivedTokenValidity=a.getObject("authInfo.shortLivedTokenValidity",!1,e);d.currentVersion=e.currentVersion;d.owningTenant=e.owningTenant;(e=d.owningSystemUrl=e.owningSystemUrl)&&b._portals.push(e);m&&e?k():f()},function(){c.sinfo_._restInfoDfd=
null;var a=Error("Unknown resource - could not find token service endpoint.");a.code="IdentityManagerBase.2";a.log=l.isDebug;g(a)}):m&&n?k():c.sinfo_._selfReq?c.sinfo_._selfReq.selfDfd.then(function(a){var e,d,g,f,k={};return a&&(e=a.user&&a.user.username,k.username=e,k.allSSL=a.allSSL,d=a.supportsOAuth,g=a.currentVersion,"multitenant"===a.portalMode&&(f=a.customBaseUrl)),c.sinfo_.webTierAuth=!!e,e&&b.normalizeWebTierAuth?b.generateToken(c.sinfo_,null,{ssl:k.allSSL}).always(function(a){return k.portalToken=
a&&a.token,k.tokenExpiration=a&&a.expires,k}):!e&&d&&4.4<=parseFloat(g)&&!b._doPortalSignIn(c.resUrl_)?b._generateOAuthInfo({portalUrl:c.sinfo_.server,customBaseUrl:f,owningTenant:c.sinfo_._selfReq.owningTenant}).always(function(){return k}):k}).always(function(a){c.sinfo_._selfReq=null;a?f(a.username,a.allSSL,a.portalToken,a.tokenExpiration):f()}):f()},_generateOAuthInfo:function(a){var c,e,d=this,g=a.portalUrl,f=a.customBaseUrl,k=a.owningTenant;if(a=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&
!this._hasTestedIfAppIsOnPortal){e=window.location.href;var n=e.indexOf("?");-1<n&&(e=e.slice(0,n));n=e.search(/\/(apps|home)\//);e=-1<n?e.slice(0,n):null}return a&&e?(this._hasTestedIfAppIsOnPortal=!0,c=w({url:e+"/sharing/rest",content:{f:"json"},handleAs:"json"}).then(function(){d.defaultOAuthInfo=new z({appId:"arcgisonline",popup:!0,popupCallbackUrl:e+"/home/oauth-callback.html"})})):(c=new b,c.resolve(),c=c.promise),c.then(function(){return d.defaultOAuthInfo?(g=g.replace(/^http:/i,"https:"),
w({url:g+"/sharing/rest/oauth2/validateRedirectUri",content:{accountId:k,client_id:d.defaultOAuthInfo.appId,redirect_uri:v.getAbsoluteUrl(d.defaultOAuthInfo.popupCallbackUrl),f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a){if(a.valid){var c=d.defaultOAuthInfo.clone();a.urlKey&&f?c.portalUrl="https://"+a.urlKey+"."+f:c.portalUrl=g;d.oAuthInfos.push(c)}})):void 0})}});return A=h(x,{declaredClass:"esri.Credential",tokenRefreshBuffer:2,constructor:function(c){a.mixin(this,c);
this.resources=this.resources||[];r.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},_oAuthCred:null,refreshToken:function(){var a,c,b=this,e=this.resources&&this.resources[0],g=n.id.findServerInfo(this.server),f=g&&g.owningSystemUrl,k=!!f&&"server"===this.scope,m=k&&D(g,n.id._legacyFed),t=k&&n.id.findServerInfo(f),h=g.webTierAuth,u=h&&n.id.normalizeWebTierAuth,q=B[this.server],q=q&&q[this.userId],v={username:this.userId,password:q};if((!h||u)&&(k&&!t&&d.some(n.id.serverInfos,
function(a){return n.id._isIdProvider(f,a.server)&&(t=a),!!t}),a=t&&n.id.findCredential(t.server,this.userId),!k||a)){if(m)return void a.refreshToken();if(k)c={serverUrl:e,token:a&&a.token,ssl:a&&a.ssl};else if(u)v=null,c={ssl:this.ssl};else{if(!q){var l;return e&&(e=n.id._sanitizeUrl(e),this._enqueued=1,l=n.id._enqueue(e,g,null,null,this.isAdmin,this),l.addCallback(function(){b._enqueued=0;b.refreshServerTokens()}).addErrback(function(){b._enqueued=0})),l}this.isAdmin&&(c={isAdmin:!0})}return n.id.generateToken(k?
t:g,k?null:v,c).addCallback(function(a){b.token=a.token;b.expires=r.isDefined(a.expires)?Number(a.expires):null;b.creationTime=(new Date).getTime();b.validity=a.validity;b.onTokenChange();b.refreshServerTokens()}).addErrback(function(){})}},refreshServerTokens:function(){"portal"===this.scope&&d.forEach(n.id.credentials,function(a){var c=n.id.findServerInfo(a.server),b=c&&c.owningSystemUrl;a!==this&&a.userId===this.userId&&b&&"server"===a.scope&&(n.id._hasSameServerInstance(this.server,b)||n.id._isIdProvider(b,
this.server))&&(D(c,n.id._legacyFed)?(a.token=this.token,a.expires=this.expires,a.creationTime=this.creationTime,a.validity=this.validity,a.onTokenChange()):a.refreshToken())},this)},onTokenChange:function(a){clearTimeout(this._refreshTimer);var c=this.server&&n.id.findServerInfo(this.server),b=(c=c&&c.owningSystemUrl)&&n.id.findServerInfo(c);!1!==a&&(!c||"portal"===this.scope||b&&b.webTierAuth&&!n.id.normalizeWebTierAuth)&&(r.isDefined(this.expires)||r.isDefined(this.validity))&&this._startRefreshTimer()},
onDestroy:function(){},destroy:function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var a=d.indexOf(n.id.credentials,this);-1<a&&n.id.credentials.splice(a,1);this.onTokenChange();this.onDestroy()},toJson:function(){return this._toJson()},_toJson:function(){var a=r.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,
isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),c=this.resources;return c&&0<c.length&&(a.resources=c),a},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);var c=6E4*this.tokenRefreshBuffer,b=(this.validity?this.creationTime+6E4*this.validity:this.expires)-(new Date).getTime();0>b&&(b=0);this._refreshTimer=setTimeout(a.hitch(this,this.refreshToken),b>c?b-c:b)}}),E.Credential=A,m("extend-esri")&&(n.IdentityManagerBase=E),E})},"esri/ServerInfo":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","./kernel","./lang"],function(h,l,a,d,b){h=h(null,{declaredClass:"esri.ServerInfo",constructor:function(a){l.mixin(this,a)},toJson:function(){return b.fixJson({server:this.server,tokenServiceUrl:this.tokenServiceUrl,adminTokenServiceUrl:this.adminTokenServiceUrl,shortLivedTokenValidity:this.shortLivedTokenValidity,owningSystemUrl:this.owningSystemUrl,owningTenant:this.owningTenant,currentVersion:this.currentVersion,hasPortal:this.hasPortal,hasServer:this.hasServer,webTierAuth:this.webTierAuth})}});
return a("extend-esri")&&(d.ServerInfo=h),h})},"esri/OAuthCredential":function(){define(["./kernel","dojo/_base/declare","dojo/has","dojo/json"],function(h,l,a,d){l=l(null,{declaredClass:"esri.OAuthCredential",oAuthInfo:null,storage:null,expires:null,ssl:null,token:null,userId:null,constructor:function(a,d){this.oAuthInfo=a;this.storage=d;this._init()},isValid:function(){var a=!1;if(this.oAuthInfo&&this.token&&this.userId){var d=(new Date).getTime();this.expires>d&&(this.expires-d)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&
(a=!0)}return a},save:function(){if(this.storage){var a=this._load(),f=this.oAuthInfo;if(f&&f.authNamespace&&f.portalUrl){var k=a[f.authNamespace];k||(k=a[f.authNamespace]={});k[f.portalUrl]={expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",d.stringify(a))}catch(m){}}}},destroy:function(){var a=this._load(),f=this.oAuthInfo;if(f&&f.authNamespace&&f.portalUrl&&this.storage){var k=a[f.authNamespace];if(k){delete k[f.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",
d.stringify(a))}catch(m){}}}f&&(f._oAuthCred=null,this.oAuthInfo=null)},_init:function(){var a=this._load(),d=this.oAuthInfo;d&&d.authNamespace&&d.portalUrl&&(a=a[d.authNamespace])&&(a=a[d.portalUrl],a&&(this.expires=a.expires,this.ssl=a.ssl,this.token=a.token,this.userId=a.userId))},_load:function(){var a={};if(this.storage){var f=this.storage.getItem("esriJSAPIOAuth");if(f)try{a=d.parse(f)}catch(k){}}return a}});return a("extend-esri")&&(h.OAuthCredential=l),l})},"esri/arcgis/OAuthInfo":function(){define(["../kernel",
"../lang","dojo/_base/declare","dojo/_base/lang","dojo/has"],function(h,l,a,d,b){var f=a(null,{declaredClass:"esri.arcgis.OAuthInfo",constructor:function(a){d.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",forceLogin:!1,showSocialLogins:!1,popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d480,width\x3d800,location,resizable,scrollbars,status"},a)},_oAuthCred:null,toJson:function(){return l.fixJson({appId:this.appId,
expiration:this.expiration,locale:this.locale,minTimeUntilExpiration:this.minTimeUntilExpiration,portalUrl:this.portalUrl,authNamespace:this.authNamespace,forceLogin:this.forceLogin,showSocialLogins:this.showSocialLogins,popup:this.popup,popupCallbackUrl:this.popupCallbackUrl,popupWindowFeatures:this.popupWindowFeatures})},clone:function(){return new f(this.toJson())}});return b("extend-esri")&&d.setObject("arcgis.OAuthInfo",f,h),f})},"dijit/form/Button":function(){define("require dojo/_base/declare dojo/dom-class dojo/has dojo/_base/kernel dojo/_base/lang dojo/ready ./_FormWidget ./_ButtonMixin dojo/text!./templates/Button.html ../a11yclick".split(" "),
function(h,l,a,d,b,f,k,m,g,e){d("dijit-legacy-requires")&&k(0,function(){h(["dijit/form/DropDownButton","dijit/form/ComboButton","dijit/form/ToggleButton"])});k=l("dijit.form.Button"+(d("dojo-bidi")?"_NoBidi":""),[m,g],{showLabel:!0,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:e,_setValueAttr:"valueNode",_setNameAttr:function(a){this.valueNode&&this.valueNode.setAttribute("name",a)},postCreate:function(){this.inherited(arguments);
this._setLabelFromContainer()},_setLabelFromContainer:function(){this.containerNode&&!this.label&&(this.label=f.trim(this.containerNode.innerHTML),this.onLabelSet())},_setShowLabelAttr:function(c){this.containerNode&&a.toggle(this.containerNode,"dijitDisplayNone",!c);this._set("showLabel",c)},setLabel:function(a){b.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},onLabelSet:function(){this.inherited(arguments);this.showLabel||
"title"in this.params||(this.titleNode.title=f.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});d("dojo-bidi")&&(k=l("dijit.form.Button",k,{onLabelSet:function(){this.inherited(arguments);this.titleNode.title&&this.applyTextDir(this.titleNode,this.titleNode.title)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this._setLabelAttr(this.label))}}));return k})},"dijit/form/_FormWidget":function(){define("dojo/_base/declare dojo/sniff dojo/_base/kernel dojo/ready ../_Widget ../_CssStateMixin ../_TemplatedMixin ./_FormWidgetMixin".split(" "),
function(h,l,a,d,b,f,k,m){l("dijit-legacy-requires")&&d(0,function(){require(["dijit/form/_FormValueWidget"])});return h("dijit.form._FormWidget",[b,k,f,m],{setDisabled:function(b){a.deprecated("setDisabled("+b+") is deprecated. Use set('disabled',"+b+") instead.","","2.0");this.set("disabled",b)},setValue:function(b){a.deprecated("dijit.form._FormWidget:setValue("+b+") is deprecated.  Use set('value',"+b+") instead.","","2.0");this.set("value",b)},getValue:function(){a.deprecated(this.declaredClass+
"::getValue() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},postMixInProperties:function(){this.nameAttrSetting=this.name&&!l("msapp")?'name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"";this.inherited(arguments)}})})},"dijit/form/_FormWidgetMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff dojo/window ../a11y".split(" "),function(h,l,a,d,b,f,k,m,g,e){return l("dijit.form._FormWidgetMixin",
null,{name:"",alt:"",value:"",type:"text","aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(c){this._set("disabled",c);/^(button|input|select|textarea|optgroup|option|fieldset)$/i.test(this.focusNode.tagName)?a.set(this.focusNode,"disabled",c):this.focusNode.setAttribute("aria-disabled",c?"true":"false");this.valueNode&&a.set(this.valueNode,"disabled",c);c?(this._set("hovering",!1),
this._set("active",!1),c="tabIndex"in this.attributeMap?this.attributeMap.tabIndex:"_setTabIndexAttr"in this?this._setTabIndexAttr:"focusNode",h.forEach(b.isArray(c)?c:[c],function(a){a=this[a];m("webkit")||e.hasDefaultTabStop(a)?a.setAttribute("tabIndex","-1"):a.removeAttribute("tabIndex")},this)):""!=this.tabIndex&&this.set("tabIndex",this.tabIndex)},_onFocus:function(a){if("mouse"==a&&this.isFocusable())var e=this.own(k(this.focusNode,"focus",function(){f.remove();e.remove()}))[0],d=m("pointer-events")?
"pointerup":m("MSPointer")?"MSPointerUp":m("touch-events")?"touchend, mouseup":"mouseup",f=this.own(k(this.ownerDocumentBody,d,b.hitch(this,function(a){f.remove();e.remove();this.focused&&("touchend"==a.type?this.defer("focus"):this.focus())})))[0];this.scrollOnFocus&&this.defer(function(){g.scrollIntoView(this.domNode)});this.inherited(arguments)},isFocusable:function(){return!this.disabled&&this.focusNode&&"none"!=d.get(this.domNode,"display")},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},
compare:function(a,b){return"number"==typeof a&&"number"==typeof b?isNaN(a)&&isNaN(b)?0:a-b:a>b?1:a<b?-1:0},onChange:function(){},_onChangeActive:!1,_handleOnChange:function(a,b){void 0!=this._lastValueReported||null!==b&&this._onChangeActive||(this._resetValue=this._lastValueReported=a);this._pendingOnChange=this._pendingOnChange||typeof a!=typeof this._lastValueReported||0!=this.compare(a,this._lastValueReported);(this.intermediateChanges||b||void 0===b)&&this._pendingOnChange&&(this._lastValueReported=
a,this._pendingOnChange=!1,this._onChangeActive&&(this._onChangeHandle&&this._onChangeHandle.remove(),this._onChangeHandle=this.defer(function(){this._onChangeHandle=null;this.onChange(a)})))},create:function(){this.inherited(arguments);this._onChangeActive=!0},destroy:function(){this._onChangeHandle&&(this._onChangeHandle.remove(),this.onChange(this._lastValueReported));this.inherited(arguments)}})})},"dijit/form/_ButtonMixin":function(){define(["dojo/_base/declare","dojo/dom","dojo/has","../registry"],
function(h,l,a,d){var b=h("dijit.form._ButtonMixin"+(a("dojo-bidi")?"_NoBidi":""),null,{label:"",type:"button",__onClick:function(a){a.stopPropagation();a.preventDefault();this.disabled||this.valueNode.click(a);return!1},_onClick:function(a){if(this.disabled)return a.stopPropagation(),a.preventDefault(),!1;!1===this.onClick(a)&&a.preventDefault();var b=a.defaultPrevented;if(!b&&"submit"==this.type&&!(this.valueNode||this.focusNode).form)for(var m=this.domNode;m.parentNode;m=m.parentNode){var g=d.byNode(m);
if(g&&"function"==typeof g._onSubmit){g._onSubmit(a);a.preventDefault();b=!0;break}}return!b},postCreate:function(){this.inherited(arguments);l.setSelectable(this.focusNode,!1)},onClick:function(){return!0},_setLabelAttr:function(a){this._set("label",a);(this.containerNode||this.focusNode).innerHTML=a;this.onLabelSet()},onLabelSet:function(){}});a("dojo-bidi")&&(b=h("dijit.form._ButtonMixin",b,{onLabelSet:function(){this.inherited(arguments);this.applyTextDir(this.containerNode||this.focusNode)}}));
return b})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),function(h,l,a,d,b,f,k,m){return h("dijit.form.Form",[b,f,k,m],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",
postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(a){l.set(this.domNode,"encType",a);d("ie")&&(this.domNode.encoding=a);this._set("encType",a)},reset:function(a){var b={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:a?a.target:this.domNode,target:a?a.target:this.domNode};!1!==this.onReset(b)&&b.returnValue&&
this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(a){this.reset(a);a.stopPropagation();a.preventDefault();return!1},_onSubmit:function(b){var e=this.constructor.prototype;if(this.execute!=e.execute||this.onExecute!=e.onExecute)a.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(b)&&(b.stopPropagation(),b.preventDefault())},onSubmit:function(){return this.isValid()},
submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"dijit/form/ValidationTextBox":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/i18n ./TextBox ../Tooltip dojo/text!./templates/ValidationTextBox.html dojo/i18n!./nls/validate".split(" "),function(h,l,a,d,b,f,k){var m=h("dijit.form.ValidationTextBox",b,{templateString:k,required:!1,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},pattern:".*",regExp:"",
regExpGen:function(){},state:"",tooltipPosition:[],_deprecateRegExp:function(a,b){b!=m.prototype[a]&&(l.deprecated("ValidationTextBox id\x3d"+this.id+", set('"+a+"', ...) is deprecated.  Use set('pattern', ...) instead.","","2.0"),this.set("pattern",b))},_setRegExpGenAttr:function(a){this._deprecateRegExp("regExpGen",a);this._set("regExpGen",this._computeRegexp)},_setRegExpAttr:function(a){this._deprecateRegExp("regExp",a)},_setValueAttr:function(){this.inherited(arguments);this._refreshState()},
validator:function(a,b){return(new RegExp("^(?:"+this._computeRegexp(b)+")"+(this.required?"":"?")+"$")).test(a)&&(!this.required||!this._isEmpty(a))&&(this._isEmpty(a)||void 0!==this.parse(a,b))},_isValidSubset:function(){return 0==this.textbox.value.search(this._partialre)},isValid:function(){return this.validator(this.textbox.value,this.get("constraints"))},_isEmpty:function(a){return(this.trim?/^\s*$/:/^$/).test(a)},getErrorMessage:function(){var a="$_unset_$"==this.invalidMessage?this.messages.invalidMessage:
this.invalidMessage?this.invalidMessage:this.promptMessage,b="$_unset_$"==this.missingMessage?this.messages.missingMessage:this.missingMessage?this.missingMessage:a;return this.required&&this._isEmpty(this.textbox.value)?b:a},getPromptMessage:function(){return this.promptMessage},_maskValidSubsetError:!0,validate:function(a){var b="",c=this.disabled||this.isValid(a);c&&(this._maskValidSubsetError=!0);var d=this._isEmpty(this.textbox.value),f=!c&&a&&this._isValidSubset();this._set("state",c?"":((!this._hasBeenBlurred||
a)&&d||f)&&(this._maskValidSubsetError||f&&!this._hasBeenBlurred&&a)?"Incomplete":"Error");this.focusNode.setAttribute("aria-invalid","Error"==this.state?"true":"false");"Error"==this.state?(this._maskValidSubsetError=a&&f,b=this.getErrorMessage(a)):"Incomplete"==this.state?(b=this.getPromptMessage(a),this._maskValidSubsetError=!this._hasBeenBlurred||a):d&&(b=this.getPromptMessage(a));this.set("message",b);return c},displayMessage:function(a){a&&this.focused?f.show(a,this.domNode,this.tooltipPosition,
!this.isLeftToRight()):f.hide(this.domNode)},_refreshState:function(){this._created&&this.validate(this.focused);this.inherited(arguments)},constructor:function(b){this.constraints=a.clone(this.constraints);this.baseClass+=" dijitValidationTextBox"},startup:function(){this.inherited(arguments);this._refreshState()},_setConstraintsAttr:function(a){!a.locale&&this.lang&&(a.locale=this.lang);this._set("constraints",a);this._refreshState()},_setPatternAttr:function(a){this._set("pattern",a);this._refreshState()},
_computeRegexp:function(a){var b=this.pattern;"function"==typeof b&&(b=b.call(this,a));if(b!=this._lastRegExp){var c="";this._lastRegExp=b;".*"!=b&&b.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(a){switch(a.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":c+=a;break;case ")":c+="|$)";break;default:c+="(?:"+a+"|$)"}});try{"".search(c)}catch(d){c=this.pattern,console.warn("RegExp error in "+this.declaredClass+": "+this.pattern)}this._partialre="^(?:"+
c+")$"}return b},postMixInProperties:function(){this.inherited(arguments);this.messages=d.getLocalization("dijit.form","validate",this.lang);this._setConstraintsAttr(this.constraints)},_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setMessageAttr:function(a){this._set("message",a);this.displayMessage(a)},reset:function(){this._maskValidSubsetError=
!0;this.inherited(arguments)},_onBlur:function(){this.displayMessage("");this.inherited(arguments)},destroy:function(){f.hide(this.domNode);this.inherited(arguments)}});return m})},"dijit/form/TextBox":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-style dojo/_base/kernel dojo/_base/lang dojo/on dojo/sniff ./_FormValueWidget ./_TextBoxMixin dojo/text!./templates/TextBox.html ../main".split(" "),function(h,l,a,d,b,f,k,m,g,e,c){m=h("dijit.form.TextBox"+(k("dojo-bidi")?"_NoBidi":""),
[m,g],{templateString:e,_singleNodeTemplate:'\x3cinput class\x3d"dijit dijitReset dijitLeft dijitInputField" data-dojo-attach-point\x3d"textbox,focusNode" autocomplete\x3d"off" type\x3d"${type}" ${!nameAttrSetting} /\x3e',_buttonInputDisabled:k("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var a=this.type.toLowerCase();if(this.templateString&&"input"==this.templateString.toLowerCase()||("hidden"==a||"file"==a)&&this.templateString==this.constructor.prototype.templateString)this.templateString=
this._singleNodeTemplate;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);9>k("ie")&&this.defer(function(){try{var c=a.getComputedStyle(this.domNode);if(c){var b=c.fontFamily;if(b){var e=this.domNode.getElementsByTagName("INPUT");if(e)for(c=0;c<e.length;c++)e[c].style.fontFamily=b}}}catch(d){}})},_setPlaceHolderAttr:function(a){this._set("placeHolder",a);this._phspan||(this._attachPoints.push("_phspan"),this._phspan=l.create("span",{className:"dijitPlaceHolder dijitInputField"},
this.textbox,"after"),this.own(f(this._phspan,"mousedown",function(a){a.preventDefault()}),f(this._phspan,"touchend, pointerup, MSPointerUp",b.hitch(this,function(){this.focus()}))));this._phspan.innerHTML="";this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(a));this._updatePlaceHolder()},_onInput:function(a){this.inherited(arguments);this._updatePlaceHolder()},_updatePlaceHolder:function(){this._phspan&&(this._phspan.style.display=this.placeHolder&&!this.textbox.value?"":"none")},
_setValueAttr:function(a,c,b){this.inherited(arguments);this._updatePlaceHolder()},getDisplayedValue:function(){d.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");return this.get("displayedValue")},setDisplayedValue:function(a){d.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",a)},_onBlur:function(a){this.disabled||(this.inherited(arguments),
this._updatePlaceHolder(),k("mozilla")&&this.selectOnClick&&(this.textbox.selectionStart=this.textbox.selectionEnd=void 0))},_onFocus:function(a){this.disabled||this.readOnly||(this.inherited(arguments),this._updatePlaceHolder())}});9>k("ie")&&(m.prototype._isTextSelected=function(){var a=this.ownerDocument.selection.createRange();return a.parentElement()==this.textbox&&0<a.text.length},c._setSelectionRange=g._setSelectionRange=function(a,c,b){a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),
a.moveStart("character",-99999),a.moveStart("character",c),a.moveEnd("character",b-c),a.select())});k("dojo-bidi")&&(m=h("dijit.form.TextBox",m,{_setPlaceHolderAttr:function(a){this.inherited(arguments);this.applyTextDir(this._phspan)}}));return m})},"dijit/form/_FormValueWidget":function(){define(["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(h,l,a,d){return h("dijit.form._FormValueWidget",[a,d],{_layoutHackIE7:function(){if(7==l("ie"))for(var a=this.domNode,d=a.parentNode,
k=a.firstChild||a,m=k.style.filter,g=this;d&&0==d.clientHeight;)(function(){var a=g.connect(d,"onscroll",function(){g.disconnect(a);k.style.filter=(new Date).getMilliseconds();g.defer(function(){k.style.filter=m})})})(),d=d.parentNode}})})},"dijit/form/_FormValueMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on ./_FormWidgetMixin".split(" "),function(h,l,a,d,b,f){return h("dijit.form._FormValueMixin",f,{readOnly:!1,_setReadOnlyAttr:function(a){l.set(this.focusNode,
"readOnly",a);this._set("readOnly",a)},postCreate:function(){this.inherited(arguments);void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.value)},_setValueAttr:function(a,b){this._handleOnChange(a,b)},_handleOnChange:function(a,b){this._set("value",a);this.inherited(arguments)},undo:function(){this._setValueAttr(this._lastValueReported,!1)},reset:function(){this._hasBeenBlurred=!1;this._setValueAttr(this._resetValue,!0)}})})},"dijit/form/_TextBoxMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/sniff dojo/keys dojo/_base/lang dojo/on ../main".split(" "),
function(h,l,a,d,b,f,k,m){var g=l("dijit.form._TextBoxMixin"+(d("dojo-bidi")?"_NoBidi":""),null,{trim:!1,uppercase:!1,lowercase:!1,propercase:!1,maxLength:"",selectOnClick:!1,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints)},_setValueAttr:function(a,c,b){var d;void 0!==a&&(d=this.filter(a),"string"!=typeof b&&(b=null===d||"number"==typeof d&&isNaN(d)?"":this.filter(this.format(d,this.constraints)),0!=this.compare(d,this.filter(this.parse(b,this.constraints)))&&
(b=null)));null==b||"number"==typeof b&&isNaN(b)||this.textbox.value==b||(this.textbox.value=b,this._set("displayedValue",this.get("displayedValue")));this.inherited(arguments,[d,c])},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value)},_setDisplayedValueAttr:function(a){null==a?a="":"string"!=typeof a&&(a=String(a));this.textbox.value=a;this._setValueAttr(this.get("value"),void 0);this._set("displayedValue",this.get("displayedValue"))},format:function(a){return null==
a?"":a.toString?a.toString():a},parse:function(a){return a},_refreshState:function(){},onInput:function(){},_onInput:function(a){this._lastInputEventValue=this.textbox.value;this._processInput(this._lastInputProducingEvent||a);delete this._lastInputProducingEvent;this.intermediateChanges&&this._handleOnChange(this.get("value"),!1)},_processInput:function(){this._refreshState();this._set("displayedValue",this.get("displayedValue"))},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);
this.inherited(arguments);this.own(k(this.textbox,"keydown, keypress, paste, cut, compositionend",f.hitch(this,function(a){var c;if("keydown"==a.type&&229!=a.keyCode){c=a.keyCode;switch(c){case b.SHIFT:case b.ALT:case b.CTRL:case b.META:case b.CAPS_LOCK:case b.NUM_LOCK:case b.SCROLL_LOCK:return}if(!a.ctrlKey&&!a.metaKey&&!a.altKey){switch(c){case b.NUMPAD_0:case b.NUMPAD_1:case b.NUMPAD_2:case b.NUMPAD_3:case b.NUMPAD_4:case b.NUMPAD_5:case b.NUMPAD_6:case b.NUMPAD_7:case b.NUMPAD_8:case b.NUMPAD_9:case b.NUMPAD_MULTIPLY:case b.NUMPAD_PLUS:case b.NUMPAD_ENTER:case b.NUMPAD_MINUS:case b.NUMPAD_PERIOD:case b.NUMPAD_DIVIDE:return}if(65<=
c&&90>=c||48<=c&&57>=c||c==b.SPACE)return;c=!1;for(var g in b)if(b[g]===a.keyCode){c=!0;break}if(!c)return}}(c=32<=a.charCode?String.fromCharCode(a.charCode):a.charCode)||(c=65<=a.keyCode&&90>=a.keyCode||48<=a.keyCode&&57>=a.keyCode||a.keyCode==b.SPACE?String.fromCharCode(a.keyCode):a.keyCode);c||(c=229);if("keypress"==a.type){if("string"!=typeof c)return;if("a"<=c&&"z">=c||"A"<=c&&"Z">=c||"0"<=c&&"9">=c||" "===c)if(a.ctrlKey||a.metaKey||a.altKey)return}var m={faux:!0},h;for(h in a)/^(layer[XY]|returnValue|keyLocation)$/.test(h)||
(g=a[h],"function"!=typeof g&&"undefined"!=typeof g&&(m[h]=g));f.mixin(m,{charOrCode:c,_wasConsumed:!1,preventDefault:function(){m._wasConsumed=!0;a.preventDefault()},stopPropagation:function(){a.stopPropagation()}});this._lastInputProducingEvent=m;!1===this.onInput(m)&&(m.preventDefault(),m.stopPropagation());if(!m._wasConsumed&&9>=d("ie"))switch(a.keyCode){case b.TAB:case b.ESCAPE:case b.DOWN_ARROW:case b.UP_ARROW:case b.LEFT_ARROW:case b.RIGHT_ARROW:break;default:if(a.keyCode==b.ENTER&&"textarea"!=
this.textbox.tagName.toLowerCase())break;this.defer(function(){this.textbox.value!==this._lastInputEventValue&&k.emit(this.textbox,"input",{bubbles:!0})})}})),k(this.textbox,"input",f.hitch(this,"_onInput")),k(this.domNode,"keypress",function(a){a.stopPropagation()}))},_blankValue:"",filter:function(a){if(null===a)return this._blankValue;if("string"!=typeof a)return a;this.trim&&(a=f.trim(a));this.uppercase&&(a=a.toUpperCase());this.lowercase&&(a=a.toLowerCase());this.propercase&&(a=a.replace(/[^\s]+/g,
function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}));return a},_setBlurValue:function(){this._setValueAttr(this.get("value"),!0)},_onBlur:function(a){this.disabled||(this._setBlurValue(),this.inherited(arguments))},_isTextSelected:function(){return this.textbox.selectionStart!=this.textbox.selectionEnd},_onFocus:function(a){this.disabled||this.readOnly||(this.selectOnClick&&"mouse"==a&&(this._selectOnClickHandle=k.once(this.domNode,"mouseup, touchend",f.hitch(this,function(a){this._isTextSelected()||
g.selectInputText(this.textbox)})),this.own(this._selectOnClickHandle),this.defer(function(){this._selectOnClickHandle&&(this._selectOnClickHandle.remove(),this._selectOnClickHandle=null)},500)),this.inherited(arguments),this._refreshState())},reset:function(){this.textbox.value="";this.inherited(arguments)}});d("dojo-bidi")&&(g=l("dijit.form._TextBoxMixin",g,{_setValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_setDisplayedValueAttr:function(){this.inherited(arguments);
this.applyTextDir(this.focusNode)},_onInput:function(){this.applyTextDir(this.focusNode);this.inherited(arguments)}}));g._setSelectionRange=m._setSelectionRange=function(a,c,b){a.setSelectionRange&&a.setSelectionRange(c,b)};g.selectInputText=m.selectInputText=function(b,c,d){b=a.byId(b);isNaN(c)&&(c=0);isNaN(d)&&(d=b.value?b.value.length:0);try{b.focus(),g._setSelectionRange(b,c,d)}catch(f){}};return g})},"dijit/Tooltip":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff ./_base/manager ./place ./_Widget ./_TemplatedMixin ./BackgroundIframe dojo/text!./templates/Tooltip.html ./main".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w){function x(){}var y=l("dijit._MasterTooltip",[r,u],{duration:n.defaultDuration,templateString:t,postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);this.bgIframe=new v(this.domNode);this.fadeIn=a.fadeIn({node:this.domNode,duration:this.duration,onEnd:m.hitch(this,"_onShow")});this.fadeOut=a.fadeOut({node:this.domNode,duration:this.duration,onEnd:m.hitch(this,"_onHide")})},show:function(a,c,b,e,d,g,f){if(!this.aroundNode||this.aroundNode!==
c||this.containerNode.innerHTML!=a)if("playing"==this.fadeOut.status())this._onDeck=arguments;else{this.containerNode.innerHTML=a;d&&this.set("textDir",d);this.containerNode.align=e?"right":"left";var n=q.around(this.domNode,c,b&&b.length?b:z.defaultPosition,!e,m.hitch(this,"orient")),t=n.aroundNodePos;"M"==n.corner.charAt(0)&&"M"==n.aroundCorner.charAt(0)?(this.connectorNode.style.top=t.y+(t.h-this.connectorNode.offsetHeight>>1)-n.y+"px",this.connectorNode.style.left=""):"M"==n.corner.charAt(1)&&
"M"==n.aroundCorner.charAt(1)?this.connectorNode.style.left=t.x+(t.w-this.connectorNode.offsetWidth>>1)-n.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");k.set(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=c;this.onMouseEnter=g||x;this.onMouseLeave=f||x}},orient:function(a,b,e,d,g){this.connectorNode.style.top="";var k=d.h;d=d.w;a.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove",
"BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[b+"-"+e];this.domNode.style.width="auto";var n=f.position(this.domNode);if(c("ie")||c("trident"))n.w+=2;var m=Math.min(Math.max(d,1),n.w);f.setMarginBox(this.domNode,{w:m});"B"==e.charAt(0)&&"B"==b.charAt(0)?(a=f.position(a),b=
this.connectorNode.offsetHeight,a.h>k?(this.connectorNode.style.top=k-(g.h+b>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(g.h/2-b/2,0),a.h-b)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");return Math.max(0,n.w-d)},_onShow:function(){c("ie")&&(this.domNode.style.filter="")},hide:function(a){this._onDeck&&this._onDeck[1]==a?this._onDeck=null:this.aroundNode===a&&(this.fadeIn.stop(),this.isShowingNow=
!1,this.aroundNode=null,this.fadeOut.play());this.onMouseEnter=this.onMouseLeave=x},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";this._onDeck&&(this.show.apply(this,this._onDeck),this._onDeck=null)}});c("dojo-bidi")&&y.extend({_setAutoTextDir:function(a){this.applyTextDir(a);h.forEach(a.children,function(a){this._setAutoTextDir(a)},this)},_setTextDirAttr:function(a){this._set("textDir",a);"auto"==a?this._setAutoTextDir(this.containerNode):this.containerNode.dir=
this.textDir}});w.showTooltip=function(a,c,b,e,d,g,f){b&&(b=h.map(b,function(a){return{after:"after-centered",before:"before-centered"}[a]||a}));z._masterTT||(w._masterTT=z._masterTT=new y);return z._masterTT.show(a,c,b,e,d,g,f)};w.hideTooltip=function(a){return z._masterTT&&z._masterTT.hide(a)};var z=l("dijit.Tooltip",r,{label:"",showDelay:400,hideDelay:400,connectId:[],position:[],selector:"",_setConnectIdAttr:function(a){h.forEach(this._connections||[],function(a){h.forEach(a,function(a){a.remove()})},
this);this._connectIds=h.filter(m.isArrayLike(a)?a:a?[a]:[],function(a){return d.byId(a,this.ownerDocument)},this);this._connections=h.map(this._connectIds,function(a){a=d.byId(a,this.ownerDocument);var c=this.selector,b=c?function(a){return e.selector(c,a)}:function(a){return a},f=this;return[e(a,b(g.enter),function(){f._onHover(this)}),e(a,b("focusin"),function(){f._onHover(this)}),e(a,b(g.leave),m.hitch(f,"_onUnHover")),e(a,b("focusout"),m.hitch(f,"set","state","DORMANT"))]},this);this._set("connectId",
a)},addTarget:function(a){a=a.id||a;-1==h.indexOf(this._connectIds,a)&&this.set("connectId",this._connectIds.concat(a))},removeTarget:function(a){a=h.indexOf(this._connectIds,a.id||a);0<=a&&(this._connectIds.splice(a,1),this.set("connectId",this._connectIds))},buildRendering:function(){this.inherited(arguments);b.add(this.domNode,"dijitTooltipData")},startup:function(){this.inherited(arguments);var a=this.connectId;h.forEach(m.isArrayLike(a)?a:[a],this.addTarget,this)},getContent:function(a){return this.label||
this.domNode.innerHTML},state:"DORMANT",_setStateAttr:function(a){if(!(this.state==a||"SHOW TIMER"==a&&"SHOWING"==this.state||"HIDE TIMER"==a&&"DORMANT"==this.state)){this._hideTimer&&(this._hideTimer.remove(),delete this._hideTimer);this._showTimer&&(this._showTimer.remove(),delete this._showTimer);switch(a){case "DORMANT":this._connectNode&&(z.hide(this._connectNode),delete this._connectNode,this.onHide());break;case "SHOW TIMER":"SHOWING"!=this.state&&(this._showTimer=this.defer(function(){this.set("state",
"SHOWING")},this.showDelay));break;case "SHOWING":var c=this.getContent(this._connectNode);if(!c){this.set("state","DORMANT");return}z.show(c,this._connectNode,this.position,!this.isLeftToRight(),this.textDir,m.hitch(this,"set","state","SHOWING"),m.hitch(this,"set","state","HIDE TIMER"));this.onShow(this._connectNode,this.position);break;case "HIDE TIMER":this._hideTimer=this.defer(function(){this.set("state","DORMANT")},this.hideDelay)}this._set("state",a)}},_onHover:function(a){this._connectNode&&
a!=this._connectNode&&this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOW TIMER")},_onUnHover:function(a){this.set("state","HIDE TIMER")},open:function(a){this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOWING")},close:function(){this.set("state","DORMANT")},onShow:function(){},onHide:function(){},destroy:function(){this.set("state","DORMANT");h.forEach(this._connections||[],function(a){h.forEach(a,function(a){a.remove()})},this);this.inherited(arguments)}});
z._MasterTooltip=y;z.show=w.showTooltip;z.hide=w.hideTooltip;z.defaultPosition=["after-centered","before-centered"];return z})},"dijit/place":function(){define("dojo/_base/array dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/_base/window ./Viewport ./main".split(" "),function(h,l,a,d,b,f,k){function m(e,c,d,g){var k=f.getEffectiveBox(e.ownerDocument);e.parentNode&&"body"==String(e.parentNode.tagName).toLowerCase()||b.body(e.ownerDocument).appendChild(e);var m=null;h.some(c,function(a){var c=
a.corner,b=a.pos,f=0,t={w:{L:k.l+k.w-b.x,R:b.x-k.l,M:k.w}[c.charAt(1)],h:{T:k.t+k.h-b.y,B:b.y-k.t,M:k.h}[c.charAt(0)]},h=e.style;h.left=h.right="auto";d&&(f=d(e,a.aroundCorner,c,t,g),f="undefined"==typeof f?0:f);var v=e.style,D=v.display,E=v.visibility;"none"==v.display&&(v.visibility="hidden",v.display="");h=l.position(e);v.display=D;v.visibility=E;D={L:b.x,R:b.x-h.w,M:Math.max(k.l,Math.min(k.l+k.w,b.x+(h.w>>1))-h.w)}[c.charAt(1)];E={T:b.y,B:b.y-h.h,M:Math.max(k.t,Math.min(k.t+k.h,b.y+(h.h>>1))-
h.h)}[c.charAt(0)];b=Math.max(k.l,D);v=Math.max(k.t,E);D=Math.min(k.l+k.w,D+h.w);E=Math.min(k.t+k.h,E+h.h);D-=b;E-=v;f+=h.w-D+(h.h-E);if(null==m||f<m.overflow)m={corner:c,aroundCorner:a.aroundCorner,x:b,y:v,w:D,h:E,overflow:f,spaceAvailable:t};return!f});m.overflow&&d&&d(e,m.aroundCorner,m.corner,m.spaceAvailable,g);c=m.y;var v=m.x,t=b.body(e.ownerDocument);/relative|absolute/.test(a.get(t,"position"))&&(c-=a.get(t,"marginTop"),v-=a.get(t,"marginLeft"));t=e.style;t.top=c+"px";t.left=v+"px";t.right=
"auto";return m}var g={TL:"BR",TR:"BL",BL:"TR",BR:"TL"};return k.place={at:function(a,c,b,d,f){b=h.map(b,function(a){var b={corner:a,aroundCorner:g[a],pos:{x:c.x,y:c.y}};d&&(b.pos.x+="L"==a.charAt(1)?d.x:-d.x,b.pos.y+="T"==a.charAt(0)?d.y:-d.y);return b});return m(a,b,f)},around:function(b,c,g,f,k){function u(a,c){E.push({aroundCorner:a,corner:c,pos:{x:{L:A,R:A+C,M:A+(C>>1)}[a.charAt(1)],y:{T:B,B:B+D,M:B+(D>>1)}[a.charAt(0)]}})}var v;if("string"==typeof c||"offsetWidth"in c||"ownerSVGElement"in c){if(v=
l.position(c,!0),/^(above|below)/.test(g[0])){var t=l.getBorderExtents(c),w=c.firstChild?l.getBorderExtents(c.firstChild):{t:0,l:0,b:0,r:0},x=l.getBorderExtents(b),y=b.firstChild?l.getBorderExtents(b.firstChild):{t:0,l:0,b:0,r:0};v.y+=Math.min(t.t+w.t,x.t+y.t);v.h-=Math.min(t.t+w.t,x.t+y.t)+Math.min(t.b+w.b,x.b+y.b)}}else v=c;if(c.parentNode)for(t="absolute"==a.getComputedStyle(c).position,c=c.parentNode;c&&1==c.nodeType&&"BODY"!=c.nodeName;){w=l.position(c,!0);x=a.getComputedStyle(c);/relative|absolute/.test(x.position)&&
(t=!1);if(!t&&/hidden|auto|scroll/.test(x.overflow)){var y=Math.min(v.y+v.h,w.y+w.h),z=Math.min(v.x+v.w,w.x+w.w);v.x=Math.max(v.x,w.x);v.y=Math.max(v.y,w.y);v.h=y-v.y;v.w=z-v.x}"absolute"==x.position&&(t=!0);c=c.parentNode}var A=v.x,B=v.y,C="w"in v?v.w:v.w=v.width,D="h"in v?v.h:(d.deprecated("place.around: dijit/place.__Rectangle: { x:"+A+", y:"+B+", height:"+v.height+", width:"+C+" } has been deprecated.  Please use { x:"+A+", y:"+B+", h:"+v.height+", w:"+C+" }","","2.0"),v.h=v.height),E=[];h.forEach(g,
function(a){var c=f;switch(a){case "above-centered":u("TM","BM");break;case "below-centered":u("BM","TM");break;case "after-centered":c=!c;case "before-centered":u(c?"ML":"MR",c?"MR":"ML");break;case "after":c=!c;case "before":u(c?"TL":"TR",c?"TR":"TL");u(c?"BL":"BR",c?"BR":"BL");break;case "below-alt":c=!c;case "below":u(c?"BL":"BR",c?"TL":"TR");u(c?"BR":"BL",c?"TR":"TL");break;case "above-alt":c=!c;case "above":u(c?"TL":"TR",c?"BL":"BR");u(c?"TR":"TL",c?"BR":"BL");break;default:u(a.aroundCorner,
a.corner)}});b=m(b,E,k,{w:C,h:D});b.aroundNodePos=v;return b}}})},"dijit/form/nls/validate":function(){define({root:{invalidMessage:"The value entered is not valid.",missingMessage:"This value is required.",rangeMessage:"This value is out of range."},bs:!0,mk:!0,sr:!0,zh:!0,"zh-tw":!0,vi:!0,uk:!0,tr:!0,th:!0,sv:!0,sl:!0,sk:!0,ru:!0,ro:!0,pt:!0,"pt-pt":!0,pl:!0,nl:!0,nb:!0,lv:!0,lt:!0,ko:!0,kk:!0,ja:!0,it:!0,id:!0,hu:!0,hr:!0,he:!0,fr:!0,fi:!0,eu:!0,et:!0,es:!0,el:!0,de:!0,da:!0,cs:!0,ca:!0,bg:!0,
az:!0,ar:!0})},"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!./nls/jsapi dojo/io-query dojo/sniff dojo/json dijit/form/Button dojo/query".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(a){this._oAuthRedirectFunc=a},oAuthSignIn:function(a,b,d,g){var f=this._oAuthDfd=new m;f.resUrl_=a;f.sinfo_=b;f.oinfo_=d;var k=!g||!1!==g.oAuthPopupConfirmation;if(!d.popup||!k)return this._doOAuthSignIn(a,b,d),f;this._nls||(this._nls=c.identity);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());a=this.oAuthDialog;b=g&&g.error;g=g&&g.token;return l.hide(a.errMsg_),b&&403==b.code&&g&&(e.set(a.errMsg_,"innerHTML",this._nls.forbidden),l.show(a.errMsg_)),
a.show(),f},setOAuthResponseHash:function(a){var c=this._oAuthDfd;if(this._oAuthDfd=null,c&&a)if(clearInterval(this._oAuthIntervalId),"#"===a.charAt(0)&&(a=a.substring(1)),a=n.queryToObject(a),a.error)a=Error("access_denied"===a.error?"ABORTED":"OAuth: "+a.error+" - "+a.error_description),a.code="IdentityManagerBase.2",a.log=k.isDebug,c.errback(a);else{var b=c.oinfo_._oAuthCred,e=new h({userId:a.username,server:c.sinfo_.server,token:a.access_token,expires:(new Date).getTime()+1E3*Number(a.expires_in),
ssl:"true"===a.ssl,_oAuthCred:b});b.storage=a.persist?window.localStorage:window.sessionStorage;b.token=e.token;b.expires=e.expires;b.userId=e.userId;b.ssl=e.ssl;b.save();c.callback(e)}},_createOAuthDialog:function(){var c=this._nls,e=a.substitute(c,this._oAuthDialogContent),d=new b({title:c.title,content:e,"class":"esriOAuthSignInDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:function(){var a=d.esriIdMgr_._oAuthDfd;d.hide_();d.esriIdMgr_._doOAuthSignIn(a.resUrl_,a.sinfo_,a.oinfo_)},cancel_:function(){var a=
d.esriIdMgr_._oAuthDfd;d.esriIdMgr_._oAuthDfd=null;d.hide_();var c=Error("ABORTED");c.code="IdentityManager.2";c.log=k.isDebug;a.errback(c)},hide_:function(){l.hide(d.errMsg_);d.hide();b._DialogLevelManager.hide(d)}}),c=d.domNode;return d.btnSubmit_=f.byNode(g.query(".esriIdSubmit",c)[0]),d.btnCancel_=f.byNode(g.query(".esriIdCancel",c)[0]),d.errMsg_=g.query(".esriErrorMsg",c)[0],d.connect(d.btnSubmit_,"onClick",d.execute_),d.connect(d.btnCancel_,"onClick",d.onCancel),d.connect(d,"onCancel",d.cancel_),
d},_doOAuthSignIn:function(a,c,b){var e=this,g={client_id:b.appId,response_type:"token",state:r.stringify({portalUrl:b.portalUrl}),expiration:b.expiration,locale:b.locale,redirect_uri:b.popup?d.getAbsoluteUrl(b.popupCallbackUrl):window.location.href.replace(/#.*$/,"")};b.forceLogin&&(g.force_login=!0);b.showSocialLogins&&(g.showSocialLogins=!0);var f=b.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",m=f+"?"+n.objectToQuery(g);if(b.popup){var h;(7===q("ie")?(h=window.open(b.popupCallbackUrl,
"esriJSAPIOAuth",b.popupWindowFeatures),h.location=m):h=window.open(m,"esriJSAPIOAuth",b.popupWindowFeatures),h)?(h.focus(),this._oAuthDfd.oAuthWin_=h,this._oAuthIntervalId=setInterval(function(){if(h.closed){clearInterval(e._oAuthIntervalId);var a=e._oAuthDfd;if(a){var c=Error("ABORTED");c.code="IdentityManager.2";c.log=k.isDebug;a.errback(c)}}},500)):(a=Error("ABORTED"),a.code="IdentityManager.2",a.log=k.isDebug,this._oAuthDfd.errback(a))}else this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:g,
authorizeUrl:f,resourceUrl:a,serverInfo:c,oAuthInfo:b}):window.location=m}}})},"cmv/viewer/js/viewer/_WidgetsMixin":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/promise/all dojo/Deferred put-selector dijit/Menu dijit/layout/ContentPane gis/dijit/FloatingTitlePane gis/dijit/FloatingWidgetDialog".split(" "),function(h,l,a,d,b,f,k,m,g,e){return h(null,{legendLayerInfos:[],editorLayerInfos:[],identifyLayerInfos:[],layerControlLayerInfos:[],widgets:{},widgetTypes:"titlePane contentPane floating domNode invisible map layer layout loading".split(" "),
postConfig:function(c){var e;if(c)e=new b,c.then(a.hitch(this,function(){d(this.createWidgets(["loading"])).then(e.resolve)}));else{var g=this.createWidgets(["loading"]);g&&g.length&&(e=d(g))}return this.inherited(arguments)||e},startup:function(){this.inherited(arguments);this.mapDeferred&&this.mapDeferred.then(a.hitch(this,"createWidgets",["map","layer"]));this.layoutDeferred&&d([this.mapDeferred,this.layoutDeferred]).then(a.hitch(this,"createWidgets",null))},createWidgets:function(c){function b(a){return d=
l.filter(e,function(c){return c.placeAt&&c.placeAt===a})}var e=[],d;c=c||this.widgetTypes;for(var g in this.config.widgets)if(this.config.widgets.hasOwnProperty(g)){var f=a.clone(this.config.widgets[g]);f.widgetKey=f.widgetKey||f.id||g;f.include&&!this.widgets[f.widgetKey]&&0<=l.indexOf(c,f.type)&&(f.position="undefined"!==typeof f.position?f.position:1E4,"titlePane"!==f.type&&"contentPane"!==f.type||f.placeAt||(f.placeAt="left"),e.push(f),this.widgets[g]=!0)}for(var k in this.panes)this.panes.hasOwnProperty(k)&&
"outer"!==k&&"center"!==k&&(d=b(k),d.sort(function(a,c){return a.position-c.position}),0<d.length&&0!==d[0].position&&(d[0].position=0),l.forEach(d,function(a,c){this.widgetLoader(a,c)},this));d=l.filter(e,function(a){return!a.placeAt});d.sort(function(a,c){return a.position-c.position});var m=[];l.forEach(d,function(a,c){var b=this.widgetLoader(a,c);b&&m.push(b)},this);return m},widgetLoader:function(c,e){var d,g;d=this.widgetTypes;d=d.concat(this.config.widgetTypes||[]);if(0>l.indexOf(d,c.type))return this.handleError({source:"Controller",
error:'Widget type "'+c.type+'" ('+c.title+") at position "+e+" is not supported."}),null;e&&(c.position=e);if("titlePane"===c.type||"contentPane"===c.type||"floating"===c.type)d=c.widgetKey+"_parent","titlePane"===c.type?g=this._createTitlePaneWidget(d,c):"contentPane"===c.type?g=this._createContentPaneWidget(d,c):"floating"===c.type&&(g=this._createFloatingWidget(d,c)),c.parentWidget=g,this._showWidgetLoader(g);var f=new b;"string"===typeof c.options?require([c.options,c.path],a.hitch(this,function(a,
b){f.resolve();this.createWidget(c,a,b)})):require([c.path],a.hitch(this,function(a){f.resolve();this.createWidget(c,c.options,a)}));return f},createWidget:function(a,b,e){var d=a.widgetKey;if(d){b=this._setWidgetOptions(a,b);var g=b.parentWidget,k=this.widgets;k[d]="titlePane"===a.type||"contentPane"===a.type||"floating"===a.type?(new e(b,f("div"))).placeAt(g.containerNode):"domNode"===a.type?new e(b,a.srcNodeRef):new e(b);k[d]&&k[d].startup&&!k[d]._started&&k[d].startup();this._hideWidgetLoader(g)}},
_setWidgetOptions:function(a,b){a.id&&(b.id=a.id+"_widget");b.parentWidget=a.parentWidget;b.map&&(b.map=this.map);b.mapRightClickMenu&&(this.mapRightClickMenu||(this.mapRightClickMenu=new k({targetNodeIds:[this.map.root],selector:".esriMapLayers"}),this.mapRightClickMenu.startup()),b.mapRightClickMenu=this.mapRightClickMenu);b.mapClickMode&&(b.mapClickMode=this.mapClickMode.current);b.legendLayerInfos&&(b.layerInfos=this.legendLayerInfos);b.layerControlLayerInfos&&(b.layerInfos=this.layerControlLayerInfos);
b.editorLayerInfos&&(b.layerInfos=this.editorLayerInfos);b.identifyLayerInfos&&(b.layerInfos=this.identifyLayerInfos);return b},_showWidgetLoader:function(a){a&&a.containerNode&&(a.loadingNode=f(a.containerNode,"div.widgetLoader i.fa.fa-spinner.fa-pulse.fa-fw").parentNode)},_hideWidgetLoader:function(a){a&&a.loadingNode&&require(["dojo/domReady!"],function(){f(a.loadingNode,"!")})},_createTitlePaneWidget:function(c,b){var e,d=a.mixin({title:b.title||"Widget",iconClass:b.iconClass,open:b.open||!1,
canFloat:b.canFloat||!1,resizable:b.resizable||!1},b.paneOptions||{});c&&(d.id=c);var f=b.placeAt;"string"===typeof f&&(f=this.panes[f]);f||(f=this.panes.left);f&&(d.sidebar=f,e=(new g(d)).placeAt(f,b.position),e.startup());return e},_createFloatingWidget:function(c,b){var d=a.mixin({title:b.title},b.paneOptions||{});c&&(d.id=c);d=new e(d);d.startup();return d},_createContentPaneWidget:function(c,b){var e,d=a.mixin({title:b.title,region:b.region||"center"},b.paneOptions||{});b.className&&(d.className=
b.className);c&&(d.id=c);var g=b.placeAt;g?"string"===typeof g&&(g=this.panes[g]):g=this.panes.left;g&&(e=(new m(d)).placeAt(g),e.startup());return e}})})},"dijit/Menu":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v){c("dijit-legacy-requires")&&v(0,function(){h(["dijit/MenuItem",
"dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"])});return a("dijit.Menu",u,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):l.forEach(this.targetNodeIds,this.bindDomNode,this);this.inherited(arguments)},_iframeContentWindow:function(a){return q.get(this._iframeContentDocument(a))||this._iframeContentDocument(a).__parent__||
a.name&&document.frames[a.name]||null},_iframeContentDocument:function(a){return a.contentDocument||a.contentWindow&&a.contentWindow.document||a.name&&document.frames[a.name]&&document.frames[a.name].document||null},bindDomNode:function(a){a=d.byId(a,this.ownerDocument);var c;if("iframe"==a.tagName.toLowerCase()){var f=a;c=this._iframeContentWindow(f);c=n.body(c.document)}else c=a==n.body(this.ownerDocument)?this.ownerDocument.documentElement:a;var k={node:a,iframe:f};b.set(a,"_dijitMenu"+this.id,
this._bindings.push(k));var h=g.hitch(this,function(a){var c=this.selector,b=c?function(a){return e.selector(c,a)}:function(a){return a},d=this;return[e(a,b(this.leftClickToOpen?"click":"contextmenu"),function(a){a.stopPropagation();a.preventDefault();(new Date).getTime()<d._lastKeyDown+500||d._scheduleOpen(this,f,{x:a.pageX,y:a.pageY},a.target)}),e(a,b("keydown"),function(a){if(93==a.keyCode||a.shiftKey&&a.keyCode==m.F10||d.leftClickToOpen&&a.keyCode==m.SPACE)a.stopPropagation(),a.preventDefault(),
d._scheduleOpen(this,f,null,a.target),d._lastKeyDown=(new Date).getTime()})]});k.connects=c?h(c):[];f&&(k.onloadHandler=g.hitch(this,function(){var a=this._iframeContentWindow(f),a=n.body(a.document);k.connects=h(a)}),f.addEventListener?f.addEventListener("load",k.onloadHandler,!1):f.attachEvent("onload",k.onloadHandler))},unBindDomNode:function(a){var c;try{c=d.byId(a,this.ownerDocument)}catch(e){return}a="_dijitMenu"+this.id;if(c&&b.has(c,a)){for(var g=b.get(c,a)-1,f=this._bindings[g],k;k=f.connects.pop();)k.remove();
(k=f.iframe)&&(k.removeEventListener?k.removeEventListener("load",f.onloadHandler,!1):k.detachEvent("onload",f.onloadHandler));b.remove(c,a);delete this._bindings[g]}},_scheduleOpen:function(a,c,b,e){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:e,delegatedTarget:a,iframe:c,coords:b})},1))},_openMyself:function(a){function b(){v.refocus&&l&&l.focus();r.close(v)}var e=a.target,g=a.iframe,n=a.coords,m=!n;this.currentTarget=a.delegatedTarget;
if(n){if(g){a=f.position(g,!0);var e=this._iframeContentWindow(g),e=f.docScroll(e.document),h=k.getComputedStyle(g),u=k.toPixelValue,q=(c("ie")&&c("quirks")?0:u(g,h.paddingLeft))+(c("ie")&&c("quirks")?u(g,h.borderLeftWidth):0),g=(c("ie")&&c("quirks")?0:u(g,h.paddingTop))+(c("ie")&&c("quirks")?u(g,h.borderTopWidth):0);n.x+=a.x+q-e.x;n.y+=a.y+g-e.y}}else n=f.position(e,!0),n.x+=10,n.y+=10;var v=this,g=this._focusManager.get("prevNode");a=this._focusManager.get("curNode");var l=!a||d.isDescendant(a,
this.domNode)?g:a;r.open({popup:this,x:n.x,y:n.y,onExecute:b,onCancel:b,orient:this.isLeftToRight()?"L":"R"});this.focus();m||this.defer(function(){this._cleanUp(!0)});this._onBlur=function(){this.inherited("_onBlur",arguments);r.close(this)}},destroy:function(){l.forEach(this._bindings,function(a){a&&this.unBindDomNode(a.node)},this);this.inherited(arguments)}})})},"dijit/popup":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on ./place ./BackgroundIframe ./Viewport ./main dojo/touch".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v){function t(){this._popupWrapper&&(f.destroy(this._popupWrapper),delete this._popupWrapper)}a=a(null,{_stack:[],_beginZIndex:1E3,_idGen:1,_repositionAll:function(){if(this._firstAroundNode){var a=this._firstAroundPosition,b=k.position(this._firstAroundNode,!0),e=b.x-a.x,a=b.y-a.y;if(e||a)for(this._firstAroundPosition=b,b=0;b<this._stack.length;b++){var d=this._stack[b].wrapper.style;d.top=parseFloat(d.top)+a+"px";"auto"==d.right?d.left=parseFloat(d.left)+e+
"px":d.right=parseFloat(d.right)-e+"px"}this._aroundMoveListener=setTimeout(c.hitch(this,"_repositionAll"),e||a?10:50)}},_createWrapper:function(a){var c=a._popupWrapper,b=a.domNode;c||(c=f.create("div",{"class":"dijitPopup",style:{display:"none"},role:"region","aria-label":a["aria-label"]||a.label||a.name||a.id},a.ownerDocumentBody),c.appendChild(b),b=b.style,b.display="",b.visibility="",b.position="",b.top="0px",a._popupWrapper=c,l.after(a,"destroy",t,!0),"ontouchend"in document&&n(c,"touchend",
function(a){/^(input|button|textarea)$/i.test(a.target.tagName)||a.preventDefault()}),c.dojoClick=!0);return c},moveOffScreen:function(a){var c=this._createWrapper(a);a=k.isBodyLtr(a.ownerDocument);var b={visibility:"hidden",top:"-9999px",display:""};b[a?"left":"right"]="-9999px";b[a?"right":"left"]="auto";m.set(c,b);return c},hide:function(a){var c=this._createWrapper(a);m.set(c,{display:"none",height:"auto",overflowY:"visible",border:""});a=a.domNode;"_originalStyle"in a&&(a.style.cssText=a._originalStyle)},
getTopPopup:function(){for(var a=this._stack,c=a.length-1;0<c&&a[c].parent===a[c-1].widget;c--);return a[c]},open:function(a){for(var f=this._stack,h=a.popup,t=h.domNode,v=a.orient||["below","below-alt","above","above-alt"],l=a.parent?a.parent.isLeftToRight():k.isBodyLtr(h.ownerDocument),C=a.around,D=a.around&&a.around.id?a.around.id+"_dropdown":"popup_"+this._idGen++;f.length&&(!a.parent||!d.isDescendant(a.parent.domNode,f[f.length-1].widget.domNode));)this.close(f[f.length-1].widget);var E=this.moveOffScreen(h);
h.startup&&!h._started&&h.startup();var F,H=k.position(t);if("maxHeight"in a&&-1!=a.maxHeight)F=a.maxHeight||Infinity;else{F=u.getEffectiveBox(this.ownerDocument);var G=C?k.position(C,!1):{y:a.y-(a.padding||0),h:2*(a.padding||0)};F=Math.floor(Math.max(G.y,F.h-(G.y+G.h)))}H.h>F&&(H=m.getComputedStyle(t),m.set(E,{overflowY:"scroll",height:F+"px",border:H.borderLeftWidth+" "+H.borderLeftStyle+" "+H.borderLeftColor}),t._originalStyle=t.style.cssText,t.style.border="none");b.set(E,{id:D,style:{zIndex:this._beginZIndex+
f.length},"class":"dijitPopup "+(h.baseClass||h["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:a.parent?a.parent.id:""});0==f.length&&C&&(this._firstAroundNode=C,this._firstAroundPosition=k.position(C,!0),this._aroundMoveListener=setTimeout(c.hitch(this,"_repositionAll"),50));g("config-bgIframe")&&!h.bgIframe&&(h.bgIframe=new r(E));D=h.orient?c.hitch(h,"orient"):null;v=C?q.around(E,C,v,l,D):q.at(E,a,"R"==v?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],a.padding,D);E.style.visibility="visible";
t.style.visibility="visible";t=[];t.push(n(E,"keydown",c.hitch(this,function(c){if(c.keyCode==e.ESCAPE&&a.onCancel)c.stopPropagation(),c.preventDefault(),a.onCancel();else if(c.keyCode==e.TAB&&(c.stopPropagation(),c.preventDefault(),(c=this.getTopPopup())&&c.onCancel))c.onCancel()})));h.onCancel&&a.onCancel&&t.push(h.on("cancel",a.onCancel));t.push(h.on(h.onExecute?"execute":"change",c.hitch(this,function(){var a=this.getTopPopup();if(a&&a.onExecute)a.onExecute()})));f.push({widget:h,wrapper:E,parent:a.parent,
onExecute:a.onExecute,onCancel:a.onCancel,onClose:a.onClose,handlers:t});if(h.onOpen)h.onOpen(v);return v},close:function(a){for(var c=this._stack;a&&h.some(c,function(c){return c.widget==a})||!a&&c.length;){var b=c.pop(),e=b.widget,d=b.onClose;e.bgIframe&&(e.bgIframe.destroy(),delete e.bgIframe);if(e.onClose)e.onClose();for(var g;g=b.handlers.pop();)g.remove();e&&e.domNode&&this.hide(e);d&&d()}0==c.length&&this._aroundMoveListener&&(clearTimeout(this._aroundMoveListener),this._firstAroundNode=this._firstAroundPosition=
this._aroundMoveListener=null)}});return v.popup=new a})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(h,l,a,d){return h("dijit.DropDownMenu",d,{templateString:a,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(a){this._moveToPopup(a);a.stopPropagation();a.preventDefault()},_onLeftArrow:function(a){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();
else this.onCancel(!1);else a.stopPropagation(),a.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u){return l("dijit._MenuBase",[n,u,r,q],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),
this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){b.toggle(this.domNode,"dijitMenuActive",a);b.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,childSelector:function(a){var b=c.byNode(a);return a.parentNode==this.containerNode&&b&&b.focus},postCreate:function(){var a=this,b="string"==typeof this.childSelector?this.childSelector:
f.hitch(this,"childSelector");this.own(m(this.containerNode,m.selector(b,k.enter),function(){a.onItemHover(c.byNode(this))}),m(this.containerNode,m.selector(b,k.leave),function(){a.onItemUnhover(c.byNode(this))}),m(this.containerNode,m.selector(b,e),function(b){a.onItemClick(c.byNode(this),b);b.stopPropagation()}),m(this.containerNode,m.selector(b,"focusin"),function(){a._onItemFocus(c.byNode(this))}));this.inherited(arguments)},onKeyboardSearch:function(a,c,b,e){this.inherited(arguments);if(a&&(-1==
e||a.popup&&1==e))this.onItemClick(a,c)},_keyboardSearchCompare:function(a,c){return a.shortcutKey?c==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},
onItemHover:function(a){this.activated?(this.set("selected",a),!a.popup||a.disabled||this.hover_timer||(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,{type:"click"})},this.passivePopupDelay));this._hoveredChild=a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==
a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&
(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,c){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;if(a.popup){this.set("selected",a);this.set("activated",!0);var b=/^key/.test(c._origType||c.type)||0==c.clientX&&0==c.clientY;this._openItemPopup(a,b)}else this.onExecute(),a._onClick?a._onClick(c):a.onClick(c)},_openItemPopup:function(a,
c){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var b=a.popup;b.parentMenu=this;this.own(this._mouseoverHandle=m.once(b.domNode,"mouseover",f.hitch(this,"_onPopupHover")));var e=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){c&&e.focusChild(a);e._cleanUp()},onExecute:f.hitch(this,"_cleanUp",!0),onClose:function(){e._mouseoverHandle&&(e._mouseoverHandle.remove(),
delete e._mouseoverHandle)}},c);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(d.set(this.selected.focusNode,"tabIndex",this.tabIndex),this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&
this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),function(h,
l,a,d,b,f,k,m,g,e){return l("dijit._KeyNavContainer",[g,e,m],{connectKeyNavHandlers:function(a,e){var d=this._keyNavCodes={},g=f.hitch(this,"focusPrev"),k=f.hitch(this,"focusNext");h.forEach(a,function(a){d[a]=g});h.forEach(e,function(a){d[a]=k});d[b.HOME]=f.hitch(this,"focusFirstChild");d[b.END]=f.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){d.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);h.forEach(this.getChildren(),
f.hitch(this,"_startupChild"))},addChild:function(a,b){this.inherited(arguments);this._startupChild(a)},_startupChild:function(a){a.set("tabIndex","-1")},_getFirst:function(){var a=this.getChildren();return a.length?a[0]:null},_getLast:function(){var a=this.getChildren();return a.length?a[a.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(a){return(a=
k.byNode(a))&&a.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(h,l,a,d,b,f,k,m){return l("dijit._KeyNavMixin",m,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);a.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var g=this._keyNavCodes={};g[d.HOME]=b.hitch(this,"focusFirstChild");g[d.END]=b.hitch(this,
"focusLastChild");g[this.isLeftToRight()?d.LEFT_ARROW:d.RIGHT_ARROW]=b.hitch(this,"_onLeftArrow");g[this.isLeftToRight()?d.RIGHT_ARROW:d.LEFT_ARROW]=b.hitch(this,"_onRightArrow");g[d.UP_ARROW]=b.hitch(this,"_onUpArrow");g[d.DOWN_ARROW]=b.hitch(this,"_onDownArrow")}var e=this,g="string"==typeof this.childSelector?this.childSelector:b.hitch(this,"childSelector");this.own(f(this.domNode,"keypress",b.hitch(this,"_onContainerKeypress")),f(this.domNode,"keydown",b.hitch(this,"_onContainerKeydown")),f(this.domNode,
"focus",b.hitch(this,"_onContainerFocus")),f(this.containerNode,f.selector(g,"focusin"),function(a){e._onChildFocus(k.getEnclosingWidget(this),a)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},
focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(a,b){a&&(this.focusedChild&&a!==this.focusedChild&&this._onChildBlur(this.focusedChild),a.set("tabIndex",this.tabIndex),a.focus(b?"end":"start"))},_onContainerFocus:function(a){a.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){a.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(b){a.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex",
"-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(a){a&&a!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),a.set("tabIndex",this.tabIndex),this.lastFocused=a,this._set("focusedChild",a))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(a,b,c,d){a&&this.focusChild(a)},_keyboardSearchCompare:function(a,b){var c=a.domNode,c=(a.label||(c.focusNode?
c.focusNode.label:"")||c.innerText||c.textContent||"").replace(/^\s+/,"").substr(0,b.length).toLowerCase();return b.length&&c==b?-1:0},_isFormElement:function(a){return"INPUT"===a.tagName||"TEXTAREA"===a.tagName||"SELECT"===a.tagName||"BUTTON"===a.tagName},_onContainerKeydown:function(a){if(!this._isFormElement(document.activeElement)){var b=this._keyNavCodes[a.keyCode];b?(b(a,this.focusedChild),a.stopPropagation(),a.preventDefault(),this._searchString=""):a.keyCode!=d.SPACE||!this._searchTimer||
a.ctrlKey||a.altKey||a.metaKey||(a.stopImmediatePropagation(),a.preventDefault(),this._keyboardSearch(a," "))}},_onContainerKeypress:function(a){this._isFormElement(document.activeElement)||a.charCode<=d.SPACE||a.ctrlKey||a.altKey||a.metaKey||(a.preventDefault(),a.stopPropagation(),this._keyboardSearch(a,String.fromCharCode(a.charCode).toLowerCase()))},_keyboardSearch:function(a,e){var c=null,d,f=0;b.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=e;var a=/^(.)\1*$/.test(this._searchString)?
1:this._searchString.length;d=this._searchString.substr(0,a);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var b=this.focusedChild||null;if(1==a||!b)if(b=this._getNextFocusableChild(b,1),!b)return;a=b;do{var g=this._keyboardSearchCompare(b,d);g&&0==f++&&(c=b);if(-1==g){f=-1;break}b=this._getNextFocusableChild(b,1)}while(b&&b!=a)})();this.onKeyboardSearch(c,a,d,f)},_onChildBlur:function(){},_getNextFocusableChild:function(a,b){var c=
a;do{if(a)a=this._getNext(a,b);else if(a=this[0<b?"_getFirst":"_getLast"](),!a)break;if(null!=a&&a!=c&&a.isFocusable())return a}while(a!=c);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(a,b){if(a)for(a=a.domNode;a;)if((a=a[0>b?"previousSibling":"nextSibling"])&&"getAttribute"in a){var c=k.byNode(a);if(c)return c}return null}})})},"cmv/viewer/js/gis/dijit/FloatingTitlePane":function(){define("dojo/_base/declare dijit/TitlePane dojo/on dojo/_base/lang dojo/dnd/Moveable dojo/aspect dojo/topic dojo/sniff dojo/_base/window dojo/window dojo/dom-geometry dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/dom-class dojox/layout/ResizeHandle xstyle/css!dojox/layout/resources/ResizeHandle.css xstyle/css!./FloatingTitlePane/css/FloatingTitlePane.css".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v){return h([l],{sidebarPosition:null,canFloat:!1,isFloating:!1,isDragging:!1,dragDelay:3,resizable:!1,resizeOptions:{},isResizing:!1,postCreate:function(){this.canFloat&&(this.createDomNodes(),this.own(a(window,"resize",d.hitch(this,"_endDrag"))));this.iconClass&&(this.iconNode=q.create("span",{"class":"titlePaneIcon fa fa-fw "+this.iconClass},this.titleNode,"before"));this.own(k.subscribe("titlePane/event",d.hitch(this,"_updateWidgetSidebarPosition")));this.own(f.after(this,
"toggle",d.hitch(this,"_afterToggle")));this.inherited(arguments)},startup:function(){this.titleBarNode&&this.canFloat&&(this._moveable=new b(this.domNode,{handle:this.titleBarNode,delay:this.dragDelay}),0<this.dragDelay&&(this._moveable.mover.prototype.onMouseUp=function(a){this.destroy();a.preventDefault();a.stopPropagation()}),this._titleBarHeight=n.get(this.titleBarNode,"height"),f.after(this._moveable,"onMove",d.hitch(this,"_dragging"),!0),f.after(this._moveable,"onMoveStop",d.hitch(this,"_endDrag"),
!0),f.after(this._moveable,"onMoveStart",d.hitch(this,"_startDrag"),!0),a(document,"mouseup, touchend",d.hitch(this,"_endDrag")));this.inherited(arguments)},createDomNodes:function(){this.moveHandleNode=q.create("span",{title:"Move widget","class":"floatingWidgetPopout"},this.titleNode,"after");this.dockHandleNode=q.create("span",{title:"Dock widget",style:"display:none","class":"floatingWidgetDock"},this.titleNode,"after");this.own(a(this.dockHandleNode,"click",d.hitch(this,function(a){this._dockWidget();
a.stopImmediatePropagation()})));if(this.resizable){var c=d.mixin({targetId:this.id,activeResize:!0,intermediateChanges:!0,startTopic:this.id+"/resize/start",endTopic:this.id+"/resize/end"},this.resizeOptions);this._resizer=(new v(c)).placeAt(this.id);n.set(this._resizer.resizeHandle,"display","none");a(this._resizer,"resize",d.hitch(this,"_resizing"),!0);this.own(k.subscribe(this.id+"/resize/start",d.hitch(this,"_startResize")));this.own(k.subscribe(this.id+"/resize/end",d.hitch(this,"_endResize")))}},
toggle:function(){this.isFloating&&this.isDragging||this.resizing||this.inherited(arguments)},_afterToggle:function(){this._updateTopic(this.open?"open":"close")},_dragging:function(){this.isDragging=!0;this.titleCursor||(this.titleCursor=n.get(this.titleBarNode,"cursor"));n.set(this.titleBarNode,"cursor","move");if(!this.isFloating){this._checkSidebarPosition();n.set(this.dockHandleNode,"display","inline");n.set(this.moveHandleNode,"display","none");n.set(this.domNode,"z-index","40");var a=n.getComputedStyle(this.containerNode),
b=parseInt(n.getComputedStyle(this.sidebar.containerNode).width,10);c.setContentSize(this.domNode,{w:b-2},a);this.isFloating=!0;this.placeAt(g.body());n.set(this.domNode,{top:this._moverBox.t-this._titleBarHeight+"px"});this.resizable&&this._resizer&&this._resizer.resizeHandle&&n.set(this._resizer.resizeHandle,"display","block");this._updateTopic("undock")}},_startDrag:function(a){this._moverBox=a.marginBox},_endDrag:function(){var a=c.position(this.domNode),b=e.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,
0),b.h-a.h);a.x=Math.min(Math.max(a.x,0),b.w-a.w);this._relativePosition=a;this._position();n.set(this.titleBarNode,"cursor",this.titleCursor);window.setTimeout(d.hitch(this,function(){this.isDragging=!1}),50)},_position:function(){if(!u.contains(this.ownerDocumentBody,"dojoMove")){var a=this.domNode,b=e.getBox(this.ownerDocument),d=this._relativePosition,g=d?null:c.position(a);n.set(a,{left:Math.floor(b.l+(d?d.x:(b.w-g.w)/2))+"px",top:Math.floor(b.t+(d?d.y:(b.h-g.h)/2))+"px"})}},_dockWidget:function(){if(!this.isDragging){r.remove(this.domNode,
"style");n.set(this.dockHandleNode,"display","none");n.set(this.moveHandleNode,"display","inline");var a=this.sidebar.getChildren();if(this.sidebarPosition>a.length||0>this.sidebarPosition)this.sidebarPosition=a.length;this.placeAt(this.sidebar,this.sidebarPosition);this.isFloating=!1;this._updateTopic("dock")}this.resizable&&this._resizer&&this._resizer.resizeHandle&&(n.set(this._resizer.resizeHandle,"display","none"),this._initialDimensions&&k.publish(this.id+"/resize/resize",this._initialDimensions))},
_updateWidgetSidebarPosition:function(a){var c=a.sidebarPosition,b=a.action;a.widgetID===this.id||!this.canFloat||"dock"!==b&&"undock"!==b||(this._checkSidebarPosition(),"dock"===b?(a=this.sidebar.getChildren(),c<this.sidebarPosition&&this.sidebarPosition<a.length&&this.sidebarPosition++):"undock"===b&&c<this.sidebarPosition&&0<this.sidebarPosition&&this.sidebarPosition--)},_checkSidebarPosition:function(){var a=this.sidebar.getChildren();if(null===this.sidebarPosition)for(var c=0,b=a.length,c=0;c<
b;c++){var e=a[c];e.canFloat&&(e.sidebarPosition=c)}},_resizing:function(a){this.isResizing=!0;(a=this._resizer._getNewCoords(a,this,"margin"))&&k.publish(this.id+"/resize/resize",{h:this._resizeDimensions.h+(a.h-this._resizer.startSize.h),w:this._resizeDimensions.w+(a.w-this._resizer.startSize.w)})},_startResize:function(){this.isResizing=!0;this._resizeDimensions=c.getContentBox(this.containerNode);this._initialDimensions||(this._initialDimensions=this._resizeDimensions)},_endResize:function(){this.isResizing=
!1;n.set(this.domNode,"height","auto")},_updateTopic:function(a){k.publish("titlePane/event",{category:"Titlepane Event",action:a,label:this.title,widgetID:this.id,sidebarPosition:this.sidebarPosition,value:a})}})})},"dijit/TitlePane":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/fx dojo/has dojo/_base/kernel dojo/keys ./_CssStateMixin ./_TemplatedMixin ./layout/ContentPane dojo/text!./templates/TitlePane.html ./_base/manager ./a11yclick".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u){l=l("dijit.TitlePane",[q,n,c],{title:"",_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!0,toggleable:!0,tabIndex:"0",duration:u.defaultDuration,baseClass:"dijitTitlePane",templateString:r,doLayout:!1,_setTooltipAttr:{node:"focusNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);a.setSelectable(this.titleNode,!1)},postCreate:function(){this.inherited(arguments);this.toggleable&&this._trackMouseState(this.titleBarNode,
this.baseClass+"Title");var a=this.hideNode,c=this.wipeNode;this._wipeIn=k.wipeIn({node:c,duration:this.duration,beforeBegin:function(){a.style.display=""}});this._wipeOut=k.wipeOut({node:c,duration:this.duration,onEnd:function(){a.style.display="none"}})},_setOpenAttr:function(a,c){h.forEach([this._wipeIn,this._wipeOut],function(a){a&&"playing"==a.status()&&a.stop()});c?this[a?"_wipeIn":"_wipeOut"].play():this.hideNode.style.display=this.wipeNode.style.display=a?"":"none";if(this._started)if(a)this._onShow();
else this.onHide();this.containerNode.setAttribute("aria-hidden",a?"false":"true");this.focusNode.setAttribute("aria-pressed",a?"true":"false");this._set("open",a);this._setCss()},_setToggleableAttr:function(a){this.focusNode.setAttribute("role",a?"button":"heading");a?(this.focusNode.setAttribute("aria-controls",this.id+"_pane"),this.focusNode.setAttribute("tabIndex",this.tabIndex),this.focusNode.setAttribute("aria-pressed",this.open)):(d.remove(this.focusNode,"aria-controls"),d.remove(this.focusNode,
"tabIndex"),d.remove(this.focusNode,"aria-pressed"));this._set("toggleable",a);this._setCss()},_setContentAttr:function(a){this.open&&this._wipeOut&&"playing"!=this._wipeOut.status()?(this._wipeIn&&"playing"==this._wipeIn.status()&&this._wipeIn.stop(),f.setMarginBox(this.wipeNode,{h:f.getMarginBox(this.wipeNode).h}),this.inherited(arguments),this._wipeIn?this._wipeIn.play():this.hideNode.style.display=""):this.inherited(arguments)},toggle:function(){this._setOpenAttr(!this.open,!0)},_setCss:function(){var a=
this.titleBarNode||this.focusNode,c=this._titleBarClass;this._titleBarClass=this.baseClass+"Title"+(this.toggleable?"":"Fixed")+(this.open?"Open":"Closed");b.replace(a,this._titleBarClass,c||"");b.replace(a,this._titleBarClass.replace("TitlePaneTitle",""),(c||"").replace("TitlePaneTitle",""));this.arrowNodeInner.innerHTML=this.open?"-":"+"},_onTitleKey:function(a){a.keyCode==e.DOWN_ARROW&&this.open&&(this.containerNode.focus(),a.preventDefault())},_onTitleClick:function(){this.toggleable&&this.toggle()},
setTitle:function(a){g.deprecated("dijit.TitlePane.setTitle() is deprecated.  Use set('title', ...) instead.","","2.0");this.set("title",a)}});m("dojo-bidi")&&l.extend({_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},_setTooltipAttr:function(a){this._set("tooltip",a);this.textDir&&(a=this.enforceTextDirWithUcc(null,a));d.set(this.focusNode,"title",a)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",
this.title),this.set("tooltip",this.tooltip))}});return l})},"dojox/layout/ResizeHandle":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/event dojo/_base/fx dojo/_base/window dojo/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/declare dojo/touch dijit/_base/manager dijit/_Widget dijit/_TemplatedMixin".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t){h.experimental("dojox.layout.ResizeHandle");var w=q("dojox.layout._ResizeHelper",
v,{show:function(){n.set(this.domNode,"display","")},hide:function(){n.set(this.domNode,"display","none")},resize:function(a){c.setMarginBox(this.domNode,a)}});return q("dojox.layout.ResizeHandle",[v,t],{targetId:"",targetContainer:null,resizeAxis:"xy",activeResize:!1,activeResizeClass:"dojoxResizeHandleClone",animateSizing:!0,animateMethod:"chain",animateDuration:225,minHeight:100,minWidth:100,constrainMax:!1,maxHeight:0,maxWidth:0,fixedAspect:!1,intermediateChanges:!1,startTopic:"/dojo/resize/start",
endTopic:"/dojo/resize/stop",templateString:'\x3cdiv dojoAttachPoint\x3d"resizeHandle" class\x3d"dojoxResizeHandle"\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/div\x3e',postCreate:function(){this.connect(this.resizeHandle,r.press,"_beginSizing");this.activeResize?this.animateSizing=!1:(this._resizeHelper=u.byId("dojoxGlobalResizeHelper"),this._resizeHelper||(this._resizeHelper=(new w({id:"dojoxGlobalResizeHelper"})).placeAt(k.body()),e.add(this._resizeHelper.domNode,this.activeResizeClass)));this.minSize||(this.minSize=
{w:this.minWidth,h:this.minHeight});this.constrainMax&&(this.maxSize={w:this.maxWidth,h:this.maxHeight});this._resizeX=this._resizeY=!1;var a=l.partial(e.add,this.resizeHandle);switch(this.resizeAxis.toLowerCase()){case "xy":this._resizeX=this._resizeY=!0;a("dojoxResizeNW");break;case "x":this._resizeX=!0;a("dojoxResizeW");break;case "y":this._resizeY=!0,a("dojoxResizeN")}},_beginSizing:function(e){if(!this._isSizing&&(a.publish(this.startTopic,[this]),this.targetDomNode=(this.targetWidget=u.byId(this.targetId))?
this.targetWidget.domNode:g.byId(this.targetId),this.targetContainer&&(this.targetDomNode=this.targetContainer),this.targetDomNode)){if(!this.activeResize){var d=c.position(this.targetDomNode,!0);this._resizeHelper.resize({l:d.x,t:d.y,w:d.w,h:d.h});this._resizeHelper.show();this.isLeftToRight()||(this._resizeHelper.startPosition={l:d.x,t:d.y})}this._isSizing=!0;this.startPoint={x:e.clientX,y:e.clientY};var d=n.getComputedStyle(this.targetDomNode),f="border-model"===c.boxModel?{w:0,h:0}:c.getPadBorderExtents(this.targetDomNode,
d),m=c.getMarginExtents(this.targetDomNode,d);this.startSize={w:n.get(this.targetDomNode,"width",d),h:n.get(this.targetDomNode,"height",d),pbw:f.w,pbh:f.h,mw:m.w,mh:m.h};this.isLeftToRight()||"absolute"!=n.get(this.targetDomNode,"position")||(d=c.position(this.targetDomNode,!0),this.startPosition={l:d.x,t:d.y});this._pconnects=[a.connect(k.doc,r.move,this,"_updateSizing"),a.connect(k.doc,r.release,this,"_endSizing")];b.stop(e)}},_updateSizing:function(a){if(this.activeResize)this._changeSizing(a);
else{var c=this._getNewCoords(a,"border",this._resizeHelper.startPosition);if(!1===c)return;this._resizeHelper.resize(c)}a.preventDefault()},_getNewCoords:function(a,c,b){try{if(!a.clientX||!a.clientY)return!1}catch(e){return!1}this._activeResizeLastEvent=a;var d=(this.isLeftToRight()?1:-1)*(this.startPoint.x-a.clientX),g=this.startPoint.y-a.clientY;a=this.startSize.w-(this._resizeX?d:0);g=this._checkConstraints(a,this.startSize.h-(this._resizeY?g:0));(b=b||this.startPosition)&&this._resizeX&&(g.l=
b.l+d,g.w!=a&&(g.l+=a-g.w),g.t=b.t);switch(c){case "margin":g.w+=this.startSize.mw,g.h+=this.startSize.mh;case "border":g.w+=this.startSize.pbw,g.h+=this.startSize.pbh}return g},_checkConstraints:function(a,c){if(this.minSize){var b=this.minSize;a<b.w&&(a=b.w);c<b.h&&(c=b.h)}this.constrainMax&&this.maxSize&&(b=this.maxSize,a>b.w&&(a=b.w),c>b.h&&(c=b.h));if(this.fixedAspect){var b=this.startSize.w,e=this.startSize.h,d=b*c-e*a;0>d?a=c*b/e:0<d&&(c=a*e/b)}return{w:a,h:c}},_changeSizing:function(a){var c=
this.targetWidget&&l.isFunction(this.targetWidget.resize),b=this._getNewCoords(a,c&&"margin");if(!1!==b&&(c?this.targetWidget.resize(b):this.animateSizing?m[this.animateMethod]([f.animateProperty({node:this.targetDomNode,properties:{width:{start:this.startSize.w,end:b.w}},duration:this.animateDuration}),f.animateProperty({node:this.targetDomNode,properties:{height:{start:this.startSize.h,end:b.h}},duration:this.animateDuration})]).play():n.set(this.targetDomNode,{width:b.w+"px",height:b.h+"px"}),
this.intermediateChanges))this.onResize(a)},_endSizing:function(c){d.forEach(this._pconnects,a.disconnect);var b=l.partial(a.publish,this.endTopic,[this]);this.activeResize?b():(this._resizeHelper.hide(),this._changeSizing(c),setTimeout(b,this.animateDuration+15));this._isSizing=!1;this.onResize(c)},onResize:function(a){}})})},"xstyle/css":function(){define(["require"],function(h){function l(a,d,b){var f=document.documentElement;a=f.insertBefore(document.createElement(a),f.firstChild);a.id=d;d=(a.currentStyle||
getComputedStyle(a,null)||{})[b];f.removeChild(a);return d}return{load:function(a,d,b,f){function k(a){var e=l("x-parse",null,"content"),g=a&&(a.sheet||a.styleSheet);e&&"none"!=e&&"normal"!=e?d([eval(e)],function(e){a?e.process(a,b):(e.processAll(),b(g))}):b(g)}var m=d.toUrl(a),g;m.match(/!$/)&&(g={wait:!1},m=m.slice(0,-1));var e=d.cache&&d.cache["url:"+m];if(e)e.xCss&&(e=e.cssText),h(["./core/load-css"],function(a){k(a.insertCss(e))});else{if("none"==l("div",a.replace(/\//g,"-").replace(/\..*/,"")+
"-loaded","display"))return k();h(["./core/load-css"],function(a){a(m,k,g)})}}}})},"xstyle/core/load-css":function(){define([],function(){function h(a){if(d.createStyleSheet){var k=d.createStyleSheet();k.cssText=a;return k.owningElement}k=d.createElement("style");k.setAttribute("type","text/css");k.appendChild(d.createTextNode(a));b.insertBefore(k,b.firstChild);return k}function l(f,k,m){var g=a[f];if(g)return e=h(g),k(e);var e=d.createElement("link");e.type="text/css";e.rel="stylesheet";e.href=f;
var c=!m||!1!==m.wait;m=(m=navigator.userAgent.match(/AppleWebKit\/(\d+\.?\d*)/))&&+m[1];if(null===e.onload&&!(536>m))e.onload=function(){e.onload=null;e.onerror=null;c&&k(e)},e.onerror=function(){console.error("Error loading stylesheet "+f);c&&k(e)};else if(c)var n=setInterval(function(){e.style&&(clearInterval(n),k(e))},15);(b||d.getElementsByTagName("head")[0]).appendChild(e);c||k(e)}var a="undefined"==typeof _css_cache?{}:_css_cache,d=document,b=d.head;l.insertCss=h;return l})},"cmv/viewer/js/gis/dijit/FloatingWidgetDialog":function(){define(["dojo/_base/declare",
"dijit/Dialog"],function(h,l){return h([l],{declaredClass:"gis.dijit.FloatingWidget",title:"Floating Widget",draggable:!0,"class":"floatingWidget",close:function(){this.hide()},focus:function(){}})})},"app/config/viewer":function(){define("esri/units esri/geometry/Extent esri/config esri/tasks/GeometryService esri/layers/ImageParameters dojo/i18n!cmv/viewer/js/config/nls/main gis/plugins/Google dojo/topic app/config/bookmarks app/config/find app/config/identify app/config/basemaps esri/layers/FeatureLayer esri/layers/ArcGISDynamicMapServiceLayer gis/dijit/LayerControl gis/dijit/LayerControl/controls/Dynamic gis/dijit/LayerControl/controls/Feature esri/dijit/HomeButton esri/dijit/OverviewMap esri/dijit/Scalebar esri/SnappingManager esri/dijit/editing/Editor esri/layers/VectorTileLayer esri/dijit/Legend gis/dijit/Growler gis/dijit/Basemaps gis/dijit/Help gis/dijit/Bookmarks gis/dijit/Find gis/dijit/Identify gis/dijit/Draw gis/dijit/Measurement gis/dijit/Print gis/dijit/Directions gis/dijit/Editor gis/dijit/StreetView gis/dijit/LocateButton gis/dijit/Locale".split(" "),
function(h,l,a,d,b,f,k,m){function g(a){a=a||{};var c=new b;c.format="png32";for(var d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);return c}a.defaults.io.proxyUrl="proxy/proxy.ashx";a.defaults.io.alwaysUseProxy=!1;a.defaults.geometryService=new d("https://tasks.arcgisonline.com/ArcGIS/rest/services/Geometry/GeometryServer");k.KEY="NOT-A-REAL-API-KEY";m.subscribe("layerControl/hello",function(a){m.publish("growler/growl",{title:"Hello!",message:a.layer._titleForLegend+" "+(a.subLayer?a.subLayer.name:"")+
" says hello"})});m.subscribe("layerControl/goodbye",function(a){m.publish("growler/growl",{title:"Goodbye!",message:a.layer._titleForLegend+" "+(a.subLayer?a.subLayer.name:"")+" says goodbye"})});return{isDebug:!0,defaultMapClickMode:"identify",mapOptions:{basemap:"streets",center:[-96.59179687497497,39.09596293629694],zoom:5,sliderStyle:"small"},titles:{header:f.viewer.titles.header,subHeader:f.viewer.titles.subHeader,pageTitle:f.viewer.titles.pageTitle},operationalLayers:[{type:"feature",url:"https://services1.arcgis.com/6bXbLtkf4y11TosO/arcgis/rest/services/Restaurants/FeatureServer/0",
title:f.viewer.operationalLayers.restaurants,options:{id:"restaurants",opacity:1,visible:!0,outFields:["*"],mode:0},editorLayerInfos:{disableGeometryUpdate:!1},legendLayerInfos:{exclude:!1,layerInfo:{title:f.viewer.operationalLayers.restaurants}}},{type:"feature",url:"https://sampleserver3.arcgisonline.com/ArcGIS/rest/services/SanFrancisco/311Incidents/FeatureServer/0",title:f.viewer.operationalLayers.sf311Incidents,options:{id:"sf311Incidents",opacity:1,visible:!0,outFields:["req_type","req_date",
"req_time","address","district"],mode:0},layerControlLayerInfos:{menu:[{topic:"hello",label:"Say Hello Custom",iconClass:"fa fa-smile-o"}]}},{type:"dynamic",url:"https://sampleserver1.arcgisonline.com/ArcGIS/rest/services/PublicSafety/PublicSafetyOperationalLayers/MapServer",title:f.viewer.operationalLayers.louisvillePubSafety,options:{id:"louisvillePubSafety",opacity:1,visible:!0,imageParameters:g({layerIds:[0,2,4,5,8,10,12,21],layerOption:"show"})},identifyLayerInfos:{layerIds:[2,4,5,8,12,21]},
layerControlLayerInfos:{layerIds:[0,2,4,5,8,9,10,12,21]},legendLayerInfos:{layerInfo:{hideLayers:[21]}}},{type:"dynamic",url:"https://sampleserver6.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer",title:f.viewer.operationalLayers.damageAssessment,options:{id:"damageAssessment",opacity:1,visible:!0,imageParameters:g()},legendLayerInfos:{exclude:!0},layerControlLayerInfos:{swipe:!0,metadataUrl:!0,expanded:!0,subLayerMenu:[{topic:"hello",label:"Say Hello",iconClass:"fa fa-smile-o"}]}}],
widgets:{growler:{include:!0,id:"growler",type:"domNode",path:"gis/dijit/Growler",srcNodeRef:"growlerDijit",options:{}},search:{include:!0,type:"domNode",path:"esri/dijit/Search",srcNodeRef:"geocoderButton",options:{map:!0,visible:!0,enableInfoWindow:!1,enableButtonMode:!0,expanded:!1}},basemaps:{include:!0,id:"basemaps",type:"domNode",path:"gis/dijit/Basemaps",srcNodeRef:"basemapsDijit",options:"app/config/basemaps"},identify:{include:!0,id:"identify",type:"titlePane",path:"gis/dijit/Identify",title:f.viewer.widgets.identify,
iconClass:"fa-info-circle",open:!1,position:3,options:"app/config/identify"},mapInfo:{include:!1,id:"mapInfo",type:"domNode",path:"gis/dijit/MapInfo",srcNodeRef:"mapInfoDijit",options:{map:!0,mode:"dms",firstCoord:"y",unitScale:3,showScale:!0,xLabel:"",yLabel:"",minWidth:286}},scalebar:{include:!0,id:"scalebar",type:"map",path:"esri/dijit/Scalebar",options:{map:!0,attachTo:"bottom-left",scalebarStyle:"line",scalebarUnit:"dual"}},locateButton:{include:!0,id:"locateButton",type:"domNode",path:"gis/dijit/LocateButton",
srcNodeRef:"locateButton",options:{map:!0,publishGPSPosition:!0,highlightLocation:!0,useTracking:!0,geolocationOptions:{maximumAge:0,timeout:15E3,enableHighAccuracy:!0}}},overviewMap:{include:!0,id:"overviewMap",type:"map",path:"esri/dijit/OverviewMap",options:{map:!0,attachTo:"bottom-right",color:"#0000CC",height:100,width:125,opacity:.3,visible:!1}},homeButton:{include:!0,id:"homeButton",type:"domNode",path:"esri/dijit/HomeButton",srcNodeRef:"homeButton",options:{map:!0,extent:new l({xmin:-180,
ymin:-85,xmax:180,ymax:85,spatialReference:{wkid:4326}})}},legend:{include:!0,id:"legend",type:"titlePane",path:"gis/dijit/Legend",title:f.viewer.widgets.legend,iconClass:"fa-picture-o",open:!1,position:1,options:{map:!0,legendLayerInfos:!0}},layerControl:{include:!0,id:"layerControl",type:"titlePane",path:"gis/dijit/LayerControl",title:f.viewer.widgets.layerControl,iconClass:"fa-th-list",open:!1,position:0,options:{map:!0,layerControlLayerInfos:!0,separated:!0,vectorReorder:!0,overlayReorder:!0,
menu:{feature:[{topic:"hello",iconClass:"fa fa-smile-o",label:"Say Hello"}]},subLayerMenu:{dynamic:[{topic:"goodbye",iconClass:"fa fa-frown-o",label:"Say goodbye"}]}}},bookmarks:{include:!0,id:"bookmarks",type:"titlePane",path:"gis/dijit/Bookmarks",title:f.viewer.widgets.bookmarks,iconClass:"fa-bookmark",open:!1,position:2,options:"app/config/bookmarks"},find:{include:!0,id:"find",type:"titlePane",canFloat:!0,path:"gis/dijit/Find",title:f.viewer.widgets.find,iconClass:"fa-search",open:!1,position:3,
options:"app/config/find"},draw:{include:!0,id:"draw",type:"titlePane",canFloat:!0,path:"gis/dijit/Draw",title:f.viewer.widgets.draw,iconClass:"fa-paint-brush",open:!1,position:4,options:{map:!0,mapClickMode:!0}},measure:{include:!0,id:"measurement",type:"titlePane",canFloat:!0,path:"gis/dijit/Measurement",title:f.viewer.widgets.measure,iconClass:"fa-expand",open:!1,position:5,options:{map:!0,mapClickMode:!0,defaultAreaUnit:h.SQUARE_MILES,defaultLengthUnit:h.MILES}},print:{include:!0,id:"print",type:"titlePane",
canFloat:!0,path:"gis/dijit/Print",title:f.viewer.widgets.print,iconClass:"fa-print",open:!1,position:6,options:{map:!0,printTaskURL:"https://utility.arcgisonline.com/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task",copyrightText:"Copyright 2014",authorText:"Me",defaultTitle:"Viewer Map",defaultFormat:"PDF",defaultLayout:"Letter ANSI A Landscape"}},directions:{include:!0,id:"directions",type:"titlePane",path:"gis/dijit/Directions",title:f.viewer.widgets.directions,
iconClass:"fa-map-signs",open:!1,position:7,options:{map:!0,mapRightClickMenu:!0,options:{routeTaskUrl:"https://sampleserver3.arcgisonline.com/ArcGIS/rest/services/Network/USA/NAServer/Route",routeParams:{directionsLanguage:"en-US",directionsLengthUnits:h.MILES},active:!1}}},editor:{include:!0,id:"editor",type:"titlePane",path:"gis/dijit/Editor",title:f.viewer.widgets.editor,iconClass:"fa-pencil",open:!1,position:8,options:{map:!0,mapClickMode:!0,editorLayerInfos:!0,settings:{toolbarVisible:!0,showAttributesOnClick:!0,
enableUndoRedo:!0,createOptions:{polygonDrawTools:["freehandpolygon","autocomplete"]},toolbarOptions:{reshapeVisible:!0,cutVisible:!0,mergeVisible:!0}}}},streetview:{include:!0,id:"streetview",type:"titlePane",canFloat:!0,position:9,path:"gis/dijit/StreetView",title:f.viewer.widgets.streetview,iconClass:"fa-street-view",paneOptions:{resizable:!0,resizeOptions:{minSize:{w:250,h:250}}},options:{map:!0,mapClickMode:!0,mapRightClickMenu:!0}},locale:{include:!0,id:"locale",type:"domNode",srcNodeRef:"geocodeDijit",
path:"gis/dijit/Locale",title:f.viewer.widgets.locale,options:{style:"margin-left: 30px;"}},help:{include:!0,id:"help",type:"floating",path:"gis/dijit/Help",title:f.viewer.widgets.help,options:{}}}}})},"esri/units":function(){define(["dojo/has","./kernel"],function(h,l){var a={CENTIMETERS:"esriCentimeters",DECIMAL_DEGREES:"esriDecimalDegrees",DEGREE_MINUTE_SECONDS:"esriDegreeMinuteSeconds",DECIMETERS:"esriDecimeters",FEET:"esriFeet",FEET_US:"esriFeetUS",INCHES:"esriInches",KILOMETERS:"esriKilometers",
METERS:"esriMeters",MILES:"esriMiles",MILES_US:"esriMilesUS",MILLIMETERS:"esriMillimeters",NAUTICAL_MILES:"esriNauticalMiles",POINTS:"esriPoints",UNKNOWN:"esriUnknownUnits",YARDS:"esriYards",YARDS_US:"esriYardsUS",ACRES:"esriAcres",ACRES_US:"esriAcresUS",ARES:"esriAres",SQUARE_KILOMETERS:"esriSquareKilometers",SQUARE_MILES:"esriSquareMiles",SQUARE_MILES_US:"esriSquareMilesUS",SQUARE_FEET:"esriSquareFeet",SQUARE_FEET_US:"esriSquareFeetUS",SQUARE_METERS:"esriSquareMeters",HECTARES:"esriHectares",SQUARE_YARDS:"esriSquareYards",
SQUARE_YARDS_US:"esriSquareYardsUS",SQUARE_INCHES:"esriSquareInches",SQUARE_MILLIMETERS:"esriSquareMillimeters",SQUARE_CENTIMETERS:"esriSquareCentimeters",SQUARE_DECIMETERS:"esriSquareDecimeters",SQUARE_NAUTICAL_MILES:"esriSquareNauticalMiles",METERS_PER_SECOND:"esriMetersPerSecond",KILOMETERS_PER_HOUR:"esriKilometersPerHour",KNOTS:"esriKnots",FEET_PER_SECOND:"esriFeetPerSecond",MILES_PER_HOUR:"esriMilesPerHour",RADIANS:"esriDURadians"};return h("extend-esri")&&(l.Units=a),a})},"esri/tasks/GeometryService":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ./Task ../geometry/Extent ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/jsonUtils".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u){h=h(e,{declaredClass:"esri.tasks.GeometryService",_eventMap:{"areas-and-lengths-complete":["result"],"auto-complete-complete":["geometries"],"buffer-complete":["geometries"],"convex-hull-complete":["geometry"],"cut-complete":["result"],"densify-complete":["geometries"],"difference-complete":["geometries"],"distance-complete":["distance"],"generalize-complete":["geometries"],"intersect-complete":["geometries"],"label-points-complete":["geometries"],"lengths-complete":["result"],
"offset-complete":["geometries"],"project-complete":["geometries"],"relation-complete":["relations"],"reshape-complete":["geometry"],"simplify-complete":["geometries"],"trim-extend-complete":["geometries"],"union-complete":["geometry"]},constructor:function(a){a=l.hitch;this._projectHandler=a(this,this._projectHandler);this._simplifyHandler=a(this,this._simplifyHandler);this._bufferHandler=a(this,this._bufferHandler);this._areasAndLengthsHandler=a(this,this._areasAndLengthsHandler);this._lengthsHandler=
a(this,this._lengthsHandler);this._labelPointsHandler=a(this,this._labelPointsHandler);this._relationHandler=a(this,this._relationHandler);this._convexHullHandler=a(this,this._convexHullHandler);this._unionHandler=a(this,this._unionHandler);this._autoCompleteHandler=a(this,this._autoCompleteHandler);this._reshapeHandler=a(this,this._reshapeHandler);this._cutHandler=a(this,this._cutHandler);this._intersectHandler=a(this,this._intersectHandler);this._differenceHandler=a(this,this._differenceHandler);
this._trimExtendHandler=a(this,this._trimExtendHandler);this._densifyHandler=a(this,this._densifyHandler);this._generalizeHandler=a(this,this._densifyHandler);this._offsetHandler=a(this,this._offsetHandler);this._distanceHandler=a(this,this._distanceHandler);this._toGeoCoordinateHandler=a(this,this._toGeoCoordinateHandler);this._fromGeoCoordinateHandler=a(this,this._fromGeoCoordinateHandler);this.registerConnectEvents()},_encodeGeometries:function(a){var c,b=[],e=a.length;for(c=0;e>c;c++)b.push(a[c].toJson());
return{geometryType:u.getJsonType(a[0]),geometries:b}},_decodeGeometries:function(c,b,e){var d=u.getGeometryType(b);c=c.geometries;var g=[],f={spatialReference:e.toJson()},k=l.mixin;return a.forEach(c,function(a,c){g[c]=new d(k(a,f))}),g},_toProjectGeometry:function(a){var b=a.spatialReference.toJson();return a instanceof c?new q({rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]],spatialReference:b}):new n({paths:[[].concat(a.points)],spatialReference:b})},
_fromProjectedGeometry:function(a,b,e){return"esriGeometryEnvelope"===b?(a=a.rings[0],new c(a[0][0],a[0][1],a[2][0],a[2][1],e)):new r({points:a.paths[0],spatialReference:e.toJson()})},project:function(a,c,e,f){var k,n=l.mixin({},this._url.query,{f:"json"});a.geometries?(f=e,e=c,c=a.outSR,k=a.geometries[0],n=l.mixin(n,a.toJson())):(k=a[0],n=l.mixin(n,{outSR:c.wkid||d.toJson(c.toJson()),inSR:k.spatialReference.wkid||d.toJson(k.spatialReference.toJson()),geometries:d.toJson(this._encodeGeometries(a))}));
var h=u.getJsonType(k),r=this._projectHandler,q=this._errorHandler,D=new b(g._dfdCanceller);return D._pendingDfd=m({url:this._url.path+"/project",content:n,callbackParamName:"callback",load:function(a,b){r(a,b,h,c,e,f,D)},error:function(a){q(a,f,D)}}),D},_projectHandler:function(a,c,b,e,d,g,f){try{var k=this._decodeGeometries(a,b,e);this._successHandler([k],"onProjectComplete",d,f)}catch(n){this._errorHandler(n,g,f)}},onProjectComplete:function(){},simplify:function(a,c,e){var f=a[0].spatialReference,
k=l.mixin({},this._url.query,{f:"json",sr:f.wkid?f.wkid:d.toJson(f.toJson()),geometries:d.toJson(this._encodeGeometries(a))}),n=u.getJsonType(a[0]),h=this._simplifyHandler,r=this._errorHandler,q=new b(g._dfdCanceller);return q._pendingDfd=m({url:this._url.path+"/simplify",content:k,callbackParamName:"callback",load:function(a,b){h(a,b,n,f,c,e,q)},error:function(a){r(a,e,q)}}),q},_simplifyHandler:function(a,c,b,e,d,g,f){try{var k=this._decodeGeometries(a,b,e);this._successHandler([k],"onSimplifyComplete",
d,f)}catch(n){this._errorHandler(n,g,f)}},onSimplifyComplete:function(){},convexHull:function(a,c,e){var f=a[0].spatialReference;a=l.mixin({},this._url.query,{f:"json",sr:d.toJson(f.toJson()),geometries:d.toJson(this._encodeGeometries(a))});var k=this._convexHullHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/convexHull",content:a,callbackParamName:"callback",load:function(a,b){k(a,b,f,c,e,h)},error:function(a){n(a,e,h)}}),h},_convexHullHandler:function(a,
c,b,e,d,g){try{var f=u.fromJson(a.geometry).setSpatialReference(b);this._successHandler([f],"onConvexHullComplete",e,g)}catch(k){this._errorHandler(k,d,g)}},onConvexHullComplete:function(){},union:function(a,c,e){var f=a[0].spatialReference;a=l.mixin({},this._url.query,{f:"json",sr:d.toJson(f.toJson()),geometries:d.toJson(this._encodeGeometries(a))});var k=this._unionHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/union",content:a,callbackParamName:"callback",
load:function(a,b){k(a,b,f,c,e,h)},error:function(a){n(a,e,h)}}),h},_unionHandler:function(a,c,b,e,d,g){try{var f=u.fromJson(a.geometry).setSpatialReference(b);this._successHandler([f],"onUnionComplete",e,g)}catch(k){this._errorHandler(k,d,g)}},onUnionComplete:function(){},autoComplete:function(a,c,e,f){var k=a[0].spatialReference;a=l.mixin({},this._url.query,{f:"json",sr:d.toJson(k.toJson()),polygons:d.toJson(this._encodeGeometries(a).geometries),polylines:d.toJson(this._encodeGeometries(c).geometries)});
var n=this._autoCompleteHandler,h=this._errorHandler,r=new b(g._dfdCanceller);return r._pendingDfd=m({url:this._url.path+"/autoComplete",content:a,callbackParamName:"callback",load:function(a,c){n(a,c,k,e,f,r)},error:function(a){h(a,f,r)}}),r},_autoCompleteHandler:function(a,c,b,e,d,g){try{var f,k=a.geometries;a=[];var n=k.length;for(f=0;n>f;f++)a[f]=new q({spatialReference:b,rings:k[f].rings});this._successHandler([a],"onAutoCompleteComplete",e,g)}catch(m){this._errorHandler(m,d,g)}},onAutoCompleteComplete:function(){},
reshape:function(a,c,e,f){var k=a.spatialReference;a=l.mixin({},this._url.query,{f:"json",sr:d.toJson(k.toJson()),target:d.toJson({geometryType:u.getJsonType(a),geometry:a.toJson()}),reshaper:d.toJson(c.toJson())});var n=this._reshapeHandler,h=this._errorHandler,r=new b(g._dfdCanceller);return r._pendingDfd=m({url:this._url.path+"/reshape",content:a,callbackParamName:"callback",load:function(a,c){n(a,c,k,e,f,r)},error:function(a){h(a,f,r)}}),r},_reshapeHandler:function(a,c,b,e,d,g){try{var f=u.fromJson(a.geometry).setSpatialReference(b);
this._successHandler([f],"onReshapeComplete",e,g)}catch(k){this._errorHandler(k,d,g)}},onReshapeComplete:function(){},cut:function(c,e,f,k){var n=c[0].spatialReference,h=a.map(c,function(a){return a.toJson()});c=l.mixin({},this._url.query,{f:"json",sr:d.toJson(n.toJson()),target:d.toJson({geometryType:u.getJsonType(c[0]),geometries:h}),cutter:d.toJson(e.toJson())});var r=this._cutHandler,q=this._errorHandler,C=new b(g._dfdCanceller);return C._pendingDfd=m({url:this._url.path+"/cut",content:c,callbackParamName:"callback",
load:function(a,c){r(a,c,n,f,k,C)},error:function(a){q(a,k,C)}}),C},_cutHandler:function(c,b,e,d,g,f){try{var k=c.geometries,n={};n.cutIndexes=c.cutIndexes;n.geometries=[];a.forEach(k,function(a){n.geometries.push(u.fromJson(a).setSpatialReference(e))});this._successHandler([n],"onCutComplete",d,f)}catch(m){this._errorHandler(m,g,f)}},onCutComplete:function(){},intersect:function(a,c,e,f){var k=a[0].spatialReference;a=l.mixin({},this._url.query,{f:"json",sr:d.toJson(k.toJson()),geometries:d.toJson(this._encodeGeometries(a)),
geometry:d.toJson({geometryType:u.getJsonType(c),geometry:c.toJson()})});var n=this._intersectHandler,h=this._errorHandler,r=new b(g._dfdCanceller);return r._pendingDfd=m({url:this._url.path+"/intersect",content:a,callbackParamName:"callback",load:function(a,c){n(a,c,k,e,f,r)},error:function(a){h(a,f,r)}}),r},_intersectHandler:function(c,b,e,d,g,f){try{var k=[];a.forEach(c.geometries,function(a){k.push(u.fromJson(a).setSpatialReference(e))});this._successHandler([k],"onIntersectComplete",d,f)}catch(n){this._errorHandler(n,
g,f)}},onIntersectComplete:function(){},difference:function(a,c,e,f){var k=a[0].spatialReference;a=l.mixin({},this._url.query,{f:"json",sr:d.toJson(k.toJson()),geometries:d.toJson(this._encodeGeometries(a)),geometry:d.toJson({geometryType:u.getJsonType(c),geometry:c.toJson()})});var n=this._differenceHandler,h=this._errorHandler,r=new b(g._dfdCanceller);return r._pendingDfd=m({url:this._url.path+"/difference",content:a,callbackParamName:"callback",load:function(a,c){n(a,c,k,e,f,r)},error:function(a){h(a,
f,r)}}),r},_differenceHandler:function(c,b,e,d,g,f){try{var k=[];a.forEach(c.geometries,function(a){k.push(u.fromJson(a).setSpatialReference(e))});this._successHandler([k],"onDifferenceComplete",d,f)}catch(n){this._errorHandler(n,g,f)}},onDifferenceComplete:function(){},buffer:function(a,c,e){var d=l.mixin({},this._url.query,{f:"json"},a.toJson()),f=a.outSpatialReference||a.geometries[0].spatialReference,k=this._bufferHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+
"/buffer",content:d,callbackParamName:"callback",load:function(a,b){k(a,b,f,c,e,h)},error:function(a){n(a,e,h)}}),h},_bufferHandler:function(a,c,b,e,d,g){try{var f,k=a.geometries;a=[];var n=k.length;for(f=0;n>f;f++)a[f]=new q({spatialReference:b,rings:k[f].rings});this._successHandler([a],"onBufferComplete",e,g)}catch(m){this._errorHandler(m,d,g)}},onBufferComplete:function(){},areasAndLengths:function(a,c,e){a=l.mixin({},this._url.query,{f:"json"},a.toJson());var d=this._areasAndLengthsHandler,f=
this._errorHandler,k=new b(g._dfdCanceller);return k._pendingDfd=m({url:this._url.path+"/areasAndLengths",content:a,callbackParamName:"callback",load:function(a,b){d(a,b,c,e,k)},error:function(a){f(a,e,k)}}),k},_areasAndLengthsHandler:function(a,c,b,e,d){try{this._successHandler([a],"onAreasAndLengthsComplete",b,d)}catch(g){this._errorHandler(g,e,d)}},onAreasAndLengthsComplete:function(){},lengths:function(a,c,e){a=l.mixin({},this._url.query,{f:"json"},a.toJson());var d=this._lengthsHandler,f=this._errorHandler,
k=new b(g._dfdCanceller);return k._pendingDfd=m({url:this._url.path+"/lengths",content:a,callbackParamName:"callback",load:function(a,b){d(a,b,c,e,k)},error:function(a){f(a,e,k)}}),k},_lengthsHandler:function(a,c,b,e,d){try{this._successHandler([a],"onLengthsComplete",b,d)}catch(g){this._errorHandler(g,e,d)}},onLengthsComplete:function(){},labelPoints:function(c,e,f){var k=a.map(c,function(a){return a.toJson()}),n=c[0].spatialReference,k=l.mixin({},this._url.query,{f:"json",sr:n.wkid?n.wkid:d.toJson(n.toJson()),
polygons:d.toJson(k)}),h=this._labelPointsHandler,r=this._errorHandler,u=new b(g._dfdCanceller);return u._pendingDfd=m({url:this._url.path+"/labelPoints",content:k,callbackParamName:"callback",load:function(a,b){h(a,b,c,n,e,f,u)},error:function(a){r(a,f,u)}}),u},_labelPointsHandler:function(c,b,e,d,g,f,k){try{var n=[];a.forEach(c.labelPoints,function(a){n.push(u.fromJson(a).setSpatialReference(d))});this._successHandler([n],"onLabelPointsComplete",g,k)}catch(m){this._errorHandler(m,f,k)}},onLabelPointsComplete:function(){},
relation:function(a,c,e){a=l.mixin({},this._url.query,{f:"json"},a.toJson());var d=this._relationHandler,f=this._errorHandler,k=new b(g._dfdCanceller);return k._pendingDfd=m({url:this._url.path+"/relation",content:a,callbackParamName:"callback",load:function(a,b){d(a,b,c,e,k)},error:function(a){f(a,e,k)}}),k},_relationHandler:function(a,c,b,e,d){try{this._successHandler([a.relations],"onRelationComplete",b,d)}catch(g){this._errorHandler(g,e,d)}},onRelationComplete:function(){},trimExtend:function(a,
c,e){var d=l.mixin({},this._url.query,{f:"json"},a.toJson()),f=a.sr,k=this._trimExtendHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/trimExtend",content:d,callbackParamName:"callback",load:function(a,b){k(a,b,f,c,e,h)},error:function(a){n(a,e,h)}}),h},_trimExtendHandler:function(a,c,b,e,d,g){try{var f,k=a.geometries;a=[];var m=k.length;for(f=0;m>f;f++)a[f]=new n({spatialReference:b,paths:k[f].paths});this._successHandler([a],"onTrimExtendComplete",
e,g)}catch(h){this._errorHandler(h,d,g)}},onTrimExtendComplete:function(){},densify:function(a,c,e){var d=l.mixin({},this._url.query,{f:"json"},a.toJson()),f=a.geometries[0].spatialReference,k=this._densifyHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/densify",content:d,callbackParamName:"callback",load:function(a,b){k(a,b,f,c,e,h)},error:function(a){n(a,e,h)}}),h},_densifyHandler:function(c,b,e,d,g,f){try{var k=[];a.forEach(c.geometries,function(a){k.push(u.fromJson(a).setSpatialReference(e))});
this._successHandler([k],"onDensifyComplete",d,f)}catch(n){this._errorHandler(n,g,f)}},onDensifyComplete:function(){},generalize:function(a,c,e){var d=l.mixin({},this._url.query,{f:"json"},a.toJson()),f=a.geometries[0].spatialReference,k=this._generalizeHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/generalize",content:d,callbackParamName:"callback",load:function(a,b){k(a,b,f,c,e,h)},error:function(a){n(a,e,h)}}),h},_generalizeHandler:function(c,
b,e,d,g,f){try{var k=[];a.forEach(c.geometries,function(a){k.push(u.fromJson(a).setSpatialReference(e))});this._successHandler([k],"onGeneralizeComplete",d,f)}catch(n){this._errorHandler(n,g,f)}},onGeneralizeComplete:function(){},offset:function(a,c,e){var d=l.mixin({},this._url.query,{f:"json"},a.toJson()),f=a.geometries[0].spatialReference,k=this._offsetHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/offset",content:d,callbackParamName:"callback",
load:function(a,b){k(a,b,f,c,e,h)},error:function(a){n(a,e,h)}}),h},_offsetHandler:function(c,b,e,d,g,f){try{var k=[];a.forEach(c.geometries,function(a){k.push(u.fromJson(a).setSpatialReference(e))});this._successHandler([k],"onOffsetComplete",d,f)}catch(n){this._errorHandler(n,g,f)}},onOffsetComplete:function(){},distance:function(a,c,e){var d=l.mixin({},this._url.query,{f:"json"},a.toJson()),f=a.geometry1.spatialReference,k=this._distanceHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=
m({url:this._url.path+"/distance",content:d,callbackParamName:"callback",load:function(a,b){k(a,b,f,c,e,h)},error:function(a){n(a,e,h)}}),h},_distanceHandler:function(a,c,b,e,d,g){try{a=a&&a.distance,this._successHandler([a],"onDistanceComplete",e,g)}catch(f){this._errorHandler(f,d,g)}},onDistanceComplete:function(){},toGeoCoordinateString:function(a,c,e){var f={};l.isObject(a.sr)?f.sr=a.sr.wkid||d.toJson(a.sr.toJson()):f.sr=a.sr;f.coordinates=d.toJson(a.coordinates);f.conversionType=a.conversionType||
"MGRS";f.conversionMode=a.conversionMode;f.numOfDigits=a.numOfDigits;f.rounding=a.rounding;f.addSpaces=a.addSpaces;a=l.mixin({},this._url.query,{f:"json"},f);var k=this._toGeoCoordinateHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/toGeoCoordinateString",content:a,callbackParamName:"callback",load:function(a,b){k(a,b,c,e,h)},error:function(a){n(a,e,h)}}),h},_toGeoCoordinateHandler:function(a,c,b,e,d){try{this._successHandler([a.strings],"onToGeoCoordinateStringComplete",
b,d)}catch(g){this._errorHandler(g,e,d)}},onToGeoCoordinateStringComplete:function(){},fromGeoCoordinateString:function(a,c,e){var f={};l.isObject(a.sr)?f.sr=a.sr.wkid||d.toJson(a.sr.toJson()):f.sr=a.sr;f.strings=d.toJson(a.strings);f.conversionType=a.conversionType||"MGRS";f.conversionMode=a.conversionMode;a=l.mixin({},this._url.query,{f:"json"},f);var k=this._fromGeoCoordinateHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/fromGeoCoordinateString",
content:a,callbackParamName:"callback",load:function(a,b){k(a,b,c,e,h)},error:function(a){n(a,e,h)}}),h},_fromGeoCoordinateHandler:function(a,c,b,e,d){try{this._successHandler([a.coordinates],"onToGeoCoordinateStringComplete",b,d)}catch(g){this._errorHandler(g,e,d)}},onFromGeoCoordinateStringComplete:function(){}});return l.mixin(h,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,
UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,
UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,
UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",
UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"}),f("extend-esri")&&l.setObject("tasks.GeometryService",h,k),h})},"esri/tasks/Task":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../deferredUtils ../urlUtils ../Evented".split(" "),function(h,l,a,d,b,f,k,m){h=h(m,{declaredClass:"esri.tasks._Task",
_eventMap:{error:["error"],complete:["result"]},constructor:function(a,b){a&&l.isString(a)&&(this._url=k.urlToObject(this.url=a));b&&b.requestOptions&&(this.requestOptions=b.requestOptions);this.normalization=!0;this._errorHandler=l.hitch(this,this._errorHandler);this.registerConnectEvents()},_useSSL:function(){var a=this._url,b=/^http:/i;this.url&&(this.url=this.url.replace(b,"https:"));a&&a.path&&(a.path=a.path.replace(b,"https:"))},_encode:function(b,e,c){var d,f,k,m,h,t={};for(k in b)if("declaredClass"!==
k&&(d=b[k],f=typeof d,null!==d&&void 0!==d&&"function"!==f))if(l.isArray(d))for(t[k]=[],h=d.length,m=0;h>m;m++)t[k][m]=this._encode(d[m]);else"object"===f?d.toJson&&(m=d.toJson(c&&c[k]),"esri.tasks.FeatureSet"===d.declaredClass&&m.spatialReference&&(m.sr=m.spatialReference,delete m.spatialReference),t[k]=e?m:a.toJson(m)):t[k]=d;return t},_successHandler:function(a,b,c,d){b&&this[b].apply(this,a);c&&c.apply(null,a);d&&f._resDfd(d,a)},_errorHandler:function(a,b,c){this.onError(a);b&&b(a);c&&c.errback(a)},
setNormalization:function(a){this.normalization=a},onError:function(){}});return d("extend-esri")&&(b.Task=h),h})},"esri/layers/ImageParameters":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang ../layerUtils".split(" "),function(h,l,a,d,b,f,k,m){l=l(null,{declaredClass:"esri.layers.ImageParameters",constructor:function(){this.layerDefinitions=[]},bbox:null,extent:null,width:null,height:null,dpi:null,format:null,imageSpatialReference:null,
layerOption:null,layerIds:null,transparent:null,timeExtent:null,layerTimeOptions:null,toJson:function(a){this.bbox&&h.deprecated(this.declaredClass+" : Property 'bbox' deprecated. Use property 'extent'.");var b=this.bbox||this.extent,b=b&&a&&b._normalize(!0);a=this.layerOption;var c=b?b.spatialReference.wkid||d.toJson(b.spatialReference.toJson()):null,f=this.imageSpatialReference,b={dpi:this.dpi,format:this.format,transparent:this.transparent,size:null!==this.width&&null!==this.height?this.width+
","+this.height:null,bbox:b?b.xmin+","+b.ymin+","+b.xmax+","+b.ymax:null,bboxSR:c,layers:a?a+":"+this.layerIds.join(","):null,imageSR:f?f.wkid||d.toJson(f.toJson()):c};b.layerDefs=m._serializeLayerDefinitions(this.layerDefinitions);a=this.timeExtent;return b.time=a?a.toJson().join(","):null,b.layerTimeOptions=m._serializeTimeOptions(this.layerTimeOptions),k.filter(b,function(a){return null!==a?!0:void 0})}});return a.mixin(l,{LAYER_OPTION_SHOW:"show",LAYER_OPTION_HIDE:"hide",LAYER_OPTION_INCLUDE:"include",
LAYER_OPTION_EXCLUDE:"exclude"}),b("extend-esri")&&a.setObject("layers.ImageParameters",l,f),l})},"cmv/viewer/js/config/nls/main":function(){define({root:{basemaps:{davidRumseyMap1812:"David Rumsey 1812",earthAtNight:"Earth at Night",landsatShaded:"Landsat Shaded"},bookmarks:{nullIsland:"Null Island",usa:"USA"},find:{louisvillePubSafety:"Find A Public Safety Location By Name",sf311Incidents:"Find Incident By Code/Description"},identify:{louisvillePubSafety:{policeStation:"Police Station",trafficCamera:"Traffic Camera"}},
viewer:{operationalLayers:{damageAssessment:"Damage Assessment",louisvillePubSafety:"Louisville Public Safety",restaurants:"Restaurants",sf311Incidents:"San Francisco 311 Incidents"},titles:{header:"Configurable Map Viewer",pageTitle:"Configurable Map Viewer",subHeader:"make it your own"},widgets:{bookmarks:"Bookmarks",directions:"Directions",draw:"Draw",editor:"Editor",find:"Find",help:"Help",identify:"Identify",measure:"Measurement",layerControl:"Layers",legend:"Legend",locale:"Locale",print:"Print",
streetview:"Google Street View"}}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/plugins/Google":function(){(function(h,l){"function"===typeof define&&define.amd?define(l):"object"===typeof exports?module.exports=l():h.GoogleMapsLoader=l()})("undefined"!==typeof window?window:null,function(){var h=null,l=null,a=!1,d=[],b=[],f=null,k={URL:"https://maps.googleapis.com/maps/api/js",KEY:null,LIBRARIES:[],CLIENT:null,CHANNEL:null,LANGUAGE:null,REGION:null,VERSION:"3",WINDOW_CALLBACK_NAME:"__google_maps_api_provider_initializator__",
_googleMockApiObject:{},load:function(f){null===l?!0===a?f&&d.push(f):(a=!0,window[k.WINDOW_CALLBACK_NAME]=function(){var g;a=!1;null===l&&(l=window.google);for(g=0;g<b.length;g++)b[g](l);f&&f(l);for(g=0;g<d.length;g++)d[g](l);d=[]},k.createLoader()):f&&f(l)},createLoader:function(){h=document.createElement("script");h.type="text/javascript";h.src=k.createUrl();document.body.appendChild(h)},isLoaded:function(){return null!==l},createUrl:function(){var a=k.URL,a=a+("?callback\x3d"+k.WINDOW_CALLBACK_NAME);
k.KEY&&(a+="\x26key\x3d"+k.KEY);0<k.LIBRARIES.length&&(a+="\x26libraries\x3d"+k.LIBRARIES.join(","));k.VERSION&&(a+="\x26v\x3d"+k.VERSION);k.CLIENT&&(a+="\x26client\x3d"+k.CLIENT);k.CHANNEL&&(a+="\x26channel\x3d"+k.CHANNEL);k.LANGUAGE&&(a+="\x26language\x3d"+k.LANGUAGE);k.REGION&&(a+="\x26region\x3d"+k.REGION);return a},release:function(m){var g=function(){k.KEY=null;k.LIBRARIES=[];k.CLIENT=null;k.CHANNEL=null;k.LANGUAGE=null;k.REGION=null;k.VERSION=googleVersion;l=null;a=!1;d=[];b=[];"undefined"!==
typeof window.google&&delete window.google;"undefined"!==typeof window[k.WINDOW_CALLBACK_NAME]&&delete window[k.WINDOW_CALLBACK_NAME];null!==f&&(k.createLoader=f,f=null);null!==h&&(h.parentElement.removeChild(h),h=null);m&&m()};a?k.load(function(){g()}):g()},onLoad:function(a){b.push(a)},makeMock:function(){f=k.createLoader;k.createLoader=function(){window.google=k._googleMockApiObject;window[k.WINDOW_CALLBACK_NAME]()}}};return k})},"app/config/bookmarks":function(){define({map:!0,editable:!0,bookmarks:[{extent:{xmin:-1.548913048708616E7,
ymin:398794.4860580916,xmax:-5891085.7193757,ymax:8509680.431452557,spatialReference:{wkid:102100}},name:"USA"}]})},"app/config/find":function(){define({map:!0,zoomExtentFactor:2,queries:[{description:"Find A Public Safety Location By Name",url:"http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/PublicSafety/PublicSafetyOperationalLayers/MapServer",layerIds:[1,2,3,4,5,6,7],searchFields:["FDNAME, PDNAME","NAME","RESNAME"],minChars:2,gridColumns:[{field:"Name",label:"Name"},{field:"layerName",
label:"Layer",width:100,sortable:!1,resizable:!1}],sort:[{attribute:"Name",descending:!1}],prompt:"fdname, pdname, name or resname",selectionMode:"single"},{description:"Find Incident By Code/Description",url:"http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/PublicSafety/PublicSafetyOperationalLayers/MapServer",layerIds:[15,17,18],searchFields:["FCODE","DESCRIPTION"],minChars:4,gridColumns:[{field:"layerName",label:"Layer",width:100,sortable:!1,resizable:!1},{field:"Fcode",label:"Fcode",
width:100},{field:"Description",label:"Descr"},{field:"SORT_VALUE",visible:!1,get:function(h){return h.layerName+" "+h.feature.attributes.Fcode}}],sort:[{attribute:"SORT_VALUE",descending:!1}],prompt:"fdname, pdname, name or resname",customGridEventHandlers:[{event:".dgrid-row:click",handler:function(h){alert("You clicked a row!")}}]}],selectionSymbols:{polygon:{type:"esriSFS",style:"esriSFSSolid",color:[255,0,0,62],outline:{type:"esriSLS",style:"esriSLSSolid",color:[255,0,0,255],width:3}},point:{type:"esriSMS",
style:"esriSMSCircle",size:25,color:[255,0,0,62],angle:0,xoffset:0,yoffset:0,outline:{type:"esriSLS",style:"esriSLSSolid",color:[255,0,0,255],width:2}}},selectionMode:"extended"})},"app/config/identify":function(){define({map:!0,mapClickMode:!0,mapRightClickMenu:!0,identifyLayerInfos:!0,identifyTolerance:5,identifies:{meetupHometowns:{0:{title:"Hometowns",fieldInfos:[{fieldName:"Location",visible:!0}]}},louisvillePubSafety:{2:{title:"Police Station",fieldInfos:[{fieldName:"Name",visible:!0},{fieldName:"Address",
visible:!0},{fieldName:"Type",visible:!0},{fieldName:"Police Function",visible:!0},{fieldName:"Last Update Date",visible:!0}]},8:{title:"Traffic Camera",description:"{Description} lasted updated: {Last Update Date}",mediaInfos:[{title:"",caption:"",type:"image",value:{sourceURL:"{Location URL}",linkURL:"{Location URL}"}}]}}}})},"app/config/basemaps":function(){define([],function(){return{map:!0,mode:"agol",title:"Basemaps",basemaps:{streets:{title:"Streets"},"streets-night-vector":{title:"Streets (Night)"},
"streets-navigation-vector":{title:"Streets (Navigation)"},"streets-relief-vector":{title:"Street (Relief)"},satellite:{title:"Satellite"},hybrid:{title:"Hybrid"},topo:{title:"Topo"},terrain:{title:"Terrain"},"gray-vector":{title:"Gray"},"dark-gray-vector":{title:"Dark Gray"},oceans:{title:"Oceans"},"national-geographic":{title:"Nat Geo"},osm:{title:"Open Street Map"},LandsatShaded:{title:"Landsat Shaded",basemap:{baseMapLayers:[{url:"https://imagery.arcgisonline.com/arcgis/rest/services/LandsatGLS/LandsatShadedBasemap/ImageServer"}]}},
EarthAtNight:{title:"Earth at Night",basemap:{baseMapLayers:[{url:"https://tiles.arcgis.com/tiles/P3ePLMYs2RVChkJx/arcgis/rest/services/Earth_at_Night_WM/MapServer"}]}},DavidRumseyMap1812:{title:"David Rumsey 1812",basemap:{baseMapLayers:[{url:"http://tiles.arcgis.com/tiles/IEuSomXfi6iB7a25/arcgis/rest/services/World_Globe_1812/MapServer"}]}}}}})},"esri/layers/FeatureLayer":function(){define("require module dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/date/locale dojo/sniff dojo/io-query dojo/dom-construct dojo/i18n dojo/when dojo/promise/all ../kernel ../lang ../request ../config ../deferredUtils ../SpatialReference ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/jsonUtils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/jsonUtils ../tasks/QueryTask ../tasks/query ../tasks/FeatureSet ../tasks/StatisticDefinition ../geometry/Extent ../geometry/jsonUtils ../geometry/normalizeUtils ../geometry/scaleUtils ./GraphicsLayer ./Field ./TimeInfo ./FeatureType ./FeatureTemplate ./FeatureEditResult ./LabelClass ./SnapshotMode ./OnDemandMode ./SelectionMode ./StreamMode ./TrackManager ./HeatmapManager dojo/i18n!../nls/jsapi require".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K,J,I,L,M,N,Q,O,T,S,R,U,W,fa,ea,oa,pa,Aa,ta,va,ua){var qa=x.defaults,ca=a(O,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",reHostedFS:/(https?:)?\/\/services.*\.arcgis\.com/i,maxPointCountForAuto:4E3,maxRecordCountForAuto:2E3,maxVertexCountForAuto:25E4,generalizeForScale:4E3,_eventMap:{"add-attachment-complete":["result"],"before-apply-edits":["adds","updates","deletes"],
"delete-attachments-complete":["results"],"edits-complete":["adds","updates","deletes"],"query-attachment-infos-complete":["results"],"query-count-complete":["count"],"query-features-complete":["featureSet"],"query-ids-complete":["objectIds"],"query-related-features-complete":["featureSets"],"selection-complete":["features","method"],"update-end":["error","info"]},constructor:function(a,c){this._preventInit||this._initFeatureLayer(a,c)},_initFeatureLayer:function(a,c){this.i18n=ua;c=c||{};this.showLabels=
null!=c.showLabels?c.showLabels:!0;this._outFields=c.outFields;this._defnExpr=c.definitionExpression;this._loadCallback=c.loadCallback;var e=c._usePatch;this._usePatch=null===e||void 0===e?!0:e;this._trackIdField=c.trackIdField;this.objectIdField=c.objectIdField;this._maxOffset=null!=c.maxAllowableOffset?c.maxAllowableOffset:this.maxAllowableOffset;this.quantize=null!=c.quantize?c.quantize:!0;this._optEditable=c.editable;this._optAutoGen=c.autoGeneralize;this.editSummaryCallback=c.editSummaryCallback;
this.userId=c.userId;this.userIsAdmin=c.userIsAdmin;this.useMapTime=c.hasOwnProperty("useMapTime")?!!c.useMapTime:!0;this.source=c.source;this.gdbVersion=c.gdbVersion;this.orderByFields=c.orderByFields;this.maxPointCountForAuto=null!=c.maxPointCountForAuto?c.maxPointCountForAuto:this.maxPointCountForAuto;this.maxRecordCountForAuto=null!=c.maxRecordCountForAuto?c.maxRecordCountForAuto:this.maxRecordCountForAuto;this.maxVertexCountForAuto=null!=c.maxVertexCountForAuto?c.maxVertexCountForAuto:this.maxVertexCountForAuto;
this.generalizeForScale=null!=c.generalizeForScale?c.generalizeForScale:this.generalizeForScale;this.queryPagination=null!=c.queryPagination?c.queryPagination:this.url?this.reHostedFS.test(this.url):!1;this.multipatchOption=c.multipatchOption;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var d=ca,e=this.mode=t.isDefined(c.mode)?c.mode:d.MODE_ONDEMAND;switch(this._isStream&&(e=d.MODE_STREAM,this.mode=d.MODE_STREAM),
e){case d.MODE_SNAPSHOT:this.currentMode=d.MODE_SNAPSHOT;this._mode=new ea(this);this._isSnapshot=!0;break;case d.MODE_ONDEMAND:case d.MODE_AUTO:this.currentMode=d.MODE_ONDEMAND;this._tileWidth=c.tileWidth||512;this._tileHeight=c.tileHeight||512;this._mode=new oa(this);this.latticeTiling=c.latticeTiling;break;case d.MODE_SELECTION:this.currentMode=d.MODE_SELECTION;this._mode=new pa(this);this._isSelOnly=!0;break;case d.MODE_STREAM:this.currentMode=d.MODE_STREAM,this._mode=new Aa(this),this._isStream=
!0}if(this._initLayer=b.hitch(this,this._initLayer),this._selectHandler=b.hitch(this,this._selectHandler),this._editable=!1,b.isObject(a)&&a.layerDefinition)return this._collection=!0,this.mode=this._isStream?d.MODE_STREAM:d.MODE_SNAPSHOT,this._initLayer(a),this;this._task=new G(this.url,{source:this.source,gdbVersion:this.gdbVersion});e=this._url.path;this._fserver=!1;-1!==e.search(/\/FeatureServer\//i)&&(this._fserver=!0);this.mode===d.MODE_AUTO&&this.reHostedFS.test(this.url)&&this._queryLimit();
(d=c.resourceInfo)?this._initLayer(d):(this.source&&(d={source:this.source.toJson()},this._url.query=b.mixin(this._url.query,{layer:k.toJson(d)})),this.gdbVersion&&(this._url.query=b.mixin(this._url.query,{gdbVersion:this.gdbVersion})),w({url:e,content:b.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler}));this.registerConnectEvents()},_initLayer:function(a,c){if(a||c){this._json=a;this._findCredential();((this.credential&&this.credential.ssl||
a&&a._ssl)&&(this._useSSL(),this._task._useSSL()),this.version=a.currentVersion,this.version)||(this.version="capabilities"in a||"drawingInfo"in a||"hasAttachments"in a||"htmlPopupType"in a||"relationships"in a||"timeInfo"in a||"typeIdField"in a||"types"in a?10:9.3);if(this._collection&&(this._isStream||(this.currentMode=ca.MODE_SNAPSHOT,this._mode=new ea(this)),this._isSnapshot=!0,this._featureSet=a.featureSet,this._nextId=a.nextObjectId,a=a.layerDefinition),this.geometryType=a.geometryType,"string"!=
typeof this.multipatchOption&&"esriGeometryMultiPatch"===this.geometryType&&(this.multipatchOption="xyFootprint"),a.hasOwnProperty("capabilities")){var d=this.capabilities=a.capabilities;d&&-1!==d.toLowerCase().indexOf("editing")?this._editable=!0:this._editable=!1}else this._collection||(this._editable=this._fserver);t.isDefined(this._optEditable)?(this._editable=this._optEditable,delete this._optEditable):"esriGeometryMultiPatch"===this.geometryType&&(this._editable=!1);this._json=k.toJson(this._json);
this.isEditable()?this._setMaxOffset(null):this.mode===ca.MODE_SNAPSHOT||"esriGeometryPolyline"!==this.geometryType&&"esriGeometryPolygon"!==this.geometryType&&!this.hasXYFootprint()||(this._autoGeneralize=t.isDefined(this._optAutoGen)?this._optAutoGen:this.mode===ca.MODE_ONDEMAND||this.mode===ca.MODE_AUTO,delete this._optAutoGen);var d=a.effectiveMinScale||a.minScale,g=a.effectiveMaxScale||a.maxScale;!this._hasMin&&d&&this.setMinScale(d);!this._hasMax&&g&&this.setMaxScale(g);this.layerId=a.id;this.name=
a.name;this.description=a.description;this.copyright=a.copyrightText;this.type=a.type;this.displayField=a.displayField;this.defaultDefinitionExpression=a.definitionExpression;this.fullExtent=new L(a.extent);this.initialExtent=new L(this.fullExtent.toJson());this.fullExtent.spatialReference&&(this.spatialReference=new z(this.fullExtent.spatialReference.toJson()));this.defaultVisibility=a.defaultVisibility;"esriGeometryPoint"!==this.geometryType&&"esriGeometryMultipoint"!==this.geometryType||(this.latticeTiling=
!1);this.hasM=a.hasM||!1;this.hasZ=a.hasZ||!1;this.indexedFields=a.indexedFields;this.maxRecordCount=a.maxRecordCount;this.canModifyLayer=a.canModifyLayer;this.supportsStatistics=a.supportsStatistics;this.supportsAdvancedQueries=this._collection?!1:a.supportsAdvancedQueries;this.supportsCalculate=a.supportsCalculate;this.supportsAttachmentsByUploadId=a.supportsAttachmentsByUploadId;this.supportsCoordinatesQuantization=a.supportsCoordinatesQuantization;this.quantize=this.quantize&&this.supportsCoordinatesQuantization;
this.hasLabels=a.hasLabels;this.canScaleSymbols=a.canScaleSymbols;this.supportsRollbackOnFailureParameter=this.supportsRollbackOnFailure=a.supportsRollbackOnFailure;this.syncCanReturnChanges=a.syncCanReturnChanges;this.isDataVersioned=a.isDataVersioned;this.editFieldsInfo=a.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=a.ownershipBasedAccessControlForFeatures;this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures&&(this.creatorField=this.editFieldsInfo.creatorField);this.relationships=
a.relationships;this.allowGeometryUpdates=t.isDefined(a.allowGeometryUpdates)?a.allowGeometryUpdates:!0;this.allowUpdateWithoutMValues=!!a.allowUpdateWithoutMValues;this.advancedQueryCapabilities=a.advancedQueryCapabilities||{supportsStatistics:this.supportsStatistics,supportsOrderBy:this.supportsAdvancedQueries,supportsDistinct:this.supportsAdvancedQueries};this.useStandardizedQueries=a.useStandardizedQueries;this.tileMaxRecordCount=a.tileMaxRecordCount;this.standardMaxRecordCount=a.standardMaxRecordCount;
this._setMaxOffset(this._maxOffset,!0);this._isTable="Table"===this.type;for(var n=this.fields=[],g=a.fields,d=0;d<g.length;d++)n.push(new T(g[d]));if(!this.objectIdField&&(this.objectIdField=a.objectIdField,!this.objectIdField))for(g=a.fields,d=0;d<g.length;d++)if(n=g[d],"esriFieldTypeOID"===n.type){this.objectIdField=n.name;break}if(!t.isDefined(this._nextId)){g=this.objectIdField;n=-1;if(this._collection&&g)for(var m,h=(d=this._featureSet)&&d.features,r=h?h.length:0,d=0;r>d;d++)m=(m=h[d].attributes)&&
m[g],m>n&&(n=m);this._nextId=n+1}this.globalIdField=a.globalIdField;var u;(d=this.typeIdField=a.typeIdField)&&(u=!this._getField(d)&&this._getField(d,!0),u&&(this.typeIdField=u.name));this.visibilityField=a.visibilityField;(u=a.defaultSymbol)&&(this.defaultSymbol=D.fromJson(u));var q,l,v=this.types=[];m=a.types;g=(d=this.editFieldsInfo)&&d.creatorField;n=d&&d.editorField;r=g||n;h=[];if(m)for(d=0;d<m.length;d++)q=new R(m[d]),l=q.templates,r&&l&&l.length&&(h=h.concat(l)),v.push(q);v=a.templates;q=this.templates=
[];if(v)for(d=0;d<v.length;d++)m=new U(v[d]),r&&h.push(m),q.push(m);for(d=0;d<h.length;d++)(r=b.getObject("prototype.attributes",!1,h[d]))&&(g&&delete r[g],n&&delete r[n]);(d=a.timeInfo)&&(this.timeInfo=new S(d),this._startTimeField=d.startTimeField,this._endTimeField=d.endTimeField,this._startTimeField&&this._endTimeField&&(this._twoTimeFields=!0),this._trackIdField?d.trackIdField=this._trackIdField:this._trackIdField=d.trackIdField);this.hasAttachments=!this._collection&&a.hasAttachments?!0:!1;
this.htmlPopupType=a.htmlPopupType;var w,g=(d=a.drawingInfo)&&d.labelingInfo;if(g&&!this.labelingInfo&&(this.labelingInfo=f.map(g,function(a){return new fa(a)}),this._fixLabelExpr()),!this.renderer)if(d&&d.renderer){if(w=d.renderer,this.setRenderer(H.fromJson(w)),"classBreaks"===w.type&&this.renderer.setMaxInclusive(!0),!this._collection){var x=w.type;u=[];switch(w=this.renderer,x){case "simple":u.push(w.symbol);break;case "uniqueValue":case "classBreaks":u.push(w.defaultSymbol),u=u.concat(f.map(w.infos,
function(a){return a.symbol}))}u=f.filter(u,t.isDefined);var y=this._url.path+"/images/",oa=this._getToken();f.forEach(u,function(a){var c=a.url;c&&(-1===c.search(/https?\:/)&&-1===c.indexOf("data:")&&(a.url=y+c),oa&&-1!==a.url.search(/https?\:/)&&(a.url+="?token\x3d"+oa))})}}else if(u)m=this.types,0<m.length?(w=new F(this.defaultSymbol,this.typeIdField),f.forEach(m,function(a){w.addValue(a.id,a.symbol)})):w=new E(this.defaultSymbol),this.setRenderer(w);else if(!this._isTable){switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":x=
new A;break;case "esriGeometryPolyline":x=new B;break;case "esriGeometryPolygon":x=new C;break;default:this.hasXYFootprint()&&(x=new C)}this.setRenderer(x?new E(x):null)}x=d&&d.transparency||0;!this.hasOwnProperty("opacity")&&0<x&&(this.opacity=1-x/100);(e("ie")||7<=e("trident")||e("safari"))&&this.isEditable()&&10.02>this.version&&(this._ts=!0);this.statistics=a.statistics;this._fixRendererFields();this._checkFields();this._updateCaps();var G=function(){this.currentMode!==ca.MODE_SNAPSHOT&&(this.queryPagination=
!1);null==this._maxOffset||this._isFractionalOffsetAllowed()||this._setMaxOffset(this._maxOffset);this.loaded=!0;this.onLoad(this);var a=this._loadCallback;a&&(delete this._loadCallback,a(this))};this._collection?(x=this._featureSet,this._featureSet=null,this._mode._drawFeatures(new J(x)),this._fcAdded=!0,G.call(this)):this._forceIdentity(this._limitPromise?function(){var a=this;this._limitPromise.then(function(c){a._checkMode(c)});this._limitPromise.always(function(){a._limitPromise=null;G.call(a)})}:
G)}},setShowLabels:function(a){this.showLabels=a;this.onShowLabelsChange()},onShowLabelsChange:function(){},onRendererChange:function(a){this.inherited(arguments);var c=this._map;(this._ager=!!(a&&a.observationAger&&a.observationRenderer),a&&"colors"in a&&"blurRadius"in a&&"maxPixelIntensity"in a)?"esriGeometryPoint"==this.geometryType&&!this._heatmapManager&&c&&(this._heatmapManager=new va(this),this._heatmapManager.initialize(c)):this.renderer&&this.renderer.getRendererInfo?f.some(this.renderer.rendererInfos,
function(a){return a.renderer&&"colors"in a.renderer&&"blurRadius"in a.renderer})||(this._heatmapManager=null):this._heatmapManager=null;if(a){var b=[],c=f.filter([a,a.observationRenderer,a.latestObservationRenderer,a.trackRenderer],t.isDefined),e=function(a){return null!=a&&"function"!=typeof a&&a};f.forEach(c,function(a){var c=e(a.attributeField),d=e(a.attributeField2);a=e(a.attributeField3);!1!==c&&b.push(c);!1!==d&&b.push(d);!1!==a&&b.push(a)});this._rendererFields=b}else this._rendererFields=
[];this.loaded&&(this._fixRendererFields(),this._checkFields(this._rendererFields),this._collection&&(this._typesDirty=!0))},redraw:function(){this.inherited(arguments);this._trackManager&&this._trackManager.container&&this._trackManager.container.redraw()},_evalSDRenderer:function(){this.inherited(arguments);var a=this._getRenderer();this._ager=!!(a&&a.observationAger&&a.observationRenderer);this._trackManager&&this._trackManager.container&&this._trackManager.container.setRenderer(a&&a.trackRenderer)},
_setMap:function(a){var c=this.inherited(arguments),b=this._mode,e=this;return b&&b.initialize(a),this.geometryType&&this.attr("data-geometry-type",this.geometryType.replace(/esriGeometry/i,"").toLowerCase()),this._addHandle=this.on("graphic-node-add",function(a){a=a.graphic.attributes;(a=e._selectedFeatures[a&&a[e.objectIdField]])&&a.attr("data-selected","")}),c},_unsetMap:function(a){var c=this._mode;c&&c.suspend();this._trackManager&&(this._trackManager.destroy(),this._trackManager=null);d.disconnect(this._zoomConnect);
d.disconnect(this._addHandle);this._zoomConnect=this._addHandle=null;this._toggleTime(!1);this.inherited("_unsetMap",arguments)},refresh:function(){this._needsRefresh=!1;var a=this._mode;a&&a.refresh()},hasXYFootprint:function(){return"esriGeometryMultiPatch"===this.geometryType&&"xyFootprint"===this.multipatchOption},getOutFields:function(){return f.filter(this._getOutFields(),function(a){return"*"===a||!!this._getField(a)},this)},getField:function(a){return this._getField(a,!0)},getFieldLabel:function(a){var c=
this.infoTemplate,c=c&&c.getFieldInfo&&c.getFieldInfo(a);a=b.isFunction(a)?null:this.getField(a);var e=c||a,d="";return e&&(d=c&&c.label||a&&a.alias||e.name||e.fieldName),d},getDomain:function(a,c){var b,e,d=c&&c.feature,g=d&&this.typeIdField&&d.attributes&&d.attributes[this.typeIdField];return null!=g&&f.some(this.types,function(c){return c.id==g?(b=c.domains&&c.domains[a],b&&"inherited"===b.type&&(b=this._getLayerDomain(a),e=!0),!0):!1},this),e||b||(b=this._getLayerDomain(a)),b},_getLayerDomain:function(a){var c;
return f.some(this.fields,function(b){return b.name===a&&(c=b.domain),!!c}),c},getType:function(a){var c,b=a&&this.typeIdField&&a.attributes&&a.attributes[this.typeIdField];return f.some(this.types,function(a){return a.id==b&&(c=a),!!c}),c},setEditable:function(a){if(!this._collection)return this;if(!this.loaded)return this._optEditable=a,this;var c=this._editable;return this._editable=a,this._updateCaps(),c!==a&&this.onCapabilitiesChange(),this},getEditCapabilities:function(a){var c={canCreate:!1,
canUpdate:!1,canDelete:!1};if(!this.loaded||!this.isEditable())return c;var e,d=a&&a.feature;a=a&&a.userId||this.getUserId();var g=f.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],b.trim),k=(c=-1<f.indexOf(g,"editing"))&&-1<f.indexOf(g,"create"),n=c&&-1<f.indexOf(g,"update"),g=c&&-1<f.indexOf(g,"delete"),m=this.ownershipBasedAccessControlForFeatures,h=this.editFieldsInfo,t=h&&h.creatorField,h=h&&h.realm,d=(d=d&&d.attributes)&&t?d[t]:void 0,t=!!this.userIsAdmin,r=!m||t||!(!m.allowOthersToUpdate&&
!m.allowUpdateToOthers),u=!m||t||!(!m.allowOthersToDelete&&!m.allowDeleteToOthers),q=!m||t||!m.hasOwnProperty("allowAnonymousToUpdate")||m.allowAnonymousToUpdate,m=!m||t||!m.hasOwnProperty("allowAnonymousToDelete")||m.allowAnonymousToDelete;if(a&&h&&(a=a+"@"+h),(t||c&&!(k||n||g))&&(k=n=g=!0),e={canCreate:k,canUpdate:n,canDelete:g},a||(e.canUpdate=e.canUpdate&&q,e.canDelete=e.canDelete&&m),null===d)e.canUpdate=e.canUpdate&&r,e.canDelete=e.canDelete&&u;else{if(""===d)return e;if(d){if(a.toLowerCase()===
d.toLowerCase())return e;e.canUpdate=e.canUpdate&&r;e.canDelete=e.canDelete&&u}}return e},getUserId:function(){var a;return this.loaded&&(a=this.credential&&this.credential.userId||this.userId||""),a},setUserIsAdmin:function(a){this.userIsAdmin=a},setEditSummaryCallback:function(a){this.editSummaryCallback=a},getEditSummary:function(a,c,e){e=t.isDefined(e)?e:(new Date).getTime();var d="";e=this.getEditInfo(a,c,e);c=c&&c.callback||this.editSummaryCallback;if(c&&(e=c(a,e)||""),b.isString(e))d=e;else{if(e){a=
e.action;c=e.userId;var g=e.timeValue,f=0;a&&f++;c&&f++;t.isDefined(g)&&f++;1<f&&(d=("edit"===a?"edit":"create")+(c?"User":"")+(t.isDefined(g)?e.displayPattern:""))}d=d&&t.substitute(e,this.i18n.layers.FeatureLayer[d])}return d},getEditInfo:function(a,c,b){if(this.loaded){b=t.isDefined(b)?b:(new Date).getTime();var e;c=c&&c.action||"last";var d=this.editFieldsInfo,g=d&&d.creatorField,f=d&&d.creationDateField,k=d&&d.editorField,n=d&&d.editDateField,k=(a=(d&&d.realm,a&&a.attributes))&&k?a[k]:void 0,
n=a&&n?a[n]:null,g=this._getEditData(a&&g?a[g]:void 0,a&&f?a[f]:null,b);b=this._getEditData(k,n,b);switch(c){case "creation":e=g;break;case "edit":e=b;break;case "last":e=b||g}return e&&(e.action=e===b?"edit":"creation"),e}},_getEditData:function(a,c,b){var e,d,f;if(t.isDefined(c)&&(d=b-c,f=0>d?"Full":6E4>d?"Seconds":12E4>d?"Minute":36E5>d?"Minutes":72E5>d?"Hour":864E5>d?"Hours":6048E5>d?"WeekDay":"Full"),(void 0!==a||f)&&(e=e||{},e.userId=a,f))a=g.format,b=new Date(c),e.minutes=Math.floor(d/6E4),
e.hours=Math.floor(d/36E5),e.weekDay=a(b,{datePattern:"EEEE",selector:"date"}),e.formattedDate=a(b,{selector:"date"}),e.formattedTime=a(b,{selector:"time"}),e.displayPattern=f,e.timeValue=c;return e},isEditable:function(){return!(!this._editable&&!this.userIsAdmin)},setMaxAllowableOffset:function(a){return this.isEditable()||this._setMaxOffset(a,!0),this},getMaxAllowableOffset:function(){var a=this._quantizationParameters?this._quantizationParameters.tolerance:void 0;return null!=this._maxOffset?
this._maxOffset:a},_setMaxOffset:function(a,c){return null==a?(delete this._maxOffset,delete this._quantizationParameters,this):(this.quantize&&this.supportsCoordinatesQuantization?("esriGeometryPolyline"===this.geometryType?this._maxOffset=a:delete this._maxOffset,this._quantizationParameters={mode:"view",originPosition:"upperLeft",tolerance:a,extent:this.fullExtent}):(this._isFractionalOffsetAllowed()&&c||(a=Math.floor(a)),isNaN(a)||0===a?delete this._maxOffset:this._maxOffset=a,delete this._quantizationParameters),
this)},_isFractionalOffsetAllowed:function(){return null==this.version||10.1<=this.version||navigator.languages&&this._isLangWithDot(navigator.languages[0])},_isLangWithDot:function(a){return a=a&&a.split("-"),a=a&&a[0]&&a[0].toLowerCase(),-1!==f.indexOf(this._langsWithDot,a)},_langsWithDot:"ar en et fr he ja ko th vi zh".split(" "),setAutoGeneralize:function(a){return this.loaded?this.isEditable()||this.mode===ca.MODE_SNAPSHOT||"esriGeometryPolyline"!==this.geometryType&&"esriGeometryPolygon"!==
this.geometryType&&!this.hasXYFootprint()||(this._autoGeneralize=a,a?(this._autoSnapshot&&(this._prevScale=null),this._updateMaxOffset()):this._setMaxOffset(null)):this._optAutoGen=a,this},setGDBVersion:function(a){return this._collection||a===this.gdbVersion||!a&&!this.gdbVersion||(this.gdbVersion=a,this._task.gdbVersion=a,this._url.query=b.mixin(this._url.query,{gdbVersion:a}),this.loaded&&(this.clearSelection(),this._map&&this.refresh()),this.onGDBVersionChange()),this},hasAllFeatures:function(){return this._mode?
this._mode.hasAllFeatures():!0},setDefinitionExpression:function(a){this._defnExpr=a;a=this._mode;return a&&a.propertyChangeHandler(1),this},getDefinitionExpression:function(){return this._defnExpr},setTimeDefinition:function(a){this._isSnapshot&&(this._timeDefn=a,(a=this._mode)&&a.propertyChangeHandler(2));return this},getTimeDefinition:function(){return this._timeDefn},setTimeOffset:function(a,c){this._timeOffset=a;this._timeOffsetUnits=c;var b=this._mode;return b&&b.propertyChangeHandler(0),this},
setUseMapTime:function(a){this.useMapTime=a;this._toggleTime(!this.suspended);(a=this._mode)&&a.propertyChangeHandler(0)},selectFeatures:function(a,c,b,e){c=c||ca.SELECTION_NEW;this._hasPartialSelectedFeatures=!1;var d;a=this._getShallowClone(a);var g=this._map,f=this,k=y._fixDfd(new m(y._dfdCanceller));if(a.outFields=this.getOutFields(),a.returnGeometry=!0,a.multipatchOption=this.multipatchOption,g&&(a.outSpatialReference=new z(g.spatialReference.toJson())),!this._applyQueryFilters(a,!0))return d=
{features:[]},this._selectHandler(d,c,b,e,k),k;if(g=this._canDoClientSideQuery(a))return k._pendingDfd=r(this._doQuery(a,g)),k._pendingDfd.then(function(a){d={features:a};f._selectHandler(d,c,b,e,k)}),k;if(this._collection)return this._resolve([Error("FeatureLayer::selectFeatures - "+this.invalidParams)],null,e,k,!0),k;var n=this;this._ts&&(a._ts=(new Date).getTime());return(k._pendingDfd=this._task.execute(a)).addCallbacks(function(a){n._selectHandler(a,c,b,e,k)},function(a){n._hasPartialSelectedFeatures=
!0;n._resolve([a],null,e,k,!0)}),k},getSelectedFeatures:function(){var a,c=this._selectedFeatures,b=[];for(a in c)c.hasOwnProperty(a)&&b.push(c[a]);return b},clearSelection:function(a){var c,b=this._selectedFeatures,e=this._mode;for(c in b)b.hasOwnProperty(c)&&(this._unSelectFeatureIIf(c,e),e._removeFeatureIIf(c));return this._selectedFeatures={},this._isSelOnly&&e._applyTimeFilter(!0),a||this.onSelectionClear(),this},setSelectionSymbol:function(a){if(this._selectionSymbol=a,a){var c,b=this._selectedFeatures;
for(c in b)b.hasOwnProperty(c)&&b[c].setSymbol(a)}return this},getSelectionSymbol:function(){return this._selectionSymbol},setLabelingInfo:function(a){a?(this.labelingInfo=a,this._fixLabelExpr()):delete this.labelingInfo;this._collection&&(this._typesDirty=!0);this.onLabelingInfoChange()},_fixLabelExpr:function(){var a,c=/\[([^\[\]]+)\]/gi,b=this,e=function(a,c){var e=b._getField(c,!0);return"["+(e&&e.name||c)+"]"};f.forEach(this.labelingInfo,function(b){(a=b.labelExpression)&&(b.labelExpression=
a.replace(c,e))})},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(a,c,e,d,g,k){var n=k.assembly,m=k.dfd;this._applyNormalized(a,n&&n[0]);this._applyNormalized(c,n&&n[1]);this.onBeforeApplyEdits(a,c,e);var h={},t=this.objectIdField,n={f:"json"},r=!1;if(this._collection)return k={},k.addResults=a?f.map(a,function(){return r=!0,{objectId:this._nextId++,success:!0}},this):null,k.updateResults=c?f.map(c,function(a){r=!0;var c=a.attributes[t];return h[c]=a,{objectId:c,success:!0}},
this):null,k.deleteResults=e?f.map(e,function(a){return r=!0,{objectId:a.attributes[t],success:!0}},this):null,void(r?this._editHandler(k,a,h,d,g,m):this._resolve([k.addResults,k.updateResults,k.deleteResults],null,d,m));if(a&&0<a.length&&(n.adds=this._convertFeaturesToJson(a,0,1),r=!0),c&&0<c.length){for(k=0;k<c.length;k++){var u=c[k];h[u.attributes[t]]=u}n.updates=this._convertFeaturesToJson(c,0,0,1);r=!0}if(e&&0<e.length){c=[];for(k=0;k<e.length;k++)c.push(e[k].attributes[t]);n.deletes=c.join(",");
r=!0}if(r){var q=this;return w({url:this._url.path+"/applyEdits",content:b.mixin(n,this._url.query),callbackParamName:"callback",load:function(c){q._editHandler(c,a,h,d,g,m)},error:function(a){q._resolve([a],null,g,m,!0)}},{usePost:!0})}this._resolve([],null,d,m)},queryFeatures:function(a,c,b){return this._query("execute","onQueryFeaturesComplete",a,c,b)},queryRelatedFeatures:function(a,c,b){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",a,c,b)},queryIds:function(a,
c,b){return this._query("executeForIds","onQueryIdsComplete",a,c,b)},queryCount:function(a,c,b){return this._query("executeForCount","onQueryCountComplete",a,c,b)},queryExtent:function(a,c,b){return this._query("executeForExtent","onQueryExtentComplete",a,c,b)},queryAttachmentInfos:function(a,e,d){var g=this._url.path+"/"+a+"/attachments",k=new m(y._dfdCanceller),n=this;return k._pendingDfd=w({url:g,content:b.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(b){var d;b=
b.attachmentInfos;f.forEach(b,function(b){d=c.objectToQuery({gdbVersion:n._url.query&&n._url.query.gdbVersion,layer:n._url.query&&n._url.query.layer,token:n._getToken()});b.url=g+"/"+b.id+(d?"?"+d:"");b.objectId=a});n._resolve([b],"onQueryAttachmentInfosComplete",e,k)},error:function(a){n._resolve([a],null,d,k,!0)}}),k},addAttachment:function(a,c,b,e){return this._sendAttachment("add",a,c,b,e)},updateAttachment:function(a,c,b,e,d){return b.appendChild(n.create("input",{type:"hidden",name:"attachmentId",
value:c})),this._sendAttachment("update",a,b,e,d)},deleteAttachments:function(a,c,e,d){var g=this._url.path+"/"+a+"/deleteAttachments",k=new m(y._dfdCanceller),n=this;c={f:"json",attachmentIds:c.join(",")};return k._pendingDfd=w({url:g,content:b.mixin(c,this._url.query),callbackParamName:"callback",load:b.hitch(this,function(c){c=c.deleteAttachmentResults;c=f.map(c,function(c){c=new W(c);return c.attachmentId=c.objectId,c.objectId=a,c});n._resolve([c],"onDeleteAttachmentsComplete",e,k)}),error:function(a){n._resolve([a],
null,d,k,!0)}},{usePost:!0}),k},addType:function(a){var c=this.types;if(c){if(f.some(c,function(c){return c.id==a.id?!0:!1}))return!1;c.push(a)}else this.types=[a];return this._typesDirty=!0,!0},deleteType:function(a){if(this._collection){var c=this.types;if(c){var b=-1;if(f.some(c,function(c,e){return c.id==a?(b=e,!0):!1}),-1<b)return this._typesDirty=!0,c.splice(b,1)[0]}}},toJson:function(){var a=this._json;if(a=b.isString(a)?k.fromJson(a):b.clone(a)){var a=a.layerDefinition?a:{layerDefinition:a},
c=a.layerDefinition,e=this._collection;if(e&&this._typesDirty){c.types=f.map(this.types||[],function(a){return a.toJson()});var d=this.renderer,g=this.labelingInfo,n=c.drawingInfo;!d&&!g||n||(n=c.drawingInfo={});n&&d&&-1===d.declaredClass.indexOf("TemporalRenderer")&&(n.renderer=d.toJson());g&&(n.labelingInfo=f.map(g,function(a){return a.toJson()}))}d=null;if((!e||this._fcAdded)&&(d={geometryType:c.geometryType,features:this._convertFeaturesToJson(this.graphics,!0)}),a.featureSet=b.mixin({},a.featureSet||
{},d),a.featureSet.transform)g=a.featureSet.transform,delete a.featureSet.transform,d=new J(a.featureSet),d.quantize(g),a.featureSet=d.toJson();return e&&(a.nextObjectId=this._nextId,c.capabilities=this.capabilities),a}},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryExtentComplete:function(){},
onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},onLabelingInfoChange:function(){},_forceIdentity:function(a){var c,b=this,e=this._url&&this._url.path,d=e&&e.toLowerCase().indexOf("/rest/services"),g=this.editFieldsInfo,g=g&&(g.creatorField||g.editorField);(this.userIsAdmin||g)&&!this._getToken()&&
-1<d&&v.id?(c=e.substring(0,d)+"/rest/info",w({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a){return a.owningSystemUrl?v.id.checkSignInStatus(a.owningSystemUrl+"/sharing"):void 0}).then(function(a){return a?v.id.getCredential(e):void 0}).then(function(a){a&&b._findCredential()}).always(function(){a.call(b)})):a.call(this)},_checkMode:function(a){var c=this.geometryType,b=this.maxRecordCount;a=(a=a&&a.features&&a.features[0])&&a.attributes&&a.attributes.exceedslimit;
this.mode===ca.MODE_AUTO&&!this.isEditable()&&0===a&&(this.queryPagination||("esriGeometryPolyline"===c||"esriGeometryPolygon"===c||"esriGeometryMultipoint"===c||this.hasXYFootprint())&&b>=this.maxRecordCountForAuto||"esriGeometryPoint"===c&&b>=this.maxPointCountForAuto)&&(this.currentMode=ca.MODE_SNAPSHOT,this._mode=new ea(this),this._isSnapshot=this._autoSnapshot=!0)},_queryLimit:function(){var a=this,c=new m;this._limitPromise=c.promise;setTimeout(function(){var b=new K,e=new I;e.statisticType=
"exceedslimit";e.maxPointCount=a.maxPointCountForAuto;e.maxRecordCount=a.maxRecordCountForAuto;e.maxVertexCount=a.maxVertexCountForAuto;e.outStatisticFieldName="exceedslimit";b.outStatistics=[e];a.queryFeatures(b).promise.then(function(a){c.resolve(a)},function(a){c.reject(a)})},0)},_updateCaps:function(){var a,c;c=this._editable;var e=b.trim(this.capabilities||""),d=f.map(e?e.split(","):[],b.trim),g=f.map(e?e.toLowerCase().split(","):[],b.trim),e=f.indexOf(g,"editing"),g={Create:f.indexOf(g,"create"),
Update:f.indexOf(g,"update"),Delete:f.indexOf(g,"delete")};if(c&&-1===e)d.push("Editing");else if(!c&&-1<e){c=[e];for(a in g)-1<g[a]&&c.push(g[a]);c.sort();for(a=c.length-1;0<=a;a--)d.splice(c[a],1)}this.capabilities=d.join(",")},_counter:{value:0},_getUniqueId:function(){return this._counter.value++},onSuspend:function(){this.inherited(arguments);this._toggleTime(!1);var a=this._mode;a&&a.suspend()},onResume:function(a){this.inherited(arguments);this._toggleTime(!0);var c=this._mode,b=this._map,
e=this._getRenderer();if(a.firstOccurrence){if(this._fixRendererFields(),this._checkFields(),this.clearSelection(),this.timeInfo&&!this._trackManager&&(this._trackIdField||e&&(e.latestObservationRenderer||e.trackRenderer))&&(this._trackManager=new ta(this),this._trackManager.initialize(b),this._childLayer=this._trackManager.container),e&&"colors"in e&&"blurRadius"in e&&"maxPixelIntensity"in e&&("esriGeometryPoint"!=this.geometryType||this._heatmapManager||(this._heatmapManager=new va(this),this._heatmapManager.initialize(b))),
this._autoSnapshot&&this._autoGeneralize&&("esriGeometryPolyline"===this.geometryType||"esriGeometryPolygon"===this.geometryType||this.hasXYFootprint())&&!this.isEditable()&&null==this.getMaxAllowableOffset())e=this.generalizeForScale,this._calculatedScale=e=this.maxScale?this.maxScale:this.minScale?Math.min(e,this.minScale):Math.min(e,Q.getScale(b,this.initialExtent)),this._calcMaxOffset=b.extent.getWidth()/b.width/b.getScale()*e;this._zoomConnect=d.connect(b,"onZoomEnd",this,this._zoomEndHandler);
this._updateMaxOffset();this._needsRefresh=!1;c&&c.startup()}else this._zoomEndHandler(),c&&c.resume()},_zoomEndHandler:function(){var a=this._map;this._updateMaxOffset();this._prevScale=a.getScale();!this.suspended&&this._needsRefresh&&this.refresh()},_updateMaxOffset:function(){var a=this._map;a&&a.loaded&&this._autoGeneralize&&(this._autoSnapshot?(a=this.getMaxAllowableOffset(),this._setMaxOffset(this._getMaxOffsetForScale(),!0),this._needsRefresh||(this._needsRefresh=a!=this.getMaxAllowableOffset())):
this._setMaxOffset(a.extent.getWidth()/a.width,!a.extent.spatialReference.isWebMercator()))},_getMaxOffsetForScale:function(){if(this._map){var a=this._map.getScale(),c=this._calculatedScale,b=this._calcMaxOffset,e=this._prevScale;return a>=c&&(null==e||c>e)?b:c>a&&(null==e||e>=c)?null:this.getMaxAllowableOffset()}},_toggleTime:function(a){var c=this._map;a&&this.timeInfo&&this.useMapTime&&c?(this._mapTimeExtent=c.timeExtent,this._timeConnect||(this._timeConnect=d.connect(c,"onTimeExtentChange",this,
this._timeChangeHandler))):(this._mapTimeExtent=null,d.disconnect(this._timeConnect),this._timeConnect=null)},_timeChangeHandler:function(a){this._mapTimeExtent=a;(a=this._mode)&&a.propertyChangeHandler(0)},_getOffsettedTE:function(a){var c=this._timeOffset,b=this._timeOffsetUnits;return a&&c&&b?a.offset(-1*c,b):a},_getTimeOverlap:function(a,c){return a&&c?a.intersection(c):a||c},_getTimeFilter:function(a){var c,b=this.getTimeDefinition();if(b&&(c=this._getTimeOverlap(b,null),!c))return[!1];if(a){if(a=
c?this._getTimeOverlap(a,c):a,!a)return[!1]}else a=c;return[!0,a]},_getAttributeFilter:function(a){var c=this.getDefinitionExpression();return a?c?"("+c+") AND ("+a+")":a:c},_applyQueryFilters:function(a,c){if(a.where=this._getAttributeFilter(a.where),a.maxAllowableOffset||(a.maxAllowableOffset=this._maxOffset),a.quantizationParameters=this._quantizationParameters,c&&this.supportsAdvancedQueries&&(a.orderByFields=a.orderByFields||this.getOrderByFields()),this.timeInfo){var b=this._getTimeFilter(a.timeExtent);
if(!b[0])return!1;a.timeExtent=b[1]}return!0},_add:function(a){var c=this._selectionSymbol,b=a.attributes,e=this.visibilityField;return c&&this._isSelOnly&&a.setSymbol(c),e&&b&&b.hasOwnProperty(e)&&a[b[e]?"show":"hide"](),this.add.apply(this,arguments)},_remove:function(){return this.remove.apply(this,arguments)},_canDoClientSideQuery:function(a){var c,b=[],e=this._map;if(!(this._isTable||!e&&!this._collection||a.text||a.where&&a.where!==this.getDefinitionExpression()||a.orderByFields&&a.orderByFields.length&&
(c=this.getOrderByFields()||[])&&a.orderByFields.join()!==c.join()||a.outStatistics||a.returnDistinctValues)){c=this._isSnapshot;var d=this._isSelOnly,g=a.geometry;if(g){if(d||a.spatialRelationship!==K.SPATIAL_REL_INTERSECTS||"extent"!==g.type||!c&&!e.extent.contains(g))return;b.push(1)}if(e=a.objectIds){if(!c){for(var k=e.length,n=this._mode,m=0,g=0;k>g;g++)n._getFeature(e[g])&&m++;if(m!==k)return}b.push(2)}if(this.timeInfo)if(a=a.timeExtent,e=this._mapTimeExtent,c)a&&b.push(3);else if(d){if(a)return}else if(e)if(-1!==
f.indexOf(b,2))a&&b.push(3);else{if(-1===f.indexOf(b,1))return;a==e&&b.push(3)}else if(0<b.length)a&&b.push(3);else if(a)return;return 0<b.length?b:null}},_getAbsMid:function(a){return h.toAbsMid?h.toAbsMid(a):l.id.replace(/\/[^\/]*$/gi,"/")+a},_doQuery:function(a,c,e){var d=[],g=this.objectIdField,k=this,n=new m,h=new m,t=this.graphics;if(-1!==f.indexOf(c,1)){var r,u=this.spatialIndex||this._map&&this._map.spatialIndex,q=a.geometry._normalize(null,!0);null==u&&qa.autoSpatialIndexing?r=(this._map||
this).addPlugin(this._getAbsMid("../plugins/spatialIndex")).then(b.hitch(this,b.partial(this._getFromIndex,q,u)),function(a){h.resolve(b.hitch(this,b.partial(this._filterByExtent,t,q)))}):u&&(r=this._getFromIndex(q,u));r?r.then(function(a){for(var c=0;c<a.length;c++)a[c].results&&(d=d.concat(a[c].results));h.resolve(d)}).otherwise(function(a){h.reject(a)}):h.resolve(this._filterByExtent(t,q))}else h.resolve(t);return h.then(function(b){if(d=b,-1!==f.indexOf(c,2)){var m=a.objectIds;d=f.filter(d,function(a){return-1<
f.indexOf(m,a.attributes[g])})}-1!==f.indexOf(c,3)&&k.timeInfo&&(b=a.timeExtent,d=k._filterByTime(d,b.startTime,b.endTime).match);e&&(d=f.map(d,function(a){return a.attributes[g]},this));n.resolve(d)}),n},_getFromIndex:function(a,c){c=c||this.spatialIndex||this._map.spatialIndex;a instanceof Array||(a=[a]);var b=this.id;return u(f.map(a,function(a){return c.intersects(a,b)}))},_filterByExtent:function(a,c){for(var b=[],e=0,d=a.length;d>e;e++){var g=a[e],f=g.geometry;f&&(this.normalization&&c.length?
(c[0].intersects(f)||c[1].intersects(f))&&b.push(g):c.intersects(f)&&b.push(g))}return b},_filterByTime:function(a,c,b){var e,d=this._startTimeField,g=this._endTimeField;this._twoTimeFields||(e=d||g);var f,k,n,m=t.isDefined,h=[],r=[],u=a.length;if(c=c?c.getTime():-(1/0),b=b?b.getTime():1/0,e)for(f=0;u>f;f++)k=a[f],n=k.attributes,d=n[e],d>=c&&b>=d?h.push(k):r.push(k);else for(f=0;u>f;f++)k=a[f],n=k.attributes,e=n[d],n=n[g],e=m(e)?e:-(1/0),n=m(n)?n:1/0,e>=c&&b>=e||n>=c&&b>=n||c>=e&&n>=b?h.push(k):r.push(k);
return{match:h,noMatch:r}},_getSizeVariables:function(a){return a&&f.filter(a.getVisualVariablesForType("sizeInfo",!1),function(a){return!(!a.field&&!a.valueExpression)})},_needClientSideSorting:function(a){return this._collection?!(!a||!a.length):f.some(a,function(a){return!!a.valueExpression})},_sortFeatures:function(a){var c=this.renderer,b=this._getSizeVariables(c);if(a&&1<a.length&&this._needClientSideSorting(b)){var e=b[0],d=this;a.sort(function(a,b){var g=c._getDataValue(a,e,"sizeInfo",null,
d),f=c._getDataValue(b,e,"sizeInfo",null,d);return null==g?-1:null==f?1:f-g})}return a},_resolve:function(a,c,b,e,d){c&&this[c].apply(this,a);b&&b.apply(null,a);e&&y._resDfd(e,a,d)},_getShallowClone:function(a){var c,b=new K;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},_query:function(a,c,b,e,d){var g,k,n=this,h=this._map,t=new m(y._dfdCanceller),u=b;if("executeRelationshipQuery"!==a){var u=this._getShallowClone(b),q=this.getOutFields();u.outFields||(u.outFields=q);u.outFields&&u.outFields.length&&
(k=-1<f.indexOf(q,"*")?!1:!f.every(u.outFields,function(a){return-1<f.indexOf(q,a)}));u.returnGeometry=b.hasOwnProperty("returnGeometry")?b.returnGeometry:!b.outStatistics;u.returnGeometry&&(u.multipatchOption=this.multipatchOption);var l;h&&(b=h&&h.spatialReference,(h=u.outSpatialReference)?g=!h.equals(b):u.outSpatialReference=new z(b.toJson()));if(!this._applyQueryFilters(u,"execute"===a&&!u.outStatistics)){switch(a){case "execute":l=new J({features:[]});break;case "executeForIds":l=[];break;case "executeForCount":l=
0;break;case "executeForExtent":l={}}return this._resolve([l],c,e,t),t}if(b="executeForExtent"!==a&&!g&&!k&&this._canDoClientSideQuery(u))return t._pendingDfd=r(this._doQuery(u,b,"executeForIds"===a||"executeForCount"===a)),t._pendingDfd.then(function(b){switch(a){case "execute":l=new J;l.features=b;break;case "executeForIds":l=b;break;case "executeForCount":l=b.length}n._resolve([l],c,e,t)}),t}if(this._collection)return this._resolve([Error("FeatureLayer::_query - "+this.invalidParams)],null,d,t,
!0),t;this._ts&&(u._ts=(new Date).getTime());return(t._pendingDfd=this._task[a](u)).addCallbacks(function(b){var d=!!u.outStatistics||g||k;if("execute"===a||"executeRelationshipQuery"===a){var f,m;if("execute"===a)for(f=b.features,m=f.length,--m;0<=m;m--){if(f[m]._layer=n,!d&&!n._isTable){var h=n._mode._getFeature(f[m].attributes[n.objectIdField]);h&&f.splice(m,1,h)}}else for(h in b)if(b.hasOwnProperty(h))for(f=b[h].features,m=f.length,--m;0<=m;m--)f[m]._layer=n}n._resolve([b],c,e,t)},function(a){n._resolve([a],
null,d,t,!0)}),t},_convertFeaturesToJson:function(a,c,e,d){var g,n=[],m=this._selectionSymbol,h=this.visibilityField,t=this.objectIdField;this.loaded&&(e||d)&&(g=f.filter(this.fields,function(a){return!1===a.editable&&(!d||a.name!==t)}));for(e=0;e<a.length;e++){var r=a[e],u={},q=r.geometry,l=r.attributes,v=r.symbol;!q||d&&this.loaded&&!this.allowGeometryUpdates||(u.geometry=q.toJson());h?(u.attributes=l=b.mixin({},l),l[h]=r.visible?1:0):l&&(u.attributes=b.mixin({},l));u.attributes&&g&&g.length&&f.forEach(g,
function(a){delete u.attributes[a.name]});v&&v!==m&&(u.symbol=v.toJson());n.push(u)}return c?n:k.toJson(n)},_selectHandler:function(a,c,b,e,d){var g;e=ca;switch(c){case e.SELECTION_NEW:this.clearSelection(!0);g=!0;break;case e.SELECTION_ADD:g=!0;break;case e.SELECTION_SUBTRACT:g=!1}var f,k;e=a.features;var n=this._mode,m=[],h=this.objectIdField;if(g)for(g=0;g<e.length;g++)f=e[g],k=f.attributes[h],f=n._addFeatureIIf(k,f),m.push(f),this._selectFeatureIIf(k,f,n);else for(g=0;g<e.length;g++)f=e[g],k=
f.attributes[h],this._unSelectFeatureIIf(k,n),k=n._removeFeatureIIf(k),m.push(k||f);this._isSelOnly&&n._applyTimeFilter(!0);this._hasPartialSelectedFeatures=!!a.exceededTransferLimit;this._resolve([m,c,a.exceededTransferLimit?{queryLimitExceeded:!0}:null],"onSelectionComplete",b,d);a.exceededTransferLimit&&this.onQueryLimitExceeded()},_selectFeatureIIf:function(a,c,b){var e=this._selectedFeatures,d=e[a];return d||(b._incRefCount(a),e[a]=c,this._isTable||(this._setSelectSymbol(c),c.attr("data-selected",
""))),d||c},_unSelectFeatureIIf:function(a,c){var b=this._selectedFeatures[a];return b&&(c._decRefCount(a),delete this._selectedFeatures[a],this._isTable||(this._setUnSelectSymbol(b),b.attr("data-selected"))),b},_isSelected:function(a){},_setSelectSymbol:function(a){var c=this._selectionSymbol;c&&!this._isSelOnly&&a.setSymbol(c)},_setUnSelectSymbol:function(a){var c=this._selectionSymbol;c&&!this._isSelOnly&&c===a.symbol&&a.setSymbol(null,!0)},_getOutFields:function(){var a=[this.objectIdField,this.typeIdField,
this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields).concat(this.dataAttributes),a=f.filter(a,function(a,c,b){return!!a&&f.indexOf(b,a)===c}),c=b.clone(this._outFields);return c?-1!==f.indexOf(c,"*")?c:(f.forEach(a,function(a){-1===f.indexOf(c,a)&&c.push(a)}),c):a},_checkFields:function(a){var c=a||this._getOutFields();(f.forEach(c,function(a){"*"!==a&&this._getField(a)},this),a||this._isTable||this._fserver||this._collection||this._isStream)||
f.some(this.fields,function(a){return a&&"esriFieldTypeGeometry"===a.type?!0:!1})},_fixFieldCase:function(a,c,e){var d,g=a&&a[c];return g&&!b.isFunction(g)&&(d=!this._getField(g)&&this._getField(g,!0),d&&(g=a[c]=d.name),e&&e.push(g)),g},_fixRendererFields:function(){var a=this.renderer;if(this._orderBy=null,a&&0<this.fields.length){var c,e=[],a=f.filter([a,a.observationRenderer,a.latestObservationRenderer,a.trackRenderer],t.isDefined),d=[].concat(a);f.forEach(a,function(a){f.forEach(a.rendererInfos,
function(a){a.renderer&&d.push(a.renderer)})});f.forEach(d,function(a){this._fixFieldCase(a,"attributeField",e);this._fixFieldCase(a,"attributeField2",e);this._fixFieldCase(a,"attributeField3",e);this._fixFieldCase(a.rotationInfo,"field",e);(c=this._fixFieldCase(a.sizeInfo,"field",e))&&(this._orderBy||(this._orderBy=[c+" DESC"]));this._fixFieldCase(a.sizeInfo,"normalizationField",e);this._fixFieldCase(a.colorInfo,"field",e);this._fixFieldCase(a.colorInfo,"normalizationField",e);this._fixFieldCase(a.field,
"field",e);this._fixFieldCase(a.opacityInfo,"field",e);this._fixFieldCase(a.opacityInfo,"normalizationField",e);f.forEach(a.visualVariables,function(a){c=this._fixFieldCase(a,"field",e);"sizeInfo"===a.type&&c&&!this._orderBy&&(this._orderBy=[c+" DESC"]);this._fixFieldCase(a,"normalizationField",e)},this);this._orderBy||!a.addBreak||b.isFunction(a.attributeField)||!a.backgroundFillSymbol&&!this._hasSizeDiff(a)||(this._orderBy=[a.attributeField+" DESC"])},this);this._rendererFields=f.filter(e,t.isDefined)}},
_hasSizeDiff:function(a){var c,b,e=Number.MAX_VALUE,d=-Number.MAX_VALUE;return f.forEach(a.infos,function(a){if(b=a.symbol){switch(c=0,b.type){case "simplemarkersymbol":c=b.size;break;case "picturemarkersymbol":c=(b.width+b.height)/2;break;case "simplelinesymbol":case "cartographiclinesymbol":c=b.width;break;case "simplefillsymbol":case "picturefillsymbol":c=b.outline&&b.outline.width}c&&(e=Math.min(e,c),d=Math.max(d,c))}}),e!==Number.MAX_VALUE&&d!==-Number.MAX_VALUE&&1<Math.abs(d-e)},getOrderByFields:function(){var a=
this.orderByFields||this._orderBy;return this.supportsAdvancedQueries&&a?f.filter(a,function(a){return a=a.split(" ")[0],!!this._getField(a,!0)},this):null},_getField:function(a,c){var b=this.fields;if(!b||0===b.length)return null;var e;return c&&(a=a.toLowerCase()),f.some(b,function(b){var d=!1;return d=c?b&&b.name.toLowerCase()===a?!0:!1:b&&b.name===a?!0:!1,d&&(e=b),d}),e},_getDateOpts:function(){this._dtOpts||(this._dtOpts={properties:f.map(f.filter(this.fields,function(a){return!(!a||"esriFieldTypeDate"!==
a.type)}),function(a){return a.name})});return this._dtOpts},_applyNormalized:function(a,c){a&&c&&f.forEach(a,function(a,b){a&&c[b]&&a.setGeometry(c[b])})},_editHandler:function(a,c,e,d,g,k){var n,m,h,t,r;g=a.addResults;var u=a.updateResults;a=a.deleteResults;var q=this.objectIdField,l=this._mode,v=this._isTable;n=this.editFieldsInfo;var w=this.getOutFields()||[],x=n&&n.creatorField,y=n&&n.creationDateField,C=n&&n.editorField,z=n&&n.editDateField;n=n&&n.realm;-1===f.indexOf(w,"*")&&(x&&-1===f.indexOf(w,
x)&&(x=null),y&&-1===f.indexOf(w,y)&&(y=null),C&&-1===f.indexOf(w,C)&&(C=null),z&&-1===f.indexOf(w,z)&&(z=null));var w=y||z?(new Date).getTime():null,A=x||C?this.getUserId():void 0;if(A&&n&&(A=A+"@"+n),g)for(n=0;n<g.length;n++)if(g[n]=new W(g[n]),!v&&(m=g[n],m.success))h=m.objectId,t=c[n],(r=t._graphicsLayer)&&r!==this&&r.remove(t),r=t.attributes||{},r[q]=h,x&&(r[x]=A),C&&(r[C]=A),y&&(r[y]=w),z&&(r[z]=w),t.setAttributes(r),l._init&&l.drawFeature(t);if(u)for(n=0;n<u.length;n++)if(u[n]=new W(u[n]),
!v&&(m=u[n],m.success))h=m.objectId,t=e[h],(c=l._getFeature(h))&&(c.geometry!==t.geometry&&t.geometry&&c.setGeometry(M.fromJson(t.geometry.toJson())),c.attributes!==t.attributes&&t.attributes&&c.setAttributes(b.mixin(c.attributes,t.attributes)),this._repaint(c,h)),t=c||t,r=t.attributes||{},C&&(r[C]=A),z&&(r[z]=w),t.setAttributes(r);if(a){e=[];for(n=0;n<a.length;n++)a[n]=new W(a[n]),v||(m=a[n],m.success&&(h=m.objectId,t=l._getFeature(h),t&&(this._unSelectFeatureIIf(h,l)&&e.push(t),t._count=0,l._removeFeatureIIf(h))));
0<e.length&&this.onSelectionComplete(e,ca.SELECTION_SUBTRACT)}this._resolve([g,u,a],"onEditsComplete",d,k)},_sendAttachment:function(a,c,e,d,g){var f=this;return w({url:this._url.path+"/"+c+"/"+("add"===a?"addAttachment":"updateAttachment"),form:e,content:b.mixin(this._url.query,{f:"json",token:this._getToken()||void 0}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(b){var e="add"===a?"onAddAttachmentComplete":"onUpdateAttachmentComplete";b=new W(b["add"===a?"addAttachmentResult":
"updateAttachmentResult"]);return b.attachmentId=b.objectId,b.objectId=c,f._resolve([b],e,d),b}).addErrback(function(a){f._resolve([a],null,g,null,!0)})},_repaint:function(a,c,b){c=t.isDefined(c)?c:a.attributes[this.objectIdField];c in this._selectedFeatures&&this._selectionSymbol||a.setSymbol(a.symbol,b)},_getKind:function(a){var c=this._trackManager;return c&&c.isLatestObservation(a)?1:0}});return b.mixin(ca,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,
MODE_AUTO:6,MODE_STREAM:7,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"}),N._createWrappers(ca),e("extend-esri")&&b.setObject("layers.FeatureLayer",ca,v),ca})},"esri/renderers/SimpleRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer".split(" "),function(h,l,a,d,b,f,k){h=h(k,{declaredClass:"esri.renderer.SimpleRenderer",constructor:function(a){if(a&&
!a.declaredClass){var b=a;this.symbol=(a=b.symbol)&&(a.declaredClass?a:f.fromJson(a));this.label=b.label;this.description=b.description}else this.symbol=a},getSymbol:function(a){return this.symbol},toJson:function(){var a=l.mixin(this.inherited(arguments),{type:"simple",label:this.label,description:this.description,symbol:this.symbol&&this.symbol.toJson()});return b.fixJson(a)}});return a("extend-esri")&&l.setObject("renderer.SimpleRenderer",h,d),h})},"esri/renderers/Renderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojox/gfx/_base ../kernel ../Color ./arcadeUtils".split(" "),
function(h,l,a,d,b,f,k,m){var g=Math.PI,e=1;h=h(null,{declaredClass:"esri.renderer.Renderer",constructor:function(a){if(this._cache={},a&&!a.declaredClass){if(this.rotationInfo=a.rotationInfo,!this.rotationInfo){var b=a.rotationType,e=a.rotationExpression;(b||e)&&(this.rotationInfo={type:b,expression:e})}this.setRotationInfo(this.rotationInfo);this.setSizeInfo(this._readSizeInfo(a.sizeInfo));this.setColorInfo(this._readColorInfo(a.colorInfo));this.setOpacityInfo(this._readOpacityInfo(a.transparencyInfo));
this.setVisualVariables(this._readVariables(a.visualVariables));this.setAuthoringInfo(a.authoringInfo)}this.getSymbol=l.hitch(this,this.getSymbol)},getSymbol:function(a){},_readSizeInfo:function(c){if(c){var e=c.minSize,d=c.maxSize;e&&(c.minSize="number"==typeof e?b.pt2px(e):this._readSizeInfo(e));d&&(c.maxSize="number"==typeof d?b.pt2px(d):this._readSizeInfo(d));c.stops&&a.forEach(c.stops,function(a){a.size&&"number"==typeof a.size&&(a.size=b.pt2px(a.size))})}return c},_readColorInfo:function(c){return c&&
(a.forEach(c.colors,function(a,b){l.isArray(a)&&(c.colors[b]=k.toDojoColor(a))}),a.forEach(c.stops,function(a,b){a.color&&l.isArray(a.color)&&(c.stops[b].color=k.toDojoColor(a.color))})),c},_readOpacityInfo:function(c){var b;return c&&(b=l.mixin({},c),b.transparencyValues&&(b.opacityValues=a.map(b.transparencyValues,function(a){return 1-a/100}),delete b.transparencyValues),b.stops&&(b.stops=a.map(b.stops,function(a){return a=l.mixin({},a),a.opacity=1-a.transparency/100,delete a.transparency,a}))),
b},_readVariables:function(c){return c&&(c=a.map(c,function(a){return"sizeInfo"===a.type?a=this._readSizeInfo(a):"colorInfo"===a.type?a=this._readColorInfo(a):"transparencyInfo"===a.type&&(a=this._readOpacityInfo(a),a.type="opacityInfo"),a},this)),c},setAuthoringInfo:function(a){this.authoringInfo=a},setRotationInfo:function(a){if(a=this.rotationInfo="string"==typeof a?{field:a}:a){if(a.expression&&!l.isFunction(a.expression)&&!a.field){var b=a.expression.match(this.rotationRE);b&&b[1]&&(a.field=
b[1])}a.rotationType=a.type}return this},rotationRE:/^\[([^\]]+)\]$/i,_processRotationInfo:function(a){return this._createCache(a)},getRotationAngle:function(a,b){var e=this._getVarInfo(b&&b.rotationInfo,"rotationInfo"),d=e.variable,g=this._cache[e.cacheKey],e="arithmetic"===this._getRotationType(d),d=d.field,g=g&&g.compiledFunc,f=a.attributes,k=null;return(d||g)&&(g?k=m.executeFunction(g,m.createExecContext(a,a._getView())):l.isFunction(d)?k=d.apply(this,arguments):f&&(k=f[d]||0),k="number"!=typeof k||
isNaN(k)?null:(k+(e?-90:0))*(e?-1:1)),k},_getRotationType:function(a){return a&&("rotationInfo"===a.type?a.rotationType:a.type)},_getDataValue:function(a,b,e,d,g){d||(d=this._getVarInfo(b,e),b=d.variable,d=this._cache[d.cacheKey],"sizeInfo"===e&&(d=d.root));return a._getDataValue(b,d,m,g)},setVisualVariables:function(c){var b=this._cache;a.forEach(this.visualVariables,function(a,c){b.hasOwnProperty(c)&&(b[c]=null)},this);this.visualVariables=c;return a.some(c,function(a){return!!a.target})&&c.sort(function(a,
c){return a.target===c.target?0:a.target?1:-1}),a.forEach(c,function(a,c){"colorInfo"===a.type?b[c]=this._processColorInfo(a):"opacityInfo"===a.type?b[c]=this._processOpacityInfo(a):"sizeInfo"===a.type?b[c]=this._processSizeInfo(a):"rotationInfo"===a.type&&(b[c]=this._processRotationInfo(a))},this),this},getVisualVariableValues:function(c){var b,e=this.visualVariables;return e&&(b=a.map(e,function(a){var b;switch(a.type){case "sizeInfo":b=this.getSize(c,{sizeInfo:a});break;case "colorInfo":b=this.getColor(c,
{colorInfo:a});break;case "opacityInfo":b=this.getOpacity(c,{opacityInfo:a});break;case "rotationInfo":b=this.getRotationAngle(c,{rotationInfo:a})}return{variable:a,value:b}},this)),b},hasVisualVariables:function(a,b){return a?!!this.getVisualVariablesForType(a,b):!!(this.getVisualVariablesForType("sizeInfo",b)||this.getVisualVariablesForType("colorInfo",b)||this.getVisualVariablesForType("opacityInfo",b)||this.getVisualVariablesForType("rotationInfo",b))},getVisualVariablesForType:function(c,b){var e,
d=this.visualVariables;return!b&&this[c]?("rotationInfo"===c&&(this[c].rotationType=this[c].type),e=[this[c]]):d&&(e=a.filter(d,function(a){return a.type===c&&("string"==typeof b?a.target===b:!1===b?!a.target:!0)}),e&&0===e.length&&(e=void 0)),e},setSizeInfo:function(a){return this.sizeInfo=this.proportionalSymbolInfo=a,this._cache.sizeInfo=this._processSizeInfo(a),this},_processSizeInfo:function(a){return a&&{root:this._createCache(a),minSize:this._createCache(a.minSize),maxSize:this._createCache(a.maxSize)}},
_convertExpressionToArcade:function(a){a&&a.expression&&(a.valueExpression="$view.scale")},_getVarInfo:function(c,b){var e;return c&&c.type===b?(e=a.indexOf(this.visualVariables,c),c=this.visualVariables[e]):(e=b,c=this[b]),{variable:c,cacheKey:e}},setProportionalSymbolInfo:function(a){return this.setSizeInfo(a),this},getSize:function(a,b){var e=this._getVarInfo(b&&b.sizeInfo,"sizeInfo"),d=e.variable,e=this._cache[e.cacheKey],g=null;if(d)var f=d.minSize,g=d.maxSize,f="object"==typeof f&&f?this._getSize(a,
f,e&&e.minSize,b):f,g="object"==typeof g&&g?this._getSize(a,g,e&&e.maxSize,b):g,g=this._getSize(a,d,e&&e.root,b,[f,g]);return g},_getSize:function(a,b,e,d,f){var k=b.stops,m=0,h=e&&e.hasExpr,l=e&&e.ipData,y=e&&e.isScaleDriven,z="object"==typeof a&&!!a,A="number"==typeof a?a:null;if(b.field||y||h){var B,C=d&&d.scale,h=f?f[0]:b.minSize;f=f?f[1]:b.maxSize;var D=b.minDataValue,E=b.maxDataValue,F=b.valueUnit||"unknown",H=b.valueRepresentation,G=b.scaleBy,K=d&&d.shape;if(y?A=C:"number"!=typeof A&&z&&(A=
this._getDataValue(a,b,null,e)),null==A)return null;if(k){var J,I;B=this._lookupData(A,l);A=B[0];h=B[1];A===h?m=k[A].size:(J=k[A].size,I=k[h].size,m=J+(I-J)*B[2])}else null!=h&&null!=f&&null!=D&&null!=E?D>=A?m=h:A>=E?m=f:(B=(A-D)/(E-D),"area"===G&&K)?(k=(m="circle"===K)?g*Math.pow(h/2,2):h*h,J=m?g*Math.pow(f/2,2):f*f,k+=B*(J-k),m=m?2*Math.sqrt(k/g):Math.sqrt(k)):m=h+B*(f-h):"unknown"===F?null!=h&&null!=D&&(h&&D?(B=A/D,m="circle"===K?2*Math.sqrt(B*Math.pow(h/2,2)):"square"===K||"diamond"===K||"image"===
K?Math.sqrt(B*Math.pow(h,2)):B*h):m=A+(h||D),m=h>m?h:m,null!=f&&m>f&&(m=f)):(k=(d&&d.resolution?d.resolution:1)*this._meterIn[F],"area"===H?(m=Math.sqrt(A/g)/k,m*=2):(m=A/k,("radius"===H||"distance"===H)&&(m*=2)),null!=h&&h>m&&(m=h),null!=f&&m>f&&(m=f))}else m=k&&k[0]&&k[0].size,null==m&&(m=b.minSize);return isNaN(m)?0:m},getSizeRangeAtScale:function(a,b){var e,d=this._getVarInfo(a,"sizeInfo"),g=this._cache[d.cacheKey],f={scale:b};if(a=d.variable,a&&b){var k,m,d=a.minSize,h=a.maxSize,l=a.stops;if(l&&
l.length?(k=l[0].size,m=l[l.length-1].size):(k="object"==typeof d&&d?this._getSize({},d,g&&g.minSize,f):d,m="object"==typeof h&&h?this._getSize({},h,g&&g.maxSize,f):h),null!=k||null!=m)k>m&&(e=m,m=k,k=e),e={minSize:k,maxSize:m}}return e},setColorInfo:function(a){return this.colorInfo=a,this._cache.colorInfo=this._processColorInfo(a),this},prepareForViewChange:function(a){var b;a=a||this._cache;for(b in a){var d=a[b];a.hasOwnProperty(b)&&d&&"object"==typeof d&&(d.hasOwnProperty("version")?d.dependsOnView&&
(d.version=e++):this.prepareForViewChange(d))}},_viewScaleRE:/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,_createCache:function(a){var b=a&&a.valueExpression,d=m.createSyntaxTree(b),g=m.createFunction(d),f=!(!a||!a.expression)||this._viewScaleRE.test(b);return{ipData:this._interpolateData(a),hasExpr:!!b,compiledFunc:g,isScaleDriven:f,dependsOnView:d?m.dependsOnView(d):!1,version:e++}},_processColorInfo:function(c){return c&&(a.forEach(c.colors,function(a,b){l.isArray(a)&&(c.colors[b]=new k(a))}),a.forEach(c.stops,
function(a,b){a.color&&l.isArray(a.color)&&(c.stops[b].color=new k(a.color))})),this._createCache(c)},getColor:function(a,b){var e=this._getVarInfo(b&&b.colorInfo,"colorInfo");return this._getColorComponent(a,e.variable,this._cache[e.cacheKey])},setOpacityInfo:function(a){return this.opacityInfo=a,this._cache.opacityInfo=this._processOpacityInfo(a),this},_processOpacityInfo:function(a){return this._createCache(a)},getOpacity:function(a,b){var e=this._getVarInfo(b&&b.opacityInfo,"opacityInfo");return this._getColorComponent(a,
e.variable,this._cache[e.cacheKey],!0)},_getColorComponent:function(a,b,e,d,g){var f,k="object"==typeof a&&!!a,h=k?a.attributes:null,x=b&&b.field,y="number"==typeof a,z=y?a:null,A=e&&e.hasExpr,B=e&&e.compiledFunc,C=e&&e.ipData;if(x||A){var D=b.normalizationField,E=h?parseFloat(h[D]):void 0;"number"!=typeof z&&k&&(A?z=m.executeFunction(B,m.createExecContext(a,a._getView())):l.isFunction(x)?z=x.apply(this,arguments):h&&(z=h[x]));null==z||isNaN(z)||"number"!=typeof z||D&&!y&&(isNaN(E)||0===E)||(isNaN(E)||
y||(z/=E),f=d?this._getOpacity(z,b,C):this._getColor(z,b,C))}else b&&(k=b.stops,d?(f=k&&k[0]&&k[0].opacity,null==f&&(f=b.opacityValues&&b.opacityValues[0])):f=k&&k[0]&&k[0].color||b.colors&&b.colors[0]);return g&&(g.data=z,g.value=f),g||f},_interpolateData:function(c){var b;if(c)if(c.colors||c.opacityValues){var e=(c.colors||c.opacityValues).length,d=c.minDataValue,g=(c.maxDataValue-d)/(e-1);b=[];for(c=0;e>c;c++)b[c]=d+c*g}else c.stops&&(b=a.map(c.stops,function(a){return a.value}));return b},_getOpacity:function(a,
b,e){var d;a=this._lookupData(a,e);if(b=b||this.opacityInfo,a){var g,f;e=a[0];var k=a[1];e===k?d=this._getOpacValue(b,e):(g=this._getOpacValue(b,e),f=this._getOpacValue(b,k),d=g+(f-g)*a[2])}return d},_getOpacValue:function(a,b){return a.opacityValues?a.opacityValues[b]:a.stops[b].opacity},_getColor:function(a,b,e){var d;a=this._lookupData(a,e);if(b=b||this.colorInfo,a)d=a[0],e=a[1],d=d===e?this._getColorObj(b,d):k.blendColors(this._getColorObj(b,d),this._getColorObj(b,e),a[2]);return d},_getColorObj:function(a,
b){return a.colors?a.colors[b]:a.stops[b].color},_lookupData:function(c,b){var e;if(b){var d=0,g=b.length-1;a.some(b,function(a,b){return a>c?(g=b,!0):(d=b,!1)});e=[d,g,(c-b[d])/(b[g]-b[d])]}return e},_meterIn:{inches:1/.0254,feet:1/.3048,yards:1/.9144,miles:1/1609.344,"nautical-miles":1/1852,millimeters:1E3,centimeters:100,decimeters:10,meters:1,kilometers:.001,"decimal-degrees":180/20015077},_writeSizeInfo:function(c){if(c){c=l.mixin({},c);this._convertExpressionToArcade(c);var e=c.minSize,d=c.maxSize;
e&&(c.minSize="number"==typeof e?b.px2pt(e):this._writeSizeInfo(e));d&&(c.maxSize="number"==typeof d?b.px2pt(d):this._writeSizeInfo(d));(e=c.legendOptions)&&(c.legendOptions=l.mixin({},e),e=e.customValues,e&&(c.legendOptions.customValues=e.slice(0)));c.stops&&(c.stops=a.map(c.stops,function(a){return a=l.mixin({},a),a.size&&"number"==typeof a.size&&(a.size=b.px2pt(a.size)),a}))}return c},_writeColorInfo:function(c){return c&&(c=l.mixin({},c),c.colors&&(c.colors=a.map(c.colors,function(a){return k.toJsonColor(a)})),
c.stops&&(c.stops=a.map(c.stops,function(a){return a=l.mixin({},a),a.color&&(a.color=k.toJsonColor(a.color)),a})),c.legendOptions&&(c.legendOptions=l.mixin({},c.legendOptions))),c},_writeOpacityInfo:function(c){var b;return c&&(b=l.mixin({},c),b.opacityValues&&(b.transparencyValues=a.map(b.opacityValues,function(a){return 100*(1-a)}),delete b.opacityValues),b.stops&&(b.stops=a.map(b.stops,function(a){return a=l.mixin({},a),a.transparency=100*(1-a.opacity),delete a.opacity,a})),b.legendOptions&&(b.legendOptions=
l.mixin({},b.legendOptions))),b},toJson:function(){var c,b=this.visualVariables,e=l.clone(this.authoringInfo),d=this.getVisualVariablesForType("rotationInfo",!1),g=(d=d&&d[0])&&d.field;return d&&d===this.rotationInfo&&(c=d.expression||g&&(l.isFunction(g)?g:"["+g+"]")),b&&(b=a.map(b,function(a){return"sizeInfo"===a.type?a=this._writeSizeInfo(a):"colorInfo"===a.type?a=this._writeColorInfo(a):"opacityInfo"===a.type?(a=this._writeOpacityInfo(a),a.type="transparencyInfo"):"rotationInfo"===a.type&&(a=l.mixin({},
a)),a},this)),e&&a.forEach(e.visualVariables,function(a){"opacityInfo"===a.type&&(a.type="transparencyInfo")}),{rotationType:c&&(this._getRotationType(d)||"geographic"),rotationExpression:c,colorInfo:this._writeColorInfo(this.colorInfo),transparencyInfo:this._writeOpacityInfo(this.opacityInfo),sizeInfo:this._writeSizeInfo(this.sizeInfo),visualVariables:b,authoringInfo:e}}});return d("extend-esri")&&l.setObject("renderer.Renderer",h,f),h})},"esri/renderers/arcadeUtils":function(){define(["dojo/_base/lang",
"dojo/_base/array","dojo/has","../kernel","../arcade/arcade"],function(h,l,a,d,b){var f={vars:{$feature:"any",$view:"any"}},k=/^\$feature\./i,m={createSyntaxTree:function(a,e){e=e||h.clone(f);var c;try{c=a?b.parseScript(a,e):null}catch(d){c=null}return c},createFunction:function(a,e){e=e||h.clone(f);var c,d="string"==typeof a?m.createSyntaxTree(a,e):a;try{c=d?b.compileScript(d,e):null}catch(k){c=null}return c},createExecContext:function(a,e){return{vars:{$feature:b.constructFeature(a),$view:e}}},
evalSyntaxTree:function(a,e){return b.executeScript(a,e,-1)},executeFunction:function(a,b){return a?a(b,-1):null},extractFieldNames:function(a,e){var c="string"==typeof a?m.createSyntaxTree(a,e):a,c=b.extractFieldLiterals(c),d=[];return l.forEach(c,function(a){k.test(a)&&(a=a.replace(k,""),d.push(a))}),d.sort(),l.filter(d,function(a,c){return 0===c||d[c-1]!==a})},dependsOnView:function(a){return b.referencesMember(a,"$view")}};return a("extend-esri")&&h.setObject("renderer.arcadeUtils",m,d),m})},
"esri/arcade/arcade":function(){define("require exports ./arcadeRuntime ./parser ./Feature ./arcadeCompiler dojo/has".split(" "),function(h,l,a,d,b,f,k){l.compileScript=function(b,d){return k("csp-restrictions")?function(e,c){return a.executeScript(b,e,c)}:f.compileScript(b,d)};l.constructFeature=function(a){return b.fromFeature(a)};l.parseScript=function(a){return d.parseScript(a)};l.validateScript=function(a,b){return d.validateScript(a,b,"simple")};l.scriptCheck=function(a,b,e){return d.scriptCheck(a,
b,e,"full")};l.parseAndExecuteScript=function(b,g,e){return a.executeScript(d.parseScript(b),g,e)};l.executeScript=function(b,d,e){return a.executeScript(b,d,e)};l.referencesMember=function(b,d){return a.referencesMember(b,d)};l.referencesFunction=function(b,d){return a.referencesFunction(b,d)};l.extractFieldLiterals=function(a,b){return void 0===b&&(b=!1),d.extractFieldLiterals(a,b)}})},"esri/arcade/arcadeRuntime":function(){define("require exports ../geometry/Polygon ../graphic ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./FunctionWrapper ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A){function B(a,c){for(var b=[],e=0;e<c.arguments.length;e++)b.push(D(a,c.arguments[e]));return b}function C(a,c,b){try{return b(a,c,B(a,c))}catch(e){throw e;}}function D(a,b){try{switch(b.type){case "EmptyStatement":return e.voidOperation;case "VariableDeclarator":var d=null===b.init?null:D(a,b.init);d===e.voidOperation&&(d=null);var g=b.id.name.toLowerCase();return null!==a.localScope?a.localScope[g]={value:d,valueset:!0,node:b.init}:a.globalScope[g]=
{value:d,valueset:!0,node:b.init},e.voidOperation;case "VariableDeclaration":for(var f=0;f<b.declarations.length;f++)D(a,b.declarations[f]);return e.voidOperation;case "BlockStatement":var k;a:{for(var m=e.voidOperation,f=0;f<b.body.length;f++)if(m=D(a,b.body[f]),m instanceof e.ReturnResult||m===e.breakResult||m===e.continueResult){k=m;break a}k=m}return k;case "FunctionDeclaration":var h=b.id.name.toLowerCase();return a.globalScope[h]={valueset:!0,node:null,value:new r(b,a)},e.voidOperation;case "ReturnStatement":var t;
if(null===b.argument)t=new e.ReturnResult(e.voidOperation);else{var u=D(a,b.argument);t=new e.ReturnResult(u)}return t;case "IfStatement":var l;if("AssignmentExpression"===b.test.type||"UpdateExpression"===b.test.type)throw Error(c.nodeErrorMessage(b.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var v=D(a,b.test);if(!0===v)l=D(a,b.consequent);else if(!1===v)l=null!==b.alternate?D(a,b.alternate):e.voidOperation;else throw Error(c.nodeErrorMessage(b,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));
return l;case "ExpressionStatement":var w;if("AssignmentExpression"===b.expression.type||"UpdateExpression"===b.expression.type)w=D(a,b.expression);else{var x=D(a,b.expression);w=x===e.voidOperation?e.voidOperation:new e.ImplicitResult(x)}return w;case "AssignmentExpression":var y;var C=D(a,b.right),f=null,z="";if("MemberExpression"===b.left.type){if(f=D(a,b.left.object),z=!0===b.left.computed?D(a,b.left.property):b.left.property.name,e.isArray(f)){if(!e.isNumber(z))throw Error("Invalid Parameter");
if(0>z&&(z=f.length+z),0>z||z>f.length)throw Error("Assignment outside of array bounds");if(z===f.length&&"\x3d"!==b.operator)throw Error("Invalid Parameter");f[z]=F(C,b.operator,f[z],b)}else{if(f instanceof n){if(!1===e.isString(z))throw Error("Dictionary accessor must be a string");}else{if(!(f instanceof q))throw e.isImmutableArray(f)?Error("Array is Immutable"):Error("Invalid Parameter");if(!1===e.isString(z))throw Error("Feature accessor must be a string");}if(!0===f.hasField(z))f.setField(z,
F(C,b.operator,f.field(z),b));else{if("\x3d"!==b.operator)throw Error("Invalid Parameter");f.setField(z,F(C,b.operator,null,b))}}y=e.voidOperation}else if(f=b.left.name.toLowerCase(),null!==a.localScope&&void 0!==a.localScope[f])y=(a.localScope[f]={value:F(C,b.operator,a.localScope[f].value,b),valueset:!0,node:b.right},e.voidOperation);else if(void 0!==a.globalScope[f])y=(a.globalScope[f]={value:F(C,b.operator,a.globalScope[f].value,b),valueset:!0,node:b.right},e.voidOperation);else throw Error("Variable not recognised");
return y;case "UpdateExpression":var A,f=null;y="";if("MemberExpression"===b.argument.type){if(f=D(a,b.argument.object),y=!0===b.argument.computed?D(a,b.argument.property):b.argument.property.name,e.isArray(f)){if(!e.isNumber(y))throw Error("Invalid Parameter");if(0>y&&(y=f.length+y),0>y||y>=f.length)throw Error("Assignment outside of array bounds");A=e.toNumber(f[y]);f[y]="++"===b.operator?A+1:A-1}else{if(f instanceof n){if(!1===e.isString(y))throw Error("Dictionary accessor must be a string");}else{if(!(f instanceof
q))throw e.isImmutableArray(f)?Error("Array is Immutable"):Error("Invalid Parameter");if(!1===e.isString(y))throw Error("Feature accessor must be a string");}if(!0!==f.hasField(y))throw Error("Invalid Parameter");A=e.toNumber(f.field(y));f.setField(y,"++"===b.operator?A+1:A-1)}z=!1===b.prefix?A:"++"===b.operator?A+1:A-1}else if(f=b.argument.name.toLowerCase(),null!==a.localScope&&void 0!==a.localScope[f])z=(A=e.toNumber(a.localScope[f].value),a.localScope[f]={value:"++"===b.operator?A+1:A-1,valueset:!0,
node:b},!1===b.prefix?A:"++"===b.operator?A+1:A-1);else if(void 0!==a.globalScope[f])z=(A=e.toNumber(a.globalScope[f].value),a.globalScope[f]={value:"++"===b.operator?A+1:A-1,valueset:!0,node:b},!1===b.prefix?A:"++"===b.operator?A+1:A-1);else throw Error("Variable not recognised");return z;case "BreakStatement":return e.breakResult;case "ContinueStatement":return e.continueResult;case "ForStatement":null!==b.init&&D(a,b.init);f={testResult:!0,lastAction:e.voidOperation};do a:{y=a;C=b;z=f;if(null!==
C.test){if(z.testResult=D(y,C.test),!1===z.testResult)break a;if(!0!==z.testResult)throw Error(c.nodeErrorMessage(C,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));}z.lastAction=D(y,C.body);z.lastAction===e.breakResult?z.testResult=!1:z.lastAction instanceof e.ReturnResult?z.testResult=!1:null!==C.update&&D(y,C.update)}while(!0===f.testResult);return f.lastAction instanceof e.ReturnResult?f.lastAction:e.voidOperation;case "ForInStatement":return E(a,b);case "Identifier":var B;var H;try{var Q=b.name.toLowerCase();
if(null!==a.localScope&&void 0!==a.localScope[Q])B=(H=a.localScope[Q],!0===H.valueset?H.value:(H.value=D(a,H.node),H.valueset=!0,H.value));else if(void 0!==a.globalScope[Q])B=(H=a.globalScope[Q],!0===H.valueset?H.value:(H.value=D(a,H.node),H.valueset=!0,H.value));else throw Error(c.nodeErrorMessage(b,"RUNTIME","VARIABLENOTFOUND"));}catch(M){throw M;}return B;case "MemberExpression":return G(a,b);case "Literal":return b.value;case "ThisExpression":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));
case "CallExpression":return I(a,b);case "UnaryExpression":return K(a,b);case "BinaryExpression":return J(a,b);case "LogicalExpression":var L;a:try{if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)throw Error(c.nodeErrorMessage(b.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===b.right.type||"UpdateExpression"===b.right.type)throw Error(c.nodeErrorMessage(b.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var N=[D(a,b.left),D(a,b.right)],
O=N[0],W=N[1];if(!e.isBoolean(O)||!e.isBoolean(W))throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYBOOLEAN"));switch(b.operator){case "||":L=O||W;break a;case "\x26\x26":L=O&&W;break a;default:throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYORORAND"));}}catch(Ta){throw Ta;}return L;case "ConditionalExpression":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{for(f=[],y=0;y<b.elements.length;y++){var Na=D(a,b.elements[y]);if(e.isFunctionParameter(Na))throw Error(c.nodeErrorMessage(b,
"RUNTIME","FUNCTIONCONTEXTILLEGAL"));Na===e.voidOperation?f.push(null):f.push(Na)}}catch(R){throw R;}return f;case "ObjectExpression":f={};for(y=0;y<b.properties.length;y++){var T=D(a,b.properties[y]);if(e.isFunctionParameter(T.value))throw Error("Illegal Argument");if(!1===e.isString(T.key))throw Error("Illegal Argument");T.value===e.voidOperation?f[T.key.toString()]=null:f[T.key.toString()]=T.value}var S=new n(f);return S.immutable=!1,S;case "Property":return{key:"Identifier"===b.key.type?b.key.name:
D(a,b.key),value:D(a,b.value)};case "Array":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));default:throw Error(c.nodeErrorMessage(b,"RUNTIME","UNREOGNISED"));}}catch(U){throw U;}}function E(a,b){var d=D(a,b.right);"VariableDeclaration"===b.left.type&&D(a,b.left);var g=null,f="VariableDeclaration"===b.left.type?b.left.declarations[0].id.name:b.left.name;if(null!==a.localScope&&void 0!==a.localScope[f]&&(g=a.localScope[f]),null===g&&void 0!==a.globalScope[f]&&(g=a.globalScope[f]),null===
g)throw Error(c.nodeErrorMessage(b,"RUNTIME","VARIABLENOTDECLARED"));if(e.isArray(d)||e.isString(d)){for(var d=d.length,k=0;d>k;k++){g.value=k;f=D(a,b.body);if(f===e.breakResult)break;if(f instanceof e.ReturnResult)return f}return e.voidOperation}if(e.isImmutableArray(d)){for(k=0;k<d.length();k++){g.value=k;f=D(a,b.body);if(f===e.breakResult)break;if(f instanceof e.ReturnResult)return f}return e.voidOperation}if(!(d instanceof n||d instanceof q))return e.voidOperation;d=d.keys();for(k=0;k<d.length;k++){g.value=
d[k];f=D(a,b.body);if(f===e.breakResult)break;if(f instanceof e.ReturnResult)return f}}function F(a,b,d,g){switch(b){case "\x3d":return a===e.voidOperation?null:a;case "/\x3d":return e.toNumber(d)/e.toNumber(a);case "*\x3d":return e.toNumber(d)*e.toNumber(a);case "-\x3d":return e.toNumber(d)-e.toNumber(a);case "+\x3d":return e.isString(d)||e.isString(a)?e.toString(d)+e.toString(a):e.toNumber(d)+e.toNumber(a);case "%\x3d":return e.toNumber(d)%e.toNumber(a);default:throw Error(c.nodeErrorMessage(g,
"RUNTIME","OPERATORNOTRECOGNISED"));}}function H(a,b,d,g){switch(b=b.toLowerCase()){case "hasz":return a=a.hasZ,void 0===a?!1:a;case "hasm":return a=a.hasM,void 0===a?!1:a;case "spatialreference":return b=a.spatialReference._arcadeCacheId,void 0===b&&(d=!0,Object.freeze&&Object.isFrozen(a.spatialReference)&&(d=!1),d&&(U++,a.spatialReference._arcadeCacheId=U,b=U)),a=new n({wkt:a.spatialReference.wkt,wkid:a.spatialReference.wkid}),void 0!==b&&(a._arcadeCacheId="SPREF"+b.toString()),a}switch(a.type){case "extent":switch(b){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return a=
a[b],void 0!==a?a:null;case "type":return"Extent"}break;case "polygon":switch(b){case "rings":return b=e.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(U++,b=U,e.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new y(a.rings,a.spatialReference,!0===a.hasZ,!0===a.hasM,b);case "type":return"Polygon"}break;case "point":switch(b){case "x":case "y":case "z":case "m":return void 0!==a[b]?a[b]:null;case "type":return"Point"}break;case "polyline":switch(b){case "paths":return b=
e.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(U++,b=U,e.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new y(a.paths,a.spatialReference,!0===a.hasZ,!0===a.hasM,b);case "type":return"Polyline"}break;case "multipoint":switch(b){case "points":return b=e.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(U++,b=U,e.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new z(a.points,a.spatialReference,
!0===a.hasZ,!0===a.hasM,b,1);case "type":return"Multipoint"}}throw Error(c.nodeErrorMessage(g,"RUNTIME","PROPERTYNOTFOUND"));}function G(a,b){try{var d=D(a,b.object);if(null===d)throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));if(!1===b.computed){if(d instanceof n||d instanceof q)return d.field(b.property.name);if(d instanceof A)return H(d,b.property.name,a,b);throw Error(c.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));}var g=D(a,b.property);if(d instanceof n||d instanceof q){if(e.isString(g))return d.field(g);
throw Error(c.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));}if(d instanceof A){if(e.isString(g))return H(d,g,a,b);throw Error(c.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));}if(e.isArray(d)){if(e.isNumber(g)&&isFinite(g)&&Math.floor(g)===g){if(0>g&&(g=d.length+g),g>=d.length||0>g)throw Error(c.nodeErrorMessage(b,"RUNTIME","OUTOFBOUNDS"));return d[g]}throw Error(c.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));}if(e.isString(d)){if(e.isNumber(g)&&isFinite(g)&&Math.floor(g)===g){if(0>g&&(g=d.length+g),
g>=d.length||0>g)throw Error(c.nodeErrorMessage(b,"RUNTIME","OUTOFBOUNDS"));return d[g]}throw Error(c.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));}if(e.isImmutableArray(d)&&e.isNumber(g)&&isFinite(g)&&Math.floor(g)===g){if(0>g&&(g=d.length()+g),g>=d.length()||0>g)throw Error(c.nodeErrorMessage(b,"RUNTIME","OUTOFBOUNDS"));return d.get(g)}throw Error(c.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));}catch(f){throw f;}}function K(a,b){try{var d=D(a,b.argument);if(e.isBoolean(d)){if("!"===b.operator)return!d;
if("-"===b.operator)return-1*e.toNumber(d);if("+"===b.operator)return 1*e.toNumber(d);throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===b.operator)return-1*e.toNumber(d);if("+"===b.operator)return 1*e.toNumber(d);throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}catch(g){throw g;}}function J(a,b){try{var d=[D(a,b.left),D(a,b.right)],g=d[0],f=d[1];switch(b.operator){case "\x3d\x3d":return e.equalityTest(g,f);case "\x3d":return e.equalityTest(g,
f);case "!\x3d":return!e.equalityTest(g,f);case "\x3c":return e.greaterThanLessThan(g,f,b.operator);case "\x3e":return e.greaterThanLessThan(g,f,b.operator);case "\x3c\x3d":return e.greaterThanLessThan(g,f,b.operator);case "\x3e\x3d":return e.greaterThanLessThan(g,f,b.operator);case "+":return e.isString(g)||e.isString(f)?e.toString(g)+e.toString(f):e.toNumber(g)+e.toNumber(f);case "-":return e.toNumber(g)-e.toNumber(f);case "*":return e.toNumber(g)*e.toNumber(f);case "/":return e.toNumber(g)/e.toNumber(f);
case "%":return e.toNumber(g)%e.toNumber(f);default:throw Error(c.nodeErrorMessage(b,"RUNTIME","OPERATORNOTRECOGNISED"));}}catch(k){throw k;}}function I(a,b){try{if("Identifier"!==b.callee.type)throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYNODESSUPPORTED"));if(null!==a.localScope&&void 0!==a.localScope[b.callee.name.toLowerCase()]){var d=a.localScope[b.callee.name.toLowerCase()];if(d.value instanceof e.NativeFunction)return d.value.fn(a,b);if(d.value instanceof r)return T(a,b,d.value.definition);
throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTAFUNCTION"));}if(void 0!==a.globalScope[b.callee.name.toLowerCase()]){d=a.globalScope[b.callee.name.toLowerCase()];if(d.value instanceof e.NativeFunction)return d.value.fn(a,b);if(d.value instanceof r)return T(a,b,d.value.definition);throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTAFUNCTION"));}throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));}catch(g){throw g;}}function L(c){return null==c?"":e.isArray(c)?"Array":e.isImmutableArray(c)?"Array":
e.isDate(c)?"Date":e.isString(c)?"String":e.isBoolean(c)?"Boolean":e.isNumber(c)?"Number":c instanceof n?"Dictionary":c instanceof q?"Feature":c instanceof f?"Point":c instanceof a?"Polygon":c instanceof b?"Polyline":c instanceof m?"Multipoint":c instanceof k?"Extent":e.isFunctionParameter(c)?"Function":c===e.voidOperation?"":"number"==typeof c&&isNaN(c)?"Number":"Unrecognised Type"}function M(a,c,b,d){try{var g=D(a,c.arguments[b]);if(e.equalityTest(g,d))return D(a,c.arguments[b+1]);var f=c.arguments.length-
b;return 1===f?D(a,c.arguments[b]):2===f?null:M(a,c,b+2,d)}catch(k){throw k;}}function N(a,c,b,d){try{if(!0===d)return D(a,c.arguments[b+1]);if(3===c.arguments.length-b)return D(a,c.arguments[b+2]);var g=D(a,c.arguments[b+2]);if(!1===e.isBoolean(g))throw Error("WHEN needs boolean test conditions");return N(a,c,b+2,g)}catch(f){throw f;}}function Q(a,c){var b=a.length,e=Math.floor(b/2),d;if(0===b)d=[];else if(1===b)d=[a[0]];else{d=Q(a.slice(0,e),c);b=Q(a.slice(e,b),c);for(e=[];0<d.length||0<b.length;)if(0<
d.length&&0<b.length){var g=c(d[0],b[0]);isNaN(g)&&(g=0);0>=g?(e.push(d[0]),d=d.slice(1)):(e.push(b[0]),b=b.slice(1))}else 0<d.length?(e.push(d[0]),d=d.slice(1)):0<b.length&&(e.push(b[0]),b=b.slice(1));d=e}return d}function O(a,c,b){try{var d=a.body;if(b.length!==a.params.length)throw Error("Invalid Parameter calls to function.");for(var g=0;g<b.length;g++)c.localScope[a.params[g].name.toLowerCase()]={d:null,value:b[g],valueset:!0,node:null};var f=D(c,d);if(f instanceof e.ReturnResult)return f.value;
if(f===e.breakResult)throw Error("Cannot Break from a Function");if(f===e.continueResult)throw Error("Cannot Continue from a Function");return f instanceof e.ImplicitResult?f.value:f}catch(k){throw k;}}function T(a,c,b){return C(a,c,function(c,e,d){c={spatialReference:a.spatialReference,applicationCache:void 0===a.applicationCache?null:a.applicationCache,globalScope:a.globalScope,depthCounter:a.depthCounter+1,console:a.console,localScope:{}};if(64<c.depthCounter)throw Error("Exceeded maximum function depth");
return O(b,c,d)})}function S(a){return function(){var c={applicationCache:void 0===a.context.applicationCache?null:a.context.applicationCache,spatialReference:a.context.spatialReference,console:a.context.console,localScope:{},depthCounter:a.context.depthCounter+1,globalScope:a.context.globalScope};if(64<c.depthCounter)throw Error("Exceeded maximum function depth");return O(a.definition,c,arguments)}}function R(a){}var U=0,W={};u.registerFunctions(W,C);v.registerFunctions(W,C);t.registerFunctions(W,
C);w.registerFunctions(W,C);x.registerFunctions(W,C);W["typeof"]=function(a,c){return C(a,c,function(a,c,b){e.pcCheck(b,1,1);a=L(b[0]);if("Unrecognised Type"===a)throw Error("Unrecognised Type");return a})};W.iif=function(a,c){try{e.pcCheck(null===c.arguments?[]:c.arguments,3,3);var b=D(a,c.arguments[0]);if(!1===e.isBoolean(b))throw Error("IF Function must have a boolean test condition");return!0===b?D(a,c.arguments[1]):D(a,c.arguments[2])}catch(d){throw d;}};W.decode=function(a,c){try{if(2>c.arguments.length)throw Error("Missing Parameters");
if(2===c.arguments.length)return D(a,c.arguments[1]);if(0===(c.arguments.length-1)%2)throw Error("Must have a default value result.");var b=D(a,c.arguments[0]);return M(a,c,1,b)}catch(e){throw e;}};W.when=function(a,c){try{if(3>c.arguments.length)throw Error("Missing Parameters");if(0===c.arguments.length%2)throw Error("Must have a default value result.");var b=D(a,c.arguments[0]);if(!1===e.isBoolean(b))throw Error("WHEN needs boolean test conditions");return N(a,c,0,b)}catch(d){throw d;}};W.top=
function(a,c){return C(a,c,function(a,c,b){if(e.pcCheck(b,2,2),e.isArray(b[0]))return e.toNumber(b[1])>=b[0].length?b[0].slice(0):b[0].slice(0,e.toNumber(b[1]));if(e.isImmutableArray(b[0]))return e.toNumber(b[1])>=b[0].length()?b[0].slice(0):b[0].slice(0,e.toNumber(b[1]));throw Error("Top cannot accept this parameter type");})};W.first=function(a,c){return C(a,c,function(a,c,b){return e.pcCheck(b,1,1),e.isArray(b[0])?0===b[0].length?null:b[0][0]:e.isImmutableArray(b[0])?0===b[0].length()?null:b[0].get(0):
null})};W.sort=function(a,c){return C(a,c,function(a,c,b){e.pcCheck(b,1,2);a=b[0];if(e.isImmutableArray(a)&&(a=a.toArray()),!1===e.isArray(a))throw Error("Illegal Argument");if(1<b.length){if(!1===e.isFunctionParameter(b[1]))throw Error("Illegal Argument");var d=S(b[1]);return a=Q(a,function(a,c){return d(a,c)})}if(0===a.length)return[];b={};for(c=0;c<a.length;c++){var g=L(a[c]);""!==g&&(b[g]=!0)}if(!0===b.Array||!0===b.Dictionary||!0===b.Feature||!0===b.Point||!0===b.Polygon||!0===b.Polyline||!0===
b.Multipoint||!0===b.Extent||!0===b.Function)return a.slice(0);c=0;var g="",f;for(f in b)c++,g=f;return a=1<c||"String"===g?Q(a,function(a,c){if(null===a||void 0===a||a===e.voidOperation)return null===c||void 0===c||c===e.voidOperation?0:1;if(null===c||void 0===c||c===e.voidOperation)return-1;var b=e.toString(a),d=e.toString(c);return d>b?-1:b===d?0:1}):"Number"===g?Q(a,function(a,c){return a-c}):"Boolean"===g?Q(a,function(a,c){return a===c?0:c?-1:1}):"Date"===g?Q(a,function(a,c){return c-a}):a.slice(0)})};
l.functionHelper={fixSpatialReference:e.fixSpatialReference,parseArguments:B,standardFunction:C};l.executeScript=function(a,c,b){b||(b=new g(102100));var f=c.vars,k=c.customfunctions,m={};f||(f={});k||(k={});var h=new n({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});h.immutable=!1;m.textformatting={value:h,valueset:!0,node:null};m.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};m.pi={value:Math.PI,valueset:!0,node:null};for(var t in W)m[t]=
{value:new e.NativeFunction(W[t]),valueset:!0,node:null};for(t in k)m[t]={value:new e.NativeFunction(k[t]),"native":!0,valueset:!0,node:null};for(t in f)f[t]instanceof d?m[t]={value:new q(f[t]),valueset:!0,node:null}:m[t]={value:f[t],valueset:!0,node:null};a=D({spatialReference:b,globalScope:m,localScope:null,console:c.console?c.console:R,depthCounter:1,applicationCache:void 0===c.applicationCache?null:c.applicationCache},a.body[0].body);if(a instanceof e.ReturnResult&&(a=a.value),a instanceof e.ImplicitResult&&
(a=a.value),a===e.voidOperation&&(a=null),a===e.breakResult)throw Error("Cannot return BREAK");if(a===e.continueResult)throw Error("Cannot return CONTINUE");if(a instanceof r)throw Error("Cannot return FUNCTION");if(a instanceof e.NativeFunction)throw Error("Cannot return FUNCTION");return a};l.extractFieldLiterals=function(a,b){return void 0===b&&(b=!1),c.findFieldLiterals(a,b)};l.validateScript=function(a,b){return c.validateScript(a,b,"simple")};l.referencesMember=function(a,b){return c.referencesMember(a,
b)};l.referencesFunction=function(a,b){return c.referencesFunction(a,b)}})},"esri/arcade/treeAnalysis":function(){define(["require","exports"],function(h,l){function a(a,c,b,e){return void 0!==a.fmin&&(a.min=a.fmin),void 0!==a.fmax&&(a.max=a.fmax),"0"!==a.min&&b.length<Number(a.min)?-2:"*"!==a.max&&b.length>Number(a.max)?-2:1}function d(c,b,e){if(null!==e.localScope&&void 0!==e.localScope[c.toLowerCase()]){var d=e.localScope[c.toLowerCase()];if("FormulaFunction"===d.type||"any"===d.type)return void 0===
d.signature&&(d.signature={min:"0",max:"*"}),a(d.signature,c,b,e)}return void 0!==e.globalScope[c.toLowerCase()]&&(d=e.globalScope[c.toLowerCase()],"FormulaFunction"===d.type||"any"===d.type)?(void 0===d.signature&&(d.signature={min:"0",max:"*"}),a(d.signature,c,b,e)):-1}function b(a,c){void 0===c&&(c=!0);var e=q(a,"SYNTAX","UNREOGNISED");try{switch(a.type){case "VariableDeclarator":return null!==a.init&&"FunctionExpression"===a.init.type?q(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR"):"Identifier"!==
a.id.type?q(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER"):null!==a.init?b(a.init,!1):"";case "VariableDeclaration":for(var d=0;d<a.declarations.length;d++)if(e=b(a.declarations[d],c),""!==e)return e;return"";case "ForInStatement":if(e=b(a.left,c),""!==e)break;if("VariableDeclaration"===a.left.type){if(1<a.left.declarations.length)return q(a,"SYNTAX","ONLY1VAR");if(null!==a.left.declarations[0].init)return q(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return q(a,"SYNTAX","LEFTNOTVAR");
return e=b(a.right,c),""!==e?e:(e=b(a.body,c),""!==e?e:"");case "ForStatement":return null!==a.test&&(e=b(a.test,c),""!==e)?e:null!==a.init&&(e=b(a.init,c),""!==e)?e:null!==a.update&&(e=b(a.update,c),""!==e)?e:null!==a.body&&(e=b(a.body,c),""!==e)?e:"";case "ContinueStatement":return"";case "EmptyStatement":return"";case "BreakStatement":return"";case "IfStatement":return e=b(a.test,c),""!==e?e:null!==a.consequent&&(e=b(a.consequent,!1),""!==e)?e:null!==a.alternate&&(e=b(a.alternate,!1),""!==e)?e:
"";case "BlockStatement":for(var g=[],d=0;d<a.body.length;d++)"EmptyStatement"!==a.body[d].type&&g.push(a.body[d]);a.body=g;for(d=0;d<a.body.length;d++)if(e=b(a.body[d],c),""!==e)return e;return"";case "FunctionDeclaration":return!1===c?q(a,"SYNTAX","GLOBALFUNCTIONSONLY"):"Identifier"!==a.id.type?q(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"):b(a.body,!1);case "ReturnStatement":return null!==a.argument?b(a.argument,c):"";case "UpdateExpression":return"Identifier"!==a.argument.type&&"MemberExpression"!==
a.argument.type?q(a,"SYNTAX","ASSIGNMENTTOVARSONLY"):b(a.argument,c);case "AssignmentExpression":if("Identifier"!==a.left.type&&"MemberExpression"!==a.left.type)return q(a,"SYNTAX","ASSIGNMENTTOVARSONLY");if(e=b(a.left,c),""!==e)break;switch(a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:return q(a,"SYNTAX","OPERATORNOTRECOGNISED")}return b(a.right,!1);case "ExpressionStatement":return b(a.expression,!1);case "Identifier":e="";break;case "MemberExpression":return e=
b(a.object,c),""!==e?e:!0===a.computed?b(a.property,c):"";case "Literal":return"";case "ThisExpression":return q(a,"SYNTAX","NOTSUPPORTED");case "CallExpression":if("Identifier"!==a.callee.type)return q(a,"SYNTAX","ONLYNODESSUPPORTED");e="";for(d=0;d<a.arguments.length;d++)if(e=b(a.arguments[d],c),""!==e)return e;return"";case "UnaryExpression":e=b(a.argument,c);break;case "BinaryExpression":if(e=b(a.left,c),""!==e)break;if(e=b(a.right,c),""!==e)break;switch(a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;
default:return q(a,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "LogicalExpression":if(e=b(a.left,c),""!==e)break;if(e=b(a.right),""!==e)break;switch(a.operator){case "\x26\x26":case "||":break;default:return q(a,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "ConditionalExpression":return q(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":e="";for(d=0;d<a.elements.length&&(e=b(a.elements[d],c),""===e);d++);break;case "Array":return q(a,"SYNTAX","NOTSUPPORTED");case "ObjectExpression":e="";for(d=
0;d<a.properties.length;d++){if(e="",null!==a.properties[d].key&&("Literal"!==a.properties[d].key.type&&"Identifier"!==a.properties[d].key.type&&(e=q(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[d].key.type))g=a.properties[d].key.value,"string"==typeof g||g instanceof String||(e=q(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"));if(""===e&&(e=b(a.properties[d],c)),""!==e)break}break;case "Property":return"Literal"!==a.key.type&&"Identifier"!==a.key.type?q(a,"SYNTAX","ONLYLITERAL"):
"Identifier"!==a.key.type&&(e=b(a.key,c),""!==e)?e:b(a.value,c)}return e}catch(f){throw f;}}function f(a,b){var g=q(a,"SYNTAX","UNREOGNISED"),k=null,m="";try{switch(a.type){case "VariableDeclarator":if(null!==a.init&&"FunctionExpression"===a.init.type)return q(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR");null!==b.localScope?void 0!==b.localScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase():void 0!==b.globalScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase();var n=null===a.init?"":f(a.init,b);
return""!==n?n:(null===b.localScope?b.globalScope[a.id.name.toLowerCase()]={type:"any"}:b.localScope[a.id.name.toLowerCase()]={type:"any"},"");case "FunctionDeclaration":return k=e(a.id.name.toLowerCase(),a,b),m=c(a,b),""!==m?m:null!==b.localScope?q(a,"SYNTAX","GLOBALFUNCTIONSONLY"):(k.isnative=!1,b.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",signature:[k]},"");case "VariableDeclaration":for(var g="",h=0;h<a.declarations.length&&(g=f(a.declarations[h],b),""===g);h++);break;case "IfStatement":return g=
f(a.test,b),""!==g?g:"AssignmentExpression"===a.test.type||"UpdateExpression"===a.test.type?q(a.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):null!==a.consequent&&(g=f(a.consequent,b),""!==g)?g:null!==a.alternate&&(g=f(a.alternate,b),""!==g)?g:"";case "EmptyStatement":return"";case "BlockStatement":for(h=0;h<a.body.length;h++)if(g=f(a.body[h],b),""!==g)return g;return"";case "ReturnStatement":return null!==a.argument?f(a.argument,b):"";case "ForInStatement":if("VariableDeclaration"===a.left.type){if(1<
a.left.declarations.length)return q(a,"SYNTAX","ONLY1VAR");if(null!==a.left.declarations[0].init)return q(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return q(a,"SYNTAX","LEFTNOTVAR");return g=f(a.left,b),""!==g?g:(g=f(a.right,b),""!==g?g:(g=f(a.body,b),""!==g?g:""));case "ForStatement":return null!==a.init&&(g=f(a.init,b),""!==g)?g:null!==a.test&&(g=f(a.test,b),""!==g)?g:null!==a.body&&(g=f(a.body,b),""!==g)?g:null!==a.update&&(g=f(a.update,b),""!==g)?g:"";case "BreakStatement":return"";
case "ContinueStatement":return"";case "UpdateExpression":if("Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type)return q(a,"SYNTAX","ASSIGNMENTTOVARSONLY");var r=!1;return"MemberExpression"===a.argument.type?f(a.argument,b):(null!==b.localScope&&void 0!==b.localScope[a.argument.name.toLowerCase()]&&(r=!0),void 0!==b.globalScope[a.argument.name.toLowerCase()]&&(r=!0),!1===r?"Identifier "+a.argument.name+" has not been declared.":"");case "AssignmentExpression":if("Identifier"!==a.left.type&&
"MemberExpression"!==a.left.type)return q(a,"SYNTAX","ASSIGNMENTTOVARSONLY");var u=f(a.right,b);return""!==u?u:(r=!1,"MemberExpression"===a.left.type?(u=f(a.left,b),""!==u?u:""):(null!==b.localScope&&void 0!==b.localScope[a.left.name.toLowerCase()]&&(r=!0),void 0!==b.globalScope[a.left.name.toLowerCase()]&&(r=!0),!1===r?"Identifier "+a.left.name+" has not been declared.":""));case "ExpressionStatement":return f(a.expression,b);case "Identifier":var l=a.name.toLowerCase();if(null!==b.localScope&&void 0!==
b.localScope[l])return"";g=void 0!==b.globalScope[l]?"":q(a,"SYNTAX","VARIABLENOTFOUND");break;case "MemberExpression":return g=f(a.object,b),""!==g?g:!0===a.computed?f(a.property,b):"";case "Literal":return"";case "ThisExpression":g=q(a,"SYNTAX","NOTSUPPORTED");break;case "CallExpression":if("Identifier"!==a.callee.type)return q(a,"SYNTAX","ONLYNODESSUPPORTED");g="";for(h=0;h<a.arguments.length;h++)if(g=f(a.arguments[h],b),""!==g)return g;var v=d(a.callee.name,a.arguments,b);-1===v&&(g=q(a,"SYNTAX",
"NOTFOUND"));-2===v&&(g=q(a,"SYNTAX","WRONGSIGNATURE"));break;case "UnaryExpression":g=f(a.argument,b);break;case "BinaryExpression":return g=f(a.left,b),""!==g?g:(g=f(a.right,b),""!==g?g:"");case "LogicalExpression":return g=f(a.left,b),""!==g?g:"AssignmentExpression"===a.left.type||"UpdateExpression"===a.left.type?q(a.left,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):(g=f(a.right,b),""!==g?g:"AssignmentExpression"===a.right.type||"UpdateExpression"===a.right.type?q(a.right,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):
"");case "ConditionalExpression":return q(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":g="";for(h=0;h<a.elements.length&&(g=f(a.elements[h],b),""===g);h++);break;case "ObjectExpression":g="";for(h=0;h<a.properties.length;h++){if(g="",null!==a.properties[h].key&&("Literal"!==a.properties[h].key.type&&"Identifier"!==a.properties[h].key.type&&(g=q(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[h].key.type)){var H=a.properties[h].key.value;"string"==typeof H||H instanceof String||
(g=q(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"))}if(""===g&&(g=f(a.properties[h],b)),""!==g)break}break;case "Property":return"Literal"!==a.key.type&&"Identifier"!==a.key.type?q(a,"SYNTAX","ONLYLITERAL"):"Identifier"!==a.key.type&&(g=f(a.key,b),""!==g)?g:f(a.value,b);case "Array":return q(a,"SYNTAX","NOTSUPPORTED")}return g}catch(G){throw G;}}function k(a,c){var b=!1;try{switch(a.type){case "VariableDeclarator":return null!==a.init?k(a.init,c):b;case "FunctionDeclaration":return k(a.body,c);case "VariableDeclaration":for(var e=
0;e<a.declarations.length;e++)if(k(a.declarations[e],c))return!0;return b;case "IfStatement":return k(a.test,c)?!0:null!==a.consequent&&k(a.consequent,c)?!0:null!==a.alternate&&k(a.alternate,c)?!0:b;case "EmptyStatement":return b;case "BlockStatement":for(e=0;e<a.body.length;e++)if(k(a.body[e],c))return!0;return b;case "ReturnStatement":return null!==a.argument?k(a.argument,c):b;case "UpdateExpression":return k(a.argument,c);case "AssignmentExpression":return b=k(a.right,c),b?b:k(a.left,c);case "ExpressionStatement":return k(a.expression,
c);case "ForInStatement":return(b=k(a.left,c))?b:(b=k(a.right,c))?b:(b=k(a.body,c),b);case "ForStatement":return null!==a.init&&(b=k(a.init,c))?b:null!==a.test&&(b=k(a.test,c))?b:null!==a.body&&(b=k(a.body,c))?b:(null!==a.update&&(b=k(a.update,c)),b);case "BreakStatement":return b;case "ContinueStatement":return b;case "Compound":return b;case "Identifier":return c.toLowerCase()===a.name.toLowerCase();case "MemberExpression":return(b=k(a.object,c))?b:(!0===a.computed&&(b=k(a.property,c)),b);case "Literal":return b;
case "ThisExpression":return b;case "CallExpression":for(e=0;e<a.arguments.length;e++)k(a.arguments[e],c)&&(b=!0);return b;case "ArrayExpression":for(e=0;e<a.elements.length;e++)k(a.elements[e],c)&&(b=!0);return b;case "UnaryExpression":return k(a.argument,c);case "BinaryExpression":return(b=k(a.left,c))?b:k(a.right,c);case "LogicalExpression":return(b=k(a.left,c))?b:k(a.right,c);case "ObjectExpression":for(e=0;e<a.properties.length;e++)k(a.properties[e],c)&&(b=!0);return b;case "Property":return k(a.value,
c);case "ConditionalExpression":return b;case "Array":return b;default:return b}}catch(d){throw d;}}function m(a,c){var b=!1;try{switch(a.type){case "VariableDeclarator":return null!==a.init?m(a.init,c):b;case "FunctionDeclaration":return m(a.body,c);case "VariableDeclaration":for(var e=0;e<a.declarations.length;e++)if(m(a.declarations[e],c))return!0;return b;case "IfStatement":return m(a.test,c)?!0:null!==a.consequent&&m(a.consequent,c)?!0:null!==a.alternate&&m(a.alternate,c)?!0:b;case "EmptyStatement":return b;
case "BlockStatement":for(e=0;e<a.body.length;e++)if(m(a.body[e],c))return!0;return b;case "ReturnStatement":return null!==a.argument?m(a.argument,c):b;case "UpdateExpression":return m(a.argument,c);case "AssignmentExpression":return m(a.left,c)?!0:m(a.right,c);case "ExpressionStatement":return m(a.expression,c);case "ForInStatement":return(b=m(a.left,c))?b:(b=m(a.right,c))?b:(b=m(a.body,c),b);case "ForStatement":return null!==a.init&&(b=m(a.init,c))?b:null!==a.test&&(b=m(a.test,c))?b:null!==a.body&&
(b=m(a.body,c))?b:(null!==a.update&&(b=m(a.update,c)),b);case "BreakStatement":return b;case "ContinueStatement":return b;case "Compound":return b;case "Identifier":return b;case "MemberExpression":return(b=m(a.object,c))?b:(!0===a.computed&&(b=m(a.property,c)),b);case "Literal":return b;case "ThisExpression":return b;case "CallExpression":if(a.callee.name.toLowerCase()===c.toLowerCase())return!0;for(e=0;e<a.arguments.length;e++)m(a.arguments[e],c)&&(b=!0);return b;case "ArrayExpression":for(e=0;e<
a.elements.length;e++)m(a.elements[e],c)&&(b=!0);return b;case "UnaryExpression":return m(a.argument,c);case "BinaryExpression":return(b=m(a.left,c))?b:m(a.right,c);case "LogicalExpression":return(b=m(a.left,c))?b:m(a.right,c);case "ConditionalExpression":return b;case "ObjectExpression":for(e=0;e<a.properties.length;e++)m(a.properties[e],c)&&(b=!0);return b;case "Property":return m(a.value,c);case "Array":return b;default:return b}}catch(d){throw d;}}function g(a,c){var b,e=[];try{switch(a.type){case "VariableDeclarator":return null!==
a.init?g(a.init,c):e;case "FunctionDeclaration":return g(a.body,c);case "VariableDeclaration":for(var d=0;d<a.declarations.length;d++)b=g(a.declarations[d],c),e=e.concat(b);return e;case "ForInStatement":return b=g(a.left,c),e=e.concat(b),b=g(a.right,c),e=e.concat(b),b=g(a.body,c),e.concat(b);case "ForStatement":return null!==a.init&&(b=g(a.init,c),e=e.concat(b)),null!==a.test&&(b=g(a.test,c),e=e.concat(b)),null!==a.body&&(b=g(a.body,c),e=e.concat(b)),null!==a.update&&(b=g(a.update,c),e=e.concat(b)),
e;case "IfStatement":return b=g(a.test,c),e=e.concat(b),null!==a.consequent&&(b=g(a.consequent,c),e=e.concat(b)),null!==a.alternate&&(b=g(a.alternate,c),e=e.concat(b)),e;case "EmptyStatement":return e;case "BlockStatement":for(d=0;d<a.body.length;d++)b=g(a.body[d],c),e=e.concat(b);return e;case "ReturnStatement":return null!==a.argument?g(a.argument,c):e;case "UpdateExpression":return g(a.argument,c);case "AssignmentExpression":return e=g(a.left,c),e.concat(g(a.right,c));case "ExpressionStatement":return g(a.expression,
c);case "BreakStatement":return e;case "ContinueStatement":return e;case "Compound":return e;case "Identifier":return e;case "MemberExpression":if("Identifier"!==a.object.type)return e;if(!1===a.computed)e.push(a.object.name.toLowerCase()+"."+a.property.name.toLowerCase());else try{"Literal"===a.property.type&&"string"==typeof a.property.value&&e.push(a.object.name.toLowerCase()+"."+a.property.value.toString().toLowerCase())}catch(f){}return e;case "Literal":return e;case "ThisExpression":return e;
case "CallExpression":for(d=0;d<a.arguments.length;d++)b=g(a.arguments[d],c),e=e.concat(b);return e;case "ArrayExpression":for(d=0;d<a.elements.length;d++)b=g(a.elements[d],c),e=e.concat(b);return e;case "UnaryExpression":return g(a.argument,c);case "ObjectExpression":for(d=0;d<a.properties.length;d++)b=g(a.properties[d],c),e=e.concat(b);return e;case "Property":return g(a.value,c);case "BinaryExpression":return b=g(a.left,c),e=e.concat(b),b=g(a.right,c),e.concat(b);case "LogicalExpression":return b=
g(a.left,c),e=e.concat(b),b=g(a.right,c),e.concat(b);case "ConditionalExpression":return e;case "Array":return e;default:return e}}catch(k){throw k;}}function e(a,c,b){b=[];if(void 0!==c.params&&null!==c.params)for(var e=0;e<c.params.length;e++)b.push("any");return{name:a,"return":"any",params:b}}function c(a,c){for(var b={globalScope:c.globalScope,localScope:{}},e=0;e<a.params.length;e++)b.localScope[a.params[e].name.toLowerCase()]={type:"any"};return f(a.body,b)}function n(a,c,b,e){var d={};void 0!==
a&&null!==a||(a={});void 0!==b&&null!==b||(b={});d.infinity={type:"any"};d.textformatting={type:"any"};d.pi={type:"any"};for(var g in c)("simple"!==e||"simple"===e&&"a"===c[g].av)&&(d[g]={type:"FormulaFunction",signature:c[g]});for(c=0;c<b.length;c++)g=b[c],d[g.name]={type:"FormulaFunction",signature:g};for(g in a)d[g]=a[g],d[g].type="any";return d}function q(a,c,b){var e="";switch(c){case "SYNTAX":e="Syntax Error: ";break;case "RUNTIME":e="Runtime Error: ";break;default:e="Syntax Error: "}try{switch(a.type){case "IfStatement":switch(b){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":e+=
" Assignments not be made in logical tests";break;case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":e+=" Non Boolean used as Condition"}break;case "UpdateExpression":case "AssignmentExpression":switch(b){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":e+=" Assignments not be made in logical tests";break;case "ASSIGNMENTTOVARSONLY":e+=" Assignments can only be made to identifiers"}break;case "ExpressionStatement":e+=" Assignments can only be made to identifiers";break;case "FunctionDeclaration":switch(b){case "GLOBALFUNCTIONSONLY":e+=
" Functions cannot be declared as variables";break;case "FUNCTIONMUSTHAVEIDENTIFIER":e+=" Function Definition must have an identifier"}break;case "VariableDeclaration":e+=" Only 1 variable can be declared at a time";break;case "VariableDeclarator":switch(b){case "FUNCTIONVARIABLEDECLARATOR":e+=" Functions cannot be declared as variables";break;case "VARIABLEMUSTHAVEIDENTIFIER":e+=" Variable Definition must have an identifier"}break;case "Identifier":e+=" Identifier Not Found. ";e+=a.name;break;case "ObjectExpression":switch(b){case "OBJECTPROPERTYMUSTBESTRING":e+=
" Property name must be a string"}break;case "ForStatement":switch(b){case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":e+=" Non Boolean used as Condition"}break;case "ForInStatement":switch(b){case "ONLY1VAR":e+=" Can only declare 1 var for use with IN";break;case "CANNOTDECLAREVAL":e+=" Can only declare value for use with IN";break;case "LEFTNOVAR":e+="Must provide a variable to iterate with.";break;case "VARIABLENOTDECLARED":e+="Variable must be declared before it is used..";break;case "CANNOTITERATETHISTYPE":e+=
"This type cannot be used in an IN loop"}break;case "MemberExpression":switch(b){case "PROPERTYNOTFOUND":e+="Cannot find member property. ";e+=!1===a.computed?a.property.name:"";break;case "OUTOFBOUNDS":e+="Out of Bounds. ";e+=!1===a.computed?a.property.name:"";break;case "NOTFOUND":e+="Cannot call member method on null. ";e+=!1===a.computed?a.property.name:"";break;case "INVALIDTYPE":e+="Cannot call member property on object of this type. ",e+=!1===a.computed?a.property.name:""}break;case "Property":switch(b){case "ONLYLITERAL":e+=
"Property names must be literals or identifiers"}break;case "Literal":break;case "ThisExpression":e+="THIS construct is not supported.";case "CallExpression":switch(b){case "WRONGSIGNATURE":e+="Function signature does not match: ";e+=a.callee.name;break;case "ONLYNODESUPPORTED":e+="Functions must be declared.";e+=a.callee.name;break;case "NOTAFUNCTION":e+="Not a Function: ";e+=a.callee.name;break;case "NOTFOUND":e+="Function Not Found: "+a.callee.name}break;case "UnaryExpression":switch(b){case "NOTSUPPORTEDUNARYOPERATOR":e+=
"Operator "+a.operator+" not allowed in this context. Only ! can be used with boolean, and - with a number";break;case "NOTSUPPORTEDTYPE":e+="Unary operator "+a.operator+" cannot be used with this argument."}case "BinaryExpression":switch(b){case "OPERATORNOTRECOGNISED":e+="Binary Operator not recognised "+a.operator}break;case "LogicalExpression":return"";case "ConditionalExpression":e+="Conditional statements not supported.";break;case "ArrayExpression":switch(b){case "FUNCTIONCONTEXTILLEGAL":e+=
" Cannot Put Function inside Array."}break;case "Array":e+="Expression contains unrecognised array structure.";break;default:e+="Expression contains unrecognised code structures."}}catch(d){throw d;}return e}function r(a,c,b){return{line:a.loc.start.line,character:a.loc.start.column,reason:q(a,c,b)}}function u(a,c,b,e,d){c={globalScope:c.globalScope,localScope:{}};for(d=0;d<a.params.length;d++)c.localScope[a.params[d].name.toLowerCase()]={type:"any"};v(a.body,c,b,e,!1)}function v(a,c,b,g,f){if(void 0===
f&&(f=!0),null===a)throw Error("Unnexpexted Expression Syntax");q(a,"SYNTAX","UNREOGNISED");var k=null;try{switch(a.type){case "VariableDeclarator":return null!==a.init&&"FunctionExpression"===a.init.type?void g.push(r(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR")):("Identifier"!==a.id.type?g.push(r(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER")):(null!==c.localScope?void 0!==c.localScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase():void 0!==c.globalScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase(),
null===c.localScope?c.globalScope[a.id.name.toLowerCase()]={type:"any"}:c.localScope[a.id.name.toLowerCase()]={type:"any"}),void(null===a.init?"":v(a.init,c,b,g,f)));case "FunctionDeclaration":return!1===f&&g.push(r(a,"SYNTAX","GLOBALFUNCTIONSONLY")),"Identifier"!==a.id.type&&g.push(r(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER")),k=e("",a,c),u(a,c,b,g,f),null!==c.localScope&&g.push(r(a,"SYNTAX","GLOBALFUNCTIONSONLY")),k.isnative=!1,void("Identifier"===a.id.type&&(c.globalScope[a.id.name.toLowerCase()]=
{type:"FormulaFunction",signature:[k]}));case "VariableDeclaration":for(var m=0;m<a.declarations.length;m++)v(a.declarations[m],c,b,g,f);break;case "IfStatement":return null!==a.test&&(v(a.test,c,b,g,f),("AssignmentExpression"===a.test.type||"UpdateExpression"===a.test.type)&&g.push(r(a.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"))),null!==a.consequent&&v(a.consequent,c,b,g,f),void(null!==a.alternate&&v(a.alternate,c,b,g,f));case "EmptyStatement":break;case "BlockStatement":if(null!==a.body)for(m=
0;m<a.body.length;m++)v(a.body[m],c,b,g,f);break;case "ReturnStatement":return void(null!==a.argument&&v(a.argument,c,b,g,f));case "ForInStatement":return"VariableDeclaration"===a.left.type?(1<a.left.declarations.length&&g.push(r(a,"SYNTAX","ONLY1VAR")),null!==a.left.declarations[0].init&&g.push(r(a,"SYNTAX","CANNOTDECLAREVAL"))):"Identifier"!==a.left.type&&g.push(r(a,"SYNTAX","LEFTNOTVAR")),v(a.left,c,b,g,f),v(a.right,c,b,g,f),void v(a.body,c,b,g,f);case "ForStatement":return null!==a.init&&v(a.init,
c,b,g,f),null!==a.test&&v(a.test,c,b,g,f),null!==a.body&&v(a.body,c,b,g,f),void(null!==a.update&&v(a.update,c,b,g,f));case "BreakStatement":break;case "ContinueStatement":break;case "UpdateExpression":"Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type?g.push(r(a,"SYNTAX","ASSIGNMENTTOVARSONLY")):("Identifier"===a.argument.type&&(k=!1,!1===b&&(null!==c.localScope&&void 0!==c.localScope[a.argument.name.toLowerCase()]&&(k=!0),void 0!==c.globalScope[a.argument.name.toLowerCase()]&&(k=
!0),!1===k&&g.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+a.argument.name+" has not been declared."}))),"MemberExpression"===a.argument.type&&v(a.argument,c,b,g,f));break;case "AssignmentExpression":switch("Identifier"!==a.left.type&&"MemberExpression"!==a.left.type&&g.push(r(a,"SYNTAX","ASSIGNMENTTOVARSONLY")),a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:g.push(r(a,"SYNTAX","OPERATORNOTRECOGNISED"))}v(a.right,
c,b,g,f);k=!1;return"Identifier"===a.left.type&&(null!==c.localScope&&void 0!==c.localScope[a.left.name.toLowerCase()]&&(k=!0),void 0!==c.globalScope[a.left.name.toLowerCase()]&&(k=!0),!1===b&&!1===k&&g.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+a.argument.name+" has not been declared."})),void("MemberExpression"===a.left.type&&v(a.left,c,b,g,f));case "ExpressionStatement":return void v(a.expression,c,b,g,f);case "Identifier":var n=a.name.toLowerCase();
if(null!==c.localScope&&void 0!==c.localScope[n])break;if(void 0!==c.globalScope[n])break;!1===b&&g.push(r(a,"SYNTAX","VARIABLENOTFOUND"));break;case "MemberExpression":return v(a.object,c,b,g,f),void(!0===a.computed&&v(a.property,c,b,g,f));case "Literal":return"";case "ThisExpression":g.push(r(a,"SYNTAX","NOTSUPPORTED"));break;case "CallExpression":"Identifier"!==a.callee.type&&g.push(r(a,"SYNTAX","ONLYNODESSUPPORTED"));for(m=0;m<a.arguments.length;m++)v(a.arguments[m],c,b,g,f);var h=d(a.callee.name,
a.arguments,c);return!1===b&&-1===h&&g.push(r(a,"SYNTAX","NOTFOUND")),void(-2===h&&g.push(r(a,"SYNTAX","WRONGSIGNATURE")));case "UnaryExpression":return void v(a.argument,c,b,g,f);case "BinaryExpression":switch(v(a.left,c,b,g,f),v(a.right,c,b,g,f),a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;default:g.push(r(a,"SYNTAX","OPERATORNOTRECOGNISED"))}break;case "LogicalExpression":switch(a.operator){case "\x26\x26":case "||":break;
default:g.push(r(a,"SYNTAX","OPERATORNOTRECOGNISED"))}return v(a.left,c,b,g,f),("AssignmentExpression"===a.left.type||"UpdateExpression"===a.left.type)&&g.push(r(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION")),v(a.right,c,b,g,f),void(("AssignmentExpression"===a.right.type||"UpdateExpression"===a.right.type)&&g.push(r(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION")));case "ConditionalExpression":g.push(r(a,"SYNTAX","NOTSUPPORTED"));break;case "ArrayExpression":for(m=0;m<a.elements.length;m++)v(a.elements[m],
c,b,g,f);break;case "Array":g.push(r(a,"SYNTAX","NOTSUPPORTED"));case "ObjectExpression":for(m=0;m<a.properties.length;m++)v(a.properties[m],c,b,g,f);break;case "Property":return"Literal"!==a.key.type&&"Identifier"!==a.key.type&&g.push(r(a,"SYNTAX","ONLYLITERAL")),"Literal"===a.key.type&&v(a.key,c,b,g,f),void v(a.value,c,b,g,f);default:g.push(r(a,"SYNTAX","UNRECOGNISED"))}}catch(l){g.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Unnexpected Syntax"})}}l.functionDecls=
{concatenate:{min:"0",max:"*",av:"a"},split:{min:"2",max:"4",av:"a"},guid:{min:"0",max:"1",av:"a"},today:{min:"0",max:"0",av:"a"},now:{min:"0",max:"0",av:"a"},timestamp:{min:"0",max:"0",av:"a"},day:{min:"1",max:"1",av:"a"},month:{min:"1",max:"1",av:"a"},year:{min:"1",max:"1",av:"a"},hour:{min:"1",max:"1",av:"a"},second:{min:"1",max:"1",av:"a"},millisecond:{min:"1",max:"1",av:"a"},minute:{min:"1",max:"1",av:"a"},weekday:{min:"1",max:"1",av:"a"},toutc:{min:"1",max:"1",av:"a"},tolocal:{min:"1",max:"1",
av:"a"},date:{min:"0",max:"7",av:"a"},datediff:{min:"2",max:"3",av:"a"},dateadd:{min:"2",max:"3",av:"a"},trim:{min:"1",max:"1",av:"a"},text:{min:"1",max:"2",av:"a"},left:{min:"2",max:"2",av:"a"},right:{min:"2",max:"2",av:"a"},mid:{min:"2",max:"3",av:"a"},upper:{min:"1",max:"1",av:"a"},proper:{min:"1",max:"2",av:"a"},lower:{min:"1",max:"1",av:"a"},find:{min:"2",max:"3",av:"a"},iif:{min:"3",max:"3",av:"a"},decode:{min:"2",max:"*",av:"a"},when:{min:"2",max:"*",av:"a"},defaultvalue:{min:"2",max:"2",av:"a"},
isempty:{min:"1",max:"1",av:"a"},maplayer:{min:"2",max:"3",av:"f"},domaincode:{min:"3",max:"4",av:"a"},domainname:{min:"2",max:"4",av:"a"},polygon:{min:"1",max:"1",av:"a"},point:{min:"1",max:"1",av:"a"},polyline:{min:"1",max:"1",av:"a"},extent:{min:"1",max:"1",av:"a"},multipoint:{min:"1",max:"1",av:"a"},geometry:{min:"1",max:"1",av:"a"},featurelayer:{min:"1",max:"3",av:"f"},featurecollection:{min:"1",max:"1",av:"f"},buffer:{min:"2",max:"4",av:"f"},area:{min:"1",max:"2",av:"f"},sumarea:{min:"1",max:"2",
av:"f"},length:{min:"1",max:"2",av:"f"},sumlength:{min:"1",max:"2",av:"f"},count:{min:"0",max:"*",av:"a"},filter:{min:"2",max:"2",av:"f"},envelopeintersects:{min:"2",max:"2",av:"f"},intersects:{min:"2",max:"2",av:"f"},contains:{min:"2",max:"2",av:"f"},overlaps:{min:"2",max:"2",av:"f"},within:{min:"2",max:"2",av:"f"},touches:{min:"2",max:"2",av:"f"},crosses:{min:"2",max:"2",av:"f"},union:{min:"1",max:"2",av:"f",fmin:1},difference:{min:"2",max:"2",av:"f",fmin:2,fmax:3},intersection:{min:"2",max:"2",
av:"f",fmin:2,fmax:3},symmetricdifference:{min:"2",max:"2",av:"f",fmin:2,fmax:3},number:{min:"1",max:"2",av:"a"},acos:{min:"1",max:"1",av:"a"},asin:{min:"1",max:"1",av:"a"},atan:{min:"1",max:"1",av:"a"},atan2:{min:"2",max:"2",av:"a"},ceil:{min:"1",max:"2",av:"a"},floor:{min:"1",max:"2",av:"a"},round:{min:"1",max:"2",av:"a"},cos:{min:"1",max:"1",av:"a"},exp:{min:"1",max:"1",av:"a"},log:{min:"1",max:"1",av:"a"},min:{min:"0",max:"*",av:"a"},console:{min:"0",max:"*",av:"a"},max:{min:"0",max:"*",av:"a"},
pow:{min:"2",max:"2",av:"a"},random:{min:"0",max:"0",av:"a"},sqrt:{min:"1",max:"1",av:"a"},sin:{min:"1",max:"1",av:"a"},tan:{min:"1",max:"1",av:"a"},abs:{min:"1",max:"1",av:"a"},isnan:{min:"1",max:"1",av:"a"},stdev:{min:"0",max:"*",av:"a"},average:{min:"0",max:"*",av:"a"},mean:{min:"0",max:"*",av:"a"},sum:{min:"0",max:"*",av:"a"},variance:{min:"0",max:"*",av:"a"},distinct:{min:"0",max:"*",av:"a"},addfield:{min:"3",max:"3",av:"f"},removefield:{min:"2",max:"2",av:"f"},aggregate:{min:"3",max:"3",av:"f"},
dissolve:{min:"2",max:"3",av:"f"},changeshape:{min:"2",max:"4",av:"f"},first:{min:"1",max:"1",av:"a"},top:{min:"2",max:"2",av:"a"},orderby:{min:"2",max:"2",av:"f"},"boolean":{min:"1",max:"1",av:"a"},dictionary:{min:"0",max:"*",av:"a"},servicearea:{min:"2",max:"*",av:"f"},equals:{min:"2",max:"2",av:"a"},"typeof":{min:"1",max:"1",av:"a"},reverse:{min:"1",max:"1",av:"a"},replace:{min:"3",max:"4",av:"a"},sort:{min:"1",max:"2",av:"a"},feature:{min:"1",max:"*",av:"a"},haskey:{min:"2",max:"2",av:"a"},indexof:{min:"2",
max:"2",av:"a"},centroid:{min:"1",max:"1",av:"f"},multiparttosinglepart:{min:"1",max:"1",av:"f"}};l.checkFunctionSignature=a;l.findFunction=d;l.validateLanguageNode=b;l.testValidityOfExpression=f;l.referencesMemberImpl=k;l.referencesMember=function(a,c){return!0===k(a.body[0].body,c.toLowerCase())?!0:!1};l.referencesFunctionImpl=m;l.referencesFunction=function(a,c){return!0===m(a.body[0].body,c)?!0:!1};l.findFieldLiteralsImpl=g;l.findFieldLiterals=function(a,c){return g(a.body[0].body,c)};l.extractFunctionDeclaration=
e;l.validateFunction=c;l.constructGlobalScope=n;l.validateScript=function(a,c,b){void 0===b&&(b="full");c={globalScope:n(c.vars,l.functionDecls,c.customFunctions,b),localScope:null};return f(a.body[0].body,c)};l.validateLanguage=function(a){return"BlockStatement"!==a.body[0].body.type?"Invalid formula content.":b(a.body[0].body)};l.nodeErrorMessage=q;l.makeError=r;l.extractAllIssuesInFunction=u;l.extractAllIssues=v;l.checkScript=function(a,c,b,e){void 0===e&&(e="full");var d=[];if("BlockStatement"!==
a.body[0].body.type)return[{line:0,character:0,reason:"Invalid Body"}];null!==c&&void 0!==c||(c={vars:{},customFunctions:[]});c={globalScope:n(c.vars,l.functionDecls,c.customFunctions,e),localScope:null};try{v(a.body[0].body,c,b,d)}catch(g){}return d}})},"esri/arcade/Feature":function(){define("require exports dojo/_base/lang ../geometry/Geometry ../graphic ../geometry/jsonUtils ./Dictionary ./languageUtils ./ImmutableArray ../geometry/Point".split(" "),function(h,l,a,d,b,f,k,m,g,e){return function(){function c(a,
e,g){(this.geometry=null,this.attributes=null,this._layer=null,this._datesfixed=!0,this.immutable=!0,a instanceof c)?(this.attributes=a.attributes,this.geometry=a.geometry,a._layer&&(this._layer=a._layer)):a instanceof b?(this.geometry=a.geometry,void 0===a.attributes?this.attributes={}:null===a.attributes?this.attributes={}:this.attributes=a.attributes,a._layer?(this._layer=a._layer,this._datesfixed=!1):a.layer&&(this._layer=a.layer,this._datesfixed=!1)):a instanceof k?(this.attributes=a.field("attributes"),
null!==this.attributes&&(this.attributes instanceof k?this.attributes=this.attributes.attributes:this.attributes=null),this.geometry=a.field("geometry"),null!==this.geometry&&(this.geometry instanceof k?this.geometry=c.parseGeometryFromDictionary(this.geometry):this.geometry instanceof d||(this.geometry=null))):(e instanceof d||null===e?(this.geometry=e,void 0===a?this.attributes={}:null===a?this.attributes={}:this.attributes=a):"string"==typeof a?(a=JSON.parse(a),null!==a.geometry&&void 0!==a.geometry&&
(this.geometry=f.fromJson(a.geometry)),void 0===a.attributes?this.attributes={}:null===a.attributes?this.attributes={}:this.attributes=a.attributes):(void 0===a?this.attributes={}:null===a&&(this.attributes={}),this.geometry=null),void 0!==g&&(this._layer=g))}return c.prototype.castToText=function(){var a="",c;for(c in this.attributes){""!==a&&(a+=",");var b=this.attributes[c];null==b||(m.isBoolean(b)||m.isNumber(b)||m.isString(b)?a+=JSON.stringify(c)+":"+JSON.stringify(b):b instanceof d?a+=JSON.stringify(c)+
":"+m.toStringExplicit(b):b instanceof g?a+=JSON.stringify(c)+":"+m.toStringExplicit(b):b instanceof Array?a+=JSON.stringify(c)+":"+m.toStringExplicit(b):b instanceof Date?a+=JSON.stringify(c)+":"+JSON.stringify(b):null!==b&&"object"==typeof b&&void 0!==b.castToText&&(a+=JSON.stringify(c)+":"+b.castToText()))}return'{"geometry":'+(null===this.geometry?"null":m.toStringExplicit(this.geometry))+',"attributes":{'+a+"}}"},c.prototype._fixDates=function(){for(var a=[],c=0;c<this._layer.fields.length;c++){var b=
this._layer.fields[c];"date"!==b.type&&"esriFieldTypeDate"!==b.type||a.push(b.name)}0<a.length&&this._fixDateFields(a);this._datesfixed=!0},c.prototype._fixDateFields=function(c){this.attributes=a.mixin({},this.attributes);for(var b=0;b<c.length;b++){var e=this.attributes[c[b]];if(null!==e)if(void 0===e)for(var d in this.attributes){if(d.toLowerCase()===c[b]){e=this.attributes[d];null!==e&&(e instanceof Date||(this.attributes[d]=new Date(e)));break}}else e instanceof Date||(this.attributes[c[b]]=
new Date(e))}},c.prototype.field=function(a){!1===this._datesfixed&&this._fixDates();var c=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var b in this.attributes)if(b.toLowerCase()===c)return this.attributes[b];if(this._hasFieldDefinition(c))return null;throw Error("Field not Found");},c.prototype._hasFieldDefinition=function(a){if(null===this._layer)return!1;for(var c=0;c<this._layer.fields.length;c++)if(this._layer.fields[c].name.toLowerCase()===a)return!0;return!1},c.prototype._field=
function(a){!1===this._datesfixed&&this._fixDates();var c=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var b in this.attributes)if(b.toLowerCase()===c)return this.attributes[b];return null},c.prototype.setField=function(a,c){if(this.immutable)throw Error("Feature is Immutable");if(!1===m.isSimpleType(c))throw Error("Illegal Value Assignment to Feature");var b=a.toLowerCase();if(void 0!==this.attributes[a])return void(this.attributes[a]=c);for(var e in this.attributes)if(e.toLowerCase()===
b)return void(this.attributes[e]=c);this.attributes[a]=c},c.prototype.hasField=function(a){var c=a.toLowerCase();if(void 0!==this.attributes[a])return!0;for(var b in this.attributes)if(b.toLowerCase()===c)return!0;return this._hasFieldDefinition(c)?!0:!1},c.prototype.keys=function(){var a=[],c={},b;for(b in this.attributes)a.push(b),c[b.toLowerCase()]=1;if(null!==this._layer)for(b=0;b<this._layer.fields.length;b++){var e=this._layer.fields[b];1!==c[e.name.toLowerCase()]&&a.push(e.name)}return a.sort()},
c.fromFeature=function(a){return new c(a)},c.parseGeometryFromDictionary=function(a){a=c.convertDictionaryToJson(a,!0);return void 0!==a.spatialreference&&(a.spatialReference=a.spatialreference,delete a.spatialreference),void 0!==a.rings&&(a.rings=this.fixPathArrays(a.rings,!0===a.hasZ,!0===a.hasM)),void 0!==a.paths&&(a.paths=this.fixPathArrays(a.paths,!0===a.hasZ,!0===a.hasM)),void 0!==a.points&&(a.points=this.fixPointArrays(a.points,!0===a.hasZ,!0===a.hasM)),f.fromJson(a)},c.fixPathArrays=function(a,
c,b){var e=[];if(a instanceof Array)for(var d=0;d<a.length;d++)e.push(this.fixPointArrays(a[d],c,b));else if(a instanceof g)for(d=0;d<a.length();d++)e.push(this.fixPointArrays(a.get(d),c,b));return e},c.fixPointArrays=function(a,c,b){var d=[];if(a instanceof Array)for(var f=0;f<a.length;f++){var k=a[f];k instanceof e?c&&b?d.push([k.x,k.y,k.z,k.m]):c?d.push([k.x,k.y,k.z]):b?d.push([k.x,k.y,k.m]):d.push([k.x,k.y]):d.push(k)}else if(a instanceof g)for(f=0;f<a.length();f++)k=a.get(f),k instanceof e?c&&
b?d.push([k.x,k.y,k.z,k.m]):c?d.push([k.x,k.y,k.z]):b?d.push([k.x,k.y,k.m]):d.push([k.x,k.y]):d.push(k);return d},c.convertDictionaryToJson=function(a,b){void 0===b&&(b=!1);var e={},d;for(d in a.attributes){var g=a.attributes[d];g instanceof k&&(g=c.convertDictionaryToJson(g));b?e[d.toLowerCase()]=g:e[d]=g}return e},c.parseAttributesFromDictionary=function(a){var c={},b;for(b in a.attributes){var e=a.attributes[b];if(!m.isSimpleType(e))throw Error("Illegal Argument");c[b]=e}return c},c.fromJson=function(a){var b=
null;null!==a.geometry&&void 0!==a.geometry&&(b=f.fromJson(a.geometry));var e={};if(null!==a.attributes&&void 0!==a.attributes)for(var d in a.attributes){var g=a.attributes[d];if(!(m.isString(g)||m.isNumber(g)||m.isBoolean(g)||m.isDate(g)))throw Error("Illegal Argument");e[d]=g}return new c(e,b)},c.prototype.domainValueLookup=function(a,c,b){if(null===this._layer||!this._layer.fields)return null;b=m.getDomain(a,this._layer,this,b);if(void 0===c)try{c=this.field(a)}catch(e){return null}return m.getDomainValue(b,
c)},c.prototype.domainCodeLookup=function(a,c,b){if(null===this._layer||!this._layer.fields)return null;a=m.getDomain(a,this._layer,this,b);return m.getDomainCode(a,c)},c}()})},"esri/arcade/functions/date":function(){define(["require","exports","../../moment","../languageUtils"],function(h,l,a,d){function b(a){return null===a?a:isNaN(a.getTime())?null:a}l.registerFunctions=function(f,k){f.today=function(a,b){return k(a,b,function(a,c,b){d.pcCheck(b,0,0);a=new Date;return a.setHours(0,0,0,0),a})};
f.now=function(a,b){return k(a,b,function(a,c,b){d.pcCheck(b,0,0);return new Date})};f.timestamp=function(a,b){return k(a,b,function(a,c,b){d.pcCheck(b,0,0);a=new Date;return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())})};f.toutc=function(a,b){return k(a,b,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?null:new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),
a.getUTCSeconds(),a.getUTCMilliseconds())})};f.tolocal=function(b,g){return k(b,g,function(b,c,g){d.pcCheck(g,1,1);b=d.toDate(g[0]);return null===b?null:a.utc([b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds(),b.getMilliseconds()]).toDate()})};f.day=function(a,b){return k(a,b,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getDate()})};f.month=function(a,b){return k(a,b,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:
a.getMonth()})};f.year=function(a,b){return k(a,b,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getFullYear()})};f.hour=function(a,b){return k(a,b,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getHours()})};f.second=function(a,b){return k(a,b,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getSeconds()})};f.millisecond=function(a,b){return k(a,b,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getMilliseconds()})};
f.minute=function(a,b){return k(a,b,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getMinutes()})};f.weekday=function(a,b){return k(a,b,function(a,c,b){d.pcCheck(b,1,1);a=d.toDate(b[0]);return null===a?NaN:a.getDay()})};f.date=function(f,g){return k(f,g,function(e,c,g){if(d.pcCheck(g,0,7),3===g.length)return b(new Date(d.toNumber(g[0]),d.toNumber(g[1]),d.toNumber(g[2]),0,0,0,0));if(4===g.length)return b(new Date(d.toNumber(g[0]),d.toNumber(g[1]),d.toNumber(g[2]),d.toNumber(g[3]),
0,0,0));if(5===g.length)return b(new Date(d.toNumber(g[0]),d.toNumber(g[1]),d.toNumber(g[2]),d.toNumber(g[3]),d.toNumber(g[4]),0,0));if(6===g.length)return b(new Date(d.toNumber(g[0]),d.toNumber(g[1]),d.toNumber(g[2]),d.toNumber(g[3]),d.toNumber(g[4]),d.toNumber(g[5]),0));if(7===g.length)return b(new Date(d.toNumber(g[0]),d.toNumber(g[1]),d.toNumber(g[2]),d.toNumber(g[3]),d.toNumber(g[4]),d.toNumber(g[5]),d.toNumber(g[6])));if(2===g.length){e=d.toString(g[1]);if(""===e)return null;e=d.standardiseDateFormat(e);
g=a(d.toString(g[0]),e,!0);return!0===g.isValid()?g.toDate():null}if(1===g.length){if(d.isString(g[0])&&""===g[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))return null;e=d.toNumber(g[0]);return!1===isNaN(e)?b(new Date(e)):d.toDate(g[0])}return 0===g.length?new Date:void 0})};f.datediff=function(a,b){return k(a,b,function(a,c,b){d.pcCheck(b,2,3);a=d.toDateM(b[0]);c=d.toDateM(b[1]);if(null===a||null===c)return NaN;switch(d.toString(b[2]).toLowerCase()){case "days":case "day":case "d":return a.diff(c,
"days",!0);case "months":case "month":return a.diff(c,"months",!0);case "minutes":case "minute":case "m":return"M"===b[2]?a.diff(c,"months",!0):a.diff(c,"minutes",!0);case "seconds":case "second":case "s":return a.diff(c,"seconds",!0);case "milliseconds":case "millisecond":case "ms":return a.diff(c);case "hours":case "hour":case "h":return a.diff(c,"hours",!0);case "years":case "year":case "y":return a.diff(c,"years",!0);default:return a.diff(c)}})};f.dateadd=function(a,b){return k(a,b,function(a,
c,b){d.pcCheck(b,2,3);a=d.toDateM(b[0]);if(null===a)return null;c="milliseconds";switch(d.toString(b[2]).toLowerCase()){case "days":case "day":case "d":c="days";break;case "months":case "month":c="months";break;case "minutes":case "minute":case "m":c="M"===b[2]?"months":"minutes";break;case "seconds":case "second":case "s":c="seconds";break;case "milliseconds":case "millisecond":case "ms":c="milliseconds";break;case "hours":case "hour":case "h":c="hours";break;case "years":case "year":case "y":c=
"years"}return a.add(d.toNumber(b[1]),c),a.toDate()})}}})},"esri/arcade/functions/string":function(){define(["require","exports","../languageUtils","../Feature"],function(h,l,a,d){l.registerFunctions=function(b,f){b.trim=function(b,d){return f(b,d,function(b,e,c){return a.pcCheck(c,1,1),a.toString(c[0]).trim()})};b.upper=function(b,d){return f(b,d,function(b,e,c){return a.pcCheck(c,1,1),a.toString(c[0]).toUpperCase()})};b.proper=function(b,d){return f(b,d,function(b,e,c){a.pcCheck(c,1,2);b=1;2===
c.length&&"firstword"===a.toString(c[1]).toLowerCase()&&(b=2);e=/\s/;c=a.toString(c[0]);for(var d="",f=!0,k=0;k<c.length;k++){var m=c[k];e.test(m)?1===b&&(f=!0):m.toUpperCase()!==m.toLowerCase()&&(f?(m=m.toUpperCase(),f=!1):m=m.toLowerCase());d+=m}return d})};b.lower=function(b,d){return f(b,d,function(b,e,c){return a.pcCheck(c,1,1),a.toString(c[0]).toLowerCase()})};b.guid=function(b,d){return f(b,d,function(b,e,c){if(a.pcCheck(c,0,1),0<c.length)switch(a.toString(c[0]).toLowerCase()){case "digits":return a.generateUUID().replace("-",
"").replace("-","").replace("-","").replace("-","");case "digits-hyphen":return a.generateUUID();case "digits-hyphen-parentheses":return"("+a.generateUUID()+")"}return"{"+a.generateUUID()+"}"})};b.console=function(b,d){return f(b,d,function(d,e,c){return 0===c.length||(1===c.length?b.console(a.toString(c[0])):b.console(a.toString(c))),a.voidOperation})};b.mid=function(b,d){return f(b,d,function(b,e,c){a.pcCheck(c,2,3);b=a.toNumber(c[1]);if(isNaN(b))return"";if(0>b&&(b=0),2===c.length)return a.toString(c[0]).substr(b);
e=a.toNumber(c[2]);return isNaN(e)?"":(0>e&&(e=0),a.toString(c[0]).substr(b,e))})};b.find=function(b,d){return f(b,d,function(b,e,c){a.pcCheck(c,2,3);b=0;if(2<c.length){if(b=a.toNumber(a.defaultUndefined(c[2],0)),isNaN(b))return-1;0>b&&(b=0)}return a.toString(c[1]).indexOf(a.toString(c[0]),b)})};b.left=function(b,d){return f(b,d,function(b,e,c){a.pcCheck(c,2,2);b=a.toNumber(c[1]);return isNaN(b)?"":(0>b&&(b=0),a.toString(c[0]).substr(0,b))})};b.right=function(b,d){return f(b,d,function(b,e,c){a.pcCheck(c,
2,2);b=a.toNumber(c[1]);return isNaN(b)?"":(0>b&&(b=0),a.toString(c[0]).substr(-1*b,b))})};b.split=function(b,d){return f(b,d,function(b,e,c){a.pcCheck(c,2,4);var d;b=a.toNumber(a.defaultUndefined(c[2],-1));e=a.toBoolean(a.defaultUndefined(c[3],!1));if(-1===b||null===b||!0===e?d=a.toString(c[0]).split(a.toString(c[1])):(isNaN(b)&&(b=-1),-1>b&&(b=-1),d=a.toString(c[0]).split(a.toString(c[1]),b)),!1===e)return d;c=[];for(e=0;e<d.length&&!(-1!==b&&c.length>=b);e++)""!==d[e]&&void 0!==d[e]&&c.push(d[e]);
return c})};b.text=function(b,d){return f(b,d,function(b,e,c){return a.pcCheck(c,1,2),a.toStringExplicit(c[0],c[1])})};b.concatenate=function(b,d){return f(b,d,function(b,e,c){b=[];if(1>c.length)return"";if(a.isArray(c[0])){e=a.defaultUndefined(c[2],"");for(var d=0;d<c[0].length;d++)b[d]=a.toStringExplicit(c[0][d],e);return 1<c.length?b.join(c[1]):b.join("")}if(a.isImmutableArray(c[0])){e=a.defaultUndefined(c[2],"");for(d=0;d<c[0].length();d++)b[d]=a.toStringExplicit(c[0].get(d),e);return 1<c.length?
b.join(c[1]):b.join("")}for(d=0;d<c.length;d++)b[d]=a.toStringExplicit(c[d]);return b.join("")})};b.reverse=function(b,d){return f(b,d,function(b,e,c){if(a.pcCheck(c,1,1),a.isArray(c[0]))return b=c[0].slice(0),b.reverse(),b;if(a.isImmutableArray(c[0]))return b=c[0].toArray().slice(0),b.reverse(),b;throw Error("Invalid Parameter");})};b.replace=function(b,d){return f(b,d,function(b,e,c){a.pcCheck(c,3,4);b=a.toString(c[0]);e=a.toString(c[1]);var d=a.toString(c[2]);return(4===c.length?a.toBoolean(c[3]):
1)?a.multiReplace(b,e,d):b.replace(e,d)})};b.domainname=function(b,m){return f(b,m,function(b,e,c){if(a.pcCheck(c,2,4),c[0]instanceof d)return c[0].domainValueLookup(a.toString(c[1]),c[2],void 0===c[3]?void 0:a.toNumber(c[3]));throw Error("Invalid Parameter");})};b.domaincode=function(b,m){return f(b,m,function(b,e,c){if(a.pcCheck(c,3,4),c[0]instanceof d)return c[0].domainCodeLookup(a.toString(c[1]),c[2],void 0===c[3]?void 0:a.toNumber(c[3]));throw Error("Invalid Parameter");})}}})},"esri/arcade/functions/maths":function(){define(["require",
"exports","../languageUtils","dojo/number"],function(h,l,a,d){function b(a,b,d){return"undefined"==typeof d||0===+d?Math[a](b):(b=+b,d=+d,isNaN(b)||"number"!=typeof d||0!==d%1?NaN:(b=b.toString().split("e"),b=Math[a](+(b[0]+"e"+(b[1]?+b[1]-d:-d))),b=b.toString().split("e"),+(b[0]+"e"+(b[1]?+b[1]+d:d))))}l.registerFunctions=function(f,k){f.number=function(b,g){return k(b,g,function(b,c,g){a.pcCheck(g,1,2);b=g[0];return a.isNumber(b)?b:null===b?0:a.isDate(b)||a.isBoolean(b)||""===b||void 0===b?Number(b):
a.isString(b)?void 0!==g[1]?(g=a.multiReplace(g[1],"\u2030",""),g=a.multiReplace(g,"\u00a4",""),d.parse(b,{pattern:g})):Number(b.trim()):Number(b)})};f.abs=function(b,d){return k(b,d,function(b,c,d){return a.pcCheck(d,1,1),Math.abs(a.toNumber(d[0]))})};f.acos=function(b,d){return k(b,d,function(b,c,d){return a.pcCheck(d,1,1),Math.acos(a.toNumber(d[0]))})};f.asin=function(b,d){return k(b,d,function(b,c,d){return a.pcCheck(d,1,1),Math.asin(a.toNumber(d[0]))})};f.atan=function(b,d){return k(b,d,function(b,
c,d){return a.pcCheck(d,1,1),Math.atan(a.toNumber(d[0]))})};f.atan2=function(b,d){return k(b,d,function(b,c,d){return a.pcCheck(d,2,2),Math.atan2(a.toNumber(d[0]),a.toNumber(d[1]))})};f.ceil=function(d,g){return k(d,g,function(e,c,d){return(a.pcCheck(d,1,2),2===d.length)?(e=a.toNumber(d[1]),isNaN(e)&&(e=0),b("ceil",a.toNumber(d[0]),-1*e)):Math.ceil(a.toNumber(d[0]))})};f.round=function(d,g){return k(d,g,function(e,c,d){return(a.pcCheck(d,1,2),2===d.length)?(e=a.toNumber(d[1]),isNaN(e)&&(e=0),b("round",
a.toNumber(d[0]),-1*e)):Math.round(a.toNumber(d[0]))})};f.floor=function(d,g){return k(d,g,function(e,c,d){return(a.pcCheck(d,1,2),2===d.length)?(e=a.toNumber(d[1]),isNaN(e)&&(e=0),b("floor",a.toNumber(d[0]),-1*e)):Math.floor(a.toNumber(d[0]))})};f.cos=function(b,d){return k(b,d,function(b,c,d){return a.pcCheck(d,1,1),Math.cos(a.toNumber(d[0]))})};f.isnan=function(b,d){return k(b,d,function(b,c,d){return a.pcCheck(d,1,1),"number"==typeof d[0]&&isNaN(d[0])})};f.exp=function(b,d){return k(b,d,function(b,
c,d){return a.pcCheck(d,1,1),Math.exp(a.toNumber(d[0]))})};f.log=function(b,d){return k(b,d,function(b,c,d){return a.pcCheck(d,1,1),Math.log(a.toNumber(d[0]))})};f.pow=function(b,d){return k(b,d,function(b,c,d){return a.pcCheck(d,2,2),Math.pow(a.toNumber(d[0]),a.toNumber(d[1]))})};f.random=function(b,d){return k(b,d,function(b,c,d){return a.pcCheck(d,0,0),Math.random()})};f.sin=function(b,d){return k(b,d,function(b,c,d){return a.pcCheck(d,1,1),Math.sin(a.toNumber(d[0]))})};f.sqrt=function(b,d){return k(b,
d,function(b,c,d){return a.pcCheck(d,1,1),Math.sqrt(a.toNumber(d[0]))})};f.tan=function(b,d){return k(b,d,function(b,c,d){return a.pcCheck(d,1,1),Math.tan(a.toNumber(d[0]))})};f.defaultvalue=function(b,d){return k(b,d,function(b,c,d){return a.pcCheck(d,2,2),null===d[0]?d[1]:""===d[0]?d[1]:void 0===d[0]?d[1]:d[0]})};f.isempty=function(b,d){return k(b,d,function(b,c,d){return a.pcCheck(d,1,1),null===d[0]?!0:""===d[0]?!0:void 0===d[0]?!0:!1})};f["boolean"]=function(b,d){return k(b,d,function(b,c,d){a.pcCheck(d,
1,1);return a.toBoolean(d[0])})}}})},"esri/arcade/functions/geometry":function(){define("require exports ../../geometry/Geometry ../../geometry/Polygon ../../geometry/Polyline ../../geometry/Point ../../geometry/Extent ../../geometry/Multipoint ../../geometry/jsonUtils ../languageUtils ../Dictionary ../Feature".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n){l.registerFunctions=function(h,r){h.polygon=function(a,b){return r(a,b,function(b,f,k){e.pcCheck(k,1,1);b=null;if(k[0]instanceof c){if(b=e.fixSpatialReference(n.parseGeometryFromDictionary(k[0]),
a.spatialReference),0==b instanceof d)throw Error("Illegal Parameter");}else b=k[0]instanceof d?g.fromJson(k[0].toJson()):e.fixSpatialReference(new d(JSON.parse(k[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return b})};h.polyline=function(a,d){return r(a,d,function(d,f,k){e.pcCheck(k,1,1);d=null;if(k[0]instanceof c){if(d=e.fixSpatialReference(n.parseGeometryFromDictionary(k[0]),
a.spatialReference),0==d instanceof b)throw Error("Illegal Parameter");}else d=k[0]instanceof b?g.fromJson(k[0].toJson()):e.fixSpatialReference(new b(JSON.parse(k[0])),a.spatialReference);if(null!==d&&!1===d.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return d})};h.point=function(a,b){return r(a,b,function(b,d,k){e.pcCheck(k,1,1);b=null;if(k[0]instanceof c){if(b=e.fixSpatialReference(n.parseGeometryFromDictionary(k[0]),
a.spatialReference),0==b instanceof f)throw Error("Illegal Parameter");}else b=k[0]instanceof f?g.fromJson(k[0].toJson()):e.fixSpatialReference(new f(JSON.parse(k[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return b})};h.multipoint=function(a,b){return r(a,b,function(b,d,f){e.pcCheck(f,1,1);b=null;if(f[0]instanceof c){if(b=e.fixSpatialReference(n.parseGeometryFromDictionary(f[0]),
a.spatialReference),0==b instanceof m)throw Error("Illegal Parameter");}else b=f[0]instanceof m?g.fromJson(f[0].toJson()):e.fixSpatialReference(new m(JSON.parse(f[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return b})};h.extent=function(a,h){return r(a,h,function(h,r,l){e.pcCheck(l,1,1);h=null;l[0]instanceof c?h=e.fixSpatialReference(n.parseGeometryFromDictionary(l[0]),
a.spatialReference):l[0]instanceof f?(h={xmin:l[0].x,ymin:l[0].y,xmax:l[0].x,ymax:l[0].y,spatialReference:l[0].spatialReference.toJson()},l[0].hasZ?(h.zmin=l[0].z,h.zmax=l[0].z):l[0].hasM&&(h.mmin=l[0].m,h.mmax=l[0].m),h=g.fromJson(h)):h=l[0]instanceof d?g.fromJson(l[0].getExtent().toJson()):l[0]instanceof b?g.fromJson(l[0].getExtent().toJson()):l[0]instanceof m?g.fromJson(l[0].getExtent().toJson()):l[0]instanceof k?g.fromJson(l[0].toJson()):e.fixSpatialReference(new k(JSON.parse(l[0])),a.spatialReference);
if(null!==h&&!1===h.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return h})};h.geometry=function(a,b){return r(a,b,function(b,d,f){e.pcCheck(f,1,1);b=null;if(b=f[0]instanceof n?e.fixSpatialReference(f[0].geometry,a.spatialReference):f[0]instanceof c?e.fixSpatialReference(n.parseGeometryFromDictionary(f[0]),a.spatialReference):e.fixSpatialReference(g.fromJson(JSON.parse(f[0])),a.spatialReference),
null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return b})};h.feature=function(b,d){return r(b,d,function(d,g,f){if(0===f.length)throw Error("Missing Parameters");d=null;if(1===f.length)if(e.isString(f[0]))d=n.fromJson(JSON.parse(f[0]));else if(f[0]instanceof n)d=new n(f[0]);else if(f[0]instanceof a)d=new n(null,f[0]);else{if(!(f[0]instanceof c))throw Error("Illegal Argument");
d=f[0].hasField("geometry")?f[0].field("geometry"):null;g=f[0].hasField("attributes")?f[0].field("attributes"):null;null!==d&&d instanceof c&&(d=n.parseGeometryFromDictionary(d));null!==g&&(g=n.parseAttributesFromDictionary(g));d=new n(g,d)}else{if(2===f.length){g=d=null;if(null!==f[0])if(f[0]instanceof a)d=f[0];else{if(!(d instanceof c))throw Error("Illegal Argument");d=n.parseGeometryFromDictionary(f[0])}if(null!==f[1]){if(!(f[1]instanceof c))throw Error("Illegal Argument");g=n.parseAttributesFromDictionary(f[1])}}else{d=
null;g={};if(null!==f[0])if(f[0]instanceof a)d=f[0];else{if(!(d instanceof c))throw Error("Illegal Argument");d=n.parseGeometryFromDictionary(f[0])}for(var k=1;k<f.length;k+=2){var m=e.toString(f[k]),h=f[k+1];if(!(null===h||void 0===h||e.isString(h)||isNaN(h)||e.isDate(h)||e.isNumber(h)||e.isBoolean(h)))throw Error("Illegal Argument");if(e.isFunctionParameter(h)||!1===e.isSimpleType(h))throw Error("Illegal Argument");h===e.voidOperation?g[m]=null:g[m]=h}}d=new n(g,d)}return d.geometry=e.fixSpatialReference(d.geometry,
b.spatialReference),d.immutable=!1,d})};h.dictionary=function(a,b){return r(a,b,function(a,b,d){if(0===d.length)throw Error("Missing Parameters");if(0!==d.length%2)throw Error("Missing Parameters");a={};for(b=0;b<d.length;b+=2){var g=e.toString(d[b]),f=d[b+1];if(!(null===f||void 0===f||e.isString(f)||isNaN(f)||e.isDate(f)||e.isNumber(f)||e.isBoolean(f)))throw Error("Illegal Argument");if(e.isFunctionParameter(f))throw Error("Illegal Argument");f===e.voidOperation?a[g]=null:a[g]=f}d=new c(a);return d.immutable=
!1,d})};h.haskey=function(a,b){return r(a,b,function(a,b,d){e.pcCheck(d,2,2);a=e.toString(d[1]);if(d[0]instanceof n||d[0]instanceof c)return d[0].hasField(a);throw Error("Illegal Argument");})};h.indexof=function(a,b){return r(a,b,function(a,b,c){e.pcCheck(c,2,2);a=c[1];if(e.isArray(c[0])){for(b=0;b<c[0].length;b++)if(e.equalityTest(a,c[0][b]))return b;return-1}if(e.isImmutableArray(c[0])){var d=c[0].length();for(b=0;d>b;b++)if(e.equalityTest(a,c[0].get(b)))return b;return-1}throw Error("Illegal Argument");
})}}})},"esri/arcade/functions/stats":function(){define(["require","exports","../languageUtils","./fieldStats"],function(h,l,a,d){function b(b,k,m,g){if(1===g.length){if(a.isArray(g[0]))return d.calculateStat(b,g[0],-1);if(a.isImmutableArray(g[0]))return d.calculateStat(b,g[0].toArray(),-1)}return d.calculateStat(b,g,-1)}l.registerFunctions=function(d,k){d.stdev=function(a,d){return k(a,d,function(a,c,d){return b("stdev",a,c,d)})};d.variance=function(a,d){return k(a,d,function(a,c,d){return b("variance",
a,c,d)})};d.average=function(a,d){return k(a,d,function(a,c,d){return b("mean",a,c,d)})};d.mean=function(a,d){return k(a,d,function(a,c,d){return b("mean",a,c,d)})};d.sum=function(a,d){return k(a,d,function(a,c,d){return b("sum",a,c,d)})};d.min=function(a,d){return k(a,d,function(a,c,d){return b("min",a,c,d)})};d.max=function(a,d){return k(a,d,function(a,c,d){return b("max",a,c,d)})};d.distinct=function(a,d){return k(a,d,function(a,c,d){return b("distinct",a,c,d)})};d.count=function(b,d){return k(b,
d,function(b,c,d){if(a.pcCheck(d,1,1),a.isArray(d[0])||a.isString(d[0]))return d[0].length;if(a.isImmutableArray(d[0]))return d[0].length();throw Error("Invalid Parameters for Count");})}}})},"esri/arcade/functions/fieldStats":function(){define(["require","exports","../languageUtils"],function(h,l,a){function d(a){for(var b=0,d=0;d<a.length;d++)b+=a[d];return b/a.length}function b(a){for(var b=d(a),m=0,g=0;g<a.length;g++)m+=Math.pow(b-a[g],2);return m/a.length}l.decodeStatType=function(a){switch(a.toLowerCase()){case "distinct":return"distinct";
case "avg":case "mean":return"avg";case "min":return"min";case "sum":return"sum";case "max":return"max";case "stdev":case "stddev":return"stddev";case "var":case "variance":return"var";case "count":return"count"}return""};l.calculateStat=function(f,k,m){switch(void 0===m&&(m=1E3),f.toLowerCase()){case "distinct":a:{f=m;m=[];for(var g={},e=[],c=0;c<k.length;c++){if(void 0!==k[c]&&null!==k[c]&&k[c]!==a.voidOperation){var n=k[c];if(a.isNumber(n)||a.isString(n))void 0===g[n]&&(m.push(n),g[n]=1);else{for(var h=
!1,r=0;r<e.length;r++)!0===a.equalityTest(e[r],n)&&(h=!0);!1===h&&(e.push(n),m.push(n))}}if(m.length>=f&&-1!==f){k=m;break a}}k=m}return k;case "avg":case "mean":return d(a.toNumberArray(k));case "min":return Math.min.apply(Math,a.toNumberArray(k));case "sum":k=a.toNumberArray(k);for(m=f=0;m<k.length;m++)f+=k[m];return f;case "max":return Math.max.apply(Math,a.toNumberArray(k));case "stdev":case "stddev":return Math.sqrt(b(a.toNumberArray(k)));case "var":case "variance":return b(a.toNumberArray(k));
case "count":return k.length}return 0}})},"esri/arcade/parser":function(){define(["require","exports","./treeAnalysis","./lib/esprima"],function(h,l,a,d){l.parseScript=function(b){b=d.parse("function _() { "+b+"\n}");if(null===b.body||void 0===b.body)throw Error("No formula provided.");if(0===b.body.length)throw Error("No formula provided.");if(0===b.body.length)throw Error("No formula provided.");if("BlockStatement"!==b.body[0].body.type)throw Error("Invalid formula content.");var f=a.validateLanguage(b);
if(""!==f)throw Error(f);return b};l.scriptCheck=function(b,f,k,m){var g=[];try{var e=d.parse("function _() { "+b+"\n}",{tolerant:!0,loc:!0}),c=e.errors;if(0<c.length)for(var n=0;n<c.length;n++)g.push({line:c[n].lineNumber,character:c[n].column,reason:c[n].description});var h=a.checkScript(e,f,k,m);for(f=0;f<h.length;f++)g.push(h[f])}catch(r){try{"Unexpected token }"===r.description&&(r.index=("function _() { "+b+"\n}").length-1)?g.push({line:r.lineNumber,character:r.column,reason:"Unexpected end of script"}):
g.push({line:r.lineNumber,character:r.column,reason:r.description})}catch(u){}}return g};l.extractFieldLiterals=function(b,d){return void 0===d&&(d=!1),a.findFieldLiterals(b,d)};l.validateScript=function(b,d,k){return void 0===k&&(k="full"),a.validateScript(b,d,k)};l.referencesMember=function(b,d){return a.referencesMember(b,d)};l.referencesFunction=function(b,d){return a.referencesFunction(b,d)}})},"esri/arcade/lib/esprima":function(){!function(h,l){"function"==typeof define&&define.amd?define(["exports"],
l):l("undefined"!=typeof exports?exports:h.esprima={})}(this,function(h){function l(a,b){if(!a)throw Error("ASSERT: "+b);}function a(a){return 48<=a&&57>=a}function d(a){return 0<="0123456789abcdefABCDEF".indexOf(a)}function b(a){return 0<="01234567".indexOf(a)}function f(a){return 10===a||13===a||8232===a||8233===a}function k(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||92===a||128<=a&&xa.NonAsciiIdentifierStart.test(String.fromCharCode(a))}function m(a){return 36===a||95===a||65<=a&&90>=
a||97<=a&&122>=a||48<=a&&57>=a||92===a||128<=a&&xa.NonAsciiIdentifierPart.test(String.fromCharCode(a))}function g(a){switch(a){default:return!1}}function e(a){if(ma&&g(a))return!0;switch(a=a.toLowerCase(),a.length){case 2:return"if"===a||"in"===a;case 3:return"var"===a||"for"===a;case 4:return"else"===a;case 5:return"break"===a;case 6:return"return"===a;case 8:return"function"===a.toLowerCase()||"continue"===a;default:return!1}}function c(a,b,c,d,e){var g;l("number"==typeof c,"Comment must have valid position");
da.lastCommentStart>=c||(da.lastCommentStart=c,g={type:a,value:b},V.range&&(g.range=[c,d]),V.loc&&(g.loc=e),V.comments.push(g),V.attachComment&&(V.leadingComments.push(g),V.trailingComments.push(g)))}function n(a){var b,d,e,g;b=P-a;for(d={start:{line:ha,column:P-ga-a}};na>P;)if(e=X.charCodeAt(P),++P,f(e))return V.comments&&(g=X.slice(b+a,P-1),d.end={line:ha,column:P-ga-1},c("Line",g,b,P-1,d)),13===e&&10===X.charCodeAt(P)&&++P,++ha,void(ga=P);V.comments&&(g=X.slice(b+a,P),d.end={line:ha,column:P-ga},
c("Line",g,b,P,d))}function q(){var a,b;for(b=0===P;na>P;)if(a=X.charCodeAt(P),32===a||9===a||11===a||12===a||160===a||5760<=a&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(a))++P;else if(f(a))++P,13===a&&10===X.charCodeAt(P)&&++P,++ha,ga=P,b=!0;else if(47===a)if(a=X.charCodeAt(P+1),47===a)++P,++P,n(2),b=!0;else{if(42!==a)break;++P;++P;a:{var d=void 0,e=void 0,g=void 0,k=void 0;for(V.comments&&(d=P-2,e={start:{line:ha,column:P-ga-2}});na>P;)if(g=
X.charCodeAt(P),f(g))13===g&&10===X.charCodeAt(P+1)&&++P,++ha,++P,ga=P,P>=na&&N();else{if(42===g&&47===X.charCodeAt(P+1)){++P;++P;V.comments&&(k=X.slice(d+2,P-2),e.end={line:ha,column:P-ga},c("Block",k,d,P,e));break a}++P}N()}}else if(b&&45===a){if(45!==X.charCodeAt(P+1)||62!==X.charCodeAt(P+2))break;P+=3;n(3)}else{if(60!==a)break;if("!--"!==X.slice(P+1,P+4))break;++P;++P;++P;++P;n(4)}}function r(a){var b,c,e=0;b="u"===a?4:2;for(a=0;b>a;++a){if(!(na>P&&d(X[P])))return"";c=X[P++];e=16*e+"0123456789abcdef".indexOf(c.toLowerCase())}return String.fromCharCode(e)}
function u(){var a,b;a=X.charCodeAt(P++);b=String.fromCharCode(a);for(92===a&&(117!==X.charCodeAt(P)&&N(),++P,a=r("u"),a&&"\\"!==a&&k(a.charCodeAt(0))||N(),b=a);na>P&&(a=X.charCodeAt(P),m(a));)++P,b+=String.fromCharCode(a),92===a&&(b=b.substr(0,b.length-1),117!==X.charCodeAt(P)&&N(),++P,a=r("u"),a&&"\\"!==a&&m(a.charCodeAt(0))||N(),b+=a);return b}function v(){var a,b,c,d,e=P,g=X.charCodeAt(P),f=X[P];switch(g){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++P,
V.tokenize&&(40===g?V.openParenToken=V.tokens.length:123===g&&(V.openCurlyToken=V.tokens.length)),{type:Y.Punctuator,value:String.fromCharCode(g),lineNumber:ha,lineStart:ga,start:e,end:P};default:if(a=X.charCodeAt(P+1),61===a)switch(g){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return P+=2,{type:Y.Punctuator,value:String.fromCharCode(g)+String.fromCharCode(a),lineNumber:ha,lineStart:ga,start:e,end:P};case 33:case 61:return P+=2,61===X.charCodeAt(P)&&++P,{type:Y.Punctuator,
value:X.slice(e,P),lineNumber:ha,lineStart:ga,start:e,end:P}}}return d=X.substr(P,4),"\x3e\x3e\x3e\x3d"===d?(P+=4,{type:Y.Punctuator,value:d,lineNumber:ha,lineStart:ga,start:e,end:P}):(c=d.substr(0,3),"\x3e\x3e\x3e"===c||"\x3c\x3c\x3d"===c||"\x3e\x3e\x3d"===c?(P+=3,{type:Y.Punctuator,value:c,lineNumber:ha,lineStart:ga,start:e,end:P}):(b=c.substr(0,2),f===b[1]&&0<="+-\x3c\x3e\x26|".indexOf(f)||"\x3d\x3e"===b?(P+=2,{type:Y.Punctuator,value:b,lineNumber:ha,lineStart:ga,start:e,end:P}):0<="\x3c\x3e\x3d!+-*%\x26|^/".indexOf(f)?
(++P,{type:Y.Punctuator,value:f,lineNumber:ha,lineStart:ga,start:e,end:P}):void N()))}function t(){var c,e,g;if(g=X[P],l(a(g.charCodeAt(0))||"."===g,"Numeric literal must start with a decimal digit or a decimal point"),e=P,c="","."!==g){if(c=X[P++],g=X[P],"0"===c){if("x"===g||"X"===g){++P;for(var f="";na>P&&d(X[P]);)f+=X[P++];return 0===f.length&&N(),k(X.charCodeAt(P))&&N(),{type:Y.NumericLiteral,value:parseInt("0x"+f,16),lineNumber:ha,lineStart:ga,start:e,end:P}}if("b"===g||"B"===g){++P;for(c="";na>
P&&(f=X[P],"0"===f||"1"===f);)c+=X[P++];return 0===c.length&&N(),na>P&&(f=X.charCodeAt(P),(k(f)||a(f))&&N()),{type:Y.NumericLiteral,value:parseInt(c,2),lineNumber:ha,lineStart:ga,start:e,end:P}}if("o"===g||"O"===g||b(g)){var m,n;for(b(g)?(n=!0,m="0"+X[P++]):(n=!1,++P,m="");na>P&&b(X[P]);)m+=X[P++];return n||0!==m.length||N(),(k(X.charCodeAt(P))||a(X.charCodeAt(P)))&&N(),{type:Y.NumericLiteral,value:parseInt(m,8),octal:n,lineNumber:ha,lineStart:ga,start:e,end:P}}g&&a(g.charCodeAt(0))&&N()}for(;a(X.charCodeAt(P));)c+=
X[P++];g=X[P]}if("."===g){for(c+=X[P++];a(X.charCodeAt(P));)c+=X[P++];g=X[P]}if("e"===g||"E"===g)if(c+=X[P++],g=X[P],("+"===g||"-"===g)&&(c+=X[P++]),a(X.charCodeAt(P)))for(;a(X.charCodeAt(P));)c+=X[P++];else N();return k(X.charCodeAt(P))&&N(),{type:Y.NumericLiteral,value:parseFloat(c),lineNumber:ha,lineStart:ga,start:e,end:P}}function w(){ba=null;q();I("Regular Expression language structures not supported")}function x(){q();w()}function y(){var a,b;if(a=V.tokens[V.tokens.length-1],!a)return x();if("Punctuator"===
a.type){if("]"===a.value)return v();if(")"===a.value)return b=V.tokens[V.openParenToken-1],!b||"Keyword"!==b.type||"if"!==b.value.toLowerCase()&&"while"!==b.value.toLowerCase()&&"for"!==b.value.toLowerCase()&&"with"!==b.value.toLowerCase()?v():x();if("}"===a.value){if(V.tokens[V.openCurlyToken-3]&&"Keyword"===V.tokens[V.openCurlyToken-3].type){if(b=V.tokens[V.openCurlyToken-4],!b)return v()}else{if(!V.tokens[V.openCurlyToken-4]||"Keyword"!==V.tokens[V.openCurlyToken-4].type)return v();if(b=V.tokens[V.openCurlyToken-
5],!b)return x()}return 0<=Ya.indexOf(b.value)?v():x()}return x()}return"Keyword"===a.type&&"this"!==a.value?x():v()}function z(){var c;q();var g;if(P>=na)g={type:Y.EOF,lineNumber:ha,lineStart:ga,start:P,end:P};else if(c=X.charCodeAt(P),k(c)){var n,h;g=P;var w;if(92===X.charCodeAt(P))w=u();else a:{var x;for(w=P++;na>P;){if(x=X.charCodeAt(P),92===x){w=(P=w,u());break a}if(!m(x))break;++P}w=X.slice(w,P)}g=(n=w,h=1===n.length?Y.Identifier:e(n)?Y.Keyword:"null"===n.toLowerCase()?Y.NullLiteral:"true"===
n.toLowerCase()||"false"===n.toLowerCase()?Y.BooleanLiteral:Y.Identifier,{type:h,value:n,lineNumber:ha,lineStart:ga,start:g,end:P})}else if(40===c||41===c||59===c)g=v();else if(39===c||34===c){var C,A,z="",D=!1;x=ha;c=ga;n=X[P];l("'"===n||'"'===n,"String literal must starts with a quote");h=P;for(++P;na>P;){if(g=X[P++],g===n){n="";break}if("\\"===g)if(g=X[P++],g&&f(g.charCodeAt(0)))++ha,"\r"===g&&"\n"===X[P]&&++P,ga=P;else switch(g){case "u":case "x":if("{"===X[P]){++P;C=z;var B,E=B=void 0,z=A=void 0;
B=X[P];E=0;for("}"===B&&N();na>P&&(B=X[P++],d(B));)E=16*E+"0123456789abcdef".indexOf(B.toLowerCase());B=((1114111<E||"}"!==B)&&N(),65535>=E?String.fromCharCode(E):(A=(E-65536>>10)+55296,z=(E-65536&1023)+56320,String.fromCharCode(A,z)));z=C+B}else A=P,(C=r(g))?z+=C:(P=A,z+=g);break;case "n":z+="\n";break;case "r":z+="\r";break;case "t":z+="\t";break;case "b":z+="\b";break;case "f":z+="\f";break;case "v":z+="\x0B";break;default:b(g)?(w="01234567".indexOf(g),0!==w&&(D=!0),na>P&&b(X[P])&&(D=!0,w=8*w+
"01234567".indexOf(X[P++]),0<="0123".indexOf(g)&&na>P&&b(X[P])&&(w=8*w+"01234567".indexOf(X[P++]))),z+=String.fromCharCode(w)):z+=g}else{if(f(g.charCodeAt(0)))break;z+=g}}g=(""!==n&&N(),{type:Y.StringLiteral,value:z,octal:D,startLineNumber:x,startLineStart:c,lineNumber:ha,lineStart:ga,start:h,end:P})}else g=46===c?a(X.charCodeAt(P+1))?t():v():a(c)?t():V.tokenize&&47===c?y():v();return g}function A(){var a,b,c,d;return q(),a={start:{line:ha,column:P-ga}},b=z(),a.end={line:ha,column:P-ga},b.type!==
Y.EOF&&(c=X.slice(b.start,b.end),d={type:Ia[b.type],value:c,range:[b.start,b.end],loc:a},b.regex&&(d.regex={pattern:b.regex.pattern,flags:b.regex.flags}),V.tokens.push(d)),b}function B(){var a;return a=ba,P=a.end,ha=a.lineNumber,ga=a.lineStart,ba="undefined"!=typeof V.tokens?A():z(),P=a.end,ha=a.lineNumber,ga=a.lineStart,a}function C(){var a,b,c;a=P;b=ha;c=ga;ba="undefined"!=typeof V.tokens?A():z();P=a;ha=b;ga=c}function D(){this.line=ha;this.column=P-ga}function E(){this.start=new D;this.end=null}
function F(a){a.type===Y.StringLiteral?this.start={line:a.startLineNumber,column:a.start-a.startLineStart}:this.start={line:a.lineNumber,column:a.start-a.lineStart};this.end=null}function H(){P=ba.start;ba.type===Y.StringLiteral?(ha=ba.startLineNumber,ga=ba.startLineStart):(ha=ba.lineNumber,ga=ba.lineStart);V.range&&(this.range=[P,0]);V.loc&&(this.loc=new E)}function G(a){V.range&&(this.range=[a.start,0]);V.loc&&(this.loc=new F(a))}function K(){var a,b,c,d;return a=P,b=ha,c=ga,q(),d=ha!==b,P=a,ha=
b,ga=c,d}function J(a,b,c){var d=Error("Line "+a+": "+c);return d.index=b,d.lineNumber=a,d.column=b-ga+1,d.description=c,d}function I(a){var b,c;throw b=Array.prototype.slice.call(arguments,1),c=a.replace(/%(\d)/g,function(a,c){return l(c<b.length,"Message reference must be in range"),b[c]}),J(ha,P,c);}function L(a){var b,c,d;if(b=Array.prototype.slice.call(arguments,1),c=a.replace(/%(\d)/g,function(a,c){return l(c<b.length,"Message reference must be in range"),b[c]}),d=J(ha,P,c),!V.errors)throw d;
V.errors.push(d)}function M(a,b){var c=ia.UnexpectedToken;a&&(c=b?b:a.type===Y.EOF?ia.UnexpectedEOS:a.type===Y.Identifier?ia.UnexpectedIdentifier:a.type===Y.NumericLiteral?ia.UnexpectedNumber:a.type===Y.StringLiteral?ia.UnexpectedString:ia.UnexpectedToken,a.type===Y.Keyword&&ma&&g(a.value)&&(c=ia.StrictReservedWord));return c=c.replace("%0",a?a.value:"ILLEGAL"),a&&"number"==typeof a.lineNumber?J(a.lineNumber,a.start,c):J(ha,P,c)}function N(a,b){throw M(a,b);}function Q(a,b){var c=M(a,b);if(!V.errors)throw c;
V.errors.push(c)}function O(a){var b=B();b.type===Y.Punctuator&&b.value===a||N(b)}function T(){var a;V.errors?(a=ba,a.type===Y.Punctuator&&","===a.value?B():a.type===Y.Punctuator&&";"===a.value?(B(),Q(a)):Q(a,ia.UnexpectedToken)):O(",")}function S(a){var b=B();b.type===Y.Keyword&&b.value.toLowerCase()===a.toLowerCase()||N(b)}function R(a){return ba.type===Y.Punctuator&&ba.value===a}function U(a){return ba.type===Y.Keyword&&ba.value.toLowerCase()===a.toLowerCase()}function W(){var a;return 59===X.charCodeAt(P)||
R(";")?void B():(a=ha,q(),void(ha===a&&(ba.type===Y.EOF||R("}")||N(ba))))}function fa(a){return a.type===aa.Identifier||a.type===aa.MemberExpression}function ea(a,b){var c,d,e=new H;return c=ma,d=Sa(),ma=c,e.finishFunctionExpression(null,a,[],d)}function oa(){var a,b,c;return a=ma,ma=!0,b=Pa(),c=ea(b.params),ma=a,c}function pa(){var a,b=new H;return a=B(),a.type===Y.StringLiteral||a.type===Y.NumericLiteral?(ma&&a.octal&&Q(a,ia.StrictOctalLiteral),b.finishLiteral(a)):b.finishIdentifier(a.value)}function Aa(){var a,
b,c,d,e,g=new H;if(a=ba,a.type===Y.Identifier)return c=pa(),"get"!==a.value||R(":")||R("(")?"set"!==a.value||R(":")||R("(")?R(":")?(B(),d=ra(),g.finishProperty("init",c,d,!1,!1)):R("(")?(d=oa(),g.finishProperty("init",c,d,!0,!1)):(d=c,g.finishProperty("init",c,d,!1,!0)):(b=pa(),O("("),a=ba,a.type!==Y.Identifier?(O(")"),Q(a),d=ea([])):(e=[wa()],O(")"),d=ea(e,a)),g.finishProperty("set",b,d,!1,!1)):(b=pa(),O("("),O(")"),d=ea([]),g.finishProperty("get",b,d,!1,!1));if(a.type===Y.EOF||a.type===Y.Punctuator)N(a);
else{if(b=pa(),R(":"))return B(),d=ra(),g.finishProperty("init",b,d,!1,!1);if(R("("))return d=oa(),g.finishProperty("init",b,d,!0,!1);N(B())}}function ta(a){var b,c,d=[],e={},g=String,f=new H;for(!0!==a&&O("{");!R("}");)a=Aa(),b=a.key.type===aa.Identifier?a.key.name:g(a.key.value),c="init"===a.kind?Ma.Data:"get"===a.kind?Ma.Get:Ma.Set,b="$"+b,Object.prototype.hasOwnProperty.call(e,b)?(e[b]===Ma.Data?ma&&c===Ma.Data?L(ia.StrictDuplicateProperty):c!==Ma.Data&&L(ia.AccessorDataProperty):c===Ma.Data?
L(ia.AccessorDataProperty):e[b]&c&&L(ia.AccessorGetSet),e[b]|=c):e[b]=c,d.push(a),R("}")||T();return O("}"),f.finishObjectExpression(d)}function va(){var a,b,c,d;if(R("("))return O("("),R(")")?(B(),Ua.ArrowParameterPlaceHolder):(++da.parenthesisCount,d=za(),O(")"),d);if(R("[")){var e=[],f=new H;for(O("[");!R("]");)R(",")?(B(),e.push(null)):(e.push(ra()),R("]")||O(","));return B(),f.finishArrayExpression(e)}if(R("{"))return ta();if(a=ba.type,d=new H,a===Y.Identifier)c=d.finishIdentifier(B().value);
else if(a===Y.StringLiteral||a===Y.NumericLiteral)ma&&ba.octal&&Q(ba,ia.StrictOctalLiteral),c=d.finishLiteral(B());else if(a===Y.Keyword){if(U("function")){var k,m,n,h,r;a=null;b=[];c=[];d=new H;return S("function"),R("(")||(e=ba,a=wa(),ma||g(e.value)&&(k=e,m=ia.StrictReservedWord)),n=Pa(k),b=n.params,c=n.defaults,f=n.stricted,k=n.firstRestricted,n.message&&(m=n.message),r=ma,h=Sa(),ma&&k&&N(k,m),ma&&f&&Q(f,m),ma=r,d.finishFunctionExpression(a,b,c,h)}U("this")?(B(),c=d.finishThisExpression()):N(B())}else a===
Y.BooleanLiteral?(b=B(),b.value="true"===b.value.toLowerCase(),c=d.finishLiteral(b)):a===Y.NullLiteral?(b=B(),b.value=null,c=d.finishLiteral(b)):R("/")||R("/\x3d")?(c="undefined"!=typeof V.tokens?d.finishLiteral(x()):d.finishLiteral(w()),C()):N(B());return c}function ua(){var a=[];if(O("("),!R(")"))for(;na>P&&(a.push(ra()),!R(")"));)T();return O(")"),a}function qa(){var a,b=new H;return a=B(),a.type===Y.Identifier||a.type===Y.Keyword||a.type===Y.BooleanLiteral||a.type===Y.NullLiteral||N(a),b.finishIdentifier(a.value)}
function ca(){var a;return O("["),a=za(),O("]"),a}function ja(){var a,b,c=new H;S("new");var d,e,g;l(da.allowIn,"callee of new expression always allow in keyword.");g=ba;for(d=U("new")?ja():va();;)if(R("["))e=ca(),d=(new G(g)).finishMemberExpression("[",d,e);else{if(!R("."))break;e=(O("."),qa());d=(new G(g)).finishMemberExpression(".",d,e)}return a=d,b=R("(")?ua():[],c.finishNewExpression(a,b)}function la(){var a,b,c=ba,d,e,g,f=da.allowIn;g=ba;da.allowIn=!0;for(d=U("new")?ja():va();;)if(R("."))e=
(O("."),qa()),d=(new G(g)).finishMemberExpression(".",d,e);else if(R("("))e=ua(),d=(new G(g)).finishCallExpression(d,e);else{if(!R("["))break;e=ca();d=(new G(g)).finishMemberExpression("[",d,e)}return a=(da.allowIn=f,d),ba.type===Y.Punctuator&&(!R("++")&&!R("--")||K()||(fa(a)||L(ia.InvalidLHSInAssignment),b=B(),a=(new G(c)).finishPostfixExpression(b.value,a))),a}function ka(){var a,b,c;return ba.type!==Y.Punctuator&&ba.type!==Y.Keyword?b=la():R("++")||R("--")?(c=ba,a=B(),b=ka(),fa(b)||L(ia.InvalidLHSInAssignment),
b=(new G(c)).finishUnaryExpression(a.value,b)):R("+")||R("-")||R("~")||R("!")?(c=ba,a=B(),b=ka(),b=(new G(c)).finishUnaryExpression(a.value,b)):U("delete")||U("void")||U("typeof")?(c=ba,a=B(),b=ka(),b=(new G(c)).finishUnaryExpression(a.value,b),ma&&"delete"===b.operator&&b.argument.type===aa.Identifier&&L(ia.StrictDelete)):b=la(),b}function sa(a,b){var c=0;if(a.type!==Y.Punctuator&&a.type!==Y.Keyword)return 0;switch(a.value){case "||":c=1;break;case "\x26\x26":c=2;break;case "|":c=3;break;case "^":c=
4;break;case "\x26":c=5;break;case "\x3d\x3d":case "!\x3d":case "\x3d\x3d\x3d":case "!\x3d\x3d":c=6;break;case "\x3c":case "\x3e":case "\x3c\x3d":case "\x3e\x3d":case "instanceof":c=7;break;case "in":c=b?7:0;break;case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":c=8;break;case "+":case "-":c=9;break;case "*":case "/":case "%":c=11}return c}function Ea(a){var b,c,d,e,g,f,k,m;e=[];g=[];f=0;k={paramSet:{}};b=0;for(c=a.length;c>b;b+=1)if(d=a[b],d.type===aa.Identifier)e.push(d),g.push(null),Ka(k,d,
d.name);else{if(d.type!==aa.AssignmentExpression)return null;e.push(d.left);g.push(d.right);++f;Ka(k,d.left,d.left.name)}return k.message===ia.StrictParamDupe&&(m=ma?k.stricted:k.firstRestricted,N(m,k.message)),0===f&&(g=[]),{params:e,defaults:g,rest:null,stricted:k.stricted,firstRestricted:k.firstRestricted,message:k.message}}function ra(){var a,b,c,d,e,g;a=da.parenthesisCount;b=g=ba;var f,k,m,n;c=ba;var h;var r,u,l,q,t;if((h=ba,r=ka(),r!==Ua.ArrowParameterPlaceHolder)&&(u=ba,l=sa(u,da.allowIn),
0!==l)){u.prec=l;B();h=[h,ba];t=ka();for(q=[r,u,t];0<(l=sa(ba,da.allowIn));){for(;2<q.length&&l<=q[q.length-2].prec;)t=q.pop(),u=q.pop().value,r=q.pop(),h.pop(),r=(new G(h[h.length-1])).finishBinaryExpression(u,r,t),q.push(r);u=B();u.prec=l;q.push(u);h.push(ba);r=ka();q.push(r)}l=q.length-1;r=q[l];for(h.pop();1<l;)r=(new G(h.pop())).finishBinaryExpression(q[l-1].value,q[l-2],r),l-=2}h=r;c=(f=h,f===Ua.ArrowParameterPlaceHolder?f:(R("?")&&(B(),k=da.allowIn,da.allowIn=!0,m=ra(),da.allowIn=k,O(":"),n=
ra(),f=(new G(c)).finishConditionalExpression(f,m,n)),f));if(c!==Ua.ArrowParameterPlaceHolder&&!R("\x3d\x3e")||da.parenthesisCount!==a&&da.parenthesisCount!==a+1||(c.type===aa.Identifier?e=Ea([c]):c.type===aa.AssignmentExpression?e=Ea([c]):c.type===aa.SequenceExpression?e=Ea(c.expressions):c===Ua.ArrowParameterPlaceHolder&&(e=Ea([])),!e)){var v;g=((ba.type!==Y.Punctuator?!1:(v=ba.value,"\x3d"===v||"*\x3d"===v||"/\x3d"===v||"%\x3d"===v||"+\x3d"===v||"-\x3d"===v||"\x3c\x3c\x3d"===v||"\x3e\x3e\x3d"===
v||"\x3e\x3e\x3e\x3d"===v||"\x26\x3d"===v||"^\x3d"===v||"|\x3d"===v))&&(fa(c)||L(ia.InvalidLHSInAssignment),b=B(),d=ra(),c=(new G(g)).finishAssignmentExpression(b.value,c,d)),c)}else{b=e;d=new G(g);var w,x;g=(O("\x3d\x3e"),w=ma,x=R("{")?Sa():ra(),ma&&b.firstRestricted&&N(b.firstRestricted,b.message),ma&&b.stricted&&Q(b.stricted,b.message),ma=w,d.finishArrowFunctionExpression(b.params,b.defaults,x,x.type!==aa.BlockStatement))}return g}function za(){var a,b=ba;if(a=ra(),R(",")){for(a=[a];na>P&&R(",");)B(),
a.push(ra());a=(new G(b)).finishSequenceExpression(a)}return a}function wa(){var a,b=new H;return a=B(),a.type!==Y.Identifier&&(ma&&a.type===Y.Keyword&&g(a.value)?Q(a,ia.StrictReservedWord):N(a)),b.finishIdentifier(a.value)}function Ha(a){var b,c=null,d=new H;return b=wa(),"const"===a?(O("\x3d"),c=ra()):R("\x3d")&&(B(),c=ra()),d.finishVariableDeclarator(b,c)}function Ga(a){var b=[];do{if(b.push(Ha(a)),!R(","))break;B()}while(na>P);return b}function Ca(a){var b,c,d,e,g=ba.type;if(g===Y.EOF&&N(ba),
g===Y.Punctuator&&"{"===ba.value){if(a){O("{");var f,m,n,h,r;f=ba;f=(m=P,n=ha,h=ga,B(),r=R(":"),ba=f,P=m,ha=n,ga=h,r);if(ba.type!==Y.Identifier&&ba.type!==Y.StringLiteral||!f){f=new H;for(var u=[];na>P&&!R("}")&&(e=Ta(),"undefined"!=typeof e);)u.push(e);f=(O("}"),f.finishBlockStatement(u))}else f=ta(!0);return f}return ta()}if(e=new H,g===Y.Punctuator)switch(ba.value){case ";":return f=new H,O(";"),f.finishEmptyStatement();case "(":return f=za(),W(),e.finishExpressionStatement(f)}else if(g===Y.Keyword)switch(ba.value.toLowerCase()){case "break":var l;
f=null;return S("break"),59===X.charCodeAt(P)?(B(),da.inIteration||da.inSwitch||I(ia.IllegalBreak),e.finishBreakStatement(null)):K()?(da.inIteration||da.inSwitch||I(ia.IllegalBreak),e.finishBreakStatement(null)):(ba.type===Y.Identifier&&(f=wa(),l="$"+f.name,Object.prototype.hasOwnProperty.call(da.labelSet,l)||I(ia.UnknownLabel,f.name)),W(),null!==f||da.inIteration||da.inSwitch||I(ia.IllegalBreak),e.finishBreakStatement(f));case "continue":var q;f=null;return S("continue"),59===X.charCodeAt(P)?(B(),
da.inIteration||I(ia.IllegalContinue),e.finishContinueStatement(null)):K()?(da.inIteration||I(ia.IllegalContinue),e.finishContinueStatement(null)):(ba.type===Y.Identifier&&(f=wa(),q="$"+f.name,Object.prototype.hasOwnProperty.call(da.labelSet,q)||I(ia.UnknownLabel,f.name)),W(),null!==f||da.inIteration||I(ia.IllegalContinue),e.finishContinueStatement(f));case "for":var t,v;h=da.allowIn;r=m=n=null;S("for");O("(");if(R(";"))B();else{if(U("var")){da.allowIn=!1;var w,x;r=new H;r=(w=B(),x=Ga(),r.finishVariableDeclaration(x,
w.value));da.allowIn=h;1===r.declarations.length&&U("in")&&(B(),f=r,u=za(),r=null)}else da.allowIn=!1,r=za(),da.allowIn=h,U("in")&&(fa(r)||L(ia.InvalidLHSInForIn),B(),f=r,u=za(),r=null);"undefined"==typeof f&&O(";")}return"undefined"==typeof f&&(R(";")||(m=za()),O(";"),R(")")||(n=za())),O(")"),v=da.inIteration,da.inIteration=!0,t=Ca(!0),da.inIteration=v,"undefined"==typeof f?e.finishForStatement(r,m,n,t):e.finishForInStatement(f,u,t);case "function":return La(e);case "if":var y,C,A;return S("if"),
O("("),y=za(),O(")"),C=Ca(!0),U("else")?(B(),A=Ca(!0)):A=null,e.finishIfStatement(y,C,A);case "return":return f=null,S("return"),da.inFunctionBody||L(ia.IllegalReturn),32===X.charCodeAt(P)&&k(X.charCodeAt(P+1))?(f=za(),W(),e.finishReturnStatement(f)):K()?e.finishReturnStatement(null):(R(";")||R("}")||ba.type===Y.EOF||(f=za()),W(),e.finishReturnStatement(f));case "var":var z;return S("var"),z=Ga(),W(),e.finishVariableDeclaration(z,"var")}return b=za(),b.type===aa.Identifier&&R(":")?(B(),d="$"+b.name,
Object.prototype.hasOwnProperty.call(da.labelSet,d)&&I(ia.Redeclaration,"Label",b.name),da.labelSet[d]=!0,c=Ca(!1),delete da.labelSet[d],e.finishLabeledStatement(b,c)):(W(),e.finishExpressionStatement(b))}function Sa(){var a,b,c,d,e,g,f=[],k=new H;for(O("{");na>P&&ba.type===Y.StringLiteral&&(b=ba,a=Ta(),f.push(a),a.expression.type===aa.Literal);)c=X.slice(b.start+1,b.end-1),"use strict"===c?(ma=!0,d&&Q(d,ia.StrictOctalLiteral)):!d&&b.octal&&(d=b);b=da.labelSet;c=da.inIteration;d=da.inSwitch;e=da.inFunctionBody;
g=da.parenthesizedCount;da.labelSet={};da.inIteration=!1;da.inSwitch=!1;da.inFunctionBody=!0;for(da.parenthesizedCount=0;na>P&&!R("}")&&(a=Ta(),"undefined"!=typeof a);)f.push(a);return O("}"),da.labelSet=b,da.inIteration=c,da.inSwitch=d,da.inFunctionBody=e,da.parenthesizedCount=g,k.finishBlockStatement(f)}function Ka(a,b,c){var d="$"+c;ma?Object.prototype.hasOwnProperty.call(a.paramSet,d)&&(a.stricted=b,a.message=ia.StrictParamDupe):a.firstRestricted||(g(c)?(a.firstRestricted=b,a.message=ia.StrictReservedWord):
Object.prototype.hasOwnProperty.call(a.paramSet,d)&&(a.firstRestricted=b,a.message=ia.StrictParamDupe));a.paramSet[d]=!0}function Wa(a){var b,c,d;return b=ba,c=wa(),Ka(a,b,b.value),R("\x3d")&&(B(),d=ra(),++a.defaultCount),a.params.push(c),a.defaults.push(d),!R(")")}function Pa(a){if(a={params:[],defaultCount:0,defaults:[],firstRestricted:a},O("("),!R(")"))for(a.paramSet={};na>P&&Wa(a);)O(",");return O(")"),0===a.defaultCount&&(a.defaults=[]),{params:a.params,defaults:a.defaults,stricted:a.stricted,
firstRestricted:a.firstRestricted,message:a.message}}function La(){var a,b,c,d,e,f,k,m,n=[],h=[],r=new H;return S("function"),c=ba,a=wa(),ma||g(c.value)&&(f=c,k=ia.StrictReservedWord),e=Pa(f),n=e.params,h=e.defaults,d=e.stricted,f=e.firstRestricted,e.message&&(k=e.message),m=ma,b=Sa(),ma&&f&&N(f,k),ma&&d&&Q(d,k),ma=m,r.finishFunctionDeclaration(a,n,h,b)}function Ta(){if(ba.type===Y.Keyword)switch(ba.value){default:return"function"===ba.value.toLowerCase()?La():Ca(!1)}return ba.type!==Y.EOF?Ca(!1):
void 0}function Na(){var a,b,c,d=[];for(a=0;a<V.tokens.length;++a)b=V.tokens[a],c={type:b.type,value:b.value},b.regex&&(c.regex={pattern:b.regex.pattern,flags:b.regex.flags}),V.range&&(c.range=b.range),V.loc&&(c.loc=b.loc),d.push(c);V.tokens=d}var Y,Ia,Ya,aa,Ua,Ma,ia,xa,X,ma,P,ha,ga,na,ba,da,V;Y={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9};Ia={};Ia[Y.BooleanLiteral]="Boolean";Ia[Y.EOF]="\x3cend\x3e";Ia[Y.Identifier]=
"Identifier";Ia[Y.Keyword]="Keyword";Ia[Y.NullLiteral]="Null";Ia[Y.NumericLiteral]="Numeric";Ia[Y.Punctuator]="Punctuator";Ia[Y.StringLiteral]="String";Ia[Y.RegularExpression]="RegularExpression";Ya="( { [ in typeof instanceof new return case delete throw void \x3d +\x3d -\x3d *\x3d /\x3d %\x3d \x3c\x3c\x3d \x3e\x3e\x3d \x3e\x3e\x3e\x3d \x26\x3d |\x3d ^\x3d , + - * / % ++ -- \x3c\x3c \x3e\x3e \x3e\x3e\x3e \x26 | ^ ! ~ \x26\x26 || ? : \x3d\x3d\x3d \x3d\x3d \x3e\x3d \x3c\x3d \x3c \x3e !\x3d !\x3d\x3d".split(" ");
aa={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",
FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator"};Ua={ArrowParameterPlaceHolder:{type:"ArrowParameterPlaceHolder"}};
Ma={Data:1,Get:2,Set:4};ia={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",
MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",
StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",
AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"};xa={NonAsciiIdentifierStart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"),
NonAsciiIdentifierPart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]")};
G.prototype=H.prototype={processComment:function(){var a,b,c,d,e,g=V.bottomRightStack,f=g[g.length-1];if(!(this.type===aa.Program&&0<this.body.length)){if(0<V.trailingComments.length){c=[];for(d=V.trailingComments.length-1;0<=d;--d)e=V.trailingComments[d],e.range[0]>=this.range[1]&&(c.unshift(e),V.trailingComments.splice(d,1));V.trailingComments=[]}else f&&f.trailingComments&&f.trailingComments[0].range[0]>=this.range[1]&&(c=f.trailingComments,delete f.trailingComments);if(f)for(;f&&f.range[0]>=this.range[0];)a=
f,f=g.pop();if(a)a.leadingComments&&a.leadingComments[a.leadingComments.length-1].range[1]<=this.range[0]&&(this.leadingComments=a.leadingComments,a.leadingComments=void 0);else if(0<V.leadingComments.length)for(b=[],d=V.leadingComments.length-1;0<=d;--d)e=V.leadingComments[d],e.range[1]<=this.range[0]&&(b.unshift(e),V.leadingComments.splice(d,1));b&&0<b.length&&(this.leadingComments=b);c&&0<c.length&&(this.trailingComments=c);g.push(this)}},finish:function(){V.range&&(this.range[1]=P);V.loc&&(this.loc.end=
new D,V.source&&(this.loc.source=V.source));V.attachComment&&this.processComment()},finishArrayExpression:function(a){return this.type=aa.ArrayExpression,this.elements=a,this.finish(),this},finishAssignmentExpression:function(a,b,c){return this.type=aa.AssignmentExpression,this.operator=a,this.left=b,this.right=c,this.finish(),this},finishBinaryExpression:function(a,b,c){return this.type="||"===a||"\x26\x26"===a?aa.LogicalExpression:aa.BinaryExpression,this.operator=a,this.left=b,this.right=c,this.finish(),
this},finishBlockStatement:function(a){return this.type=aa.BlockStatement,this.body=a,this.finish(),this},finishBreakStatement:function(a){return this.type=aa.BreakStatement,this.label=a,this.finish(),this},finishCallExpression:function(a,b){return this.type=aa.CallExpression,this.callee=a,this.arguments=b,this.finish(),this},finishConditionalExpression:function(a,b,c){return this.type=aa.ConditionalExpression,this.test=a,this.consequent=b,this.alternate=c,this.finish(),this},finishContinueStatement:function(a){return this.type=
aa.ContinueStatement,this.label=a,this.finish(),this},finishEmptyStatement:function(){return this.type=aa.EmptyStatement,this.finish(),this},finishExpressionStatement:function(a){return this.type=aa.ExpressionStatement,this.expression=a,this.finish(),this},finishForStatement:function(a,b,c,d){return this.type=aa.ForStatement,this.init=a,this.test=b,this.update=c,this.body=d,this.finish(),this},finishForInStatement:function(a,b,c){return this.type=aa.ForInStatement,this.left=a,this.right=b,this.body=
c,this.each=!1,this.finish(),this},finishFunctionDeclaration:function(a,b,c,d){return this.type=aa.FunctionDeclaration,this.id=a,this.params=b,this.defaults=c,this.body=d,this.rest=null,this.generator=!1,this.expression=!1,this.finish(),this},finishFunctionExpression:function(a,b,c,d){return this.type=aa.FunctionExpression,this.id=a,this.params=b,this.defaults=c,this.body=d,this.rest=null,this.generator=!1,this.expression=!1,this.finish(),this},finishIdentifier:function(a){return this.type=aa.Identifier,
this.name=a,this.finish(),this},finishIfStatement:function(a,b,c){return this.type=aa.IfStatement,this.test=a,this.consequent=b,this.alternate=c,this.finish(),this},finishLiteral:function(a){return this.type=aa.Literal,this.value=a.value,this.raw=X.slice(a.start,a.end),a.regex&&(this.regex=a.regex),this.finish(),this},finishMemberExpression:function(a,b,c){return this.type=aa.MemberExpression,this.computed="["===a,this.object=b,this.property=c,this.finish(),this},finishObjectExpression:function(a){return this.type=
aa.ObjectExpression,this.properties=a,this.finish(),this},finishPostfixExpression:function(a,b){return this.type=aa.UpdateExpression,this.operator=a,this.argument=b,this.prefix=!1,this.finish(),this},finishProgram:function(a){return this.type=aa.Program,this.body=a,this.finish(),this},finishProperty:function(a,b,c,d,e){return this.type=aa.Property,this.key=b,this.value=c,this.kind=a,this.method=d,this.shorthand=e,this.finish(),this},finishReturnStatement:function(a){return this.type=aa.ReturnStatement,
this.argument=a,this.finish(),this},finishUnaryExpression:function(a,b){return this.type="++"===a||"--"===a?aa.UpdateExpression:aa.UnaryExpression,this.operator=a,this.argument=b,this.prefix=!0,this.finish(),this},finishVariableDeclaration:function(a,b){return this.type=aa.VariableDeclaration,this.declarations=a,this.kind=b,this.finish(),this},finishVariableDeclarator:function(a,b){return this.type=aa.VariableDeclarator,this.id=a,this.init=b,this.finish(),this}};h.version="2.0.0-dev";h.tokenize=function(a,
b){var c,d;c=String;"string"==typeof a||a instanceof String||(a=c(a));X=a;P=0;ha=0<X.length?1:0;ga=0;na=X.length;ba=null;da={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};V={};b=b||{};b.tokens=!0;V.tokens=[];V.tokenize=!0;V.openParenToken=-1;V.openCurlyToken=-1;V.range="boolean"==typeof b.range&&b.range;V.loc="boolean"==typeof b.loc&&b.loc;"boolean"==typeof b.comment&&b.comment&&(V.comments=[]);"boolean"==typeof b.tolerant&&b.tolerant&&(V.errors=[]);try{if(C(),
ba.type===Y.EOF)return V.tokens;for(B();ba.type!==Y.EOF;)try{B()}catch(e){if(V.errors){V.errors.push(e);break}throw e;}Na();d=V.tokens;"undefined"!=typeof V.comments&&(d.comments=V.comments);"undefined"!=typeof V.errors&&(d.errors=V.errors)}catch(g){throw g;}finally{V={}}return d};h.parse=function(a,b){var c,d;d=String;"string"==typeof a||a instanceof String||(a=d(a));X=a;P=0;ha=0<X.length?1:0;ga=0;na=X.length;ba=null;da={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,inIteration:!1,
inSwitch:!1,lastCommentStart:-1};V={};"undefined"!=typeof b&&(V.range="boolean"==typeof b.range&&b.range,V.loc="boolean"==typeof b.loc&&b.loc,V.attachComment="boolean"==typeof b.attachComment&&b.attachComment,V.loc&&null!==b.source&&void 0!==b.source&&(V.source=d(b.source)),"boolean"==typeof b.tokens&&b.tokens&&(V.tokens=[]),"boolean"==typeof b.comment&&b.comment&&(V.comments=[]),"boolean"==typeof b.tolerant&&b.tolerant&&(V.errors=[]),V.attachComment&&(V.range=!0,V.comments=[],V.bottomRightStack=
[],V.trailingComments=[],V.leadingComments=[]));try{var e;q();C();e=new H;ma=!1;var g,f,k,m;for(d=[];na>P&&(f=ba,f.type===Y.StringLiteral)&&(g=Ta(),d.push(g),g.expression.type===aa.Literal);)k=X.slice(f.start+1,f.end-1),"use strict"===k?(ma=!0,m&&Q(m,ia.StrictOctalLiteral)):!m&&f.octal&&(m=f);for(;na>P&&(g=Ta(),"undefined"!=typeof g);)d.push(g);c=e.finishProgram(d);"undefined"!=typeof V.comments&&(c.comments=V.comments);"undefined"!=typeof V.tokens&&(Na(),c.tokens=V.tokens);"undefined"!=typeof V.errors&&
(c.errors=V.errors)}catch(n){throw n;}finally{V={}}return c};h.Syntax=function(){var a,b={};"function"==typeof Object.create&&(b=Object.create(null));for(a in aa)aa.hasOwnProperty(a)&&(b[a]=aa[a]);return"function"==typeof Object.freeze&&Object.freeze(b),b}()})},"esri/arcade/arcadeCompiler":function(){define("require exports ../geometry/Polygon ../graphic ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z){function A(a,b,c){try{return c(a,null,b)}catch(d){throw d;}}function B(a,b){try{switch(b.type){case "EmptyStatement":return"lc.voidOperation";case "VariableDeclarator":return H(a,b);case "VariableDeclaration":for(var d=[],e=0;e<b.declarations.length;e++)d.push(B(a,b.declarations[e]));return d.join("\n")+" \n lastStatement\x3d  lc.voidOperation; \n";case "BlockStatement":return F(a,b);case "FunctionDeclaration":var g=b.id.name.toLowerCase(),f={applicationCache:void 0===
a.applicationCache?null:a.applicationCache,spatialReference:a.spatialReference,console:a.console,symbols:a.symbols,localScope:{_SymbolsMap:{}},depthCounter:a.depthCounter+1,globalScope:a.globalScope};if(64<f.depthCounter)throw Error("Exceeded maximum function depth");for(var d="new lc.SizzleFunction( lang.functionDepthchecker(function() { var lastStatement \x3d lc.voidOperation; var lscope \x3d [];\n ",k=0;k<b.params.length;k++){var m=b.params[k].name.toLowerCase(),n=N(m,a);f.localScope._SymbolsMap[m]=
n;d+="lscope['"+n+"']\x3darguments["+k.toString()+"];\n"}(d+=F(f,b.body)+"\n return lastStatement; }, runtimeCtx))",d+="\n lastStatement \x3d lc.voidOperation; \n",void 0!==a.globalScope[g])?e="gscope['"+g+"']\x3d"+d:void 0!==a.globalScope._SymbolsMap[g]?e="gscope['"+a.globalScope._SymbolsMap[g]+"']\x3d"+d:(n=N(g,a),e=(a.globalScope._SymbolsMap[g]=n,"gscope['"+n+"']\x3d"+d));return e;case "ReturnStatement":var h;h=null===b.argument?"return lc.voidOperation;":"return "+B(a,b.argument)+";";return h;
case "IfStatement":if("AssignmentExpression"===b.test.type||"UpdateExpression"===b.test.type)throw Error(c.nodeErrorMessage(b.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var r=B(a,b.test),u=Q(a),l="var "+u+" \x3d "+r+";\n if ("+u+" \x3d\x3d\x3d true) {\n"+E(a,b.consequent)+"\n }\n";return l+=null!==b.alternate?"else if ("+u+"\x3d\x3d\x3dfalse)   { \n"+E(a,b.alternate)+"}\n":"else if ("+u+"\x3d\x3d\x3dfalse) { \n lastStatement \x3d lc.voidOperation;\n }\n",l+("else { lang.error({type: '"+
b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION'); \n}\n");case "ExpressionStatement":return"AssignmentExpression"===b.expression.type?"lastStatement \x3d lc.voidOperation; "+B(a,b.expression)+" \n ":"lastStatement \x3d "+B(a,b.expression)+";";case "AssignmentExpression":return D(a,b);case "UpdateExpression":return C(a,b);case "BreakStatement":return"break;";case "ContinueStatement":return"continue;";case "ForStatement":d="lastStatement \x3d lc.voidOperation; \n";null!==b.init&&(d+=B(a,b.init));
var q=Q(a),t=Q(a);return d+="var "+q+" \x3d true;",d+="\n do { ",null!==b.update&&(d+=" if ("+q+"\x3d\x3d\x3dfalse) {\n "+B(a,b.update)+"  \n}\n "+q+"\x3dfalse; \n"),null!==b.test&&(d+="var "+t+" \x3d "+B(a,b.test)+";",d+="if ("+t+"\x3d\x3d\x3dfalse) { break; } else if ("+t+"!\x3d\x3dtrue) { lang.error({type: '"+b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION');   }\n"),d+=B(a,b.body),null!==b.update&&(d+="\n "+B(a,b.update)),d+("\n"+q+" \x3d true; \n} while(true);  lastStatement \x3d lc.voidOperation;");
case "ForInStatement":var v=Q(a),w=Q(a),x=Q(a),y="var "+v+" \x3d "+B(a,b.right)+";\n";"VariableDeclaration"===b.left.type&&(y+=B(a,b.left));var A="VariableDeclaration"===b.left.type?b.left.declarations[0].id.name:b.left.name,A=A.toLowerCase(),d="";return null!==a.localScope&&(void 0!==a.localScope[A]?d="lscope['"+A+"']":void 0!==a.localScope._SymbolsMap[A]&&(d="lscope['"+a.localScope._SymbolsMap[A]+"']")),""===d&&(void 0!==a.globalScope[A]?d="gscope['"+A+"']":void 0!==a.globalScope._SymbolsMap[A]&&
(d="gscope['"+a.globalScope._SymbolsMap[A]+"']")),y+="if ("+v+"\x3d\x3d\x3dnull) {  lastStatement \x3d lc.voidOperation; }\n ",y+="else if (lc.isArray("+v+") || lc.isString("+v+")) {",y+="var "+w+"\x3d"+v+".length; \n",y+="for(var "+x+"\x3d0; "+x+"\x3c"+w+"; "+x+"++) {\n",y+=d+"\x3d"+x+";\n",y+=B(a,b.body),y+="\n}\n",y+=" lastStatement \x3d lc.voidOperation; \n",y+=" \n}\n",y+="else if (lc.isImmutableArray("+v+")) {",y+="var "+w+"\x3d"+v+".length(); \n",y+="for(var "+x+"\x3d0; "+x+"\x3c"+w+"; "+x+
"++) {\n",y+=d+"\x3d"+x+";\n",y+=B(a,b.body),y+="\n}\n",y+=" lastStatement \x3d lc.voidOperation; \n",y+=" \n}\n",y+="else if (( "+v+" instanceof lang.Dictionary) || ( "+v+" instanceof lang.Feature)) {",y+="var "+w+"\x3d"+v+".keys(); \n",y+="for(var "+x+"\x3d0; "+x+"\x3c"+w+".length; "+x+"++) {\n",y+=d+"\x3d"+w+"["+x+"];\n",y+=B(a,b.body),y+="\n}\n",y+=" lastStatement \x3d lc.voidOperation; \n",y+=" \n}\n",y+"else { lastStatement \x3d lc.voidOperation; } \n";case "Identifier":return K(a,b);case "MemberExpression":var z;
try{d=void 0,z=(d=!0===b.computed?B(a,b.property):"'"+b.property.name+"'","lang.member("+B(a,b.object)+","+d+")")}catch(fa){throw fa;}return z;case "Literal":return null===b.value||void 0===b.value?"null":JSON.stringify(b.value);case "ThisExpression":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "CallExpression":try{if("Identifier"!==b.callee.type)throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYNODESSUPPORTED"));var J=b.callee.name.toLowerCase(),e="";if(null!==a.localScope&&(void 0!==
a.localScope[J]?e="lscope['"+J+"']":void 0!==a.localScope._SymbolsMap[J]&&(e="lscope['"+a.localScope._SymbolsMap[J]+"']")),""===e&&(void 0!==a.globalScope[J]?e="gscope['"+J+"']":void 0!==a.globalScope._SymbolsMap[J]&&(e="gscope['"+a.globalScope._SymbolsMap[J]+"']")),""!==e){g="[";for(f=0;f<b.arguments.length;f++)0<f&&(g+=", "),g+=B(a,b.arguments[f]);d=(g+="]","lang.callfunc("+e+","+g+",runtimeCtx)")}else throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));}catch(G){throw G;}return d;case "UnaryExpression":var I;
try{I="lang.unary("+B(a,b.argument)+",'"+b.operator+"')"}catch(M){throw M;}return I;case "BinaryExpression":var L;try{L="lang.binary("+B(a,b.left)+","+B(a,b.right)+",'"+b.operator+"')"}catch(O){throw O;}return L;case "LogicalExpression":var W;try{if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)throw Error(c.nodeErrorMessage(b.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===b.right.type||"UpdateExpression"===b.right.type)throw Error(c.nodeErrorMessage(b.right,
"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));W="lang.logical("+B(a,b.left)+","+B(a,b.right)+",'"+b.operator+"')"}catch(R){throw R;}return W;case "ConditionalExpression":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{d=[];for(e=0;e<b.elements.length;e++)"Literal"===b.elements[e].type?d.push(B(a,b.elements[e])):d.push("lang.aCheck("+B(a,b.elements[e])+",'ArrayExpression')");k="["+d.join(",")+"]"}catch(T){throw T;}return k;case "ObjectExpression":d="lang.dictionary([";
for(e=0;e<b.properties.length;e++){var S=b.properties[e],U="Identifier"===S.key.type?"'"+S.key.name+"'":B(a,S.key),ia=B(a,S.value);0<e&&(d+=",");d+="lang.strCheck("+U+",'ObjectExpression'),lang.aCheck("+ia+", 'ObjectExpression')"}return d+"])";case "Property":throw Error("Should not get here");case "Array":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));default:throw Error(c.nodeErrorMessage(b,"RUNTIME","UNREOGNISED"));}}catch(xa){throw xa;}}function C(a,b){var c=null,d="";if("MemberExpression"===
b.argument.type)return c=B(a,b.argument.object),d=!0===b.argument.computed?B(a,b.argument.property):"'"+b.argument.property.name+"'","lang.memberupdate("+c+","+d+",'"+b.operator+"',"+b.prefix+")";if(c=b.argument.name.toLowerCase(),null!==a.localScope){if(void 0!==a.localScope[c])return"lang.update(lscope, '"+c+"','"+b.operator+"',"+b.prefix+")";if(void 0!==a.localScope._SymbolsMap[c])return"lang.update(lscope, '"+a.localScope._SymbolsMap[c]+"','"+b.operator+"',"+b.prefix+")"}if(void 0!==a.globalScope[c])return"lang.update(gscope, '"+
c+"','"+b.operator+"',"+b.prefix+")";if(void 0!==a.globalScope._SymbolsMap[c])return"lang.update(gscope, '"+a.globalScope._SymbolsMap[c]+"','"+b.operator+"',"+b.prefix+")";throw Error("Variable not recognised");}function D(a,b){var c=B(a,b.right),d=null,e="";if("MemberExpression"===b.left.type)return d=B(a,b.left.object),e=!0===b.left.computed?B(a,b.left.property):"'"+b.left.property.name+"'","lang.assignmember("+d+","+e+",'"+b.operator+"',"+c+");";if(d=b.left.name.toLowerCase(),null!==a.localScope){if(void 0!==
a.localScope[d])return"lscope['"+d+"']\x3dlang.assign("+c+",'"+b.operator+"', lscope['"+d+"']); ";if(void 0!==a.localScope._SymbolsMap[d])return"lscope['"+a.localScope._SymbolsMap[d]+"']\x3dlang.assign("+c+",'"+b.operator+"', lscope['"+a.localScope._SymbolsMap[d]+"']); "}if(void 0!==a.globalScope[d])return"gscope['"+d+"']\x3dlang.assign("+c+",'"+b.operator+"', gscope['"+d+"']); ";if(void 0!==a.globalScope._SymbolsMap[d])return"gscope['"+a.globalScope._SymbolsMap[d]+"']\x3dlang.assign("+c+",'"+b.operator+
"', gscope['"+a.globalScope._SymbolsMap[d]+"']); ";throw Error("Variable not recognised");}function E(a,b){return"BlockStatement"===b.type?B(a,b):"ReturnStatement"===b.type?B(a,b):"BreakStatement"===b.type?B(a,b):"ContinueStatement"===b.type?B(a,b):"UpdateExpression"===b.type?"lastStatement \x3d "+B(a,b)+";":"ExpressionStatement"===b.type?B(a,b):"ObjectExpression"===b.type?"lastStatement \x3d "+B(a,b)+";":B(a,b)}function F(a,b){for(var c="",d=0;d<b.body.length;d++)c+="ReturnStatement"===b.body[d].type?
B(a,b.body[d])+" \n":"BreakStatement"===b.body[d].type?B(a,b.body[d])+" \n":"ContinueStatement"===b.body[d].type?B(a,b.body[d])+" \n":"UpdateExpression"===b.body[d].type?"lastStatement \x3d "+B(a,b.body[d])+"; \n":"ObjectExpression"===b.body[d].type?"lastStatement \x3d "+B(a,b.body[d])+"; \n":B(a,b.body[d])+" \n";return c}function H(a,b){var c=null===b.init?null:B(a,b.init);c===e.voidOperation&&(c=null);var d=b.id.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[d])return"lscope['"+
d+"']\x3d"+c+";";if(void 0!==a.localScope._SymbolsMap[d])return"lscope['"+a.localScope._SymbolsMap[d]+"']\x3d"+c+";";var g=N(d,a);return a.localScope._SymbolsMap[d]=g,"lscope['"+g+"']\x3d"+c+";"}if(void 0!==a.globalScope[d])return"gscope['"+d+"']\x3d"+c+";";if(void 0!==a.globalScope._SymbolsMap[d])return"gscope['"+a.globalScope._SymbolsMap[d]+"']\x3d"+c+";";g=N(d,a);return a.globalScope._SymbolsMap[d]=g,"gscope['"+g+"']\x3d"+c+";"}function G(a,b,d){switch(b=b.toLowerCase()){case "hasz":return a=a.hasZ,
void 0===a?!1:a;case "hasm":return a=a.hasM,void 0===a?!1:a;case "spatialreference":return b=a.spatialReference._arcadeCacheId,void 0===b&&(d=!0,Object.freeze&&Object.isFrozen(a.spatialReference)&&(d=!1),d&&(S++,a.spatialReference._arcadeCacheId=S,b=S)),a=new n({wkt:a.spatialReference.wkt,wkid:a.spatialReference.wkid}),void 0!==b&&(a._arcadeCacheId="SPREF"+b.toString()),a}switch(a.type){case "extent":switch(b){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return a=
a[b],void 0!==a?a:null;case "type":return"Extent"}break;case "polygon":switch(b){case "rings":return b=e.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(S++,b=S,e.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new x(a.rings,a.spatialReference,!0===a.hasZ,!0===a.hasM,b);case "type":return"Polygon"}break;case "point":switch(b){case "x":case "y":case "z":case "m":return void 0!==a[b]?a[b]:null;case "type":return"Point"}break;case "polyline":switch(b){case "paths":return b=
e.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(S++,b=S,e.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new x(a.paths,a.spatialReference,!0===a.hasZ,!0===a.hasM,b);case "type":return"Polyline"}break;case "multipoint":switch(b){case "points":return b=e.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(S++,b=S,e.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new y(a.points,a.spatialReference,
!0===a.hasZ,!0===a.hasM,b,1);case "type":return"Multipoint"}}throw Error(c.nodeErrorMessage(d,"RUNTIME","PROPERTYNOTFOUND"));}function K(a,b){try{var d=b.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[d])return"lscope['"+d+"']";if(void 0!==a.localScope._SymbolsMap[d])return"lscope['"+a.localScope._SymbolsMap[d]+"']"}if(void 0!==a.globalScope[d])return"gscope['"+d+"']";if(void 0!==a.globalScope._SymbolsMap[d])return"gscope['"+a.globalScope._SymbolsMap[d]+"']";throw Error(c.nodeErrorMessage(b,
"RUNTIME","VARIABLENOTFOUND"));}catch(e){throw e;}}function J(c){return null===c?"":e.isArray(c)?"Array":e.isImmutableArray(c)?"Array":e.isDate(c)?"Date":e.isString(c)?"String":e.isBoolean(c)?"Boolean":e.isNumber(c)?"Number":c instanceof n?"Dictionary":c instanceof q?"Feature":c instanceof f?"Point":c instanceof a?"Polygon":c instanceof b?"Polyline":c instanceof m?"Multipoint":c instanceof k?"Extent":e.isFunctionParameter(c)?"Function":c===e.voidOperation?"":"number"==typeof c&&isNaN(c)?"Number":
"Unrecognised Type"}function I(a,b,c,d){try{if(e.equalityTest(b[c],d))return b[c+1];var g=b.length-c;return 1===g?b[c]:2===g?null:I(a,b,c+2,d)}catch(f){throw f;}}function L(a,b,c,d){try{if(!0===d)return b[c+1];if(3===b.length-c)return b[c+2];var g=b[c+2];if(!1===e.isBoolean(g))throw Error("WHEN needs boolean test conditions");return L(a,b,c+2,g)}catch(f){throw f;}}function M(a,b){var c=a.length,d=Math.floor(c/2),e;if(0===c)e=[];else if(1===c)e=[a[0]];else{e=M(a.slice(0,d),b);c=M(a.slice(d,c),b);for(d=
[];0<e.length||0<c.length;)if(0<e.length&&0<c.length){var g=b(e[0],c[0]);isNaN(g)&&(g=0);0>=g?(d.push(e[0]),e=e.slice(1)):(d.push(c[0]),c=c.slice(1))}else 0<e.length?(d.push(e[0]),e=e.slice(1)):0<c.length&&(d.push(c[0]),c=c.slice(1));e=d}return e}function N(a,b){return b.symbols.symbolCounter++,"_T"+b.symbols.symbolCounter.toString()}function Q(a){return a.symbols.symbolCounter++,"_Tvar"+a.symbols.symbolCounter.toString()}function O(a,b,c){var d={};a||(a={});c||(c={});d._SymbolsMap={};d.textformatting=
1;d.infinity=1;d.pi=1;for(var e in b)d[e]=1;for(e in c)d[e]=1;for(e in a)d[e]=1;return d}function T(a){}var S=0,R={};r.registerFunctions(R,A);u.registerFunctions(R,A);v.registerFunctions(R,A);t.registerFunctions(R,A);w.registerFunctions(R,A);R["typeof"]=function(a,b){return A(a,b,function(a,b,c){e.pcCheck(c,1,1);a=J(c[0]);if("Unrecognised Type"===a)throw Error("Unrecognised Type");return a})};R.iif=function(a,b){try{return A(a,b,function(a,b,c){if(e.pcCheck(c,3,3),!1===e.isBoolean(c[0]))throw Error("IF Function must have a boolean test condition");
return c[0]?c[1]:c[2]})}catch(c){throw c;}};R.decode=function(a,b){try{return A(a,b,function(b,c,d){if(2>d.length)throw Error("Missing Parameters");if(2===d.length)return d[1];if(0===(d.length-1)%2)throw Error("Must have a default value result.");return I(a,d,1,d[0])})}catch(c){throw c;}};R.when=function(a,b){try{return A(a,b,function(b,c,d){if(3>d.length)throw Error("Missing Parameters");if(0===d.length%2)throw Error("Must have a default value result.");b=d[0];if(!1===e.isBoolean(b))throw Error("WHEN needs boolean test conditions");
return L(a,d,0,b)})}catch(c){throw c;}};R.top=function(a,b){return A(a,b,function(a,b,c){if(e.pcCheck(c,2,2),e.isArray(c[0]))return e.toNumber(c[1])>=c[0].length?c[0].slice(0):c[0].slice(0,e.toNumber(c[1]));if(e.isImmutableArray(c[0]))return e.toNumber(c[1])>=c[0].length()?c[0].slice(0):c[0].slice(0,e.toNumber(c[1]));throw Error("Top cannot accept this parameter type");})};R.first=function(a,b){return A(a,b,function(a,b,c){return e.pcCheck(c,1,1),e.isArray(c[0])?0===c[0].length?null:c[0][0]:e.isImmutableArray(c[0])?
0===c[0].length()?null:c[0].get(0):null})};R.sort=function(a,b){return A(a,b,function(a,b,c){e.pcCheck(c,1,2);b=c[0];if(e.isImmutableArray(b)&&(b=b.toArray()),!1===e.isArray(b))throw Error("Illegal Argument");if(1<c.length){if(!1===e.isFunctionParameter(c[1]))throw Error("Illegal Argument");return b=M(b,function(b,d){return fa.callfunc(c[1],[b,d],a)})}if(0===b.length)return[];for(var d={},g=0;g<b.length;g++){var f=J(b[g]);""!==f&&(d[f]=!0)}if(!0===d.Array||!0===d.Dictionary||!0===d.Feature||!0===
d.Point||!0===d.Polygon||!0===d.Polyline||!0===d.Multipoint||!0===d.Extent||!0===d.Function)return b.slice(0);var g=0,f="",k;for(k in d)g++,f=k;return b=1<g||"String"===f?M(b,function(a,b){if(null===a||void 0===a||a===e.voidOperation)return null===b||void 0===b||b===e.voidOperation?0:1;if(null===b||void 0===b||b===e.voidOperation)return-1;var c=e.toString(a),d=e.toString(b);return d>c?-1:c===d?0:1}):"Number"===f?M(b,function(a,b){return a-b}):"Boolean"===f?M(b,function(a,b){return a===b?0:b?-1:1}):
"Date"===f?M(b,function(a,b){return b-a}):b.slice(0)})};for(var U in R)R[U]=new e.NativeFunction(R[U]);var W=function(){};W.prototype=R;l.functionHelper={fixSpatialReference:e.fixSpatialReference,parseArguments:function(a,b){for(var c=[],d=0;d<b.arguments.length;d++)c.push(B(a,b.arguments[d]));return c},standardFunction:A};l.executeScript=function(a,b,c){return a(b,c)};l.extractFieldLiterals=function(a,b){return void 0===b&&(b=!1),c.findFieldLiterals(a,b)};l.validateScript=function(a,b){return c.validateScript(a,
b,"simple")};l.referencesMember=function(a,b){return c.referencesMember(a,b)};l.referencesFunction=function(a,b){return c.referencesFunction(a,b)};var fa={error:function(a,b,d){throw Error(c.nodeErrorMessage(a,b,d));},functionDepthchecker:function(a,b){return function(){if(b.depthCounte++,64<b.depthCounter)throw Error("Exceeded maximum function depth");var c=a.apply(this,arguments);return b.depthCounte--,c}},aCheck:function(a,b){if(e.isFunctionParameter(a))throw Error(c.nodeErrorMessage({type:b},
"RUNTIME","FUNCTIONCONTEXTILLEGAL"));return a===e.voidOperation?null:a},Dictionary:n,Feature:q,dictionary:function(a){for(var b={},c=0;c<a.length;c+=2){if(e.isFunctionParameter(a[c+1]))throw Error("Illegal Argument");if(!1===e.isString(a[c]))throw Error("Illegal Argument");a[c+1]===e.voidOperation?b[a[c].toString()]=null:b[a[c].toString()]=a[c+1]}a=new n(b);return a.immutable=!1,a},strCheck:function(a,b){if(!1===e.isString(a))throw Error("Illegal Argument");return a},unary:function(a,b){if(e.isBoolean(a)){if("!"===
b)return!a;if("-"===b)return-1*e.toNumber(a);if("+"===b)return 1*e.toNumber(a);throw Error(c.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===b)return-1*e.toNumber(a);if("+"===b)return 1*e.toNumber(a);throw Error(c.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));},logical:function(a,b,d){if(!e.isBoolean(a)||!e.isBoolean(b))throw Error(c.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));switch(d){case "||":return a||
b;case "\x26\x26":return a&&b;default:throw Error(c.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));}},binary:function(a,b,d){switch(d){case "\x3d\x3d":return e.equalityTest(a,b);case "\x3d":return e.equalityTest(a,b);case "!\x3d":return!e.equalityTest(a,b);case "\x3c":return e.greaterThanLessThan(a,b,d);case "\x3e":return e.greaterThanLessThan(a,b,d);case "\x3c\x3d":return e.greaterThanLessThan(a,b,d);case "\x3e\x3d":return e.greaterThanLessThan(a,b,d);case "+":return e.isString(a)||
e.isString(b)?e.toString(a)+e.toString(b):e.toNumber(a)+e.toNumber(b);case "-":return e.toNumber(a)-e.toNumber(b);case "*":return e.toNumber(a)*e.toNumber(b);case "/":return e.toNumber(a)/e.toNumber(b);case "%":return e.toNumber(a)%e.toNumber(b);default:throw Error(c.nodeErrorMessage({type:"BinaryExpression"},"RUNTIME","OPERATORNOTRECOGNISED"));}},assign:function(a,b,d){switch(b){case "\x3d":return a===e.voidOperation?null:a;case "/\x3d":return e.toNumber(d)/e.toNumber(a);case "*\x3d":return e.toNumber(d)*
e.toNumber(a);case "-\x3d":return e.toNumber(d)-e.toNumber(a);case "+\x3d":return e.isString(d)||e.isString(a)?e.toString(d)+e.toString(a):e.toNumber(d)+e.toNumber(a);case "%\x3d":return e.toNumber(d)%e.toNumber(a);default:throw Error(c.nodeErrorMessage("AssignmentExpression","RUNTIME","OPERATORNOTRECOGNISED"));}},update:function(a,b,c,d){var g=e.toNumber(a[b]);return a[b]="++"===c?g+1:g-1,!1===d?g:"++"===c?g+1:g-1},memberupdate:function(a,b,c,d){var g;if(e.isArray(a)){if(!e.isNumber(b))throw Error("Invalid Parameter");
if(0>b&&(b=a.length+b),0>b||b>=a.length)throw Error("Assignment outside of array bounds");g=e.toNumber(a[b]);a[b]="++"===c?g+1:g-1}else{if(a instanceof n){if(!1===e.isString(b))throw Error("Dictionary accessor must be a string");}else{if(!(a instanceof q))throw e.isImmutableArray(a)?Error("Array is Immutable"):Error("Invalid Parameter");if(!1===e.isString(b))throw Error("Feature accessor must be a string");}if(!0!==a.hasField(b))throw Error("Invalid Parameter");g=e.toNumber(a.field(b));a.setField(b,
"++"===c?g+1:g-1)}return!1===d?g:"++"===c?g+1:g-1},assignmember:function(a,b,c,d){if(e.isArray(a)){if(!e.isNumber(b))throw Error("Invalid Parameter");if(0>b&&(b=a.length+b),0>b||b>a.length)throw Error("Assignment outside of array bounds");if(b===a.length&&"\x3d"!==c)throw Error("Invalid Parameter");a[b]=this.assign(d,c,a[b])}else{if(a instanceof n){if(!1===e.isString(b))throw Error("Dictionary accessor must be a string");}else{if(!(a instanceof q))throw e.isImmutableArray(a)?Error("Array is Immutable"):
Error("Invalid Parameter");if(!1===e.isString(b))throw Error("Feature accessor must be a string");}if(!0===a.hasField(b))a.setField(b,this.assign(d,c,a.field(b)));else{if("\x3d"!==c)throw Error("Invalid Parameter");a.setField(b,this.assign(d,c,null))}}},member:function(a,b){if(null===a)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","NOTFOUND"));if(a instanceof n||a instanceof q){if(e.isString(b))return a.field(b);throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));
}if(a instanceof z){if(e.isString(b))return G(a,b,"MemberExpression");throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));}if(e.isArray(a)){if(e.isNumber(b)&&isFinite(b)&&Math.floor(b)===b){if(0>b&&(b=a.length+b),b>=a.length||0>b)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return a[b]}throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));}if(e.isString(a)){if(e.isNumber(b)&&isFinite(b)&&Math.floor(b)===b){if(0>b&&(b=a.length+
b),b>=a.length||0>b)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return a[b]}throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));}if(e.isImmutableArray(a)&&e.isNumber(b)&&isFinite(b)&&Math.floor(b)===b){if(0>b&&(b=a.length()+b),b>=a.length()||0>b)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return a.get(b)}throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));},callfunc:function(a,b,c){return a instanceof
e.NativeFunction?a.fn(c,b):a instanceof e.SizzleFunction?a.fn.apply(this,b):a.apply(this,b)}};l.compileScript=function(a,b){void 0===b&&(b=null);null===b&&(b={vars:{},customfunctions:{}});var c={globalScope:O(b.vars,R,b.customfunctions),localScope:null,console:T,symbols:{symbolCounter:0}},c=B(c,a.body[0].body);""===c&&(c="lc.voidOperation;");var f={lc:e,lang:fa,postProcess:function(a){if(a instanceof e.ReturnResult&&(a=a.value),a instanceof e.ImplicitResult&&(a=a.value),a===e.voidOperation&&(a=null),
a===e.breakResult)throw Error("Cannot return BREAK");if(a===e.continueResult)throw Error("Cannot return CONTINUE");if(e.isFunctionParameter(a))throw Error("Cannot return FUNCTION");return a},prepare:function(a,b){b||(b=new g(102100));var c=a.vars,e=a.customfunctions,f=new W;c||(c={});e||(e={});var k=new n({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});k.immutable=!1;f._SymbolsMap={textformatting:1,infinity:1,pi:1};f.textformatting=k;f.infinity=Number.POSITIVE_INFINITY;
f.pi=Math.PI;for(var m in e)f[m]=e[m],f._SymbolsMap[m]=1;for(m in c)f._SymbolsMap[m]=1,c[m]instanceof d?f[m]=new q(c[m]):f[m]=c[m];return{spatialReference:b,globalScope:f,localScope:null,console:a.console?a.console:T,symbols:{symbolCounter:0},depthCounter:1,applicationCache:void 0===a.applicationCache?null:a.applicationCache}}};return(new Function("context","spatialReference","var runtimeCtx\x3dthis.prepare(context, spatialReference);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n "+
c+"\n return lastStatement; } \n return this.postProcess(mainBody());")).bind(f)}})},"esri/renderers/UniqueValueRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ./arcadeUtils".split(" "),function(h,l,a,d,b,f,k,m,g){h=h(m,{declaredClass:"esri.renderer.UniqueValueRenderer",constructor:function(a,b,d,g,f){(this.values=[],this._symbols={},this.infos=[],a&&!a.declaredClass)?(b=a,this.defaultSymbol=(a=b.defaultSymbol)&&
(a.declaredClass?a:k.fromJson(a)),this.attributeField=b.field1,this.attributeField2=b.field2,this.attributeField3=b.field3,this.fieldDelimiter=b.fieldDelimiter,this.defaultLabel=b.defaultLabel,this.setValueExpression(b.valueExpression),this.valueExpressionTitle=b.valueExpressionTitle,this.legendOptions=b.legendOptions,b.backgroundFillSymbol&&(this.backgroundFillSymbol=k.fromJson(b.backgroundFillSymbol)),l.forEach(b.uniqueValueInfos,this._addValueInfo,this)):(this.defaultSymbol=a,this.attributeField=
b,this.attributeField2=d,this.attributeField3=g,this.fieldDelimiter=f);this._multiple=!!this.attributeField2},addValue:function(b,c){var d=a.isObject(b)?b:{value:b,symbol:c};this._addValueInfo(d)},removeValue:function(a){var b=l.indexOf(this.values,a);-1!==b&&(this.values.splice(b,1),delete this._symbols[a],this.infos.splice(b,1))},getUniqueValueInfo:function(b){var c,d,f,k,m=this.attributeField,h=b.attributes;return this._compiledFunc?k=g.executeFunction(this._compiledFunc,g.createExecContext(b,
b._getView())):this._multiple?(c=this.attributeField2,d=this.attributeField3,f=[],m&&f.push(h[m]),c&&f.push(h[c]),d&&f.push(h[d]),k=f.join(this.fieldDelimiter||"")):k=a.isFunction(m)?m(b):h[m],this._symbols[k]},setValueExpression:function(a){this.valueExpression=a;this._compiledFunc=g.createFunction(a)},getSymbol:function(a){return(a=this.getUniqueValueInfo(a))&&a.symbol||this.defaultSymbol},_addValueInfo:function(a){var b=a.value;this.values.push(b);this.infos.push(a);var d=a.symbol;d&&(d.declaredClass||
(a.symbol=k.fromJson(d)));this._symbols[b]=a},toJson:function(){var b,c=f.fixJson,d={type:"uniqueValue",field1:this.attributeField,field2:this.attributeField2,field3:this.attributeField3,fieldDelimiter:this.fieldDelimiter,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:a.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),defaultLabel:this.defaultLabel,uniqueValueInfos:l.map(this.infos||[],function(b){return b=a.mixin({},
b),b.symbol=b.symbol&&b.symbol.toJson(),b.value+="",c(b)})};return this.backgroundFillSymbol&&(d.backgroundFillSymbol=this.backgroundFillSymbol.toJson()),b=a.mixin(this.inherited(arguments),d),c(b)}});return d("extend-esri")&&a.setObject("renderer.UniqueValueRenderer",h,b),h})},"esri/renderers/jsonUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../Color ../symbols/jsonUtils ./SimpleRenderer ./UniqueValueRenderer ./ClassBreaksRenderer ./VectorFieldRenderer ./DotDensityRenderer ./ScaleDependentRenderer ./TimeClassBreaksAger ./TimeRampAger ./TemporalRenderer ./HeatmapRenderer".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t){var w={fromJson:function(a){var b;switch(a.type||""){case "simple":b=new m(a);break;case "uniqueValue":b=new g(a);break;case "classBreaks":b=new e(a);break;case "vectorField":b=new c(a);break;case "scaleDependent":b=this._scaleDependentFromJson(a);break;case "dotDensity":b=this._dotDensityFromJson(a);break;case "temporal":b=this._temporalFromJson(a);break;case "heatmap":b=this._heatmapFromJson(a)}return b},_scaleDependentFromJson:function(a){var b={},c=
a.minScale;return b.rendererInfos=h.map(a.rendererInfos,function(a){var b=a.maxScale;a={minScale:c,maxScale:b,renderer:a.renderer&&this.fromJson(a.renderer)};return c=b,a},this),new q(b)},_dotDensityFromJson:function(a){return a.backgroundColor&&l.isArray(a.backgroundColor)&&(a.backgroundColor=f.toDojoColor(a.backgroundColor)),0<a.dotSize&&(a.dotSize=d.pt2px(a.dotSize)),a.fields&&h.forEach(a.fields,function(a){a&&l.isArray(a.color)&&(a.color=f.toDojoColor(a.color))}),a.legendOptions&&(a.legendOptions.backgroundColor&&
l.isArray(a.legendOptions.backgroundColor)&&(a.legendOptions.backgroundColor=f.toDojoColor(a.legendOptions.backgroundColor)),a.legendOptions.outline&&(a.legendOptions.outline=k.fromJson(a.legendOptions.outline))),a.outline&&(a.outline=k.fromJson(a.outline)),new n(a)},_temporalFromJson:function(a){var b,c,d,e;return a=a||{},b=this.fromJson(a.observationRenderer),c=a.latestObservationRenderer?this.fromJson(a.latestObservationRenderer):null,d=a.trackRenderer?this.fromJson(a.trackRenderer):null,e=this._agerFromJson(a.observationAger),
new v(b,c,d,e)},_agerFromJson:function(a){var b;return a=a||{},a.colorRange||a.sizeRange||a.alphaRange?b=this._timeRampFromJson(a):a.agerClassBreakInfos&&(b=this._timeClassBreaksFromJson(a)),b},_timeRampFromJson:function(a){var b,c,d;return a.colorRange&&1<a.colorRange.length&&(b=[f.toDojoColor(a.colorRange[0]),f.toDojoColor(a.colorRange[1])]),a.sizeRange&&1<a.sizeRange.length&&(c=[a.sizeRange[0],a.sizeRange[1]]),a.alphaRange&&1<a.alphaRange.length&&(d=[a.alphaRange[0]/255,a.alphaRange[1]/255]),new u(b,
c,d)},_timeClassBreaksFromJson:function(a){var b,c,d,e=a.agerClassBreakInfos,g=[];b=r.UNIT_DAYS;switch(a.timeUnits){case "esriTimeUnitsSeconds":b=r.UNIT_SECONDS;break;case "esriTimeUnitsMilliseconds":b=r.UNIT_MILLISECONDS;break;case "esriTimeUnitsHours":b=r.UNIT_HOURS;break;case "esriTimeUnitsMinutes":b=r.UNIT_MINUTES;break;case "esriTimeUnitsMonths":b=r.UNIT_MONTHS;break;case "esriTimeUnitsWeeks":b=r.UNIT_WEEKS;break;case "esriTimeUnitsYears":b=r.UNIT_YEARS}for(d=0;d<e.length;d+=1)a=e[d],c={minAge:0,
maxAge:a.oldestAge||1/0},a.color&&(c.color=f.toDojoColor(a.color)),a.alpha&&(c.alpha=a.alpha/255),c.size=a.size,g[d]=c;return new r(g,b)},_heatmapFromJson:function(a){var b=a.colorStops;return b&&b instanceof Array&&h.forEach(b,function(a){a.color=f.toDojoColor(a.color)}),new t(a)}};return a("extend-esri")&&l.mixin(l.getObject("renderer",!0,b),w),w})},"esri/renderers/ClassBreaksRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ./arcadeUtils".split(" "),
function(h,l,a,d,b,f,k,m,g){h=h(m,{declaredClass:"esri.renderer.ClassBreaksRenderer",constructor:function(a,b){if(this.breaks=[],this._symbols={},this.infos=[],this.isMaxInclusive=!0,a&&!a.declaredClass){var d=a;this.attributeField=d.field;this.setValueExpression(d.valueExpression);this.valueExpressionTitle=d.valueExpressionTitle;this.legendOptions=d.legendOptions;this.defaultSymbol=(a=d.defaultSymbol)&&(a.declaredClass?a:k.fromJson(a));this.backgroundFillSymbol=(a=d.backgroundFillSymbol)&&(a.declaredClass?
a:k.fromJson(a));this._copy(["defaultLabel","classificationMethod:rest","normalizationType:rest","normalizationField","normalizationTotal"],d,this);var g=d.minValue;(d=d.classBreakInfos)&&d[0]&&f.isDefined(d[0].classMaxValue)&&l.forEach(d,function(a){var b=a.classMaxValue;a.minValue=g;g=a.maxValue=b},this);l.forEach(d,this._addBreakInfo,this)}else this.defaultSymbol=a,this.attributeField=b},addBreak:function(b,c,d){b=a.isObject(b)?b:{minValue:b,maxValue:c,symbol:d};this._addBreakInfo(b)},removeBreak:function(a,
b){var d,g,f=this.breaks,k=f.length,m=this._symbols;for(g=0;k>g;g++)if(d=f[g],d[0]==a&&d[1]==b){f.splice(g,1);delete m[a+"-"+b];this.infos.splice(g,1);break}},clearBreaks:function(){this.breaks=[];this._symbols={};this.infos=[]},getBreakIndex:function(b){var c,d,f=this.attributeField;c=b.attributes;var k=this.breaks,m=k.length,h=this.isMaxInclusive;if(this._compiledFunc)b=g.executeFunction(this._compiledFunc,g.createExecContext(b,b._getView()));else if(a.isFunction(f))b=f(b);else{b=parseFloat(c[f]);
var l=this.normalizationType;if(l)if(f=parseFloat(this.normalizationTotal),c=parseFloat(c[this.normalizationField]),"log"===l)b=Math.log(b)*Math.LOG10E;else if("percent-of-total"!==l||isNaN(f)){if("field"===l){if(isNaN(b)||isNaN(c))return-1;b/=c}}else b=b/f*100}if(null!=b&&!isNaN(b)&&"number"==typeof b)for(c=0;m>c;c++)if(d=k[c],d[0]<=b&&(h?b<=d[1]:b<d[1]))return c;return-1},getBreakInfo:function(a){a=this.getBreakIndex(a);return-1!==a?this.infos[a]:null},getSymbol:function(a){return(a=this.breaks[this.getBreakIndex(a)])?
this._symbols[a[0]+"-"+a[1]]:this.defaultSymbol},setMaxInclusive:function(a){this.isMaxInclusive=a},setValueExpression:function(a){this.valueExpression=a;this._compiledFunc=g.createFunction(a)},_normalizationTypeEnums:[["field","esriNormalizeByField"],["log","esriNormalizeByLog"],["percent-of-total","esriNormalizeByPercentOfTotal"]],_classificationMethodEnums:[["natural-breaks","esriClassifyNaturalBreaks"],["equal-interval","esriClassifyEqualInterval"],["quantile","esriClassifyQuantile"],["standard-deviation",
"esriClassifyStandardDeviation"],["geometrical-interval","esriClassifyGeometricalInterval"]],_copy:function(a,b,d){l.forEach(a,function(a){var e,g,f,k,m=a.split(":");if(1<m.length&&(a=m[0],e=this["_"+a+"Enums"],"rest"===m[1]?(g="1",f="0"):"sdk"===m[1]&&(g="0",f="1")),k=b[a],void 0!==k&&(d[a]=k,e&&g))for(var h=e.length,m=0;h>m;m++)if(e[m][g]===k){d[a]=e[m][f];break}},this)},_addBreakInfo:function(a){var b=a.minValue,d=a.maxValue;this.breaks.push([b,d]);this.infos.push(a);var g=a.symbol;g&&(g.declaredClass||
(a.symbol=k.fromJson(g)));this._symbols[b+"-"+d]=a.symbol},toJson:function(){var b=this.infos||[],c=f.fixJson,d=b[0]&&b[0].minValue,g=this.backgroundFillSymbol,b=a.mixin(this.inherited(arguments),{type:"classBreaks",field:this.attributeField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:a.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),backgroundFillSymbol:g&&g.toJson(),minValue:d===-(1/0)?-Number.MAX_VALUE:
d,classBreakInfos:l.map(b,function(b){return b=a.mixin({},b),b.symbol=b.symbol&&b.symbol.toJson(),b.classMaxValue=b.maxValue===1/0?Number.MAX_VALUE:b.maxValue,delete b.minValue,delete b.maxValue,c(b)})});return this._copy(["defaultLabel","classificationMethod:sdk","normalizationType:sdk","normalizationField","normalizationTotal"],this,b),b.hasOwnProperty("normalizationType")&&!b.normalizationType&&delete b.normalizationType,b.hasOwnProperty("classificationMethod")&&!b.classificationMethod&&delete b.classificationMethod,
c(b)}});return d("extend-esri")&&a.setObject("renderer.ClassBreaksRenderer",h,b),h})},"esri/renderers/VectorFieldRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/_base/array ../kernel ../lang ../Color ./Renderer ./ClassBreaksRenderer ../symbols/SimpleMarkerSymbol ../symbols/PictureMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/jsonUtils require".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r){var u=h(m,{declaredClass:"esri.renderer.VectorFieldRenderer",iconFolderPath:"../images/symbol/sfs/",
constructor:function(a){f.isDefined(a)||(a={});a.attributeField=a.attributeField||"Magnitude";a.rotationInfo=a.rotationInfo||this._getRotationInfo(a);h.safeMixin(this,a);this.style=this.style||u.STYLE_SINGLE_ARROW;this.singleArrowSymbol&&(this.singleArrowSymbol=this.singleArrowSymbol.declaredClass?this.singleArrowSymbol:q.fromJson(this.singleArrowSymbol));this.renderer=new g(this._getDefaultSymbol(),a.attributeField);this._updateRenderer(this.style);this.flowRepresentation=this.flowRepresentation||
this.FLOW_FROM},getSymbol:function(a){return this.renderer&&this.renderer.getSymbol(a)},setVisualVariables:function(a){return a=d.filter(a,function(a){return"sizeInfo"===a.type?f.isDefined(this._updateSizeInfo(a)):void 0},this),this.inherited(arguments),this},setSizeInfo:function(a){return this._updateSizeInfo(a),this.inherited(arguments),this},setProportionalSymbolInfo:function(a){return this.setSizeInfo(a),this},setColorInfo:function(a){return this},_updateRenderer:function(a){return f.isDefined(this.renderer)?
a===u.STYLE_SINGLE_ARROW?this._createSingleArrowRenderer():a===u.STYLE_BEAUFORT_KN?this._createBeaufortKnotsRenderer():a===u.STYLE_BEAUFORT_METER?this._createBeaufortMeterRenderer():a===u.STYLE_BEAUFORT_FEET?this._createBeaufortFeetRenderer():a===u.STYLE_BEAUFORT_MILE?this._createBeaufortMilesRenderer():a===u.STYLE_BEAUFORT_KM?this._createBeaufortKilometersRenderer():a===u.STYLE_OCEAN_CURRENT_M?this._createCurrentMeterRenderer():a===u.STYLE_OCEAN_CURRENT_KN?this._createCurrentKnotsRenderer():a===
u.STYLE_SCALAR?this._createSimpleScalarRenderer():a===u.STYLE_WIND_BARBS?this._createWindBarbsRenderer():this._createClassifiedArrowRenderer():Error("Invalid Renderer!")},_updateSizeInfo:function(a){return a&&f.isDefined(a.minSize)&&f.isDefined(a.maxSize)&&f.isDefined(a.minDataValue)&&f.isDefined(a.maxDataValue)?(this.style===u.STYLE_WIND_BARBS&&(a.minSize=a.maxSize),a.field=a.field||"Magnitude",a.type="sizeInfo",a):null},_createClassifiedArrowRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new k([56,
168,0]));var a=[0,1E-6,3.5,7,10.5,14];if(f.isDefined(this.minDataValue)&&f.isDefined(this.maxDataValue)){var b=(this.maxDataValue-this.minDataValue)/5,a=[],c,d;d=this.minDataValue;for(c=0;6>c;c++)a[c]=d,d+=b}this._addBreaks(a,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]])},_createSingleArrowRenderer:function(){this.renderer.defaultSymbol=this.singleArrowSymbol||this._getDefaultSymbol()},_createBeaufortMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new k([214,
47,39]));this._addBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new k([214,47,39]));this._addBreaks([0,1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,
250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]])},_createBeaufortFeetRenderer:function(){var a=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];d.forEach(a,function(b,c){a[c]*=3.28084});this.renderer.defaultSymbol=this._getDefaultSymbol(new k([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortMilesRenderer:function(){var a=
[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];d.forEach(a,function(b,c){a[c]*=2.23694});this.renderer.defaultSymbol=this._getDefaultSymbol(new k([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKilometersRenderer:function(){var a=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];d.forEach(a,function(b,c){a[c]*=3.6});this.renderer.defaultSymbol=
this._getDefaultSymbol(new k([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createCurrentMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new k([177,177,177]));this._addBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,177]])},_createCurrentKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new k([177,
177,177]));this._addBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]])},_createSimpleScalarRenderer:function(){this.renderer.defaultSymbol=new c({url:r.toUrl(this.iconFolderPath+"scalar.png"),height:20,width:20,type:"esriPMS",angle:0})},_createWindBarbsRenderer:function(){var a,b,d=[];for(a=0;150>=a;a+=5)d.push(a);b="M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20;M25 0 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40;M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35;M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15 M25 10 M25 5 L17.5 7.5".split(";");
var g=new c({url:r.toUrl(this.iconFolderPath+"windbarb.png"),height:20,width:20,type:"esriPMS",angle:0});this.renderer.defaultSymbol=g;for(a=0;a<d.length-1;a++)0==a?this.renderer.addBreak({minValue:d[a],maxValue:d[a+1],symbol:g}):this.renderer.addBreak({minValue:d[a],maxValue:d[a+1],symbol:(new e).setPath(b[a]).setOutline((new n).setWidth(1.5)).setSize(20).setColor(new k([0,0,0,255]))})},_getDefaultSymbol:function(a){return(new e).setPath("M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z").setOutline((new n).setWidth(0)).setSize(20).setColor(a||
new k([0,92,230]))},_getRotationInfo:function(a){var b=a&&a.flowRepresentation||u.FLOW_FROM,c=a&&a.rotationField||"Direction",d=u.FLOW_FROM;return{field:function(a){a=a.attributes[c];return b===d?a:a+180},type:"geographic"}},_addBreaks:function(a,b){if(!f.isDefined(this.renderer))return Error("Invalid Renderer!");if(!(a&&b&&a.length&&b.length&&a.length>=b.length))return Error("AddBreaks: Input arguments break values and colors not valid");var c;for(c=0;c<b.length;c++)this.renderer.addBreak({minValue:a[c],
maxValue:a[c+1],symbol:this._getDefaultSymbol(new k(b[c]))})},toJson:function(){var a=l.mixin(this.inherited(arguments),{type:"vectorField",style:this.style,attributeField:this.attributeField,flowRepresentation:this.flowRepresentation});return this.renderer&&this.renderer.defaultSymbol&&this.style===u.STYLE_SINGLE_ARROW&&(a.singleArrowSymbol=this.renderer.defaultSymbol.toJson()),f.fixJson(a)}});return l.mixin(u,{STYLE_WIND_BARBS:"wind_speed",STYLE_SINGLE_ARROW:"single_arrow",STYLE_CLASSIFIED_ARROW:"classified_arrow",
STYLE_BEAUFORT_KN:"beaufort_kn",STYLE_BEAUFORT_METER:"beaufort_m",STYLE_BEAUFORT_MILE:"beaufort_mi",STYLE_BEAUFORT_FEET:"beaufort_ft",STYLE_BEAUFORT_KM:"beaufort_km",STYLE_OCEAN_CURRENT_M:"ocean_current_m",STYLE_OCEAN_CURRENT_KN:"ocean_current_kn",STYLE_SCALAR:"simple_scalar"},{FLOW_FROM:"flow_from",FLOW_TO:"flow_to"}),a("extend-esri")&&l.setObject("renderer.VectorFieldRenderer",u,b),u})},"esri/renderers/DotDensityRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Renderer ../symbols/PictureFillSymbol ../geometry/ScreenPoint ../geometry/Point".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q){h=h(e,{declaredClass:"esri.renderer.DotDensityRenderer",constructor:function(a){this.dotSize=a.dotSize||3;this.dotValue=a.dotValue;this.fields=a.fields;this.outline=a.outline;this.backgroundColor=a.backgroundColor;this.exactCount=a.exactCount||!0;this.dotShape=a.dotShape||"square";this.legendOptions=a.legendOptions;this._exactCountMinArea=1E4;this._currentMapScale=this._map=this._canvas=null;this._symbolMap={};this._currentGraphic=this._currentResolution=this._objectIdField=
null;this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1},getSymbol:function(a){var b,d,e;return this._currentGraphic=a,this._supportsCanvas?(this._map||(this._map=a.getLayer()._map,this._objectIdField=a.getLayer().objectIdField,this._currentMapScale=this._map.getScale(),this._currentResolution=this._map.extent.getWidth()/this._map.width,this._map.on("zoom-end",l.hitch(this,function(a){this._currentMapScale=this._map.getScale();this._currentResolution=a.extent.getWidth()/this._map.width;this._symbolMap[this._currentMapScale]=
{}}))),this._symbolMap[this._currentMapScale]&&this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]]?(d=this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]],e=this._getShapeProperties(a),d.setOffset(e.dx,e.dy),d):(b=this._generateFieldsCount(this.fields,a.attributes,this.dotValue),e=this._getShapeProperties(a),d=new c(this._generateImageSrc(e.width,e.height,b,e.minXY,e.maxXY),this.outline,e.width,e.height),d.setOffset(e.dx,e.dy),this._symbolMap[this._currentMapScale]?
this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]]=d:(this._symbolMap[this._currentMapScale]={},this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]]=d),d)):null},_generateFieldsCount:function(a,b,c){var d,e;for(e=a.length-1;0<=e;e--)d=b[a[e].name]/c,a[e].numPoints=Math.round(d);return a},_getShapeProperties:function(a){var b,c,d,e,g,f,k,m;return b=a.geometry.getExtent(),b.contains(this._map.extent)&&(b=this._map.extent),k=Math.ceil(b.getWidth()/this._currentResolution),
m=Math.ceil(b.getHeight()/this._currentResolution),c=this._map.toScreen(new q(b.xmin,b.ymin,b.spatialReference)),d=this._map.toScreen(new q(b.xmax,b.ymax,b.spatialReference)),f=a.getLayer().getNode().getCTM(),e=(c.x-f.e)%k,g=(d.y-f.f)%m,{minXY:c,maxXY:d,dx:e,dy:g,width:k,height:m}},_generateImageSrc:function(a,b,c,d,e,g){var f,k,m,n=this.dotSize;this._canvas?(this._canvas.width=a,this._canvas.height=b):this._canvas=this._initCanvas(a,b);f=this._canvas.getContext("2d");(g=g||this.backgroundColor)&&
(f.fillStyle=g.toCss(!0),f.fillRect(0,0,a,b),f.fill());for(g=c.length-1;0<=g;g--)for(f.fillStyle=c[g].color.toCss(!0),k=c[g].numPoints-1;0<=k;k--)m=this._getRandomPoint(a,b,d,e),"square"===this.dotShape?f.fillRect(m.x,m.y,n,n):"circle"===this.dotShape&&(f.beginPath(),f.arc(m.x,m.y,n/2,0,2*Math.PI,!0)),f.fill();return this._canvas.toDataURL()},_initCanvas:function(a,b){var c=d.create("canvas",{id:"canvas",width:a+"px",height:b+"px",style:"position: absolute; left: -10000px; top: 0px;"},null);return document.body.appendChild(c),
c},_getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},_getRandomPoint:function(a,b,c,d){var e={},g=this.outline&&this.outline.width?this.outline.width:0;if(!0===this.exactCount&&a*b>this._exactCountMinArea){do e.x=this._getRandomInt(c.x,d.x),e.y=this._getRandomInt(d.y,c.y),a=new n(e.x,e.y),a=this._checkPointShapeBounds(a,this.dotSize+g,this._currentGraphic.geometry),!0===a&&(e.x-=c.x,e.y-=d.y);while(!1===a)}else e.x=this._getRandomInt(0,a),e.y=this._getRandomInt(0,b);return e},
_checkPointShapeBounds:function(a,b,c){var d=null,d=!1,e=!0,g=0;do{switch(g){case 1:a.x+=b;break;case 2:a.y+=b;break;case 3:a.x-=b}d=this._map.toMap(a);d=c.contains(d);!1===d&&(e=!1);g+=1}while(3>=g&&!0===e);return d},setDotSize:function(a){0<a&&(this.dotSize=a)},setDotValue:function(a){0<a&&(this.dotValue=a)},setOutline:function(a){this.outline=a},setBackgroundColor:function(a){this.backgroundColor=a},toJson:function(){var b=l.mixin(this.inherited(arguments),{type:"dotDensity",backgroundColor:g.toJsonColor(this.backgroundColor),
dotShape:this.dotShape,dotSize:0<this.dotSize?f.px2pt(this.dotSize):0,dotValue:this.dotValue,fields:a.map(this.fields,function(a){return m.fixJson({color:g.toJsonColor(a.color),name:a.name})}),legendOptions:this.legendOptions&&m.fixJson({backgroundColor:g.toJsonColor(this.legendOptions.backgroundColor),dotCoverage:this.legendOptions.dotCoverage,outline:this.legendOptions.outline&&this.legendOptions.outline.toJson(),valueUnit:this.legendOptions.valueUnit}),outline:this.outline&&this.outline.toJson()});
return m.fixJson(b)}});return b("extend-esri")&&l.setObject("renderer.DotDensityRenderer",h,k),h})},"esri/renderers/ScaleDependentRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ./Renderer".split(" "),function(h,l,a,d,b,f,k){h=h(k,{declaredClass:"esri.renderer.ScaleDependentRenderer",constructor:function(a){this.setRendererInfos(a&&a.rendererInfos||[])},setRendererInfos:function(a){return this.rendererInfos=a,this._setRangeType(),this},getSymbol:function(a){var b=
this.getRendererInfo(a);return b&&b.renderer&&b.renderer.getSymbol(a)},getRendererInfo:function(a){a=a.getLayer().getMap();return"zoom"===this.rangeType?this.getRendererInfoByZoom(a.getZoom()):this.getRendererInfoByScale(a.getScale())},getRendererInfoByZoom:function(a){var b,d,c=this.rendererInfos,f=0;do b=c[f],a>=b.minZoom&&a<=b.maxZoom&&(d=b),f++;while(!d&&f<c.length);return d},getRendererInfoByScale:function(a){var b,d,c,f,k,h,l=this.rendererInfos,v=0;do b=l[v],c=b.minScale,f=b.maxScale,k=!c,h=
!f,!k&&c>=a&&(k=!0),!h&&a>=f&&(h=!0),k&&h&&(d=b),v++;while(!d&&v<l.length);return d},addRendererInfo:function(a){var b,d,c=0,f=this.rendererInfos,k=a.hasOwnProperty("minZoom")?"minZoom":"minScale",h=f.length;do d=f[c],(h===c||a[k]<d[k])&&(f.splice(c,0,a),this._setRangeType(),b=!0),c++;while(!b&&h>c);return this},_setRangeType:function(){var a=this.rendererInfos;(a=a&&a[0])&&(this.rangeType=a.hasOwnProperty("minZoom")?"zoom":a.hasOwnProperty("minScale")?"scale":"")},toJson:function(){if("zoom"===this.rangeType)return null;
var b=this.rendererInfos||[],d=b[0]&&b[0].minScale,b=a.mixin(this.inherited(arguments),{type:"scaleDependent",minScale:0<d?d:0,rendererInfos:l.map(b,function(a){return f.fixJson({maxScale:0<a.maxScale?a.maxScale:0,renderer:a.renderer&&a.renderer.toJson()})})});return f.fixJson(b)}});return d("extend-esri")&&a.setObject("renderer.ScaleDependentRenderer",h,b),h})},"esri/renderers/TimeClassBreaksAger":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has dojo/date ../kernel ../lang ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),
function(h,l,a,d,b,f,k,m,g,e){var c=h(e,{declaredClass:"esri.renderer.TimeClassBreaksAger",constructor:function(a,b){this.infos=a;this.timeUnits=b||"day";a.sort(function(a,b){return a.minAge<b.minAge?-1:a.minAge>b.minAge?1:0})},getAgedSymbol:function(a,c){var d=c.getLayer(),e=c.attributes,g=k.isDefined;a=m.fromJson(a.toJson());var f=d._map.timeExtent.endTime;if(!f)return a;var h=b.difference(new Date(e[d._startTimeField]),f,this.timeUnits);return l.some(this.infos,function(b){if(h>=b.minAge&&h<=b.maxAge){var c=
b.color,d=b.size;b=b.alpha;return c&&a.setColor(c),g(d)&&this._setSymbolSize(a,d),g(b)&&a.color&&(a.color.a=b),!0}},this),a},toJson:function(){var a,b,c,d={agerClassBreakInfos:[]};d.timeUnits=this._getRestUnits(this.timeUnits);for(a=0;a<this.infos.length;a+=1)b=this.infos[a],c={},c.oldestAge=b.maxAge===1/0?null:b.maxAge,c.size=b.size,b.color&&(c.color=g.toJsonColor(b.color)),b.alpha&&(c.alpha=Math.round(255*b.alpha)),d.agerClassBreakInfos[a]=c;return d},_getRestUnits:function(a){var b="esriTimeUnitsDays";
switch(a){case c.UNIT_SECONDS:b="esriTimeUnitsSeconds";break;case c.UNIT_MILLISECONDS:b="esriTimeUnitsMilliseconds";break;case c.UNIT_HOURS:b="esriTimeUnitsHours";break;case c.UNIT_MINUTES:b="esriTimeUnitsMinutes";break;case c.UNIT_MONTHS:b="esriTimeUnitsMonths";break;case c.UNIT_WEEKS:b="esriTimeUnitsWeeks";break;case c.UNIT_YEARS:b="esriTimeUnitsYears"}return b}});return a.mixin(c,{UNIT_DAYS:"day",UNIT_HOURS:"hour",UNIT_MILLISECONDS:"millisecond",UNIT_MINUTES:"minute",UNIT_MONTHS:"month",UNIT_SECONDS:"second",
UNIT_WEEKS:"week",UNIT_YEARS:"year"}),d("extend-esri")&&a.setObject("renderer.TimeClassBreaksAger",c,f),c})},"esri/renderers/SymbolAger":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.renderer.SymbolAger",getAgedSymbol:function(a,d){},_setSymbolSize:function(a,d){switch(a.type){case "simplemarkersymbol":a.setSize(d);break;case "picturemarkersymbol":a.setWidth(d);a.setHeight(d);break;case "simplelinesymbol":case "cartographiclinesymbol":a.setWidth(d);
break;case "simplefillsymbol":case "picturefillsymbol":a.outline&&a.outline.setWidth(d)}}});return a("extend-esri")&&l.setObject("renderer.SymbolAger",h,d),h})},"esri/renderers/TimeRampAger":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has ../kernel ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(h,l,a,d,b,f,k,m){h=h(m,{declaredClass:"esri.renderer.TimeRampAger",constructor:function(a,b,c){this.colorRange=a;this.sizeRange=b;this.alphaRange=c},getAgedSymbol:function(b,
d){var c=d.getLayer(),k=d.attributes;b=f.fromJson(b.toJson());var m=c._map.timeExtent,h=m.startTime,m=m.endTime;if(!h||!m)return b;h=h.getTime();m=m.getTime();c=new Date(k[c._startTimeField]);c=c.getTime();h>c&&(c=h);var l,c=m===h?1:(c-h)/(m-h);if(k=this.sizeRange)m=k[0],k=k[1],h=Math.abs(k-m)*c,this._setSymbolSize(b,k>m?m+h:m-h);if(k=this.colorRange){var v=k[0],m=k[1],t=Math.round;l=new a;var w=v.r,x=m.r,h=Math.abs(x-w)*c;l.r=t(x>w?w+h:w-h);w=v.g;x=m.g;h=Math.abs(x-w)*c;l.g=t(x>w?w+h:w-h);w=v.b;
x=m.b;h=Math.abs(x-w)*c;l.b=t(x>w?w+h:w-h);v=v.a;m=m.a;h=Math.abs(m-v)*c;l.a=m>v?v+h:v-h;b.setColor(l)}if(l=b.color,k=this.alphaRange,k&&l)m=k[0],k=k[1],h=Math.abs(k-m)*c,l.a=k>m?m+h:m-h;return b},toJson:function(){var a={};return this.sizeRange&&(a.sizeRange=this.sizeRange),this.colorRange&&(a.colorRange=[k.toJsonColor(this.colorRange[0]),k.toJsonColor(this.colorRange[1])]),this.alphaRange&&(a.alphaRange=[Math.round(255*this.alphaRange[0]),Math.round(255*this.alphaRange[1])]),a}});return d("extend-esri")&&
l.setObject("renderer.TimeRampAger",h,b),h})},"esri/renderers/TemporalRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Renderer"],function(h,l,a,d,b){h=h(b,{declaredClass:"esri.renderer.TemporalRenderer",constructor:function(a,b,d,g){this.observationRenderer=a;this.latestObservationRenderer=b;this.trackRenderer=d;this.observationAger=g},getSymbol:function(a){var b=a.getLayer(),d=this.getObservationRenderer(a),g=d&&d.getSymbol(a),e=this.observationAger;
return b.timeInfo&&b._map.timeExtent&&d===this.observationRenderer&&e&&g&&(g=e.getAgedSymbol(g,a)),g},getObservationRenderer:function(a){return 0===a.getLayer()._getKind(a)?this.observationRenderer:this.latestObservationRenderer||this.observationRenderer},toJson:function(){var a={type:"temporal"};return a.observationRenderer=this.observationRenderer.toJson(),this.latestObservationRenderer&&(a.latestObservationRenderer=this.latestObservationRenderer.toJson()),this.trackRenderer&&(a.trackRenderer=this.trackRenderer.toJson()),
this.observationAger&&(a.observationAger=this.observationAger.toJson()),a}});return a("extend-esri")&&l.setObject("renderer.TemporalRenderer",h,d),h})},"esri/renderers/HeatmapRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct ../sniff ../kernel ../lang ../symbols/PictureMarkerSymbol ../Color ./Renderer".split(" "),function(h,l,a,d,b,f,k,m,g,e){h=h([e],{declaredClass:"esri.renderer.HeatmapRenderer",colors:null,blurRadius:10,maxPixelIntensity:100,minPixelIntensity:0,
field:null,fieldOffset:null,colorStops:null,constructor:function(a){return this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1,this._supportsCanvas?("string"==typeof a&&(a=JSON.parse(a)),l.mixin(this,a),this._canvas=null,this.colors||this.colorStops||(this.colorStops=[{ratio:0,color:"rgba(255, 140, 0, 0)"},{ratio:.75,color:"rgba(255, 140, 0, 1)"},{ratio:.9,color:"rgba(255, 0,   0, 1)"}]),void(this.gradient=this._generateGradient(this.colorStops||this.colors))):void 0},getSymbol:function(a){if(!this._supportsCanvas)return!1;
var b=a.attributes.imageData;a=a.attributes.size;if(!a)return null;var d=this._getContext(a[0],a[1]),e=d.getImageData(0,0,a[0],a[1]);if(window.ArrayBuffer&&b instanceof ArrayBuffer?b=window.Uint8ClampedArray?new Uint8ClampedArray(b):new Uint8Array(b):b.BYTES_PER_ELEMENT&&1!==b.BYTES_PER_ELEMENT&&(b=window.Uint8ClampedArray?new Uint8ClampedArray(b.buffer):new Uint8Array(b.buffer)),window.CanvasPixelArray&&e.data instanceof window.CanvasPixelArray)for(var g=e.data,f=g.length;f--;)g[f]=b[f];else e.data.set(b);
d.putImageData(e,0,0);return new m(d.canvas.toDataURL(),a[0],a[1])},setColors:function(a){return a&&(a instanceof Array||a.colors)&&(this.gradient=this._generateGradient(a.colors||a),this.colors=a),this},setColorStops:function(a){return a&&(a instanceof Array||a.colorStops)&&(this.gradient=this._generateGradient(a.colorStops||a),this.colorStops=a),this},setMaxPixelIntensity:function(a){return this.maxPixelIntensity=a,this},setMinPixelIntensity:function(a){return this.minPixelIntensity=a,this},setField:function(a){return this.field=
a,this},setFieldOffset:function(a){return this.fieldOffset=a,this},setBlurRadius:function(a){return this.blurRadius=a,this},getStats:function(){},getHistogramData:function(){},toJson:function(){var b=l.mixin(this.inherited(arguments),{type:"heatmap",blurRadius:this.blurRadius,colorStops:this._colorsToStops(this.colorStops||this.colors),maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity,field:this.field});return null!=this.fieldOffset&&(b.fieldOffset=this.fieldOffset),
a.forEach(b.colorStops,function(a){a.color=g.toJsonColor(a.color)}),k.fixJson(b)},_getContext:function(a,b){this._canvas?(this._canvas.width=a,this._canvas.height=b):this._canvas=this._initCanvas(a,b);return this._canvas.getContext("2d")},_initCanvas:function(a,b){var e=d.create("canvas",{id:"hm_canvas-"+Math.floor(1E3*Math.random()),style:"position: absolute; left: 0px; top: -10000px;"},null);return e.width=a,e.height=b,document.body.appendChild(e),e},_generateGradient:function(a,b){b||(b=512);for(var d,
e=this._colorsToStops(a),g=this._getContext(1,b||512),f=g.createLinearGradient(0,0,0,b),k=0;k<e.length;k++)d=e[k],f.addColorStop(d.ratio,d.color.toCss(!0));g.fillStyle=f;g.fillRect(0,0,1,b);return g.getImageData(0,0,1,b).data},_colorsToStops:function(b){var d=[];if(!b[0])return d;if(null!=b[0].ratio)d=a.map(b,function(a){return{ratio:a.ratio,color:this._toColor(a.color)}},this);else if(null!=b[0].value){for(var e=1/0,g=-(1/0),f=0,d=0;d<b.length;d++){var k=b[d].value;e>k&&(e=k);k>g&&(g=k)}f=g-e;this.maxPixelIntensity=
g;this.minPixelIntensity=e;d=a.map(b,function(a){var b=a.value;a=this._toColor(a.color);return{value:b,ratio:(b-e)/f,color:a}},this)}else var m=b.length-1,d=a.map(b,function(a,b){return{color:this._toColor(a),ratio:b/m}},this);return d},_toColor:function(a){return a.toRgba||a.declaredClass||(a=new g(a)),a}});return b("extend-esri")&&l.setObject("renderer.HeatmapRenderer",h,f),h})},"esri/tasks/QueryTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ../geometry/Extent ../geometry/normalizeUtils ./Task ./FeatureSet".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q){h=h(n,{declaredClass:"esri.tasks.QueryTask",_eventMap:{complete:["featureSet"],"execute-for-count-complete":["count"],"execute-for-ids-complete":["objectIds"],"execute-relationship-query-complete":["featureSets"]},constructor:function(a,b){this._handler=l.hitch(this,this._handler);this._relationshipQueryHandler=l.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=l.hitch(this,this._executeForIdsHandler);this._countHandler=l.hitch(this,this._countHandler);
this._extentHandler=l.hitch(this,this._extentHandler);this.source=b&&b.source;this.gdbVersion=b&&b.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:4,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForExtent",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},
onExecuteForExtentComplete:function(){},execute:function(a,c,d,e,g){var f=g.assembly;a=this._encode(l.mixin({},this._url.query,{f:"json"},a.toJson(f&&f[0])));var k=this._handler,h=this._errorHandler;this.source&&(f={source:this.source.toJson()},a.layer=b.toJson(f));return this.gdbVersion&&(a.gdbVersion=this.gdbVersion),m({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,b){k(a,b,c,d,g.dfd)},error:function(a){h(a,d,g.dfd)},callbackSuffix:e},this.requestOptions)},executeRelationshipQuery:function(a,
b,c){a=this._encode(l.mixin({},this._url.query,{f:"json"},a.toJson()));var e=this._relationshipQueryHandler,f=this._errorHandler;this.gdbVersion&&(a.gdbVersion=this.gdbVersion);var k=new d(g._dfdCanceller);return k._pendingDfd=m({url:this._url.path+"/queryRelatedRecords",content:a,callbackParamName:"callback",load:function(a,d){e(a,d,b,c,k)},error:function(a){f(a,c,k)}},this.requestOptions),k},executeForIds:function(a,c,d,e){var g=e.assembly;a=this._encode(l.mixin({},this._url.query,{f:"json",returnIdsOnly:!0},
a.toJson(g&&g[0])));var f=this._executeForIdsHandler,k=this._errorHandler;this.source&&(g={source:this.source.toJson()},a.layer=b.toJson(g));return this.gdbVersion&&(a.gdbVersion=this.gdbVersion),m({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,b){f(a,b,c,d,e.dfd)},error:function(a){k(a,d,e.dfd)}},this.requestOptions)},executeForCount:function(a,c,d,e){var g=e.assembly;a=this._encode(l.mixin({},this._url.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},a.toJson(g&&
g[0])));var f=this._countHandler,k=this._errorHandler;this.source&&(g={source:this.source.toJson()},a.layer=b.toJson(g));return this.gdbVersion&&(a.gdbVersion=this.gdbVersion),m({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,b){f(a,b,c,d,e.dfd)},error:function(a){k(a,d,e.dfd)}},this.requestOptions)},executeForExtent:function(a,c,d,e){var g=e.assembly;a=this._encode(l.mixin({},this._url.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},a.toJson(g&&g[0])));
var f=this._extentHandler,k=this._errorHandler;this.source&&(g={source:this.source.toJson()},a.layer=b.toJson(g));return this.gdbVersion&&(a.gdbVersion=this.gdbVersion),m({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,b){f(a,b,c,d,e.dfd)},error:function(a){k(a,d,e.dfd)}},this.requestOptions)},_handler:function(a,b,c,d,e){try{var g=new q(a);this._successHandler([g],"onComplete",c,e)}catch(f){this._errorHandler(f,d,e)}},_relationshipQueryHandler:function(b,c,d,e,
g){try{var f=b.geometryType,k=b.spatialReference,m={};a.forEach(b.relatedRecordGroups,function(a){var b={};b.geometryType=f;b.spatialReference=k;b.features=a.relatedRecords;b=new q(b);if(null!=a.objectId)m[a.objectId]=b;else for(var c in a)a.hasOwnProperty(c)&&"relatedRecords"!==c&&(m[a[c]]=b)});this._successHandler([m],"onExecuteRelationshipQueryComplete",d,g)}catch(h){this._errorHandler(h,e,g)}},_executeForIdsHandler:function(a,b,c,d,e){try{this._successHandler([a.objectIds],"onExecuteForIdsComplete",
c,e)}catch(g){this._errorHandler(g,d,e)}},_countHandler:function(a,b,c,d,e){try{var g,f=a.features,k=a.objectIds;if(k)g=k.length;else{if(f)throw Error("Unable to perform query. Please check your parameters.");g=a.count}this._successHandler([g],"onExecuteForCountComplete",c,e)}catch(m){this._errorHandler(m,d,e)}},_extentHandler:function(a,b,c,d,g){try{a.extent&&(a.extent=new e(a.extent)),this._successHandler([a],"onExecuteForExtentComplete",c,g)}catch(f){this._errorHandler(f,d,g)}}});return c._createWrappers(h),
f("extend-esri")&&l.setObject("tasks.QueryTask",h,k),h})},"esri/tasks/FeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),function(h,l,a,d,b,f,k,m,g,e,c){h=h(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(b){if(b){l.mixin(this,b);var d=this.features,g=b.spatialReference,f=e.getGeometryType(b.geometryType),g=this.spatialReference=
new m(g);this.geometryType=b.geometryType;b.fields&&(this.fields=b.fields);a.forEach(d,function(a,b){var e=a.geometry&&a.geometry.spatialReference;d[b]=new k(f&&a.geometry?new f(a.geometry):null,a.symbol&&c.fromJson(a.symbol),a.attributes);d[b].geometry&&!e&&d[b].geometry.setSpatialReference(g)});this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,fieldAliases:null,toJson:function(a){var b={};return this.displayFieldName&&(b.displayFieldName=this.displayFieldName),
this.fields&&(b.fields=this.fields),this.spatialReference?b.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(b.spatialReference=this.features[0].geometry.spatialReference.toJson()),this.features[0]&&(this.features[0].geometry&&(b.geometryType=e.getJsonType(this.features[0].geometry)),b.features=g._encodeGraphics(this.features,a)),b.exceededTransferLimit=this.exceededTransferLimit,b.transform=this.transform,f.fixJson(b)},_hydrate:function(){var a=this.transform,
b=this.geometryType;if(!a||!b)return void(this.transform=null);for(var c=this.features,d=a.translate[0],e=a.translate[1],g=a.scale[0],f=a.scale[1],k=function(a,b,c){return"esriGeometryPoint"===a?function(a){a.x=b(a.x);a.y=c(a.y)}:"esriGeometryPolyline"===a||"esriGeometryPolygon"===a?function(a){var d,e,g,f,k,m,h,n=a.rings||a.paths;a=0;for(d=n.length;d>a;a++)for(f=n[a],e=0,g=f.length;g>e;e++)k=f[e],0<e?(m+=k[0],h+=k[1]):(m=k[0],h=k[1]),k[0]=b(m),k[1]=c(h)}:"esriGeometryEnvelope"===a?function(a){a.xmin=
b(a.xmin);a.ymin=c(a.ymin);a.xmax=b(a.xmax);a.ymax=c(a.ymax)}:"esriGeometryMultipoint"===a?function(a){var d,e,g,f,k=a.points;a=0;for(d=k.length;d>a;a++)e=k[a],0<a?(g+=e[0],f+=e[1]):(g=e[0],f=e[1]),e[0]=b(g),e[1]=c(f)}:void 0}(b,function(a){return a*g+d},function(a){return e-a*f}),a=0,b=c.length;b>a;a++)c[a].geometry&&k(c[a].geometry);this.transform=null},quantize:function(a){if(!this.geometryType)return this.transform=null,this;var b,c,d=a.translate[0],e=a.translate[1],g=a.scale[0],f=a.scale[1],
k=this.features,m=function(a,b,c){var d,e,g,f,k,m,h,n=[];d=0;for(e=a.length;e>d;d++)g=a[d],0<d?(m=b(g[0]),h=c(g[1]),(m!==f||h!==k)&&(n.push([m-f,h-k]),f=m,k=h)):(f=b(g[0]),k=c(g[1]),n.push([f,k]));return 0<n.length?n:null},h=function(a,b,c){return"esriGeometryPoint"===a?function(a){return a.x=b(a.x),a.y=c(a.y),a}:"esriGeometryPolyline"===a||"esriGeometryPolygon"===a?function(a){var d,e,g,f,k;g=a.rings||a.paths;k=[];d=0;for(e=g.length;e>d;d++)f=g[d],(f=m(f,b,c))&&k.push(f);return 0<k.length?(a.rings?
a.rings=k:a.paths=k,a):null}:"esriGeometryMultipoint"===a?function(a){var d;return d=m(a.points,b,c),0<d.length?(a.points=d,a):null}:"esriGeometryEnvelope"===a?function(a){return a}:void 0}(this.geometryType,function(a){return Math.round((a-d)/g)},function(a){return Math.round((e-a)/f)});b=0;for(c=k.length;c>b;b++)k[b].geometry&&(h(k[b].geometry)||k[b].setGeometry(null));return this.transform=a,this}});return d("extend-esri")&&l.setObject("tasks.FeatureSet",h,b),h})},"esri/graphicsUtils":function(){define(["dojo/_base/lang",
"dojo/_base/array","dojo/has","./kernel","./geometry/Extent"],function(h,l,a,d,b){var f={graphicsExtent:function(a){if(!a||!a.length)return null;var d,g,e=a[0].geometry,c=e.getExtent(),f=a.length;null===c&&(c=new b(e.x,e.y,e.x,e.y,e.spatialReference));for(g=1;f>g;g++)d=(e=a[g].geometry).getExtent(),null===d&&(d=new b(e.x,e.y,e.x,e.y,e.spatialReference)),c=c.union(d);return 0>c.getWidth()&&0>c.getHeight()?null:c},getGeometries:function(a){return l.map(a,function(a){return a.geometry})},_encodeGraphics:function(a,
b){var d,e,c,f=[];return l.forEach(a,function(a,k){d=a.toJson();e={};d.geometry&&(c=b&&b[k],e.geometry=c&&c.toJson()||d.geometry);d.attributes&&(e.attributes=d.attributes);f[k]=e}),f}};return a("extend-esri")&&h.mixin(d,f),f})},"esri/tasks/StatisticDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.tasks.StatisticDefinition",toJson:function(){return{statisticType:this.statisticType,onStatisticField:this.onStatisticField,
outStatisticFieldName:this.outStatisticFieldName,maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount}}});return a("extend-esri")&&l.setObject("tasks.StatisticDefinition",h,d),h})},"esri/layers/Field":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./RangeDomain ./CodedValueDomain".split(" "),function(h,l,a,d,b,f){h=h(null,{declaredClass:"esri.layers.Field",constructor:function(a){if(a&&l.isObject(a)&&(this.name=a.name,this.type=
a.type,this.alias=a.alias,this.length=a.length,this.editable=a.editable,this.nullable=a.nullable,(a=a.domain)&&l.isObject(a)))switch(a.type){case "range":this.domain=new b(a);break;case "codedValue":this.domain=new f(a)}}});return a("extend-esri")&&l.setObject("layers.Field",h,d),h})},"esri/layers/RangeDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./Domain".split(" "),function(h,l,a,d,b,f){h=h([f],{declaredClass:"esri.layers.RangeDomain",constructor:function(a){a&&
l.isObject(a)&&(this.minValue=a.range[0],this.maxValue=a.range[1])},toJson:function(){var a=this.inherited(arguments);return a.range=[this.minValue,this.maxValue],b.fixJson(a)}});return a("extend-esri")&&l.setObject("layers.RangeDomain",h,d),h})},"esri/layers/Domain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(h,l,a,d,b){h=h(null,{declaredClass:"esri.layers.Domain",constructor:function(a){a&&l.isObject(a)&&(this.name=a.name,this.type=a.type)},
toJson:function(){return b.fixJson({name:this.name,type:this.type})}});return a("extend-esri")&&l.setObject("layers.Domain",h,d),h})},"esri/layers/CodedValueDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ./Domain".split(" "),function(h,l,a,d,b,f,k){h=h([k],{declaredClass:"esri.layers.CodedValueDomain",constructor:function(a){a&&l.isObject(a)&&(this.codedValues=a.codedValues)},getName:function(b){var d;return a.some(this.codedValues,function(a){return a.code==
b&&(d=a.name),!!d}),d},toJson:function(){var a=this.inherited(arguments);return a.codedValues=l.clone(this.codedValues),f.fixJson(a)}});return d("extend-esri")&&l.setObject("layers.CodedValueDomain",h,b),h})},"esri/layers/FeatureType":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../symbols/jsonUtils ./RangeDomain ./CodedValueDomain ./InheritedDomain ./FeatureTemplate".split(" "),function(h,l,a,d,b,f,k,m,g,e,c){h=h(null,{declaredClass:"esri.layers.FeatureType",
constructor:function(a){if(a&&l.isObject(a)){this.id=a.id;this.name=a.name;var b=a.symbol;b&&(this.symbol=k.fromJson(b));var d,b=a.domains,f=this.domains={};for(d in b)if(b.hasOwnProperty(d)){var h=b[d];switch(h.type){case "range":f[d]=new m(h);break;case "codedValue":f[d]=new g(h);break;case "inherited":f[d]=new e(h)}}if(d=a.templates)for(b=this.templates=[],a=0;a<d.length;a++)b.push(new c(d[a]))}},toJson:function(){var b,c={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()},d=this.domains,
e=this.templates,g=f.fixJson;if(d){var k=c.domains={};for(b in d)d.hasOwnProperty(b)&&(k[b]=d[b]&&d[b].toJson());g(k)}return e&&(c.templates=a.map(e,function(a){return a.toJson()})),g(c)}});return d("extend-esri")&&l.setObject("layers.FeatureType",h,b),h})},"esri/layers/InheritedDomain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Domain"],function(h,l,a,d,b){h=h([b],{declaredClass:"esri.layers.InheritedDomain"});return a("extend-esri")&&l.setObject("layers.InheritedDomain",
h,d),h})},"esri/layers/FeatureTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../graphic".split(" "),function(h,l,a,d,b,f){h=h(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(a){a&&l.isObject(a)&&(this.name=a.name,this.description=a.description,this.drawingTool=a.drawingTool,this.thumbnail=a.thumbnail,a=a.prototype,this.prototype=new f(a.geometry,null,a.attributes))},toJson:function(){return b.fixJson({name:this.name,description:this.description,
drawingTool:this.drawingTool,thumbnail:b.fixJson(l.clone(this.thumbnail)),prototype:this.prototype&&this.prototype.toJson()})}});return l.mixin(h,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",
TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"}),a("extend-esri")&&l.setObject("layers.FeatureTemplate",h,d),h})},"esri/layers/FeatureEditResult":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.layers.FeatureEditResult",
constructor:function(a){a&&l.isObject(a)&&(this.objectId=a.objectId,this.success=a.success,!a.success)&&(a=a.error,this.error=Error(),this.error.code=a.code,this.error.message=a.description)}});return a("extend-esri")&&l.setObject("layers.FeatureEditResult",h,d),h})},"esri/layers/LabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../symbols/TextSymbol ../symbols/ShieldLabelSymbol".split(" "),function(h,l,a,d,b,f,k,m){var g=RegExp("__begin__",
"ig"),e=RegExp("__end__","ig"),c=/^__begin__/i,n=/__end__$/i;h=h(null,{declaredClass:"esri.layers.LabelClass",labelPlacement:null,labelExpression:null,format:null,fieldInfos:null,useCodedValues:null,symbol:null,maxScale:0,minScale:0,where:null,sizeInfo:null,_labelPlacementLookup:{"above-center":"esriServerPointLabelPlacementAboveCenter","above-left":"esriServerPointLabelPlacementAboveLeft","above-right":"esriServerPointLabelPlacementAboveRight","below-center":"esriServerPointLabelPlacementBelowCenter",
"below-left":"esriServerPointLabelPlacementBelowLeft","below-right":"esriServerPointLabelPlacementBelowRight","center-center":"esriServerPointLabelPlacementCenterCenter","center-left":"esriServerPointLabelPlacementCenterLeft","center-right":"esriServerPointLabelPlacementCenterRight","above-after":"esriServerLinePlacementAboveAfter","above-along":"esriServerLinePlacementAboveAlong","above-before":"esriServerLinePlacementAboveBefore","above-start":"esriServerLinePlacementAboveStart","above-end":"esriServerLinePlacementAboveEnd",
"below-after":"esriServerLinePlacementBelowAfter","below-along":"esriServerLinePlacementBelowAlong","below-before":"esriServerLinePlacementBelowBefore","below-start":"esriServerLinePlacementBelowStart","below-end":"esriServerLinePlacementBelowEnd","center-after":"esriServerLinePlacementCenterAfter","center-along":"esriServerLinePlacementCenterAlong","center-before":"esriServerLinePlacementCenterBefore","center-start":"esriServerLinePlacementCenterStart","center-end":"esriServerLinePlacementCenterEnd",
"always-horizontal":"esriServerPolygonPlacementAlwaysHorizontal"},constructor:function(a){a&&(l.mixin(this,a),this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)||(this.labelPlacement=f.valueOf(this._labelPlacementLookup,a.labelPlacement)),a.format&&(this.format=a.format),a.fieldInfos&&(this.fieldInfos=a.fieldInfos),a.symbol&&("esriSHD"===a.symbol.type?this.symbol=new m(a.symbol):this.symbol=new k(a.symbol)),(a=this.sizeInfo)&&(a.minSize&&(a.minSize=d.pt2px(a.minSize)),a.maxSize&&(a.maxSize=
d.pt2px(a.maxSize))))},getSymbol:function(){return this.symbol},toJson:function(){var a=this.sizeInfo;a&&(a=l.mixin({},a),a.minSize&&(a.minSize=d.px2pt(a.minSize)),a.maxSize&&(a.maxSize=d.px2pt(a.maxSize)));var b=f.fixJson(this.labelExpressionInfo&&l.clone(this.labelExpressionInfo));this._processLabelExpressionInfo(b);a={name:this.name,labelExpression:this.labelExpression,labelExpressionInfo:b,format:this.format||void 0,fieldInfos:this.fieldInfos||void 0,useCodedValues:this.useCodedValues,maxScale:this.maxScale,
minScale:this.minScale,where:this.where,sizeInfo:a||void 0,labelPlacement:this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)?this._labelPlacementLookup[this.labelPlacement]:this.labelPlacement,symbol:this.symbol&&this.symbol.toJson()};return f.fixJson(a)},_processLabelExpressionInfo:function(a){a&&a.value&&(a.expression=this._convertTemplatedStringToArcade(a.value))},_convertTemplatedStringToArcade:function(a){var b;return a&&(b=l.replace(a,function(a,b){return'__begin__$feature["'+b+
'"]__end__'}),b=c.test(b)?b.replace(c,""):'"'+b,b=n.test(b)?b.replace(n,""):b+'"',b=b.replace(g,'" + ').replace(e,' + "')),b}});return a("extend-esri")&&l.setObject("layers.LabelClass",h,b),h})},"esri/symbols/ShieldLabelSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol ./Font".split(" "),function(h,l,a,d,b,f,k,m,g){var e={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};h=h(m,{declaredClass:"esri.symbol.ShieldLabelSymbol",
type:"shieldlabelsymbol",color:[255,255,255,1],width:32,height:32,font:d.defaultFont,constructor:function(b,g,f,k,m){b?l.isString(b)?(this.url=b,g&&(this.color=g),f&&(this.width=f),k&&(this.height=k),void 0!==m&&(this.font=m)):(this.width=d.pt2px(b.width),this.height=d.pt2px(b.height),g=b.imageData,9>a("ie")||!g||(f=this.url,this.url="data:"+(b.contentType||"image")+";base64,"+g,this.imageData=f)):l.mixin(this,e)},getStroke:function(){return null},getFill:function(){return this.color},setWidth:function(a){return this.width=
a,this},setHeight:function(a){return this.height=a,this},setUrl:function(a){return a!==this.url&&(delete this.imageData,delete this.contentType),this.url=a,this},setFont:function(a){return this.font=a,this},setText:function(a){return this.text=a,this},getWidth:function(){return this.width},getHeight:function(){return this.height},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||
""},fill:null,stroke:null}},toJson:function(){var a=this.url,b=this.imageData;if(0===a.indexOf("data:"))var e=a,a=b,b=e.indexOf(";base64,")+8,b=e.substr(b);var a=k.getAbsoluteUrl(a),e=d.px2pt(this.width),e=isNaN(e)?void 0:e,m=d.px2pt(this.height),m=isNaN(m)?void 0:m,a=f.fixJson(l.mixin(this.inherited("toJson",arguments),{type:"esriSHD",url:a,imageData:b,contentType:this.contentType,width:e,height:m}));this.font?(b=new g(this.font),a.font=b.toJson()):a.font=null;return delete a.size,a.imageData||delete a.imageData,
a}});return h.defaultProps=e,a("extend-esri")&&(l.setObject("symbol.ShieldLabelSymbol",h,b),b.symbol.defaultShieldLabelSymbol=e),h})},"esri/layers/SnapshotMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ../tasks/query ./RenderMode".split(" "),function(h,l,a,d,b,f,k){h=h([k],{declaredClass:"esri.layers._SnapshotMode",constructor:function(a){this.featureLayer=a;this.pagination=a.queryPagination;this._featureMap={};this._hasPartialFeatures=!1;this._drawFeatures=
l.hitch(this,this._drawFeatures);this._queryErrorHandler=l.hitch(this,this._queryErrorHandler)},startup:function(){this.pagination=this.pagination&&null!=this.featureLayer.maxRecordCount;this.featureLayer._collection?this._applyTimeFilter():this._fetchAll()},propertyChangeHandler:function(a){this._init&&(a?this.featureLayer._collection||this._fetchAll():this._applyTimeFilter())},drawFeature:function(a){var b=a.attributes[this.featureLayer.objectIdField];this._addFeatureIIf(b,a);this._incRefCount(b)},
resume:function(){this.propertyChangeHandler(0)},refresh:function(){var a=this.featureLayer;a._collection?(a._fireUpdateStart(),a._refresh(!0),a._fireUpdateEnd()):this._fetchAll()},hasAllFeatures:function(){return!this._hasPartialFeatures},_getRequestId:function(a){return("_"+a.name+a.layerId+a._ulid).replace(/[^a-zA-Z0-9\_]+/g,"_")},_fetchAll:function(){var a=this.featureLayer;a._collection||a.suspended||(a._fireUpdateStart(),this._clearIIf(),this._hasPartialFeatures=!1,this._sendRequest())},_sendRequest:function(a){var d=
this.map,e=this.featureLayer,c=e.getDefinitionExpression(),k=new f;k.outFields=e.getOutFields();k.where=c||"1\x3d1";k.returnGeometry=!0;k.outSpatialReference=new b(d.spatialReference.toJson());k.timeExtent=e.getTimeDefinition();k.maxAllowableOffset=e._maxOffset;k.quantizationParameters=e._quantizationParameters;e._ts&&(k._ts=(new Date).getTime());k.orderByFields=e.supportsAdvancedQueries?e.getOrderByFields():null;k.multipatchOption=e.multipatchOption;this.pagination&&(this._start=k.start=null==a?
0:a,k.num=e.maxRecordCount);var h;e._usePatch&&(h=this._getRequestId(e),this._cancelPendingRequest(null,h));e._task.execute(k,this._drawFeatures,this._queryErrorHandler,h)},_drawFeatures:function(a){this._purgeRequests();var b,d,c,f,k=a.features,h=this.featureLayer,l=h.objectIdField,v=k.length,t=a.exceededTransferLimit&&!h._collection,w=h._selectedFeatures,x=h.mode===h.constructor.MODE_AUTO;h._fireUpdateStart();h._sortFeatures(k);for(b=0;v>b;b++)c=k[b],f=c.attributes[l],d=this._addFeatureIIf(f,c),
this._incRefCount(f),x&&d!==c&&w[f]&&(d.setGeometry(c.geometry),d.setAttributes(c.attributes));this._applyTimeFilter(!0);this.pagination&&t||(this._hasPartialFeatures=!!a.exceededTransferLimit,h._fireUpdateEnd(null,a.exceededTransferLimit?{queryLimitExceeded:!0}:null));t&&(this.pagination&&this._sendRequest(this._start+h.maxRecordCount),h.onQueryLimitExceeded())},_queryErrorHandler:function(a){this._purgeRequests();this._hasPartialFeatures=!0;var b=this.featureLayer;b._errorHandler(a);b._fireUpdateEnd(a)}});
return a("extend-esri")&&l.setObject("layers._SnapshotMode",h,d),h})},"esri/layers/RenderMode":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/io/script ../kernel".split(" "),function(h,l,a,d,b,f,k){l=l(null,{declaredClass:"esri.layers._RenderMode",constructor:function(){this._prefix="jsonp_"+(h._scopeName||"dojo")+"IoScript"},initialize:function(a){this.map=a;this._init=!0},startup:function(){},propertyChangeHandler:function(a){},destroy:function(){this._init=
!1},drawFeature:function(a){},suspend:function(){},resume:function(){},refresh:function(){},hasAllFeatures:function(){return!0},_incRefCount:function(a){(a=this._featureMap[a])&&a._count++},_decRefCount:function(a){(a=this._featureMap[a])&&a._count--},_getFeature:function(a){return this._featureMap[a]},_addFeatureIIf:function(a,b){var d=this._featureMap,c=d[a],f=this.featureLayer;return c||(d[a]=b,f._add(b),b._count=0),c||b},_removeFeatureIIf:function(a){var b=this._featureMap[a],d=this.featureLayer;
if(b){if(b._count)return;delete this._featureMap[a];d._remove(b)}return b},_clearIIf:function(){var a;a=this.featureLayer;var b=a.graphics,d=a._selectedFeatures,c=a.getSelectedFeatures().length,f=a.objectIdField;if(c)for(a=b.length-1;0<=a;a--){var c=b[a],k=c.attributes[f];k in d?c._count=1:(c._count=0,this._removeFeatureIIf(k))}else a.clear(),this._featureMap={}},_isPending:function(a){return f[this._prefix+a]?!0:!1},_cancelPendingRequest:function(a,b){if(a=a||f[this._prefix+b])try{a.cancel(),f._validCheck(a)}catch(d){}},
_purgeRequests:function(){f._validCheck(null)},_toggleVisibility:function(a){var b,d=this.featureLayer,c=d.graphics,f=a?"show":"hide",k=c.length;a=a&&d._ager;for(b=0;k>b;b++){var h=c[b];h[f]();a&&d._repaint(h)}},_applyTimeFilter:function(a){var b=this.featureLayer;if(b.timeInfo&&!b.suspended){a||b._fireUpdateStart();var e=b._trackManager;e&&e.clearTracks();var c=b.getTimeDefinition(),f=b._getOffsettedTE(b._mapTimeExtent);f?(f=b._getTimeOverlap(c,f))?(c=b._filterByTime(b.graphics,f.startTime,f.endTime),
e&&e.addFeatures(c.match),d.forEach(c.match,function(a){var c=a._shape;a.visible||(a.show(),c=a._shape,c&&c._moveToFront());b._ager&&c&&b._repaint(a)}),d.forEach(c.noMatch,function(a){a.visible&&a.hide()})):this._toggleVisibility(!1):(e&&e.addFeatures(b.graphics),this._toggleVisibility(!0));e&&(e.moveLatestToFront(),e.drawTracks());a||b._fireUpdateEnd()}}});return b("extend-esri")&&a.setObject("layers._RenderMode",l,k),l})},"esri/layers/OnDemandMode":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/has ../kernel ../geometry/Point ../tasks/query ./RenderMode ./GridLayout".split(" "),
function(h,l,a,d,b,f,k,m,g,e){h=h([g],{declaredClass:"esri.layers._OnDemandMode",constructor:function(b){this.featureLayer=b;this._featureMap={};this._hasPartialFeatures=!1;this._queryErrorHandler=a.hitch(this,this._queryErrorHandler)},initialize:function(a){this.inherited(arguments);var b=this.featureLayer,d=b._srInfo;this._gridLayer=new e(new k(d?d.valid[0]:a.extent.xmin,d?d.valid[1]:a.extent.ymax,a.spatialReference),{width:b._tileWidth,height:b._tileHeight},{width:a.width,height:a.height},d);this._cellMap=
{};this._gridLayer.setResolution(a.extent)},startup:function(){this._ioQueue=[];this.featureLayer.suspended||(this._zoomHandler(),this._enableConnectors())},propertyChangeHandler:function(a){this._init&&2>a&&this._zoomHandler()},destroy:function(){this._disableConnectors();this.inherited(arguments)},drawFeature:function(a){var b=this._gridLayer,d=a.geometry,e=[];if(d)for(var e=b.getCellsInExtent("point"===d.type?{xmin:d.x,ymin:d.y,xmax:d.x,ymax:d.y}:d.getExtent(),!1).cells,g,f,k,m=this._cellMap,h=
a.attributes[this.featureLayer.objectIdField],b=0;b<e.length;b++)d=e[b],g=d.latticeID,f=d.row,k=d.col,g?d=m[g]=m[g]||d:(m[f]=m[f]||{},d=m[f][k]=m[f][k]||d),d.features=d.features||[],d.features.push(a),this._addFeatureIIf(h,a),this._incRefCount(h)},suspend:function(){this._init&&this._disableConnectors()},resume:function(){this._init&&(this._enableConnectors(),this._zoomHandler())},refresh:function(){this._zoomHandler()},hasAllFeatures:function(){if(this._hasPartialFeatures)return!0;var a,b=!1,d=this._getCurrentCells();
for(a=0;a<d.length;a++)if(d[a].hasPartialFeatures){b=!0;break}return!b},_enableConnectors:function(){var a=this.map;this._zoomConnect=l.connect(a,"onZoomEnd",this,this._zoomHandler);this._panConnect=l.connect(a,"onPanEnd",this,this._panHandler);this._resizeConnect=l.connect(a,"onResize",this,this._panHandler)},_disableConnectors:function(){l.disconnect(this._zoomConnect);l.disconnect(this._panConnect);l.disconnect(this._resizeConnect)},_zoomHandler:function(){this._processIOQueue(!0);var a=this.featureLayer,
b=this.map;a.suspended||(a._fireUpdateStart(),this._clearIIf(),this._hasPartialFeatures=!1,(a=a._trackManager)&&a.clearTracks(),this._cellMap={},this._gridLayer.setResolution(b.extent),this._sendRequest())},_panHandler:function(a){this.featureLayer._fireUpdateStart();var b=this.featureLayer._resized;a=b?a:null;b&&this._gridLayer.setMapState(a,this.map.width,this.map.height);this._sendRequest(a)},_getRequestId:function(a,b){return("_"+a.name+a.layerId+a._ulid+"_"+b.resolution+"_"+(b.latticeID||b.row+
"_"+b.col)).replace(/[^a-zA-Z0-9\_]+/g,"_")},_sendRequest:function(a){this._exceeds=!1;var b=this.featureLayer,e=this.map;a=a||e.extent;e=this._gridLayer.getCellsInExtent(a,b.latticeTiling).cells;if(!b.isEditable())var g=this._cellMap,e=d.filter(e,function(a){if(a.lattice){if(g[a.latticeID])return!1}else if(g[a.row]&&g[a.row][a.col])return!1;return!0});var f,k,h,l,x=b.getOutFields(),y=b.getDefinitionExpression(),z=b._getOffsettedTE(b._mapTimeExtent),A=b.supportsAdvancedQueries?b.getOrderByFields():
null,B=b._usePatch,C=this._ioQueue,D=this,E=this._drawFeatures;this._pending=this._pending||0;for(f=0;f<e.length;f++)k=e[f],h=new m,h.geometry=k.extent||k.lattice,h.outFields=x,h.where=y,b.latticeTiling&&k.extent&&(h.spatialRelationship=m.SPATIAL_REL_CONTAINS),h.returnGeometry=!0,h.timeExtent=z,b._ts&&(h._ts=(new Date).getTime()),h.orderByFields=A,h.multipatchOption=b.multipatchOption,h.maxAllowableOffset=b._maxOffset,h.quantizationParameters=b._quantizationParameters,(l=b.advancedQueryCapabilities)&&
l.supportsQueryWithResultType&&(h.resultType="tile"),l=null,B&&(l=this._getRequestId(b,k),this._isPending(l))||(this._pending++,C.push(b._task.execute(h,function(){var a=k;return function(b){E.apply(D,[b,a])}}.call(this),this._queryErrorHandler,l)));this._removeOldCells(a);this._endCheck()},_drawFeatures:function(a,b){b.hasPartialFeatures=!!a.exceededTransferLimit;this._exceeds=this._exceeds||a.exceededTransferLimit;this._finalizeIO();var d,e;d=this.featureLayer;e=this.map.extent;var g=b.extent,f=
b.row,k=b.col,m=d.objectIdField,h=a.features,l=this._gridLayer,z=this._cellMap,A=b.latticeID,B=A?z[A]:z[f]&&z[f][k];if(b.resolution==l._resolution&&(A?A===l.getLatticeID(e):l.intersects(g,e)))if(B)d._sortFeatures(h),this._updateCell(B,h);else for(d._sortFeatures(h),b.features=h,A?z[A]=b:(z[f]=z[f]||{},z[f][k]=b),e=h.length,d=0;e>d;d++)g=h[d],f=g.attributes[m],this._addFeatureIIf(f,g),this._incRefCount(f);else B&&this._removeCell(f,k,A);this._endCheck()},_queryErrorHandler:function(a){this._finalizeIO();
this._hasPartialFeatures=!0;this.featureLayer._errorHandler(a);this._endCheck(!0)},_finalizeIO:function(){this._purgeRequests();this._pending--},_endCheck:function(a){if(0===this._pending){this._processIOQueue();var b=this.featureLayer,e=b._trackManager;e&&(e.clearTracks(),e.addFeatures(b.graphics),b._ager&&d.forEach(b.graphics,function(a){a._shape&&b._repaint(a)}),e.moveLatestToFront(),e.drawTracks());this.featureLayer._fireUpdateEnd(a&&Error("FeatureLayer: an error occurred while updating the layer"),
this._exceeds?{queryLimitExceeded:!0}:null);this._exceeds&&b.onQueryLimitExceeded()}},_processIOQueue:function(a){this._ioQueue=d.filter(this._ioQueue,function(a){return-1<a.fired?!1:!0});a&&d.forEach(this._ioQueue,this._cancelPendingRequest)},_getCurrentCells:function(a){var b,d=[];a=a||this._cellMap;for(b in a)if(a.hasOwnProperty(b)){var e=a[b];e&&(e.hasOwnProperty("row")||e.hasOwnProperty("latticeID")?d.push(e):"object"==typeof e&&d.push.apply(d,this._getCurrentCells(e)))}return d},_removeOldCells:function(a){var b,
d,e=this._cellMap,g=this._gridLayer;for(b in e)if(e[b]){var f=e[b],k=f.latticeID,m=0,h=0;if(k)m++,k!==g.getLatticeID(a)&&(this._removeCell(null,null,k),h++);else for(d in f)f[d]&&(m++,g.intersects(f[d].extent,a)||(this._removeCell(b,d),h++));h===m&&delete e[b]}},_updateCell:function(a,b){var d;d=this.featureLayer;var e=d.objectIdField,g=d._selectedFeatures,f=b.length;a.features=a.features||[];for(d=0;f>d;d++){var k=b[d],m=k.attributes[e],h=this._addFeatureIIf(m,k);h===k?(this._incRefCount(m),a.features.push(h)):
m in g||(h.setGeometry(k.geometry),h.setAttributes(k.attributes))}},_removeCell:function(a,b,d){var e=this._cellMap,g=this.featureLayer,f=g.objectIdField,k=d?e[d]:e[a]&&e[a][b];if(k)for(d?delete e[d]:delete e[a][b],b=k.features,a=0;a<b.length;a++)d=b[a].attributes[f],this._decRefCount(d),d in g._selectedFeatures||this._removeFeatureIIf(d)}});return b("extend-esri")&&a.setObject("layers._OnDemandMode",h,f),h})},"esri/layers/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/Polyline".split(" "),
function(h,l,a,d,b,f,k,m){h=h(null,{declaredClass:"esri.layers._GridLayout",constructor:function(a,b,c,d){this.origin=a;this.cellWidth=b.width;this.cellHeight=b.height;this.mapWidth=c.width;this.mapHeight=c.height;this.srInfo=d},setResolution:function(a){if(this._resolution=(a.xmax-a.xmin)/this.mapWidth,this.srInfo)a=Math.round(2*this.srInfo.valid[1]/this._resolution),a=Math.round(a/this.cellWidth),this._frameStats=[a,0,a-1]},setMapState:function(a,b,c){this.mapWidth=b;this.mapHeight=c;this.setResolution(a)},
getCellCoordinates:function(a){var b=this._resolution,c=this.origin;return{row:Math.floor((c.y-a.y)/(this.cellHeight*b)),col:Math.floor((a.x-c.x)/(this.cellWidth*b))}},normalize:function(a){var b=this._frameStats;if(b){var c=b[0],d=b[1],b=b[2];d>a?(a%=c,a=d>a?a+c:a):a>b&&(a%=c)}return a},intersects:function(b,d){var c=this.srInfo;return c?a.some(d._getParts(c),function(a){return b.intersects(a.extent)}):b.intersects(d)},getCellExtent:function(a,b){var c=this._resolution,d=this.origin,m=this.cellWidth,
h=this.cellHeight;return new k(b*m*c+d.x,d.y-(a+1)*h*c,(b+1)*m*c+d.x,d.y-a*h*c,new f(d.spatialReference.toJson()))},getLatticeID:function(a){var b=this.getCellCoordinates({x:a.xmin,y:a.ymax}),c=this.getCellCoordinates({x:a.xmax,y:a.ymin});a=b.row;var d=c.row,b=this.normalize(b.col),c=this.normalize(c.col);return a+"_"+d+"_"+b+"_"+c},sorter:function(a,b){return b>a?-1:1},getCellsInExtent:function(b,d){var c,f,k,h,l,v,t,w,x=this.getCellCoordinates({x:b.xmin,y:b.ymax}),y=this.getCellCoordinates({x:b.xmax,
y:b.ymin}),z=x.row,A=y.row,x=x.col,y=y.col,B=[];w=[];var C=[],D=[];for(c=z;A>=c;c++)for(f=x;y>=f;f++)k=this.normalize(f),b=this.getCellExtent(c,k),a.some(B,function(a){return a.row===c&&a.col===k})||B.push({row:c,col:k,extent:b,resolution:this._resolution}),d&&(w.push(b.xmin,b.xmax),C.push(b.ymin,b.ymax));x=this.normalize(x);y=this.normalize(y);w.sort(this.sorter);C.sort(this.sorter);f=w.length;for(c=f-1;0<=c;c--)f-1>c&&w[c]===w[c+1]&&w.splice(c,1);f=C.length;for(c=f-1;0<=c;c--)f-1>c&&C[c]===C[c+
1]&&C.splice(c,1);if(w.length&&C.length){h=w[0];l=w[w.length-1];v=C[0];t=C[C.length-1];f=w.length;for(c=0;f>c;c++)D.push([[w[c],t],[w[c],v]]);f=C.length;for(c=0;f>c;c++)D.push([[h,C[c]],[l,C[c]]]);w=new m({paths:D,spatialReference:this.origin.spatialReference.toJson()});B.push({latticeID:z+"_"+A+"_"+x+"_"+y,lattice:w,resolution:this._resolution})}return{minRow:z,maxRow:A,minCol:x,maxCol:y,cells:B}}});return d("extend-esri")&&l.setObject("layers._GridLayout",h,b),h})},"esri/layers/SelectionMode":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","./RenderMode"],function(h,l,a,d,b){h=h([b],{declaredClass:"esri.layers._SelectionMode",constructor:function(a){this.featureLayer=a;this._featureMap={}},propertyChangeHandler:function(a){this._init&&0===a&&this._applyTimeFilter()},resume:function(){this.propertyChangeHandler(0)},hasAllFeatures:function(){return!this.featureLayer._hasPartialSelectedFeatures}});return a("extend-esri")&&l.setObject("layers._SelectionMode",h,d),h})},"esri/layers/StreamMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../tasks/query ../tasks/QueryTask ../geometry/jsonUtils ./RenderMode".split(" "),
function(h,l,a,d,b,f,k,m,g,e){h=h([e],{declaredClass:"esri.layers._StreamMode",constructor:function(a,b){this.featureLayer=a;this._featureMap={};this._setRefreshRate();this._drawBuffer={adds:[],updates:[]};this._timeoutId=null;this._flushDrawBuffer=l.hitch(this,this._flushDrawBuffer);this._featuresByTime={};this._lastEndTimeCheck=null;this._maxFeatureAge=0;a.purgeOptions&&a.purgeOptions.age&&"number"==typeof a.purgeOptions.age&&(this._maxFeatureAge=1E3*Math.ceil(60*a.purgeOptions.age));this._drawFeatures=
l.hitch(this,this._drawFeatures);this._queryErrorHandler=l.hitch(this,this._queryErrorHandler)},startup:function(){this.featureLayer._collection},propertyChangeHandler:function(a){this._init&&(0===a?this._applyTimeFilter():3===a&&this._redrawAllTracks())},destroy:function(){this.inherited(arguments);clearTimeout(this._timeoutId);this._featuresByTime=this._drawBuffer=this._featureMap=null},drawFeature:function(a){var b=this.featureLayer,d=b.objectIdField;this._timeoutId||(this._timeoutId=setTimeout(this._flushDrawBuffer,
this._refreshRate));b._joinField&&this._getFeature(a.attributes[d])?this._drawBuffer.updates.push({oid:a.attributes[d],updates:a}):this._drawBuffer.adds.push(a)},resume:function(){this.propertyChangeHandler(0)},refresh:function(){var a=this.featureLayer;a&&(a._relatedUrl||a._keepLatestUrl?(a._fireUpdateStart(),a._refreshing=!0,a.disconnect(),a.clear(),a._relatedQueried=!1,a._keepLatestQueried=!1,a.connect()):(a._fireUpdateStart(),a.clear(),a._fireUpdateEnd()))},_drawFeatures:function(a,b){this._purgeRequests();
var d=this.featureLayer;d._create(a.features||[]);d._fireUpdateEnd(null,b)},_applyTimeFilter:function(a){this.inherited(arguments);this._redrawAllTracks()},_removeFeatures:function(b){var d=this.featureLayer,e=d.objectIdField;b&&a.forEach(b,function(a){a=a.attributes[e];d._unSelectFeatureIIf(a,this);this._decRefCount(a);this._removeFeatureIIf(a)},this)},_addFeatures:function(b){var d,e,g,f=this.featureLayer,k=f._endTimeField,m=f._startTimeField,h=[],l=[],y=[];if(d=f._trackManager,e=f.objectIdField,
d)for(g in b=d.addFeatures(b),b)b.hasOwnProperty(g)&&(h.push(g),b[g].adds&&(l=l.concat(b[g].adds)),b[g].deletes&&(y=y.concat(b[g].deletes)));else l=b;a.forEach(l,function(a){var b,c,d=a.attributes[e];b=k&&a.attributes[k];!b&&this._maxFeatureAge&&(b=m&&a.attributes[m]?a.attributes[m]+this._maxFeatureAge:Date.now()+this._maxFeatureAge);b&&(c=1E3*Math.ceil(b/1E3),this._featuresByTime[c]?this._featuresByTime[c].push(d):this._featuresByTime[c]=[d]);this._addFeatureIIf(d,a);this._incRefCount(d)},this);
y.length&&this._removeFeatures(y);d&&d.refreshTracks(h)},_updateFeatures:function(b){var d,e,g=this.featureLayer,f=[];d=g._trackManager;e=g._trackIdField;a.forEach(b,function(a){var b,c;b=a.updates;if(a=this._getFeature(a.oid)){b.geometry&&a.setGeometry(b.geometry);b=b.attributes||{};for(c in b)b.hasOwnProperty(c)&&(a.attributes[c]=b[c]);a.visible=this._checkFeatureTimeIntersects(a);d&&a.attributes[e]?f.push(a.attributes[e]):g._repaint(a,null,!0)}},this);f.length&&d.refreshTracks(f)},_redrawAllTracks:function(){var a,
b=this.featureLayer._trackManager;b&&(a=b.trimTracks(),a&&0<a.length&&(this._removeFeatures(a),b.refreshTracks()))},_flushDrawBuffer:function(){clearTimeout(this._timeoutId);var a,b=this._drawBuffer,d=b.adds.splice(0,b.adds.length),b=b.updates.splice(0,b.updates.length),e=this.featureLayer;return e?(e.updating||e._fireUpdateStart(),this._addFeatures(d),this._updateFeatures(b),a=this._getExpiredFeatures(),a&&a.length&&(this._removeFeatures(a),e._trackManager&&e._trackManager.removeFeatures(a)),e._purge(),
e._fireUpdateEnd(),void(this._timeoutId=null)):!1},_clearDrawBuffer:function(){var a=this._timeoutId,b=this._drawBuffer,d=b.adds,b=b.updates;a&&clearTimeout(a);d.splice(0,d.length);b.splice(0,b.length);this._timeoutId=null},_clearTimeBin:function(){this._featuresByTime={};this._lastEndTimeCheck=1E3*Math.ceil(Date.now()/1E3)},_clearFeatureMap:function(){this._featureMap={}},_setRefreshRate:function(a){a=a||0===a?a:200;0>a&&(a=200);this._refreshRate=a},_checkFeatureTimeIntersects:function(a){var b,
d=this.featureLayer,e=d.getMap();return(e=e?e.timeExtent:null)&&d.timeInfo&&(d.timeInfo.startTimeField||d.timeInfo.endTimeField)?(b=d._filterByTime([a],e.startTime,e.endTime),0<b.match.length):!0},_getRequestId:function(a){return("_"+a.name+a.layerId+a._ulid).replace(/[^a-zA-Z0-9\_]+/g,"_")},_fetchArchive:function(a){function b(a){z++;e.execute(h).then(function(b){a(null,b)},function(b){a(b)})}function d(a,c){if(a)return z>=A||!y._relatedUrl?void B._queryErrorHandler(Error("Could not get features from related feature service")):
(C={relatedFeatureWarning:"Querying related feature service using the current filter failed. All related features are displayed, and the filter is applied to the stream service only"},h.where="1\x3d1",void b(d));var e=B._fixFieldNameCasing(y,c);c.features=e;B._drawFeatures(c,C)}var e,h,l,t,w,x,y=this.featureLayer;if(y._fireUpdateStart(),!a||!this.map)return this._fireUpdateEnd({error:"Archive data cannot be fetched if no feature service url is provided or if the layer is not added to a map"}),!1;
e=new m(a);h=new k;a=this.map;l=y.getFilter()||{};t=l.where||"1\x3d1";w=l.geometry?g.fromJson(l.geometry):null;l=l.outFields?l.outFields.split(","):["*"];h.geometry=w;h.where=t;h.outFields=l;h.returnGeometry=!0;h.outSpatialReference=new f(a.spatialReference.toJson());y._usePatch&&(x=this._getRequestId(y),this._cancelPendingRequest(null,x));var z=0,A=2,B=this,C=null;b(d)},_queryErrorHandler:function(a){this._purgeRequests();var b=this.featureLayer;b._errorHandler(a);b._fireUpdateEnd(a)},_fixFieldNameCasing:function(a,
b){var d=b.features||[],e=b.fields;if(!e||!d.length)return d;for(var g,f=this._mapFieldNameDifferences(a.fields,e),k=[],m=0,h=b.features.length;h>m;m++)e=d[m],g=this._swizzleResponseAttributes(e.attributes,f),k.push({geometry:e.geometry,attributes:g});return k},_mapFieldNameDifferences:function(a,b){var d,e,g=[],f={};d=0;for(e=b.length;e>d;d++)g.push(b[d].name);d=0;for(e=a.length;e>d;d++){var k=a[d].name,m=this._checkForStreamFieldName(k,g);m&&(f[m]=k)}return f},_checkForStreamFieldName:function(a,
b){for(var d,e=a.toLowerCase(),g=0,f=b.length;f>g;g++)if(b[g].toLowerCase()===e){d=b[g];break}return d},_swizzleResponseAttributes:function(a,b){var d={},e;for(e in a)if(a.hasOwnProperty(e)){var g=a[e];b.hasOwnProperty(e)?d[b[e]]=g:d[e]=g}return d},_getExpiredFeatures:function(){var b,d,e,g=[],f=[];if(!this.featureLayer._endTimeField&&!this._maxFeatureAge)return f;if(b=1E3*Math.floor(this._lastEndTimeCheck/1E3),d=1E3*Math.ceil(Date.now()/1E3),this._lastEndTimeCheck=d,b&&b!==d)for(e=this._featuresByTime;d>=
b;b+=1E3)e[b]&&(g=g.concat(e[b]),delete e[b]);return a.forEach(g,function(a){(a=this._getFeature(a))&&f.push(a)},this),f}});return d("extend-esri")&&l.setObject("layers._StreamMode",h,b),h})},"esri/layers/TrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../geometry/Polyline ./GraphicsLayer".split(" "),function(h,l,a,d,b,f,k,m){h=h(null,{declaredClass:"esri.layers._TrackManager",constructor:function(a){this.layer=a;this.trackMap={};
this.trackLineMap={}},initialize:function(a){this.map=a;var b=this.layer,c=b._getRenderer(),c=c&&c.trackRenderer;if("esriGeometryPoint"===b.geometryType){var d=this.container=new m._GraphicsLayer({id:b.id+"_tracks",_child:!0,visible:b.visible,minScale:b.minScale,maxScale:b.maxScale});d.loaded=!0;d.onLoad(d);d._setMap(a,b._div);d.setRenderer(c);b.on("visibility-change",l.hitch(this,function(a){this.container.setVisibility(a.visible);this.container.evaluateSuspension()}));b.on("scale-range-change",
l.hitch(this,function(){this.container.setScaleRange(this.layer.minScale,this.layer.maxScale)}))}},addFeatures:function(b){var d=this.trackMap,c=this.layer,f=c._trackIdField,k=[];a.forEach(b,function(b){var c=b.attributes[f];(d[c]=d[c]||[]).push(b);-1===a.indexOf(k,c)&&k.push(c)});var m=c._startTimeField,h=c.objectIdField,l=function(a,b){var c=a.attributes[m],d=b.attributes[m];return c===d?a.attributes[h]<b.attributes[h]?-1:1:d>c?-1:1};a.forEach(k,function(a){d[a].sort(l)})},trimTracks:function(b){function d(a){for(a=
f[a]||[];a.length>k;)m.push(a.shift())}var c,f=this.trackMap,k=this.layer.maximumTrackPoints||0,m=[];if(!k)return m;if(b)a.forEach(b,function(a){d(a)});else for(c in f)f.hasOwnProperty(c)&&d(c);return m},drawTracks:function(b){function d(a){var b,e,g,l,r=c[a];if(l=u.trackLineMap[a],v.remove(l),delete u.trackLineMap[a],l=null,!r||2>r.length)return!1;e=[];for(b=r.length-1;0<=b;b--)(g=r[b].geometry)&&e.push([g.x,g.y]);b={};b[h]=a;1<e.length&&(l=new f(new k({paths:[e],spatialReference:m}),null,b),v.add(l),
u.trackLineMap[a]=l)}var c,m,h,l,u=this,v=this.container;if(v)if(c=this.trackMap,m=this.map.spatialReference,h=this.layer._trackIdField,b)a.forEach(b,function(a){d(a)});else for(l in c)c.hasOwnProperty(l)&&d(l)},refreshTracks:function(b){function d(a){var b,c;if(f.drawTracks([a]),h&&h.latestObservationRenderer)for(a=k[a]||[],b=a.length,c=0;b>c;c++)m._repaint(a[c],null,!0)}var c,f=this,k=this.trackMap,m=this.layer,h=m._getRenderer();if(b)a.forEach(b,function(a){d(a)});else for(c in k)k.hasOwnProperty(c)&&
d(c);this.moveLatestToFront()},moveLatestToFront:function(b){a.forEach(this.getLatestObservations(b),function(a){var b=a._shape;b&&b._moveToFront();this._repaint(a,null,!0)},this.layer)},getLatestObservations:function(b){function d(a){a=m[a];return a[a.length-1]}var c,f=[],k=this.layer._getRenderer(),m=this.trackMap;if(!k.latestObservationRenderer)return f;if(b)a.forEach(b,function(a){f.push(d(a))});else for(c in m)m.hasOwnProperty(c)&&f.push(d(c));return f},clearTracks:function(b){var d,c=this.getLatestObservations(b),
f=this.container;b?a.forEach(b,function(a){delete this.trackMap[a];f&&(d=this.trackLineMap[a],f.remove(d),delete this.trackLineMap[a])},this):(this.trackMap={},this.trackLineMap={},f&&f.clear());a.forEach(c,function(a){this._repaint(a,null,!0)},this.layer)},isLatestObservation:function(a){var b=this.trackMap[a.attributes[this.layer._trackIdField]];return b?b[b.length-1]===a:!1},destroy:function(){var a=this.container;a&&(a.clear(),a._unsetMap(this.map,this.layer._div));this.map=this.layer=this.trackMap=
this.container=null}});return d("extend-esri")&&l.setObject("layers._TrackManager",h,b),h})},"esri/layers/HeatmapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/_base/array require ../kernel ../sniff ../geometry/Point ../geometry/webMercatorUtils ./MapImage ../renderers/HeatmapRenderer ../tasks/query dojo/_base/fx".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q){function r(){}function u(a){var b=a.layer;return{geometry:a.geometry,attributes:a.attributes,getLayer:function(){return b}}}
h=h(null,{declaredClass:"esri.layers.HeatmapManager",heatmapRenderer:null,sourceLayer:null,imageLayer:null,useTiles:!0,useWorker:!1,map:null,constructor:function(a){this.sourceLayer=a;this._hndls=[]},initialize:function(a){this.map=a;var d=this.sourceLayer,e=d.renderer;d.setDrawMode(!1);this.imageLayer=a._getMapImageLyr();var f=this;e instanceof c?this.heatmapRenderer=e:this.heatmapRenderer=(e.getRendererInfoByZoom(a.getZoom())||e.getRendererInfoByScale(a.getScale())).renderer;this._setupDraw=this._setupDraw.bind(this);
this.recalculateHeatmap=this.recalculateHeatmap.bind(this);this._removeRenderer=this._removeRenderer.bind(this);this._handleRendererChange=this._handleRendererChange.bind(this);this._rendererChangeHandle=this.sourceLayer.on("renderer-change",this._handleRendererChange);this._handleOpacityChange=this._handleOpacityChange.bind(this);this._reprojectFeature=this._reprojectFeature.bind(this);b(["../workers/heatmapCalculator"],function(a){f._calculator=new a(l.mixin({width:f.map.width,height:f.map.height},
f._getOptions()));f._setupRenderer();f.heatmapRenderer.getStats=a.calculateStats;f.heatmapRenderer.getHistogramData=a.getHistogramData})},destroy:function(){this._removeHandlers();this._rendererChangeHandle&&this._rendererChangeHandle.remove();this._rendererChangeHandle=this.sourceLayer=this.imageLayer=this.map=this.heatmapRenderer=this._hndls=null},_handleRendererChange:function(a){var b=a.renderer,d=b instanceof c;this.heatmapRenderer?d?this.heatmapRenderer=b:this._removeRenderer(a):d&&(this.heatmapRenderer=
b,this.sourceLayer&&this.map&&this._setupRenderer())},_handleOpacityChange:function(a){a=a.opacity;var b=this._getImageBySourceId(this.sourceLayer.id);b&&b.setOpacity(a)},_setupRenderer:function(){var b=this._hndls,c=this.sourceLayer,e=this.map,f=this;c._originalDraw=c._draw;c._draw=r;c._div.clear();clearTimeout(this._resetTimer);this._resetTimer=setTimeout(this._resetGraphics.bind(this),250);b.push(c.on("update-end",this._setupDraw));b.push(c.on("suspend",function(a){(a=f._getImageBySourceId(f.sourceLayer.id))&&
a.hide()}));b.push(c.on("resume",function(a){(a=f._getImageBySourceId(f.sourceLayer.id))&&a.show()}));b.push(a.after(c,"redraw",this._setupDraw));b.push(e.on("layer-remove",function(a){a.layer==c&&((a=f._getImageBySourceId(f.sourceLayer.id))&&f.imageLayer.removeImage(a),f._removeRenderer({target:c}))}));c._collection&&b.push(c.on("graphic-add",function(a){f._reprojectFeature(a.graphic);f._setupDraw()}));1!==c.mode&&(b.push(e.on("resize, pan-end",this._setupDraw)),b.push(e.on("zoom-end",this._setupDraw)));
b.push(c.on("opacity-change",this._handleOpacityChange));this.imageLayer.suspended&&this.imageLayer.resume();c.graphics&&c.graphics.length&&(c.graphics[0].geometry&&!e.spatialReference.equals(c.graphics[0].geometry.spatialReference)&&d.forEach(c.graphics,function(a){this._reprojectFeature(a)}.bind(this)),this._setupDraw())},_setupDraw:function(){if(!this._drawTimer){var a=(this.sourceLayer,this);this._drawTimer=setTimeout(function(){clearTimeout(a._drawTimer);a._drawTimer=null;a.sourceLayer._getRenderer().isInstanceOf(c)&&
a.recalculateHeatmap()},16)}},_removeRenderer:function(a){var b=a.target;b._draw=b._originalDraw;delete b._originalDraw;b.setDrawMode(!0);this._removeHandlers();this._hndls=[];var c=this._getImageBySourceId(this.sourceLayer.id);c&&this.imageLayer.removeImage(c);clearTimeout(this._drawTimer);clearTimeout(this._resetTimer);this._drawTimer=this._resetTimer=null;b.renderer!=a.renderer&&b.renderer.getRendererInfo?this.heatmapRenderer=null:(b.redraw(),this.destroy())},recalculateHeatmap:function(){this._calculator?
this._doMainCalculation():this._calculatorClient&&this._doWorkerCalculation()},_reprojectFeature:function(a){if(a&&a.geometry){var b=a.geometry,c=this.map.spatialReference;c.equals(b.spatialReference)||(b=g.project(b,c),null==b||(a.geometry=b))}},_doWorkerCalculation:function(){},_doMainCalculation:function(){var a=this.sourceLayer,b=this.map,c=this.heatmapRenderer,d=this.map.extent,f=this.map.width,g=this.map.height,k=this._calculator,m=this,h=function(h){h=m._getScreenPoints(h.features,b,a);h=k.calculateImageData(l.mixin({screenPoints:h,
mapinfo:{extent:[d.xmin,d.ymin,d.xmax,d.ymax],resolution:b.getResolution()},width:f,height:g},m._getOptions()));h=c.getSymbol(u({geometry:b.extent,attributes:{size:[f,g],imageData:h},layer:a}));h=new e({extent:b.extent,href:h.url,opacity:0,sourceId:a.id});m._swapMapImages(h,m._getImageBySourceId(a.id));a.suspended&&h.hide()},r={geometry:b.extent,timeExtent:a.useMapTime?b.timeExtent:void 0,spatialRelationship:n.SPATIAL_REL_INTERSECTS};null!=a._canDoClientSideQuery(r)?a.queryFeatures(r,h):h({features:a.graphics})},
_getScreenPoints:function(a,b,c){var e,f,g,k=[],h=a.length,n=0,l=0,r=new m(b.extent.xmin,b.extent.ymax,b.spatialReference),u=b.toScreen(r),q=u.x,u=u.y,G=b.getResolution();for((e=b.extent.getCacheValue("_parts"))&&(g=d.map(e,function(a){return c._intersects(b,a.extent)[0]}));h--;)e=a[h],e.geometry&&(f={x:Math.ceil((e.geometry.x-r.x)/G+q),y:Math.floor((r.y-e.geometry.y)/G-u),attributes:e.attributes},g&&(l=1<g.length&&f.x<-g[0]?g[1]:g[0],f.x+=l),k[n++]=f);return k},_getImageBySourceId:function(a){var b=
this.imageLayer.getImages();return b=d.filter(b,function(b){return b.sourceId==a}),b.length?b[b.length-1]:void 0},_swapMapImages:function(a,b){function c(){d.removeImage(b)}var d=this.imageLayer,e=this.sourceLayer.opacity||1;d.addImage(a);q.anim(a._node,{opacity:e},null,null,function(){a.opacity=e});null!=b&&q.anim(b._node,{opacity:0},null,null,c)},_removeHandlers:function(){if(null!=this._hndls)for(var a=this._hndls.length;a--;)this._hndls[a].remove()},_getOptions:function(){var a=this.heatmapRenderer;
return{blurRadius:a.blurRadius,gradient:a.gradient,maxPixelIntensity:a.maxPixelIntensity,minPixelIntensity:a.minPixelIntensity,field:a.field,fieldOffset:a.fieldOffset}},_resetGraphics:function(){clearTimeout(this._resetTimer);this._resetTimer=null;for(var a,b=this.sourceLayer.graphics,c=b.length;c--;)a=b[c],a._shape=a._offsets=void 0}});return k("extend-esri")&&l.setObject("layers.HeatmapManager",h,f),h})},"esri/layers/MapImage":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has ../kernel ../domUtils ../geometry/Extent".split(" "),
function(h,l,a,d,b,f,k){h=h(null,{declaredClass:"esri.layers.MapImage",constructor:function(a){l.mixin(this,a);this.extent=new k(this.extent)},visible:!0,opacity:1,getLayer:function(){return this._layer},getNode:function(){return this._node},show:function(){if(!this.visible){this.visible=!0;var a,b=this._node,d=this._layer;b&&(a=d&&d._div,a&&(d.suspended||d._setPos(b,a._left,a._top),(d._active||a).appendChild(b)),f.show(b))}},hide:function(){if(this.visible){this.visible=!1;var a=this._node;a&&(f.hide(a),
a.parentNode&&a.parentNode.removeChild(a))}},setOpacity:function(b){var d=this._node;this.opacity=b;d&&a.set(d,"opacity",b)}});return d("extend-esri")&&l.setObject("layers.MapImage",h,b),h})},"esri/layers/ArcGISDynamicMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/sniff dojo/io-query ../kernel ../config ../request ../urlUtils ../layerUtils ../geometry/scaleUtils ./DynamicMapServiceLayer ./ArcGISMapServiceLayer ./TimeInfo ./LayerTimeOptions ./ImageParameters ./DynamicLayerInfo ./LayerMapSource".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x){h=h([q,r],{declaredClass:"esri.layers.ArcGISDynamicMapServiceLayer",_eventMap:{"visible-layers-change":["visibleLayers"]},constructor:function(a,b,c){a=b&&b.imageParameters;var d=l.hitch;if(a){var e=a.layerDefinitions;e&&this.setLayerDefinitions(e);a.layerOption===t.LAYER_OPTION_SHOW&&(this.visibleLayers=[].concat(a.layerIds),this.onVisibleLayersChange(this.visibleLayers))}this._setIsPNG32=d(this,this._setIsPNG32);this.dpi=a&&a.dpi||96;this.imageFormat=
a&&a.format||"png8";this.imageTransparency=a&&!1===a.transparent?!1:!0;this._setIsPNG32();this.gdbVersion=b&&b.gdbVersion;this._params.gdbVersion=this.gdbVersion;l.mixin(this._params,this._url.query,{dpi:this.dpi,transparent:this.imageTransparency,format:this.imageFormat},a?a.toJson():{});this.getImageUrl=d(this,this.getImageUrl);this._initLayer=d(this,this._initLayer);this._load=d(this,this._load);this.useMapImage=b?b.useMapImage:!1;this._loadCallback=b&&b.loadCallback;(b=b&&b.resourceInfo)?this._initLayer(b):
(void 0===c||!1===c)&&this._load();this.registerConnectEvents()},disableClientCaching:!1,layerDefinitions:null,_initLayer:function(a,b){this.inherited(arguments);a.timeInfo&&(this.timeInfo=new u(a.timeInfo));this.loaded=!0;this.onLoad(this);var c=this._loadCallback;c&&(delete this._loadCallback,c(this))},getImageUrl:function(a,b,c,k){var h=this._url.path+"/export?",n=this._params,r=a.spatialReference.wkid||d.toJson(a.spatialReference.toJson()),u=this._errorHandler;if(delete n._ts,l.mixin(n,{bbox:a.xmin+
","+a.ymin+","+a.xmax+","+a.ymax,bboxSR:r,imageSR:r,size:b+","+c},this.disableClientCaching?{_ts:(new Date).getTime()}:{}),n.layerDefs)a=n.layerDefs,delete n.layerDefs,l.mixin(n,{layerDefs:a});var q=n.token=this._getToken();a=e.addProxy(h+f.objectToQuery(l.mixin({},n,{f:"image"})));a.length>m.defaults.io.postLength||this.useMapImage?this._jsonRequest=g({url:h,content:l.mixin(n,{f:"json"}),callbackParamName:"callback",load:function(a){a=a.href;q&&(a+=-1===a.indexOf("?")?"?token\x3d"+q:"\x26token\x3d"+
q);k(e.addProxy(a))},error:u}):k(a)},_setIsPNG32:function(){var a=this.imageFormat.toLowerCase(),c=b("ie");this.isPNG32=c&&6===c&&("png32"===a||"png24"===a)&&this.imageTransparency},_setTime:function(b){var d=this.timeInfo;b=this._params.time=b?b.toJson().join(","):null;if(10.02>this.version&&d)if(b)this._params.layerTimeOptions=c._serializeTimeOptions(this.layerTimeOptions);else{var e=this.layerInfos;if(e){var f=this.layerTimeOptions,g=f?f.slice(0):[],k=[];a.forEach(e,function(a){a.subLayerIds||
k.push(a.id)});k.length&&(a.forEach(k,function(a){if(!g[a]){var b=new v;b.useTime=!1;g[a]=b}}),this._params.layerTimeOptions=c._serializeTimeOptions(g,k))}}10.02<=this.version&&d&&(b||d.hasLiveData||(this._params.time="null,null"))},setDPI:function(a,b){this.dpi=this._params.dpi=a;b||this.refresh(!0)},setImageFormat:function(a,b){this.imageFormat=this._params.format=a;this._setIsPNG32();b||this.refresh(!0)},setImageTransparency:function(a,b){this.imageTransparency=this._params.transparent=a;this._setIsPNG32();
b||this.refresh(!0)},setVisibleLayers:function(a,b){this.visibleLayers=a;this._params.layers=t.LAYER_OPTION_SHOW+":"+(a.length?a.join():"-1");this._updateDynamicLayers();b||this.refresh(!0);this.onVisibleLayersChange(this.visibleLayers)},onVisibleLayersChange:function(){},setDefaultVisibleLayers:function(a){this.visibleLayers=this._defaultVisibleLayers;this._params.layers=null;this._updateDynamicLayers();a||this.refresh(!0);this.onVisibleLayersChange(this.visibleLayers)},setLayerDefinitions:function(a,
b){this.layerDefinitions=a;this._params.layerDefs=c._serializeLayerDefinitions(a);this._updateDynamicLayers();b||this.refresh(!0)},setDefaultLayerDefinitions:function(a){this.layerDefinitions=this._params.layerDefs=null;this._updateDynamicLayers();a||this.refresh(!0)},setDisableClientCaching:function(a){this.disableClientCaching=a},setLayerTimeOptions:function(a,b){this.layerTimeOptions=a;this._params.layerTimeOptions=c._serializeTimeOptions(a);this._updateDynamicLayers();b||this.refresh(!0)},refresh:function(a){if(a)this.inherited(arguments);
else{var b=this.disableClientCaching;this.disableClientCaching=!0;this.inherited(arguments);this.disableClientCaching=b}},setLayerDrawingOptions:function(a,b){this.layerDrawingOptions=a;this._updateDynamicLayers();b||this.refresh(!0)},setDynamicLayerInfos:function(a,b){a&&0<a.length?(this.dynamicLayerInfos=a,this.visibleLayers=c._getDefaultVisibleLayers(a),this.onVisibleLayersChange(this.visibleLayers)):this.dynamicLayerInfos=this.layerDrawingOptions=null;this._updateDynamicLayers();b||this.refresh(!0)},
createDynamicLayerInfosFromLayerInfos:function(){var b,c=[];return a.forEach(this.layerInfos,function(a){b=new w(a.toJson());b.source=new x({mapLayerId:a.id});c.push(b)}),c},_onDynamicLayersChange:function(){},_updateDynamicLayers:function(){if(this.dynamicLayerInfos&&0<this.dynamicLayerInfos.length||this.layerDrawingOptions&&0<this.layerDrawingOptions.length){this.dynamicLayerInfos&&0!==this.dynamicLayerInfos.length||(this.dynamicLayerInfos=this.createDynamicLayerInfosFromLayerInfos());var b;b=this.dynamicLayerInfos;
var e=[],f=this._map&&n.getScale(this._map),g=this.visibleLayers,k=f?c._getLayersForScale(f,b):g;a.forEach(b,function(b){if(!b.subLayerIds){var c,d=b.id;if(-1!==a.indexOf(g,d)&&-1!==a.indexOf(k,d)){c={id:d,name:b.name};c.source=b.source&&b.source.toJson();var f;this.layerDefinitions&&this.layerDefinitions[d]&&(f=this.layerDefinitions[d]);f&&(c.definitionExpression=f);var m;this.layerDrawingOptions&&this.layerDrawingOptions[d]&&(m=this.layerDrawingOptions[d]);m&&(c.drawingInfo=m.toJson());var h;this.layerTimeOptions&&
this.layerTimeOptions[d]&&(h=this.layerTimeOptions[d]);h&&(c.layerTimeOptions=h.toJson());c.minScale=b.minScale||0;c.maxScale=b.maxScale||0;e.push(c)}}},this);b=d.toJson(e);this._params.dynamicLayers&&this._params.dynamicLayers.length===b.length&&this._params.dynamicLayers===b||(this._params.dynamicLayers=b,this._onDynamicLayersChange(this._params.dynamicLayers))}else this._params.dynamicLayers?(this._params.dynamicLayers=null,this._onDynamicLayersChange(null)):this._params.dynamicLayers=null},_onExtentChangeHandler:function(a,
b,c){c&&this._updateDynamicLayers();this.inherited(arguments)},_setMap:function(a,b,c){return this._map=a,this._updateDynamicLayers(),this.inherited(arguments)},onGDBVersionChange:function(){},setGDBVersion:function(a,b){this.gdbVersion=a;this._params.gdbVersion=a;this.onGDBVersionChange();b||this.refresh(!0)},exportMapImage:function(a,b){var c=m.defaults.map,c=l.mixin({size:c.width+","+c.height},this._params,a?a.toJson(this.normalization):{},{f:"json"});if(delete c._ts,c.layerDefs){var d=c.layerDefs;
delete c.layerDefs;l.mixin(c,{layerDefs:d})}this._exportMapImage(this._url.path+"/export",c,b)}});return b("extend-esri")&&l.setObject("layers.ArcGISDynamicMapServiceLayer",h,k),h})},"esri/layers/DynamicMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/dom-construct dojo/dom-style dojox/gfx/matrix ../kernel ../config ../sniff ../request ../domUtils ./layer ./MapImage".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q){var r=m.defaults.map.zoomDuration;h=h(n,
{declaredClass:"esri.layers.DynamicMapServiceLayer",_eventMap:{"map-image-export":["mapImage"]},constructor:function(b,c){this.useMapTime=c&&c.hasOwnProperty("useMapTime")?!!c.useMapTime:!0;this.extentProcessor=c&&c.extentProcessor;var d=a.hitch;this._exportMapImageHandler=d(this,this._exportMapImageHandler);this._imgSrcFunc=d(this,this._imgSrcFunc);this._divAlphaImageFunc=d(this,this._divAlphaImageFunc);this._tileLoadHandler=d(this,this._tileLoadHandler);this._tileErrorHandler=d(this,this._tileErrorHandler);
this.registerConnectEvents()},opacity:1,isPNG32:!1,_setMap:function(a,c,e){this.inherited(arguments);this._map=a;var f=this._div=d.create("div",null,c),m=k._css.names,h={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible",opacity:this.opacity},n=g("ie"),r=l.connect,q=a.__visibleDelta;if(8===n&&delete h.opacity,"css-transforms"===a.navigationMode?(this._isChildLayer||(h[m.transform]=k._css.translate(q.x,q.y),b.set(f,h)),this._left=q.x,this._top=q.y):(h.left="0px",h.top="0px",
b.set(f,h),this._left=this._top=0),b.set(f,h),this._onResizeHandler_connect=r(a,"onResize",this,"_onResizeHandler"),this._opacityChangeHandler_connect=r(this,"onOpacityChange",this,"_opacityChangeHandler"),this._img_loading=null,this._dragOrigin={x:0,y:0},this.evaluateSuspension(),this.suspended&&!a.loaded)var C=l.connect(a,"onLoad",this,function(){l.disconnect(C);C=null;this.evaluateSuspension()});return this.extentProcessor&&(this._panEndEvalHandle=l.connect(a,"onPanEnd",this,this.evaluateSuspension),
this._zoomEndEvalHandle=l.connect(a,"onZoomEnd",this,this.evaluateSuspension)),f},_unsetMap:function(a,b){this._img&&this._clearEventListeners(this._img);this._img_loading&&this._clearEventListeners(this._img_loading);d.destroy(this._div);this._map=this._div=this._img=this._img_loading=null;var c=l.disconnect;c(this._onResizeHandler_connect);c(this._opacityChangeHandler_connect);c(this._panEndEvalHandle);c(this._zoomEndEvalHandle);this._panEndEvalHandle=this._zoomEndEvalHandle=this._onResizeHandler_connect=
this._opacityChangeHandler_connect=null;this._fireUpdateEnd();this._toggleTime();clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();this.inherited(arguments)},_onResizeHandler:function(a,c,d){b.set(this._div,{width:c+"px",height:d+"px"});this._onExtentChangeHandler(a)},onSuspend:function(){this.inherited(arguments);this._fireUpdateEnd();this._toggleTime();c.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(){this.inherited(arguments);
var c=this._map;if(this._toggleTime(),"css-transforms"===c.navigationMode)c=c.__visibleDelta,this._left=c.x,this._top=c.y,this._isChildLayer||b.set(this._div,k._css.names.transform,k._css.translate(this._left,this._top));this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(a.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0)}),0)},canResume:function(){var a=this.inherited(arguments);if(a){var b=this._map.extent;this.extentProcessor&&b&&
(a=!!this.extentProcessor({layer:this,extent:b,width:this._map.width}).extent)}return a},_enableDrawConnectors:function(){var a=l.connect,b=this._map;b&&(this._onPanHandler_connect=a(b,"onPan",this,"_onPanHandler"),this._onExtentChangeHandler_connect=a(b,"onExtentChange",this,"_onExtentChangeHandler"),"css-transforms"===b.navigationMode?this._onScaleHandler_connect=a(b,"onScale",this,this._onScaleHandler):this._onZoomHandler_connect=a(b,"onZoom",this,"_onZoomHandler"))},_disableDrawConnectors:function(){var a=
l.disconnect;a(this._onPanHandler_connect);a(this._onExtentChangeHandler_connect);a(this._onZoomHandler_connect);a(this._onScaleHandler_connect);this._onPanHandler_connect=this._onExtentChangeHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=null},_toggleTime:function(){var a=this._map;this.timeInfo&&this.useMapTime&&a&&!this.suspended?(this._timeConnect||(this._timeConnect=l.connect(a,"onTimeExtentChange",this,this._onTimeExtentChangeHandler)),this._setTime(a.timeExtent)):
(l.disconnect(this._timeConnect),this._timeConnect=null,this._setTime(null))},_setTime:function(a){this._params&&(this._params.time=a?a.toJson().join(","):null)},_onPanHandler:function(a,c){this._panDx=c.x;this._panDy=c.y;var d=this._dragOrigin,e=this._map.__visibleDelta,f=this._img;f&&("css-transforms"===this._map.navigationMode?(this._left=e.x+c.x,this._top=e.y+c.y,this._isChildLayer||b.set(this._div,k._css.names.transform,k._css.translate(this._left,this._top))):b.set(f,{left:d.x+c.x+"px",top:d.y+
c.y+"px"}))},_onExtentChangeHandler:function(a,c,e){if(!this.suspended){clearTimeout(this._wakeTimer);this._wakeTimer=null;var m=this._map,h=this._img,n=h&&h.style,q=this._dragOrigin;!c||e||!h||c.x===this._panDx&&c.y===this._panDy||("css-transforms"===m.navigationMode?(c=m.__visibleDelta,this._left=c.x,this._top=c.y,this._isChildLayer||b.set(this._div,k._css.names.transform,k._css.translate(this._left,this._top))):b.set(h,{left:q.x+c.x+"px",top:q.y+c.y+"px"}));h?(q.x=parseInt(n.left,10),q.y=parseInt(n.top,
10)):q.x=q.y=0;"css-transforms"===m.navigationMode&&e&&h&&(b.set(h,k._css.names.transition,"none"),h._multiply=h._multiply?f.multiply(h._matrix,h._multiply):h._matrix);this._fireUpdateStart();if(e=this._img_loading)if(this._clearEventListeners(e),d.destroy(e),this._img_loading=null,e=this._jsonRequest){try{e.cancel()}catch(A){}this._jsonRequest=null}var B=m.width;e=m.height;c=B;var C=0;if(10<=this.version&&m.wrapAround180&&(a=a._normalize(!0)),this.extentProcessor)C=this.extentProcessor({layer:this,
extent:a,width:c}),a=C.extent,c=C.width,C=C.marginLeft||0;if(this.isPNG32)h=this._img_loading=d.create("div"),h.id=m.id+"_"+this.id+"_"+(new Date).getTime(),b.set(h,{position:"absolute",left:"0px",top:"0px",width:c+"px",height:e+"px"}),m=h.appendChild(d.create("div")),b.set(m,{opacity:0,width:c+"px",height:e+"px"}),this.getImageUrl(a,c,e,this._divAlphaImageFunc);else{var D=this._img_loading=d.create("img"),E=k._css.names,F=g("ie"),H={position:"absolute",width:c+"px",height:e+"px"};8===F&&(H.opacity=
this.opacity);null!=C&&0!==C&&(H.marginLeft=C+"px");"css-transforms"===m.navigationMode?(H[E.transform]=k._css.translate(-this._left,-this._top),D._tdx=-this._left,D._tdy=-this._top,H[E.transition]=E.transformName+" "+r+"ms ease",this.extentProcessor&&(H[E.origin]=B/2-C+"px "+e/2+"px")):(H.left="0px",H.top="0px");D.id=m.id+"_"+this.id+"_"+(new Date).getTime();b.set(D,H);D._onload_connect=l.connect(D,"onload",this,"_onLoadHandler");D._onerror_connect=l.connect(D,"onerror",this,"_onErrorHandler");D._onabort_connect=
l.connect(D,"onabort",this,"_onErrorHandler");this._startRect={left:q.x,top:q.y,width:h?parseInt(n.width,10):c,height:h?parseInt(n.height,10):e,marginLeft:h?parseInt(n.marginLeft||"0",10):C,zoom:n&&n.zoom?parseFloat(n.zoom):1};this.getImageUrl(a,c,e,this._imgSrcFunc)}}},_onTimeExtentChangeHandler:function(a){this.suspended||(this._setTime(a),this.refresh(!0))},getImageUrl:function(a,b,c,d){},_imgSrcFunc:function(a){this._img_loading.src=a},_divAlphaImageFunc:function(a){b.set(this._img_loading,"filter",
"progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+a+"', sizingMethod\x3d'scale')");this._onLoadHandler({currentTarget:this._img_loading})},_onLoadHandler:function(a){a=a.currentTarget;var b=this._map;if(this._clearEventListeners(a),!b||b.__panning||b.__zooming)return d.destroy(a),void this._fireUpdateEnd();this._img&&this._div.removeChild(this._img);this._img=a;b=a.style;this._startRect={left:0,top:0,width:parseInt(b.width,10),height:parseInt(b.height,10),marginLeft:parseInt(b.marginLeft||
"0",10),zoom:1};this._div.appendChild(a);this.suspended||c.show(this._div);this._img_loading=null;a=this._dragOrigin;a.x=a.y=0;this.onUpdate();this._fireUpdateEnd()},_onErrorHandler:function(a){a=a.currentTarget;b.set(a,"visibility","hidden");this._clearEventListeners(a);a=Error("Unable to load image: "+a.src);this.onError(a);this._fireUpdateEnd(a)},_clearEventListeners:function(a){l.disconnect(a._onload_connect);l.disconnect(a._onerror_connect);l.disconnect(a._onabort_connect);a._onload_connect=
a._onerror_connect=a._onabort_connect=null},setUseMapTime:function(a,b){this.useMapTime=a;this._toggleTime();b||this.refresh(!0)},refresh:function(){this._map&&this._onExtentChangeHandler(this._map.extent)},_onScaleHandler:function(a,c){var d={},e=k._css.names,g=this._img;g&&(b.set(g,e.transition,c?"none":e.transformName+" "+r+"ms ease"),g._matrix=a,a=g._multiply?f.multiply(a,g._multiply):a,(g._tdx||g._tdy)&&(a=f.multiply(a,{xx:1,xy:0,yx:0,yy:1,dx:g._tdx,dy:g._tdy})),d[e.transform]=k._css.matrix(a),
b.set(g,d))},_onZoomHandler:function(a,c,d){a=this._startRect;var e=a.width*c,f=a.height*c,k=a.marginLeft*c,m=this._img,h=g("ie");m&&(h&&8>h?b.set(m,{left:a.left-(e-a.width)*(d.x-a.left)/a.width+"px",top:a.top-(f-a.height)*(d.y-a.top)/a.height+"px",zoom:c*a.zoom}):b.set(m,{left:a.left-(e-a.width)*(d.x-a.left)/a.width+"px",top:a.top-(f-a.height)*(d.y-a.top)/a.height+"px",width:e+"px",height:f+"px"}),null!=k&&0!==k&&b.set(m,{marginLeft:k+"px"}))},_exportMapImage:function(a,b,c){var d=this._exportMapImageHandler;
b.token=this._getToken();e({url:a,content:b,callbackParamName:"callback",load:function(a,b){d(a,b,c)},error:m.defaults.io.errorHandler})},_exportMapImageHandler:function(a,b,c){a=new q(a);this.onMapImageExport(a);c&&c(a)},onMapImageExport:function(){},setOpacity:function(a){this.opacity!=a&&this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_opacityChangeHandler:function(a){var c=8===g("ie")?this._img:this._div;b.set(c,"opacity",a)}});return g("extend-esri")&&a.setObject("layers.DynamicMapServiceLayer",
h,k),h})},"esri/layers/DynamicLayerInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./LayerInfo ./LayerMapSource ./LayerDataSource".split(" "),function(h,l,a,d,b,f,k,m){h=h(f,{declaredClass:"esri.layers.DynamicLayerInfo",defaultVisibility:!0,parentLayerId:-1,maxScale:0,minScale:0,constructor:function(a){if(a){var b;a.source?b="mapLayer"===a.source.type?new k(a.source):new m(a.source):(b=new k,b.mapLayerId=this.id);this.source=b}},toJson:function(){var a=this.inherited(arguments);
return a.source=this.source&&this.source.toJson(),b.fixJson(a)}});return a("extend-esri")&&l.setObject("layers.DynamicLayerInfo",h,d),h})},"esri/layers/LayerMapSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./LayerSource".split(" "),function(h,l,a,d,b,f){h=h(f,{declaredClass:"esri.layers.LayerMapSource",type:"mapLayer",toJson:function(){return b.fixJson({type:"mapLayer",mapLayerId:this.mapLayerId,gdbVersion:this.gdbVersion})}});return a("extend-esri")&&l.setObject("layers.LayerMapSource",
h,d),h})},"esri/layers/LayerSource":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.layers.LayerSource",type:null,constructor:function(a){a&&l.mixin(this,a)},toJson:function(){}});return a("extend-esri")&&l.setObject("layers.LayerSource",h,d),h})},"esri/layers/LayerDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./LayerSource ./TableDataSource ./QueryDataSource ./JoinDataSource ./RasterDataSource".split(" "),
function(h,l,a,d,b,f,k,m,g,e){h=h(f,{declaredClass:"esri.layers.LayerDataSource",type:"dataLayer",constructor:function(a){if(a&&a.dataSource){switch(a.dataSource.type){case "table":a=new k(a.dataSource);break;case "queryTable":a=new m(a.dataSource);break;case "joinTable":a=new g(a.dataSource);break;case "raster":a=new e(a.dataSource);break;default:a=a.dataSource}this.dataSource=a}},toJson:function(){var a={type:"dataLayer",dataSource:this.dataSource&&this.dataSource.toJson()};return b.fixJson(a)}});
return a("extend-esri")&&l.setObject("layers.LayerDataSource",h,d),h})},"esri/layers/TableDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./DataSource".split(" "),function(h,l,a,d,b,f){h=h(f,{declaredClass:"esri.layers.TableDataSource",toJson:function(){return b.fixJson({type:"table",workspaceId:this.workspaceId,dataSourceName:this.dataSourceName,gdbVersion:this.gdbVersion})}});return a("extend-esri")&&l.setObject("layers.TableDataSource",h,d),h})},"esri/layers/DataSource":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.layers.DataSource",constructor:function(a){a&&l.mixin(this,a)},toJson:function(){}});return a("extend-esri")&&l.setObject("layers.DataSource",h,d),h})},"esri/layers/QueryDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./DataSource ../SpatialReference".split(" "),function(h,l,a,d,b,f,k){h=h(f,{declaredClass:"esri.layers.QueryDataSource",constructor:function(a){a&&(a.oidFields&&
l.isString(a.oidFields)&&(this.oidFields=a.oidFields.split(",")),a.spatialReference&&(this.spatialReference=new k(a.spatialReference)))},toJson:function(){var a={type:"queryTable",workspaceId:this.workspaceId,query:this.query,oidFields:this.oidFields&&this.oidFields.join(),spatialReference:this.spatialReference&&this.spatialReference.toJson()};if(this.geometryType){var d;d="point"===this.geometryType.toLowerCase()?"esriGeometryPoint":"multipoint"===this.geometryType.toLowerCase()?"esriGeometryMultipoint":
"polyline"===this.geometryType.toLowerCase()?"esriGeometryPolyline":"polygon"===this.geometryType.toLowerCase()?"esriGeometryPolygon":this.geometryType;a.geometryType=d}return b.fixJson(a)}});return a("extend-esri")&&l.setObject("layers.QueryDataSource",h,d),h})},"esri/layers/JoinDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./DataSource ./LayerMapSource ./TableDataSource ./QueryDataSource ./RasterDataSource".split(" "),function(h,l,a,d,b,f,k,m,g,e){var c=
h(f,{declaredClass:"esri.layers.JoinDataSource",constructor:function(a){a&&(a.leftTableSource&&(this.leftTableSource=this._createLayerSource(a.leftTableSource)),a.rightTableSource&&(this.rightTableSource=this._createLayerSource(a.rightTableSource)))},_createLayerSource:function(a){var d;if("mapLayer"===a.type)d=new k(a);else{d={type:"dataLayer"};var f;switch(a.dataSource.type){case "table":f=new m(a.dataSource);break;case "queryTable":f=new g(a.dataSource);break;case "joinTable":f=new c(a.dataSource);
break;case "raster":f=new e(a.dataSource);break;default:f=a.dataSource}d.dataSource=f;d.toJson=function(){var a={type:"dataLayer",dataSource:f.toJson()};return b.fixJson(a)}}return d},toJson:function(){var a,c={type:"joinTable",leftTableSource:this.leftTableSource&&this.leftTableSource.toJson(),rightTableSource:this.rightTableSource&&this.rightTableSource.toJson(),leftTableKey:this.leftTableKey,rightTableKey:this.rightTableKey};return a="left-outer-join"===this.joinType.toLowerCase()?"esriLeftOuterJoin":
"left-inner-join"===this.joinType.toLowerCase()?"esriLeftInnerJoin":this.joinType,c.joinType=a,b.fixJson(c)}});return a("extend-esri")&&l.setObject("layers.JoinDataSource",c,d),c})},"esri/layers/RasterDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./DataSource".split(" "),function(h,l,a,d,b,f){h=h(f,{declaredClass:"esri.layers.RasterDataSource",toJson:function(){return b.fixJson({type:"raster",workspaceId:this.workspaceId,dataSourceName:this.dataSourceName})}});
return a("extend-esri")&&l.setObject("layers.RasterDataSource",h,d),h})},"cmv/viewer/js/gis/dijit/LayerControl":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/topic dojo/dom-attr dojo/dom-construct dijit/_WidgetBase dijit/_Container dijit/layout/ContentPane dijit/form/Button esri/tasks/ProjectParameters esri/config require xstyle/css!./LayerControl/css/LayerControl.css".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q){return h([k,m],{map:null,layerInfos:[],icons:{expand:"fa-caret-right",
collapse:"fa-caret-down",checked:"fa-check-square-o",unchecked:"fa-square-o",update:"fa-refresh",menu:"fa-bars",folder:"fa-folder-o",folderOpen:"fa-folder-open-o"},separated:!1,overlayReorder:!1,overlayLabel:!1,vectorReorder:!1,vectorLabel:!1,noMenu:null,noLegend:null,noZoom:null,noTransparency:null,menu:{},subLayerMenu:{},swipe:null,swiperButtonStyle:"position:absolute;top:20px;left:120px;z-index:50;",baseClass:"layerControlDijit",_vectorContainer:null,_overlayContainer:null,_swiper:null,_swipeLayerToggleHandle:null,
_controls:{dynamic:"./LayerControl/controls/Dynamic",feature:"./LayerControl/controls/Feature",image:"./LayerControl/controls/Image",tiled:"./LayerControl/controls/Tiled",csv:"./LayerControl/controls/CSV",georss:"./LayerControl/controls/GeoRSS",wms:"./LayerControl/controls/WMS",wfs:"./LayerControl/controls/WFS",kml:"./LayerControl/controls/KML",vectortile:"./LayerControl/controls/VectorTile",webtiled:"./LayerControl/controls/WebTiled",imagevector:"./LayerControl/controls/ImageVector",raster:"./LayerControl/controls/Raster",
stream:"./LayerControl/controls/Stream"},constructor:function(b){b=b||{};b.map?this._controls=a.mixin(this._controls,b.controls||{}):d.publish("viewer/handleError",{source:"LayerControl",error:"map option is required"})},postCreate:function(){this.inherited(arguments);if(this.separated){var a=h([k,m]);!1!==this.vectorLabel&&this.addChild(new g({className:"vectorLabelContainer",content:this.vectorLabel},f.create("div")),"first");this._vectorContainer=new a({className:"vectorLayerContainer"},f.create("div"));
this.addChild(this._vectorContainer,"last");!1!==this.overlayLabel&&this.addChild(new g({className:"overlayLabelContainer",content:this.overlayLabel},f.create("div")),"last");this._overlayContainer=new a({className:"overlayLayerContainer"},f.create("div"));this.addChild(this._overlayContainer,"last")}else this.vectorReorder=this.overlayReorder=!1;this._addLayerControls(this.layerInfos);this._subscribeToTopics()},_subscribeToTopics:function(){this._removeLayerControlsHandler=d.subscribe("layerControl/removeLayerControls",
a.hitch(this,function(a){this._removeLayerControls(a)}));this._addLayerControlsHandler=d.subscribe("layerControl/addLayerControls",a.hitch(this,function(a){this._addLayerControls(a)}))},_addLayerControls:function(b){var c=[];l.forEach(b,function(a){var b=a.controlOptions;b&&!0===b.exclude||((b=this._controls[a.type])?c.push(b):d.publish("viewer/handleError",{source:"LayerControl",error:'the layer type "'+a.type+'" is not supported'}))},this);q(c,a.hitch(this,function(){l.forEach(b,function(b){var c=
b.controlOptions;c&&!0===c.exclude||(c=this._controls[b.type])&&q([c],a.hitch(this,"_addControl",b))},this);this._checkReorder()}))},_removeLayerControls:function(b){function c(a){return b.reduce(function(b,c){return c===a.layer||b},!1)}var d=this._overlayContainer.getChildren().filter(function(a){return c(a)}).concat(this._vectorContainer.getChildren().filter(function(a){return c(a)})).concat(this.getChildren().filter(function(a){return c(a)}));l.forEach(d,a.hitch(this,function(a){this.separated?
"overlay"===a._layerType?this._overlayContainer.removeChild(a):this._vectorContainer.removeChild(a):this.removeChild(a);a.destroy()}))},_addControl:function(b,c){var d="string"===typeof b.layer?this.map.getLayer(b.layer):b.layer;if(b.controlOptions&&("dynamic"===b.type||"feature"===b.type))if(d.loaded)this._applyLayerControlOptions(b.controlOptions,d);else d.on("load",a.hitch(this,"_applyLayerControlOptions",b.controlOptions));d=new c({controller:this,layer:d,layerTitle:b.title,controlOptions:a.mixin({noLegend:null,
noZoom:null,noTransparency:null,swipe:null,expanded:!1,sublayers:!0,menu:this.menu[b.type],subLayerMenu:this.subLayerMenu[b.type]},b.controlOptions)});d.startup();var e=b.position||0;this.separated?"overlay"===d._layerType?this._overlayContainer.addChild(d,e):this._vectorContainer.addChild(d,e):this.addChild(d,e)},_applyLayerControlOptions:function(a,b){if("undefined"!==typeof a.includeUnspecifiedLayers||"undefined"!==typeof a.subLayerInfos||"undefined"!==typeof a.excludedLayers){var c=[];if(!a.includeUnspecifiedLayers&&
a.subLayerInfos&&0!==a.subLayerInfos.length){var d=l.map(a.subLayerInfos,function(a){return a.id});l.forEach(b.layerInfos,function(a){-1!==l.indexOf(d,a.id)&&c.push(a)})}else if(a.excludedLayers)l.forEach(b.layerInfos,function(b){-1===l.indexOf(a.excludedLayers,b.id)&&c.push(b)});else if(a.subLayerInfos){this._mixinLayerInfos(b.layerInfos,a.subLayerInfos);this._setSublayerVisibilities(b);return}a.subLayerInfos&&this._mixinLayerInfos(c,a.subLayerInfos);b.layerInfos=c;this._setSublayerVisibilities(b)}},
_setSublayerVisibilities:function(a){var b=l.map(l.filter(a.layerInfos,function(a){return a.defaultVisibility}),function(a){return a.id});a.setVisibleLayers(b)},_mixinLayerInfos:function(b,c){c&&0!==c.length&&(l.forEach(c,function(a){"undefined"===typeof a.defaultVisibility&&(a.defaultVisibility=!0)}),l.forEach(b,function(b){var d=l.filter(c,function(a){return a.id===b.id}).shift();d&&a.mixin(b,d)}))},_moveUp:function(a){var b=a.layer.id,c=a.domNode;"overlay"===a._layerType?a.getPreviousSibling()&&
(a=l.indexOf(this.map.layerIds,b),this.map.reorderLayer(b,a+1),this._overlayContainer.containerNode.insertBefore(c,c.previousSibling),this._checkReorder()):"vector"===a._layerType&&a.getPreviousSibling()&&(a=l.indexOf(this.map.graphicsLayerIds,b),this.map.reorderLayer(b,a+1),this._vectorContainer.containerNode.insertBefore(c,c.previousSibling),this._checkReorder())},_moveDown:function(a){var b=a.layer.id,c=a.domNode;"overlay"===a._layerType?a.getNextSibling()&&(a=l.indexOf(this.map.layerIds,b),this.map.reorderLayer(b,
a-1),this._overlayContainer.containerNode.insertBefore(c,c.nextSibling.nextSibling),this._checkReorder()):"vector"===a._layerType&&a.getNextSibling()&&(a=l.indexOf(this.map.graphicsLayerIds,b),this.map.reorderLayer(b,a-1),this._vectorContainer.containerNode.insertBefore(c,c.nextSibling.nextSibling),this._checkReorder())},_checkReorder:function(){this.separated&&(this.vectorReorder&&l.forEach(this._vectorContainer.getChildren(),function(a){a._reorderUp&&(a.getPreviousSibling()?a._reorderUp.set("disabled",
!1):a._reorderUp.set("disabled",!0));a._reorderDown&&(a.getNextSibling()?a._reorderDown.set("disabled",!1):a._reorderDown.set("disabled",!0))},this),this.overlayReorder&&l.forEach(this._overlayContainer.getChildren(),function(a){a._reorderUp&&(a.getPreviousSibling()?a._reorderUp.set("disabled",!1):a._reorderUp.set("disabled",!0));a._reorderDown&&(a.getNextSibling()?a._reorderDown.set("disabled",!1):a._reorderDown.set("disabled",!0))},this))},_zoomToLayer:function(b){if("esri.layers.KMLLayer"!==b.declaredClass){var e=
this.map;b.spatialReference===e.spatialReference?e.setExtent(b.fullExtent,!0):n.defaults.geometryService?n.defaults.geometryService.project(a.mixin(new c,{geometries:[b.fullExtent],outSR:e.spatialReference}),function(a){e.setExtent(a[0],!0)},function(a){d.publish("viewer/handleError",{source:"LayerControl._zoomToLayer",error:a})}):d.publish("viewer/handleError",{source:"LayerControl._zoomToLayer",error:"esriConfig.defaults.geometryService is not set"})}},_swipeLayer:function(c,g){c&&c.visible&&(this._swiper?
(this._swiper.disable(),this._swipeLayerToggleHandle&&this._swipeLayerToggleHandle.remove(),this._swiper.set("layers",[c]),this._swiper.set("type",g),this._swiper.enable(),b.set(this._swiper.disableBtn.domNode,"style",this.swiperButtonStyle)):q(["esri/dijit/LayerSwipe"],a.hitch(this,function(d){this._swiper=new d({type:g||"vertical",map:this.map,layers:[c]},f.create("div",{},this.map.id,"first"));this._swiper.startup();this._swiper.disableBtn=new e({label:"Exit Layer Swipe",onClick:a.hitch(this,"_swipeDisable")},
f.create("div",{},this.map.id));b.set(this._swiper.disableBtn.domNode,"style",this.swiperButtonStyle)})),this._swipeLayerToggleHandle=d.subscribe("layerControl/layerToggle",a.hitch(this,function(a){a.id!==c.id||a.visible||this._swipeDisable()})))},_swipeDisable:function(){this._swiper.disable();this._swipeLayerToggleHandle&&this._swipeLayerToggleHandle.remove();b.set(this._swiper.disableBtn.domNode,"style","display:none;")},showAllLayers:function(){this.separated?(l.forEach(this._vectorContainer.getChildren(),
function(a){a.layer.show()}),l.forEach(this._overlayContainer.getChildren(),function(a){a.layer.show()})):l.forEach(this.getChildren(),function(a){a.layer.show()})},hideAllLayers:function(){this.separated?(l.forEach(this._vectorContainer.getChildren(),function(a){a.layer.hide()}),l.forEach(this._overlayContainer.getChildren(),function(a){a.layer.hide()})):l.forEach(this.getChildren(),function(a){a.layer.hide()})}})})},"esri/tasks/ProjectParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),
function(h,l,a,d,b,f,k,m){h=h(null,{declaredClass:"esri.tasks.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJson:function(){var b=a.map(this.geometries,function(a){return a.toJson()}),e={};return e.outSR=this.outSR.wkid||d.toJson(this.outSR.toJson()),e.inSR=this.geometries[0].spatialReference.wkid||d.toJson(this.geometries[0].spatialReference.toJson()),e.geometries=d.toJson({geometryType:m.getJsonType(this.geometries[0]),geometries:b}),this.transformation&&
(e.transformation=this.transformation.wkid||d.toJson(this.transformation)),k.isDefined(this.transformForward)&&(e.transformForward=this.transformForward),e}});return b("extend-esri")&&l.setObject("tasks.ProjectParameters",h,f),h})},"cmv/viewer/js/gis/dijit/LayerControl/controls/Dynamic":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/topic dojo/query dojo/dom-construct dojo/dom-attr dijit/registry dijit/_WidgetBase dijit/_TemplatedMixin dijit/_Contained dijit/MenuItem dijit/MenuSeparator ./_Control ./_DynamicSublayer ./_DynamicFolder ./../plugins/legendUtil dojo/i18n!./../nls/resource".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x){return h([e,c,n,u],{_layerType:"overlay",_esriLayerType:"dynamic",_hasSublayers:!1,_visLayersHandler:null,constructor:function(){this._sublayerControls=[]},_layerTypePreInit:function(){1<this.layer.layerInfos.length&&this.controlOptions.sublayers&&(this._hasSublayers=!0,this._visLayersHandler=d.after(this.layer,"setVisibleLayers",l.hitch(this,"_onSetVisibleLayers"),!0))},_layerTypeInit:function(){var a=w.isLegend(this.controlOptions.noLegend,this.controller.noLegend);
a&&!0===this.controlOptions.sublayers?(this._expandClick(),this._createSublayers(this.layer),d.after(this,"_createSublayers",l.hitch(this,w.dynamicSublayerLegend(this.layer,this.expandNode)))):!1===this.controlOptions.sublayers&&a?(this._expandClick(),w.layerLegend(this.layer,this.expandNode)):!0!==this.controlOptions.sublayers||a?this._expandRemove():(this._expandClick(),d.after(this,"_createSublayers",l.hitch(this,"_removeSublayerLegends")),this._createSublayers(this.layer))},_dynamicToggleMenuItems:function(a){this._hasSublayers&&
!1!==this.controlOptions.allSublayerToggles&&(a.addChild(new q({label:x.dynamicSublayersOn,onClick:l.hitch(this,"_toggleAllSublayers",!0)})),a.addChild(new q({label:x.dynamicSublayersOff,onClick:l.hitch(this,"_toggleAllSublayers",!1)})),a.addChild(new r))},_initCustomMenu:function(){this._hasSublayers||(a.forEach(this.controlOptions.subLayerMenu,l.hitch(this,"_addCustomMenuItem",this.layerMenu)),this.layerMenu.addChild(new r))},_toggleAllSublayers:function(b){a.forEach(this._sublayerControls,function(a){a._setSublayerCheckbox(b)});
this._setVisibleLayers()},_createSublayers:function(b){if(1<b.layerInfos.length){var c=a.map(b.layerInfos,function(a){return a.id});a.forEach(b.layerInfos,l.hitch(this,function(d){var e=a.filter(this.controlOptions.subLayerInfos,function(a){return a.id===d.id}).shift();l.mixin(d,e);var e=d.parentLayerId,f=d.subLayerIds,m=b.id+"-"+d.id+"-sublayer-control",h;-1===e||-1===c.indexOf(e)?null===f?(h=new v({id:m,control:this,sublayerInfo:d,icons:this.icons}),k.place(h.domNode,this.expandNode,"last")):null!==
f&&(h=new t({id:m,control:this,sublayerInfo:d,icons:this.icons}),k.place(h.domNode,this.expandNode,"last")):-1!==e&&null!==f?(h=new t({id:m,control:this,sublayerInfo:d,icons:this.icons}),k.place(h.domNode,g.byId(b.id+"-"+d.parentLayerId+"-sublayer-control").expandNode,"last")):-1!==e&&null===f&&(h=new v({id:m,control:this,sublayerInfo:d,icons:this.icons}),k.place(h.domNode,g.byId(b.id+"-"+d.parentLayerId+"-sublayer-control").expandNode,"last"));h.startup();this._sublayerControls.push(h)}))}},_removeSublayerLegends:function(){a.forEach(this._sublayerControls,
function(a){a.sublayerInfo.subLayerIds||k.destroy(a.expandClickNode)})},_setVisibleLayers:function(){this._visLayersHandler.remove();var c=this.layer,e=[];a.forEach(f("."+c.id+"-layerControlSublayerCheck"),function(a){"checked"===m.get(a,"data-checked")&&e.push(parseInt(m.get(a,"data-sublayer-id"),10))});a.forEach(c.layerInfos,function(b){null!==b.subLayerIds&&-1===a.indexOf(e,b.id)?a.forEach(b.subLayerIds,function(b){-1!==a.indexOf(e,b)&&e.splice(a.indexOf(e,b),1)}):null!==b.subLayerIds&&-1!==a.indexOf(e,
b.id)&&e.splice(a.indexOf(e,b.id),1)});e.length||e.push(-1);c.setVisibleLayers(e);c.refresh();b.publish("layerControl/setVisibleLayers",{id:c.id,visibleLayers:e});this._visLayersHandler=d.after(this.layer,"setVisibleLayers",l.hitch(this,"_onSetVisibleLayers"),!0)},_onSetVisibleLayers:function(b){var c=[];a.forEach(this.layer.layerInfos,function(d){-1!==a.indexOf(b,d.id)&&c.push(d.id);-1!==d.parentLayerId&&-1===a.indexOf(c,d.parentLayerId)&&c.push(d.parentLayerId)});a.forEach(this._sublayerControls,
function(b){-1!==a.indexOf(c,b.sublayerInfo.id)?b._setSublayerCheckbox(!0):b._setSublayerCheckbox(!1)})}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n){k=h("dijit.MenuItem"+(f("dojo-bidi")?"_NoBidi":""),[m,g,e,c],{templateString:n,baseClass:"dijitMenuItem",label:"",
_setLabelAttr:function(a){this._set("label",a);var b="",c;c=a.search(/{\S}/);if(0<=c){var b=a.charAt(c+1),d=a.substr(0,c);a=a.substr(c+3);c=d+b+a;a=d+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+b+"\x3c/span\x3e"+a}else c=a;this.domNode.setAttribute("aria-label",c+" "+this.accelKey);this.containerNode.innerHTML=a;this._set("shortcutKey",b)},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(a){!a||"label"in this.params||this._set("label",
a.innerHTML)},buildRendering:function(){this.inherited(arguments);a.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&a.set(this.accelKeyNode,"id",this.id+"_accel");l.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==f("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(a){}},_setSelected:function(a){d.toggle(this.domNode,"dijitMenuItemSelected",a)},setLabel:function(a){b.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.",
"","2.0");this.set("label",a)},setDisabled:function(a){b.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",a)},_setDisabledAttr:function(a){this.focusNode.setAttribute("aria-disabled",a?"true":"false");this._set("disabled",a)},_setAccelKeyAttr:function(b){this.accelKeyNode&&(this.accelKeyNode.style.display=b?"":"none",this.accelKeyNode.innerHTML=b,a.set(this.containerNode,"colSpan",b?"1":"2"));this._set("accelKey",b)}});f("dojo-bidi")&&
(k=h("dijit.MenuItem",k,{_setLabelAttr:function(a){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return k})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(h,l,a,d,b,f){return h("dijit.MenuSeparator",[a,d,b],{templateString:f,buildRendering:function(){this.inherited(arguments);l.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},
"cmv/viewer/js/gis/dijit/LayerControl/controls/_Control":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/topic dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-attr dojo/fx dojo/html dijit/MenuItem ./../plugins/LayerMenu dojo/text!./templates/Control.html".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r){return h([],{templateString:r,controller:null,layer:null,layerTitle:"Layer Title",controlOptions:null,layerMenu:null,icons:null,_reorderUp:null,_reorderDown:null,
_scaleRangeHandler:null,_expandClickHandler:null,constructor:function(a){a.controller&&(this.icons=a.controller.icons);this._handlers=[]},postCreate:function(){this.inherited(arguments);this.controller?this.layer?this.layer.loaded?this._initialize():this._handlers.push(this.layer.on("load",l.hitch(this,"_initialize"))):(b.publish("viewer/handleError",{source:"LayerControl/_Control",error:"layer option is required"}),this.destroy()):(b.publish("viewer/handleError",{source:"LayerControl/_Control",error:"controller option is required"}),
this.destroy())},_initialize:function(){this._layerTypePreInit&&this._layerTypePreInit();var a=this.layer,b=this.controlOptions;this._setLayerCheckbox(a,this.checkNode);c.set(this.labelNode,this.layerTitle);!0!==b.noMenu&&!0!==this.controller.noMenu||!0===this.controller.noMenu&&!1===b.noMenu?(this.layerMenu=new q({control:this,contextMenuForWindow:!1,targetNodeIds:[this.menuNode],leftClickToOpen:!0}),this.layerMenu.startup(),this._initCustomMenu()):(m.remove(this.menuNode,"fa, layerControlMenuIcon, "+
this.icons.menu),k.set(this.menuClickNode,"cursor","default"));if(0!==a.minScale||0!==a.maxScale)this._checkboxScaleRange(),this._scaleRangeHandler=a.getMap().on("zoom-end",l.hitch(this,"_checkboxScaleRange"));this._layerTypeInit();b.expanded&&b.sublayers&&this.expandClickNode.click();this._handlers.push(d(this.checkNode,"click",l.hitch(this,"_setLayerVisibility",a,this.checkNode)),a.on("scale-range-change",l.hitch(this,"_scaleRangeChange")),a.on("update-start",l.hitch(this,"_updateStart")),a.on("update-end",
l.hitch(this,"_updateEnd")),a.on("visibility-change",l.hitch(this,"_visibilityChange")))},_initCustomMenu:function(){a.forEach(this.controlOptions.menu,l.hitch(this,"_addCustomMenuItem",this.layerMenu))},_addCustomMenuItem:function(a,c){var d=new n(c);d.set("onClick",l.hitch(this,function(){b.publish("layerControl/"+c.topic,{layer:this.layer,iconNode:this.iconNode,menuItem:d})}));a.addChild(d)},_expandClick:function(){this._expandClickHandler=d(this.expandClickNode,"click",l.hitch(this,"_expandClicked"));
this._handlers.push(this._expandClickHandler)},_expandClicked:function(){var a=this.icons,b=this.expandNode,c=this.expandIconNode;"none"===k.get(b,"display")?(e.wipeIn({node:b,duration:300}).play(),m.replace(c,a.collapse,a.expand)):(e.wipeOut({node:b,duration:300}).play(),m.replace(c,a.expand,a.collapse))},_expandRemove:function(){m.remove(this.expandIconNode,["fa",this.icons.expand,"layerControlToggleIcon"]);k.set(this.expandClickNode,"cursor","default");f.destroy(this.expandNode)},_setLayerVisibility:function(a,
c,d){d.stopPropagation&&d.stopPropagation();a.visible?(this._setLayerCheckbox(a,c),a.hide()):(this._setLayerCheckbox(a,c),a.show());b.publish("layerControl/layerToggle",{id:a.id,visible:a.visible});0===a.minScale&&0===a.maxScale||this._checkboxScaleRange()},_setLayerCheckbox:function(a,b){var c=this.icons;a.visible?(g.set(b,"data-checked","checked"),m.replace(b,c.checked,c.unchecked)):(g.set(b,"data-checked","unchecked"),m.replace(b,c.unchecked,c.checked))},_checkboxScaleRange:function(){var a=this.checkNode,
b=this.layer,c=b.getMap().getScale(),d=b.minScale,b=b.maxScale;m.remove(a,"layerControlCheckIconOutScale");(0!==d&&c>d||0!==b&&c<b)&&m.add(a,"layerControlCheckIconOutScale")},_scaleRangeChange:function(){if(0!==this.layer.minScale||0!==this.layer.maxScale){this._checkboxScaleRange();if(this._scaleRangeHandler){var b=a.indexOf(this._handlers,this._scaleRangeHandler);-1!==b&&(this._handlers[b].remove(),this._handlers.splice(b,1))}this._scaleRangeHandler=this.layer.getMap().on("zoom-end",l.hitch(this,
"_checkboxScaleRange"));this._handlers.push(this._scaleRangeHandler)}else this._checkboxScaleRange(),this._scaleRangeHandler&&(b=a.indexOf(this._handlers,this._scaleRangeHandler),-1!==b&&(this._handlers[b].remove(),this._handlers.splice(b,1)),this._scaleRangeHandler=null)},_updateStart:function(){k.set(this.layerUpdateNode,"display","inline-block");this._layerState=l.clone({visible:this.layer.visible,visibleLayers:this.layer.visibleLayers||null})},_updateEnd:function(){k.set(this.layerUpdateNode,
"display","none");this._layerState||(this._layerState=null)},_visibilityChange:function(a){(a.visible&&"unchecked"===g.get(this.checkNode,"data-checked")||!a.visible&&"checked"===g.get(this.checkNode,"data-checked"))&&this._setLayerCheckbox(this.layer,this.checkNode)},destroy:function(){this.inherited(arguments);this._handlers.forEach(function(a){a.remove()})}})})},"cmv/viewer/js/gis/dijit/LayerControl/plugins/LayerMenu":function(){define("dojo/_base/declare dijit/Menu dijit/MenuItem dijit/PopupMenuItem dijit/MenuSeparator ./Transparency dojo/i18n!./../nls/resource".split(" "),
function(h,l,a,d,b,f,k){return h(l,{control:null,_removed:!1,postCreate:function(){this.inherited(arguments);var m=this.control,g=m.layer,e=m.controlOptions,c=m.controller,h=m._layerType;if("vector"===h&&c.vectorReorder||"overlay"===h&&c.overlayReorder)m._reorderUp=new a({label:k.moveUp,onClick:function(){c._moveUp(m)}}),this.addChild(m._reorderUp),m._reorderDown=new a({label:k.moveDown,onClick:function(){c._moveDown(m)}}),this.addChild(m._reorderDown),this.addChild(new b);m._dynamicToggleMenuItems&&
m._dynamicToggleMenuItems(this);(!0!==e.noZoom&&!0!==c.noZoom||!0===c.noZoom&&!1===e.noZoom)&&this.addChild(new a({label:k.zoomTo,onClick:function(){c._zoomToLayer(g)}}));(!0!==e.noTransparency&&!0!==c.noTransparency||!0===c.noTransparency&&!1===e.noTransparency)&&this.addChild(new f({label:k.transparency,layer:g}));if(!0===e.swipe||!0===c.swipe&&!1!==e.swipe)h=new l,h.addChild(new a({label:k.layerSwipeVertical,onClick:function(){c._swipeLayer(g,"vertical")}})),h.addChild(new a({label:k.layerSwipeHorizontal,
onClick:function(){c._swipeLayer(g,"horizontal")}})),!0===e.swipeScope&&h.addChild(new a({label:k.layerSwipeScope,onClick:function(){c._swipeLayer(g,"scope")}})),this.addChild(new d({label:k.layerSwipe,popup:h}));!0===e.metadataUrl&&g.url&&(this.addChild(new b),this.addChild(new a({label:k.metadata,onClick:function(){window.open(g.url,"_blank")}})));e.metadataUrl&&"string"===typeof e.metadataUrl&&(this.addChild(new b),this.addChild(new a({label:k.metadata,onClick:function(){window.open(e.metadataUrl,
"_blank")}})));(h=this.getChildren()[this.getChildren().length-1])&&h.isInstanceOf(b)&&this.removeChild(h)}})})},"dijit/PopupMenuItem":function(){define("dojo/_base/declare dojo/dom-style dojo/_base/lang dojo/query ./popup ./registry ./MenuItem ./hccss".split(" "),function(h,l,a,d,b,f,k){return h("dijit.PopupMenuItem",k,{baseClass:"dijitMenuItem dijitPopupMenuItem",_fillContent:function(){if(this.srcNodeRef){var a=d("*",this.srcNodeRef);this.inherited(arguments,[a[0]]);this.dropDownContainer=this.srcNodeRef}},
_openPopup:function(d,f){var e=this.popup;b.open(a.delegate(d,{popup:this.popup,around:this.domNode}));f&&e.focus&&e.focus()},_closePopup:function(){b.close(this.popup);this.popup.parentMenu=null},startup:function(){if(!this._started){this.inherited(arguments);if(!this.popup){var a=d("[widgetId]",this.dropDownContainer)[0];this.popup=f.byNode(a)}this.ownerDocumentBody.appendChild(this.popup.domNode);this.popup.domNode.setAttribute("aria-labelledby",this.containerNode.id);this.popup.startup();this.popup.domNode.style.display=
"none";this.arrowWrapper&&l.set(this.arrowWrapper,"visibility","");this.focusNode.setAttribute("aria-haspopup","true")}},destroyDescendants:function(a){this.popup&&(this.popup._destroyed||this.popup.destroyRecursive(a),delete this.popup);this.inherited(arguments)}})})},"cmv/viewer/js/gis/dijit/LayerControl/plugins/Transparency":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/query dojo/dom-style dijit/PopupMenuItem dijit/TooltipDialog dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels".split(" "),
function(h,l,a,d,b,f,k,m,g){return h(f,{layer:null,constructor:function(a){a=a||{};l.mixin(this,a)},postCreate:function(){this.inherited(arguments);var e=new m({value:this.layer.opacity,minimum:0,maximum:1,discreteValues:21,intermediateChanges:!0,showButtons:!1,onChange:l.hitch(this,function(c){this.layer.setOpacity(c);a.forEach(d("."+this.layer.id+"-layerLegendImage"),function(a){b.set(a,"opacity",c)})})});(new g({labels:["100%","50%","0%"],style:"height:1em;font-size:75%;"},e.bottomDecoration)).startup();
e.startup();this.popup=new k({style:"width:200px;",content:e});b.set(this.popup.connectorNode,"display","none");this.popup.startup()}})})},"dijit/TooltipDialog":function(){define("dojo/_base/declare dojo/dom-class dojo/has dojo/keys dojo/_base/lang dojo/on ./focus ./layout/ContentPane ./_DialogMixin ./form/_FormMixin ./_TemplatedMixin dojo/text!./templates/TooltipDialog.html ./main".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q){h=h("dijit.TooltipDialog",[m,c,e,g],{title:"",doLayout:!1,autofocus:!0,
baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:n,_setTitleAttr:"containerNode",postCreate:function(){this.inherited(arguments);this.own(f(this.domNode,"keydown",b.hitch(this,"_onKey")))},orient:function(a,b,c){a={"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight",
"TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft","BR-TL":"dijitTooltipBelow dijitTooltipABLeft","BL-TR":"dijitTooltipBelow dijitTooltipABRight","TL-BR":"dijitTooltipAbove dijitTooltipABRight","TR-BL":"dijitTooltipAbove dijitTooltipABLeft"}[b+"-"+c];l.replace(this.domNode,a,this._currentOrientClass||"");this._currentOrientClass=a},focus:function(){this._getFocusItems();k.focus(this._firstFocusItem)},onOpen:function(a){this.orient(this.domNode,a.aroundCorner,
a.corner);var b=a.aroundNodePos;"M"==a.corner.charAt(0)&&"M"==a.aroundCorner.charAt(0)?(this.connectorNode.style.top=b.y+(b.h-this.connectorNode.offsetHeight>>1)-a.y+"px",this.connectorNode.style.left=""):"M"==a.corner.charAt(1)&&"M"==a.aroundCorner.charAt(1)&&(this.connectorNode.style.left=b.x+(b.w-this.connectorNode.offsetWidth>>1)-a.x+"px");this._onShow()},onClose:function(){this.onHide()},_onKey:function(a){if(a.keyCode==d.ESCAPE)this.defer("onCancel"),a.stopPropagation(),a.preventDefault();else if(a.keyCode==
d.TAB){var b=a.target;this._getFocusItems();this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):b==this._firstFocusItem&&a.shiftKey?(k.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):b!=this._lastFocusItem||a.shiftKey?a.stopPropagation():(k.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault())}}});a("dojo-bidi")&&h.extend({_setTitleAttr:function(a){this.containerNode.title=this.textDir&&this.enforceTextDirWithUcc?this.enforceTextDirWithUcc(null,
a):a;this._set("title",a)},_setTextDirAttr:function(a){this._created&&this.textDir==a||(this._set("textDir",a),this.textDir&&this.title&&(this.containerNode.title=this.enforceTextDirWithUcc(null,this.title)))}});return h})},"dijit/form/HorizontalSlider":function(){define("dojo/_base/array dojo/_base/declare dojo/dnd/move dojo/_base/fx dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/dnd/Moveable dojo/dnd/Mover dojo/query dojo/mouse dojo/on ../_base/manager ../focus ../typematic ./Button ./_FormValueWidget ../_Container dojo/text!./templates/HorizontalSlider.html".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z){var A=l("dijit.form._SliderMover",c,{onMouseMove:function(a){var c=this.widget,d=c._abspos;d||(d=c._abspos=b.position(c.sliderBarContainer,!0),c._setPixelValue_=m.hitch(c,"_setPixelValue"),c._isReversed_=c._isReversed());a=a[c._mousePixelCoord]-d[c._startingPixelCoord];c._setPixelValue_(c._isReversed_?d[c._pixelCount]-a:a,d[c._pixelCount],!1)},destroy:function(a){c.prototype.destroy.apply(this,arguments);var b=this.widget;b._abspos=null;b._setValueAttr(b.value,
!0)}});a=l("dijit.form.HorizontalSlider",[x,y],{templateString:z,value:0,showButtons:!0,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:!0,slideDuration:u.defaultDuration,_setIdAttr:"",_setNameAttr:"valueNode",baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_handleOffsetCoord:"left",_progressPixelSize:"width",
_onKeyUp:function(a){this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey||this._setValueAttr(this.value,!0)},_onKeyDown:function(a){if(!(this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey)){switch(a.keyCode){case k.HOME:this._setValueAttr(this.minimum,!1);break;case k.END:this._setValueAttr(this.maximum,!1);break;case this._descending||this.isLeftToRight()?k.RIGHT_ARROW:k.LEFT_ARROW:case !1===this._descending?k.DOWN_ARROW:k.UP_ARROW:case !1===this._descending?k.PAGE_DOWN:k.PAGE_UP:this.increment(a);
break;case this._descending||this.isLeftToRight()?k.LEFT_ARROW:k.RIGHT_ARROW:case !1===this._descending?k.UP_ARROW:k.DOWN_ARROW:case !1===this._descending?k.PAGE_UP:k.PAGE_DOWN:this.decrement(a);break;default:return}a.stopPropagation();a.preventDefault()}},_onHandleClick:function(a){this.disabled||this.readOnly||(g("ie")||v.focus(this.sliderHandle),a.stopPropagation(),a.preventDefault())},_isReversed:function(){return!this.isLeftToRight()},_onBarClick:function(a){if(!this.disabled&&!this.readOnly&&
this.clickSelect){v.focus(this.sliderHandle);a.stopPropagation();a.preventDefault();var c=b.position(this.sliderBarContainer,!0),d=a[this._mousePixelCoord]-c[this._startingPixelCoord];this._setPixelValue(this._isReversed()?c[this._pixelCount]-d:d,c[this._pixelCount],!0);this._movable.onMouseDown(a)}},_setPixelValue:function(a,b,c){if(!this.disabled&&!this.readOnly){var d=this.discreteValues;if(1>=d||Infinity==d)d=b;d--;a=Math.round(a/(b/d));this._setValueAttr(Math.max(Math.min((this.maximum-this.minimum)*
a/d+this.minimum,this.maximum),this.minimum),c)}},_setValueAttr:function(a,b){this._set("value",a);this.valueNode.value=a;this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments);var c=this.maximum>this.minimum?(a-this.minimum)/(this.maximum-this.minimum):0,e=!1===this._descending?this.remainingBar:this.progressBar,f=!1===this._descending?this.progressBar:this.remainingBar;this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);if(b&&0<this.slideDuration&&
e.style[this._progressPixelSize]){var g=this,k={},m=parseFloat(e.style[this._progressPixelSize]),h=this.slideDuration*(c-m/100);0!=h&&(0>h&&(h=0-h),k[this._progressPixelSize]={start:m,end:100*c,units:"%"},this._inProgressAnim=d.animateProperty({node:e,duration:h,onAnimate:function(a){f.style[g._progressPixelSize]=100-parseFloat(a[g._progressPixelSize])+"%"},onEnd:function(){delete g._inProgressAnim},properties:k}),this._inProgressAnim.play())}else e.style[this._progressPixelSize]=100*c+"%",f.style[this._progressPixelSize]=
100*(1-c)+"%"},_bumpValue:function(a,c){if(!(this.disabled||this.readOnly||this.maximum<=this.minimum)){var d=f.getComputedStyle(this.sliderBarContainer),e=b.getContentBox(this.sliderBarContainer,d),d=this.discreteValues;if(1>=d||Infinity==d)d=e[this._pixelCount];d--;e=Math.round((this.value-this.minimum)*d/(this.maximum-this.minimum))+a;0>e&&(e=0);e>d&&(e=d);e=e*(this.maximum-this.minimum)/d+this.minimum;this._setValueAttr(e,c)}},_onClkBumper:function(a){this.disabled||this.readOnly||!this.clickSelect||
this._setValueAttr(a,!0)},_onClkIncBumper:function(){this._onClkBumper(!1===this._descending?this.minimum:this.maximum)},_onClkDecBumper:function(){this._onClkBumper(!1===this._descending?this.maximum:this.minimum)},decrement:function(a){this._bumpValue(a.keyCode==k.PAGE_DOWN?-this.pageIncrement:-1)},increment:function(a){this._bumpValue(a.keyCode==k.PAGE_UP?this.pageIncrement:1)},_mouseWheeled:function(a){this.focused&&(a.stopPropagation(),a.preventDefault(),this._bumpValue(0>a.wheelDelta?-1:1,!0))},
startup:function(){this._started||(h.forEach(this.getChildren(),function(a){this[a.container]!=this.containerNode&&this[a.container].appendChild(a.domNode)},this),this.inherited(arguments))},_typematicCallback:function(a,b,c){if(-1==a)this._setValueAttr(this.value,!0);else this[b==(this._descending?this.incrementButton:this.decrementButton)?"decrement":"increment"](c)},buildRendering:function(){this.inherited(arguments);this.showButtons&&(this.incrementButton.style.display="",this.decrementButton.style.display=
"");var a=n('label[for\x3d"'+this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.focusNode.setAttribute("aria-labelledby",a[0].id));this.focusNode.setAttribute("aria-valuemin",this.minimum);this.focusNode.setAttribute("aria-valuemax",this.maximum)},postCreate:function(){this.inherited(arguments);this.showButtons&&this.own(t.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500),t.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));this.own(r(this.domNode,
q.wheel,m.hitch(this,"_mouseWheeled")));var a=l(A,{widget:this});this._movable=new e(this.sliderHandle,{mover:a});this._layoutHackIE7()},destroy:function(){this._movable.destroy();this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);this.inherited(arguments)}});a._Mover=A;return a})},"dojo/dnd/move":function(){define("../_base/declare ../dom-geometry ../dom-style ./common ./Mover ./Moveable".split(" "),function(h,l,a,d,b,f){d=h("dojo.dnd.move.constrainedMoveable",
f,{constraints:function(){},within:!1,constructor:function(a,b){b||(b={});this.constraints=b.constraints;this.within=b.within},onFirstMove:function(a){var b=this.constraintBox=this.constraints.call(this,a);b.r=b.l+b.w;b.b=b.t+b.h;this.within&&(a=l.getMarginSize(a.node),b.r-=a.w,b.b-=a.h)},onMove:function(a,b){var d=this.constraintBox,e=a.node.style;this.onMoving(a,b);b.l=b.l<d.l?d.l:d.r<b.l?d.r:b.l;b.t=b.t<d.t?d.t:d.b<b.t?d.b:b.t;e.left=b.l+"px";e.top=b.t+"px";this.onMoved(a,b)}});b=h("dojo.dnd.move.boxConstrainedMoveable",
d,{box:{},constructor:function(a,b){var d=b&&b.box;this.constraints=function(){return d}}});h=h("dojo.dnd.move.parentConstrainedMoveable",d,{area:"content",constructor:function(b,d){var f=d&&d.area;this.constraints=function(){var b=this.node.parentNode,c=a.getComputedStyle(b),d=l.getMarginBox(b,c);if("margin"==f)return d;var k=l.getMarginExtents(b,c);d.l+=k.l;d.t+=k.t;d.w-=k.w;d.h-=k.h;if("border"==f)return d;k=l.getBorderExtents(b,c);d.l+=k.l;d.t+=k.t;d.w-=k.w;d.h-=k.h;if("padding"==f)return d;k=
l.getPadExtents(b,c);d.l+=k.l;d.t+=k.t;d.w-=k.w;d.h-=k.h;return d}}});return{constrainedMoveable:d,boxConstrainedMoveable:b,parentConstrainedMoveable:h}})},"dijit/typematic":function(){define("dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/on dojo/sniff ./main".split(" "),function(h,l,a,d,b,f){var k=f.typematic={_fireEventAndReload:function(){this._timer=null;this._callback(++this._count,this._node,this._evt);this._currentTimeout=Math.max(0>this._currentTimeout?this._initialDelay:1<this._subsequentDelay?
this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay),this._minDelay);this._timer=setTimeout(a.hitch(this,"_fireEventAndReload"),this._currentTimeout)},trigger:function(b,d,e,c,f,k,h,l){if(f!=this._obj){this.stop();this._initialDelay=h||500;this._subsequentDelay=k||.9;this._minDelay=l||10;this._obj=f;this._node=e;this._count=this._currentTimeout=-1;this._callback=a.hitch(d,c);this._evt={faux:!0};for(var v in b)"layerX"!=v&&"layerY"!=v&&(d=b[v],"function"!=typeof d&&"undefined"!=
typeof d&&(this._evt[v]=d));this._fireEventAndReload()}},stop:function(){this._timer&&(clearTimeout(this._timer),this._timer=null);this._obj&&(this._callback(-1,this._node,this._evt),this._obj=null)},addKeyListener:function(b,f,e,c,n,q,r){var u="keyCode"in f?"keyCode":"charCode"in f?"charCode":"charOrCode",v=[d(b,"keyCode"in f?"keydown":"charCode"in f?"keypress":l._keypress,a.hitch(this,function(a){a[u]!=f[u]||void 0!==f.ctrlKey&&f.ctrlKey!=a.ctrlKey||void 0!==f.altKey&&f.altKey!=a.altKey||void 0!==
f.metaKey&&f.metaKey!=(a.metaKey||!1)||void 0!==f.shiftKey&&f.shiftKey!=a.shiftKey?k._obj==f&&k.stop():(a.stopPropagation(),a.preventDefault(),k.trigger(a,e,b,c,f,n,q,r))})),d(b,"keyup",a.hitch(this,function(){k._obj==f&&k.stop()}))];return{remove:function(){h.forEach(v,function(a){a.remove()})}}},addMouseListener:function(f,g,e,c,n,l){var r=[d(f,"mousedown",a.hitch(this,function(a){a.preventDefault();k.trigger(a,g,f,e,f,c,n,l)})),d(f,"mouseup",a.hitch(this,function(a){this._obj&&a.preventDefault();
k.stop()})),d(f,"mouseout",a.hitch(this,function(a){this._obj&&a.preventDefault();k.stop()})),d(f,"dblclick",a.hitch(this,function(d){d.preventDefault();9>b("ie")&&(k.trigger(d,g,f,e,f,c,n,l),setTimeout(a.hitch(this,k.stop),50))}))];return{remove:function(){h.forEach(r,function(a){a.remove()})}}},addListener:function(a,b,d,c,f,k,l,u){var v=[this.addKeyListener(b,d,c,f,k,l,u),this.addMouseListener(a,c,f,k,l,u)];return{remove:function(){h.forEach(v,function(a){a.remove()})}}}};return k})},"dijit/form/HorizontalRuleLabels":function(){define("dojo/_base/declare dojo/has dojo/number dojo/query dojo/_base/lang ./HorizontalRule".split(" "),
function(h,l,a,d,b,f){h=h("dijit.form.HorizontalRuleLabels",f,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH"\x3e\x3c/div\x3e',labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:'\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerH" style\x3d"left:',_labelPrefix:'"\x3e\x3cdiv class\x3d"dijitRuleLabel dijitRuleLabelH"\x3e',_suffix:"\x3c/div\x3e\x3c/div\x3e",
_calcPosition:function(a){return a},_genHTML:function(a,b){var d=this.labels[b];return this._positionPrefix+this._calcPosition(a)+this._positionSuffix+this.labelStyle+this._genDirectionHTML(d)+this._labelPrefix+d+this._suffix},_genDirectionHTML:function(a){return""},getLabels:function(){var b=this.labels;!b.length&&this.srcNodeRef&&(b=d("\x3e li",this.srcNodeRef).map(function(a){return String(a.innerHTML)}));if(!b.length&&1<this.count)for(var b=[],f=this.minimum,g=(this.maximum-f)/(this.count-1),
e=0;e<this.count;e++)b.push(e<this.numericMargin||e>=this.count-this.numericMargin?"":a.format(f,this.constraints)),f+=g;return b},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();this.count=this.labels.length}});l("dojo-bidi")&&h.extend({_setTextDirAttr:function(a){this.textDir!=a&&(this._set("textDir",a),d(".dijitRuleLabelContainer",this.domNode).forEach(b.hitch(this,function(a){a.style.direction=this.getTextDir(a.innerText||a.textContent||"")})))},_genDirectionHTML:function(a){return this.textDir?
"direction:"+this.getTextDir(a)+";":""}});return h})},"dijit/form/HorizontalRule":function(){define(["dojo/_base/declare","../_Widget","../_TemplatedMixin"],function(h,l,a){return h("dijit.form.HorizontalRule",[l,a],{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH"\x3e\x3c/div\x3e',count:3,container:"containerNode",ruleStyle:"",_positionPrefix:'\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkH" style\x3d"left:',_positionSuffix:"%;",_suffix:'"\x3e\x3c/div\x3e',_genHTML:function(a){return this._positionPrefix+
a+this._positionSuffix+this.ruleStyle+this._suffix},_isHorizontal:!0,buildRendering:function(){this.inherited(arguments);var a;if(1==this.count)a=this._genHTML(50,0);else{var b,f=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){a=this._genHTML(0,0);for(b=1;b<this.count-1;b++)a+=this._genHTML(f*b,b);a+=this._genHTML(100,this.count-1)}else{a=this._genHTML(100,0);for(b=1;b<this.count-1;b++)a+=this._genHTML(100-f*b,b);a+=this._genHTML(0,this.count-1)}}this.domNode.innerHTML=a}})})},"cmv/viewer/js/gis/dijit/LayerControl/nls/resource":function(){define({root:{noLegend:"No Legend",
moveUp:"Move Up",moveDown:"Move Down",zoomTo:"Zoom to Layer",transparency:"Transparency",metadata:"Metadata",layerSwipe:"Layer Swipe",layerSwipeVertical:"Vertical",layerSwipeHorizontal:"Horizontal",layerSwipeScope:"Scope",dynamicSublayersOn:"Turn On All Sublayers",dynamicSublayersOff:"Turn Off All Sublayers"},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/LayerControl/controls/_DynamicSublayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dojo/dom-style dojo/dom-attr dojo/fx dojo/html dijit/Menu dijit/MenuItem dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Sublayer.html dojo/i18n!./../nls/resource".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v){return h([q,r],{control:null,sublayerInfo:null,menu:null,icons:null,templateString:u,i18n:v,_expandClickHandler:null,_handlers:[],postCreate:function(){this.inherited(arguments);if(this.control.controlOptions.subLayerInfos&&!this.control.controlOptions.includeUnspecifiedLayers){var c=a.map(this.control.controlOptions.subLayerInfos,function(a){return a.id});0>a.indexOf(c,this.sublayerInfo.id)&&b.add(this.domNode,"layerControlHidden")}this.control.controlOptions.layerIds&&
0>a.indexOf(this.control.controlOptions.layerIds,this.sublayerInfo.id)&&b.add(this.domNode,"layerControlHidden");var f=this.checkNode;k.set(f,"data-sublayer-id",this.sublayerInfo.id);b.add(f,this.control.layer.id+"-layerControlSublayerCheck");-1!==a.indexOf(this.control.layer.visibleLayers,this.sublayerInfo.id)?this._setSublayerCheckbox(!0,f):this._setSublayerCheckbox(!1,f);this._handlers.push(d(f,"click",l.hitch(this,function(a){a.stopPropagation&&a.stopPropagation();"checked"===k.get(f,"data-checked")?
this._setSublayerCheckbox(!1,f):this._setSublayerCheckbox(!0,f);this.control._setVisibleLayers();this._checkboxScaleRange()})));g.set(this.labelNode,this.sublayerInfo.name);this._expandClick();if(0!==this.sublayerInfo.minScale||0!==this.sublayerInfo.maxScale)this._checkboxScaleRange(),this._handlers.push(this.control.layer.getMap().on("zoom-end",l.hitch(this,"_checkboxScaleRange")));this.control.controlOptions.subLayerMenu&&this.control.controlOptions.subLayerMenu.length?(this.menu=new e({contextMenuForWindow:!1,
targetNodeIds:[this.menuClickNode],leftClickToOpen:!0}),a.forEach(this.control.controlOptions.subLayerMenu,l.hitch(this,"_addMenuItem")),this.menu.startup()):b.add(this.menuClickNode,"hidden")},_addMenuItem:function(a){var b=new c(a);b.set("onClick",l.hitch(this,function(){n.publish("layerControl/"+a.topic,{layer:this.control.layer,subLayer:this.sublayerInfo,iconNode:this.iconNode,menuItem:b})}));this.menu.addChild(b)},_expandClick:function(){var a=this.icons;this._expandClickHandler=d(this.expandClickNode,
"click",l.hitch(this,function(){var c=this.expandNode,d=this.expandIconNode;"none"===f.get(c,"display")?(m.wipeIn({node:c,duration:300}).play(),b.replace(d,a.collapse,a.expand)):(m.wipeOut({node:c,duration:300}).play(),b.replace(d,a.expand,a.collapse))}));this._handlers.push(this._expandClickHandler)},_setSublayerCheckbox:function(a,c){c=c||this.checkNode;var d=this.icons;a?(k.set(c,"data-checked","checked"),b.replace(c,d.checked,d.unchecked)):(k.set(c,"data-checked","unchecked"),b.replace(c,d.unchecked,
d.checked))},_checkboxScaleRange:function(){var a=this.checkNode,c=this.control.layer.getMap().getScale(),d=this.sublayerInfo.minScale,e=this.sublayerInfo.maxScale;b.remove(a,"layerControlCheckIconOutScale");(0!==d&&c>d||0!==e&&c<e)&&b.add(a,"layerControlCheckIconOutScale")},destroy:function(){this.inherited(arguments);this._handlers.forEach(function(a){a.remove()})}})})},"cmv/viewer/js/gis/dijit/LayerControl/controls/_DynamicFolder":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dojo/dom-style dojo/dom-attr dojo/fx dojo/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Folder.html".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n){return h([e,c],{control:null,sublayerInfo:null,icons:null,templateString:n,_expandClickHandler:null,_handlers:[],postCreate:function(){this.inherited(arguments);if(this.control.controlOptions.subLayerInfos&&!this.control.controlOptions.includeUnspecifiedLayers){var c=a.map(this.control.controlOptions.subLayerInfos,function(a){return a.id});0>a.indexOf(c,this.sublayerInfo.id)&&b.add(this.domNode,"layerControlHidden")}this.control.controlOptions.layerIds&&0>a.indexOf(this.control.controlOptions.layerIds,
this.sublayerInfo.id)&&b.add(this.domNode,"layerControlHidden");var e=this.checkNode;k.set(e,"data-sublayer-id",this.sublayerInfo.id);b.add(e,this.control.layer.id+"-layerControlSublayerCheck");-1!==a.indexOf(this.control.layer.visibleLayers,this.sublayerInfo.id)?this._setSublayerCheckbox(!0,e):this._setSublayerCheckbox(!1,e);this._handlers.push(d(e,"click",l.hitch(this,function(a){a.stopPropagation&&a.stopPropagation();"checked"===k.get(e,"data-checked")?this._setSublayerCheckbox(!1,e):this._setSublayerCheckbox(!0,
e);this.control._setVisibleLayers();this._checkboxScaleRange()})));g.set(this.labelNode,this.sublayerInfo.name);this._expandClick();if(0!==this.sublayerInfo.minScale||0!==this.sublayerInfo.maxScale)this._checkboxScaleRange(),this._handlers.push(this.control.layer.getMap().on("zoom-end",l.hitch(this,"_checkboxScaleRange")))},_expandClick:function(){var a=this.icons;this._handlers.push(this._expandClickHandler=d(this.expandClickNode,"click",l.hitch(this,function(){var c=this.expandNode,d=this.expandIconNode;
"none"===f.get(c,"display")?(m.wipeIn({node:c,duration:300}).play(),b.replace(d,a.folderOpen,a.folder)):(m.wipeOut({node:c,duration:300}).play(),b.replace(d,a.folder,a.folderOpen))})))},_setSublayerCheckbox:function(a,c){c=c||this.checkNode;var d=this.icons;a?(k.set(c,"data-checked","checked"),b.replace(c,d.checked,d.unchecked)):(k.set(c,"data-checked","unchecked"),b.replace(c,d.unchecked,d.checked))},_checkboxScaleRange:function(){var a=this.checkNode,c=this.control.layer.getMap().getScale(),d=this.sublayerInfo.minScale,
e=this.sublayerInfo.maxScale;b.remove(a,"layerControlCheckIconOutScale");(0!==d&&c>d||0!==e&&c<e)&&b.add(a,"layerControlCheckIconOutScale")},destroy:function(){this.inherited(arguments);this._handlers.forEach(function(a){a.remove()})}})})},"cmv/viewer/js/gis/dijit/LayerControl/plugins/legendUtil":function(){define("dojo/_base/array dojo/_base/lang dojo/has dojo/topic dojo/dom-construct dojo/dom-class dojo/dom-style dojo/html dijit/registry dojox/gfx esri/request esri/dijit/Legend dojo/i18n!esri/nls/jsapi dojo/i18n!./../nls/resource".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r){q.widgets.legend.NLS_noLegend=r.noLegend;return{isLegend:function(a,b){if(null===b||!1===b){if(!0!==a)return!0}else if(!0===b&&!1===a)return!0;return!1},_legendRequest:function(a,b,d,e){var f={f:"json",token:"function"===typeof a._getToken?a._getToken():null},g={disableIdentityLookup:!1,usePost:!1,useProxy:!1};a.layerDrawingOptions&&0<a.layerDrawingOptions.length&&(f.dynamicLayers=this._createDynamicLayerParameter(a),g.usePost=!0);c({url:a.url+"/legend",callbackParamName:"callback",
content:f},g).then(l.hitch(this,d,a,b),l.hitch(this,e,a,b))},_arcgisLegendRequest:function(b,d,e,f){var g=b.url.toLowerCase().indexOf("/rest/"),g=b.url.substring(0,g)+b.url.substring(g+5,b.url.length),g="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+window.escape(g);if(!a("ie")||8<a("ie"))g+="\x26returnbytes\x3dtrue";c({url:g,callbackParamName:"callback",content:{f:"json"}}).then(l.hitch(this,e,b,d),l.hitch(this,f,b,d))},_image:function(c,d,e){var f=c.url;(!a("ie")||9<=a("ie"))&&c.imageData&&
0<c.imageData.length?f="data:image/png;base64,"+c.imageData:0!==c.url.indexOf("http")&&(f=e.url+"/"+d+"/images/"+c.url,(d=e._getToken())&&(f+="?token\x3d"+d));f=b.create("img",{src:f,"class":e.id+"-layerLegendImage"});k.set(f,{width:c.width+"px",height:c.height+"px",opacity:e.opacity});return f},layerLegend:function(a,c){var d=new n({map:a.getMap(),layerInfos:[{layer:a}]},b.create("div",{},c));setTimeout(function(){d.startup()},1)},dynamicSublayerLegend:function(a,b){10.01<=a.version?this._legendRequest(a,
b,"_createDynamicSublayerLegend","_dynamicSublayerLegendError"):this._arcgisLegendRequest(a,b,"_createDynamicSublayerLegend","_dynamicSublayerLegendError")},_createDynamicSublayerLegend:function(a,c,d){h.forEach(d.layers,function(d){var e=d.layerId,k=b.create("table");f.add(k,"layerControlLegendTable");h.forEach(d.legend,function(c){var d=b.create("tr",{},k,"last"),f=b.create("td",{"class":"layerControlLegendImage"},d,"first");b.create("td",{innerHTML:c.label||"\x26nbsp;","class":"layerControlLegendLabel"},
d,"last");b.place(this._image(c,e,a),f)},this);if(a.layerInfos.reduce(function(a,b){return b.id===d.layerId||a},!1))if(1<a.layerInfos.length){var n=g.byId(a.id+"-"+d.layerId+"-sublayer-control").expandNode;m.set(n,"");b.place(k,n)}else b.place(k,c)},this)},_dynamicSublayerLegendError:function(a,b,c){1===a.layerInfos.length&&m.set(b,"No Legend");d.publish("viewer/handleError",{source:"LayerControl/legendUtil/_createDynamicSublayerLegend",error:c})},_surfaceDims:[20,20],vectorLegend:function(a,b){var c=
a.renderer.symbol,d=a.renderer.infos;c?this._createVectorLegend([{symbol:c,description:"",label:"",value:""}],a,b):d?this._createVectorLegend(d,a,b):m.set(b,"No Legend")},_createVectorLegend:function(a,c,g){var n=b.create("table");f.add(n,"layerControlLegendTable");h.forEach(a,function(a){var h=b.create("tr",{},n,"last"),l=b.create("td",{"class":"layerControlLegendImage"},h,"first");b.create("td",{innerHTML:a.label||"\x26nbsp;","class":"layerControlLegendLabel"},h,"last");var h=a.symbol,r=h.getShapeDescriptors(),
u=r.defaultShape;a=r.fill;r=r.stroke;if(u.src)l=b.create("img",{src:u.src},l),k.set(l,{width:h.width+"px",height:h.height+"px",opacity:c.opacity}),f.add(l,c.id+"-layerLegendImage");else if(h){var q=this._surfaceDims[0],D=this._surfaceDims[1];h.width&&h.height&&(q=h.width,D=h.height);h=b.create("span",{},l);k.set(h,{width:q+"px",height:D+"px",display:"inline-block"});h=e.createSurface(h,q,D).createShape(u);a&&h.setFill(a);r&&h.setStroke(r);h.applyTransform({dx:q/2,dy:D/2});k.set(l,{opacity:c.opacity});
f.add(l,c.id+"-layerLegendImage")}else m.set(g,"No Legend"),d.publish("viewer/handleError",{source:"LayerControl/legendUtil/_createVectorLegend",error:"renderer does not contain symbol(s)"});b.place(n,g)},this)},_createDynamicLayerParameter:function(a){if(a.dynamicLayerInfos&&0<a.dynamicLayerInfos.length||a.layerDrawingOptions&&0<a.layerDrawingOptions.length){a.dynamicLayerInfos=a.createDynamicLayerInfosFromLayerInfos();var b=[];a.dynamicLayerInfos.forEach(function(c){if(!c.subLayerIds){var d,e=c.id;
d={id:e,name:c.name};c.source&&(d.source=c.source.toJson());a.layerDrawingOptions&&a.layerDrawingOptions[e]&&(d.drawingInfo=a.layerDrawingOptions[e].toJson());b.push(d)}},this);return JSON.stringify(b)}return null}}})},"esri/dijit/Legend":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/_base/Color dojo/debounce dojo/has dojo/sniff dojo/Deferred dojo/DeferredList dojo/json dojo/dom dojo/dom-construct dojo/dom-style dojo/dom-class dijit/_Widget dojox/gfx dojox/gfx/matrix dojox/html/entities ../kernel ../config ../request ../lang ../numberUtils ../renderers/utils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/ClassBreaksRenderer ../renderers/ScaleDependentRenderer ../renderers/DotDensityRenderer ../renderers/TemporalRenderer ../renderers/VectorFieldRenderer ../renderers/HeatmapRenderer ../symbols/PictureFillSymbol ../symbols/SimpleLineSymbol ../symbols/jsonUtils ../renderers/jsonUtils ./_EventedWidget dojo/i18n!../nls/jsapi".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K,J,I,L,M,N,Q,O,T,S,R,U){var W=l([R,w],{declaredClass:"esri.dijit.Legend",widgetsInTemplate:!1,layers:null,alignRight:!1,hoverLabelShowing:!1,dotDensitySwatchSize:26,dotCoverage:75,gradientHeight:30,transparencyRampColor:new k([64,64,64]),defaultText:"Aa",sizeRampLightColor:new k([255,255,255]),sizeRampDarkColor:new k([128,128,128]),layerConnects:[],gradientWidth:34,colorRampBorder:"1px solid",_specialChars:{lt:"\x3c",gt:"\x3e"},_ieTimer:100,
_isRightToLeft:!1,_align:null,_legendAlign:null,constructor:function(b,c){return a.mixin(this,U.widgets.legend),this._i18n=U.widgets.legend,b=b||{},b.map?c?(this.map=b.map,this.layerInfos=b.layerInfos,this._respectCurrentMapScale=!1===b.respectCurrentMapScale?!1:!0,this._respectVisibility=!1===b.respectVisibility?!1:!0,this.arrangement=b.arrangement===W.ALIGN_RIGHT?W.ALIGN_RIGHT:W.ALIGN_LEFT,this.arrangement===W.ALIGN_RIGHT&&(this.alignRight=!0),this.autoUpdate=!1===b.autoUpdate?!1:!0,this._surfaceItems=
[],this.hideLayersInLegend={},void(this.refresh=m(this.refresh,0))):void console.error("esri.dijit.Legend: must specify a container for the legend"):void console.error("esri.dijit.Legend: unable to find the 'map' property in parameters")},postMixInProperties:function(){this.inherited(arguments);var a,b,c=["ar","he"];for(a=0;a<c.length;a+=1)b=c[a],h.locale&&-1!==h.locale.indexOf(b)&&(-1!==h.locale.indexOf("-")?-1!==h.locale.indexOf(b+"-")&&(this._isRightToLeft=!0):this._isRightToLeft=!0);this._isRightToLeft?
(this._align=this.alignRight?"left":"right",this._legendAlign=this.alignRight?"esriLegendLeft":"esriLegendRight"):(this._align=this.alignRight?"right":"left",this._legendAlign=this.alignRight?"esriLegendRight":"esriLegendLeft")},startup:function(){this.inherited(arguments);this._initialize();9>g("ie")&&(this._repaintItems=a.hitch(this,this._repaintItems),setTimeout(this._repaintItems,this._ieTimer))},destroy:function(){this._deactivate();this._removeHoverHandlers();this.inherited(arguments)},refresh:function(a){if(this.domNode){a?
(this.layerInfos=a,this.layers=[],d.forEach(this.layerInfos,function(a){this._isSupportedLayerType(a.layer)&&(a.title&&(a.layer._titleForLegend=a.title),a.layer._hideDefaultSymbol=!1===a.defaultSymbol?!0:!1,a.hideLayers?(this.hideLayersInLegend[a.layer.id]=a.hideLayers,this._addSubLayersToHide(a)):this.hideLayersInLegend[a.layer.id]=[],a.hoverLabel&&(a.layer._hoverLabel=a.hoverLabel),a.hoverLabels&&(a.layer._hoverLabels=a.hoverLabels),this.layers.push(a.layer))},this)):this.useAllMapLayers&&(this.layerInfos=
null,this.layers=null);for(a=this.domNode.children.length-1;0<=a;a--)u.destroy(this.domNode.children[a]);this._removeHoverHandlers();this.startup()}},_legendUrl:"http://utility.arcgis.com/sharing/tools/legend",_initialize:function(){if(this.layerInfos&&(this.layers=[],d.forEach(this.layerInfos,function(a){this._isSupportedLayerType(a.layer)&&(a.title&&(a.layer._titleForLegend=a.title),a.layer._hideDefaultSymbol=!1===a.defaultSymbol?!0:!1,a.hideLayers?(this.hideLayersInLegend[a.layer.id]=a.hideLayers,
this._addSubLayersToHide(a)):this.hideLayersInLegend[a.layer.id]=[],a.hoverLabel&&(a.layer._hoverLabel=a.hoverLabel),a.hoverLabels&&(a.layer._hoverLabels=a.hoverLabels),this.layers.push(a.layer))},this)),this.useAllMapLayers=!1,!this.layers){this.useAllMapLayers=!0;this.layers=[];var a=[],b=[];d.forEach(this.map.layerIds,function(c){var e;c=this.map.getLayer(c);this._isSupportedLayerType(c)&&(c.arcgisProps&&c.arcgisProps.title&&(c._titleForLegend=c.arcgisProps.title),this.layers.push(c));"esri.layers.KMLLayer"==
c.declaredClass&&(e=c.getLayers(),d.forEach(e,function(b){a.push(b.id)},this));"esri.layers.GeoRSSLayer"==c.declaredClass&&(e=c.getFeatureLayers(),d.forEach(e,function(a){b.push(a.id)},this))},this);d.forEach(this.map.graphicsLayerIds,function(c){var e=this.map.getLayer(c);-1==d.indexOf(a,c)&&-1==d.indexOf(b,c)&&this._isSupportedLayerType(e)&&e._params&&e._params.drawMode&&(e.arcgisProps&&e.arcgisProps.title&&(e._titleForLegend=e.arcgisProps.title),this.layers.push(e))},this)}this._createLegend()},
_activate:function(){this._deactivate();this.autoUpdate&&(this._respectCurrentMapScale&&(this._ozeConnect=b.connect(this.map,"onZoomEnd",this,"_refreshLayers")),this.useAllMapLayers&&(this._olaConnect=b.connect(this.map,"onLayerAdd",this,"_updateAllMapLayers"),this._olrConnect=b.connect(this.map,"onLayerRemove",this,"_updateAllMapLayers"),this._olroConnect=b.connect(this.map,"onLayersReordered",this,"_updateAllMapLayers")),d.forEach(this.layers,function(c){var d={};d.ovcConnect=b.connect(c,"onVisibilityChange",
this,"_refreshLayers");d.oocConnect=b.connect(c,"onOpacityChange",this,"_refreshLayers");d.oscConnect=b.connect(c,"onScaleRangeChange",this,"_refreshLayers");"esri.layers.ArcGISDynamicMapServiceLayer"===c.declaredClass&&c.supportsDynamicLayers&&(d.odcConnect=b.connect(c,"_onDynamicLayersChange",a.hitch(this,"_updateDynamicLayers",c)));"esri.layers.ArcGISImageServiceLayer"===c.declaredClass&&(d.oirConnect=b.connect(c,"onRenderingChange",a.partial(this._updateImageServiceLayers,this,c)));"esri.layers.ArcGISImageServiceVectorLayer"===
c.declaredClass&&(d.oivrConnect=b.connect(c,"onRendererChange",a.hitch(this,"_refreshLayers")));this.layerConnects[c.id]=d},this))},_deactivate:function(){this._ozeConnect&&b.disconnect(this._ozeConnect);this._olaConnect&&b.disconnect(this._olaConnect);this._olroConnect&&b.disconnect(this._olroConnect);this._olrConnect&&b.disconnect(this._olrConnect);d.forEach(this.layers,function(a){a=this.layerConnects[a.id]||{};a.ovcConnect&&b.disconnect(a.ovcConnect);a.oocConnect&&b.disconnect(a.oocConnect);a.oscConnect&&
b.disconnect(a.oscConnect);a.odcConnect&&b.disconnect(a.odcConnect);a.oirConnect&&b.disconnect(a.oirConnect);a.oivrConnect&&b.disconnect(a.oivrConnect)},this);this.layerConnects=[]},_updateDynamicLayers:function(a){delete a.legendResponse;this._refreshLayers()},_updateImageServiceLayers:function(a,b){delete b.legendResponse;a._refreshLayers()},_refreshLayers:function(){this.refresh()},_updateAllMapLayers:function(){this.layers=[];d.forEach(this.map.layerIds,function(a){a=this.map.getLayer(a);this._isSupportedLayerType(a)&&
this.layers.push(a)},this);d.forEach(this.map.graphicsLayerIds,function(a){a=this.map.getLayer(a);this._isSupportedLayerType(a)&&a._params&&a._params.drawMode&&this.layers.push(a)},this);this.refresh()},_createLegend:function(){var c=!1,e=!1;v.set(this.domNode,"position","relative");u.create("div",{id:this.id+"_msg",className:"esriLegendMsg",innerHTML:this.NLS_creatingLegend+"..."},this.domNode);var f=[];d.forEach(this.layers,function(g){if("esri.layers.KMLLayer"==g.declaredClass||"esri.layers.GeoRSSLayer"==
g.declaredClass){var k;g.loaded?("esri.layers.KMLLayer"==g.declaredClass?k=g.getLayers():"esri.layers.GeoRSSLayer"==g.declaredClass&&(k=g.getFeatureLayers(),this.hideLayersInLegend[g.id]&&(k=d.filter(k,function(a){return-1==d.indexOf(this.hideLayersInLegend[g.id],a.id)},this))),d.forEach(k,function(a){"esri.layers.FeatureLayer"==a.declaredClass&&g._titleForLegend&&(a._titleForLegend=g._titleForLegend+" - ","esriGeometryPoint"==a.geometryType?a._titleForLegend+=this.NLS_points:"esriGeometryPolyline"==
a.geometryType?a._titleForLegend+=this.NLS_lines:"esriGeometryPolygon"==a.geometryType&&(a._titleForLegend+=this.NLS_polygons),f.push(a))},this)):b.connect(g,"onLoad",a.hitch(this,function(){this.refresh(this.layerInfos)}))}else if("esri.layers.WMSLayer"===g.declaredClass)if(g.loaded){if((!this._respectVisibility||this._respectVisibility&&g.visible)&&0<g.layerInfos.length&&d.some(g.layerInfos,function(a){return a.legendURL})){var m=!1;d.forEach(g.layerInfos,function(b){if(b.legendURL&&-1<d.indexOf(g.visibleLayers,
b.name)){m||(u.create("div",{innerHTML:"\x3cspan class\x3d'esriLegendServiceLabel'\x3e"+(g._titleForLegend||g.name||g.id)+"\x3c/span\x3e"},this.domNode),m=!0);var e;b=b.legendURL;if(g.customParameters||g.customLayerParameters){var f=a.clone(g.customParameters||{});a.mixin(f,g.customLayerParameters||{});for(e in f)b+=(-1===b.indexOf("?")?"?":"\x26")+e+"\x3d"+f[e]}u.create("div",{innerHTML:"\x3cimg src\x3d'"+b+"'/\x3e"},this.domNode);c=!0}},this)}}else b.connect(g,"onLoad",a.hitch(this,function(){this.refresh(this.layerInfos)}));
else"esri.layers.WFSLayer"!==g.declaredClass||g.renderer?f.push(g):(k=u.create("div",{id:this.id+"_"+g.id,"class":"esriLegendService"}),u.create("span",{innerHTML:this._getServiceTitle(g),"class":"esriLegendServiceLabel"},u.create("td",{align:this._align},u.create("tr",{},u.create("tbody",{},u.create("table",{width:"95%"},k))))),u.place(k,this.id,"first"),tableNode=u.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},k),tableBody=u.create("tbody",{},tableNode),"esriGeometryComplex"===
g.geometryType?(this._buildRow_Renderer(g,g._pointSymbol,null,this.NLS_points,null,tableBody),this._buildRow_Renderer(g,g._lineSymbol,null,this.NLS_lines,null,tableBody),this._buildRow_Renderer(g,g._polygonSymbol,null,this.NLS_areas,null,tableBody)):"esriGeometryPoint"===g.geometryType?this._buildRow_Renderer(g,g._pointSymbol,null,"",null,tableBody):"esriGeometryPolyline"===g.geometryType?this._buildRow_Renderer(g,g._lineSymbol,null,"",null,tableBody):"esriGeometryPolygon"===g.geometryType&&this._buildRow_Renderer(g,
g._polygonSymbol,null,"",null,tableBody),e=!0)},this);var g=[];(d.forEach(f,function(c){if(c.loaded){if((!this._respectVisibility||this._respectVisibility&&c.visible)&&(c.layerInfos||c.renderer||"esri.layers.ArcGISImageServiceLayer"==c.declaredClass)){var d=u.create("div",{id:this.id+"_"+c.id,style:{display:"none"},"class":"esriLegendService"});if(u.create("span",{innerHTML:this._getServiceTitle(c),"class":"esriLegendServiceLabel"},u.create("td",{align:this._align},u.create("tr",{},u.create("tbody",
{},u.create("table",{width:"95%"},d))))),u.place(d,this.id,"first"),c.legendResponse||c.renderer)this._createLegendForLayer(c);else{if(this.isHostedTileService(c))return void this._getLayerInfos(c).then(a.hitch(this,function(a){this._createLegendForLayer(a)}),a.hitch(this,function(a){g.push(this._legendRequest(a))}));g.push(this._legendRequest(c))}}}else var e=b.connect(c,"onLoad",this,function(a){b.disconnect(e);e=null;this.refresh()})},this),0!==g.length||c||e)?(new n(g)).addCallback(a.hitch(this,
function(a){c||e?r.byId(this.id+"_msg").innerHTML="":r.byId(this.id+"_msg").innerHTML=this.NLS_noLegend;this._activate()})):(r.byId(this.id+"_msg").innerHTML=this.NLS_noLegend,this._activate())},_createLegendForLayer:function(a){if(a.legendResponse||a.renderer||this.isHostedTileService(a)){var b=!1;if(a.legendResponse||this.isHostedTileService(a)){var c=a.dynamicLayerInfos||a.layerInfos;c&&c.length?d.forEach(c,function(c,e){if(!this.hideLayersInLegend[a.id]||-1===d.indexOf(this.hideLayersInLegend[a.id],
c.id)){var f=this._buildLegendItems(a,c,e);b=b||f}},this):"esri.layers.ArcGISImageServiceLayer"==a.declaredClass&&(b=this._buildLegendItems(a,{id:0,name:null,title:a.name,subLayerIds:null,parentLayerId:-1},0))}else a.renderer&&(c=a.url?a.url.substring(a.url.lastIndexOf("/")+1,a.url.length):"fc_"+a.id,b=this._buildLegendItems(a,{id:c,name:null,subLayerIds:null,parentLayerId:-1},0));b&&(v.set(r.byId(this.id+"_"+a.id),"display","block"),v.set(r.byId(this.id+"_msg"),"display","none"))}},_legendRequest:function(c){return c.loaded?
10.01<=c.version?this._legendRequestServer(c):this._legendRequestTools(c):void b.connect(c,"onLoad",a.hitch(this,"_legendRequest"))},_legendRequestServer:function(b){var c=b.url,e=c.indexOf("?");-1<e?c=c.substring(0,e)+"/legend"+c.substring(e):c+="/legend";(e=b._getToken())&&(c+="?token\x3d"+e);var f=a.hitch(this,"_processLegendResponse"),g={f:"json"};b._params.dynamicLayers&&(g.dynamicLayers=q.stringify(this._createDynamicLayers(b)),"[{}]"===g.dynamicLayers&&(g.dynamicLayers="[]"));b._params.bandIds&&
(g.bandIds=b._params.bandIds);b._params.renderingRule?g.renderingRule=b._params.renderingRule:b.rasterFunctionInfos&&0<b.rasterFunctionInfos.length&&d.forEach(b.rasterFunctionInfos,function(a){a&&a.name&&"none"===a.name.toLowerCase()&&(g.renderingRule=q.stringify({rasterFunction:a.name}))});return C({url:c,content:g,callbackParamName:"callback",load:function(a,c){f(b,a,c)},error:B.defaults.io.errorHandler})},_legendRequestTools:function(b){var c=b.url.toLowerCase().indexOf("/rest/"),c=b.url.substring(0,
c)+b.url.substring(c+5,b.url.length),c=this._legendUrl+"?soapUrl\x3d"+window.escape(c);(!g("ie")||8<g("ie"))&&(c+="\x26returnbytes\x3dtrue");var d=a.hitch(this,"_processLegendResponse");return C({url:c,content:{f:"json"},callbackParamName:"callback",load:function(a,c){d(b,a,c)},error:B.defaults.io.errorHandler})},_processLegendResponse:function(a,b){b&&b.layers&&(a.legendResponse=b,r.byId(this.id+"_"+a.id)&&u.empty(r.byId(this.id+"_"+a.id)),u.create("span",{innerHTML:this._getServiceTitle(a),"class":"esriLegendServiceLabel"},
u.create("td",{align:this._align},u.create("tr",{},u.create("tbody",{},u.create("table",{width:"95%"},r.byId(this.id+"_"+a.id)))))),this._createLegendForLayer(a))},_buildLegendItems:function(a,b,c){var e=!1,f=r.byId(this.id+"_"+a.id),g=b.parentLayerId;if(b.subLayerIds)a=u.create("div",{id:this.id+"_"+a.id+"_"+b.id+"_group",style:{display:"none"},"class":-1==g?0<c?"esriLegendGroupLayer":"":this._legendAlign},-1==g?f:r.byId(this.id+"_"+a.id+"_"+g+"_group")),u.create("td",{innerHTML:z.encode(b.name),
align:this._align},u.create("tr",{},u.create("tbody",{},u.create("table",{width:"95%","class":"esriLegendLayerLabel"},a))));else{if(this._respectVisibility&&a.visibleLayers)if(c=a.dynamicLayerInfos||a.layerInfos)if(a._params&&a._params.layers){if(-1===d.indexOf(a.visibleLayers,b.id))return e}else{if(c=this._getReallyVisibleLayers(c,a.visibleLayers),-1===d.indexOf(c,b.id))return e}else if(-1===d.indexOf(a.visibleLayers,b.id))return e;f=u.create("div",{id:this.id+"_"+a.id+"_"+b.id,style:{display:"none"},
"class":-1<g?this._legendAlign:""},-1==g?f:r.byId(this.id+"_"+a.id+"_"+g+"_group"));u.create("td",{innerHTML:z.encode(b.name)||"",align:this._align},u.create("tr",{},u.create("tbody",{},u.create("table",{width:"95%","class":"esriLegendLayerLabel"},f))));c=a.dynamicLayerInfos||a.layerInfos;g=!1;c&&c.length&&(g=d.some(c,function(a){return!!a.drawingInfo}));a.legendResponse?e=e||this._buildLegendItems_Tools(a,b,f):(a.renderer||g)&&(e=e||this._buildLegendItems_Renderer(a,b,f))}return e},_getReallyVisibleLayers:function(a,
b){if(!a||!b||!b.length)return[];var c,e=[],f=[];for(c=0;c<a.length;c++)a[c].subLayerIds?(-1===d.indexOf(b,a[c].id)||-1<d.indexOf(f,a[c].id))&&(f=f.concat(a[c].subLayerIds)):-1<d.indexOf(b,a[c].id)&&-1===d.indexOf(f,a[c].id)&&e.push(a[c].id);return e},_buildLegendItems_Tools:function(a,b,c){var e=b.parentLayerId,f=this.map.getScale(),g=!1,k=function(a,b){var c,d;for(c=0;c<a.length;c++)if(b.dynamicLayerInfos)for(d=0;d<b.dynamicLayerInfos[d].length;d++){if(b.dynamicLayerInfos[d].mapLayerId==a[c].layerId)return a[c]}else if(b.id==
a[c].layerId)return a[c];return{}};if(!this._respectCurrentMapScale||this._respectCurrentMapScale&&this._isLayerInScale(a,b,f)){var m=!0;if(this._respectCurrentMapScale&&("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISMapServiceLayer"===a.declaredClass)){var h=this._getEffectiveScale(a,b);(h.minScale&&h.minScale<f||h.maxScale&&h.maxScale>f)&&(m=!1)}if(m){var f=k(a.legendResponse.layers,b),n=f.legendType,l=f.layerType,q=f.legend;if(q){"esri.layers.ArcGISImageServiceLayer"!==
a.declaredClass&&this._sanitizeLegendResponse(a,f,b);c=u.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c);var t=u.create("tbody",{},c);(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(c,a,b);d.forEach(q,function(c){10.1<=a.version&&!c.values&&1<q.length&&(a._hideDefaultSymbol||"\x3call other values\x3e"===c.label||!(c.label||"esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&10.3<=a.version||"Raster Layer"===l))||(c.url&&0===c.url.indexOf("http")||
c.imageData&&0<c.imageData.length)&&(g=!0,this._buildRow_Tools(c,t,a,b.id,n))},this)}}}return g&&(v.set(r.byId(this.id+"_"+a.id+"_"+b.id),"display","block"),-1<e&&(v.set(r.byId(this.id+"_"+a.id+"_"+e+"_group"),"display","block"),this._findParentGroup(a.id,a,e))),g},_getLayerInfos:function(a){var b=new c,e=a.dynamicLayerInfos||a.layerInfos;if(e&&e.length)if(d.some(e,function(a){return!!a.drawingInfo}))b.resolve(a);else{var f=a.url,g=f.indexOf("?");-1==g?f+="/layers":f=f.substring(0,g)+"/layers"+f.substring(g,
f.length);C({url:f,content:{f:"json"},callbackParamName:"callback",load:function(c,f){c.layers?(d.forEach(e,function(a){var b=d.filter(c.layers,function(b){return a.source?b.id===a.source.mapLayerId:b.id===a.id});b&&b[0]&&b[0].drawingInfo&&(a.drawingInfo=b[0].drawingInfo,a.fields=b[0].fields)}),b.resolve(a)):b.reject(a)},error:function(c){b.reject(a)}})}return b},_sanitizeLegendResponse:function(b,c,e){var f=c.legend;if(10.1<=b.version&&1<f.length&&!c._sanitized){var g,k;(b=a.getObject("layerDefinition.drawingInfo.renderer",
!1,e))||(b=a.getObject("drawingInfo.renderer",!1,e));d.some(f,function(a){return a.values?!0:void 0})&&d.some(f,function(a,b){return a.values||(k=b,g=a),!!g});b?"uniqueValue"===b.type?g&&(f.splice(k,1),f.push(g)):"classBreaks"===b.type&&(g&&f.splice(k,1),f.reverse(),g&&f.push(g)):g&&(f.splice(k,1),f.push(g));c._sanitized=!0}},_buildRow_Tools:function(a,b,c,d,e){var f,k;b=u.create("tr",{},b);this.alignRight?(f=u.create("td",{align:this._isRightToLeft?"left":"right"},b),k=u.create("td",{align:this._isRightToLeft?
"left":"right",width:35},b)):(k=u.create("td",{width:35,align:"center"},b),f=u.create("td",{},b));b=a.url;(!g("ie")||9<=g("ie")||9>g("ie")&&"esri.layers.ArcGISImageServiceLayer"===c.declaredClass)&&a.imageData&&0<a.imageData.length?b="data:image/png;base64,"+a.imageData:0!==a.url.indexOf("http")&&(b=c.url+"/"+d+"/images/"+a.url,(d=c._getToken())&&(b+="?token\x3d"+d));k=u.create("img",{src:b,border:0,style:"opacity:"+c.opacity},k);a=u.create("td",{innerHTML:z.encode(a.label),align:this._align},u.create("tr",
{},u.create("tbody",{},u.create("table",{width:"95%",dir:"ltr"},f))));e&&"Stretched"===e&&10.3<=c.version&&"esri.layers.ArcGISImageServiceLayer"===c.declaredClass&&(a.style.verticalAlign="top",a.style.lineHeight="1",k.style.marginBottom="-1px",k.style.display="block",f.style.verticalAlign="top");9>g("ie")&&(k.style.filter="alpha(opacity\x3d"+100*c.opacity+")")},_getVariable:function(a,b,c){var d,e;return a&&(d=a.getVisualVariablesForType(b,c),e=d&&d[0]),e},_getVariables:function(a,b,c){a=[this._getVariable(a,
"colorInfo",!1),this._getVariable(a,"opacityInfo",!1),this._getVariable(a,"sizeInfo",!1)];return b?d.filter(a,function(a){return!(!a||a.field!==b||a.normalizationField!=c)}):a},_getFieldAlias:function(b,c,d){var e=c.infoTemplate,e=e&&e.getFieldInfo&&e.getFieldInfo(b);b=a.isFunction(b)?null:this.getField(c,b,d);c=e||b;d="";return c&&(d=e&&e.label||b&&b.alias||c.name||c.fieldName),d},_getRampTitle:function(b,c,d){var e,f=b.field,g=b.normalizationField,k=!1,m=!1,h=!1;if(f=a.isFunction(f)?null:f,g=a.isFunction(g)?
null:g,b.legendOptions&&b.legendOptions.title)e=b.legendOptions.title;else if(b.valueExpressionTitle)e=b.valueExpressionTitle;else{if(c.renderer&&c.renderer.authoringInfo&&c.renderer.authoringInfo.visualVariables){var n=c.renderer.authoringInfo.visualVariables;for(b=0;b<n.length;b++){var l=n[b];if("colorInfo"===l.type&&"ratio"===l.style){k=!0;break}if("colorInfo"===l.type&&"percent"===l.style){m=!0;break}if("colorInfo"===l.type&&"percentTotal"===l.style){h=!0;break}}}(k=h&&"showRatioPercentTotal"||
m&&"showRatioPercent"||k&&"showRatio"||g&&"showNormField"||f&&"showField"||null)&&(e=D.substitute({field:f&&this._getFieldAlias(f,c,d),normField:g&&this._getFieldAlias(g,c,d)},this._i18n[k]))}return e},_getRendererTitle:function(b,c,d){var e;if(b){var f,g,k,m;b instanceof K&&(f=b.attributeField,g=b.normalizationField,k="percent-of-total"===b.normalizationType);f=a.isFunction(f)?null:f;g=a.isFunction(g)?null:g;b.legendOptions&&b.legendOptions.title?e=b.legendOptions.title:b.valueExpressionTitle?e=
b.valueExpressionTitle:(m=g&&"showNormField"||(k?"showNormPct":null)||f&&"showField"||null,m&&(e=D.substitute({field:f&&this._getFieldAlias(f,c,d),normField:g&&this._getFieldAlias(g,c,d)},this._i18n[m])))}return e},_buildLegendItems_Renderer:function(b,c,e){var f,g=c.parentLayerId,k=this.map,m=k.getScale(),h=!1;if(!this._respectCurrentMapScale||this._isLayerInScale(b,c,m)){var n,l,q,t,w,x,C,y,A;if(q="esri.layers.ArcGISImageServiceVectorLayer"===b.declaredClass?b.renderer.renderer:c&&c.drawingInfo?
S.fromJson(a.clone(c.drawingInfo.renderer)):b.renderer,q instanceof J&&(t="zoom"===q.rangeType?q.getRendererInfoByZoom(k.getZoom()):q.getRendererInfoByScale(m),q=t&&t.renderer,!q))return!1;var D,B,E,F,Q;t=this._getVariables(q);var O=d.filter(t,function(a){return!!a}).length,m=t[0],k=t[1];t=t[2];if(m&&(w=this._getMedianColor(q,m),m.field&&(C=a.isFunction(m.field)?null:this.getField(b,m.field,c)),D=!(m.legendOptions&&!1===m.legendOptions.showLegend)),k&&(k.field&&(A=a.isFunction(k.field)?null:this.getField(b,
k.field,c)),B=!(k.legendOptions&&!1===k.legendOptions.showLegend)),t&&(t.field&&(y=a.isFunction(t.field)?null:this.getField(b,t.field,c)),E=!(t.legendOptions&&!1===t.legendOptions.showLegend)),q instanceof N)f=h=!0,this._showHeatRamp(b,c,q,e);else if(q instanceof I)f=h=!0,this._showDotDensityLegend(b,c,q,e);else if(q instanceof L)f=h=!0,l=u.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},e),n=u.create("tbody",{},l),(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(l,
b,c),q.latestObservationRenderer&&q.latestObservationRenderer instanceof H&&this._buildRow_Renderer(b,q.latestObservationRenderer.symbol,w,z.encode(q.latestObservationRenderer.label)||this.NLS_currentObservations,null,n),q.observationRenderer&&q.observationRenderer instanceof H&&this._buildRow_Renderer(b,q.observationRenderer.symbol,w,z.encode(q.observationRenderer.label)||this.NLS_previousObservations,null,n);else if(q instanceof G){if(q.infos&&0<q.infos.length){if(f=h=!0,q.legendOptions&&q.legendOptions.title||
q.valueExpressionTitle)l=u.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},e),n=u.create("tbody",{},l),O=q.legendOptions&&q.legendOptions.title?q.legendOptions.title:q.valueExpressionTitle,this._buildRow_Renderer(b,null,w,z.encode(O),null,n);l=u.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},e);n=u.create("tbody",{},l);(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(l,b,c);q.attributeField&&t&&this._addSubHeader(n,this._getFieldAlias(q.attributeField,
b,c));var W=[];d.forEach(q.infos,function(a){var c=null;b._editable&&b.types&&(c=this._getTemplateFromTypes(b.types,a.value));var e=a.label;null==e&&(e=a.value);-1===d.indexOf(W,e)&&(W.push(e),this._buildRow_Renderer(b,a.symbol,w,z.encode(e),c,n))},this)}Q=this._displayDefaultSymbol(b,q,e)}else if(q instanceof K){if(q.infos&&0<q.infos.length||"esri.layers.ArcGISImageServiceVectorLayer"===b.declaredClass)(f=h=!0,F=this._isUnclassedRenderer(q),m||1!==q.infos.length)||(x=(x=q.infos[0])&&x.symbol),F||
(l=u.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},e),n=u.create("tbody",{},l),O=this._getRendererTitle(q,b,c),this._buildRow_Renderer(b,null,w,z.encode(O),null,n)),l=u.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},e),n=u.create("tbody",{},l),(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(l,b,c),F&&t&&E||(O=q.infos.slice(0).reverse(),d.forEach(O,function(a){var c=a.label;null!=c||F||(c=a.minValue+" - "+a.maxValue);
this._buildRow_Renderer(b,a.symbol,w,z.encode(c),null,n)},this)),"esri.layers.ArcGISImageServiceVectorLayer"!==b.declaredClass||b.renderer.style!==M.STYLE_SCALAR&&b.renderer.style!==M.STYLE_SINGLE_ARROW||(this._buildRow_Renderer(b,q.defaultSymbol,null,"",null,n),b._hideDefaultSymbol=!0);F||(Q=this._displayDefaultSymbol(b,q,e))}else q instanceof H&&(f=h=!0,l=u.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},e),n=u.create("tbody",{},l),(b._hoverLabel||b._hoverLabels)&&
this._createHoverAction(l,b,c),x=null,b._editable&&b.templates&&0<b.templates.length&&(x=b.templates[0]),l=1<O?null:C&&D||A&&B||y&&E,this._buildRow_Renderer(b,q.symbol,w,z.encode(l?this._getRampTitle(1<O?null:m||k||t,b,c):q.label),x,n),x=m?null:q.symbol,l&&(C=A=y=null));if(f){var R;if(m&&D&&(m.field||m.valueExpression)&&(R=t&&E?!0:!1,this._showGradientRamp(b,c,q,null,e,m,C,null,R)),t&&E&&(t.field||t.valueExpression)&&(R=m&&D||q instanceof G?!1:!0,this._showSizeLegend(b,c,q,t,w,e,y,null,R)),k&&B&&
(k.field||k.valueExpression))f=x&&!x.url&&x.color?x.color:this.transparencyRampColor,this._showGradientRamp(b,c,q,f,e,k,A,null,!1)}Q||F&&!D&&!E&&!B||(Q=this._displayDefaultSymbol(b,q,e));h=h||Q}return h&&(v.set(r.byId(this.id+"_"+b.id+"_"+c.id),"display","block"),-1<g&&(v.set(r.byId(this.id+"_"+b.id+"_"+g+"_group"),"display","block"),this._findParentGroup(b.id,g))),h},_isUnclassedRenderer:function(a,b){var c;if(a instanceof K&&a.infos&&1===a.infos.length){c=a.attributeField;var d=a.normalizationField;
c=b?c===b:!!this._getVariables(a,c,d).length}return c},_displayDefaultSymbol:function(a,b,c){var d;!a._hideDefaultSymbol&&b.defaultSymbol&&(d=!0,c=u.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c),c=u.create("tbody",{},c),this._buildRow_Renderer(a,b.defaultSymbol,null,z.encode(b.defaultLabel)||"others",null,c));return d},_showGradientRamp:function(b,c,d,e,f,g,k,m,h){h=u.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"+(h?"":" esriLegendSubFragment")},
f);f=u.create("tbody",{},h);(b._hoverLabel||b._hoverLabels||m)&&this._createHoverAction(h,b,c,m);(k||g.valueExpression)&&this._addSubHeader(f,this._getRampTitle(g,b,c));var n;(k=g.field)&&(n=a.isFunction(k)?null:this.getField(b,k,c));(c=this._getRampStops(d,g,e,n&&"esriFieldTypeDate"===n.type))&&c.length&&this._drawGradientRamp(f,c,!0,b,this._getRampBorderColor(d),!!e)},_getMedianColor:function(a,b){var c,d;b.colors?(c=b.minDataValue,d=b.maxDataValue):b.stops&&(c=b.stops[0].value,d=b.stops[b.stops.length-
1].value);return a.getColor(c+(d-c)/2,{colorInfo:b})},_getRampStops:function(a,b,c,e){var f,g,m,h,n,l=!1;b.colors||b.opacityValues?(m=b.maxDataValue-b.minDataValue,f=d.map([0,.25,.5,.75,1],function(a){return h=b.minDataValue+a*m,Number(h.toFixed(6))}),this._checkPrecision(0,4,f)):b.stops&&(f=d.map(b.stops,function(a){return a.value}),l=d.some(b.stops,function(a){return!!a.label}),l&&(n=d.map(b.stops,function(a){return a.label})));var r,q,u=f[0];return m=f[f.length-1]-u,g=d.map(f,function(d,g){c?(r=
new k(c.toRgba()),q=a.getOpacity(d,{opacityInfo:b}),null!=q&&(r.a=q)):r=a.getColor(d,{colorInfo:b});var h="";if(l)h=n[g];else{var h=e?F.formatDate(d,F.timelineDateFormatOptions):E.format(d),t="";0===g?t=this._specialChars.lt+" ":g===f.length-1&&(t=this._specialChars.gt+" ");h=t+h}return{value:d,color:r,offset:1-(d-u)/m,label:h}},this),g.reverse()},_checkPrecision:function(a,b,c){var d=a+(b-a)/2,e=c[a],f=c[d],g=c[b],k=Math.floor(e),m=Math.floor(f),h=Math.floor(g);k===e&&h===g&&m!==f&&k!==m&&h!==m&&
(c[d]=m);a+1!==d&&this._checkPrecision(a,d,c);d+1!==b&&this._checkPrecision(d,b,c)},_getRampBorderColor:function(a){var b,c;return a instanceof H?b=a.symbol:(a instanceof G||a instanceof K)&&(b=a.infos[0].symbol),c=b&&-1===b.type.indexOf("linesymbol")?b.getStroke():null,c&&c.color},_drawGradientRamp:function(a,b,c,e,f,m){var h,n,l,r,q,t,w,C,y=u.create("tr",{},a),A=b.length-1;a=0;this.alignRight?(h=u.create("td",{align:this._isRightToLeft?"left":"right"},y),n=u.create("td",{align:this._isRightToLeft?
"left":"right",width:this.gradientWidth},y)):(n=u.create("td",{width:this.gradientWidth,align:"center"},y),h=u.create("td",{},y));y=f&&0<f.a&&!(240<=f.r&&240<=f.g&&240<=f.b);l=u.create("div",{"class":y?"":"esriLegendBorderLessColorRamp",style:"position: relative; width:"+this.gradientWidth+"px;"},n);n=u.create("div",{"class":"esriLegendColorRamp"+(m?" esriLegendTransparencyRamp":"")},l);m=v.get(n,"width");y&&(f=9>g("ie")?f.toHex():"rgba("+f.toRgba().join(",")+")",v.set(n,"border",this.colorRampBorder+
" "+f));c?(w=this.gradientHeight*A,v.set(n,"height",w+"px")):w=v.get(n,"height");v.set(l,"height",w+"px");f=x.createSurface(n,m,w);9>g("ie")&&(q=f.getEventSource(),v.set(q,"position","relative"),v.set(q.parentNode,"position","relative"),a=1);try{c&&d.forEach(b,function(a,b){a.offset=b/A}),t=f.createRect({x:-a,y:-a,width:m+a,height:w+a}),t.setFill({type:"linear",x1:0,y1:0,x2:0,y2:w,colors:b}).setStroke(null),f.createRect({width:m,height:w}).setFill(new k([255,255,255,1-e.opacity])).setStroke(null),
this._surfaceItems.push(f)}catch(D){f.clear(),f.destroy()}d.forEach(b,function(a,c){if(a.label){C="top:"+100*a.offset+"%;";var d="";0===c&&(d+=" esriLegendColorRampTickFirst");c===b.length-1&&(d+=" esriLegendColorRampTickLast");u.create("div",{"class":"esriLegendColorRampTick"+d,innerHTML:"\x26nbsp;",style:C},l)}});r=u.create("div",{"class":"esriLegendColorRampLabels",style:{height:w+this.gradientHeight+"px"}},h);c?d.forEach(b,function(a){u.create("div",{"class":"esriLegendColorRampLabel",innerHTML:z.encode(a.label)||
"\x26nbsp;"},r)}):(u.create("div",{"class":"esriLegendColorRampLabel",innerHTML:this._i18n.high},r),u.create("div",{"class":"esriLegendColorRampLabel",innerHTML:this._i18n.low,style:"top: "+(w+this.gradientHeight-2*this.gradientHeight)+"px;"},r))},_showHeatRamp:function(a,b,c,d,e){var f,g=c.field;f=u.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d);d=u.create("tbody",{},f);(a._hoverLabel||a._hoverLabels||e)&&this._createHoverAction(f,a,b,e);(g=g&&this.getField(a,
g,b))&&this._addSubHeader(d,this._getFieldAlias(g.name,a,b));b=this._getHeatmapStops(c);b.length&&this._drawGradientRamp(d,b,!1,a)},_getHeatmapStops:function(a){var b,c,e,f,g=a.colorStops;a=a.colors;g&&g[0]?(b=g.length-1,g[0]&&null!=g[0].ratio)?(a=g[b])&&1!==a.ratio&&(g=g.slice(0),g.push({ratio:1,color:a.color}),b++):(c=g[0].value,e=g[b].value-c,g=d.map(g,function(a){return{color:a.color,ratio:(a.value-c)/e}})):a&&a[0]&&(b=a.length-1,f=1/(a.length-1),g=d.map(a,function(a,b){return{color:a,ratio:b*
f}}));return g=d.map(g,function(a,c){var d="";return 0===c?d="Low":c===b&&(d="High"),{color:a.color,label:d,offset:1-a.ratio}}),g.reverse()},_showDotDensityLegend:function(b,c,e,f){var g,k,m,h,n,l,r,q=e.legendOptions,t=this.dotDensitySwatchSize,v=Math.round(t/2);q&&(k=q.backgroundColor,m=q.outline,h=q.valueUnit,n=q.dotCoverage);n=(n||this.dotCoverage)/100;r=Math.round(t*t/Math.pow(e.dotSize,2)*n);f=u.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},f);l=u.create("tbody",
{},f);(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(f,b,c);this._addSubHeader(l,D.substitute({value:e.dotValue,unit:h||""},this.NLS_dotValue));d.forEach(e.fields,function(d){d=a.mixin({},d);d.numPoints=r;g=new Q(e._generateImageSrc(t,t,[d],{x:0,y:0},{x:t,y:t},k),m||e.outline,t,t);d=this.getField(b,d.name,c)||d;this._buildRow_Renderer(b,g,null,z.encode(this._getFieldAlias(d.name,b,c)),null,l,{type:"path",path:"M "+-v+","+-v+" L "+v+","+-v+" L "+v+","+v+" L "+-v+","+v+" L "+-v+","+-v+" E"})},
this)},_showSizeLegend:function(b,c,d,e,f,g,k,m,h){var n;n=(n=e.legendOptions)&&n.customValues;f=this._getSizeSymbol(d,f);if((!e.valueUnit||"unknown"===e.valueUnit)&&f&&(n||null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue||e.stops&&!(1>=e.stops.length))){h=u.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"+(h?"":" esriLegendSubFragment")},g);g=u.create("tbody",{},h);(b._hoverLabel||b._hoverLabels||m)&&this._createHoverAction(h,b,c,m);(k||
e.valueExpression)&&this._addSubHeader(g,this._getRampTitle(e,b,c));var l;(k=e.field)&&(l=a.isFunction(k)?null:this.getField(b,k,c));c=l&&"esriFieldTypeDate"===l.type;n=n||this._getDataValues(d,f,e,c);for(l=h=n.length-1;0<=l;l--)k=n[l],f=T.fromJson(f.toJson()),this._applySize(f,d,e,k),k=c?F.formatDate(k,F.timelineDateFormatOptions):E.format(k),m="",l===h?m=this._specialChars.gt+" ":0===l&&(m=this._specialChars.lt+" "),m="\x3cspan class\x3d'esriLegendSizeRampLabel'\x3e"+z.encode(m+k)+"\x3c/span\x3e",
this._buildRow_Renderer(b,f,null,m,null,g)}},_getSizeSymbol:function(a,b){var c,d;if(a instanceof H?c=a.symbol:a instanceof M?c=a.defaultSymbol:(a instanceof G||a instanceof K)&&(c=a.infos[0].symbol,d=1<a.infos.length),c=c&&-1!==c.type.indexOf("fillsymbol")?null:c,c&&(c=T.fromJson(c.toJson()),b||d))if(-1!==c.type.indexOf("linesymbol"))c.setColor(new k(this.sizeRampDarkColor));else if(c.setColor(new k(this.sizeRampLightColor)),c.setOutline)d=new O,d.setColor(new k(this.sizeRampDarkColor)),d.setWidth(1.5),
c.setOutline(d);return c},_getDataValues:function(a,b,c,e,f,g){f=null==f?5:f;g=null==g?20:g;var k=a.getSizeRangeAtScale(c,this.map.getScale());f=this._interpolateSizeRange(k,f);var m=this._getDataRange(c),h=d.map(f,function(a){return this._getDataValueFromSize(a,m,k)},this);if(!e){var n,h=E.round(h);for(e=1;e<h.length-1;e++)(n=this._roundDataValue(a,b,c,h[e],h[e-1],g))&&(h[e]=n[0],f[e]=n[1])}return h},_getDataRange:function(a){var b=a.stops;return b?{min:b[0].value,max:b[b.length-1].value}:{min:a.minDataValue,
max:a.maxDataValue}},_interpolateSizeRange:function(a,b){var c,d=a.minSize,e=(a.maxSize-d)/(b-1),f=[];for(c=0;b>c;c++)f.push(d+e*c);return f},_getDataValueFromSize:function(a,b,c){var d,e,f=c.minSize;c=c.maxSize;var g=b.min;b=b.max;return f>=a?e=g:a>=c?e=b:(d=(a-f)/(c-f),e=d*(b-g)+g),e},_roundDataValue:function(a,b,c,d,e,f){var g,k,m,h,n,l,r,q,u,t,v,w,x,C,y,A=this._getSize(b,a,c,d);e=this._getSize(b,a,c,e);var D=E.getDigits(d);k=D.integer;D=D.fractional;0<d&&1>d&&(g=Math.pow(10,D),d*=g,k=E.getDigits(d).integer);
for(--k;0<=k&&(m=Math.pow(10,k),h=Math.floor(d/m)*m,n=Math.ceil(d/m)*m,null!=g&&(h/=g,n/=g),l=(h+n)/2,l=E.round([h,l,n],{indexes:[1]})[1],r=this._getSize(b,a,c,h),q=this._getSize(b,a,c,n),u=this._getSize(b,a,c,l),t=E.getPctChange(A,r,e,null),v=E.getPctChange(A,q,e,null),w=E.getPctChange(A,u,e,null),x=t.prev<=f,C=v.prev<=f,x&&C&&(t.prev<=v.prev?(x=!0,C=!1):(C=!0,x=!1)),x?y=[h,r]:C?y=[n,q]:w.prev<=f&&(y=[l,u]),!y);k--);return y},_applySize:function(a,b,c,d){var e;e=a.type;b=this._getSize(a,b,c,d);switch(e){case "simplemarkersymbol":a.setSize(b);
break;case "picturemarkersymbol":e=a.width;c=a.height;a.setHeight(b);a.setWidth(e/c*b);break;case "simplelinesymbol":case "cartographiclinesymbol":a.setWidth(b);break;case "textsymbol":a.font&&a.font.setSize(b)}},_getSize:function(a,b,c,d){return b.getSize(d,{sizeInfo:c,scale:this.map.getScale(),shape:-1!==a.type.indexOf("markersymbol")?a.style:null})},_buildRow_Renderer:function(a,b,c,d,e,f,g){var k,m;f=u.create("tr",{},f);this.alignRight?(k=u.create("td",{align:this._isRightToLeft?"left":"right"},
f),b&&(m=u.create("td",{align:this._isRightToLeft?"left":"right",width:35},f))):(b&&(m=u.create("td",{width:35,align:"center"},f)),k=u.create("td",{},f));var h,n=f=30;if(b){if("simplemarkersymbol"==b.type)f=Math.min(Math.max(f,b.size+12),125),n=Math.min(Math.max(n,b.size+12),125);else if("picturemarkersymbol"==b.type)f=Math.min(Math.max(f,b.width),125),n=Math.min(b.height||n,125);else if("textsymbol"==b.type){var l,r;b.text||(l=b.text,r=!0,b.setText(this.defaultText));f=Math.min(Math.max(f,b.getWidth()+
12),125);n=Math.min(Math.max(n,b.getHeight()+12),125);r&&b.setText(l)}h=u.create("div",{style:"width:"+f+"px;height:"+n+"px;"},m)}if(D.isDefined(d)&&"number"==typeof d&&(d=""+d),u.create("td",{innerHTML:d||"",align:this._align},u.create("tr",{},u.create("tbody",{},u.create("table",{width:"95%"},k)))),b)a=this._drawSymbol(h,b,c,f,n,e,a,g),this._surfaceItems.push(a)},_addSubHeader:function(a,b){var c=u.create("tr",{},a),c=u.create("td",{align:this._align,colspan:2},c);u.create("td",{innerHTML:z.encode(b)||
"",align:this._align},u.create("tr",{},u.create("tbody",{},u.create("table",{width:"95%"},c))))},_drawSymbol:function(b,c,d,e,f,m,h,n){var l;c=T.fromJson(c.toJson());var r=h.opacity;if(d&&c.setColor(new k(d.toRgba())),"simplelinesymbol"===c.type||"cartographiclinesymbol"===c.type||"textsymbol"===c.type){if(!c.color)return;l=c.color.toRgba();l[3]*=r;c.color.setColor(l)}else"simplemarkersymbol"===c.type||"simplefillsymbol"===c.type?(c.color&&(l=c.color.toRgba(),l[3]*=r,c.color.setColor(l)),c.outline&&
c.outline.color&&(l=c.outline.color.toRgba(),l[3]*=r,c.outline.color.setColor(l))):"picturemarkersymbol"===c.type&&(b.style.opacity=r,b.style.filter="alpha(opacity\x3d("+100*r+"))");var q;b=x.createSurface(b,e,f);9>g("ie")&&(q=b.getEventSource(),v.set(q,"position","relative"),v.set(q.parentNode,"position","relative"));var u;m=this._getDrawingToolShape(c,m)||T.getShapeDescriptors(c);d=(q=m.defaultShape)&&"text"===q.type;try{d&&!q.text&&(q.text=this.defaultText),u=b.createShape(n||q).setFill(m.fill).setStroke(m.stroke),
d&&u.setFont(m.font)}catch(t){return b.clear(),void b.destroy()}l=u.getBoundingBox();n=l.width;m=l.height;d=-(l.x+n/2);r=-(l.y+m/2);q=b.getDimensions();d={dx:d+q.width/2,dy:r+q.height/2};if("simplemarkersymbol"===c.type&&"path"===c.style)e=h._getScaleMatrix(l,c.size),u.applyTransform(y.scaleAt(e.xx,e.yy,{x:q.width/2,y:q.height/2}));else if(n>e||m>f)h=n/e>m/f,e=((h?e:f)-5)/(h?n:m),a.mixin(d,{xx:e,yy:e});return u.applyTransform(d),b},_getDrawingToolShape:function(a,b){var c;switch(b?b.drawingTool||
null:null){case "esriFeatureEditToolArrow":c={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 Z"};break;case "esriFeatureEditToolTriangle":c={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 Z"};break;case "esriFeatureEditToolRectangle":c={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"};break;case "esriFeatureEditToolCircle":c={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":c={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;default:return null}return{defaultShape:c,
fill:a.getFill(),stroke:a.getStroke()}},_repaintItems:function(){d.forEach(this._surfaceItems,function(a){this._repaint(a)},this)},_repaint:function(b){if(b){b.getStroke&&b.setStroke&&b.setStroke(b.getStroke());try{b.getFill&&b.setFill&&b.setFill(b.getFill())}catch(c){}b.children&&a.isArray(b.children)&&d.forEach(b.children,this._repaint,this)}},_createHoverAction:function(c,d,e,f){(f=d._hoverLabel||d._hoverLabels&&d._hoverLabels[e.id]||f)&&(f=z.encode(f),d.mouseMoveHandler=d.mouseMoveHandler||{},
d.mouseMoveHandler[e.id]=b.connect(c,"onmousemove",a.hitch(this,function(b,c){this.mouseX=c.clientX;this.mouseY=c.clientY;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,v.set(r.byId(this.id+"_hoverLabel"),"display","none"));setTimeout(a.hitch(this,function(a,b,c){if(a==this.mouseX&&b==this.mouseY&&!this.hoverLabelShowing)if(this.hoverLabelShowing=!0,r.byId(this.id+"_hoverLabel")){var d=r.byId(this.id+"_hoverLabel");d.innerHTML="\x3cspan\x3e"+c+"\x3c/span\x3e";v.set(d,"top",b+"px");v.set(d,"left",
a+15+"px");v.set(d,"display","")}else u.create("div",{innerHTML:"\x3cspan\x3e"+c+"\x3c/span\x3e",id:this.id+"_hoverLabel","class":"esriLegendHoverLabel",style:{top:b+"px",left:a+15+"px"}},document.body)},c.clientX,c.clientY,b),500)},f)),d.mouseOutHandler=d.mouseOutHandler||{},d.mouseOutHandler[e.id]=b.connect(c,"onmouseout",a.hitch(this,function(a){this.mouseY=this.mouseX=-1;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,v.set(r.byId(this.id+"_hoverLabel"),"display","none"))})))},_removeHoverHandlers:function(){var a;
d.forEach(this.layers,function(c){if(c.mouseMoveHandler)for(a in c.mouseMoveHandler)b.disconnect(c.mouseMoveHandler[a]);if(c.mouseOutHandler)for(a in c.mouseOutHandler)b.disconnect(c.mouseOutHandler[a])})},_createDynamicLayers:function(a){var b,c=[];return d.forEach(a.dynamicLayerInfos||a.layerInfos,function(d){b={id:d.id};b.source=d.source&&d.source.toJson();var e;a.layerDefinitions&&a.layerDefinitions[d.id]&&(e=a.layerDefinitions[d.id]);e&&(b.definitionExpression=e);var f;a.layerDrawingOptions&&
a.layerDrawingOptions[d.id]&&(f=a.layerDrawingOptions[d.id]);f&&(b.drawingInfo=f.toJson());b.minScale=d.minScale||0;b.maxScale=d.maxScale||0;c.push(b)}),c},_getTemplateFromTypes:function(a,b){var c;for(c=0;c<a.length;c++)if(a[c].id==b&&a[c].templates&&0<a[c].templates.length)return a[c].templates[0];return null},_findParentGroup:function(a,b,c){var d,e=b.dynamicLayerInfos||b.layerInfos;for(d=0;d<e.length;d++)if(c==e[d].id){-1<e[d].parentLayerId&&(v.set(r.byId(this.id+"_"+a+"_"+e[d].parentLayerId+
"_group"),"display","block"),this._findParentGroup(a,b,e[d].parentLayerId));break}},_addSubLayersToHide:function(a){function b(c,e){var f,g,k=a.layer.dynamicLayerInfos||a.layer.layerInfos;for(f=0;f<k.length;f++)if(k[f].id===c&&k[f].subLayerIds)for(g=0;g<k[f].subLayerIds.length;g++){var m=k[f].subLayerIds[g];-1===d.indexOf(e,m)&&(e.push(m),b(m,e))}}a.layer.layerInfos&&d.forEach(this.hideLayersInLegend[a.layer.id],function(c){b(c,this.hideLayersInLegend[a.layer.id])},this)},_isLayerInScale:function(a,
b,c){var d,e=!0;if(a.legendResponse&&a.legendResponse.layers)for(d=0;d<a.legendResponse.layers.length;d++){var f=a.legendResponse.layers[d];if(b.id==f.layerId){var g,k;!a.minScale&&0!==a.minScale||!a.maxScale&&0!==a.maxScale?(0==f.minScale&&a.tileInfo&&(g=a.tileInfo.lods[0].scale),0==f.maxScale&&a.tileInfo&&(k=a.tileInfo.lods[a.tileInfo.lods.length-1].scale)):(g=Math.min(a.minScale,f.minScale)||a.minScale||f.minScale,k=Math.max(a.maxScale,f.maxScale));(0<g&&c>g||k>c)&&(e=!1);break}}else(a.minScale||
a.maxScale)&&(a.minScale&&a.minScale<c||a.maxScale&&a.maxScale>c)&&(e=!1);return e},_getServiceTitle:function(a){var b=a._titleForLegend;if(b||(b=a.url,a.url?-1<a.url.indexOf("/MapServer")?(b=a.url.substring(0,a.url.indexOf("/MapServer")),b=b.substring(b.lastIndexOf("/")+1,b.length)):-1<a.url.indexOf("/ImageServer")?(b=a.url.substring(0,a.url.indexOf("/ImageServer")),b=b.substring(b.lastIndexOf("/")+1,b.length)):-1<a.url.indexOf("/FeatureServer")&&(b=a.url.substring(0,a.url.indexOf("/FeatureServer")),
b=b.substring(b.lastIndexOf("/")+1,b.length)):b="",a.name&&(0<b.length?b+=" - "+a.name:b=a.name)),"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass&&a.vectorFieldPixelFilter)a=a.vectorFieldPixelFilter.outputUnit?this["NLS_"+a.vectorFieldPixelFilter.outputUnit]:this["NLS_"+a.vectorFieldPixelFilter.inputUnit],D.isDefined(a)&&(b+=" ("+a+")");return z.encode(b)},_getEffectiveScale:function(a,b){var c=b.minScale,d=b.maxScale;if(D.isDefined(b.parentLayerId)){var e,f=a.layerInfos,g=b.parentLayerId;
for(e=f.length-1;0<=e;e--)if(f[e].id==g){if(0==c&&0<f[e].minScale?c=f[e].minScale:0<c&&0==f[e].minScale||0<c&&0<f[e].minScale&&(c=Math.min(c,f[e].minScale)),d=Math.max(d||0,f[e].maxScale||0),!(-1<f[e].parentLayerId))break;g=f[e].parentLayerId}}return{minScale:c,maxScale:d}},_isSupportedLayerType:function(a){return a&&("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&10.2<=a.version||"esri.layers.ArcGISImageServiceVectorLayer"===
a.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass||"esri.layers.FeatureLayer"===a.declaredClass||"esri.layers.StreamLayer"===a.declaredClass||"esri.layers.KMLLayer"===a.declaredClass||"esri.layers.GeoRSSLayer"===a.declaredClass||"esri.layers.WMSLayer"===a.declaredClass||"esri.layers.WFSLayer"===a.declaredClass||"esri.layers.CSVLayer"===a.declaredClass)?!0:!1},isHostedTileService:function(a){var b=/(https?:)?\/\/services.*\.arcgis\.com/i;return"esri.layers.ArcGISTiledMapServiceLayer"===
a.declaredClass&&b.test(a.url)?!0:!1},getField:function(a,b,c){if(a.getField)return a.getField(b);if(c&&c.fields){var e;return d.forEach(c.fields,function(a){a.name===b&&(e=a)}),e}return null}});return a.mixin(W,{ALIGN_LEFT:0,ALIGN_RIGHT:1}),g("extend-esri")&&a.setObject("dijit.Legend",W,A),W})},"dojo/debounce":function(){define([],function(){return function(h,l){var a;return function(){a&&clearTimeout(a);var d=this,b=arguments;a=setTimeout(function(){h.apply(d,b)},l)}}})},"dojo/DeferredList":function(){define(["./_base/kernel",
"./_base/Deferred","./_base/array"],function(h,l,a){h.DeferredList=function(d,b,f,k,m){var g=[];l.call(this);var e=this;0!==d.length||b||this.resolve([0,[]]);var c=0;a.forEach(d,function(a,m){function h(a,b){g[m]=[a,b];c++;c===d.length&&e.resolve(g)}a.then(function(a){b?e.resolve([m,a]):h(!0,a)},function(a){f?e.reject(a):h(!1,a);if(k)return null;throw a;})})};h.DeferredList.prototype=new l;h.DeferredList.prototype.gatherResults=function(d){d=new h.DeferredList(d,!1,!0,!1);d.addCallback(function(b){var d=
[];a.forEach(b,function(a){d.push(a[1])});return d});return d};return h.DeferredList})},"dojox/html/entities":function(){define(["dojo/_base/lang"],function(h){var l=h.getObject("dojox.html.entities",!0),a=function(a,d){var k,m;if(d._encCache&&d._encCache.regexp&&d._encCache.mapper&&d.length==d._encCache.length)k=d._encCache.mapper,m=d._encCache.regexp;else{k={};m=["["];var g;for(g=0;g<d.length;g++)k[d[g][0]]="\x26"+d[g][1]+";",m.push(d[g][0]);m.push("]");m=new RegExp(m.join(""),"g");d._encCache=
{mapper:k,regexp:m,length:d.length}}return a=a.replace(m,function(a){return k[a]})},d=function(a,d){var k,m;if(d._decCache&&d._decCache.regexp&&d._decCache.mapper&&d.length==d._decCache.length)k=d._decCache.mapper,m=d._decCache.regexp;else{k={};m=["("];var g;for(g=0;g<d.length;g++){var e="\x26"+d[g][1]+";";g&&m.push("|");k[e]=d[g][0];m.push(e)}m.push(")");m=new RegExp(m.join(""),"g");d._decCache={mapper:k,regexp:m,length:d.length}}return a=a.replace(m,function(a){return k[a]})};l.html=[["\x26","amp"],
['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];l.latin=[["\u00a1","iexcl"],["\u00a2","cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],
["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2",
"Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec",
"igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1","ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],
["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],
["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122",
"trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],
["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],
["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],
["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];l.encode=function(b,d){b&&(d?b=a(b,d):(b=a(b,l.html),b=a(b,l.latin)));return b};l.decode=function(a,f){a&&(f?a=d(a,f):(a=d(a,l.html),a=d(a,l.latin)));return a};return l})},"esri/numberUtils":function(){define(["dojo/has","dojo/number","dojo/i18n!dojo/cldr/nls/number","./kernel"],function(h,l,a,d){var b=function(a,b){return a-b},f={_reNumber:/^-?(\d+)(\.(\d+))?$/i,getDigits:function(a){var b=
String(a),d=b.match(f._reNumber);a={integer:0,fractional:0};if(d&&d[1])a.integer=d[1].split("").length,a.fractional=d[3]?d[3].split("").length:0;else if(-1<b.toLowerCase().indexOf("e")){var e,c,d=b.split("e"),b=d[0],d=d[1];b&&d&&(b=Number(b),d=Number(d),c=0<d,c||(d=Math.abs(d)),e=f.getDigits(b),c?(e.integer+=d,d>e.fractional?e.fractional=0:e.fractional-=d):(e.fractional+=d,d>e.integer?e.integer=1:e.integer-=d),a=e)}return a},getFixedNumbers:function(a,b){var d,e;return d=Number(a.toFixed(b)),a>d?
e=d+1/Math.pow(10,b):(e=d,d-=1/Math.pow(10,b)),d=Number(d.toFixed(b)),e=Number(e.toFixed(b)),[d,e]},getPctChange:function(a,b,d,e){var c,f,h,l={prev:null,next:null};return null!=d&&(c=a-d,f=b-d,h=f-c,l.prev=Math.floor(Math.abs(100*h/c))),null!=e&&(c=e-a,f=e-b,h=f-c,l.next=Math.floor(Math.abs(100*h/c))),l},round:function(a,d){var g,e,c,h,l,r,u,v,t,w,x=a.slice(0),y=d&&null!=d.tolerance?d.tolerance:2,z=d&&d.indexes,A=d&&null!=d.strictBounds?d.strictBounds:!1;if(z)z.sort(b);else for(z=[],u=0;u<x.length;u++)z.push(u);
for(u=0;u<z.length;u++)if(w=z[u],g=x[w],e=0===w?null:x[w-1],c=w===x.length-1?null:x[w+1],h=f.getDigits(g),l=h.fractional){v=0;for(t=!1;l>=v&&!t;)r=f.getFixedNumbers(g,v),r=A&&0===u?r[1]:r[0],t=f.hasMinimalChange(g,r,e,c,y),v++;t&&(x[w]=r)}return x},hasMinimalChange:function(a,b,d,e,c){var h,l;a=f.getPctChange(a,b,d,e);return h=null==a.prev||a.prev<=c,l=null==a.next||a.next<=c,h&&l||a.prev+a.next<=2*c},_reAllZeros:new RegExp("\\"+a.decimal+"0+$","g"),_reSomeZeros:RegExp("(\\d)0*$","g"),format:function(a,
b){b=b||{places:20,round:-1};var d=l.format(a,b);return d&&(d=d.replace(f._reSomeZeros,"$1").replace(f._reAllZeros,"")),d}};return h("extend-esri")&&(d.numberUtils=f),f})},"esri/renderers/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/has dojo/date/locale ../kernel ../numberUtils ../Color dojo/i18n!../nls/jsapi dojo/i18n!dojo/cldr/nls/gregorian".split(" "),function(h,l,a,d,b,f,k,m,g){function e(a){return a&&l.map(a,function(a){return new k(a)})}function c(a,b,c){var d="";return 0===
b?d=q.lt+" ":b===c&&(d=q.gt+" "),d+a}var n={},q={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%"},r={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},u={millisecond:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},second:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},minute:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},hour:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},day:{selector:"date",
dateOptions:{formatLength:"long"}},month:{selector:"date",dateOptions:{formatLength:"long"}},year:{selector:"date",dateOptions:{selector:"year"}}},v={formatLength:"short",fullYear:!0},t={formatLength:"short"};return h.mixin(n,{timelineDateFormatOptions:{selector:"date",dateOptions:{formatLength:"short",fullYear:!0}},formatDate:function(a,b){var c,e=[];null==a||a instanceof Date||(a=new Date(a));b=b||{};b=h.mixin({},b);var f=b.selector?b.selector.toLowerCase():null,k=!f||-1<f.indexOf("time"),f=!f||
-1<f.indexOf("date");return k&&(b.timeOptions=b.timeOptions||t,b.timeOptions&&(b.timeOptions=h.mixin({},b.timeOptions),b.timeOptions.selector=b.timeOptions.selector||"time",e.push(b.timeOptions))),f&&(b.dateOptions=b.dateOptions||v,b.dateOptions&&(b.dateOptions=h.mixin({},b.dateOptions),b.dateOptions.selector=b.dateOptions.selector||"date",e.push(b.dateOptions))),e&&e.length?(e=l.map(e,function(b){return d.format(a,b)}),c=1==e.length?e[0]:g["dateTimeFormat-medium"].replace(/\'/g,"").replace(/\{(\d+)\}/g,
function(a,b){return e[b]})):c=d.format(a),c},createColorStops:function(a){var b=a.values,d=a.colors,e=a.labelIndexes,g=a.isDate,k=a.dateFormatOptions;return l.map(b,function(a,m){var h=null;if(!e||-1<l.indexOf(e,m)){var r;(r=g?n.formatDate(a,k):f.format(a))&&(h=c(r,m,b.length-1))}return{value:a,color:d[m],label:h}})},updateColorStops:function(a){var b,d=a.stops,e=a.changes,g=a.isDate,k=a.dateFormatOptions,m=[],h=l.map(d,function(a){return a.value});l.forEach(e,function(a){m.push(a.index);h[a.index]=
a.value});b=f.round(h,{indexes:m});l.forEach(d,function(a,e){if(a.value=h[e],null!=a.label){var m,l=null;(m=g?n.formatDate(b[e],k):f.format(b[e]))&&(l=c(m,e,d.length-1));a.label=l}})},createClassBreakLabel:function(a){var b=a.minValue,c=a.maxValue,d=a.isFirstBreak?"":q.gt+" ";a="percent-of-total"===a.normalizationType?q.pct:"";return b=null==b?"":f.format(b),c=null==c?"":f.format(c),d+b+a+" "+m.smartMapping.minToMax+" "+c+a},setLabelsForClassBreaks:function(a){var b=a.classBreaks,c=a.classificationMethod,
d=a.normalizationType,e=[];b&&b.length&&("standard-deviation"===c||(a.round?(e.push(b[0].minValue),l.forEach(b,function(a){e.push(a.maxValue)}),e=f.round(e),l.forEach(b,function(a,b){a.label=n.createClassBreakLabel({minValue:0===b?e[0]:e[b],maxValue:e[b+1],isFirstBreak:0===b,normalizationType:d})})):l.forEach(b,function(a,b){a.label=n.createClassBreakLabel({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===b,normalizationType:d})})))},updateClassBreak:function(a){var b,c=a.classBreaks,d=a.normalizationType,
e=a.change,f=e.index,e=e.value,g=-1,k=-1,m=c.length;return"standard-deviation"===a.classificationMethod?void 0:(0===f?g=f:f===m?k=f-1:(k=f-1,g=f),-1<g&&m>g&&(b=c[g],b.minValue=e,b.label=n.createClassBreakLabel({minValue:b.minValue,maxValue:b.maxValue,isFirstBreak:0===g,normalizationType:d})),void(-1<k&&m>k&&(b=c[k],b.maxValue=e,b.label=n.createClassBreakLabel({minValue:b.minValue,maxValue:b.maxValue,isFirstBreak:0===k,normalizationType:d}))))},calculateDateFormatInterval:function(a){var b,c,d,e,f,
g,k,m,h,n=a.length,q=1/0;a=l.map(a,function(a){return new Date(a)});for(b=0;n-1>b;b++){d=a[b];f=[];k=1/0;m="";for(c=b+1;n>c;c++)e=a[c],e=d.getFullYear()!==e.getFullYear()&&"year"||d.getMonth()!==e.getMonth()&&"month"||d.getDate()!==e.getDate()&&"day"||d.getHours()!==e.getHours()&&"hour"||d.getMinutes()!==e.getMinutes()&&"minute"||d.getSeconds()!==e.getSeconds()&&"second"||"millisecond",g=r[e],k>g&&(k=g,m=e),f.push(e);q>k&&(q=k,h=m)}return h},createUniqueValueLabel:function(a){var b=a.value,c=a.fieldInfo,
d=a.domain;a=a.dateFormatInterval;var e=String(b),d=d&&d.codedValues?d.getName(b):null;return d?e=d:"number"==typeof b&&(e=c&&"esriFieldTypeDate"===c.type?n.formatDate(b,a&&u[a]):f.format(b)),e},cloneColorInfo:function(a){var b;return a&&(b=h.mixin({},a),b.colors=e(b.colors),b.stops=b.stops&&l.map(b.stops,function(a){return a=h.mixin({},a),a.color&&(a.color=new k(a.color)),a}),b.legendOptions&&(b.legendOptions=h.mixin({},b.legendOptions))),b},cloneOpacityInfo:function(a){var b;a&&(b=h.mixin({},a),
(a=b.opacityValues)&&(b.opacityValues=a.slice(0)),(a=b.stops)&&(b.stops=l.map(a,function(a){return h.mixin({},a)})),(a=b.legendOptions)&&(b.legendOptions=h.mixin({},a)));return b},cloneSizeInfo:function(a){var b;a&&(b=h.mixin({},a),b.stops&&(b.stops=l.map(b.stops,function(a){return h.mixin({},a)})),(a=b.minSize)&&"object"==typeof a&&(b.minSize=n.cloneSizeInfo(a)),(a=b.maxSize)&&"object"==typeof a&&(b.maxSize=n.cloneSizeInfo(a)),(a=b.legendOptions)&&(b.legendOptions=h.mixin({},a),a=a.customValues,
a&&(b.legendOptions.customValues=a.slice(0))));return b}}),a("extend-esri")&&h.setObject("renderer.utils",n,b),n})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),function(h,l,a,d,b,f){return h([f,b],{_onMap:function(a){var b,d,e=this.constructor._onMap;return e&&e.FINAL||(delete this.constructor._onMap,e=this.registerConnectEvents(),e.FINAL=!0),a=a.toLowerCase(),e[a]?b=this[e[a].method]:(d=this._onCamelCase(a),
this[d]&&(b=d)),b},on:function(a,b){var f=this._onMap(a),e=a.replace(/\-/g,""),c="on"+e in this.domNode;return f||!c?this.inherited(arguments):this.own(d(this.domNode,e,b))[0]},emit:function(a,b,d){var e,c,f,h=a.toLowerCase(),r=this.constructor._onMap||this.registerConnectEvents();return c=this[this._onMap(h)],b=b||{},b.target||(b.target=this),c&&r&&r[h]&&(this._onObj2Arr(function(){e=Array.prototype.slice.call(arguments)},r[h].argKeys)(b),f=l.mixin({},arguments),f[2]=e,f[0]=r[h].name.replace(/^on/,
"")),this.inherited(f||arguments)}})})},"cmv/viewer/js/gis/dijit/LayerControl/controls/Feature":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_Contained ./_Control ./../plugins/legendUtil".split(" "),function(h,l,a,d,b,f){return h([l,a,d,b],{_layerType:"vector",_esriLayerType:"feature",_layerTypeInit:function(){f.isLegend(this.controlOptions.noLegend,this.controller.noLegend)?(this._expandClick(),f.vectorLegend(this.layer,this.expandNode)):this._expandRemove()}})})},
"esri/dijit/HomeButton":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/has ../kernel dijit/_WidgetBase dijit/a11yclick dijit/_TemplatedMixin dojo/on dojo/Deferred dojo/text!./templates/HomeButton.html dojo/i18n!../nls/jsapi dojo/dom-class dojo/dom-style".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r){h=l("esri.dijit.HomeButton",[f,m,h],{templateString:c,options:{theme:"HomeButton",map:null,extent:null,fit:!1,visible:!0},constructor:function(b,c){var d=a.mixin({},this.options,
b);this.domNode=c;this._i18n=n;this.set("map",d.map);this.set("theme",d.theme);this.set("visible",d.visible);this.set("extent",d.extent);this.set("fit",d.fit);this.watch("theme",this._updateThemeWatch);this.watch("visible",this._visible);this._css={container:"homeContainer",home:"home",loading:"loading"}},postCreate:function(){this.inherited(arguments);this.own(g(this._homeNode,k,a.hitch(this,this.home)))},startup:function(){this.inherited(arguments);this.map||this.destroy();this.map.loaded?this._init():
g.once(this.map,"load",a.hitch(this,function(){this._init()}))},destroy:function(){this.inherited(arguments)},home:function(){var b=new e,c=this.get("extent");this._showLoading();var d={extent:c};c?this.map.extent!==c?this.map.setExtent(c,this.get("fit")).then(a.hitch(this,function(){this._hideLoading();this.emit("home",d);b.resolve(d)}),a.hitch(this,function(a){a||(a=Error("HomeButton::Error setting map extent"));d.error=a;this.emit("home",d);b.reject(a)})):(this._hideLoading(),this.emit("home",
d),b.resolve(d)):(this._hideLoading(),c=Error("HomeButton::home extent is undefined"),d.error=c,this.emit("home",d),b.reject(c));return b.promise},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},_init:function(){this._visible();this.get("extent")||this.set("extent",this.map.extent);this.set("loaded",!0);this.emit("load",{})},_showLoading:function(){q.add(this._homeNode,this._css.loading)},_hideLoading:function(){q.remove(this._homeNode,this._css.loading)},_updateThemeWatch:function(a,
b,c){q.remove(this.domNode,b);q.add(this.domNode,c)},_visible:function(){this.get("visible")?r.set(this.domNode,"display","block"):r.set(this.domNode,"display","none")}});return d("extend-esri")&&a.setObject("dijit.HomeButton",h,b),h})},"esri/dijit/OverviewMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/html dojo/has dojo/dom-class dojo/dom-style dojo/dnd/Moveable dijit/_Widget dijit/_Templated ../map ../geometry/Point ../geometry/ScreenPoint ../layers/TiledMapServiceLayer ../layers/DynamicMapServiceLayer ../layers/VectorTileLayer ../layers/ArcGISTiledMapServiceLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/ArcGISImageServiceLayer ../layers/OpenStreetMapLayer ../virtualearth/VETiledLayer ../kernel ../config ../domUtils dojo/text!./templates/OverviewMap.html dojo/i18n!../nls/jsapi".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E){h=h([g,e],{declaredClass:"esri.dijit.OverviewMap",widgetsInTemplate:!0,templateString:D,constructor:function(b,c){if(l.mixin(this,E.widgets.overviewMap),b=b||{},!b.map)return void console.error("esri.dijit.OverviewMap: "+this.NLS_noMap);var e={};if(c&&(this._detached=!0,e=d.coords(c,!0)),this.map=b.map,this.baseLayer=b.baseLayer,this.width=b.width||e.w||this.map.width/4,this.height=b.height||e.h||this.map.height/4,this.attachTo=b.attachTo||
"top-right",this.expandFactor=b.expandFactor||2,this.color=b.color||"#000000",this.opacity=b.opacity||.5,this.maximizeButton=!!b.maximizeButton,this.visible=!!b.visible,this.map.loaded)this._initialSetup();else var f=a.connect(this.map,"onLoad",this,function(){a.disconnect(f);f=null;this._initialSetup()});this._detached&&(this.visible=!0);this._maximized=!1},startup:function(){this.inherited(arguments);(!this.domNode.parentNode||9>b("ie")&&"DIV"!==this.domNode.parentNode.nodeName)&&this.map.container.appendChild(this.domNode);
this._detached?(k.set(this._body,"display","block"),k.set(this._controllerDiv,"display","none"),k.set(this._maximizerDiv,"display","none"),this.map.loaded?this._initialize():a.connect(this.map,"onLoad",this,this._initialize)):("bottom"===this.attachTo.split("-")[0]&&this.domNode.insertBefore(this._maximizerDiv,this._controllerDiv),this.maximizeButton||f.add(this._maximizerDiv,"ovwDisabledButton"),f.add(this.domNode,{"top-left":"ovwTL","top-right":"ovwTR","bottom-left":"ovwBL","bottom-right":"ovwBR"}[this.attachTo]),
f.add(this._controllerDiv,"ovwShow"),f.add(this._maximizerDiv,"ovwMaximize"),this.visible&&this.map.loaded&&(this.visible=!1,this.show()));k.set(this._focusDiv,"opacity",this.opacity)},destroy:function(){this._deactivate();this.overviewMap&&this.overviewMap.destroy();this.overviewMap=this.baseLayer=null;this.inherited(arguments)},resize:function(a){!a||0>=a.w||0>=a.h||this._resize(a.w,a.h)},show:function(){if(!this.visible){var a=this._controllerDiv;a.title=this.NLS_hide;f.remove(a,"ovwShow");f.add(a,
"ovwHide");C.show(this._body);C.show(this._maximizerDiv);this._initialize();this.visible=!0}},hide:function(){if(this.visible){var a=this._controllerDiv;a.title=this.NLS_show;f.remove(a,"ovwHide");f.add(a,"ovwShow");this._maximized&&this._maximizeHandler();C.hide(this._body);C.hide(this._maximizerDiv);this._deactivate();this.visible=!1}},_initialSetup:function(){if(this._mainMapLayer=this.map.getLayer(this.map.layerIds[0]),!this._mainMapLayer)return void console.error("esri.dijit.OverviewMap: "+this.NLS_noLayer);
var b=this.baseLayer||this._mainMapLayer,c=this.map.spatialReference,d=b.spatialReference;if(d.wkid!==c.wkid&&d.wkt!==c.wkt)return void console.error("esri.dijit.OverviewMap: "+this.NLS_invalidSR);c=b.declaredClass;if(b instanceof r)if(-1!==c.indexOf("VETiledLayer"))this.baseLayer=new z({resourceInfo:b.getResourceInfo(),culture:b.culture,mapStyle:b.mapStyle,bingMapsKey:b.bingMapsKey});else if(-1!==c.indexOf("OpenStreetMapLayer"))this.baseLayer=new y({tileServers:b.tileServers});else if(-1!==c.indexOf("WebTiledLayer")){var c=
b.initialExtent,d=b.fullExtent,e=b.tileInfo;this.baseLayer=new b.constructor(b.urlTemplate,{initialExtent:c&&new c.constructor(c.toJson()),fullExtent:d&&new d.constructor(d.toJson()),tileInfo:e&&new e.constructor(e.toJson()),tileServers:b.tileServers&&b.tileServers.slice(0)})}else this.baseLayer=new t(b.url,{resourceInfo:b.getResourceInfo()});else if(b instanceof u)-1!==c.indexOf("ArcGISImageServiceLayer")?this.baseLayer=new x(b.url):(this.baseLayer=new w(b.url),this.baseLayer.setImageFormat("png24"));
else{if(!(b instanceof v))return void console.error("esri.dijit.OverviewMap: "+this.NLS_invalidType);b="http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer";"https:"===location.protocol&&(b=b.replace("http:","https:"));this.baseLayer=new t(b,{})}!this._detached&&this.visible&&this._controllerDiv&&(b=function(){this.visible=!1;this.show()},this.baseLayer.loaded?b.call(this):a.connect(this.baseLayer,"onLoad",this,b))},_visibilityHandler:function(){this.visible?this.hide():
this.show()},_maximizeHandler:function(){var a=this._maximizerDiv;this._maximized?(a.title=this.NLS_maximize,f.remove(a,"ovwRestore"),f.add(a,"ovwMaximize"),this._resize(this.width,this.height)):(a.title=this.NLS_restore,f.remove(a,"ovwMaximize"),f.add(a,"ovwRestore"),this._resize(this.map.width,this.map.height));this._maximized=!this._maximized},_resize:function(a,b){k.set(this._body,{width:a+"px",height:b+"px"});var c=B.defaults.map.panDuration,d=this.overviewMap;B.defaults.map.panDuration=0;d&&
(d.resize(!0),d.centerAt(this._focusExtent.getCenter()));B.defaults.map.panDuration=c},_initialize:function(){if(this.overviewMap)this._activate();else{var d,e;9>b("ie")?e=this._body.firstChild:e=this._body.firstElementChild;this.overviewMap=d=new c(e,{slider:!1,showAttribution:!1,logo:!1,lods:this._overviewLods,wrapAround180:this.map.wrapAround180});a.connect(d,"onLoad",this,function(){this._map_resize_override=l.hitch(d,this._map_resize_override);d.disableMapNavigation();this._activate()});d.addLayer(this.baseLayer)}},
_activate:function(){var b=this.map,c=this.overviewMap;this._moveableHandle=new m(this._focusDiv);this._soeConnect=a.connect(b,"onExtentChange",this,this._syncOverviewMap);this._ufoConnect=a.connect(b,"onPan",this,this._updateFocus);this._oecConnect=a.connect(c,"onExtentChange",this,this._ovwExtentChangeHandler);this._opaConnect=a.connect(c,"onPan",this,this._ovwPanHandler);this._ozsConnect=a.connect(c,"onZoomStart",this,function(){C.hide(this._focusDiv)});this._ozeConnect=a.connect(c,"onZoomEnd",
this,function(){C.show(this._focusDiv)});this._omsConnect=a.connect(this._moveableHandle,"onMoveStop",this,this._moveStopHandler);this._syncOverviewMap(b.extent,null,null,null)},_deactivate:function(){a.disconnect(this._soeConnect);a.disconnect(this._ufoConnect);a.disconnect(this._oecConnect);a.disconnect(this._opaConnect);a.disconnect(this._ozsConnect);a.disconnect(this._ozeConnect);a.disconnect(this._omsConnect);this._moveableHandle&&this._moveableHandle.destroy()},_syncOverviewMap:function(a,b,
c,d){return this._suspendPanHandling?void(this._suspendPanHandling=!1):(this._focusExtent=a,void this.overviewMap.setExtent(a.expand(this.expandFactor),!0))},_updateFocus:function(a){this._suspendPanHandling||(this._focusExtent=a,this._drawFocusDiv(a))},_drawFocusDiv:function(a,b){var c=this.overviewMap,d=c.toScreen(new n(a.xmin,a.ymax,c.spatialReference)),e=c.toScreen(new n(a.xmax,a.ymin,c.spatialReference)),c=e.x-d.x,e=e.y-d.y,f=!0;c>this.overviewMap.width&&e>this.overviewMap.height&&(f=!1);k.set(this._focusDiv,
{left:d.x+(b?b.x:0)+"px",top:d.y+(b?b.y:0)+"px",width:c+"px",height:e+"px",display:f?"block":"none"})},_moveStopHandler:function(a){var b=this._moveableHandle.node.style;a=this._focusExtent;var c=this.overviewMap,b=c.toMap(new q(parseInt(b.left,10),parseInt(b.top,10))),d=new n(a.xmin,a.ymax,c.spatialReference);this._focusExtent=a.offset(b.x-d.x,b.y-d.y);this._maximized?this._maximizeHandler():c.centerAt(this._focusExtent.getCenter());this._suspendPanHandling=!0;this.map.setExtent(this._focusExtent)},
_ovwExtentChangeHandler:function(){this._drawFocusDiv(this._focusExtent)},_ovwPanHandler:function(a,b){this._drawFocusDiv(this._focusExtent,b)}});return b("extend-esri")&&l.setObject("dijit.OverviewMap",h,A),h})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(h,l,a,d,b,f,k){f.extend(h,{waiRole:"",waiState:""});return b("dijit._Templated",[l,a],{constructor:function(){k.deprecated(this.declaredClass+
": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin","","2.0")},_processNode:function(a,b){var e=this.inherited(arguments),c=b(a,"waiRole");c&&a.setAttribute("role",c);(c=b(a,"waiState"))&&d.forEach(c.split(/\s*,\s*/),function(b){-1!=b.indexOf("-")&&(b=b.split("-"),a.setAttribute("aria-"+b[0],b[1]))});return e}})})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],
function(h,l,a,d,b){return a("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var a=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);b.parse(a,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(d.hitch(this,
function(a){this._startupWidgets=a;for(var b=0;b<a.length;b++)this._processTemplateNode(a[b],function(a,b){return a[b]},function(a,b,c){return b in a?a.connect(a,b,c):a.on(b,c,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");
}},_processTemplateNode:function(a,b,d){return b(a,"dojoType")||b(a,"data-dojo-type")?!0:this.inherited(arguments)},startup:function(){h.forEach(this._startupWidgets,function(a){a&&!a._started&&a.startup&&a.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"esri/layers/ArcGISImageServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../config ./DynamicMapServiceLayer ./ImageServiceLayerMixin".split(" "),function(h,l,a,d,b,f,k){h=h([f,k],{declaredClass:"esri.layers.ArcGISImageServiceLayer",
constructor:function(a,b){this._initialize(a,b);this.useMapImage=b&&b.useMapImage||!1},refresh:function(a){if(a)this.inherited(arguments);else{var b=this.disableClientCaching;this.disableClientCaching=!0;this.inherited(arguments);this.disableClientCaching=b}},exportMapImage:function(a,d){var e=b.defaults.map,e=l.mixin({size:e.width+","+e.height},this._params,a?a.toJson(this.normalization):{},{f:"json"});delete e._ts;this._exportMapImage(this._url.path+"/exportImage",e,d)}});return a("extend-esri")&&
l.setObject("layers.ArcGISImageServiceLayer",h,d),h})},"esri/layers/ImageServiceLayerMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/json dojo/_base/config dojo/_base/connect dojo/has dojo/io-query ../kernel ../config ../lang ../request ../deferredUtils ../urlUtils ../geometry/Extent ../geometry/Point ../geometry/Polygon ./MosaicRule ./RasterFunction ./DimensionalDefinition ./Raster ./PixelBlock ./pixelFilters/VectorFieldPixelFilter ./rasterFormats/ImageCanvasDecoder ./TimeInfo ./Field ../graphic ../tasks/ImageServiceIdentifyTask ../tasks/ImageServiceIdentifyParameters".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K){h=h(null,{declaredClass:"esri.layers.ImageServiceLayerMixin",_rasterFieldPrefix:"Raster.",_renderingRuleFieldSubPrefix:"ServicePixelValue.",_eventMap:{"rendering-change":!0,"mosaic-rule-change":!0,"spatial-reference-change":!0},constructor:function(a,b){this.useMapTime=b&&b.hasOwnProperty("useMapTime")?!!b.useMapTime:!0},_initialize:function(a,b){this._url=u.urlToObject(a);this.raster=new A(this._url.path);this.infoTemplate=b&&
b.infoTemplate;var c=b&&b.imageServiceParameters;this.format=c&&c.format;this.compressionTolerance=c&&c.compressionTolerance?c.compressionTolerance:.01;this.interpolation=c?c.interpolation:null;this.compressionQuality=c?c.compressionQuality:null;this.bandIds=c?c.bandIds:null;this.mosaicRule=c?c.mosaicRule:null;this.renderingRule=c?c.renderingRule:null;this.useMapDimensionValue=b&&b.hasOwnProperty("useMapDimensionValue")?!!b.useMapDimensionValue:!0;this.activeMapDimensions=b&&b.activeMapDimensions;
this._params=l.mixin({},this._url.query,{f:"image",interpolation:this.interpolation,format:this.format,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null},c?c.toJson():{});this.pixelFilter=b&&b.pixelFilter;this.originalPixelData=this.pixelData=null;this.hasDataChanged=!0;this._requestDataHandler=l.hitch(this,this._requestDataHandler);this._requestDataErrorHandler=l.hitch(this,this._requestDataErrorHandler);this._rasterReadPromise=null;this._initLayer=l.hitch(this,
this._initLayer);this._queryVisibleRastersHandler=l.hitch(this,this._queryVisibleRastersHandler);this._visibleRasters=[];this._rasterAttributeTableFields=[];this._rasterAttributeTableFeatures=[];this._renderingRuleAttributeTable={};this._useRenderingRuleAttributeTable=!1;this._loadCallback=b&&b.loadCallback;(c=b&&b.resourceInfo)?this._initLayer(c):q({url:this._url.path,content:l.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});this.registerConnectEvents()},
disableClientCaching:!1,_initLayer:function(a,b){if(null!==a&&void 0!==a){this._findCredential();(this.credential&&this.credential.ssl||a&&a._ssl)&&this._useSSL();var c=this.minScale,d=this.maxScale;l.mixin(this,a);this.minScale=c;this.maxScale=d;this.initialExtent=this.fullExtent=this.extent=new v(a.extent);this.spatialReference=this.initialExtent.spatialReference;this.pixelSizeX=parseFloat(this.pixelSizeX);this.pixelSizeY=parseFloat(this.pixelSizeY);for(var e=this.minValues,f=this.maxValues,g=this.meanValues,
k=this.stdvValues,m=this.bands=[],c=0,d=this.bandCount;d>c;c++)m[c]={min:e[c],max:f[c],mean:g[c],stddev:k[c]};this.timeInfo=(c=this.timeInfo)&&c.timeExtent?new E(c):null;d=this.fields=[];if(e=a.fields)for(c=0;c<e.length;c++)d.push(new F(e[c]));(this.version=a.currentVersion,this.version)||(this.version="fields"in a||"objectIdField"in a||"timeInfo"in a?10:9.3);n.isDefined(a.minScale)&&!this._hasMin&&this.setMinScale(a.minScale);n.isDefined(a.maxScale)&&!this._hasMax&&this.setMaxScale(a.maxScale);c=
{};(a.defaultMosaicMethod?(c.method=a.defaultMosaicMethod,c.operation=a.mosaicOperator,c.sortField=a.sortField,c.sortValue=a.sortValue):c.method=x.METHOD_NONE,this.defaultMosaicRule=new x(c),this.defaultMosaicRule.ascending=!0,this._useRenderingRuleAttributeTable=10<this.version&&"esriImageServiceDataTypeThematic"===this.serviceDataType&&!this.hasRasterAttributeTable,this._setDefaultRenderingRule(!0),this._isScientificData()&&(!this.mosaicRule||this.mosaicRule&&!this.mosaicRule.multidimensionalDefinition)&&
this._setDefaultMultidimensionalDefinition(!0),10<this.version&&this.hasRasterAttributeTable)&&this.getRasterAttributeTable().then(l.hitch(this,function(a){a&&a.features&&0<a.features.length&&(this._rasterAttributeTableFeatures=l.clone(a.features));a&&a.fields&&0<a.fields.length&&(this._rasterAttributeTableFields=l.clone(a.fields))}));this._isVectorData()&&!n.isDefined(this.pixelFilter)&&(this.vectorFieldPixelFilter=new C,this.vectorFieldPixelFilter.isDataUV="esriImageServiceDataTypeVector-UV"===
this.serviceDataType,this.pixelFilter=this.vectorFieldPixelFilter.computeMagnitudeAndDirection,this.getKeyProperties().then(l.hitch(this,this._setFlowRepresentation)));this.loaded=!0;this._setDefaultFilter();this.onLoad(this);(c=this._loadCallback)&&(delete this._loadCallback,c(this))}},getKeyProperties:function(){var b=this._url.path+"/keyProperties",c=new a(r._dfdCanceller);10<this.version?(c._pendingDfd=q({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),c._pendingDfd.then(function(a){c.callback(a)},
function(a){c.errback(a)})):(b=Error("Layer does not have key properties"),b.log=f.isDebug,c.errback(b));return c},getRasterAttributeTable:function(c){var d=this._url.path+"/rasterAttributeTable",e=new a(r._dfdCanceller),g={f:"json"},k=this.hasRasterAttributeTable;(c&&c.renderingRule&&(g.renderingRule=b.toJson(c.renderingRule.toJson()),k=!0),10<this.version&&k)?(e._pendingDfd=q({url:d,content:g,handleAs:"json",callbackParamName:"callback"}),e._pendingDfd.then(function(a){e.callback(a)},function(a){e.errback(a)})):
(c=Error("Layer does not support raster attribute table"),c.log=f.isDebug,e.errback(c));return e},_getRenderingRuleAttributeTable:function(b){var c=new a(r._dfdCanceller);if(!b||!b.renderingRule)return c.errback(Error("Rendering rule is not specified")),c;b=b.renderingRule;var d=b.functionName;return this._renderingRuleAttributeTable&&d&&this._renderingRuleAttributeTable.hasOwnProperty(d)?c.resolve(this._renderingRuleAttributeTable[d]):c=this.getRasterAttributeTable({renderingRule:b}).then(l.hitch(this,
function(a){var b;return a&&a.features&&a.features.length&&a.fields&&a.fields.length&&(b={features:l.clone(a.features),fields:l.clone(a.fields)},d&&(this._renderingRuleAttributeTable[d]=b)),b})),c},_getRasterAttributeTableFeatures:function(){var b=new a;return this._rasterAttributeTableFeatures&&0<this._rasterAttributeTableFeatures.length?(b.resolve(this._rasterAttributeTableFeatures),b):10<this.version&&this.hasRasterAttributeTable?(b=this.getRasterAttributeTable(),b.then(l.hitch(this,function(a){a&&
a.features&&0<a.features.length&&(this._rasterAttributeTableFeatures=l.clone(a.features))})),b):(b.resolve(this._rasterAttributeTableFeatures),b)},_getRenderingRuleAttributeTableFeatures:function(b){b=b&&b.renderingRule;return b?this._getRenderingRuleAttributeTable({renderingRule:b}).then(function(a){return a&&a.features}):(b=new a,b.errback(Error("Rendering rule is not specified")),b)},getCustomRasterFields:function(a){var b=a?a.rasterAttributeTableFieldPrefix:this._rasterFieldPrefix;a=10.3<=this.version?
"esriFieldTypeDouble":"esriFieldTypeString";var c={name:this._rasterFieldPrefix+"ItemPixelValue",alias:"Item Pixel Value",domain:null,editable:!1,length:50,type:a},e={name:this._rasterFieldPrefix+"ServicePixelValue",alias:"Service Pixel Value",domain:null,editable:!1,length:50,type:a},f={name:this._rasterFieldPrefix+"ServicePixelValue.Raw",alias:"Raw Service Pixel Value",domain:null,editable:!1,length:50,type:"esriFieldTypeDouble"},g=this.fields?l.clone(this.fields):[];a=g.length;(g[a]=e,10.4<=this.version&&
"esri.layers.ArcGISImageServiceLayer"===this.declaredClass&&(!this.rasterFunctionInfos||!this.rasterFunctionInfos.length||this._isRasterFunctionInfoAvailable("none"))&&(a++,g[a]=f),(this.capabilities&&-1<this.capabilities.toLowerCase().indexOf("catalog")||this.fields&&0<this.fields.length)&&(a++,g[a]=c),!n.isDefined(this.pixelFilter)||"esriImageServiceDataTypeVector-UV"!==this.serviceDataType&&"esriImageServiceDataTypeVector-MagDir"!==this.serviceDataType)||(c={name:this._rasterFieldPrefix+"Magnitude",
alias:"Magnitude",domain:null,editable:!1,type:"esriFieldTypeDouble"},e={name:this._rasterFieldPrefix+"Direction",alias:"Direction",domain:null,editable:!1,type:"esriFieldTypeDouble"},a++,g[a]=c,a++,g[a]=e);a=this._rasterAttributeTableFields;c=this.renderingRule&&this.renderingRule.functionName;if(c&&this._renderingRuleAttributeTable&&this._renderingRuleAttributeTable.hasOwnProperty(c)&&(a=this._renderingRuleAttributeTable[c].fields),a&&0<a.length)a=d.filter(a,function(a){return"esriFieldTypeOID"!==
a.type&&"value"!==a.name.toLowerCase()}),a=d.map(a,function(a){var c=l.clone(a);return c.name=b+a.name,c}),g=g.concat(a);var k=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;return 10.4<=this.version&&this.rasterFunctionInfos&&d.forEach(this.rasterFunctionInfos,function(a){a&&a.name&&"none"!==a.name.toLowerCase()&&(a={name:k+a.name.replace(/ /gi,"_"),alias:a.name,domain:null,editable:!1,type:"esriFieldTypeDouble"},g.push(a))}),g},_prepareGetImageParameters:function(a,c,d,e){e=n.isDefined(e)?
e:this._params;var f=a.spatialReference.wkid||b.toJson(a.spatialReference.toJson(!1));delete e._ts;l.mixin(e,{bbox:a.xmin+","+a.ymin+","+a.xmax+","+a.ymax,imageSR:f,bboxSR:f,size:c+","+d},this.disableClientCaching?{_ts:(new Date).getTime()}:{});delete e.compressionTolerance;e.format&&"LERC"===e.format.toUpperCase()&&(e.compressionTolerance=this.compressionTolerance);e.token=this._getToken()},getImageUrl:function(a,b,d,e,f){f=n.isDefined(f)?f:this._params;this._prepareGetImageParameters(a,b,d,f);a=
l.clone(f);this._cleanupRequestParams(a);b=this._url.path+"/exportImage?";d=u.addProxy(b+g.objectToQuery(l.mixin(a,{f:"image"})));var k=a.token;d.length>c.defaults.io.postLength||this.useMapImage?this._jsonRequest=q({url:b,content:l.mixin(a,{f:"json"}),callbackParamName:"callback",load:function(a,b){var c=a.href;k&&(c+=-1===c.indexOf("?")?"?token\x3d"+k:"\x26token\x3d"+k);e(u.addProxy(c))},error:this._errorHandler}):e(d)},onRenderingChange:function(){},onMosaicRuleChange:function(){},setInterpolation:function(a,
b){this.interpolation=this._params.interpolation=a;b||this.refresh(!0)},setCompressionQuality:function(a,b){this.compressionQuality=this._params.compressionQuality=a;b||this.refresh(!0)},setCompressionTolerance:function(a,b){this.compressionTolerance=a;b||this.refresh(!0)},setBandIds:function(a,b){var c=!1;this.bandIds!==a&&(c=!0);this.bandIds=a;this._params.bandIds=a.join(",");c&&!b&&this.onRenderingChange();b||this.refresh(!0)},setDefaultBandIds:function(a){this.bandIds=this._params.bandIds=null;
a||this.refresh(!0)},setDisableClientCaching:function(a){this.disableClientCaching=a},setMosaicRule:function(a,c){var d=!1;this.mosaicRule!==a&&(d=!0);this.mosaicRule=a;this._params.mosaicRule=b.toJson(a.toJson());d&&!c&&this.onMosaicRuleChange();c||this.refresh(!0)},setRenderingRule:function(a,c){var d=!1;this.renderingRule!==a&&(d=!0);this.renderingRule=a;this._params.renderingRule=a?b.toJson(a.toJson()):null;this._useRenderingRuleAttributeTable&&this._getRenderingRuleAttributeTable({renderingRule:a});
d&&this.onRenderingChange();this._setDefaultFilter();c||this.refresh(!0)},setImageFormat:function(a,b){this.format=this._params.format=a;this._setDefaultFilter();b||this.refresh(!0)},setInfoTemplate:function(a){this.infoTemplate=a},setDefinitionExpression:function(a,b){var c=this.mosaicRule?this.mosaicRule.toJson():{};this.mosaicRule||(this.defaultMosaicRule?c=this.defaultMosaicRule.toJson():c.method=x.METHOD_NONE);c.where=a;c=new x(c);return this.setMosaicRule(c,b),this},getDefinitionExpression:function(){return this.mosaicRule?
this.mosaicRule.where:null},setPixelFilter:function(a){this.pixelFilter=a;this._isDefaultPixelFilter=!1},getPixelData:function(a){return a?(this._useBrowserDecoding()&&(this.originalPixelData={pixelBlock:this._getPixelBlockFromCanvas(this._context,this._map.width,this._map.height),extent:this._map.extent}),this.originalPixelData):this.pixelData},redraw:function(){this.hasDataChanged=!1;this._setPixelData(this.originalPixelData)},queryVisibleRasters:function(b,c,e,f){var g=this._map,k=r._fixDfd(new a(r._dfdCanceller));
this._visibleRasters=[];var m,h,n=!0,q=this.infoTemplate?this.infoTemplate.info:null,u=q?l.clone(this.infoTemplate.info.fieldInfos):null;if(c=c||{},q&&this.infoTemplate.info.mediaInfos&&this.infoTemplate.info.mediaInfos.length){var v=[];d.forEach(this.infoTemplate.info.mediaInfos,function(a){v=v.concat(a&&a.value&&a.value.fields||[])});v.length&&d.forEach(u,function(a){a&&-1<v.indexOf(a.fieldName)&&(a.visible=!0)})}if(u&&0<u.length)for(n=!1,m=0;m<u.length;m++)if(h=u[m],h&&h.fieldName.toLowerCase()!==
this._rasterFieldPrefix.toLowerCase()+"servicepixelvalue"&&(h.visible||q.title&&-1<q.title.toLowerCase().indexOf(h.fieldName.toLowerCase()))){n=!0;break}var w=(h=this._removeVisualizationStretchFunction(this.renderingRule))&&h.functionName,x=[];if(10.4<=this.version){var C=!1;if(this.rasterFunctionInfos&&u){var A=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;d.forEach(this.rasterFunctionInfos,function(a){var b=A+a.name.replace(/ /gi,"_");d.some(u,function(a){return a.visible&&a.fieldName===
b})&&(C=C||w&&w===a.name,x.push(new y({rasterFunction:a.name})))})}h&&!C&&x.push(h)}m=new K;if(m.geometry=b.geometry,m.returnGeometry=this._map.spatialReference.equals(this.spatialReference),m.returnCatalogItems=n,m.timeExtent=b.timeExtent,m.mosaicRule=this.mosaicRule||null,m.renderingRule=10.4>this.version&&h||null,m.renderingRules=x||null,g)b=new t((g.extent.xmax-g.extent.xmin)/g.width,(g.extent.ymax-g.extent.ymin)/g.height,g.extent.spatialReference),m.pixelSize=b;c.requestParams=m;var D=this;b=
new G(this.url);return(k._pendingDfd=b.execute(m)).addCallbacks(function(a){D._queryVisibleRastersHandler(a,c,e,f,k)},function(a){D._resolve([a],null,f,k,!0)}),k},_queryVisibleRastersHandler:function(a,c,e,f,g){function k(){var a,b,f,r,q,u,w,C,y,A,D,E=this.getCustomRasterFields(c),H=this._getDomainFields(E),F=c?c.returnDomainValues:!1,J=c&&c.rasterAttributeTableFieldPrefix;this._useRenderingRuleAttributeTable&&this.renderingRule?(A=this._getRenderingRuleAttributeTableFeatures({renderingRule:this.renderingRule}),
D=t):A=this._getRasterAttributeTableFeatures();A.then(l.hitch(this,function(c){for(a=0;a<h.length;a++){if(ka=h[a],ka.setInfoTemplate(this.infoTemplate),ka._layer=this,t){if(y=t.replace(/ /gi,"").split(","),b=t,f=y,m&&m.length>=a&&(b=m[a].replace(/ /gi,", "),f=m[a].split(" ")),ka.attributes[this._rasterFieldPrefix+"ItemPixelValue"]=f,ka.attributes[this._rasterFieldPrefix+"ServicePixelValue"]=y,x&&(ka.attributes[this._rasterFieldPrefix+"ServicePixelValue.Raw"]=x.replace(/ /gi,"").split(",")),this.pixelFilter){var k=
new B({height:1,width:1,pixelType:"F32",pixels:[],statistics:[]});d.forEach(f,function(a){k.addData({pixels:[a],statistics:{minValue:a,maxValue:a,noDataValue:null}})});this.pixelFilter({pixelBlock:k,extent:new v(0,0,0,0,this._map.spatialReference)});("esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType)&&(ka.attributes[this._rasterFieldPrefix+"Magnitude"]=k.pixels[0][0],ka.attributes[this._rasterFieldPrefix+"Direction"]=k.pixels[1][0])}d.forEach(z,
function(a){ka.attributes[a.name]=a.value});var A=D||b;if(c&&0<c.length&&(r=d.filter(c,function(a){return a&&a.attributes?a.attributes.hasOwnProperty("Value")?a.attributes.Value==A:a.attributes.VALUE==A:void 0}),0<r.length&&(q=l.clone(r[0]),J&&q))){C={};for(u in q.attributes)q.attributes.hasOwnProperty(u)&&(w=J+u,C[w]=q.attributes[u]);q.attributes=C;ka.attributes=l.mixin(ka.attributes,q.attributes)}}F&&H&&0<H.length&&d.forEach(H,function(a){if(a){var b=ka.attributes[a.name];n.isDefined(b)&&(b=this._getDomainValue(a.domain,
b),n.isDefined(b)&&(ka.attributes[a.name]=b))}},this);sa.push(ka);this._visibleRasters.push(ka)}this._resolve([sa,null,!0],null,e,g)}))}var m,h,r,u,t=a.value,x=a.value,C=0,y=0,A=this,D=this.objectIdField,z=[];f=c.requestParams.renderingRules;var E=a.processedValues,F=this.renderingRule&&b.toJson(this._removeVisualizationStretchFunction(this.renderingRule).toJson());if(f&&E&&f.length===E.length){var G=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;d.forEach(f,function(a,c){if(a.functionName){var d=
{name:G+a.functionName.replace(/ /gi,"_"),value:E[c].replace(/ /gi,"").split(",")};z.push(d);F&&F===b.toJson(a.toJson())&&(t=E[c])}})}if(f=this.infoTemplate&&this.infoTemplate.info&&this.infoTemplate.info.layerOptions&&this.infoTemplate.info.layerOptions.hasOwnProperty("showNoDataRecords")?this.infoTemplate.info.layerOptions.showNoDataRecords:!0,a.catalogItems){var K,ca,ja=0,la=a.catalogItems.features.length;u=0;h=Array(la);m=Array(la);r=Array(la);for(C=0;la>C;C++)-1<a.properties.Values[C].toLowerCase().indexOf("nodata")&&
u++;K=la-u;for(C=0;la>C;C++)u=!0,-1<a.properties.Values[C].toLowerCase().indexOf("nodata")?(ca=K++,f||(u=!1,h.length--,m.length--,r.length--)):ca=ja++,u&&(h[ca]=a.catalogItems.features[C],m[ca]=a.properties.Values[C],r[ca]=h[ca].attributes[D])}this._visibleRasters=[];var ka;a=-1<t.toLowerCase().indexOf("nodata");(a&&!f&&(h=[],m=[],r=[]),!t||h||a)||(D="ObjectId",h=[],ka=new H(new v(this.fullExtent),null,{ObjectId:0}),h.push(ka));var sa=[];return h?void(!this._map.spatialReference.equals(this.spatialReference)&&
r&&0<r.length?q({url:this._url.path+"/query",content:{f:"json",objectIds:r.join(","),returnGeometry:!0,outSR:b.toJson(A._map.spatialReference.toJson()),outFields:D},handleAs:"json",callbackParamName:"callback",load:function(a){if(0===a.features.length)return void A._resolve([sa,null,null],null,e,g);for(C=0;C<a.features.length;C++)for(y=0;y<h.length;y++)h[y].attributes[D]==a.features[C].attributes[D]&&(h[y].geometry=new w(a.features[C].geometry),h[y].geometry.setSpatialReference(A._map.spatialReference));
k.call(A)},error:function(a){A._resolve([sa,null,null],null,e,g)}}):k.call(this)):void this._resolve([sa,null,null],null,e,g)},getVisibleRasters:function(){var a,b=this._visibleRasters,c=[];for(a in b)b.hasOwnProperty(a)&&c.push(b[a]);return c},_getDomainFields:function(a){if(a){var b=[];return d.forEach(a,function(a){if(a.domain){var c={};c.name=a.name;c.domain=a.domain;b.push(c)}}),b}},_getDomainValue:function(a,b){if(a&&a.codedValues){var c;return d.some(a.codedValues,function(a){return a.code===
b?(c=a.name,!0):!1}),c}},_requestData:function(a,b,c){this._rasterReadPromise&&this._rasterReadPromise.cancel();a=l.clone(a);var d=a._normalize(!0);this._prepareGetImageParameters(d,b,c);b=l.clone(this._params);this._cleanupRequestParams(b);b.extent=a;b.format=b.format||(10.3<=this.version?"lerc":"jpgpng");"lerc"===b.format.toLowerCase()&&!b.lercVersion&&10.5<=this.version&&(b.lercVersion=2);c=null;this._useBrowserDecoding()&&(c=new D({ctx:this._context}));b={imageServiceParameters:b,nBands:Math.min(this.bandCount,
3),pixelType:this.pixelType,decodeFunc:c?l.hitch(c,"decode"):null};this._rasterReadPromise=this.raster.read(b,this._requestDataHandler,this._requestDataErrorHandler)},_requestDataHandler:function(a){this._rasterReadPromise&&this._rasterReadPromise.isCanceled()||(this.originalPixelData=a,this.hasDataChanged=!0,this._setPixelData(a))},_setPixelData:function(a){a=this._clonePixelData(a);this.pixelFilter&&this.pixelFilter(a);this.pixelData=a;this._rasterReadPromise&&this._rasterReadPromise.isCanceled()||
(this._drawPixelData(),this._rasterReadPromise=null)},_clonePixelData:function(a){if(null===a||void 0===a)return a;var b={};a.extent&&(b.extent=l.clone(a.extent));a=a.pixelBlock;return null===a||void 0===a?b:(b.pixelBlock=a.clone(),b)},_setDefaultFilter:function(){},_getPixelBlockFromCanvas:function(a,b,c){for(var d,e,f=a.getImageData(0,0,b,c).data,g=b*c,k=0,m=0,h=new Uint8Array(g),n=new Uint8Array(g),l=new Uint8Array(g),r=new Uint8Array(g),q=1/0,u=1/0,t=1/0,v=-(1/0),w=-(1/0),x=-(1/0),k=0;g>k;k++)a=
f[m++],d=f[m++],e=f[m++],q=a>q?q:a,v=v>a?v:a,u=d>u?u:d,w=w>d?w:d,t=e>t?t:e,x=x>e?x:e,h[k]=a,n[k]=d,l[k]=e,r[k]=1&f[m++];return new B({width:b,height:c,pixels:[h,n,l],pixelType:"U8",mask:r,statistics:[{minValue:q,maxValue:v},{minValue:u,maxValue:w},{minValue:t,maxValue:x}]})},_useBrowserDecoding:function(){return(void 0===this.pixelFilter||null===this.pixelFilter)&&("jpeg"===this.format.toLowerCase()||"jpg"===this.format.toLowerCase()||-1<this.format.toLowerCase().indexOf("png"))},getMultidimensionalInfo:function(){var b=
this._url.path+"/multiDimensionalInfo",c=new a(r._dfdCanceller);if(this._multidimensionalInfo)return c.resolve(this._multidimensionalInfo),c;10.3<=this.version&&this.hasMultidimensions?(c._pendingDfd=q({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),c._pendingDfd.then(l.hitch(this,function(a){this._multidimensionalInfo=a.multidimensionalInfo;c.callback(a.multidimensionalInfo)}),function(a){c.errback(a)})):(b=Error("Layer does not support multidimensional info"),b.log=f.isDebug,
c.errback(b));return c},getDefaultMultidimensionalDefinition:function(){var b,c,d,e=[],f=new a(r._dfdCanceller);return this._defaultMultidimensionalDefinition?(f.resolve(this._defaultMultidimensionalDefinition),f):(f._pendingDfd=this.getMultidimensionalInfo(),f._pendingDfd.then(l.hitch(this,function(a){b=a;c=b.variables[0].dimensions;for(d in c)c.hasOwnProperty(d)&&(c[d].hasRanges?e.push(new z({variableName:"",dimensionName:c[d].name,isSlice:!1,values:[c[d].values[0]]})):e.push(new z({variableName:"",
dimensionName:c[d].name,isSlice:!0,values:[c[d].extent[0]]})));this._defaultMultidimensionalDefinition=e;f.callback(e)}),function(a){f.errback(a)}),f)},_setDefaultMultidimensionalDefinition:function(a){var b,c={};this.getDefaultMultidimensionalDefinition().then(l.hitch(this,function(d){b=d;0<b.length&&(this.mosaicRule?(c=l.clone(this.mosaicRule),c.multidimensionalDefinition=b):this.defaultMosaicRule?(c=l.clone(this.defaultMosaicRule),c.multidimensionalDefinition=b):c=new x({multidimensionalDefinition:b}),
this.setMosaicRule(c,a))}))},_setDefaultRenderingRule:function(a){var b={};if(!this.renderingRule&&"esri.layers.ArcGISImageServiceVectorLayer"!==this.declaredClass&&this.rasterFunctionInfos&&this.rasterFunctionInfos.length&&"none"!==this.rasterFunctionInfos[0].name.toLowerCase())b.rasterFunction=this.rasterFunctionInfos[0].name;else if(!this.renderingRule&&"esri.layers.ArcGISImageServiceVectorLayer"===this.declaredClass&&10.3<this.version){var c="esriImageServiceDataTypeVector-UV"===this.serviceDataType?
7:10;b.rasterFunction="Resample";b.rasterFunctionArguments={ResamplingType:c,InputCellSize:{x:this.pixelSizeX,y:this.pixelSizeY}}}b.hasOwnProperty("rasterFunction")&&(this.defaultRenderingRule=new y(b),this.setRenderingRule(this.defaultRenderingRule,a))},_cleanupRequestParams:function(a){if(!a)return a;if(a.time&&a.mosaicRule){var c=new x(b.fromJson(a.mosaicRule));if(c&&c.multidimensionalDefinition&&0<c.multidimensionalDefinition.length){var e=d.filter(c.multidimensionalDefinition,function(a){return"StdTime"!==
a.dimensionName});c.multidimensionalDefinition=e;a.mosaicRule=b.toJson(c.toJson())}}var f,c="displayOnPan drawMode styling id opacity visible resourceInfo useMapDimensionValue extent".split(" ");for(f in c)a.hasOwnProperty(c[f])&&delete a[c[f]];return a},_removeVisualizationStretchFunction:function(a){var b=a&&a.functionName;if(!b||"stretch"!==b.toLowerCase())return a;var c=a.functionArguments.Raster;return c&&c.functionName&&d.some(this.rasterFunctionInfos,function(a){return c.functionName===a.name})?
c:a},_isScientificData:function(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType||"esriImageServiceDataTypeScientific"===this.serviceDataType},_isVectorData:function(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType},_isRasterFunctionInfoAvailable:function(a){return d.some(a&&(this.rasterFunctionInfos||[]),function(b){return b&&b.name&&
b.name.toLowerCase()===a.toLowerCase()})},_createPixelData:function(a){a=new B({width:2,height:2,pixels:a,pixelType:this.pixelType,statistics:a});var b=this.fullExtent.getCenter(),b=new v(b.x,b.y,b.x+this.pixelSizeX,b.y+this.pixelSizeY,this.spatialReference);return{pixelBlock:a,extent:b}},_resolve:function(a,b,c,d,e){b&&this[b].apply(this,a);c&&c.apply(null,a);d&&r._resDfd(d,a,e)},_toggleTime:function(){var a=this._map;this.timeInfo&&this.useMapTime&&a&&!this.suspended?(this._timeConnect||(this._timeConnect=
k.connect(a,"onTimeExtentChange",this,this._onTimeExtentChangeHandler)),this._setTime(a.timeExtent)):(k.disconnect(this._timeConnect),this._timeConnect=null,this._setTime(null))},setUseMapTime:function(a,b){this.useMapTime=a;this._toggleTime();!b&&this._map&&this.refresh(!0)},_setTime:function(a){this._params&&(this._params.time=a?a.toJson().join(","):null)},_onTimeExtentChangeHandler:function(a){this.suspended||(this._setTime(a),this.refresh(!0))},handleSpatialReferenceChange:function(){this.onSpatialReferenceChange()}});
return m("extend-esri")&&l.setObject("layers.ImageServiceLayerMixin",h,e),h})},"esri/layers/MosaicRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../geometry/Point".split(" "),function(h,l,a,d,b,f){var k=h(null,{declaredClass:"esri.layers.MosaicRule",method:null,where:null,sortField:null,sortValue:null,ascending:!1,lockRasterIds:null,viewpoint:null,objectIds:null,operation:null,multidimensionalDefinition:[],constructor:function(a){l.isObject(a)&&(l.mixin(this,
a),a.mosaicMethod&&(this.method=a.mosaicMethod),this.method&&"esri"!==this.method.toLowerCase().substring(0,4)&&(this.method=this._getMethodEnum(this.method)),a.mosaicOperation&&(this.operation=a.mosaicOperation),this.operation&&"MT_"!==this.operation.toUpperCase().substring(0,3)&&(this.operation=this._getOperatorEnum(this.operation)),a.fids&&(this.objectIds=a.fids),a.viewpoint&&(this.viewpoint=new f(a.viewpoint)),this.multidimensionalDefinition=a.multidimensionalDefinition||[])},toJson:function(){var a=
null,d=this.multidimensionalDefinition?this.multidimensionalDefinition.length:0;if(d)for(var a=[],e=0;d>e;e++)a.push("esri.layers.DimensionalDefinition"===this.multidimensionalDefinition[e].declaredClass?this.multidimensionalDefinition[e].toJson():this.multidimensionalDefinition[e]);a={mosaicMethod:this.method,where:this.where,sortField:this.sortField,sortValue:this.sortValue,ascending:this.ascending,lockRasterIds:this.lockRasterIds,viewpoint:this.viewpoint?this.viewpoint.toJson():null,fids:this.objectIds,
mosaicOperation:this.operation,multidimensionalDefinition:a};return b.filter(a,function(a){return null!==a?!0:void 0})},_getMethodEnum:function(a){if(a){var b=k.METHOD_NONE;switch(a.toLowerCase()){case "byattribute":b=k.METHOD_ATTRIBUTE;break;case "center":b=k.METHOD_CENTER;break;case "lockraster":b=k.METHOD_LOCKRASTER;break;case "nadir":b=k.METHOD_NADIR;break;case "northwest":b=k.METHOD_NORTHWEST;break;case "seamline":b=k.METHOD_SEAMLINE;break;case "viewpoint":b=k.METHOD_VIEWPOINT}return b}},_getOperatorEnum:function(a){if(a)switch(a.toLowerCase()){case "first":return k.OPERATION_FIRST;
case "last":return k.OPERATION_LAST;case "max":return k.OPERATION_MAX;case "min":return k.OPERATION_MIN;case "blend":return k.OPERATION_BLEND;case "mean":return k.OPERATION_MEAN;case "sum":return k.OPERATION_SUM}}});return l.mixin(k,{METHOD_NONE:"esriMosaicNone",METHOD_CENTER:"esriMosaicCenter",METHOD_NADIR:"esriMosaicNadir",METHOD_VIEWPOINT:"esriMosaicViewpoint",METHOD_ATTRIBUTE:"esriMosaicAttribute",METHOD_LOCKRASTER:"esriMosaicLockRaster",METHOD_NORTHWEST:"esriMosaicNorthwest",METHOD_SEAMLINE:"esriMosaicSeamline",
OPERATION_FIRST:"MT_FIRST",OPERATION_LAST:"MT_LAST",OPERATION_MIN:"MT_MIN",OPERATION_MAX:"MT_MAX",OPERATION_MEAN:"MT_MEAN",OPERATION_BLEND:"MT_BLEND",OPERATION_SUM:"MT_SUM"}),a("extend-esri")&&l.setObject("layers.MosaicRule",k,d),k})},"esri/layers/RasterFunction":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(h,l,a,d,b){var f=h(null,{declaredClass:"esri.layers.RasterFunction",functionName:null,arguments:null,functionArguments:null,variableName:null,
outputPixelType:null,constructor:function(a){if(l.isObject(a)){var b,d=0;if(this.functionName=a.rasterFunction,this.functionArguments=l.clone(a.rasterFunctionArguments||a.arguments),l.mixin(this,a),b=this.functionArguments,b&&(b.Raster=this._toRasterFunction(b.Raster),b.Raster2=this._toRasterFunction(b.Raster2),b.DEM=this._toRasterFunction(b.DEM),b.FillRaster=this._toRasterFunction(b.FillRaster),b.Rasters&&b.Rasters.length))for(d=0;d<b.Rasters.length;d++)b.Rasters[d]=this._toRasterFunction(b.Rasters[d])}},
_toRasterFunction:function(a){return a&&(a.rasterFunction||a.functionName)?new f(a):a},_rfToJson:function(a){return a&&"esri.layers.RasterFunction"===a.declaredClass&&(a=a.toJson()),a},toJson:function(){var a=l.clone(this.functionArguments||this.arguments);if(a&&(a.Raster=this._rfToJson(a.Raster),a.Raster2=this._rfToJson(a.Raster2),a.DEM=this._rfToJson(a.DEM),a.FillRaster=this._rfToJson(a.FillRaster),a.Rasters&&a.Rasters.length)){var d,f=[];for(d=0;d<a.Rasters.length;d++)f.push(this._rfToJson(a.Rasters[d]));
a.Rasters=f}return b.filter({rasterFunction:this.functionName,rasterFunctionArguments:a,variableName:this.variableName,outputPixelType:this.outputPixelType?this.outputPixelType:null},function(a){return null!==a&&void 0!==a?!0:void 0})}});return a("extend-esri")&&l.setObject("layers.RasterFunction",f,d),f})},"esri/layers/DimensionalDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(h,l,a,d,b){h=h(null,{declaredClass:"esri.layers.DimensionalDefinition",
variableName:null,dimensionName:null,values:[],isSlice:!1,constructor:function(a){l.isObject(a)&&l.mixin(this,a)},toJson:function(){return b.filter({variableName:this.variableName,dimensionName:this.dimensionName,values:this.values,isSlice:this.isSlice},function(a){return null!==a})}});return a("extend-esri")&&l.setObject("layers.DimensionalDefinition",h,d),h})},"esri/layers/Raster":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/config dojo/json dojo/sniff ../kernel ../Evented ../request ../geometry/Extent ../SpatialReference ../deferredUtils ./PixelBlock ./rasterFormats/LercCodec ./rasterFormats/Lerc2Codec".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t){var w,x,y,z,A,B;l=l(e,{declaredClass:"esri.layers.Raster",imageServiceUrl:null,validPixelTypes:"U1 U2 U4 U8 U16 U32 S8 S16 S32 F32".split(" "),validFormats:"lerc jpeg jpg jpgpng png png8 png24 png32 bip bsq tiff".split(" "),_eventMap:{"raster-read-complete":["pixelData","params"]},constructor:function(a){this.imageServiceUrl=a;this.registerConnectEvents();this._loadRasterFormatModules()},read:function(e,f,g){var k=this,h=new d(r._dfdCanceller);if(10>m("ie"))throw"This browser is not supported.";
if(!e.imageServiceParameters)throw"Insufficient parameters to read data";var n=a.clone(e.imageServiceParameters),l=e.pixelType;b.some(this.validPixelTypes,function(a){return a===l})||(n.pixelType="F32");b.some(this.validFormats,function(a){return a.toLowerCase()===n.format.toLowerCase()})||(n.format="lerc");var q,u=e.decodeFunc;this._prepareGetImageParameters(n);var t=n.width,v=n.height,w=n.extent;return delete n.width,delete n.height,delete n.extent,h._pendingDfd=c({url:this.imageServiceUrl+"/exportImage",
handleAs:"arraybuffer",content:a.mixin(n,{f:"image"}),load:function(a){k.decode(a,{width:t,height:v,planes:null,pixelType:l,noDataValue:n.noData,format:n.format,decodeFunc:u}).then(function(a){q={pixelBlock:a,extent:w};k._resolve([q,n],"onRasterReadComplete",f,h)},function(a){k._resolve([a],null,g,h,!0)})},error:function(a){k._resolve([a],null,g,h,!0)}}),h.promise},decode:function(a,b){if(void 0===b||null===b)throw"missing decode options";var c,d;return b.format&&(c=b.format.toUpperCase()),"BSQ"!==
c&&"BIP"!==c&&(c=this._getFormat(a)),d=b.decodeFunc,(void 0===d||null===d)&&(d=this._getFormatDecoderDfd(c)),d(a,b)},onRasterReadComplete:function(){},_prepareGetImageParameters:function(b){if(b.size&&b.bbox){var c=b.size.split(",");(b.width=parseFloat(c[0]),b.height=parseFloat(c[1]),b.extent)||(c=b.bbox.split(","),b.extent=new n(parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3]),new q(b.bboxSR)))}else{if(!b.width||Math.floor(b.width)!==b.width||!b.height||Math.floor(b.height)!==
b.height)throw"Incorrect Image Dimensions";if(!b.extent||"esri.geometry.Extent"!==b.extent.declaredClass)throw"Incorrect extent";var c=b.extent,d=c.spatialReference.wkid||k.toJson(c.spatialReference.toJson());delete b._ts;a.mixin(b,{bbox:c.xmin+","+c.ymin+","+c.xmax+","+c.ymax,imageSR:d,bboxSR:d,size:b.width+","+b.height},b.disableClientCaching?{_ts:(new Date).getTime()}:{})}},_adjustExtent:function(a,b,c){var d=a.ymax-a.ymin,e=a.xmax-a.xmin;return c>=b?(d=e*b/c,a.ymax=a.ymin+d):(e=d*c/b,a.xmax=a.xmin+
e),a},_resolve:function(a,b,c,d,e){b&&this[b].apply(this,a);c&&c.apply(null,a);d&&r._resDfd(d,a,e)},_getFormatDecoderDfd:function(b){var c=null;switch(b){case "LERC":c=this._decodeLerc;break;case "LERC2":c=this._decodeLerc2;break;case "JPEG":c=this._decodeJpeg;break;case "PNG":c=this._decodePng;break;case "BSQ":c=this._decodeBsq;break;case "BIP":c=this._decodeBip;break;case "TIFF":c=this._decodeTiff;break;default:c=function(a,b){throw"The raster format is not supported";}}c=a.hitch(this,c);return function(a,
e){var f=new d;try{var g;"LERC"===b||!0===A?(g=c(a,e),f.resolve(g)):B.then(function(){g=c(a,e);f.resolve(g)})}catch(k){f.reject(k)}return f}},_getFormat:function(a){a=new Uint8Array(a,0,10);var b="";return 255===a[0]&&216===a[1]?b="JPEG":137===a[0]&&80===a[1]&&78===a[2]&&71===a[3]?b="PNG":67===a[0]&&110===a[1]&&116===a[2]&&90===a[3]&&73===a[4]&&109===a[5]&&97===a[6]&&103===a[7]&&101===a[8]&&32===a[9]?b="LERC":76===a[0]&&101===a[1]&&114===a[2]&&99===a[3]&&50===a[4]&&32===a[5]?b="LERC2":-1<String.fromCharCode.apply(null,
a).toLowerCase().indexOf("error")?b="ERROR":(73===a[0]&&73===a[1]&&42===a[2]&&0===a[3]||77===a[0]&&77===a[1]&&0===a[2]&&42===a[3])&&(b="TIFF"),b},_validateDecodeParams:function(a){if(!a.height||Math.floor(a.height)!==a.height)throw"Height not provided.";if(!a.width||Math.floor(a.width)!==a.width)throw"Width not provided.";},_decodeJpeg:function(a,b){if(!w)throw"The jpeg decoder module is not loaded.";this._validateDecodeParams(b);var c=(new w).decode(a);if(!F(c,b))throw"The decoded image dimensions are incorrect.";
var d,e,f=[];for(d=0;d<c.pixels.length;d++)e=c.pixels[d],f.push(this._calculateBandStatistics(e));return new u({width:c.width,height:c.height,pixels:c.pixels,pixelType:"U8",mask:c.mask,statistics:f})},_decodePng:function(a,b){if(!x)throw"The png decoder module is not loaded.";this._validateDecodeParams(b);var c=new Uint8Array(a),d=new x(c),c=new Uint8Array(b.width*b.height*4);d.copyToImageData(c,d.decodePixels());var e,f=d=0;e=new Uint8Array(b.width*b.height);for(d=0;d<b.width*b.height;d++)e[d]=c[4*
d+3];for(var g=new u({width:b.width,height:b.height,pixels:[],pixelType:"U8",mask:e,statistics:[]}),d=0;3>d;d++){e=new Uint8Array(b.width*b.height);for(f=0;f<b.width*b.height;f++)e[f]=c[4*f+d];g.addData({pixels:e,statistics:this._calculateBandStatistics(e)})}return g},_decodeBsq:function(a,b){if(!y)throw"The bsq decoder module is not loaded.";this._validateDecodeParams(b);D=b.noDataValue;b.pixelType=E(b.pixelType);var c,d=y.decodeBSQ(a,{bandCount:b.planes,width:b.width,height:b.height,pixelType:C,
noDataValue:D}),e=[],f=null;for(c=0;c<d.pixels.length;c++)f=d.pixels[c],e.push(this._calculateBandStatistics(f));return new u({width:b.width,height:b.height,pixels:d.pixels,pixelType:b.pixelType,mask:d.maskData,statistics:e})},_decodeBip:function(a,b){this._validateDecodeParams(b);D=b.noDataValue;b.pixelType=E(b.pixelType);var c,d=y.decodeBIP(a,{bandCount:b.planes,width:b.width,height:b.height,pixelType:C,noDataValue:D}),e=[],f=null;for(c=0;c<d.pixels.length;c++)f=d.pixels[c],e.push(this._calculateBandStatistics(f));
return new u({width:b.width,height:b.height,pixels:d.pixels,pixelType:b.pixelType,mask:d.maskData,statistics:e})},_decodeTiff:function(a,b){this._validateDecodeParams(b);D=b.noDataValue;b.pixelType=E(b.pixelType);var c,d=z.decode(a),e=[],f=null;for(c=0;c<d.pixels.length;c++)f=d.pixels[c],e.push(this._calculateBandStatistics(f,d.maskData));return new u({width:d.width,height:d.height,pixels:d.pixels,pixelType:d.pixelType,mask:d.maskData,statistics:e})},_decodeLerc:function(a,b){this._validateDecodeParams(b);
D=b.noDataValue;b.pixelType=E(b.pixelType);for(var c,d,e=0,f=0,g=a.byteLength-10;g>f;){var k=v.decode(a,{inputOffset:f,encodedMaskData:c,returnMask:0===e?!0:!1,returnEncodedMask:0===e?!0:!1,returnFileInfo:!0,pixelType:C,noDataValue:D});if(f=k.fileInfo.eofOffset,0===e&&(c=k.encodedMaskData,d=new u({width:b.width,height:b.height,pixels:[],pixelType:b.pixelType,mask:k.maskData,statistics:[]})),e++,!F(k,b))throw"The decoded image dimensions are incorrect";d.addData({pixels:k.pixelData,statistics:{minValue:k.minValue,
maxValue:k.maxValue,noDataValue:k.noDataValue}})}return d},_decodeLerc2:function(a,b){this._validateDecodeParams(b);D=b.noDataValue;b.pixelType=E(b.pixelType);for(var c,d,e,f=0,g=0,k=a.byteLength-10;k>g;){if(d=t.decode(a,{inputOffset:g,maskData:c,returnFileInfo:!0}),g=d.fileInfo.eofOffset,0===f&&(c=d.maskData,e=new u({width:b.width,height:b.height,pixels:[],pixelType:d.fileInfo.pixelType,mask:d.maskData,statistics:[]})),f++,!F(d,b))throw"The decoded image dimensions are incorrect";e.addData({pixels:d.pixelData,
statistics:{minValue:d.minValue,maxValue:d.maxValue,noDataValue:d.noDataValue}})}return e},_calculateBandStatistics:function(a,b){var c,d=1/0,e=-(1/0),f=a.length,g=0;if(b)for(c=0;f>c;c++)b[c]&&(g=a[c],d=d>g?g:d,e=g>e?g:e);else for(c=0;f>c;c++)g=a[c],d=d>g?g:d,e=g>e?g:e;return{minValue:d,maxValue:e}},_loadRasterFormatModules:function(){A||(B||(B=new d),10>m("ie")?B.isRejected()||B.reject("unsupported browser version"):h(["./rasterFormats/JpgPlus","./rasterFormats/Png","./rasterFormats/Raw","./rasterFormats/TiffDecoder",
"./rasterFormats/Zlib"],function(a,b,c,d){w=a;x=b;y=c;z=d;A=!0;B.isResolved()||B.resolve(!0)}))}});var C=null,D=null,E=function(a){return"U1"===a||"U2"===a||"U4"===a||"U8"===a?(a="U8",D=Math.pow(2,8)-1,C=Uint8Array,a):"U16"===a?(D=D||Math.pow(2,16)-1,C=Uint16Array,a):"U32"===a?(D=D||Math.pow(2,32)-1,C=Uint32Array,a):"S8"===a?(D=D||0-Math.pow(2,7),C=Int8Array,a):"S16"===a?(D=D||0-Math.pow(2,15),C=Int16Array,a):"S32"===a?(D=D||0-Math.pow(2,31),C=Int32Array,a):(C=Float32Array,a)},F=function(a,b){return a.height!==
b.height||a.width!==b.width?!1:!0};return m("extend-esri")&&a.setObject("layers.Raster",l,g),l})},"esri/layers/PixelBlock":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h([],{declaredClass:"esri.layers.PixelBlock",planes:null,width:null,height:null,pixelType:null,pixels:[],statistics:[],constructor:function(a){if(a){if(!a.width||Math.floor(a.width)!==a.width)throw"PixelBlock: incorrect width";if(!a.height||Math.floor(a.height)!==a.height)throw"PixelBlock: incorrect height";
if(!a.pixels||!a.statistics)throw"PixelBlock: pixel data or statistics not present";this.width=a.width;this.height=a.height;this.pixels=a.pixels;this.pixelType=a.pixelType||null;this.statistics=a.statistics;this.mask=a.mask||null}},getPlaneCount:function(){return this.pixels.length!==this.statistics.length?console.error("Inconsistent pixel data and statistics"):this.statistics.length},addData:function(a){if(!a.pixels||!a.statistics)throw"Pixel data or statistics are not present";if(a.pixels.length!==
this.width*this.height)throw"Inconsistent pixel data size";this.statistics.push(a.statistics);this.pixels.push(a.pixels)},getAsRGBA:function(){var a=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "S8":case "S16":case "U16":case "S32":case "U32":case "F32":case "F64":this._fillFromNon8Bit(a);break;default:this._fillFrom8Bit(a)}return new Uint8ClampedArray(a)},getAsRGBAFloat:function(){var a=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(a),a},clone:function(){var a=
new this.constructor;a.width=this.width;a.height=this.height;a.pixelType=this.pixelType;this.mask&&(a.mask=new Uint8Array(this.mask));var d,k;if(this.pixels)for(a.pixels=[],k=this.pixels.length,d=0;k>d;d++)a.pixels[d]=new Float32Array(this.pixels[d]);if(this.statistics)for(a.statistics=[],k=this.statistics.length,d=0;k>d;d++)a.statistics[d]=l.clone(this.statistics[d]);return a},_fillFrom8Bit:function(a){var d=this.pixels,k=this.mask;if(!a||!d||!d.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");
var m,g,e;m=g=e=d[0];3<=d.length&&(g=d[1],e=d[2]);var d=new Uint32Array(a),c=this.width*this.height;if(m.length!==c)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");if(k&&k.length===c)for(a=0;c>a;a++)k[a]&&(d[a]=-16777216|e[a]<<16|g[a]<<8|m[a]);else for(a=0;c>a;a++)d[a]=-16777216|e[a]<<16|g[a]<<8|m[a]},_fillFromNon8Bit:function(a){var d=this.pixels,k=this.mask,m=this.statistics;if(!a||!d||!d.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");
var g=1,e=0;m&&0<m.length?(e=m[0].minValue,g=255/(m[0].maxValue-m[0].minValue)):(g=255,"S8"===this.pixelType?(e=-128,g=127):"U16"===this.pixelType?g=65535:"S16"===this.pixelType?(e=-32768,g=32767):"U32"===this.pixelType?g=4294967295:"S32"===this.pixelType?(e=-2147483648,g=2147483647):"F32"===this.pixelType?(e=-3.4E39,g=3.4E39):"F64"===this.pixelType&&(e=-Number.MAX_VALUE,g=Number.MAX_VALUE),g=255/(g-e));var c,h,l;a=new Uint32Array(a);m=this.width*this.height;if(c=d[0],c.length!==m)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");
if(3<=d.length)if(h=d[1],l=d[2],k&&k.length===m)for(d=0;m>d;d++)k[d]&&(a[d]=-16777216|(l[d]-e)*g<<16|(h[d]-e)*g<<8|(c[d]-e)*g);else for(d=0;m>d;d++)a[d]=-16777216|(l[d]-e)*g<<16|(h[d]-e)*g<<8|(c[d]-e)*g;else if(k&&k.length===m)for(d=0;m>d;d++)h=(c[d]-e)*g,k[d]&&(a[d]=-16777216|h<<16|h<<8|h);else for(d=0;m>d;d++)h=(c[d]-e)*g,a[d]=-16777216|h<<16|h<<8|h},_fillFrom32Bit:function(a){var d=this.pixels,k=this.mask;if(!a||!d||!d.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");
var m,g,e;m=g=e=d[0];3<=d.length&&(g=d[1],e=d[2]);var c=this.width*this.height;if(m.length!==c)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");var h=0;if(k&&k.length===c)for(d=0;c>d;d++)a[h++]=m[d],a[h++]=g[d],a[h++]=e[d],a[h++]=k[d];else for(d=0;c>d;d++)a[h++]=m[d],a[h++]=g[d],a[h++]=e[d],a[h++]=255}});return a("extend-esri")&&l.setObject("layers.PixelBlock",h,d),h})},"esri/layers/rasterFormats/LercCodec":function(){define([],function(){var h={defaultNoDataValue:-3.4027999387901484E38,
decode:function(a,d){var b;d=d||{};var f;f=d.inputOffset||0;var k=d.encodedMaskData||null===d.encodedMaskData,m={},g=new Uint8Array(a,f,10);if(m.fileIdentifierString=String.fromCharCode.apply(null,g),"CntZImage"!=m.fileIdentifierString.trim())throw"Unexpected file identifier string: "+m.fileIdentifierString;f+=10;g=new DataView(a,f,24);m.fileVersion=g.getInt32(0,!0);m.imageType=g.getInt32(4,!0);m.height=g.getUint32(8,!0);m.width=g.getUint32(12,!0);m.maxZError=g.getFloat64(16,!0);f+=24;var e;if(!k)if(g=
new DataView(a,f,16),m.mask={},m.mask.numBlocksY=g.getUint32(0,!0),m.mask.numBlocksX=g.getUint32(4,!0),m.mask.numBytes=g.getUint32(8,!0),m.mask.maxValue=g.getFloat32(12,!0),f+=16,0<m.mask.numBytes){e=new Uint8Array(Math.ceil(m.width*m.height/8));var g=new DataView(a,f,m.mask.numBytes),k=g.getInt16(0,!0),c=2,n=0;do{if(0<k)for(;k--;)e[n++]=g.getUint8(c++);else for(var q=g.getUint8(c++),k=-k;k--;)e[n++]=q;k=g.getInt16(c,!0);c+=2}while(c<m.mask.numBytes);if(-32768!==k||n<e.length)throw"Unexpected end of mask RLE encoding";
m.mask.bitset=e;f+=m.mask.numBytes}else 0===(m.mask.numBytes|m.mask.numBlocksY|m.mask.maxValue)&&(e=new Uint8Array(Math.ceil(m.width*m.height/8)),m.mask.bitset=e);g=new DataView(a,f,16);m.pixels={};m.pixels.numBlocksY=g.getUint32(0,!0);m.pixels.numBlocksX=g.getUint32(4,!0);m.pixels.numBytes=g.getUint32(8,!0);m.pixels.maxValue=g.getFloat32(12,!0);f+=16;e=m.pixels.numBlocksX;g=m.pixels.numBlocksY;e+=0<m.width%e?1:0;k=g+(0<m.height%g?1:0);m.pixels.blocks=Array(e*k);for(n=c=0;k>n;n++)for(q=0;e>q;q++){var r=
0,g=new DataView(a,f,Math.min(10,a.byteLength-f)),u={};m.pixels.blocks[c++]=u;var v=g.getUint8(0);if(r++,u.encoding=63&v,3<u.encoding)throw"Invalid block encoding ("+u.encoding+")";if(2!==u.encoding){if(0!==v&&2!==v){if(v>>=6,u.offsetType=v,2===v)u.offset=g.getInt8(1),r++;else if(1===v)u.offset=g.getInt16(1,!0),r+=2;else{if(0!==v)throw"Invalid block offset type";u.offset=g.getFloat32(1,!0);r+=4}if(1===u.encoding)if(v=g.getUint8(r),r++,u.bitsPerPixel=63&v,v>>=6,u.numValidPixelsType=v,2===v)u.numValidPixels=
g.getUint8(r),r++;else if(1===v)u.numValidPixels=g.getUint16(r,!0),r+=2;else{if(0!==v)throw"Invalid valid pixel count type";u.numValidPixels=g.getUint32(r,!0);r+=4}}if(f+=r,3!=u.encoding)if(0===u.encoding){v=(m.pixels.numBytes-1)/4;if(v!==Math.floor(v))throw"uncompressed block has invalid length";g=new ArrayBuffer(4*v);r=new Uint8Array(g);r.set(new Uint8Array(a,f,4*v));g=new Float32Array(g);u.rawData=g;f+=4*v}else 1===u.encoding&&(v=Math.ceil(u.numValidPixels*u.bitsPerPixel/8),g=Math.ceil(v/4),g=
new ArrayBuffer(4*g),r=new Uint8Array(g),r.set(new Uint8Array(a,f,v)),u.stuffedData=new Uint32Array(g),f+=v)}else f++}f=(m.eofOffset=f,m);var m=null!=d.noDataValue?d.noDataValue:h.defaultNoDataValue,k=d.encodedMaskData,t=d.returnMask,w,c=0,n=f.pixels.numBlocksX,q=f.pixels.numBlocksY,u=Math.floor(f.width/n),r=Math.floor(f.height/q),v=2*f.maxZError;e=Number.MAX_VALUE;k=k||(f.mask?f.mask.bitset:null);g=new (d.pixelType||Float32Array)(f.width*f.height);t&&k&&(b=new Uint8Array(f.width*f.height));for(var x,
y,t=new Float32Array(u*r),z=0;q>=z;z++){var A=z!==q?r:f.height%q;if(0!==A)for(var B=0;n>=B;B++){var C=B!==n?u:f.width%n;if(0!==C){var D,E,F,H=z*f.width*r+B*u,G=f.width-C,K=f.pixels.blocks[c];if(2>K.encoding){if(0===K.encoding)D=K.rawData;else{D=K.stuffedData;E=K.bitsPerPixel;x=K.numValidPixels;y=K.offset;var J=v,I=t,L=f.pixels.maxValue,M=void 0,N=void 0,Q=void 0,O=(1<<E)-1,T=0,S=0,R=Math.ceil((L-y)/J),M=4*D.length-Math.ceil(E*x/8);D[D.length-1]<<=8*M;for(M=0;x>M;M++)(0===S&&(Q=D[T++],S=32),S>=E)?
(N=Q>>>S-E&O,S-=E):(S=E-S,N=(Q&O)<<S&O,Q=D[T++],S=32-S,N+=Q>>>S),I[M]=R>N?y+N*J:L;D=t}E=0}else F=2===K.encoding?0:K.offset;var U;if(k)for(y=0;A>y;y++){7&H&&(U=k[H>>3],U<<=7&H);for(x=0;C>x;x++)7&H||(U=k[H>>3]),128&U?(b&&(b[H]=1),w=2>K.encoding?D[E++]:F,e=e>w?w:e,g[H++]=w):(b&&(b[H]=0),g[H++]=m),U<<=1;H+=G}else if(2>K.encoding)for(y=0;A>y;y++){for(x=0;C>x;x++)w=D[E++],e=e>w?w:e,g[H++]=w;H+=G}else for(e=e>F?F:e,y=0;A>y;y++){for(x=0;C>x;x++)g[H++]=F;H+=G}if(1===K.encoding&&E!==K.numValidPixels)throw"Block and Mask do not match";
c++}}}w={width:f.width,height:f.height,pixelData:g,minValue:e,maxValue:f.pixels.maxValue,noDataValue:m};b&&(w.maskData=b);d.returnEncodedMask&&f.mask&&(w.encodedMaskData=f.mask.bitset?f.mask.bitset:null);if(d.returnFileInfo&&(w.fileInfo=l(f),d.computeUsedBitDepths)){b=w.fileInfo;F=f.pixels.numBlocksX*f.pixels.numBlocksY;U={};for(D=0;F>D;D++)E=f.pixels.blocks[D],0===E.encoding?U.float32=!0:1===E.encoding?U[E.bitsPerPixel]=!0:U[0]=!0;F=Object.keys(U);b.bitDepths=F}return w}},l=function(a){return{fileIdentifierString:a.fileIdentifierString,
fileVersion:a.fileVersion,imageType:a.imageType,height:a.height,width:a.width,maxZError:a.maxZError,eofOffset:a.eofOffset,mask:a.mask?{numBlocksX:a.mask.numBlocksX,numBlocksY:a.mask.numBlocksY,numBytes:a.mask.numBytes,maxValue:a.mask.maxValue}:null,pixels:{numBlocksX:a.pixels.numBlocksX,numBlocksY:a.pixels.numBlocksY,numBytes:a.pixels.numBytes,maxValue:a.pixels.maxValue,noDataValue:this.noDataValue}}};return h})},"esri/layers/rasterFormats/Lerc2Codec":function(){define([],function(){var h={unstuff:function(a,
b,f,k,m,g,e,c){var h,l,r,u,v=(1<<f)-1,t=0,w=0;h=4*a.length-Math.ceil(f*k/8);if(a[a.length-1]<<=8*h,m)for(h=0;k>h;h++)0===w&&(r=a[t++],w=32),w>=f?(l=r>>>w-f&v,w-=f):(u=f-w,l=(r&v)<<u&v,r=a[t++],w=32-u,l+=r>>>w),b[h]=m[l];else for(m=Math.ceil((c-g)/e),h=0;k>h;h++)0===w&&(r=a[t++],w=32),w>=f?(l=r>>>w-f&v,w-=f):(u=f-w,l=(r&v)<<u&v,r=a[t++],w=32-u,l+=r>>>w),b[h]=m>l?g+l*e:c},unstuffLUT:function(a,b,f,k,m,g){var e,c=(1<<b)-1,h=0,l=0,r=0,u=0,v=0,t=[],l=4*a.length-Math.ceil(b*f/8);a[a.length-1]<<=8*l;for(var w=
Math.ceil((g-k)/m),l=0;f>l;l++)0===u&&(e=a[h++],u=32),u>=b?(v=e>>>u-b&c,u-=b):(r=b-u,v=(e&c)<<r&c,e=a[h++],u=32-r,v+=e>>>u),t[l]=w>v?k+v*m:g;return t.unshift(k),t},unstuff2:function(a,b,f,k,m,g,e,c){var h,l,r,u,v=(1<<f)-1,t=0,w=0,x=0;if(m)for(h=0;k>h;h++)0===w&&(r=a[t++],w=32,x=0),w>=f?(l=r>>>x&v,w-=f,x+=f):(u=f-w,l=r>>>x&v,r=a[t++],w=32-u,l|=(r&(1<<u)-1)<<f-u,x=u),b[h]=m[l];else for(m=Math.ceil((c-g)/e),h=0;k>h;h++)0===w&&(r=a[t++],w=32,x=0),w>=f?(l=r>>>x&v,w-=f,x+=f):(u=f-w,l=r>>>x&v,r=a[t++],w=
32-u,l|=(r&(1<<u)-1)<<f-u,x=u),b[h]=m>l?g+l*e:c;return b},unstuffLUT2:function(a,b,f,k,m,g){for(var e,c=(1<<b)-1,h=0,l=0,r=0,u=0,v=0,t=0,w=[],x=Math.ceil((g-k)/m),l=0;f>l;l++)0===u&&(e=a[h++],u=32,t=0),u>=b?(v=e>>>t&c,u-=b,t+=b):(r=b-u,v=e>>>t&c,e=a[h++],u=32-r,v|=(e&(1<<r)-1)<<b-r,t=r),w[l]=x>v?k+v*m:g;return w.unshift(k),w},originalUnstuff:function(a,b,f,k){var m,g,e,c,h=(1<<f)-1,l=0,r=0;m=4*a.length-Math.ceil(f*k/8);a[a.length-1]<<=8*m;for(m=0;k>m;m++)0===r&&(e=a[l++],r=32),r>=f?(g=e>>>r-f&h,r-=
f):(c=f-r,g=(e&h)<<c&h,e=a[l++],r=32-c,g+=e>>>r),b[m]=g;return b},originalUnstuff2:function(a,b,f,k){var m,g,e,c,h=(1<<f)-1,l=0,r=0,u=0;for(m=0;k>m;m++)0===r&&(e=a[l++],r=32,u=0),r>=f?(g=e>>>u&h,r-=f,u+=f):(c=f-r,g=e>>>u&h,e=a[l++],r=32-c,g|=(e&(1<<c)-1)<<f-c,u=c),b[m]=g;return b}},l={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(a){for(var b=65535,f=65535,k=a.length,m=Math.floor(k/2),g=0;m;){var e=359<=m?359:m,m=m-e;do b+=a[g++]<<8,f+=b+=a[g++];while(--e);b=(65535&b)+(b>>>16);f=(65535&
f)+(f>>>16)}return 1&k&&(f+=b+=a[g]<<8),b=(65535&b)+(b>>>16),f=(65535&f)+(f>>>16),(f<<16|b)>>>0},readHeaderInfo:function(a,b){var f=b.ptr,k=new Uint8Array(a,f,6),m={};if(m.fileIdentifierString=String.fromCharCode.apply(null,k),0!==m.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+m.fileIdentifierString;f+=6;k=new DataView(a,f,52);m.fileVersion=k.getInt32(0,!0);f+=4;3<=m.fileVersion&&(m.checksum=k.getUint32(4,!0),f+=4);k=new DataView(a,f,48);m.height=
k.getUint32(0,!0);m.width=k.getUint32(4,!0);m.numValidPixel=k.getUint32(8,!0);m.microBlockSize=k.getInt32(12,!0);m.blobSize=k.getInt32(16,!0);m.imageType=k.getInt32(20,!0);m.maxZError=k.getFloat64(24,!0);m.zMin=k.getFloat64(32,!0);m.zMax=k.getFloat64(40,!0);f+=48;b.headerInfo=m;b.ptr=f;var g;if(3<=m.fileVersion&&(g=this.computeChecksumFletcher32(new Uint8Array(a,f-48,m.blobSize-14)),g!==m.checksum))throw"Checksum failed.";return!0},readMask:function(a,b){var f=b.ptr,k=b.headerInfo,m=k.width*k.height,
g=k.numValidPixel,e=new DataView(a,f,4),k={};if(k.numBytes=e.getUint32(0,!0),f+=4,(0===g||m===g)&&0!==k.numBytes)throw"invalid mask";if(0===g)g=new Uint8Array(Math.ceil(m/8)),k.bitset=g,e=new Uint8Array(m),b.pixels.resultMask=e,f+=k.numBytes;else if(0<k.numBytes){var g=new Uint8Array(Math.ceil(m/8)),e=new DataView(a,f,k.numBytes),c=e.getInt16(0,!0),h=2,l=0,r=0;do{if(0<c)for(;c--;)g[l++]=e.getUint8(h++);else for(r=e.getUint8(h++),c=-c;c--;)g[l++]=r;c=e.getInt16(h,!0);h+=2}while(h<k.numBytes);if(-32768!==
c||l<g.length)throw"Unexpected end of mask RLE encoding";e=new Uint8Array(m);for(h=h=c=0;m>h;h++)7&h?(c=g[h>>3],c<<=7&h):c=g[h>>3],128&c&&(e[h]=1);b.pixels.resultMask=e;k.bitset=g;f+=k.numBytes}return b.ptr=f,b.mask=k,!0},readDataOneSweep:function(a,b,f){var k=b.ptr,h=b.headerInfo,g=h.width*h.height,h=h.numValidPixel*l.getDateTypeSize(h.imageType);if(f===Uint8Array)a=new Uint8Array(a,k,h);else{var e=new ArrayBuffer(h);(new Uint8Array(e)).set(new Uint8Array(a,k,h));a=new f(e)}if(a.length===g)b.pixels.resultPixels=
a;else for(b.pixels.resultPixels=new f(g),e=e=f=0;g>e;e++)b.pixels.resultMask[e]&&(b.pixels.resultPixels[e]=a[f++]);return k+=h,b.ptr=k,!0},readHuffman:function(d,b,f){var k=b.headerInfo,k=k.width*k.height,h=this.HUFFMAN_LUT_BITS_MAX,g=new DataView(d,b.ptr,16);b.ptr+=16;if(2>g.getInt32(0,!0))throw"unsupported Huffman version";var e=g.getInt32(4,!0),c=g.getInt32(8,!0),n=g.getInt32(12,!0);if(c>=n)return!1;var q=new Uint32Array(n-c);l.decodeBits(d,b,q);for(var r,u,v=[],g=c;n>g;g++)r=g-(e>g?0:e),v[r]=
{first:q[g-c],second:null};g=d.byteLength-b.ptr;q=Math.ceil(g/4);q=new ArrayBuffer(4*q);(new Uint8Array(q)).set(new Uint8Array(d,b.ptr,g));var t;d=new Uint32Array(q);var w=q=0;t=d[0];for(g=c;n>g;g++)r=g-(e>g?0:e),u=v[r].first,0<u&&(v[r].second=t<<q>>>32-u,32-q>=u?(q+=u,32===q&&(q=0,w++,t=d[w])):(q+=u-32,w++,t=d[w],v[r].second|=t>>>32-q));for(var x=0===b.headerInfo.imageType?128:0,y=b.headerInfo.height,z=b.headerInfo.width,A=0,B=0,C=new a,g=0;g<v.length;g++)void 0!==v[g]&&(A=Math.max(A,v[g].first));
for(var B=A>=h?h:A,D,E,F,h=[],g=c;n>g;g++)if(r=g-(e>g?0:e),u=v[r].first,0<u)if(t=[u,r],B>=u)for(D=v[r].second<<B-u,E=1<<B-u,c=0;E>c;c++)h[D|c]=t;else for(D=v[r].second,E=C,c=u-1;0<=c;c--)(F=D>>>c&1)?(E.right||(E.right=new a),E=E.right):(E.left||(E.left=new a),E=E.left),0!==c||E.val||(E.val=t[1]);var H,G;u=b.pixels.resultMask;n=e=0;0<q&&(w++,q=0);t=d[w];f=new f(k);if(b.headerInfo.numValidPixel===z*y)for(g=c=0;y>g;g++)for(r=0;z>r;r++,c++){if(k=0,H=t<<q>>>32-B,G=H,B>32-q&&(H|=d[w+1]>>>64-q-B,G=H),h[G])k=
h[G][1],q+=h[G][0];else for(G=H=t<<q>>>32-A,A>32-q&&(H|=d[w+1]>>>64-q-A,G=H),E=C,n=0;A>n;n++)if(F=H>>>A-n-1&1,E=F?E.right:E.left,!E.left&&!E.right){k=E.val;q=q+n+1;break}32<=q&&(q-=32,w++,t=d[w]);k-=x;k+=0<r?e:0<g?f[c-z]:e;k&=255;e=f[c]=k}else for(g=c=0;y>g;g++)for(r=0;z>r;r++,c++)if(u[c]){if(k=0,H=t<<q>>>32-B,G=H,B>32-q&&(H|=d[w+1]>>>64-q-B,G=H),h[G])k=h[G][1],q+=h[G][0];else for(G=H=t<<q>>>32-A,A>32-q&&(H|=d[w+1]>>>64-q-A,G=H),E=C,n=0;A>n;n++)if(F=H>>>A-n-1&1,E=F?E.right:E.left,!E.left&&!E.right){k=
E.val;q=q+n+1;break}32<=q&&(q-=32,w++,t=d[w]);k-=x;k+=0<r&&u[c-1]?e:0<g&&u[c-z]?f[c-z]:e;k&=255;e=f[c]=k}b.pixels.resultPixels=f;b.ptr=b.ptr+4*(w+1)+(0<q?4:0)},decodeBits:function(a,b,f,k){var m=b.headerInfo.fileVersion,g=0,e=new DataView(a,b.ptr,5),c=e.getUint8(0);g++;var n=c>>6,l=0===n?4:3-n,r=0<(32&c)?!0:!1,n=31&c,c=0;if(1===l)c=e.getUint8(g),g++;else if(2===l)c=e.getUint16(g,!0),g+=2;else{if(4!==l)throw"Invalid valid pixel count type";c=e.getUint32(g,!0);g+=4}k=k||0;var u,v,t,w,x,l=2*b.headerInfo.maxZError;
if(r){b.counter.lut++;r=e.getUint8(g);g++;w=Math.ceil((r-1)*n/8);x=Math.ceil(w/4);v=new ArrayBuffer(4*x);t=new Uint8Array(v);b.ptr+=g;t.set(new Uint8Array(a,b.ptr,w));g=new Uint32Array(v);b.ptr+=w;for(e=0;r-1>>>e;)e++;w=Math.ceil(c*e/8);x=Math.ceil(w/4);v=new ArrayBuffer(4*x);t=new Uint8Array(v);t.set(new Uint8Array(a,b.ptr,w));u=new Uint32Array(v);b.ptr+=w;a=3<=m?h.unstuffLUT2(g,n,r-1,k,l,b.headerInfo.zMax):h.unstuffLUT(g,n,r-1,k,l,b.headerInfo.zMax);3<=m?h.unstuff2(u,f,e,c,a):h.unstuff(u,f,e,c,
a)}else b.counter.bitstuffer++,e=n,b.ptr+=g,0<e&&(w=Math.ceil(c*e/8),x=Math.ceil(w/4),v=new ArrayBuffer(4*x),t=new Uint8Array(v),t.set(new Uint8Array(a,b.ptr,w)),u=new Uint32Array(v),b.ptr+=w,3<=m?h.unstuff2(u,f,e,c,!1,k,l,b.headerInfo.zMax):h.unstuff(u,f,e,c,!1,k,l,b.headerInfo.zMax))},readTiles:function(a,b,f){var k=b.headerInfo,h=k.width,g=k.height,e=k.microBlockSize,k=k.imageType,c=Math.ceil(h/e),n=Math.ceil(g/e);b.pixels.numBlocksY=n;b.pixels.numBlocksX=c;b.pixels.ptr=0;for(var q,r,u,v,t,w,x,
y,z=0,A=r=0,B=0,C=0,D=0,E=0,F=0,H=z=0,G=0,K=0,J=0,I=0,L=y=0,M=new f(e*e),g=g%e||e,N=h%e||e,A=0;n>A;A++)for(C=A!==n-1?e:g,B=0;c>B;B++){if(D=B!==c-1?e:N,G=A*h*e+B*e,K=h-D,E=a.byteLength-b.ptr,q=new DataView(a,b.ptr,Math.min(10,E)),r={},L=0,F=q.getUint8(0),L++,z=F>>6&255,H=F>>2&15,H!==(B*e>>3&15))throw"integrity issue";if(w=3&F,3<w)throw b.ptr+=L,"Invalid block encoding ("+w+")";if(2!==w)if(0===w){if(b.counter.uncompressed++,b.ptr+=L,J=C*D*l.getDateTypeSize(k),I=a.byteLength-b.ptr,J=I>J?J:I,u=new ArrayBuffer(J),
v=new Uint8Array(u),v.set(new Uint8Array(a,b.ptr,J)),t=new f(u),y=0,b.pixels.resultMask)for(z=0;C>z;z++){for(r=0;D>r;r++)b.pixels.resultMask[G]&&(b.pixels.resultPixels[G]=t[y++]),G++;G+=K}else for(z=0;C>z;z++){for(r=0;D>r;r++)b.pixels.resultPixels[G++]=t[y++];G+=K}b.ptr+=y*l.getDateTypeSize(k)}else if(x=l.getDataTypeUsed(k,z),y=l.getOnePixel(r,L,x,q),L+=l.getDateTypeSize(x),3===w)if(b.ptr+=L,b.counter.constantoffset++,b.pixels.resultMask)for(z=0;C>z;z++){for(r=0;D>r;r++)b.pixels.resultMask[G]&&(b.pixels.resultPixels[G]=
y),G++;G+=K}else for(z=0;C>z;z++){for(r=0;D>r;r++)b.pixels.resultPixels[G++]=y;G+=K}else if(b.ptr+=L,l.decodeBits(a,b,M,y),L=0,b.pixels.resultMask)for(z=0;C>z;z++){for(r=0;D>r;r++)b.pixels.resultMask[G]&&(b.pixels.resultPixels[G]=M[L++]),G++;G+=K}else for(z=0;C>z;z++){for(r=0;D>r;r++)b.pixels.resultPixels[G++]=M[L++];G+=K}else b.counter.constant++,b.ptr+=L}},formatFileInfo:function(a){return{fileIdentifierString:a.headerInfo.fileIdentifierString,fileVersion:a.headerInfo.fileVersion,imageType:a.headerInfo.imageType,
height:a.headerInfo.height,width:a.headerInfo.width,numValidPixel:a.headerInfo.numValidPixel,microBlockSize:a.headerInfo.microBlockSize,blobSize:a.headerInfo.blobSize,maxZError:a.headerInfo.maxZError,pixelType:l.getPixelType(a.headerInfo.imageType),eofOffset:a.eofOffset,mask:a.mask?{numBytes:a.mask.numBytes}:null,pixels:{numBlocksX:a.pixels.numBlocksX,numBlocksY:a.pixels.numBlocksY,maxValue:a.headerInfo.zMax,minValue:a.headerInfo.zMin,noDataValue:a.noDataValue}}},constructConstantSurface:function(a){var b=
a.headerInfo.zMax,f=a.headerInfo.height*a.headerInfo.width,k=0;if(a.pixels.resultMask)for(k=0;f>k;k++)a.pixels.resultMask[k]&&(a.pixels.resultPixels[k]=b);else for(k=0;f>k;k++)a.pixels.resultPixels[k]=b},getDataTypeArray:function(a){switch(a){case 0:a=Int8Array;break;case 1:a=Uint8Array;break;case 2:a=Int16Array;break;case 3:a=Uint16Array;break;case 4:a=Int32Array;break;case 5:a=Uint32Array;break;case 6:a=Float32Array;break;case 7:a=Float64Array;break;default:a=Float32Array}return a},getPixelType:function(a){switch(a){case 0:a=
"S8";break;case 1:a="U8";break;case 2:a="S16";break;case 3:a="U16";break;case 4:a="S32";break;case 5:a="U32";break;case 6:a="F32";break;case 7:a="F64";break;default:a="F32"}return a},isValidPixelValue:function(a,b){if(null===b||void 0===b)return!1;var f;switch(a){case 0:f=-128<=b&&127>=b;break;case 1:f=0<=b&&255>=b;break;case 2:f=-32768<=b&&32767>=b;break;case 3:f=0<=b&&65536>=b;break;case 4:f=-2147483648<=b&&2147483647>=b;break;case 5:f=0<=b&&4294967296>=b;break;case 6:f=-3.4027999387901484E38<=
b&&3.4027999387901484E38>=b;break;case 7:f=4.9E-324<=b&&1.7976931348623157E308>=b;break;default:f=!1}return f},getDateTypeSize:function(a){var b=0;switch(a){case 0:case 1:b=1;break;case 2:case 3:b=2;break;case 4:case 5:case 6:b=4;break;case 7:b=8;break;default:b=a}return b},getDataTypeUsed:function(a,b){var f=a;switch(a){case 2:case 4:f=a-b;break;case 3:case 5:f=a-2*b;break;case 6:f=0===b?a:1===b?2:1;break;case 7:f=0===b?a:a-2*b+1;break;default:f=a}return f},getOnePixel:function(a,b,f,k){a=0;switch(f){case 0:a=
k.getInt8(b);break;case 1:a=k.getUint8(b);break;case 2:a=k.getInt16(b,!0);break;case 3:a=k.getUint16(b,!0);break;case 4:a=k.getInt32(b,!0);break;case 5:a=k.getUInt32(b,!0);break;case 6:a=k.getFloat32(b,!0);break;case 7:a=k.getFloat64(b,!0);break;default:throw"the decoder does not understand this pixel type";}return a}},a=function(a,b,f){this.val=a;this.left=b;this.right=f};return{decode:function(a,b){b=b||{};var f=b.maskData||null===b.maskData,k=b.noDataValue,h=0,g={};if(g.ptr=b.inputOffset||0,g.pixels=
{},l.readHeaderInfo(a,g)){var h=g.headerInfo,e=l.getDataTypeArray(h.imageType);if(f)g.pixels.resultMask=b.maskData,g.ptr+=4;else if(!l.readMask(a,g))return;f=h.width*h.height;if(g.pixels.resultPixels=new e(f),g.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0},0!==h.numValidPixel)if(h.zMax===h.zMin)l.constructConstantSurface(g);else{var c=new DataView(a,g.ptr,2),n=c.getUint8(0,!0);(g.ptr++,n)?l.readDataOneSweep(a,g,e):1<h.fileVersion&&1>=h.imageType&&1E-5>Math.abs(h.maxZError-
.5)?(c=c.getUint8(1,!0),g.ptr++,c?l.readHuffman(a,g,e):l.readTiles(a,g,e)):l.readTiles(a,g,e)}g.eofOffset=g.ptr;var q;b.inputOffset?(q=g.headerInfo.blobSize+b.inputOffset-g.ptr,1<=Math.abs(q)&&(g.eofOffset=b.inputOffset+g.headerInfo.blobSize)):(q=g.headerInfo.blobSize-g.ptr,1<=Math.abs(q)&&(g.eofOffset=g.headerInfo.blobSize));q={width:h.width,height:h.height,pixelData:g.pixels.resultPixels,minValue:h.zMin,maxValue:h.zMax,maskData:g.pixels.resultMask};if(g.pixels.resultMask&&l.isValidPixelValue(h.imageType,
k)){e=g.pixels.resultMask;for(h=0;f>h;h++)e[h]||(q.pixelData[h]=k);q.noDataValue=k}return g.noDataValue=k,b.returnFileInfo&&(q.fileInfo=l.formatFileInfo(g)),q}},getBandCount:function(a){for(var b=0,f=0,k={ptr:0,pixels:{}};f<a.byteLength-58;)l.readHeaderInfo(a,k),f+=k.headerInfo.blobSize,b++,k.ptr=f;return b}}})},"esri/layers/pixelFilters/VectorFieldPixelFilter":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../lang dojo/_base/array".split(" "),function(h,l,a,d,b,f){h=
h(null,{declaredClass:"esri.layers.pixelFilters.VectorFieldPixelFilter",speedUnits:["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"],constructor:function(a){l.mixin(this,a);this.isDataUV=a&&a.isDataUV?a.isDataUV:!1;this.computeMagnitudeAndDirection=l.hitch(this,this.computeMagnitudeAndDirection);this.unitConversionFactor=1;this._updateUnitConvFactor()},setUnits:function(a,b){this.inputUnit=a;this.outputUnit=b;this.unitConversionFactor=1;this._updateUnitConvFactor()},
_updateUnitConvFactor:function(){var a=f.indexOf(this.speedUnits,this.inputUnit),b=f.indexOf(this.speedUnits,this.outputUnit);if(this.inputUnit&&this.outputUnit&&0<=a&&0<=b){var d=[1,.277778,.514444,.3048,.44704,0];this.unitConversionFactor=d[a]/d[b]}},computeMagnitudeAndDirection:function(a){if(!b.isDefined(a))throw"Could not compute magnitude and direction. No pixel data is available.";var d=a.pixelBlock;if(!b.isDefined(d)||2!==d.getPlaneCount())throw"Could not compute magnitude and direction. Pixel data does not contain two bands.";
var f=a.extent,e=(f.xmax-f.xmin)/d.width,c=(f.ymax-f.ymin)/d.height,h=f.xmin+e/2,f=f.ymax-c/2;d.statistics[0].minValue=0;d.statistics[0].maxValue=0;var l,r,u,v,t,w,x,y,z=180/Math.PI,A=[],B=0,C=0,D=0,E=!b.isDefined(d.mask);t=x=+(1/0);w=y=-(1/0);for(B=0;B<d.height;B++)for(C=0;C<d.width;C++,D++)A.push([h+e*C,f-c*B]),(E||d.mask[D])&&(u=l=d.pixels[0][D]*this.unitConversionFactor,v=r=d.pixels[1][D],this.isDataUV&&(u=Math.sqrt(l*l+r*r),v=90-z*Math.atan2(r,l),d.pixels[0][D]=u*this.unitConversionFactor,d.pixels[1][D]=
v),u>w&&(w=u),t>u&&(t=u),v>y&&(y=v),x>v&&(x=v));return d.statistics[0].maxValue=w,d.statistics[0].minValue=t,d.statistics[1].maxValue=y,d.statistics[1].minValue=x,a.locations=A,a}});return a("extend-esri")&&l.setObject("layers.pixelFilters.VectorFieldPixelFilter",h,d),h})},"esri/layers/rasterFormats/ImageCanvasDecoder":function(){define(["require","dojo/_base/declare","dojo/Deferred","dojo/sniff"],function(h,l,a,d){var b;return l(null,{constructor:function(a){this.ctx=a.ctx;this._loadRasterFormatModule()},
decode:function(b,d){if(!d.width||!d.height)throw"Native decoding requires the image format, width and height";var h,g=new a,e=new Uint8Array(b),c=this._getFormat(b);if("error"===c)throw"invalid format";"jpeg"===c&&(h=this._getMask(e,d));var n,l,r="";for(n=0;n<e.length;n+=65535)l=e.subarray(n,n+65535>e.length-1?e.length-1:n+65535),r+=String.fromCharCode.apply(null,l);var u,e="data:image/"+c+";base64,"+window.btoa(r),v=new Image;v.src=e;var t=this;return v.onload=function(){t.ctx.clearRect(0,0,d.width,
d.height);t.ctx.drawImage(v,0,0);var a=t.ctx.getImageData(0,0,v.width,v.height);if(u=a.data,h)for(n=0;n<h.length;n++)h[n]?u[4*n+3]=255:u[4*n+3]=0;t.ctx.putImageData(a,0,0);g.resolve(null)},v.onerror=function(){g.reject("cannot load image")},g},_getFormat:function(a){a=new Uint8Array(a,0,10);var b="error";return 255===a[0]&&216===a[1]?b="jpeg":137===a[0]&&80===a[1]&&78===a[2]&&71===a[3]&&(b="png"),b},_getMask:function(a,d){var h;try{if(!b)throw"The zlib decoder module is not loaded.";var g=0,e=0,c=
Math.round(a.length/2);1===c%2&&(c+=1);for(var n=a.length-2,g=c;n>g&&(255!==a[g]||217!==a[g+1]);g++);c=g+=2;if(c<a.length-1){var l=(new b(a.subarray(c))).getBytes();h=new Uint8Array(d.width*d.height);for(g=c=0;g<l.length;g++)for(e=7;0<=e;e--)h[c++]=l[g]>>e&1}}catch(r){}return h},_loadRasterFormatModule:function(){10>d("ie")||h(["./Zlib"],function(a){b=a})}})})},"esri/tasks/ImageServiceIdentifyTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../request ../geometry/normalizeUtils ./Task ./ImageServiceIdentifyResult".split(" "),
function(h,l,a,d,b,f,k,m){h=h(k,{declaredClass:"esri.tasks.ImageServiceIdentifyTask",constructor:function(a){this._url.path+="/identify";this._handler=l.hitch(this,this._handler)},__msigns:[{n:"execute",c:3,a:[{i:0,p:["geometry"]}],e:2}],_handler:function(a,b,c,d,f){try{var k=new m(a);this._successHandler([k],"onComplete",c,f)}catch(h){this._errorHandler(h,d,f)}},execute:function(a,d,c,f){var k=f.assembly;a=this._encode(l.mixin({},this._url.query,{f:"json"},a.toJson(k&&k[0])));var h=this._handler,
m=this._errorHandler;return b({url:this._url.path,content:a,callbackParamName:"callback",load:function(a,b){h(a,b,d,c,f.dfd)},error:function(a){m(a,c,f.dfd)}})},onComplete:function(){}});return f._createWrappers(h),a("extend-esri")&&l.setObject("tasks.ImageServiceIdentifyTask",h,d),h})},"esri/tasks/ImageServiceIdentifyResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../geometry/jsonUtils ./FeatureSet".split(" "),function(h,l,a,d,b,f){h=h(null,{declaredClass:"esri.tasks.ImageServiceIdentifyResult",
constructor:function(a){a.catalogItems&&(this.catalogItems=new f(a.catalogItems));a.location&&(this.location=b.fromJson(a.location));this.catalogItemVisibilities=a.catalogItemVisibilities;this.name=a.name;this.objectId=a.objectId;this.value=a.value;this.processedValues=a.processedValues;this.properties=a.properties}});return a("extend-esri")&&l.setObject("tasks.ImageServiceIdentifyResult",h,d),h})},"esri/tasks/ImageServiceIdentifyParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/_base/array dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),
function(h,l,a,d,b,f,k,m){h=h(null,{declaredClass:"esri.tasks.ImageServiceIdentifyParameters",geometry:null,mosaicRule:null,renderingRule:null,renderingRules:null,pixelSizeX:null,pixelSizeY:null,pixelSize:null,returnGeometry:!1,returnCatalogItems:!0,timeExtent:null,toJson:function(b){var e=b&&b.geometry||this.geometry;b={geometry:e,returnGeometry:this.returnGeometry,returnCatalogItems:this.returnCatalogItems,mosaicRule:this.mosaicRule?a.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?
a.toJson(this.renderingRule.toJson()):null};e&&(b.geometryType=m.getJsonType(e));e=this.timeExtent;return b.time=e?e.toJson().join(","):null,k.isDefined(this.pixelSizeX)&&k.isDefined(this.pixelSizeY)?b.pixelSize=a.toJson({x:parseFloat(this.pixelSizeX),y:parseFloat(this.pixelSizeY)}):this.pixelSize&&(b.pixelSize=this.pixelSize?a.toJson(this.pixelSize.toJson()):null),this.renderingRules&&(b.renderingRules=a.toJson(d.map(this.renderingRules,function(a){return a.toJson()}))),b}});return b("extend-esri")&&
l.setObject("tasks.ImageServiceIdentifyParameters",h,f),h})},"esri/virtualearth/VETiledLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/_base/array dojo/_base/config dojo/has dojo/string dojo/_base/Deferred ../kernel ../urlUtils ../SpatialReference ../layers/TileInfo ../layers/TiledMapServiceLayer ../geometry/Extent ../request".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u){h=h(q,{declaredClass:"esri.virtualearth.VETiledLayer",constructor:function(a){try{if(a=
l.mixin({bingMapsKey:null,culture:"en-US"},a||{}),this.url=e.getProtocolForWebResource()+"//dev.virtualearth.net/REST/v1",this._url=e.urlToObject(this.url),this.spatialReference=new c({wkid:102100}),this.tileInfo=new n({rows:256,cols:256,dpi:96,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:1,resolution:78271.5169639999,scale:2.95828763795777E8},{level:2,resolution:39135.7584820001,scale:1.47914381897889E8},{level:3,resolution:19567.8792409999,scale:7.3957190948944E7},
{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,
scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,scale:1128.497176},{level:20,resolution:.1492910708238085,scale:564.248588}]}),this.initialExtent=
this.fullExtent=new r(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,new c({wkid:102100})),l.mixin(this,a),this.hasAttributionData=this.showAttribution,this._initLayer=l.hitch(this,this._initLayer),this._errorHandler=l.hitch(this,this._errorHandler),this._getTileInfo=l.hitch(this,this._getTileInfo),!this.bingMapsKey)throw Error("BingMapsKey must be provided.");this._getTileInfo()}catch(b){throw this.onError(b),b;}},_unsetMap:function(a,b){this.inherited("_unsetMap",arguments)},
_getTileInfo:function(){if(this.mapStyle){var a=this._url.path+"/Imagery/Metadata/"+this.mapStyle;if(this.bingMapsKey){var b=this.resourceInfo;!this.loaded&&b?this._initLayer(b):u({url:a,content:l.mixin({},{key:this.bingMapsKey,ss:!0,c:this.culture,include:this.hasAttributionData?"imageryProviders":null}),callbackParamName:"jsonp",load:this._initLayer,error:this._errorHandler})}}},_initLayer:function(b,c){if(200!==b.statusCode){var f=Error();return f.code=b.statusCode,f.message=b.statusDescription,
f.details=b.errorDetails,f.authenticationResultCode=b.authenticationResultCode,void this.onError(f)}try{this.resourceInfo=a.toJson(b);var f=b.resourceSets[0].resources[0],g=f.imageUrl.replace("{","${");if(this.tileServers=d.map(f.imageUrlSubdomains,function(a){var b=e.getProtocolForWebResource();return k.substitute(g,{subdomain:a}).replace("http:",b)}),this._tsLength=this.tileServers.length,this.loaded)this.refresh(),this.onMapStyleChange();else{this.copyright=this.copyright||"\x26copy; 2012 Microsoft Corporation and its data suppliers";
this.loaded=!0;this.onLoad(this);var h=this.loadCallback;h&&(delete this.loadCallback,h(this))}}catch(m){this.onError(m)}},getAttributionData:function(){var c,d=new m,e=a.fromJson(this.resourceInfo);(this.hasAttributionData&&e&&(c=l.getObject("resourceSets.0.resources.0.imageryProviders",!1,e)),c)?d.callback({contributors:c}):(c=Error("Layer does not have attribution data"),c.log=b.isDebug,d.errback(c));return d},getTileUrl:function(a,b,c){return k.substitute(this.tileServers[b%this._tsLength].replace(/\{/g,
"${"),{quadkey:this._getQuadKey(a,b,c),culture:this.culture,token:this.bingMapsKey})},_getQuadKey:function(a,b,c){var d,e,f="";for(e=a;0<e;e--)a="0",d=1<<e-1,0!=(c&d)&&a++,0!=(b&d)&&(a++,a++),f+=a;return f},setMapStyle:function(a){this.mapStyle=a;this._getTileInfo()},setCulture:function(a){this.culture=a;this._getTileInfo()},setBingMapsKey:function(a){this.bingMapsKey=a},onMapStyleChange:function(){}});return l.mixin(h,{MAP_STYLE_AERIAL:"aerial",MAP_STYLE_AERIAL_WITH_LABELS:"aerialWithLabels",MAP_STYLE_ROAD:"road"}),
f("extend-esri")&&l.setObject("virtualearth.VETiledLayer",h,g),h})},"esri/dijit/Scalebar":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/query ../kernel ../lang ../domUtils ../units ../SpatialReference ../WKIDUnitConversion ../geometry/Point ../geometry/ScreenPoint ../geometry/Polyline ../geometry/geodesicUtils ../geometry/webMercatorUtils ../geometry/screenUtils ../geometry/normalizeUtils dojo/i18n!../nls/jsapi".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C){h=h(null,{declaredClass:"esri.dijit.Scalebar",map:null,mapUnit:null,scalebarUnit:null,unitsDictionary:[],domNode:null,screenPt1:null,screenPt2:null,localStrings:C.widgets.scalebar,constructor:function(c,e){if(this.metricScalebar=f.create("div",{innerHTML:"\x3cdiv class\x3d'esriScaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarLineLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLine esriScalebarMetricLine'\x3e\x3c/div\x3e"}),
this.englishScalebar=f.create("div",{innerHTML:"\x3cdiv class\x3d'esriScalebarLine esriScalebarEnglishLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarLineLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e"}),this.domNode=f.create("div"),c=c||{},!c.map)return void console.error("scalebar: unable to find the 'map' property in parameters");if(c.scalebarUnit){if("english"!==c.scalebarUnit&&"metric"!==c.scalebarUnit&&"dual"!==c.scalebarUnit)return void console.error("scalebar unit only accepts english or metric or dual");
this.scalebarUnit=c.scalebarUnit}else this.scalebarUnit="english";if(c.scalebarStyle){if("ruler"!==c.scalebarStyle&&"line"!==c.scalebarStyle)return void console.error("scalebar style must be ruler or line");this.scalebarStyle=c.scalebarStyle}else this.scalebarStyle="ruler";switch(this.background=c.background,this.scalebarUnit){case "english":"ruler"===this.scalebarStyle&&(this.englishScalebar.innerHTML="\x3cdiv class\x3d'esriScalebarRuler'\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_secondpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_secondpiece'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'scaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel' style\x3d'left: -3%'\x3e0\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarFirstNumber'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e");
this.domNode.appendChild(this.englishScalebar);break;case "metric":"ruler"===this.scalebarStyle&&(this.metricScalebar.innerHTML="\x3cdiv class\x3d'esriScalebarRuler'\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_secondpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_secondpiece'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'scaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel' style\x3d'left: -3%'\x3e0\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarFirstNumber'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e");
this.domNode.appendChild(this.metricScalebar);break;case "dual":this.domNode.appendChild(this.metricScalebar),this.domNode.appendChild(this.englishScalebar)}if(this.map=c.map,e?e.appendChild(this.domNode):(this.map.container.appendChild(this.domNode),c.attachTo?b.add(this.domNode,"scalebar_"+c.attachTo):b.add(this.domNode,"scalebar_bottom-left")),b.add(this.domNode,"esriScalebar"),this.map.loaded)this._getDistance(this.map.extent),this._checkBingMaps();else var g=d.connect(this.map,"onLoad",this,
function(){d.disconnect(g);g=null;this._getDistance(this.map.extent);this._checkBingMaps()});this._mapOnPan=d.connect(this.map,"onPan",this,this._getDistance);this._mapOnExtentChange=d.connect(this.map,"onExtentChange",this,this._getDistance);a.forEach(this.map.layerIds,function(a,b){"esri.virtualearth.VETiledLayer"===this.map.getLayer(a).declaredClass&&d.connect(this.map.getLayer(a),"onVisibilityChange",l.hitch(this,function(a){this._checkBingMaps()}))},this);this._mapOnLayerAdd=d.connect(this.map,
"onLayerAdd",l.hitch(this,function(a){"esri.virtualearth.VETiledLayer"===a.declaredClass&&d.connect(a,"onVisibilityChange",l.hitch(this,function(a){this._checkBingMaps()}));this._checkBingMaps()}));this._mapOnLayerRemove=d.connect(this.map,"onLayerRemove",l.hitch(this,this._checkBingMaps))},hide:function(){this._hidden=!0;q.hide(this.domNode)},show:function(){this._hidden=!1;q.show(this.domNode)},destroy:function(){d.disconnect(this._mapOnPan);d.disconnect(this._mapOnExtentChange);d.disconnect(this._mapOnLayerAdd);
d.disconnect(this._mapOnLayerRemove);this.hide();this.map=null;f.destroy(this.domNode)},_checkBingMaps:function(){b.contains(this.domNode,"scalebar_bottom-left")&&(m.set(this.domNode,"left","25px"),a.forEach(this.map.layerIds,function(a,b){if("esri.virtualearth.VETiledLayer"===this.map.getLayer(a).declaredClass&&this.map.getLayer(a).visible){var c="95px";this.map._mapParams.nav&&(c="115px");m.set(this.domNode,"left",c)}},this))},_getDistance:function(a){var b=k.position(this.domNode,!0).y-this.map.position.y,
b=b>this.map.height?this.map.height:b,b=0>b?0:b,c,d,e=new w(0,b),b=new w(this.map.width,b);this.mapUnit="esriDecimalDegrees";var f=A.toMapPoint(a,this.map.width,this.map.height,e),g=A.toMapPoint(a,this.map.width,this.map.height,b),e=new t(a.xmin,(a.ymin+a.ymax)/2,this.map.spatialReference),b=new t(a.xmax,(a.ymin+a.ymax)/2,this.map.spatialReference);if(3857===this.map.spatialReference.wkid||102100===this.map.spatialReference.wkid||102113===this.map.spatialReference.wkid||this.map.spatialReference.wkt&&
-1!=this.map.spatialReference.wkt.indexOf("WGS_1984_Web_Mercator"))f=z.webMercatorToGeographic(f,!0),g=z.webMercatorToGeographic(g,!0),e=z.webMercatorToGeographic(e,!0),b=z.webMercatorToGeographic(b,!0);else if(n.isDefined(v[this.map.spatialReference.wkid])||this.map.spatialReference.wkt&&0===this.map.spatialReference.wkt.indexOf("PROJCS")){this.mapUnit="linearUnit";a=Math.abs(a.xmax-a.xmin);if(n.isDefined(v[this.map.spatialReference.wkid]))d=v.values[v[this.map.spatialReference.wkid]];else{d=this.map.spatialReference.wkt;
c=d.lastIndexOf(",")+1;var h=d.lastIndexOf("]]");d=parseFloat(d.substring(c,h))}a*=d;d=a/1609;c=a/1E3}"esriDecimalDegrees"===this.mapUnit&&(a=new x(new u({wkid:4326})),a.addPath([f,g]),f=B._straightLineDensify(a,10),a=y.geodesicLengths([f],r.KILOMETERS)[0],f=new x(new u({wkid:4326})),f.addPath([e,b]),e=B._straightLineDensify(f,10),y.geodesicLengths([e],r.KILOMETERS),d=a/1.609,c=a);"english"===this.scalebarUnit?this._getScaleBarLength(d,"mi"):"metric"===this.scalebarUnit?this._getScaleBarLength(c,
"km"):"dual"===this.scalebarUnit&&(this._getScaleBarLength(d,"mi"),this._getScaleBarLength(c,"km"))},_getScaleBarLength:function(a,b){var c=50*a/this.map.width,d=0,e=b;for(.1>c&&("mi"===b?(c*=5280,e="ft"):"km"===b&&(c*=1E3,e="m"));1<=c;)c/=10,d++;var f,g;.5<c?(f=1,g=.5):.3<c?(f=.5,g=.3):.2<c?(f=.3,g=.2):.15<c?(f=.2,g=.15):.1<=c&&(f=.15,g=.1);f=f/c>=c/g?g:f;c=f/c*50;d=Math.pow(10,d)*f;this._drawScaleBar(c,d,e)},_drawScaleBar:function(b,c,d){var f,g,k,h=2*Math.round(b);"mi"===d||"ft"===d?(this.englishScalebar.style.width=
h+"px",f=e(".esriScalebarFirstNumber",this.englishScalebar),g=e(".esriScalebarSecondNumber",this.englishScalebar),k=e(".esriScalebarMetricLineBackground",this.englishScalebar)):(this.metricScalebar.style.width=h+"px",f=e(".esriScalebarFirstNumber",this.metricScalebar),g=e(".esriScalebarSecondNumber",this.metricScalebar),k=e(".esriScalebarMetricLineBackground",this.metricScalebar));a.forEach(k,function(a,b){a.style.width=h-2+"px"},this);a.forEach(f,function(a,b){a.innerHTML=c},this);a.forEach(g,function(a,
b){"esriUnknown"!==this.mapUnit?a.innerHTML=2*c+this.localStrings[d]:a.innerHTML=2*c+"Unknown Unit"},this)}});return g("extend-esri")&&l.setObject("dijit.Scalebar",h,c),h})},"esri/geometry/geodesicUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point ./Polyline ./Polygon".split(" "),function(h,l,a,d,b,f,k,m){function g(a){var b=Math.PI/180,c=Math.sin(a.y*b),c=.9933056200098026*(c/(1-.006694379990197414*c*c)-6.111035746609262*Math.log((1-.0818191908429643*
c)/(1+.0818191908429643*c)));return new f(6378137*a.x*b,3189068.5*c)}function e(a,c,d,e){var g,k,h,m,n=1/298.257223563,l=Math.sin(d);d=Math.cos(d);a=(1-n)*Math.tan(a);var r=1/Math.sqrt(1+a*a),q=a*r,F=Math.atan2(a,d);a=r*l*r*l;for(var H=1-a,G=2.7233160610754688E11*H/4.040829998466145E13,K=1+G/16384*(4096+G*(-768+G*(320-175*G))),J=G/1024*(256+G*(-128+G*(74-47*G))),G=e/(6356752.31424518*K),I=2*Math.PI;1E-12<Math.abs(G-I);)h=Math.cos(2*F+G),g=Math.sin(G),k=Math.cos(G),m=J*g*(h+J/4*(k*(-1+2*h*h)-J/6*h*
(-3+4*g*g)*(-3+4*h*h))),I=G,G=e/(6356752.31424518*K)+m;e=q*g-r*k*d;e=Math.atan2(q*k+r*g*d,(1-n)*Math.sqrt(a+e*e));l=Math.atan2(g*l,r*k-q*g*d);d=n/16*H*(4+n*(4-3*H));g=l-(1-d)*n*Math.sqrt(a)*(G+d*g*(h+d*k*(-1+2*h*h)));return new f((c+g)/(Math.PI/180),e/(Math.PI/180),new b({wkid:4326}))}function c(a,b,c,d){var e,f,g,k,h,m,n,l,r,q,G=1/298.257223563,K=d-b,J=Math.atan((1-G)*Math.tan(a)),I=Math.atan((1-G)*Math.tan(c)),L=Math.sin(J),J=Math.cos(J),M=Math.sin(I),I=Math.cos(I),N=K,Q=1E3;do{if(n=Math.sin(N),
l=Math.cos(N),g=Math.sqrt(I*n*I*n+(J*M-L*I*l)*(J*M-L*I*l)),0===g)return 0;h=L*M+J*I*l;m=Math.atan2(g,h);r=J*I*n/g;f=1-r*r;k=h-2*L*M/f;isNaN(k)&&(k=0);q=G/16*f*(4+G*(4-3*f));e=N;N=K+(1-q)*G*r*(m+q*g*(k+q*h*(-1+2*k*k)))}while(1E-12<Math.abs(N-e)&&0<--Q);if(0===Q)return L=6371009*Math.acos(Math.sin(a)*Math.sin(c)+Math.cos(a)*Math.cos(c)*Math.cos(d-b)),M=d-b,J=Math.sin(M)*Math.cos(c),a=Math.cos(a)*Math.sin(c)-Math.sin(a)*Math.cos(c)*Math.cos(M),{azimuth:Math.atan2(J,a),geodesicDistance:L};a=2.7233160610754688E11*
f/4.040829998466145E13;c=a/1024*(256+a*(-128+a*(74-47*a)));a=6356752.31424518*(1+a/16384*(4096+a*(-768+a*(320-175*a))))*(m-c*g*(k+c/4*(h*(-1+2*k*k)-c/6*k*(-3+4*g*g)*(-3+4*k*k))));c=Math.atan2(I*Math.sin(N),J*M-L*I*Math.cos(N));L=Math.atan2(J*Math.sin(N),J*M*Math.cos(N)-L*I);return{azimuth:c,geodesicDistance:a,reverseAzimuth:L}}function n(a,b){var d=Math.PI/180;if(637.100877151506>b&&(b=637.100877151506),!(a instanceof k||a instanceof m))throw console.error("_geodesicDensify: the input geometry is neither polyline nor polygon"),
Error("_geodesicDensify: the input geometry is neither polyline nor polygon");var f,g=a instanceof k,n=[];return h.forEach(g?a.paths:a.rings,function(a){n.push(f=[]);f.push([a[0][0],a[0][1]]);var g,k,h,m,l,r;g=a[0][0]*d;k=a[0][1]*d;for(l=0;l<a.length-1;l++)if(h=a[l+1][0]*d,m=a[l+1][1]*d,g!==h||k!==m){var u=c(k,g,m,h),q=u.azimuth,u=u.geodesicDistance,x=u/b;if(1<x){for(r=1;x-1>=r;r++){var J=e(k,g,q,r*b);f.push([J.x,J.y])}r=e(k,g,q,(u+Math.floor(x-1)*b)/2);f.push([r.x,r.y])}k=e(k,g,q,u);f.push([k.x,
k.y]);g=k.x*d;k=k.y*d}}),g?new k({paths:n,spatialReference:a.spatialReference}):new m({rings:n,spatialReference:a.spatialReference})}var q={esriMeters:1,esriKilometers:1E3,esriYards:.9144,esriFeet:.3048,esriMiles:1609.344,esriNauticalMiles:1852,esriInches:.0254,esriDecimeters:.1,esriCentimeters:.01,esriMillimeters:.001,esriSquareMeters:1,esriSquareKilometers:1E6,esriSquareYards:.83612736,esriSquareFeet:.09290304,esriSquareMiles:2589988.110336,esriAcres:4046.8564224,esriHectares:1E4,esriAres:100,esriSquareInches:6.4516E-4,
esriSquareMillimeters:1E-6,esriSquareCentimeters:1E-4,esriSquareDecimeters:.01},r={geodesicDensify:n,geodesicLengths:function(a,b){var d=Math.PI/180,e=[];return h.forEach(a,function(a,f){var g=0;h.forEach(a.paths,function(a,b){var e,f,k,h,m,n,l=0;for(e=1;e<a.length;e++)f=a[e-1][0]*d,k=a[e][0]*d,h=a[e-1][1]*d,m=a[e][1]*d,(h!==m||f!==k)&&(n=c(h,f,m,k),l+=n.geodesicDistance);g+=l});g/=q[b];e.push(g)}),e},geodesicAreas:function(a,b){var c=[];h.forEach(a,function(a,b){var d=n(a,1E4);c.push(d)});var d,
e,k=[];return h.forEach(c,function(a,c){var m=0;h.forEach(a.rings,function(a,b){d=g(new f(a[0][0],a[0][1]));e=g(new f(a[a.length-1][0],a[a.length-1][1]));var c,k=e.x*d.y-d.x*e.y;for(c=0;c<a.length-1;c++)d=g(new f(a[c+1][0],a[c+1][1])),e=g(new f(a[c][0],a[c][1])),k+=e.x*d.y-d.x*e.y;m+=k});m/=q[b];k.push(m/-2)}),k},_unitsDictionary:q,_toEqualAreaPoint:g,_directGeodeticSolver:e,_inverseGeodeticSolver:c};return a("extend-esri")&&l.mixin(l.getObject("geometry",!0,d),r),r})},"esri/SnappingManager":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/Deferred dojo/has dojo/keys ./kernel ./graphic ./geometry/ScreenPoint ./geometry/Extent ./symbols/SimpleMarkerSymbol ./symbols/SimpleLineSymbol ./tasks/query".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u){h=h(null,{declaredClass:"esri.SnappingManager",constructor:function(c){if(c=c||{},c.map||console.error("map is not specified for SnappingManager"),this.map=c.map,this.tolerance=c.tolerance||15,this.layerInfos=[],c.layerInfos)this.layerInfos=c.layerInfos;else{var d;for(d=0;d<this.map.graphicsLayerIds.length;d++){var f=this.map.getLayer(this.map.graphicsLayerIds[d]);this.layerInfos.push({layer:f})}if(this.map.loaded)this.layerInfos.push({layer:this.map.graphics});
else var g=l.connect(this.map,"onLoad",this,function(a){l.disconnect(g);g=null;this.layerInfos.push({layer:this.map.graphics});this.setLayerInfos(this.layerInfos)})}c.snapPointSymbol?this.snapPointSymbol=c.snapPointSymbol:this.snapPointSymbol=new q(q.STYLE_CROSS,15,new r(r.STYLE_SOLID,new b([0,255,255]),1),new b([0,255,0,0]));c.alwaysSnap?this.alwaysSnap=c.alwaysSnap:this.alwaysSnap=!1;c.snapKey?this.snapKey=c.snapKey:this.snapKey=k("mac")?m.META:m.CTRL;this._SelectionLyrQuery=new u;this._SelectionLyrQuery.spatialRelationship=
u.SPATIAL_REL_INTERSECTS;this._snappingGraphic=new e;this.setLayerInfos(this.layerInfos);this._currentGraphicOption={snapToPoint:!0,snapToVertex:!0,snapToEdge:!0};this._snappingCallback=a.hitch(this,this._snappingCallback)},getSnappingPoint:function(b){var c=this.layers,e=this.tolerance,g=this.map,k=this.layerOptions,h=g.toMap(b.offset(-e,e)),e=g.toMap(b.offset(e,-e)),h=new n(h.x,h.y,e.x,e.y,g.spatialReference),m=new u;m.geometry=h;m.spatialRelationship=u.SPATIAL_REL_INTERSECTS;var l,r,q=[],E=[],
F=this._extractPointsAndLines,H=new f,G=0,e=h.xmin,K=h.xmax;d.forEach(c,function(a,b){a.visible&&a.loaded&&"esri.layers.FeatureLayer"===a.declaredClass&&a.mode!==a.constructor.MODE_SELECTION&&G++});g.spatialReference._isWrappable()&&(e=n.prototype._normalizeX(h.xmin,g.spatialReference._getInfo()).x,K=n.prototype._normalizeX(h.xmax,g.spatialReference._getInfo()).x);var J=new n(e,h.ymin,K,h.ymax,g.spatialReference);d.forEach(c,function(a,b){if("esri.layers.GraphicsLayer"===a.declaredClass&&a.visible){var c=
[];d.forEach(a.graphics,function(a){a&&a.visible&&J.intersects(a.geometry)&&c.push(a)});var e=F(c,k[b]);q=q.concat(e[0]);E=E.concat(e[1])}});var I=a.hitch(this,function(a){(G--,a instanceof Error)||(a=F(a.features,k[r]),q=q.concat(a[0]),E=E.concat(a[1]));G||(l=this._getSnappingPoint(q,E,b),H.callback(l))}),L=!1;return d.forEach(c,function(a,b){a.visible&&a.loaded&&(r=b,"esri.layers.FeatureLayer"===a.declaredClass&&a.mode!==a.constructor.MODE_SELECTION&&(L=!0,a.queryFeatures(m,I,I)))}),L||(l=this._getSnappingPoint(q,
E,b),H.callback(l)),H},setLayerInfos:function(a){this.layers=[];this.layerOptions=[];var b;for(b=0;b<a.length;b++)this.layers.push(a[b].layer),this.layerOptions.push({snapToPoint:!0,snapToVertex:!0,snapToEdge:!0}),!1===a[b].snapToPoint&&(this.layerOptions[b].snapToPoint=a[b].snapToPoint),!1===a[b].snapToVertex&&(this.layerOptions[b].snapToVertex=a[b].snapToVertex),!1===a[b].snapToEdge&&(this.layerOptions[b].snapToEdge=a[b].snapToEdge);this._featurePtsFromSelectionLayer=[];this._featureLinesFromSelectionLayer=
[];this._selectionLayers=[];this._selectionLayerOptions=[];d.forEach(this.layers,function(a,b){"esri.layers.FeatureLayer"===a.declaredClass&&a.mode===a.constructor.MODE_SELECTION&&(this._selectionLayers.push(a),this._selectionLayerOptions.push(this.layerOptions[b]))},this);this.layerInfos=a},destroy:function(){l.disconnect(this._onExtentChangeConnect);this._killOffSnapping();this._featurePtsFromSelectionLayer=this._featureLinesFromSelectionLayer=this._currentFeaturePts=this._currentFeatureLines=this.layers=
this.map=null},_startSelectionLayerQuery:function(){l.disconnect(this._onExtentChangeConnect);this._mapExtentChangeHandler(this._selectionLayers,this._selectionLayerOptions,this.map.extent);this._onExtentChangeConnect=l.connect(this.map,"onExtentChange",a.hitch(this,"_mapExtentChangeHandler",this._selectionLayers,this._selectionLayerOptions))},_stopSelectionLayerQuery:function(){l.disconnect(this._onExtentChangeConnect)},_mapExtentChangeHandler:function(b,c,e){this._featurePtsFromSelectionLayer=[];
this._featureLinesFromSelectionLayer=[];var f;this._SelectionLyrQuery.geometry=e;var g=a.hitch(this,function(a){a instanceof Error||(a=this._extractPointsAndLines(a.features,c[f]),this._featurePtsFromSelectionLayer=this._featurePtsFromSelectionLayer.concat(a[0]),this._featureLinesFromSelectionLayer=this._featureLinesFromSelectionLayer.concat(a[1]))});d.forEach(b,function(a,b){a.visible&&a.loaded&&(f=b,a.queryFeatures(this._SelectionLyrQuery,g,g))},this)},_extractPointsAndLines:function(a,b){var c,
e,f=[],g=[];return d.forEach(a,function(a,d){if((!a._graphicsLayer||a.visible)&&a.geometry)if("point"===a.geometry.type&&b.snapToPoint)f.push(a.geometry);else if("polyline"===a.geometry.type)for(c=0;c<a.geometry.paths.length;c++){g.push("lineStart");for(e=0;e<a.geometry.paths[c].length;e++){var k=a.geometry.getPoint(c,e);b.snapToVertex&&f.push(k);b.snapToEdge&&g.push(k)}g.push("lineEnd")}else if("polygon"===a.geometry.type)for(c=0;c<a.geometry.rings.length;c++){g.push("lineStart");for(e=0;e<a.geometry.rings[c].length;e++)k=
a.geometry.getPoint(c,e),b.snapToVertex&&f.push(k),b.snapToEdge&&g.push(k);g.push("lineEnd")}}),[f,g]},_getSnappingPoint:function(a,b,e){var f,g,k=this.tolerance,h=this.map,m=this.map._getFrameWidth();if(a=a.concat(this._featurePtsFromSelectionLayer),b=b.concat(this._featureLinesFromSelectionLayer),this._currentGraphic){var n=this._extractPointsAndLines([this._currentGraphic],this._currentGraphicOption);a=a.concat(n[0]);b=b.concat(n[1])}var l,r;if(d.forEach(a,function(a,b){var c=h.toScreen(a,!0);
if(-1!==m&&(c.x%=m,0>c.x&&(c.x+=m),h.width>m))for(var d=(h.width-m)/2;c.x<d;)c.x+=m;f=Math.sqrt((c.x-e.x)*(c.x-e.x)+(c.y-e.y)*(c.y-e.y));k>=f&&(k=f,l=c.x,r=c.y)}),l)b=new c(l,r),g=b=h.toMap(b);else{var q,u,k=this.tolerance;for(a=0;a<b.length;a++)if("lineStart"===b[a])for(n=a+1;n<b.length;n++){if("lineEnd"!==b[n+1]&&"lineStart"!==b[n+1]&&"lineEnd"!==b[n]&&"lineStart"!==b[n]){var G=h.toScreen(b[n],!0),K=h.toScreen(b[n+1],!0),J=G.x>=K.x?G:K,I=G.x>=K.x?K:G;-1!==m&&(J.x%=m,0>J.x&&(J.x+=m),I.x%=m,0>I.x&&
(I.x+=m),I.x>J.x&&(I.x-=m));var L,M,N,Q,O,G=J.x,K=J.y,T=I.x,I=I.y;G===T?(J=G,L=e.y,M=N=G,Q=I>=K?K:I,O=I>=K?I:K):K===I?(J=e.x,L=K,M=T>=G?G:T,N=T>=G?T:G,Q=O=K):(L=(I-K)/(T-G),M=(K*T-G*I)/(T-G),J=(M-(e.y*I-e.y*K-e.x*G+e.x*T)/(I-K))/((G-T)/(I-K)-L),L=L*J+M,M=T>=G?G:T,N=T>=G?T:G,Q=I>=K?K:I,O=I>=K?I:K);if(J>=M&&N>=J&&L>=Q&&O>=L)G=Math.sqrt((e.x-J)*(e.x-J)+(e.y-L)*(e.y-L)),k>=G&&(k=G,q=J,u=L);else{var S;M=Math.sqrt((G-e.x)*(G-e.x)+(K-e.y)*(K-e.y));N=Math.sqrt((T-e.x)*(T-e.x)+(I-e.y)*(I-e.y));N>=M?(S=M,J=
G,L=K):(S=N,J=T,L=I);k>=S&&(k=S,q=J,u=L)}}if("lineEnd"===b[n]){a=n;break}}q&&(b=new c(q,u),g=b=h.toMap(b))}return g},_setGraphic:function(a){this._currentGraphic=a},_addSnappingPointGraphic:function(){var a=this.map;this._snappingGraphic.setSymbol(this.snapPointSymbol);a.graphics.add(this._snappingGraphic)},_setUpSnapping:function(){var a=this.map;this._onSnapKeyDown_connect=l.connect(a,"onKeyDown",this,"_onSnapKeyDownHandler");this._onSnapKeyUp_connect=l.connect(a,"onKeyUp",this,"_onSnapKeyUpHandler");
this._onSnappingMouseMove_connect=l.connect(a,"onMouseMove",this,"_onSnappingMouseMoveHandler");this._onSnappingMouseDrag_connect=l.connect(a,"onMouseDrag",this,"_onSnappingMouseMoveHandler");this.alwaysSnap&&this._activateSnapping()},_killOffSnapping:function(){l.disconnect(this._onSnapKeyDown_connect);l.disconnect(this._onSnapKeyUp_connect);l.disconnect(this._onSnappingMouseMove_connect);l.disconnect(this._onSnappingMouseDrag_connect);this._deactivateSnapping()},_onSnapKeyDownHandler:function(a){a.keyCode===
this.snapKey&&(l.disconnect(this._onSnapKeyDown_connect),this.alwaysSnap?this._deactivateSnapping():this._activateSnapping())},_activateSnapping:function(){this._snappingActive=!0;this._addSnappingPointGraphic();this._currentLocation&&this._onSnappingMouseMoveHandler(this._currentLocation)},_onSnapKeyUpHandler:function(a){a.keyCode===this.snapKey&&(this._onSnapKeyDown_connect=l.connect(this.map,"onKeyDown",this,"_onSnapKeyDownHandler"),this.alwaysSnap?this._activateSnapping():this._deactivateSnapping())},
_deactivateSnapping:function(){this._snappingActive=!1;this._snappingPoint=null;this.map.graphics.remove(this._snappingGraphic);this._snappingGraphic.setGeometry(null)},_onSnappingMouseMoveHandler:function(a){if(this._currentLocation=a,this._snappingPoint=null,this._snappingActive)this._snappingGraphic.hide(),this.getSnappingPoint(a.screenPoint).addCallback(this._snappingCallback)},_snappingCallback:function(a){(this._snappingPoint=a)&&(this._snappingGraphic.show(),this._snappingGraphic.setGeometry(a))}});
return k("extend-esri")&&(g.SnappingManager=h),h})},"esri/dijit/editing/Editor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/DeferredList dojo/dom-class dojo/dom-construct dojo/string dijit/_Widget dijit/_Templated ../../domUtils ../../graphicsUtils ../../geometry/Polyline ../../geometry/Polygon ../../graphic ../../undoManager ../../tasks/query ../../layers/FeatureLayer ../../layers/FeatureTemplate ../../toolbars/draw ../../toolbars/edit ../AttributeInspector ./Util ./Add ./Update ./Delete ./Cut ./Union ./toolbars/Drawing ./SelectionHelper ./TemplatePicker ../../kernel ../../config dojo/i18n!../../nls/jsapi dojo/text!./templates/Editor.html dijit/ProgressBar dojo/NodeList-dom".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K,J,I,L,M,N,Q,O,T){var S=h([n,q],{declaredClass:"esri.dijit.editing.Editor",widgetsInTemplate:!0,templateString:T,onLoad:function(){},constructor:function(a,b){a=a||{};a.settings||console.error("Editor: please provide 'settings' parameter in the constructor");a.settings.layerInfos||console.error("Editor: please provide 'layerInfos' parameter in the constructor");this._settings=a.settings;this._eConnects=[]},startup:function(){this.inherited(arguments);
this._setDefaultOptions();var b=this._settings.layerInfos;if(a.every(b,function(a){return a.featureLayer.loaded}))this._initLayers(),this._connectEvents(),this._createWidgets(),this.onLoad(),this.loaded=!0;else{var c=b.length;a.forEach(b,function(a){a=a.featureLayer;if(a.loaded)c--;else var b=d.connect(a,"onLoad",this,function(a){d.disconnect(b);b=null;c--;c||(this._initLayers(),this._connectEvents(),this._createWidgets(),this.onLoad(),this.loaded=!0)})},this)}this._reset();this._enableMapClickHandler()},
stopEditing:function(a){this._updateCurrentFeature(l.hitch(this,function(){this._clearSelection(!1);a&&a()}))},destroy:function(){this.drawingToolbar&&this.drawingToolbar.destroy();this.attributeInspector&&this.attributeInspector.destroy();this.templatePicker&&this.templatePicker.destroy();this._selectionHelper&&this._selectionHelper.destroy();this._drawToolbar&&this._drawToolbar.deactivate();this._reset();this._disableMapClickHandler();a.forEach(this._eConnects,d.disconnect);d.disconnect(this._dtConnect);
d.disconnect(this._templatePickerOnSelectionChangeEvent);this._layer=this._currentGraphic=this._activeType=this._activeTemplate=this._drawingTool=this._drawToolbar=this.editToolbar=this.drawingToolbar=this.attributeInspector=this.templatePicker=this.undoManager=null;this._settings.map.infoWindow&&this._settings.map.infoWindow.clearFeatures&&this._settings.map.infoWindow.clearFeatures();this.inherited(arguments)},_setDefaultOptions:function(){this._drawToolbar=this._settings.drawToolbar||new B(this._settings.map);
this._settings.drawToolbar=this._drawToolbar;this.editToolbar=this._settings.editToolbar||new C(this._settings.map,{textSymbolEditorHolder:this.domNode});this._settings.editToolbar=this.editToolbar;this._settings.toolbarVisible=this._settings.toolbarVisible||!1;this._settings.toolbarOptions=l.mixin({reshapeVisible:!1,cutVisible:!1,mergeVisible:!1},this._settings.toolbarOptions);this._settings.createOptions=l.mixin({polylineDrawTools:[S.CREATE_TOOL_POLYLINE],polygonDrawTools:[S.CREATE_TOOL_POLYGON],
editAttributesImmediately:!0},this._settings.createOptions);this._settings.singleSelectionTolerance=this._settings.singleSelectionTolerance||3;this._settings.maxUndoRedoOperations=this._settings.maxUndoRedoOperations||10;this._settings.editor=this;this._usePopup=this._settings.usePopup=this._settings.map.infoWindow._setPagerCallbacks?!0:!1;this._datePackage=this._settings.datePackage;var a=Q.defaults;this._settings.geometryService=this._settings.geometryService||a.geometryService;a.geometryService=
a.geometryService||this._settings.geometryService},_initLayers:function(){this._settings.layers=[];this._settings.userIds={};this._settings.createOnlyLayer={};a.forEach(this._settings.layerInfos,function(a){if(a.featureLayer&&a.featureLayer.loaded){this._settings.layers.push(a.featureLayer);var b=a.featureLayer.id;a.featureLayer.credential&&(this._settings.userIds[b]=a.featureLayer.credential.userId);a.userId&&(this._settings.userIds[b]=a.userId);var c=a.featureLayer.getEditCapabilities();c.canCreate&&
!c.canUpdate?this._settings.createOnlyLayer[b]=!0:this._settings.createOnlyLayer[b]=!1;this._isTextSymbolPointLayer(a.featureLayer)&&(a.disableAttributeUpdate=!0)}},this)},_reset:function(){this._hideAttributeInspector();this.editToolbar.deactivate();this._editVertices=!0;this._drawingTool=this._activeTemplate=this._activeType=this._currentGraphic=this._layer=null;this._attributeChanged=!1},_saveFeatureOnClient:function(a){var b,c=this.templatePicker.getSelected();b=c.template?c.featureLayer.renderer.getSymbol(c.template.prototype):
c.symbolInfo.symbol;this._tempGraphic=new w(a,b,null,null);this._tempGraphic.setAttributes(l.mixin({},c.template.prototype.attributes));b=this._settings.map;b.graphics.add(this._tempGraphic);a=this._findCenterPoint(a);this._createAttributeInspector(!0);b.infoWindow.setTitle(c.featureLayer?c.featureLayer.name:O.widgets.attributeInspector.NLS_title);this.attributeInspector.showFeature(this._tempGraphic,c.featureLayer);this._showInfoWindow(a,b.getInfoWindowAnchor(a));this._settings.createOnlyLayer[c.featureLayer.id]&&
(this._infoWindowHideEvent=d.connect(b.infoWindow,"onHide",this,"_infoWindowHide"));d.disconnect(this._templatePickerOnSelectionChangeEvent);this.templatePicker.clearSelection();this._drawToolbar.deactivate();this._enableMapClickHandler();this.drawingToolbar&&this.drawingToolbar.deactivate();this._templatePickerOnSelectionChangeEvent=d.connect(this.templatePicker,"onSelectionChange",l.hitch(this,"_onCreateFeature"))},_saveAttributesOnClient:function(a,b,c){this._tempGraphic.attributes[b]="number"==
typeof c&&isNaN(c)?null:c},_infoWindowHide:function(){this._createFeature(this._tempGraphic.geometry,this._tempGraphic.attributes);d.disconnect(this._infoWindowHideEvent)},_createFeature:function(b,c){return this._editClickPoint=this._findCenterPoint(b),b.rings?void this._simplify(b,l.hitch(this,function(b){this._drawingTool!==A.TOOL_AUTO_COMPLETE_POLYGON?this._applyEdits([{layer:this._layer,adds:[this._createGraphic(b,c)]}],l.hitch(this,function(){this._chainAttachment(this._oEdits[0].adds[0].attributes[this._oEdits[0].layer.objectIdField],
this._oEdits[0].layer)})):this._autoComplete(b,l.hitch(this,function(b){b&&b.length&&this._applyEdits([{layer:this._layer,adds:a.map(b,l.hitch(this,function(a){return this._createGraphic(a,c)}))}],function(){this._chainAttachment(this._oEdits[0].adds[0].attributes[this._oEdits[0].layer.objectIdField],this._oEdits[0].layer)})}))})):void this._applyEdits([{layer:this._layer,adds:[this._createGraphic(b,c)]}],l.hitch(this,function(){this._chainAttachment(this._oEdits[0].adds[0].attributes[this._oEdits[0].layer.objectIdField],
this._oEdits[0].layer);this._layer&&this._layer.renderer&&"heatmap"===this._layer.renderer.type&&this._layer.refresh()}))},_chainAttachment:function(a,b){this.attributeInspector&&this.attributeInspector._attachmentEditor&&this.attributeInspector._attachmentEditor._tempUpload&&this.attributeInspector._attachmentEditor._chainAttachment(a,b)},_updateCurrentFeature:function(a){var b=this._isModified();b?this._updateFeature(b,a):a&&a(!1)},_updateFeature:function(a,b,c){var d,e=a.geometry,f=a.getLayer();
f.hasM&&!f.allowUpdateWithoutMValues||c&&!this._isModified()?(d=new w,d.setAttributes(a.attributes),this._applyEdits([{layer:a.getLayer(),updates:[d]}],b)):e.rings?this._simplify(e,l.hitch(this,function(c){this._applyEdits([{layer:a.getLayer(),updates:[l.mixin(a,{geometry:c})]}],b)})):this._applyEdits([{layer:a.getLayer(),updates:[a]}],b)},_deleteFeature:function(b,c){var d=[];b?d.push({layer:b.getLayer(),deletes:[b]}):(d=a.map(a.filter(this._settings.layers,function(a){return 0<a.getSelectedFeatures().length}),
function(a){return{layer:a,deletes:a.getSelectedFeatures()}}))&&d.length||!this._currentGraphic||d.push({layer:this._layer,deletes:[this._currentGraphic]});this._applyEdits(d,c)},_stopEditing:function(a,b,c,d){r.hide(this.progressBar.domNode);this._settings.createOnlyLayer[a.id]||this._undoRedoAdd();var e;if(!0===a._isSelOnly||1===a.mode||6===a.mode){if(b&&b.length){this.templatePicker.clearSelection();var f=new y;f.objectIds=[b[0].objectId];this._settings.createOnlyLayer[a.id]?this._settings.map.graphics.remove(this._tempGraphic):
this._selectFeatures([a],f,l.hitch(this,"_onEditFeature"))}}else(e=this._selectionHelper.findMapService(this._settings.map,a))&&e.refresh(),b&&b.length&&(this.templatePicker.clearSelection(),this._settings.createOnlyLayer[a.id]?this._settings.map.graphics.remove(this._tempGraphic):E.findFeatures(b,a,l.hitch(this,"_onEditFeature")));d&&d.length&&(this._clearSelection(!0),this._undoRedo&&(e=this._selectionHelper.findMapService(a,this._settings.map),e&&e.refresh()));this._undoRedo&&c&&c.length&&(e=this._selectionHelper.findMapService(a,
this._settings.map),e&&e.refresh(),this.attributeInspector.refresh(),this._undoRedo=!1);this.drawingToolbar&&this.drawingToolbar._updateUI();this._undoRedo=!1},_undoRedoAdd:function(){if(this._settings._isApplyEditsCall=!1,this._settings.undoManager){var a=this._edits&&this._edits.length?this._edits[0]:null;if(a){var b=a.adds||[],c=a.updates||[],d=a.deletes||[],e=a.preUpdates||[],a={featureLayer:a.layer};"CUT"===this._activeTool?b.length&&c.length&&e.length&&this.undoManager.add(new K(l.mixin(a,{preUpdatedGraphics:e,
addedGraphics:b,postUpdatedGraphics:c}))):"UNION"===this._activeTool?d.length&&c.length&&e.length&&this.undoManager.add(new J(l.mixin(a,{preUpdatedGraphics:e,deletedGraphics:d,postUpdatedGraphics:c}))):b.length?this.undoManager.add(new F(l.mixin(a,{addedGraphics:b}))):d.length?this.undoManager.add(new G(l.mixin(a,{deletedGraphics:d}))):c.length&&(this._rollbackGraphic||e.length)&&this.undoManager.add(new H(l.mixin(a,{preUpdatedGraphics:e.length?e:[this._rollbackGraphic],postUpdatedGraphics:c})));
this._rollbackGraphic=this._edits=null}}},_activateDrawToolbar:function(a){this._layer=a.featureLayer;this._activeType=a.type;this._drawingTool=(this._activeTemplate=a.template)?this._activeTemplate.drawingTool:null;this._drawTool=this._toDrawTool(this._drawingTool,a.featureLayer);d.disconnect(this._dtConnect);this._settings.createOnlyLayer[a.featureLayer.id]?this._dtConnect=d.connect(this._drawToolbar,"onDrawEnd",this,"_saveFeatureOnClient"):this._dtConnect=d.connect(this._drawToolbar,"onDrawEnd",
this,"_createFeature");this.editToolbar.deactivate();this._disableMapClickHandler();this.drawingToolbar?this.drawingToolbar.activateEditing(this._drawTool,this._layer):this._drawToolbar.activate(this._drawTool)},_activateEditToolbar:function(b,c){var d=b.getLayer(),e=d?d.geometryType:null,f=this._isTextSymbolPoint(b),g=C.MOVE;"esriGeometryPoint"!==e&&!0===this._isNotesFeature(b)?(g=g|C.ROTATE|C.SCALE,this._editVertices=!1):"esriGeometryPoint"!==e&&!0===this._editVertices?(g=g|C.ROTATE|C.SCALE,this._editVertices=
!1):f?(g=g|C.ROTATE|C.SCALE|C.EDIT_TEXT,this._editVertices=!1):(g|=C.EDIT_VERTICES,this._editVertices=!0);this._attributeChanged=this._isModified();this._rollbackGraphic=new w(b.toJson());var e=d.getEditCapabilities({feature:b,userId:this._settings.userIds[d.id]}),k=a.filter(this._settings.layerInfos,function(a){return a.featureLayer.layerId===d.layerId})[0];(e.canUpdate&&!k.disableGeometryUpdate&&d.allowGeometryUpdates&&(this.editToolbar.activate(g,b),f&&(this.editToolbar._textEditor._addTextBox(b),
this.editToolbar._textSymbolEditor&&this.editToolbar._textSymbolEditor.hide())),this._settings.map.infoWindow.isShowing||this._updateAttributeDisabled(b))||(f=c&&c.screenPoint||this._findCenterPoint(b),this._showInfoWindow(f,this._settings.map.getInfoWindowAnchor(f)))},_createGraphic:function(b,c){var d=new w(b,this._activeType&&this._activeType.symbol||this._layer.defaultSymbol,c);return this._activeTemplate||c?d.attributes=c||l.mixin({},this._activeTemplate.prototype.attributes):(d.attributes=d.attributes||
[],a.forEach(this._layer.fields,function(a){d.attributes[a.name]=null},this)),d},_connectEvents:function(){var b=this._settings.layers;a.forEach(b,function(a){this._connect(a,"onEditsComplete",l.hitch(this,"_stopEditing",a))},this);a.forEach(b,function(a){this._connect(a,"onBeforeApplyEdits",l.hitch(this,function(){r.show(this.progressBar.domNode);this._settings._isApplyEditsCall=!0}))},this);this._connect(this.editToolbar,"onGraphicClick",l.hitch(this,"_activateEditToolbar"));this._connect(this.editToolbar,
"onGraphicFirstMove",l.hitch(this,"_hideAttributeInspector"));this._connect(this.editToolbar,"onVertexFirstMove",l.hitch(this,"_hideAttributeInspector"));this._connect(this.editToolbar,"onScaleStart",l.hitch(this,"_hideAttributeInspector"));this._connect(this.editToolbar,"onRotateStart",l.hitch(this,"_hideAttributeInspector"))},_connect:function(a,b,c){this._eConnects.push(d.connect(a,b,c))},_createWidgets:function(){this._selectionHelper=new L(this._settings);this._createTemplatePicker();this._createAttributeInspector();
this._createDrawingToolbar();this._createUndoRedoManager()},_createTemplatePicker:function(){if(this._settings.templatePicker)this.templatePicker=this._settings.templatePicker,r.hide(this.templatePickerDiv);else{var b=a.filter(this._settings.layers,function(a){return a.getEditCapabilities().canCreate});this.templatePicker=new M({"class":"esriTemplatePicker",featureLayers:b,showTooltip:!0,maxLabelLength:this._settings.typesCharacterLimit,columns:"auto",rows:"auto"},this.templatePickerDiv);this.templatePicker.startup();
this._settings.templatePicker=this.templatePicker}this._templatePickerOnSelectionChangeEvent=d.connect(this.templatePicker,"onSelectionChange",l.hitch(this,"_onCreateFeature"))},_createAttributeInspector:function(c){if(this._settings.attributeInspector)this._customAttributeInspector=!0,this.attributeInspector=this._settings.attributeInspector;else{this._customAttributeInspector=!1;var d=this._settings.map;this.attributeInspector=new D({layerInfos:this._settings.layerInfos,hideNavButtons:this._usePopup,
datePackage:this._datePackage},e.create("div"));this.attributeInspector.startup();d.infoWindow.setContent(this.attributeInspector.domNode);d.infoWindow.setTitle(O.widgets.attributeInspector.NLS_title);d.infoWindow.resize(350,375);b.query(".esriAttributeInspector .atiLayerName").style({display:"none"})}this._connect(this.attributeInspector,"onDelete",l.hitch(this,"_deleteFeature"));this._connect(this.attributeInspector,"onNext",l.hitch(this,function(a){this._updateCurrentFeature(l.hitch(this,function(){this._attributeChanged=
!1;this._onEditFeature(a)}))}));this._usePopup&&this._settings.map.infoWindow._setPagerCallbacks(this.attributeInspector,l.hitch(this.attributeInspector,"next"),l.hitch(this.attributeInspector,"previous"));c?this._connect(this.attributeInspector,"onAttributeChange",l.hitch(this,"_saveAttributesOnClient")):this._connect(this.attributeInspector,"onAttributeChange",l.hitch(this,function(b,c,d){var e=b.getLayer();(e=a.filter(e.fields,function(a){return a.name===c})[0])&&""===d&&(d=null);this._rollbackGraphic=
new w(l.clone(b.toJson()));this.attributeInspector._rollbackInfo={field:e,graphic:this._rollbackGraphic};this._currentGraphic.attributes[c]="number"==typeof d&&isNaN(d)?null:d;this._currentGraphic.setAttributes(this._currentGraphic.attributes);this._updateFeature(this._currentGraphic,null,!0);this._attributeChanged=!1}))},_createDrawingToolbar:function(){!0===this._settings.toolbarVisible&&(this.drawingToolbar=new I({"class":"esriDrawingToolbar",drawToolbar:this._drawToolbar,editToolbar:this.editToolbar,
settings:this._settings,onDelete:l.hitch(this,"_deleteFeature"),onApplyEdits:l.hitch(this,"_applyEdits"),onShowAttributeInspector:l.hitch(this,"_onEditFeature")},this.drawingToolbarDiv))},_createUndoRedoManager:function(){(this._settings.enableUndoRedo||this._settings.undoManager)&&(this._settings.enableUndoRedo=!0,this.undoManager=this._settings.undoManager,this.undoManager||(this.undoManager=this._settings.undoManager=new x({maxOperations:this._settings.maxUndoRedoOperations})),this._connect(this.undoManager,
"onUndoComplete",l.hitch(this,this._updateUndoRedoOperations)),this._connect(this.undoManager,"onRedoComplete",l.hitch(this,this._updateUndoRedoOperations)),this._connect(document,"onkeypress",l.hitch(this,function(a){(a.metaKey||a.ctrlKey)&&("z"===a.charOrCode&&this._undo(),"y"===a.charOrCode&&this._redo())})))},_updateUndoRedoOperations:function(a){if(a&&a.addedIds){var b;for(b=0;b<this.undoManager.length;b++){var c=this.undoManager.get(b);c&&a.layer===c._featureLayer&&c.updateObjectIds(a.oldIds,
a.addedIds)}}a&&"Update Features"===a.operation.label&&this.attributeInspector.refresh()},_enableMapClickHandler:function(){this._mapClickHandler=d.connect(this._settings.map,"onClick",l.hitch(this,function(a){return this._drawToolbar._geometryType?void 0:"SELECT"===this._activeTool?void(this._activeTool=""):void this._updateCurrentFeature(l.hitch(this,function(){this._reset();this._updateSelection(a)}))}))},_disableMapClickHandler:function(){d.disconnect(this._mapClickHandler)},_onCreateFeature:function(){var a=
this.templatePicker.getSelected();a?this._updateCurrentFeature(l.hitch(this,function(){this._currentGraphic&&this._clearSelection(!1);this._reset();this._activateDrawToolbar(a)})):(this._reset(),d.disconnect(this._dtConnect),this._drawToolbar.deactivate(),this._enableMapClickHandler(),this.drawingToolbar&&this.drawingToolbar.deactivate())},_isTextSymbolPoint:function(a){if("point"===a.geometry.type||"multipoint"===a.geometry.type){var b=a.getLayer(),c=b.renderer;a=a.symbol||b._getSymbol(a);if(!a&&
(c.hasVisualVariables("sizeInfo",!1)||c.hasVisualVariables("colorInfo",!1)||c.hasVisualVariables("opacityInfo",!1))&&c.addBreak&&c.infos&&1===c.infos.length&&(a=c.infos[0].symbol||c.defaultSymbol),a&&"textsymbol"===a.type)return!0}return!1},_isTextSymbolPointLayer:function(a){return"esriGeometryPoint"===a.geometryType&&a.renderer&&a.renderer._symbols&&a.renderer._symbols[0]&&a.renderer._symbols[0].symbol&&"textsymbol"===a.renderer._symbols[0].symbol.type?!0:!1},_updateAttributeDisabled:function(a){a=
a.getLayer();if(!a)return!1;var b,c,d=!1;for(b=0;b<this._settings.layerInfos.length;b++)if(c=this._settings.layerInfos[b],c.featureLayer==a){d=c.disableAttributeUpdate;break}return d},_onEditFeature:function(a,b){var d,e,f;(a=(l.isArray(a)?a[0]:a)||null)&&(this._layer=a.getLayer(),this._customAttributeInspector||this._updateAttributeDisabled(a)||(b=b||this._editClickPoint||this._findCenterPoint(a),1<this._currentFeatureCount?(this._popupFeatures.indexOf(a),d=this._currentFeatureCount-this._popupFeatures.indexOf(a)+
1,d>this._currentFeatureCount&&(d=1),e=c.substitute(O.widgets.popup.NLS_pagingInfo,{index:d,total:this._currentFeatureCount}),this._settings.map.infoWindow.setTitle(e)):(e=this._layer?this._layer.name:O.widgets.attributeInspector.NLS_title,this._settings.map.infoWindow.setTitle(e)),(this.drawingToolbar||!this._settings.map.infoWindow.isShowing)&&(this.attributeInspector.refresh(),this._showInfoWindow(b,this._settings.map.getInfoWindowAnchor(b))),this._editClickPoint=null),a!==this._currentGraphic&&
(this._editVertices=!0,this._currentGraphic=a,a.getDojoShape()&&a.getDojoShape().moveToFront(),f=!!this._layer.hasM,(!f||this._layer.allowUpdateWithoutMValues)&&this._activateEditToolbar(a)))},_applyEdits:function(b,c){if(b=b||[],!(0>=b.length)){this._edits=this._oEdits=b;var d=[];a.forEach(b,function(a){a.layer&&d.push(a.layer.applyEdits(a.adds,a.updates,a.deletes))});0<d.length&&(this._deferredsList=(new m(d)).addCallback(l.hitch(this,function(){r.hide(this.progressBar.domNode);c&&c();var a=this._settings.map;
a&&a.infoWindow.reposition&&a.infoWindow.isShowing&&a.infoWindow.reposition()})))}},_undo:function(){this._settings.undoManager&&!this._settings._isApplyEditsCall&&(this.editToolbar.deactivate(),this._undoRedo=!0,this._settings.undoManager.undo())},_redo:function(){this._settings.undoManager&&!this._settings._isApplyEditsCall&&(this.editToolbar.deactivate(),this._undoRedo=!0,this._settings.undoManager.redo())},_simplify:function(a,b){t.prototype.isSelfIntersecting(a)?this._settings.geometryService.simplify([a],
function(a){var c=a&&a.length?a[0]:c;b&&b(c)}):b&&b(a)},_autoComplete:function(a,b){var c=this._getLayers("esriGeometryPolygon"),d=new y;d.geometry=a;d.returnGeometry=!0;this._selectFeatures(c,d,l.hitch(this,function(c){!c||0>=c.length?b&&b([a]):this._settings.geometryService.autoComplete(u.getGeometries(c),this._toPolylines([d.geometry]),function(a){b&&b(a)})}))},_getLayers:function(b){return a.filter(this._settings.layers,function(a){return a.geometryType===b})},_selectFeatures:function(a,b,c,d){this._selectionHelper.selectFeatures(a,
b,d||z.SELECTION_NEW,c)},_updateSelection:function(b){var c=b.mapPoint,d=b.graphic;if(d&&d.getLayer()&&!this._isValidLayer(d.getLayer()))return void this._clearSelection();if(this._selectionHelper.selectFeaturesByGeometry(this._settings.layers,c,z.SELECTION_NEW,l.hitch(this,function(b){var e=a.some(b,l.hitch(this,function(a){return a==d}));d&&!e?(b=d.getLayer(),this._isValidLayer(b)?(e=new y,e.objectIds=[d.attributes[b.objectIdField]],this._selectionHelper.selectFeatures([b],e,z.SELECTION_ADD,l.hitch(this,
function(a){this._updatePopupButtons(a);this._onEditFeature(a,c)}))):this._clearSelection()):b&&b.length?(this._updatePopupButtons(b),this._onEditFeature(b,c)):this._clearSelection()})),d&&this._isTextSymbolPoint(d))b=0|C.MOVE|C.ROTATE|C.SCALE|C.EDIT_TEXT,this.editToolbar.activate(b,d)},_updatePopupButtons:function(c){if(!this._usePopup||!c)return this._popupFeatures=null,void(this._currentFeatureCount=null);var d=c.length;a.forEach([this._settings.map.infoWindow._prevFeatureButton,this._settings.map.infoWindow._nextFeatureButton],
l.hitch(this,function(a){1<d?g.remove(a,"hidden"):g.add(a,"hidden")}));var e=1<d?"block":"none";b.query(".esriAttributeInspector .atiLayerName").style({display:e});this._currentFeatureCount=d;this._popupFeatures=c},_clearSelection:function(a){this._currentFeatureCount=0;this._popupFeatures=null;this._selectionHelper.clearSelection(a||!1);this._reset()},_findCenterPoint:function(a){var b;a=a.geometry||a;switch(a.type){case "point":b=a;break;case "polyline":b=a.getPoint(0,Math.ceil(a.paths[0].length/
2));break;case "polygon":b=a.rings.length-1,b=a.getPoint(b,a.rings[b].length-1)}return this._settings.map.toScreen(b)},_hideAttributeInspector:function(){!this._customAttributeInspector&&this._settings.map.infoWindow&&this._settings.map.infoWindow.hide()},_toPolylines:function(b){return a.map(b,function(b){var c=new v(b.spatialReference);return a.forEach(b.rings,function(a){c.addPath(a)}),c})},_isNotesFeature:function(b){var c=b.getLayer(),d=c?c.types||null:null;if(!d)return!1;var e,f=b.attributes[c.typeIdField];
return(a.some(d,function(a){return a.id===f?(e=a.templates,!0):!1}),e)?(b=e[0]||null)?this._isShapeTool(b.drawingTool)?!0:!1:!1:!1},_isValidLayer:function(a){var b,c=this._settings.layerInfos;for(b=0;b<c.length;b++){var d=c[b];if(a.id==(d.featureLayer?d.featureLayer.id:d.layerId))return!0}return!1},_isShapeTool:function(a){switch(a){case A.TOOL_ARROW:return B.ARROW;case A.TOOL_LEFT_ARROW:return B.LEFT_ARROW;case A.TOOL_RIGHT_ARROW:return B.RIGHT_ARROW;case A.TOOL_UP_ARROW:return B.UP_ARROW;case A.TOOL_DOWN_ARROW:return B.DOWN_ARROW;
case A.TOOL_CIRCLE:return B.CIRCLE;case A.TOOL_ELLIPSE:return B.ELLIPSE;case A.TOOL_TRIANGLE:return B.TRIANGLE;case A.TOOL_RECTANGLE:return B.RECTANGLE;default:return null}},_toDrawTool:function(a,b){var c=b.geometryType;switch(a){case A.TOOL_POINT:return B.POINT;case A.TOOL_ARROW:return B.ARROW;case A.TOOL_LEFT_ARROW:return B.LEFT_ARROW;case A.TOOL_RIGHT_ARROW:return B.RIGHT_ARROW;case A.TOOL_UP_ARROW:return B.UP_ARROW;case A.TOOL_DOWN_ARROW:return B.DOWN_ARROW;case A.TOOL_CIRCLE:return B.CIRCLE;
case A.TOOL_ELLIPSE:return B.ELLIPSE;case A.TOOL_TRIANGLE:return B.TRIANGLE;case A.TOOL_RECTANGLE:return B.RECTANGLE;case A.TOOL_LINE:return B.POLYLINE;case A.TOOL_POLYGON:return B.POLYGON;case A.TOOL_FREEHAND:return"esriGeometryPolyline"===c?B.FREEHAND_POLYLINE:B.FREEHAND_POLYGON;default:var d=B.POINT;return"esriGeometryPolyline"===c?(d=B.POLYLINE,this._settings.createOptions.polylineDrawTools[0]===S.CREATE_TOOL_FREEHAND_POLYLINE&&(d=B.FREEHAND_POLYLINE)):"esriGeometryPolygon"===c&&(d=B.POLYGON,
this._settings.createOptions.polygonDrawTools[0]===S.CREATE_TOOL_FREEHAND_POLYGON&&(d=B.FREEHAND_POLYGON)),d}},_isModified:function(){var a=this.editToolbar.getCurrentState();return(a.isModified||this._attributeChanged)&&a.graphic?a.graphic:null},_showInfoWindow:function(a,b){this._customAttributeInspector||this._settings.map.infoWindow.show(a,b)}});return l.mixin(S,{CREATE_TOOL_POLYLINE:"polyline",CREATE_TOOL_FREEHAND_POLYLINE:"freehandpolyline",CREATE_TOOL_POLYGON:"polygon",CREATE_TOOL_FREEHAND_POLYGON:"freehandpolygon",
CREATE_TOOL_AUTOCOMPLETE:"autocomplete",CREATE_TOOL_RECTANGLE:"rectangle",CREATE_TOOL_TRIANGLE:"triangle",CREATE_TOOL_CIRCLE:"circle",CREATE_TOOL_ELLIPSE:"ellipse",CREATE_TOOL_ARROW:"arrow",CREATE_TOOL_UP_ARROW:"uparrow",CREATE_TOOL_DOWN_ARROW:"downarrow",CREATE_TOOL_RIGHT_ARROW:"rightarrow",CREATE_TOOL_LEFT_ARROW:"leftarrow"}),f("extend-esri")&&l.setObject("dijit.editing.Editor",S,N),S})},"esri/undoManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/when ./kernel ./Evented require".split(" "),
function(h,l,a,d,b,f){h=h([f],{declaredClass:"esri.UndoManager",maxOperations:10,canUndo:!1,canRedo:!1,position:0,length:0,onUndo:function(){},onRedo:function(){},onUndoComplete:function(){},onRedoComplete:function(){},onAdd:function(){},onChange:function(){},constructor:function(a){a=a||{};a.maxOperations&&(this.maxOperations=a.maxOperations);this._historyStack=[]},add:function(a){if(0<this.maxOperations)for(;this._historyStack.length>=this.maxOperations;)this._historyStack.shift();this._historyStack.splice(this.position,
0,a);this.position++;this.clearRedo();this.onAdd();this._checkAvailability()},undo:function(){if(0===this.position)return null;var a=this.peekUndo();(this.position--,a)?(a=a.performUndo(),this.onUndo(),this._checkAvailability(),d(a).then(l.hitch(this,this.onUndoComplete))):(this.onUndo(),this._checkAvailability())},redo:function(){if(this.position===this._historyStack.length)return null;var a=this.peekRedo();(this.position++,a)?(a=a.performRedo(),this.onRedo(),this._checkAvailability(),d(a).then(l.hitch(this,
this.onRedoComplete))):(this.onRedo(),this._checkAvailability())},_checkAvailability:function(){this.length=this._historyStack.length;0===this.length?(this.canRedo=!1,this.canUndo=!1):0===this.position?(this.canRedo=!0,this.canUndo=!1):this.position===this.length?(this.canUndo=!0,this.canRedo=!1):(this.canUndo=!0,this.canRedo=!0);this.onChange()},clearUndo:function(){this._historyStack.splice(0,this.position);this.position=0;this._checkAvailability()},clearRedo:function(){this._historyStack.splice(this.position,
this._historyStack.length-this.position);this.position=this._historyStack.length;this._checkAvailability()},peekUndo:function(){return 0<this._historyStack.length&&0<this.position?this.get(this.position-1):void 0},peekRedo:function(){return 0<this._historyStack.length&&this.position<this._historyStack.length?this.get(this.position):void 0},get:function(a){return this._historyStack[a]},remove:function(a){0<this._historyStack.length&&(this._historyStack.splice(a,1),0<this.position&&a<this.position&&
this.position--,this._checkAvailability())},destroy:function(){this._historyStack=null}});return a("extend-esri")&&(b.UndoManager=h),h})},"esri/toolbars/draw":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/_base/window dojo/has dojo/sniff dojo/keys dojo/dom-construct dojo/dom-style dojo/dom-geometry ../kernel ../sniff ./_toolbar ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../graphic ../geometry/jsonUtils ../geometry/webMercatorUtils ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/Rect dojo/i18n!../nls/jsapi".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E){var F=h(u,{declaredClass:"esri.toolbars.Draw",_eventMap:{"draw-complete":!0,"draw-end":["geometry"]},constructor:function(a,c){this.markerSymbol=new v(v.STYLE_SOLID,10,new t(t.STYLE_SOLID,new b([255,0,0]),2),new b([0,0,0,.25]));this.lineSymbol=new t(t.STYLE_SOLID,new b([255,0,0]),2);this.fillSymbol=new w(w.STYLE_SOLID,new t(t.STYLE_SOLID,new b([255,0,0]),2),new b([0,0,0,.25]));this._points=[];this._mouse=!k("esri-touch")&&!k("esri-pointer");
this._defaultOptions={showTooltips:!0,drawTime:75,tolerance:8,tooltipOffset:15};this._options=l.mixin(l.mixin({},this._defaultOptions),c||{});(m("ios")||m("android"))&&(this._options.showTooltips=!1);this._onKeyDownHandler=l.hitch(this,this._onKeyDownHandler);this._onMouseDownHandler=l.hitch(this,this._onMouseDownHandler);this._onMouseUpHandler=l.hitch(this,this._onMouseUpHandler);this._onClickHandler=l.hitch(this,this._onClickHandler);this._onMouseMoveHandler=l.hitch(this,this._onMouseMoveHandler);
this._onMouseDragHandler=l.hitch(this,this._onMouseDragHandler);this._onDblClickHandler=l.hitch(this,this._onDblClickHandler);this._updateTooltip=l.hitch(this,this._updateTooltip);this._hideTooltip=l.hitch(this,this._hideTooltip);this._redrawGraphic=l.hitch(this,this._redrawGraphic)},_geometryType:null,respectDrawingVertexOrder:!1,setRespectDrawingVertexOrder:function(a){this.respectDrawingVertexOrder=a},setMarkerSymbol:function(a){this.markerSymbol=a},setLineSymbol:function(a){this.lineSymbol=a},
setFillSymbol:function(a){this.fillSymbol=a},activate:function(a,b){this._geometryType&&this.deactivate();var c=this.map,e=d.connect,f=F;switch(this._options=l.mixin(l.mixin({},this._options),b||{}),c.navigationManager.setImmediateClick(!1),a){case f.ARROW:case f.LEFT_ARROW:case f.RIGHT_ARROW:case f.UP_ARROW:case f.DOWN_ARROW:case f.TRIANGLE:case f.CIRCLE:case f.ELLIPSE:case f.RECTANGLE:this._deactivateMapTools(!0,!1,!1,!0);this._onClickHandler_connect=e(c,"onClick",this._onClickHandler);this._mouse?
(this._onMouseDownHandler_connect=e(c,"onMouseDown",this._onMouseDownHandler),this._onMouseDragHandler_connect=e(c,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler_connect=e(c,"onMouseUp",this._onMouseUpHandler)):(this._onMouseDownHandler2_connect=e(c,"onMouseDragStart",this._onMouseDownHandler),this._onMouseDragHandler2_connect=e(c,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler2_connect=e(c,"onMouseDragEnd",this._onMouseUpHandler));k("esri-touch")&&!k("esri-pointer")&&
(this._onMouseDownHandler2_connect=e(c,"onSwipeStart",this._onMouseDownHandler),this._onMouseDragHandler2_connect=e(c,"onSwipeMove",this._onMouseDragHandler),this._onMouseUpHandler2_connect=e(c,"onSwipeEnd",this._onMouseUpHandler));break;case f.POINT:this._onClickHandler_connect=e(c,"onClick",this._onClickHandler);break;case f.LINE:case f.EXTENT:case f.FREEHAND_POLYLINE:case f.FREEHAND_POLYGON:this._deactivateMapTools(!0,!1,!1,!0);this._mouse?(this._onMouseDownHandler_connect=e(c,"onMouseDown",this._onMouseDownHandler),
this._onMouseDragHandler_connect=e(c,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler_connect=e(c,"onMouseUp",this._onMouseUpHandler)):(this._onMouseDownHandler_connect=e(c,"onMouseDragStart",this._onMouseDownHandler),this._onMouseDragHandler_connect=e(c,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler_connect=e(c,"onMouseDragEnd",this._onMouseUpHandler));k("esri-touch")&&!k("esri-pointer")&&(this._onMouseDownHandler2_connect=e(c,"onSwipeStart",this._onMouseDownHandler),
this._onMouseDragHandler2_connect=e(c,"onSwipeMove",this._onMouseDragHandler),this._onMouseUpHandler2_connect=e(c,"onSwipeEnd",this._onMouseUpHandler));break;case f.POLYLINE:case f.POLYGON:case f.MULTI_POINT:c.navigationManager.setImmediateClick(!0);this._onClickHandler_connect=e(c,"onClick",this._onClickHandler);this._onDblClickHandler_connect=e(c,"onDblClick",this._onDblClickHandler);this._dblClickZoom=c.isDoubleClickZoom;c.disableDoubleClickZoom();break;default:return void console.error("Unsupported geometry type: "+
a)}this._onKeyDown_connect=e(c,"onKeyDown",this._onKeyDownHandler);this._redrawConnect=e(c,"onExtentChange",this._redrawGraphic);this._geometryType=a;this._toggleTooltip(!0);c.snappingManager&&"freehandpolyline"!==this._geometryType&&"freehandpolygon"!==this._geometryType&&(c.snappingManager._startSelectionLayerQuery(),c.snappingManager._setUpSnapping());this.onActivate(this._geometryType)},deactivate:function(){var a=this.map;this._clear();var b=d.disconnect;switch(b(this._onMouseMoveHandler_connect),
b(this._onMouseDownHandler_connect),b(this._onMouseDragHandler_connect),b(this._onMouseUpHandler_connect),b(this._onMouseDownHandler2_connect),b(this._onMouseDragHandler2_connect),b(this._onMouseUpHandler2_connect),b(this._onClickHandler_connect),b(this._onDblClickHandler_connect),b(this._onKeyDown_connect),b(this._redrawConnect),this._onMouseDownHandler_connect=this._onMouseMoveHandler_connect=this._onMouseDragHandler_connect=this._onMouseUpHandler_connect=this._onMouseDownHandler2_connect=this._onMouseDragHandler2_connect=
this._onMouseUpHandler2_connect=this._onClickHandler_connect=this._onDblClickHandler_connect=this._onKeyDown_connect=this._redrawConnect=null,a.snappingManager&&(a.snappingManager._stopSelectionLayerQuery(),a.snappingManager._killOffSnapping()),this._geometryType){case F.CIRCLE:case F.ELLIPSE:case F.TRIANGLE:case F.ARROW:case F.LEFT_ARROW:case F.RIGHT_ARROW:case F.UP_ARROW:case F.DOWN_ARROW:case F.RECTANGLE:case F.LINE:case F.EXTENT:case F.FREEHAND_POLYLINE:case F.FREEHAND_POLYGON:this._activateMapTools(!0,
!1,!1,!0);break;case F.POLYLINE:case F.POLYGON:case F.MULTI_POINT:this._dblClickZoom&&a.enableDoubleClickZoom()}b=this._geometryType;this._geometryType=null;a.navigationManager.setImmediateClick(!1);this._toggleTooltip(!1);this.onDeactivate(b)},_clear:function(){this._graphic&&this.map.graphics.remove(this._graphic,!0);this._tGraphic&&this.map.graphics.remove(this._tGraphic,!0);this._graphic=this._tGraphic=null;this.map.snappingManager&&this.map.snappingManager._setGraphic(null);this._points=[]},
finishDrawing:function(){var b,c=this._points,e=this.map.spatialReference,f=F;switch(c=c.slice(0,c.length),this._geometryType){case f.POLYLINE:if(!this._graphic||2>c.length)return;b=new A(e);b.addPath([].concat(c));break;case f.POLYGON:if(!this._graphic||3>c.length)return;b=new B(e);c=[].concat(c,[c[0].offset(0,0)]);B.prototype.isClockwise(c)||this.respectDrawingVertexOrder||c.reverse();b.addRing(c);break;case f.MULTI_POINT:b=new C(e),a.forEach(c,function(a){b.addPoint(a)})}d.disconnect(this._onMouseMoveHandler_connect);
this._clear();this._setTooltipMessage(0);this._drawEnd(b)},_drawEnd:function(a){if(a){var b,c=this.map.spatialReference;this.onDrawEnd(a);c&&(c.isWebMercator()?b=z.webMercatorToGeographic(a,!0):4326===c.wkid&&(b=y.fromJson(a.toJson())));this.onDrawComplete({geometry:a,geographicGeometry:b})}},_normalizeRect:function(a,b,c){var d=a.x;a=a.y;var e=b.x;b=b.y;var f=Math.abs(d-e),g=Math.abs(a-b);return{x:Math.min(d,e),y:Math.max(a,b),width:f,height:g,spatialReference:c}},_onMouseDownHandler:function(a){this._dragged=
!1;var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var c=b||a.mapPoint,d=F;b=this.map;var e=b.spatialReference;switch(this._points.push(c.offset(0,0)),this._geometryType){case d.LINE:this._graphic=b.graphics.add(new x(new A({paths:[[[c.x,c.y],[c.x,c.y]]],spatialReference:e}),this.lineSymbol),!0);b.snappingManager&&b.snappingManager._setGraphic(this._graphic);break;case d.FREEHAND_POLYLINE:this._oldPoint=a.screenPoint;c=new A(e);c.addPath(this._points);this._graphic=b.graphics.add(new x(c,
this.lineSymbol),!0);b.snappingManager&&b.snappingManager._setGraphic(this._graphic);break;case d.CIRCLE:case d.ELLIPSE:case d.TRIANGLE:case d.ARROW:case d.LEFT_ARROW:case d.RIGHT_ARROW:case d.UP_ARROW:case d.DOWN_ARROW:case d.RECTANGLE:case d.FREEHAND_POLYGON:this._oldPoint=a.screenPoint,c=new B(e),c.addRing(this._points),this._graphic=b.graphics.add(new x(c,this.fillSymbol),!0),b.snappingManager&&b.snappingManager._setGraphic(this._graphic)}k("esri-touch")&&a.preventDefault()},_onMouseMoveHandler:function(a){var b;
this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var c=this._points[this._points.length-1];a=b||a.mapPoint;b=this._tGraphic;var d=b.geometry;switch(this._geometryType){case F.POLYLINE:case F.POLYGON:d.setPoint(0,0,{x:c.x,y:c.y}),d.setPoint(0,1,{x:a.x,y:a.y}),b.setGeometry(d)}},_onMouseDragHandler:function(a){if(this._graphic||this._points.length){if(k("esri-touch")&&!this._points.length)return void a.preventDefault();this._dragged=!0;var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);
var c=this._points[0],d=b||a.mapPoint,e=this.map,f=e.spatialReference;b=this._graphic;var g=F,h=e.toScreen(c),m=e.toScreen(d),n=[],n=m.x-h.x,m=m.y-h.y,r=Math.sqrt(n*n+m*m);switch(this._geometryType){case g.CIRCLE:this._hideTooltip();b.geometry=B.createCircle({center:h,r:r,numberOfPoints:60,map:e});b.setGeometry(b.geometry);break;case g.ELLIPSE:this._hideTooltip();b.geometry=B.createEllipse({center:h,longAxis:n,shortAxis:m,numberOfPoints:60,map:e});b.setGeometry(b.geometry);break;case g.TRIANGLE:this._hideTooltip();
n=[[0,-r],[.8660254037844386*r,.5*r],[-.8660254037844386*r,.5*r],[0,-r]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);break;case g.ARROW:this._hideTooltip();c=m/r;e=n/r;d=.25*e*r;f=.25*r/(m/n);r*=.25*c;n=[[n,m],[n-d*(1+24/f),m+24*e-r],[n-d*(1+12/f),m+12*e-r],[-12*c,12*e],[12*c,-12*e],[n-d*(1-12/f),m-12*e-r],[n-d*(1-24/f),m-24*e-r],[n,m]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);break;case g.LEFT_ARROW:this._hideTooltip();n=0>=n?[[n,0],[.75*n,m],[.75*n,.5*
m],[0,.5*m],[0,-.5*m],[.75*n,-.5*m],[.75*n,-m],[n,0]]:[[0,0],[.25*n,m],[.25*n,.5*m],[n,.5*m],[n,-.5*m],[.25*n,-.5*m],[.25*n,-m],[0,0]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);break;case g.RIGHT_ARROW:this._hideTooltip();n=0<=n?[[n,0],[.75*n,m],[.75*n,.5*m],[0,.5*m],[0,-.5*m],[.75*n,-.5*m],[.75*n,-m],[n,0]]:[[0,0],[.25*n,m],[.25*n,.5*m],[n,.5*m],[n,-.5*m],[.25*n,-.5*m],[.25*n,-m],[0,0]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);break;case g.UP_ARROW:this._hideTooltip();
n=0>=m?[[0,m],[-n,.75*m],[-.5*n,.75*m],[-.5*n,0],[.5*n,0],[.5*n,.75*m],[n,.75*m],[0,m]]:[[0,0],[-n,.25*m],[-.5*n,.25*m],[-.5*n,m],[.5*n,m],[.5*n,.25*m],[n,.25*m],[0,0]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);break;case g.DOWN_ARROW:this._hideTooltip();n=0<=m?[[0,m],[-n,.75*m],[-.5*n,.75*m],[-.5*n,0],[.5*n,0],[.5*n,.75*m],[n,.75*m],[0,m]]:[[0,0],[-n,.25*m],[-.5*n,.25*m],[-.5*n,m],[.5*n,m],[.5*n,.25*m],[n,.25*m],[0,0]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);
break;case g.RECTANGLE:this._hideTooltip();n=[[0,0],[n,0],[n,m],[0,m],[0,0]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);break;case g.LINE:b.setGeometry(l.mixin(b.geometry,{paths:[[[c.x,c.y],[d.x,d.y]]]}));break;case g.EXTENT:b&&e.graphics.remove(b,!0);b=new D(this._normalizeRect(c,d,f));b._originOnly=!0;this._graphic=e.graphics.add(new x(b,this.fillSymbol),!0);e.snappingManager&&e.snappingManager._setGraphic(this._graphic);break;case g.FREEHAND_POLYLINE:if(this._hideTooltip(),
!1===this._canDrawFreehandPoint(a))return void(k("esri-touch")&&a.preventDefault());this._points.push(a.mapPoint.offset(0,0));b.geometry._insertPoints([d.offset(0,0)],0);b.setGeometry(b.geometry);break;case g.FREEHAND_POLYGON:if(this._hideTooltip(),!1===this._canDrawFreehandPoint(a))return void(k("esri-touch")&&a.preventDefault());this._points.push(a.mapPoint.offset(0,0));b.geometry._insertPoints([d.offset(0,0)],0);b.setGeometry(b.geometry)}k("esri-touch")&&a.preventDefault()}},_canDrawFreehandPoint:function(a){if(!this._oldPoint)return!1;
var b=this._oldPoint.x-a.screenPoint.x,c=this._oldPoint.y-a.screenPoint.y,d=this._options.tolerance;if(d>(0>b?-1*b:b)&&d>(0>c?-1*c:c))return!1;b=new Date;return b-this._startTime<this._options.drawTime?!1:(this._startTime=b,this._oldPoint=a.screenPoint,!0)},_onMouseUpHandler:function(a){if(!this._dragged||!this._graphic)return void this._clear();0===this._points.length&&this._points.push(a.mapPoint.offset(0,0));var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var c,d=this._points[0];
b=b||a.mapPoint;var e=this.map.spatialReference,f=F;switch(this._geometryType){case f.CIRCLE:case f.ELLIPSE:case f.TRIANGLE:case f.ARROW:case f.LEFT_ARROW:case f.RIGHT_ARROW:case f.UP_ARROW:case f.DOWN_ARROW:case f.RECTANGLE:c=this._graphic.geometry;break;case f.LINE:c=new A({paths:[[[d.x,d.y],[b.x,b.y]]],spatialReference:e});break;case f.EXTENT:c=(new D(this._normalizeRect(d,b,e))).getExtent();break;case f.FREEHAND_POLYLINE:c=new A(e);c.addPath([].concat(this._points,[b.offset(0,0)]));break;case f.FREEHAND_POLYGON:c=
new B(e),d=[].concat(this._points,[b.offset(0,0),this._points[0].offset(0,0)]),B.prototype.isClockwise(d)||this.respectDrawingVertexOrder||d.reverse(),c.addRing(d)}k("esri-touch")&&a.preventDefault();this._clear();this._drawEnd(c)},_onClickHandler:function(a){var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var c,e,f;b=b||a.mapPoint;a=this.map;var g=a.toScreen(b),k=F;switch(this._points.push(b.offset(0,0)),this._geometryType){case k.POINT:this._drawEnd(b.offset(0,0));this._setTooltipMessage(0);
break;case k.POLYLINE:1===this._points.length?(c=new A(a.spatialReference),c.addPath(this._points),this._graphic=a.graphics.add(new x(c,this.lineSymbol),!0),a.snappingManager&&a.snappingManager._setGraphic(this._graphic),this._onMouseMoveHandler_connect=d.connect(a,"onMouseMove",this._onMouseMoveHandler),this._tGraphic=a.graphics.add(new x(new A({paths:[[[b.x,b.y],[b.x,b.y]]],spatialReference:a.spatialReference}),this.lineSymbol),!0)):(this._graphic.geometry._insertPoints([b.offset(0,0)],0),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.lineSymbol),
c=this._tGraphic,e=c.geometry,e.setPoint(0,0,b.offset(0,0)),e.setPoint(0,1,b.offset(0,0)),c.setGeometry(e));break;case k.POLYGON:1===this._points.length?(f=new B(a.spatialReference),f.addRing(this._points),this._graphic=a.graphics.add(new x(f,this.fillSymbol),!0),a.snappingManager&&a.snappingManager._setGraphic(this._graphic),this._onMouseMoveHandler_connect=d.connect(a,"onMouseMove",this._onMouseMoveHandler),this._tGraphic=a.graphics.add(new x(new A({paths:[[[b.x,b.y],[b.x,b.y]]],spatialReference:a.spatialReference}),
this.fillSymbol),!0)):(this._graphic.geometry._insertPoints([b.offset(0,0)],0),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.fillSymbol),c=this._tGraphic,e=c.geometry,e.setPoint(0,0,b.offset(0,0)),e.setPoint(0,1,b.offset(0,0)),c.setGeometry(e));break;case k.MULTI_POINT:c=this._points;1===c.length?(e=new C(a.spatialReference),e.addPoint(c[c.length-1]),this._graphic=a.graphics.add(new x(e,this.markerSymbol),!0),a.snappingManager&&a.snappingManager._setGraphic(this._graphic)):(this._graphic.geometry.addPoint(c[c.length-
1]),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.markerSymbol));break;case k.ARROW:this._addShape([[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]],g.x,g.y);break;case k.LEFT_ARROW:this._addShape([[0,0],[24,24],[24,12],[96,12],[96,-12],[24,-12],[24,-24],[0,0]],g.x,g.y);break;case k.RIGHT_ARROW:this._addShape([[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]],g.x,g.y);break;case k.UP_ARROW:this._addShape([[0,0],[-24,24],[-12,24],[-12,96],
[12,96],[12,24],[24,24],[0,0]],g.x,g.y);break;case k.DOWN_ARROW:this._addShape([[0,0],[-24,-24],[-12,-24],[-12,-96],[12,-96],[12,-24],[24,-24],[0,0]],g.x,g.y);break;case k.TRIANGLE:this._addShape([[0,-48],[41.56921938165306,24],[-41.56921938165306,24],[0,-48]],g.x,g.y);break;case k.RECTANGLE:this._addShape([[0,-96],[96,-96],[96,0],[0,0],[0,-96]],g.x-48,g.y+48);break;case k.CIRCLE:this._clear();this._drawEnd(B.createCircle({center:g,r:48,numberOfPoints:60,map:a}));break;case k.ELLIPSE:this._clear(),
this._drawEnd(B.createEllipse({center:g,longAxis:48,shortAxis:24,numberOfPoints:60,map:a}))}this._setTooltipMessage(this._points.length)},_addShape:function(a,b,c){this._setTooltipMessage(0);this._clear();this._drawEnd(this._toPolygon(a,b,c))},_toPolygon:function(b,c,d){var e=this.map,f=new B(e.spatialReference);return f.addRing(a.map(b,function(a){return e.toMap({x:a[0]+c,y:a[1]+d})})),f},_onDblClickHandler:function(b){var c,e=this._points,f=this.map.spatialReference,g=F;k("esri-touch")&&e.push(b.mapPoint);
var h=e[e.length-1],m=e[e.length-2];switch(e=h&&m&&h.x===m.x&&h.y===m.y?e.slice(0,e.length-1):e.slice(0,e.length),this._geometryType){case g.POLYLINE:if(!this._graphic||2>e.length)return d.disconnect(this._onMouseMoveHandler_connect),this._clear(),void this._onClickHandler(b);c=new A(f);c.addPath([].concat(e));break;case g.POLYGON:if(!this._graphic||2>e.length)return d.disconnect(this._onMouseMoveHandler_connect),this._clear(),void this._onClickHandler(b);c=new B(f);b=[].concat(e,[e[0].offset(0,0)]);
B.prototype.isClockwise(b)||this.respectDrawingVertexOrder||b.reverse();c.addRing(b);break;case g.MULTI_POINT:c=new C(f),a.forEach(e,function(a){c.addPoint(a)})}d.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(c)},_onKeyDownHandler:function(a){a.keyCode===g.ESCAPE&&(d.disconnect(this._onMouseMoveHandler_connect),this._clear(),this._setTooltipMessage(0))},_toggleTooltip:function(a){this._options.showTooltips&&(a?this._tooltip||(this._tooltip=e.create("div",
{"class":"tooltip"},this.map.container),n.isBodyLtr()||c.set(this._tooltip,"direction","rtl"),this._tooltip.style.display="none",this._tooltip.style.position="fixed",this._setTooltipMessage(0),this._onTooltipMouseEnterHandler_connect=d.connect(this.map,"onMouseOver",this._updateTooltip),this._onTooltipMouseLeaveHandler_connect=d.connect(this.map,"onMouseOut",this._hideTooltip),this._onTooltipMouseMoveHandler_connect=d.connect(this.map,"onMouseMove",this._updateTooltip)):this._tooltip&&(d.disconnect(this._onTooltipMouseEnterHandler_connect),
d.disconnect(this._onTooltipMouseLeaveHandler_connect),d.disconnect(this._onTooltipMouseMoveHandler_connect),e.destroy(this._tooltip),this._tooltip=null))},_hideTooltip:function(){var a=this._tooltip;a&&(a.style.display="none")},_setTooltipMessage:function(a){var b=this._tooltip;if(b){var c="";switch(this._geometryType){case F.POINT:c=E.toolbars.draw.addPoint;break;case F.ARROW:case F.LEFT_ARROW:case F.RIGHT_ARROW:case F.UP_ARROW:case F.DOWN_ARROW:case F.TRIANGLE:case F.RECTANGLE:case F.CIRCLE:case F.ELLIPSE:c=
E.toolbars.draw.addShape;break;case F.LINE:case F.EXTENT:case F.FREEHAND_POLYLINE:case F.FREEHAND_POLYGON:c=E.toolbars.draw.freehand;break;case F.POLYLINE:case F.POLYGON:c=E.toolbars.draw.start;1===a?c=E.toolbars.draw.resume:2<=a&&(c=E.toolbars.draw.complete);break;case F.MULTI_POINT:c=E.toolbars.draw.addMultipoint,1<=a&&(c=E.toolbars.draw.finish)}b.innerHTML=c}},_updateTooltip:function(a){var b=this._tooltip;if(b){var d,e;a.clientX||a.pageY?(d=a.clientX,e=a.clientY):(d=a.clientX+f.body().scrollLeft-
f.body().clientLeft,e=a.clientY+f.body().scrollTop-f.body().clientTop);b.style.display="none";c.set(b,{left:d+this._options.tooltipOffset+"px",top:e+"px"});b.style.display=""}},_redrawGraphic:function(a,b,c,d){if(c||this.map.wrapAround180)(a=this._graphic)&&a.setGeometry(a.geometry),(a=this._tGraphic)&&a.setGeometry(a.geometry)},onActivate:function(){},onDeactivate:function(){},onDrawComplete:function(){},onDrawEnd:function(){}});return l.mixin(F,{POINT:"point",MULTI_POINT:"multipoint",LINE:"line",
EXTENT:"extent",POLYLINE:"polyline",POLYGON:"polygon",FREEHAND_POLYLINE:"freehandpolyline",FREEHAND_POLYGON:"freehandpolygon",ARROW:"arrow",LEFT_ARROW:"leftarrow",RIGHT_ARROW:"rightarrow",UP_ARROW:"uparrow",DOWN_ARROW:"downarrow",TRIANGLE:"triangle",CIRCLE:"circle",ELLIPSE:"ellipse",RECTANGLE:"rectangle"}),k("extend-esri")&&l.setObject("toolbars.Draw",F,q),F})},"esri/toolbars/_toolbar":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../Evented"],function(h,l,a,d,
b){h=h([b],{declaredClass:"esri.toolbars._Toolbar",constructor:function(a){this.map=a},_cursors:{move:"pointer","move-v":"pointer","move-gv":"pointer",box0:"nw-resize",box1:"n-resize",box2:"ne-resize",box3:"e-resize",box4:"se-resize",box5:"s-resize",box6:"sw-resize",box7:"w-resize",box8:"pointer"},_deactivateMapTools:function(a,b,d,g){var e=this.map;a&&(this._mapNavState={isDoubleClickZoom:e.isDoubleClickZoom,isClickRecenter:e.isClickRecenter,isPan:e.isPan,isRubberBandZoom:e.isRubberBandZoom,isKeyboardNavigation:e.isKeyboardNavigation,
isScrollWheelZoom:e.isScrollWheelZoom},e.disableDoubleClickZoom(),e.disableClickRecenter(),e.disablePan(),e.disableRubberBandZoom(),e.disableKeyboardNavigation());b&&e.hideZoomSlider();d&&e.hidePanArrows();g&&e.graphics.disableMouseEvents()},_activateMapTools:function(a,b,d,g){var e=this.map,c=this._mapNavState;a&&c&&(c.isDoubleClickZoom&&e.enableDoubleClickZoom(),c.isClickRecenter&&e.enableClickRecenter(),c.isPan&&e.enablePan(),c.isRubberBandZoom&&e.enableRubberBandZoom(),c.isKeyboardNavigation&&
e.enableKeyboardNavigation(),c.isScrollWheelZoom&&e.enableScrollWheelZoom());b&&e.showZoomSlider();d&&e.showPanArrows();g&&e.graphics.enableMouseEvents()}});return a("extend-esri")&&l.setObject("toolbars._Toolbar",h,d),h})},"esri/toolbars/edit":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/has dojo/dom-construct dojo/dom-style ../kernel ../lang ../sniff ./_toolbar ./_Box ./_GraphicMover ./_VertexEditor ./TextEditor ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/TextSymbol ../graphic".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z){var A=l(q,{declaredClass:"esri.toolbars.Edit",constructor:function(b,c){if(this._map=b,this._tool=0,this._map.loaded)this._scratchGL=b.graphics;else var e=d.connect(this._map,"onLoad",this,function(){d.disconnect(e);e=null;this._scratchGL=this._map.graphics});var g=k("esri-mobile");this._defaultOptions=a.mixin({vertexSymbol:new w(w.STYLE_CIRCLE,g?20:12,new x(x.STYLE_SOLID,new f([0,0,0,.5]),1),new f([128,128,128])),ghostVertexSymbol:new w(w.STYLE_CIRCLE,
g?18:10,new x(x.STYLE_SOLID,new f([0,0,0,.5]),1),new f([255,255,255,.75])),ghostLineSymbol:new x(x.STYLE_DOT,new f([128,128,128]),2),allowDeleteVertices:!0,allowAddVertices:!0,rotateHandleOffset:g?24:16,boxLineSymbol:new x(x.STYLE_DASH,new f([64,64,64]),1),boxHandleSymbol:new w(w.STYLE_SQUARE,g?16:9,new x(x.STYLE_SOLID,new f([0,0,0,.5]),1),new f([255,255,255,.75])),textAnchorSymbol:new w(w.STYLE_CIRCLE,10,null,new f([255,0,0]))},c||{})},activate:function(b,c,e){this.deactivate();this._graphic=c;this._options=
a.mixin(a.mixin({},this._defaultOptions),e||{});var f=A.MOVE;e=A.EDIT_VERTICES;var g=A.SCALE,k=A.ROTATE,h=A.EDIT_TEXT,m=!1,n=!1,l=!1,r=this._map,q=r.spatialReference,u=c.geometry.spatialReference;this._geo=!(!q||!u||q.equals(u)||!q.isWebMercator()||4326!==u.wkid);this._isTextPoint=this._prepareTextSymbolEditing(c,b);(b&f)===f&&(m=this._enableMove(c));f=(b&g)===g;k=(b&k)===k;if((f||k)&&(l=this._enableBoxEditing(c,f,k)),(b&e)===e&&(n=this._enableVertexEditing(c)),(b&h)===h&&this._enableTextEditing(c),
!(m||n||l))throw Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");(this._tool=b)&&(this._mapPanEndHandle=d.connect(r,"onPanEnd",this,this._mapPanEndHandler),this._mapExtChgHandle=d.connect(r,"onExtentChange",this,this._mapExtentChangeHandler),this.onActivate(this._tool,c));r.snappingManager&&(m||n)&&r.snappingManager._startSelectionLayerQuery()},deactivate:function(){this._isTextPoint=null;var a=this._tool,b=this._graphic;
if(a){var c=!!this._modified;this._clear();d.disconnect(this._mapPanEndHandle);d.disconnect(this._mapExtChgHandle);this._graphic=this._geo=this._mapPanEndHandle=this._mapExtChgHandle=null;this.onDeactivate(a,b,{isModified:c});this._map.snappingManager&&this._map.snappingManager._stopSelectionLayerQuery()}},refresh:function(){this._refreshMoveables(!0)},getCurrentState:function(){return{tool:this._tool,graphic:this._graphic,isModified:!!this._modified}},onActivate:function(a,b){},onDeactivate:function(a,
b,c){},onGraphicMoveStart:function(a){},onGraphicFirstMove:function(a){this._modified=!0},onGraphicMove:function(a,b){},onGraphicMoveStop:function(a,b){},onGraphicClick:function(a,b){},onVertexMoveStart:function(a,b){},onVertexFirstMove:function(a,b){this._modified=!0},onVertexMove:function(a,b,c){},onVertexMoveStop:function(a,b,c){},onVertexAdd:function(a,b){this._modified=!0},onVertexClick:function(a,b){},onVertexMouseOver:function(a,b){},onVertexMouseOut:function(a,b){},onVertexDelete:function(a,
b){this._modified=!0},onTextEditStart:function(a,b){},onTextEditEnd:function(a){},onScaleStart:function(a){},onScaleFirstMove:function(a){this._modified=!0},onScale:function(a,b){},onScaleStop:function(a,b){},onRotateStart:function(a){},onRotateFirstMove:function(a){this._modified=!0},onRotate:function(a,b){},onRotateStop:function(a,b){},_eventMap:{activate:["tool","graphic"],deactivate:["tool","graphic","info"],"graphic-move-start":["graphic"],"graphic-first-move":["graphic"],"graphic-move":["graphic",
"transform"],"graphic-move-stop":["graphic","transform"],"graphic-click":["graphic","info"],"vertex-move-start":["graphic","vertexinfo"],"vertex-first-move":["graphic","vertexinfo"],"vertex-move":["graphic","vertexinfo","transform"],"vertex-move-stop":["graphic","vertexinfo","transform"],"vertex-add":["graphic","vertexinfo"],"vertex-click":["graphic","vertexinfo"],"vertex-mouse-over":["graphic","vertexinfo"],"vertex-mouse-out":["graphic","vertexinfo"],"vertex-delete":["graphic","vertexinfo"],"scale-start":["graphic"],
"scale-first-move":["graphic"],scale:["graphic","info"],"scale-stop":["graphic","info"],"rotate-start":["graphic"],"rotate-first-move":["graphic"],rotate:["graphic","info"],"rotate-stop":["graphic","info"]},_prepareTextSymbolEditing:function(a,b){if("point"===a.geometry.type||"multipoint"===a.geometry.type){var c=a.getLayer(),d=c.renderer,c=a.symbol||c._getSymbol(a);if(!c&&(d.hasVisualVariables("sizeInfo",!1)||d.hasVisualVariables("colorInfo",!1)||d.hasVisualVariables("opacityInfo",!1))&&d.addBreak&&
d.infos&&1===d.infos.length&&(c=d.infos[0].symbol||d.defaultSymbol),c&&"textsymbol"===c.type){if((b&A.SCALE)===A.SCALE||(b&A.ROTATE)===A.ROTATE||(b&A.EDIT_TEXT)===A.EDIT_TEXT){a.setSymbol(new y(c.toJson()));var e=this;this._textSymbolEditor?(this._textSymbolEditor.createForm(a),this._textSymbolEditor.show()):this._options&&this._options.textSymbolEditor?(this._textSymbolEditor=this._options.textSymbolEditor,this._textSymbolEditor.on("symbol-change",function(){e._boxEditor&&e._boxEditor.refresh()})):
h(["../dijit/SymbolEditor"],function(b){if(!e._textSymbolEditor){var c;c=e._options.textSymbolEditorHolder?m.create("div",null,e._options.textSymbolEditorHolder):m.create("div",null,e._map.root);e._textSymbolEditor=new b({graphic:a},c);b=e._textSymbolEditor.domNode.parentNode.id;g.set(e._textSymbolEditor.domNode,{position:"map_root"===b?"absolute":"relative",left:"map_root"===b?e._map.width/2-100+"px":"5px",top:"20px","z-index":50});e._textSymbolEditor.startup();e._textSymbolEditor.createForm(a);
e._textSymbolEditor.show();e._textSymbolEditor.on("symbol-change",function(){e._boxEditor&&e._boxEditor.refresh()})}})}return((b&A.MOVE)===A.MOVE||(b&A.ROTATE)===A.ROTATE||(b&A.SCALE)===A.SCALE)&&(this._textAnchor=new z(a.geometry,this._options.textAnchorSymbol),this._scratchGL.add(this._textAnchor)),!0}}return!1},_enableMove:function(a){var b=this._map;switch(a.geometry.type){case "point":case "polyline":case "polygon":return this._graphicMover=new u(a,b,this,this._textAnchor),!0}return!1},_enableVertexEditing:function(a){var b=
this._map;switch(a.geometry.type){case "multipoint":case "polyline":case "polygon":return this._vertexEditor=v.create(a,b,this),!0}return!1},_enableBoxEditing:function(a,b,c){var d=this._map,e=a.geometry.type;return"polyline"===e||"polygon"===e||this._isTextPoint?(this._boxEditor=new r(a,d,this,b,c,this._options.uniformScaling,this._isTextPoint),!0):!1},_enableTextEditing:function(b){return this._isTextPoint?(this._textEditor=new t(b,this._map,this),d.connect(this._textEditor,"onEditStart",a.hitch(this,
function(){this._textAnchor&&(this._textAnchor.getLayer().remove(this._textAnchor),this._textAnchor=null);this._map.disableKeyboardNavigation();this._disableMove();this._disableBoxEditing()})),!0):!1},_disableMove:function(){var a=this._graphicMover;a&&(a.destroy(),this._graphicMover=null)},_disableVertexEditing:function(){var a=this._vertexEditor;a&&(a.destroy(),this._vertexEditor=null)},_disableBoxEditing:function(){var a=this._boxEditor;a&&(a.destroy(),this._boxEditor=null)},_disableTextEditing:function(){this._textEditor&&
(this._textEditor.destroy(),this._textEditor=null);this._map.enableKeyboardNavigation()},_disableSymbolEditing:function(){this._textSymbolEditor&&this._textSymbolEditor.hide()},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._disableTextEditing();this._disableSymbolEditing();this._textAnchor&&(this._textAnchor.getLayer().remove(this._textAnchor),this._textAnchor=null);this._tool=0;this._modified=!1},_mapPanEndHandler:function(){this._refreshMoveables()},
_mapExtentChangeHandler:function(a,b,c){c&&this._refreshMoveables()},_refreshMoveables:function(a){var d=b.filter([this._graphicMover,this._vertexEditor,this._boxEditor],c.isDefined);b.forEach(d,function(b){b.refresh(a)})},_beginOperation:function(a){b.forEach(this._getAffectedTools(a),function(a){a.suspend()})},_endOperation:function(a){b.forEach(this._getAffectedTools(a),function(a){a.resume()})},_getAffectedTools:function(a){var d=[];switch(a){case "MOVE":d=[this._vertexEditor,this._boxEditor];
break;case "VERTICES":d=[this._boxEditor];break;case "BOX":d=[this._vertexEditor]}return b.filter(d,c.isDefined)}});return a.mixin(A,{MOVE:1,EDIT_VERTICES:2,SCALE:4,ROTATE:8,EDIT_TEXT:16}),k("extend-esri")&&a.setObject("toolbars.Edit",A,e),A})},"esri/toolbars/_Box":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/has dojo/dom-style dojox/gfx/Moveable dojox/gfx/matrix ../kernel ../lang ../geometry/Point ../geometry/Polyline ../symbols/SimpleMarkerSymbol ../geometry/webMercatorUtils ../geometry/jsonUtils ../graphic".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t){h=h(null,{declaredClass:"esri.toolbars._Box",constructor:function(a,b,c,d,e,f,g){this._graphic=a;this._map=b;this._toolbar=c;this._scale=d;this._rotate=e;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";this._uniformScaling=f;a=c._options;this._markerSymbol=a.boxHandleSymbol;this._lineSymbol=a.boxLineSymbol;this._moveStartHandler=l.hitch(this,this._moveStartHandler);this._firstMoveHandler=l.hitch(this,this._firstMoveHandler);
this._moveStopHandler=l.hitch(this,this._moveStopHandler);this._moveHandler=l.hitch(this,this._moveHandler);this._isTextPoint=g;this._init()},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null},refresh:function(){this._draw()},suspend:function(){a.forEach(this._getAllGraphics(),function(a){a.hide()})},resume:function(){a.forEach(this._getAllGraphics(),function(a){a.show()});this._draw()},_init:function(){this._draw()},_cleanUp:function(){this._connects&&
a.forEach(this._connects,d.disconnect);var b=this._toolbar._scratchGL;this._anchors&&a.forEach(this._anchors,function(a){b.remove(a.graphic);(a=a.moveable)&&a.destroy()});this._box&&b.remove(this._box);this._box=this._anchors=this._connects=null},_draw:function(){if(!this._graphic.getDojoShape())return void this._cleanUp();var b=this._map,c=this._toolbar._scratchGL,d=this._getBoxCoords(),e=new q(b.spatialReference),f=l.clone(a.filter(d,function(a,b){return 8!==b&&0===b%2}));f[0]&&f.push([f[0][0],
f[0][1]]);e.addPath(f);this._rotate&&e.addPath([d[1],d[8]]);this._box?this._box.setGeometry(e):(this._box=new t(e,this._lineSymbol),c.add(this._box));this._anchors?a.forEach(this._anchors,function(a,c){this._scale||(c=8);var e=new n(d[c],b.spatialReference);a.graphic.setGeometry(e);var e=a.moveable,f=a.graphic.getDojoShape();f&&(e?f!==e.shape&&(e.destroy(),a.moveable=this._getMoveable(a.graphic,c)):a.moveable=this._getMoveable(a.graphic,c))},this):(this._anchors=[],this._connects=[],a.forEach(d,function(a,
d){if(this._scale||!(8>d)){a=new n(a,b.spatialReference);var e=new t(a,this._markerSymbol);this._isTextPoint&&1===d%2&&e.hide();c.add(e);this._anchors.push({graphic:e,moveable:this._getMoveable(e,d)})}},this))},_getBoxCoords:function(b){var c,d,e,f,g=this._map,k=[];if(this._isTextPoint){c=this._graphic.getNode().getBoundingClientRect();var h=g.__container.getBoundingClientRect();c=[{x:c.left-h.left,y:c.top-h.top},{x:c.right-h.left,y:c.top-h.top},{x:c.right-h.left,y:c.bottom-h.top},{x:c.left-h.left,
y:c.bottom-h.top}]}else c=this._getTransformedBoundingBox(this._graphic);if(a.forEach(c,function(a,c,h){d=a;(e=h[c+1])||(e=h[0]);f={x:(d.x+e.x)/2,y:(d.y+e.y)/2};b||(d=g.toMap(d),f=g.toMap(f));k.push([d.x,d.y]);k.push([f.x,f.y])}),this._rotate)c=l.clone(k[1]),c=b?{x:c[0],y:c[1]}:g.toScreen({x:c[0],y:c[1],spatialReference:g.spatialReference}),c.y-=this._toolbar._options.rotateHandleOffset,b||(c=g.toMap(c)),k.push([c.x,c.y]);return k},_getTransformedBoundingBox:function(a){var b=this._map,c=a.geometry.getExtent(),
d=a.geometry.spatialReference;a=new n(c.xmin,c.ymax,d);c=new n(c.xmax,c.ymin,d);return a=b.toScreen(a),c=b.toScreen(c),[{x:a.x,y:a.y},{x:c.x,y:a.y},{x:c.x,y:c.y},{x:a.x,y:c.y}]},_getAllGraphics:function(){var b=[this._box];return this._anchors&&a.forEach(this._anchors,function(a){b.push(a.graphic)}),b=a.filter(b,c.isDefined)},_getMoveable:function(a,b){var c=a.getDojoShape();if(c){var e=new m(c);e._index=b;this._connects.push(d.connect(e,"onMoveStart",this._moveStartHandler));this._connects.push(d.connect(e,
"onFirstMove",this._firstMoveHandler));this._connects.push(d.connect(e,"onMoveStop",this._moveStopHandler));e.onMove=this._moveHandler;c=c.getEventSource();return c&&k.set(c,"cursor",this._toolbar._cursors["box"+b]),e}},_moveStartHandler:function(a){this._toolbar["on"+(8===a.host._index?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic)},_firstMoveHandler:function(b){this._map.disableScrollWheelZoom();var c,d,e=b.host._index,f=this._wrapOffset=b.host.shape._wrapOffsets[0]||0,k=this._graphic.getLayer()._getTransform(),
h=a.map(this._getBoxCoords(!0),function(a){return{x:a[0]+f,y:a[1]}});b=this._isTextPoint?this._map.toScreen(this._graphic.geometry):{x:h[1].x,y:h[3].y};this._centerCoord=g.multiplyPoint(g.invert(k),b);8===e?(c=g.multiplyPoint(g.invert(k),h[1]),this._isTextPoint&&(this._centerCoord=this._deNormalizePoint(this._centerCoord,c)),this._startLine=[this._centerCoord,c],this._moveLine=l.clone(this._startLine)):(c=g.multiplyPoint(g.invert(k),h[e]),d=g.multiplyPoint(g.invert(k),h[(e+4)%8]),this._isTextPoint&&
(this._centerCoord=this._deNormalizePoint(this._centerCoord,c)),this._firstMoverToAnchor=Math.sqrt((c.x-this._centerCoord.x)*(c.x-this._centerCoord.x)+(c.y-this._centerCoord.y)*(c.y-this._centerCoord.y)),this._startBox=d,this._startBox.width=h[4].x-h[0].x,this._startBox.height=h[4].y-h[0].y,this._moveBox=l.clone(this._startBox),this._xfactor=c.x>d.x?1:-1,this._yfactor=c.y>d.y?1:-1,1===e||5===e?this._xfactor=0:(3===e||7===e)&&(this._yfactor=0));this._toolbar._beginOperation("BOX");this._toolbar["on"+
(8===e?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic)},_moveHandler:function(a,b){var c,d,e,f,k,h,m,n,l,r=a.host._index,q=this._defaultEventArgs;(q.angle=0,q.scaleX=1,q.scaleY=1,8===r)?(c=this._startLine,d=this._moveLine,e=d[1],e.x+=b.dx,e.y+=b.dy,d=this._getAngle(c,d),this._isTextPoint&&(d+=this._graphic.symbol.angle),e=g.rotategAt(d,c[0]),this._graphic.getDojoShape().setTransform(e),q.transform=e,q.angle=d,q.around=c[0]):((c=this._startBox,d=this._moveBox,d.width+=b.dx*this._xfactor,
d.height+=b.dy*this._yfactor,this._uniformScaling||this._isTextPoint?(m=d.x+this._xfactor*d.width,n=d.y+this._yfactor*d.height,l=Math.sqrt((m-this._centerCoord.x)*(m-this._centerCoord.x)+(n-this._centerCoord.y)*(n-this._centerCoord.y)),this._scaleRatio=f=k=l/this._firstMoverToAnchor,h=this._centerCoord):(f=d.width/c.width,k=d.height/c.height,h={x:c.x,y:c.y}),(isNaN(f)||f===1/0||f===-(1/0))&&(f=1),(isNaN(k)||k===1/0||k===-(1/0))&&(k=1),e=g.scaleAt(f,k,h),this._isTextPoint)?(c=g.rotategAt(this._graphic.symbol.angle,
h),this._graphic.getDojoShape().setTransform([c,e])):this._graphic.getDojoShape().setTransform(e),q.transform=e,q.scaleX=f,q.scaleY=k,q.around=h);this._toolbar["on"+(8===r?this._rotateEvent:this._scaleEvent)](this._graphic,q)},_moveStopHandler:function(a){this._map.enableScrollWheelZoom();var b,c=this._graphic,d=this._toolbar,e=d._geo?u.geographicToWebMercator(c.geometry):c.geometry,f=e.spatialReference,g=c.getDojoShape(),k=g.getTransform(),h=c.getLayer()._getTransform();this._isTextPoint?(b=this._graphic.symbol,
8===a.host._index?b.angle+=this._getAngle(this._startLine,this._moveLine):b.font.setSize(Math.round(b.font.size*this._scaleRatio*100)/100),this._graphic.setSymbol(b)):(e=e.toJson(),this._updateSegments(e.paths||e.rings,k,h,f),g.setTransform(null),e=v.fromJson(e),c.setGeometry(d._geo?u.webMercatorToGeographic(e,!0):e));this._draw();this._startLine=this._moveLine=this._startBox=this._moveBox=this._xfactor=this._yfactor=null;d._endOperation("BOX");this._defaultEventArgs.transform=k;d["on"+(8===a.host._index?
this._rotateEvent:this._scaleEvent)+"Stop"](this._graphic,this._defaultEventArgs)},_updateSegments:function(b,c,d,e){var f=this._map,k=this._wrapOffset||0;a.forEach(b,function(b){a.forEach(b,function(a){this._updatePoint(a,e,k,g,f,d,c)},this)},this)},_updatePoint:function(a,b,c,d,e,f,g){b=e.toScreen({x:a[0],y:a[1],spatialReference:b},!0);b.x+=c;b=d.multiplyPoint([f,g,d.invert(f)],b);b.x-=c;c=e.toMap(b);a[0]=c.x;a[1]=c.y},_getAngle:function(a,b){var c=180*Math.atan2(a[0].y-a[1].y,a[0].x-a[1].x)/Math.PI;
return 180*Math.atan2(b[0].y-b[1].y,b[0].x-b[1].x)/Math.PI-c},_deNormalizePoint:function(a,b){var c=this._map._getFrameWidth();if(-1===c)return a;for(var d={x:a.x,y:a.y};Math.abs(d.x-b.x)>=c;)d.x<b.x?d.x+=c:d.x-=c;var e=Math.abs(d.x-b.x);return Math.abs(d.x-b.x+c)<e?d.x+=c:Math.abs(d.x-b.x-c)<e&&(d.x-=c),d}});return f("extend-esri")&&l.setObject("toolbars._Box",h,e),h})},"dojox/gfx/Moveable":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/_base/event dojo/topic dojo/touch dojo/dom-class dojo/_base/window ./Mover dojo/mouse".split(" "),
function(h,l,a,d,b,f,k,m,g,e){return l("dojox.gfx.Moveable",null,{constructor:function(a,b){this.shape=a;this.delay=b&&0<b.delay?b.delay:0;this.mover=b&&b.mover?b.mover:g;this.leftButtonOnly=b&&b.leftButtonOnly;this.events=[this.shape.on(f.press,h.hitch(this,"onMouseDown"))]},destroy:function(){a.forEach(this.events,function(a){a.remove()});this.events=this.shape=null},onMouseDown:function(a){this.delay?(this.events.push(this.shape.on(f.move,h.hitch(this,"onMouseMove")),this.shape.on(f.release,h.hitch(this,
"onMouseUp"))),this._lastX=a.clientX,this._lastY=a.clientY):this.leftButtonOnly&&!e.isLeft(a)||new this.mover(this.shape,a,this);d.stop(a)},onMouseMove:function(a){var b=a.clientY;if(Math.abs(a.clientX-this._lastX)>this.delay||Math.abs(b-this._lastY)>this.delay)this.onMouseUp(a),new this.mover(this.shape,a,this);d.stop(a)},onMouseUp:function(a){this.events.pop().remove()},onMoveStart:function(a){b.publish("/gfx/move/start",a);k.add(m.body(),"dojoMove")},onMoveStop:function(a){b.publish("/gfx/move/stop",
a);k.remove(m.body(),"dojoMove")},onFirstMove:function(a){},onMove:function(a,b,d){this.onMoving(a,b,d);this.shape.applyLeftTransform(b);this.onMoved(a,b)},onMoving:function(a,b){},onMoved:function(a,b){}})})},"dojox/gfx/Mover":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/on dojo/touch dojo/_base/event".split(" "),function(h,l,a,d,b,f){return a("dojox.gfx.Mover",null,{constructor:function(a,m,g){this.shape=a;this.lastX=m.clientX;this.lastY=m.clientY;a=this.host=g;m=
document;g=d(m,b.move,h.hitch(this,"onFirstMove"));this.events=[d(m,b.move,h.hitch(this,"onMouseMove")),d(m,b.release,h.hitch(this,"destroy")),d(m,"dragstart",h.hitch(f,"stop")),d(m,"selectstart",h.hitch(f,"stop")),g];if(a&&a.onMoveStart)a.onMoveStart(this)},onMouseMove:function(a){var b=a.clientX,d=a.clientY;this.host.onMove(this,{dx:b-this.lastX,dy:d-this.lastY},a);this.lastX=b;this.lastY=d;f.stop(a)},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove()},destroy:function(){l.forEach(this.events,
function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.shape=null}})})},"esri/toolbars/_GraphicMover":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/json dojo/has dojo/dom-style dojox/gfx/Moveable dojox/gfx/Mover dojox/gfx/matrix ../kernel ../geometry/webMercatorUtils ../geometry/ScreenPoint ../geometry/Point".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q){var r=h(null,{declaredClass:"esri.toolbars._GraphicMover",constructor:function(a,
b,c,d){this.graphic=a;this.map=b;this.toolbar=c;this.tempPt=d;this._enableGraphicMover();this._moved=!1},refresh:function(a){var b=this.graphic.getDojoShape();!b||!a&&b._hostGraphic||(this._disableGraphicMover(),this._enableGraphicMover())},destroy:function(){this._disableGraphicMover()},hasMoved:function(){return this._moved},_enableGraphicMover:function(){var b=this.graphic,c=b.getDojoShape();c&&(c._hostGraphic=b,this._moveable=new k(c,{mover:r.Mover}),this._moveStartHandle=a.connect(this._moveable,
"onMoveStart",this,this._moveStartHandler),this._firstMoveHandle=a.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler),this._movingHandle=a.connect(this._moveable,"onMoving",this,this._movingHandler),this._moveStopHandle=a.connect(this._moveable,"onMoveStop",this,this._moveStopHandler),(b=c.getEventSource())&&f.set(b,"cursor",this.toolbar._cursors.move))},_disableGraphicMover:function(){var b=this._moveable;if(b){a.disconnect(this._moveStartHandle);a.disconnect(this._firstMoveHandle);
a.disconnect(this._movingHandle);a.disconnect(this._moveStopHandle);var c=b.shape;c&&(c._hostGraphic=null,(c=c.getEventSource())&&f.set(c,"cursor",null));b.destroy()}this._moveable=null},_moveStartHandler:function(){var a=this.graphic,b=this.map;this._startTx=a.getDojoShape().getTransform();"point"===this.graphic.geometry.type&&b.snappingManager&&b.snappingManager._setUpSnapping();this.toolbar.onGraphicMoveStart(a)},_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic)},
_movingHandler:function(a){a=a.shape.getTransform();this.tempPt&&this.tempPt.getDojoShape().setTransform(a);this.toolbar.onGraphicMove(this.graphic,a)},_moveStopHandler:function(a){var b=this.graphic,e=this.toolbar,f=this.map,k=e._geo?c.geographicToWebMercator(b.geometry):b.geometry,h=k.type,m=b.getDojoShape(),l=m.getTransform();if(d.toJson(l)!==d.toJson(this._startTx)){switch(this._moved=!0,h){case "point":var r,h=[l,g.invert(this._startTx)];f.snappingManager&&(r=f.snappingManager._snappingPoint);
k=r||f.toMap(g.multiplyPoint(h,f.toScreen(k,!0)));f.snappingManager&&f.snappingManager._killOffSnapping();break;case "polyline":k=this._updatePolyGeometry(k,k.paths,l);break;case "polygon":k=this._updatePolyGeometry(k,k.rings,l)}m.setTransform(null);b.setGeometry(e._geo?c.webMercatorToGeographic(k,!0):k);this.tempPt&&this.tempPt.setGeometry(new q(b.geometry.toJson()))}else this._moved=!1;(e._endOperation("MOVE"),e.onGraphicMoveStop(b,l),this._moved)||(a=a.__e,f=this.map.position,a=new n(a.pageX-f.x,
a.pageY-f.y),e.onGraphicClick(b,{screenPoint:a,mapPoint:this.map.toMap(a)}))},_updatePolyGeometry:function(a,b,c){var d,e,f,g;e=this.map;d=a.getPoint(0,0);e=e.toMap(e.toScreen(d).offset(c.dx,c.dy));c=e.x-d.x;var k=e.y-d.y;for(d=0;d<b.length;d++)for(f=b[d],e=0;e<f.length;e++)g=a.getPoint(d,e),a.setPoint(d,e,g.offset(c,k));return a}});return r.Mover=h(m,{declaredClass:"esri.toolbars._Mover",constructor:function(a,b,c){this.__e=b}}),b("extend-esri")&&(l.setObject("toolbars._GraphicMover",r,e),l.setObject("toolbars._Mover",
r.Mover,e)),r})},"esri/toolbars/_VertexEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/has dijit/Menu dijit/MenuItem ../kernel ./_VertexMover ../geometry/Point ../geometry/jsonUtils dojo/i18n!../nls/jsapi".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n){var q=h(null,{declaredClass:"esri.toolbars._GraphicVertexEditor",constructor:function(a,b,c){this.graphic=a;this.map=b;this.toolbar=c;a=c._options;this._symbol1=a.vertexSymbol;this._symbol2=a.ghostVertexSymbol;
b=a.ghostLineSymbol;this._lineStroke={style:b.style,width:b.width,color:b.color};this._canDel=a.allowDeleteVertices;this._canAdd=a.allowAddVertices;this._addControllers()},destroy:function(){this._removeControllers()},refresh:function(a){a?(this._removeControllers(),this._addControllers()):(this._refresh(this._vertexMovers),this._refresh(this._mpVertexMovers))},suspend:function(){this._suspended||this._removeControllers();this._suspended=!0},resume:function(){this._suspended&&this._addControllers();
this._suspended=!1},_addControllers:function(){this._firstMoveHandle=a.connect(g,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=a.connect(g,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),this._symbol1);this._canAdd&&(this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,!0));var b=this._getGraphicsLayer();if(this._mouseOverHandle=a.connect(b,"onMouseOver",this,this._mouseOverHandler),
this._mouseOutHandle=a.connect(b,"onMouseOut",this,this._mouseOutHandler),this._canDel)this._ctxMenu=new f({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"}),b=this._ctxDelete=new k({label:n.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}),this._deleteHandle=a.connect(b,"onClick",this,this._deleteHandler),this._ctxMenu.addChild(b),this._ctxMenu.startup()},_removeControllers:function(){a.disconnect(this._firstMoveHandle);a.disconnect(this._moveStopHandle);
a.disconnect(this._mouseOverHandle);a.disconnect(this._mouseOutHandle);a.disconnect(this._deleteHandle);this._ctxMenu&&(this._ctxDelete=null,this._unbindCtxNode(),this._ctxMenu.destroyRecursive());this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=this._mpVertexMovers=null},_add:function(a,b,c){var d,e,f=this.graphic,k=[];for(d=0;d<a.length;d++){var h=a[d],m=[];for(e=0;e<h.length;e++)m.push(new g(h[e],b,f,d,e,h.length,this,c));k.push(m)}return k},_remove:function(a){a&&
d.forEach(a,function(a){d.forEach(a,function(a){a.destroy()})})},_refresh:function(a){a&&d.forEach(a,function(a){d.forEach(a,function(a){a.refresh()})})},_isNew:function(a){return-1===d.indexOf(this._vertexMovers[a.segIndex],a)?!0:!1},_getGraphicsLayer:function(){return this.toolbar._scratchGL},_deleteHandler:function(a){a=this._selectedMover;a.ptIndex;this._updateRelatedGraphic(a,a.relatedGraphic,a.graphic.geometry,a.segIndex,a.ptIndex,a.segLength,!1,!0);this._canAdd&&this._deleteMidpoints(a);this._deleteVertex(a);
this.toolbar._endOperation("VERTICES")},_mouseOverHandler:function(a){a=a.graphic;var b=this._findMover(a);b&&(this.toolbar.onVertexMouseOver(this.graphic,b._getInfo()),b._placeholder||(this._selectedMover=b,this._canDel&&this._bindCtxNode(a.getDojoShape().getNode())))},_mouseOutHandler:function(a){(a=this._findMover(a.graphic))&&this.toolbar.onVertexMouseOut(this.graphic,a._getInfo())},_bindCtxNode:function(a){this._unbindCtxNode();this._ctxDelete.set("disabled",this._selectedMover.segLength<=this.minLength?
!0:!1);this._ctxMenu.bindDomNode(a);this._bindNode=a},_unbindCtxNode:function(){var a=this._bindNode;a&&this._ctxMenu.unBindDomNode(a)},_findMover:function(a){var b,c=[];b=this._mpVertexMovers;d.forEach(this._vertexMovers,function(a){c=c.concat(a)});b&&d.forEach(b,function(a){c=c.concat(a)});for(b=0;b<c.length;b++){var e=c[b];if(e.graphic===a)return e}},_firstMoveHandler:function(a){!this._isNew(a)&&this._canAdd&&this._hideRelatedMidpoints(a);this.toolbar._beginOperation("VERTICES")},_moveStopHandler:function(a,
b){var c=this._isNew(a);return b&&(b.dx||b.dy)?(this._updateRelatedGraphic(a,a.relatedGraphic,a.graphic.geometry,a.segIndex,a.ptIndex,a.segLength,c),this._canAdd&&(c?this._addMidpoints(a):(this._repositionRelatedMidpoints(a),this._showRelatedMidpoints(a))),void this.toolbar._endOperation("VERTICES")):void(!c&&this._canAdd&&this._showRelatedMidpoints(a))},_showRelatedMidpoints:function(a){var b=this._getAdjacentMidpoints(a.ptIndex,a.segLength),c=this._mpVertexMovers[a.segIndex];for(a=0;a<b.length;a++){var d=
c[b[a]];d.graphic.show();d.refresh()}},_hideRelatedMidpoints:function(a){var b=this._getAdjacentMidpoints(a.ptIndex,a.segLength),c=this._mpVertexMovers[a.segIndex];for(a=0;a<b.length;a++)c[b[a]].graphic.hide()},_repositionRelatedMidpoints:function(a){var b,c=this._getAdjacentMidpoints(a.ptIndex,a.segLength),d=this._mpVertexMovers[a.segIndex];for(b=0;b<c.length;b++){var f=this._getAdjacentVertices(c[b],a.segLength),g=a.relatedGraphic.geometry.getPoint(a.segIndex,f[0]),f=a.relatedGraphic.geometry.getPoint(a.segIndex,
f[1]),g=new e({x:(g.x+f.x)/2,y:(g.y+f.y)/2,spatialReference:g.spatialReference.toJson()});d[c[b]].graphic.setGeometry(g)}},_addMidpoints:function(a){var b,c=a.segIndex,d=a.ptIndex,f=a.segLength,k=d+1,h=f+1;this._mpVertexMovers[c].splice(d,1);var m=this._vertexMovers[c];for(b=0;k>b;b++)m[b].segLength+=1;for(b=k;b<m.length;b++)m[b].ptIndex+=1,m[b].segLength+=1;a.ptIndex=k;a.segLength=m.length+1;m.splice(k,0,a);a.graphic.setSymbol(this._symbol1);m=this._mpVertexMovers[c];for(b=0;d>b;b++)m[b].segLength+=
1;for(b=d;f-1>b;b++)m[b].ptIndex+=1,m[b].segLength+=1;f=this._getAdjacentVertices(d,h);c=this._getAdjacentVertices(d+1,h);b=a.relatedGraphic.geometry.getPoint(a.segIndex,f[0]);k=a.relatedGraphic.geometry.getPoint(a.segIndex,f[1]);f=new e({x:(b.x+k.x)/2,y:(b.y+k.y)/2,spatialReference:b.spatialReference.toJson()});b=a.relatedGraphic.geometry.getPoint(a.segIndex,c[0]);k=a.relatedGraphic.geometry.getPoint(a.segIndex,c[1]);b=new e({x:(b.x+k.x)/2,y:(b.y+k.y)/2,spatialReference:b.spatialReference.toJson()});
c=new g(f,this._symbol2,this.graphic,a.segIndex,d,h,this,!0);a=new g(b,this._symbol2,this.graphic,a.segIndex,d+1,h,this,!0);m.splice(d,0,c,a)},_deleteVertex:function(a){var b,c=a.ptIndex,d=this._vertexMovers[a.segIndex];for(b=0;c>b;b++)--d[b].segLength;for(b=c+1;b<d.length;b++){var e=d[b];--e.ptIndex;--e.segLength}d.splice(c,1);b=a._getInfo();a.destroy();this.toolbar.onVertexDelete(this.graphic,b)}});return l.mixin(q,{create:function(a,b,c){switch(a.geometry.type){case "multipoint":return new q.MultipointVertexEditor(a,
b,c);case "polyline":return new q.PolylineVertexEditor(a,b,c);case "polygon":return new q.PolygonVertexEditor(a,b,c)}}}),q.MultipointVertexEditor=h(q,{declaredClass:"esri.toolbars._MultipointVertexEditor",minLength:1,constructor:function(){this._moveStartHandle=a.connect(g,"onMoveStart",this,this._moveStartHandler);a.disconnect(this._firstMoveHandle)},destroy:function(){this.inherited(arguments);a.disconnect(this._moveStartHandle)},_getSegments:function(a){var b=a.points,c=[],d=a.spatialReference;
for(a=0;a<b.length;a++){var f=b[a];c.push(new e({x:f[0],y:f[1],spatialReference:d.toJson()}))}return[c]},_getMidpointSegments:function(a){return[]},_getControlPoints:function(a,b,c,d,e){return[]},_getGraphicsLayer:function(){return this.graphic._graphicsLayer},_mouseOverHandler:function(a){var b=a.graphic;(a=this._findMover(a))&&(this.toolbar.onVertexMouseOver(b,a._getInfo()),this._selectedMover=a,this._canDel&&this._bindCtxNode(a.graphic.getDojoShape().getNode()))},_mouseOutHandler:function(a){var b=
a.graphic;(a=this._findMover(a))&&this.toolbar.onVertexMouseOut(b,a._getInfo())},_findMover:function(a){var b=[].concat(this._vertexMovers[0]),c=a.target;for(a=0;a<b.length;a++){var d=b[a];if(d.graphic.getDojoShape().getNode()===c)return d}},_moveStartHandler:function(a){var b=a.ptIndex,c=a.segLength-1,d=a.relatedGraphic.geometry.points;a=d.splice(b,1);d.push(a[0]);d=this._vertexMovers[0];for(a=c;a>b;a--)--d[a].ptIndex;a=d.splice(b,1);d.push(a[0]);a[0].ptIndex=c},_moveStopHandler:function(a){this._updateRelatedGraphic(a,
a.relatedGraphic,a.graphic.geometry,a.segIndex,a.ptIndex,a.segLength);this.toolbar._endOperation("VERTICES")},_updateRelatedGraphic:function(a,b,c,d,e,f,g,k){a=b.geometry;k?a.removePoint(e):a.setPoint(e,c);b.setGeometry(a)},_deleteMidpoints:function(a){}}),q.PolylineVertexEditor=h(q,{declaredClass:"esri.toolbars._PolylineVertexEditor",minLength:2,_getSegments:function(a){var b,c,d=a.paths,e=[];for(b=0;b<d.length;b++){var f=d[b],g=[];for(c=0;c<f.length;c++)g.push(a.getPoint(b,c));e.push(g)}return e},
_getMidpointSegments:function(a){var b,c,d=a.paths,f=[],g=a.spatialReference;for(b=0;b<d.length;b++){var k=d[b],h=[];for(c=0;c<k.length-1;c++){var m=a.getPoint(b,c),n=a.getPoint(b,c+1),m=new e({x:(m.x+n.x)/2,y:(m.y+n.y)/2,spatialReference:g.toJson()});h.push(m)}f.push(h)}return f},_getControlPoints:function(a,b,c,d,e){var f,g,k,h,m=this.map;return this._isNew(a)?(f=d,g=d+1,0<=f&&(k=m.toScreen(b.getPoint(c,f))),e>=g&&(h=m.toScreen(b.getPoint(c,g)))):(f=d-1,g=d+1,0<=f&&(k=m.toScreen(b.getPoint(c,f))),
e>g&&(h=m.toScreen(b.getPoint(c,g)))),[k,h]},_getAdjacentMidpoints:function(a,b){var c=[],d=a-1;0<=d&&c.push(d);return b-1>a&&c.push(a),c},_getAdjacentVertices:function(a,b){return[a,a+1]},_deleteMidpoints:function(a){var b,c=this._mpVertexMovers[a.segIndex],d=c.length-1,f=this._getAdjacentMidpoints(a.ptIndex,a.segLength).sort(),k=f[0];for(b=0;k>b;b++)--c[b].segLength;for(b=k+1;b<c.length;b++){var h=c[b];--h.ptIndex;--h.segLength}if(1===f.length)c.splice(k,1)[0].destroy();else for(h=this._getAdjacentVertices(k,
d),b=a.relatedGraphic.geometry.getPoint(a.segIndex,h[0]),h=a.relatedGraphic.geometry.getPoint(a.segIndex,h[1]),b=new e({x:(b.x+h.x)/2,y:(b.y+h.y)/2,spatialReference:b.spatialReference.toJson()}),a=new g(b,this._symbol2,this.graphic,a.segIndex,k,d,this,!0),c=c.splice(k,f.length,a),b=0;b<c.length;b++)c[b].destroy()},_updateRelatedGraphic:function(a,b,d,e,f,g,k,h){a=b.geometry;k?a.insertPoint(e,f+1,c.fromJson(d.toJson())):h?a.removePoint(e,f):a.setPoint(e,f,c.fromJson(d.toJson()));b.setGeometry(a)}}),
q.PolygonVertexEditor=h(q,{declaredClass:"esri.toolbars._PolygonVertexEditor",minLength:3,_getSegments:function(a){var b,c,d=a.rings,e=[];for(b=0;b<d.length;b++){var f=d[b],g=[];for(c=0;c<f.length-1;c++)g.push(a.getPoint(b,c));e.push(g)}return e},_getMidpointSegments:function(a){var b,c,d=a.rings,f=[],g=a.spatialReference;for(b=0;b<d.length;b++){var k=d[b],h=[];for(c=0;c<k.length-1;c++){var m=a.getPoint(b,c),n=a.getPoint(b,c+1),m=new e({x:(m.x+n.x)/2,y:(m.y+n.y)/2,spatialReference:g.toJson()});h.push(m)}f.push(h)}return f},
_getControlPoints:function(a,b,c,d,e){var f,g,k,h,m=this.map;return this._isNew(a)?(f=d,g=(d+1)%e):(f=d-1,f=0>f?(e+f)%e:f,g=(d+1)%e),k=m.toScreen(b.getPoint(c,f)),h=m.toScreen(b.getPoint(c,g)),[k,h]},_getAdjacentMidpoints:function(a,b){var c=a-1;return[0>c?(b+c)%b:c,a]},_getAdjacentVertices:function(a,b){return[a,(a+1)%b]},_deleteMidpoints:function(a){var b,c,d,f;c=a.ptIndex;var k=this._mpVertexMovers[a.segIndex],h=k.length-1;d=this._getAdjacentMidpoints(c,a.segLength).sort();f=d[0];var m=d[d.length-
1];if(0===c)for(b=this._getAdjacentVertices(h-1,h),c=a.relatedGraphic.geometry.getPoint(a.segIndex,b[0]),b=a.relatedGraphic.geometry.getPoint(a.segIndex,b[1]),c=new e({x:(c.x+b.x)/2,y:(c.y+b.y)/2,spatialReference:c.spatialReference.toJson()}),a=new g(c,this._symbol2,this.graphic,a.segIndex,h-1,h,this,!0),k.splice(m,1,a)[0].destroy(),k.splice(f,1)[0].destroy(),d=0;d<k.length-1;d++)f=k[d],--f.ptIndex,--f.segLength;else{b=this._getAdjacentVertices(f,h);c=a.relatedGraphic.geometry.getPoint(a.segIndex,
b[0]);b=a.relatedGraphic.geometry.getPoint(a.segIndex,b[1]);c=new e({x:(c.x+b.x)/2,y:(c.y+b.y)/2,spatialReference:c.spatialReference.toJson()});a=new g(c,this._symbol2,this.graphic,a.segIndex,f,h,this,!0);m=k.splice(f,d.length,a);for(d=0;d<m.length;d++)m[d].destroy();for(d=0;f>d;d++)--k[d].segLength;for(d=f+1;d<k.length;d++)f=k[d],--f.ptIndex,--f.segLength}},_updateRelatedGraphic:function(a,b,d,e,f,g,k,h){a=b.geometry;k?a.insertPoint(e,f+1,c.fromJson(d.toJson())):h?(a.removePoint(e,f),0===f&&a.setPoint(e,
g-1,c.fromJson(a.getPoint(e,0).toJson()))):(a.setPoint(e,f,c.fromJson(d.toJson())),0===f&&a.setPoint(e,g,c.fromJson(d.toJson())));b.setGeometry(a)}}),b("extend-esri")&&(l.setObject("toolbars._GraphicVertexEditor",q,m),l.setObject("toolbars._MultipointVertexEditor",q.MultipointVertexEditor,m),l.setObject("toolbars._PolylineVertexEditor",q.PolylineVertexEditor,m),l.setObject("toolbars._PolygonVertexEditor",q.PolygonVertexEditor,m)),q})},"esri/toolbars/_VertexMover":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/has dojo/sniff dojo/dom-style dojox/gfx/Moveable ../kernel ../geometry/Point ../graphic ../geometry/webMercatorUtils".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c){h=h(null,{declaredClass:"esri.toolbars.VertexMover",constructor:function(a,b,c,d,e,f,g,k){this.point=a;this.symbol=b;this.relatedGraphic=c;this.segIndex=d;this.ptIndex=e;this.segLength=f;this.editor=g;this.map=g.map;this._scratchGL=g.toolbar._scratchGL;this._placeholder=k||!1;this._type=c.geometry.type;this._init();this._enable()},refresh:function(a){(a||this._needRefresh())&&(this._disable(),this._enable())},destroy:function(){this._disable();this.graphic&&this._scratchGL.remove(this.graphic);
this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=this.segLength=this.editor=this.map=this._scratchGL=null},_init:function(){var a=new g(this.point.toJson()),a=new e(a,this.symbol);switch(this._type){case "multipoint":a._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(a)}this.graphic=a},_enable:function(){var a=this.graphic.getDojoShape();a&&(a._hasMover=!0,this._moveable=this._getMoveable(a),
(a=a.getEventSource())&&f.set(a,"cursor",this.editor.toolbar._cursors[this._placeholder?"move-gv":"move-v"]))},_disable:function(){var b=this._moveable;if(b){a.disconnect(this._startHandle);a.disconnect(this._firstHandle);a.disconnect(this._movingHandle);a.disconnect(this._stopHandle);var c=b.shape;c&&(c=c.getEventSource())&&f.set(c,"cursor",null);b.destroy();this._moveable=null}},_needRefresh:function(){var a=this.graphic.getDojoShape(),b=!1;if(a)switch(this._type){case "multipoint":var c=this.relatedGraphic.getDojoShape();
c&&(c=c.children[this.ptIndex],a!==c&&(a=c,this.graphic._shape=a,b=!0));break;case "polyline":case "polygon":b=!a._hasMover}return b},_getMoveable:function(c){c=new k(c,b("mac")&&b("ff")&&!d("esri-touch")&&{leftButtonOnly:!0});return this._startHandle=a.connect(c,"onMoveStart",this,this._moveStartHandler),this._firstHandle=a.connect(c,"onFirstMove",this,this._firstMoveHandler),this._movingHandle=a.connect(c,"onMoving",this,this._movingHandler),this._stopHandle=a.connect(c,"onMoveStop",this,this._moveStopHandler),
c},_getPtIndex:function(){return this.ptIndex+(this._placeholder?1:0)},_getInfo:function(){return{graphic:this.graphic,isGhost:this._placeholder,segmentIndex:this.segIndex,pointIndex:this._getPtIndex()}},_moveStartHandler:function(a){var b=this.map;b.snappingManager&&b.snappingManager._setUpSnapping();b.disableScrollWheelZoom();a.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo())},_firstMoveHandler:function(a){var b,c=
a.shape,d=this._getControlEdges(),e=this._scratchGL._div,f=[],g=a.host.shape._wrapOffsets[0]||0;for(b=0;b<d.length;b++){var k=d[b];k.x1+=g;k.x2+=g;f.push([e.createLine({x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2}).setStroke(this.editor._lineStroke),k.x1,k.y1,k.x2,k.y2])}c._lines=f;a.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo())},_movingHandler:function(a,b,c){var e;b=this.map;d("esri-pointer")&&(e=b.navigationManager.pointerEvents._processTouchEvent(c,
c),b.snappingManager&&b.snappingManager._onSnappingMouseMoveHandler(e));c=a.shape;a=c.getTransform();e=c._lines;for(c=0;c<e.length;c++)b=e[c],b[0].setShape({x1:b[1]+a.dx,y1:b[2]+a.dy,x2:b[3],y2:b[4]});this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),a)},_moveStopHandler:function(a){a=a.shape;var b=this.editor.toolbar,d=a.getTransform(),e=this.map,f=this.graphic,g=b._geo?c.geographicToWebMercator(f.geometry):f.geometry;e.enableScrollWheelZoom();var k,h=a._lines;if(h){for(k=0;k<
h.length;k++)h[k][0].removeShape();a._lines=null}k=!1;var h=!0,m=this._getInfo();d&&(d.dx||d.dy)?this._placeholder&&(this._placeholder=!1,k=!0):h=!1;var l;e.snappingManager&&(l=e.snappingManager._snappingPoint);l=l||e.toMap(e.toScreen(g).offset(d.dx,d.dy));e.snappingManager&&e.snappingManager._killOffSnapping();a.setTransform(null);f.setGeometry(b._geo?c.webMercatorToGeographic(l,!0):l);this.constructor.onMoveStop(this,d);b.onVertexMoveStop(this.relatedGraphic,m,d);h||b.onVertexClick(this.relatedGraphic,
m);k&&b.onVertexAdd(this.relatedGraphic,this._getInfo())},_getControlEdges:function(){var a=this.map,b=this.relatedGraphic.geometry,c=this.segIndex,d=this.ptIndex,e=this.segLength,f=this._scratchGL._getTransform(),g=f.dx,f=f.dy,k=a.toScreen(this.graphic.geometry),a=k.x-g,k=k.y-f,h=[],b=this.editor._getControlPoints(this,b,c,d,e);return b[0]&&h.push({x1:a,y1:k,x2:b[0].x-g,y2:b[0].y-f}),b[1]&&h.push({x1:a,y1:k,x2:b[1].x-g,y2:b[1].y-f}),h}});return d("extend-esri")&&l.setObject("toolbars.VertexMover",
h,m),l.mixin(h,{onMoveStart:function(){},onFirstMove:function(){},onMoveStop:function(){}}),h})},"esri/toolbars/TextEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/event dojo/has dojo/dom-construct dojo/dom-class dojo/dom-style dojo/keys ../kernel".split(" "),function(h,l,a,d,b,f,k,m,g,e){h=h(null,{declaredClass:"esri.toolbars.TextEditor",constructor:function(a,b,d){this._graphic=a;this._map=b;this._toolbar=d;this._enable(this._graphic)},destroy:function(){this._disable()},
onEditStart:function(){},onEditEnd:function(){},_enable:function(b){return this._editBox?(a.disconnect(this._addEditBoxHandler),void(this._addEditBoxHandler=null)):(this._map.navigationManager.setImmediateClick(!0),void(this._addEditBoxHandler=a.connect(b.getLayer(),"onDblClick",this,function(e){this._map.navigationManager.setImmediateClick(!1);e.graphic==b&&(d.stop(e),a.disconnect(this._addEditBoxHandler),this._addEditBoxHandler=null,this._addTextBox(b))})))},_disable:function(){this._applyEdit();
this._addEditBoxHandler&&(a.disconnect(this._addEditBoxHandler),this._addEditBoxHandler=null);this._removeTextBox();this.onEditEnd(this._graphic);this._toolbar.onTextEditEnd(this._graphic)},_addTextBox:function(b,d){if(!this._editBox){var e;b.symbol.text||(b.symbol.text="Tempt text",b.setSymbol(b.symbol),e="");var h=this._createInputTextStyle(b,this._map);""!==e&&(e=d||b.symbol.text);this._editBox=f.create("input",{type:"text",value:e});m.set(this._editBox,h);k.add(this._editBox,"esriTextEditorInput");
this._map.container.appendChild(this._editBox);this._editBox.focus();this._editBoxKeyHandler=a.connect(this._editBox,"onkeyup",l.hitch(this,function(a){a.keyCode!=g.ENTER&&a.keyCode!==g.TAB||this._disable()}));this._editBoxBlurHandler=a.connect(this._editBox,"onblur",l.hitch(this,function(a){this._disable()}));b.symbol.text="";b.setSymbol(b.symbol);b.hide();var u=this._editBox;this._disableBoxHandler||(this._disableBoxHandler=this._map.on("zoom-start",l.hitch(this,function(){this._disable()})));this._moveBoxHandler=
this._map.on("pan",function(a){m.set(u,{left:this._editBoxLeft+a.delta.x+"px",top:this._editBoxTop+a.delta.y+"px"})});this._moveBoxStartHandler=this._map.on("pan-start",function(){this._editBoxLeft=parseFloat(m.get(u,"left"));this._editBoxTop=parseFloat(m.get(u,"top"))});this.onEditStart(b,this._editBox);this._toolbar.onTextEditStart(b,this._editBox)}},_removeTextBox:function(){this._editBoxBlurHandler&&(a.disconnect(this._editBoxBlurHandler),this._editBoxBlurHandler=null);this._editBox&&(this._editBox.parentNode.removeChild(this._editBox),
this._editBox=null);this._disableBoxHandler&&(this._disableBoxHandler.remove(),this._disableBoxHandler=null);this._moveBoxHandler&&(this._moveBoxHandler.remove(),this._moveBoxHandler=null);this._moveBoxStartHandler&&(this._moveBoxStartHandler.remove(),this._moveBoxStartHandler=null);this._editBoxKeyHandler&&(a.disconnect(this._editBoxKeyHandler),this._editBoxKeyHandler=null)},_createInputTextStyle:function(a,b){var d=a.getDojoShape().getTransformedBoundingBox(),e=Math.abs(d[0].x-d[1].x)/Math.cos(a.symbol.angle/
180*Math.PI),f=a.symbol.font;return{"font-family":f.family,"font-size":f.size+"px","font-style":f.style,"font-variant":f.variant,"font-weight":f.weight,left:d[0].x+"px",top:d[0].y+"px",width:e+"px"}},_applyEdit:function(){if(this._editBox)if(this._editBox.value){this._graphic.show();var a=this._graphic.symbol;a.text=this._editBox.value;this._graphic.setSymbol(a)}else this._graphic.getLayer().remove(this._graphic)}});return b("extend-esri")&&l.setObject("toolbars.TextEditor",h,e),h})},"esri/dijit/AttributeInspector":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/sniff dojo/_base/kernel dojo/has dojo/dom-style dojo/dom-construct ../kernel ../lang ../domUtils ../layers/InheritedDomain ../layers/FeatureLayer dojo/i18n!../nls/jsapi dojo/fx dojox/gfx dijit/_Widget dijit/_Templated dijit/Editor dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/TextColor ./_EventedWidget ./editing/AttachmentEditor ./editing/Util ../tasks/query dijit/form/DateTextBox dijit/form/TextBox dijit/form/NumberTextBox dijit/form/FilteringSelect dijit/form/NumberSpinner dijit/form/Button dijit/form/SimpleTextarea dijit/form/ValidationTextBox dijit/form/TimeTextBox dijit/Tooltip dojo/data/ItemFileReadStore dojox/date/islamic dojox/date/islamic/Date dojox/date/islamic/locale dojo/text!./templates/AttributeInspector.html".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K,J,I,L,M,N,Q,O,T,S,R,U){var W=h([B,w,x],{declaredClass:"esri.dijit.AttributeInspector",widgetsInTemplate:!0,templateString:U,onUpdate:function(){},onDelete:function(){},onAttributeChange:function(){},onNext:function(){},onReset:function(){},onCancel:function(){},_navMessage:"( ${idx} ${of} ${numFeatures} )",_currentAttributeFieldName:null,_aiConnects:[],_selection:[],_toolTips:[],_numFeatures:0,_featureIdx:0,_currentLInfo:null,_currentFeature:null,
_rollbackInfo:null,_eventMap:{update:!0,"delete":["feature"],"attribute-change":["feature","fieldName","fieldValue"],next:["feature"],reset:!0,cancel:!0},constructor:function(b,c){l.mixin(this,u.widgets.attributeInspector);b=b||{};b.featureLayer||b.layerInfos||console.error("esri.AttributeInspector: please provide correct parameter in the constructor");this._datePackage=this._getDatePackage(b);this._layerInfos=b.layerInfos||[{featureLayer:b.featureLayer,options:b.options||[]}];this._layerInfos=a.filter(this._layerInfos,
function(a){return!a.disableAttributeUpdate});this._hideNavButtons=b.hideNavButtons||!1},postCreate:function(){if(a.every(this._layerInfos,function(a){return a.featureLayer.loaded}))this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature();else{var b=this._layerInfos.length;a.forEach(this._layerInfos,function(a){a=a.featureLayer;if(a.loaded)b--;else var c=d.connect(a,"onLoad",this,function(a){d.disconnect(c);c=null;b--;b||(this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature())})},
this)}},destroy:function(){this._destroyAttributeTable();a.forEach(this._aiConnects,d.disconnect);delete this._aiConnects;this._attachmentEditor&&(this._attachmentEditor.destroy(),delete this._attachmentEditor);delete this._layerInfos;this._selection=this._currentFeature=this._currentLInfo=this._attributes=this._layerInfos=null;this.inherited(arguments)},refresh:function(){this._updateSelection()},first:function(){this.onFirstFeature()},last:function(){this.onLastFeature()},next:function(){this.onNextFeature()},
previous:function(){this.onPreviousFeature()},showFeature:function(a,b){b&&(this._createOnlyFirstTime=!0);this._updateSelection([a],b);this._updateUI()},onLayerSelectionChange:function(a,b,c){this._createOnlyFirstTime=!1;this._featureIdx=c===r.SELECTION_NEW?0:this._featureIdx;this._updateSelection();this._updateUI()},onLayerSelectionClear:function(){!this._selection||0>=this._selection.length||(this._numFeatures=0,this._featureIdx=0,this._selection=[],this._currentFeature=null,this._currentLInfo=
null,this._updateUI())},onLayerUpdateEnd:function(a,b,c,d){},onLayerError:function(a,b,c,d){},onLayerEditsError:function(a,b,c,d){},onLayerEditsComplete:function(b,c,d,e){if(e=e||[],e.length){var f=this._selection,g=b.featureLayer.objectIdField;a.forEach(e,l.hitch(this,function(b){a.some(f,l.hitch(this,function(a,c){return a.attributes[g]!==b.objectId?!1:(this._selection.splice(c,1),!0)}))}))}c=c||[];c.length&&(this._selection=D.findFeatures(c,b.featureLayer),this._featureIdx=0);e=this._numFeatures=
this._selection?this._selection.length:0;if(c.length){if(c=e?this._selection[this._featureIdx]:null)e=c.getLayer().getEditCapabilities(),e.canCreate&&!e.canUpdate||this._showFeature(c);this._updateUI()}if(d=d||[],d.length){var k=this._rollbackInfo;a.forEach(d,function(c){var e=D.findFeatures(d,b.featureLayer)[0];if(!c.success&&e.attributes[b.featureLayer.objectIdField]===c.objectId&&k){c=k.graphic.attributes[k.field.name];var f=a.filter(this._currentLInfo.fieldInfos,function(a){return a.fieldName===
k.field.name},this)[0].dijit;e.attributes[k.field.name]=c;this._setValue(f,c)}},this)}this._rollbackInfo=null},onFieldValueChange:function(b,c){var d=b.field,e=b.dijit,f=this._currentFeature,g=this._currentLInfo,k=d.name;if(""!==e.displayedValue&&"undefined"==typeof c&&!e.isValid()||""!==e.displayedValue&&e.displayedValue!==c&&e.isValid&&!e.isValid())return void this._setValue(e,f.attributes[d.name]);if(c="undefined"==typeof c?null:c,"esriFieldTypeDate"===d.type){if(e instanceof Array){var h=e[0].getValue(),
e=e[1].getValue();c=h&&e?new Date(h.getFullYear(),h.getMonth(),h.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()):h||e||null}else c=e.getValue();c=c&&c.getTime?c.getTime():c&&c.toGregorian?c.toGregorian().getTime():c}if(this._currentFeature.attributes[d.name]!==c){if(k===g.typeIdField){var m=this._findFirst(g.types,"id",c);a.forEach(g.fieldInfos,function(a){if(d=a.field,d&&d.name!==g.typeIdField)a=a.dijit,this._setFieldDomain(a,m,d)&&a&&(this._setValue(a,f.attributes[d.name]+
""),!1===a.isValid()&&this._setValue(a,null))},this)}this.onAttributeChange(f,k,c)}},onDeleteBtn:function(a){this._deleteFeature()},onNextFeature:function(a){this._onNextFeature(1)},onPreviousFeature:function(a){this._onNextFeature(-1)},onFirstFeature:function(a){this._onNextFeature(-1*this._featureIdx)},onLastFeature:function(a){this._onNextFeature(this._numFeatures-1-this._featureIdx)},_initLayerInfos:function(){var b=this._layerInfos;this._editorTrackingInfos={};a.forEach(b,this._initLayerInfo,
this)},_initLayerInfo:function(b){var d,e,f=b.featureLayer;this._userIds={};e=f.id;f.credential&&(this._userIds[e]=f.credential.userId);b.userId&&(this._userIds[e]=b.userId);this._connect(f,"onSelectionComplete",l.hitch(this,"onLayerSelectionChange",b));this._connect(f,"onSelectionClear",l.hitch(this,"onLayerSelectionClear",b));this._connect(f,"onEditsComplete",l.hitch(this,"onLayerEditsComplete",b));this._connect(f,"error",l.hitch(this,"onLayerError",b));this._connect(f,"onUpdateEnd",l.hitch(this,
"onLayerUpdateEnd",b));b.showAttachments=f.hasAttachments?c.isDefined(b.showAttachments)?b.showAttachments:!0:!1;b.hideFields=b.hideFields||[];b.htmlFields=b.htmlFields||[];b.isEditable=f.isEditable()?c.isDefined(b.isEditable)?b.isEditable:!0:!1;b.typeIdField=f.typeIdField;b.layerId=f.id;b.types=f.types;f.globalIdField&&(d=this._findFirst(b.fieldInfos,"fieldName",f.globalIdField),d||b.showGlobalID||b.hideFields.push(f.globalIdField));(e=this._findFirst(b.fieldInfos,"fieldName",f.objectIdField))||
b.showObjectID||b.hideFields.push(f.objectIdField);var g=this._getFields(b.featureLayer);if(g){var k=b.fieldInfos||[],k=a.map(k,function(a){return l.mixin({},a)});k.length?b.fieldInfos=a.filter(a.map(k,l.hitch(this,function(a){var c=a.stringFieldOption||(this._isInFields(a.fieldName,b.htmlFields)?W.STRING_FIELD_OPTION_RICHTEXT:W.STRING_FIELD_OPTION_TEXTBOX);return l.mixin(a,{field:this._findFirst(g,"name",a.fieldName),stringFieldOption:c})})),"return item.field;"):(g=a.filter(g,l.hitch(this,function(a){return!this._isInFields(a.name,
b.hideFields)})),b.fieldInfos=a.map(g,l.hitch(this,function(a){var c=this._isInFields(a.name,b.htmlFields)?W.STRING_FIELD_OPTION_RICHTEXT:W.STRING_FIELD_OPTION_TEXTBOX;return{fieldName:a.name,field:a,stringFieldOption:c}})));b.showGlobalID&&!d&&k.push(this._findFirst(g,"name",f.globalIdField));b.showObjectID&&!e&&k.push(this._findFirst(g,"name",f.objectIdField));d=[];f.editFieldsInfo&&(f.editFieldsInfo.creatorField&&d.push(f.editFieldsInfo.creatorField),f.editFieldsInfo.creationDateField&&d.push(f.editFieldsInfo.creationDateField),
f.editFieldsInfo.editorField&&d.push(f.editFieldsInfo.editorField),f.editFieldsInfo.editDateField&&d.push(f.editFieldsInfo.editDateField));this._editorTrackingInfos[f.id]=d}},_createAttachmentEditor:function(){this._attachmentEditor=null;var b=a.filter(this._layerInfos,function(a){return a.showAttachments});b&&b.length&&(this._attachmentEditor=new C({"class":"atiAttachmentEditor"},this.attachmentEditor),this._attachmentEditor.startup())},_setCurrentLInfo:function(a){var b=this._currentLInfo?this._currentLInfo.featureLayer:
null,c=a.featureLayer;if(b&&b.id===c.id&&!b.ownershipBasedAccessControlForFeatures&&(b=c.getEditCapabilities(),!b.canCreate||b.canUpdate))return;this._currentLInfo=a;this._createTable()},_updateSelection:function(b,c){this._selection=b||[];a.forEach(this._layerInfos,this._getSelection,this);var d=this._selection.length;this._numFeatures=this._selection.length;this._showFeature(d?this._selection[this._featureIdx]:null,c)},_getSelection:function(a){a=a.featureLayer.getSelectedFeatures();this._selection=
this._selection.concat(a)},_updateUI:function(){var a=this._numFeatures,b=this._currentLInfo;this.layerName.innerHTML=b&&0!==a?b.featureLayer?b.featureLayer.name:"":this.NLS_noFeaturesSelected;m.set(this.attributeTable,"display",a?"":"none");m.set(this.editButtons,"display",a?"":"none");m.set(this.navButtons,"display",!this._hideNavButtons&&1<a?"":"none");this.navMessage.innerHTML=c.substitute({idx:this._featureIdx+1,of:this.NLS_of,numFeatures:this._numFeatures},this._navMessage);this._attachmentEditor&&
m.set(this._attachmentEditor.domNode,"display",b&&b.showAttachments&&a?"":"none");m.set(this.deleteBtn.domNode,"display",b&&!1===b.showDeleteButton||!this._canDelete?"none":"");this.domNode.parentNode&&0<this.domNode.parentNode.scrollTop&&(this.domNode.parentNode.scrollTop=0)},_onNextFeature:function(a){this._featureIdx+=a;0>this._featureIdx?this._featureIdx=this._numFeatures-1:this._featureIdx>=this._numFeatures&&(this._featureIdx=0);a=this._selection.length?this._selection[this._featureIdx]:null;
this._showFeature(a);this._updateUI();this.onNext(a)},_deleteFeature:function(){this.onDelete(this._currentFeature)},_showFeature:function(b,d){if(b){this._currentFeature=b;var e=d?d:b.getLayer(),f=e.getEditCapabilities({feature:b,userId:this._userIds[e.id]});this._canUpdate=f.canUpdate;this._canDelete=f.canDelete;if(f=this._getLInfoFromFeatureLayer(e)){this._setCurrentLInfo(f);var g=b.attributes,k=this._findFirst(f.types,"id",g[f.typeIdField]),h=null;a.forEach(f.fieldInfos,function(b){h=b.field;
var d=[];b.dijit&&1<b.dijit.length?a.forEach(b.dijit,function(a){d.push(a)}):d.push(b.dijit);a.forEach(d,l.hitch(this,function(a){if(a){var b=this._setFieldDomain(a,k,h),d=g[h.name],d=d&&b&&b.codedValues&&b.codedValues.length&&b.codedValues[d]?b.codedValues[d].name:d;c.isDefined(d)||(d="");"dijit.form.DateTextBox"===a.declaredClass||"dijit.form.TimeTextBox"===a.declaredClass?d=""===d?null:new Date(d):"dijit.form.FilteringSelect"===a.declaredClass&&(a._lastValueReported=null,d=g[h.name]+"");try{this._setValue(a,
d),"dijit.form.FilteringSelect"===a.declaredClass&&!1===a.isValid()&&this._setValue(a,null)}catch(e){a.set("displayedValue",this.NLS_errorInvalid,!1)}}}))},this);this._attachmentEditor&&f.showAttachments&&this._attachmentEditor.showAttachments(this._currentFeature,e);(e=e.getEditSummary(b))?(this.editorTrackingInfoDiv.innerHTML=e,n.show(this.editorTrackingInfoDiv)):n.hide(this.editorTrackingInfoDiv)}}},_setFieldDomain:function(b,d,e){if(!b)return null;var f=e.domain;return d&&d.domains&&d.domains[e.name]&&
0==d.domains[e.name]instanceof q&&(f=d.domains[e.name]),f?(f.codedValues&&0<f.codedValues.length?(b.set("store",this._toStore(a.map(f.codedValues,function(a){return{id:a.code+="",name:a.name}}))),this._setValue(b,f.codedValues[0].code)):(b.constraints={min:c.isDefined(f.minValue)?f.minValue:Number.MIN_VALUE,max:c.isDefined(f.maxValue)?f.maxValue:Number.MAX_VALUE},this._setValue(b,b.constraints.min)),f):null},_setValue:function(a,b){a.set&&(a._onChangeActive=!1,a.set("value",b,!0),a._onChangeActive=
!0)},_getFields:function(b){var d=b._getOutFields();if(!d)return null;b=b.fields;return"*"==d?b:a.filter(a.map(d,l.hitch(this,"_findFirst",b,"name")),c.isDefined)},_isInFields:function(b,c){return b&&(c||c.length)?a.some(c,function(a){return a.toLowerCase()===b.toLowerCase()}):!1},_findFirst:function(b,c,d){return(b=a.filter(b,function(a){return a.hasOwnProperty(c)&&a[c]===d}))&&b.length?b[0]:null},_getLInfoFromFeatureLayer:function(a){return this._findFirst(this._layerInfos,"layerId",a?a.id:null)},
_createTable:function(){this._destroyAttributeTable();this.attributeTable.innerHTML="";this._attributes=g.create("table",{cellspacing:"0",cellpadding:"0"},this.attributeTable);var b=g.create("tbody",null,this._attributes),c=this._currentLInfo,d=this._findFirst(c.types,"id",this._currentFeature.attributes[c.typeIdField]);a.forEach(c.fieldInfos,l.hitch(this,"_createField",d,b),this);this._createOnlyFirstTime=!1},_createField:function(a,b,c){var d,e=this._currentLInfo,f=c.field,k=!1,h=null;if(!this._isInFields(f.name,
e.hideFields)&&!this._isInFields(f.name,this._editorTrackingInfos[e.featureLayer.id])){b=g.create("tr",null,b);g.create("td",{innerHTML:c.label||f.alias||f.name,"class":"atiLabel"},b).setAttribute("data-fieldname",f.name);b=g.create("td",null,b);if(c.customField?(g.place(c.customField.domNode||c.customField,g.create("div",null,b),"first"),d=c.customField):(!1===e.isEditable||!1===f.editable||!1===c.isEditable||"esriFieldTypeOID"===f.type||"esriFieldTypeGlobalID"===f.type||!this._canUpdate&&!this._createOnlyFirstTime)&&
(k=!0),!d&&e.typeIdField&&f.name.toLowerCase()==e.typeIdField.toLowerCase()?d=this._createTypeField(f,c,b):d||(d=this._createDomainField(f,c,a,b)),!d)switch(f.type){case "esriFieldTypeString":d=this._createStringField(f,c,b);break;case "esriFieldTypeDate":d=this._createDateField(f,c,b);c.format&&c.format.time&&(h=this._createTimeField(f,c,b));break;case "esriFieldTypeInteger":case "esriFieldTypeSmallInteger":d=this._createIntField(f,c,b);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":d=
this._createFltField(f,c,b);break;default:d=this._createStringField(f,c,b)}c.tooltip&&c.tooltip.length&&this._toolTips.push(new Q({connectId:[d.id],label:c.tooltip}));d.onChange=l.hitch(this,"onFieldValueChange",c);d.set("disabled",k);h?(c.dijit=[d,h],h.onChange=l.hitch(this,"onFieldValueChange",c),h.set("disabled",k)):c.dijit=d}},_createTypeField:function(b,c,d){return(c=b.domain)&&"range"===c.type&&c.minValue===c.maxValue?new H({"class":"atiField"},g.create("div",null,d)):new K({"class":"atiField",
name:b.alias||b.name,required:!b.nullable||!1,store:this._toStore(a.map(this._currentLInfo.types,function(a){return{id:a.id,name:a.name}})),searchAttr:"name"},g.create("div",null,d))},_createDomainField:function(a,b,c,d){b=a.domain;return c&&c.domains&&c.domains[a.name]&&0==c.domains[a.name]instanceof q&&(b=c.domains[a.name]),b?b.codedValues?new K({"class":"atiField",name:a.alias||a.name,searchAttr:"name",required:!a.nullable||!1},g.create("div",null,d)):new J({"class":"atiField"},g.create("div",
null,d)):null},_createStringField:function(a,b,c){var d={"class":"atiField",trim:!0,maxLength:a.length};return b.stringFieldOption===W.STRING_FIELD_OPTION_TEXTAREA?(d["class"]+=" atiTextAreaField",new L(d,g.create("div",null,c))):b.stringFieldOption===W.STRING_FIELD_OPTION_RICHTEXT?(d["class"]+=" atiRichTextField",d.height="100%",d.width="100%",d.plugins=b.richTextPlugins||"bold italic underline foreColor hiliteColor | justifyLeft justifyCenter justifyRight justifyFull | insertOrderedList insertUnorderedList indent outdent | createLink".split(" "),
a=new y(d,g.create("div",null,c)),a.startup(),a):a.nullable&&b.field&&b.field.nullable?new H(d,g.create("div",null,c)):new M({required:!0},g.create("div",null,c))},_createTimeField:function(a,b,c){a={"class":"atiField",trim:!0,constraints:{formatLength:"medium"}};return this._datePackage&&(a.datePackage=this._datePackage),new N(a,g.create("div",null,c))},_createDateField:function(a,b,c){a={"class":"atiField",trim:!0};return this._datePackage&&(a.datePackage=this._datePackage),new F(a,g.create("div",
null,c))},_createIntField:function(a,b,c){return new G({"class":"atiField",constraints:"esriFieldTypeSmallInteger"===a.type?{min:-32768,max:32767,places:0}:{places:0},invalidMessage:this.NLS_validationInt,trim:!0},g.create("div",null,c))},_createFltField:function(a,b,c){var d=/\de[-+]?\d/i,e=/[0-9]\d{0,2}(\.\d{3})*(,\d+)?$/i;return new M({validator:function(a,b){return this._maskValidSubsetError=!1,this._hasBeenBlurred=!0,""===a||null===a?!0:d.test(a)?!0:e.test(a)&&("min"in b?0<=this.compare(a,b.min):
1)&&("max"in b?0>=this.compare(a,b.max):1)?!0:!1},"class":"atiField",trim:!0,constraints:{places:"0,40",min:-(1/0),max:1/0,exponent:!0},invalidMessage:this.NLS_validationFlt},g.create("div",null,c))},_toStore:function(a){return new O({data:{identifier:"id",label:"name",items:a}})},_connect:function(a,b,c){this._aiConnects.push(d.connect(a,b,c))},_getDatePackage:function(a){return null===a.datePackage?null:a.datePackage?a.datePackage:"ar"===f.locale?"dojox.date.islamic":null},_destroyAttributeTable:function(){a.forEach(this._layerInfos,
function(b){a.forEach(b.fieldInfos,function(b){var c=b.dijit;if(c){if(c._onChangeHandle=null,b.customField)return;c instanceof Array?a.forEach(c,l.hitch(this,function(a){a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy();a._onChangeHandle=null})):c.destroyRecursive?c.destroyRecursive():c.destroy&&c.destroy()}b.dijit=null},this)},this);a.forEach(this._toolTips,function(a){a.destroy()});this._toolTips=[];this._attributes&&g.destroy(this._attributes)}});return l.mixin(W,{STRING_FIELD_OPTION_RICHTEXT:"richtext",
STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_TEXTBOX:"textbox"}),k("extend-esri")&&l.setObject("dijit.AttributeInspector",W,e),W})},"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D){function E(a){return new y({command:a.name})}function F(a){return new y({buttonClass:x,command:a.name})}a=a("dijit.Editor",C,{plugins:null,extraPlugins:null,constructor:function(){c.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",z]);this._plugins=
[];this._editInterval=1E3*this.editActionInterval;if(n("ie")||n("trident")||n("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new d;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);c.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=b.getLocalization("dijit._editor",
"commands",this.lang);n("webkit")&&g.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new v({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));l.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);k.add(this.iframe.parentNode,"dijitEditorIFrameContainer");k.add(this.iframe,"dijitEditorIFrame");f.set(this.iframe,"allowTransparency",
!0);this.toolbar.startup();this.onNormalizedDisplayChanged()},destroy:function(){l.forEach(this._plugins,function(a){a&&a.destroy&&a.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(a,b){var d=c.isString(a)?{name:a}:c.isFunction(a)?{ctor:a}:a;if(!d.setEditor){var e={args:d,plugin:null,editor:this};d.name&&(y.registry[d.name]?e.plugin=y.registry[d.name](d):r.publish(D._scopeName+".Editor.getPlugin",e));if(!e.plugin)try{var f=
d.ctor||c.getObject(d.name)||h(d.name);f&&(e.plugin=new f(d))}catch(g){throw Error(this.id+": cannot find plugin ["+d.name+"]");}if(!e.plugin)throw Error(this.id+": cannot find plugin ["+d.name+"]");a=e.plugin}1<arguments.length?this._plugins[b]=a:this._plugins.push(a);a.setEditor(this);c.isFunction(a.setToolbar)&&a.setToolbar(this.toolbar)},resize:function(a){a&&w.prototype.resize.apply(this,arguments)},layout:function(){var a=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+m.getPadBorderExtents(this.iframe.parentNode).h+
m.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=a+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(a){var b,c=this.document.body,d=c.clientWidth,e=c.clientHeight,f=c.clientLeft,g=c.offsetWidth,k=c.offsetHeight,h=c.offsetLeft;/^rtl$/i.test(c.dir||"")?d<g&&a.x>d&&a.x<g&&(b=!0):a.x<f&&a.x>h&&(b=!0);b||e<k&&a.y>e&&a.y<k&&(b=!0);b||(delete this._cursorToStart,delete this._savedSelection,"BODY"==a.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(a){this.customUndo&&this.endEditing(!0);"BODY"!=a.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(a){this._inEditing||(this._inEditing=!0,this._beginEditing(a));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(a){if(!this.customUndo||
"undo"!=a&&"redo"!=a){this.customUndo&&(this.endEditing(),this._beginEditing());var b=this.inherited(arguments);this.customUndo&&this._endEditing();return b}return this[a]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(a){var b;try{if(b=this.document.execCommand(a,!1,null),n("webkit")&&!b)throw{};}catch(c){b=q.substitute,alert(b(this.commands.systemShortcut,
[this.commands[a],b(this.commands[n("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[a]])])),b=!1}return b},queryCommandEnabled:function(a){return!this.customUndo||"undo"!=a&&"redo"!=a?this.inherited(arguments):"undo"==a?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(a){var b=a.mark,d=a.mark;a=a.isCollapsed;var e,f,g;d&&(9>n("ie")||9===n("ie")&&n("quirks")?c.isArray(d)?(b=[],l.forEach(d,function(a){b.push(B.getNode(a,this.editNode))},this),this.selection.moveToBookmark({mark:b,
isCollapsed:a})):d.startContainer&&d.endContainer&&(g=B.getSelection(this.window))&&g.removeAllRanges&&(g.removeAllRanges(),a=B.create(this.window),e=B.getNode(d.startContainer,this.editNode),f=B.getNode(d.endContainer,this.editNode),e&&f&&(a.setStart(e,d.startOffset),a.setEnd(f,d.endOffset),g.addRange(a))):(g=B.getSelection(this.window))&&g.removeAllRanges&&(g.removeAllRanges(),a=B.create(this.window),e=B.getNode(d.startContainer,this.editNode),f=B.getNode(d.endContainer,this.editNode),e&&f&&(a.setStart(e,
d.startOffset),a.setEnd(f,d.endOffset),g.addRange(a))))},_changeToStep:function(a,b){this.setValue(b.text);var c=b.bookmark;c&&this._moveToBookmark(c)},undo:function(){var a=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._steps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(b,this._steps[this._steps.length-1]),this._undoedSteps.push(b),this.onDisplayChanged(),delete this._undoRedoActive,a=!0);delete this._undoRedoActive}return a},redo:function(){var a=
!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._undoedSteps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],b),this._steps.push(b),this.onDisplayChanged(),a=!0);delete this._undoRedoActive}return a},endEditing:function(a){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(a),this._inEditing=!1)},_getBookmark:function(){var a=this.selection.getBookmark(),b=[];if(a&&a.mark){var d=
a.mark;if(9>n("ie")||9===n("ie")&&n("quirks")){var e=B.getSelection(this.window);if(c.isArray(d))l.forEach(a.mark,function(a){b.push(B.getIndex(a,this.editNode).o)},this),a.mark=b;else if(e){var f;e.rangeCount&&(f=e.getRangeAt(0));a.mark=f?f.cloneRange():this.selection.getBookmark()}}try{a.mark&&a.mark.startContainer&&(b=B.getIndex(a.mark.startContainer,this.editNode).o,a.mark={startContainer:b,startOffset:a.mark.startOffset,endContainer:a.mark.endContainer===a.mark.startContainer?b:B.getIndex(a.mark.endContainer,
this.editNode).o,endOffset:a.mark.endOffset})}catch(g){a.mark=null}}return a},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:A.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var a=A.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:a,bookmark:this._getBookmark()})},onKeyDown:function(a){n("ie")||this.iframe||a.keyCode!=e.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var b=a.keyCode;if(a.ctrlKey&&
!a.shiftKey&&!a.altKey){if(90==b||122==b){a.stopPropagation();a.preventDefault();this.undo();return}if(89==b||121==b){a.stopPropagation();a.preventDefault();this.redo();return}}this.inherited(arguments);switch(b){case e.ENTER:case e.BACKSPACE:case e.DELETE:this.beginEditing();break;case 88:case 86:if(a.ctrlKey&&!a.altKey&&!a.metaKey){this.endEditing();88==a.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!a.ctrlKey&&!a.altKey&&!a.metaKey&&(a.keyCode<
e.F1||a.keyCode>e.F15)){this.beginEditing();break}case e.ALT:this.endEditing();break;case e.UP_ARROW:case e.DOWN_ARROW:case e.LEFT_ARROW:case e.RIGHT_ARROW:case e.HOME:case e.END:case e.PAGE_UP:case e.PAGE_DOWN:this.endEditing(!0);case e.CTRL:case e.SHIFT:case e.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(a){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(a){this.customUndo?this.isClosed?this.setValue(a):(this.beginEditing(),a||(a="\x26#160;"),this.setValue(a),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(a){this.setValueDeferred.then(c.hitch(this,function(){!this.disabled&&a||!this._buttonEnabledPlugins&&a?
l.forEach(this._plugins,function(a){a.set("disabled",!0)}):this.disabled&&!a&&l.forEach(this._plugins,function(a){a.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&g.set(this.document.body,"color",g.get(this.iframe,"color"))}catch(a){}}});c.mixin(y.registry,{undo:E,redo:E,cut:E,copy:E,paste:E,insertOrderedList:E,insertUnorderedList:E,indent:E,outdent:E,justifyCenter:E,justifyFull:E,justifyLeft:E,justifyRight:E,
"delete":E,selectAll:E,removeFormat:E,unlink:E,insertHorizontalRule:E,bold:F,italic:F,underline:F,strikethrough:F,subscript:F,superscript:F,"|":function(){return new y({setEditor:function(a){this.editor=a;this.button=new t({ownerDocument:a.ownerDocument})}})}});return a})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(h,l,a,d,b,f,k,m){a("dijit-legacy-requires")&&b(0,function(){h(["dijit/ToolbarSeparator"])});
return l("dijit.Toolbar",[f,m,k],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(h,l,a,d){return h("dijit.ToolbarSeparator",[a,d],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',
buildRendering:function(){this.inherited(arguments);l.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/form/ToggleButton":function(){define(["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(h,l,a,d){return h("dijit.form.ToggleButton",[a,d],{baseClass:"dijitToggleButton",setChecked:function(a){l.deprecated("setChecked("+a+") is deprecated. Use set('checked',"+a+") instead.","","2.0");this.set("checked",a)}})})},"dijit/form/_ToggleButtonMixin":function(){define(["dojo/_base/declare",
"dojo/dom-attr"],function(h,l){return h("dijit.form._ToggleButtonMixin",null,{checked:!1,_aria_attr:"aria-pressed",_onClick:function(a){var d=this.checked;this._set("checked",!d);var b=this.inherited(arguments);this.set("checked",b?this.checked:d);return b},_setCheckedAttr:function(a,d){this._set("checked",a);var b=this.focusNode||this.domNode;this._created&&l.get(b,"checked")!=!!a&&l.set(b,"checked",!!a);b.setAttribute(this._aria_attr,String(a));this._handleOnChange(a,d)},postCreate:function(){this.inherited(arguments);
var a=this.focusNode||this.domNode;this.checked&&a.setAttribute("checked","checked");void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.checked)},reset:function(){this._hasBeenBlurred=!1;this.set("checked",this.params.checked||!1)}})})},"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(h,l,a,d,b){l=l("dijit._editor._Plugin",d,{constructor:function(b){this.params=b||{};a.mixin(this,
this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:b,disabled:!1,getLabel:function(a){return this.editor.commands[a]},_initButton:function(){if(this.command.length){var b=this.getLabel(this.command),d=this.editor,h=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(b=a.mixin({label:b,ownerDocument:d.ownerDocument,dir:d.dir,lang:d.lang,showLabel:!1,
iconClass:h,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete b.name,this.button=new this.buttonClass(b))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();this.inherited(arguments)},connect:function(a,b,d){this.own(h.connect(a,b,this,d))},updateState:function(){var a=this.editor,b=this.command,d,g;if(a&&a.isLoaded&&b.length){var e=this.get("disabled");if(this.button)try{g=!e&&a.queryCommandEnabled(b),
this.enabled!==g&&(this.enabled=g,this.button.set("disabled",!g)),g&&"boolean"==typeof this.button.checked&&(d=a.queryCommandState(b),this.checked!==d&&(this.checked=d,this.button.set("checked",a.queryCommandState(b))))}catch(c){}}},setEditor:function(b){this.editor=b;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",a.hitch(this.editor,"execCommand",this.command,this.commandArg))):this.button.domNode.style.display=
"none");this.own(this.editor.on("NormalizedDisplayChanged",a.hitch(this,"updateState")))},setToolbar:function(a){this.button&&a.addChild(this.button)},set:function(a,b){if("object"===typeof a){for(var d in a)this.set(d,a[d]);return this}d=this._getAttrNames(a);if(this[d.s])var g=this[d.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(a,b);return g||this},get:function(a){var b=this._getAttrNames(a);return this[b.g]?this[b.g]():this[a]},_setDisabledAttr:function(a){this._set("disabled",
a);this.updateState()},_getAttrNames:function(a){var b=this._attrPairNames;if(b[a])return b[a];var d=a.charAt(0).toUpperCase()+a.substr(1);return b[a]={s:"_set"+d+"Attr",g:"_get"+d+"Attr"}},_set:function(a,b){this[a]=b}});l.registry={};return l})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),function(h,l,a,d,b,f,k,m,g,e,c){return h("dijit._editor.plugins.EnterKeyHandling",
g,{blockNodeForEnter:"BR",constructor:function(a){a&&("blockNodeForEnter"in a&&(a.blockNodeForEnter=a.blockNodeForEnter.toUpperCase()),d.mixin(this,a))},setEditor:function(c){if(this.editor!==c)if(this.editor=c,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,c.onLoadDeferred.then(d.hitch(this,function(e){this.own(b(c.document,"keydown",d.hitch(this,function(b){if(b.keyCode==a.ENTER){var c=d.mixin({},b);c.shiftKey=!0;this.handleEnterKey(c)||(b.stopPropagation(),b.preventDefault())}})));9<=f("ie")&&
10>=f("ie")&&this.own(b(c.document,"paste",d.hitch(this,function(a){setTimeout(d.hitch(this,function(){var a=this.editor.document.selection.createRange();a.move("character",-1);a.select();a.move("character",1);a.select()}),0)})));return e}));else if(this.blockNodeForEnter){var e=d.hitch(this,"handleEnterKey");c.addKeyHandler(13,0,0,e);c.addKeyHandler(13,0,1,e);this.own(this.editor.on("KeyPressed",d.hitch(this,"onKeyPressed")))}},onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var a=
this.editor.selection.getAncestorElement("LI");if(a){f("mozilla")&&"LI"==a.parentNode.parentNode.nodeName&&(a=a.parentNode.parentNode);var b=a.firstChild;!b||1!=b.nodeType||"UL"!=b.nodeName&&"OL"!=b.nodeName||(a.insertBefore(b.ownerDocument.createTextNode("\u00a0"),b),b=c.create(this.editor.window),b.setStart(a.firstChild,0),a=c.getSelection(this.editor.window,!0),a.removeAllRanges(),a.addRange(b))}else e.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter),(a=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?
(a.innerHTML=this.bogusHtmlContent,9>=f("ie")&&(a=this.editor.document.selection.createRange(),a.move("character",-1),a.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(a){var b,d,g,k,h=this.editor.document,
w,x,y;if(a.shiftKey){a=this.editor.selection.getParentElement();if(k=c.getAncestor(a,this.blockNodes)){if("LI"==k.tagName)return!0;a=c.getSelection(this.editor.window);b=a.getRangeAt(0);b.collapsed||(b.deleteContents(),a=c.getSelection(this.editor.window),b=a.getRangeAt(0));if(c.atBeginningOfContainer(k,b.startContainer,b.startOffset))w=h.createElement("br"),b=c.create(this.editor.window),k.insertBefore(w,k.firstChild),b.setStartAfter(w),a.removeAllRanges(),a.addRange(b);else if(c.atEndOfContainer(k,
b.startContainer,b.startOffset))b=c.create(this.editor.window),w=h.createElement("br"),k.appendChild(w),k.appendChild(h.createTextNode("\u00a0")),b.setStart(k.lastChild,0),a.removeAllRanges(),a.addRange(b);else return(x=b.startContainer)&&3==x.nodeType?(y=x.nodeValue,d=h.createTextNode(y.substring(0,b.startOffset)),g=h.createTextNode(y.substring(b.startOffset)),k=h.createElement("br"),""==g.nodeValue&&f("webkit")&&(g=h.createTextNode("\u00a0")),l.place(d,x,"after"),l.place(k,d,"after"),l.place(g,
k,"after"),l.destroy(x),b=c.create(this.editor.window),b.setStart(g,0),a.removeAllRanges(),a.addRange(b),!1):!0}else a=c.getSelection(this.editor.window),a.rangeCount?(b=a.getRangeAt(0))&&b.startContainer&&(b.collapsed||(b.deleteContents(),a=c.getSelection(this.editor.window),b=a.getRangeAt(0)),(x=b.startContainer)&&3==x.nodeType?(k=b.startOffset,x.length<k&&(g=this._adjustNodeAndOffset(x,k),x=g.node,k=g.offset),y=x.nodeValue,d=h.createTextNode(y.substring(0,k)),g=h.createTextNode(y.substring(k)),
k=h.createElement("br"),g.length||(g=h.createTextNode("\u00a0")),d.length?l.place(d,x,"after"):d=x,l.place(k,d,"after"),l.place(g,k,"after"),l.destroy(x)):(0<=b.startOffset&&(w=x.childNodes[b.startOffset]),k=h.createElement("br"),g=h.createTextNode("\u00a0"),w?(l.place(k,w,"before"),l.place(g,k,"after")):(x.appendChild(k),x.appendChild(g))),b=c.create(this.editor.window),b.setStart(g,0),b.setEnd(g,g.length),a.removeAllRanges(),a.addRange(b),this.editor.selection.collapse(!0)):e.prototype.execCommand.call(this.editor,
"inserthtml","\x3cbr\x3e");return!1}var z=!0;a=c.getSelection(this.editor.window);b=a.getRangeAt(0);b.collapsed||(b.deleteContents(),a=c.getSelection(this.editor.window),b=a.getRangeAt(0));w=c.getBlockAncestor(b.endContainer,null,this.editor.editNode);var A=w.blockNode;if(this._checkListLater=A&&("LI"==A.nodeName||"LI"==A.parentNode.nodeName))return f("mozilla")&&(this._pressedEnterInBlock=A),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(A.innerHTML)&&
(A.innerHTML="",f("webkit")&&(b=c.create(this.editor.window),b.setStart(A,0),a.removeAllRanges(),a.addRange(b)),this._checkListLater=!1),!0;if(!w.blockNode||w.blockNode===this.editor.editNode){try{e.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(B){}w={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),blockContainer:this.editor.editNode};if(w.blockNode){if(w.blockNode!=this.editor.editNode&&!(w.blockNode.textContent||w.blockNode.innerHTML).replace(/^\s+|\s+$/g,
"").length)return this.removeTrailingBr(w.blockNode),!1}else w.blockNode=this.editor.editNode;a=c.getSelection(this.editor.window);b=a.getRangeAt(0)}A=h.createElement(this.blockNodeForEnter);A.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(w.blockNode);g=b.endOffset;z=b.endContainer;z.length<g&&(g=this._adjustNodeAndOffset(z,g),z=g.node,g=g.offset);if(c.atEndOfContainer(w.blockNode,z,g))w.blockNode===w.blockContainer?w.blockNode.appendChild(A):l.place(A,w.blockNode,"after"),z=!1,b=c.create(this.editor.window),
b.setStart(A,0),a.removeAllRanges(),a.addRange(b),this.editor.height&&m.scrollIntoView(A);else if(c.atBeginningOfContainer(w.blockNode,b.startContainer,b.startOffset))l.place(A,w.blockNode,w.blockNode===w.blockContainer?"first":"before"),A.nextSibling&&this.editor.height&&(b=c.create(this.editor.window),b.setStart(A.nextSibling,0),a.removeAllRanges(),a.addRange(b),m.scrollIntoView(A.nextSibling)),z=!1;else{w.blockNode===w.blockContainer?w.blockNode.appendChild(A):l.place(A,w.blockNode,"after");z=
!1;w.blockNode.style&&A.style&&w.blockNode.style.cssText&&(A.style.cssText=w.blockNode.style.cssText);if((x=b.startContainer)&&3==x.nodeType){g=b.endOffset;x.length<g&&(g=this._adjustNodeAndOffset(x,g),x=g.node,g=g.offset);y=x.nodeValue;d=h.createTextNode(y.substring(0,g));g=h.createTextNode(y.substring(g,y.length));l.place(d,x,"before");l.place(g,x,"after");l.destroy(x);for(d=d.parentNode;d!==w.blockNode;){y=h.createElement(d.tagName);d.style&&y.style&&d.style.cssText&&(y.style.cssText=d.style.cssText);
"FONT"===d.tagName&&(d.color&&(y.color=d.color),d.face&&(y.face=d.face),d.size&&(y.size=d.size));for(b=g;b;)x=b.nextSibling,y.appendChild(b),b=x;l.place(y,d,"after");g=y;d=d.parentNode}b=g;if(1==b.nodeType||3==b.nodeType&&b.nodeValue)A.innerHTML="";for(d=b;b;)x=b.nextSibling,A.appendChild(b),b=x}b=c.create(this.editor.window);h=d;if("BR"!==this.blockNodeForEnter){for(;h;)k=h,h=x=h.firstChild;k&&k.parentNode?(A=k.parentNode,b.setStart(A,0),a.removeAllRanges(),a.addRange(b),this.editor.height&&m.scrollIntoView(A),
f("mozilla")&&(this._pressedEnterInBlock=w.blockNode)):z=!0}else b.setStart(A,0),a.removeAllRanges(),a.addRange(b),this.editor.height&&m.scrollIntoView(A),f("mozilla")&&(this._pressedEnterInBlock=w.blockNode)}return z},_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3==a.nextSibling.nodeType;)b-=a.length,a=a.nextSibling;return{node:a,offset:b}},removeTrailingBr:function(a){if(a=/P|DIV|LI/i.test(a.tagName)?a:this.editor.selection.getParentOfType(a,["P","DIV","LI"]))a.lastChild&&
(1<a.childNodes.length&&3==a.lastChild.nodeType&&/^[\s\xAD]*$/.test(a.lastChild.nodeValue)||"BR"==a.lastChild.tagName)&&l.destroy(a.lastChild),a.childNodes.length||(a.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G){var K=a("dijit._editor.RichText",[B,C],{constructor:function(a){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};a&&q.isString(a.value)&&(this.value=a.value);this.onLoadDeferred=new d},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[q.trim,q.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);t("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));t("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(t("ie")||t("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[q.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[q.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);x.publish(G._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var a=q.hitch(this,function(a,b){return function(){return!this.execCommand(a,b)}}),b={b:a("bold"),i:a("italic"),u:a("underline"),a:a("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:a("formatblock",
"h1"),2:a("formatblock","h2"),3:a("formatblock","h3"),4:a("formatblock","h4"),"\\":a("insertunorderedlist")};t("ie")||(b.Z=a("redo"));for(var c in b)this.addKeyHandler(c,!0,!1,b[c])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(K._editorCommandsLocalized)this._local2NativeFormatNames=K._local2NativeFormatNames,this._native2LocalFormatNames=K._native2LocalFormatNames;else{K._editorCommandsLocalized=!0;K._local2NativeFormatNames={};
K._native2LocalFormatNames={};this._local2NativeFormatNames=K._local2NativeFormatNames;this._native2LocalFormatNames=K._native2LocalFormatNames;for(var a="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),b="",c,d=0;c=a[d++];)b="l"!==c.charAt(1)?b+("\x3c"+c+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+c+"\x3e\x3cbr/\x3e"):b+("\x3c"+c+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+c+"\x3e\x3cbr/\x3e");var e=m.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:b});this.ownerDocumentBody.appendChild(e);
a=q.hitch(this,function(){for(var a=e.firstChild;a;)try{this.selection.selectElement(a.firstChild);var b=a.tagName.toLowerCase();this._local2NativeFormatNames[b]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[b]]=b;a=a.nextSibling.nextSibling}catch(c){}m.destroy(e)});this.defer(a)}},open:function(a){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new d;this.isClosed||this.close();x.publish(G._scopeName+"._editor.RichText::open",
this);1===arguments.length&&a.nodeName&&(this.domNode=a);var c=this.domNode,g;if(q.isString(this.value))g=this.value,c.innerHTML="";else if(c.nodeName&&"textarea"==c.nodeName.toLowerCase()){var h=this.textarea=c;this.name=h.name;g=h.value;c=this.domNode=this.ownerDocument.createElement("div");c.setAttribute("widgetId",this.id);h.removeAttribute("widgetId");c.cssText=h.cssText;c.className+=" "+h.className;m.place(c,h,"before");var n=q.hitch(this,function(){e.set(h,{display:"block",position:"absolute",
top:"-1000px"});if(t("ie")){var a=h.style;this.__overflow=a.overflow;a.overflow="hidden"}});t("ie")?this.defer(n,10):n();if(h.form){var u=h.value;this.reset=function(){this.getValue()!==u&&this.replaceValue(u)};r(h.form,"submit",q.hitch(this,function(){f.set(h,"disabled",this.disabled);h.value=this.getValue()}))}}else g=F.getChildrenHtml(c),c.innerHTML="";this.value=g;c.nodeName&&"LI"===c.nodeName&&(c.innerHTML=" \x3cbr\x3e");this.header=c.ownerDocument.createElement("div");c.appendChild(this.header);
this.editingArea=c.ownerDocument.createElement("div");c.appendChild(this.editingArea);this.footer=c.ownerDocument.createElement("div");c.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!l.useXDomain||l.allowXdRichTextSave)){if((g=b.byId(G._scopeName+"._editor.RichText.value"))&&""!==g.value)for(var n=g.value.split(this._SEPARATOR),v=0,w;w=n[v++];)if(w=w.split(this._NAME_CONTENT_SEP),w[0]===this.name){this.value=w[1];n=n.splice(v,1);g.value=n.join(this._SEPARATOR);
break}K._globalSaveHandler||(K._globalSaveHandler={},y.addOnUnload(function(){for(var a in K._globalSaveHandler){var b=K._globalSaveHandler[a];q.isFunction(b)&&b()}}));K._globalSaveHandler[this.id]=q.hitch(this,"_saveContent")}this.isClosed=!1;g=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");g.id=this.id+"_iframe";g.style.border="none";g.style.width="100%";this._layoutMode?g.style.height="100%":7<=t("ie")?(this.height&&(g.style.height=this.height),this.minHeight&&(g.style.minHeight=
this.minHeight)):g.style.height=this.height?this.height:this.minHeight;g.frameBorder=0;g._loadFunc=q.hitch(this,function(a){this.window=a;this.document=a.document;this.selection=new D.SelectionManager(a);t("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});n=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");n=11>t("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+n+"');document.close()":"javascript: '"+
n+"'";this.editingArea.appendChild(g);g.src=n;"LI"===c.nodeName&&(c.lastChild.style.marginTop="-1.2em");k.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var a=e.getComputedStyle(this.domNode),d;if(this["aria-label"])d=this["aria-label"];else{var f=u('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||b.byId(this["aria-labelledby"],this.ownerDocument);f&&(d=f.textContent||f.innerHTML||"")}var f="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(d?" aria-label\x3d'"+w.escape(d)+"'":"")+"\x3e\x3c/div\x3e",g=[a.fontWeight,a.fontSize,a.fontFamily].join(" "),k=a.lineHeight,k=0<=k.indexOf("px")?parseFloat(k)/parseFloat(a.fontSize):0<=k.indexOf("em")?parseFloat(k):"normal",h="",m=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(a){a=a.replace(/^;/ig,"")+";";var b=a.split(":")[0];if(b){var b=q.trim(b),b=b.toLowerCase(),c,d="";for(c=0;c<b.length;c++){var f=b.charAt(c);switch(f){case "-":c++,f=b.charAt(c).toUpperCase();default:d+=
f}}e.set(m.domNode,d,"")}h+=a+";"});this.iframe.setAttribute("title",d);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||c.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",d?"\x3ctitle\x3e"+w.escape(d)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",g,";\n",this.height||t("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",k,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",t("ie")||t("trident")||t("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",d?" aria-label\x3d'"+w.escape(d)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+h+"'\x3e",f,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var a=[];this.styleSheets&&(a=this.styleSheets.split(";"),this.styleSheets=
"");a=a.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var b="",c=0,d,e=A.get(this.ownerDocument);d=a[c++];)d=(new z(e.location,d)).toString(),this.editingAreaStyleSheets.push(d),b+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+d+'"/\x3e';return b},addStyleSheet:function(a){var b=a.toString(),c=A.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new z(c.location,b)).toString();-1<h.indexOf(this.editingAreaStyleSheets,b)||(this.editingAreaStyleSheets.push(b),
this.onLoadDeferred.then(q.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(b);else{var a=this.document.getElementsByTagName("head")[0],c=this.document.createElement("link");c.rel="stylesheet";c.type="text/css";c.href=b;a.appendChild(c)}})))},removeStyleSheet:function(a){var b=a.toString(),c=A.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new z(c.location,b)).toString();a=h.indexOf(this.editingAreaStyleSheets,b);-1!==a&&(delete this.editingAreaStyleSheets[a],
u('link[href\x3d"'+b+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(a){a=!!a;this._set("disabled",a);if(this.isLoaded){var b=t("ie")&&(this.isLoaded||!this.focusOnLoad);b&&(this.editNode.unselectable="on");this.editNode.contentEditable=!a;this.editNode.tabIndex=a?"-1":this.tabIndex;b&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(t("mozilla")&&!a&&this._mozSettingProps){a=this._mozSettingProps;for(var c in a)if(a.hasOwnProperty(c))try{this.document.execCommand(c,
!1,a[c])}catch(d){}}this._disabledOK=!0}},onLoad:function(a){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=H.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var b=this;this.beforeIframeNode=m.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=m.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){b.editNode.focus()};this.focusNode=
this.editNode;var c=this.events.concat(this.captureEvents),d=this.iframe?this.document:this.editNode;this.own.apply(this,h.map(c,function(a){var b=a.toLowerCase().replace(/^on/,"");return r(d,b,q.hitch(this,a))},this));this.own(r(d,"mouseup",q.hitch(this,"onClick")));t("ie")&&(this.own(r(this.document,"mousedown",q.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);t("webkit")&&(this._webkitListener=this.own(r(this.document,"mouseup",q.hitch(this,"onDisplayChanged")))[0],this.own(r(this.document,
"mousedown",q.hitch(this,function(a){a=a.target;!a||a!==this.document.body&&a!==this.document||this.defer("placeCursorAtEnd")}))));if(t("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(e){}this.isLoaded=!0;this.set("disabled",this.disabled);c=q.hitch(this,function(){this.setValue(a);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&v(q.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(c):c()},onKeyDown:function(a){if(a.keyCode===n.SHIFT||a.keyCode===n.ALT||a.keyCode===n.META||a.keyCode===n.CTRL)return!0;a.keyCode===n.TAB&&this.isTabIndent&&(a.stopPropagation(),a.preventDefault(),this.queryCommandEnabled(a.shiftKey?"outdent":"indent")&&this.execCommand(a.shiftKey?"outdent":"indent"));if(a.keyCode==n.TAB&&!this.isTabIndent&&!a.ctrlKey&&!a.altKey)return a.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>t("ie")&&a.keyCode===n.BACKSPACE&&"Control"===this.document.selection.type&&(a.stopPropagation(),a.preventDefault(),this.execCommand("delete"));t("ff")&&(a.keyCode===n.PAGE_UP||a.keyCode===n.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&a.preventDefault();var b=this._keyHandlers[a.keyCode],c=arguments;b&&!a.altKey&&h.some(b,function(b){if(!(b.shift^a.shiftKey||b.ctrl^(a.ctrlKey||a.metaKey)))return b.handler.apply(this,c)||a.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(a){c.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",a)},_setValueAttr:function(a){this.setValue(a)},_setDisableSpellCheckAttr:function(a){this.document?f.set(this.document.body,"spellcheck",!a):this.onLoadDeferred.then(q.hitch(this,function(){f.set(this.document.body,"spellcheck",!a)}));this._set("disableSpellCheck",a)},addKeyHandler:function(a,b,c,d){"string"==
typeof a&&(a=a.toUpperCase().charCodeAt(0));q.isArray(this._keyHandlers[a])||(this._keyHandlers[a]=[]);this._keyHandlers[a].push({shift:c||!1,ctrl:b||!1,handler:d})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(a){this.onDisplayChanged(a)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(a){(t("ie")||t("trident"))&&this.defer(function(){H.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var b=this.getValue(!0);if(b!==this.value)this.onChange(b);
this._set("value",b)},_onFocus:function(a){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!t("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>t("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(a,b){var c=a.toLowerCase();"formatblock"===c?t("safari")&&void 0===b&&(c="heading"):"hilitecolor"!==c||t("mozilla")||(c="backcolor");return c},_qcaCache:{},queryCommandAvailable:function(a){var b=this._qcaCache[a];return void 0!==
b?b:this._qcaCache[a]=this._queryCommandAvailable(a)},_queryCommandAvailable:function(a){switch(a.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return t("ie")||t("trident")||t("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!t("webkit");default:return!1}},execCommand:function(a,b){var c;this.focused&&this.focus();a=this._normalizeCommand(a,b);if(void 0!==b){if("heading"===a)throw Error("unimplemented");"formatblock"===
a&&(t("ie")||t("trident"))&&(b="\x3c"+b+"\x3e")}var d="_"+a+"Impl";if(this[d])c=this[d](b);else if((b=1<arguments.length?b:null)||"createlink"!==a)c=this.document.execCommand(a,!1,b);this.onDisplayChanged();return c},queryCommandEnabled:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);var b="_"+a+"EnabledImpl";return this[b]?this[b](a):this._browserQueryCommandEnabled(a)},queryCommandState:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);
try{return this.document.queryCommandState(a)}catch(b){return!1}},queryCommandValue:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);if(t("ie")&&"formatblock"===a)a=this._native2LocalFormatNames[this.document.queryCommandValue(a)];else if(t("mozilla")&&"hilitecolor"===a){var b;try{b=this.document.queryCommandValue("styleWithCSS")}catch(c){b=!1}this.document.execCommand("styleWithCSS",!1,!0);a=this.document.queryCommandValue(a);this.document.execCommand("styleWithCSS",
!1,b)}else a=this.document.queryCommandValue(a);return a},_sCall:function(a,b){return this.selection[a].apply(this.selection,b)},placeCursorAtStart:function(){this.focus();var a=!1;if(t("mozilla"))for(var b=this.editNode.firstChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){var a=!0,c=b.tagName?b.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(c)?this.selection.selectElement(b):
this.selection.selectElementChildren(b);break}b=b.nextSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var a=!1;if(t("mozilla"))for(var b=this.editNode.lastChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){a=!0;this.selection.selectElement(b.lastChild||b);break}b=b.previousSibling}else a=!0,this.selection.selectElementChildren(this.editNode);
a&&this.selection.collapse(!1)},getValue:function(a){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,a):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(a){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){a=this._preFilterContent(a);var b=this.isClosed?this.domNode:this.editNode;b.innerHTML=a;this._preDomFilterContent(b)}else this.textarea.value=a;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(q.hitch(this,function(){this.setValue(a)}))},replaceValue:function(a){this.isClosed?this.setValue(a):this.window&&this.window.getSelection&&!t("mozilla")?this.setValue(a):this.window&&this.window.getSelection?(a=this._preFilterContent(a),this.execCommand("selectall"),this.execCommand("inserthtml",a),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(a);this._set("value",this.getValue(!0))},_preFilterContent:function(a){var b=
a;h.forEach(this.contentPreFilters,function(a){a&&(b=a(b))});return b},_preDomFilterContent:function(a){a=a||this.editNode;h.forEach(this.contentDomPreFilters,function(b){b&&q.isFunction(b)&&b(a)},this)},_postFilterContent:function(a,b){var c;q.isString(a)?c=a:(a=a||this.editNode,this.contentDomPostFilters.length&&(b&&(a=q.clone(a)),h.forEach(this.contentDomPostFilters,function(b){a=b(a)})),c=F.getChildrenHtml(a));q.trim(c.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(c="");h.forEach(this.contentPostFilters,
function(a){c=a(c)});return c},_saveContent:function(){var a=b.byId(G._scopeName+"._editor.RichText.value");a&&(a.value&&(a.value+=this._SEPARATOR),a.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(a,b){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");b||(a=a.replace(/'/gm,"\x26#39;"));return a},getNodeHtml:function(a){c.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return F.getNodeHtml(a)},getNodeChildrenHtml:function(a){c.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return F.getChildrenHtml(a)},close:function(a){if(!this.isClosed){arguments.length||(a=!0);a&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);t("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var b=this.textarea.style;b.position="";b.left=b.top="";t("ie")&&(b.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;m.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;k.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);K._globalSaveHandler&&delete K._globalSaveHandler[this.id]},_removeMozBogus:function(a){return a.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(a){a=a.replace(/\sclass="webkit-block-placeholder"/gi,"");a=a.replace(/\sclass="apple-style-span"/gi,
"");return a=a.replace(/<meta charset=\"utf-8\" \/>/gi,"")},_normalizeFontStyle:function(a){return a.replace(/<(\/)?strong([ \>])/gi,"\x3c$1b$2").replace(/<(\/)?em([ \>])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(a){return a.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(a){if(!a)return!1;
if(t("ie")||t("trident")||t("edge"))return this.focused&&!this.disabled;var b=9>t("ie")?this.document.selection.createRange():this.document;try{return b.queryCommandEnabled(a)}catch(c){return!1}},_createlinkEnabledImpl:function(){var a=!0;return a=t("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var a=!0;return a=t("mozilla")||t("webkit")||t("ie")||t("trident")||t("edge")?
this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var a=!0;return a=t("mozilla")||t("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var a=!0;t("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("cut");return a},_copyEnabledImpl:function(){var a=!0;t("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("copy");
return a},_pasteEnabledImpl:function(){var a=!0;return t("webkit")?!0:a=this._browserQueryCommandEnabled("paste")},_inserthorizontalruleImpl:function(a){return t("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,a)},_unlinkImpl:function(a){return this.queryCommandEnabled("unlink")&&(t("mozilla")||t("webkit"))?(a=this.selection.getAncestorElement("a"),this.selection.selectElement(a),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",
!1,a)},_hilitecolorImpl:function(a){var b;this._handleTextColorOrProperties("hilitecolor",a)||(t("mozilla")?(this.document.execCommand("styleWithCSS",!1,!0),b=this.document.execCommand("hilitecolor",!1,a),this.document.execCommand("styleWithCSS",!1,!1)):b=this.document.execCommand("hilitecolor",!1,a));return b},_backcolorImpl:function(a){t("ie")&&(a=a?a:null);var b=this._handleTextColorOrProperties("backcolor",a);b||(b=this.document.execCommand("backcolor",!1,a));return b},_forecolorImpl:function(a){t("ie")&&
(a=a?a:null);var b=!1;(b=this._handleTextColorOrProperties("forecolor",a))||(b=this.document.execCommand("forecolor",!1,a));return b},_inserthtmlImpl:function(a){a=this._preFilterContent(a);var b=!0;if(9>t("ie")){var c=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var d=c.item(0);c.length;)c.remove(c.item(0));d.outerHTML=a}else c.pasteHTML(a);c.select()}else if(8>t("trident")){var e=E.getSelection(this.window);if(e&&e.rangeCount&&e.getRangeAt){c=
e.getRangeAt(0);c.deleteContents();var f=m.create("div");f.innerHTML=a;for(var g,d=this.document.createDocumentFragment();a=f.firstChild;)g=d.appendChild(a);c.insertNode(d);g&&(c=c.cloneRange(),c.setStartAfter(g),c.collapse(!1),e.removeAllRanges(),e.addRange(c))}}else t("mozilla")&&!a.length?this.selection.remove():b=this.document.execCommand("inserthtml",!1,a);return b},_boldImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("bold");b||(b=
this.document.execCommand("bold",!1,a));return b},_italicImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("italic");b||(b=this.document.execCommand("italic",!1,a));return b},_underlineImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("underline");b||(b=this.document.execCommand("underline",!1,a));return b},_strikethroughImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),
b=this._adaptIEFormatAreaAndExec("strikethrough");b||(b=this.document.execCommand("strikethrough",!1,a));return b},_superscriptImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("superscript");b||(b=this.document.execCommand("superscript",!1,a));return b},_subscriptImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("subscript");b||(b=this.document.execCommand("subscript",!1,a));return b},
_fontnameImpl:function(a){var b;if(t("ie")||t("trident"))b=this._handleTextColorOrProperties("fontname",a);b||(b=this.document.execCommand("fontname",!1,a));return b},_fontsizeImpl:function(a){var b;if(t("ie")||t("trident"))b=this._handleTextColorOrProperties("fontsize",a);b||(b=this.document.execCommand("fontsize",!1,a));return b},_insertorderedlistImpl:function(a){var b=!1;if(t("ie")||t("trident")||t("edge"))b=this._adaptIEList("insertorderedlist",a);b||(b=this.document.execCommand("insertorderedlist",
!1,a));return b},_insertunorderedlistImpl:function(a){var b=!1;if(t("ie")||t("trident")||t("edge"))b=this._adaptIEList("insertunorderedlist",a);b||(b=this.document.execCommand("insertunorderedlist",!1,a));return b},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(a){var b=0;if(a&&a.childNodes){var c;for(c=0;c<a.childNodes.length;c++)var d=g.position(a.childNodes[c]),
b=b+d.h}return b},_isNodeEmpty:function(a,b){return 1===a.nodeType?0<a.childNodes.length?this._isNodeEmpty(a.childNodes[0],b):!0:3===a.nodeType?""===a.nodeValue.substring(b):!1},_removeStartingRangeFromRange:function(a,b){if(a.nextSibling)b.setStart(a.nextSibling,0);else{for(var c=a.parentNode;c&&null==c.nextSibling;)c=c.parentNode;c&&b.setStart(c.nextSibling,0)}return b},_adaptIESelection:function(){var a=E.getSelection(this.window);if(a&&a.rangeCount&&!a.isCollapsed){for(var b=a.getRangeAt(0),c=
b.startContainer,d=b.startOffset;3===c.nodeType&&d>=c.length&&c.nextSibling;)d-=c.length,c=c.nextSibling;for(var e=null;this._isNodeEmpty(c,d)&&c!==e;)e=c,b=this._removeStartingRangeFromRange(c,b),c=b.startContainer,d=0;a.removeAllRanges();a.addRange(b)}},_adaptIEFormatAreaAndExec:function(a){var b=E.getSelection(this.window),c=this.document,d,e,f,g,k,n,l;if(a&&b&&b.isCollapsed){if(this.queryCommandValue(a)){a=this._tagNamesForCommand(a);f=b.getRangeAt(0);g=f.startContainer;3===g.nodeType&&(e=f.endOffset,
g.length<e&&(e=this._adjustNodeAndOffset(d,e),g=e.node));for(;g&&g!==this.editNode;){d=g.tagName?g.tagName.toLowerCase():"";if(-1<h.indexOf(a,d)){l=g;break}g=g.parentNode}if(l&&(d=f.startContainer,a=c.createElement(l.tagName),m.place(a,l,"after"),d&&3===d.nodeType)){e=f.endOffset;d.length<e&&(e=this._adjustNodeAndOffset(d,e),d=e.node,e=e.offset);g=d.nodeValue;f=c.createTextNode(g.substring(0,e));var r=g.substring(e,g.length);r&&(k=c.createTextNode(r));m.place(f,d,"before");k&&(n=c.createElement("span"),
n.className="ieFormatBreakerSpan",m.place(n,d,"after"),m.place(k,n,"after"),k=n);m.destroy(d);f=f.parentNode;for(d=[];f!==l;){g=f.tagName;e={tagName:g};d.push(e);g=c.createElement(g);f.style&&g.style&&f.style.cssText&&(g.style.cssText=f.style.cssText,e.cssText=f.style.cssText);"FONT"===f.tagName&&(f.color&&(g.color=f.color,e.color=f.color),f.face&&(g.face=f.face,e.face=f.face),f.size&&(g.size=f.size,e.size=f.size));f.className&&(g.className=f.className,e.className=f.className);if(k)for(;k;)e=k.nextSibling,
g.appendChild(k),k=e;g.tagName==f.tagName?(n=c.createElement("span"),n.className="ieFormatBreakerSpan",m.place(n,f,"after"),m.place(g,n,"after")):m.place(g,f,"after");k=g;f=f.parentNode}if(k){if(1===k.nodeType||3===k.nodeType&&k.nodeValue)a.innerHTML="";for(;k;)e=k.nextSibling,a.appendChild(k),k=e}if(d.length){e=d.pop();k=c.createElement(e.tagName);e.cssText&&k.style&&(k.style.cssText=e.cssText);e.className&&(k.className=e.className);"FONT"===e.tagName&&(e.color&&(k.color=e.color),e.face&&(k.face=
e.face),e.size&&(k.size=e.size));for(m.place(k,a,"before");d.length;)e=d.pop(),l=c.createElement(e.tagName),e.cssText&&l.style&&(l.style.cssText=e.cssText),e.className&&(l.className=e.className),"FONT"===e.tagName&&(e.color&&(l.color=e.color),e.face&&(l.face=e.face),e.size&&(l.size=e.size)),k.appendChild(l),k=l;l=c.createTextNode(".");n.appendChild(l);k.appendChild(l)}else n=c.createElement("span"),n.className="ieFormatBreakerSpan",l=c.createTextNode("."),n.appendChild(l),m.place(n,a,"before");k=
E.create(this.window);k.setStart(l,0);k.setEnd(l,l.length);b.removeAllRanges();b.addRange(k);this.selection.collapse(!1);l.parentNode.innerHTML="";a.firstChild||m.destroy(a);return!0}return!1}f=b.getRangeAt(0);if((d=f.startContainer)&&3===d.nodeType)return e=f.startOffset,d.length<e&&(e=this._adjustNodeAndOffset(d,e),d=e.node,e=e.offset),g=d.nodeValue,f=c.createTextNode(g.substring(0,e)),r=g.substring(e),""!==r&&(k=c.createTextNode(g.substring(e))),n=c.createElement("span"),l=c.createTextNode("."),
n.appendChild(l),f.length?m.place(f,d,"after"):f=d,m.place(n,f,"after"),k&&m.place(k,n,"after"),m.destroy(d),k=E.create(this.window),k.setStart(l,0),k.setEnd(l,l.length),b.removeAllRanges(),b.addRange(k),c.execCommand(a),m.place(n.firstChild,n,"before"),m.destroy(n),k.setStart(l,0),k.setEnd(l,l.length),b.removeAllRanges(),b.addRange(k),this.selection.collapse(!1),l.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(a){var b=E.getSelection(this.window);if(b.isCollapsed&&b.rangeCount&&
!this.queryCommandValue(a)){var c=b.getRangeAt(0),d=c.startContainer;if(d&&3==d.nodeType&&!c.startOffset)return c="ul","insertorderedlist"===a&&(c="ol"),a=this.document.createElement(c),c=m.create("li",null,a),m.place(a,d,"before"),c.appendChild(d),m.create("br",null,a,"after"),a=E.create(this.window),a.setStart(d,0),a.setEnd(d,d.length),b.removeAllRanges(),b.addRange(a),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(a,b){var c=E.getSelection(this.window),d=this.document,
f,g,k,h,n;b=b||null;if(a&&c&&c.isCollapsed&&c.rangeCount&&(g=c.getRangeAt(0),(f=g.startContainer)&&3===f.nodeType)){n=g.startOffset;f.length<n&&(g=this._adjustNodeAndOffset(f,n),f=g.node,n=g.offset);k=f.nodeValue;g=d.createTextNode(k.substring(0,n));""!==k.substring(n)&&(h=d.createTextNode(k.substring(n)));k=d.createElement("span");n=d.createTextNode(".");k.appendChild(n);d=d.createElement("span");k.appendChild(d);g.length?m.place(g,f,"after"):g=f;m.place(k,g,"after");h&&m.place(h,k,"after");m.destroy(f);
f=E.create(this.window);f.setStart(n,0);f.setEnd(n,n.length);c.removeAllRanges();c.addRange(f);if(t("webkit")){c="color";if("hilitecolor"===a||"backcolor"===a)c="backgroundColor";e.set(k,c,b);this.selection.remove();m.destroy(d);k.innerHTML="\x26#160;";this.selection.selectElement(k);this.focus()}else this.execCommand(a,b),m.place(k.firstChild,k,"before"),m.destroy(k),f.setStart(n,0),f.setEnd(n,n.length),c.removeAllRanges(),c.addRange(f),this.selection.collapse(!1),n.parentNode.removeChild(n);return!0}return!1},
_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3===a.nextSibling.nodeType;)b-=a.length,a=a.nextSibling;return{node:a,offset:b}},_tagNamesForCommand:function(a){return"bold"===a?["b","strong"]:"italic"===a?["i","em"]:"strikethrough"===a?["s","strike"]:"superscript"===a?["sup"]:"subscript"===a?["sub"]:"underline"===a?["u"]:[]},_stripBreakerNodes:function(a){if(this.isLoaded)return u(".ieFormatBreakerSpan",a).forEach(function(a){for(;a.firstChild;)m.place(a.firstChild,a,"before");
m.destroy(a)}),a},_stripTrailingEmptyNodes:function(a){function b(a){return/^(p|div|br)$/i.test(a.nodeName)&&0==a.children.length&&/^[\s\xA0]*$/.test(a.textContent||a.innerText||"")||3===a.nodeType&&/^[\s\xA0]*$/.test(a.nodeValue)}for(;a.lastChild&&b(a.lastChild);)m.destroy(a.lastChild);return a},_setTextDirAttr:function(a){this._set("textDir",a);this.onLoadDeferred.then(q.hitch(this,function(){this.editNode.dir=a}))}});return K})},"dijit/selection":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/sniff dojo/_base/window dijit/focus".split(" "),
function(h,l,a,d,b,f){var k=function(g){var e=g.document;this.getType=function(){if(e.getSelection){var a="text",b;try{b=g.getSelection()}catch(d){}b&&1==b.rangeCount&&(b=b.getRangeAt(0),b.startContainer==b.endContainer&&1==b.endOffset-b.startOffset&&3!=b.startContainer.nodeType&&(a="control"));return a}return e.selection.type.toLowerCase()};this.getSelectedText=function(){if(e.getSelection){var a=g.getSelection();return a?a.toString():""}return"control"==this.getType()?null:e.selection.createRange().text};
this.getSelectedHtml=function(){if(e.getSelection){var a=g.getSelection();if(a&&a.rangeCount){var b,d="";for(b=0;b<a.rangeCount;b++){var f=a.getRangeAt(b).cloneContents(),k=e.createElement("div");k.appendChild(f);d+=k.innerHTML}return d}return null}return"control"==this.getType()?null:e.selection.createRange().htmlText};this.getSelectedElement=function(){if("control"==this.getType()){if(e.getSelection){var a=g.getSelection();return a.anchorNode.childNodes[a.anchorOffset]}if((a=e.selection.createRange())&&
a.item)return e.selection.createRange().item(0)}return null};this.getParentElement=function(){if("control"==this.getType()){var a=this.getSelectedElement();if(a)return a.parentNode}else if(e.getSelection){if(a=e.getSelection()){for(a=a.anchorNode;a&&1!=a.nodeType;)a=a.parentNode;return a}}else return a=e.selection.createRange(),a.collapse(!0),a.parentElement();return null};this.hasAncestorElement=function(a){return null!=this.getAncestorElement.apply(this,arguments)};this.getAncestorElement=function(a){var b=
this.getSelectedElement()||this.getParentElement();return this.getParentOfType(b,arguments)};this.isTag=function(a,b){if(a&&a.tagName)for(var d=a.tagName.toLowerCase(),e=0;e<b.length;e++){var f=String(b[e]).toLowerCase();if(d==f)return f}return""};this.getParentOfType=function(a,b){for(;a;){if(this.isTag(a,b).length)return a;a=a.parentNode}return null};this.collapse=function(a){if(e.getSelection){var b=g.getSelection();b.removeAllRanges?a?b.collapseToStart():b.collapseToEnd():b.collapse(a)}else b=
e.selection.createRange(),b.collapse(a),b.select()};this.remove=function(){var a=e.selection;e.getSelection?(a=g.getSelection(),a.deleteFromDocument()):"none"!=a.type.toLowerCase()&&a.clear();return a};this.selectElementChildren=function(a,b){var f;a=l.byId(a);if(e.getSelection){var k=g.getSelection();d("opera")?(f=k.rangeCount?k.getRangeAt(0):e.createRange(),f.setStart(a,0),f.setEnd(a,3==a.nodeType?a.length:a.childNodes.length),k.addRange(f)):k.selectAllChildren(a)}else if(f=a.ownerDocument.body.createTextRange(),
f.moveToElementText(a),!b)try{f.select()}catch(h){}};this.selectElement=function(a,f){var g;a=l.byId(a);if(e.getSelection){var k=e.getSelection();g=e.createRange();k.removeAllRanges&&(d("opera")&&k.getRangeAt(0)&&(g=k.getRangeAt(0)),g.selectNode(a),k.removeAllRanges(),k.addRange(g))}else try{k=a.tagName?a.tagName.toLowerCase():"",g="img"===k||"table"===k?b.body(e).createControlRange():b.body(e).createRange(),g.addElement(a),f||g.select()}catch(h){this.selectElementChildren(a,f)}};this.inSelection=
function(a){if(a){var b,d;if(e.getSelection){var f=g.getSelection();f&&0<f.rangeCount&&(d=f.getRangeAt(0));if(d&&d.compareBoundaryPoints&&e.createRange)try{if(b=e.createRange(),b.setStart(a,0),1===d.compareBoundaryPoints(d.START_TO_END,b))return!0}catch(k){}}else{d=e.selection.createRange();try{b=a.ownerDocument.body.createTextRange(),b.moveToElementText(a)}catch(h){}if(d&&b&&1===d.compareEndPoints("EndToStart",b))return!0}}return!1};this.getBookmark=function(){var a,b,d=e.selection,k=f.curNode;if(e.getSelection){if(d=
g.getSelection())if(d.isCollapsed){if(a=k?k.tagName:"")if(a=a.toLowerCase(),"textarea"==a||"input"==a&&(!k.type||"text"==k.type.toLowerCase()))return d={start:k.selectionStart,end:k.selectionEnd,node:k,pRange:!0},{isCollapsed:d.end<=d.start,mark:d};a={isCollapsed:!0};d.rangeCount&&(a.mark=d.getRangeAt(0).cloneRange())}else b=d.getRangeAt(0),a={isCollapsed:!1,mark:b.cloneRange()}}else if(d){a=k?k.tagName:"";a=a.toLowerCase();if(k&&a&&("button"==a||"textarea"==a||"input"==a)){if(d.type&&"none"==d.type.toLowerCase())return{isCollapsed:!0,
mark:null};b=d.createRange();return{isCollapsed:b.text&&b.text.length?!1:!0,mark:{range:b,pRange:!0}}}a={};try{b=d.createRange(),a.isCollapsed=!("Text"==d.type?b.htmlText.length:b.length)}catch(h){return a.isCollapsed=!0,a}if("CONTROL"==d.type.toUpperCase())if(b.length)for(a.mark=[],d=0,k=b.length;d<k;)a.mark.push(b.item(d++));else a.isCollapsed=!0,a.mark=null;else a.mark=b.getBookmark()}else console.warn("No idea how to store the current selection for this browser!");return a};this.moveToBookmark=
function(b){if(b=b.mark)if(e.getSelection){var d=g.getSelection();d&&d.removeAllRanges?b.pRange?(d=b.node,d.selectionStart=b.start,d.selectionEnd=b.end):(d.removeAllRanges(),d.addRange(b)):console.warn("No idea how to restore selection for this browser!")}else if(e.selection&&b){var f;b.pRange?f=b.range:a.isArray(b)?(f=e.body.createControlRange(),h.forEach(b,function(a){f.addElement(a)})):(f=e.body.createTextRange(),f.moveToBookmark(b));f.select()}};this.isCollapsed=function(){return this.getBookmark().isCollapsed}},
m=new k(window);m.SelectionManager=k;return m})},"dijit/_editor/range":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang"],function(h,l,a){var d={getIndex:function(a,b){for(var d=[],e=[],c=a,f,h;a!=b;){var l=0;for(f=a.parentNode;h=f.childNodes[l++];)if(h===a){--l;break}d.unshift(l);e.unshift(l-f.childNodes.length);a=f}if(0<d.length&&3==c.nodeType){for(h=c.previousSibling;h&&3==h.nodeType;)d[d.length-1]--,h=h.previousSibling;for(h=c.nextSibling;h&&3==h.nodeType;)e[e.length-
1]++,h=h.nextSibling}return{o:d,r:e}},getNode:function(b,d){if(!a.isArray(b)||0==b.length)return d;var f=d;h.every(b,function(a){if(0<=a&&a<f.childNodes.length)f=f.childNodes[a];else return f=null,!1;return!0});return f},getCommonAncestor:function(a,b,d){d=d||a.ownerDocument.body;var e=function(a){for(var b=[];a;)if(b.unshift(a),a!==d)a=a.parentNode;else break;return b};a=e(a);b=e(b);for(var e=Math.min(a.length,b.length),c=a[0],f=1;f<e;f++)if(a[f]===b[f])c=a[f];else break;return c},getAncestor:function(a,
b,d){for(d=d||a.ownerDocument.body;a&&a!==d;){var e=a.nodeName.toUpperCase();if(b.test(e))return a;a=a.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(a,b,f){f=f||a.ownerDocument.body;b=b||d.BlockTagNames;for(var e=null,c;a&&a!==f;){var h=a.nodeName.toUpperCase();!e&&b.test(h)&&(e=a);!c&&/^(?:BODY|TD|TH|CAPTION)$/.test(h)&&(c=a);a=a.parentNode}return{blockNode:e,blockContainer:c||a.ownerDocument.body}},atBeginningOfContainer:function(a,
b,d){var e=!1,c=0==d;c||3!=b.nodeType||/^[\s\xA0]+$/.test(b.nodeValue.substr(0,d))&&(c=!0);if(c)for(e=!0;b&&b!==a;){if(b.previousSibling){e=!1;break}b=b.parentNode}return e},atEndOfContainer:function(a,b,d){var e=!1,c=d==(b.length||b.childNodes.length);c||3!=b.nodeType||/^[\s\xA0]+$/.test(b.nodeValue.substr(d))&&(c=!0);if(c)for(e=!0;b&&b!==a;){if(b.nextSibling){e=!1;break}b=b.parentNode}return e},adjacentNoneTextNode:function(a,b){for(var d=a,e=0-a.length||0,c=b?"nextSibling":"previousSibling";d&&
3==d.nodeType;)e+=d.length,d=d[c];return[d,e]},create:function(a){a=a||window;return a.getSelection?a.document.createRange():new f},getSelection:function(a,d){if(a.getSelection)return a.getSelection();var f=new b.selection(a);d||f._getCurrentSelection();return f}};if(!window.getSelection)var b=d.ie={cachedSelection:{},selection:function(a){this._ranges=[];this.addRange=function(a,b){this._ranges.push(a);b||a._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=
[];this.rangeCount=0};this.getRangeAt=function(a){return this._ranges[a]};this._getCurrentSelection=function(){this.removeAllRanges();var d;d=a.document.selection.createRange();d="CONTROL"==a.document.selection.type.toUpperCase()?new f(b.decomposeControlRange(d)):new f(b.decomposeTextRange(d));d?(this.addRange(d,!0),this.isCollapsed=d.collapsed):this.isCollapsed=!0}},decomposeControlRange:function(a){var b=a.item(0),f=a.item(a.length-1);a=b.parentNode;var e=f.parentNode,b=d.getIndex(b,a).o[0],f=d.getIndex(f,
e).o[0]+1;return[a,b,e,f]},getEndPoint:function(a,b){var f=a.duplicate();f.collapse(!b);var e="EndTo"+(b?"End":"Start"),c=f.parentElement(),n,l,r;0<c.childNodes.length?h.every(c.childNodes,function(b,h){var m;if(3!=b.nodeType)if(f.moveToElementText(b),0<f.compareEndPoints(e,a))if(r&&3==r.nodeType)n=r,m=!0;else return n=c,l=h,!1;else{if(h==c.childNodes.length-1)return n=c,l=c.childNodes.length,!1}else h==c.childNodes.length-1&&(n=b,m=!0);if(m&&n){n=(m=d.adjacentNoneTextNode(n)[0])?m.nextSibling:c.firstChild;
var u=d.adjacentNoneTextNode(n);m=u[0];u=u[1];m?(f.moveToElementText(m),f.collapse(!1)):f.moveToElementText(c);f.setEndPoint(e,a);l=f.text.length-u;return!1}r=b;return!0}):(n=c,l=0);if(!b&&1==n.nodeType&&l==n.childNodes.length){var u=n.nextSibling;u&&3==u.nodeType&&(n=u,l=0)}return[n,l]},setEndPoint:function(a,b,f){a=a.duplicate();var e;if(3!=b.nodeType)if(0<f){if(e=b.childNodes[f-1])if(3==e.nodeType)b=e,f=e.length;else if(e.nextSibling&&3==e.nextSibling.nodeType)b=e.nextSibling,f=0;else{a.moveToElementText(e.nextSibling?
e:b);var c=e.parentNode;e=c.insertBefore(e.ownerDocument.createTextNode(" "),e.nextSibling);a.collapse(!1);c.removeChild(e)}}else a.moveToElementText(b),a.collapse(!0);3==b.nodeType&&(e=d.adjacentNoneTextNode(b),c=e[0],e=e[1],c?(a.moveToElementText(c),a.collapse(!1),"inherit"!=c.contentEditable&&e++):(a.moveToElementText(b.parentNode),a.collapse(!0),a.move("character",1),a.move("character",-1)),f+=e,0<f&&a.move("character",f)!=f&&console.error("Error when moving!"));return a},decomposeTextRange:function(a){var d=
b.getEndPoint(a),f=d[0],e=d[1],c=d[0],d=d[1];a.htmlText.length&&(a.htmlText==a.text?d=e+a.text.length:(d=b.getEndPoint(a,!0),c=d[0],d=d[1]));return[f,e,c,d]},setRange:function(a,d,f,e,c,h){d=b.setEndPoint(a,d,f);a.setEndPoint("StartToStart",d);if(!h)var l=b.setEndPoint(a,e,c);a.setEndPoint("EndToEnd",l||d);return a}},f=d.W3CRange=l(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=
null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=this.startContainer!==this.endContainer?d.getCommonAncestor(this.startContainer,this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(a,b){b=parseInt(b);if(this.startContainer!==a||this.startOffset!=b)delete this._cachedBookmark,this.startContainer=a,this.startOffset=
b,this.endContainer?this._updateInternal():this.setEnd(a,b)},setEnd:function(a,b){b=parseInt(b);if(this.endContainer!==a||this.endOffset!=b)delete this._cachedBookmark,this.endContainer=a,this.endOffset=b,this.startContainer?this._updateInternal():this.setStart(a,b)},setStartAfter:function(a,b){this._setPoint("setStart",a,b,1)},setStartBefore:function(a,b){this._setPoint("setStart",a,b,0)},setEndAfter:function(a,b){this._setPoint("setEnd",a,b,1)},setEndBefore:function(a,b){this._setPoint("setEnd",
a,b,0)},_setPoint:function(a,b,f,e){f=d.getIndex(b,b.parentNode).o;this[a](b.parentNode,f.pop()+e)},_getIERange:function(){var a=(this._body||this.endContainer.ownerDocument.body).createTextRange();b.setRange(a,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return a},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var a=this.startContainer,b=this._getIERange();3!==
a.nodeType||this.startOffset||this.setStartBefore(a);b.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var a=new f([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);a._body=this._body;return a},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});a.setObject("dijit.range",d);return d})},"dijit/_editor/html":function(){define(["dojo/_base/array",
"dojo/_base/lang","dojo/sniff"],function(h,l,a){var d={};l.setObject("dijit._editor.html",d);var b=d.escapeXml=function(a,b){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");b||(a=a.replace(/'/gm,"\x26#39;"));return a};d.getNodeHtml=function(a){var b=[];d.getNodeHtmlHelper(a,b);return b.join("")};d.getNodeHtmlHelper=function(f,k){switch(f.nodeType){case 1:var m=f.nodeName.toLowerCase();if(!m||"/"==m.charAt(0))return"";k.push("\x3c",m);var g=
[],e={},c;if(a("dom-attributes-explicit")||a("dom-attributes-specified-flag"))for(var n=0;c=f.attributes[n++];){var l=c.name;"_dj"===l.substr(0,3)||a("dom-attributes-specified-flag")&&!c.specified||l in e||(c=c.value,("src"==l||"href"==l)&&f.getAttribute("_djrealurl")&&(c=f.getAttribute("_djrealurl")),8===a("ie")&&"style"===l&&(c=c.replace("HEIGHT:","height:").replace("WIDTH:","width:")),g.push([l,c]),e[l]=c)}else{var r=(/^input$|^img$/i.test(f.nodeName)?f:f.cloneNode(!1)).outerHTML,e=r.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi),
r=r.substr(0,r.indexOf("\x3e"));h.forEach(e,function(a){if(a){var b=a.indexOf("\x3d");if(0<b&&(a=a.substring(0,b),"_dj"!=a.substr(0,3)))if("src"!=a&&"href"!=a||!f.getAttribute("_djrealurl")){var c;switch(a){case "style":c=f.style.cssText.toLowerCase();break;case "class":c=f.className;break;case "width":if("img"===m){(b=/width=(\S+)/i.exec(r))&&(c=b[1]);break}case "height":if("img"===m){(b=/height=(\S+)/i.exec(r))&&(c=b[1]);break}default:c=f.getAttribute(a)}null!=c&&g.push([a,c.toString()])}else g.push([a,
f.getAttribute("_djrealurl")])}},this)}g.sort(function(a,b){return a[0]<b[0]?-1:a[0]==b[0]?0:1});for(e=0;c=g[e++];)k.push(" ",c[0],'\x3d"',"string"===typeof c[1]?b(c[1],!0):c[1],'"');switch(m){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":k.push(" /\x3e");break;case "script":k.push("\x3e",f.innerHTML,"\x3c/",m,"\x3e");break;default:k.push("\x3e"),f.hasChildNodes()&&d.getChildrenHtmlHelper(f,k),k.push("\x3c/",m,"\x3e")}break;case 4:case 3:k.push(b(f.nodeValue,
!0));break;case 8:k.push("\x3c!--",b(f.nodeValue,!0),"--\x3e");break;default:k.push("\x3c!-- Element not recognized - Type: ",f.nodeType," Name: ",f.nodeName,"--\x3e")}};d.getChildrenHtml=function(a){var b=[];d.getChildrenHtmlHelper(a,b);return b.join("")};d.getChildrenHtmlHelper=function(b,k){if(b)for(var h=b.childNodes||b,g=!a("ie")||h!==b,e,c=0;e=h[c++];)g&&e.parentNode!=b||d.getNodeHtmlHelper(e,k)};return d})},"dijit/_editor/nls/commands":function(){define({root:{bold:"Bold",copy:"Copy",cut:"Cut",
"delete":"Delete",indent:"Indent",insertHorizontalRule:"Horizontal Rule",insertOrderedList:"Numbered List",insertUnorderedList:"Bullet List",italic:"Italic",justifyCenter:"Align Center",justifyFull:"Justify",justifyLeft:"Align Left",justifyRight:"Align Right",outdent:"Outdent",paste:"Paste",redo:"Redo",removeFormat:"Remove Format",selectAll:"Select All",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",underline:"Underline",undo:"Undo",unlink:"Remove Link",createLink:"Create Link",
toggleDir:"Toggle Direction",insertImage:"Insert Image",insertTable:"Insert/Edit Table",toggleTableBorder:"Toggle Table Border",deleteTable:"Delete Table",tableProp:"Table Property",htmlToggle:"HTML Source",foreColor:"Foreground Color",hiliteColor:"Background Color",plainFormatBlock:"Paragraph Style",formatBlock:"Paragraph Style",fontSize:"Font Size",fontName:"Font Name",tabIndent:"Tab Indent",fullScreen:"Toggle Full Screen",viewSource:"View HTML Source",print:"Print",newPage:"New Page",systemShortcut:'The "${0}" action is only available in your browser using a keyboard shortcut. Use ${1}.',
ctrlKey:"ctrl+${0}",appleKey:"\u2318${0}"},bs:!0,mk:!0,sr:!0,zh:!0,"zh-tw":!0,vi:!0,uk:!0,tr:!0,th:!0,sv:!0,sl:!0,sk:!0,ru:!0,ro:!0,pt:!0,"pt-pt":!0,pl:!0,nl:!0,nb:!0,lv:!0,lt:!0,ko:!0,kk:!0,ja:!0,it:!0,id:!0,hu:!0,hr:!0,he:!0,fr:!0,fi:!0,eu:!0,et:!0,es:!0,el:!0,de:!0,da:!0,cs:!0,ca:!0,bg:!0,az:!0,ar:!0})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n){var q=l("dijit._editor.plugins.LinkDialog",e,{buttonClass:c,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=b.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(a){h("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),b.hitch(this,function(c,e,k){var h=this;this.tag="insertImage"==this.command?"img":"a";c=b.delegate(c.getLocalization("dijit","common",this.lang),c.getLocalization("dijit._editor",
"LinkDialog",this.lang));var m=this.dropDown=this.button.dropDown=new e({title:c[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:b.hitch(this,"setValue"),onOpen:function(){h._onOpenDialog();e.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(b.hitch(h,"_onCloseDialog"),0)}});c.urlRegExp=this.urlRegExp;c.id=k.getUniqueId(this.editor.id);this._uniqueId=c.id;this._setContent(m.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
g.substitute(this.linkDialogTemplate,c));m.startup();this._urlInput=k.byId(this._uniqueId+"_urlInput");this._textInput=k.byId(this._uniqueId+"_textInput");this._setButton=k.byId(this._uniqueId+"_setButton");this.own(k.byId(this._uniqueId+"_cancelButton").on("click",b.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",b.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",b.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=b.hitch(this,function(){var a=this._urlInput.get("value");return this._urlRegExp.test(a)||this._emailRegExp.test(a)});this.own(f(m.domNode,"keydown",b.hitch(this,b.hitch(this,function(a){!a||a.keyCode!=d.ENTER||a.shiftKey||a.metaKey||a.ctrlKey||a.altKey||this._setButton.get("disabled")||(m.onExecute(),m.execute(m.get("value")))}))));a()}))},_checkAndFixInput:function(){var a=this,c=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var d=c,e=!1,f=!1;d&&1<d.length&&(d=b.trim(d),0!==d.indexOf("mailto:")&&(0<d.indexOf("/")?-1===d.indexOf("://")&&"/"!==d.charAt(0)&&d.indexOf("./")&&0!==d.indexOf("../")&&a._hostRxp.test(d)&&(e=!0):a._userAtRxp.test(d)&&(f=!0)));e&&a._urlInput.set("value","http://"+d);f&&a._urlInput.set("value","mailto:"+d);a._setButton.set("disabled",!a._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(b.hitch(this,
function(){this.own(f(this.editor.editNode,"dblclick",b.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(a){this.dropDown.set({parserScope:"dojo",content:a})},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));return a},setValue:function(b){this._onCloseDialog();if(9>k("ie")){var c=n.getSelection(this.editor.window).getRangeAt(0).endContainer;3===c.nodeType&&(c=c.parentNode);
c&&c.nodeName&&c.nodeName.toLowerCase()!==this.tag&&(c=this.editor.selection.getSelectedElement(this.tag));c&&c.nodeName&&c.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(c),this.editor.execCommand("unlink"))}b=this._checkValues(b);this.editor.execCommand("inserthtml",g.substitute(this.htmlTemplate,b));m("a",this.editor.document).forEach(function(b){b.innerHTML||a.has(b,"name")||b.parentNode.removeChild(b)},this)},_onCloseDialog:function(){this.editor.focused&&
this.editor.focus()},_getCurrentValues:function(a){var b,c,d;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("href"),d=a.getAttribute("target")||"_self",c=a.textContent||a.innerText,this.editor.selection.selectElement(a,!0)):c=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:c||"",targetSelect:d||""}},_onOpenDialog:function(){var a,b;if(k("ie")){if(b=n.getSelection(this.editor.window),b.rangeCount){var c=b.getRangeAt(0);a=c.endContainer;
3===a.nodeType&&(a=a.parentNode);a&&a.nodeName&&a.nodeName.toLowerCase()!==this.tag&&(a=this.editor.selection.getSelectedElement(this.tag));if(!a||a.nodeName&&a.nodeName.toLowerCase()!==this.tag)(b=this.editor.selection.getAncestorElement(this.tag))&&b.nodeName&&b.nodeName.toLowerCase()==this.tag?(a=b,this.editor.selection.selectElement(a)):c.startContainer===c.endContainer&&(b=c.startContainer.firstChild)&&b.nodeName&&b.nodeName.toLowerCase()==this.tag&&(a=b,this.editor.selection.selectElement(a))}}else a=
this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(a))},_onDblClick:function(b){if(b&&b.target&&(b=b.target,(b.tagName?b.tagName.toLowerCase():"")===this.tag&&a.get(b,"href"))){var c=this.editor;this.editor.selection.selectElement(b);c.onDisplayChanged();c._updateTimer&&(c._updateTimer.remove(),delete c._updateTimer);c.onNormalizedDisplayChanged();var d=this.button;setTimeout(function(){d.set("disabled",
!1);d.loadAndOpenDropDown().then(function(){d.dropDown.focus&&d.dropDown.focus()})},10)}}}),r=l("dijit._editor.plugins.ImgLinkDialog",[q],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(a){var b,c;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("src"),c=a.getAttribute("alt"),this.editor.selection.selectElement(a,!0)):c=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:c||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(b.hitch(this,
function(){this.own(f(this.editor.editNode,"mousedown",b.hitch(this,"_selectTag")))}))},_selectTag:function(a){a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(a))},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));a&&a.textInput&&(a.textInput=a.textInput.replace(/"/g,"\x26quot;"));return a},_onDblClick:function(b){if(b&&b.target&&(b=b.target,(b.tagName?b.tagName.toLowerCase():"")===this.tag&&a.get(b,
"src"))){var c=this.editor;this.editor.selection.selectElement(b);c.onDisplayChanged();c._updateTimer&&(c._updateTimer.remove(),delete c._updateTimer);c.onNormalizedDisplayChanged();var d=this.button;setTimeout(function(){d.set("disabled",!1);d.loadAndOpenDropDown().then(function(){d.dropDown.focus&&d.dropDown.focus()})},10)}}});e.registry.createLink=function(){return new q({command:"createLink"})};e.registry.insertImage=function(){return new r({command:"insertImage"})};q.ImgLinkDialog=r;return q})},
"dijit/form/DropDownButton":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/query ../registry ../popup ./Button ../_Container ../_HasDropDown dojo/text!./templates/DropDownButton.html ../a11yclick".split(" "),function(h,l,a,d,b,f,k,m,g,e){return h("dijit.form.DropDownButton",[k,m,g],{baseClass:"dijitDropDownButton",templateString:e,_fillContent:function(){var a=this.srcNodeRef,b=this.containerNode;if(a&&b)for(;a.hasChildNodes();){var d=a.firstChild;d.hasAttribute&&(d.hasAttribute("data-dojo-type")||
d.hasAttribute("dojoType")||d.hasAttribute("data-"+l._scopeName+"-type")||d.hasAttribute(l._scopeName+"Type"))?(this.dropDownContainer=this.ownerDocument.createElement("div"),this.dropDownContainer.appendChild(d)):b.appendChild(d)}},startup:function(){this._started||(!this.dropDown&&this.dropDownContainer&&(this.dropDown=b.byNode(this.dropDownContainer.firstChild),delete this.dropDownContainer),this.dropDown&&f.hide(this.dropDown),this.inherited(arguments))},isLoaded:function(){var a=this.dropDown;
return!!a&&(!a.href||a.isLoaded)},loadDropDown:function(b){var d=this.dropDown,e=d.on("load",a.hitch(this,function(){e.remove();b()}));d.refresh()},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown}})})},"dijit/_HasDropDown":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on dojo/touch ./registry ./focus ./popup ./_FocusMixin".split(" "),function(h,l,a,d,
b,f,k,m,g,e,c,n,q,r,u,v){return h("dijit._HasDropDown",v,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:!0,forceWidth:!1,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:!0,_onDropDownMouseDown:function(a){this.disabled||this.readOnly||("MSPointerDown"!=a.type&&"pointerdown"!=a.type&&a.preventDefault(),this.own(c.once(this.ownerDocument,n.release,e.hitch(this,"_onDropDownMouseUp"))),this.toggleDropDown())},_onDropDownMouseUp:function(a){var c=
this.dropDown,d=!1;if(a&&this._opened){var e=f.position(this._buttonNode,!0);if(!(a.pageX>=e.x&&a.pageX<=e.x+e.w&&a.pageY>=e.y&&a.pageY<=e.y+e.h)){for(e=a.target;e&&!d;)b.contains(e,"dijitPopup")?d=!0:e=e.parentNode;if(d){e=a.target;if(c.onItemClick){for(var g;e&&!(g=q.byNode(e));)e=e.parentNode;if(g&&g.onClick&&g.getParent)g.getParent().onItemClick(g,a)}return}}}this._opened?c.focus&&(!1!==c.autoFocus||"mouseup"==a.type&&!this.hovering)&&(this._focusDropDownTimer=this.defer(function(){c.focus();
delete this._focusDropDownTimer})):this.focus&&this.defer("focus")},_onDropDownClick:function(a){this._stopClickEvents&&(a.stopPropagation(),a.preventDefault())},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var a={after:this.isLeftToRight()?"Right":"Left",before:this.isLeftToRight()?"Left":"Right",above:"Up",below:"Down",left:"Left",right:"Right"}[this.dropDownPosition[0]]||
this.dropDownPosition[0]||"Down";b.add(this._arrowWrapperNode||this._buttonNode,"dijit"+a+"ArrowButton")},postCreate:function(){this.inherited(arguments);var a=this.focusNode||this.domNode;this.own(c(this._buttonNode,n.press,e.hitch(this,"_onDropDownMouseDown")),c(this._buttonNode,"click",e.hitch(this,"_onDropDownClick")),c(a,"keydown",e.hitch(this,"_onKey")),c(a,"keyup",e.hitch(this,"_onKeyUp")))},destroy:function(){this._opened&&this.closeDropDown(!0);this.dropDown&&(this.dropDown._destroyed||this.dropDown.destroyRecursive(),
delete this.dropDown);this.inherited(arguments)},_onKey:function(a){if(!this.disabled&&!this.readOnly){var b=this.dropDown,c=a.target;b&&this._opened&&b.handleKey&&!1===b.handleKey(a)?(a.stopPropagation(),a.preventDefault()):b&&this._opened&&a.keyCode==g.ESCAPE?(this.closeDropDown(),a.stopPropagation(),a.preventDefault()):!this._opened&&(a.keyCode==g.DOWN_ARROW||(a.keyCode==g.ENTER||a.keyCode==g.SPACE&&(!this._searchTimer||a.ctrlKey||a.altKey||a.metaKey))&&("input"!==(c.tagName||"").toLowerCase()||
c.type&&"text"!==c.type.toLowerCase()))&&(this._toggleOnKeyUp=!0,a.stopPropagation(),a.preventDefault())}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var a=this.dropDown;a&&a.focus&&this.defer(e.hitch(a,"focus"),1)}},_onBlur:function(){this.closeDropDown(!1);this.inherited(arguments)},isLoaded:function(){return!0},loadDropDown:function(a){a()},loadAndOpenDropDown:function(){var a=new l,b=e.hitch(this,function(){this.openDropDown();a.resolve(this.dropDown)});
this.isLoaded()?b():this.loadDropDown(b);return a},toggleDropDown:function(){this.disabled||this.readOnly||(this._opened?this.closeDropDown(!0):this.loadAndOpenDropDown())},openDropDown:function(){var a=this.dropDown,c=a.domNode,g=this._aroundNode||this.domNode,k=this,h=u.open({parent:this,popup:a,around:g,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){k.closeDropDown(!0)},onCancel:function(){k.closeDropDown(!0)},onClose:function(){d.set(k._popupStateNode,"popupActive",
!1);b.remove(k._popupStateNode,"dijitHasDropDownOpen");k._set("_opened",!1)}});if(this.forceWidth||this.autoWidth&&g.offsetWidth>a._popupWrapper.offsetWidth){var g=g.offsetWidth-a._popupWrapper.offsetWidth,m={w:a.domNode.offsetWidth+g};this._origStyle=c.style.cssText;e.isFunction(a.resize)?a.resize(m):f.setMarginBox(c,m);"R"==h.corner[1]&&(a._popupWrapper.style.left=a._popupWrapper.style.left.replace("px","")-g+"px")}d.set(this._popupStateNode,"popupActive","true");b.add(this._popupStateNode,"dijitHasDropDownOpen");
this._set("_opened",!0);this._popupStateNode.setAttribute("aria-expanded","true");this._popupStateNode.setAttribute("aria-owns",a.id);"presentation"===c.getAttribute("role")||c.getAttribute("aria-labelledby")||c.setAttribute("aria-labelledby",this.id);return h},closeDropDown:function(a){this._focusDropDownTimer&&(this._focusDropDownTimer.remove(),delete this._focusDropDownTimer);this._opened&&(this._popupStateNode.setAttribute("aria-expanded","false"),a&&this.focus&&this.focus(),u.close(this.dropDown),
this._opened=!1);this._origStyle&&(this.dropDown.domNode.style.cssText=this._origStyle,delete this._origStyle)}})})},"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),function(h,l,a,d,b,f){var k=a("dijit._editor.plugins.TextColor",b,{buttonClass:f,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var a=this;this.button.loadDropDown=
function(b){function d(c){a.button.dropDown=new c({dir:a.editor.dir,ownerDocument:a.editor.ownerDocument,value:a.value,onChange:function(b){a.editor.execCommand(a.command,b)},onExecute:function(){a.editor.execCommand(a.command,this.get("value"))}});b()}"string"==typeof a.colorPicker?h([a.colorPicker],d):d(a.colorPicker)}},updateState:function(){var a=this.editor,b=this.command;if(a&&a.isLoaded&&b.length){if(this.button){var d=this.get("disabled");this.button.set("disabled",d);if(d)return;var c;try{c=
a.queryCommandValue(b)||""}catch(f){c=""}}""==c&&(c="#000000");"transparent"==c&&(c="#ffffff");"string"==typeof c?-1<c.indexOf("rgb")&&(c=l.fromRgb(c).toHex()):(c=((c&255)<<16|c&65280|(c&16711680)>>>16).toString(16),c="#000000".slice(0,7-c.length)+c);this.value=c;(a=this.button.dropDown)&&a.get&&c!==a.get("value")&&a.set("value",c,!1)}}});b.registry.foreColor=function(a){return new k(a)};b.registry.hiliteColor=function(a){return new k(a)};return k})},"dojo/colors":function(){define(["./_base/kernel",
"./_base/lang","./_base/Color","./_base/array"],function(h,l,a,d){var b={};l.setObject("dojo.colors",b);var f=function(a,b,d){0>d&&++d;1<d&&--d;var c=6*d;return 1>c?a+(b-a)*c:1>2*d?b:2>3*d?a+(b-a)*(2/3-d)*6:a};h.colorFromRgb=a.fromRgb=function(b,g){var e=b.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(e){var c=e[2].split(/\s*,\s*/),k=c.length,e=e[1];if("rgb"==e&&3==k||"rgba"==e&&4==k)return e=c[0],"%"==e.charAt(e.length-1)?(e=d.map(c,function(a){return 2.56*parseFloat(a)}),4==k&&(e[3]=
c[3]),a.fromArray(e,g)):a.fromArray(c,g);if("hsl"==e&&3==k||"hsla"==e&&4==k){var e=(parseFloat(c[0])%360+360)%360/360,h=parseFloat(c[1])/100,l=parseFloat(c[2])/100,h=.5>=l?l*(h+1):l+h-l*h,l=2*l-h,e=[256*f(l,h,e+1/3),256*f(l,h,e),256*f(l,h,e-1/3),1];4==k&&(e[3]=c[3]);return a.fromArray(e,g)}}return null};var k=function(a,b,d){a=Number(a);return isNaN(a)?d:a<b?b:a>d?d:a};a.prototype.sanitize=function(){this.r=Math.round(k(this.r,0,255));this.g=Math.round(k(this.g,0,255));this.b=Math.round(k(this.b,
0,255));this.a=k(this.a,0,1);return this};b.makeGrey=a.makeGrey=function(b,d){return a.fromArray([b,b,b,d])};l.mixin(a.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,
20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,
191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,
205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,
0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,
238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],
tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return a})},"esri/dijit/editing/AttachmentEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/io-query dojo/dom-attr dijit/_Widget dijit/_Templated dijit/ProgressBar ../../kernel ../../lang ../../domUtils dojo/text!./templates/AttachmentEditor.html dojo/i18n!../../nls/jsapi dojo/NodeList-dom".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t){h=h([e,c],{declaredClass:"esri.dijit.editing.AttachmentEditor",widgetsInTemplate:!0,templateString:v,_listHtml:"\x3cspan id\x3d'node_${oid}_${attid}'\x3e\x3ca href\x3d'${href}' target\x3d'_blank'\x3e${name}\x3c/a\x3e",_deleteBtnHtml:"(\x3cspan style\x3d'cursor:pointer;color:red;font-weight:bold;' class\x3d'deleteAttachment' id\x3d'${attid}');'\x3eX\x3c/span\x3e)",_endHtml:"\x3cbr/\x3e\x3c/span\x3e",_aeConnects:[],_layerEditingCapChecked:{},_layerEditingCap:{},
constructor:function(a,b){l.mixin(this,t.widgets.attachmentEditor)},startup:function(){this.inherited(arguments);this._uploadField_connect=a.connect(this._uploadField,"onchange",this,function(){0<this._uploadField.value.length&&this._addAttachment()});this._uploadFieldFocus_connect=a.connect(this._uploadField,"onfocus",l.hitch(this,function(a){u.hide(this._attachmentError)}))},destroy:function(){d.forEach(this._aeConnects,a.disconnect);a.disconnect(this._uploadField_connect);a.disconnect(this._uploadFieldFocus_connect);
this.inherited(arguments)},showAttachments:function(a,b){if(this._attachmentList.innerHTML=this.NLS_none,this._uploadField.value="",d.forEach(this.domNode.children,function(a,b){u.show(a)}),u.hide(this._attachmentError),a&&(this._featureLayer=a.getLayer()||b,this._featureLayer)){if("esri.layers.FeatureLayer"!==this._featureLayer.declaredClass||!this._featureLayer.getEditCapabilities)return b&&b.getEditCapabilities()?void 0:(u.hide(this._uploadForm),void d.forEach(this.domNode.children,function(a,
b){u.hide(a)}));this._currentLayerId=this._featureLayer.id;this._layerEditingCapChecked[this._currentLayerId]||(this._layerEditingCap[this._currentLayerId]=this._featureLayer.getEditCapabilities(),this._layerEditingCapChecked[this._currentLayerId]=!0);this._featureCanUpdate=this._featureLayer.getEditCapabilities({feature:a}).canUpdate;this._oid=a.attributes[this._featureLayer.objectIdField];this._getAttachments(a)}},_getAttachments:function(a){this._featureLayer&&this._featureLayer.queryAttachmentInfos&&
this._featureLayer.queryAttachmentInfos(this._oid,l.hitch(this,"_onQueryAttachmentInfosComplete"))},_addAttachment:function(){u.hide(this._attachmentError);this._featureLayer&&this._featureLayer.addAttachment?(u.show(this._attachmentProgress),this._featureLayer.addAttachment(this._oid,this._uploadForm,l.hitch(this,"_onAddAttachmentComplete"),l.hitch(this,"_onAddAttachmentError"))):this._tempUpload=this._uploadForm},_chainAttachment:function(a,b){this._tempUpload&&(u.show(this._attachmentProgress),
b.addAttachment(a,this._tempUpload,l.hitch(this,"_onAddAttachmentComplete"),l.hitch(this,"_onAddAttachmentError")));this._tempUpload=null},_deleteAttachment:function(a,b){u.show(this._attachmentProgress);this._featureLayer.deleteAttachments(a,[b],l.hitch(this,"_onDeleteAttachmentComplete"))},_onQueryAttachmentInfosComplete:function(a){var b=this._listHtml+this._deleteBtnHtml+this._endHtml;this._uploadForm.style.display="block";!this._featureCanUpdate&&this._layerEditingCap[this._currentLayerId].canUpdate||
!this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate?(b=this._listHtml+this._endHtml,this._uploadForm.style.display="none"):this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(b=this._listHtml+this._endHtml);var c=this._attachmentList;a=d.map(a,l.hitch(this,function(a){return r.substitute({href:a.url,name:a.name,oid:a.objectId,attid:a.id},b)}));c.innerHTML=a.join("")||this.NLS_none;
this._updateConnects()},_onAddAttachmentComplete:function(a){u.hide(this._attachmentProgress.domNode);var b=this._attachmentList,c=this._uploadField,d=c.value,e=d.lastIndexOf("\\");-1<e&&(d=d.substring(e+1,d.length));var d=d.replace(/\ /g,"_"),e=m.objectToQuery({gdbVersion:this._featureLayer.gdbVersion,token:this._featureLayer._getToken()}),f=this._listHtml+this._deleteBtnHtml+this._endHtml;this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&
(f=this._listHtml+this._endHtml);a=r.substitute({href:this._featureLayer._url.path+"/"+a.objectId+"/attachments/"+a.attachmentId+(e?"?"+e:""),name:d,oid:a.objectId,attid:a.attachmentId},f);b.innerHTML=b.innerHTML==this.NLS_none?a:b.innerHTML+a;this._updateConnects();c.value=""},_onAddAttachmentError:function(a){if(u.hide(this._attachmentProgress.domNode),a&&r.isDefined(a.code)){var b=this._attachmentError;g.set(b,"innerHTML",(400===a.code?this.NLS_fileNotSupported:a.message||a.details&&a.details.length&&
a.details[0])||this.NLS_error);u.show(b)}},_onDeleteAttachmentComplete:function(a){u.hide(this._attachmentProgress.domNode);var c=this._attachmentList;d.every(a,function(a){return a.success})&&(b.query("#node_"+a[0].objectId+"_"+a[0].attachmentId).orphan(),c.children&&c.children.length||(c.innerHTML=this.NLS_none))},_updateConnects:function(){d.forEach(this._aeConnects,a.disconnect);b.query(".deleteAttachment").forEach(function(b){this._aeConnects.push(a.connect(b,"onclick",l.hitch(this,"_deleteAttachment",
this._oid,b.id)))},this)}});return f("extend-esri")&&l.setObject("dijit.editing.AttachmentEditor",h,q),h})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),function(h,l,a,d,b,f,k,m){return l("dijit.ProgressBar",[f,k],{progress:"0",value:"",maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:m,_indeterminateHighContrastImagePath:h.toUrl("./themes/a11y/indeterminate_progress.gif"),
postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update()},_setDirAttr:function(b){var d="rtl"==b.toLowerCase();a.toggle(this.domNode,"dijitProgressBarRtl",d);a.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&
d);this.inherited(arguments)},update:function(b){d.mixin(this,b||{});b=this.internalProgress;var e=this.domNode,c=1;this.indeterminate?e.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(c=Math.min(parseFloat(this.progress)/100,1),this.progress=c*this.maximum):(this.progress=Math.min(this.progress,this.maximum),c=this.maximum?this.progress/this.maximum:0),e.setAttribute("aria-valuenow",this.progress));e.setAttribute("aria-labelledby",this.labelNode.id);e.setAttribute("aria-valuemin",
0);e.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(c);a.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);a.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());b.style.width=100*c+"%";this.onChange()},_setValueAttr:function(a){this._set("value",a);Infinity==a?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:a})},_setLabelAttr:function(a){this._set("label",a);this.update()},_setIndeterminateAttr:function(a){this._set("indeterminate",
a);this.update()},report:function(a){return this.label?this.label:this.indeterminate?"\x26#160;":b.format(a,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"esri/dijit/editing/Util":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../../kernel"],function(h,l,a,d){var b={};return b={findFeatures:function(a,b,d){var g=b.objectIdField;b=l.filter(b.graphics,function(b){return l.some(a,function(a){return b.attributes[g]===a.objectId})});return d?void d(b):
b},getSelection:function(a){var b=[];return l.forEach(a,function(a){a=a.getSelectedFeatures();l.forEach(a,function(a){b.push(a)})}),b}},a("extend-esri")&&h.setObject("dijit.editing.Util.LayerHelper",b,d),b})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(h,l,a){return h("dijit.form.DateTextBox",a,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:l,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t){var w=d("dijit.Calendar",[q,r,u],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){m.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new w._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:e.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(c(this.domNode,"keydown",e.hitch(this,"_onKeyDown")),c(this.dateRowsNode,"mouseover",e.hitch(this,"_onDayMouseOver")),c(this.dateRowsNode,"mouseout",e.hitch(this,"_onDayMouseOut")),c(this.dateRowsNode,"mousedown",e.hitch(this,"_onDayMouseDown")),c(this.dateRowsNode,"mouseup",e.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=
new this.dateClassObj(this.currentFocus);b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var c=this.currentFocus.getDate();b.setDate(Math.min(c,a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){(a=f.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!f.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode)&&(f.add(a,"dijitCalendarHoveredDate"),this._currentNode=a)},_onDayMouseOut:function(a){!this._currentNode||
a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode||(a="dijitCalendarHoveredDate",f.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),f.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&!f.contains(a,"dijitCalendarDisabledDate")&&(f.add(a,"dijitCalendarActiveDate"),this._currentNode=a)},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&f.remove(a,"dijitCalendarActiveDate")},
handleKey:function(a){var b=-1,c,d=this.currentFocus;switch(a.keyCode){case g.RIGHT_ARROW:b=1;case g.LEFT_ARROW:c="day";this.isLeftToRight()||(b*=-1);break;case g.DOWN_ARROW:b=1;case g.UP_ARROW:c="week";break;case g.PAGE_DOWN:b=1;case g.PAGE_UP:c=a.ctrlKey||a.altKey?"year":"month";break;case g.END:d=this.dateModule.add(d,"month",1),c="day";case g.HOME:d=new this.dateClassObj(d);d.setDate(1);break;default:return!0}c&&(d=this.dateModule.add(d,c,b));this._setCurrentFocusAttr(d);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});w._MonthDropDownButton=d("dijit.Calendar._MonthDropDownButton",t,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new w._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.dropDown.set("months",
b);this.containerNode.innerHTML=(6==n("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});w._MonthDropDown=d("dijit.Calendar._MonthDropDown",[r,v,u],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";h.forEach(a,function(a,b){k.create("div",{className:"dijitCalendarMonthLabel",month:b,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(b.get(a.target,"month"))},onChange:function(){}});return w})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u){var v=l("dijit.CalendarLite",[q,r],{templateString:u,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",dayOffset:-1,currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=
new this.dateClassObj(a);b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=f.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){if(a||
0===a)a=new this.dateClassObj(a),a.setHours(1,0,0,0);return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var b=new this.dateClassObj(this.currentFocus);b.setDate(1);var b=this._patchDate(b),c=b.getDay(),d=this.dateModule.getDaysInMonth(b),e=this.dateModule.getDaysInMonth(this.dateModule.add(b,"month",-1)),f=new this.dateClassObj,g=0<=this.dayOffset?this.dayOffset:a.getFirstDayOfWeek(this.lang);g>
c&&(g-=7);if(!this.summary){var k=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,b);this.gridNode.setAttribute("summary",k[b.getMonth()])}this._date2cell={};h.forEach(this.dateCells,function(a,k){var h=k+g,m=new this.dateClassObj(b),n="dijitCalendar",l=0;h<c?(h=e-c+h+1,l=-1,n+="Previous"):h>=c+d?(h=h-c-d+1,l=1,n+="Next"):(h=h-c+1,n+="Current");l&&(m=this.dateModule.add(m,"month",l));m.setDate(h);this.dateModule.compare(m,f,"date")||(n="dijitCalendarCurrentDate "+n);this.isDisabledDate(m,
this.lang)?(n="dijitCalendarDisabledDate "+n,a.setAttribute("aria-disabled","true")):(n="dijitCalendarEnabledDate "+n,a.removeAttribute("aria-disabled"),a.setAttribute("aria-selected","false"));(l=this.getClassForDate(m,this.lang))&&(n=l+" "+n);a.className=n+"Month dijitCalendarDateTemplate";n=m.valueOf();this._date2cell[n]=a;a.dijitDateValue=n;this._setText(this.dateLabels[k],m.getDateLocalized?m.getDateLocalized(this.lang):m.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);
a.setDate(1);this.monthWidget.set("month",a);var b=a.getFullYear()-1,c=new this.dateClassObj;h.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?g.getObject(a.datePackage,!1):d;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?
g.getObject(a.datePackage+".locale",!1):b},_createMonthWidget:function(){return v._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var b=this.dowTemplateString,c=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),d=0<=this.dayOffset?this.dayOffset:a.getFirstDayOfWeek(this.lang);this.dayCellsHtml=n.substitute([b,b,b,b,b,b,b].join(""),{d:""},function(){return c[d++%7]});b=n.substitute(this.weekTemplateString,
{d:this.dateTemplateString});this.dateRowsHtml=[b,b,b,b,b,b].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);k.setSelectable(this.domNode,!1);b=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",b,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=g.hitch(this,function(a,b,c){this[a].dojoClick=!0;return e(this[a],"click",g.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,
b,c))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,b){var d=this.currentFocus,e=this._getNodeByDate(d);a=this._patchDate(a);this._set("currentFocus",a);this._date2cell&&0==this.dateModule.difference(d,a,"month")||(this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]));d=this._getNodeByDate(a);d.setAttribute("tabIndex",this.tabIndex);(this.focused||
b)&&d.focus();e&&e!=d&&(c("webkit")?e.setAttribute("tabIndex","-1"):e.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue&&0!==a.dijitDateValue;a=a.parentNode);a&&!m.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function b(a,
c){m.toggle(c,"dijitCalendarSelectedDate",a);c.setAttribute("aria-selected",a?"true":"false")}h.forEach(this._selectedCells||[],g.partial(b,!1));this._selectedCells=h.filter(h.map(a,this._getNodeByDate,this),function(a){return a});h.forEach(this._selectedCells,g.partial(b,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});v._MonthWidget=l("dijit.CalendarLite._MonthWidget",q,{_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",
this.lang,a),d=6==c("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+h.map(b,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=d+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});return v})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(h,l,a,d,b,f,k,m){new Date("X");return d("dijit.form._DateTimeTextBox",[f,k],{templateString:m,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:l.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(a,b){var c=this._isInvalidDate(a),d=this._isInvalidDate(b);if(c||d)return c&&d?0:c?-1:1;var c=this.format(a,this._unboundedConstraints),d=this.format(b,this._unboundedConstraints),
f=this.parse(c,this._unboundedConstraints),k=this.parse(d,this._unboundedConstraints);return c==d?0:h.compare(f,k,this._selector)},autoWidth:!0,format:function(a,b){return a?this.dateLocaleModule.format(a,b):""},parse:function(a,b){return this.dateLocaleModule.parse(a,b)||(this._isEmpty(a)?null:void 0)},serialize:function(b,d){b.toGregorian&&(b=b.toGregorian());return a.toISOString(b,d)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(a){a=
a||{};this.dateModule=a.datePackage?b.getObject(a.datePackage,!1):h;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=a.datePackage?b.getObject(a.datePackage+".locale",!1):l;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||
(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(d){d.selector=this._selector;d.fullYear=!0;var e=a.fromISOString;"string"==typeof d.min&&(d.min=e(d.min),this.dateClassObj instanceof Date||(d.min=new this.dateClassObj(d.min)));"string"==typeof d.max&&(d.max=e(d.max),this.dateClassObj instanceof Date||(d.max=new this.dateClassObj(d.max)));this.inherited(arguments);this._unboundedConstraints=b.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(a){return!a||
isNaN(a)||"object"!=typeof a||a.toString()==this._invalidDate},_setValueAttr:function(b,d,c){void 0!==b&&("string"==typeof b&&(b=a.fromISOString(b)),this._isInvalidDate(b)&&(b=null),b instanceof Date&&!(this.dateClassObj instanceof Date)&&(b=new this.dateClassObj(b)));this.inherited(arguments,[b,d,c]);this.value instanceof Date&&(this.filterString="");!1!==d&&this.dropDown&&this.dropDown.set("value",b,!1)},_set:function(a,b){if("value"==a){b instanceof Date&&!(this.dateClassObj instanceof Date)&&
(b=new this.dateClassObj(b));var c=this._get("value");if(c instanceof this.dateClassObj&&0==this.compare(b,c))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(a){this._isInvalidDate(a)&&(a=new this.dateClassObj);this._set("dropDownDefaultValue",a)},openDropDown:function(a){this.dropDown&&this.dropDown.destroy();var d=b.isString(this.popupClass)?b.getObject(this.popupClass,!1):this.popupClass,c=this,f=this.get("value");this.dropDown=new d({onChange:function(a){c.set("value",
a,!0)},id:this.id+"_popup",dir:c.dir,lang:c.lang,value:f,textDir:c.textDir,currentFocus:this._isInvalidDate(f)?this.dropDownDefaultValue:f,constraints:c.constraints,filterString:c.filterString,datePackage:c.datePackage,isDisabledDate:function(a){return!c.rangeCheck(a,c.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(a,b){this._setValueAttr(this.parse(a,this.constraints),b,a)}})})},"dijit/form/RangeBoundTextBox":function(){define(["dojo/_base/declare",
"dojo/i18n","./MappedTextBox","dojo/i18n!./nls/validate"],function(h,l,a){return h("dijit.form.RangeBoundTextBox",a,{rangeMessage:"",rangeCheck:function(a,b){return("min"in b?0<=this.compare(a,b.min):!0)&&("max"in b?0>=this.compare(a,b.max):!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var a=this.get("value");if(null==a)return!1;var b=!1;"min"in this.constraints&&(b=this.constraints.min,b=0>this.compare(a,"number"==typeof b&&
0<=b&&0!=a?0:b));!b&&"max"in this.constraints&&(b=this.constraints.max,b=0<this.compare(a,"number"!=typeof b||0<b?b:0));return b},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(a){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(a))},getErrorMessage:function(a){var b=this.get("value");return null==b||""===b||"number"==typeof b&&isNaN(b)||this.isInRange(a)?this.inherited(arguments):this.rangeMessage},
postMixInProperties:function(){this.inherited(arguments);this.rangeMessage||(this.messages=l.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}})})},"dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(h,l,a,d){return h("dijit.form.MappedTextBox",d,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(a){return a.toString?
a.toString():""},toString:function(){var a=this.filter(this.get("value"));return null!=a?"string"==typeof a?a:this.serialize(a,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.valueNode=a.place("\x3cinput type\x3d'hidden'"+(this.name&&!l("msapp")?' name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"")+"/\x3e",this.textbox,"after")},reset:function(){this.valueNode.value="";this.inherited(arguments)}})})},
"dijit/form/NumberTextBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "),function(h,l,a,d,b,f){var k=function(b){b=b||{};var d=a.getLocalization("dojo.cldr","number",a.normalizeLocale(b.locale)),c=b.pattern?b.pattern:d[(b.type||"decimal")+"Format"];b="number"==typeof b.places?b.places:"string"===typeof b.places&&0<b.places.length?b.places.replace(/.*,/,""):-1!=c.indexOf(".")?c.split(".")[1].replace(/[^#0]/g,"").length:0;return{sep:d.decimal,
places:b}},m=h("dijit.form.NumberTextBoxMixin",null,{pattern:function(a){return"("+(this.focused&&this.editOptions?this._regExpGenerator(l.delegate(a,this.editOptions))+"|":"")+this._regExpGenerator(a)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:b.format,_regExpGenerator:b.regexp,_decimalInfo:k(),postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},_setConstraintsAttr:function(a){var b="number"==typeof a.places?a.places:0;b&&b++;"number"!=typeof a.max&&
(a.max=9*Math.pow(10,15-b));"number"!=typeof a.min&&(a.min=-9*Math.pow(10,15-b));this.inherited(arguments,[a]);this.focusNode&&this.focusNode.value&&!isNaN(this.value)&&this.set("value",this.value);this._decimalInfo=k(a)},_onFocus:function(){if(!this.disabled&&!this.readOnly){var a=this.get("value");"number"!=typeof a||isNaN(a)||(a=this.format(a,this.constraints),void 0!==a&&(this.textbox.value=a));this.inherited(arguments)}},format:function(a,b){var c=String(a);if("number"!=typeof a)return c;if(isNaN(a))return"";
if(!("rangeCheck"in this&&this.rangeCheck(a,b))&&!1!==b.exponent&&/\de[-+]?\d/i.test(c))return c;this.editOptions&&this.focused&&(b=l.mixin({},b,this.editOptions));return this._formatter(a,b)},_parser:b.parse,parse:function(a,b){var c=l.mixin({},b,this.editOptions&&this.focused?this.editOptions:{});if(this.focused&&null!=c.places){var d=c.places,d="number"===typeof d?d:Number(d.split(",").pop());c.places="0,"+d}c=this._parser(a,c);this.editOptions&&this.focused&&isNaN(c)&&(c=this._parser(a,b));return c},
_getDisplayedValueAttr:function(){var a=this.inherited(arguments);return isNaN(a)?this.textbox.value:a},filter:function(a){if(null==a||"string"==typeof a&&""==a)return NaN;"number"!=typeof a||isNaN(a)||0==a||(a=b.round(a,this._decimalInfo.places));return this.inherited(arguments,[a])},serialize:function(a,b){return"number"!=typeof a||isNaN(a)?"":this.inherited(arguments)},_setBlurValue:function(){var a=l.hitch(l.delegate(this,{focused:!0}),"get")("value");this._setValueAttr(a,!0)},_setValueAttr:function(a,
b,c){if(void 0!==a&&void 0===c)if(c=String(a),"number"==typeof a)if(isNaN(a))c="";else{if("rangeCheck"in this&&this.rangeCheck(a,this.constraints)||!1===this.constraints.exponent||!/\de[-+]?\d/i.test(c))c=void 0}else a?a=void 0:(c="",a=NaN);this.inherited(arguments,[a,b,c])},_getValueAttr:function(){var a=this.inherited(arguments);if(isNaN(a)&&""!==this.textbox.value){if(!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+b._realNumberRegexp(l.delegate(this.constraints))+
"$")).test(this.textbox.value))return a=Number(this.textbox.value),isNaN(a)?void 0:a}else return a},isValid:function(a){if(!this.focused||this._isEmpty(this.textbox.value))return this.inherited(arguments);var b=this.get("value");return!isNaN(b)&&this.rangeCheck(b,this.constraints)?!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1},_isValidSubset:function(){var a="number"==typeof this.constraints.min,b="number"==typeof this.constraints.max,c=this.get("value");
if(isNaN(c)||!a&&!b)return this.inherited(arguments);var f=c|0,k=0>c,h=-1!=this.textbox.value.indexOf(this._decimalInfo.sep),m=(this.maxLength||20)-this.textbox.value.length,l=h?this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g,""):"",f=h?f+"."+l:f+"",m=d.rep("9",m),h=c;k?h=Number(f+m):c=Number(f+m);return!(a&&c<this.constraints.min||b&&h>this.constraints.max)}});h=h("dijit.form.NumberTextBox",[f,m],{baseClass:"dijitTextBox dijitNumberTextBox"});h.Mixin=m;return h})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(h,l,a,d,b){return h("dijit.form.FilteringSelect",[d,b],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(a,b,d,g){b&&b[this.searchAttr]!==this._lastQuery||!b&&a.length&&this.store.getIdentity(a[0])!=this._lastQuery||
(a.length?this.set("item",a[0],g):this.set("value","",g||void 0===g&&!this.focused,this.textbox.value,null))},_openResultList:function(a,b,d){b[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(b,d,h,g){this._onChangeActive||(d=null);if(void 0===g){if(null===b||""===b)if(b="",!l.isString(h)){this._setDisplayedValueAttr(h||"",d);
return}var e=this;this._lastQuery=b;a(this.store.get(b),function(a){e._callbackSetLabel(a?[a]:[],void 0,void 0,d)})}else this.valueNode.value=b,this.inherited(arguments,[b,d,h,g])},_setItemAttr:function(a,b,d){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(a){return a.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(b,d){null==b&&(b="");if(!this._created){if(!("displayedValue"in this.params))return;d=!1}if(this.store){this.closeDropDown();
var h=l.clone(this.query),g=this._getDisplayQueryString(b),e;this.store._oldAPI?e=g:(e=this._patternToRegExp(g),e.toString=function(){return g});this._lastQuery=h[this.searchAttr]=e;this._lastDisplayedValue=this.textbox.value=b;this._set("displayedValue",b);var c=this,n={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};l.mixin(n,this.fetchProperties);this._fetchHandle=this.store.query(h,n);a(this._fetchHandle,function(a){c._fetchHandle=null;c._callbackSetLabel(a||[],h,n,d)},function(a){c._fetchHandle=
null;c._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/ComboBoxMixin":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/kernel dojo/_base/lang dojo/store/util/QueryResults ./_AutoCompleterMixin ./_ComboBoxMenu ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(h,l,a,d,b,f,k,m,g){return h("dijit.form.ComboBoxMixin",[m,f],{dropDownClass:k,hasDownArrow:!0,
templateString:g,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_setHasDownArrowAttr:function(a){this._set("hasDownArrow",a);this._buttonNode.style.display=a?"":"none"},_showResultList:function(){this.displayMessage("");this.inherited(arguments)},_setStoreAttr:function(a){a.get||d.mixin(a,{_oldAPI:!0,get:function(a){var b=new l;this.fetchItemByIdentity({identity:a,onItem:function(a){b.resolve(a)},onError:function(a){b.reject(a)}});return b.promise},query:function(a,
e){var f=new l(function(){g.abort&&g.abort()});f.total=new l;var g=this.fetch(d.mixin({query:a,onBegin:function(a){f.total.resolve(a)},onComplete:function(a){f.resolve(a)},onError:function(a){f.reject(a)}},e));return b(f)}});this._set("store",a)},postMixInProperties:function(){var b=this.params.store||this.store;b&&this._setStoreAttr(b);this.inherited(arguments);if(!this.params.store&&this.store&&!this.store._oldAPI){var c=this.declaredClass;d.mixin(this.store,{getValue:function(b,d){a.deprecated(c+
".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return b[d]},getLabel:function(b){a.deprecated(c+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return b.name},fetch:function(b){a.deprecated(c+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");require(["dojo/data/ObjectStore"],d.hitch(this,function(a){(new a({objectStore:this})).fetch(b)}))}})}},buildRendering:function(){this.inherited(arguments);
this.focusNode.setAttribute("aria-autocomplete",this.autoComplete?"both":"list")}})})},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../when"],function(h,l,a){var d=function(b){function f(f){b[f]=function(){var g=arguments,e=a(b,function(a){Array.prototype.unshift.call(g,a);return d(h[f].apply(h,g))});if("forEach"!==f||k)return e}}if(!b)return b;var k=!!b.then;k&&(b=l.delegate(b));f("forEach");f("filter");f("map");null==b.total&&(b.total=a(b,function(a){return a.length}));
return b};l.setObject("dojo.store.util.QueryResults",d);return d})},"dijit/form/_AutoCompleterMixin":function(){define("dojo/aspect dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/query dojo/regexp dojo/sniff ./DataList ./_TextBoxMixin ./_SearchMixin".split(" "),function(h,l,a,d,b,f,k,m,g,e,c){l=l("dijit.form._AutoCompleterMixin",c,{item:null,autoComplete:!0,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:!1,_getCaretPos:function(a){var b=0;if("number"==
typeof a.selectionStart)b=a.selectionStart;else if(m("ie")){var c=a.ownerDocument.selection.createRange().duplicate();a=a.createTextRange();c.move("character",0);a.move("character",0);try{a.setEndPoint("EndToEnd",c),b=String(a.text).replace(/\r/g,"").length}catch(d){}}return b},_setCaretPos:function(a,b){b=parseInt(b);e.selectInputText(a,b,b)},_setDisabledAttr:function(a){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",a?"true":"false")},_onKey:function(a){if(!(32<=a.charCode)){var b=
a.charCode||a.keyCode;if(b!=d.ALT&&b!=d.CTRL&&b!=d.META&&b!=d.SHIFT){var c=this.dropDown,e=null;this._abortQuery();this.inherited(arguments);if(!(a.altKey||a.ctrlKey||a.metaKey))switch(this._opened&&(e=c.getHighlightedOption()),b){case d.PAGE_DOWN:case d.DOWN_ARROW:case d.PAGE_UP:case d.UP_ARROW:this._opened&&this._announceOption(e);a.stopPropagation();a.preventDefault();break;case d.ENTER:if(e){if(e==c.nextButton){this._nextSearch(1);a.stopPropagation();a.preventDefault();break}else if(e==c.previousButton){this._nextSearch(-1);
a.stopPropagation();a.preventDefault();break}a.stopPropagation();a.preventDefault()}else this._setBlurValue(),this._setCaretPos(this.focusNode,this.focusNode.value.length);case d.TAB:b=this.get("displayedValue");if(c&&(b==c._messages.previousMessage||b==c._messages.nextMessage))break;e&&this._selectOption(e);case d.ESCAPE:this._opened&&(this._lastQuery=null,this.closeDropDown())}}}},_autoCompleteText:function(a){var b=this.focusNode;e.selectInputText(b,b.value.length);var c=this.ignoreCase?"toLowerCase":
"substr";0==a[c](0).indexOf(this.focusNode.value[c](0))?(c=this.autoComplete?this._getCaretPos(b):b.value.length,c+1>b.value.length&&(b.value=a,e.selectInputText(b,c))):(b.value=a,e.selectInputText(b))},_openResultList:function(a,c,d){var e=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();a.length||0!=d.start?(this._nextSearch=this.dropDown.onPage=b.hitch(this,function(b){a.nextPage(-1!==b);this.focus()}),this.dropDown.createOptions(a,d,b.hitch(this,"_getMenuLabelFromItem")),this._showResultList(),
"direction"in d?(d.direction?this.dropDown.highlightFirstOption():d.direction||this.dropDown.highlightLastOption(),e&&this._announceOption(this.dropDown.getHighlightedOption())):!this.autoComplete||this._prev_key_backspace||/^[*]+$/.test(c[this.searchAttr].toString())||this._announceOption(this.dropDown.containerNode.firstChild.nextSibling)):this.closeDropDown()},_showResultList:function(){this.closeDropDown(!0);this.openDropDown();this.domNode.setAttribute("aria-expanded","true")},loadDropDown:function(){this._startSearchAll()},
isLoaded:function(){return!1},closeDropDown:function(){this._abortQuery();this._opened&&(this.inherited(arguments),this.domNode.setAttribute("aria-expanded","false"))},_setBlurValue:function(){var a=this.get("displayedValue"),b=this.dropDown;!b||a!=b._messages.previousMessage&&a!=b._messages.nextMessage?"undefined"==typeof this.item?(this.item=null,this.set("displayedValue",a)):(this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0),this._refreshState()):this._setValueAttr(this._lastValueReported,
!0);this.focusNode.removeAttribute("aria-activedescendant")},_setItemAttr:function(a,b,c){var d="";a&&(c||(c=this.store._oldAPI?this.store.getValue(a,this.searchAttr):a[this.searchAttr]),d=this._getValueField()!=this.searchAttr?this.store.getIdentity(a):c);this.set("value",d,b,c,a)},_announceOption:function(b){if(b){var c;if(b==this.dropDown.nextButton||b==this.dropDown.previousButton)c=b.innerHTML,this.item=void 0,this.value="";else{var d=this.dropDown.items[b.getAttribute("item")];c=(this.store._oldAPI?
this.store.getValue(d,this.searchAttr):d[this.searchAttr]).toString();this.set("item",d,!1,c)}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",a.get(b,"id"));this._autoCompleteText(c)}},_selectOption:function(a){this.closeDropDown();a&&this._announceOption(a);this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,!0);this.focusNode.removeAttribute("aria-activedescendant")},_startSearchAll:function(){this._startSearch("")},
_startSearchFromInput:function(){this.item=void 0;this.inherited(arguments)},_startSearch:function(a){if(!this.dropDown){var c=this.id+"_popup";this.dropDown=new (b.isString(this.dropDownClass)?b.getObject(this.dropDownClass,!1):this.dropDownClass)({onChange:b.hitch(this,this._selectOption),id:c,dir:this.dir,textDir:this.textDir})}this._lastInput=a;this.inherited(arguments)},_getValueField:function(){return this.searchAttr},postMixInProperties:function(){this.inherited(arguments);if(!this.store&&
this.srcNodeRef&&(this.store=new g({},this.srcNodeRef),!("value"in this.params))){var a=this.item=this.store.fetchSelectedItem();if(a){var b=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(a,b):a[b]}}},postCreate:function(){var a=f('label[for\x3d"'+this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.domNode.setAttribute("aria-labelledby",a[0].id));this.inherited(arguments);h.after(this,"onSearch",b.hitch(this,"_openResultList"),!0)},_getMenuLabelFromItem:function(a){a=
this.labelFunc(a,this.store);var b=this.labelType;"none"!=this.highlightMatch&&"text"==this.labelType&&this._lastInput&&(a=this.doHighlight(a,this._lastInput),b="html");return{html:"html"==b,label:a}},doHighlight:function(a,b){var c=(this.ignoreCase?"i":"")+("all"==this.highlightMatch?"g":""),d=this.queryExpr.indexOf("${0}");b=k.escapeString(b);return this._escapeHtml(a.replace(new RegExp((0==d?"^":"")+"("+b+")"+(d==this.queryExpr.length-4?"$":""),c),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,
'\x3cspan class\x3d"dijitComboBoxHighlightMatch"\x3e$1\x3c/span\x3e')},_escapeHtml:function(a){return a=String(a).replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;")},reset:function(){this.item=null;this.inherited(arguments)},labelFunc:function(a,b){return(b._oldAPI?b.getValue(a,this.labelAttr||this.searchAttr):a[this.labelAttr||this.searchAttr]).toString()},_setValueAttr:function(a,b,c,d){this._set("item",d||null);null==a&&(a="");this.inherited(arguments)}});
m("dojo-bidi")&&l.extend({_setTextDirAttr:function(a){this.inherited(arguments);this.dropDown&&this.dropDown._set("textDir",a)}});return l})},"dijit/form/DataList":function(){define("dojo/_base/declare dojo/dom dojo/_base/lang dojo/query dojo/store/Memory ../registry".split(" "),function(h,l,a,d,b,f){function k(b){return{id:b.value,value:b.value,name:a.trim(b.innerText||b.textContent||"")}}return h("dijit.form.DataList",b,{constructor:function(b,g){this.domNode=l.byId(g);a.mixin(this,b);this.id&&
f.add(this);this.domNode.style.display="none";this.inherited(arguments,[{data:d("option",this.domNode).map(k)}])},destroy:function(){f.remove(this.id)},fetchSelectedItem:function(){var a=d("\x3e option[selected]",this.domNode)[0]||d("\x3e option",this.domNode)[0];return a&&k(a)}})})},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(h,l,a){return h("dojo.store.Memory",null,{constructor:function(a){for(var b in a)this[b]=a[b];this.setData(this.data||
[])},data:null,idProperty:"id",index:null,queryEngine:a,get:function(a){return this.data[this.index[a]]},getIdentity:function(a){return a[this.idProperty]},put:function(a,b){var f=this.data,k=this.index,h=this.idProperty,h=a[h]=b&&"id"in b?b.id:h in a?a[h]:Math.random();if(h in k){if(b&&!1===b.overwrite)throw Error("Object already exists");f[k[h]]=a}else k[h]=f.push(a)-1;return h},add:function(a,b){(b=b||{}).overwrite=!1;return this.put(a,b)},remove:function(a){var b=this.index,f=this.data;if(a in
b)return f.splice(b[a],1),this.setData(f),!0},query:function(a,b){return l(this.queryEngine(a,b)(this.data))},setData:function(a){a.items?(this.idProperty=a.identifier||this.idProperty,a=this.data=a.items):this.data=a;this.index={};for(var b=0,f=a.length;b<f;b++)this.index[a[b][this.idProperty]]=b}})})},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(h){return function(l,a){function d(b){b=h.filter(b,l);var d=a&&a.sort;d&&b.sort("function"==typeof d?d:function(a,
b){for(var c,f=0;c=d[f];f++){var h=a[c.attribute],m=b[c.attribute],h=null!=h?h.valueOf():h,m=null!=m?m.valueOf():m;if(h!=m)return!!c.descending==(null==h||h>m)?-1:1}return 0});if(a&&(a.start||a.count)){var m=b.length;b=b.slice(a.start||0,(a.start||0)+(a.count||Infinity));b.total=m}return b}switch(typeof l){default:throw Error("Can not query with a "+typeof l);case "object":case "undefined":var b=l;l=function(a){for(var d in b){var h=b[d];if(h&&h.test){if(!h.test(a[d],a))return!1}else if(h!=a[d])return!1}return!0};
break;case "string":if(!this[l])throw Error("No filter function "+l+" was found in store");l=this[l];case "function":}d.matches=l;return d}})},"dijit/form/_SearchMixin":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/query dojo/string dojo/when ../registry".split(" "),function(h,l,a,d,b,f,k){return h("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},list:"",_setListAttr:function(a){this._set("list",a)},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",
ignoreCase:!0,_patternToRegExp:function(a){return new RegExp("^"+a.replace(/(\\.)|(\*)|(\?)|\W/g,function(a,b,c,d){return c?".*":d?".":b?b:"\\"+a})+"$",this.ignoreCase?"mi":"m")},_abortQuery:function(){this.searchTimer&&(this.searchTimer=this.searchTimer.remove());this._queryDeferHandle&&(this._queryDeferHandle=this._queryDeferHandle.remove());this._fetchHandle&&(this._fetchHandle.abort&&(this._cancelingQuery=!0,this._fetchHandle.abort(),this._cancelingQuery=!1),this._fetchHandle.cancel&&(this._cancelingQuery=
!0,this._fetchHandle.cancel(),this._cancelingQuery=!1),this._fetchHandle=null)},_processInput:function(a){if(!this.disabled&&!this.readOnly){a=a.charOrCode;var b=!1;this._prev_key_backspace=!1;switch(a){case l.DELETE:case l.BACKSPACE:b=this._maskValidSubsetError=this._prev_key_backspace=!0;break;default:b="string"==typeof a||229==a}if(b)if(this.store)this.searchTimer=this.defer("_startSearchFromInput",1);else this.onSearch()}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value)},
_startSearch:function(d){this._abortQuery();var g=this,e=a.clone(this.query),c={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:!0}},k=b.substitute(this.queryExpr,[d.replace(/([\\\*\?])/g,"\\$1")]),h,l=function(){var a=g._fetchHandle=g.store.query(e,c);g.disabled||g.readOnly||h!==g._lastQuery||f(a,function(b){g._fetchHandle=null;g.disabled||g.readOnly||h!==g._lastQuery||f(a.total,function(a){b.total=a;var d=g.pageSize;if(isNaN(d)||d>b.total)d=b.total;b.nextPage=function(a){c.direction=
a=!1!==a;c.count=d;a?(c.start+=b.length,c.start>=b.total&&(c.count=0)):(c.start-=d,0>c.start&&(c.count=Math.max(d+c.start,0),c.start=0));0>=c.count?(b.length=0,g.onSearch(b,e,c)):l()};g.onSearch(b,e,c)})},function(a){g._fetchHandle=null;g._cancelingQuery||console.error(g.declaredClass+" "+a.toString())})};a.mixin(c,this.fetchProperties);this.store._oldAPI?h=k:(h=this._patternToRegExp(k),h.toString=function(){return k});this._lastQuery=e[this.searchAttr]=h;this._queryDeferHandle=this.defer(l,this.searchDelay)},
constructor:function(){this.query={};this.fetchProperties={}},postMixInProperties:function(){if(!this.store){var a=this.list;a&&(this.store=k.byId(a))}this.inherited(arguments)}})})},"dijit/form/_ComboBoxMenu":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-style dojo/keys ../_WidgetBase ../_TemplatedMixin ./_ComboBoxMenuMixin ./_ListMouseMixin".split(" "),function(h,l,a,d,b,f,k,m){return h("dijit.form._ComboBoxMenu",[b,f,m,k],{templateString:"\x3cdiv class\x3d'dijitReset dijitMenu' data-dojo-attach-point\x3d'containerNode' style\x3d'overflow: auto; overflow-x: hidden;' role\x3d'listbox'\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point\x3d'previousButton' role\x3d'option'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuNextButton' data-dojo-attach-point\x3d'nextButton' role\x3d'option'\x3e\x3c/div\x3e\x3c/div\x3e",
baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);this.isLeftToRight()||(l.add(this.previousButton,"dijitMenuItemRtl"),l.add(this.nextButton,"dijitMenuItemRtl"));this.containerNode.setAttribute("role","listbox")},_createMenuItem:function(){var a=this.ownerDocument.createElement("div");a.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");a.setAttribute("role","option");return a},onHover:function(a){l.add(a,"dijitMenuItemHover")},onUnhover:function(a){l.remove(a,
"dijitMenuItemHover")},onSelect:function(a){l.add(a,"dijitMenuItemSelected")},onDeselect:function(a){l.remove(a,"dijitMenuItemSelected")},_page:function(b){var d=0,c=this.domNode.scrollTop,f=a.get(this.domNode,"height");for(this.getHighlightedOption()||this.selectNextNode();d<f;){var k=this.getHighlightedOption();if(b){if(!k.previousSibling||"none"==k.previousSibling.style.display)break;this.selectPreviousNode()}else{if(!k.nextSibling||"none"==k.nextSibling.style.display)break;this.selectNextNode()}k=
this.domNode.scrollTop;d+=(k-c)*(b?-1:1);c=k}},handleKey:function(a){switch(a.keyCode){case d.DOWN_ARROW:return this.selectNextNode(),!1;case d.PAGE_DOWN:return this._page(!1),!1;case d.UP_ARROW:return this.selectPreviousNode(),!1;case d.PAGE_UP:return this._page(!0),!1;default:return!0}}})})},"dijit/form/_ComboBoxMenuMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/has dojo/i18n dojo/i18n!./nls/ComboBox".split(" "),function(h,l,a,d,b){var f=l("dijit.form._ComboBoxMenuMixin"+
(d("dojo-bidi")?"_NoBidi":""),null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=b.getLocalization("dijit.form","ComboBox",this.lang)},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages.previousMessage;this.nextButton.innerHTML=this._messages.nextMessage},_setValueAttr:function(a){this._set("value",a);this.onChange(a)},onClick:function(a){if(a==this.previousButton)this._setSelectedAttr(null),this.onPage(-1);else if(a==
this.nextButton)this._setSelectedAttr(null),this.onPage(1);else this.onChange(a)},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null)},_createOption:function(a,b){var d=this._createMenuItem(),e=b(a);e.html?d.innerHTML=e.label:d.appendChild(d.ownerDocument.createTextNode(e.label));""==d.innerHTML&&(d.innerHTML="\x26#160;");return d},createOptions:function(b,d,f){this.items=b;this.previousButton.style.display=0==d.start?"none":"";a.set(this.previousButton,"id",this.id+
"_prev");h.forEach(b,function(b,d){var e=this._createOption(b,f);e.setAttribute("item",d);a.set(e,"id",this.id+d);this.nextButton.parentNode.insertBefore(e,this.nextButton)},this);var e=!1;b.total&&!b.total.then&&-1!=b.total?d.start+d.count<b.total?e=!0:d.start+d.count>b.total&&d.count==b.length&&(e=!0):d.count==b.length&&(e=!0);this.nextButton.style.display=e?"":"none";a.set(this.nextButton,"id",this.id+"_next")},clearResultList:function(){for(var a=this.containerNode;2<a.childNodes.length;)a.removeChild(a.childNodes[a.childNodes.length-
2]);this._setSelectedAttr(null)},highlightFirstOption:function(){this.selectFirstNode()},highlightLastOption:function(){this.selectLastNode()},selectFirstNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.previousButton&&this.selectNextNode()},selectLastNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.nextButton&&this.selectPreviousNode()},getHighlightedOption:function(){return this.selected}});d("dojo-bidi")&&(f=l("dijit.form._ComboBoxMenuMixin",
f,{_createOption:function(){var a=this.inherited(arguments);this.applyTextDir(a);return a}}));return f})},"dijit/form/nls/ComboBox":function(){define({root:{previousMessage:"Previous choices",nextMessage:"More choices"},bs:!0,mk:!0,sr:!0,zh:!0,"zh-tw":!0,vi:!0,uk:!0,tr:!0,th:!0,sv:!0,sl:!0,sk:!0,ru:!0,ro:!0,pt:!0,"pt-pt":!0,pl:!0,nl:!0,nb:!0,lv:!0,lt:!0,ko:!0,kk:!0,ja:!0,it:!0,id:!0,hu:!0,hr:!0,he:!0,fr:!0,fi:!0,eu:!0,et:!0,es:!0,el:!0,de:!0,da:!0,cs:!0,ca:!0,bg:!0,az:!0,ar:!0})},"dijit/form/_ListMouseMixin":function(){define(["dojo/_base/declare",
"dojo/on","dojo/touch","./_ListBase"],function(h,l,a,d){return h("dijit.form._ListMouseMixin",d,{postCreate:function(){this.inherited(arguments);this.domNode.dojoClick=!0;this._listConnect("click","_onClick");this._listConnect("mousedown","_onMouseDown");this._listConnect("mouseup","_onMouseUp");this._listConnect("mouseover","_onMouseOver");this._listConnect("mouseout","_onMouseOut")},_onClick:function(a,d){this._setSelectedAttr(d,!1);this._deferredClick&&this._deferredClick.remove();this._deferredClick=
this.defer(function(){this._deferredClick=null;this.onClick(d)})},_onMouseDown:function(a,d){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging=!0;this._setSelectedAttr(d,!1)},_onMouseUp:function(a,d){this._isDragging=!1;var k=this.selected,h=this._hoveredNode;k&&d==k?this.defer(function(){this._onClick(a,k)}):h&&this.defer(function(){this._onClick(a,h)})},_onMouseOut:function(a,d){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=
null);this._isDragging&&(this._cancelDrag=(new Date).getTime()+1E3)},_onMouseOver:function(a,d){this._cancelDrag&&((new Date).getTime()>this._cancelDrag&&(this._isDragging=!1),this._cancelDrag=null);this._hoveredNode=d;this.onHover(d);this._isDragging&&this._setSelectedAttr(d,!1)}})})},"dijit/form/_ListBase":function(){define(["dojo/_base/declare","dojo/on","dojo/window"],function(h,l,a){return h("dijit.form._ListBase",null,{selected:null,_listConnect:function(a,b){var f=this;return f.own(l(f.containerNode,
l.selector(function(a,b,d){return a.parentNode==d},a),function(a){f[b](a,this)}))},selectFirstNode:function(){for(var a=this.containerNode.firstChild;a&&"none"==a.style.display;)a=a.nextSibling;this._setSelectedAttr(a,!0)},selectLastNode:function(){for(var a=this.containerNode.lastChild;a&&"none"==a.style.display;)a=a.previousSibling;this._setSelectedAttr(a,!0)},selectNextNode:function(){var a=this.selected;if(a){for(a=a.nextSibling;a&&"none"==a.style.display;)a=a.nextSibling;a?this._setSelectedAttr(a,
!0):this.selectFirstNode()}else this.selectFirstNode()},selectPreviousNode:function(){var a=this.selected;if(a){for(a=a.previousSibling;a&&"none"==a.style.display;)a=a.previousSibling;a?this._setSelectedAttr(a,!0):this.selectLastNode()}else this.selectLastNode()},_setSelectedAttr:function(d,b){if(this.selected!=d){var f=this.selected;if(f)this.onDeselect(f);d&&(b&&a.scrollIntoView(d),this.onSelect(d));this._set("selected",d)}else if(d)this.onSelect(d)}})})},"dijit/form/NumberSpinner":function(){define(["dojo/_base/declare",
"dojo/keys","./_Spinner","./NumberTextBox"],function(h,l,a,d){return h("dijit.form.NumberSpinner",[a,d.Mixin],{baseClass:"dijitTextBox dijitSpinner dijitNumberTextBox",adjust:function(a,d){var k=this.constraints,h=isNaN(a),g=!isNaN(k.max),e=!isNaN(k.min);h&&0!=d&&(a=0<d?e?k.min:g?k.max:0:g?this.constraints.max:e?k.min:0);var c=a+d;if(h||isNaN(c))return a;g&&c>k.max&&(c=k.max);e&&c<k.min&&(c=k.min);return c},_onKeyDown:function(a){if(!(this.disabled||this.readOnly||a.keyCode!=l.HOME&&a.keyCode!=l.END||
a.ctrlKey||a.altKey||a.metaKey||"undefined"==typeof this.get("value"))){var d=this.constraints[a.keyCode==l.HOME?"min":"max"];"number"==typeof d&&this._setValueAttr(d,!1);a.stopPropagation();a.preventDefault()}}})})},"dijit/form/_Spinner":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/sniff dojo/mouse dojo/on ../typematic ./RangeBoundTextBox dojo/text!./templates/Spinner.html ./_TextBoxMixin".split(" "),function(h,l,a,d,b,f,k,m,g,e){return h("dijit.form._Spinner",m,{defaultTimeout:500,
minimumTimeout:10,timeoutChangeRate:.9,smallDelta:1,largeDelta:10,templateString:g,baseClass:"dijitTextBox dijitSpinner",cssStateNodes:{upArrowNode:"dijitUpArrowButton",downArrowNode:"dijitDownArrowButton"},adjust:function(a){return a},_arrowPressed:function(a,b,d){this.disabled||this.readOnly||(this._setValueAttr(this.adjust(this.get("value"),b*d),!1),e.selectInputText(this.textbox,this.textbox.value.length))},_arrowReleased:function(){this._wheelTimer=null},_typematicCallback:function(a,b,d){var e=
this.smallDelta;b==this.textbox&&(b=d.keyCode,e=b==l.PAGE_UP||b==l.PAGE_DOWN?this.largeDelta:this.smallDelta,b=b==l.UP_ARROW||b==l.PAGE_UP?this.upArrowNode:this.downArrowNode);-1==a?this._arrowReleased(b):this._arrowPressed(b,b==this.upArrowNode?1:-1,e)},_wheelTimer:null,_mouseWheeled:function(a){if(this.focused){a.stopPropagation();a.preventDefault();var b=a.wheelDelta/120;Math.floor(b)!=b&&(b=0<a.wheelDelta?1:-1);a=a.detail?-1*a.detail:b;if(0!==a){var d=this[0<a?"upArrowNode":"downArrowNode"];this._arrowPressed(d,
a,this.smallDelta);this._wheelTimer&&this._wheelTimer.remove();this._wheelTimer=this.defer(function(){this._arrowReleased(d)},50)}}},_setConstraintsAttr:function(a){this.inherited(arguments);this.focusNode&&(void 0!==this.constraints.min?this.focusNode.setAttribute("aria-valuemin",this.constraints.min):this.focusNode.removeAttribute("aria-valuemin"),void 0!==this.constraints.max?this.focusNode.setAttribute("aria-valuemax",this.constraints.max):this.focusNode.removeAttribute("aria-valuemax"))},_setValueAttr:function(a,
b){this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(f(this.domNode,b.wheel,a.hitch(this,"_mouseWheeled")),k.addListener(this.upArrowNode,this.textbox,{keyCode:l.UP_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),k.addListener(this.downArrowNode,this.textbox,{keyCode:l.DOWN_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,
"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),k.addListener(this.upArrowNode,this.textbox,{keyCode:l.PAGE_UP,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),k.addListener(this.downArrowNode,this.textbox,{keyCode:l.PAGE_DOWN,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout))}})})},"dijit/form/SimpleTextarea":function(){define(["dojo/_base/declare",
"dojo/dom-class","dojo/sniff","./TextBox"],function(h,l,a,d){return h("dijit.form.SimpleTextarea",d,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"\x3ctextarea ${!nameAttrSetting} data-dojo-attach-point\x3d'focusNode,containerNode,textbox' autocomplete\x3d'off'\x3e\x3c/textarea\x3e",postMixInProperties:function(){!this.value&&this.srcNodeRef&&(this.value=this.srcNodeRef.value);this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);a("ie")&&this.cols&&
l.add(this.textbox,"dijitTextAreaCols")},filter:function(a){a&&(a=a.replace(/\r/g,""));return this.inherited(arguments)},_onInput:function(b){if(this.maxLength){var d=parseInt(this.maxLength),k=this.textbox.value.replace(/\r/g,""),d=k.length-d;if(0<d){var h=this.textbox;if(h.selectionStart){var g=h.selectionStart,e=0;a("opera")&&(e=(this.textbox.value.substring(0,g).match(/\r/g)||[]).length);this.textbox.value=k.substring(0,g-d-e)+k.substring(g-e);h.setSelectionRange(g-d,g-d)}else this.ownerDocument.selection&&
(h.focus(),k=this.ownerDocument.selection.createRange(),k.moveStart("character",-d),k.text="",k.select())}}this.inherited(arguments)}})})},"dijit/form/TimeTextBox":function(){define(["dojo/_base/declare","dojo/keys","dojo/_base/lang","../_TimePicker","./_DateTimeTextBox"],function(h,l,a,d,b){return h("dijit.form.TimeTextBox",b,{baseClass:"dijitTextBox dijitComboBox dijitTimeTextBox",popupClass:d,_selector:"time",value:new Date(""),maxHeight:-1,openDropDown:function(b){this.inherited(arguments);this.dropDown.on("input",
a.hitch(this,function(){this.set("value",this.dropDown.get("value"),!1)}))},_onInput:function(){this.inherited(arguments);var a=this.get("displayedValue");this.filterString=a&&!this.parse(a,this.constraints)?a.toLowerCase():"";this._opened&&this.closeDropDown();this.openDropDown()}})})},"dijit/_TimePicker":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/sniff dojo/query dojo/mouse dojo/on ./_WidgetBase ./form/_ListMouseMixin".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v){return b("dijit._TimePicker",[u,v],{baseClass:"dijitTimePicker",pickerMin:"T00:00:00",pickerMax:"T23:59:59",clickableIncrement:"T00:15:00",visibleIncrement:"T01:00:00",value:new Date,_visibleIncrement:2,_clickableIncrement:1,_totalIncrements:10,constraints:{},serialize:d.toISOString,buildRendering:function(){this.inherited(arguments);this.timeMenu=this.containerNode=this.domNode},setValue:function(a){m.deprecated("dijit._TimePicker:setValue() is deprecated.  Use set('value', ...) instead.",
"","2.0");this.set("value",a)},_setValueAttr:function(a){this._set("value",a);this._showText()},_setFilterStringAttr:function(a){this._set("filterString",a);this._showText()},isDisabledDate:function(){return!1},_getFilteredNodes:function(a,b,c,d){a=this.ownerDocument.createDocumentFragment();for(b=0;b<this._maxIncrement;b++)(c=this._createOption(b))&&a.appendChild(c);return a},_showText:function(){var a=d.fromISOString;this.domNode.innerHTML="";this._clickableIncrementDate=a(this.clickableIncrement);
this._visibleIncrementDate=a(this.visibleIncrement);var b=function(a){return 3600*a.getHours()+60*a.getMinutes()+a.getSeconds()},c=b(this._clickableIncrementDate),b=b(this._visibleIncrementDate);(this.value||this.currentFocus).getTime();this._refDate=a(this.pickerMin);this._refDate.setFullYear(1970,0,1);this._clickableIncrement=1;this._visibleIncrement=b/c;a=a(this.pickerMax);a.setFullYear(1970,0,1);a=.001*(a.getTime()-this._refDate.getTime());this._maxIncrement=Math.ceil((a+1)/c);c=this._getFilteredNodes();
!c.firstChild&&this.filterString?(this.filterString="",this._showText()):this.domNode.appendChild(c)},constructor:function(){this.constraints={}},postMixInProperties:function(){this.inherited(arguments);this._setConstraintsAttr(this.constraints)},_setConstraintsAttr:function(a){for(var b in{clickableIncrement:1,visibleIncrement:1,pickerMin:1,pickerMax:1})b in a&&(this[b]=a[b]);a.locale||(a.locale=this.lang)},_createOption:function(b){var c=new Date(this._refDate),d=this._clickableIncrementDate;c.setHours(c.getHours()+
d.getHours()*b,c.getMinutes()+d.getMinutes()*b,c.getSeconds()+d.getSeconds()*b);"time"==this.constraints.selector&&c.setFullYear(1970,0,1);var e=a.format(c,this.constraints);if(this.filterString&&0!==e.toLowerCase().indexOf(this.filterString))return null;d=this.ownerDocument.createElement("div");d.className=this.baseClass+"Item";d.date=c;d.idx=b;k.create("div",{"class":this.baseClass+"ItemInner",innerHTML:e},d);e=1>b%this._visibleIncrement&&-1<b%this._visibleIncrement;b=!e&&!(b%this._clickableIncrement);
e?d.className+=" "+this.baseClass+"Marker":b&&(d.className+=" "+this.baseClass+"Tick");this.isDisabledDate(c)&&(d.className+=" "+this.baseClass+"ItemDisabled");this.value&&!l.compare(this.value,c,this.constraints.selector)&&(d.selected=!0,d.className+=" "+this.baseClass+"ItemSelected",this._selectedDiv=d,e?d.className+=" "+this.baseClass+"MarkerSelected":b&&(d.className+=" "+this.baseClass+"TickSelected"),this._highlightOption(d,!0));return d},onOpen:function(){this.inherited(arguments);this.set("selected",
this._selectedDiv)},_onOptionSelected:function(a,b){var c=a.target.date||a.target.parentNode.date;c&&!this.isDisabledDate(c)&&(this._set("value",c),this.emit("input"),b&&(this._highlighted_option=null,this.set("value",c),this.onChange(c)))},onChange:function(){},_highlightOption:function(a,b){if(a){if(b)this._highlighted_option&&this._highlightOption(this._highlighted_option,!1),this._highlighted_option=a;else{if(this._highlighted_option!==a)return;this._highlighted_option=null}f.toggle(a,this.baseClass+
"ItemHover",b);f.contains(a,this.baseClass+"Marker")?f.toggle(a,this.baseClass+"MarkerHover",b):f.toggle(a,this.baseClass+"TickHover",b)}},handleKey:function(a){if(a.keyCode==g.DOWN_ARROW)return this.selectNextNode(),this._onOptionSelected({target:this._highlighted_option},!1),a.stopPropagation(),a.preventDefault(),!1;if(a.keyCode==g.UP_ARROW)return this.selectPreviousNode(),this._onOptionSelected({target:this._highlighted_option},!1),a.stopPropagation(),a.preventDefault(),!1;if(a.keyCode==g.ENTER||
a.keyCode===g.TAB){if(!this._keyboardSelected&&a.keyCode===g.TAB)return!0;this._highlighted_option&&this._onOptionSelected({target:this._highlighted_option},!0);return a.keyCode===g.TAB}},onHover:function(a){this._highlightOption(a,!0)},onUnhover:function(a){this._highlightOption(a,!1)},onSelect:function(a){this._highlightOption(a,!0)},onDeselect:function(a){this._highlightOption(a,!1)},onClick:function(a){this._onOptionSelected({target:a},!0)}})})},"dojo/data/ItemFileReadStore":function(){define("../_base/kernel ../_base/lang ../_base/declare ../_base/array ../_base/xhr ../Evented ./util/filter ./util/simpleFetch ../date/stamp".split(" "),
function(h,l,a,d,b,f,k,m,g){a=a("dojo.data.ItemFileReadStore",[f],{constructor:function(a){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=!1;this.url=this._ccUrl=this._jsonFileUrl=a.url;this._jsonData=a.data;this.data=null;this._datatypeMap=a.typeMap||{};this._datatypeMap.Date||(this._datatypeMap.Date={type:Date,deserialize:function(a){return g.fromISOString(a)}});this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._itemsByIdentity=null;this._storeRefPropName=
"_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=!1;this._queuedFetches=[];void 0!==a.urlPreventCache&&(this.urlPreventCache=a.urlPreventCache?!0:!1);void 0!==a.hierarchical&&(this.hierarchical=a.hierarchical?!0:!1);a.clearOnClose&&(this.clearOnClose=!0);"failOk"in a&&(this.failOk=a.failOk?!0:!1)},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:!1,urlPreventCache:!1,failOk:!1,hierarchical:!0,_assertIsItem:function(a){if(!this.isItem(a))throw Error(this.declaredClass+
": Invalid item argument.");},_assertIsAttribute:function(a){if("string"!==typeof a)throw Error(this.declaredClass+": Invalid attribute argument.");},getValue:function(a,b,d){a=this.getValues(a,b);return 0<a.length?a[0]:d},getValues:function(a,b){this._assertIsItem(a);this._assertIsAttribute(b);return(a[b]||[]).slice(0)},getAttributes:function(a){this._assertIsItem(a);var b=[],d;for(d in a)d!==this._storeRefPropName&&d!==this._itemNumPropName&&d!==this._rootItemPropName&&d!==this._reverseRefMap&&
b.push(d);return b},hasAttribute:function(a,b){this._assertIsItem(a);this._assertIsAttribute(b);return b in a},containsValue:function(a,b,d){var f=void 0;"string"===typeof d&&(f=k.patternToRegExp(d,!1));return this._containsValue(a,b,d,f)},_containsValue:function(a,b,f,g){return d.some(this.getValues(a,b),function(a){if(null!==a&&!l.isObject(a)&&g){if(a.toString().match(g))return!0}else if(f===a)return!0})},isItem:function(a){return a&&a[this._storeRefPropName]===this&&this._arrayOfAllItems[a[this._itemNumPropName]]===
a?!0:!1},isItemLoaded:function(a){return this.isItem(a)},loadItem:function(a){this._assertIsItem(a.item)},getFeatures:function(){return this._features},getLabel:function(a){if(this._labelAttr&&this.isItem(a))return this.getValue(a,this._labelAttr)},getLabelAttributes:function(a){return this._labelAttr?[this._labelAttr]:null},filter:function(a,b,d){var f=[],g,h;if(a.query){var m;g=a.queryOptions?a.queryOptions.ignoreCase:!1;var l={};for(h in a.query)m=a.query[h],"string"===typeof m?l[h]=k.patternToRegExp(m,
g):m instanceof RegExp&&(l[h]=m);for(g=0;g<b.length;++g){var w=!0,x=b[g];if(null===x)w=!1;else for(h in a.query)m=a.query[h],this._containsValue(x,h,m,l[h])||(w=!1);w&&f.push(x)}}else for(g=0;g<b.length;++g)h=b[g],null!==h&&f.push(h);d(f,a)},_fetchItems:function(a,c,d){var f=this;if(this._loadFinished)this.filter(a,this._getItemsArray(a.queryOptions),c);else if(this._jsonFileUrl!==this._ccUrl?(h.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),
this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url),null!=this.data&&(this._jsonData=this.data,this.data=null),this._jsonFileUrl)if(this._loadInProgress)this._queuedFetches.push({args:a,filter:l.hitch(f,"filter"),findCallback:l.hitch(f,c)});else{this._loadInProgress=!0;var g=b.get({url:f._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk});g.addCallback(function(b){try{f._getItemsFromLoadedData(b),
f._loadFinished=!0,f._loadInProgress=!1,f.filter(a,f._getItemsArray(a.queryOptions),c),f._handleQueuedFetches()}catch(g){f._loadFinished=!0,f._loadInProgress=!1,d(g,a)}});g.addErrback(function(b){f._loadInProgress=!1;d(b,a)});var k=null;a.abort&&(k=a.abort);a.abort=function(){g&&-1===g.fired&&g.cancel();k&&k.call(a)}}else if(this._jsonData)try{this._loadFinished=!0,this._getItemsFromLoadedData(this._jsonData),this._jsonData=null,f.filter(a,this._getItemsArray(a.queryOptions),c)}catch(m){d(m,a)}else d(Error(this.declaredClass+
": No JSON source data was provided as either URL or a nested Javascript object."),a)},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var a=0;a<this._queuedFetches.length;a++){var b=this._queuedFetches[a],d=b.args,f=b.filter,b=b.findCallback;f?f(d,this._getItemsArray(d.queryOptions),b):this.fetchItemByIdentity(d)}this._queuedFetches=[]}},_getItemsArray:function(a){return a&&a.deep?this._arrayOfAllItems:this._arrayOfTopLevelItems},close:function(a){this.clearOnClose&&this._loadFinished&&
!this._loadInProgress&&(this._arrayOfAllItems=[],this._arrayOfTopLevelItems=[],this._loadFinished=!1,this._itemsByIdentity=null,this._loadInProgress=!1,this._queuedFetches=[])},_getItemsFromLoadedData:function(a){function b(a){return null!==a&&"object"===typeof a&&(!l.isArray(a)||f)&&!l.isFunction(a)&&(a.constructor==Object||l.isArray(a))&&"undefined"===typeof a._reference&&"undefined"===typeof a._type&&"undefined"===typeof a._value&&g.hierarchical}function d(a){g._arrayOfAllItems.push(a);for(var e in a){var f=
a[e];if(f)if(l.isArray(f))for(var k=0;k<f.length;++k){var h=f[k];b(h)&&d(h)}else b(f)&&d(f)}}var f=!1,g=this;this._labelAttr=a.label;var k,h;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=a.items;for(k=0;k<this._arrayOfTopLevelItems.length;++k)h=this._arrayOfTopLevelItems[k],l.isArray(h)&&(f=!0),d(h),h[this._rootItemPropName]=!0;var m={},w;for(k=0;k<this._arrayOfAllItems.length;++k)for(w in h=this._arrayOfAllItems[k],h){if(w!==this._rootItemPropName){var x=h[w];null!==x?l.isArray(x)||(h[w]=[x]):
h[w]=[null]}m[w]=w}for(;m[this._storeRefPropName];)this._storeRefPropName+="_";for(;m[this._itemNumPropName];)this._itemNumPropName+="_";for(;m[this._reverseRefMap];)this._reverseRefMap+="_";if(m=a.identifier)for(this._itemsByIdentity={},this._features["dojo.data.api.Identity"]=m,k=0;k<this._arrayOfAllItems.length;++k)if(h=this._arrayOfAllItems[k],a=h[m],a=a[0],Object.hasOwnProperty.call(this._itemsByIdentity,a)){if(this._jsonFileUrl)throw Error(this.declaredClass+":  The json data as specified by: ["+
this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+m+"].  Value collided: ["+a+"]");if(this._jsonData)throw Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+m+"].  Value collided: ["+a+"]");}else this._itemsByIdentity[a]=h;else this._features["dojo.data.api.Identity"]=Number;for(k=0;k<this._arrayOfAllItems.length;++k)h=this._arrayOfAllItems[k],h[this._storeRefPropName]=this,h[this._itemNumPropName]=
k;for(k=0;k<this._arrayOfAllItems.length;++k)for(w in h=this._arrayOfAllItems[k],h)for(a=h[w],m=0;m<a.length;++m)if(x=a[m],null!==x&&"object"==typeof x){if("_type"in x&&"_value"in x){var y=x._type,z=this._datatypeMap[y];if(z)if(l.isFunction(z))a[m]=new z(x._value);else if(l.isFunction(z.deserialize))a[m]=z.deserialize(x._value);else throw Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");else throw Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+
y+"'");}if(x._reference){x=x._reference;if(l.isObject(x))for(y=0;y<this._arrayOfAllItems.length;++y){var z=this._arrayOfAllItems[y],A=!0,B;for(B in x)z[B]!=x[B]&&(A=!1);A&&(a[m]=z)}else a[m]=this._getItemByIdentity(x);this.referenceIntegrity&&(x=a[m],this.isItem(x)&&this._addReferenceToMap(x,h,w))}else this.isItem(x)&&this.referenceIntegrity&&this._addReferenceToMap(x,h,w)}},_addReferenceToMap:function(a,b,d){},getIdentity:function(a){var b=this._features["dojo.data.api.Identity"];return b===Number?
a[this._itemNumPropName]:(a=a[b])?a[0]:null},fetchItemByIdentity:function(a){var c,d;if(this._loadFinished)c=this._getItemByIdentity(a.identity),a.onItem&&(d=a.scope?a.scope:h.global,a.onItem.call(d,c));else{var f=this;this._jsonFileUrl!==this._ccUrl?(h.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=
this.url);null!=this.data&&null==this._jsonData&&(this._jsonData=this.data,this.data=null);this._jsonFileUrl?this._loadInProgress?this._queuedFetches.push({args:a}):(this._loadInProgress=!0,d=b.get({url:f._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk}),d.addCallback(function(b){var d=a.scope?a.scope:h.global;try{f._getItemsFromLoadedData(b),f._loadFinished=!0,f._loadInProgress=!1,c=f._getItemByIdentity(a.identity),a.onItem&&a.onItem.call(d,c),f._handleQueuedFetches()}catch(g){f._loadInProgress=
!1,a.onError&&a.onError.call(d,g)}}),d.addErrback(function(b){f._loadInProgress=!1;a.onError&&a.onError.call(a.scope?a.scope:h.global,b)})):this._jsonData&&(f._getItemsFromLoadedData(f._jsonData),f._jsonData=null,f._loadFinished=!0,c=f._getItemByIdentity(a.identity),a.onItem&&(d=a.scope?a.scope:h.global,a.onItem.call(d,c)))}},_getItemByIdentity:function(a){var b=null;this._itemsByIdentity?Object.hasOwnProperty.call(this._itemsByIdentity,a)&&(b=this._itemsByIdentity[a]):Object.hasOwnProperty.call(this._arrayOfAllItems,
a)&&(b=this._arrayOfAllItems[a]);void 0===b&&(b=null);return b},getIdentityAttributes:function(a){a=this._features["dojo.data.api.Identity"];return a===Number?null:[a]},_forceLoad:function(){var a=this;this._jsonFileUrl!==this._ccUrl?(h.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url);null!=
this.data&&(this._jsonData=this.data,this.data=null);if(this._jsonFileUrl){var c=b.get({url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:!0});c.addCallback(function(b){try{if(!0!==a._loadInProgress&&!a._loadFinished)a._getItemsFromLoadedData(b),a._loadFinished=!0;else if(a._loadInProgress)throw Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}catch(c){throw c;}});c.addErrback(function(a){throw a;
})}else this._jsonData&&(a._getItemsFromLoadedData(a._jsonData),a._jsonData=null,a._loadFinished=!0)}});l.extend(a,m);return a})},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(h){var l={};h.setObject("dojo.data.util.filter",l);l.patternToRegExp=function(a,d){for(var b="^",f=null,k=0;k<a.length;k++)switch(f=a.charAt(k),f){case "\\":b+=f;k++;b+=a.charAt(k);break;case "*":b+=".*";break;case "?":b+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":b+=
"\\";default:b+=f}b+="$";return d?new RegExp(b,"mi"):new RegExp(b,"m")};return l})},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(h,l,a){var d={};h.setObject("dojo.data.util.simpleFetch",d);d.errorHandler=function(a,d){d.onError&&d.onError.call(d.scope||l.global,a,d)};d.fetchHandler=function(b,d){var k=d.abort||null,h=!1,g=d.start?d.start:0,e=d.count&&Infinity!==d.count?g+d.count:b.length;d.abort=function(){h=!0;k&&k.call(d)};var c=d.scope||
l.global;d.store||(d.store=this);d.onBegin&&d.onBegin.call(c,b.length,d);d.sort&&b.sort(a.createSortFunction(d.sort,this));if(d.onItem)for(var n=g;n<b.length&&n<e;++n){var q=b[n];h||d.onItem.call(c,q,d)}d.onComplete&&!h&&(n=null,d.onItem||(n=b.slice(g,e)),d.onComplete.call(c,n,d))};d.fetch=function(a){a=a||{};a.store||(a.store=this);this._fetchItems(a,h.hitch(this,"fetchHandler"),h.hitch(this,"errorHandler"));return a};return d})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(h){var l=
{};h.setObject("dojo.data.util.sorter",l);l.basicComparator=function(a,d){var b=-1;null===a&&(a=void 0);null===d&&(d=void 0);if(a==d)b=0;else if(a>d||null==a)b=1;return b};l.createSortFunction=function(a,d){function b(a,b,c,d){return function(e,f){var g=d.getValue(e,a),k=d.getValue(f,a);return b*c(g,k)}}for(var f=[],k,h=d.comparatorMap,g=l.basicComparator,e=0;e<a.length;e++){k=a[e];var c=k.attribute;if(c){k=k.descending?-1:1;var n=g;h&&("string"!==typeof c&&"toString"in c&&(c=c.toString()),n=h[c]||
g);f.push(b(c,k,n,d))}}return function(a,b){for(var c=0;c<f.length;){var d=f[c++](a,b);if(0!==d)return d}return 0}};return l})},"dojox/date/islamic":function(){define(["dojox/main","dojo/_base/lang","dojo/date","./islamic/Date"],function(h,l,a,d){var b=l.getObject("date.islamic",!0,h);b.getDaysInMonth=function(a){return a.getDaysInIslamicMonth(a.getMonth(),a.getFullYear())};b.compare=function(b,k,h){b instanceof d&&(b=b.toGregorian());k instanceof d&&(k=k.toGregorian());return a.compare.apply(null,
arguments)};b.add=function(a,b,h){var g=new d(a);switch(b){case "day":g.setDate(a.getDate()+h);break;case "weekday":var e=a.getDay();if(5>e+h&&0<e+h)g.setDate(a.getDate()+h);else{var c=b=0;5==e?(e=4,c=0<h?-1:1):6==e&&(e=4,c=0<h?-2:2);var e=0<h?5-e-1:-e,n=h-e,l=parseInt(n/5);0!=n%5&&(b=0<h?2:-2);b=b+7*l+n%5+e;g.setDate(a.getDate()+b+c)}break;case "year":g.setFullYear(a.getFullYear()+h);break;case "week":h*=7;g.setDate(a.getDate()+h);break;case "month":a=a.getMonth();g.setMonth(a+h);break;case "hour":g.setHours(a.getHours()+
h);break;case "minute":g._addMinutes(h);break;case "second":g._addSeconds(h);break;case "millisecond":g._addMilliseconds(h)}return g};b.difference=function(a,k,h){k=k||new d;h=h||"day";var g=k.getFullYear()-a.getFullYear(),e=1;switch(h){case "weekday":g=Math.round(b.difference(a,k,"day"));e=parseInt(b.difference(a,k,"week"));h=g%7;if(0==h)g=5*e;else{var c=0,n=a.getDay();k=k.getDay();e=parseInt(g/7);h=g%7;a=new d(a);a.setDate(a.getDate()+7*e);a=a.getDay();if(0<g)switch(!0){case 5==n:c=-1;break;case 6==
n:c=0;break;case 5==k:c=-1;break;case 6==k:c=-2;break;case 5<a+h:c=-2}else if(0>g)switch(!0){case 5==n:c=0;break;case 6==n:c=1;break;case 5==k:c=2;break;case 6==k:c=1;break;case 0>a+h:c=2}g=g+c-2*e}e=g;break;case "year":e=g;break;case "month":h=k.toGregorian()>a.toGregorian()?k:a;c=k.toGregorian()>a.toGregorian()?a:k;e=h.getMonth();n=c.getMonth();if(0==g)e=h.getMonth()-c.getMonth();else for(e=12-n+e,g=c.getFullYear()+1,h=h.getFullYear(),g;g<h;g++)e+=12;k.toGregorian()<a.toGregorian()&&(e=-e);break;
case "week":e=parseInt(b.difference(a,k,"day")/7);break;case "day":e/=24;case "hour":e/=60;case "minute":e/=60;case "second":e/=1E3;case "millisecond":e*=k.toGregorian().getTime()-a.toGregorian().getTime()}return Math.round(e)};return b})},"dojox/main":function(){define(["dojo/_base/kernel"],function(h){return h.dojox})},"dojox/date/islamic/Date":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/date"],function(h,l,a){var d=l("dojox.date.islamic.Date",null,{_date:0,_month:0,_year:0,
_hours:0,_minutes:0,_seconds:0,_milliseconds:0,_day:0,_GREGORIAN_EPOCH:1721425.5,_ISLAMIC_EPOCH:1948439.5,constructor:function(){var a=arguments.length;a?1==a?(a=arguments[0],"number"==typeof a&&(a=new Date(a)),a instanceof Date?this.fromGregorian(a):""==a?this._date=new Date(""):(this._year=a._year,this._month=a._month,this._date=a._date,this._hours=a._hours,this._minutes=a._minutes,this._seconds=a._seconds,this._milliseconds=a._milliseconds)):3<=a&&(this._year+=arguments[0],this._month+=arguments[1],
this._date+=arguments[2],this._hours+=arguments[3]||0,this._minutes+=arguments[4]||0,this._seconds+=arguments[5]||0,this._milliseconds+=arguments[6]||0):this.fromGregorian(new Date)},getDate:function(){return this._date},getMonth:function(){return this._month},getFullYear:function(){return this._year},getDay:function(){return this.toGregorian().getDay()},getHours:function(){return this._hours},getMinutes:function(){return this._minutes},getSeconds:function(){return this._seconds},getMilliseconds:function(){return this._milliseconds},
setDate:function(a){a=parseInt(a);if(!(0<a&&a<=this.getDaysInIslamicMonth(this._month,this._year))){var d;if(0<a)for(d=this.getDaysInIslamicMonth(this._month,this._year);a>d;a-=d,d=this.getDaysInIslamicMonth(this._month,this._year))this._month++,12<=this._month&&(this._year++,this._month-=12);else for(d=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:this._year-1);0>=a;d=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:
this._year-1))this._month--,0>this._month&&(this._year--,this._month+=12),a+=d}this._date=a;return this},setFullYear:function(a){this._year=+a},setMonth:function(a){this._year+=Math.floor(a/12);this._month=0<a?Math.floor(a%12):Math.floor((a%12+12)%12)},setHours:function(){var a=arguments.length,d=0;1<=a&&(d=parseInt(arguments[0]));2<=a&&(this._minutes=parseInt(arguments[1]));3<=a&&(this._seconds=parseInt(arguments[2]));4==a&&(this._milliseconds=parseInt(arguments[3]));for(;24<=d;)this._date++,a=this.getDaysInIslamicMonth(this._month,
this._year),this._date>a&&(this._month++,12<=this._month&&(this._year++,this._month-=12),this._date-=a),d-=24;this._hours=d},_addMinutes:function(a){a+=this._minutes;this.setMinutes(a);this.setHours(this._hours+parseInt(a/60));return this},_addSeconds:function(a){a+=this._seconds;this.setSeconds(a);this._addMinutes(parseInt(a/60));return this},_addMilliseconds:function(a){a+=this._milliseconds;this.setMilliseconds(a);this._addSeconds(parseInt(a/1E3));return this},setMinutes:function(a){this._minutes=
a%60;return this},setSeconds:function(a){this._seconds=a%60;return this},setMilliseconds:function(a){this._milliseconds=a%1E3;return this},toString:function(){if(isNaN(this._date))return"Invalidate Date";var a=new Date;a.setHours(this._hours);a.setMinutes(this._minutes);a.setSeconds(this._seconds);a.setMilliseconds(this._milliseconds);return this._month+" "+this._date+" "+this._year+" "+a.toTimeString()},toGregorian:function(){var b=this._year,b=this._date+Math.ceil(29.5*this._month)+354*(b-1)+Math.floor((3+
11*b)/30)+this._ISLAMIC_EPOCH-1,b=Math.floor(b-.5)+.5,d=b-this._GREGORIAN_EPOCH,k=Math.floor(d/146097),h=this._mod(d,146097),d=Math.floor(h/36524),g=this._mod(h,36524),h=Math.floor(g/1461),g=this._mod(g,1461),g=Math.floor(g/365),k=400*k+100*d+4*h+g;4!=d&&4!=g&&k++;d=b-(this._GREGORIAN_EPOCH+365*(k-1)+Math.floor((k-1)/4)-Math.floor((k-1)/100)+Math.floor((k-1)/400));h=this._GREGORIAN_EPOCH-1+365*(k-1)+Math.floor((k-1)/4)-Math.floor((k-1)/100)+Math.floor((k-1)/400)+Math.floor(739/12+(a.isLeapYear(new Date(k,
3,1))?-1:-2)+1);h=b<h?0:a.isLeapYear(new Date(k,3,1))?1:2;d=Math.floor((12*(d+h)+373)/367);h=this._GREGORIAN_EPOCH-1+365*(k-1)+Math.floor((k-1)/4)-Math.floor((k-1)/100)+Math.floor((k-1)/400)+Math.floor((367*d-362)/12+(2>=d?0:a.isLeapYear(new Date(k,d-1,1))?-1:-2)+1);return new Date(k,d-1,b-h+1,this._hours,this._minutes,this._seconds,this._milliseconds)},fromGregorian:function(b){b=new Date(b);var d=b.getFullYear(),k=b.getMonth(),h=b.getDate(),d=this._GREGORIAN_EPOCH-1+365*(d-1)+Math.floor((d-1)/4)+
-Math.floor((d-1)/100)+Math.floor((d-1)/400)+Math.floor((367*(k+1)-362)/12+(2>=k+1?0:a.isLeapYear(b)?-1:-2)+h),d=Math.floor(d)+.5,d=d-this._ISLAMIC_EPOCH,k=Math.floor((30*d+10646)/10631),h=Math.ceil((d-29-this._yearStart(k))/29.5),h=Math.min(h,11);this._date=Math.ceil(d-this._monthStart(k,h))+1;this._month=h;this._year=k;this._hours=b.getHours();this._minutes=b.getMinutes();this._seconds=b.getSeconds();this._milliseconds=b.getMilliseconds();this._day=b.getDay();return this},valueOf:function(){return this.toGregorian().valueOf()},
_yearStart:function(a){return 354*(a-1)+Math.floor((3+11*a)/30)},_monthStart:function(a,d){return Math.ceil(29.5*d)+354*(a-1)+Math.floor((3+11*a)/30)},_civilLeapYear:function(a){return 11>(14+11*a)%30},getDaysInIslamicMonth:function(a,d){var k=0,k=29+(a+1)%2;11==a&&this._civilLeapYear(d)&&k++;return k},_mod:function(a,d){return a-d*Math.floor(a/d)}});d.getDaysInIslamicMonth=function(a){return(new d).getDaysInIslamicMonth(a.getMonth(),a.getFullYear())};return d})},"dojox/date/islamic/locale":function(){define("dojox/main dojo/_base/lang dojo/_base/array dojo/date dojo/i18n dojo/regexp dojo/string ./Date dojo/i18n!dojo/cldr/nls/islamic".split(" "),
function(h,l,a,d,b,f,k,m,g){function e(a,b,c,e,f){return f.replace(/([a-z])\1*/ig,function(c){var e,g,h=c.charAt(0);c=c.length;var m=["abbr","wide","narrow"];switch(h){case "G":e=b.eraAbbr[0];break;case "y":e=String(a.getFullYear());break;case "M":e=a.getMonth();3>c?(e+=1,g=!0):(h=["months-format",m[c-3]].join("-"),e=b[h][e]);break;case "d":e=a.getDate(!0);g=!0;break;case "E":e=a.getDay();3>c?(e+=1,g=!0):(h=["days-format",m[c-3]].join("-"),e=b[h][e]);break;case "a":e=12>a.getHours()?"am":"pm";e=b["dayPeriods-format-wide-"+
e];break;case "h":case "H":case "K":case "k":g=a.getHours();switch(h){case "h":e=g%12||12;break;case "H":e=g;break;case "K":e=g%12;break;case "k":e=g||24}g=!0;break;case "m":e=a.getMinutes();g=!0;break;case "s":e=a.getSeconds();g=!0;break;case "S":e=Math.round(a.getMilliseconds()*Math.pow(10,c-3));g=!0;break;case "z":if(e=d.getTimezoneName(a.toGregorian()))break;c=4;case "Z":e=a.toGregorian().getTimezoneOffset();e=[0>=e?"+":"-",k.pad(Math.floor(Math.abs(e)/60),2),k.pad(Math.abs(e)%60,2)];4==c&&(e.splice(0,
0,"GMT"),e.splice(3,0,":"));e=e.join("");break;default:throw Error("dojox.date.islamic.locale.formatPattern: invalid pattern char: "+f);}g&&(e=k.pad(e,c));return e})}function c(b,c,d,e){var f=function(a){return a};c=c||f;d=d||f;e=e||f;var g=b.match(/(''|[^'])+/g),k="'"==b.charAt(0);a.forEach(g,function(a,b){a?(g[b]=(k?d:c)(a),k=!k):g[b]=""});return e(g.join(""))}function n(a,c,d,e){e=f.escapeString(e);b.normalizeLocale(d.locale);return e.replace(/([a-z])\1*/ig,function(b){var e;e=b.charAt(0);var f=
b.length,g="";d.strict?1<f&&(g="0{"+(f-1)+"}"):g="0?";switch(e){case "y":e="\\d+";break;case "M":e=2<f?"\\S+ ?\\S+":g+"[1-9]|1[0-2]";break;case "d":e="[12]\\d|"+g+"[1-9]|3[01]";break;case "E":e="\\S+";break;case "h":e=g+"[1-9]|1[0-2]";break;case "k":e=g+"\\d|1[01]";break;case "H":e=g+"\\d|1\\d|2[0-3]";break;case "K":e=g+"[1-9]|1\\d|2[0-4]";break;case "m":case "s":e=g+"\\d|[0-5]\\d";break;case "S":e="\\d{"+f+"}";break;case "a":f=d.am||c["dayPeriods-format-wide-am"];g=d.pm||c["dayPeriods-format-wide-pm"];
d.strict?e=f+"|"+g:(e=f+"|"+g,f!=f.toLowerCase()&&(e+="|"+f.toLowerCase()),g!=g.toLowerCase()&&(e+="|"+g.toLowerCase()));break;default:e=".*"}a&&a.push(b);return"("+e+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var q=l.getObject("date.islamic.locale",!0,h);q.format=function(a,d){d=d||{};var f=b.normalizeLocale(d.locale),g=d.formatLength||"short",k=q._getIslamicBundle(f),h=[],f=l.hitch(this,e,a,k,f,d.fullYear);if("year"==d.selector)return a.getFullYear();if("time"!=d.selector){var m=d.datePattern||k["dateFormat-"+
g];m&&h.push(c(m,f))}"date"!=d.selector&&(g=d.timePattern||k["timeFormat-"+g])&&h.push(c(g,f));return h.join(" ")};q.regexp=function(a){return q._parseInfo(a).regexp};q._parseInfo=function(a){a=a||{};var d=b.normalizeLocale(a.locale),d=q._getIslamicBundle(d),e=a.formatLength||"short",f=a.datePattern||d["dateFormat-"+e],e=a.timePattern||d["timeFormat-"+e],g=[];return{regexp:c("date"==a.selector?f:"time"==a.selector?e:"undefined"==typeof e?f:f+" "+e,l.hitch(this,n,g,d,a)),tokens:g,bundle:d}};q.parse=
function(c,d){c=c.replace(/[\u200E\u200F\u202A\u202E]/g,"");d||(d={});var e=q._parseInfo(d),f=e.tokens,g=e.bundle,e=e.regexp.replace(/[\u200E\u200F\u202A\u202E]/g,""),e=(new RegExp("^"+e+"$")).exec(c);b.normalizeLocale(d.locale);if(!e)return null;var k=[1389,0,1,0,0,0,0],h="",n=["abbr","wide","narrow"];a.every(e,function(b,c){if(!c)return!0;var e=f[c-1],m=e.length;switch(e.charAt(0)){case "y":k[0]=Number(b);break;case "M":if(2<m){if(e=g["months-format-"+n[m-3]].concat(),d.strict||(b=b.replace(".",
"").toLowerCase(),e=a.map(e,function(a){return a?a.replace(".","").toLowerCase():a})),b=a.indexOf(e,b),-1==b)return!1}else b--;k[1]=Number(b);break;case "D":k[1]=0;case "d":k[2]=Number(b);break;case "a":e=d.am||g["dayPeriods-format-wide-am"];m=d.pm||g["dayPeriods-format-wide-pm"];if(!d.strict){var l=/\./g;b=b.replace(l,"").toLowerCase();e=e.replace(l,"").toLowerCase();m=m.replace(l,"").toLowerCase()}if(d.strict&&b!=e&&b!=m)return!1;h=b==m?"p":b==e?"a":"";break;case "K":24==b&&(b=0);case "h":case "H":case "k":k[3]=
Number(b);break;case "m":k[4]=Number(b);break;case "s":k[5]=Number(b);break;case "S":k[6]=Number(b)}return!0});e=+k[3];"p"===h&&12>e?k[3]=e+12:"a"===h&&12==e&&(k[3]=0);return new m(k[0],k[1],k[2],k[3],k[4],k[5],k[6])};var r=[];q.addCustomFormats=function(a,b){r.push({pkg:a,name:b})};q._getIslamicBundle=function(c){var d={};a.forEach(r,function(a){a=b.getLocalization(a.pkg,a.name,c);d=l.mixin(d,a)},this);return d};q.addCustomFormats("dojo.cldr","islamic");q.getNames=function(a,b,c,d,e){var f;d=q._getIslamicBundle(d);
a=[a,c,b];"standAlone"==c&&(c=a.join("-"),f=d[c],1==f[0]&&(f=void 0));a[1]="format";return(f||d[a.join("-")]).concat()};q.weekDays=q.getNames("days","wide","format");q.months=q.getNames("months","wide","format");return q})},"dojo/cldr/nls/islamic":function(){define({root:{"dateFormatItem-Ehm":"E h:mm a","days-standAlone-short":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"months-format-narrow":"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),"field-second-relative+0":"now","quarters-standAlone-narrow":["1","2",
"3","4"],"field-weekday":"Day of the Week","field-wed-relative+0":"this Wednesday","field-wed-relative+1":"next Wednesday","dateFormatItem-GyMMMEd":"G y MMM d, E","dateFormatItem-MMMEd":"MMM d, E",eraNarrow:["AH"],"field-tue-relative+-1":"last Tuesday","days-format-short":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dateTimeFormats-appendItem-Day-Of-Week":"{0} {1}","dateFormat-long":"G y MMMM d","field-fri-relative+-1":"last Friday","field-wed-relative+-1":"last Wednesday","months-format-wide":"Muharram;Safar;Rabi\u02bb I;Rabi\u02bb II;Jumada I;Jumada II;Rajab;Sha\u02bbban;Ramadan;Shawwal;Dhu\u02bbl-Qi\u02bbdah;Dhu\u02bbl-Hijjah".split(";"),
"dateFormatItem-yyyyQQQ":"G y QQQ","dateTimeFormat-medium":"{1} {0}","dayPeriods-format-wide-pm":"PM","dateFormat-full":"G y MMMM d, EEEE","dateFormatItem-yyyyMEd":"GGGGG y-MM-dd, E","field-thu-relative+-1":"last Thursday","dateFormatItem-Md":"MM-dd","dayPeriods-format-abbr-am":"AM","dateTimeFormats-appendItem-Second":"{0} ({2}: {1})","dayPeriods-format-wide-noon":"noon","field-era":"Era","months-standAlone-wide":"Muharram;Safar;Rabi\u02bb I;Rabi\u02bb II;Jumada I;Jumada II;Rajab;Sha\u02bbban;Ramadan;Shawwal;Dhu\u02bbl-Qi\u02bbdah;Dhu\u02bbl-Hijjah".split(";"),
"timeFormat-short":"HH:mm","quarters-format-wide":["Q1","Q2","Q3","Q4"],"timeFormat-long":"HH:mm:ss z","field-year":"Year","dateTimeFormats-appendItem-Era":"{1} {0}","field-hour":"Hour","months-format-abbr":"Muh.;Saf.;Rab. I;Rab. II;Jum. I;Jum. II;Raj.;Sha.;Ram.;Shaw.;Dhu\u02bbl-Q.;Dhu\u02bbl-H.".split(";"),"field-sat-relative+0":"this Saturday","field-sat-relative+1":"next Saturday","timeFormat-full":"HH:mm:ss zzzz","dateTimeFormats-appendItem-Week":"{0} ({2}: {1})","field-day-relative+0":"today",
"field-thu-relative+0":"this Thursday","field-day-relative+1":"tomorrow","field-thu-relative+1":"next Thursday","dateFormatItem-GyMMMd":"G y MMM d","dateFormatItem-H":"HH","months-standAlone-abbr":"Muh.;Saf.;Rab. I;Rab. II;Jum. I;Jum. II;Raj.;Sha.;Ram.;Shaw.;Dhu\u02bbl-Q.;Dhu\u02bbl-H.".split(";"),"quarters-format-abbr":["Q1","Q2","Q3","Q4"],"quarters-standAlone-wide":["Q1","Q2","Q3","Q4"],"dateFormatItem-Gy":"G y","dateFormatItem-yyyyMMMEd":"G y MMM d, E","dateFormatItem-M":"L","days-standAlone-wide":"Sun Mon Tue Wed Thu Fri Sat".split(" "),
"dateFormatItem-yyyyMMM":"G y MMM","dateFormatItem-yyyyMMMd":"G y MMM d","dayPeriods-format-abbr-noon":"noon","timeFormat-medium":"HH:mm:ss","field-sun-relative+0":"this Sunday","dateFormatItem-Hm":"HH:mm","field-sun-relative+1":"next Sunday","quarters-standAlone-abbr":["Q1","Q2","Q3","Q4"],eraAbbr:["AH"],"field-minute":"Minute","field-dayperiod":"Dayperiod","days-standAlone-abbr":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dateFormatItem-d":"d","dateFormatItem-ms":"mm:ss","quarters-format-narrow":["1",
"2","3","4"],"field-day-relative+-1":"yesterday","dateTimeFormat-long":"{1} {0}","dayPeriods-format-narrow-am":"a","dateFormatItem-h":"h a","dateFormatItem-MMMd":"MMM d","dateFormatItem-MEd":"MM-dd, E","dateTimeFormat-full":"{1} {0}","field-fri-relative+0":"this Friday","field-fri-relative+1":"next Friday","field-day":"Day","days-format-wide":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"field-zone":"Zone","months-standAlone-narrow":"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),"dateFormatItem-y":"G y","dateTimeFormats-appendItem-Day":"{0} ({2}: {1})",
"field-year-relative+-1":"last year","field-month-relative+-1":"last month","dateTimeFormats-appendItem-Year":"{1} {0}","dateFormatItem-hm":"h:mm a","dateTimeFormats-appendItem-Hour":"{0} ({2}: {1})","dayPeriods-format-abbr-pm":"PM","days-format-abbr":"Sun Mon Tue Wed Thu Fri Sat".split(" "),eraNames:["AH"],"days-format-narrow":"SMTWTFS".split(""),"dateFormatItem-yyyyMd":"GGGGG y-MM-dd","field-month":"Month","days-standAlone-narrow":"SMTWTFS".split(""),"dateFormatItem-MMM":"LLL","field-tue-relative+0":"this Tuesday",
"field-tue-relative+1":"next Tuesday","dateTimeFormats-appendItem-Quarter":"{0} ({2}: {1})","dayPeriods-format-wide-am":"AM","dateTimeFormats-appendItem-Month":"{0} ({2}: {1})","dateTimeFormats-appendItem-Minute":"{0} ({2}: {1})","dateFormatItem-EHm":"E HH:mm","field-mon-relative+0":"this Monday","field-mon-relative+1":"next Monday","dateFormat-short":"GGGGG y-MM-dd","dateFormatItem-EHms":"E HH:mm:ss","dateFormatItem-Ehms":"E h:mm:ss a","dayPeriods-format-narrow-noon":"n","field-second":"Second",
"field-sat-relative+-1":"last Saturday","field-sun-relative+-1":"last Sunday","field-month-relative+0":"this month","field-month-relative+1":"next month","dateTimeFormats-appendItem-Timezone":"{0} {1}","dateFormatItem-Ed":"d, E","field-week":"Week","dateFormat-medium":"G y MMM d","field-week-relative+-1":"last week","field-year-relative+0":"this year","dateFormatItem-yyyyM":"GGGGG y-MM","field-year-relative+1":"next year","dayPeriods-format-narrow-pm":"p","dateFormatItem-yyyyQQQQ":"G y QQQQ","dateTimeFormat-short":"{1} {0}",
"dateFormatItem-Hms":"HH:mm:ss","dateFormatItem-hms":"h:mm:ss a","dateFormatItem-GyMMM":"G y MMM","field-mon-relative+-1":"last Monday","dateFormatItem-yyyy":"G y","field-week-relative+0":"this week","field-week-relative+1":"next week"},ar:!0,bs:!0,cs:!0,da:!0,de:!0,en:!0,"en-au":!0,"en-gb":!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,pt:!0,"pt-pt":!0,ro:!0,ru:!0,sr:!0,sv:!0,th:!0,tr:!0,vi:!0,zh:!0,"zh-hant":!0})},"dojo/cldr/nls/en/islamic":function(){define({"field-second-relative+0":"now",
"field-weekday":"Day of the Week","field-wed-relative+0":"this Wednesday","field-wed-relative+1":"next Wednesday","dateFormatItem-GyMMMEd":"E, MMM d, y G","dateFormatItem-MMMEd":"E, MMM d","field-tue-relative+-1":"last Tuesday","days-format-short":"Su Mo Tu We Th Fr Sa".split(" "),"dateFormat-long":"MMMM d, y G","field-fri-relative+-1":"last Friday","field-wed-relative+-1":"last Wednesday","dateFormatItem-yyyyQQQ":"QQQ y G","dateTimeFormat-medium":"{1}, {0}","dateFormat-full":"EEEE, MMMM d, y G",
"dateFormatItem-yyyyMEd":"E, M/d/y GGGGG","field-thu-relative+-1":"last Thursday","dateFormatItem-Md":"M/d","field-era":"Era","timeFormat-short":"h:mm a","quarters-format-wide":["1st quarter","2nd quarter","3rd quarter","4th quarter"],"timeFormat-long":"h:mm:ss a z","field-year":"Year","dateTimeFormats-appendItem-Era":"{0} {1}","field-hour":"Hour","field-sat-relative+0":"this Saturday","field-sat-relative+1":"next Saturday","timeFormat-full":"h:mm:ss a zzzz","field-day-relative+0":"today","field-thu-relative+0":"this Thursday",
"field-day-relative+1":"tomorrow","field-thu-relative+1":"next Thursday","dateFormatItem-GyMMMd":"MMM d, y G","dateFormatItem-Gy":"y G","dateFormatItem-yyyyMMMEd":"E, MMM d, y G","dateFormatItem-yyyyMMM":"MMM y G","dateFormatItem-yyyyMMMd":"MMM d, y G","timeFormat-medium":"h:mm:ss a","field-sun-relative+0":"this Sunday","field-sun-relative+1":"next Sunday",eraAbbr:["AH"],"field-minute":"Minute","field-dayperiod":"AM/PM","field-day-relative+-1":"yesterday","dateTimeFormat-long":"{1} 'at' {0}","dateFormatItem-MEd":"E, M/d",
"dateTimeFormat-full":"{1} 'at' {0}","field-fri-relative+0":"this Friday","field-fri-relative+1":"next Friday","field-day":"Day","days-format-wide":"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),"field-zone":"Time Zone","dateFormatItem-y":"y G","field-year-relative+-1":"last year","field-month-relative+-1":"last month","dateTimeFormats-appendItem-Year":"{0} {1}","dateFormatItem-yyyyMd":"M/d/y GGGGG","field-month":"Month","field-tue-relative+0":"this Tuesday","field-tue-relative+1":"next Tuesday",
"field-mon-relative+0":"this Monday","field-mon-relative+1":"next Monday","dateFormat-short":"M/d/y GGGGG","field-second":"Second","field-sat-relative+-1":"last Saturday","field-sun-relative+-1":"last Sunday","field-month-relative+0":"this month","field-month-relative+1":"next month","dateFormatItem-Ed":"d E","field-week":"Week","dateFormat-medium":"MMM d, y G","field-year-relative+0":"this year","field-week-relative+-1":"last week","dateFormatItem-yyyyM":"M/y GGGGG","field-year-relative+1":"next year",
"dateFormatItem-yyyyQQQQ":"QQQQ y G","dateTimeFormat-short":"{1}, {0}","dateFormatItem-GyMMM":"MMM y G","field-mon-relative+-1":"last Monday","dateFormatItem-yyyy":"y G","field-week-relative+0":"this week","field-week-relative+1":"next week"})},"esri/dijit/editing/Add":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ./EditOperationBase".split(" "),function(h,l,a,d,b,f){l=l(f,{declaredClass:"esri.dijit.editing.Add",type:"edit",label:"Add Features",constructor:function(a){return a=
a||{},a.featureLayer?(this._featureLayer=a.featureLayer,a.addedGraphics?void(this._addedGraphics=a.addedGraphics):void console.error("In constructor of 'esri.dijit.editing.Add', no graphics provided")):void console.error("In constructor of 'esri.dijit.editing.Add', featureLayer is not provided")},updateObjectIds:function(a,b){this.updateIds(this._featureLayer,this._addedGraphics,a,b)},performUndo:function(){return this._featureLayer.applyEdits(null,null,this._addedGraphics).then(a.hitch(this,function(){return{layer:this._featureLayer,
operation:this}}))},performRedo:function(){var b=h.map(this._addedGraphics,function(a){return a.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._addedGraphics,null,null).then(a.hitch(this,function(a,d,e){a=h.map(a,function(a){return a.objectId});return{oldIds:b,addedIds:a,layer:this._featureLayer,operation:this}}))}});return d("extend-esri")&&a.setObject("dijit.editing.Add",l,b),l})},"esri/dijit/editing/EditOperationBase":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/has","../../kernel","../../OperationBase"],function(h,l,a,d,b){l=l(b,{declaredClass:"esri.EditOperationBase",updateIds:function(a,b,d,g){h.forEach(b,function(b,c){var k=b[a.objectIdField];h.forEach(d,function(c,d){k===c&&(b[a.objectIdField]=g[d])})})}});return a("extend-esri")&&(d.EditOperationBase=l),l})},"esri/OperationBase":function(){define(["dojo/_base/declare","dojo/has","./kernel"],function(h,l,a){h=h(null,{declaredClass:"esri.OperationBase",type:"not implemented",
label:"not implemented",constructor:function(a){a=a||{};a.label&&(this.label=a.label)},performUndo:function(){},performRedo:function(){}});return l("extend-esri")&&(a.OperationBase=h),h})},"esri/dijit/editing/Update":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/jsonUtils ./EditOperationBase".split(" "),function(h,l,a,d,b,f,k){h=l(k,{declaredClass:"esri.dijit.editing.Update",type:"edit",label:"Update Features",constructor:function(b){var d;
if(b=b||{},!b.featureLayer)return void console.error("In constructor of 'esri.dijit.editing.Update', featureLayer not provided");if(this._featureLayer=b.featureLayer,!b.preUpdatedGraphics)return void console.error("In constructor of 'esri.dijit.editing.Update', preUpdatedGraphics not provided");this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(d=0;d<b.preUpdatedGraphics.length;d++)this._preUpdatedGraphicsGeometries.push(b.preUpdatedGraphics[d].geometry.toJson()),this._preUpdatedGraphicsAttributes.push(b.preUpdatedGraphics[d].attributes);
if(!b.postUpdatedGraphics)return void console.error("In constructor of 'esri.dijit.editing.Update', postUpdatedGraphics not provided");this._postUpdatedGraphics=b.postUpdatedGraphics;this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];for(d=0;d<b.postUpdatedGraphics.length;d++)b.postUpdatedGraphics[d].geometry?this._postUpdatedGraphicsGeometries.push(b.postUpdatedGraphics[d].geometry.toJson()):this._postUpdatedGraphicsGeometries.push(b.postUpdatedGraphics[d].geometry),this._postUpdatedGraphicsAttributes.push(a.clone(b.postUpdatedGraphics[d].attributes))},
updateObjectIds:function(a,b){this.updateIds(this._featureLayer,this._preUpdatedGraphicsAttributes,a,b);this.updateIds(this._featureLayer,this._postUpdatedGraphicsAttributes,a,b)},performUndo:function(){var b;for(b=0;b<this._postUpdatedGraphics.length;b++)this._preUpdatedGraphicsGeometries[b]?this._postUpdatedGraphics[b].setGeometry(f.fromJson(this._preUpdatedGraphicsGeometries[b])):this._postUpdatedGraphics[b].setGeometry(this._preUpdatedGraphicsGeometries[b]),this._postUpdatedGraphics[b].setAttributes(this._preUpdatedGraphicsAttributes[b]);
return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null).then(a.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))},performRedo:function(){var b;for(b=0;b<this._postUpdatedGraphics.length;b++)this._postUpdatedGraphicsGeometries[b]?this._postUpdatedGraphics[b].setGeometry(f.fromJson(this._postUpdatedGraphicsGeometries[b])):this._postUpdatedGraphics[b].setGeometry(this._postUpdatedGraphicsGeometries[b]),this._postUpdatedGraphics[b].setAttributes(this._postUpdatedGraphicsAttributes[b]);
return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null).then(a.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))}});return d("extend-esri")&&a.setObject("dijit.editing.Update",h,b),h})},"esri/dijit/editing/Delete":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ./EditOperationBase".split(" "),function(h,l,a,d,b,f){l=l(f,{declaredClass:"esri.dijit.editing.Delete",type:"edit",label:"Delete Features",constructor:function(a){return a=
a||{},a.featureLayer?(this._featureLayer=a.featureLayer,a.deletedGraphics?void(this._deletedGraphics=a.deletedGraphics):void console.error("In constructor of 'esri.dijit.editing.Delete', no graphics provided")):void console.error("In constructor of 'esri.dijit.editing.Delete', featureLayer is not provided")},updateObjectIds:function(a,b){this.updateIds(this._featureLayer,this._deletedGraphics,a,b)},performUndo:function(){var b=h.map(this._deletedGraphics,function(a){return a.attributes[this._featureLayer.objectIdField]},
this);return this._featureLayer.applyEdits(this._deletedGraphics,null,null).then(a.hitch(this,function(a,d,e){a=h.map(a,function(a){return a.objectId});return{oldIds:b,addedIds:a,layer:this._featureLayer,operation:this}}))},performRedo:function(){return this._featureLayer.applyEdits(null,null,this._deletedGraphics).then(a.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))}});return d("extend-esri")&&a.setObject("dijit.editing.Delete",l,b),l})},"esri/dijit/editing/Cut":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/jsonUtils ./EditOperationBase".split(" "),
function(h,l,a,d,b,f,k){l=l(k,{declaredClass:"esri.dijit.editing.Cut",type:"edit",label:"Cut Features",constructor:function(b){var d;if(b=b||{},!b.featureLayer)return void console.error("In constructor of 'esri.dijit.editing.Cut', featureLayer not provided");if(this._featureLayer=b.featureLayer,!b.addedGraphics)return void console.error("In constructor of 'esri.dijit.editing.Cut', addedGraphics for cut not provided");if(this._addedGraphics=b.addedGraphics,!b.preUpdatedGraphics)return void console.error("In constructor of 'esri.dijit.editing.Cut', preUpdatedGraphics not provided");
this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(d=0;d<b.preUpdatedGraphics.length;d++)this._preUpdatedGraphicsGeometries.push(b.preUpdatedGraphics[d].geometry.toJson()),this._preUpdatedGraphicsAttributes.push(b.preUpdatedGraphics[d].attributes);if(!b.postUpdatedGraphics)return void console.error("In constructor of 'esri.dijit.editing.Cut', postUpdatedGraphics not provided");this._postUpdatedGraphics=b.postUpdatedGraphics;this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=
[];for(d=0;d<b.postUpdatedGraphics.length;d++)this._postUpdatedGraphicsGeometries.push(b.postUpdatedGraphics[d].geometry.toJson()),this._postUpdatedGraphicsAttributes.push(a.clone(b.postUpdatedGraphics[d].attributes))},updateObjectIds:function(a,b){this.updateIds(this._featureLayer,this._preUpdatedGraphicsAttributes,a,b);this.updateIds(this._featureLayer,this._postUpdatedGraphicsAttributes,a,b);this.updateIds(this._featureLayer,this._addedGraphics,a,b)},performUndo:function(){var b;for(b=0;b<this._postUpdatedGraphics.length;b++)this._postUpdatedGraphics[b].setGeometry(f.fromJson(this._preUpdatedGraphicsGeometries[b])),
this._postUpdatedGraphics[b].setAttributes(this._preUpdatedGraphicsAttributes[b]);return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,this._addedGraphics).then(a.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))},performRedo:function(){var b;for(b=0;b<this._postUpdatedGraphics.length;b++)this._postUpdatedGraphics[b].setGeometry(f.fromJson(this._postUpdatedGraphicsGeometries[b])),this._postUpdatedGraphics[b].setAttributes(this._postUpdatedGraphicsAttributes[b]);
var d=h.map(this._addedGraphics,function(a){return a.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._addedGraphics,this._postUpdatedGraphics,null).then(a.hitch(this,function(a,b,f){a=h.map(a,function(a){return a.objectId});return{oldIds:d,addedIds:a,layer:this._featureLayer,operation:this}}))}});return d("extend-esri")&&a.setObject("dijit.editing.Cut",l,b),l})},"esri/dijit/editing/Union":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/jsonUtils ./EditOperationBase".split(" "),
function(h,l,a,d,b,f,k){l=l(k,{declaredClass:"esri.dijit.editing.Union",type:"edit",label:"Union Features",constructor:function(b){b=b||{};this._featureLayer=b.featureLayer;this._deletedGraphics=b.deletedGraphics;this._preUpdatedGraphics=b.preUpdatedGraphics;this._postUpdatedGraphics=b.postUpdatedGraphics;this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];var d;for(d=0;d<b.preUpdatedGraphics.length;d++)this._preUpdatedGraphicsGeometries.push(b.preUpdatedGraphics[d].geometry.toJson()),
this._preUpdatedGraphicsAttributes.push(b.preUpdatedGraphics[d].attributes);for(d=0;d<b.postUpdatedGraphics.length;d++)this._postUpdatedGraphicsGeometries.push(b.postUpdatedGraphics[d].geometry.toJson()),this._postUpdatedGraphicsAttributes.push(a.clone(b.postUpdatedGraphics[d].attributes))},updateObjectIds:function(a,b){this.updateIds(this._featureLayer,this._preUpdatedGraphicsAttributes,a,b);this.updateIds(this._featureLayer,this._postUpdatedGraphicsAttributes,a,b);this.updateIds(this._featureLayer,
this._deletedGraphics,a,b)},performUndo:function(){var b;for(b=0;b<this._postUpdatedGraphics.length;b++)this._postUpdatedGraphics[b].setGeometry(f.fromJson(this._preUpdatedGraphicsGeometries[b])),this._postUpdatedGraphics[b].setAttributes(this._preUpdatedGraphicsAttributes[b]);var d=h.map(this._deletedGraphics,function(a){return a.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._deletedGraphics,this._postUpdatedGraphics,null).then(a.hitch(this,function(a,
b,f){a=h.map(a,function(a){return a.objectId});return{oldIds:d,addedIds:a,layer:this._featureLayer,operation:this}}))},performRedo:function(){var b;for(b=0;b<this._postUpdatedGraphics.length;b++)this._postUpdatedGraphics[b].setGeometry(f.fromJson(this._postUpdatedGraphicsGeometries[b])),this._postUpdatedGraphics[b].setAttributes(this._postUpdatedGraphicsAttributes[b]);return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,this._deletedGraphics).then(a.hitch(this,function(){return{layer:this._featureLayer,
operation:this}}))}});return d("extend-esri")&&a.setObject("dijit.editing.Union",l,b),l})},"esri/dijit/editing/toolbars/Drawing":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dijit/_CssStateMixin ../Util ./ToolbarBase ../tools/ButtonToolBase ../tools/Cut ../tools/Union ../tools/Reshape ../tools/Editing ../tools/EditingTools ../tools/Selection ../tools/SelectionTools ../../../kernel".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t){h=h([m,
f],{declaredClass:"esri.dijit.editing.toolbars.Drawing",onShowAttributeInspector:function(){},_activateTool:function(a,b){this._settings.editor._activeTool=a;"EDITING"!==a&&this._settings.templatePicker.clearSelection();"ATTRIBUTES"!==a&&this._settings.editor._hideAttributeInspector();"CLEAR"!==a&&this.inherited(arguments)},_initializeToolbar:function(){a.forEach(this._settings.layers,function(a){this._tbConnects.push(d.connect(a,"onSelectionComplete",this,"_updateUI"))},this)},activateEditing:function(a,
b){this._tools.EDITING._activateTool(a,b.geometryType);this._activeTool=this._tools.EDITING;this._activeTool.setChecked(!0)},_updateUI:function(){this._settings.undoManager&&(this._tools.UNDO.set("disabled",!1===this._settings.undoManager.canUndo),this._tools.REDO.set("disabled",!1===this._settings.undoManager.canRedo));this._selectedFeatures=k.getSelection(this._settings.layers);var a=this._selectedFeatures.length;this._tools.DELETE&&this._tools.DELETE.set("disabled",0>=a);this._tools.CLEAR&&this._tools.CLEAR.set("disabled",
0>=a);this._tools.ATTRIBUTES&&this._tools.ATTRIBUTES.set("disabled",0>=a);this._tools.UNION&&this._tools.UNION.set("disabled",2>a)},_toolFinished:function(a){"ATTRIBUTES"===a&&this._selectedFeatures&&this._selectedFeatures.length&&this.onShowAttributeInspector(this._selectedFeatures[0]);("SELECT"===a||"CUT"===a||"RESHAPING"===a||"EDITING"===a)&&(this._activeTool.deactivate(),this._activeTool.setChecked(!1),this._activeTool=null);"DELETE"===a&&this.onDelete();this._settings.editor._activeTool=null;
this._updateUI()},_createTools:function(){this._tools.SELECT=new u({settings:this._settings,onClick:l.hitch(this,"_activateTool","SELECT",!0),onFinished:l.hitch(this,"_toolFinished","SELECT")});this.addChild(this._tools.SELECT);this._tools.CLEAR=new g(l.mixin(v.selectClear,{settings:this._settings,onClick:l.hitch(this._settings.editor,"_clearSelection",!1)}));this.addChild(this._tools.CLEAR);this._createSeparator();this._tools.ATTRIBUTES=new g(l.mixin(r.attributes,{settings:this._settings,onClick:l.hitch(this,
"_toolFinished","ATTRIBUTES")}));this.addChild(this._tools.ATTRIBUTES);this._createSeparator();this._tools.EDITING=new q({settings:this._settings,onClick:l.hitch(this,"_activateTool","EDITING",!0),onApplyEdits:l.hitch(this,"onApplyEdits"),onFinished:l.hitch(this,"_toolFinished","EDITING")});this.addChild(this._tools.EDITING);this._tools.DELETE=new g(l.mixin(r.del,{settings:this._settings,onClick:l.hitch(this,"_toolFinished","DELETE")}));this.addChild(this._tools.DELETE);this._settings.toolbarOptions&&
((this._settings.toolbarOptions.cutVisible||this._settings.toolbarOptions.mergeVisible||this._settings.toolbarOptions.reshapeVisible)&&this._createSeparator(),this._settings.toolbarOptions.cutVisible&&(this._tools.CUT=new e({settings:this._settings,onFinished:l.hitch(this,"_toolFinished","CUT"),onClick:l.hitch(this,"_activateTool","CUT",!0),onApplyEdits:l.hitch(this,"onApplyEdits")}),this.addChild(this._tools.CUT)),this._settings.toolbarOptions.mergeVisible&&(this._tools.UNION=new c({settings:this._settings,
onFinished:l.hitch(this,"_toolFinished","UNION"),onApplyEdits:l.hitch(this,"onApplyEdits")}),this.addChild(this._tools.UNION)),this._settings.toolbarOptions.reshapeVisible&&(this._tools.RESHAPING=new n({settings:this._settings,onClick:l.hitch(this,"_activateTool","RESHAPING",!0),onFinished:l.hitch(this,"_toolFinished","RESHAPING"),onApplyEdits:l.hitch(this,"onApplyEdits")}),this.addChild(this._tools.RESHAPING)));this._settings.enableUndoRedo&&(this._createSeparator(),this._tools.UNDO=new g(l.mixin(r.undo,
{settings:this._settings,disabled:!0,onClick:l.hitch(this,function(){this._tools.UNDO.set("disabled",!0);this._tools.REDO.set("disabled",!0);this._settings.editor._undo()})})),this.addChild(this._tools.UNDO),this._tools.REDO=new g(l.mixin(r.redo,{settings:this._settings,disabled:!0,onClick:l.hitch(this,function(){this._tools.UNDO.set("disabled",!0);this._tools.REDO.set("disabled",!0);this._settings.editor._redo()})})),this.addChild(this._tools.REDO))}});return b("extend-esri")&&l.setObject("dijit.editing.toolbars.Drawing",
h,t),h})},"esri/dijit/editing/toolbars/ToolbarBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dijit/Toolbar dijit/ToolbarSeparator ../../../kernel ../../../lang".split(" "),function(h,l,a,d,b,f,k,m,g){h=h([f],{declaredClass:"esri.dijit.editing.toolbars.ToolbarBase",_enabled:!0,graphicsAdded:function(){},drawEnd:function(){},onApplyEdits:function(){},onDelete:function(){},constructor:function(a,b){a&&a.settings&&(this._tools=[],this._tbConnects=
[],this._initialize(a.settings))},postCreate:function(){this._createTools();this.deactivate()},destroy:function(){var b,c=this._tools;for(b in c)c.hasOwnProperty(b)&&g.isDefined(this._tools[b])&&this._tools[b].destroy();a.forEach(this._tbConnects,d.disconnect);this.inherited(arguments)},activate:function(a){this._enabled=!0},deactivate:function(){var a;this._enabled=!1;this._geometryType=this._layer=null;var b=this._tools;for(a in b)b.hasOwnProperty(a)&&(this._tools[a].deactivate(),this._tools[a].setChecked(!1))},
isEnabled:function(){return this._enabled},setActiveSymbol:function(a){this._activeSymbol=a},_getSymbol:function(){},_createTools:function(){},_initialize:function(a){this._settings=a;this._toolbar=a.drawToolbar;this._editToolbar=a.editToolbar;this._initializeToolbar()},_activateTool:function(a,b){this._activeTool&&this._activeTool.deactivate();!0===b&&this._activeTool==this._tools[a]?(this._activeTool.setChecked(!1),this._activeTool=null):(this._activeTool=this._tools[a],this._activeTool.setChecked(!0),
this._activeTool.activate(null))},_createSeparator:function(){this.addChild(new k)}});return b("extend-esri")&&l.setObject("dijit.editing.toolbars.ToolbarBase",h,m),h})},"esri/dijit/editing/tools/ButtonToolBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dijit/form/Button ./ToolBase ../../../kernel".split(" "),function(h,l,a,d,b,f){h=h([d,b],{declaredClass:"esri.dijit.editing.tools.ButtonToolBase",postCreate:function(){this.inherited(arguments);this._setShowLabelAttr&&this._setShowLabelAttr(!1)},
destroy:function(){d.prototype.destroy.apply(this,arguments);b.prototype.destroy.apply(this,arguments)}});return a("extend-esri")&&l.setObject("dijit.editing.tools.ButtonToolBase",h,f),h})},"esri/dijit/editing/tools/ToolBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../../../kernel","dojo/i18n!../../../nls/jsapi"],function(h,l,a,d,b){h=h(null,{declaredClass:"esri.dijit.editing.tools.ToolBase",_enabled:!0,showLabel:!1,constructor:function(a,d){a=a||{};l.mixin(this,a);this.label=
this._label?b.widgets.editor.tools[this._label]:"";this._settings=a.settings;this._toolbar=a.settings.drawToolbar;this._editToolbar=a.settings.editToolbar;this._initializeTool()},onFinished:function(){},onDrawEnd:function(){},onApplyEdits:function(){},postCreate:function(){this.deactivate();this.inherited(arguments)},destroy:function(){},activate:function(a){this._toolbar&&this._toolbar.deactivate();this._editToolbar&&this._editToolbar.deactivate();this._enabled&&(this._checked=!0,this._layer=a,this._toolbar&&
this._drawType&&this._toolbar.activate(this._drawType))},deactivate:function(){this._toolbar&&this._toolbar.deactivate();this._editToolbar&&this._editToolbar.deactivate();this.setChecked(!1);this._updateUI()},setEnabled:function(a){this._enabled=a;this._updateUI()},setChecked:function(a){this._checked=a},enable:function(a){this._updateUI()},isEnabled:function(){return this._enabled},getToolName:function(){return this._toolName},_initializeTool:function(){},_updateUI:function(){this.disabled=!this._enabled;
this.attr("iconClass",this._enabled?this._enabledIcon:this._disabledIcon)}});return a("extend-esri")&&l.setObject("dijit.editing.tools.ToolBase",h,d),h})},"esri/dijit/editing/tools/Cut":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dojo/DeferredList ../../../graphicsUtils ../../../graphic ../../../tasks/query ../../../layers/FeatureLayer ../../../toolbars/draw ../Cut ./ToggleToolBase ../../../kernel".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,
q,r){h=h([q],{declaredClass:"esri.dijit.editing.tools.Cut",id:"btnFeatureCut",_enabledIcon:"toolbarIcon cutIcon",_disabledIcon:"toolbarIcon cutIcon",_drawType:c.POLYLINE,_enabled:!0,_label:"NLS_cutLbl",_cutConnects:[],activate:function(){this._cutConnects.push(d.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd"));this.inherited(arguments)},deactivate:function(){this.inherited(arguments);a.forEach(this._cutConnects,d.disconnect);this._cutConnects=[];this._edits=[]},_onDrawEnd:function(b){var c=this._cutLayers=
a.filter(this._settings.layers,function(a){return"esriGeometryPolygon"===a.geometryType||"esriGeometryPolyline"===a.geometryType&&a.visible&&a._isMapAtVisibleScale()});this._cutConnects=this._cutConnects.concat(a.map(c,l.hitch(this,function(b){return d.connect(b,"onEditsComplete",l.hitch(this,function(b,c,d){if(this._settings.undoRedoManager){var e=this._settings.undoRedoManager;a.forEach(this._edits,l.hitch(this,function(a){e.add(new n({featureLayer:a.layer,addedGraphics:a.adds,preUpdatedGraphics:a.preUpdates,
postUpdatedGraphics:a.updates}))}),this)}this.onFinished()}))})));var f=new g;f.geometry=b;a.forEach(c,function(a,b){this._settings.editor._selectionHelper.selectFeatures([a],f,e.SELECTION_NEW,l.hitch(this,"_cutFeatures",a,f))},this)},_cutFeatures:function(a,b,c){if(c&&c.length){this._edits=[];var d=[];d.push(this._settings.geometryService.cut(k.getGeometries(c),b.geometry,l.hitch(this,"_cutHandler",a,c)));(new f(d)).addCallback(l.hitch(this,function(){this.onApplyEdits(this._edits)}))}},_cutHandler:function(b,
c,d){var e,f,g=[],k=[],h=a.map(c,function(a){return new m(l.clone(a.toJson()))});a.forEach(d.cutIndexes,function(a,b){e!=a?(e=a,k.push(c[a].setGeometry(d.geometries[b]))):(f=new m(d.geometries[b],null,l.mixin({},c[a].attributes),null),f.attributes[c[0].getLayer().objectIdField]=null,g.push(f))},this);this._edits.push({layer:b,adds:g,updates:k,preUpdates:h})}});return b("extend-esri")&&l.setObject("dijit.editing.tools.Cut",h,r),h})},"esri/dijit/editing/tools/ToggleToolBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dijit/form/ToggleButton ./ToolBase ../../../kernel".split(" "),
function(h,l,a,d,b,f){h=h([d,b],{declaredClass:"esri.dijit.editing.tools.ToggleToolBase",postCreate:function(){this.inherited(arguments);this._setShowLabelAttr&&this._setShowLabelAttr(!1)},destroy:function(){d.prototype.destroy.apply(this,arguments);b.prototype.destroy.apply(this,arguments)},setChecked:function(a){d.prototype.setChecked.apply(this,arguments)}});return a("extend-esri")&&l.setObject("dijit.editing.tools.ToggleToolBase",h,f),h})},"esri/dijit/editing/tools/Union":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../../../graphicsUtils ../../../graphic ../../../toolbars/draw ../Union ./ButtonToolBase ../../../kernel".split(" "),
function(h,l,a,d,b,f,k,m,g,e){h=h([g],{declaredClass:"esri.dijit.editing.tools.Union",id:"btnFeatureUnion",_enabledIcon:"toolbarIcon unionIcon",_disabledIcon:"toolbarIcon unionIcon",_drawType:k.POLYLINE,_enabled:!0,_label:"NLS_unionLbl",_onClick:function(c){this._settings.editor._activeTool="UNION";c=a.filter(this._settings.layers,function(a){return"esriGeometryPolygon"===a.geometryType&&a.visible&&a._isMapAtVisibleScale()});var d=[],e=0;a.forEach(c,function(c,g){var k=c.getSelectedFeatures();2<=
k.length&&(e++,this._settings.geometryService.union(b.getGeometries(k),l.hitch(this,function(b){var g=k.shift(),h=[],u=[];h.push(new f(g.toJson()));u.push(g.setGeometry(b));d.push({layer:c,updates:u,deletes:k,preUpdates:h});e--;0>=e&&this.onApplyEdits(d,l.hitch(this,function(){if(this._settings.undoRedoManager){var b=this._settings.undoRedoManager;a.forEach(this._edits,l.hitch(this,function(a){b.add(new m({featureLayer:a.layer,deletedGraphics:a.deletes,preUpdatedGraphics:a.preUpdates,postUpdatedGraphics:a.updates}))}),
this)}this._settings.editor._selectionHelper.clearSelection(!1);this.onFinished()}))})))},this)}});return d("extend-esri")&&l.setObject("dijit.editing.tools.Union",h,e),h})},"esri/dijit/editing/tools/Reshape":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has ../../../graphic ../../../layers/FeatureLayer ../../../tasks/query ../../../toolbars/draw ./ToggleToolBase ../../../kernel".split(" "),function(h,l,a,d,b,f,k,m,g,e,c){h=h([e],{declaredClass:"esri.dijit.editing.tools.Reshape",
id:"btnFeatureReshape",_enabledIcon:"toolbarIcon reshapeIcon",_disabledIcon:"toolbarIcon reshapeIcon",_drawType:g.POLYLINE,_enabled:!0,_label:"NLS_reshapeLbl",activate:function(){d.disconnect(this._rConnect);this._rConnect=d.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd");this.inherited(arguments)},deactivate:function(){this.inherited(arguments);d.disconnect(this._rConnect);delete this._rConnect},_onDrawEnd:function(b){var c=this._settings.layers,d=new m;d.geometry=b;b=this._reshapeLayers=a.filter(c,
function(a){return"esriGeometryPolygon"===a.geometryType||"esriGeometryPolyline"});this._settings.editor._selectionHelper.selectFeatures(b,d,k.SELECTION_NEW,l.hitch(this,"_reshape",d))},_reshape:function(a,b){if(1===b.length){var c=[],d=[],e=[],g=b[0],k=g.getLayer();this._settings.geometryService.reshape(g.geometry,a.geometry,l.hitch(this,function(a){return"polyline"===a.type&&a.paths&&0===a.paths.length?(this._settings.editor._selectionHelper.clearSelection(!1),void this.onFinished()):"polygon"===
a.type&&a.rings&&0===a.rings.length?(this._settings.editor._selectionHelper.clearSelection(!1),void this.onFinished()):(e.push(new f(g.toJson())),d.push(g.setGeometry(a)),c.push({layer:k,updates:d,preUpdates:e}),void this.onApplyEdits(c,l.hitch(this,function(){this._settings.editor._selectionHelper.clearSelection(!1);this.onFinished()})))}))}}});return b("extend-esri")&&l.setObject("dijit.editing.tools.Reshape",h,c),h})},"esri/dijit/editing/tools/Editing":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../../../layers/FeatureTemplate ./Edit ./EditingTools ./DropDownToolBase ../../../kernel ../../../lang".split(" "),
function(h,l,a,d,b,f,k,m,g,e){h=h([m],{declaredClass:"esri.dijit.editing.tools.Editing",_enabled:!1,deactivate:function(){this._enabled&&(this._enabled=!1,this.inherited(arguments),this._settings.templatePicker.clearSelection())},onItemClicked:function(a,d){this.inherited(arguments);this._activeTool===this._tools.AUTOCOMPLETE&&(this._settings.editor._drawingTool=b.TOOL_AUTO_COMPLETE_POLYGON)},_activateTool:function(a,b){var d;this.enable(b);for(d in this._tools)this._tools.hasOwnProperty(d)&&(this.dropDown.removeChild(this._tools[d]),
!0===this._tools[d]._enabled&&this.dropDown.addChild(this._tools[d]));this._geometryType===b&&!1!==this._activeTool._enabled||(this._activeTool=this._tools[a.toUpperCase()]);this._geometryType=b;this._activeTool.activate();this._activeTool.setChecked(!0);this._updateUI()},_initializeTool:function(a){this.inherited(arguments);this._initializeTools()},_initializeTools:function(){var b,d=this._settings.layers,e=this._settings.editor,f=!1,g=!1,k=!1,h=this._toolTypes=[];a.forEach(d,function(d){b=d.geometryType;
f=f||"esriGeometryPoint"===b;g=g||"esriGeometryPolyline"===b;k=k||"esriGeometryPolygon"===b;h=h.concat(a.map(this._getTemplatesFromLayer(d),l.hitch(this,function(a){return e._toDrawTool(a.drawingTool,d)})))},this);d=this._settings.createOptions;f&&this._toolTypes.push("point");g&&(this._toolTypes=this._toolTypes.concat(d.polylineDrawTools));k&&(this._toolTypes=this._toolTypes.concat(d.polygonDrawTools));this._toolTypes=this._toUnique(this._toolTypes.concat(h))},_toUnique:function(b){var d={};return a.filter(b,
function(a){return d[a]?!1:d[a]=!0})},_getTemplatesFromLayer:function(b){var d=b.templates||[];return a.forEach(b.types,function(a){d=d.concat(a.templates)}),a.filter(d,e.isDefined)},_createTools:function(){a.forEach(this._toolTypes,this._createTool,this);this.inherited(arguments)},_createTool:function(a){var b=l.mixin(k[a],{settings:this._settings,onClick:l.hitch(this,"onItemClicked",k[a].id)});this._tools[a.toUpperCase()]=new f(b)}});return d("extend-esri")&&l.setObject("dijit.editing.tools.Editing",
h,g),h})},"esri/dijit/editing/tools/Edit":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./MenuItemBase","../../../kernel"],function(h,l,a,d,b){h=h([d],{declaredClass:"esri.dijit.editing.tools.Edit",enable:function(a){this._enabled=a===this._geomType;this.inherited(arguments)}});return a("extend-esri")&&l.setObject("dijit.editing.tools.Edit",h,b),h})},"esri/dijit/editing/tools/MenuItemBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dijit/MenuItem ./ToolBase ../../../kernel".split(" "),
function(h,l,a,d,b,f){h=h([d,b],{declaredClass:"esri.dijit.editing.tools.MenuItemBase",destroy:function(){d.prototype.destroy.apply(this,arguments);b.prototype.destroy.apply(this,arguments)}});return a("extend-esri")&&l.setObject("dijit.editing.tools.MenuItemBase",h,f),h})},"esri/dijit/editing/tools/EditingTools":function(){define(["dojo/_base/lang","dojo/has","../../../toolbars/draw","../../../kernel"],function(h,l,a,d){a={point:{id:"esriPointTool",_enabledIcon:"toolbarIcon pointIcon",_disabledIcon:"toolbarIcon pointIconDisabled",
_drawType:a.POINT,_geomType:"esriGeometryPoint",_label:"NLS_pointLbl"},polyline:{id:"toolDrawFreehandPolyline",_enabledIcon:"toolbarIcon polylineIcon",_disabledIcon:"toolbarIcon polylineIconDisabled",_drawType:a.POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_polylineLbl"},freehandpolyline:{id:"toolDrawPolyline",_enabledIcon:"toolbarIcon freehandPolylineIcon",_disabledIcon:"toolbarIcon freehandPolylineIcon",_drawType:a.FREEHAND_POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_freehandPolylineLbl"},
polygon:{id:"toolDrawPolygon",_enabledIcon:"toolbarIcon polygonIcon",_disabledIcon:"toolbarIcon polygonIconDisabled",_drawType:a.POLYGON,_geomType:"esriGeometryPolygon",_label:"NLS_polygonLbl"},freehandpolygon:{id:"toolDrawFreehandPolygon",_enabledIcon:"toolbarIcon freehandPolygonIcon",_disabledIcon:"toolbarIcon freehandPolygonIconDisabled",_drawType:a.FREEHAND_POLYGON,_label:"NLS_freehandPolygonLbl",_geomType:"esriGeometryPolygon"},autocomplete:{id:"btnFeatureAutoComplete",_enabledIcon:"toolbarIcon autoCompleteIcon",
_disabledIcon:"toolbarIcon autoCompleteIcon",_drawType:a.POLYGON,_label:"NLS_autoCompleteLbl",_geomType:"esriGeometryPolygon"},rectangle:{id:"toolDrawRect",_enabledIcon:"toolbarIcon rectangleIcon",_disabledIcon:"toolbarIcon rectangleIcon",_drawType:a.RECTANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_rectangleLbl"},arrow:{id:"toolDrawArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:a.ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLbl"},uparrow:{id:"toolDrawArrowUp",
_enabledIcon:"toolbarIcon arrowUpIcon",_disabledIcon:"toolbarIcon arrowUpIcon",_drawType:a.UP_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowUpLbl"},downarrow:{id:"toolDrawDownArrow",_enabledIcon:"toolbarIcon arrowDownIcon",_disabledIcon:"toolbarIcon arrowDownIcon",_drawType:a.DOWN_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowDownLbl"},leftarrow:{id:"toolDrawLeftArrow",_enabledIcon:"toolbarIcon arrowLeftIcon",_disabledIcon:"toolbarIcon arrowLeftIcon",_drawType:a.LEFT_ARROW,_geomType:"esriGeometryPolygon",
_label:"NLS_arrowLeftLbl"},rightarrow:{id:"toolDrawRightArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:a.RIGHT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowRightLbl"},circle:{id:"toolDrawCircle",_enabledIcon:"toolbarIcon circleIcon",_disabledIcon:"toolbarIcon circleIcon",_drawType:a.CIRCLE,_geomType:"esriGeometryPolygon",_label:"NLS_circleLbl"},ellipse:{id:"toolDrawEllipse",_enabledIcon:"toolbarIcon ellipseIcon",_disabledIcon:"toolbarIcon ellipseIcon",
_drawType:a.ELLIPSE,_geomType:"esriGeometryPolygon",_label:"NLS_ellipseLbl"},triangle:{id:"toolDrawTriangle",_enabledIcon:"toolbarIcon triangleIcon",_disabledIcon:"toolbarIcon triangleIcon",_drawType:a.TRIANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_triangleLbl"},attributes:{id:"btnAttributes",_enabledIcon:"toolbarIcon attributesIcon",_disabledIcon:"toolbarIcon attributesIcon",_enabled:!1,_label:"NLS_attributesLbl"},del:{id:"btnDelete2",_enabledIcon:"toolbarIcon deleteFeatureIcon",_disabledIcon:"toolbarIcon deleteFeatureIcon",
_enabled:!1,_label:"NLS_deleteLbl"},undo:{id:"btnUndo",_enabledIcon:"dijitEditorIcon dijitEditorIconUndo",_disabledIcon:"dijitEditorIcon dijitEditorIconUndo",_enabled:!1,_label:"NLS_undoLbl"},redo:{id:"btnRedo",_enabledIcon:"dijitEditorIcon dijitEditorIconRedo",_disabledIcon:"dijitEditorIcon dijitEditorIconRedo",_enabled:!1,_label:"NLS_redoLbl"}};return l("extend-esri")&&h.setObject("dijit.editing.tools.EditingTools",a,d),a})},"esri/dijit/editing/tools/DropDownToolBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-style dijit/registry dijit/Menu dijit/form/ComboButton ./ToolBase ../../../kernel ../../../lang".split(" "),
function(h,l,a,d,b,f,k,m,g,e){h=h([k,m],{declaredClass:"esri.dijit.editing.tools.DropDownToolBase",_enabled:!1,_checked:!1,postCreate:function(){this._tools=[];this._createTools();this.inherited(arguments);this._setShowLabelAttr&&this._setShowLabelAttr(!1)},destroy:function(){var a,b=this._tools;for(a in b)b.hasOwnProperty(a)&&e.isDefined(b[a])&&b[a].destroy();this.inherited(arguments)},_createTools:function(){var a,b=new f;this.dropDown=b;for(a in this._tools)this._tools.hasOwnProperty(a)&&b.addChild(this._tools[a]);
this._activeTool=b.getChildren()[0];this._updateUI()},activate:function(a){this.inherited(arguments);this._activeTool?this._activeTool.activate():this._activateDefaultTool()},deactivate:function(){this.inherited(arguments);this._activeTool&&this._activeTool.deactivate()},enable:function(a){for(var b in this._tools)this._tools.hasOwnProperty(b)&&this._tools[b].enable(a);this.setEnabled(!0);this.inherited(arguments)},setChecked:function(a){this._checked=a;this._updateUI()},_onDrawEnd:function(a){},
onLayerChange:function(a,b,d){this._activeTool=null;this._activeType=b;this._activeTemplate=d;this._activeLayer=a},onItemClicked:function(a,d){this._activeTool&&this._activeTool.deactivate();this._activeTool=b.byId(a);!1===this._checked?this._onClick():(this._updateUI(),this._activeTool&&(this._activeTool.activate(),this._activeTool.setChecked(!0)))},_onClick:function(a){!1!==this._enabled&&(this._checked=!this._checked,this.inherited(arguments))},_updateUI:function(){this.attr("disabled",!this._enabled);
d.set(this.focusNode,{outline:"none"});d.set(this.titleNode,{padding:"0px",border:"none"});this._checked?d.set(this.titleNode,{backgroundColor:"#D4DFF2",border:"1px solid #316AC5"}):d.set(this.titleNode,{backgroundColor:"",border:""});this._activeTool&&(this.attr("iconClass",this._checked?this._activeTool._enabledIcon:this._activeTool._disabledIcon),this.attr("label",this._activeTool.label))}});return a("extend-esri")&&l.setObject("dijit.editing.tools.DropDownToolBase",h,g),h})},"dijit/form/ComboButton":function(){define("dojo/_base/declare dojo/keys ../focus ./DropDownButton dojo/text!./templates/ComboButton.html ../a11yclick".split(" "),
function(h,l,a,d,b){return h("dijit.form.ComboButton",d,{templateString:b,_setIdAttr:"",_setTabIndexAttr:["focusNode","titleNode"],_setTitleAttr:"titleNode",optionsTitle:"",baseClass:"dijitComboButton",cssStateNodes:{buttonNode:"dijitButtonNode",titleNode:"dijitButtonContents",_popupStateNode:"dijitDownArrowButton"},_focusedNode:null,_onButtonKeyDown:function(b){b.keyCode==l[this.isLeftToRight()?"RIGHT_ARROW":"LEFT_ARROW"]&&(a.focus(this._popupStateNode),b.stopPropagation(),b.preventDefault())},_onArrowKeyDown:function(b){b.keyCode==
l[this.isLeftToRight()?"LEFT_ARROW":"RIGHT_ARROW"]&&(a.focus(this.titleNode),b.stopPropagation(),b.preventDefault())},focus:function(b){this.disabled||a.focus("start"==b?this.titleNode:this._popupStateNode)}})})},"esri/dijit/editing/tools/Selection":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/has ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol ../../../symbols/SimpleFillSymbol ./Edit ./SelectionTools ./DropDownToolBase ../../../kernel".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q){h=h([n],{declaredClass:"esri.dijit.editing.tools.Selection",_enabled:!0,activate:function(){this.inherited(arguments);this._sConnect=d.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd")},deactivate:function(){this.inherited(arguments);d.disconnect(this._sConnect);delete this._sConnect},_initializeTool:function(){this._createSymbols();this._initializeLayers();this._toolTypes=["select","selectadd","selectremove"]},_onDrawEnd:function(a){this.inherited(arguments);
this._settings.editor._hideAttributeInspector();var b=this._settings.layers;this._selectMethod=this._activeTool._selectMethod;this._settings.editor._selectionHelper.selectFeaturesByGeometry(b,a,this._selectMethod,l.hitch(this,"onFinished"))},_createSymbols:function(){this._pointSelectionSymbol=new k(k.STYLE_CIRCLE,10,new m(m.STYLE_SOLID,new b([0,0,0]),1),new b([255,0,0,.5]));this._polylineSelectionSymbol=new m(m.STYLE_SOLID,new b([0,200,255]),2);this._polygonSelectionSymbol=new g(g.STYLE_SOLID,new m(m.STYLE_SOLID,
new b([0,0,0]),1),new b([0,200,255,.5]))},_initializeLayers:function(){a.forEach(this._settings.layers,this._setSelectionSymbol,this)},_setSelectionSymbol:function(a){var b=null;switch(a.geometryType){case "esriGeometryPoint":b=this._pointSelectionSymbol;break;case "esriGeometryPolyline":b=this._polylineSelectionSymbol;break;case "esriGeometryPolygon":b=this._polygonSelectionSymbol}a.setSelectionSymbol(a._selectionSymbol||b)},_createTools:function(){a.forEach(this._toolTypes,this._createTool,this);
this.inherited(arguments)},_createTool:function(a){var b=l.mixin(c[a],{settings:this._settings,onClick:l.hitch(this,"onItemClicked",c[a].id)});this._tools[a.toUpperCase()]=new e(b)}});return f("extend-esri")&&l.setObject("dijit.editing.tools.Selection",h,q),h})},"esri/dijit/editing/tools/SelectionTools":function(){define(["dojo/_base/lang","dojo/has","../../../layers/FeatureLayer","../../../toolbars/draw","../../../kernel"],function(h,l,a,d,b){a={select:{id:"btnNewSelection",_enabledIcon:"toolbarIcon newSelectionIcon",
_disabledIcon:"toolbarIcon newSelectionIcon",_drawType:d.EXTENT,_selectMethod:a.SELECTION_NEW,_label:"NLS_selectionNewLbl"},selectadd:{id:"btnAddToSelection",_enabledIcon:"toolbarIcon addToSelectionIcon",_disabledIcon:"toolbarIcon addToSelectionIcon",_drawType:d.EXTENT,_selectMethod:a.SELECTION_ADD,_label:"NLS_selectionAddLbl"},selectremove:{id:"btnSubtractFromSelection",_enabledIcon:"toolbarIcon removeFromSelectionIcon",_disabledIcon:"toolbarIcon removeFromSelectionIcon",_drawType:d.EXTENT,_selectMethod:a.SELECTION_SUBTRACT,
_label:"NLS_selectionRemoveLbl"},selectClear:{id:"btnClearSelection",_enabledIcon:"toolbarIcon clearSelectionIcon",_disabledIcon:"toolbarIcon clearSelectionIcon",_enabled:!1,_label:"NLS_selectionClearLbl"}};return l("extend-esri")&&h.setObject("dijit.editing.tools.SelectionTools",a,b),a})},"esri/dijit/editing/SelectionHelper":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/has dojo/DeferredList ../../geometry/Extent ../../geometry/Point ../../geometry/ScreenPoint ../../layers/FeatureLayer ../../tasks/query ../../kernel".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n){h=h(null,{declaredClass:"esri.dijit.editing.SelectionHelper",constructor:function(a){this._settings=a||{};this._sConnects=[];this._mapServiceCount=0;this._map=this._settings.map;this._tolerance=this._settings.singleSelectionTolerance;this._initMapServiceInfos(this._settings.layers)},destroy:function(){for(var b in this._sConnects)this._sConnects.hasOwnProperty(b)&&a.disconnect(this._sConnects[b])},selectFeatures:function(a,b,c,g){c===e.SELECTION_NEW&&(this._resetMapServiceInfos(),
this.getSelection(a));var k=[];d.forEach(a,function(a){if(!0===a.visible&&!0===a._isMapAtVisibleScale()){var d=c;a._isSelOnly&&d===e.SELECTION_NEW&&(d=e.SELECTION_ADD);k.push(a.selectFeatures(b,d))}});(new f(k)).addCallback(l.hitch(this,function(b){var f=[];if(d.forEach(b,function(b,c){d.forEach(b[1],function(b){(b=a[c]._mode._getFeature(b.attributes[a[c].objectIdField])||null)&&f.push(b)},this)},this),!this._mapServiceCount)return void g(f);(b=c===e.SELECTION_SUBTRACT)?(this._resetMapServiceInfos(),
this._createLayerDefs(this._getLayerInfosFromSelection(a))):this._createLayerDefs(this._getLayerInfosFromFeatures(f));this._updateLayerDefs(this._mapServiceInfos,!1,!(f&&f.length||b),l.hitch(this,g,f))}))},selectFeaturesByGeometry:function(a,b,d,e){var f=b;-1!==b.declaredClass.indexOf("Extent")&&b.xmax===b.xmin&&b.ymax===b.ymin&&(f=new m(b.xmax,b.ymax,b.spatialReference));f=-1!==f.declaredClass.indexOf("Point")?this._extentFromPoint(f):f;b=new c;b.geometry=f;this.selectFeatures(a,b,d,e)},clearSelection:function(a){if(d.forEach(this._nonSelOnlyLayers,
function(a){a.clearSelection&&a.clearSelection()}),this._mapServiceCount){this._resetMapServiceInfos();var b=this._getLayerInfosFromSelection(this._settings.layers);d.some(b,function(a){return a.oids&&a.oids.length})&&(this._createLayerDefs(b),this._updateLayerDefs(this._mapServiceInfos,!0,a||!1))}},findMapService:function(a){var b,c,d,e=this._map,f=e.layerIds;a=a&&a._url&&a._url.path?a._url.path.toLowerCase():"";for(c in f)if(f.hasOwnProperty(c)&&(b=e.getLayer(f[c]),d=b._url?b._url.path?b._url.path.toLowerCase().replace("mapserver",
"featureserver"):b._url.toLowerCase().replace("mapserver","featureserver"):"",a.substr(0,d.length)===d&&"esri.layers.ArcGISDynamicMapServiceLayer"===b.declaredClass))return b},getSelection:function(a){var b=[];d.forEach(a,function(a){a._isSelOnly&&b.push(this._createLayerInfo(a))},this);d.forEach(b,function(a){var b=this._createMapServiceInfo(this.findMapService(a.layer));b&&(b.layerInfos[a.layer.layerId]=a)},this)},_initMapServiceInfos:function(a){this._nonSelOnlyLayers=[];this._mapServiceInfos=
[];d.forEach(a,function(a){var b=this.findMapService(a);b?(this._mapServiceCount++,this._createMapServiceInfo(b),b&&b.setDisableClientCaching(!0)):this._nonSelOnlyLayers.push(a)},this)},_createMapServiceInfo:function(a){if(!a)return null;var b=this._mapServiceInfos,c=b[a.id];return c||(c=b[a.id]={mapService:a,layerInfos:[],layerDefs:l.mixin([],a.layerDefinitions||[]),origLayerDefs:l.mixin([],a.layerDefinitions||[])}),c},_resetMapServiceInfo:function(a){d.forEach(a.layerInfos,this._resetLayerInfo);
a.layerDefs=l.mixin([],a.origLayerDefs||[])},_resetMapServiceInfos:function(){var a,b=this._mapServiceInfos;for(a in b)b.hasOwnProperty(a)&&this._resetMapServiceInfo(b[a])},_createLayerInfo:function(a,b){var c=a.objectIdField,e=b?[]:a.getSelectedFeatures();return{layer:a,selectedFeatures:e||[],oids:d.map(e,function(a){return a.attributes[c]})}},_resetLayerInfo:function(a){a&&(a.selectedFeatures=[],a.oids=[])},_updateLayerDefs:function(b,c,d,e){for(var f in b)if(b.hasOwnProperty(f)){var g=b[f],k=g.mapService,
h=g.layerDefs=c?l.mixin([],g.origLayerDefs||[]):g.layerDefs;h?(d?e&&e():this._sConnects[k.id]=a.connect(k,"onUpdateEnd",l.hitch(this,"_onMapServiceUpdate",g,c,e)),k.setLayerDefinitions(h,d||!1)):e&&e()}},_onMapServiceUpdate:function(b,f,g){a.disconnect(this._sConnects[b.mapService.id]);d.forEach(b.layerInfos,function(a){if(f)a&&a.layer.clearSelection();else{var b=new c;b.objectIds=a?a.oids:[];b.objectIds.length&&a.layer.selectFeatures(b,e.SELECTION_SUBTRACT)}},this);f&&this._resetMapServiceInfo(b);
g&&g()},_createLayerDefs:function(a){d.forEach(a,function(a){var b=a.layer,c=this._createMapServiceInfo(this.findMapService(a.layer));if(c){var c=(c.mapService,c.layerDefs),e=b.layerId,f='("'+b.objectIdField+'" NOT IN (',g=a.oids;g&&g.length&&(d.forEach(a.oids,function(a,b){g=!0;b&&(f+=",");f+="'"+a+"'"}),f+="))",c.length&&c[e]&&c[e].length?c[e]+=" AND"+f:c[e]=f)}},this)},_getLayerInfosFromFeatures:function(a){var b=[];d.forEach(a,function(a){var c=a.getLayer();c&&c._isSelOnly&&(b[c.id]||(b[c.id]=
this._createLayerInfo(c,!0)),b[c.id].selectedFeatures.push(a),b[c.id].oids.push(a.attributes[c.objectIdField]))},this);var c;a=[];for(c in b)b.hasOwnProperty(c)&&a.push(b[c]);return a},_getLayerInfosFromSelection:function(a){var b=[];return d.forEach(a,function(a){a._isSelOnly&&b.push(this._createLayerInfo(a,!1))},this),b},_extentFromPoint:function(a){var b=this._tolerance,c=this._map,d=c.toScreen(a);a=new g(d.x-b,d.y+b);b=new g(d.x+b,d.y-b);a=c.toMap(a);b=c.toMap(b);return new k(a.x,a.y,b.x,b.y,
c.spatialReference)}});return b("extend-esri")&&l.setObject("dijit.editing.SelectionHelper",h,n),h})},"esri/dijit/editing/TemplatePicker":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/html dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/has dojo/query dojo/sniff dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/_Widget dijit/_Templated dojo/data/ItemFileReadStore dojox/grid/DataGrid dojox/gfx ../../layers/FeatureLayer ../../symbols/SimpleMarkerSymbol ../../symbols/PictureMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ./TemplatePickerItem ../../kernel ../../lang ../../request ../_EventedWidget dojo/i18n!../../nls/jsapi dojo/text!./templates/TemplatePicker.html".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K,J){var I=h([G,u,v],{declaredClass:"esri.dijit.editing.TemplatePicker",widgetsInTemplate:!0,templateString:J,featureLayers:null,items:null,grouping:!0,showTooltip:!1,maxLabelLength:0,rows:4,_rows:0,columns:3,surfaceWidth:30,surfaceHeight:30,emptyMessage:"",useLegend:!0,legendCache:{},_uniqueId:{id:0},_assumedCellWidth:90,_initialAutoWidth:300,_initialAutoHeight:200,_ieTimer:150,constructor:function(a,b){a=a||{};a.items||a.featureLayers||
console.error("TemplatePicker: please provide 'featureLayers' or 'items' parameter in the constructor");this._dojo14x=4<=k.version.minor;this._itemWidgets={};a.featureLayers&&a.featureLayers.length&&(this._flChanged=1);this._nls=K.widgets.templatePicker;this.emptyMessage=a.emptyMessage||this._nls&&this._nls.creationDisabled||""},postMixInProperties:function(){this.inherited(arguments);this._preprocess()},startup:function(){if(this.inherited(arguments),"auto"===this.rows&&"auto"===this.columns){var b=
q.getContentBox(this.domNode);b.w||(this.domNode.style.width=this._initialAutoWidth+"px");(!b.h||1>=b.h)&&(this.domNode.style.height=this._initialAutoHeight+"px");b=q.getContentBox(this.domNode);this._columns=Math.floor(b.w/this._assumedCellWidth)||1}this._applyGridPatches();this._setGridLayout();a.connect(this.grid,"onRowClick",this,this._rowClicked);this._setGridData();this._toggleTooltip();9>m("ie")&&(this._repaintItems=l.hitch(this,this._repaintItems),setTimeout(this._repaintItems,this._ieTimer))},
destroy:function(){this.showTooltip=!1;this._toggleTooltip();this._clearLegendInfo();this.featureLayers=this.items=this.grid=this._flItems=this._itItems=this._groupRowIndices=this._selectedCell=this._selectedInfo=this._selectedItem=null;this.inherited(arguments)},getSelected:function(){return this._selectedCell?this._selectedItem:null},clearSelection:function(){var a=this._selectedCell,b=this._selectedInfo;a&&this._rowClicked({cellNode:a,rowIndex:b.selRow,cellIndex:b.selCol})},update:function(a){var b;
a="auto"===this.rows&&"auto"===this.columns&&a?!0:!1;var c=this.grid;if(a){var e;b=this.domNode;e=k.query("#"+b.id+".templatePicker div.item")[0];b=q.getContentBox(b);e=(e=e&&e.parentNode)?d.coords(e).w:this._assumedCellWidth;this._columns=(this._columns=Math.floor((b.w-c.views.views[0].getScrollbarWidth())/e))||1}e=this._rows;this._preprocess();var f=this._rows;this._setGridLayout();this._setGridData();f!==e&&c.set("autoHeight",this._rows,!1);a?(c._resize({w:b.w,h:b.h}),c.viewsHeaderNode.style.display=
"none"):c.update();this._toggleTooltip();var g=this,h=this.getSelected();h&&c.store.fetch({onComplete:function(a){var b=(a=g._locate(h,g._selectedInfo,a))&&c.views.views[0].getCellNode(a[0],a[1]);b&&g._rowClicked({cellNode:b,rowIndex:a[0],cellIndex:a[1]},!0)}});9>m("ie")&&setTimeout(this._repaintItems,this._ieTimer);b=this.featureLayers;a=this.items;b&&b.length||a&&a.length||!c||!this.emptyMessage||c.showMessage(this.emptyMessage)},_eventMap:{"selection-change":!0},onSelectionChange:function(){},
_setUseLegendAttr:function(a){var b=this.useLegend;this._started&&b===a||(a?this._flChanged=1:this._clearLegendInfo());this.useLegend=a},_setFeatureLayersAttr:function(a){var b=this.featureLayers;this._started&&b===a||(this._flChanged=1);this.featureLayers=a},_adjustRowsCols:function(a){if("auto"===this.rows&&"auto"===this.columns)return void(this._started||(this._rows=!1,this._columns=null,this._autoWidth=!1));var c=0;this._rows=this.rows;this._columns=this.columns;"auto"===this.rows?(this.featureLayers?
this.grouping?(c=a.length,b.forEach(a,function(a){c+=Math.ceil(a.length/this.columns)},this)):(b.forEach(a,function(a){c+=a.length},this),c=Math.ceil(c/this.columns)):c=Math.ceil(a.length/this.columns),this._rows=c):"auto"===this.columns&&(this.featureLayers?this.grouping?c=3:(b.forEach(a,function(a){c+=a.length},this),c=Math.ceil(c/this.rows)):c=Math.ceil(a.length/this.rows),this._columns=c)},_preprocess:function(){this.items&&(this.grouping=!1);this._autoWidth=!1;"auto"!==this.rows&&"auto"!==this.columns||
(this._autoWidth=!0);var c;if(this.featureLayers)if(this.useLegend&&this._flChanged&&(this._legendIndices=[],this._loadingIndices=[],this._legendSymbols={},this._ignoreLegends(),this._loadingLegends=[],clearTimeout(this._legendTimer),this._legendTimer=null,this._processSelectionLayers(),this._flChanged=0),b.every(this.featureLayers,function(a){return a.loaded}))c=this._flItems=this._getItemsFromLayers(this.featureLayers),this._adjustRowsCols(c);else{var d=this.featureLayers.length;b.forEach(this.featureLayers,
function(b){if(b.loaded)d--;else var c=a.connect(b,"onLoad",this,function(){a.disconnect(c);c=null;d--;d||this.update()})},this)}else c=this._itItems=this._getItemsFromItems(this.items),this._adjustRowsCols(c)},_processSelectionLayers:function(){var a,c,d,e,f,g,k,h={};b.forEach(this.featureLayers,function(b,f){b.mode===y.MODE_SELECTION&&b._map&&b.url&&b._params.drawMode&&!b.source&&(c=l.trim(b._url.path).replace(/\/(MapServer|FeatureServer).*/gi,"/MapServer").replace(/^https?:\/\//gi,"").toLowerCase(),
d=h[c]=h[c]||{},e=d.featureLayers=d.featureLayers||{},g=d.indices=d.indices||[],e[f]=b,g.push(f),a=b._map)});a&&b.forEach(a.layerIds,function(b){(b=a.getLayer(b))&&b.url&&(b.getImageUrl||b.getTileUrl)&&b.loaded&&10.1<=b.version&&(c=l.trim(b._url.path).replace(/(\/MapServer).*/gi,"$1"),f=c.replace(/^https?:\/\//gi,"").toLowerCase(),h[f]&&!h[f].mapServiceUrl&&(d=h[f],d.mapServiceUrl=c,d.mapServiceLayer=b,this._legendIndices=this._legendIndices.concat(d.indices),k=this._fetchLegend({pickerInstance:this,
info:d},f),k.then?(this._loadingIndices=this._loadingIndices.concat(d.indices),this._loadingLegends.push(k)):this._processLegendResponse(k,d)))},this)},_fetchLegend:function(a,c){var d=I.prototype,e=d.legendCache[c];return e?e.then&&e._contexts.push(a):(e=d.legendCache[c]=H({url:a.info.mapServiceUrl+"/legend",content:{f:"json"},callbackParamName:"callback"}),e._contexts=[a],e.addBoth(function(a){if(!e.canceled){d.legendCache[c]=a;var f=e._contexts;e._contexts=null;b.forEach(f,function(c){var d,f=
c.pickerInstance;c=c.info;f._destroyed||(b.forEach(c.indices,function(a){d=b.indexOf(f._loadingIndices,a);-1<d&&f._loadingIndices.splice(d,1)}),d=b.indexOf(f._loadingLegends,e),-1<d&&f._loadingLegends.splice(d,1),f._processLegendResponse(a,c))})}})),e},_clearLegendInfo:function(){clearTimeout(this._legendTimer);this._ignoreLegends();this._legendIndices=this._loadingIndices=this._legendSymbols=this._loadingLegends=this._legendTimer=null},_ignoreLegends:function(){this._loadingLegends&&b.forEach(this._loadingLegends,
function(a){var c=-1;b.some(a._contexts,function(a,b){return a.pickerInstance===this&&(c=b),-1<c},this);-1<c&&a._contexts.splice(c,1)},this)},_processLegendResponse:function(a,c){if(!a||a instanceof Error){var d;b.forEach(c.indices,function(a){d=b.indexOf(this._legendIndices,a);-1<d&&this._legendIndices.splice(d,1)},this)}else b.forEach(c.indices,function(d){var e,f,g,k,h,m=c.featureLayers[d].layerId,l=c.mapServiceUrl+"/"+m+"/images/",n=c.mapServiceLayer._getToken();this._legendSymbols[d]||(f=null,
b.some(a.layers,function(a){return a.layerId==m&&(f=a),!!f}),f&&(g=this._legendSymbols[d]={},b.forEach(f.legend,function(a){if(k=a.values,k&&k.length)for(e=0;e<k.length;e++)g[k[e]]=a;else g.defaultSymbol=a;(h=a.url)&&!a._fixed&&(a._fixed=1,-1===h.search(/https?\:/)&&(a.url=l+h),n&&-1!==a.url.search(/https?\:/)&&(a.url+=(-1<a.url.indexOf("?")?"\x26":"?")+"token\x3d"+n))})))},this);var e=this;e._started&&!e._legendTimer&&(e._legendTimer=setTimeout(function(){clearTimeout(e._legendTimer);e._legendTimer=
null;e._destroyed||e.update()},0))},_applyGridPatches:function(){var b,c,d,e=this.grid,f=e.adaptWidth;if(e.adaptWidth=function(){b=this.views.views;for(c=0;d=b[c];c++)r.set(d.headerNode,"display","block");f.apply(this,arguments);for(c=0;d=b[c];c++)r.set(d.headerNode,"display","none")},this._dojo14x){if("auto"!==this.rows&&"auto"!==this.columns)var g=a.connect(e,"_onFetchComplete",this,function(){a.disconnect(g);this.grid.set("autoHeight",this._rows)});a.connect(e,"_onDelete",this,this._destroyItems);
a.connect(e,"_clearData",this,this._destroyItems);a.connect(e,"destroy",this,this._destroyItems);(e=e.focus)&&e.findAndFocusGridCell&&(e.findAndFocusGridCell=function(){return!1})}},_setGridLayout:function(){var a,b=function(a){return function(b,c){return this._cellGet(a,b,c)}},c=l.hitch(this,this._cellFormatter),d=[],e=this._columns;for(a=0;e>a;a++)d.push({field:"cell"+a,get:l.hitch(this,b(a)),formatter:c});a={cells:[d]};this.grouping&&(e={field:"groupName",colSpan:e,get:l.hitch(this,this._cellGetGroup),
formatter:l.hitch(this,this._cellGroupFormatter)},a.cells.push([e]));e=this.grid;b=w.prototype.rowsPerPage;e.set("rowsPerPage",this._rows>b?this._rows:b);e.set("structure",a)},_setGridData:function(){var a=[];if(this.grouping){this._groupRowIndices=[];var c,d,e=this._columns;b.forEach(this._flItems,function(b,f){a.push({});var g=0===f?0:c+d+1;this._groupRowIndices.push(g);c=g;d=Math.ceil(b.length/e);a=a.concat(this._getStoreItems(b))},this)}else this.featureLayers?(b.forEach(this._flItems,function(b){a=
a.concat(b)}),a=this._getStoreItems(a)):a=this._getStoreItems(this._itItems);var f=new t({data:{items:a}});this.grid.setStore(f)},_toggleTooltip:function(){if(this.showTooltip){if(!this.tooltip){this.tooltip=n.create("div",{"class":"tooltip"},this.domNode);this.tooltip.style.display="none";this.tooltip.style.position="fixed";var b=this.grid;this._mouseOverConnect=a.connect(b,"onCellMouseOver",this,this._cellMouseOver);this._mouseOutConnect=a.connect(b,"onCellMouseOut",this,this._cellMouseOut)}}else this.tooltip&&
(a.disconnect(this._mouseOverConnect),a.disconnect(this._mouseOutConnect),n.destroy(this.tooltip),this.tooltip=null)},_rowClicked:function(a,b){var d=a.cellNode,e=a.rowIndex,f=a.cellIndex,g=this._getCellInfo(d,e,f);if(g){var k=this.grid.store;k.getValue(g,"loadingCell")||(this._selectedCell&&c.remove(this._selectedCell,"selectedItem"),d!==this._selectedCell?(c.add(d,"selectedItem"),this._selectedCell=d,this._selectedItem={featureLayer:k.getValue(g,"layer"),type:k.getValue(g,"type"),template:k.getValue(g,
"template"),symbolInfo:k.getValue(g,"symbolInfo"),item:this._getItem(g)},this._selectedInfo={selRow:e,selCol:f,index1:k.getValue(g,"index1"),index2:k.getValue(g,"index2"),index:k.getValue(g,"index")}):this._selectedCell=this._selectedInfo=this._selectedItem=null,b||this.onSelectionChange())}},_locate:function(a,c,d){var e,f=this.grid.store,g=Array(this._columns),k=c.index1,h=c.index2,m=c.index,l=a.item;return b.some(d,function(a,c){return b.some(g,function(b,d){var g=f.getValue(a,"cell"+d);return g&&
(l?m===f.getValue(g,"index"):k===f.getValue(g,"index1")&&h===f.getValue(g,"index2"))?(e=[c,d],!0):!1})}),e},_getCellInfo:function(a,b,c){if(a)return a=this.grid,b=a.getItem(b),a.store.getValue(b,"cell"+c)},_getItem:function(a){var b=this.items;return b?b[this.grid.store.getValue(a,"index")]:void 0},_cellMouseOver:function(a){var b=this.tooltip,c=a.cellNode,e=this._getCellInfo(c,a.rowIndex,a.cellIndex);if(b&&e){var f=this.grid.store;a=f.getValue(e,"template");var g=f.getValue(e,"type"),k=f.getValue(e,
"symbolInfo"),f=f.getValue(e,"layer");a=(e=this._getItem(e))&&e.label+(e.description?": "+e.description:"")||a&&a.name+(a.description?": "+a.description:"")||g&&g.name||k&&k.label+(k.description?": "+k.description:"")||(f&&f.name+": ")+"Default";b.style.display="none";b.innerHTML=a;c=d.coords(c.firstChild);r.set(b,{left:c.x+"px",top:c.y+c.h+5+"px"});b.style.display=""}},_cellMouseOut:function(){var a=this.tooltip;a&&(a.style.display="none")},_destroyItems:function(){var a,b=this._itemWidgets;for(a in b)b[a]&&
(b[a].destroy(),delete b[a])},_repaintItems:function(){var a,b=this._itemWidgets;for(a in b){var c=b[a];c&&c._repaint(c._surface)}},_getStoreItems:function(a){var c=this._uniqueId;a=b.map(a,function(a){return l.mixin({surfaceId:"tpick-surface-"+c.id++},a)});for(var d,e=a.length,f=0,g={},k=0,h=[],m=!0,n=this._columns;e>f;)m=!0,d="cell"+k,g[d]=a[f],f++,k++,0===k%n&&(m=!1,h.push(g),g={},k=0);return m&&e&&h.push(g),h},_getItemsFromLayers:function(a){var c=[];return b.forEach(a,function(a,b){c.push(this._getItemsFromLayer(a,
b))},this),c},_getItemsFromLayer:function(a,c){var d=[];if(this.useLegend&&-1<b.indexOf(this._loadingIndices,c))return[{label:this._nls&&this._nls.loading||"",symbol:null,layer:a,type:null,template:null,index1:c,index2:0,loadingCell:1}];var g=[],g=g.concat(a.templates);b.forEach(a.types,function(a){var c=a.templates;b.forEach(c,function(b){b._type_=a});g=g.concat(c)});var g=b.filter(g,F.isDefined),k=a.renderer;if(k){var h=k.declaredClass.replace("esri.renderer.","");if(0<g.length)b.forEach(g,function(g){var m=
g.prototype;if(m){var l;if(l=k.valueExpression?this._createSimpleSymbol(a):this._isUnclassedRenderer(k)?k.infos[0].symbol:k.getSymbol(m)){var n,r,q=null;if(9>e("ie")||!g.thumbnail||!g.thumbnail.imageData){if(this.useLegend&&-1<b.indexOf(this._legendIndices,c)){if(r=this._legendSymbols&&this._legendSymbols[c])switch(h){case "SimpleRenderer":q=r.defaultSymbol;break;case "UniqueValueRenderer":b.some(k.infos,function(a){return a.symbol===l&&(q=r[a.value]),!!q});break;case "ClassBreaksRenderer":b.some(k.infos,
function(a){return a.symbol===l&&(q=r[a.maxValue]),!!q})}q&&(n=f.fromJson(f.toJson(A.defaultProps)),n.url=q.url,n.imageData=q.imageData,n.contentType=q.contentType,n.width=q.width,n.height=q.height,F.isDefined(n.width)&&F.isDefined(n.height)||(n.width=15,n.height=15),q=new A(n))}}else q=new A(g.thumbnail);d.push({label:this._trimLabel(g.name),symbol:q||l,legendOverride:!!q,layer:a,type:g._type_,template:g,index1:c,index2:d.length})}else switch(h){case "HeatmapRenderer":d.push({label:this._trimLabel(g.name),
symbol:new z,legendOverride:!!q,layer:a,type:g._type_,template:g,index1:c,index2:d.length})}}delete g._type_},this);else{var m=[];switch("TemporalRenderer"===h&&(k=k.observationRenderer,k&&(h=k.declaredClass.replace("esri.renderer.",""))),h){case "SimpleRenderer":m=[{symbol:k.symbol,label:k.label,description:k.description}];break;case "UniqueValueRenderer":case "ClassBreaksRenderer":m=k.infos}d=b.map(m,function(b,d){return{label:this._trimLabel(b.label),description:b.description,symbolInfo:l.mixin({constructor:function(){}},
b),symbol:b.symbol,layer:a,index1:c,index2:d}},this)}}return d},_isUnclassedRenderer:function(a){return!!((a.hasVisualVariables("sizeInfo",!1)||a.hasVisualVariables("colorInfo",!1)||a.hasVisualVariables("opacityInfo",!1))&&a.addBreak&&a.infos&&1===a.infos.length)},_createSimpleSymbol:function(a){var b;switch(a.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":b=new z;break;case "esriGeometryPolyline":b=new C;break;case "esriGeometryPolygon":b=new B;break;default:a.hasXYFootprint&&
a.hasXYFootprint()&&(b=new B)}return b},_getItemsFromItems:function(a){return b.map(a,function(a,b){return a=l.mixin({index:b},a),a.label=this._trimLabel(a.label),a},this)},_trimLabel:function(a){var b=this.maxLabelLength;return b&&a&&a.length>b&&(a=a.substr(0,b)+"..."),a||""},_cellGet:function(a,b,c){return c?this.grid.store.getValue(c,"cell"+a):""},_cellFormatter:function(a){if(a){var b=this._itemWidgets,c=this.grid.store,d=c.getValue(a,"surfaceId"),e=b[d];return e||(e=b[d]=new D({id:d,label:c.getValue(a,
"label"),symbol:c.getValue(a,"symbol"),legendOverride:c.getValue(a,"legendOverride"),surfaceWidth:this.surfaceWidth,surfaceHeight:this.surfaceHeight,template:c.getValue(a,"template")})),e||""}return""},_cellGetGroup:function(a,c){if(!this._groupRowIndices)return"";var d,e=b.indexOf(this._groupRowIndices,a);return c&&-1!==e?(d=this.featureLayers[e],d&&(this.groupLabelFunction?this.groupLabelFunction(d):d.name)||""):""},_cellGroupFormatter:function(a){return a?"\x3cdiv class\x3d'groupLabel'\x3e"+a+
"\x3c/div\x3e":""}});return m("extend-esri")&&l.setObject("dijit.editing.TemplatePicker",I,E),I})},"dojox/grid/DataGrid":function(){define("../main dojo/_base/array dojo/_base/lang dojo/_base/json dojo/_base/sniff dojo/_base/declare ./_Grid ./DataSelection dojo/_base/html dojo/has dojo/has!dojo-bidi?./bidi/_BidiMixin".split(" "),function(h,l,a,d,b,f,k,m,g){var e=f("dojox.grid.DataGrid",k,{store:null,query:null,queryOptions:null,fetchText:"...",sortFields:null,updateDelay:1,items:null,_store_connects:null,
_by_idty:null,_by_idx:null,_cache:null,_pages:null,_pending_requests:null,_bop:-1,_eop:-1,_requests:0,rowCount:0,_isLoaded:!1,_isLoading:!1,keepSelection:!1,postCreate:function(){this._pages=[];this._store_connects=[];this._by_idty={};this._by_idx=[];this._cache=[];this._pending_requests={};this._setStore(this.store);this.inherited(arguments)},destroy:function(){this.selection.destroy();this.inherited(arguments)},createSelection:function(){this.selection=new m(this)},get:function(a,b){if(b&&"_item"==
this.field&&!this.fields)return b;if(b&&this.fields){var d=[],e=this.grid.store;l.forEach(this.fields,function(a){d=d.concat(e.getValues(b,a))});return d}return b||"string"!==typeof a?b?this.field?"_item"==this.field?b:this.grid.store.getValue(b,this.field):this.value:this.defaultValue:this.inherited(arguments)},_checkUpdateStatus:function(){if(0<this.updateDelay){var a=!1;this._endUpdateDelay&&(clearTimeout(this._endUpdateDelay),delete this._endUpdateDelay,a=!0);this.updating||(this.beginUpdate(),
a=!0);if(a){var b=this;this._endUpdateDelay=setTimeout(function(){delete b._endUpdateDelay;b.endUpdate()},this.updateDelay)}}},_onSet:function(a,b,d,e){this._checkUpdateStatus();a=this.getItemIndex(a);-1<a&&this.updateRow(a)},_createItem:function(a,b){var e=this._hasIdentity?this.store.getIdentity(a):d.toJson(this.query)+":idx:"+b+":sort:"+d.toJson(this.getSortProps());return this._by_idty[e]={idty:e,item:a}},_addItem:function(a,b,d){this._by_idx[b]=this._createItem(a,b);d||this.updateRow(b)},_onNew:function(a,
b){this._checkUpdateStatus();var d=this.get("rowCount");this._addingItem=!0;this.updateRowCount(d+1);this._addingItem=!1;this._addItem(a,d);this.showMessage()},_onDelete:function(a){this._checkUpdateStatus();a=this._getItemIndex(a,!0);if(0<=a){this._pages=[];this._eop=this._bop=-1;var b=this._by_idx[a];this._by_idx.splice(a,1);delete this._by_idty[b.idty];this.updateRowCount(this.get("rowCount")-1);0===this.get("rowCount")&&this.showMessage(this.noDataMessage)}this.selection.isSelected(a)&&(this.selection.deselect(a),
this.selection.selected.splice(a,1))},_onRevert:function(){this._refresh()},setStore:function(a,b,d){this._requestsPending(0)||(this._setQuery(b,d),this._setStore(a),this._refresh(!0))},setQuery:function(a,b){this._requestsPending(0)||(this._setQuery(a,b),this._refresh(!0))},setItems:function(a){this.items=a;this._setStore(this.store);this._refresh(!0)},_setQuery:function(a,b){this.query=a;this.queryOptions=b||this.queryOptions},_setStore:function(a){this.store&&this._store_connects&&l.forEach(this._store_connects,
this.disconnect,this);if(this.store=a){a=this.store.getFeatures();var b=[];this._canEdit=!!a["dojo.data.api.Write"]&&!!a["dojo.data.api.Identity"];this._hasIdentity=!!a["dojo.data.api.Identity"];a["dojo.data.api.Notification"]&&!this.items&&(b.push(this.connect(this.store,"onSet","_onSet")),b.push(this.connect(this.store,"onNew","_onNew")),b.push(this.connect(this.store,"onDelete","_onDelete")));this._canEdit&&b.push(this.connect(this.store,"revert","_onRevert"));this._store_connects=b}},_onFetchBegin:function(a,
b){this.scroller&&(this.rowCount!=a&&(b.isRender?(this.scroller.init(a,this.keepRows,this.rowsPerPage),this.rowCount=a,this._setAutoHeightAttr(this.autoHeight,!0),this._skipRowRenormalize=!0,this.prerender(),this._skipRowRenormalize=!1):this.updateRowCount(a)),a?this.showMessage():(this.views.render(),this._resize(),this.showMessage(this.noDataMessage),this.focus.initFocusView()))},_onFetchComplete:function(a,d){this.scroller&&(a&&0<a.length&&(l.forEach(a,function(a,b){this._addItem(a,d.start+b,!0)},
this),this.updateRows(d.start,a.length),d.isRender?(this.setScrollTop(0),this.postrender()):this._lastScrollTop&&this.setScrollTop(this._lastScrollTop),b("ie")&&g.setSelectable(this.domNode,this.selectable)),delete this._lastScrollTop,this._isLoaded||(this._isLoading=!1,this._isLoaded=!0),this._pending_requests[d.start]=!1)},_onFetchError:function(a,b){delete this._lastScrollTop;this._isLoaded||(this._isLoading=!1,this._isLoaded=!0,this.showMessage(this.errorMessage));this._pending_requests[b.start]=
!1;this.onFetchError(a,b)},onFetchError:function(a,b){},_fetch:function(b,d){b=b||0;if(this.store&&!this._pending_requests[b]){this._isLoaded||this._isLoading||(this._isLoading=!0,this.showMessage(this.loadingMessage));this._pending_requests[b]=!0;try{if(this.items){var e=this.items,f=this.store;this.rowsPerPage=e.length;var g={start:b,count:this.rowsPerPage,isRender:d};this._onFetchBegin(e.length,g);var k=0;l.forEach(e,function(a){f.isItemLoaded(a)||k++});if(0===k)this._onFetchComplete(e,g);else{var h=
function(a){k--;0===k&&this._onFetchComplete(e,g)};l.forEach(e,function(a){f.isItemLoaded(a)||f.loadItem({item:a,onItem:h,scope:this})},this)}}else this.store.fetch({start:b,count:this.rowsPerPage,query:this.query,sort:this.getSortProps(),queryOptions:this.queryOptions,isRender:d,onBegin:a.hitch(this,"_onFetchBegin"),onComplete:a.hitch(this,"_onFetchComplete"),onError:a.hitch(this,"_onFetchError")})}catch(m){this._onFetchError(m,{start:b,count:this.rowsPerPage})}}},_clearData:function(){this.updateRowCount(0);
this._by_idty={};this._by_idx=[];this._pages=[];this._bop=this._eop=-1;this._isLoading=this._isLoaded=!1},getItem:function(a){var b=this._by_idx[a];return!b||b&&!b.item?(this._preparePage(a),null):b.item},getItemIndex:function(a){return this._getItemIndex(a,!1)},_getItemIndex:function(a,b){if(!b&&!this.store.isItem(a))return-1;for(var d=this._hasIdentity?this.store.getIdentity(a):null,e=0,f=this._by_idx.length;e<f;e++){var g=this._by_idx[e];if(g&&(d&&g.idty==d||g.item===a))return e}return-1},filter:function(a,
b){this.query=a;b&&this._clearData();this._fetch()},_getItemAttr:function(a,b){var d=this.getItem(a);return d?this.store.getValue(d,b):this.fetchText},_render:function(){this.domNode.parentNode&&(this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage),this.prerender(),this._fetch(0,!0))},_requestsPending:function(a){return this._pending_requests[a]},_rowToPage:function(a){return this.rowsPerPage?Math.floor(a/this.rowsPerPage):a},_pageToRow:function(a){return this.rowsPerPage?this.rowsPerPage*
a:a},_preparePage:function(a){(a<this._bop||a>=this._eop)&&!this._addingItem&&(a=this._rowToPage(a),this._needPage(a),this._bop=a*this.rowsPerPage,this._eop=this._bop+(this.rowsPerPage||this.get("rowCount")))},_needPage:function(a){this._pages[a]||(this._pages[a]=!0,this._requestPage(a))},_requestPage:function(b){b=this._pageToRow(b);0<Math.min(this.rowsPerPage,this.get("rowCount")-b)&&(this._requests++,this._requestsPending(b)||setTimeout(a.hitch(this,"_fetch",b,!1),1))},getCellName:function(a){return a.field},
_refresh:function(a){this._clearData();this._fetch(0,a)},sort:function(){this.edit.apply();this._lastScrollTop=this.scrollTop;this._refresh()},canSort:function(){return!this._isLoading},getSortProps:function(){var a=this.getCell(this.getSortIndex());if(a){var b=a.sortDesc,d=!(0<this.sortInfo);return[{attribute:a.field,descending:"undefined"==typeof b?d:d?!b:b}]}return this.sortFields?this.sortFields:null},styleRowState:function(a){if(this.store&&this.store.getState){for(var b=this.store.getState(a.index),
d="",e=0,f=["inflight","error","inserting"],g;g=f[e];e++)if(b[g]){d=" dojoxGridRow-"+g;break}a.customClasses+=d}},onStyleRow:function(a){this.styleRowState(a);this.inherited(arguments)},canEdit:function(a,b){return this._canEdit},_copyAttr:function(a,b){var d=this.getItem(a);return this.store.getValue(d,b)},doStartEdit:function(a,b){this._cache[b]||(this._cache[b]=this._copyAttr(b,a.field));this.onStartEdit(a,b)},doApplyCellEdit:function(b,d,e){this.store.fetchItemByIdentity({identity:this._by_idx[d].idty,
onItem:a.hitch(this,function(a){var f=this.store.getValue(a,e);"number"==typeof f?b=isNaN(b)?b:parseFloat(b):"boolean"==typeof f?b="true"==b?!0:"false"==b?!1:b:f instanceof Date&&(f=new Date(b),b=isNaN(f.getTime())?b:f);this.store.setValue(a,e,b);this.onApplyCellEdit(b,d,e)})})},doCancelEdit:function(a){this._cache[a]&&(this.updateRow(a),delete this._cache[a]);this.onCancelEdit.apply(this,arguments)},doApplyEdit:function(a,b){this.onApplyEdit(a)},removeSelectedRows:function(){if(this._canEdit){this.edit.apply();
var b=a.hitch(this,function(a){a.length&&(l.forEach(a,this.store.deleteItem,this.store),this.selection.clear())});this.allItemsSelected?this.store.fetch({query:this.query,queryOptions:this.queryOptions,onComplete:b}):b(this.selection.getSelected())}}});e.cell_markupFactory=function(b,d,e){var f=a.trim(g.attr(d,"field")||"");f&&(e.field=f);e.field=e.field||e.name;if(f=a.trim(g.attr(d,"fields")||""))e.fields=f.split(",");b&&b(d,e)};e.markupFactory=function(b,d,f,g){return k.markupFactory(b,d,f,a.partial(e.cell_markupFactory,
g))};return e})},"dojox/grid/_Grid":function(){define("dojo/_base/kernel ../main dojo/_base/declare ./_Events ./_Scroller ./_Layout ./_View ./_ViewManager ./_RowManager ./_FocusManager ./_EditManager ./Selection ./_RowSelector ./util dijit/_Widget dijit/_TemplatedMixin dijit/CheckedMenuItem dojo/text!./resources/_Grid.html dojo/string dojo/_base/array dojo/_base/lang dojo/_base/sniff dojox/html/metrics dojo/_base/html dojo/query dojo/dnd/common dojo/i18n!dijit/nls/loading".split(" "),function(h,l,
a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D){h.isCopyKey||(h.isCopyKey=h.dnd.getCopyKeyState);a=a("dojox.grid._Grid",[u,v,d],{templateString:w,classTag:"dojoxGrid",rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:!1,initialWidth:"",autoHeight:"",rowHeight:0,autoRender:!0,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:!1,selectionMode:"extended",rowSelector:"",columnReordering:!1,headerMenu:null,placeholderLabel:"GridColumns",selectable:!1,_click:null,loadingMessage:"\x3cspan class\x3d'dojoxGridLoading'\x3e${loadingState}\x3c/span\x3e",
errorMessage:"\x3cspan class\x3d'dojoxGridError'\x3e${errorState}\x3c/span\x3e",noDataMessage:"",escapeHTMLInData:!0,formatterScope:null,editable:!1,summary:"",_setSummaryAttr:"domNode",sortInfo:0,_placeholders:null,_layoutClass:f,buildRendering:function(){this.inherited(arguments);this.domNode.getAttribute("tabIndex")||(this.domNode.tabIndex="0");this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");
this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");B.initOnFontResize();this.connect(B,"onFontResize","textSizeChanged");r.funnelEvents(this.domNode,this,"doKeyEvent",r.keyEvents);"none"!=this.selectionMode&&this.domNode.setAttribute("aria-multiselectable","single"==this.selectionMode?"false":"true");C.addClass(this.domNode,this.classTag);this.isLeftToRight()||C.addClass(this.domNode,this.classTag+"Rtl");0<this.rowHeight&&C.addClass(this.viewsNode,
this.classTag+"FixedRowHeight")},postMixInProperties:function(){this.inherited(arguments);var a=h.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=x.substitute(this.loadingMessage,a);this.errorMessage=x.substitute(this.errorMessage,a);this.srcNodeRef&&this.srcNodeRef.style.height&&(this.height=this.srcNodeRef.style.height);this._setAutoHeightAttr(this.autoHeight,!0);this.lastScrollTop=this.scrollTop=0},postCreate:function(){this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);
this._setStructureAttr(this.structure);this._click=[];this.inherited(arguments);this.domNode&&this.autoWidth&&this.initialWidth&&(this.domNode.style.width=this.initialWidth);this.domNode&&!this.editable&&C.attr(this.domNode,"aria-readonly","true")},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;this.scroller&&(this.scroller.destroy(),delete this.scroller);this.edit.destroy();delete this.edit;this.views.destroyViews();this.focus&&(this.focus.destroy(),
delete this.focus);this.headerMenu&&this._placeholders.length&&(y.forEach(this._placeholders,function(a){a.unReplace(!0)}),this.headerMenu.unBindDomNode(this.viewsHeaderNode));this.inherited(arguments)},_setAutoHeightAttr:function(a,b){"string"==typeof a&&(a=a&&"false"!=a?"true"==a?!0:window.parseInt(a,10):!1);"number"==typeof a&&(isNaN(a)&&(a=!1),0>a?a=!0:0===a&&(a=!1));this.autoHeight=a;this._autoHeight="boolean"==typeof a?a:"number"==typeof a?a>=this.get("rowCount"):!1;this._started&&!b&&this.render()},
_getRowCountAttr:function(){return this.updating&&this.invalidated&&void 0!=this.invalidated.rowCount?this.invalidated.rowCount:this.rowCount},textSizeChanged:function(){this.render()},sizeChange:function(){this.update()},createManagers:function(){this.rows=new g(this);this.focus=new e(this);this.edit=new c(this)},createSelection:function(){this.selection=new n(this)},createScroller:function(){this.scroller=new b;this.scroller.grid=this;this.scroller.renderRow=z.hitch(this,"renderRow");this.scroller.removeRow=
z.hitch(this,"rowRemoved")},createLayout:function(){this.layout=new this._layoutClass(this);this.connect(this.layout,"moveColumn","onMoveColumn")},onMoveColumn:function(){this.update()},onResizeColumn:function(a){},createViews:function(){this.views=new m(this);this.views.createView=z.hitch(this,"createView")},createView:function(a,b){var c=new (z.getObject(a))({grid:this,index:b});this.viewsNode.appendChild(c.domNode);this.viewsHeaderNode.appendChild(c.headerNode);this.views.addView(c);C.attr(this.domNode,
"align",this.isLeftToRight()?"left":"right");return c},buildViews:function(){for(var a=0,b;b=this.layout.structure[a];a++)this.createView(b.type||l._scopeName+".grid._View",a).setStructure(b);this.scroller.setContentNodes(this.views.getContentNodes())},_setStructureAttr:function(a){a&&z.isString(a)&&(h.deprecated("dojox.grid._Grid.set('structure', 'objVar')","use dojox.grid._Grid.set('structure', objVar) instead","2.0"),a=z.getObject(a));this.structure=a;if(!a)if(this.layout.structure)a=this.layout.structure;
else return;this.views.destroyViews();this.focus.focusView=null;a!==this.layout.structure&&this.layout.setStructure(a);this._structureChanged()},setStructure:function(a){h.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.set('structure', obj) instead.","2.0");this._setStructureAttr(a)},getColumnTogglingItems:function(){var a,b=[];a=y.map(this.layout.cells,function(a){a.menuItems||(a.menuItems=[]);var c=this,d=new t({label:a.name,checked:!a.hidden,_gridCell:a,onChange:function(a){if(c.layout.setColumnVisibility(this._gridCell.index,
a)){var b=this._gridCell.menuItems;1<b.length&&y.forEach(b,function(b){b!==this&&b.setAttribute("checked",a)},this);a=y.filter(c.layout.cells,function(a){1<a.menuItems.length?y.forEach(a.menuItems,"item.set('disabled', false);"):a.menuItems[0].set("disabled",!1);return!a.hidden});1==a.length&&y.forEach(a[0].menuItems,"item.set('disabled', true);")}},destroy:function(){var a=y.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(a,1);delete this._gridCell;t.prototype.destroy.apply(this,
arguments)}});a.menuItems.push(d);a.hidden||b.push(d);return d},this);1==b.length&&b[0].set("disabled",!0);return a},_setHeaderMenuAttr:function(a){this._placeholders&&this._placeholders.length&&(y.forEach(this._placeholders,function(a){a.unReplace(!0)}),this._placeholders=[]);this.headerMenu&&this.headerMenu.unBindDomNode(this.viewsHeaderNode);if(this.headerMenu=a)this.headerMenu.bindDomNode(this.viewsHeaderNode),this.headerMenu.getPlaceholders&&(this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel))},
setHeaderMenu:function(a){h.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.set('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(a)},setupHeaderMenu:function(){this._placeholders&&this._placeholders.length&&y.forEach(this._placeholders,function(a){a._replaced&&a.unReplace(!0);a.replace(this.getColumnTogglingItems())},this)},_fetch:function(a){this.setScrollTop(0)},getItem:function(a){return null},showMessage:function(a){a?(this.messagesNode.innerHTML=a,this.messagesNode.style.display=
""):(this.messagesNode.innerHTML="",this.messagesNode.style.display="none")},_structureChanged:function(){this.buildViews();this.autoRender&&this._started&&this.render()},hasLayout:function(){return this.layout.cells.length},resize:function(a,b){this._pendingChangeSize=a;this._pendingResultSize=b;this.sizeChange()},_getPadBorder:function(){return this._padBorder=this._padBorder||C._getPadBorderExtents(this.domNode)},_getHeaderHeight:function(){var a=this.viewsHeaderNode.style,b="none"==a.display?
0:this.views.measureHeader();a.height=b+"px";this.views.normalizeHeaderNodeHeight();return b},_resize:function(a,b){a=a||this._pendingChangeSize;b=b||this._pendingResultSize;delete this._pendingChangeSize;delete this._pendingResultSize;if(this.domNode){var c=this.domNode.parentNode;if(c&&1==c.nodeType&&this.hasLayout()&&"hidden"!=c.style.visibility&&"none"!=c.style.display){var d=this._getPadBorder(),e=void 0,f;this._autoHeight?this.domNode.style.height="auto":"number"==typeof this.autoHeight?(f=
e=this._getHeaderHeight(),f+=this.scroller.averageRowHeight*this.autoHeight,this.domNode.style.height=f+"px"):this.domNode.clientHeight<=d.h&&(c==document.body?this.domNode.style.height=this.defaultHeight:this.height?this.domNode.style.height=this.height:this.fitTo="parent");b&&(a=b);!this._autoHeight&&a?(C.marginBox(this.domNode,a),this.height=this.domNode.style.height,delete this.fitTo):"parent"==this.fitTo&&(f=this._parentContentBoxHeight=0<this._parentContentBoxHeight?this._parentContentBoxHeight:
C._getContentBox(c).h,this.domNode.style.height=Math.max(0,f)+"px");c=y.some(this.views.views,function(a){return a.flexCells});this._autoHeight||0!==(f||C._getContentBox(this.domNode).h)?(this.viewsHeaderNode.style.display="block",c||void 0!==e||(e=this._getHeaderHeight())):this.viewsHeaderNode.style.display="none";c&&(e=void 0);this.adaptWidth();this.adaptHeight(e);this.postresize()}}},adaptWidth:function(){var a=!this.initialWidth&&this.autoWidth,b=a?0:this.domNode.clientWidth||this.domNode.offsetWidth-
this._getPadBorder().w,b=this.views.arrange(1,b);this.views.onEach("adaptWidth");a&&(this.domNode.style.width=b+"px")},adaptHeight:function(a){a=void 0===a?this._getHeaderHeight():a;var b=this._autoHeight?-1:Math.max(this.domNode.clientHeight-a,0)||0;this.views.onEach("setSize",[0,b]);this.views.onEach("adaptHeight");if(!this._autoHeight){var c=0,d=0,e=y.filter(this.views.views,function(a){(a=a.hasHScrollbar())?c++:d++;return!a});0<c&&0<d&&y.forEach(e,function(a){a.adaptHeight(!0)})}!0===this.autoHeight||
-1!=b||"number"==typeof this.autoHeight&&this.autoHeight>=this.get("rowCount")?this.scroller.windowHeight=b:this.scroller.windowHeight=Math.max(this.domNode.clientHeight-a,0)},startup:function(){this._started||(this.inherited(arguments),this.autoRender&&this.render())},render:function(){this.domNode&&this._started&&(this.hasLayout()?(this.update=this.defaultUpdate,this._render()):this.scroller.init(0,this.keepRows,this.rowsPerPage))},_render:function(){this.scroller.init(this.get("rowCount"),this.keepRows,
this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender()},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize()},postrender:function(){this.postresize();this.focus.initFocusView();C.setSelectable(this.domNode,this.selectable)},postresize:function(){if(this._autoHeight){var a=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=a}},renderRow:function(a,b){this.views.renderRow(a,
b,this._skipRowRenormalize)},rowRemoved:function(a){this.views.rowRemoved(a)},invalidated:null,updating:!1,beginUpdate:function(){this.invalidated=[];this.updating=!0},endUpdate:function(){this.updating=!1;var a=this.invalidated,b;if(a.all)this.update();else if(void 0!=a.rowCount)this.updateRowCount(a.rowCount);else for(b in a)this.updateRow(Number(b));this.invalidated=[]},defaultUpdate:function(){this.domNode&&(this.updating?this.invalidated.all=!0:(this.lastScrollTop=this.scrollTop,this.prerender(),
this.scroller.invalidateNodes(),this.setScrollTop(this.lastScrollTop),this.postrender()))},update:function(){this.render()},updateRow:function(a){a=Number(a);this.updating?this.invalidated[a]=!0:(this.views.updateRow(a),this.scroller.rowHeightChanged(a))},updateRows:function(a,b){a=Number(a);b=Number(b);var c;if(this.updating)for(c=0;c<b;c++)this.invalidated[c+a]=!0;else{for(c=0;c<b;c++)this.views.updateRow(c+a,this._skipRowRenormalize);this.scroller.rowHeightChanged(a)}},updateRowCount:function(a){this.updating?
this.invalidated.rowCount=a:(this.rowCount=a,this._setAutoHeightAttr(this.autoHeight,!0),this.layout.cells.length&&this.scroller.updateRowCount(a),this._resize(),this.layout.cells.length&&this.setScrollTop(this.scrollTop))},updateRowStyles:function(a){this.views.updateRowStyles(a)},getRowNode:function(a){if(!this.focus.focusView||this.focus.focusView instanceof q)for(var b=0,c;c=this.views.views[b];b++){if(!(c instanceof q))return c.rowNodes[a]}else return this.focus.focusView.rowNodes[a];return null},
rowHeightChanged:function(a){this.views.renormalizeRow(a);this.scroller.rowHeightChanged(a)},fastScroll:!0,delayScroll:!1,scrollRedrawThreshold:A("ie")?100:50,scrollTo:function(a){if(this.fastScroll){var b=Math.abs(this.lastScrollTop-a);this.lastScrollTop=a;if(b>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=!0;this.scrollTop=a;this.views.setScrollTop(a);this._pendingScroll&&window.clearTimeout(this._pendingScroll);var c=this;this._pendingScroll=window.setTimeout(function(){delete c._pendingScroll;
c.finishScrollJob()},200)}else this.setScrollTop(a)}else this.setScrollTop(a)},finishScrollJob:function(){this.delayScroll=!1;this.setScrollTop(this.scrollTop)},setScrollTop:function(a){this.scroller.scroll(this.views.setScrollTop(a))},scrollToRow:function(a){this.setScrollTop(this.scroller.findScrollTop(a)+1)},styleRowNode:function(a,b){b&&this.rows.styleRowNode(a,b)},_mouseOut:function(a){this.rows.setOverRow(-2)},getCell:function(a){return this.layout.cells[a]},setCellWidth:function(a,b){this.getCell(a).unitWidth=
b},getCellName:function(a){return"Cell "+a.index},canSort:function(a){},sort:function(){},getSortAsc:function(a){a=void 0==a?this.sortInfo:a;return Boolean(0<a)},getSortIndex:function(a){a=void 0==a?this.sortInfo:a;return Math.abs(a)-1},setSortIndex:function(a,b){var c=a+1;void 0!=b?c*=b?1:-1:this.getSortIndex()==a&&(c=-this.sortInfo);this.setSortInfo(c)},setSortInfo:function(a){this.canSort(a)&&(this.sortInfo=a,this.sort(),this.update())},doKeyEvent:function(a){a.dispatch="do"+a.type;this.onKeyEvent(a)},
_dispatch:function(a,b){return a in this?this[a](b):!1},dispatchKeyEvent:function(a){this._dispatch(a.dispatch,a)},dispatchContentEvent:function(a){this.edit.dispatchEvent(a)||a.sourceView.dispatchContentEvent(a)||this._dispatch(a.dispatch,a)},dispatchHeaderEvent:function(a){a.sourceView.dispatchHeaderEvent(a)||this._dispatch("doheader"+a.type,a)},dokeydown:function(a){this.onKeyDown(a)},doclick:function(a){if(a.cellNode)this.onCellClick(a);else this.onRowClick(a)},dodblclick:function(a){if(a.cellNode)this.onCellDblClick(a);
else this.onRowDblClick(a)},docontextmenu:function(a){if(a.cellNode)this.onCellContextMenu(a);else this.onRowContextMenu(a)},doheaderclick:function(a){if(a.cellNode)this.onHeaderCellClick(a);else this.onHeaderClick(a)},doheaderdblclick:function(a){if(a.cellNode)this.onHeaderCellDblClick(a);else this.onHeaderDblClick(a)},doheadercontextmenu:function(a){if(a.cellNode)this.onHeaderCellContextMenu(a);else this.onHeaderContextMenu(a)},doStartEdit:function(a,b){this.onStartEdit(a,b)},doApplyCellEdit:function(a,
b,c){this.onApplyCellEdit(a,b,c)},doCancelEdit:function(a){this.onCancelEdit(a)},doApplyEdit:function(a){this.onApplyEdit(a)},addRow:function(){this.updateRowCount(this.get("rowCount")+1)},removeSelectedRows:function(){this.allItemsSelected?this.updateRowCount(0):this.updateRowCount(Math.max(0,this.get("rowCount")-this.selection.getSelected().length));this.selection.clear()}});a.markupFactory=function(a,b,c,d){var e=function(a){a=C.attr(a,"width")||"auto";"auto"!=a&&"em"!=a.slice(-2)&&"%"!=a.slice(-1)&&
(a=parseInt(a,10)+"px");return a};a.structure||"table"!=b.nodeName.toLowerCase()||(a.structure=D("\x3e colgroup",b).map(function(a){var b=C.attr(a,"span"),b={noscroll:"true"==C.attr(a,"noscroll")?!0:!1,__span:b?parseInt(b,10):1,cells:[]};C.hasAttr(a,"width")&&(b.width=e(a));return b}),a.structure.length||a.structure.push({__span:Infinity,cells:[]}),D("thead \x3e tr",b).forEach(function(b,c){var f=0,g=0,k,h=null;D("\x3e th",b).map(function(b){h?f>=k+h.__span&&(g++,k+=h.__span,h=a.structure[g]):(k=
0,h=a.structure[0]);var m={name:z.trim(C.attr(b,"name")||b.innerHTML),colSpan:parseInt(C.attr(b,"colspan")||1,10),type:z.trim(C.attr(b,"cellType")||""),id:z.trim(C.attr(b,"id")||"")};f+=m.colSpan;var n=C.attr(b,"rowspan");n&&(m.rowSpan=n);C.hasAttr(b,"width")&&(m.width=e(b));C.hasAttr(b,"relWidth")&&(m.relWidth=window.parseInt(C.attr(b,"relWidth"),10));C.hasAttr(b,"hidden")&&(m.hidden="true"==C.attr(b,"hidden")||!0===C.attr(b,"hidden"));d&&d(b,m);m.type=m.type?z.getObject(m.type):l.grid.cells.Cell;
m.type&&m.type.markupFactory&&m.type.markupFactory(b,m);h.cells[c]||(h.cells[c]=[]);h.cells[c].push(m)})}));return new c(a,b)};return a})},"dojox/grid/_Events":function(){define(["dojo/keys","dojo/dom-class","dojo/_base/declare","dojo/_base/event","dojo/_base/sniff"],function(h,l,a,d,b){return a("dojox.grid._Events",null,{cellOverClass:"dojoxGridCellOver",onKeyEvent:function(a){this.dispatchKeyEvent(a)},onContentEvent:function(a){this.dispatchContentEvent(a)},onHeaderEvent:function(a){this.dispatchHeaderEvent(a)},
onStyleRow:function(a){a.customClasses+=(a.odd?" dojoxGridRowOdd":"")+(a.selected?" dojoxGridRowSelected":"")+(a.over?" dojoxGridRowOver":"");this.focus.styleRow(a);this.edit.styleRow(a)},onKeyDown:function(a){if(!a.altKey&&!a.metaKey){var b;switch(a.keyCode){case h.ESCAPE:this.edit.cancel();break;case h.ENTER:if(!this.edit.isEditing()){b=this.focus.getHeaderIndex();if(0<=b){this.setSortIndex(b);break}else this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(a),a.shiftKey);d.stop(a)}a.shiftKey||
(b=this.edit.isEditing(),this.edit.apply(),b||this.edit.setEditCell(this.focus.cell,this.focus.rowIndex));this.edit.isEditing()||((this.focus.focusView||this.views.views[0]).content.decorateEvent(a),this.onRowClick(a),d.stop(a));break;case h.SPACE:if(!this.edit.isEditing()){b=this.focus.getHeaderIndex();if(0<=b){this.setSortIndex(b);break}else this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(a),a.shiftKey),this.focus._focusifyCellNode(!0),this.focus.setFocusCell(this.focus.cell,this.focus.rowIndex);
d.stop(a)}break;case h.TAB:this.focus[a.shiftKey?"previousKey":"nextKey"](a);break;case h.LEFT_ARROW:case h.RIGHT_ARROW:if(!this.edit.isEditing()){var m=a.keyCode;d.stop(a);b=this.focus.getHeaderIndex();0<=b&&a.shiftKey&&a.ctrlKey?this.focus.colSizeAdjust(a,b,5*(m==h.LEFT_ARROW?-1:1)):(a=m==h.LEFT_ARROW?1:-1,this.isLeftToRight()&&(a*=-1),this.focus.move(0,a))}break;case h.UP_ARROW:this.edit.isEditing()||0===this.focus.rowIndex||(d.stop(a),this.focus.move(-1,0));break;case h.DOWN_ARROW:this.edit.isEditing()||
this.focus.rowIndex+1==this.rowCount||(d.stop(a),this.focus.move(1,0));break;case h.PAGE_UP:this.edit.isEditing()||0===this.focus.rowIndex||(d.stop(a),this.focus.rowIndex!=this.scroller.firstVisibleRow+1?this.focus.move(this.scroller.firstVisibleRow-this.focus.rowIndex,0):(this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex-1)),this.focus.move(this.scroller.firstVisibleRow-this.scroller.lastVisibleRow+1,0)));break;case h.PAGE_DOWN:this.edit.isEditing()||this.focus.rowIndex+1==this.rowCount||
(d.stop(a),this.focus.rowIndex!=this.scroller.lastVisibleRow-1?this.focus.move(this.scroller.lastVisibleRow-this.focus.rowIndex-1,0):(this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex+1)),this.focus.move(this.scroller.lastVisibleRow-this.scroller.firstVisibleRow-1,0)))}}},onMouseOver:function(a){-1==a.rowIndex?this.onHeaderCellMouseOver(a):this.onCellMouseOver(a)},onMouseOut:function(a){-1==a.rowIndex?this.onHeaderCellMouseOut(a):this.onCellMouseOut(a)},onMouseDown:function(a){-1==
a.rowIndex?this.onHeaderCellMouseDown(a):this.onCellMouseDown(a)},onMouseOverRow:function(a){this.rows.isOver(a.rowIndex)||(this.rows.setOverRow(a.rowIndex),-1==a.rowIndex?this.onHeaderMouseOver(a):this.onRowMouseOver(a))},onMouseOutRow:function(a){if(this.rows.isOver(-1))this.onHeaderMouseOut(a);else this.rows.isOver(-2)||(this.rows.setOverRow(-2),this.onRowMouseOut(a))},onMouseDownRow:function(a){if(-1!=a.rowIndex)this.onRowMouseDown(a)},onCellMouseOver:function(a){a.cellNode&&l.add(a.cellNode,
this.cellOverClass)},onCellMouseOut:function(a){a.cellNode&&l.remove(a.cellNode,this.cellOverClass)},onCellMouseDown:function(a){},onCellClick:function(a){this._click[0]=this._click[1];this._click[1]=a;this.edit.isEditCell(a.rowIndex,a.cellIndex)||this.focus.setFocusCell(a.cell,a.rowIndex);1<this._click.length&&null==this._click[0]&&this._click.shift();this.onRowClick(a)},onCellDblClick:function(a){var d;d=1<this._click.length&&b("ie")?this._click[1]:1<this._click.length&&this._click[0].rowIndex!=
this._click[1].rowIndex?this._click[0]:a;this.focus.setFocusCell(d.cell,d.rowIndex);this.edit.setEditCell(d.cell,d.rowIndex);this.onRowDblClick(a)},onCellContextMenu:function(a){this.onRowContextMenu(a)},onCellFocus:function(a,b){this.edit.cellFocus(a,b)},onRowClick:function(a){this.edit.rowClick(a);this.selection.clickSelectEvent(a)},onRowDblClick:function(a){},onRowMouseOver:function(a){},onRowMouseOut:function(a){},onRowMouseDown:function(a){},onRowContextMenu:function(a){d.stop(a)},onHeaderMouseOver:function(a){},
onHeaderMouseOut:function(a){},onHeaderCellMouseOver:function(a){a.cellNode&&l.add(a.cellNode,this.cellOverClass)},onHeaderCellMouseOut:function(a){a.cellNode&&l.remove(a.cellNode,this.cellOverClass)},onHeaderCellMouseDown:function(a){},onHeaderClick:function(a){},onHeaderCellClick:function(a){this.setSortIndex(a.cell.index);this.onHeaderClick(a)},onHeaderDblClick:function(a){},onHeaderCellDblClick:function(a){this.onHeaderDblClick(a)},onHeaderCellContextMenu:function(a){this.onHeaderContextMenu(a)},
onHeaderContextMenu:function(a){this.headerMenu||d.stop(a)},onStartEdit:function(a,b){},onApplyCellEdit:function(a,b,d){},onCancelEdit:function(a){},onApplyEdit:function(a){},onCanSelect:function(a){return!0},onCanDeselect:function(a){return!0},onSelected:function(a){this.updateRowStyles(a)},onDeselected:function(a){this.updateRowStyles(a)},onSelectionChanged:function(){}})})},"dojox/grid/_Scroller":function(){define(["dijit/registry","dojo/_base/declare","dojo/_base/lang","./util","dojo/_base/html"],
function(h,l,a,d,b){var f=function(a){a&&dojo.forEach(h.toArray(),function(d){d.domNode&&b.isDescendant(d.domNode,a,!0)&&d.destroy()})},k=function(a,d){for(var e=[],c=0,f;f=a.childNodes[c];){c++;var k=b.byId(f);(k&&k.tagName?k.tagName.toLowerCase():"")==d&&e.push(f)}return e};return l("dojox.grid._Scroller",null,{constructor:function(a){this.setContentNodes(a);this.pageHeights=[];this.pageNodes=[];this.stack=[]},rowCount:0,defaultRowHeight:32,keepRows:100,contentNode:null,scrollboxNode:null,defaultPageHeight:0,
keepPages:10,pageCount:0,windowHeight:0,firstVisibleRow:0,lastVisibleRow:0,averageRowHeight:0,page:0,pageTop:0,init:function(b,d,e){switch(arguments.length){case 3:this.rowsPerPage=e;case 2:this.keepRows=d;case 1:this.rowCount=b}this.defaultPageHeight=(0<this.grid.rowHeight?this.grid.rowHeight:this.defaultRowHeight)*this.rowsPerPage;this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);this.setKeepInfo(this.keepRows);this.invalidate();this.scrollboxNode&&(this.scrollboxNode.scrollTop=
0,this.scroll(0),this.scrollboxNode.onscroll=a.hitch(this,"onscroll"))},_getPageCount:function(a,b){return a?Math.ceil(a/b)||1:0},destroy:function(){this.invalidateNodes();delete this.contentNodes;delete this.contentNode;delete this.scrollboxNode},setKeepInfo:function(a){this.keepPages=(this.keepRows=a)?Math.max(Math.ceil(this.keepRows/this.rowsPerPage),2):this.keepPages},setContentNodes:function(a){this.colCount=(this.contentNodes=a)?this.contentNodes.length:0;this.pageNodes=[];for(a=0;a<this.colCount;a++)this.pageNodes[a]=
[]},getDefaultNodes:function(){return this.pageNodes[0]||[]},invalidate:function(){this._invalidating=!0;this.invalidateNodes();this.pageHeights=[];this.height=this.pageCount?(this.pageCount-1)*this.defaultPageHeight+this.calcLastPageHeight():0;this.resize();this._invalidating=!1},updateRowCount:function(a){this.invalidateNodes();this.rowCount=a;a=this.pageCount;0===a&&(this.height=1);this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);if(this.pageCount<a)for(--a;a>=this.pageCount;a--)this.height-=
this.getPageHeight(a),delete this.pageHeights[a];else this.pageCount>a&&(this.height+=this.defaultPageHeight*(this.pageCount-a-1)+this.calcLastPageHeight());this.resize()},pageExists:function(a){return Boolean(this.getDefaultPageNode(a))},measurePage:function(a){return this.grid.rowHeight?((a+1)*this.rowsPerPage>this.rowCount?this.rowCount-a*this.rowsPerPage:this.rowsPerPage)*this.grid.rowHeight:(a=this.getDefaultPageNode(a))&&a.innerHTML?a.offsetHeight:void 0},positionPage:function(a,b){for(var d=
0;d<this.colCount;d++)this.pageNodes[d][a].style.top=b+"px"},repositionPages:function(a){for(var b=this.getDefaultNodes(),d=0,c=0;c<this.stack.length;c++)d=Math.max(this.stack[c],d);var f=(c=b[a])?this.getPageNodePosition(c)+this.getPageHeight(a):0;for(a+=1;a<=d;a++){if(c=b[a]){if(this.getPageNodePosition(c)==f)break;this.positionPage(a,f)}f+=this.getPageHeight(a)}},installPage:function(a){for(var b=0;b<this.colCount;b++)this.contentNodes[b].appendChild(this.pageNodes[b][a])},preparePage:function(a,
b){for(var d=b?this.popPage():null,c=0;c<this.colCount;c++){var f=this.pageNodes[c],k=null===d?this.createPageNode():this.invalidatePageNode(d,f);k.pageIndex=a;f[a]=k}},renderPage:function(a){var b=[],d;for(d=0;d<this.colCount;d++)b[d]=this.pageNodes[d][a];d=0;for(a*=this.rowsPerPage;d<this.rowsPerPage&&a<this.rowCount;d++,a++)this.renderRow(a,b)},removePage:function(a){var b=0;for(a*=this.rowsPerPage;b<this.rowsPerPage;b++,a++)this.removeRow(a)},destroyPage:function(a){for(var d=0;d<this.colCount;d++){var e=
this.invalidatePageNode(a,this.pageNodes[d]);e&&b.destroy(e)}},pacify:function(a){},pacifying:!1,pacifyTicks:200,setPacifying:function(a){this.pacifying!=a&&(this.pacifying=a,this.pacify(this.pacifying))},startPacify:function(){this.startPacifyTicks=(new Date).getTime()},doPacify:function(){var a=(new Date).getTime()-this.startPacifyTicks>this.pacifyTicks;this.setPacifying(!0);this.startPacify();return a},endPacify:function(){this.setPacifying(!1)},resize:function(){this.scrollboxNode&&(this.windowHeight=
this.scrollboxNode.clientHeight);for(var a=0;a<this.colCount;a++)d.setStyleHeightPx(this.contentNodes[a],Math.max(1,this.height));a=!this._invalidating;if(!a){var b=this.grid.get("autoHeight");"number"==typeof b&&b<=Math.min(this.rowsPerPage,this.rowCount)&&(a=!0)}a&&this.needPage(this.page,this.pageTop);a=this.page<this.pageCount-1?this.rowsPerPage:this.rowCount%this.rowsPerPage||this.rowsPerPage;b=this.getPageHeight(this.page);this.averageRowHeight=0<b&&0<a?b/a:0},calcLastPageHeight:function(){if(!this.pageCount)return 0;
var a=(this.rowCount%this.rowsPerPage||this.rowsPerPage)*this.defaultRowHeight;return this.pageHeights[this.pageCount-1]=a},updateContentHeight:function(a){this.height+=a;this.resize()},updatePageHeight:function(a,b,d){if(this.pageExists(a)){var c=this.getPageHeight(a),f=this.measurePage(a);void 0===f&&(f=c);this.pageHeights[a]=f;if(c!=f){this.updateContentHeight(f-c);var k=this.grid.get("autoHeight");"number"==typeof k&&k>this.rowCount||!0===k&&!b?d?(b=this.grid.viewsNode.style,b.height=parseInt(b.height)+
f-c+"px",this.repositionPages(a)):this.grid.sizeChange():this.repositionPages(a)}return f}return 0},rowHeightChanged:function(a,b){this.updatePageHeight(Math.floor(a/this.rowsPerPage),!1,b)},invalidateNodes:function(){for(;this.stack.length;)this.destroyPage(this.popPage())},createPageNode:function(){var a=document.createElement("div");b.attr(a,"role","presentation");a.style.position="absolute";a.style[this.grid.isLeftToRight()?"left":"right"]="0";return a},getPageHeight:function(a){a=this.pageHeights[a];
return void 0!==a?a:this.defaultPageHeight},pushPage:function(a){return this.stack.push(a)},popPage:function(){return this.stack.shift()},findPage:function(a){for(var b=0,d=0,c=0;b<this.pageCount&&!(c=this.getPageHeight(b),d+c>=a);b++,d+=c);this.page=b;this.pageTop=d},buildPage:function(a,b,d){this.preparePage(a,b);this.positionPage(a,d);this.installPage(a);this.renderPage(a);this.pushPage(a)},needPage:function(a,b){var d=this.getPageHeight(a);this.pageExists(a)?this.positionPage(a,b):(this.buildPage(a,
!this.grid._autoHeight&&this.keepPages&&this.stack.length>=this.keepPages,b),d=this.updatePageHeight(a,!0));return d},onscroll:function(){this.scroll(this.scrollboxNode.scrollTop)},scroll:function(a){this.grid.scrollTop=a;if(this.colCount){this.startPacify();this.findPage(a);for(var b=this.height,d=this.getScrollBottom(a),c=this.page,f=this.pageTop;c<this.pageCount&&(0>d||f<d);c++)f+=this.needPage(c,f);this.firstVisibleRow=this.getFirstVisibleRow(this.page,this.pageTop,a);this.lastVisibleRow=this.getLastVisibleRow(c-
1,f,d);b!=this.height&&this.repositionPages(c-1);this.endPacify()}},getScrollBottom:function(a){return 0<=this.windowHeight?a+this.windowHeight:-1},processNodeEvent:function(a,b){for(var d=a.target;d&&d!=b&&d.parentNode&&d.parentNode.parentNode!=b;)d=d.parentNode;if(!d||!d.parentNode||d.parentNode.parentNode!=b)return!1;a.topRowIndex=d.parentNode.pageIndex*this.rowsPerPage;var c=a.topRowIndex,f;a:{f=0;for(var k,h=d.parentNode;k=h.childNodes[f++];)if(k==d){--f;break a}f=-1}a.rowIndex=c+f;a.rowTarget=
d;return!0},processEvent:function(a){return this.processNodeEvent(a,this.contentNode)},renderRow:function(a,b){},removeRow:function(a){},getDefaultPageNode:function(a){return this.getDefaultNodes()[a]},positionPageNode:function(a,b){},getPageNodePosition:function(a){return a.offsetTop},invalidatePageNode:function(a,b){var d=b[a];d&&(delete b[a],this.removePage(a,d),f(d),d.innerHTML="");return d},getPageRow:function(a){return a*this.rowsPerPage},getLastPageRow:function(a){return Math.min(this.rowCount,
this.getPageRow(a+1))-1},getFirstVisibleRow:function(a,b,d){if(!this.pageExists(a))return 0;var c=this.getPageRow(a),f=this.getDefaultNodes();a=k(f[a],"div");for(var f=0,h=a.length;f<h&&b<d;f++,c++)b+=a[f].offsetHeight;return c?c-1:c},getLastVisibleRow:function(a,b,d){if(!this.pageExists(a))return 0;var c=this.getDefaultNodes(),f=this.getLastPageRow(a);a=k(c[a],"div");for(c=a.length-1;0<=c&&b>d;c--,f--)b-=a[c].offsetHeight;return f+1},findTopRow:function(a){for(var b=this.getDefaultNodes(),b=k(b[this.page],
"div"),d=0,c=b.length,f=this.pageTop,h;d<c;d++)if(h=b[d].offsetHeight,f+=h,f>=a)return this.offset=h-(f-a),d+this.page*this.rowsPerPage;return-1},findScrollTop:function(a){var b=Math.floor(a/this.rowsPerPage),d=0,c;for(c=0;c<b;c++)d+=this.getPageHeight(c);this.pageTop=d;this.page=b;this.needPage(b,this.pageTop);c=this.getDefaultNodes();var f=k(c[b],"div"),b=a-this.rowsPerPage*b;c=0;for(a=f.length;c<a&&c<b;c++)d+=f[c].offsetHeight;return d},dummy:0})})},"dojox/grid/util":function(){define(["../main",
"dojo/_base/lang","dojo/dom"],function(h,l,a){var d=l.getObject("grid.util",!0,h);d.na="...";d.rowIndexTag="gridRowIndex";d.gridViewTag="gridView";d.fire=function(a,d,k){var h=a&&d&&a[d];return h&&(k?h.apply(a,k):a[d]())};d.setStyleHeightPx=function(a,d){if(0<=d){var k=a.style,h=d+"px";a&&k.height!=h&&(k.height=h)}};d.mouseEvents="mouseover mouseout mousedown mouseup click dblclick contextmenu".split(" ");d.keyEvents=["keyup","keydown","keypress"];d.funnelEvents=function(a,f,k,h){h=h?h:d.mouseEvents.concat(d.keyEvents);
for(var g=0,e=h.length;g<e;g++)f.connect(a,"on"+h[g],k)};d.removeNode=function(b){(b=a.byId(b))&&b.parentNode&&b.parentNode.removeChild(b);return b};d.arrayCompare=function(a,d){for(var k=0,h=a.length;k<h;k++)if(a[k]!=d[k])return!1;return a.length==d.length};d.arrayInsert=function(a,d,k){a.length<=d?a[d]=k:a.splice(d,0,k)};d.arrayRemove=function(a,d){a.splice(d,1)};d.arraySwap=function(a,d,k){var h=a[d];a[d]=a[k];a[k]=h};return d})},"dojox/grid/_Layout":function(){define("dojo/_base/kernel ../main dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom-geometry ./cells ./_RowSelector".split(" "),
function(h,l,a,d,b,f){return a("dojox.grid._Layout",null,{constructor:function(a){this.grid=a},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(a,b,f,e,c){var h=this.structure[a].cells[0],l=this.structure[b].cells[0],r=null,u=r=0;a=0;for(var v;v=h[a];a++)if(v.index==f){r=a;break}r=h.splice(r,1)[0];r.view=this.grid.views.views[b];a=0;for(v=null;v=l[a];a++)if(v.index==e){u=a;break}c||(u+=1);l.splice(u,0,r);if(f=this.grid.getCell(this.grid.getSortIndex()))f._currentlySorted=this.grid.getSortAsc();
this.cells=[];for(a=f=0;b=this.structure[a];a++)for(e=0;c=b.cells[e];e++)for(h=0;v=c[h];h++)v.index=f,this.cells.push(v),"_currentlySorted"in v&&(l=f+1,l*=v._currentlySorted?1:-1,this.grid.sortInfo=l,delete v._currentlySorted),f++;d.forEach(this.cells,function(a){var b=a.markup[2].split(" ");parseInt(b[1].substring(5))!=a.index&&(b[1]='idx\x3d"'+a.index+'"',a.markup[2]=b.join(" "))});this.grid.setupHeaderMenu()},setColumnVisibility:function(a,b){var d=this.cells[a];if(d.hidden==b){d.hidden=!b;var e=
d.view,c=e.viewWidth;c&&"auto"!=c&&(e._togglingColumn=f.getMarginBox(d.getHeaderNode()).w||0);e.update();return!0}return!1},addCellDef:function(a,d,f){var e=this,c=function(a){var b=0;1<a.colSpan?b=0:(b=a.width||e._defaultCellProps.width||e.defaultWidth,isNaN(b)||(b+="em"));return b};a={grid:this.grid,subrow:a,layoutIndex:d,index:this.cells.length};if(f&&f instanceof l.grid.cells._Base)return d=b.clone(f),a.unitWidth=c(d._props),d=b.mixin(d,this._defaultCellProps,f._props,a);d=f.type||f.cellType||
this._defaultCellProps.type||this._defaultCellProps.cellType||l.grid.cells.Cell;b.isString(d)&&(d=b.getObject(d));a.unitWidth=c(f);return new d(b.mixin({},this._defaultCellProps,f,a))},addRowDef:function(a,b){for(var f=[],e=0,c=0,h=!0,l=0,r;r=b[l];l++)r=this.addCellDef(a,l,r),f.push(r),this.cells.push(r),h&&r.relWidth?e+=r.relWidth:r.width&&(r=r.width,"string"==typeof r&&"%"==r.slice(-1)?c+=window.parseInt(r,10):"auto"==r&&(h=!1));e&&h&&d.forEach(f,function(a){a.relWidth&&(a.width=a.unitWidth=a.relWidth/
e*(100-c)+"%")});return f},addRowsDef:function(a){var d=[];if(b.isArray(a))if(b.isArray(a[0]))for(var f=0,e;a&&(e=a[f]);f++)d.push(this.addRowDef(f,e));else d.push(this.addRowDef(0,a));return d},addViewDef:function(a){this._defaultCellProps=a.defaultCell||{};a.width&&"auto"==a.width&&delete a.width;return b.mixin({},a,{cells:this.addRowsDef(a.rows||a.cells)})},setStructure:function(a){this.fieldIndex=0;this.cells=[];var d=this.structure=[];if(this.grid.rowSelector){var f={type:l._scopeName+".grid._RowSelector"};
if(b.isString(this.grid.rowSelector)){var e=this.grid.rowSelector;"false"==e?f=null:"true"!=e&&(f.width=e)}else this.grid.rowSelector||(f=null);f&&d.push(this.addViewDef(f))}var c=function(a){return"name"in a||"field"in a||"get"in a},f=function(a){return b.isArray(a)&&(b.isArray(a[0])||c(a[0]))?!0:!1},e=function(a){return null!==a&&b.isObject(a)&&("cells"in a||"rows"in a||"type"in a&&!c(a))};if(b.isArray(a)){for(var h=!1,q=0,r;r=a[q];q++)if(e(r)){h=!0;break}if(h)for(q=0;r=a[q];q++)f(r)?d.push(this.addViewDef({cells:r})):
e(r)&&d.push(this.addViewDef(r));else d.push(this.addViewDef({cells:a}))}else e(a)&&d.push(this.addViewDef(a));this.cellCount=this.cells.length;this.grid.setupHeaderMenu()}})})},"dojox/grid/cells":function(){define(["../main","./cells/_base"],function(h){return h.grid.cells})},"dojox/grid/cells/_base":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/event dojo/_base/connect dojo/_base/array dojo/_base/sniff dojo/dom dojo/dom-attr dojo/dom-construct dijit/_Widget ../util".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n){var q=l("dojox.grid._DeferredTextWidget",c,{deferred:null,_destroyOnRemove:!0,postCreate:function(){this.deferred&&this.deferred.addBoth(a.hitch(this,function(a){this.domNode&&(this.domNode.innerHTML=a)}))}}),r=function(){setTimeout(a.hitch.apply(h,arguments),0)},u=l("dojox.grid.cells._Base",null,{styles:"",classes:"",editable:!1,alwaysEditing:!1,formatter:null,defaultValue:"...",value:null,hidden:!1,noresize:!1,draggable:!0,_valueProp:"value",_formatPending:!1,constructor:function(b){this._props=
b||{};a.mixin(this,b);void 0===this.draggable&&(this.draggable=!0)},_defaultFormat:function(a,b){var c=this.grid.formatterScope||this,d=this.formatter;d&&c&&"string"==typeof d&&(d=this.formatter=c[d]);c=a!=this.defaultValue&&d?d.apply(c,b):a;if("undefined"==typeof c)return this.defaultValue;c&&c.addBoth&&(c=new q({deferred:c},e.create("span",{innerHTML:this.defaultValue})));return c&&c.declaredClass&&c.startup?"\x3cdiv class\x3d'dojoxGridStubNode' linkWidget\x3d'"+c.id+"' cellIdx\x3d'"+this.index+
"'\x3e"+this.defaultValue+"\x3c/div\x3e":c},format:function(a,b){var c=this.grid.edit.info,d=this.get?this.get(a,b):this.value||this.defaultValue,d=d&&d.replace&&this.grid.escapeHTMLInData?d.replace(/&(?![a-z0-9]{1,8}\;)/ig,"\x26amp;").replace(/</g,"\x26lt;"):d;return this.editable&&(this.alwaysEditing||c.rowIndex==a&&c.cell==this)?this.formatEditing(c.value?c.value:d,a):this._defaultFormat(d,[d,a,this])},formatEditing:function(a,b){},getNode:function(a){return this.view.getCellNode(a,this.index)},
getHeaderNode:function(){return this.view.getHeaderCellNode(this.index)},getEditNode:function(a){return(this.getNode(a)||0).firstChild||0},canResize:function(){var a=this.unitWidth;return a&&"auto"!==a},isFlex:function(){var b=this.unitWidth;return b&&a.isString(b)&&("auto"==b||"%"==b.slice(-1))},applyEdit:function(a,b){this.getNode(b)&&this.grid.edit.applyCellEdit(a,this,b)},cancelEdit:function(a){this.grid.doCancelEdit(a)},_onEditBlur:function(a){this.grid.edit.isEditCell(a,this.index)&&this.grid.edit.apply()},
registerOnBlur:function(c,d){this.commitOnBlur&&b.connect(c,"onblur",function(b){setTimeout(a.hitch(this,"_onEditBlur",d),250)})},needFormatNode:function(a,b){this._formatPending=!0;r(this,"_formatNode",a,b)},cancelFormatNode:function(){this._formatPending=!1},_formatNode:function(a,b){this._formatPending&&(this._formatPending=!1,k("ie")||m.setSelectable(this.grid.domNode,!0),this.formatNode(this.getEditNode(b),a,b))},formatNode:function(a,b,c){k("ie")?r(this,"focus",c,a):this.focus(c,a)},dispatchEvent:function(a,
b){if(a in this)return this[a](b)},getValue:function(a){return this.getEditNode(a)[this._valueProp]},setValue:function(a,b){var c=this.getEditNode(a);c&&(c[this._valueProp]=b)},focus:function(a,b){var c=b||this.getEditNode(a);try{n.fire(c,"focus"),n.fire(c,"select")}catch(d){}},save:function(a){this.value=this.value||this.getValue(a)},restore:function(a){this.setValue(a,this.value)},_finish:function(a){m.setSelectable(this.grid.domNode,!1);this.cancelFormatNode()},apply:function(a){this.applyEdit(this.getValue(a),
a);this._finish(a)},cancel:function(a){this.cancelEdit(a);this._finish(a)}});u.markupFactory=function(b,c){var d=a.trim(g.get(b,"formatter")||"");d&&(c.formatter=a.getObject(d)||d);if(d=a.trim(g.get(b,"get")||""))c.get=a.getObject(d);d=function(c,d,e){var f=a.trim(g.get(b,c)||"");f&&(d[e||c]="false"!=f.toLowerCase())};d("sortDesc",c);d("editable",c);d("alwaysEditing",c);d("noresize",c);d("draggable",c);if(d=a.trim(g.get(b,"loadingText")||g.get(b,"defaultValue")||""))c.defaultValue=d;d=function(c,
d,e){var f=a.trim(g.get(b,c)||"")||void 0;f&&(d[e||c]=f)};d("styles",c);d("headerStyles",c);d("cellStyles",c);d("classes",c);d("headerClasses",c);d("cellClasses",c)};var v=u.Cell=l("dojox.grid.cells.Cell",u,{constructor:function(){this.keyFilter=this.keyFilter},keyFilter:null,formatEditing:function(a,b){this.needFormatNode(a,b);return'\x3cinput class\x3d"dojoxGridInput" type\x3d"text" value\x3d"'+a+'"\x3e'},formatNode:function(a,b,c){this.inherited(arguments);this.registerOnBlur(a,c)},doKey:function(a){this.keyFilter&&
-1==String.fromCharCode(a.charCode).search(this.keyFilter)&&d.stop(a)},_finish:function(a){this.inherited(arguments);var b=this.getEditNode(a);try{n.fire(b,"blur")}catch(c){}}});v.markupFactory=function(b,c){u.markupFactory(b,c);var d=a.trim(g.get(b,"keyFilter")||"");d&&(c.keyFilter=new RegExp(d))};(u.RowIndex=l("dojox.grid.cells.RowIndex",v,{name:"Row",postscript:function(){this.editable=!1},get:function(a){return a+1}})).markupFactory=function(a,b){v.markupFactory(a,b)};(u.Select=l("dojox.grid.cells.Select",
v,{options:null,values:null,returnIndex:-1,constructor:function(a){this.values=this.values||this.options},formatEditing:function(a,b){this.needFormatNode(a,b);for(var c=['\x3cselect class\x3d"dojoxGridSelect"\x3e'],d=0,e,f;void 0!==(e=this.options[d])&&void 0!==(f=this.values[d]);d++)f=f.replace?f.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):f,e=e.replace?e.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):e,c.push("\x3coption",a==f?" selected":"",' value\x3d"'+f+'"',"\x3e",e,"\x3c/option\x3e");
c.push("\x3c/select\x3e");return c.join("")},_defaultFormat:function(a,b){var c=this.inherited(arguments);if(!this.formatter&&this.values&&this.options){var d=f.indexOf(this.values,c);0<=d&&(c=this.options[d])}return c},getValue:function(a){var b=this.getEditNode(a);if(b)return a=b.selectedIndex,b=b.options[a],-1<this.returnIndex?a:b.value||b.innerHTML}})).markupFactory=function(b,c){v.markupFactory(b,c);var d=a.trim(g.get(b,"options")||"");if(d){var e=d.split(",");e[0]!=d&&(c.options=e)}if(d=a.trim(g.get(b,
"values")||""))e=d.split(","),e[0]!=d&&(c.values=e)};var t=u.AlwaysEdit=l("dojox.grid.cells.AlwaysEdit",v,{alwaysEditing:!0,_formatNode:function(a,b){this.formatNode(this.getEditNode(b),a,b)},applyStaticValue:function(a){var b=this.grid.edit;b.applyCellEdit(this.getValue(a),this,a);b.start(this,a,!0)}});t.markupFactory=function(a,b){v.markupFactory(a,b)};(u.Bool=l("dojox.grid.cells.Bool",t,{_valueProp:"checked",formatEditing:function(a,b){return'\x3cinput class\x3d"dojoxGridInput" type\x3d"checkbox"'+
(a?' checked\x3d"checked"':"")+' style\x3d"width: auto" /\x3e'},doclick:function(a){"INPUT"==a.target.tagName&&this.applyStaticValue(a.rowIndex)}})).markupFactory=function(a,b){t.markupFactory(a,b)};return u})},"dojox/grid/_RowSelector":function(){define(["dojo/_base/declare","./_View"],function(h,l){return h("dojox.grid._RowSelector",l,{defaultWidth:"2em",noscroll:!0,padBorderWidth:2,buildRendering:function(){this.inherited("buildRendering",arguments);this.scrollboxNode.style.overflow="hidden";this.headerNode.style.visibility=
"hidden"},getWidth:function(){return this.viewWidth||this.defaultWidth},buildRowContent:function(a,d){d.innerHTML='\x3ctable class\x3d"dojoxGridRowbarTable" style\x3d"width:'+(this.contentWidth||0)+'px;height:1px;" border\x3d"0" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"\x3e\x3ctr\x3e\x3ctd class\x3d"dojoxGridRowbarInner"\x3e\x26nbsp;\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e'},renderHeader:function(){},updateRow:function(){},resize:function(){this.adaptHeight()},adaptWidth:function(){!("contentWidth"in
this)&&this.contentNode&&0<this.contentNode.offsetWidth&&(this.contentWidth=this.contentNode.offsetWidth-this.padBorderWidth)},doStyleRowNode:function(a,d){var b=["dojoxGridRowbar dojoxGridNonNormalizedCell"];this.grid.rows.isOver(a)&&b.push("dojoxGridRowbarOver");this.grid.selection.isSelected(a)&&b.push("dojoxGridRowbarSelected");d.className=b.join(" ")},domouseover:function(a){this.grid.onMouseOverRow(a)},domouseout:function(a){if(!this.isIntraRowEvent(a))this.grid.onMouseOutRow(a)}})})},"dojox/grid/_View":function(){define("dojo dijit/registry ../main dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/connect dojo/_base/sniff dojo/query dojo/_base/window dojo/text!./resources/View.html dojo/dnd/Source dijit/_Widget dijit/_TemplatedMixin dojox/html/metrics ./util dojo/_base/html ./_Builder dojo/dnd/Avatar dojo/dnd/Manager".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y){c=d("dojox.grid._View",[q,r],{defaultWidth:"18em",viewWidth:"",templateString:c,classTag:"dojoxGrid",marginBottom:0,rowPad:2,_togglingColumn:-1,_headerBuilderClass:w._HeaderBuilder,_contentBuilderClass:w._ContentBuilder,postMixInProperties:function(){this.rowNodes={}},postCreate:function(){this.connect(this.scrollboxNode,"onscroll","doscroll");v.funnelEvents(this.contentNode,this,"doContentEvent","mouseover mouseout click dblclick contextmenu mousedown".split(" "));
v.funnelEvents(this.headerNode,this,"doHeaderEvent","dblclick mouseover mouseout mousemove mousedown click contextmenu".split(" "));this.content=new this._contentBuilderClass(this);this.header=new this._headerBuilderClass(this);this.grid.isLeftToRight()||(this.headerNodeContainer.style.width="")},destroy:function(){t.destroy(this.headerNode);delete this.headerNode;for(var a in this.rowNodes)this._cleanupRowWidgets(this.rowNodes[a]),t.destroy(this.rowNodes[a]);this.rowNodes={};this.source&&this.source.destroy();
this.inherited(arguments)},focus:function(){m("ie")||m("webkit")||m("opera")?this.hiddenFocusNode.focus():this.scrollboxNode.focus()},setStructure:function(a){a=this.structure=a;a.width&&!isNaN(a.width)?this.viewWidth=a.width+"em":this.viewWidth=a.width||(a.noscroll?"auto":this.viewWidth);this._onBeforeRow=a.onBeforeRow||function(){};this._onAfterRow=a.onAfterRow||function(){};if(this.noscroll=a.noscroll)this.scrollboxNode.style.overflow="hidden";this.simpleStructure=Boolean(1==a.cells.length);this.testFlexCells();
this.updateStructure()},_cleanupRowWidgets:function(a){a&&b.forEach(g("[widgetId]",a).map(l.byNode),function(a){a._destroyOnRemove?(a.destroy(),delete a):a.domNode&&a.domNode.parentNode&&a.domNode.parentNode.removeChild(a.domNode)})},onBeforeRow:function(a,b){this._onBeforeRow(a,b);0<=a&&this._cleanupRowWidgets(this.getRowNode(a))},onAfterRow:function(a,c,d){this._onAfterRow(a,c,d);var e=this.grid;b.forEach(g(".dojoxGridStubNode",d),function(a){if(a&&a.parentNode){var b=a.getAttribute("linkWidget"),
c=window.parseInt(t.attr(a,"cellIdx"),10);e.getCell(c);(b=l.byId(b))?(a.parentNode.replaceChild(b.domNode,a),b._started||b.startup(),h.destroy(a)):a.innerHTML=""}},this)},testFlexCells:function(){this.flexCells=!1;for(var a=0,b;b=this.structure.cells[a];a++)for(var c=0,d;d=b[c];c++)d.view=this,this.flexCells=this.flexCells||d.isFlex();return this.flexCells},updateStructure:function(){this.header.update();this.content.update()},getScrollbarWidth:function(){var a=this.hasVScrollbar(),b=t.style(this.scrollboxNode,
"overflow");this.noscroll||!b||"hidden"==b?a=!1:"scroll"==b&&(a=!0);return a?u.getScrollbar().w:0},getColumnsWidth:function(){var a=this.headerContentNode;return a&&a.firstChild?a.firstChild.offsetWidth||t.style(a.firstChild,"width"):0},setColumnsWidth:function(a){this.headerContentNode.firstChild.style.width=a+"px";this.viewWidth&&(this.viewWidth=a+"px")},getWidth:function(){return this.viewWidth||this.getColumnsWidth()+this.getScrollbarWidth()+"px"},getContentWidth:function(){return Math.max(0,
t._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px"},render:function(){this.scrollboxNode.style.height="";this.renderHeader();0<=this._togglingColumn&&(this.setColumnsWidth(this.getColumnsWidth()-this._togglingColumn),this._togglingColumn=-1);var a=this.grid.layout.cells,b=f.hitch(this,function(b,c){!this.grid.isLeftToRight()&&(c=!c);for(var d=c?-1:1,e=this.header.getCellNodeIndex(b)+d,f=a[e];f&&f.getHeaderNode()&&"none"==f.getHeaderNode().style.display;)e+=d,f=a[e];return f?f.getHeaderNode():
null});if(this.grid.columnReordering&&this.simpleStructure){this.source&&this.source.destroy();this.bottomMarker&&t.destroy(this.bottomMarker);this.bottomMarker=t.byId("dojoxGrid_bottomMarker");this.topMarker&&t.destroy(this.topMarker);this.topMarker=t.byId("dojoxGrid_topMarker");this.bottomMarker||(this.bottomMarker=t.create("div",{id:"dojoxGrid_bottomMarker","class":"dojoxGridColPlaceBottom"},e.body()),this._hide(this.bottomMarker),this.topMarker=t.create("div",{id:"dojoxGrid_topMarker","class":"dojoxGridColPlaceTop"},
e.body()),this._hide(this.topMarker));this.arrowDim=t.contentBox(this.bottomMarker);var c=t.contentBox(this.headerContentNode.firstChild.rows[0]).h;this.source=new n(this.headerContentNode.firstChild.rows[0],{horizontal:!0,accept:["gridColumn_"+this.grid.id],viewIndex:this.index,generateText:!1,onMouseDown:f.hitch(this,function(a){this.header.decorateEvent(a);if((this.header.overRightResizeArea(a)||this.header.overLeftResizeArea(a))&&this.header.canResize(a)&&!this.header.moveable)this.header.beginColumnResize(a);
else{if(this.grid.headerMenu)this.grid.headerMenu.onCancel(!0);a.button===(9>m("ie")?1:0)&&n.prototype.onMouseDown.call(this.source,a)}}),onMouseOver:f.hitch(this,function(a){var b=this.source;b._getChildByEvent(a)&&n.prototype.onMouseOver.apply(b,arguments)}),_markTargetAnchor:f.hitch(this,function(a){var d=this.source;if(d.current!=d.targetAnchor||d.before!=a){d.targetAnchor&&b(d.targetAnchor,d.before)&&d._removeItemClass(b(d.targetAnchor,d.before),d.before?"After":"Before");n.prototype._markTargetAnchor.call(d,
a);var e=a?d.targetAnchor:b(d.targetAnchor,d.before);a=0;e||(e=d.targetAnchor,a=t.contentBox(e).w+this.arrowDim.w/2+2);e=t.position(e,!0);a=Math.floor(e.x-this.arrowDim.w/2+a);t.style(this.bottomMarker,"visibility","visible");t.style(this.topMarker,"visibility","visible");t.style(this.bottomMarker,{left:a+"px",top:c+e.y+"px"});t.style(this.topMarker,{left:a+"px",top:e.y-this.arrowDim.h+"px"});d.targetAnchor&&b(d.targetAnchor,d.before)&&d._addItemClass(b(d.targetAnchor,d.before),d.before?"After":"Before")}}),
_unmarkTargetAnchor:f.hitch(this,function(){var a=this.source;a.targetAnchor&&(a.targetAnchor&&b(a.targetAnchor,a.before)&&a._removeItemClass(b(a.targetAnchor,a.before),a.before?"After":"Before"),this._hide(this.bottomMarker),this._hide(this.topMarker),n.prototype._unmarkTargetAnchor.call(a))}),destroy:f.hitch(this,function(){k.disconnect(this._source_conn);k.unsubscribe(this._source_sub);n.prototype.destroy.call(this.source);this.bottomMarker&&(t.destroy(this.bottomMarker),delete this.bottomMarker);
this.topMarker&&(t.destroy(this.topMarker),delete this.topMarker)}),onDndCancel:f.hitch(this,function(){n.prototype.onDndCancel.call(this.source);this._hide(this.bottomMarker);this._hide(this.topMarker)})});this._source_conn=k.connect(this.source,"onDndDrop",this,"_onDndDrop");this._source_sub=k.subscribe("/dnd/drop/before",this,"_onDndDropBefore");this.source.startup()}},_hide:function(a){t.style(a,{top:"-10000px",visibility:"hidden"})},_onDndDropBefore:function(a,b,c){y.manager().target===this.source&&
(this.source._targetNode=this.source.targetAnchor,this.source._beforeTarget=this.source.before,b=this.grid.views.views,a=b[a.viewIndex],b=b[this.index],b!=a&&(a.convertColPctToFixed(),b.convertColPctToFixed()))},_onDndDrop:function(a,b,c){if(y.manager().target!==this.source)y.manager().source===this.source&&(this._removingColumn=!0);else{this._hide(this.bottomMarker);this._hide(this.topMarker);c=function(a){return a?t.attr(a,"idx"):null};var d=t.marginBox(b[0]).w;if(a.viewIndex!==this.index){var e=
this.grid.views.views,f=e[a.viewIndex],e=e[this.index];f.viewWidth&&"auto"!=f.viewWidth&&f.setColumnsWidth(f.getColumnsWidth()-d);e.viewWidth&&"auto"!=e.viewWidth&&e.setColumnsWidth(e.getColumnsWidth())}d=this.source._targetNode;f=this.source._beforeTarget;!this.grid.isLeftToRight()&&(f=!f);var e=this.grid.layout,g=this.index;delete this.source._targetNode;delete this.source._beforeTarget;e.moveColumn(a.viewIndex,g,c(b[0]),c(d),f)}},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent);
this.flexCells&&(this.contentWidth=this.getContentWidth(),this.headerContentNode.firstChild.style.width=this.contentWidth);v.fire(this,"onAfterRow",[-1,this.structure.cells,this.headerContentNode])},_getHeaderContent:function(a){var b=a.name||a.grid.getCellName(a);/^\s+$/.test(b)&&(b="\x26nbsp;");var c=['\x3cdiv class\x3d"dojoxGridSortNode'];a.index!=a.grid.getSortIndex()?c.push('"\x3e'):c=c.concat([" ",0<a.grid.sortInfo?"dojoxGridSortUp":"dojoxGridSortDown",'"\x3e\x3cdiv class\x3d"dojoxGridArrowButtonChar"\x3e',
0<a.grid.sortInfo?"\x26#9650;":"\x26#9660;",'\x3c/div\x3e\x3cdiv class\x3d"dojoxGridArrowButtonNode" role\x3d"presentation"\x3e\x3c/div\x3e','\x3cdiv class\x3d"dojoxGridColCaption"\x3e']);c=c.concat([b,"\x3c/div\x3e\x3c/div\x3e"]);return c.join("")},resize:function(){this.adaptHeight();this.adaptWidth()},hasHScrollbar:function(a){var b=this._hasHScroll||!1;if(void 0==this._hasHScroll||a)this.noscroll?this._hasHScroll=!1:(a=t.style(this.scrollboxNode,"overflow"),this._hasHScroll="hidden"==a?!1:"scroll"==
a?!0:this.scrollboxNode.offsetWidth-this.getScrollbarWidth()<this.contentNode.offsetWidth);b!==this._hasHScroll&&this.grid.update();return this._hasHScroll},hasVScrollbar:function(a){var b=this._hasVScroll||!1;if(void 0==this._hasVScroll||a)this.noscroll?this._hasVScroll=!1:(a=t.style(this.scrollboxNode,"overflow"),this._hasVScroll="hidden"==a?!1:"scroll"==a?!0:this.scrollboxNode.scrollHeight>this.scrollboxNode.clientHeight);b!==this._hasVScroll&&this.grid.update();return this._hasVScroll},convertColPctToFixed:function(){var a=
!1;this.grid.initialWidth="";var c=g("th",this.headerContentNode),d=b.map(c,function(b,c){var d=b.style.width;t.attr(b,"vIdx",c);if(d&&"%"==d.slice(-1))a=!0;else if(d&&"px"==d.slice(-2))return window.parseInt(d,10);return t.contentBox(b).w});return a?(b.forEach(this.grid.layout.cells,function(a,b){if(a.view==this){var c=a.view.getHeaderCellNode(a.index);if(c&&t.hasAttr(c,"vIdx")){var e=window.parseInt(t.attr(c,"vIdx"));this.setColWidth(b,d[e]);t.removeAttr(c,"vIdx")}}},this),!0):!1},adaptHeight:function(a){if(!this.grid._autoHeight){var b=
this.domNode.style.height&&parseInt(this.domNode.style.height.replace(/px/,""),10)||this.domNode.clientHeight;if(!a&&(a=this.noscroll))a:{for(var c=0;c<this.grid.views.views.length;++c)if(a=this.grid.views.views[c],a!==this&&a.hasHScrollbar()){a=!0;break a}a=!1}a&&(b-=u.getScrollbar().h);v.setStyleHeightPx(this.scrollboxNode,b)}this.hasVScrollbar(!0)},adaptWidth:function(){this.flexCells&&(this.contentWidth=this.getContentWidth(),this.headerContentNode.firstChild.style.width=this.contentWidth);var a=
this.scrollboxNode.offsetWidth-this.getScrollbarWidth();this._removingColumn?(a=Math.min(a,this.getColumnsWidth())+"px",this._removingColumn=!1):a=Math.max(a,this.getColumnsWidth())+"px";this.contentNode.style.width=a;this.hasHScrollbar(!0)},setSize:function(a,b){var c=this.domNode.style,d=this.headerNode.style;a&&(c.width=a,d.width=a);c.height=0<=b?b+"px":""},renderRow:function(a){var b=this.createRowNode(a);this.buildRow(a,b);return b},createRowNode:function(b){var c=document.createElement("div");
c.className=this.classTag+"Row";this instanceof a.grid._RowSelector?t.attr(c,"role","presentation"):(t.attr(c,"role","row"),"none"!=this.grid.selectionMode&&c.setAttribute("aria-selected","false"));c[v.gridViewTag]=this.id;c[v.rowIndexTag]=b;return this.rowNodes[b]=c},buildRow:function(a,b){this.buildRowContent(a,b);this.styleRow(a,b)},buildRowContent:function(a,b){b.innerHTML=this.content.generateHtml(a,a);this.flexCells&&this.contentWidth&&(b.firstChild.style.width=this.contentWidth);v.fire(this,
"onAfterRow",[a,this.structure.cells,b])},rowRemoved:function(a){0<=a&&this._cleanupRowWidgets(this.getRowNode(a));this.grid.edit.save(this,a);delete this.rowNodes[a]},getRowNode:function(a){return this.rowNodes[a]},getCellNode:function(a,b){var c=this.getRowNode(a);if(c)return this.content.getCellNode(c,b)},getHeaderCellNode:function(a){if(this.headerContentNode)return this.header.getCellNode(this.headerContentNode,a)},styleRow:function(a,b){var c;c=void 0==b.style.cssText?b.getAttribute("style"):
b.style.cssText;b._style=c;this.styleRowNode(a,b)},styleRowNode:function(a,b){b&&this.doStyleRowNode(a,b)},doStyleRowNode:function(a,b){this.grid.styleRowNode(a,b)},updateRow:function(a){var b=this.getRowNode(a);b&&(b.style.height="",this.buildRow(a,b));return b},updateRowStyles:function(a){this.styleRowNode(a,this.getRowNode(a))},lastTop:0,firstScroll:0,_nativeScroll:!1,doscroll:function(a){if(13<=m("ff")||m("chrome"))this._nativeScroll=!0;a=this.grid.isLeftToRight();if(2>this.firstScroll){if(!a&&
1==this.firstScroll||a&&0===this.firstScroll){var b=t.marginBox(this.headerNodeContainer);m("ie")?this.headerNodeContainer.style.width=b.w+this.getScrollbarWidth()+"px":m("mozilla")&&(this.headerNodeContainer.style.width=b.w-this.getScrollbarWidth()+"px",this.scrollboxNode.scrollLeft=a?this.scrollboxNode.clientWidth-this.scrollboxNode.scrollWidth:this.scrollboxNode.scrollWidth-this.scrollboxNode.clientWidth)}this.firstScroll++}this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;a=this.scrollboxNode.scrollTop;
a!==this.lastTop&&this.grid.scrollTo(a);this._nativeScroll=!1},setScrollTop:function(a){this.lastTop=a;this._nativeScroll||(this.scrollboxNode.scrollTop=a);return this.scrollboxNode.scrollTop},doContentEvent:function(a){if(this.content.decorateEvent(a))this.grid.onContentEvent(a)},doHeaderEvent:function(a){if(this.header.decorateEvent(a))this.grid.onHeaderEvent(a)},dispatchContentEvent:function(a){return this.content.dispatchEvent(a)},dispatchHeaderEvent:function(a){return this.header.dispatchEvent(a)},
setColWidth:function(a,b){this.grid.setCellWidth(a,b+"px")},update:function(){if(this.domNode){this.content.update();this.grid.update();var a=this.scrollboxNode.scrollLeft;this.scrollboxNode.scrollLeft=a;this.headerNode.scrollLeft=a}}});var z=d("dojox.grid._GridAvatar",x,{construct:function(){var a=e.doc,b=a.createElement("table");b.cellPadding=b.cellSpacing="0";b.className="dojoxGridDndAvatar";b.style.position="absolute";b.style.zIndex=1999;b.style.margin="0px";var c=a.createElement("tbody"),d=a.createElement("tr"),
f=a.createElement("td"),g=a.createElement("td");d.className="dojoxGridDndAvatarItem";g.className="dojoxGridDndAvatarItemImage";g.style.width="16px";var k=this.manager.source;if(k.creator)k=k._normalizedCreator(k.getItem(this.manager.nodes[0].id).data,"avatar").node;else{var k=this.manager.nodes[0].cloneNode(!0),h,m;"tr"==k.tagName.toLowerCase()?(h=a.createElement("table"),m=a.createElement("tbody"),m.appendChild(k),h.appendChild(m),k=h):"th"==k.tagName.toLowerCase()&&(h=a.createElement("table"),m=
a.createElement("tbody"),a=a.createElement("tr"),h.cellPadding=h.cellSpacing="0",a.appendChild(k),m.appendChild(a),h.appendChild(m),k=h)}k.id="";f.appendChild(k);d.appendChild(g);d.appendChild(f);t.style(d,"opacity",.9);c.appendChild(d);b.appendChild(c);this.node=b;b=y.manager();this.oldOffsetY=b.OFFSET_Y;b.OFFSET_Y=1},destroy:function(){y.manager().OFFSET_Y=this.oldOffsetY;this.inherited(arguments)}}),A=y.manager().makeAvatar;y.manager().makeAvatar=function(){return void 0===this.source.viewIndex||
t.hasClass(e.body(),"dijit_a11y")?A.call(y.manager()):new z(this)};return c})},"dojo/main":function(){define("./_base/kernel ./has require ./sniff ./_base/lang ./_base/array ./_base/config ./ready ./_base/declare ./_base/connect ./_base/Deferred ./_base/json ./_base/Color require ./_base/browser require".split(" "),function(h,l,a,d,b,f,k,m){k.isDebug&&a(["./_firebug/firebug"]);return h})},"dojo/_base/browser":function(){require.has&&require.has.add("config-selectorEngine","acme");define("../ready ./kernel ./connect ./unload ./window ./event ./html ./NodeList ../query ./xhr ./fx".split(" "),
function(h){return h})},"dojo/_base/NodeList":function(){define(["./kernel","../query","./array","./html","../NodeList-dom"],function(h,l,a){l=l.NodeList;var d=l.prototype;d.connect=l._adaptAsForEach(function(){return h.connect.apply(this,arguments)});d.coords=l._adaptAsMap(h.coords);l.events="blur focus change click error keydown keypress keyup load mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup submit".split(" ");a.forEach(l.events,function(a){var f="on"+a;d[f]=function(a,
b){return this.connect(f,a,b)}});return h.NodeList=l})},"dojo/dnd/Source":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom-class ../dom-geometry ../mouse ../ready ../topic ./common ./Selector ./Manager".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n){a.isAsync||m(0,function(){require(["dojo/dnd/AutoSource","dojo/dnd/Target"])});var q=l("dojo.dnd.Source",c,{isSource:!0,horizontal:!1,copyOnly:!1,selfCopy:!1,selfAccept:!0,skipForm:!1,withHandles:!1,autoSync:!1,delay:0,
accept:["text"],generateText:!0,constructor:function(a,c){d.mixin(this,d.mixin({},c));var e=this.accept;if(e.length){this.accept={};for(var f=0;f<e.length;++f)this.accept[e[f]]=1}this.mouseDown=this.isDragging=!1;this.targetBox=this.targetAnchor=null;this.before=!0;this._lastY=this._lastX=0;this.sourceState="";this.isSource&&b.add(this.node,"dojoDndSource");this.targetState="";this.accept&&b.add(this.node,"dojoDndTarget");this.horizontal&&b.add(this.node,"dojoDndHorizontal");this.topics=[g.subscribe("/dnd/source/over",
d.hitch(this,"onDndSourceOver")),g.subscribe("/dnd/start",d.hitch(this,"onDndStart")),g.subscribe("/dnd/drop",d.hitch(this,"onDndDrop")),g.subscribe("/dnd/cancel",d.hitch(this,"onDndCancel"))]},checkAcceptance:function(a,b){if(this==a)return!this.copyOnly||this.selfAccept;for(var c=0;c<b.length;++c){for(var d=a.getItem(b[c].id).type,e=!1,f=0;f<d.length;++f)if(d[f]in this.accept){e=!0;break}if(!e)return!1}return!0},copyState:function(a,b){if(a)return!0;2>arguments.length&&(b=this==n.manager().target);
if(b){if(this.copyOnly)return this.selfCopy}else return this.copyOnly;return!1},destroy:function(){q.superclass.destroy.call(this);h.forEach(this.topics,function(a){a.remove()});this.targetAnchor=null},onMouseMove:function(a){if(!this.isDragging||"Disabled"!=this.targetState){q.superclass.onMouseMove.call(this,a);var b=n.manager();if(!this.isDragging&&this.mouseDown&&this.isSource&&(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)){var c=this.getSelectedNodes();
c.length&&b.startDrag(this,c,this.copyState(e.getCopyKeyState(a),!0))}this.isDragging&&(c=!1,this.current&&(this.targetBox&&this.targetAnchor==this.current||(this.targetBox=f.position(this.current,!0)),c=this.horizontal?a.pageX-this.targetBox.x<this.targetBox.w/2==f.isBodyLtr(this.current.ownerDocument):a.pageY-this.targetBox.y<this.targetBox.h/2),this.current!=this.targetAnchor||c!=this.before)&&(this._markTargetAnchor(c),b.canDrop(!this.current||b.source!=this||!(this.current.id in this.selection)))}},
onMouseDown:function(a){this.mouseDown||!this._legalMouseDown(a)||this.skipForm&&e.isFormElement(a)||(this.mouseDown=!0,this._lastX=a.pageX,this._lastY=a.pageY,q.superclass.onMouseDown.call(this,a))},onMouseUp:function(a){this.mouseDown&&(this.mouseDown=!1,q.superclass.onMouseUp.call(this,a))},onDndSourceOver:function(a){this!==a?(this.mouseDown=!1,this.targetAnchor&&this._unmarkTargetAnchor()):this.isDragging&&(a=n.manager(),a.canDrop("Disabled"!=this.targetState&&(!this.current||a.source!=this||
!(this.current.id in this.selection))))},onDndStart:function(a,b,c){this.autoSync&&this.sync();this.isSource&&this._changeState("Source",this==a?c?"Copied":"Moved":"");b=this.accept&&this.checkAcceptance(a,b);this._changeState("Target",b?"":"Disabled");this==a&&n.manager().overSource(this);this.isDragging=!0},onDndDrop:function(a,b,c,d){if(this==d)this.onDrop(a,b,c);this.onDndCancel()},onDndCancel:function(){this.targetAnchor&&(this._unmarkTargetAnchor(),this.targetAnchor=null);this.before=!0;this.mouseDown=
this.isDragging=!1;this._changeState("Source","");this._changeState("Target","")},onDrop:function(a,b,c){if(this!=a)this.onDropExternal(a,b,c);else this.onDropInternal(b,c)},onDropExternal:function(a,b,c){var d=this._normalizedCreator;this._normalizedCreator=this.creator?function(b,c){return d.call(this,a.getItem(b.id).data,c)}:c?function(b){var c=a.getItem(b.id);b=b.cloneNode(!0);b.id=e.getUniqueId();return{node:b,data:c.data,type:c.type}}:function(b){var c=a.getItem(b.id);a.delItem(b.id);return{node:b,
data:c.data,type:c.type}};this.selectNone();c||this.creator||a.selectNone();this.insertNodes(!0,b,this.before,this.current);!c&&this.creator&&a.deleteSelectedNodes();this._normalizedCreator=d},onDropInternal:function(a,b){var c=this._normalizedCreator;if(!(this.current&&this.current.id in this.selection)){if(b)this._normalizedCreator=this.creator?function(a,b){return c.call(this,this.getItem(a.id).data,b)}:function(a){var b=this.getItem(a.id);a=a.cloneNode(!0);a.id=e.getUniqueId();return{node:a,data:b.data,
type:b.type}};else{if(!this.current)return;this._normalizedCreator=function(a){var b=this.getItem(a.id);return{node:a,data:b.data,type:b.type}}}this._removeSelection();this.insertNodes(!0,a,this.before,this.current);this._normalizedCreator=c}},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){q.superclass.onOverEvent.call(this);n.manager().overSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOver()},onOutEvent:function(){q.superclass.onOutEvent.call(this);
n.manager().outSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOut()},_markTargetAnchor:function(a){if(this.current!=this.targetAnchor||this.before!=a)this.targetAnchor&&this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetAnchor=this.current,this.targetBox=null,this.before=a,this.targetAnchor&&this._addItemClass(this.targetAnchor,this.before?"Before":"After")},_unmarkTargetAnchor:function(){this.targetAnchor&&(this._removeItemClass(this.targetAnchor,
this.before?"Before":"After"),this.targetBox=this.targetAnchor=null,this.before=!0)},_markDndStatus:function(a){this._changeState("Source",a?"Copied":"Moved")},_legalMouseDown:function(a){if("touchstart"!=a.type&&!k.isLeft(a))return!1;if(!this.withHandles)return!0;for(a=a.target;a&&a!==this.node;a=a.parentNode){if(b.contains(a,"dojoDndHandle"))return!0;if(b.contains(a,"dojoDndItem")||b.contains(a,"dojoDndIgnore"))break}return!1}});return q})},"dojo/dnd/Selector":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom ../dom-construct ../mouse ../_base/NodeList ../on ../touch ./common ./Container".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n){var q=l("dojo.dnd.Selector",n,{constructor:function(a,b){b||(b={});this.singular=b.singular;this.autoSync=b.autoSync;this.selection={};this.anchor=null;this.simpleSelection=!1;this.events.push(g(this.node,e.press,d.hitch(this,"onMouseDown")),g(this.node,e.release,d.hitch(this,"onMouseUp")))},singular:!1,getSelectedNodes:function(){var a=new m,d=c._empty,e;for(e in this.selection)e in d||a.push(b.byId(e));return a},selectNone:function(){return this._removeSelection()._removeAnchor()},
selectAll:function(){this.forInItems(function(a,c){this._addItemClass(b.byId(c),"Selected");this.selection[c]=1},this);return this._removeAnchor()},deleteSelectedNodes:function(){var a=c._empty,d;for(d in this.selection)if(!(d in a)){var e=b.byId(d);this.delItem(d);f.destroy(e)}this.anchor=null;this.selection={};return this},forInSelectedItems:function(b,d){d=d||a.global;var e=this.selection,f=c._empty,g;for(g in e)g in f||b.call(d,this.getItem(g),g,this)},sync:function(){q.superclass.sync.call(this);
this.anchor&&!this.getItem(this.anchor.id)&&(this.anchor=null);var a=[],b=c._empty,d;for(d in this.selection)d in b||this.getItem(d)||a.push(d);h.forEach(a,function(a){delete this.selection[a]},this);return this},insertNodes:function(a,b,c,d){var e=this._normalizedCreator;this._normalizedCreator=function(b,c){var d=e.call(this,b,c);a?(this.anchor?this.anchor!=d.node&&(this._removeItemClass(d.node,"Anchor"),this._addItemClass(d.node,"Selected")):(this.anchor=d.node,this._removeItemClass(d.node,"Selected"),
this._addItemClass(this.anchor,"Anchor")),this.selection[d.node.id]=1):(this._removeItemClass(d.node,"Selected"),this._removeItemClass(d.node,"Anchor"));return d};q.superclass.insertNodes.call(this,b,c,d);this._normalizedCreator=e;return this},destroy:function(){q.superclass.destroy.call(this);this.selection=this.anchor=null},onMouseDown:function(a){this.autoSync&&this.sync();if(this.current)if(!this.singular&&!c.getCopyKeyState(a)&&!a.shiftKey&&this.current.id in this.selection)this.simpleSelection=
!0,k.isLeft(a)&&(a.stopPropagation(),a.preventDefault());else{if(!this.singular&&a.shiftKey){c.getCopyKeyState(a)||this._removeSelection();var b=this.getAllNodes();if(b.length&&(this.anchor||(this.anchor=b[0],this._addItemClass(this.anchor,"Anchor")),this.selection[this.anchor.id]=1,this.anchor!=this.current)){for(var d=0,e;d<b.length&&(e=b[d],e!=this.anchor&&e!=this.current);++d);for(++d;d<b.length;++d){e=b[d];if(e==this.anchor||e==this.current)break;this._addItemClass(e,"Selected");this.selection[e.id]=
1}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1}}else this.singular?this.anchor==this.current?c.getCopyKeyState(a)&&this.selectNone():(this.selectNone(),this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1):c.getCopyKeyState(a)?this.anchor==this.current?(delete this.selection[this.anchor.id],this._removeAnchor()):this.current.id in this.selection?(this._removeItemClass(this.current,"Selected"),delete this.selection[this.current.id]):
(this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this._addItemClass(this.anchor,"Selected")),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1):this.current.id in this.selection||(this.selectNone(),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1);a.stopPropagation();a.preventDefault()}},onMouseUp:function(){this.simpleSelection&&(this.simpleSelection=!1,this.selectNone(),this.current&&
(this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1))},onMouseMove:function(){this.simpleSelection=!1},onOverEvent:function(){this.onmousemoveEvent=g(this.node,e.move,d.hitch(this,"onMouseMove"))},onOutEvent:function(){this.onmousemoveEvent&&(this.onmousemoveEvent.remove(),delete this.onmousemoveEvent)},_removeSelection:function(){var a=c._empty,d;for(d in this.selection)if(!(d in a)){var e=b.byId(d);e&&this._removeItemClass(e,"Selected")}this.selection=
{};return this},_removeAnchor:function(){this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this.anchor=null);return this}});return q})},"dojo/dnd/Container":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../_base/window ../dom ../dom-class ../dom-construct ../Evented ../has ../on ../query ../touch ./common".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r){l=l("dojo.dnd.Container",g,{skipForm:!1,allowNested:!1,constructor:function(a,b){this.node=f.byId(a);
b||(b={});this.creator=b.creator||null;this.skipForm=b.skipForm;this.parent=b.dropParent&&f.byId(b.dropParent);this.map={};this.current=null;this.containerState="";k.add(this.node,"dojoDndContainer");b&&b._skipStartup||this.startup();this.events=[c(this.node,q.over,d.hitch(this,"onMouseOver")),c(this.node,q.out,d.hitch(this,"onMouseOut")),c(this.node,"dragstart",d.hitch(this,"onSelectStart")),c(this.node,"selectstart",d.hitch(this,"onSelectStart"))]},creator:function(){},getItem:function(a){return this.map[a]},
setItem:function(a,b){this.map[a]=b},delItem:function(a){delete this.map[a]},forInItems:function(b,c){c=c||a.global;var d=this.map,e=r._empty,f;for(f in d)f in e||b.call(c,d[f],f,this);return c},clearItems:function(){this.map={}},getAllNodes:function(){return n((this.allowNested?"":"\x3e ")+".dojoDndItem",this.parent)},sync:function(){var a={};this.getAllNodes().forEach(function(b){if(b.id){var c=this.getItem(b.id);if(c){a[b.id]=c;return}}else b.id=r.getUniqueId();var c=b.getAttribute("dndType"),
d=b.getAttribute("dndData");a[b.id]={data:d||b.innerHTML,type:c?c.split(/\s*,\s*/):["text"]}},this);this.map=a;return this},insertNodes:function(a,b,c){this.parent.firstChild?b?c||(c=this.parent.firstChild):c&&(c=c.nextSibling):c=null;var d;if(c)for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),c.parentNode.insertBefore(d.node,c);else for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),this.parent.appendChild(d.node);
return this},destroy:function(){h.forEach(this.events,function(a){a.remove()});this.clearItems();this.node=this.parent=this.current=null},markupFactory:function(a,b,c){a._skipStartup=!0;return new c(b,a)},startup:function(){if(!this.parent&&(this.parent=this.node,"table"==this.parent.tagName.toLowerCase())){var a=this.parent.getElementsByTagName("tbody");a&&a.length&&(this.parent=a[0])}this.defaultCreator=r._defaultCreator(this.parent);this.sync()},onMouseOver:function(a){for(var b=a.relatedTarget;b&&
b!=this.node;)try{b=b.parentNode}catch(c){b=null}b||(this._changeState("Container","Over"),this.onOverEvent());b=this._getChildByEvent(a);this.current!=b&&(this.current&&this._removeItemClass(this.current,"Over"),b&&this._addItemClass(b,"Over"),this.current=b)},onMouseOut:function(a){for(a=a.relatedTarget;a;){if(a==this.node)return;try{a=a.parentNode}catch(b){a=null}}this.current&&(this._removeItemClass(this.current,"Over"),this.current=null);this._changeState("Container","");this.onOutEvent()},onSelectStart:function(a){this.skipForm&&
r.isFormElement(a)||(a.stopPropagation(),a.preventDefault())},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(a,b){var c="dojoDnd"+a,d=a.toLowerCase()+"State";k.replace(this.node,c+b,c+this[d]);this[d]=b},_addItemClass:function(a,b){k.add(a,"dojoDndItem"+b)},_removeItemClass:function(a,b){k.remove(a,"dojoDndItem"+b)},_getChildByEvent:function(a){if(a=a.target)for(var b=a.parentNode;b;a=b,b=a.parentNode)if((b==this.parent||this.allowNested)&&k.contains(a,"dojoDndItem"))return a;
return null},_normalizedCreator:function(a,b){var c=(this.creator||this.defaultCreator).call(this,a,b);d.isArray(c.type)||(c.type=["text"]);c.node.id||(c.node.id=r.getUniqueId());k.add(c.node,"dojoDndItem");return c}});r._createNode=function(a){return a?function(b){return m.create(a,{innerHTML:b})}:r._createSpan};r._createTrTd=function(a){var b=m.create("tr");m.create("td",{innerHTML:a},b);return b};r._createSpan=function(a){return m.create("span",{innerHTML:a})};r._defaultCreatorNodes={ul:"li",ol:"li",
div:"div",p:"div"};r._defaultCreator=function(a){a=a.tagName.toLowerCase();var b="tbody"==a||"thead"==a?r._createTrTd:r._createNode(r._defaultCreatorNodes[a]);return function(a,c){var e=a&&d.isObject(a),f,g;e&&a.tagName&&a.nodeType&&a.getAttribute?(f=a.getAttribute("dndData")||a.innerHTML,e=(e=a.getAttribute("dndType"))?e.split(/\s*,\s*/):["text"],g=a):(f=e&&a.data?a.data:a,e=e&&a.type?a.type:["text"],g=("avatar"==c?r._createSpan:b)(String(f)));g.id||(g.id=r.getUniqueId());return{node:g,data:f,type:e}}};
return l})},"dojo/dnd/Manager":function(){define("../_base/array ../_base/declare ../_base/lang ../_base/window ../dom-class ../Evented ../has ../keys ../on ../topic ../touch ./common ./autoscroll ./Avatar".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r){var u=l("dojo.dnd.Manager",[f],{constructor:function(){this.source=this.avatar=null;this.nodes=[];this.copy=!0;this.target=null;this.canDropFlag=!1;this.events=[]},OFFSET_X:k("touch")?0:16,OFFSET_Y:k("touch")?-64:16,overSource:function(a){this.avatar&&
(this.target=a&&"Disabled"!=a.targetState?a:null,this.canDropFlag=Boolean(this.target),this.avatar.update());e.publish("/dnd/source/over",a)},outSource:function(a){this.avatar?this.target==a&&(this.target=null,this.canDropFlag=!1,this.avatar.update(),e.publish("/dnd/source/over",null)):e.publish("/dnd/source/over",null)},startDrag:function(f,k,h){function m(a){a.preventDefault();a.stopPropagation()}q.autoScrollStart(d.doc);this.source=f;this.nodes=k;this.copy=Boolean(h);this.avatar=this.makeAvatar();
d.body().appendChild(this.avatar.node);e.publish("/dnd/start",f,k,this.copy);this.events=[g(d.doc,c.move,a.hitch(this,"onMouseMove")),g(d.doc,c.release,a.hitch(this,"onMouseUp")),g(d.doc,"keydown",a.hitch(this,"onKeyDown")),g(d.doc,"keyup",a.hitch(this,"onKeyUp")),g(d.doc,"dragstart",m),g(d.body(),"selectstart",m)];f="dojoDnd"+(h?"Copy":"Move");b.add(d.body(),f)},canDrop:function(a){a=Boolean(this.target&&a);this.canDropFlag!=a&&(this.canDropFlag=a,this.avatar.update())},stopDrag:function(){b.remove(d.body(),
["dojoDndCopy","dojoDndMove"]);h.forEach(this.events,function(a){a.remove()});this.events=[];this.avatar.destroy();this.source=this.target=this.avatar=null;this.nodes=[]},makeAvatar:function(){return new r(this)},updateAvatar:function(){this.avatar.update()},onMouseMove:function(a){var b=this.avatar;b&&(q.autoScrollNodes(a),b=b.node.style,b.left=a.pageX+this.OFFSET_X+"px",b.top=a.pageY+this.OFFSET_Y+"px",b=Boolean(this.source.copyState(n.getCopyKeyState(a))),this.copy!=b&&this._setCopyStatus(b));
k("touch")&&a.preventDefault()},onMouseUp:function(a){if(this.avatar){if(this.target&&this.canDropFlag){var b=Boolean(this.source.copyState(n.getCopyKeyState(a)));e.publish("/dnd/drop/before",this.source,this.nodes,b,this.target,a);e.publish("/dnd/drop",this.source,this.nodes,b,this.target,a)}else e.publish("/dnd/cancel");this.stopDrag()}},onKeyDown:function(a){if(this.avatar)switch(a.keyCode){case m.CTRL:a=Boolean(this.source.copyState(!0));this.copy!=a&&this._setCopyStatus(a);break;case m.ESCAPE:e.publish("/dnd/cancel"),
this.stopDrag()}},onKeyUp:function(a){this.avatar&&a.keyCode==m.CTRL&&(a=Boolean(this.source.copyState(!1)),this.copy!=a&&this._setCopyStatus(a))},_setCopyStatus:function(a){this.copy=a;this.source._markDndStatus(this.copy);this.updateAvatar();b.replace(d.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"))}});n._manager=null;u.manager=n.manager=function(){n._manager||(n._manager=new u);return n._manager};return u})},"dojo/dnd/Avatar":function(){define("../_base/declare ../_base/window ../dom ../dom-attr ../dom-class ../dom-construct ../hccss ../query".split(" "),
function(h,l,a,d,b,f,k,m){return h("dojo.dnd.Avatar",null,{constructor:function(a){this.manager=a;this.construct()},construct:function(){var a=f.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),b=this.manager.source,c,h=f.create("tbody",null,a),m=f.create("tr",null,h),l=f.create("td",null,m),u=Math.min(5,this.manager.nodes.length),v=0;k("highcontrast")&&f.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"\x3c"},l);f.create("span",{innerHTML:b.generateText?
this._generateText():""},l);for(d.set(m,{"class":"dojoDndAvatarHeader",style:{opacity:.9}});v<u;++v)b.creator?c=b._normalizedCreator(b.getItem(this.manager.nodes[v].id).data,"avatar").node:(c=this.manager.nodes[v].cloneNode(!0),"tr"==c.tagName.toLowerCase()&&(m=f.create("table"),f.create("tbody",null,m).appendChild(c),c=m)),c.id="",m=f.create("tr",null,h),l=f.create("td",null,m),l.appendChild(c),d.set(m,{"class":"dojoDndAvatarItem",style:{opacity:(9-v)/10}});this.node=a},destroy:function(){f.destroy(this.node);
this.node=!1},update:function(){b.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(k("highcontrast")){var d=a.byId("a11yIcon"),e="+";this.manager.canDropFlag&&!this.manager.copy?e="\x3c ":this.manager.canDropFlag||this.manager.copy?this.manager.canDropFlag||(e="x"):e="o";d.innerHTML=e}m("tr.dojoDndAvatarHeader td span"+(k("highcontrast")?" span":""),this.node).forEach(function(a){a.innerHTML=this.manager.source.generateText?this._generateText():""},this)},_generateText:function(){return this.manager.nodes.length.toString()}})})},
"dojox/html/metrics":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/sniff dojo/ready dojo/_base/unload dojo/_base/window dojo/dom-geometry".split(" "),function(h,l,a,d,b,f,k){var m=l.getObject("dojox.html.metrics",!0),g=l.getObject("dojox");m.getFontMeasurements=function(){var b={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},c;a("ie")&&(c=f.doc.documentElement.style.fontSize||"",c||(f.doc.documentElement.style.fontSize=
"100%"));var d=f.doc.createElement("div"),e=d.style;e.position="absolute";e.left="-100px";e.top="0";e.width="30px";e.height="1000em";e.borderWidth="0";e.margin="0";e.padding="0";e.outline="0";e.lineHeight="1";e.overflow="hidden";f.body().appendChild(d);for(var g in b)e.fontSize=g,b[g]=16*Math.round(12*d.offsetHeight/16)/12/1E3;a("ie")&&(f.doc.documentElement.style.fontSize=c);f.body().removeChild(d);return b};var e=null;m.getCachedFontMeasurements=function(a){if(a||!e)e=m.getFontMeasurements();return e};
var c=null,n={};m.getTextBox=function(a,b,d){var e,g;if(c)e=c;else{e=c=f.doc.createElement("div");var h=f.doc.createElement("div");h.appendChild(e);g=h.style;g.overflow="scroll";g.position="absolute";g.left="0px";g.top="-10000px";g.width="1px";g.height="1px";g.visibility="hidden";g.borderWidth="0";g.margin="0";g.padding="0";g.outline="0";f.body().appendChild(h)}e.className="";g=e.style;g.borderWidth="0";g.margin="0";g.padding="0";g.outline="0";if(1<arguments.length&&b)for(var m in b)m in n||(g[m]=
b[m]);2<arguments.length&&d&&(e.className=d);e.innerHTML=a;g=k.position(e);g.w=e.parentNode.scrollWidth;return g};var q=16,r=16;m.getScrollbar=function(){return{w:q,h:r}};m._fontResizeNode=null;m.initOnFontResize=function(b){var c=m._fontResizeNode=f.doc.createElement("iframe");b=c.style;b.position="absolute";b.width="5em";b.height="10em";b.top="-10000px";b.display="none";a("ie")?c.onreadystatechange=function(){"complete"==c.contentWindow.document.readyState&&(c.onresize=c.contentWindow.parent[g._scopeName].html.metrics._fontresize)}:
c.onload=function(){c.contentWindow.onresize=c.contentWindow.parent[g._scopeName].html.metrics._fontresize};c.setAttribute("src","javascript:'\x3chtml\x3e\x3chead\x3e\x3cscript\x3eif(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}\x3c/script\x3e\x3c/head\x3e\x3cbody\x3e\x3c/body\x3e\x3c/html\x3e'");f.body().appendChild(c);m.initOnFontResize=function(){}};m.onFontResize=function(){};m._fontresize=function(){m.onFontResize()};b.addOnUnload(function(){var b=m._fontResizeNode;b&&(a("ie")&&
b.onresize?b.onresize=null:b.contentWindow&&b.contentWindow.onresize&&(b.contentWindow.onresize=null),m._fontResizeNode=null)});d(function(){try{var a=f.doc.createElement("div");a.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";f.body().appendChild(a);q=a.offsetWidth-a.clientWidth;r=a.offsetHeight-a.clientHeight;f.body().removeChild(a);delete a}catch(b){}"fontSizeWatch"in h.config&&h.config.fontSizeWatch&&m.initOnFontResize()});return m})},
"dojox/grid/_Builder":function(){define("../main dojo/_base/array dojo/_base/lang dojo/_base/window dojo/_base/event dojo/_base/sniff dojo/_base/connect dojo/dnd/Moveable dojox/html/metrics ./util dojo/_base/html dojo/dom-geometry".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n){var q=h.grid,r=function(a){return 0<=a.rowIndex?a.rowIndex:l.indexOf(a.parentNode.childNodes,a)},u=function(a,b){return a&&((a.rows||0)[b]||a.childNodes[b])},v=function(a){for(;a&&"TABLE"!=a.tagName;a=a.parentNode);return a},
t=function(a){var b=a.toUpperCase();return function(a){return a.tagName!=b}},w=e.rowIndexTag,x=e.gridViewTag,y=q._Builder=a.extend(function(a){a&&(this.view=a,this.grid=a.grid)},{view:null,_table:'\x3ctable class\x3d"dojoxGridRowTable" border\x3d"0" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"',getTableArray:function(){var a=[this._table];this.view.viewWidth&&a.push([' style\x3d"width:',this.view.viewWidth,';"'].join(""));a.push("\x3e");return a},generateCellMarkup:function(a,b,c,
d){var e=[],f;d?(f=a.index!=a.grid.getSortIndex()?"":0<a.grid.sortInfo?'aria-sort\x3d"ascending"':'aria-sort\x3d"descending"',a.id||(a.id=this.grid.id+"Hdr"+a.index),f=['\x3cth tabIndex\x3d"-1" aria-readonly\x3d"true" role\x3d"columnheader"',f,' id\x3d"',a.id,'"']):f=['\x3ctd tabIndex\x3d"-1" role\x3d"gridcell"',this.grid.editable&&!a.editable?'aria-readonly\x3d"true"':""];a.colSpan&&f.push(' colspan\x3d"',a.colSpan,'"');a.rowSpan&&f.push(' rowspan\x3d"',a.rowSpan,'"');f.push(' class\x3d"dojoxGridCell ');
a.classes&&f.push(a.classes," ");c&&f.push(c," ");e.push(f.join(""));e.push("");f=['" idx\x3d"',a.index,'" style\x3d"'];b&&";"!=b[b.length-1]&&(b+=";");f.push(a.styles,b||"",a.hidden?"display:none;":"");a.unitWidth&&f.push("width:",a.unitWidth,";");e.push(f.join(""));e.push("");f=['"'];a.attrs&&f.push(" ",a.attrs);f.push("\x3e");e.push(f.join(""));e.push("");e.push(d?"\x3c/th\x3e":"\x3c/td\x3e");return e},isCellNode:function(a){return Boolean(a&&a!=d.doc&&c.attr(a,"idx"))},getCellNodeIndex:function(a){return a?
Number(c.attr(a,"idx")):-1},getCellNode:function(a,b){for(var c=0,d;(d=u(a.firstChild,c))&&d.cells;c++)for(var e=0,f;f=d.cells[e];e++)if(this.getCellNodeIndex(f)==b)return f;return null},findCellTarget:function(a,b){for(var c=a;c&&(!this.isCellNode(c)||c.offsetParent&&x in c.offsetParent.parentNode&&c.offsetParent.parentNode[x]!=this.view.id)&&c!=b;)c=c.parentNode;return c!=b?c:null},baseDecorateEvent:function(a){a.dispatch="do"+a.type;a.grid=this.grid;a.sourceView=this.view;a.cellNode=this.findCellTarget(a.target,
a.rowNode);a.cellIndex=this.getCellNodeIndex(a.cellNode);a.cell=0<=a.cellIndex?this.grid.getCell(a.cellIndex):null},findTarget:function(a,b){for(var c=a;c&&c!=this.domNode&&(!(b in c)||x in c&&c[x]!=this.view.id);)c=c.parentNode;return c!=this.domNode?c:null},findRowTarget:function(a){return this.findTarget(a,w)},isIntraNodeEvent:function(a){try{return a.cellNode&&a.relatedTarget&&c.isDescendant(a.relatedTarget,a.cellNode)}catch(b){return!1}},isIntraRowEvent:function(a){try{var b=a.relatedTarget&&
this.findRowTarget(a.relatedTarget);return!b&&-1==a.rowIndex||b&&a.rowIndex==b.gridRowIndex}catch(c){return!1}},dispatchEvent:function(a){return a.dispatch in this?this[a.dispatch](a):!1},domouseover:function(a){a.cellNode&&a.cellNode!=this.lastOverCellNode&&(this.lastOverCellNode=a.cellNode,this.grid.onMouseOver(a));this.grid.onMouseOverRow(a)},domouseout:function(a){if(a.cellNode&&a.cellNode==this.lastOverCellNode&&!this.isIntraNodeEvent(a,this.lastOverCellNode)&&(this.lastOverCellNode=null,this.grid.onMouseOut(a),
!this.isIntraRowEvent(a)))this.grid.onMouseOutRow(a)},domousedown:function(a){if(a.cellNode)this.grid.onMouseDown(a);this.grid.onMouseDownRow(a)},_getTextDirStyle:function(a,b,c){return""}});h=q._ContentBuilder=a.extend(function(a){y.call(this,a)},y.prototype,{update:function(){this.prepareHtml()},prepareHtml:function(){for(var a=this.grid.get,b=this.view.structure.cells,c=0,d;d=b[c];c++)for(var e=0,f;f=d[e];e++)f.get=f.get||void 0==f.value&&a,f.markup=this.generateCellMarkup(f,f.cellStyles,f.cellClasses,
!1),!this.grid.editable&&f.editable&&(this.grid.editable=!0)},generateHtml:function(a,b){var c=this.getTableArray(),d,f=this.view.structure.cells,g=this.grid.getItem(b);e.fire(this.view,"onBeforeRow",[b,f]);for(var k=0,h;h=f[k];k++)if(!h.hidden&&!h.header){c.push(h.invisible?'\x3ctr class\x3d"dojoxGridInvisible"\x3e':"\x3ctr\x3e");for(var m=0,l,n,r;l=h[m];m++)n=l.markup,d=l.customClasses=[],r=l.customStyles=[],n[5]=l.format(b,g),n[1]=d.join(" "),n[3]=r.join(";"),(d=l.textDir||this.grid.textDir)&&
(n[3]+=this._getTextDirStyle(d,l,b)),c.push.apply(c,n);c.push("\x3c/tr\x3e")}c.push("\x3c/table\x3e");return c.join("")},decorateEvent:function(a){a.rowNode=this.findRowTarget(a.target);if(!a.rowNode)return!1;a.rowIndex=a.rowNode[w];this.baseDecorateEvent(a);a.cell=this.grid.getCell(a.cellIndex);return!0}});var z=q._HeaderBuilder=a.extend(function(a){this.moveable=null;y.call(this,a)},y.prototype,{_skipBogusClicks:!1,overResizeWidth:4,minColWidth:1,update:function(){this.tableMap?this.tableMap.mapRows(this.view.structure.cells):
this.tableMap=new q._TableMap(this.view.structure.cells)},generateHtml:function(a,b){var c,d=this.getTableArray(),f=this.view.structure.cells;e.fire(this.view,"onBeforeRow",[-1,f]);for(var g=0,k;k=f[g];g++)if(!k.hidden){d.push(k.invisible?'\x3ctr class\x3d"dojoxGridInvisible"\x3e':"\x3ctr\x3e");for(var h=0,m,l;m=k[h];h++)m.customClasses=[],m.customStyles=[],this.view.simpleStructure&&(m.draggable&&(m.headerClasses?-1==m.headerClasses.indexOf("dojoDndItem")&&(m.headerClasses+=" dojoDndItem"):m.headerClasses=
"dojoDndItem"),m.attrs?-1==m.attrs.indexOf("dndType\x3d'gridColumn_")&&(m.attrs+=" dndType\x3d'gridColumn_"+this.grid.id+"'"):m.attrs="dndType\x3d'gridColumn_"+this.grid.id+"'"),l=this.generateCellMarkup(m,m.headerStyles,m.headerClasses,!0),l[5]=void 0!=b?b:a(m),l[3]=m.customStyles.join(";"),(c=m.textDir||this.grid.textDir)&&(l[3]+=this._getTextDirStyle(c,m,b)),l[1]=m.customClasses.join(" "),d.push(l.join(""));d.push("\x3c/tr\x3e")}d.push("\x3c/table\x3e");return d.join("")},getCellX:function(a){var b;
b=t("th");for(var c=a.target;c&&b(c);c=c.parentNode);(b=c)?(b=n.position(b),a=a.clientX-b.x):a=a.layerX;return a},decorateEvent:function(a){this.baseDecorateEvent(a);a.rowIndex=-1;a.cellX=this.getCellX(a);return!0},prepareResize:function(a,b){do{var c=a.cellIndex;a.cellNode=c?a.cellNode.parentNode.cells[c+b]:null;a.cellIndex=a.cellNode?this.getCellNodeIndex(a.cellNode):-1}while(a.cellNode&&"none"==a.cellNode.style.display);return Boolean(a.cellNode)},canResize:function(a){if(!a.cellNode||1<a.cellNode.colSpan)return!1;
a=this.grid.getCell(a.cellIndex);return!a.noresize&&a.canResize()},overLeftResizeArea:function(a){if(c.hasClass(d.body(),"dojoDndMove"))return!1;if(f("ie")){var b=a.target;if(c.hasClass(b,"dojoxGridArrowButtonNode")||c.hasClass(b,"dojoxGridArrowButtonChar")||c.hasClass(b,"dojoxGridColCaption"))return!1}return this.grid.isLeftToRight()?0<a.cellIndex&&0<a.cellX&&a.cellX<this.overResizeWidth&&this.prepareResize(a,-1):a.cellNode&&0<a.cellX&&a.cellX<this.overResizeWidth},overRightResizeArea:function(a){if(c.hasClass(d.body(),
"dojoDndMove"))return!1;if(f("ie")){var b=a.target;if(c.hasClass(b,"dojoxGridArrowButtonNode")||c.hasClass(b,"dojoxGridArrowButtonChar")||c.hasClass(b,"dojoxGridColCaption"))return!1}return this.grid.isLeftToRight()?a.cellNode&&a.cellX>=a.cellNode.offsetWidth-this.overResizeWidth:0<a.cellIndex&&a.cellX>=a.cellNode.offsetWidth-this.overResizeWidth&&this.prepareResize(a,-1)},domousemove:function(a){if(!this.moveable){var d=this.overRightResizeArea(a)?"dojoxGridColResize":this.overLeftResizeArea(a)?
"dojoxGridColResize":"";d&&!this.canResize(a)&&(d="dojoxGridColNoResize");c.toggleClass(a.sourceView.headerNode,"dojoxGridColNoResize","dojoxGridColNoResize"==d);c.toggleClass(a.sourceView.headerNode,"dojoxGridColResize","dojoxGridColResize"==d);d&&b.stop(a)}},domousedown:function(a){this.moveable||((this.overRightResizeArea(a)||this.overLeftResizeArea(a))&&this.canResize(a)?this.beginColumnResize(a):(this.grid.onMouseDown(a),this.grid.onMouseOverRow(a)))},doclick:function(a){return this._skipBogusClicks?
(b.stop(a),!0):!1},colResizeSetup:function(a,b){var e=c.contentBox(a.sourceView.headerNode);if(b){this.lineDiv=document.createElement("div");var k=c.position(a.sourceView.headerNode,!0),h=c.contentBox(a.sourceView.domNode),m=a.pageX;!this.grid.isLeftToRight()&&8>f("ie")&&(m-=g.getScrollbar().w);c.style(this.lineDiv,{top:k.y+"px",left:m+"px",height:h.h+e.h+"px"});c.addClass(this.lineDiv,"dojoxGridResizeColLine");this.lineDiv._origLeft=m;d.body().appendChild(this.lineDiv)}for(var k=[],h=this.tableMap.findOverlappingNodes(a.cellNode),
m=0,l;l=h[m];m++)k.push({node:l,index:this.getCellNodeIndex(l),width:l.offsetWidth});h=a.sourceView;l=this.grid.isLeftToRight()?1:-1;for(var n=a.grid.views.views,m=[],r=h.idx+l,q;q=n[r];r+=l)m.push({node:q.headerNode,left:window.parseInt(q.headerNode.style.left)});l=h.headerContentNode.firstChild;return{scrollLeft:a.sourceView.headerNode.scrollLeft,view:h,node:a.cellNode,index:a.cellIndex,w:c.contentBox(a.cellNode).w,vw:e.w,table:l,tw:c.contentBox(l).w,spanners:k,followers:m}},beginColumnResize:function(b){this.moverDiv=
document.createElement("div");c.style(this.moverDiv,{position:"absolute",left:0});d.body().appendChild(this.moverDiv);c.addClass(this.grid.domNode,"dojoxGridColumnResizing");var e=this.moveable=new m(this.moverDiv),f=this.colResizeSetup(b,!0);e.onMove=a.hitch(this,"doResizeColumn",f);k.connect(e,"onMoveStop",a.hitch(this,function(){this.endResizeColumn(f);f.node.releaseCapture&&f.node.releaseCapture();this.moveable.destroy();delete this.moveable;this.moveable=null;c.removeClass(this.grid.domNode,
"dojoxGridColumnResizing")}));b.cellNode.setCapture&&b.cellNode.setCapture();e.onMouseDown(b)},doResizeColumn:function(a,b,d){var e=d.l,e={deltaX:e,w:a.w+(this.grid.isLeftToRight()?e:-e),vw:a.vw+e,tw:a.tw+e};this.dragRecord={inDrag:a,mover:b,leftTop:d};e.w>=this.minColWidth&&(b?c.style(this.lineDiv,"left",this.lineDiv._origLeft+e.deltaX+"px"):this.doResizeNow(a,e))},endResizeColumn:function(a){if(this.dragRecord){var b=this.dragRecord.leftTop,b=this.grid.isLeftToRight()?b.l:-b.l,b=b+(Math.max(a.w+
b,this.minColWidth)-(a.w+b));f("webkit")&&a.spanners.length&&(b+=c._getPadBorderExtents(a.spanners[0].node).w);this.doResizeNow(a,{deltaX:b,w:a.w+b,vw:a.vw+b,tw:a.tw+b});delete this.dragRecord}c.destroy(this.lineDiv);c.destroy(this.moverDiv);c.destroy(this.moverDiv);delete this.moverDiv;this._skipBogusClicks=!0;a.view.update();this._skipBogusClicks=!1;this.grid.onResizeColumn(a.index)},doResizeNow:function(a,b){a.view.convertColPctToFixed();if(a.view.flexCells&&!a.view.testFlexCells()){var c=v(a.node);
c&&(c.style.width="")}for(var d,e,c=0;d=a.spanners[c];c++)e=d.width+b.deltaX,0<e&&(d.node.style.width=e+"px",a.view.setColWidth(d.index,e));if(this.grid.isLeftToRight()||!f("ie"))for(c=0;d=a.followers[c];c++)e=d.left+b.deltaX,d.node.style.left=e+"px";a.node.style.width=b.w+"px";a.view.setColWidth(a.index,b.w);a.view.headerNode.style.width=b.vw+"px";a.view.setColumnsWidth(b.tw);this.grid.isLeftToRight()||(a.view.headerNode.scrollLeft=a.scrollLeft+b.deltaX)}});q._TableMap=a.extend(function(a){this.mapRows(a)},
{map:null,mapRows:function(a){if(a.length){this.map=[];var b;for(b=0;a[b];b++)this.map[b]=[];for(var c=0;b=a[c];c++)for(var d=0,e=0,f,g;f=b[d];d++){for(;this.map[c][e];)e++;this.map[c][e]={c:d,r:c};g=f.rowSpan||1;f=f.colSpan||1;for(var k=0;k<g;k++)for(var h=0;h<f;h++)this.map[c+k][e+h]=this.map[c][e];e+=f}}},dumpMap:function(){for(var a=0,b;b=this.map[a];a++)for(var c=0;b[c];c++);},getMapCoords:function(a,b){for(var c=0,d;d=this.map[c];c++)for(var e=0,f;f=d[e];e++)if(f.c==b&&f.r==a)return{j:c,i:e};
return{j:-1,i:-1}},getNode:function(a,b,c){return(a=a&&a.rows[b])&&a.cells[c]},_findOverlappingNodes:function(a,b,c){var d=[];b=this.getMapCoords(b,c);c=0;for(var e;e=this.map[c];c++)c!=b.j&&(e=(e=e[b.i])?this.getNode(a,e.r,e.c):null)&&d.push(e);return d},findOverlappingNodes:function(a){return this._findOverlappingNodes(v(a),r(a.parentNode),0<=a.cellIndex?a.cellIndex:l.indexOf(a.parentNode.cells,a))}});return{_Builder:y,_HeaderBuilder:z,_ContentBuilder:h}})},"dojox/grid/_ViewManager":function(){define(["dojo/_base/declare",
"dojo/_base/sniff","dojo/dom-class"],function(h,l,a){return h("dojox.grid._ViewManager",null,{constructor:function(a){this.grid=a},defaultWidth:200,views:[],resize:function(){this.onEach("resize")},render:function(){this.onEach("render")},addView:function(a){a.idx=this.views.length;this.views.push(a)},destroyViews:function(){for(var a=0,b;b=this.views[a];a++)b.destroy();this.views=[]},getContentNodes:function(){for(var a=[],b=0,f;f=this.views[b];b++)a.push(f.contentNode);return a},forEach:function(a){for(var b=
0,f;f=this.views[b];b++)a(f,b)},onEach:function(a,b){b=b||[];for(var f=0,k;k=this.views[f];f++)a in k&&k[a].apply(k,b)},normalizeHeaderNodeHeight:function(){for(var a=[],b=0,f;f=this.views[b];b++)f.headerContentNode.firstChild&&a.push(f.headerContentNode);this.normalizeRowNodeHeights(a)},normalizeRowNodeHeights:function(d){var b=0,f=[];if(this.grid.rowHeight)b=this.grid.rowHeight;else{if(1>=d.length)return;for(var k=0,h;h=d[k];k++)a.contains(h,"dojoxGridNonNormalizedCell")||(f[k]=h.firstChild.offsetHeight,
b=Math.max(b,f[k]));b=0<=b?b:0;(l("mozilla")||8<l("ie"))&&b&&b++}for(k=0;h=d[k];k++)f[k]!=b&&(h.firstChild.style.height=b+"px")},resetHeaderNodeHeight:function(){for(var a=0,b;b=this.views[a];a++)if(b=b.headerContentNode.firstChild)b.style.height=""},renormalizeRow:function(a){for(var b=[],f=0,k,h;(k=this.views[f])&&(h=k.getRowNode(a));f++)h.firstChild.style.height="",b.push(h);this.normalizeRowNodeHeights(b)},getViewWidth:function(a){return this.views[a].getWidth()||this.defaultWidth},measureHeader:function(){this.resetHeaderNodeHeight();
this.forEach(function(a){a.headerContentNode.style.height=""});var a=0;this.forEach(function(b){a=Math.max(b.headerNode.offsetHeight,a)});return a},measureContent:function(){var a=0;this.forEach(function(b){a=Math.max(b.domNode.offsetHeight,a)});return a},findClient:function(a){a=this.grid.elasticView||-1;if(0>a)for(var b=1,f;f=this.views[b];b++)if(f.viewWidth){for(b=1;f=this.views[b];b++)if(!f.viewWidth){a=b;break}break}0>a&&(a=Math.floor(this.views.length/2));return a},arrange:function(a,b){var f,
k,h,g=this.views.length,e=this,c=0>=b?g:this.findClient(),n=function(a,b){var c=a.domNode.style,d=a.headerNode.style;e.grid.isLeftToRight()?(c.left=b+"px",d.left=b+"px"):(c.right=b+"px",4>l("ff")?d.right=b+a.getScrollbarWidth()+"px":d.right=b+"px",l("webkit")||"auto"==d.width||(d.width=parseInt(d.width,10)-a.getScrollbarWidth()+"px"));c.top="0px";d.top=0};for(f=0;(k=this.views[f])&&f<c;f++)h=this.getViewWidth(f),k.setSize(h,0),n(k,a),h=k.headerContentNode&&k.headerContentNode.firstChild?k.getColumnsWidth()+
k.getScrollbarWidth():k.domNode.offsetWidth,a+=h;f++;for(var q=b,r=g-1;(k=this.views[r])&&f<=r;r--)h=this.getViewWidth(r),k.setSize(h,0),h=k.domNode.offsetWidth,q-=h,n(k,q);c<g&&(k=this.views[c],h=Math.max(1,q-a),k.setSize(h+"px",0),n(k,a));return a},renderRow:function(a,b,f){for(var k=[],h=0,g,e;(g=this.views[h])&&(e=b[h]);h++)g=g.renderRow(a),e.appendChild(g),k.push(g);f||this.normalizeRowNodeHeights(k)},rowRemoved:function(a){this.onEach("rowRemoved",[a])},updateRow:function(a,b){for(var f=0,k;k=
this.views[f];f++)k.updateRow(a);b||this.renormalizeRow(a)},updateRowStyles:function(a){this.onEach("updateRowStyles",[a])},setScrollTop:function(a){for(var b=a,f=0,k;k=this.views[f];f++)b=k.setScrollTop(a),l("ie")&&k.headerNode&&k.scrollboxNode&&(k.headerNode.scrollLeft=k.scrollboxNode.scrollLeft);return b},getFirstScrollingView:function(){for(var a=0,b;b=this.views[a];a++)if(b.hasHScrollbar()||b.hasVScrollbar())return b;return null}})})},"dojox/grid/_RowManager":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/dom-class"],function(h,l,a){return h("dojox.grid._RowManager",null,{constructor:function(a){this.grid=a},linesToEms:2,overRow:-2,prepareStylingRow:function(a,b){return{index:a,node:b,odd:Boolean(a&1),selected:!!this.grid.selection.isSelected(a),over:this.isOver(a),customStyles:"",customClasses:"dojoxGridRow"}},styleRowNode:function(a,b){var f=this.prepareStylingRow(a,b);this.grid.onStyleRow(f);this.applyStyles(f)},applyStyles:function(a){a.node.className=a.customClasses;var b=
a.node.style.height,f=a.node,k=a.customStyles+";"+(a.node._style||"");void 0==f.style.cssText?f.setAttribute("style",k):f.style.cssText=k;a.node.style.height=b},updateStyles:function(a){this.grid.updateRowStyles(a)},setOverRow:function(a){var b=this.overRow;this.overRow=a;b!=this.overRow&&(l.isString(b)||0<=b)&&this.updateStyles(b);this.updateStyles(this.overRow)},isOver:function(d){return this.overRow==d&&!a.contains(this.grid.domNode,"dojoxGridColumnResizing")}})})},"dojox/grid/_FocusManager":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/_base/connect dojo/_base/event dojo/_base/sniff dojo/query ./util dojo/_base/html".split(" "),
function(h,l,a,d,b,f,k,m,g){return a("dojox.grid._FocusManager",null,{constructor:function(a){this.grid=a;this.cell=null;this.rowIndex=-1;this._connects=[];this._headerConnects=[];this.headerMenu=this.grid.headerMenu;this._connects.push(d.connect(this.grid.domNode,"onfocus",this,"doFocus"));this._connects.push(d.connect(this.grid.domNode,"onblur",this,"doBlur"));this._connects.push(d.connect(this.grid.domNode,"mousedown",this,"_mouseDown"));this._connects.push(d.connect(this.grid.domNode,"mouseup",
this,"_mouseUp"));this._connects.push(d.connect(this.grid.domNode,"oncontextmenu",this,"doContextMenu"));this._connects.push(d.connect(this.grid.lastFocusNode,"onfocus",this,"doLastNodeFocus"));this._connects.push(d.connect(this.grid.lastFocusNode,"onblur",this,"doLastNodeBlur"));this._connects.push(d.connect(this.grid,"_onFetchComplete",this,"_delayedCellFocus"));this._connects.push(d.connect(this.grid,"postrender",this,"_delayedHeaderFocus"))},destroy:function(){h.forEach(this._connects,d.disconnect);
h.forEach(this._headerConnects,d.disconnect);delete this.grid;delete this.cell},_colHeadNode:null,_colHeadFocusIdx:null,_contextMenuBindNode:null,tabbingOut:!1,focusClass:"dojoxGridCellFocus",focusView:null,initFocusView:function(){this.focusView=this.grid.views.getFirstScrollingView()||this.focusView||this.grid.views.views[0];this._initColumnHeaders()},isFocusCell:function(a,b){return this.cell==a&&this.rowIndex==b},isLastFocusCell:function(){return this.cell?this.rowIndex==this.grid.rowCount-1&&
this.cell.index==this.grid.layout.cellCount-1:!1},isFirstFocusCell:function(){return this.cell?0===this.rowIndex&&0===this.cell.index:!1},isNoFocusCell:function(){return 0>this.rowIndex||!this.cell},isNavHeader:function(){return!!this._colHeadNode},getHeaderIndex:function(){return this._colHeadNode?h.indexOf(this._findHeaderCells(),this._colHeadNode):-1},_focusifyCellNode:function(a){var b=this.cell&&this.cell.getNode(this.rowIndex);if(b&&(g.toggleClass(b,this.focusClass,a),a)){a=this.scrollIntoView();
try{if(f("webkit")||!this.grid.edit.isEditing())m.fire(b,"focus"),a&&(this.cell.view.scrollboxNode.scrollLeft=a)}catch(d){}}},_delayedCellFocus:function(){if(!this.isNavHeader()&&this.grid.focused){var a=this.cell&&this.cell.getNode(this.rowIndex);if(a)try{this.grid.edit.isEditing()||(g.toggleClass(a,this.focusClass,!0),this._colHeadNode&&this.blurHeader(),m.fire(a,"focus"))}catch(b){}}},_delayedHeaderFocus:function(){this.isNavHeader()&&this.focusHeader()},_initColumnHeaders:function(){h.forEach(this._headerConnects,
d.disconnect);this._headerConnects=[];for(var a=this._findHeaderCells(),b=0;b<a.length;b++)this._headerConnects.push(d.connect(a[b],"onfocus",this,"doColHeaderFocus")),this._headerConnects.push(d.connect(a[b],"onblur",this,"doColHeaderBlur"))},_findHeaderCells:function(){for(var a=k("th",this.grid.viewsHeaderNode),b=[],d=0;d<a.length;d++){var f=a[d],h=g.hasAttr(f,"tabIndex"),m=g.attr(f,"tabIndex");h&&0>m&&b.push(f)}return b},_setActiveColHeader:function(a,b,d){this.grid.domNode.setAttribute("aria-activedescendant",
a.id);null!=d&&0<=d&&d!=b&&g.toggleClass(this._findHeaderCells()[d],this.focusClass,!1);g.toggleClass(a,this.focusClass,!0);this._colHeadNode=a;this._colHeadFocusIdx=b;this._scrollHeader(this._colHeadFocusIdx)},scrollIntoView:function(){var a=this.cell?this._scrollInfo(this.cell):null;if(!a||!a.s)return null;var b=this.grid.scroller.findScrollTop(this.rowIndex);a.n&&a.sr&&(a.n.offsetLeft+a.n.offsetWidth>a.sr.l+a.sr.w?a.s.scrollLeft=a.n.offsetLeft+a.n.offsetWidth-a.sr.w:a.n.offsetLeft<a.sr.l&&(a.s.scrollLeft=
a.n.offsetLeft));a.r&&a.sr&&(b+a.r.offsetHeight>a.sr.t+a.sr.h?this.grid.setScrollTop(b+a.r.offsetHeight-a.sr.h):b<a.sr.t&&this.grid.setScrollTop(b));return a.s.scrollLeft},_scrollInfo:function(a,b){if(a){var d=a.view.scrollboxNode,f={w:d.clientWidth,l:d.scrollLeft,t:d.scrollTop,h:d.clientHeight},g=a.view.getRowNode(this.rowIndex);return{c:a,s:d,sr:f,n:b?b:a.getNode(this.rowIndex),r:g}}return null},_scrollHeader:function(a){var b=null;if(this._colHeadNode){var d=this.grid.getCell(a);if(!d)return;b=
this._scrollInfo(d,d.getNode(0))}b&&b.s&&b.sr&&b.n&&(b.n.offsetLeft+b.n.offsetWidth>b.sr.l+b.sr.w?b.s.scrollLeft=b.n.offsetLeft+b.n.offsetWidth-b.sr.w:b.n.offsetLeft<b.sr.l?b.s.scrollLeft=b.n.offsetLeft:7>=f("ie")&&d&&d.view.headerNode&&(d.view.headerNode.scrollLeft=b.s.scrollLeft))},_isHeaderHidden:function(){var a=this.focusView;if(!a)for(var b=0,d;d=this.grid.views.views[b];b++)if(d.headerNode){a=d;break}return a&&"none"==g.getComputedStyle(a.headerNode).display},colSizeAdjust:function(a,b,d){var f=
this._findHeaderCells(),g=this.focusView;if(!g||!g.header.tableMap.map)for(var k=0,h;h=this.grid.views.views[k];k++)if(h.header.tableMap.map){g=h;break}k=f[b];!g||b==f.length-1&&0===b||(g.content.baseDecorateEvent(a),a.cellNode=k,a.cellIndex=g.content.getCellNodeIndex(a.cellNode),a.cell=0<=a.cellIndex?this.grid.getCell(a.cellIndex):null,g.header.canResize(a)&&(b={l:d},a=g.header.colResizeSetup(a,!1),g.header.doResizeColumn(a,null,b),g.update()))},styleRow:function(a){},setFocusIndex:function(a,b){this.setFocusCell(this.grid.getCell(b),
a)},setFocusCell:function(a,b){a&&!this.isFocusCell(a,b)&&(this.tabbingOut=!1,this._colHeadNode&&this.blurHeader(),this._colHeadNode=this._colHeadFocusIdx=null,this.focusGridView(),this._focusifyCellNode(!1),this.cell=a,this.rowIndex=b,this._focusifyCellNode(!0));if(f("opera"))setTimeout(l.hitch(this.grid,"onCellFocus",this.cell,this.rowIndex),1);else this.grid.onCellFocus(this.cell,this.rowIndex)},next:function(){if(this.cell){var a=this.rowIndex,b=this.cell.index+1,d=this.grid.layout.cellCount-
1,f=this.grid.rowCount-1;b>d&&(b=0,a++);a>f&&(b=d,a=f);if(this.grid.edit.isEditing()&&(d=this.grid.getCell(b),!this.isLastFocusCell()&&(!d.editable||this.grid.canEdit&&!this.grid.canEdit(d,a)))){this.cell=d;this.rowIndex=a;this.next();return}this.setFocusIndex(a,b)}},previous:function(){if(this.cell){var a=this.rowIndex||0,b=(this.cell.index||0)-1;0>b&&(b=this.grid.layout.cellCount-1,a--);0>a&&(b=a=0);if(this.grid.edit.isEditing()){var d=this.grid.getCell(b);if(!this.isFirstFocusCell()&&!d.editable){this.cell=
d;this.rowIndex=a;this.previous();return}}this.setFocusIndex(a,b)}},move:function(a,b){var d=0>b?-1:1;if(this.isNavHeader()){var f=this._findHeaderCells(),k=currentIdx=h.indexOf(f,this._colHeadNode);for(currentIdx+=b;0<=currentIdx&&currentIdx<f.length&&"none"==f[currentIdx].style.display;)currentIdx+=d;0<=currentIdx&&currentIdx<f.length&&this._setActiveColHeader(f[currentIdx],currentIdx,k)}else if(this.cell){var m=this.grid.scroller,f=this.rowIndex,k=this.grid.rowCount-1,l=Math.min(k,Math.max(0,f+
a));a&&(0<a?l>m.getLastPageRow(m.page)&&this.grid.setScrollTop(this.grid.scrollTop+m.findScrollTop(l)-m.findScrollTop(f)):0>a&&l<=m.getPageRow(m.page)&&this.grid.setScrollTop(this.grid.scrollTop-m.findScrollTop(f)-m.findScrollTop(l)));for(var m=this.grid.layout.cellCount-1,t=this.cell.index,w=Math.min(m,Math.max(0,t+b)),x=this.grid.getCell(w);0<=w&&w<m&&x&&!0===x.hidden;)w+=d,x=this.grid.getCell(w);x&&!0!==x.hidden||(w=t);d=x.getNode(l);!d&&a?0<=l+a&&l+a<=k&&this.move(0<a?++a:--a,b):d&&"none"!==g.style(d,
"display")||!b?(this.setFocusIndex(l,w),a&&this.grid.updateRow(f)):0<=w+b&&w+b<=m&&this.move(a,0<b?++b:--b)}},previousKey:function(a){this.grid.edit.isEditing()?(b.stop(a),this.previous()):this.isNavHeader()||this._isHeaderHidden()?(this.tabOut(this.grid.domNode),null!=this._colHeadFocusIdx&&(g.toggleClass(this._findHeaderCells()[this._colHeadFocusIdx],this.focusClass,!1),this._colHeadFocusIdx=null),this._focusifyCellNode(!1)):(this.grid.domNode.focus(),b.stop(a))},nextKey:function(a){a.target===
this.grid.domNode&&null==this._colHeadFocusIdx?(this.focusHeader(),b.stop(a)):this.isNavHeader()?(this.blurHeader(),this.findAndFocusGridCell()||this.tabOut(this.grid.lastFocusNode),this._colHeadNode=this._colHeadFocusIdx=null):this.grid.edit.isEditing()?(b.stop(a),this.next()):this.tabOut(this.grid.lastFocusNode)},tabOut:function(a){this.tabbingOut=!0;a.focus()},focusGridView:function(){m.fire(this.focusView,"focus")},focusGrid:function(a){this.focusGridView();this._focusifyCellNode(!0)},findAndFocusGridCell:function(){var a=
!0,b=0===this.grid.rowCount;this.isNoFocusCell()&&!b?(b=0,this.grid.getCell(b).hidden&&(b=this.isNavHeader()?this._colHeadFocusIdx:0),this.setFocusIndex(0,b)):this.cell&&!b?(this.focusView&&!this.focusView.rowNodes[this.rowIndex]&&this.grid.scrollToRow(this.rowIndex),this.focusGrid()):a=!1;this._colHeadNode=this._colHeadFocusIdx=null;return a},focusHeader:function(){var a=this._findHeaderCells(),b=this._colHeadFocusIdx;this._isHeaderHidden()?this.findAndFocusGridCell():this._colHeadFocusIdx||(this.isNoFocusCell()?
this._colHeadFocusIdx=0:this._colHeadFocusIdx=this.cell.index);for(this._colHeadNode=a[this._colHeadFocusIdx];this._colHeadNode&&0<=this._colHeadFocusIdx&&this._colHeadFocusIdx<a.length&&"none"==this._colHeadNode.style.display;)this._colHeadFocusIdx++,this._colHeadNode=a[this._colHeadFocusIdx];this._colHeadNode&&"none"!=this._colHeadNode.style.display?(this.headerMenu&&this._contextMenuBindNode!=this.grid.domNode&&(this.headerMenu.unBindDomNode(this.grid.viewsHeaderNode),this.headerMenu.bindDomNode(this.grid.domNode),
this._contextMenuBindNode=this.grid.domNode),this._setActiveColHeader(this._colHeadNode,this._colHeadFocusIdx,b),this._scrollHeader(this._colHeadFocusIdx),this._focusifyCellNode(!1)):this.findAndFocusGridCell()},blurHeader:function(){g.removeClass(this._colHeadNode,this.focusClass);g.removeAttr(this.grid.domNode,"aria-activedescendant");if(this.headerMenu&&this._contextMenuBindNode==this.grid.domNode){var a=this.grid.viewsHeaderNode;this.headerMenu.unBindDomNode(this.grid.domNode);this.headerMenu.bindDomNode(a);
this._contextMenuBindNode=a}},doFocus:function(a){a&&a.target!=a.currentTarget?b.stop(a):this._clickFocus||(this.tabbingOut||this.focusHeader(),this.tabbingOut=!1,b.stop(a))},doBlur:function(a){b.stop(a)},doContextMenu:function(a){this.headerMenu||b.stop(a)},doLastNodeFocus:function(a){this.tabbingOut?this._focusifyCellNode(!1):0<this.grid.rowCount?(this.isNoFocusCell()&&this.setFocusIndex(0,0),this._focusifyCellNode(!0)):this.focusHeader();this.tabbingOut=!1;b.stop(a)},doLastNodeBlur:function(a){b.stop(a)},
doColHeaderFocus:function(a){this._setActiveColHeader(a.target,g.attr(a.target,"idx"),this._colHeadFocusIdx);this._scrollHeader(this.getHeaderIndex());b.stop(a)},doColHeaderBlur:function(a){g.toggleClass(a.target,this.focusClass,!1)},_mouseDown:function(a){this._clickFocus=dojo.some(this.grid.views.views,function(b){return b.scrollboxNode===a.target})},_mouseUp:function(a){this._clickFocus=!1}})})},"dojox/grid/_EditManager":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/connect dojo/_base/sniff ./util".split(" "),
function(h,l,a,d,b,f){return a("dojox.grid._EditManager",null,{constructor:function(a){this.grid=a;this.connections=b("ie")?[d.connect(document.body,"onfocus",h.hitch(this,"_boomerangFocus"))]:[];this.connections.push(d.connect(this.grid,"onBlur",this,"apply"));this.connections.push(d.connect(this.grid,"prerender",this,"_onPreRender"))},info:{},destroy:function(){l.forEach(this.connections,d.disconnect)},cellFocus:function(a,b){this.grid.singleClickEdit||this.isEditRow(b)?this.setEditCell(a,b):this.apply();
(this.isEditing()||a&&a.editable&&a.alwaysEditing)&&this._focusEditor(a,b)},rowClick:function(a){this.isEditing()&&!this.isEditRow(a.rowIndex)&&this.apply()},styleRow:function(a){a.index==this.info.rowIndex&&(a.customClasses+=" dojoxGridRowEditing")},dispatchEvent:function(a){var b=a.cell;return(b=b&&b.editable?b:0)&&b.dispatchEvent(a.dispatch,a)},isEditing:function(){return void 0!==this.info.rowIndex},isEditCell:function(a,b){return this.info.rowIndex===a&&this.info.cell.index==b},isEditRow:function(a){return this.info.rowIndex===
a},setEditCell:function(a,b){!this.isEditCell(b,a.index)&&this.grid.canEdit&&this.grid.canEdit(a,b)&&this.start(a,b,this.isEditRow(b)||a.editable)},_focusEditor:function(a,b){f.fire(a,"focus",[b])},focusEditor:function(){this.isEditing()&&this._focusEditor(this.info.cell,this.info.rowIndex)},_boomerangWindow:500,_shouldCatchBoomerang:function(){return this._catchBoomerang>(new Date).getTime()},_boomerangFocus:function(){this._shouldCatchBoomerang()&&(this.grid.focus.focusGrid(),this.focusEditor(),
this._catchBoomerang=0)},_doCatchBoomerang:function(){b("ie")&&(this._catchBoomerang=(new Date).getTime()+this._boomerangWindow)},start:function(a,b,d){this._isValidInput()&&(this.grid.beginUpdate(),this.editorApply(),this.isEditing()&&!this.isEditRow(b)&&(this.applyRowEdit(),this.grid.updateRow(b)),d?(this.info={cell:a,rowIndex:b},this.grid.doStartEdit(a,b),this.grid.updateRow(b)):this.info={},this.grid.endUpdate(),this.grid.focus.focusGrid(),this._focusEditor(a,b),this._doCatchBoomerang())},_editorDo:function(a){var b=
this.info.cell;if(b&&b.editable)b[a](this.info.rowIndex)},editorApply:function(){this._editorDo("apply")},editorCancel:function(){this._editorDo("cancel")},applyCellEdit:function(a,b,d){this.grid.canEdit(b,d)&&this.grid.doApplyCellEdit(a,d,b.field)},applyRowEdit:function(){this.grid.doApplyEdit(this.info.rowIndex,this.info.cell.field)},apply:function(){this.isEditing()&&this._isValidInput()&&(this.grid.beginUpdate(),this.editorApply(),this.applyRowEdit(),this.info={},this.grid.endUpdate(),this.grid.focus.focusGrid(),
this._doCatchBoomerang())},cancel:function(){this.isEditing()&&(this.grid.beginUpdate(),this.editorCancel(),this.info={},this.grid.endUpdate(),this.grid.focus.focusGrid(),this._doCatchBoomerang())},save:function(a,b){var d=this.info.cell;!this.isEditRow(a)||b&&d.view!=b||!d.editable||d.save(d,this.info.rowIndex)},restore:function(a,b){var d=this.info.cell;this.isEditRow(b)&&d.view==a&&d.editable&&d.restore(this.info.rowIndex)},_isValidInput:function(){var a=(this.info.cell||{}).widget;if(!a||!a.isValid)return!0;
a.focused=!0;return a.isValid(!0)},_onPreRender:function(){this.isEditing()&&(this.info.value=this.info.cell.getValue())}})})},"dojox/grid/Selection":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-attr"],function(h,l,a,d){return h("dojox.grid.Selection",null,{constructor:function(a){this.grid=a;this.selected=[];this.setMode(a.selectionMode)},mode:"extended",selected:null,updating:0,selectedIndex:-1,rangeStartIndex:-1,setMode:function(a){this.selected.length&&
this.deselectAll();this.mode="extended"!=a&&"multiple"!=a&&"single"!=a&&"none"!=a?"extended":a},onCanSelect:function(a){return this.grid.onCanSelect(a)},onCanDeselect:function(a){return this.grid.onCanDeselect(a)},onSelected:function(a){},onDeselected:function(a){},onChanging:function(){},onChanged:function(){},isSelected:function(a){return"none"==this.mode?!1:this.selected[a]},getFirstSelected:function(){if(!this.selected.length||"none"==this.mode)return-1;for(var a=0,d=this.selected.length;a<d;a++)if(this.selected[a])return a;
return-1},getNextSelected:function(a){if("none"==this.mode)return-1;a+=1;for(var d=this.selected.length;a<d;a++)if(this.selected[a])return a;return-1},getSelected:function(){for(var a=[],d=0,k=this.selected.length;d<k;d++)this.selected[d]&&a.push(d);return a},getSelectedCount:function(){for(var a=0,d=0;d<this.selected.length;d++)this.selected[d]&&a++;return a},_beginUpdate:function(){if(0===this.updating)this.onChanging();this.updating++},_endUpdate:function(){this.updating--;if(0===this.updating)this.onChanged()},
select:function(a){"none"!=this.mode&&("multiple"!=this.mode?(this.deselectAll(a),this.addToSelection(a)):this.toggleSelect(a))},addToSelection:function(b){if("none"!=this.mode)if(a.isArray(b))l.forEach(b,this.addToSelection,this);else if(b=Number(b),this.selected[b])this.selectedIndex=b;else if(!1!==this.onCanSelect(b)){this.selectedIndex=b;var f=this.grid.getRowNode(b);f&&d.set(f,"aria-selected","true");this._beginUpdate();this.selected[b]=!0;this.onSelected(b);this._endUpdate()}},deselect:function(b){if("none"!=
this.mode)if(a.isArray(b))l.forEach(b,this.deselect,this);else if(b=Number(b),this.selectedIndex==b&&(this.selectedIndex=-1),this.selected[b]&&!1!==this.onCanDeselect(b)){var f=this.grid.getRowNode(b);f&&d.set(f,"aria-selected","false");this._beginUpdate();delete this.selected[b];this.onDeselected(b);this._endUpdate()}},setSelected:function(a,d){this[d?"addToSelection":"deselect"](a)},toggleSelect:function(b){a.isArray(b)?l.forEach(b,this.toggleSelect,this):this.setSelected(b,!this.selected[b])},
_range:function(a,d,k){var h=0<=a?a:d;a=d;h>a&&(a=h,h=d);for(d=h;d<=a;d++)k(d)},selectRange:function(b,d){this._range(b,d,a.hitch(this,"addToSelection"))},deselectRange:function(b,d){this._range(b,d,a.hitch(this,"deselect"))},insert:function(a){this.selected.splice(a,0,!1);this.selectedIndex>=a&&this.selectedIndex++},remove:function(a){this.selected.splice(a,1);this.selectedIndex>=a&&this.selectedIndex--},deselectAll:function(a){for(var d in this.selected)d!=a&&!0===this.selected[d]&&this.deselect(d)},
clickSelect:function(a,d,k){if("none"!=this.mode){this._beginUpdate();if("extended"!=this.mode)this.select(a);else{if(!k||0>this.rangeStartIndex)this.rangeStartIndex=a;d||this.deselectAll(a);k?this.selectRange(this.rangeStartIndex,a):d?this.toggleSelect(a):this.addToSelection(a)}this._endUpdate()}},clickSelectEvent:function(a){this.clickSelect(a.rowIndex,dojo.isCopyKey(a),a.shiftKey)},clear:function(){this._beginUpdate();this.deselectAll();this._endUpdate()}})})},"dijit/CheckedMenuItem":function(){define(["dojo/_base/declare",
"dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(h,l,a,d){return h("dijit.CheckedMenuItem",a,{baseClass:"dijitMenuItem dijitCheckedMenuItem",templateString:d,checked:!1,_setCheckedAttr:function(a){this.domNode.setAttribute("aria-checked",a?"true":"false");this._set("checked",a)},iconClass:"",role:"menuitemcheckbox",checkedChar:"\x26#10003;",onChange:function(){},_onClick:function(a){this.disabled||(this.set("checked",!this.checked),this.onChange(this.checked));
this.onClick(a)}})})},"dojox/grid/DataSelection":function(){define(["dojo/_base/declare","./_SelectionPreserver","./Selection"],function(h,l,a){return h("dojox.grid.DataSelection",a,{constructor:function(a){a.keepSelection&&(this.preserver=new l(this))},destroy:function(){this.preserver&&this.preserver.destroy()},getFirstSelected:function(){var d=a.prototype.getFirstSelected.call(this);return-1==d?null:this.grid.getItem(d)},getNextSelected:function(d){d=this.grid.getItemIndex(d);d=a.prototype.getNextSelected.call(this,
d);return-1==d?null:this.grid.getItem(d)},getSelected:function(){for(var a=[],b=0,f=this.selected.length;b<f;b++)this.selected[b]&&a.push(this.grid.getItem(b));return a},addToSelection:function(d){if("none"!=this.mode){var b=null,b="number"==typeof d||"string"==typeof d?d:this.grid.getItemIndex(d);a.prototype.addToSelection.call(this,b)}},deselect:function(d){if("none"!=this.mode){var b=null,b="number"==typeof d||"string"==typeof d?d:this.grid.getItemIndex(d);a.prototype.deselect.call(this,b)}},deselectAll:function(d){var b=
null;d||"number"==typeof d?(b="number"==typeof d||"string"==typeof d?d:this.grid.getItemIndex(d),a.prototype.deselectAll.call(this,b)):this.inherited(arguments)}})})},"dojox/grid/_SelectionPreserver":function(){define(["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array"],function(h,l,a,d){return h("dojox.grid._SelectionPreserver",null,{constructor:function(b){this.selection=b;var d=this.grid=b.grid;this.reset();this._connects=[l.connect(d,"_setStore",this,"reset"),l.connect(d,
"_addItem",this,"_reSelectById"),l.connect(b,"onSelected",a.hitch(this,"_selectById",!0)),l.connect(b,"onDeselected",a.hitch(this,"_selectById",!1)),l.connect(b,"deselectAll",this,"reset")]},destroy:function(){this.reset();d.forEach(this._connects,l.disconnect);delete this._connects},reset:function(){this._selectedById={}},_reSelectById:function(a,d){a&&this.grid._hasIdentity&&(this.selection.selected[d]=this._selectedById[this.grid.store.getIdentity(a)])},_selectById:function(a,d){if("none"!=this.selection.mode&&
this.grid._hasIdentity){var k=d,h=this.grid;if("number"==typeof d||"string"==typeof d)k=(k=h._by_idx[d])&&k.item;k&&(this._selectedById[h.store.getIdentity(k)]=!!a);return k}}})})},"esri/dijit/editing/TemplatePickerItem":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/sniff dojo/dom-style dijit/_Widget dijit/_Templated dojox/gfx ../../symbols/jsonUtils ../../kernel".split(" "),function(h,l,a,d,b,f,k,m,g,e,c){h=h([k,m],{declaredClass:"esri.dijit.editing.TemplatePickerItem",
templateString:"\x3cdiv class\x3d'item' style\x3d'text-align: center;'\x3e\x3cdiv class\x3d'itemSymbol' dojoAttachPoint\x3d'_surfaceNode'\x3e\x3c/div\x3e\x3cdiv class\x3d'itemLabel'\x3e${label}\x3c/div\x3e\x3c/div\x3e",startup:function(){this._started||(this.inherited(arguments),this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template))},_draw:function(a,b,c,k,h){if(b&&"textsymbol"!==b.type){a=g.createSurface(a,c,k);if(9>d("ie")){var m=a.getEventSource();
f.set(m,"position","relative");f.set(m.parentNode,"position","relative")}var w;b=!this.legendOverride&&this._getDrawingToolShape(b,h)||e.getShapeDescriptors(b);try{w=a.createShape(b.defaultShape).setFill(b.fill).setStroke(b.stroke)}catch(x){return a.clear(),void a.destroy()}var y=w.getBoundingBox();b=y.width;h=y.height;var m=-(y.x+b/2),y=-(y.y+h/2),z=a.getDimensions(),m={dx:m+z.width/2,dy:y+z.height/2};if(b>c||h>k)y=b/c>h/k,c=((y?c:k)-5)/(y?b:h),l.mixin(m,{xx:c,yy:c});return w.applyTransform(m),a}},
_getDrawingToolShape:function(a,b){var c;switch(b?b.drawingTool||null:null){case "esriFeatureEditToolArrow":c={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolLeftArrow":c={type:"path",path:"M -15,1 L -8,8 L -8,5 L 10,5 L 10,-2 L -8,-2 L -8,-5 L -15,1 E"};break;case "esriFeatureEditToolRightArrow":c={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolUpArrow":c={type:"path",path:"M 1,-10 L 8,-3 L 5,-3 L 5,15 L -2,15 L -2,-3 L -5,-3 L 1,-10 E"};
break;case "esriFeatureEditToolDownArrow":c={type:"path",path:"M 1,15 L 8,8 L 5,8 L 5,-10 L -2,-10 L -2,8 L -5,8 L 1,15 E"};break;case "esriFeatureEditToolTriangle":c={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":c={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":c={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":c={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;case "esriFeatureEditToolFreehand":c=
"simplelinesymbol"===a.type||"cartographiclinesymbol"===a.type?{type:"path",path:"m -11, -7c-1.5,-3.75 7.25,-9.25 12.5,-7c5.25,2.25 6.75,9.75 3.75,12.75c-3,3 -3.25,2.5 -9.75,5.25c-6.5,2.75 -7.25,14.25 2,15.25c9.25,1 11.75,-4 13.25,-6.75c1.5,-2.75 3.5,-11.75 12,-6.5"}:{type:"path",path:"M 10,-13 c3.1,0.16667 4.42564,2.09743 2.76923,3.69231c-2.61025,2.87179 -5.61025,5.6718 -6.14358,6.20513c-0.66667,0.93333 -0.46667,1.2 -0.53333,1.93333c-0.00001,0.86666 0.6,1.66667 1.13334,2c1.03077,0.38462 2.8,0.93333 3.38974,1.70769c0.47693,0.42564 0.87693,0.75897 1.41026,1.75897c0.13333,1.06667 -0.46667,2.86667 -1.8,3.8c-0.73333,0.73333 -3.86667,2.66666 -4.86667,3.13333c-0.93333,0.8 -7.4,3.2 -7.6,3.06667c-1.06667,0.46667 -4.73333,1.13334 -5.2,1.26667c-1.6,0.33334 -4.6,0.4 -6.25128,0.05128c-1.41539,-0.18462 -2.34872,-2.31796 -1.41539,-4.45129c0.93333,-1.73333 1.86667,-3.13333 2.64615,-3.85641c1.28718,-1.47692 2.57437,-2.68204 3.88718,-3.54359c0.88718,-1.13845 1.8,-1.33333 2.26666,-2.45641c0.33334,-0.74359 0.37949,-1.7641 0.06667,-2.87692c-0.66666,-1.46666 -1.66666,-1.86666 -2.98975,-2.2c-1.27692,-0.26666 -2.12307,-0.64102 -3.27692,-1.46666c-0.66667,-1.00001 -1.01538,-3.01539 0.73333,-4.06667c1.73333,-1.2 3.6,-1.93333 4.93333,-2.2c1.33333,-0.46667 4.84104,-1.09743 5.84103,-1.23076c1.60001,-0.46667 6.02564,-0.50257 7.29231,-0.56924z"};
break;default:return null}return{defaultShape:c,fill:a.getFill(),stroke:a.getStroke()}},_repaint:function(b){return b?(b.getStroke&&b.setStroke&&b.setStroke(b.getStroke()),b.getFill&&b.setFill&&b.setFill(b.getFill()),void(b.children&&l.isArray(b.children)&&a.forEach(b.children,this._repaint,this))):void(this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template))},destroy:function(){this._surface&&(this._surface.destroy(),delete this._surface);this.inherited(arguments)}});
return d("extend-esri")&&l.setObject("dijit.editing.TemplatePickerItem",h,c),h})},"cmv/viewer/js/gis/dijit/Growler":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/dom-style dojo/dom-construct dojo/_base/fx dojo/dom-class dojo/topic xstyle/css!./Growler/css/Growler.css".split(" "),function(h,l,a,d,b,f,k,m,g){var e=h([l,a],{templateString:'\x3cdiv class\x3d"growl ${level}" data-dojo-attach-event\x3d"onmouseover:hoverOver,onmouseout:hoverOut,onclick:close"\x3e\x3ch3\x3e${title}\x3c/h3\x3e\x3cspan data-dojo-attach-point\x3d"growlMessageNode"\x3e\x3c/span\x3e\x3c/div\x3e',
title:"Title",message:"Message",level:"default",timeout:1E4,opacity:1,_container:null,_timer:null,postCreate:function(){this.inherited(arguments);this._container?(b.set(this.domNode,"opacity",0),f.place(this.domNode,this._container),this.growlMessageNode.innerHTML=this.message,k.anim(this.domNode,{opacity:this.opacity},250),this.setTimeout()):g.publish("viewer/handleError",{source:"Growler",error:"Growl container not found/specified."})},setTimeout:function(){0<this.timeout&&(this._timer=setTimeout(d.hitch(this,
"close"),this.timeout))},hoverOver:function(){clearInterval(this._timer);m.add(this.domNode,"hover")},hoverOut:function(){0<this.timeout&&this.setTimeout();m.remove(this.domNode,"hover")},close:function(){k.anim(this.domNode,{opacity:0},500,null,d.hitch(this,"remove"))},remove:function(){k.anim(this.domNode,{height:0,margin:0},250,null,d.partial(f.destroy,this.domNode))}});return h([l,a],{templateString:'\x3cdiv class\x3d"gis-dijit-Growl" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',
postCreate:function(){this.inherited(arguments);this.own(g.subscribe("growler/growl",d.hitch(this,"growl")))},growl:function(a){a=a||{};d.mixin(a,{_container:this.containerNode});(new e(a)).startup()}})})},"cmv/viewer/js/gis/dijit/Basemaps":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/array dojo/topic dijit/DropDownMenu dijit/MenuItem esri/basemaps esri/dijit/BasemapGallery dojo/text!./Basemaps/templates/Basemaps.html dojo/i18n!./Basemaps/nls/resource dijit/form/DropDownButton xstyle/css!./Basemaps/css/Basemaps.css".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q){return h([l,a,d],{templateString:n,widgetsInTemplate:!0,i18n:q,title:q.title,basemaps:{},currentBasemap:null,mapStartBasemap:null,basemapsToShow:null,galleryOptions:{basemapIds:null,basemaps:null,basemapsGroup:null,bingMapsKey:null,portalUrl:null,referenceIds:null,showArcGISBasemaps:!1},postCreate:function(){this.inherited(arguments);this.initializeBasemaps();this.createBasemapGallery();k.subscribe("basemaps/updateBasemap",b.hitch(this,"updateBasemap"))},initializeBasemaps:function(){if(this.galleryOptions.basemaps)this.basemapsToShow=
this.basemapsToShow||f.map(this.galleryOptions.basemaps,function(a){return a.id});else{if(!this.basemaps||1>Object.keys(this.basemaps).length)this.basemaps=b.clone(e),this.galleryOptions.showArcGISBasemaps=!1;this.basemapsToShow=this.basemapsToShow||Object.keys(this.basemaps);var a=[];f.forEach(this.basemapsToShow,b.hitch(this,function(b){var c=this.basemaps[b];if(c.basemap&&"esri.dijit.Basemap"===c.basemap.declaredClass){var d=c.basemap;d.title=c.title||d.title;d.id=b;a.push(d)}else e[b]||(c.basemap.title=
c.title||c.basemap.title,e[b]=c.basemap),c.title=c.title||e[b].title,this.galleryOptions.showArcGISBasemaps=!1}));this.galleryOptions.basemaps=a}this.mapStartBasemap=this.mapStartBasemap||this.map.getBasemap();0>f.indexOf(this.basemapsToShow,this.mapStartBasemap)&&(this.mapStartBasemap=this.basemapsToShow[0])},createBasemapGallery:function(){var a=b.mixin({map:this.map},this.galleryOptions);this.gallery=new c(a);this.gallery.startup();if(this.galleryOptions.showArcGISBasemaps)this.gallery.on("load",
b.hitch(this,"buildMenu"));else this.buildMenu()},buildMenu:function(){this.menu=new m({style:"display: none;"});f.forEach(this.basemapsToShow,function(a){this.basemaps.hasOwnProperty(a)&&(a=new g({id:a,label:this.basemaps[a].title,iconClass:a===this.mapStartBasemap?"selectedIcon":"emptyIcon",onClick:b.hitch(this,"updateBasemap",a)}),this.menu.addChild(a))},this);this.dropDownButton.set("dropDown",this.menu);this.setStartingBasemap()},setStartingBasemap:function(){this.mapStartBasemap&&(this.gallery.get(this.mapStartBasemap)||
e[this.mapStartBasemap])&&this.updateBasemap(this.mapStartBasemap)},updateBasemap:function(a){if(a!==this.currentBasemap&&-1!==f.indexOf(this.basemapsToShow,a)){if(this.gallery.get(a))this.gallery.select(a);else if(e[a])this.gallery._removeBasemapLayers(),this.gallery._removeReferenceLayer(),this.map.setBasemap(a);else{k.publish("viewer/error","Invalid basemap selected.");return}this.currentBasemap=a;var b=this.menu.getChildren();f.forEach(b,function(b){b.id===a?b.set("iconClass","selectedIcon"):
b.set("iconClass","emptyIcon")})}}})})},"esri/dijit/BasemapGallery":function(){define("require dojo/_base/declare dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/_base/kernel dojo/_base/sniff dojo/has dojo/query dojo/Deferred dojo/DeferredList dojo/dom dojo/dom-construct dojo/dom-class dijit/_Widget dijit/_Templated ../kernel ../lang ../urlUtils ../request ../geometry/Extent ../SpatialReference ../virtualearth/VETiledLayer ../layers/OpenStreetMapLayer ../layers/ArcGISTiledMapServiceLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/WebTiledLayer ../layers/VectorTileLayer ../layers/TileInfo ../layers/ArcGISImageServiceLayer ../layers/ImageServiceParameters ../layers/ImageParameters ./Basemap ./_EventedWidget dojo/text!./templates/BasemapGallery.html".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K,J,I,L,M,N){l=l([M,u,v],{declaredClass:"esri.dijit.BasemapGallery",widgetsInTemplate:!0,templateString:N,loaded:!1,basemaps:[],bingMapsKey:null,flowContainer:null,_hasUI:!1,_supportsVTL:null,_selectedBasemap:null,_selectBasemapInProgress:!1,_eventMap:{load:!0,"selection-change":!0,add:["basemap"],remove:["basemap"],error:["message"]},constructor:function(a,b){a=a||{};a.map||console.error("esri.dijit.BasemapGallery: Unable to find the 'map' property in parameters");
this.map=a.map;this._hasUI=b?!0:!1;this.bingMapsKey=a.bingMapsKey&&0<a.bingMapsKey.length?a.bingMapsKey:null;this.showArcGISBasemaps=!1!==a.showArcGISBasemaps;this.basemaps=a.basemaps||[];this.basemapIds=a.basemapIds;this.referenceIds=a.referenceIds;this.basemapsGroup=a.basemapsGroup;this.arcgisUrl=t.dijit._arcgisUrl;a.portalUrl&&(this.arcgisUrl=a.portalUrl+"/sharing/rest");0>this.arcgisUrl.indexOf("://")?this.arcgisUrl=x.getProtocolForWebResource()+"//"+this.arcgisUrl:"https:"===window.location.protocol&&
(this.arcgisUrl=this.arcgisUrl.replace("http:","https:"));this.init()},init:function(){this.inherited(arguments);a.forEach(this.basemaps,function(b){b.id&&0!==b.id.length||(b.id=this._getUniqueId());a.forEach(b.layers,function(a){a.opacity=0<=a.opacity?a.opacity:1;a.visibility=!0},this)},this);this.basemapIds&&0<this.basemapIds.length&&a.forEach(this.basemapIds,function(a){this.map.getLayer(a)._basemapGalleryLayerType="basemap"},this);this.referenceIds&&0<this.referenceIds.length&&a.forEach(this.referenceIds,
function(a){a=this.map.getLayer(a);a._basemapGalleryLayerType="reference";a.attr("data-reference",!0)},this);this.basemapsGroup&&(this.basemapsGroup.owner&&this.basemapsGroup.title||this.basemapsGroup.id)?this._findCustomBasemapsGroup(b.hitch(this,"_handleArcGISBasemapsResponse")):this.showArcGISBasemaps?this._findArcGISBasemapsGroup(b.hitch(this,"_handleArcGISBasemapsResponse")):this._finishStartup();this._checkVTLSupport().then(b.hitch(this,function(a){this._supportsVTL=a}))},startup:function(){this.loaded?
this._refreshUI():d.connect(this,"onLoad",b.hitch(this,function(){this._refreshUI()}))},select:function(a){this._select(a)},getSelected:function(){return this._selectedBasemap},get:function(a){var b;for(b=0;b<this.basemaps.length;b++)if(this.basemaps[b].id===a)return this.basemaps[b];return null},add:function(a){return a&&!a.id?(a.id=this._getUniqueId(),this.basemaps.push(a),this._refreshUI(),this.onAdd(a),!0):a&&this._isUniqueId(a.id)?(this.basemaps.push(a),this._refreshUI(),this.onAdd(a),!0):!1},
remove:function(a){var b;for(b=0;b<this.basemaps.length;b++){var c=this.basemaps[b];if(c.id===a)return this._selectedBasemap&&this._selectedBasemap.id===c.id&&(this._selectedBasemap=null),this.basemaps.splice(b,1),this._refreshUI(),this.onRemove(c),c}return null},onLoad:function(){},onSelectionChange:function(){},onAdd:function(a){},onRemove:function(a){},onError:function(a){},_defaultBasemapGalleryGroupQuery:'title:"ArcGIS Online Basemaps" AND owner:esri',_basemapGalleryGroupQuery:null,_finishStartup:function(){this.loaded=
!0;this.onLoad();0===this.map.layerIds.length&&0<this.basemaps.length&&!this._selectBasemapInProgress&&this._select(this.basemaps[0].id)},_findCustomBasemapsGroup:function(a){this.basemapsGroup&&this.basemapsGroup.id?this._findArcGISBasemaps(this.basemapsGroup.id,a):(this._basemapGalleryGroupQuery='title:"'+this.basemapsGroup.title+'" AND owner:'+this.basemapsGroup.owner,this._findArcGISBasemapsGroup(a))},_findArcGISBasemapsGroup:function(a){if(this._basemapGalleryGroupQuery)this._findArcGISBasemapsGroupContent(a);
else{var c=this.arcgisUrl+"/portals/self",d={f:"json"};d.culture=f.locale;y({url:c,content:d,callbackParamName:"callback",load:b.hitch(this,function(b,c){b&&b.basemapGalleryGroupQuery?this._basemapGalleryGroupQuery=b.basemapGalleryGroupQuery:this._basemapGalleryGroupQuery=this._defaultBasemapGalleryGroupQuery;this._findArcGISBasemapsGroupContent(a)}),error:b.hitch(this,function(a,b){this._basemapGalleryGroupQuery=this._defaultBasemapGalleryGroupQuery})})}},_findArcGISBasemapsGroupContent:function(a){var c=
b.hitch(this,"_findArcGISBasemaps"),d=this.arcgisUrl+"/community/groups",e={};e.q=this._basemapGalleryGroupQuery;e.f="json";y({url:d,content:e,callbackParamName:"callback",load:b.hitch(this,function(b,d){if(0<b.results.length)c(b.results[0].id,a);else this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")}),error:b.hitch(this,function(a){this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")})})},_findArcGISBasemaps:function(a,c){var d=this.arcgisUrl+
"/search",e={};e.q="group:"+a+' AND type:"web map"';e.sortField="name";e.sortOrder="desc";e.num=50;e.f="json";y({url:d,content:e,callbackParamName:"callback",load:b.hitch(this,function(a,b){if(0<a.results.length)c(a.results);else this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")}),error:b.hitch(this,function(a,b){this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")})})},_handleArcGISBasemapsResponse:function(b){0<b.length&&(a.forEach(b,function(a,
b){if(this.bingMapsKey||!this.bingMapsKey&&a.title&&-1===a.title.indexOf("Bing Maps")){var c={};if(c.id=this._getUniqueId(),c.title=a.title,c.thumbnailUrl="",a.thumbnail&&a.thumbnail.length&&(c.thumbnailUrl=this.arcgisUrl+"/content/items/"+a.id+"/info/"+a.thumbnail,t.id)){var d=t.id.findCredential(x.urlToObject(this.arcgisUrl).path);d&&(c.thumbnailUrl+="?token\x3d"+d.token)}c.itemId=a.id;c=new L(c,this);this.basemaps.splice(0,0,c)}},this),this._finishStartup())},_refreshUI:function(){this._hasUI&&
(q.empty(this.flowContainer),a.forEach(this.basemaps,function(a,b){a.id||(a.id="basemap_"+b);this.flowContainer.appendChild(this._buildNodeLayout(a))},this),q.create("br",{style:{clear:"both"}},this.flowContainer),this._markSelected(this._selectedBasemap))},_buildNodeLayout:function(a){var c=q.create("div",{id:"galleryNode_"+a.id,"class":"esriBasemapGalleryNode"}),e=q.create("a",{href:"javascript:void(0);"},c);d.connect(e,"onclick",b.hitch(this,"_onNodeClick",a));var f=a.title||"";a.thumbnailUrl?
q.create("img",{"class":"esriBasemapGalleryThumbnail",src:a.thumbnailUrl,title:f,alt:f},e):q.create("img",{"class":"esriBasemapGalleryThumbnail",src:h.toUrl("./images/transparent.gif"),title:f,alt:f},e);a=q.create("div",{"class":"esriBasemapGalleryLabelContainer"},c);return q.create("span",{innerHTML:f,alt:f,title:f},a),c},_onNodeClick:function(a,b){b.preventDefault();this._markSelected(a);this.select(a.id)},_markSelected:function(b){b&&(a.forEach(f.query(".esriBasemapGallerySelectedNode",this.domNode),
function(a){r.remove(a,"esriBasemapGallerySelectedNode")}),(b=n.byId("galleryNode_"+b.id))&&r.add(b,"esriBasemapGallerySelectedNode"))},_select:function(a){this._selectBasemapInProgress=!0;var c=this.get(a);c?(c.layers?this._getServiceInfos(c):(a=c.getLayers(this.arcgisUrl),b.isArray(a)?this._getServiceInfos(c):a.addCallback(b.hitch(this,function(a){this._getServiceInfos(c)}))),this._markSelected(c)):this._selectBasemapInProgress=!1},_getServiceInfos:function(d){"https:"===location.protocol&&a.forEach(d.layers,
function(a){(this._isAgolService(a.url)||this._isHostedService(a.url))&&(a.url=a.url.replace("http:","https:"))},this);this._selectedBasemap=d;var e=[];(a.forEach(d.layers,function(a){a.url&&0<a.url.length&&!a.isReference&&!a.type&&(a.deferredsPos=e.length,e.push(this._getServiceInfo(a.url)))},this),0<e.length)?(new c(e)).addCallback(b.hitch(this,function(b){var c=null;(a.forEach(d.layers,function(a){if(0===a.deferredsPos||a.deferredsPos){a.serviceInfoResponse=b[a.deferredsPos][1];var d=a.serviceInfoResponse.fullExtent;
d||(d=a.serviceInfoResponse.extent);c=c?c.union(new z(d)):new z(d)}},this),this.map.extent)&&5>this._getIntersectionPercent(c,this.map.extent)&&this.map.setExtent(c,!0);this._switchBasemapLayers(d);this._updateReferenceLayer(d)})):(this._switchBasemapLayers(d),this._updateReferenceLayer(d))},_checkVTLSupport:function(){var a=new e;return k("ie")?a.resolve(!1):a.resolve(H.supported()),a},_switchBasemapLayers:function(c){var e,f,g,k,h=c.layers,m=!1;if(a.forEach(h,function(a){"VectorTileLayer"===a.type&&
(m=!0)}),m&&!0!==this._supportsVTL)return e="esri.dijit.BasemapGallery: Unable to switch basemap because layer type is not supported by your current browser version.",void this.onError(e);if(0<this.map.layerIds.length&&0===this.map.getNumLevels()&&("OpenStreetMap"===h[0].type||h[0].type&&-1<h[0].type.indexOf("BingMaps")||"WebTiledLayer"===h[0].type||"VectorTileLayer"===h[0].type))return e="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.",
void this.onError(e);a.forEach(h,function(a){if(!a.isReference&&a.type&&-1<a.type.indexOf("BingMaps")&&!this.bingMapsKey)return void this.onError("esri.dijit.BasemapGallery: Invalid Bing Maps key.")},this);var l=0;a.forEach(h,function(a,c){if(!a.isReference){var e,m;if("OpenStreetMap"===a.type){if(0<this.map.layerIds.length&&0===this.map.getNumLevels())return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.",void this.onError(m);
e=new C({id:"layer_osm",opacity:a.opacity})}else if(a.type&&-1<a.type.indexOf("BingMaps")){if(0<this.map.layerIds.length&&0===this.map.getNumLevels())return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.",void this.onError(m);e=B.MAP_STYLE_AERIAL_WITH_LABELS;"BingMapsAerial"===a.type?e=B.MAP_STYLE_AERIAL:"BingMapsRoad"===a.type&&(e=B.MAP_STYLE_ROAD);e=new B({id:"layer_bing",bingMapsKey:this.bingMapsKey,mapStyle:e,
opacity:a.opacity})}else if("WebTiledLayer"===a.type){if(0<this.map.layerIds.length&&0===this.map.getNumLevels())return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.",void this.onError(m);e=a.initialExtent||a.fullExtent;e=new F(a.templateUrl||a.url,{visible:a.visibility,opacity:a.opacity,copyright:a.copyright,fullExtent:a.fullExtent&&new z(a.fullExtent),initialExtent:e&&new z(e),subDomains:a.subDomains,tileInfo:a.tileInfo?
new G(a.tileInfo):null,tileServers:a.tileServers})}else if("VectorTileLayer"===a.type){e=new H(a.styleUrl,{visible:a.visibility,opacity:a.opacity});0===c&&1<h.length&&this._removeBasemapLayers();var n=this;d.connect(e,"onLoad",b.hitch(this,function(a,b,c){var d;return n._sameSpatialReference(c.spatialReference,n.map.spatialReference)?0<n.map.getNumLevels()?n._sameTilingScheme(c.tileInfo,n.map.__tileInfo)?(0===b&&1===h.length&&n._removeBasemapLayers(),c._basemapGalleryLayerType="basemap",void n.map.addLayer(c,
a)):(d="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.",void n.onError(d)):(d="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.",void n.onError(d)):(d="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.",void n.onError(d))},l,c))}else if(a.serviceInfoResponse&&a.serviceInfoResponse.mapName){if(f=new A(a.serviceInfoResponse.spatialReference),
g=this._sameSpatialReference(f,this.map.spatialReference),this.map.spatialReference&&!g)return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.",void this.onError(m);if(!0===a.serviceInfoResponse.singleFusedMapCache&&0<this.map.getNumLevels()){if(k=this._sameTilingScheme(a.serviceInfoResponse.tileInfo,this.map.__tileInfo),!k)return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.",
void this.onError(m)}else if(!0===a.serviceInfoResponse.singleFusedMapCache&&-1<a.serviceInfoResponse.capabilities.toLowerCase().indexOf("tilesonly")&&0===this.map.getNumLevels())return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.",void this.onError(m);e=(0===this.map.layerIds.length||0<this.map.getNumLevels())&&!0===a.serviceInfoResponse.singleFusedMapCache?this._loadAsCached(a):this._loadAsDynamic(a)}else if(a.serviceInfoResponse&&
a.serviceInfoResponse.pixelSizeX){if(f=new A(a.serviceInfoResponse.spatialReference),g=this._sameSpatialReference(f,this.map.spatialReference),!g)return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.",void this.onError(m);if(!0===a.serviceInfoResponse.singleFusedMapCache&&0<this.map.getNumLevels()&&(k=this._sameTilingScheme(a.serviceInfoResponse.tileInfo,this.map.__tileInfo),!k))return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.",
void this.onError(m);a.serviceInfoResponse.singleFusedMapCache?e=new D(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility}):a.serviceInfoResponse.pixelSizeX?(e=new J,e.bandIds=a.bandIds,!a.bandIds&&a.serviceInfoResponse.bandCount&&3<parseInt(a.serviceInfoResponse.bandCount,10)&&(e.bandIds=[0,1,2]),e=new K(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility,imageServiceParameters:e})):(e=new I,e.format="png24",a.serviceInfoResponse.supportedImageFormatTypes&&
-1<a.serviceInfoResponse.supportedImageFormatTypes.indexOf("PNG32")&&(e.format="png32"),e=new E(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility,imageParameters:e}))}"VectorTileLayer"===a.type?l++:e&&(0===c&&this._removeBasemapLayers(),e._basemapGalleryLayerType="basemap",this.map.addLayer(e,l),l++)}},this);this._selectBasemapInProgress=!1;this.onSelectionChange()},_removeBasemapLayers:function(){var b=this.map.layerIds,c=[];a.forEach(b,function(a){a=this.map.getLayer(a);
"basemap"===a._basemapGalleryLayerType&&c.push(a)},this);0===c.length&&0<b.length&&c.push(this.map.getLayer(b[0]));0<c.length&&a.forEach(c,function(a){this.map.removeLayer(a)},this)},_updateReferenceLayer:function(a){var b;this._removeReferenceLayer();for(b=0;b<a.layers.length;b++)!0===a.layers[b].isReference&&this._addReferenceLayer(a.layers[b])},_removeReferenceLayer:function(){var a;for(a=this.map.layerIds.length-1;0<=a;a--){var b=this.map.getLayer(this.map.layerIds[a]);"reference"===b._basemapGalleryLayerType&&
this.map.removeLayer(b)}},_addReferenceLayer:function(a){"VectorTileLayer"===a.type?this._handleReferenceServiceInfoResponse(a):this._getServiceInfo(a.url,b.hitch(this,"_handleReferenceServiceInfoResponse",a))},_handleReferenceServiceInfoResponse:function(a,b,c){var d;(a.serviceInfoResponse=b,"VectorTileLayer"===a.type)?d=new H(a.styleUrl,{visible:a.visibility,opacity:a.opacity}):b&&b.mapName?d=!0===b.singleFusedMapCache?this._loadAsCached(a):this._loadAsDynamic(a):b&&b.pixelSizeX&&(a.serviceInfoResponse.singleFusedMapCache?
d=new D(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility}):a.serviceInfoResponse.pixelSizeX?(c=new J,c.bandIds=a.bandIds,!a.bandIds&&b.bandCount&&3<parseInt(b.bandCount,10)&&(c.bandIds=[0,1,2]),d=new K(a.url,{resourceInfo:b,opacity:a.opacity,visible:a.visibility,imageServiceParameters:c})):(b=new I,b.format="png24",a.serviceInfoResponse.supportedImageFormatTypes&&-1<a.serviceInfoResponse.supportedImageFormatTypes.indexOf("PNG32")&&(b.format="png32"),b.transparent=!0,
d=new E(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility,imageParameters:b})));d&&(d._basemapGalleryLayerType="reference",d.attr("data-reference",!0),this.map.addLayer(d))},_getServiceInfo:function(a,c){return y({url:a,content:{f:"json"},callbackParamName:"callback",load:function(a,b){c&&c(a,b)},error:b.hitch(this,function(a,b){this.onError("esri.dijit.BasemapGallery: service not accessible.")})})},_loadAsCached:function(b){var c=[];b.displayLevels||(c=a.map(b.serviceInfoResponse.tileInfo.lods,
function(a){return a.level}));var d=null;b.exclusionAreas&&b.exclusionAreas.length&&(d=[],a.forEach(b.exclusionAreas,function(a){d.push({minZoom:a.minZoom,maxZoom:a.maxZoom,minScale:a.minScale,maxScale:a.maxScale,geometry:new z(a.geometry)})}));return new D(b.url,{resourceInfo:b.serviceInfoResponse,opacity:b.opacity,visible:b.visibility,exclusionAreas:d,displayLevels:b.displayLevels||c})},_loadAsDynamic:function(a){var b=new E(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility});
return a.visibleLayers&&b.setVisibleLayers(a.visibleLayers),b},_getIntersectionPercent:function(a,b){var c=b.intersects(a);if(c){var c=c.getWidth()*c.getHeight(),d=b.getWidth()*b.getHeight();return c/d*100}return 0},_getIds:function(){var b=[];return a.forEach(this.basemaps,function(a){b.push(a.id)},this),b},_getUniqueId:function(){for(var a=","+this._getIds().toString()+",",b=0;;){if(!(-1<a.indexOf(",basemap_"+b+",")))return"basemap_"+b;b++}},_isUniqueId:function(a){return-1===(","+this._getIds().toString()+
",").indexOf(","+a+",")?!0:!1},_isAgolService:function(a){return a?-1!==a.indexOf("/services.arcgisonline.com/")||-1!==a.indexOf("/server.arcgisonline.com/"):!1},_isHostedService:function(a){return a?-1!==a.indexOf(".arcgis.com/"):!1},_sameSpatialReference:function(a,b){return a&&b&&a.wkt==b.wkt&&(a.wkid===b.wkid||w.isDefined(a.latestWkid)&&a.latestWkid===b.wkid||w.isDefined(b.latestWkid)&&a.wkid===b.latestWkid||w.isDefined(a.latestWkid)&&a.latestWkid===b.latestWkid)?!0:a&&b&&a.isWebMercator()&&b.isWebMercator()?
!0:!1},_sameTilingScheme:function(a,b){var c,d;c=this.map;var e=c.width>c.height?c.width:c.height,f=!1,g=!1;for(c=0;c<a.lods.length;c++){var k=a.lods[c].scale;a.dpi!==b.dpi&&(k=a.lods[c].scale/a.dpi);for(d=0;d<b.lods.length;d++){var h=b.lods[d].scale;if(a.dpi!==b.dpi&&(h=b.lods[d].scale/b.dpi),Math.abs(h-k)/h<1/e){if(f){g=!0;break}f=!0}if(k>h)break}if(g)break}return g?!0:!f||1!==a.lods.length&&1!==b.lods.length?!1:!0}});return m("extend-esri")&&b.setObject("dijit.BasemapGallery",l,t),l})},"esri/layers/WebTiledLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/url dojo/sniff dojo/string ../config ../kernel ../request ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r){function u(a,b){var c,d,f=[];if(a&&b&&(b.customLayerParameters||b.customParameters)){c=l.clone(b.customParameters||{});l.mixin(c,b.customLayerParameters||{});d=e.urlToObject(a);for(var g in d.query)c.hasOwnProperty(g)||f.push(g+"\x3d"+d.query[g]);a=d.path+(f.length?"?"+f.join("\x26"):"")}return a}h=h(q,{declaredClass:"esri.layers.WebTiledLayer",constructor:function(h,m){m||(m={});this.urlTemplate=h=u(h,m.wmtsInfo);var q=new n(-2.0037508342787E7,-2.003750834278E7,
2.003750834278E7,2.0037508342787E7,new c({wkid:102100})),x=new n(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,new c({wkid:102100}));(this.initialExtent=m.initialExtent||q,this.fullExtent=m.fullExtent||x,m.tileInfo)?this.tileInfo=m.tileInfo:this.tileInfo=new r({dpi:96,rows:256,cols:256,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,resolution:156543.033928,scale:5.91657527591555E8},{level:1,resolution:78271.5169639999,scale:2.95828763795777E8},
{level:2,resolution:39135.7584820001,scale:1.47914381897889E8},{level:3,resolution:19567.8792409999,scale:7.3957190948944E7},{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,
scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,
scale:1128.497176},{level:20,resolution:.14929107082380833,scale:564.248588},{level:21,resolution:.07464553541190416,scale:282.124294},{level:22,resolution:.03732276770595208,scale:141.062147},{level:23,resolution:.01866138385297604,scale:70.5310735}]});this.spatialReference=new c(this.tileInfo.spatialReference.toJson());this.copyright=m.copyright||"";var y=new d(h),q=y.scheme+"://"+y.authority+"/";if(this.urlPath=h.substring(q.length),this.tileServers=m.tileServers||[],-1===y.authority.indexOf("{subDomain}")&&
this.tileServers.push(q),m.subDomains&&0<m.subDomains.length&&1<y.authority.split(".").length){this.subDomains=m.subDomains;var z;a.forEach(m.subDomains,function(a){-1<y.authority.indexOf("${subDomain}")?z=y.scheme+"://"+f.substitute(y.authority,{subDomain:a})+"/":-1<y.authority.indexOf("{subDomain}")&&(z=y.scheme+"://"+y.authority.replace(/\{subDomain\}/gi,a)+"/");this.tileServers.push(z)},this)}this.tileServers=a.map(this.tileServers,function(a){return"/"!==a.charAt(a.length-1)&&(a+="/"),a});this._levelToLevelValue=
[];a.forEach(this.tileInfo.lods,function(a){this._levelToLevelValue[a.level]=a.levelValue||a.level},this);this._wmtsInfo=m.wmtsInfo;var A=l.hitch(this,function(){this.loaded=!0;this.onLoad(this)});if(b("chrome")){var q=this.getTileUrl(0,0,0),x=k.defaults.io,B="with-credentials"===x.useCors?e.canUseXhr(q,!0):-1;(x=-1<B?x.corsEnabledServers[B]:null)&&x.withCredentials?g({url:q,handleAs:"arraybuffer"}).addBoth(function(a){A()}):A()}else A()},getTileUrl:function(a,b,c){a=this._levelToLevelValue[a];var d=
this.tileServers[b%this.tileServers.length]+f.substitute(this.urlPath,{level:a,col:c,row:b});return d=d.replace(/\{level\}/gi,a).replace(/\{row\}/gi,b).replace(/\{col\}/gi,c),d=this._appendCustomLayerParameters(d),d=this.addTimestampToURL(d),e.addProxy(d)},_appendCustomLayerParameters:function(a){var b,c;if(this._wmtsInfo&&(this._wmtsInfo.customLayerParameters||this._wmtsInfo.customParameters))for(b in c=l.clone(this._wmtsInfo.customParameters||{}),l.mixin(c,this._wmtsInfo.customLayerParameters||
{}),c)a+=(-1===a.indexOf("?")?"?":"\x26")+b+"\x3d"+encodeURIComponent(c[b]);return a}});return b("extend-esri")&&l.setObject("layers.WebTiledLayer",h,m),h})},"esri/layers/ImageServiceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang".split(" "),function(h,l,a,d,b,f){h=h(null,{declaredClass:"esri.layers.ImageServiceParameters",extent:null,width:null,height:null,imageSpatialReference:null,format:null,interpolation:null,compressionQuality:null,
bandIds:null,timeExtent:null,mosaicRule:null,renderingRule:null,noData:null,compressionTolerance:null,adjustAspectRatio:null,lercVersion:null,toJson:function(b){var d=this.bbox||this.extent;b=(d=d&&b&&d._normalize(!0))?d.spatialReference.wkid||a.toJson(d.spatialReference.toJson()):null;var g=this.imageSpatialReference,d={bbox:d?d.xmin+","+d.ymin+","+d.xmax+","+d.ymax:null,bboxSR:b,size:null!==this.width&&null!==this.height?this.width+","+this.height:null,imageSR:g?g.wkid||a.toJson(g.toJson()):b,format:this.format,
interpolation:this.interpolation,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null,mosaicRule:this.mosaicRule?a.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?a.toJson(this.renderingRule.toJson()):null,noData:this.noData,noDataInterpretation:this.noDataInterpretation,compressionTolerance:this.compressionTolerance,adjustAspectRatio:this.adjustAspectRatio,lercVersion:this.lercVersion};b=this.timeExtent;return d.time=b?b.toJson().join(","):
null,f.filter(d,function(a){return null!==a&&void 0!==a?!0:void 0})}});return l.mixin(h,{INTERPOLATION_BILINEAR:"RSP_BilinearInterpolation",INTERPOLATION_CUBICCONVOLUTION:"RSP_CubicConvolution",INTERPOLATION_MAJORITY:"RSP_Majority",INTERPOLATION_NEARESTNEIGHBOR:"RSP_NearestNeighbor",NODATA_MATCH_ALL:"esriNoDataMatchAll",NODATA_MATCH_ANY:"esriNoDataMatchAny"}),d("extend-esri")&&l.setObject("layers.ImageServiceParameters",h,b),h})},"esri/dijit/Basemap":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../request ./BasemapLayer".split(" "),
function(h,l,a,d,b,f,k){h=h(null,{declaredClass:"esri.dijit.Basemap",id:null,title:"",thumbnailUrl:null,layers:null,itemId:null,basemapGallery:null,constructor:function(a,b){a=a||{};a.layers||a.itemId||console.error("esri.dijit.Basemap: unable to find the 'layers' property in parameters");this.id=a.id;this.itemId=a.itemId;this.layers=a.layers;this.title=a.title||"";this.thumbnailUrl=a.thumbnailUrl;this.basemapGallery=b},getLayers:function(d){if(this.layers)return this.layers;if(this.itemId)return d=
f({url:(d||b.dijit._arcgisUrl)+"/content/items/"+this.itemId+"/data",content:{f:"json"},callbackParamName:"callback",error:a.hitch(this,function(a,b){this.basemapGallery?this.basemapGallery.onError("esri.dijit.Basemap: could not access basemap item."):console.error("esri.dijit.Basemap: could not access basemap item.")})}),d.addCallback(a.hitch(this,function(a,b){return a.baseMap?(this.layers=[],l.forEach(a.baseMap.baseMapLayers,function(a){this.layers.push(new k(a))},this),this.layers):(this.basemapGallery?
this.basemapGallery.onError("esri.dijit.Basemap: could not access basemap item."):console.error("esri.dijit.Basemap: could not access basemap item."),[])})),d}});return d("extend-esri")&&a.setObject("dijit.Basemap",h,b),h})},"esri/dijit/BasemapLayer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.dijit.BasemapLayer",constructor:function(a){a=a||{};a.url||a.type||console.error("esri.dijit.BasemapLayer: unable to find the 'url' or 'type' property in parameters");
this.url=a.url;this.type=a.type;this.isReference=!0===a.isReference?!0:!1;this.opacity=a.opacity;this.visibleLayers=a.visibleLayers;this.displayLevels=a.displayLevels;this.exclusionAreas=a.exclusionAreas;this.bandIds=a.bandIds;this.templateUrl=a.templateUrl;this.copyright=a.copyright;this.subDomains=a.subDomains;this.fullExtent=a.fullExtent;this.initialExtent=a.initialExtent;this.tileInfo=a.tileInfo;this.tileServers=a.tileServers;this.styleUrl=a.styleUrl}});return a("extend-esri")&&l.setObject("dijit.BasemapLayer",
h,d),h})},"cmv/viewer/js/gis/dijit/Basemaps/nls/resource":function(){define({root:{title:"Basemaps"},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/Help":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin gis/dijit/_FloatingWidgetMixin dojo/dom-construct dojo/on dojo/_base/lang dojo/aspect dojo/text!./Help/templates/HelpDialog.html dojo/i18n!./Help/nls/resource dijit/form/Button dijit/layout/TabContainer dijit/layout/ContentPane xstyle/css!./Help/css/Help.css".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c){return h([l,a,d,b],{widgetsInTemplate:!0,templateString:e,i18n:c,html:'\x3ca href\x3d"#"\x3elink\x3c/a\x3e'.replace("link",c.link),domTarget:"helpDijit",draggable:!1,baseClass:"helpDijit",postCreate:function(){this.inherited(arguments);this.parentWidget.draggable=this.draggable;if(this.parentWidget.toggleable)this.own(g.after(this.parentWidget,"toggle",m.hitch(this,function(){this.containerNode.resize()})));else{var a=f.place(this.html,this.domTarget);k(a,"click",m.hitch(this.parentWidget,
"show"))}},onOpen:function(){this.openOnStartup||this.containerNode.resize()},close:function(){this.parentWidget.hide&&this.parentWidget.hide()}})})},"cmv/viewer/js/gis/dijit/_FloatingWidgetMixin":function(){define(["dojo/_base/declare","dojo/on","dojo/_base/lang"],function(h,l,a){return h(null,{startup:function(){this.parentWidget&&"gis.dijit.FloatingWidget"===this.parentWidget.declaredClass&&this.onOpen&&l(this.parentWidget,"show",a.hitch(this,"onOpen"));this.parentWidget&&"gis.dijit.FloatingWidget"===
this.parentWidget.declaredClass&&this.onClose&&l(this.parentWidget,"hide",a.hitch(this,"onClose"));this.parentWidget&&"gis.dijit.FloatingWidget"===this.parentWidget.declaredClass&&this.openOnStartup&&this.parentWidget.show();this.inherited(arguments)}})})},"cmv/viewer/js/gis/dijit/Help/nls/resource":function(){define({root:{link:"Help",navigation:{title:"Navigation",description:"Map navigation using mouse and keyboard:",pan1:"Drag to pan",recenter:"SHIFT + Click to recenter",zoomIn1:"SHIFT + Drag to zoom in",
zoomOut1:"SHIFT + CTRL + Drag to zoom out",zoomIn2:"Mouse Scroll Forward to zoom in",zoomOut2:"Mouse Scroll Backward to zoom out",pan2:"Use Arrow keys to pan",zoomInLevel:"+ key to zoom in a level",zoomOutLevel:"- key to zoom out a level",zoomCenter:"Double Click to Center and Zoom in"},search:{title:"Search",description:"A variety of searches can be performed in the search box:",address:"Search by Address",place:"Search by Place Name",etc:"Search By Zip Code, County, etc."},tools:{title:"Tools",
description:"In addition to Search capabilities, the following tools are provided:",measure:{title:"Measure",description:"The measure tool provides the capabilities to draw a point, line, or polygon on the map and specify the unit of measurement."},print:{title:"Print",description:"This map can be exported to various formats and layouts."}}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"dijit/layout/TabContainer":function(){define(["dojo/_base/lang","dojo/_base/declare","./_TabContainerBase","./TabController",
"./ScrollingTabController"],function(h,l,a,d,b){return l("dijit.layout.TabContainer",a,{useMenu:!0,useSlider:!0,controllerWidget:"",_makeController:function(a){var b=this.baseClass+"-tabs"+(this.doLayout?"":" dijitTabNoLayout");return new ("string"==typeof this.controllerWidget?h.getObject(this.controllerWidget):this.controllerWidget)({id:this.id+"_tablist",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,tabPosition:this.tabPosition,doLayout:this.doLayout,containerId:this.id,
"class":b,nested:this.nested,useMenu:this.useMenu,useSlider:this.useSlider,tabStripClass:this.tabStrip?this.baseClass+(this.tabStrip?"":"No")+"Strip":null},a)},postMixInProperties:function(){this.inherited(arguments);this.controllerWidget||(this.controllerWidget="top"!=this.tabPosition&&"bottom"!=this.tabPosition||this.nested?d:b)}})})},"dijit/layout/_TabContainerBase":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style ./StackContainer ./utils ../_TemplatedMixin dojo/text!./templates/TabContainer.html".split(" "),
function(h,l,a,d,b,f,k,m){return h("dijit.layout._TabContainerBase",[b,k],{tabPosition:"top",baseClass:"dijitTabContainer",tabStrip:!1,nested:!1,templateString:m,postMixInProperties:function(){this.baseClass+=this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"");this.srcNodeRef&&d.set(this.srcNodeRef,"visibility","hidden");this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.tablist=this._makeController(this.tablistNode);this.doLayout||
l.add(this.domNode,"dijitTabContainerNoLayout");this.nested?(l.add(this.domNode,"dijitTabContainerNested"),l.add(this.tablist.containerNode,"dijitTabContainerTabListNested"),l.add(this.tablistSpacer,"dijitTabContainerSpacerNested"),l.add(this.containerNode,"dijitTabPaneWrapperNested")):l.add(this.domNode,"tabStrip-"+(this.tabStrip?"enabled":"disabled"))},_setupChild:function(a){l.add(a.domNode,"dijitTabPane");this.inherited(arguments)},startup:function(){this._started||(this.tablist.startup(),this.inherited(arguments))},
layout:function(){if(this._contentBox&&"undefined"!=typeof this._contentBox.l){var b=this.selectedChildWidget;if(this.doLayout){var d=this.tabPosition.replace(/-h/,"");this.tablist.region=d;d=[this.tablist,{domNode:this.tablistSpacer,region:d},{domNode:this.containerNode,region:"center"}];f.layoutChildren(this.domNode,this._contentBox,d);this._containerContentBox=f.marginBox2contentBox(this.containerNode,d[2]);b&&b.resize&&b.resize(this._containerContentBox)}else{if(this.tablist.resize){d=this.tablist.domNode.style;
d.width="0";var c=a.getContentBox(this.domNode).w;d.width="";this.tablist.resize({w:c})}b&&b.resize&&b.resize()}}},destroy:function(a){this.tablist&&this.tablist.destroy(a);this.inherited(arguments)}})})},"dijit/layout/StackContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/ready dojo/topic dojo/when ../registry ../_WidgetBase ./_LayoutWidget".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r){f("dijit-legacy-requires")&&
g(0,function(){require(["dijit/layout/StackController"])});a=a("dijit.layout.StackContainer",r,{doLayout:!0,persist:!1,baseClass:"dijitStackContainer",buildRendering:function(){this.inherited(arguments);d.add(this.domNode,"dijitLayoutContainer")},postCreate:function(){this.inherited(arguments);this.own(m(this.domNode,"keydown",k.hitch(this,"_onKeyDown")))},startup:function(){if(!this._started){var a=this.getChildren();h.forEach(a,this._setupChild,this);this.persist?this.selectedChildWidget=n.byId(l(this.id+
"_selectedChild")):h.some(a,function(a){a.selected&&(this.selectedChildWidget=a);return a.selected},this);var b=this.selectedChildWidget;!b&&a[0]&&(b=this.selectedChildWidget=a[0],b.selected=!0);e.publish(this.id+"-startup",{children:a,selected:b,textDir:this.textDir});this.inherited(arguments)}},resize:function(){if(!this._hasBeenShown){this._hasBeenShown=!0;var a=this.selectedChildWidget;a&&this._showChild(a)}this.inherited(arguments)},_setupChild:function(a){var c=a.domNode,d=b.place("\x3cdiv role\x3d'tabpanel' class\x3d'"+
this.baseClass+"ChildWrapper dijitHidden'\x3e",a.domNode,"replace"),e=a["aria-label"]||a.title||a.label;e&&d.setAttribute("aria-label",e);b.place(c,d);a._wrapper=d;this.inherited(arguments);"none"==c.style.display&&(c.style.display="block");a.domNode.removeAttribute("title")},addChild:function(a,b){this.inherited(arguments);this._started&&(e.publish(this.id+"-addChild",a,b),this.layout(),this.selectedChildWidget||this.selectChild(a))},removeChild:function(a){var c=h.indexOf(this.getChildren(),a);
this.inherited(arguments);b.destroy(a._wrapper);delete a._wrapper;this._started&&e.publish(this.id+"-removeChild",a);if(!this._descendantsBeingDestroyed){if(this.selectedChildWidget===a&&(this.selectedChildWidget=void 0,this._started)){var d=this.getChildren();d.length&&this.selectChild(d[Math.max(c-1,0)])}this._started&&this.layout()}},selectChild:function(a,b){var d;a=n.byId(a);this.selectedChildWidget!=a&&(d=this._transition(a,this.selectedChildWidget,b),this._set("selectedChildWidget",a),e.publish(this.id+
"-selectChild",a,this._focused),this.persist&&l(this.id+"_selectedChild",this.selectedChildWidget.id));return c(d||!0)},_transition:function(a,b){b&&this._hideChild(b);var c=this._showChild(a);a.resize&&(this.doLayout?a.resize(this._containerContentBox||this._contentBox):a.resize());return c},_adjacent:function(a){var b=this.getChildren(),c=h.indexOf(b,this.selectedChildWidget),c=c+(a?1:b.length-1);return b[c%b.length]},forward:function(){return this.selectChild(this._adjacent(!0),!0)},back:function(){return this.selectChild(this._adjacent(!1),
!0)},_onKeyDown:function(a){e.publish(this.id+"-containerKeyDown",{e:a,page:this})},layout:function(){var a=this.selectedChildWidget;a&&a.resize&&(this.doLayout?a.resize(this._containerContentBox||this._contentBox):a.resize())},_showChild:function(a){var b=this.getChildren();a.isFirstChild=a==b[0];a.isLastChild=a==b[b.length-1];a._set("selected",!0);a._wrapper&&d.replace(a._wrapper,"dijitVisible","dijitHidden");return a._onShow&&a._onShow()||!0},_hideChild:function(a){a._set("selected",!1);a._wrapper&&
d.replace(a._wrapper,"dijitHidden","dijitVisible");a.onHide&&a.onHide()},closeChild:function(a){if(!a.onClose||a.onClose(this,a))this.removeChild(a),a.destroyRecursive()},destroyDescendants:function(a){this._descendantsBeingDestroyed=!0;this.selectedChildWidget=void 0;h.forEach(this.getChildren(),function(b){a||this.removeChild(b);b.destroyRecursive(a)},this);this._descendantsBeingDestroyed=!1}});a.ChildWidgetProperties={selected:!1,disabled:!1,closable:!1,iconClass:"dijitNoIcon",showTitle:!0};k.extend(q,
a.ChildWidgetProperties);return a})},"dijit/layout/TabController":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/has dojo/i18n dojo/_base/lang ./StackController ../registry ../Menu ../MenuItem dojo/text!./templates/_TabButton.html dojo/i18n!../nls/common".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n){n=h("dijit.layout._TabButton"+(b("dojo-bidi")?"_NoBidi":""),m.StackButton,{baseClass:"dijitTab",cssStateNodes:{closeNode:"dijitTabCloseButton"},templateString:n,_setNameAttr:"focusNode",
scrollOnFocus:!1,buildRendering:function(){this.inherited(arguments);l.setSelectable(this.containerNode,!1)},startup:function(){this.inherited(arguments);var a=this.domNode;this.defer(function(){a.className=a.className},1)},_setCloseButtonAttr:function(b){this._set("closeButton",b);d.toggle(this.domNode,"dijitClosable",b);this.closeNode.style.display=b?"":"none";b&&(b=f.getLocalization("dijit","common"),this.closeNode&&a.set(this.closeNode,"title",b.itemClose))},_setDisabledAttr:function(b){this.inherited(arguments);
if(this.closeNode)if(b)a.remove(this.closeNode,"title");else{var c=f.getLocalization("dijit","common");a.set(this.closeNode,"title",c.itemClose)}},_setLabelAttr:function(a){this.inherited(arguments);this.showLabel||this.params.title||(this.iconNode.alt=k.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});b("dojo-bidi")&&(n=h("dijit.layout._TabButton",n,{_setLabelAttr:function(a){this.inherited(arguments);this.applyTextDir(this.iconNode,this.iconNode.alt)}}));h=h("dijit.layout.TabController",
m,{baseClass:"dijitTabController",templateString:"\x3cdiv role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown:onkeydown'\x3e\x3c/div\x3e",tabPosition:"top",buttonWidget:n,buttonWidgetCloseClass:"dijitTabCloseButton",postCreate:function(){this.inherited(arguments);var a=new e({id:this.id+"_Menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,targetNodeIds:[this.domNode],selector:function(a){return d.contains(a,"dijitClosable")&&!d.contains(a,"dijitTabDisabled")}});
this.own(a);var b=f.getLocalization("dijit","common"),k=this;a.addChild(new c({label:b.itemClose,ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,onClick:function(a){a=g.byNode(this.getParent().currentTarget);k.onCloseButtonClick(a.page)}}))}});h.TabButton=n;return h})},"dijit/layout/StackController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/topic ../focus ../registry ../_Widget ../_TemplatedMixin ../_Container ../form/ToggleButton dojo/touch".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r){d=l("dijit.layout._StackButton",r,{tabIndex:"-1",closeButton:!1,_aria_attr:"aria-selected",buildRendering:function(a){this.inherited(arguments);(this.focusNode||this.domNode).setAttribute("role","tab")}});l=l("dijit.layout.StackController",[c,n,q],{baseClass:"dijitStackController",templateString:"\x3cspan role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown'\x3e\x3c/span\x3e",containerId:"",buttonWidget:d,buttonWidgetCloseClass:"dijitStackCloseButton",pane2button:function(a){return e.byId(this.id+
"_"+a)},postCreate:function(){this.inherited(arguments);this.own(m.subscribe(this.containerId+"-startup",f.hitch(this,"onStartup")),m.subscribe(this.containerId+"-addChild",f.hitch(this,"onAddChild")),m.subscribe(this.containerId+"-removeChild",f.hitch(this,"onRemoveChild")),m.subscribe(this.containerId+"-selectChild",f.hitch(this,"onSelectChild")),m.subscribe(this.containerId+"-containerKeyDown",f.hitch(this,"onContainerKeyDown")));this.containerNode.dojoClick=!0;this.own(k(this.containerNode,"click",
f.hitch(this,function(b){var c=e.getEnclosingWidget(b.target);if(c!=this.containerNode&&!c.disabled&&c.page)for(b=b.target;b!==this.containerNode;b=b.parentNode)if(a.contains(b,this.buttonWidgetCloseClass)){this.onCloseButtonClick(c.page);break}else if(b==c.domNode){this.onButtonClick(c.page);break}})))},onStartup:function(a){this.textDir=a.textDir;h.forEach(a.children,this.onAddChild,this);if(a.selected)this.onSelectChild(a.selected);var b=e.byId(this.containerId).containerNode,c=f.hitch(this,"pane2button");
a={title:"label",showtitle:"showLabel",iconclass:"iconClass",closable:"closeButton",tooltip:"title",disabled:"disabled",textdir:"textdir"};var d=function(a,d){return k(b,"attrmodified-"+a,function(a){var b=c(a.detail&&a.detail.widget&&a.detail.widget.id);b&&b.set(d,a.detail.newValue)})},g;for(g in a)this.own(d(g,a[g]))},destroy:function(a){this.destroyDescendants(a);this.inherited(arguments)},onAddChild:function(a,b){var c=new (f.isString(this.buttonWidget)?f.getObject(this.buttonWidget):this.buttonWidget)({id:this.id+
"_"+a.id,name:this.id+"_"+a.id,label:a.title,disabled:a.disabled,ownerDocument:this.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir||this.textDir,showLabel:a.showTitle,iconClass:a.iconClass,closeButton:a.closable,title:a.tooltip,page:a});this.addChild(c,b);a.controlButton=c;if(!this._currentChild)this.onSelectChild(a);c=a._wrapper.getAttribute("aria-labelledby")?a._wrapper.getAttribute("aria-labelledby")+" "+c.id:c.id;a._wrapper.removeAttribute("aria-label");a._wrapper.setAttribute("aria-labelledby",
c)},onRemoveChild:function(a){this._currentChild===a&&(this._currentChild=null);var b=this.pane2button(a.id);b&&(this.removeChild(b),b.destroy());delete a.controlButton},onSelectChild:function(a){if(a){if(this._currentChild){var b=this.pane2button(this._currentChild.id);b.set("checked",!1);b.focusNode.setAttribute("tabIndex","-1")}b=this.pane2button(a.id);b.set("checked",!0);this._currentChild=a;b.focusNode.setAttribute("tabIndex","0");e.byId(this.containerId)}},onButtonClick:function(a){var b=this.pane2button(a.id);
g.focus(b.focusNode);this._currentChild&&this._currentChild.id===a.id&&b.set("checked",!0);e.byId(this.containerId).selectChild(a)},onCloseButtonClick:function(a){e.byId(this.containerId).closeChild(a);this._currentChild&&(a=this.pane2button(this._currentChild.id))&&g.focus(a.focusNode||a.domNode)},adjacent:function(a){this.isLeftToRight()||this.tabPosition&&!/top|bottom/.test(this.tabPosition)||(a=!a);var b=this.getChildren(),c=h.indexOf(b,this.pane2button(this._currentChild.id)),d=b[c],e;do c=(c+
(a?1:b.length-1))%b.length,e=b[c];while(e.disabled&&e!=d);return e},onkeydown:function(a,c){if(!this.disabled&&!a.altKey){var d=null;if(a.ctrlKey||!a._djpage){switch(a.keyCode){case b.LEFT_ARROW:case b.UP_ARROW:a._djpage||(d=!1);break;case b.PAGE_UP:a.ctrlKey&&(d=!1);break;case b.RIGHT_ARROW:case b.DOWN_ARROW:a._djpage||(d=!0);break;case b.PAGE_DOWN:a.ctrlKey&&(d=!0);break;case b.HOME:for(var e=this.getChildren(),f=0;f<e.length;f++){var g=e[f];if(!g.disabled){this.onButtonClick(g.page);break}}a.stopPropagation();
a.preventDefault();break;case b.END:e=this.getChildren();for(f=e.length-1;0<=f;f--)if(g=e[f],!g.disabled){this.onButtonClick(g.page);break}a.stopPropagation();a.preventDefault();break;case b.DELETE:case 87:this._currentChild.closable&&(a.keyCode==b.DELETE||a.ctrlKey)&&(this.onCloseButtonClick(this._currentChild),a.stopPropagation(),a.preventDefault());break;case b.TAB:a.ctrlKey&&(this.onButtonClick(this.adjacent(!a.shiftKey).page),a.stopPropagation(),a.preventDefault())}null!==d&&(this.onButtonClick(this.adjacent(d).page),
a.stopPropagation(),a.preventDefault())}}},onContainerKeyDown:function(a){a.e._djpage=a.page;this.onkeydown(a.e)}});l.StackButton=d;return l})},"dijit/layout/ScrollingTabController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/_base/lang dojo/on dojo/query dojo/sniff ../registry dojo/text!./templates/ScrollingTabController.html dojo/text!./templates/_ScrollingTabControllerButton.html ./TabController ./utils ../_WidgetsInTemplateMixin ../Menu ../MenuItem ../form/Button ../_HasDropDown dojo/NodeList-dom ../a11yclick".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y){n=l("dijit.layout.ScrollingTabController",[r,v],{baseClass:"dijitTabController dijitScrollingTabController",templateString:n,useMenu:!0,useSlider:!0,tabStripClass:"",_minScroll:5,_setClassAttr:{node:"containerNode",type:"class"},buildRendering:function(){this.inherited(arguments);var b=this.domNode;this.scrollNode=this.tablistWrapper;this._initButtons();this.tabStripClass||(this.tabStripClass="dijitTabContainer"+this.tabPosition.charAt(0).toUpperCase()+
this.tabPosition.substr(1).replace(/-.*/,"")+"None",a.add(b,"tabStrip-disabled"));a.add(this.tablistWrapper,this.tabStripClass)},onStartup:function(){this.inherited(arguments);b.set(this.domNode,"visibility","");this._postStartup=!0;this.own(m(this.containerNode,"attrmodified-label, attrmodified-iconclass",k.hitch(this,function(a){this._dim&&this.resize(this._dim)})))},onAddChild:function(a,c){this.inherited(arguments);b.set(this.containerNode,"width",b.get(this.containerNode,"width")+200+"px")},
onRemoveChild:function(a,b){var c=this.pane2button(a.id);this._selectedTab===c.domNode&&(this._selectedTab=null);this.inherited(arguments)},_initButtons:function(){this._btnWidth=0;this._buttons=g("\x3e .tabStripButton",this.domNode).filter(function(a){if(this.useMenu&&a==this._menuBtn.domNode||this.useSlider&&(a==this._rightBtn.domNode||a==this._leftBtn.domNode))return this._btnWidth+=d.getMarginSize(a).w,!0;b.set(a,"display","none");return!1},this)},_getTabsWidth:function(){var a=this.getChildren();
if(a.length){var b=a[this.isLeftToRight()?0:a.length-1].domNode,a=a[this.isLeftToRight()?a.length-1:0].domNode;return a.offsetLeft+a.offsetWidth-b.offsetLeft}return 0},_enableBtn:function(a){var c=this._getTabsWidth();a=a||b.get(this.scrollNode,"width");return 0<c&&a<c},resize:function(a){this._dim=a;this.scrollNode.style.height="auto";var b=this._contentBox=u.marginBox2contentBox(this.domNode,{h:0,w:a.w});b.h=this.scrollNode.offsetHeight;d.setContentSize(this.domNode,b);b=this._enableBtn(this._contentBox.w);
this._buttons.style("display",b?"":"none");this._leftBtn.region="left";this._rightBtn.region="right";this._menuBtn.region=this.isLeftToRight()?"right":"left";u.layoutChildren(this.domNode,this._contentBox,[this._menuBtn,this._leftBtn,this._rightBtn,{domNode:this.scrollNode,region:"center"}]);this._selectedTab&&(this._anim&&"playing"==this._anim.status()&&this._anim.stop(),this.scrollNode.scrollLeft=this._convertToScrollLeft(this._getScrollForSelectedTab()));this._setButtonClass(this._getScroll());
this._postResize=!0;return{h:this._contentBox.h,w:a.w}},_getScroll:function(){return this.isLeftToRight()||8>e("ie")||e("trident")&&e("quirks")||e("webkit")?this.scrollNode.scrollLeft:b.get(this.containerNode,"width")-b.get(this.scrollNode,"width")+(e("trident")||e("edge")?-1:1)*this.scrollNode.scrollLeft},_convertToScrollLeft:function(a){if(this.isLeftToRight()||8>e("ie")||e("trident")&&e("quirks")||e("webkit"))return a;var c=b.get(this.containerNode,"width")-b.get(this.scrollNode,"width");return(e("trident")||
e("edge")?-1:1)*(a-c)},onSelectChild:function(a,c){var d=this.pane2button(a.id);if(d){var e=d.domNode;if(e!=this._selectedTab&&(this._selectedTab=e,this._postResize)){var f=this._getScroll();f>e.offsetLeft||f+b.get(this.scrollNode,"width")<e.offsetLeft+b.get(e,"width")?(e=this.createSmoothScroll(),c&&(e.onEnd=function(){d.focus()}),e.play()):c&&d.focus()}this.inherited(arguments)}},_getScrollBounds:function(){var a=this.getChildren(),c=b.get(this.scrollNode,"width"),d=b.get(this.containerNode,"width")-
c,e=this._getTabsWidth();if(a.length&&e>c)return{min:this.isLeftToRight()?0:a[a.length-1].domNode.offsetLeft,max:this.isLeftToRight()?a[a.length-1].domNode.offsetLeft+a[a.length-1].domNode.offsetWidth-c:d};a=this.isLeftToRight()?0:d;return{min:a,max:a}},_getScrollForSelectedTab:function(){var a=this._selectedTab,c=b.get(this.scrollNode,"width"),d=this._getScrollBounds(),a=a.offsetLeft+b.get(a,"width")/2-c/2;return a=Math.min(Math.max(a,d.min),d.max)},createSmoothScroll:function(a){if(0<arguments.length){var b=
this._getScrollBounds();a=Math.min(Math.max(a,b.min),b.max)}else a=this._getScrollForSelectedTab();this._anim&&"playing"==this._anim.status()&&this._anim.stop();var c=this,d=this.scrollNode,e=new f.Animation({beforeBegin:function(){this.curve&&delete this.curve;var b=d.scrollLeft,g=c._convertToScrollLeft(a);e.curve=new f._Line(b,g)},onAnimate:function(a){d.scrollLeft=a}});this._anim=e;this._setButtonClass(a);return e},_getBtnNode:function(b){for(b=b.target;b&&!a.contains(b,"tabStripButton");)b=b.parentNode;
return b},doSlideRight:function(a){this.doSlide(1,this._getBtnNode(a))},doSlideLeft:function(a){this.doSlide(-1,this._getBtnNode(a))},doSlide:function(c,d){if(!d||!a.contains(d,"dijitTabDisabled")){var e=.75*b.get(this.scrollNode,"width")*c,e=this._getScroll()+e;this._setButtonClass(e);this.createSmoothScroll(e).play()}},_setButtonClass:function(a){var b=this._getScrollBounds();this._leftBtn.set("disabled",a<=b.min);this._rightBtn.set("disabled",a>=b.max)}});q=l("dijit.layout._ScrollingTabControllerButtonMixin",
null,{baseClass:"dijitTab tabStripButton",templateString:q,tabIndex:"",isFocusable:function(){return!1}});l("dijit.layout._ScrollingTabControllerButton",[x,q]);l("dijit.layout._ScrollingTabControllerMenuButton",[x,y,q],{containerId:"",tabIndex:"-1",isLoaded:function(){return!1},loadDropDown:function(a){this.dropDown=new t({id:this.containerId+"_menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir});var b=c.byId(this.containerId);h.forEach(b.getChildren(),function(a){var c=
new w({id:a.id+"_stcMi",label:a.title,iconClass:a.iconClass,disabled:a.disabled,ownerDocument:this.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir||b.textDir,onClick:function(){b.selectChild(a)}});this.dropDown.addChild(c)},this);a()},closeDropDown:function(a){this.inherited(arguments);this.dropDown&&(this._popupStateNode.removeAttribute("aria-owns"),this.dropDown.destroyRecursive(),delete this.dropDown)}});return n})},"cmv/viewer/js/gis/dijit/Bookmarks":function(){define("dojo/_base/declare dijit/_WidgetBase esri/dijit/Bookmarks dojo/json dojo/cookie dojo/_base/lang xstyle/css!./Bookmarks/css/Bookmarks.css".split(" "),
function(h,l,a,d,b,f){return h([l],{declaredClass:"gis.digit.Bookmarks",postCreate:function(){this.inherited(arguments);var k=this.bookmarks;this.bookmarkItems=b("bookmarkItems");this.bookmarkItems=void 0===this.bookmarkItems?[]:d.parse(this.bookmarkItems);this.bookmarks=new a({map:this.map,id:this.id+"_esri",editable:this.editable,bookmarks:f.mixin(this.bookmarkItems,k)},this.domNode);this.connect(this.bookmarks,"onEdit","setBookmarks");this.connect(this.bookmarks,"onRemove","setBookmarks")},setBookmarks:function(){b("bookmarkItems",
d.stringify(this.bookmarks.toJson()),{expires:365})},_export:function(){return d.stringify(this.bookmarks.toJson())}})})},"esri/dijit/Bookmarks":function(){define("dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/has dojo/keys dojo/on dojo/query dojo/window dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dnd/Avatar dojo/dnd/Source dojo/i18n!../nls/jsapi dijit/a11yclick dijit/_WidgetBase ../kernel ../domUtils ../Evented ../geometry/Extent ./BookmarkItem".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B){a=a([w,z],{declaredClass:"esri.dijit.Bookmarks",bookmarks:[],bookmarkDomNode:null,bookmarkTable:null,initBookmarks:null,editable:null,map:null,_oldGenerateText:null,_customGenerateText:!1,_LTR:!0,_dndSource:null,_inputBox:null,_label:null,_css:{esriBookmarks:"esriBookmarks",esriBookmarksRTL:"esriBookmarksRTL",esriBookmarkList:"esriBookmarkList",esriBookmarkTable:"esriBookmarkTable",esriBookmarkEditImage:"esriBookmarkEditImage",esriBookmarkRemoveImage:"esriBookmarkRemoveImage",
esriBookmarkLabel:"esriBookmarkLabel",esriBookmarkItem:"esriBookmarkItem",esriBookmarkHighlight:"esriBookmarkHighlight",esriAddBookmark:"esriAddBookmark",esriBookmarkEditBox:"esriBookmarkEditBox"},_clickHandlers:[],_mouseOverHandlers:[],_mouseOutHandlers:[],_removeHandlers:[],_editHandlers:[],_dndHandlers:[],_eventMap:{click:!0,edit:!0,remove:!0},onClick:function(){},onEdit:function(){},onRemove:function(){},constructor:function(a,b){this.map=a.map;this.editable=a.editable;this.initBookmarks=a.bookmarks;
delete a.bookmarks;this.bookmarkDomNode=n.create("div");c.add(this.bookmarkDomNode,this._css.esriBookmarkList);this.bookmarkTable=n.create("div");c.add(this.bookmarkTable,this._css.esriBookmarkTable);this.bookmarkDomNode.appendChild(this.bookmarkTable);b=e.byId(b);b.appendChild(this.bookmarkDomNode);this.srcNodeRef=b;c.add(this.srcNodeRef,this._css.esriBookmarks);(this._LTR=this.isLeftToRight())||c.add(this.srcNodeRef,this._css.esriBookmarksRTL);this._dndSource=new u(this.bookmarkTable,{creator:this._avatarCreator,
singular:!0,checkAcceptance:function(a,b){return this===a?!0:!1}});this._dndSourceNodes=this._dndSource.getAllNodes();this._dndHandlers.push(k(this._dndSource,"DndStart",d.hitch(this,function(a){a===this._dndSource&&(this._oldGenerateText=r.prototype._generateText,r.prototype._generateText=d.hitch(this,this._generateText),this._customGenerateText=!0,this._inputBox&&this._inputBox.blur())})));this._dndHandlers.push(k(this._dndSource,"DndDrop",d.hitch(this,function(a){a===this._dndSource&&(this._syncBookmarksAfterReorder(),
this.emit("reorder",this.bookmarks))})));this._dndHandlers.push(k(this._dndSource,"DndCancel",d.hitch(this,function(){this._customGenerateText&&(r.prototype._generateText=this._oldGenerateText,this._customGenerateText=!1)})));this._addInitialBookmarks()},destroy:function(){this.map=null;h.forEach(this._clickHandlers,function(a){l.disconnect(a)});h.forEach(this._mouseOverHandlers,function(a){l.disconnect(a)});h.forEach(this._mouseOutHandlers,function(a){l.disconnect(a)});h.forEach(this._removeHandlers,
function(a){l.disconnect(a)});h.forEach(this._editHandlers,function(a){l.disconnect(a)});n.destroy(this.bookmarkDomNode)},addBookmark:function(a){var b,e,f,k,h,r,q,u;"esri.dijit.BookmarkItem"===a.declaredClass?b=a:(e=new A(a.extent),b=new B({name:a.name,extent:e}));this.editable?(k=v.widgets.bookmarks,h=k.NLS_bookmark_edit,r=k.NLS_bookmark_remove,f=n.create("div",{innerHTML:'\x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d\'esriBookmarkLabel\'\x3e'+a.name+'\x3c/div\x3e\x3cdiv tabindex\x3d"0" role\x3d"button" title\x3d\''+
r+"' class\x3d'esriBookmarkRemoveImage'\x3e\x3cbr/\x3e\x3c/div\x3e\x3cdiv tabindex\x3d\"0\" role\x3d\"button\" title\x3d'"+h+"' class\x3d'esriBookmarkEditImage'\x3e\x3cbr/\x3e\x3c/div\x3e"}),q=m(".esriBookmarkEditImage",f)[0],u=m(".esriBookmarkRemoveImage",f)[0],this._removeHandlers.push(l.connect(u,t,this,"_removeBookmark")),this._editHandlers.push(l.connect(q,t,this,"_editBookmarkLabel"))):f=n.create("div",{innerHTML:"\x3cdiv tabindex\x3d\"0\" class\x3d'esriBookmarkLabel'\x3e"+a.name+"\x3c/div\x3e"});
c.add(f,this._css.esriBookmarkItem);"esri.geometry.Extent"===a.extent.declaredClass||new A(a.extent);e=m(".esriBookmarkLabel",f)[0];this._clickHandlers.push(l.connect(e,t,d.hitch(this,"_onClickHandler",a)));this._mouseOverHandlers.push(l.connect(f,"onmouseover",d.hitch(this,function(){c.add(f,this._css.esriBookmarkHighlight)})));this._mouseOutHandlers.push(l.connect(f,"onmouseout",d.hitch(this,function(){c.remove(f,this._css.esriBookmarkHighlight)})));this.bookmarks.push(b);this._dndSource.insertNodes(!1,
[f]);this._dndSourceNodes=this._dndSource.getAllNodes();g.scrollIntoView(f);this._syncBookmarksAfterReorder()},removeBookmark:function(a){this._inputBox&&this._inputBox.blur();var b;b=m(".esriBookmarkLabel",this.bookmarkDomNode);b=h.filter(b,function(b){return b.innerHTML===a});h.forEach(b,function(a){a.parentNode.parentNode.parentNode.removeChild(a.parentNode.parentNode)});for(b=this.bookmarks.length-1;0<=b;b--)this.bookmarks[b].name===a&&this.bookmarks.splice(b,1);this.onRemove()},hide:function(){y.hide(this.bookmarkDomNode)},
show:function(){y.show(this.bookmarkDomNode)},_addInitialBookmarks:function(){if(this.editable){var a=n.create("div",{tabIndex:0,role:"button",innerHTML:"\x3cdiv\x3e"+v.widgets.bookmarks.NLS_add_bookmark+"\x3c/div\x3e"});c.add(a,this._css.esriBookmarkItem);c.add(a,this._css.esriAddBookmark);this._clickHandlers.push(l.connect(a,t,this,this._newBookmark));this._mouseOverHandlers.push(l.connect(a,"onmouseover",d.hitch(this,function(){c.add(a,this._css.esriBookmarkHighlight)})));this._mouseOutHandlers.push(l.connect(a,
"onmouseout",d.hitch(this,function(){c.remove(a,this._css.esriBookmarkHighlight)})));this.srcNodeRef.appendChild(a)}this.bookmarks=[];h.forEach(this.initBookmarks,function(a){this.addBookmark(a)},this)},_newBookmark:function(){var a,b,c,d,e,f,g,k,h=this.map,l=v.widgets.bookmarks.NLS_new_bookmark,n=h.extent;h.spatialReference._isWrappable()?(a=A.prototype._normalizeX(n.xmin,h.spatialReference._getInfo()).x,b=A.prototype._normalizeX(n.xmax,h.spatialReference._getInfo()).x,a>b?(g=h.spatialReference.isWebMercator(),
c=g?2.0037508342788905E7:180,d=g?-2.0037508342788905E7:-180,Math.abs(a-c)>Math.abs(b-d)?(e=a,f=c):(e=d,f=b),k=new A(e,n.ymin,f,n.ymax,h.spatialReference)):k=new A(a,n.ymin,b,n.ymax,h.spatialReference)):k=n;a=new B({name:l,extent:k});this.addBookmark(a);a=m(".esriBookmarkItem",this.bookmarkDomNode);b=a[a.length-1];a={target:{parentNode:null}};a.target.parentNode=b;this._editBookmarkLabel(a)},_removeBookmark:function(a){a.target.parentNode.parentNode.parentNode.removeChild(a.target.parentNode.parentNode);
this.removeBookmark(a.target.parentNode.textContent)},_syncBookmarksAfterReorder:function(){var a=[],b=this._dndSource.getAllNodes();h.forEach(b,d.hitch(this,function(b){var c=this._dndSourceNodes.map(function(a,c){return a===b?c:void 0}).filter(isFinite)[0];a.push(this.bookmarks[c])}));this.bookmarks=a;this._dndSourceNodes=b},_generateText:function(){return this._dndSource&&this._dndSource.getSelectedNodes()[0]&&this._dndSource.getSelectedNodes()[0].firstChild.firstChild.innerHTML?this._dndSource.getSelectedNodes()[0].firstChild.firstChild.innerHTML:
""},_editBookmarkLabel:function(a){this._inputBox&&this._inputBox.blur();var b;b=v.widgets.bookmarks.NLS_new_bookmark;a=a.target.parentNode;var c=a.firstChild||m(".esriBookmarkLabel",a)[0],e=q.position(a,!0),g=e.y;this._label=c;this._inputBox=n.create("input",{className:"esriBookmarkEditBox",value:c.innerHTML!==b?c.textContent:"",style:{top:g+"px",left:this._LTR?e.x+"px":"0px"}},this.srcNodeRef);k(this._inputBox,"keyup",d.hitch(this,function(a){switch(a.keyCode){case f.ENTER:this._inputBox.blur()}}));
k(this._inputBox,"blur",d.hitch(this,this._finishEdit));this._inputBox.focus();this._inputBox.select();b=q.position(a,!0);this._inputBox.style.left=this._LTR?b.x+"px":"0px";this._inputBox.style.top=b.y+"px"},_finishEdit:function(){if(this._inputBox){var a=v.widgets.bookmarks.NLS_new_bookmark,b=m(".esriBookmarkLabel",this.bookmarkDomNode),c=this._inputBox.value;if(c===this._label.innerHTML)return this._inputBox.parentNode.removeChild(this._inputBox),void(this._inputBox=null);this._label.textContent=
""!==c?c:a;h.forEach(this.bookmarks,function(a,c){a&&b[c]&&(a.name=b[c].innerHTML)});this._inputBox.parentNode.removeChild(this._inputBox);this._inputBox=null;this.onEdit()}},_avatarCreator:function(a,b){var d=n.create("div");return d.id=dojo.dnd.getUniqueId(),c.add(d,"dojoDndItem"),"avatar"!==b&&n.place(a,d),{node:d,data:a,type:"something"}},_onClickHandler:function(a){var b=a.extent;a.extent.declaredClass||(b=new A(a.extent));this.map.setExtent(b);this.onClick()},toJson:function(){var a=[];return h.forEach(this.bookmarks,
function(b){b&&a.push(b.toJson())}),a}});return b("extend-esri")&&d.setObject("dijit.Bookmarks",a,x),a})},"esri/dijit/BookmarkItem":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.dijit.BookmarkItem",constructor:function(a){this.name=a.name;this.extent=a.extent},toJson:function(){var a={},d=this.extent.toJson();return a.extent={spatialReference:d.spatialReference,xmax:d.xmax,xmin:d.xmin,ymax:d.ymax,ymin:d.ymin},a.name=
this.name,a}});return a("extend-esri")&&l.setObject("dijit.BookmarkItem",h,d),h})},"cmv/viewer/js/gis/dijit/Find":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/dom-construct dojo/_base/lang dojo/_base/array dojo/on dojo/keys dojo/dom-style dojo/store/Memory dgrid/OnDemandGrid dgrid/Selection dgrid/Keyboard dgrid/extensions/ColumnResizer esri/layers/GraphicsLayer esri/symbols/jsonUtils esri/graphicsUtils esri/tasks/FindTask esri/tasks/FindParameters esri/geometry/Extent dojo/text!./Find/templates/Find.html dojo/i18n!./Find/nls/resource dijit/form/Form dijit/form/DropDownButton dijit/TooltipDialog dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/form/CheckBox dijit/form/Button xstyle/css!./Find/css/Find.css".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B){return h([l,a,d],{widgetsInTemplate:!0,templateString:A,baseClass:"gis_AdvancedFindDijit",i18n:B,spatialReference:null,showOptionsButton:!1,zoomOptions:{select:!0,deselect:!1},defaultResultsSymbols:{point:{type:"esriSMS",style:"esriSMSCircle",size:25,color:[0,255,255,32],angle:0,xoffset:0,yoffset:0,outline:{type:"esriSLS",style:"esriSLSSolid",color:[0,255,255,255],width:2}},polyline:{type:"esriSLS",style:"esriSLSSolid",color:[0,255,255,255],
width:3},polygon:{type:"esriSFS",style:"esriSFSSolid",color:[0,255,255,32],outline:{type:"esriSLS",style:"esriSLSSolid",color:[0,255,255,255],width:3}}},defaultSelectionSymbols:{point:{type:"esriSMS",style:"esriSMSCircle",size:25,color:[4,156,219,32],angle:0,xoffset:0,yoffset:0,outline:{type:"esriSLS",style:"esriSLSSolid",color:[4,156,219,255],width:2}},polyline:{type:"esriSLS",style:"esriSLSSolid",color:[4,156,219,255],width:3},polygon:{type:"esriSFS",style:"esriSFSSolid",color:[4,156,219,32],outline:{type:"esriSLS",
style:"esriSLSSolid",color:[4,156,219,255],width:3}}},postCreate:function(){this.inherited(arguments);this.showOptionsButton&&e.set(this.optionsDropDownDijit.domNode,"display","inline-block");this.initializeGlobalVariables();this.addKeyUpHandlerToSearchInput();this.initializeQueries();this.updateSearchPrompt()},initializeGlobalVariables:function(){this.queryIdx=0;this.currentQueryEventHandlers=[];this.gridColumns=null;this.selectionMode||(this.selectionMode="single");this.zoomExtentFactor||(this.zoomExtentFactor=
1.5);this.spatialReference||(this.spatialReference=this.map.spatialReference.wkid);this.pointExtentSize||(this.pointExtentSize=4326===this.spatialReference?1E-4:25)},addKeyUpHandlerToSearchInput:function(){this.own(m(this.searchTextDijit,"keyup",f.hitch(this,function(a){a.keyCode===g.ENTER&&this.search()})))},initializeQueries:function(){for(var a=0,b=this.queries.length,a=0;a<b;a++)this.queries[a].id=a;this.querySelectDom.style.display="none";1<b&&(a=new c({data:this.queries}),this.querySelectDijit.set("store",
a),this.querySelectDijit.set("value",this.queryIdx),this.querySelectDom.style.display="block")},search:function(){this.userInputIsInvalid()?this.displayInvalidUserInputMessage():this.queryConfigurationIsInvalid()?this.displayInvalidQueryConfigurationMessage():(this.createOrResetResultsGrid(),this.displayFindMessage(this.i18n.searching),this.executeFindTask())},executeFindTask:function(){var a=this.getQueryInput().query.url,b=this.getFindParams();(new x(a)).execute(b,f.hitch(this,this.showResults))},
getQueryInput:function(){return{query:this.queries[this.queryIdx]||{},searchText:this.searchTextDijit.get("value")}},queryConfigurationIsInvalid:function(){var a=this.getQueryInput().query;return a.url&&a.searchFields&&a.layerIds?!1:!0},userInputIsInvalid:function(){return 0===this.getQueryInput().searchText.length||this.userInputLessThanMinLength()?!0:!1},userInputLessThanMinLength:function(){var a=this.getQueryInput();return a.query.minChars&&a.searchText.length<a.query.minChars?!0:!1},displayInvalidQueryConfigurationMessage:function(){this.displayFindMessage("There is a problem with the query configuration.")},
displayInvalidUserInputMessage:function(){var a=this.getQueryInput().query.minChars;this.displayFindMessage("You must enter at least "+a+" characters.")},displayFindMessage:function(a){b.empty(this.findResultsNode);this.findResultsNode.innerHTML=a;this.findResultsNode.style.display="block"},getFindParams:function(){var a=this.getQueryInput(),b=new y;b.returnGeometry=!0;b.layerIds=a.query.layerIds;b.searchFields=a.query.searchFields;b.layerDefinitions=a.query.layerDefs;b.searchText=a.searchText;b.contains=
!this.containsSearchText.checked;b.outSpatialReference={wkid:this.spatialReference};return b},createOrResetResultsGrid:function(){this.resultsGrid||(this.createResultsStore(),this.createResultsGrid(),this.attachStandardEventHandlersToResultsGrid());this.clearResultsGrid();this.clearFeatures();this.resetResultsGridColumns();this.resetResultsGridSort();this.resetGridSelectionMode();this.attachCustomEventHandlersToResultsGrid()},createResultsStore:function(){this.resultsStore||(this.resultsStore=new c({idProperty:"id",
data:[]}))},createResultsGrid:function(){this.resultsGrid=new (h([n,r,q,u]))({selectionMode:this.selectionMode,cellNavigation:!1,showHeader:!0,store:this.resultsStore},this.findResultsGrid);this.resultsGrid.startup()},resetResultsGridColumns:function(){if(this.resultsGrid){var a=this.queries[this.queryIdx].gridColumns||{layerName:"Layer",foundFieldName:"Field",value:"Result"};a instanceof Array&&(a=k.filter(a,function(a){"undefined"===typeof a.visible&&(a.visible=!0);return a.visible}));this.resultsGrid.setColumns(a)}},
resetResultsGridSort:function(){this.resultsGrid&&this.resultsGrid.set("sort",this.queries[this.queryIdx].sort||[{attribute:"value",descending:!1}])},resetGridSelectionMode:function(){this.resultsGrid&&this.resultsGrid.set("selectionMode",this.queries[this.queryIdx].selectionMode||this.selectionMode)},attachStandardEventHandlersToResultsGrid:function(){this.resultsGrid&&(this.own(this.resultsGrid.on("dgrid-select",f.hitch(this,"onResultsGridSelect"))),this.own(this.resultsGrid.on("dgrid-deselect",
f.hitch(this,"onResultsGridDeselect"))),this.own(this.resultsGrid.on(".dgrid-row:dblclick",f.hitch(this,"onResultsGridRowClick"))))},attachCustomEventHandlersToResultsGrid:function(){if(this.resultsGrid){k.forEach(this.currentQueryEventHandlers,function(a){a.handle.remove()});var a=this.queries[this.queryIdx].customGridEventHandlers||[];k.forEach(a,f.hitch(this,function(a){a.handle=this.resultsGrid.on(a.event,f.hitch(this,a.handler))}));this.currentQueryEventHandlers=a}},showResults:function(a){var b=
this.i18n.noResultsLabel;this.results=a;0<this.results.length&&(b=this.results.length+" "+this.i18n.resultsLabel.labelPrefix+(1===this.results.length?"":this.i18n.resultsLabel.multipleResultsSuffix)+" "+this.i18n.resultsLabel.labelSuffix,this.createGraphicsLayerAndSymbols(),this.parseGridColumnProperties(),this.addResultsToGraphicsLayer(),this.zoomToGraphics(this.graphicsLayer.graphics),this.showResultsGrid());this.displayFindMessage(b)},createGraphicsLayerAndSymbols:function(){this.graphicsLayer||
(this.graphicsLayer=this.createGraphicsLayer());this.graphicsSymbols||(this.graphicsSymbols=this.createGraphicsSymbols())},createGraphicsLayer:function(){var a=new v({id:this.id+"_findGraphics",title:"Find"});a.on("click",f.hitch(this,"onGraphicsLayerClick"));this.map.addLayer(a);return a},onGraphicsLayerClick:function(a){var b=this.zoomOptions.select;this.zoomOptions.select=!1;a=this.resultsGrid.row(a.graphic.storeid);this.resultsGrid.select(a);this.resultsGrid.focus(a.element);a.element.focus();
this.zoomOptions.select=b},createGraphicsSymbols:function(){var a={},b;b=f.mixin(this.defaultResultsSymbols,this.resultsSymbols||{});a.resultsSymbols={};a.resultsSymbols.point=t.fromJson(b.point);a.resultsSymbols.polyline=t.fromJson(b.polyline);a.resultsSymbols.polygon=t.fromJson(b.polygon);b=f.mixin(this.defaultSelectionSymbols,this.selectionSymbols||{});a.selectionSymbols={};a.selectionSymbols.point=t.fromJson(b.point);a.selectionSymbols.polyline=t.fromJson(b.polyline);a.selectionSymbols.polygon=
t.fromJson(b.polygon);return a},parseGridColumnProperties:function(){this.queries[this.queryIdx].gridColumns&&k.forEach(this.results,function(a){k.forEach(this.queries[this.queryIdx].gridColumns,function(b){function c(a,b){return a.field&&!b.hasOwnProperty(a.field)&&a.get?!0:!1}(function(b,c){return b.field&&!a.hasOwnProperty(b.field)&&c.feature.attributes.hasOwnProperty(b.field)?!0:!1})(b,this)?this[b.field]=this.feature.attributes[b.field]:c(b,this)&&(this[b.field]=b.get(this))},a)},this)},addResultsToGraphicsLayer:function(){var a=
0;k.forEach(this.results,function(b){b.id=a;b.feature.storeid=b.id;a++;this.setGraphicSymbol(b.feature,!1);this.graphicsLayer.add(b.feature)},this)},showResultsGrid:function(){var a=this.getQueryInput();this.resultsGrid.store.setData(this.results);this.resultsGrid.refresh();var b="block";1===a.query.layerIds.length&&(b="none");this.resultsGrid.styleColumn("layerName","display:"+b);a.query&&!0!==a.query.hideGrid&&(this.findResultsGrid.style.display="block")},onResultsGridSelect:function(a){k.forEach(a.rows,
f.hitch(this,function(a){a=a.data.feature;this.setGraphicSymbol(a,!0);a&&a.getDojoShape()&&a.getDojoShape().moveToFront()}));this.graphicsLayer.redraw();this.zoomOptions.select&&this.zoomToSelectedGraphics()},onResultsGridDeselect:function(a){k.forEach(a.rows,f.hitch(this,function(a){this.setGraphicSymbol(a.data.feature,!1)}));this.graphicsLayer.redraw();this.zoomOptions.deselect&&this.zoomToSelectedGraphics()},onResultsGridRowClick:function(a){var b=this.resultsGrid.row(a),c=b.data.feature;setTimeout(f.hitch(this,
function(){this.resultsGrid.selection.hasOwnProperty(b.id)&&this.zoomToGraphics([c])}),100)},setGraphicSymbol:function(a,b){a.setSymbol(b?this.graphicsSymbols.selectionSymbols[a.geometry.type]:this.graphicsSymbols.resultsSymbols[a.geometry.type])},zoomToSelectedGraphics:function(){var a=[],b=this.resultsGrid.selection,c;for(c in b)b.hasOwnProperty(c)&&a.push(this.resultsGrid.row(c).data.feature);0!==a.length&&this.zoomToGraphics(a)},zoomToGraphics:function(a){var b=null;1<a.length?b=w.graphicsExtent(a):
1===a.length&&(b=this.getExtentFromGraphic(a[0]));b&&this.setMapExtent(b)},getExtentFromGraphic:function(a){var b=null;switch(a.geometry.type){case "point":b=this.getExtentFromPoint(a);break;default:b=w.graphicsExtent([a])}return b},getExtentFromPoint:function(a){var b=this.pointExtentSize;a=a.geometry;return new z({xmin:a.x-b,ymin:a.y-b,xmax:a.x+b,ymax:a.y+b,spatialReference:{wkid:this.spatialReference}})},setMapExtent:function(a){this.map.setExtent(a.expand(this.zoomExtentFactor))},clearResults:function(){this.results=
null;this.clearResultsGrid();this.clearFeatures();this.searchFormDijit.reset();this.querySelectDijit.setValue(this.queryIdx);b.empty(this.findResultsNode)},clearResultsGrid:function(){this.resultStore&&this.resultsStore.setData([]);this.resultsGrid&&this.resultsGrid.refresh();this.findResultsNode.style.display="none";this.findResultsGrid.style.display="none"},clearFeatures:function(){this.graphicsLayer&&this.graphicsLayer.clear()},_onQueryChange:function(a){0<=a&&a<this.queries.length&&(this.queryIdx=
a,this.updateSearchPrompt())},updateSearchPrompt:function(){this.searchTextDijit.set("placeholder",this.queries[this.queryIdx].prompt||B.searchText.placeholder);this.searchTextDijit.set("value",null)},onZoomOptionsSelectChange:function(a){this.zoomOptions.select=a},onZoomOptionsDeselectChange:function(a){this.zoomOptions.deselect=a}})})},"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(h,l,a){return h("dgrid.OnDemandGrid",[l,a],{})})},"dgrid/Grid":function(){define("dojo/_base/kernel dojo/_base/declare dojo/on dojo/has put-selector/put ./List ./util/misc dojo/_base/sniff".split(" "),
function(h,l,a,d,b,f,k){function m(a,b){b&&b.nodeType&&a.appendChild(b)}function g(a,b,d,e){if(this.formatter){e=this.formatter;var f=this.grid.formatterScope;d.innerHTML="string"===typeof e&&f?f[e](b,a):this.formatter(b,a)}else null!=b&&d.appendChild(document.createTextNode(b))}var e=8>d("ie")&&!d("quirks");l=l("dgrid.Grid",f,{columns:null,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(a){return"object"!=typeof a?this.columns[a]:this.cell(a).column},listType:"grid",cell:function(a,
b){if(a.column&&a.element)return a;a.target&&a.target.nodeType&&(a=a.target);var d;if(a.nodeType){do{if(this._rowIdToObject[a.id])break;var e=a.columnId;if(e){b=e;d=a;break}a=a.parentNode}while(a&&a!=this.domNode)}if(!d&&"undefined"!=typeof b){var f=this.row(a);if(e=f&&f.element)for(var e=e.getElementsByTagName("td"),g=0;g<e.length;g++)if(e[g].columnId==b){d=e[g];break}}if(null!=a)return{row:f||this.row(a),column:b&&this.column(b),element:d}},createRowCells:function(a,f,g,h){var m=b("table.dgrid-row-table[role\x3dpresentation]"),
l=9>d("ie")||d("quirks")?b(m,"tbody"):m,t,w,x,y,z,A,B,C,D,E;g=g||this.subRows;w=0;for(x=g.length;w<x;w++)for(A=g[w],t=b(l,"tr"),A.className&&b(t,"."+A.className),y=0,z=A.length;y<z;y++){B=A[y];C=B.id;D=B.field?".field-"+k.escapeCssIdentifier(B.field,"-"):"";(E="function"===typeof B.className?B.className(h):B.className)&&(D+="."+E);D=b(a+(".dgrid-cell.dgrid-cell-padding"+(C?".dgrid-column-"+k.escapeCssIdentifier(C,"-"):"")+D.replace(/ +/g,"."))+"[role\x3d"+("th"===a?"columnheader":"gridcell")+"]");
D.columnId=C;e?(C=b(D,"!dgrid-cell-padding div.dgrid-cell-padding"),D.contents=C):C=D;if(E=B.colSpan)D.colSpan=E;if(E=B.rowSpan)D.rowSpan=E;f(C,B);t.appendChild(D)}return m},left:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,-(b||1),"dgrid-cell"))},right:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,b||1,"dgrid-cell"))},renderRow:function(a,d){var e=this.createRowCells("td",function(b,e){var f=a;e.get?f=e.get(a):"field"in e&&"_item"!=e.field&&(f=
f[e.field]);e.renderCell?m(b,e.renderCell(a,f,b,d)):g.call(e,a,f,b,d)},d&&d.subRows,a);return b("div[role\x3drow]\x3e",e)},renderHeader:function(){var c=this,f=this.headerNode,g=f.childNodes.length;for(f.setAttribute("role","row");g--;)b(f.childNodes[g],"!");g=this.createRowCells("th",function(a,b){var c=b.headerNode=a;e&&(a=a.parentNode);var d=b.field;d&&(a.field=d);b.renderHeaderCell?m(c,b.renderHeaderCell(c)):("label"in b||b.field)&&c.appendChild(document.createTextNode("label"in b?b.label:b.field));
!1!==b.sortable&&d&&"_item"!=d&&(a.sortable=!0,a.className+=" dgrid-sortable")},this.subRows&&this.subRows.headerRows);this._rowIdToObject[g.id=this.id+"-header"]=this.columns;f.appendChild(g);this._sortListener&&this._sortListener.remove();this._sortListener=a(g,"click,keydown",function(b){if("click"==b.type||32==b.keyCode||!d("opera")&&13==b.keyCode){var e=b.target,g,k,h;do if(e.sortable){h=[{attribute:g=e.field||e.columnId,descending:(k=c._sort[0])&&k.attribute==g&&!k.descending}];g={bubbles:!0,
cancelable:!0,grid:c,parentType:b.type,sort:h};a.emit(b.target,"dgrid-sort",g)&&(c._sortNode=e,c.set("sort",h));break}while((e=e.parentNode)&&e!=f)}})},resize:function(){var a=this.headerNode.firstChild,b=this.contentNode,e;this.inherited(arguments);if(!d("ie")||7<d("ie")&&!d("quirks"))b.style.width="",b&&a&&(e=a.offsetWidth)!=b.offsetWidth&&(b.style.width=e+"px")},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();this.inherited(arguments)},_setSort:function(a,
b){this.inherited(arguments);this.updateSortArrow(this._sort)},_findSortArrowParent:function(a){var b=this.columns,d;for(d in b){var e=b[d];if(e.field==a)return e.headerNode}},updateSortArrow:function(a,d){this._lastSortedArrow&&(b(this._lastSortedArrow,"\x3c!dgrid-sort-up!dgrid-sort-down"),b(this._lastSortedArrow,"!"),delete this._lastSortedArrow);d&&(this._sort=a);if(a[0]){var e=a[0].attribute,f=a[0].descending,e=this._sortNode||this._findSortArrowParent(e),g;delete this._sortNode;e&&(e=e.contents||
e,g=this._lastSortedArrow=b("div.dgrid-sort-arrow.ui-icon[role\x3dpresentation]"),g.innerHTML="\x26nbsp;",e.insertBefore(g,e.firstChild),b(e,f?".dgrid-sort-down":".dgrid-sort-up"),this.resize())}},styleColumn:function(a,b){return this.addCssRule("#"+k.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+k.escapeCssIdentifier(a,"-"),b)},_configColumns:function(a,b){var d=[],e=b instanceof Array;k.each(b,function(f,g){"string"==typeof f&&(b[g]=f={label:f});e||f.field||(f.field=g);g=f.id=f.id||(isNaN(g)?
g:a+g);this._configColumn&&(this._configColumn(f,g,b,a),g=f.id);e&&(this.columns[g]=f);f.grid=this;"function"===typeof f.init&&f.init();d.push(f)},this);return e?b:d},_destroyColumns:function(){var a=this.subRows,b=a&&a.length,d,e,f,g;this.cleanup();for(d=0;d<b;d++)for(e=0,g=a[d].length;e<g;e++)f=a[d][e],"function"===typeof f.destroy&&f.destroy()},configStructure:function(){var a=this.subRows,b=this._columns=this.columns;this.columns=!b||b instanceof Array?{}:b;if(a)for(b=0;b<a.length;b++)a[b]=this._configColumns(b+
"-",a[b]);else this.subRows=[this._configColumns("",b)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(a){this._destroyColumns();this.subRows=null;this.columns=a;this._updateColumns()},_setSubRows:function(a){this._destroyColumns();this.subRows=a;this._updateColumns()},setColumns:function(a){h.deprecated("setColumns(...)",'use set("columns", ...) instead',"dgrid 0.4");this.set("columns",a)},setSubRows:function(a){h.deprecated("setSubRows(...)",'use set("subRows", ...) instead',
"dgrid 0.4");this.set("subRows",a)},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this._sort&&this._sort.length?this.updateSortArrow(this._sort):this.resize())}});l.appendIfNode=m;l.defaultRenderCell=g;return l})},"dgrid/List":function(){define("dojo/_base/kernel dojo/_base/declare dojo/dom dojo/on dojo/has ./util/misc dojo/has!touch?./TouchScroll xstyle/has-class put-selector/put dojo/_base/sniff xstyle/css!./css/dgrid.css".split(" "),
function(h,l,a,d,b,f,k,m,g){function e(a,b){g(document.body,a,".dgrid-scrollbar-measure");var c=a["offset"+b]-a["client"+b];a.className="";document.body.removeChild(a);return c}function c(a){var b=a?"."+a.replace(w,"."):"";this._class&&(b="!"+this._class.replace(w,"!")+b);g(this.domNode,b);this._class=a}function n(){return this._class}function q(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}}function r(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&
(this.bodyNode.scrollTop=a.y)}m("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var u,v;b.add("dom-scrollbar-width",function(a,b,c){return e(c,"Width")});b.add("dom-scrollbar-height",function(a,b,c){return e(c,"Height")});b.add("dom-rtl-scrollbar-left",function(a,c,d){a=g("div");g(document.body,d,".dgrid-scrollbar-measure[dir\x3drtl]");g(d,a);c=!!b("ie")||!!b("trident")||a.offsetLeft>=b("dom-scrollbar-width");d.className="";document.body.removeChild(d);g(a,"!");d.removeAttribute("dir");
return c});var t=0,w=/ +/g,x=7>b("ie")&&!b("quirks")?function(){var a,b,c;this._started&&(a=document.documentElement,b=a.clientWidth,a=a.clientHeight,c=this._prevWinDims||[],c[0]!==b||c[1]!==a)&&(this.resize(),this._prevWinDims=[b,a])}:function(){this._started&&this.resize()};return l("dgrid.List",b("touch")?k:null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,useTouchScroll:null,addUiClasses:!0,shouldObserveStore:!0,cleanEmptyObservers:!0,highlightDuration:250,
postscript:function(a,b){var c=this;(this._Row=function(a,b,c){this.id=a;this.data=b;this.element=c}).prototype.remove=function(){c.removeRow(this.element)};b&&(this.srcNodeRef=b=b.nodeType?b:document.getElementById(b));this.create(a,b)},listType:"list",create:function(a,d){var e=this.domNode=d||g("div"),f;a?(this.params=a,l.safeMixin(this,a),f=a["class"]||a.className||e.className,this._sort=a.sort||[],delete this.sort):this._sort=[];this.observers=[];this._numObservers=0;this._listeners=[];this._rowIdToObject=
{};this.postMixInProperties&&this.postMixInProperties();this.id=e.id=e.id||this.id||"dgrid_"+t++;null===this.useTouchScroll&&(this.useTouchScroll=!b("dom-scrollbar-width"));this.buildRendering();f&&c.call(this,f);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&this.startup()},buildRendering:function(){var a=this.domNode,c=this.addUiClasses,e=this,k,h,m,l;l=this.isRTL="rtl"==(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();a.className=
"";g(a,"[role\x3dgrid].dgrid.dgrid-"+this.listType+(c?".ui-widget":""));k=this.headerNode=g(a,"div.dgrid-header.dgrid-header-row"+(c?".ui-widget-header":"")+(this.showHeader?"":".dgrid-header-hidden"));(b("quirks")||8>b("ie"))&&g(a,"div.dgrid-spacer");h=this.bodyNode=g(a,"div.dgrid-scroller");b("ff")&&(h.tabIndex=-1);this.headerScrollNode=g(a,"div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width"+(c?".ui-widget-header":""));m=this.footerNode=g("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));
g(a,m);l&&(a.className+=" dgrid-rtl"+(b("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));d(h,"scroll",function(b){e.showHeader&&(k.scrollLeft=b.scrollLeft||h.scrollLeft);b.stopPropagation();d.emit(a,"scroll",{scrollTarget:h})});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=g(this.bodyNode,"div.dgrid-content"+(c?".ui-widget-content":""));this._listeners.push(this._resizeHandle=d(window,"resize",f.throttleDelayed(x,this)))},postCreate:b("touch")?function(){this.useTouchScroll&&
this.inherited(arguments)}:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this._sort))},configStructure:function(){},resize:function(){var a=this.bodyNode,c=this.headerNode,d=this.footerNode,e=c.offsetHeight,g=this.showFooter?d.offsetHeight:0,k=b("quirks")||7>b("ie");this.headerScrollNode.style.height=a.style.marginTop=e+"px";a.style.marginBottom=g+"px";k&&(a.style.height="",a.style.height=Math.max(this.domNode.offsetHeight-
e-g,0)+"px",g&&(d.style.bottom="1px",setTimeout(function(){d.style.bottom=""},0)));u||(u=b("dom-scrollbar-width"),v=b("dom-scrollbar-height"),b("ie")&&(u++,v++),f.addCssRule(".dgrid-scrollbar-width","width: "+u+"px"),f.addCssRule(".dgrid-scrollbar-height","height: "+v+"px"),17==u||k||(f.addCssRule(".dgrid-header-row","right: "+u+"px"),f.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+u+"px")));k&&(c.style.width=a.clientWidth+"px",setTimeout(function(){c.scrollLeft=a.scrollLeft},0))},addCssRule:function(a,
b){var c=f.addCssRule(a,b);this.cleanAddedRules&&this._listeners.push(c);return c},on:function(a,c){var e=d(this.domNode,a,c);b("dom-addeventlistener")||this._listeners.push(e);return e},cleanup:function(){var a=this.observers,b;for(b in this._rowIdToObject)if(this._rowIdToObject[b]!=this.columns){var c=document.getElementById(b);c&&this.removeRow(c,!0)}for(b=0;b<a.length;b++)(c=a[b])&&c.cancel();this.observers=[];this._numObservers=0;this.preload=null},destroy:function(){if(this._listeners){for(var a=
this._listeners.length;a--;)this._listeners[a].remove();delete this._listeners}this._started=!1;this.cleanup();g(this.domNode,"!");this.useTouchScroll&&this.inherited(arguments)},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";this.scrollTo({x:0,y:0})},newRow:function(a,b,c,d,e){if(b){var f=this.insertRow(a,b,c,d,e);g(f,".dgrid-highlight"+(this.addUiClasses?".ui-state-highlight":""));setTimeout(function(){g(f,"!dgrid-highlight!ui-state-highlight")},
this.highlightDuration);return f}},adjustRowIndices:function(a){var b=a.rowIndex;if(-1<b){do-1<a.rowIndex&&(this.maintainOddEven&&-1<(a.className+" ").indexOf("dgrid-row ")&&g(a,"."+(1==b%2?"dgrid-row-odd":"dgrid-row-even")+"!"+(0==b%2?"dgrid-row-odd":"dgrid-row-even")),a.rowIndex=b++);while((a=a.nextSibling)&&a.rowIndex!=b)}},renderArray:function(b,c,d){function e(){var a=arguments;if(-1<q)for(var c=0;c<a.length;c++){var g=a[c],k=n[g?0:n.length-1];if(k=k&&f(k)){var m=k[g?"previousSibling":"nextSibling"];
m&&(m=h.row(m));m&&m.element!=k&&(g=g?"unshift":"push",b[g](m.data),n[g](m.element),d.count++)}}}function f(b){return!a.isDescendant(b,h.domNode)&&document.getElementById(b.id)?h.row(b.id.slice(h.id.length+5)).element:b}function g(a){v=h.insertRow(a,u,null,m++,d);v.observerIndex=q;return v}function k(a){w=a.slice(0);(r=c?c.parentNode:h.contentNode)&&r.parentNode&&(r!==h.contentNode||a.length)?(r.insertBefore(u,c||null),(v=a[a.length-1])&&h.adjustRowIndices(v)):l[q]&&h.cleanEmptyObservers&&"undefined"!==
typeof q&&(l[q].cancel(),l[q]=0,h._numObservers--);n=a;t&&(t.rows=n)}d=d||{};var h=this,m=d.start||0,l=this.observers,n,r,q;c||(this._lastCollection=b);if(b.observe&&this.shouldObserveStore){h._numObservers++;var t=b.observe(function(a,g,k){var m,l,t;-1<g&&n[g]&&(m=n.splice(g,1)[0],m.parentNode==r&&((l=m.nextSibling)&&g!=k&&l.rowIndex--,h.removeRow(m)),d.count--,h._processScroll&&h._processScroll());if(-1<k){if(n.length)if(0===k)t=(t=n[k])&&f(t);else{if(t=n[k-1])t=f(t),t=(t.connected||t).nextSibling}else t=
h._getFirstRowSibling&&h._getFirstRowSibling(r);m&&t&&m.id===t.id&&(t=(t.connected||t).nextSibling);t&&!t.parentNode&&(t=document.getElementById(t.id));m=c&&c.parentNode||t&&t.parentNode||h.contentNode;if(m=h.newRow(a,m,t,d.start+k,d))if(m.observerIndex=q,n.splice(k,0,m),!l||k<g)l=(l=m.previousSibling)&&l.rowIndex+1!=m.rowIndex&&0!=m.rowIndex?l:m;d.count++}0===g?e(1,1):g===b.length-(-1===k?0:1)&&e(0,0);g!=k&&l&&h.adjustRowIndices(l);h._onNotification(n,a,g,k)},!0);q=l.push(t)-1}var u=document.createDocumentFragment(),
v,w;if(b.map){if(n=b.map(g,console.error),n.then)return b.then(function(a){b=a;return n.then(function(a){k(a);e(1,1,0,0);return w})})}else{n=[];for(var x=0,T=b.length;x<T;x++)n[x]=g(b[x])}k(n);e(1,1,0,0);return w},_onNotification:function(a,b,c,d){},renderHeader:function(){},_autoId:0,insertRow:function(a,b,c,d,e){var f=e.parentId,f=this.id+"-row-"+(f?f+"-":"")+(this.store&&this.store.getIdentity?this.store.getIdentity(a):this._autoId++),g=document.getElementById(f),k=g&&g.previousSibling;g&&(g===
c&&(c=(c.connected||c).nextSibling),this.removeRow(g));g=this.renderRow(a,e);g.className=(g.className||"")+" dgrid-row "+(1==d%2?"dgrid-row-odd":"dgrid-row-even")+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[g.id=f]=a;b.insertBefore(g,c||null);k&&this.adjustRowIndices(k);g.rowIndex=d;return g},renderRow:function(a,b){return g("div",""+a)},removeRow:function(a,b){a=a.element||a;delete this._rowIdToObject[a.id];b||g(a,"!")},row:function(a){var b;if(a instanceof this._Row)return a;
a.target&&a.target.nodeType&&(a=a.target);if(a.nodeType){do{var c=a.id;if(b=this._rowIdToObject[c])return new this._Row(c.substring(this.id.length+5),b,a);a=a.parentNode}while(a&&a!=this.domNode)}else return"object"==typeof a?b=this.store.getIdentity(a):(b=a,a=this._rowIdToObject[this.id+"-row-"+b]),new this._Row(b,a,document.getElementById(this.id+"-row-"+b))},cell:function(a){return{row:this.row(a)}},_move:function(a,b,c,d){var e,f;f=e=a.element;b=b||1;do if(a=e[0>b?"previousSibling":"nextSibling"]){do if((e=
a)&&-1<(e.className+" ").indexOf(c+" ")){f=e;b+=0>b?1:-1;break}while(a=(!d||!e.hidden)&&e[0>b?"lastChild":"firstChild"])}else if(e=e.parentNode,!e||e===this.bodyNode||e===this.headerNode)break;while(b);return f},up:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,-(b||1),"dgrid-row",c))},down:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,b||1,"dgrid-row",c))},scrollTo:b("touch")?function(a){return this.useTouchScroll?this.inherited(arguments):r.call(this,
a)}:r,getScrollPosition:b("touch")?function(){return this.useTouchScroll?this.inherited(arguments):q.call(this)}:q,get:function(a){var b="_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,1)):this[a]},set:function(a,b){if("object"===typeof a)for(var c in a)this.set(c,a[c]);else c="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[c]?this[c].apply(this,[].slice.call(arguments,1)):this[a]=b;return this},_getClass:n,
_setClass:c,_getClassName:n,_setClassName:c,_setSort:function(a,b){this._sort="string"!=typeof a?a:[{attribute:a,descending:b}];this.refresh();this._lastCollection&&(a.length&&("string"!=typeof a&&(b=a[0].descending,a=a[0].attribute),this._lastCollection.sort(function(c,d){var e=c[a],f=d[a];void 0===e&&(e="");void 0===f&&(f="");return e==f?0:e>f==!b?1:-1})),this.renderArray(this._lastCollection))},sort:function(a,b){h.deprecated("sort(...)",'use set("sort", ...) instead',"dgrid 0.4");this.set("sort",
a,b)},_getSort:function(){return this._sort},_setShowHeader:function(a){var b=this.headerNode;this.showHeader=a;g(b,(a?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();a&&(b.scrollLeft=this.getScrollPosition().x)},setShowHeader:function(a){h.deprecated("setShowHeader(...)",'use set("showHeader", ...) instead',"dgrid 0.4");this.set("showHeader",a)},_setShowFooter:function(a){this.showFooter=a;g(this.footerNode,(a?"!":".")+"dgrid-footer-hidden");this.resize()}})})},"dgrid/util/misc":function(){define(["dojo/has",
"put-selector/put"],function(h,l){h.add("dom-contains",function(a,b,c){return!!c.contains});var a=[],d,b,f,k=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,m={defaultDelay:15,throttle:function(a,b,c){var d=!1;c=c||m.defaultDelay;return function(){d||(d=!0,a.apply(b,arguments),setTimeout(function(){d=!1},c))}},throttleDelayed:function(a,b,c){var d=!1;c=c||m.defaultDelay;return function(){if(!d){d=!0;var f=arguments;setTimeout(function(){d=!1;a.apply(b,f)},c)}}},debounce:function(a,b,c){var d;c=c||m.defaultDelay;
return function(){d&&(clearTimeout(d),d=null);var f=arguments;d=setTimeout(function(){a.apply(b,f)},c)}},each:function(a,b,c){var d,f;if(a)if("number"===typeof a.length)for(d=0,f=a.length;d<f;d++)b.call(c,a[d],d,a);else for(d in a)b.call(c,a[d],d,a)},contains:function(a,b){return h("dom-contains")?a.contains(b):a.compareDocumentPosition(b)&8},addCssRule:function(g,e){d||(d=l(document.getElementsByTagName("head")[0],"style"),d=d.sheet||d.styleSheet,b=d.deleteRule?"deleteRule":"removeRule",f=d.cssRules?
"cssRules":"rules");var c=a.length;a[c]=(d.cssRules||d.rules).length;d.addRule?d.addRule(g,e):d.insertRule(g+"{"+e+"}",a[c]);return{get:function(b){return d[f][a[c]].style[b]},set:function(b,e){"undefined"!==typeof a[c]&&(d[f][a[c]].style[b]=e)},remove:function(){var e=a[c],f,g;if(void 0!==e)for(d[b](e),a[c]=void 0,f=c+1,g=a.length;f<g;f++)a[f]>e&&a[f]--}}},escapeCssIdentifier:function(a,b){return"string"===typeof a?a.replace(k,b||"\\$1"):a}};return m})},"xstyle/has-class":function(){define(["dojo/has"],
function(h){var l={};return function(){for(var a,d=arguments,b=0;b<d.length;b++)if(a=d[b],!l[a]){l[a]=!0;var f=a.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/),k=h(f[2]),m=-f[4];(0<m?m<=k&&(-f[5]||m)>=k:!!k)==!f[1]&&(document.documentElement.className+=" has-"+a)}}})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/dom dojo/on ./util/misc put-selector/put".split(" "),function(h,l,a,d,b,f,k,m,g){return a("dgrid.OnDemandList",
[h,l],{minRowsPerPage:25,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:m.defaultDelay,keepScrollPosition:!1,rowHeight:22,postCreate:function(){this.inherited(arguments);var a=this;k(this.bodyNode,"scroll",m[this.pagingMethod](function(b){a._processScroll(b)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(a,c){function f(a){g(y,
"!");if(a)throw k._refreshDeferred&&(k._refreshDeferred.reject(a),delete k._refreshDeferred),a;}var k=this,h=c&&c.container||this.contentNode,m={query:a,count:0,options:c},l,t=this.preload,w,x={node:g(h,"div.dgrid-preload",{rowIndex:0}),count:0,query:a,next:m,options:c};x.node.style.height="0";m.node=l=g(h,"div.dgrid-preload");m.previous=x;l.rowIndex=this.minRowsPerPage;t?((m.next=t.next)&&l.offsetTop>=t.node.offsetTop?m.previous=t:(m.next=t,m.previous=t.previous),m.previous.next=m,m.next.previous=
m):this.preload=m;var y=g(l,"-div.dgrid-loading");g(y,"div.dgrid-below").innerHTML=this.loadingMessage;c=d.mixin(this.get("queryOptions"),c,{start:0,count:this.minRowsPerPage},"level"in a?{queryLevel:a.level}:null);this._trackError(function(){return w=a(c)});if("undefined"===typeof w)f();else return b.when(k.renderArray(w,l,c),function(a){return b.when("undefined"===typeof w.total?w.length:w.total,function(b){var d=a.length,e=l.parentNode,f=k.noDataNode;g(y,"!");"queryLevel"in c||(k._total=b);0===
b&&e&&(f&&(g(f,"!"),delete k.noDataNode),k.noDataNode=f=g("div.dgrid-no-data"),e.insertBefore(f,k._getFirstRowSibling(e)),f.innerHTML=k.noDataMessage);for(f=e=0;f<d;f++)e+=k._calcRowHeight(a[f]);d&&e&&(k.rowHeight=e/d);b-=d;m.count=b;l.rowIndex=d;b?l.style.height=Math.min(b*k.rowHeight,k.maxEmptySpace)+"px":(l.style.display="none",c.count++);k._previousScrollPosition&&(k.scrollTo(k._previousScrollPosition),delete k._previousScrollPosition);k._processScroll();k._refreshDeferred&&(k._refreshDeferred.resolve(w),
delete k._refreshDeferred);return a},f)},f),w},refresh:function(a){var c=this,d=a&&a.keepScrollPosition,f;"undefined"===typeof d&&(d=this.keepScrollPosition);d&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this.store)return d=this._refreshDeferred=new b,f=c.renderQuery(function(a){return c.store.query(c.query,a)}),"undefined"===typeof f&&d.reject(),d.then(function(a){c._refreshTimeout=setTimeout(function(){k.emit(c.domNode,"dgrid-refresh-complete",{bubbles:!0,
cancelable:!1,grid:c,results:a});c._refreshTimeout=null},0);delete c._refreshDeferred;return a},function(a){delete c._refreshDeferred;throw a;})},resize:function(){this.inherited(arguments);this._processScroll()},_getFirstRowSibling:function(a){return a.lastChild},_calcRowHeight:function(a){var b=a.nextSibling;return b&&!/\bdgrid-preload\b/.test(b.className)?b.offsetTop-a.offsetTop:a.offsetHeight},lastScrollTop:0,_processScroll:function(a){function c(a,b,c,d){var e=h.farOffRemoval,k=a.node;if(b>2*
e){for(var m,l=k[c],q=0,t=0,u=[];m=l;){var v=h._calcRowHeight(m);if(q+v+e>b||0>l.className.indexOf("dgrid-row")&&0>l.className.indexOf("dgrid-loading"))break;l=m[c];q+=v;t+=m.count||1;h.removeRow(m,!0);u.push(m)}a.count+=t;d?(k.rowIndex-=t,f(a)):k.style.height=k.offsetHeight+q+"px";var w=g("div",u);setTimeout(function(){g(w,"!")},1)}}function f(a,b){a.node.style.height=Math.min(a.count*h.rowHeight,b?Infinity:h.maxEmptySpace)+"px"}function k(a,b){do a=b?a.next:a.previous;while(a&&!a.node.offsetWidth);
return a}var h=this,m=h.bodyNode;a=a&&a.scrollTop||this.getScrollPosition().y;var m=m.offsetHeight+a,l,t,w=h.preload,x=h.lastScrollTop,y=h.bufferRows*h.rowHeight,z=y-h.rowHeight,A,B,C,D=!0;for(h.lastScrollTop=a;w&&!w.node.offsetWidth;)w=w.previous;for(;w&&w!=l;){l=h.preload;h.preload=w;t=w.node;var E=t.offsetTop;if(m+1+z<E)w=k(w,D=!1);else if(a-1-z>E+t.offsetHeight)w=k(w,D=!0);else{var F=((t.rowIndex?a-y:m)-E)/h.rowHeight,E=(m-a+2*y)/h.rowHeight,H=Math.max(Math.min((a-x)*h.rowHeight,h.maxRowsPerPage/
2),h.maxRowsPerPage/-2),E=E+Math.min(Math.abs(H),10);0==t.rowIndex&&(F-=E);F=Math.max(F,0);10>F&&0<F&&E+F<h.maxRowsPerPage&&(E+=Math.max(0,F),F=0);E=Math.min(Math.max(E,h.minRowsPerPage),h.maxRowsPerPage,w.count);if(0==E)w=k(w,D);else{var E=Math.ceil(E),F=Math.min(Math.floor(F),w.count-E),G=d.mixin(h.get("queryOptions"),w.options);w.count-=E;var K=t,J,I=h.queryRowsOverlap;if(H=(0<t.rowIndex||t.offsetTop>a)&&w){var L=w.previous;L&&(c(L,a-(L.node.offsetTop+L.node.offsetHeight),"nextSibling"),0<F&&L.node==
t.previousSibling?(F=Math.min(w.count,F),w.previous.count+=F,f(w.previous,!0),t.rowIndex+=F,I=0):E+=F,w.count-=F);G.start=t.rowIndex-I;G.count=Math.min(E+I,h.maxRowsPerPage);t.rowIndex=G.start+G.count}else w.next&&(c(w.next,w.next.node.offsetTop-m,"previousSibling",!0),K=t.nextSibling,K==w.next.node?(w.next.count+=w.count-F,w.next.node.rowIndex=F+E,f(w.next),w.count=F,I=0):J=!0),G.start=w.count,G.count=Math.min(E+I,h.maxRowsPerPage);J&&K&&K.offsetWidth&&(J=K.offsetTop);f(w);"level"in w.query&&(G.queryLevel=
w.query.level);if("queryLevel"in G||!(G.start>h._total||0>G.count)){t=g(K,"-div.dgrid-loading[style\x3dheight:"+E*h.rowHeight+"px]");g(t,"div.dgrid-"+(H?"below":"above")).innerHTML=h.loadingMessage;t.count=E;var M=w.query(G);if(void 0===h._trackError(function(){return M})){g(t,"!");return}(function(a,c,d,e){C=b.when(h.renderArray(e,a,G),function(k){B=e;K=a.nextSibling;g(a,"!");if(d&&K&&K.offsetWidth){var m=h.getScrollPosition();h.scrollTo({x:m.x,y:m.y+K.offsetTop-d,preserveMomentum:!0})}b.when(e.total||
e.length,function(a){"queryLevel"in G||(h._total=a);c&&(c.count=a-c.node.rowIndex,0===c.count&&G.count++,f(c))});h._processScroll();return k},function(b){g(a,"!");throw b;})}).call(this,t,H,J,M);w=w.previous}}}}C&&(A=this._refreshDeferred)&&(delete this._refreshDeferred,b.when(C,function(){A.resolve(B)}))},removeRow:function(a,b){if(a){var d=a.previousSibling,g=a.nextSibling,k;if(k=d)k=d.observerIndex,k=null!=k?k:d.previousObserverIndex;d=k;if(k=g)k=g.observerIndex,k=null!=k?k:g.nextObserverIndex;
g=a.observerIndex;a.observerIndex=void 0;b&&(a.nextObserverIndex=k,a.previousObserverIndex=d);if(this.cleanEmptyObservers&&-1<g&&g!==d&&g!==k&&(d=this.observers,k=d[g])){if(!b)for(var h=k.rows,m=0;m<h.length;m++)if(h[m]!=a&&f.isDescendant(h[m],this.domNode))return this.inherited(arguments);k.cancel();this._numObservers--;d[g]=0}}this.inherited(arguments)}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/aspect put-selector/put".split(" "),
function(h,l,a,d,b,f,k){function m(a){return a}function g(a){if("object"!==typeof a)a=Error(a);else if("cancel"===a.dojoType)return;a.grid=this;b.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,bubbles:!0})&&console.error(a)}return l("dgrid._StoreMixin",null,{store:null,query:null,queryOptions:null,getBeforePut:!0,noDataMessage:"",loadingMessage:"",constructor:function(){this.query={};this.queryOptions={};this.dirty={};this._updating={};this._columnsWithSet={};f.before(this,"configStructure",
a.hitch(this,function(){this._columnsWithSet={}}))},postCreate:function(){this.inherited(arguments);this.store&&this._updateNotifyHandle(this.store)},destroy:function(){this.inherited(arguments);this._notifyHandle&&this._notifyHandle.remove()},_configColumn:function(a){a.set&&(this._columnsWithSet[a.field]=a);this.inherited(arguments)},_updateNotifyHandle:function(b){this._notifyHandle&&(this._notifyHandle.remove(),delete this._notifyHandle);b&&"function"===typeof b.notify&&this.shouldObserveStore&&
(this._notifyHandle=f.after(b,"notify",a.hitch(this,"_onNotify"),!0),(b=this.get("sort"))&&b.length||console.warn("Observable store detected, but no sort order specified. You may experience quirks when adding/updating items.  These can be resolved by setting a sort order on the list or grid."))},_setStore:function(a,b,d){this._updateNotifyHandle(a);this.store=a;this.dirty={};this.set("query",b,d)},_setQuery:function(a,b){var d=b&&b.sort;this.query=void 0!==a?a:this.query;this.queryOptions=b||this.queryOptions;
this._started&&(d?this.set("sort",d):this.refresh())},setStore:function(a,b,d){h.deprecated("setStore(...)",'use set("store", ...) instead',"dgrid 0.4");this.set("store",a,b,d)},setQuery:function(a,b){h.deprecated("setQuery(...)",'use set("query", ...) instead',"dgrid 0.4");this.set("query",a,b)},_getQueryOptions:function(){var b=a.delegate(this.queryOptions,{});if("function"===typeof this._sort||this._sort.length)b.sort=this._sort;return b},_getQuery:function(){var b=this.query;return"object"==typeof b&&
null!=b?a.delegate(b,{}):b},_setSort:function(a,b){this.store&&(this._lastCollection=null);this.inherited(arguments)},_onNotify:function(a,b){this.inherited(arguments);a&&1>this._numObservers&&this.refresh({keepScrollPosition:!0})},refresh:function(){var a=this.inherited(arguments);this.store||(this.noDataNode=k(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return a},renderArray:function(){var a=this,b=this.inherited(arguments);this.store||d.when(b,function(b){b.length&&
a.noDataNode&&k(a.noDataNode,"!")});return b},insertRow:function(b,c,d,f,g){var k=this.store,h=this.dirty,k=k&&k.getIdentity(b),m;k in h&&!(k in this._updating)&&(m=h[k]);m&&(b=a.delegate(b,m));return this.inherited(arguments)},updateDirty:function(a,b,d){var f=this.dirty,g=f[a];g||(g=f[a]={});g[b]=d},setDirty:function(a,b,d){h.deprecated("setDirty(...)","use updateDirty() instead","dgrid 0.4");this.updateDirty(a,b,d)},save:function(){function a(e,k){return function(a){var h=b._columnsWithSet,m=b._updating,
l,r;if("function"===typeof a.set)a.set(k);else for(l in k)a[l]=k[l];for(l in h)r=h[l].set(a),void 0!==r&&(a[l]=r);m[e]=!0;return d.when(f.put(a),function(){delete g[e];delete m[e]})}}var b=this,f=this.store,g=this.dirty,k=new d,h=k.promise,m=function(a){var d;return b.getBeforePut||!(d=b.row(a).data)?function(){return f.get(a)}:function(){return d}},l;for(l in g)var w=a(l,g[l]),h=h.then(m(l)).then(w);k.resolve();return h},revert:function(){this.dirty={};this.refresh()},_trackError:function(b){var c;
"string"==typeof b&&(b=a.hitch(this,b));try{c=b()}catch(f){g.call(this,f)}return d.when(c,m,a.hitch(this,g))},newRow:function(){var a=this.inherited(arguments);this.noDataNode&&(k(this.noDataNode,"!"),delete this.noDataNode);return a},removeRow:function(a,b){var d={element:a};!b&&this.noDataMessage&&this.up(d).element===a&&this.down(d).element===a&&(this.noDataNode=k(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return this.inherited(arguments)}})})},"dgrid/Selection":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/Deferred dojo/on dojo/has dojo/aspect ./List dojo/has!touch?./util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),
function(h,l,a,d,b,f,k,m,g){function e(a,b){for(var c=a.unselectable=b?"on":"",d=a.getElementsByTagName("*"),e=d.length;--e;)"INPUT"!==d[e].tagName&&"TEXTAREA"!==d[e].tagName&&(d[e].unselectable=c)}function c(a,c){var g=a.bodyNode,k=c?"text":21>b("ff")?"-moz-none":"none";q&&"msUserSelect"!==q?g.style[q]=k:b("dom-selectstart")?c||a._selectstartHandle?c&&a._selectstartHandle&&(a._selectstartHandle.remove(),delete a._selectstartHandle):a._selectstartHandle=d(g,"selectstart",function(a){var b=a.target&&
a.target.tagName;"INPUT"!==b&&"TEXTAREA"!==b&&a.preventDefault()}):(e(g,!c),c||a._unselectableHandle)?c&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle):a._unselectableHandle=f.after(a,"renderRow",function(a){e(a,!0);return a})}b.add("dom-comparedocumentposition",function(a,b,c){return!!c.compareDocumentPosition});b.add("pointer",function(a){return"PointerEvent"in a?"pointer":"MSPointerEvent"in a?"MSPointer":!1});b.add("css-user-select",function(a,b,c){a=c.style;
b=["Khtml","O","ms","Moz","Webkit"];c=b.length;var d="userSelect";do if("undefined"!==typeof a[d])return d;while(c--&&(d=b[c]+"UserSelect"));return!1});b.add("dom-selectstart","undefined"!==typeof document.onselectstart);var n=b("mac")?"metaKey":"ctrlKey",q=b("css-user-select"),r=(k=b("pointer"))&&"MS"===k.slice(0,2),u=k?k+(r?"Down":"down"):"mousedown",v=k?k+(r?"Up":"up"):"mouseup";return l("dgrid.Selection",null,{selectionDelegate:".dgrid-row",selectionEvents:u+","+v+",dgrid-cellfocusin",selectionTouchEvents:b("touch")?
m.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();
this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(a){a!=this.selectionMode&&(this.clearSelection(),this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},setSelectionMode:function(a){h.deprecated("setSelectionMode(...)",'use set("selectionMode", ...) instead',"dgrid 0.4");this.set("selectionMode",a)},_setAllowTextSelection:function(a){"undefined"!==typeof a?c(this,a):c(this,"none"===this.selectionMode);
this.allowTextSelection=a},_handleSelect:function(a,b){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(b))&&("dgrid-cellfocusin"!==a.type||"mousedown"!==a.parentType)&&(a.type!==v||b==this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32==a.keyCode)if(!a.shiftKey&&a.type===u&&this.isSelected(b))this._waitForMouseUp=b;else this[this._selectionHandlerName](a,b);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(a,
b){var c=a.keyCode?a.ctrlKey:a[n];this._lastSelected===b?this.select(b,null,!c||!this.isSelected(b)):(this.clearSelection(),this.select(b),this._lastSelected=b)},_multipleSelectionHandler:function(a,b){var c=this._lastSelected,d=a.keyCode?a.ctrlKey:a[n],e;a.shiftKey||(e=d?null:!0,c=null);this.select(b,c,e);c||(this._lastSelected=b)},_extendedSelectionHandler:function(a,b){(2===a.button?this.isSelected(b):a.keyCode?a.ctrlKey:a[n])||this.clearSelection(null,!0);this._multipleSelectionHandler(a,b)},
_toggleSelectionHandler:function(a,b){this.select(b,null,null)},_initSelectionEvents:function(){var a=this,c=this.contentNode,e=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};b("touch")&&!b("pointer")&&this.selectionTouchEvents?(d(c,m.selector(e,this.selectionTouchEvents),function(b){a._handleSelect(b,this);a._ignoreMouseSelect=this}),d(c,d.selector(e,this.selectionEvents),function(b){a._ignoreMouseSelect!==this?a._handleSelect(b,this):b.type===v&&(a._ignoreMouseSelect=
null)})):d(c,d.selector(e,this.selectionEvents),function(b){a._handleSelect(b,this)});this.addKeyHandler&&this.addKeyHandler(32,function(b){a._handleSelect(b,b.target)});if(this.allowSelectAll)this.on("keydown",function(b){b[n]&&65==b.keyCode&&!/\bdgrid-input\b/.test(b.target.className)&&(b.preventDefault(),a[a.allSelected?"clearSelection":"selectAll"]())});this._setStore&&f.after(this,"_setStore",function(){a._updateDeselectionAspect()});this._updateDeselectionAspect()},_updateDeselectionAspect:function(){function a(c,
d,e){c=d||c&&c[b.idProperty||"id"];if(null!=c&&(d=(c=b.row(c))&&b.selection[c.id]))b[e](c,null,d)}var b=this,c=this.store,d,e;this._removeDeselectSignals&&this._removeDeselectSignals();c&&c.notify?(d=f.before(c,"notify",function(b,c){b||a(b,c,"deselect")}),e=f.after(c,"notify",function(b,c){a(b,c,"select")},!0),this._removeDeselectSignals=function(){d.remove();e.remove()}):(d=f.before(this,"removeRow",function(a,b){var c;b||(c=this.row(a))&&c.id in this.selection&&this.deselect(c)}),this._removeDeselectSignals=
function(){d.remove()})},allowSelect:function(a){return!0},_fireSelectionEvent:function(a){var b=this._selectionEventQueues[a],c=this._selectionTriggerEvent,e;e={bubbles:!0,grid:this};c&&(e.parentType=c.type);e[this._selectionTargetType]=b;this._selectionEventQueues[a]=[];d.emit(this.contentNode,"dgrid-"+a,e)},_fireSelectionEvents:function(){var a=this._selectionEventQueues,b;for(b in a)a[b].length&&this._fireSelectionEvent(b)},_select:function(a,b,c){var d,e,f;"undefined"===typeof c&&(c=!0);a.element||
(a=this.row(a));if(!1===c||this.allowSelect(a))if(d=this.selection,e=!!d[a.id],null===c&&(c=!e),f=a.element,c||this.allSelected?d[a.id]=c:delete this.selection[a.id],f&&(c?g(f,".dgrid-selected"+(this.addUiClasses?".ui-state-active":"")):g(f,"!dgrid-selected!ui-state-active")),c!==e&&f&&this._selectionEventQueues[(c?"":"de")+"select"].push(a),b)if(b.element||(b=this.row(b)),b){if(b=b.element)for(d=this._determineSelectionDirection(f,b),d||(b=document.getElementById(b.id),d=this._determineSelectionDirection(f,
b));a.element!=b&&(a=this[d](a));)this._select(a,null,c)}else this._lastSelected=f,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")},_determineSelectionDirection:b("dom-comparedocumentposition")?function(a,b){var c=b.compareDocumentPosition(a);return c&1?!1:2===c?"down":"up"}:function(a,
b){return 1>b.sourceIndex?!1:b.sourceIndex>a.sourceIndex?"down":"up"},select:function(a,b,c){this._select(a,b,c);this._fireSelectionEvents()},deselect:function(a,b){this.select(a,b,!1)},clearSelection:function(a,b){this.allSelected=!1;for(var c in this.selection)a!==c&&this._select(c,null,!1);b||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var b=this.row(this._rowIdToObject[a]);this._select(b.id,
null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===typeof a||null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var b=this,c=this.inherited(arguments);a.when(c,function(a){var c=b.selection,d,e,f;for(d=0;d<a.length;d++)e=b.row(a[d]),
(f=e.id in c?c[e.id]:b.allSelected)&&b._select(e,null,f);b._fireSelectionEvents()});return c}})})},"dgrid/Keyboard":function(){define("dojo/_base/declare dojo/aspect dojo/on dojo/_base/lang dojo/has put-selector/put ./util/misc dojo/_base/Deferred dojo/_base/sniff".split(" "),function(h,l,a,d,b,f,k,m){function g(a){a.preventDefault()}var e={checkbox:1,radio:1,button:1},c=/\bdgrid-cell\b/,n=/\bdgrid-row\b/,q=h("dgrid.Keyboard",null,{pageSkip:10,tabIndex:0,keyMap:null,headerKeyMap:null,postMixInProperties:function(){this.inherited(arguments);
this.keyMap||(this.keyMap=d.mixin({},q.defaultKeyMap));this.headerKeyMap||(this.headerKeyMap=d.mixin({},q.defaultHeaderKeyMap))},postCreate:function(){function b(a){var c=a.target;return c.type&&(!e[c.type]||32==a.keyCode)}function d(e){function g(){f._focusedHeaderNode&&(f._focusedHeaderNode.tabIndex=-1);if(f.showHeader){if(h)for(var a=0,b,c=f.headerNode.getElementsByTagName("th");b=c[a];++a){if(r.test(b.className)){f._focusedHeaderNode=u=b;break}}else f._focusedHeaderNode=u=f.headerNode;u&&(u.tabIndex=
f.tabIndex)}}var h=f.cellNavigation,r=h?c:n,q=e===f.headerNode,u=e;q?(g(),l.after(f,"renderHeader",g,!0)):l.after(f,"renderArray",function(a){return m.when(a,function(a){var b=f._focusedNode||u;if(r.test(b.className)&&k.contains(e,b))return a;for(var c=0,d=e.getElementsByTagName("*"),g;g=d[c];++c)if(r.test(g.className)){b=f._focusedNode=g;break}b.tabIndex=f.tabIndex;return a})});f._listeners.push(a(e,"mousedown",function(a){b(a)||f._focusOnNode(a.target,q,a)}));f._listeners.push(a(e,"keydown",function(a){if(!a.metaKey&&
!a.altKey){var c=f[q?"headerKeyMap":"keyMap"][a.keyCode];c&&!b(a)&&c.call(f,a)}}))}this.inherited(arguments);var f=this;this.tabableHeader&&(d(this.headerNode),a(this.headerNode,"dgrid-cellfocusin",function(){f.scrollTo({x:this.scrollLeft})}));d(this.contentNode);this._debouncedEnsureRowScroll=k.debounce(this._ensureRowScroll,this)},removeRow:function(a){if(!this._focusedNode)return this.inherited(arguments);var b=this,c=document.activeElement===this._focusedNode,d=this[this.cellNavigation?"cell":
"row"](this._focusedNode),e=d.row||d,f;a=a.element||a;a===e.element&&((f=this.down(e,!0))&&f.element!==a||(f=this.up(e,!0)),this._removedFocus={active:c,rowId:e.id,columnId:d.column&&d.column.id,siblingId:f&&f.element!==a?f.id:void 0},setTimeout(function(){b._removedFocus&&b._restoreFocus(e.id)},0),this._focusedNode=null);this.inherited(arguments)},insertRow:function(a){var b=this.inherited(arguments);this._removedFocus&&!this._removedFocus.wait&&this._restoreFocus(b);return b},_restoreFocus:function(a){var b=
this._removedFocus,c;if((a=(a=a&&this.row(a))&&a.element&&a.id===b.rowId?a:"undefined"!==typeof b.siblingId&&this.row(b.siblingId))&&a.element){if(!a.element.parentNode.parentNode){b.wait=!0;return}"undefined"!==typeof b.columnId&&(c=this.cell(a,b.columnId))&&c.element&&(a=c);b.active&&0!==a.element.offsetHeight?this._focusOnNode(a,!1,null):(f(a.element,".dgrid-focus"),a.element.tabIndex=this.tabIndex,this._focusedNode=a.element)}delete this._removedFocus},addKeyHandler:function(a,b,c){return l.after(this[c?
"headerKeyMap":"keyMap"],a,b,!0)},_ensureRowScroll:function(a){var b=this.getScrollPosition().y;b>a.offsetTop?this.scrollTo({y:a.offsetTop}):b+this.contentNode.offsetHeight<a.offsetTop+a.offsetHeight&&this.scrollTo({y:a.offsetTop-this.contentNode.offsetHeight+a.offsetHeight})},_focusOnNode:function(e,g,k){var h="_focused"+(g?"Header":"")+"Node",m=this[h],l=this.cellNavigation?"cell":"row",r=this[l](e),q,u,t,v,w;if(e=r&&r.element){if(this.cellNavigation)for(q=e.getElementsByTagName("input"),w=0,t=
q.length;w<t;w++)if(u=q[w],(-1!=u.tabIndex||"_dgridLastValue"in u)&&!u.disabled){8>b("ie")&&(u.style.position="relative");u.focus();8>b("ie")&&(u.style.position="");v=!0;break}null!==k&&(k=d.mixin({grid:this},k),k.type&&(k.parentType=k.type),k.bubbles||(k.bubbles=!0));m&&(f(m,"!dgrid-focus[!tabIndex]"),8>b("ie")&&(m.style.position=""),k&&(k[l]=this[l](m),a.emit(m,"dgrid-cellfocusout",k)));m=this[h]=e;k&&(k[l]=r);h=this.cellNavigation?c:n;!v&&h.test(e.className)&&(8>b("ie")&&(e.style.position="relative"),
e.tabIndex=this.tabIndex,e.focus());f(e,".dgrid-focus");k&&a.emit(m,"dgrid-cellfocusin",k);this.cellNavigation&&(this.columnSets||1<this.subRows.length)&&!g&&this._debouncedEnsureRowScroll(r.row.element)}},focusHeader:function(a){this._focusOnNode(a||this._focusedHeaderNode,!0)},focus:function(a){(a=a||this._focusedNode)?this._focusOnNode(a,!1):this.contentNode.focus()}}),r=q.moveFocusVertical=function(a,b){var c=this.cellNavigation,d=this[c?"cell":"row"](a),d=c&&d.column.id,e=this.down(this._focusedNode,
b,!0);c&&(e=this.cell(e,d));this._focusOnNode(e,!1,a);a.preventDefault()};h=q.moveFocusUp=function(a){r.call(this,a,-1)};var u=q.moveFocusDown=function(a){r.call(this,a,1)},v=q.moveFocusPageUp=function(a){r.call(this,a,-this.pageSkip)},t=q.moveFocusPageDown=function(a){r.call(this,a,this.pageSkip)},w=q.moveFocusHorizontal=function(a,b){if(this.cellNavigation){var c=!this.row(a);this._focusOnNode(this.right(this["_focused"+(c?"Header":"")+"Node"],b),c,a);a.preventDefault()}},x=q.moveFocusLeft=function(a){w.call(this,
a,-1)},y=q.moveFocusRight=function(a){w.call(this,a,1)},z=q.moveHeaderFocusEnd=function(a,b){var c;this.cellNavigation&&(c=this.headerNode.getElementsByTagName("th"),this._focusOnNode(c[b?0:c.length-1],!0,a));a.preventDefault()},A=q.moveHeaderFocusHome=function(a){z.call(this,a,!0)},B=q.moveFocusEnd=function(a,c){var e=this,f=this.cellNavigation,g=this.contentNode,k=g.scrollTop+(c?0:g.scrollHeight),g=g[c?"firstChild":"lastChild"],h=-1<g.className.indexOf("dgrid-preload"),n=h?g[(c?"next":"previous")+
"Sibling"]:g,r=n.offsetTop+(c?0:n.offsetHeight),q;if(h){for(;n&&0>n.className.indexOf("dgrid-row");)n=n[(c?"next":"previous")+"Sibling"];if(!n)return}!h||1>g.offsetHeight?(f&&(n=this.cell(n,this.cell(a).column.id)),this._focusOnNode(n,!1,a)):(b("dom-addeventlistener")||(a=d.mixin({},a)),q=l.after(this,"renderArray",function(b){q.remove();return m.when(b,function(b){b=b[c?0:b.length-1];f&&(b=e.cell(b,e.cell(a).column.id));e._focusOnNode(b,!1,a)})}));k===r&&a.preventDefault()},C=q.moveFocusHome=function(a){B.call(this,
a,!0)};q.defaultKeyMap={32:g,33:v,34:t,35:B,36:C,37:x,38:h,39:y,40:u};q.defaultHeaderKeyMap={32:g,35:z,36:A,37:x,39:y};return q})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-geometry dojo/has ../util/misc put-selector/put dojo/_base/html xstyle/css!../css/extensions/ColumnResizer.css".split(" "),function(h,l,a,d,b,f,k,m,g){function e(a){for(var b=a.length,c=b,d=a[0].length,e=Array(b);b--;)e[b]=Array(d);for(var f={},b=
0;b<c;b++)for(var g=e[b],k=a[b],h=0,m=0;h<d;h++){var l=k[m],n;if("undefined"==typeof g[h]){g[h]=l.id;if(l.rowSpan&&1<l.rowSpan){n=e;for(var r=l.rowSpan,q=b,G=h,K=l.id,J=1;J<r;J++)n[q+J][G]=K}if(0<b&&l.colSpan&&1<l.colSpan)for(n=1;n<l.colSpan;n++)if(g[++h]=l.id,l.rowSpan&&1<l.rowSpan)for(var r=e,q=l.rowSpan,G=b,K=h,J=l.id,I=1;I<q;I++)r[G+I][K]=J;f[l.id]=a[0][h].id;m++}}return f}function c(a,b,c,d,e){if(!(0>=c)){var f=a.columns[b],g;if(f&&(g={grid:a,columnId:b,width:c,bubbles:!0,cancelable:!0},d&&(g.parentType=
d),!a._resizedColumns||l.emit(a.headerNode,"dgrid-columnresize",g)))return"auto"===c?delete f.width:(f.width=c,c+="px"),(d=a._columnSizes[b])?d.set("width",c):d=m.addCssRule("#"+m.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+m.escapeCssIdentifier(b,"-"),"width: "+c+";"),a._columnSizes[b]=d,!1!==e&&a.resize(),!0}}var n,q=0,r={create:function(){n=g("div.dgrid-column-resizer")},destroy:function(){g(n,"!");n=null},show:function(a){a=f.position(a.domNode,!0);n.style.top=a.y+"px";n.style.height=
a.h+"px";g(document.body,n)},move:function(a){n.style.left=a+"px"},hide:function(){n.parentNode.removeChild(n)}};return h("dgrid.extensions.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);q++||r.create()},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();--q||r.destroy()},resizeColumnWidth:function(a,b){return c(this,a,b)},configStructure:function(){var a=
this._oldColumnSizes=d.mixin({},this._columnSizes),b;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);for(b in a)b in this._columnSizes||a[b].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var b=a.id,c;"width"in a&&((c=this._oldColumnSizes[b])?c.set("width",a.width+"px"):c=m.addCssRule("#"+m.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+m.escapeCssIdentifier(b,"-"),"width: "+a.width+"px;"),this._columnSizes[b]=c)},renderHeader:function(){this.inherited(arguments);
var b=this,c;if(this.columnSets&&this.columnSets.length)for(var f=this.columnSets.length;f--;)c=d.mixin(c||{},e(this.columnSets[f]));else this.subRows&&1<this.subRows.length&&(c=e(this.subRows));for(var f=a(".dgrid-cell",b.headerNode),h=f.length;h--;){var n=f[h],r=n.columnId,q=b.columns[r],A=n.childNodes;if(q&&!1!==q.resizable){q=g("div.dgrid-resize-header-container");for(n.contents=q;0<A.length;)g(q,A[0]);n=g(n,q,"div.dgrid-resize-handle.resizeNode-"+m.escapeCssIdentifier(r,"-"));n.columnId=c&&c[r]||
r}}b.mouseMoveListen||(l(b.headerNode,".dgrid-resize-handle:mousedown"+(k("touch")?",.dgrid-resize-handle:touchstart":""),function(a){b._resizeMouseDown(a,this);b.mouseMoveListen.resume();b.mouseUpListen.resume()}),b._listeners.push(b.mouseMoveListen=l.pausable(document,"mousemove"+(k("touch")?",touchmove":""),m.throttleDelayed(function(a){b._updateResizerPosition(a)}))),b._listeners.push(b.mouseUpListen=l.pausable(document,"mouseup"+(k("touch")?",touchend":""),function(a){b._resizeMouseUp(a);b.mouseMoveListen.pause();
b.mouseUpListen.pause()})),b.mouseMoveListen.pause(),b.mouseUpListen.pause())},_resizeMouseDown:function(c,d){c.preventDefault();b.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(c);this._targetCell=a(".dgrid-column-"+m.escapeCssIdentifier(d.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(c);r.show(this)},_resizeMouseUp:function(d){var e=this._columnSizes,f,g,k;this.adjustLastColumn&&(k=this.headerNode.clientWidth-1);this._resizedColumns||(f=a(".dgrid-cell",
this.headerNode),this.columnSets&&this.columnSets.length?f=f.filter(function(a){return"0"==a.columnId.split("-")[0]&&!(a.columnId in e)}):this.subRows&&1<this.subRows.length&&(f=f.filter(function(a){return"0"==a.columnId.charAt(0)&&!(a.columnId in e)})),g=f.map(function(a){return a.offsetWidth}),f.forEach(function(a,b){c(this,a.columnId,g[b],null,!1)},this),this._resizedColumns=!0);b.setSelectable(this.domNode,!0);f=this._targetCell;var h=this._getResizeMouseLocation(d)-this._startX,l=f.offsetWidth+
h,n=this._getResizedColumnWidths(),q=n.totalWidth,n=n.lastColId,C=a(".dgrid-column-"+m.escapeCssIdentifier(n,"-"),this.headerNode)[0].offsetWidth;l<this.minWidth&&(l=this.minWidth);c(this,f.columnId,l,d.type)&&f.columnId!=n&&this.adjustLastColumn&&(q+h<k?c(this,n,"auto",d.type):C-h<=this.minWidth&&c(this,n,this.minWidth,d.type));r.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(a){if(this._targetCell){a=this._getResizeMouseLocation(a);var b=this._targetCell.offsetWidth,
c=a;b+(a-this._startX)<this.minWidth&&(c=this._startX-(b-this.minWidth));r.move(c)}},_getResizeMouseLocation:function(a){var b=0;a.pageX?b=a.pageX:a.clientX&&(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return b},_getResizedColumnWidths:function(){var b=0,c=a((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),d=c.length;if(!d)return{};for(var e=c[d-1].columnId;d--;)b+=c[d].offsetWidth;return{totalWidth:b,lastColId:e}}})})},"esri/tasks/FindTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ./Task ./FindResult".split(" "),
function(h,l,a,d,b,f,k,m,g,e){h=h(g,{declaredClass:"esri.tasks.FindTask",constructor:function(a,b){this._url.path+="/find";this._handler=l.hitch(this,this._handler);this.gdbVersion=b&&b.gdbVersion},_handler:function(b,d,f,g,k){try{var h=[];a.forEach(b.results,function(a,b){h[b]=new e(a)});this._successHandler([h],"onComplete",f,k)}catch(m){this._errorHandler(m,g,k)}},execute:function(a,b,e){a=this._encode(l.mixin({},this._url.query,{f:"json"},a.toJson()));var f=this._handler,g=this._errorHandler;
this.gdbVersion&&(a.gdbVersion=this.gdbVersion);var h=new d(m._dfdCanceller);return h._pendingDfd=k({url:this._url.path,content:a,callbackParamName:"callback",load:function(a,c){f(a,c,b,e,h)},error:function(a){g(a,e,h)}}),h},onComplete:function(){}});return b("extend-esri")&&l.setObject("tasks.FindTask",h,f),h})},"esri/tasks/FindResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../graphic ../geometry/jsonUtils".split(" "),function(h,l,a,d,b,f){h=h(null,{declaredClass:"esri.tasks.FindResult",
constructor:function(a){l.mixin(this,a);this.feature=new b(a.geometry?f.fromJson(a.geometry):null,null,a.attributes);delete this.geometry;delete this.attributes}});return a("extend-esri")&&l.setObject("tasks.FindResult",h,d),h})},"esri/tasks/FindParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../layerUtils".split(" "),function(h,l,a,d,b,f,k){h=h(null,{declaredClass:"esri.tasks.FindParameters",searchText:null,contains:!0,searchFields:null,
outSpatialReference:null,layerIds:null,returnGeometry:!1,layerDefinitions:null,dynamicLayerInfos:null,toJson:function(){var b={searchText:this.searchText,contains:this.contains,returnGeometry:this.returnGeometry,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},f=this.layerIds,e=this.searchFields,c=this.outSpatialReference;if(f&&(b.layers=f.join(",")),e&&(b.searchFields=e.join(",")),c&&(b.sr=c.wkid||d.toJson(c.toJson())),b.layerDefs=k._serializeLayerDefinitions(this.layerDefinitions),
this.dynamicLayerInfos&&0<this.dynamicLayerInfos.length){var h=[];a.forEach(this.dynamicLayerInfos,function(b){if(!b.subLayerIds){var c=b.id;if(this.layerIds&&-1!==a.indexOf(this.layerIds,c)){var d={id:c};d.source=b.source&&b.source.toJson();var e;this.layerDefinitions&&this.layerDefinitions[c]&&(e=this.layerDefinitions[c]);e&&(d.definitionExpression=e);h.push(d)}}},this);f=d.toJson(h);"[]"===f&&(f="[{}]");b.dynamicLayers=f}return b}});return b("extend-esri")&&l.setObject("tasks.FindParameters",h,
f),h})},"cmv/viewer/js/gis/dijit/Find/nls/resource":function(){define({root:{selectQuery:"Select query",searchText:{label:"Search for",placeholder:"Enter the text you want to search for."},exactMatches:"Find exact matches only",searchButton:{label:"Search",busyLabel:"searching"},clearButton:{label:"Clear"},searching:"Searching...",resultsLabel:{multipleResultsSuffix:"s",labelPrefix:"Result",labelSuffix:"found"},noResultsLabel:"No results found.",optionsLabel:"Options",zoomOnSelect:"Zoom on select",
zoomOnDeselect:"Zoom on deselect"},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),function(h,l,a,d,b,f,k,m,g){d("dijit-legacy-requires")&&f(0,function(){h(["dijit/form/RadioButton"])});return l("dijit.form.CheckBox",[k,m],{templateString:g,baseClass:"dijitCheckBox",_setValueAttr:function(a,
b){"string"==typeof a&&(this.inherited(arguments),a=!0);this._created&&this.set("checked",a,b)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},_fillContent:function(){},_onFocus:function(){this.id&&b("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&b("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");
this.inherited(arguments)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(h,l){return h("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(a){this._set("readOnly",a);l.set(this.focusNode,"readOnly",a)},_setLabelAttr:void 0,_getSubmitValue:function(a){return null==a||""===a?"on":a},_setValueAttr:function(a){a=this._getSubmitValue(a);this._set("value",a);l.set(this.focusNode,
"value",a)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));l.set(this.focusNode,"value",this.value)},_onClick:function(a){return this.readOnly?(a.stopPropagation(),a.preventDefault(),!1):this.inherited(arguments)}})})},"cmv/viewer/js/gis/dijit/Identify":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/MenuItem dojo/_base/lang dojo/_base/array dojo/promise/all dojo/topic dojo/query dojo/dom-style dojo/dom-class dojo/dnd/Moveable dojo/store/Memory esri/tasks/IdentifyTask esri/tasks/IdentifyParameters esri/dijit/PopupTemplate esri/layers/FeatureLayer esri/TimeExtent dojo/Deferred dojo/text!./Identify/templates/Identify.html dojo/i18n!./Identify/nls/resource ./Identify/Formatters dijit/form/Form dijit/form/FilteringSelect xstyle/css!./Identify/css/Identify.css".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B){return h([l,a,d],{widgetsInTemplate:!0,templateString:z,baseClass:"gis_IdentifyDijit",i18n:A,mapClickMode:null,identifies:{},infoTemplates:{},featureLayers:{},ignoreOtherGraphics:!0,createDefaultInfoTemplates:!0,draggable:!1,layerSeparator:"||",allLayersId:"***",excludedFields:"objectid esri_oid shape shape.len shape_length shape_len shape.stlength() shape.area shape_area shape.starea()".split(" "),defaultFormatters:{esriFieldTypeSmallInteger:B.formatInt,
esriFieldTypeInteger:B.formatInt,esriFieldTypeSingle:B.formatFloat,esriFieldTypeDouble:B.formatFloat,esriFieldTypeDate:B.formatDate},postCreate:function(){this.inherited(arguments);this.identifies||(this.identifies={});this.layers=[];this.addLayerInfos(this.layerInfos);this.own(g.subscribe("mapClickMode/currentSet",f.hitch(this,"setMapClickMode")));this.own(g.subscribe("identify/addLayerInfos",f.hitch(this,"addLayerInfos")));this.map.on("click",f.hitch(this,function(a){"identify"===this.mapClickMode&&
this.executeIdentifyTask(a)}));this.mapRightClickMenu&&this.addRightClickMenu();this.parentWidget&&(this.createIdentifyLayerList(),this.map.on("update-end",f.hitch(this,function(){this.createIdentifyLayerList()})));this.draggable&&this.setupDraggable()},addLayerInfos:function(a){k.forEach(a,f.hitch(this,"addLayerInfo"))},addLayerInfo:function(a){var b=this.map.getLayer(a.layer.id),c;if(b){var d=b.url;if("esri.layers.FeatureLayer"===b.declaredClass){if(b.capabilities&&0>k.indexOf(b.capabilities.toLowerCase(),
"data")&&!b.infoTemplate&&(c=this.getInfoTemplate(b,b.layerId))&&(b.setInfoTemplate(c),0<k.filter(c.info.fieldInfos,function(a){return a.formatter}).length))b.on("graphic-draw",f.hitch(this,"getFormattedFeature",b.infoTemplate));c=d.lastIndexOf("/"+b.layerId);0<c&&(d=d.substring(0,c))}else b.layerInfos&&k.forEach(b.layerInfos,f.hitch(this,function(c){c=c.id;(null===a.layerIds||0<=k.indexOf(a.layerIds,c))&&this.getFeatureLayerForDynamicSublayer(b,c)}));this.layers.push({ref:b,layerInfo:a,identifyTask:new u(d)});
if(this.parentWidget)b.on("visibility-change",f.hitch(this,function(a){!1===a.visible&&this.createIdentifyLayerList()}))}},addRightClickMenu:function(){this.map.on("MouseDown",f.hitch(this,function(a){this.mapRightClick=a}));this.mapRightClickMenu.addChild(new b({label:this.i18n.rightClickMenuItem.label,onClick:f.hitch(this,"handleRightClick")}))},setupDraggable:function(){var a,b,d;a=e("div.esriPopup");b=e("div.esriPopup div.titlePane div.title");d=e("div.esriPopup div.outerPointer, div.esriPopup div.pointer");
0<a.length&&0<b.length&&(c.set(b[0],"cursor","move"),a=new q(a[0],{handle:b[0]}),0<d.length&&(a.onMoveStart=function(){k.forEach(d,function(a){n.remove(a,"left right top bottom topLeft topRight bottomLeft bottomRight")})}))},executeIdentifyTask:function(a){var b=a.mapPoint,c=this.createIdentifyParams(b),d=[],e=[],g=this.getSelectedLayer();if(!this.checkForGraphicInfoTemplate(a)){var h=k.filter(this.layers,function(b){return b.ref.id===a.graphic._layer.id})[0];if(!h)return;e.push(h);h=new y;d.push(h.promise);
h.resolve([{feature:a.graphic}])}this.map.infoWindow.hide();this.map.infoWindow.clearFeatures();a.shiftKey||a.ctrlKey||a.altKey||(k.forEach(this.layers,f.hitch(this,function(a){var b=this.getLayerIds(a,g);if(0<b.length){var k=f.clone(c);k.layerDefinitions=a.ref.layerDefinitions;k.layerIds=b;a.ref.timeInfo&&a.ref.timeInfo.timeExtent&&this.map.timeExtent&&(k.timeExtent=new x(this.map.timeExtent.startTime,this.map.timeExtent.endTime));d.push(a.identifyTask.execute(k));e.push(a)}})),0<d.length&&(this.map.infoWindow.setTitle(this.i18n.mapInfoWindow.identifyingTitle),
this.map.infoWindow.setContent('\x3cdiv class\x3d"loading"\x3e\x3c/div\x3e'),this.map.infoWindow.show(b),m(d).then(f.hitch(this,"identifyCallback",e),f.hitch(this,"identifyError"))))},checkForGraphicInfoTemplate:function(a){return a.graphic&&(a=a.graphic._layer,a.infoTemplate||a.capabilities&&0>k.indexOf(a.capabilities.toLowerCase(),"data")||!(this.ignoreOtherGraphics||this.identifies.hasOwnProperty(a.id)&&!isNaN(a.layerId)&&this.identifies[a.id].hasOwnProperty(a.layerId)))?!1:!0},createIdentifyParams:function(a){var b=
new v;b.tolerance=this.identifyTolerance;b.returnGeometry=!0;b.layerOption=v.LAYER_OPTION_VISIBLE;b.geometry=a;b.mapExtent=this.map.extent;b.width=this.map.width;b.height=this.map.height;b.spatialReference=this.map.spatialReference;return b},getSelectedLayer:function(){var a=this.allLayersId;if(this.parentWidget){var b=this.identifyFormDijit.get("value");b.identifyLayer&&""!==b.identifyLayer?a=b.identifyLayer:this.identifyLayerDijit.set("value",a)}return a},getLayerIds:function(a,b){var c=b.split(this.layerSeparator),
d=this.allLayersId,e=a.ref,f=a.layerInfo.layerIds,g=[];!e.visible||c[0]!==d&&e.id!==c[0]||(1<c.length&&c[1]?g=[c[1]]:"esri.layers.FeatureLayer"!==e.declaredClass||isNaN(e.layerId)?e.layerInfos&&(g=this.getLayerInfos(e,f)):e.capabilities&&0<=k.indexOf(e.capabilities.toLowerCase(),"data")&&(g=[e.layerId]));return g},getLayerInfos:function(a,b){var c=[];k.forEach(a.layerInfos,f.hitch(this,function(d){this.includeSubLayer(d,a,b)&&c.push(d.id)}));return c},identifyCallback:function(a,b){var c=[];k.forEach(b,
function(b,d){var e=a[d].ref;k.forEach(b,function(a){a.feature.geometry.spatialReference=this.map.spatialReference;if(void 0===a.feature.infoTemplate){var b=this.getInfoTemplate(e,null,a);if(b)a.layerId&&e.layerInfos&&b.info.showAttachments&&(a.feature._layer=this.getFeatureLayerForDynamicSublayer(e,a.layerId)),a.feature.setInfoTemplate(b);else return}a=this.getFormattedFeature(a.feature.infoTemplate,a.feature);c.push(a)},this)},this);this.map.infoWindow.setFeatures(c)},getFormattedFeature:function(a,
b){b.graphic&&(b=b.graphic);b&&a&&a.info&&k.forEach(a.info.fieldInfos,function(a){"function"===typeof a.formatter&&(b.attributes[a.fieldName]=a.formatter(b.attributes[a.fieldName],b.attributes,f.clone(b.geometry)))});return b},identifyError:function(a){this.map.infoWindow.hide();g.publish("viewer/handleError",{source:"Identify",error:a})},handleRightClick:function(){this.executeIdentifyTask(this.mapRightClick)},getInfoTemplate:function(a,b,c){var d;c?b=c.layerId||a.layerId:null===b&&(b=a.layerId);
var e=this.identifies;if(e.hasOwnProperty(a.id)){if(e[a.id].hasOwnProperty(b)&&(d=e[a.id][b],d instanceof t))return d}else e[a.id]={};c=f.mixin(this.createDefaultInfoTemplate(a,b,c),e[a.id][b]||{});d=e[a.id][b]=new t(c);c.content&&d.setContent(c.content);return e[a.id][b]},createDefaultInfoTemplate:function(a,b,c){b=null;var d=[],e=this.getLayerName(a);c&&(e=c.layerName);if(c&&c.feature){if(c=c.feature.attributes)for(var g in c)c.hasOwnProperty(g)&&this.addDefaultFieldInfo(d,{fieldName:g,label:this.makeSentenceCase(g),
visible:!0})}else if(a._outFields&&a._outFields.length&&"*"!==a._outFields[0]){var h=a.fields;k.forEach(a._outFields,f.hitch(this,function(a){var b=k.filter(h,function(b){return b.name===a});0<b.length&&this.addDefaultFieldInfo(d,{fieldName:b[0].name,label:b[0].alias,visible:!0})}))}else a.fields&&k.forEach(a.fields,f.hitch(this,function(a){this.addDefaultFieldInfo(d,{fieldName:a.name,label:a.alias===a.name?this.makeSentenceCase(a.name):a.alias,visible:!0})}));0<d.length&&(b={title:e,fieldInfos:d,
showAttachments:a.hasAttachments});return b},makeSentenceCase:function(a){if(!a.length)return"";a=a.toLowerCase().replace(/_/g," ").split(" ");for(var b=0;b<a.length;b++)a[b]=a[b].charAt(0).toUpperCase()+(a[b].substr(1).length?a[b].substr(1):"");return a.length?a.join(" "):a},addDefaultFieldInfo:function(a,b){var c=b.fieldName.toLowerCase();0>k.indexOf(this.excludedFields,c)&&a.push(b)},createIdentifyLayerList:function(){var a=null,b=[],c=this.identifyLayerDijit.get("value"),d=this.layerSeparator;
k.forEach(this.layers,f.hitch(this,function(e){var g=e.ref,h=e.layerInfo.layerIds;if(g.visible){var m=this.getLayerName(e);"esri.layers.FeatureLayer"!==g.declaredClass||isNaN(g.layerId)?k.forEach(g.layerInfos,f.hitch(this,function(e){this.includeSubLayer(e,g,h)&&(b.push({name:m+" \\ "+e.name,id:g.id+d+e.id}),g.id+d+e.id===c&&(a=c))})):(b.push({name:m,id:g.id+d+g.layerId}),g.id+d+g.layerId===c&&(a=c))}}));b.sort(function(a,b){return a.name>b.name?1:b.name>a.name?-1:0});this.identifyLayerDijit.set("disabled",
1>b.length);0<b.length&&(b.unshift({name:this.i18n.labels.allVisibleLayers,id:"***"}),a||(a=b[0].id));var e=new r({data:b});this.identifyLayerDijit.set("store",e);this.identifyLayerDijit.set("value",a)},includeSubLayer:function(a,b,c){return null!==a.subLayerIds||this.isDefaultLayerVisibility(b)&&!this.checkVisibilityRecursive(b,a.id)||0>k.indexOf(b.visibleLayers,a.id)||!this.layerVisibleAtCurrentScale(a)||c&&0>k.indexOf(c,a.id)||!this.createDefaultInfoTemplates&&!this.getInfoTemplate(b,a.id)?!1:
!0},checkVisibilityRecursive:function(a,b){var c=k.filter(a.layerInfos,function(a){return a.id===b});return 0<c.length&&(c=c[0],-1!==a.visibleLayers.indexOf(b)&&(-1===c.parentLayerId||this.checkVisibilityRecursive(a,c.parentLayerId)))?!0:!1},isDefaultLayerVisibility:function(a){for(var b=0;b<a.layerInfos.length;b++){var c=a.layerInfos[b];if(c.defaultVisibility&&-1===a.visibleLayers.indexOf(c.id))return!1}return!0},getLayerName:function(a){var b=null;a.layerInfo&&(b=a.layerInfo.title);b||k.forEach(this.layers,
function(c){c.ref.id===a.id&&(b=c.layerInfo.title)});b||(b=a.name,!b&&a.ref&&(b=a.ref._titleForLegend));return b},getFeatureLayerForDynamicSublayer:function(a,b){if(!a.layerInfos)return!1;var c=a.url+"/"+b;this.featureLayers.hasOwnProperty(c)||(this.featureLayers[c]=new w(c));return this.featureLayers[c]},layerVisibleAtCurrentScale:function(a){var b=this.map.getScale();return!(0!==a.maxScale&&b<a.maxScale||0!==a.minScale&&b>a.minScale)},setMapClickMode:function(a){this.mapClickMode=a;var b=this.map;
k.forEach(b.graphicsLayerIds,function(c){if(c=b.getLayer(c))"identify"===a?this.infoTemplates[c.id]&&(c.infoTemplate=f.clone(this.infoTemplates[c.id])):c.infoTemplate&&(this.infoTemplates[c.id]=f.clone(c.infoTemplate),c.infoTemplate=null)},this)}})})},"esri/tasks/IdentifyTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../request ../geometry/normalizeUtils ./Task ./IdentifyResult".split(" "),function(h,l,a,d,b,f,k,m,g){h=h(m,{declaredClass:"esri.tasks.IdentifyTask",
_eventMap:{complete:["results"]},constructor:function(a,b){this._url.path+="/identify";this._handler=l.hitch(this,this._handler);this.gdbVersion=b&&b.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:3,a:[{i:0,p:["geometry"]}],e:2}],_handler:function(b,c,d,f,k){try{var h=[];a.forEach(b.results,function(a,b){h[b]=new g(a)});this._successHandler([h],"onComplete",d,k)}catch(m){this._errorHandler(m,f,k)}},execute:function(a,b,d,g){var k=g.assembly;a=this._encode(l.mixin({},this._url.query,
{f:"json"},a.toJson(k&&k[0])));var h=this._handler,m=this._errorHandler;return this.gdbVersion&&(a.gdbVersion=this.gdbVersion),f({url:this._url.path,content:a,callbackParamName:"callback",load:function(a,e){h(a,e,b,d,g.dfd)},error:function(a){m(a,d,g.dfd)}})},onComplete:function(){}});return k._createWrappers(h),d("extend-esri")&&l.setObject("tasks.IdentifyTask",h,b),h})},"esri/tasks/IdentifyResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../graphic ../geometry/jsonUtils".split(" "),
function(h,l,a,d,b,f){h=h(null,{declaredClass:"esri.tasks.IdentifyResult",constructor:function(a){l.mixin(this,a);this.feature=new b(a.geometry?f.fromJson(a.geometry):null,null,a.attributes);delete this.geometry;delete this.attributes}});return a("extend-esri")&&l.setObject("tasks.IdentifyResult",h,d),h})},"esri/tasks/IdentifyParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../layerUtils ../geometry/jsonUtils ../geometry/scaleUtils".split(" "),
function(h,l,a,d,b,f,k,m,g){var e=h(null,{declaredClass:"esri.tasks.IdentifyParameters",constructor:function(){this.layerOption=e.LAYER_OPTION_TOP},geometry:null,spatialReference:null,layerIds:null,tolerance:null,returnGeometry:!1,mapExtent:null,width:400,height:400,dpi:96,layerDefinitions:null,timeExtent:null,layerTimeOptions:null,dynamicLayerInfos:null,toJson:function(b){var e=b&&b.geometry||this.geometry,f=this.mapExtent,h=this.spatialReference,l=this.layerIds;b={tolerance:this.tolerance,returnGeometry:this.returnGeometry,
imageDisplay:this.width+","+this.height+","+this.dpi,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision};if(e){var v=e.toJson();delete v.spatialReference;b.geometry=d.toJson(v);b.geometryType=m.getJsonType(e)}h?b.sr=h.wkid||d.toJson(h.toJson()):e&&e.spatialReference?b.sr=e.spatialReference.wkid||d.toJson(e.spatialReference.toJson()):f&&f.spatialReference&&(b.sr=f.spatialReference.wkid||d.toJson(f.spatialReference.toJson()));f&&(b.mapExtent=f.xmin+","+f.ymin+","+f.xmax+
","+f.ymax);b.layers=this.layerOption;l&&(b.layers+=":"+l.join(","));b.layerDefs=k._serializeLayerDefinitions(this.layerDefinitions);e=this.timeExtent;if(b.time=e?e.toJson().join(","):null,b.layerTimeOptions=k._serializeTimeOptions(this.layerTimeOptions),this.dynamicLayerInfos&&0<this.dynamicLayerInfos.length){var f=g.getScale({extent:f,width:this.width,spatialReference:f.spatialReference}),t=k._getLayersForScale(f,this.dynamicLayerInfos),w=[];a.forEach(this.dynamicLayerInfos,function(b){if(!b.subLayerIds){var c=
b.id;if((!this.layerIds||this.layerIds&&-1!==a.indexOf(this.layerIds,c))&&-1!==a.indexOf(t,c)){var d={id:c};d.source=b.source&&b.source.toJson();var e;this.layerDefinitions&&this.layerDefinitions[c]&&(e=this.layerDefinitions[c]);e&&(d.definitionExpression=e);var f;this.layerTimeOptions&&this.layerTimeOptions[c]&&(f=this.layerTimeOptions[c]);f&&(d.layerTimeOptions=f.toJson());w.push(d)}}},this);f=d.toJson(w);"[]"===f&&(f="[{}]");b.dynamicLayers=f}return b}});return l.mixin(e,{LAYER_OPTION_TOP:"top",
LAYER_OPTION_VISIBLE:"visible",LAYER_OPTION_ALL:"all"}),b("extend-esri")&&l.setObject("tasks.IdentifyParameters",e,f),e})},"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(h,l,a,d,b,f,k,m){h=h([f,k],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(a,b){l.mixin(this,b);this.initialize(a,b)},getTitle:function(a){var b;
return this.info&&(b=this.titleHasRelatedFields?"":this._getPopupValues(a,!0).title),b||""},getContent:function(a){return this.info?(new m({template:this,graphic:a,chartTheme:this.chartTheme},d.create("div"))).domNode:""}});return a("extend-esri")&&l.setObject("dijit.PopupTemplate",h,b),h})},"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all ./lang ./kernel ./request ./tasks/query ./tasks/QueryTask ./tasks/StatisticDefinition dojo/i18n!dojo/cldr/nls/number".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v){h=h(null,{declaredClass:"esri.PopupInfo",initialize:function(b,c){if(b){l.mixin(this,c);this.info=b;this.title=this.getTitle;this.content=this.getContent;var d=this._fieldLabels={},e=this._fieldsMap={};b.fieldInfos&&a.forEach(b.fieldInfos,function(a){var b=a.fieldName.toLowerCase();d[b]=a.label;e[b]=a});this._relatedFieldPrefix="relationships/";this.titleHasRelatedFields=!(!b.title||-1===b.title.indexOf("{"+this._relatedFieldPrefix))}},toJson:function(){return d.fromJson(d.toJson(this.info))},
getTitle:function(){},getContent:function(){},getFieldInfo:function(b){var c;return a.some(this.info&&this.info.fieldInfos,function(a){return a.fieldName===b&&(c=a),!!c}),c},getComponents:function(b){var c,d,e=this.info,f=new k;return e.fieldInfos&&(d=a.filter(e.fieldInfos,function(a){return-1!==a.fieldName.indexOf(this._relatedFieldPrefix)},this)),d&&0<d.length&&(c=this._getRelatedRecords({graphic:b,fieldsInfo:d})),c?c.always(l.hitch(this,function(){f.resolve(this._getPopupValues(b))})):f.resolve(this._getPopupValues(b)),
f.promise},getAttachments:function(a){var b=a.getLayer();a=a.attributes;if(this.info.showAttachments&&b&&b.hasAttachments&&b.objectIdField&&(a=a&&a[b.objectIdField]))return b.queryAttachmentInfos(a)},_getPopupValues:function(b,c){var d,f,g,k,h,m=this.info,n=b.getLayer(),r=l.clone(b.attributes)||{},q=l.clone(r),u=m.fieldInfos,v="",K="",J=n&&n._getDateOpts&&n._getDateOpts().properties,J=J&&J.slice(0),I={dateFormat:{properties:J,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)}};
if(this._relatedInfo)for(k in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(k)){var L=this._relatedInfo[k],M=this._relatedLayersInfo[k];L&&(a.forEach(L.relatedFeatures,function(a){for(h in a.attributes)if(a.attributes.hasOwnProperty(h)&&"esriRelCardinalityOneToOne"===M.relation.cardinality){var b=this._toRelatedFieldName([M.relation.id,h]);r[b]=q[b]=a.attributes[h]}},this),a.forEach(L.relatedStatsFeatures,function(a){for(h in a.attributes)if(a.attributes.hasOwnProperty(h)){var b=this._toRelatedFieldName([M.relation.id,
h]);r[b]=q[b]=a.attributes[h]}},this))}if(u&&a.forEach(u,function(b){f=b.fieldName;var c=this._getLayerFieldInfo(n,f);c&&(f=b.fieldName=c.name);if(q[f]=this._formatValue(q[f],f,I),J&&b.format&&b.format.dateFormat)b=a.indexOf(J,f),-1<b&&J.splice(b,1)},this),n){k=n.types;var N=(L=n.typeIdField)&&r[L];for(f in r)if(r.hasOwnProperty(f)&&-1===f.indexOf(this._relatedFieldPrefix)&&(g=r[f],e.isDefined(g))){var Q=this._getDomainName(n,b,k,N,f,g);e.isDefined(Q)?q[f]=Q:f===L&&(Q=this._getTypeName(n,b,g),e.isDefined(Q)&&
(q[f]=Q))}}if(m.title&&(v=this._processFieldsInLinks(this._fixTokens(m.title,n),r),v=l.trim(e.substitute(q,v,I)||"")),c)return{title:v};m.description&&(K=this._processFieldsInLinks(this._fixTokens(m.description,n),r),K=l.trim(e.substitute(q,K,I)||""));u&&(d=[],a.forEach(u,function(a){(f=a.fieldName)&&a.visible&&d.push([a.label||f,e.substitute(q,"${"+f+"}",I)||""])}));var O,T;return m.mediaInfos&&(O=[],a.forEach(m.mediaInfos,function(b){switch(T=0,g=b.value,b.type){case "image":var c=g.sourceURL,c=
c&&l.trim(e.substitute(r,this._fixTokens(c,n)));T=!!c;break;case "piechart":case "linechart":case "columnchart":case "barchart":var d,c=g.normalizeField;g.fields=a.map(g.fields,function(a){return d=this._getLayerFieldInfo(n,a),d?d.name:a},this);c&&(d=this._getLayerFieldInfo(n,c),g.normalizeField=d?d.name:c);T=a.some(g.fields,function(a){return e.isDefined(r[a])||-1!==a.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(T){b=l.clone(b);g=b.value;var c=b.title?this._processFieldsInLinks(this._fixTokens(b.title,
n),r):"",f=b.caption?this._processFieldsInLinks(this._fixTokens(b.caption,n),r):"";if(b.title=c?l.trim(e.substitute(q,c,I)||""):"",b.caption=f?l.trim(e.substitute(q,f,I)||""):"","image"===b.type)g.sourceURL=e.substitute(r,this._fixTokens(g.sourceURL,n)),g.linkURL&&(g.linkURL=l.trim(e.substitute(r,this._fixTokens(g.linkURL,n))||""));else{var k,h;a.forEach(g.fields,function(a,b){if(-1!==a.indexOf(this._relatedFieldPrefix))h=this._getRelatedChartInfos(a,g,r,I),h instanceof Array?g.fields=h:g.fields[b]=
h;else{var c=r[a],c=void 0===c?null:c;k=r[g.normalizeField]||0;c&&k&&(c/=k);g.fields[b]={y:c,tooltip:(this._fieldLabels[a.toLowerCase()]||a)+":\x3cbr/\x3e"+this._formatValue(c,a,I,!!k)}}},this)}O.push(b)}},this)),{title:v,description:K,hasDescription:!!m.description,fields:d&&d.length?d:null,mediaInfos:O&&O.length?O:null,formatted:q,editSummary:n&&n.getEditSummary?n.getEditSummary(b):""}},_getRelatedChartInfos:function(b,c,d,e){var f,g,k,h,m,l,n;return f=[],n=this._fromRelatedFieldName(b),m=n[0],
g=this._relatedInfo[m],l=this._relatedLayersInfo[m],g&&a.forEach(g.relatedFeatures,function(a){var g,m=a.attributes;for(g in m)if(m.hasOwnProperty(g)&&g===n[1]){if(a={},h=m[g],c.normalizeField&&(k=-1!==c.normalizeField.indexOf(this._relatedFieldPrefix)?m[this._fromRelatedFieldName(c.normalizeField)[1]]:d[c.normalizeField]),h&&k&&(h/=k),c.tooltipField)if(-1!==c.tooltipField.indexOf(this._relatedFieldPrefix)){var l=this._fromRelatedFieldName(c.tooltipField)[1];m[l]&&"string"==typeof m[l]?a.tooltip=
m[l]+":\x3cbr/\x3e"+this._formatValue(h,m[l],e,!!k):a.tooltip=l+":\x3cbr/\x3e"+this._formatValue(h,l,e,!!k)}else a.tooltip=(this._fieldLabels[b.toLowerCase()]||b)+":\x3cbr/\x3e"+this._formatValue(h,c.tooltipField,e,!!k);else a.tooltip=h;a.y=h;f.push(a)}},this),"esriRelCardinalityOneToMany"===l.relation.cardinality||"esriRelCardinalityManyToMany"===l.relation.cardinality?f:f[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",
longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",
shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",
year:"(datePattern: 'y', selector: 'date')"},_reHref:/href\s*=\s*\"([^\"]+)\"/gi,_reHrefApos:/href\s*=\s*\'([^\']+)\'/gi,_fixTokens:function(a,b){var c=this;return a.replace(/(\{([^\{\r\n]+)\})/g,function(a,d,e){a=c._getLayerFieldInfo(b,e);return"$"+(a?"{"+a.name+"}":d)})},_encodeAttributes:function(a){var b,c,d=l.clone(a)||{};for(b in d)(a=d[b])&&"string"==typeof a&&(c=encodeURIComponent(a).replace(/\'/g,"\x26apos;"),d[b]=c);return d},_processFieldsInLinks:function(a,b){var c=this._encodeAttributes(b),
d=this;return a&&(a=a.replace(this._reHref,function(a,e){return d._addValuesToHref(a,e,b,c)}).replace(this._reHrefApos,function(a,e){return d._addValuesToHref(a,e,b,c)})),a},_addValuesToHref:function(a,b,c,d){return b=b&&l.trim(b),e.substitute((b?0!==b.indexOf("${"):1)?d:c,a)},_getLayerFieldInfo:function(a,b){return a&&a.getField?a.getField(b):null},_formatValue:function(b,c,d,f){var g=this._fieldsMap[c.toLowerCase()],k=g&&g.format;c=-1!==a.indexOf(d.dateFormat.properties,c);var h=!("number"!=typeof b||
c||k&&k.dateFormat);if(!e.isDefined(b)||!g||!e.isDefined(k))return h?this._forceLTR(b):b;var m="",g=[],n=k.hasOwnProperty("places")||k.hasOwnProperty("digitSeparator"),r=k.hasOwnProperty("digitSeparator")?k.digitSeparator:!0;if(n&&!c)m="NumberFormat",g.push("places: "+(e.isDefined(k.places)&&(!f||0<k.places)?Number(k.places):"Infinity")),g.length&&(m+="("+g.join(",")+")");else{if(!k.dateFormat)return h?this._forceLTR(b):b;m="DateFormat"+this._insertOffset(this._dateFormats[k.dateFormat]||this._dateFormats.shortDateShortTime)}var q=
this._applyFormatting(b,m,d);return n&&-1<b.constructor.toString().indexOf("Array")&&(q="",a.forEach(b,l.hitch(this,function(a,b){b&&(q+=" ");q+=this._applyFormatting(a,m,d)}))),n&&!r&&v.group&&(q=q.replace(new RegExp("\\"+v.group,"g"),"")),c&&(q='\x3cspan class\x3d"esriDateValue"\x3e'+q+"\x3c/span\x3e"),h?this._forceLTR(q):q},_applyFormatting:function(a,b,c){return e.substitute({myKey:a},"${myKey:"+b+"}",c)||""},_forceLTR:function(a){var b=m("ie");return b&&10>=b?a:"\x3cspan class\x3d'esriNumericValue'\x3e"+
a+"\x3c/span\x3e"},_insertOffset:function(a){return a&&(a=e.isDefined(this.utcOffset)?a.replace(/\)\s*$/,", utcOffset:"+this.utcOffset+")"):a),a},_getDomainName:function(a,b,c,d,e,f){return(a=a.getDomain&&a.getDomain(e,{feature:b}))&&a.codedValues?a.getName(f):null},_getTypeName:function(a,b,c){return(a=a.getType&&a.getType(b))&&a.name},_getRelatedRecords:function(a){var b,c=a.graphic,d=new k;return this._relatedLayersInfo?this._queryRelatedLayers(c).then(l.hitch(this,function(a){this._setRelatedRecords(c,
a);d.resolve(a)}),l.hitch(this,this._handlerErrorResponse,d)):this._getRelatedLayersInfo(a).then(l.hitch(this,function(a){for(b in a)a.hasOwnProperty(b)&&a[b]&&(this._relatedLayersInfo[b].relatedLayerInfo=a[b]);this._queryRelatedLayers(c).then(l.hitch(this,function(a){this._setRelatedRecords(c,a);d.resolve(a)}),l.hitch(this,this._handlerErrorResponse,d))}),l.hitch(this,this._handlerErrorResponse,d)),d.promise},_getRelatedLayersInfo:function(b){var c,d,e=b.fieldsInfo,f={};c=b.graphic.getLayer();this._relatedLayersInfo||
(this._relatedLayersInfo={});a.forEach(e,function(b){var d,e,f,g;d=this._fromRelatedFieldName(b.fieldName);e=d[0];d=d[1];e&&(this._relatedLayersInfo[e]||(a.some(c.relationships,function(a){return a.id==e?(g=a,!0):void 0}),g&&(this._relatedLayersInfo[e]={relation:g,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[e]&&(this._relatedLayersInfo[e].relatedFields.push(d),b.statisticType&&(f=new u,f.statisticType=b.statisticType,f.onStatisticField=d,f.outStatisticFieldName=d,this._relatedLayersInfo[e].outStatistics.push(f))))},
this);for(d in this._relatedLayersInfo)if(this._relatedLayersInfo.hasOwnProperty(d)){var k,h;this._relatedLayersInfo[d]&&(k=this._relatedLayersInfo[d].relation,h=c.url.replace(/[0-9]+$/,k.relatedTableId),this._relatedLayersInfo[d].relatedLayerUrl=h,f[d]=n({url:h,content:{f:"json"},callbackParamName:"callback"}))}return g(f)},_queryRelatedLayers:function(a){var b,c={};for(b in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(b)&&(c[b]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[b]}));
return g(c)},_queryRelatedLayer:function(b){var c,d,e,f,k,h,m,l,n,u,v,G,K,J;return c=b.graphic,d=c.getLayer(),e=d.url.match(/[0-9]+$/g)[0],G=b.relatedInfo,u=G.relatedLayerInfo,K=G.relatedLayerUrl,J=G.relation,a.some(u.relationships,function(a){return a.relatedTableId===parseInt(e,10)?(f=a,!0):void 0},this),f&&(k=new q,a.some(u.fields,function(b){return b.name===f.keyField?(l=-1!==a.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],b.type)?"number":
"string",!0):void 0}),m="string"===l?f.keyField+"\x3d'"+c.attributes[J.keyField]+"'":f.keyField+"\x3d"+c.attributes[J.keyField],k.where=m,k.outFields=G.relatedFields,G.outStatistics&&0<G.outStatistics.length&&u.supportsStatistics&&(n=new q,n.where=k.where,n.outFields=k.outFields,n.outStatistics=G.outStatistics),h=new r(K),v=[],v.push(h.execute(k)),n&&v.push(h.execute(n))),g(v)},_setRelatedRecords:function(a,b){this._relatedInfo=[];for(var c in b)if(b.hasOwnProperty(c)&&b[c]){var d=b[c];this._relatedInfo[c]=
{};this._relatedInfo[c].relatedFeatures=d[0].features;e.isDefined(d[1])&&(this._relatedInfo[c].relatedStatsFeatures=d[1].features)}},_handlerErrorResponse:function(a,b){a.reject(b)},_fromRelatedFieldName:function(a){var b,c=[];return-1!==a.indexOf(this._relatedFieldPrefix)&&(b=a.split("/"),c=b.slice(1)),c},_toRelatedFieldName:function(a){var b="";return a&&0<a.length&&(b=this._relatedFieldPrefix+a[0]+"/"+a[1]),b}});return f("extend-esri")&&(c.PopupInfo=c.PopupInfoTemplate=h),h})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y){var z=0;l=l([x,u,v],{declaredClass:"esri.dijit._PopupRenderer",constructor:function(){this._nls=d.mixin({},y.widgets.popup)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this.template.getComponents(this.graphic).then(d.hitch(this,this._handleComponentsSuccess),d.hitch(this,this._handleComponentsError))},destroy:function(){this._dfd&&this._dfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._dfd=null;this.inherited(arguments)},_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+
1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var a=this._mediaInfos,d=a.length,g=this.domNode,k=this._prevMedia,h=this._nextMedia;if(1<d){var m=0,l=0;b.forEach(a,function(a){"image"===a.type?m++:-1!==a.type.indexOf("chart")&&l++});m&&(e.set(this._imageCount,"innerHTML",m),f.query(".summary .image",g).removeClass("hidden"));l&&(e.set(this._chartCount,"innerHTML",l),f.query(".summary .chart",g).removeClass("hidden"))}else f.query(".summary",
g).addClass("hidden"),c.add(k,"hidden"),c.add(h,"hidden");a=this._mediaPtr;0===a?c.add(k,"hidden"):c.remove(k,"hidden");a===d-1?c.add(h,"hidden"):c.remove(h,"hidden");this._destroyFrame()},_displayMedia:function(){var a=this._mediaInfos[this._mediaPtr],b=a.title,g=a.caption,k=f.query(".mediaSection .hzLine",this.domNode)[0];if(e.set(this._mediaTitle,"innerHTML",b),c[b?"remove":"add"](this._mediaTitle,"hidden"),e.set(this._mediaCaption,"innerHTML",g),c[g?"remove":"add"](this._mediaCaption,"hidden"),
c[b&&g?"remove":"add"](k,"hidden"),this._rid=null,"image"===a.type)this._showImage(a.value);else{var m=this,b=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],g=a.value.theme||this.chartTheme;d.isString(g)&&(g=g.replace(/\./gi,"/"),-1===g.indexOf("/")&&(g="dojox/charting/themes/"+g));g||(g="./Rainbow");b.push(g);try{var l=this._rid=z++;h(b,function(b,c,d){l===m._rid&&(m._rid=null,m._showChart(a.type,a.value,b,c,d))})}catch(n){}}},_preventNewTab:function(a){return a=a&&d.trim(a).toLowerCase(),
a&&(0===a.indexOf("mailto:")||0===a.indexOf("tel:"))},_showImage:function(b){c.add(this._mediaFrame,"image");var d,e=q.get(this._gallery,"height");b.linkURL&&(d=n.create("a",{href:b.linkURL,target:this._preventNewTab(b.linkURL)?"":"_blank"},this._mediaFrame));n.create("img",{className:"esriPopupMediaImage",src:b.sourceURL},d||this._mediaFrame);var g,k=f.query(".esriPopupMediaImage",this._mediaFrame)[0],h=this;g=a.connect(k,"onload",function(){a.disconnect(g);g=null;h._imageLoaded(k,e)})},_showChart:function(a,
d,e,f,g){c.remove(this._mediaFrame,"image");e=this._chart=new e(n.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});switch(g&&e.setTheme(g),a){case "piechart":e.addPlot("default",{type:"Pie",labels:!1});e.addSeries("Series A",d.fields);break;case "linechart":e.addPlot("default",{type:"Markers"});e.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});e.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});b.forEach(d.fields,function(a,b){a.x=
b+1});e.addSeries("Series A",d.fields);break;case "columnchart":e.addPlot("default",{type:"Columns",gap:3});e.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});e.addSeries("Series A",d.fields);break;case "barchart":e.addPlot("default",{type:"Bars",gap:3}),e.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),e.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),e.addSeries("Series A",d.fields)}this._action=new f(e);e.render()},_destroyFrame:function(){this._rid=
null;this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);e.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(a,b){var c=a.height;b>c&&(c=Math.round((b-c)/2),q.set(a,"marginTop",c+"px"))},_attListHandler:function(a,c){if(a===this._dfd){this._dfd=null;var d="";c instanceof Error||!c||!c.length||b.forEach(c,function(a){d+="\x3cli\x3e";d+="\x3ca href\x3d'"+w.addProxy(a.url)+"' target\x3d'_blank'\x3e"+(a.name||"[No name]")+"\x3c/a\x3e";
d+="\x3c/li\x3e"});e.set(this._attachmentsList,"innerHTML",d||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_handleComponentsSuccess:function(a){if(a){var k=this.showTitle?a.title:"",h=a.description,m=a.fields,l=a.mediaInfos,n=this.domNode,q=this._nls,u=this,t=this.template,v=this.graphic;this._prevMedia.title=q.NLS_prevMedia;this._nextMedia.title=q.NLS_nextMedia;e.set(this._title,"innerHTML",k);k||c.add(this._title,"hidden");!a.hasDescription&&m&&(h="",b.forEach(m,function(a){h+="\x3ctr valign\x3d'top'\x3e";
h+="\x3ctd class\x3d'attrName'\x3e"+r.encode(a[0])+"\x3c/td\x3e";h+="\x3ctd class\x3d'attrValue'\x3e"+a[1].replace(/^\s*(https?:\/\/[^\s]+)\s*$/i,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+q.NLS_moreInfo+"\x3c/a\x3e")+"\x3c/td\x3e";h+="\x3c/tr\x3e"}),h&&(h="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+h+"\x3c/table\x3e"));e.set(this._description,"innerHTML",h);h||c.add(this._description,"hidden");f.query("a",this._description).forEach(function(a){u._preventNewTab(a.href)?
"_blank"===a.target&&e.remove(a,"target"):e.set(a,"target","_blank")});k&&h?f.query(".mainSection .hzLine",n).removeClass("hidden"):k||h?f.query(".mainSection .hzLine",n).addClass("hidden"):f.query(".mainSection",n).addClass("hidden");(k=this._dfd=t.getAttachments(v))&&(k.addBoth(d.hitch(this,this._attListHandler,k)),e.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+q.NLS_searching+"...\x3c/li\x3e"),f.query(".attachmentsSection",n).removeClass("hidden"));l&&l.length&&(f.query(".mediaSection",n).removeClass("hidden"),
g.setSelectable(this._mediaFrame,!1),this._mediaInfos=l,this._mediaPtr=0,this._updateUI(),this._displayMedia());a.editSummary&&(e.set(this._editSummary,"innerHTML",a.editSummary),l&&l.length&&c.remove(this._mediaBreak,"hidden"),c.remove(this._editSummarySection,"hidden"))}},_handleComponentsError:function(a){}});return k("extend-esri")&&d.setObject("dijit._PopupRenderer",l,t),l})},"cmv/viewer/js/gis/dijit/Identify/nls/resource":function(){define({root:{labels:{selectLayer:'Choose "All Visible Layers" or a single layer for identify:',
allVisibleLayers:"*** All Visible Layers ***"},rightClickMenuItem:{label:"Identify here"},mapInfoWindow:{identifyingTitle:"Identifying..."}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/Identify/Formatters":function(){define(["dojo/number","dojo/date/locale"],function(h,l){return{formatInt:function(a){return h.format(a)},formatFloat:function(a){return h.format(a,{places:3})},formatDate:function(a){return l.format(new Date(a),{formatLength:"short"})}}})},"cmv/viewer/js/gis/dijit/Draw":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/Color esri/toolbars/draw esri/layers/GraphicsLayer esri/graphic esri/renderers/SimpleRenderer dojo/text!./Draw/templates/Draw.html esri/renderers/UniqueValueRenderer esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/layers/FeatureLayer dojo/topic dojo/aspect dojo/i18n!./Draw/nls/resource dijit/form/Button xstyle/css!./Draw/css/Draw.css xstyle/css!./Draw/css/adw-icons.css".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x){return h([l,a,d],{widgetsInTemplate:!0,templateString:c,i18n:x,drawToolbar:null,mapClickMode:null,postCreate:function(){this.inherited(arguments);this.drawToolbar=new k(this.map);this.drawToolbar.on("draw-end",b.hitch(this,"onDrawToolbarDrawEnd"));this.createGraphicLayers();this.own(t.subscribe("mapClickMode/currentSet",b.hitch(this,"setMapClickMode")));this.parentWidget&&this.parentWidget.toggleable&&this.own(w.after(this.parentWidget,"toggle",b.hitch(this,
function(){this.onLayoutChange(this.parentWidget.open)})))},createGraphicLayers:function(){this.pointSymbol=new q(q.STYLE_CIRCLE,10,new r(r.STYLE_SOLID,new f([255,0,0]),1),new f([255,0,0,1]));this.polylineSymbol=new r(r.STYLE_DASH,new f([255,0,0]),1);this.polygonSymbol=new u(u.STYLE_SOLID,new r(r.STYLE_DASHDOT,new f([255,0,0]),2),new f([255,255,0,0]));this.pointGraphics=new m({id:"drawGraphics_point",title:"Draw Graphics"});this.pointRenderer=new e(this.pointSymbol);this.pointRenderer.label="User drawn points";
this.pointRenderer.description="User drawn points";this.pointGraphics.setRenderer(this.pointRenderer);this.map.addLayer(this.pointGraphics);this.polylineGraphics=new m({id:"drawGraphics_line",title:"Draw Graphics"});this.polylineRenderer=new e(this.polylineSymbol);this.polylineRenderer.label="User drawn lines";this.polylineRenderer.description="User drawn lines";this.polylineGraphics.setRenderer(this.polylineRenderer);this.map.addLayer(this.polylineGraphics);this.polygonGraphics=new v({layerDefinition:{geometryType:"esriGeometryPolygon",
fields:[{name:"OBJECTID",type:"esriFieldTypeOID",alias:"OBJECTID",domain:null,editable:!1,nullable:!1},{name:"ren",type:"esriFieldTypeInteger",alias:"ren",domain:null,editable:!0,nullable:!1}]},featureSet:null},{id:"drawGraphics_poly",title:"Draw Graphics",mode:v.MODE_SNAPSHOT});this.polygonRenderer=new n(new u,"ren",null,null,", ");this.polygonRenderer.addValue({value:1,symbol:new u({color:[255,170,0,255],outline:{color:[255,170,0,255],width:1,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",
style:"esriSFSForwardDiagonal"}),label:"User drawn polygons",description:"User drawn polygons"});this.polygonGraphics.setRenderer(this.polygonRenderer);this.map.addLayer(this.polygonGraphics)},drawPoint:function(){this.disconnectMapClick();this.drawToolbar.activate(k.POINT);this.drawModeTextNode.innerText=this.i18n.labels.point},drawCircle:function(){this.disconnectMapClick();this.drawToolbar.activate(k.CIRCLE);this.drawModeTextNode.innerText=this.i18n.labels.circle},drawLine:function(){this.disconnectMapClick();
this.drawToolbar.activate(k.POLYLINE);this.drawModeTextNode.innerText=this.i18n.labels.polyline},drawFreehandLine:function(){this.disconnectMapClick();this.drawToolbar.activate(k.FREEHAND_POLYLINE);this.drawModeTextNode.innerText=this.i18n.labels.freehandPolyline},drawPolygon:function(){this.disconnectMapClick();this.drawToolbar.activate(k.POLYGON);this.drawModeTextNode.innerText=this.i18n.labels.polygon},drawFreehandPolygon:function(){this.disconnectMapClick();this.drawToolbar.activate(k.FREEHAND_POLYGON);
this.drawModeTextNode.innerText=this.i18n.labels.freehandPolygon},disconnectMapClick:function(){t.publish("mapClickMode/setCurrent","draw");this.enableStopButtons()},connectMapClick:function(){t.publish("mapClickMode/setDefault");this.disableStopButtons()},onDrawToolbarDrawEnd:function(a){this.drawToolbar.deactivate();this.drawModeTextNode.innerText=this.i18n.labels.currentDrawModeNone;switch(a.geometry.type){case "point":a=new g(a.geometry);this.pointGraphics.add(a);break;case "polyline":a=new g(a.geometry);
this.polylineGraphics.add(a);break;case "polygon":a=new g(a.geometry,null,{ren:1}),this.polygonGraphics.add(a)}this.connectMapClick()},clearGraphics:function(){this.endDrawing();this.connectMapClick();this.drawModeTextNode.innerText="None"},stopDrawing:function(){this.drawToolbar.deactivate();this.drawModeTextNode.innerText="None";this.connectMapClick()},endDrawing:function(){this.pointGraphics.clear();this.polylineGraphics.clear();this.polygonGraphics.clear();this.drawToolbar.deactivate();this.disableStopButtons()},
disableStopButtons:function(){this.stopDrawingButton.set("disabled",!0);this.eraseDrawingButton.set("disabled",!this.noGraphics())},enableStopButtons:function(){this.stopDrawingButton.set("disabled",!1);this.eraseDrawingButton.set("disabled",!this.noGraphics())},noGraphics:function(){return 0<this.pointGraphics.graphics.length?!0:0<this.polylineGraphics.graphics.length?!0:0<this.polygonGraphics.graphics.length?!0:!1},onLayoutChange:function(a){a||"draw"===this.mapClickMode&&t.publish("mapClickMode/setDefault")},
setMapClickMode:function(a){this.mapClickMode=a}})})},"cmv/viewer/js/gis/dijit/Draw/nls/resource":function(){define({root:{labels:{point:"Point",circle:"Circle",polyline:"Polyline",freehandPolyline:"Freehand polyline",polygon:"Polygon",freehandPolygon:"Freehand polygon",stopDrawing:"Stop drawing",clearDrawing:"Clear drawing",currentDrawMode:"Current draw mode:",currentDrawModeNone:"None"}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/Measurement":function(){define("dojo/_base/declare dijit/_WidgetBase esri/dijit/Measurement dojo/aspect dojo/_base/lang dojo/dom-construct dojo/topic".split(" "),
function(h,l,a,d,b,f,k){return h([l],{declaredClass:"gis.dijit.Measurement",mapClickMode:null,postCreate:function(){this.inherited(arguments);this.measure=(new a({map:this.map,defaultAreaUnit:this.defaultAreaUnit,defaultLengthUnit:this.defaultLengthUnit},f.create("div"))).placeAt(this.domNode);this.measure.startup();d.after(this.measure,"setTool",b.hitch(this,"checkMeasureTool"));d.after(this.measure,"closeTool",b.hitch(this,"checkMeasureTool"));this.own(k.subscribe("mapClickMode/currentSet",b.hitch(this,
"setMapClickMode")));this.parentWidget&&this.parentWidget.toggleable&&this.own(d.after(this.parentWidget,"toggle",b.hitch(this,function(){this.onLayoutChange(this.parentWidget.open)})))},checkMeasureTool:function(){this.measure.activeTool&&""!==this.measure.activeTool?"measure"!==this.mapClickMode&&this.disconnectMapClick():"measure"===this.mapClickMode&&this.connectMapClick()},disconnectMapClick:function(){k.publish("mapClickMode/setCurrent","measure")},connectMapClick:function(){k.publish("mapClickMode/setDefault")},
onLayoutChange:function(a){a||"measure"!==this.mapClickMode||this.connectMapClick()},setMapClickMode:function(a){this.mapClickMode=a;"measure"!==a&&(this.measure.setTool("area",!1),this.measure.setTool("distance",!1),this.measure.setTool("location",!1),this.measure.clearResult())}})})},"esri/dijit/Measurement":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/debounce dojo/sniff dojo/dom-style dojo/dom-construct dojox/gfx dijit/_Widget dijit/registry dijit/Menu dijit/MenuItem ../symbols/PictureMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/jsonUtils ../geometry/geodesicUtils ../geometry/webMercatorUtils ../geometry/Point ../geometry/Polyline ../geometry/Polygon ../graphic ../tasks/AreasAndLengthsParameters ../tasks/LengthsParameters ../tasks/GeometryService ../kernel ../config ../domUtils ../numberUtils ../lang ../units ../WKIDUnitConversion ../SpatialReference dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ./_EventedWidget dojo/text!./templates/Measurement.html dojo/i18n!../nls/jsapi dijit/form/ToggleButton dijit/form/DropDownButton dijit/layout/ContentPane".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K,J,I,L,M,N,Q,O,T,S,R,U){l=l([S,n,O,T],{declaredClass:"esri.dijit.Measurement",widgetsInTemplate:!0,templateString:R,_map:null,_geometryService:null,_interpolatedMap:null,_mouseImgURL:null,_defaultPinURL:null,_measureGraphics:[],_measureGraphic:null,_locationGraphic:null,_tempGraphic:null,_polylineGraphics:null,_polygonGraphic:null,_pointSymbol:null,_useDefaultPointSymbol:!0,_defaultLineSymbol:null,_lineSymbol:null,_areaLineSymbol:null,
_defaultFillSymbol:null,_fillSymbol:null,_borderlessFillSymbol:null,_userGeometry:null,_currentGeometry:null,_inputPoints:[],_unitDictionary:[],numberPattern:"#,###,###,##0.0",result:null,_defaultDistanceUnit:null,_defaultAreaUnit:null,_defaultLocationUnit:null,currentDistanceUnit:null,currentAreaUnit:null,currentLocationUnit:null,_unitStrings:{},_locationUnitStrings:[],_locationUnitStringsLong:[],_distanceUnitStrings:[],_distanceUnitStringsLong:[],_areaUnitStrings:[],_areaUnitStringsLong:[],_calculatingMsg:null,
_gsErrorMsg:null,_NLS_Lat:null,_NLS_Lon:null,_mouseMoveMapHandler:null,_mouseClickMapHandler:null,_doubleClickMapHandler:null,_mouseDragMapHandler:null,_clickMapHandler:null,_mapExtentChangeHandler:null,_geometryAreaHandler:null,_snappingCallback:null,_calcTimer:null,_buttonDijits:{},previousTool:null,activeTool:null,markerLongitude:null,markerLatitude:null,mouseLongitude:null,mouseLatitude:null,_eventMap:{"measure-start":["toolName","unitName"],measure:["toolName","geometry","values","unitName",
"segmentLength"],"measure-end":["toolName","geometry","values","unitName"],"tool-change":["toolName","unitName","previousToolName"],"unit-change":["unitName","toolName"]},constructor:function(c,d){if(c=c||{},c.map){if(this._map=c.map,this._map.loaded)this._map.cs=this._checkCS(this._map.spatialReference),this._interpolatedMap=!("Web Mercator"===this._map.cs||"PCS"===this._map.cs);else var e=b.connect(this._map,"onLoad",this,function(){b.disconnect(e);e=null;this._map.cs=this._checkCS(this._map.spatialReference);
this._interpolatedMap=!("Web Mercator"===this._map.cs||"PCS"===this._map.cs)});this._geometryService=K.defaults.geometryService;this._mouseImgURL=h.toUrl("./images/cursor16x24.png");this._defaultPinURL=h.toUrl("./images/esriGreenPin16x26.png");this._defaultLineSymbol=new t(t.STYLE_SOLID,new f([0,128,255]),3);this._defaultFillSymbol=new w(t.STYLE_SOLID,new t(t.STYLE_SOLID,new f([0,128,255]),3),new f([0,0,0,.5]));c.pointSymbol?(this._pointSymbol=c.pointSymbol,this._useDefaultPointSymbol=!1):(this._pointSymbol=
new v(this._defaultPinURL,16,26),this._pointSymbol.setOffset(0,12));var g=c.fillSymbol||this._defaultFillSymbol;this._fillSymbol=g;this._areaLineSymbol=g.outline||this._defaultLineSymbol;this._borderlessFillSymbol=x.fromJson(g.toJson());this._borderlessFillSymbol.setOutline(null);c.lineSymbol?this._lineSymbol=c.lineSymbol:this._lineSymbol=this._defaultLineSymbol;c.defaultLengthUnit?this._defaultDistanceUnit=c.defaultLengthUnit:this._defaultDistanceUnit=M.MILES;c.defaultAreaUnit?this._defaultAreaUnit=
c.defaultAreaUnit:this._defaultAreaUnit=M.ACRES;c.defaultLocationUnit?this._defaultLocationUnit=c.defaultLocationUnit:this._defaultLocationUnit=M.DECIMAL_DEGREES;this._snappingCallback=a.hitch(this,this._snappingCallback);c.geometry&&(this._userGeometry=c.geometry);this._calcTimer=null;this.advancedLocationUnits=c.advancedLocationUnits||!1;this._NLS_Lon=U.widgets.measurement.NLS_longitude;this._NLS_Lat=U.widgets.measurement.NLS_latitude;this._gsErrorMsg=U.widgets.measurement.NLS_geometry_service_error;
this._calculatingMsg=U.widgets.measurement.NLS_calculating;this._geometryServiceLength=k(this._geometryServiceLength,250)}},startup:function(){if(this._setupDictionaries(),e.create("img",{src:this._mouseImgURL,style:"vertical-align:middle"},this.mouseCell),this._useDefaultPointSymbol?e.create("img",{src:this._defaultPinURL,style:"vertical-align:middle"},this.pinCell):this._drawPointGraphics(this.pinCell),this._userGeometry)if(this._map.loaded)this._measureCustomGeometry(this._userGeometry),this._userGeometry=
null;else var a=b.connect(this._map,"onLoad",this,function(){b.disconnect(a);a=null;this._measureCustomGeometry(this._userGeometry);this._userGeometry=null})},destroy:function(){this._resetToolState();this.clearResult();this.inherited(arguments);this._map=this._geometryService=this._measureGraphics=this._measureGraphic=this._tempGraphic=null},setTool:function(a,b){this.previousTool=this.activeTool||null;this._polylineGraphics=[];this._resetToolState();this._polygonGraphic&&(this._map.graphics.remove(this._polygonGraphic),
this._polygonGraphic=null);var c=q.byNode(this._buttonDijits[a].domNode).checked;g.set(this._unitDropDown.domNode,"visibility","visible");q.byNode(this._buttonDijits.area.domNode).set("checked",!1);q.byNode(this._buttonDijits.distance.domNode).set("checked",!1);q.byNode(this._buttonDijits.location.domNode).set("checked",!1);!0!==b&&!1!==b||(c=b);q.byNode(this._buttonDijits[a].domNode).set("checked",c);this._toggleLocationResultsTable(!1,!0);c?(this.activeTool=a,this._dblClickZoom=this._map.isDoubleClickZoom,
this._dblClickZoom&&this._map.disableDoubleClickZoom(),"area"===a?this._setupAreaTool():"distance"===a?this._setupDistanceTool():"location"===a&&this._setupLocationTool(),this._map.snappingManager&&(this._map.snappingManager._startSelectionLayerQuery(),this._map.snappingManager._setUpSnapping())):(this.activeTool=null,g.set(this._unitDropDown.domNode,"visibility","hidden"));this.activeTool!==this.previousTool&&this.onToolChange(this.activeTool,this.getUnit(),this.previousTool)},measure:function(a){a&&
this._measureCustomGeometry(a)},clearResult:function(){var a,c=this._map;this.result=0;this.resultValue.setContent("\x26nbsp");for(a=0;a<this._measureGraphics.length;a++)c.graphics.remove(this._measureGraphics[a]);this._measureGraphic=this._currentGeometry=null;this._measureGraphics=[];c.graphics.remove(this._tempGraphic);b.disconnect(this._mouseMoveMapHandler);this._mouseMoveMapHandler=null},show:function(){J.show(this.domNode)},hide:function(){J.hide(this.domNode)},showTool:function(a){g.set(this._buttonDijits[a].domNode,
"display","inline-block")},hideTool:function(a){g.set(this._buttonDijits[a].domNode,"display","none")},getTool:function(){return this.activeTool?{toolName:this.activeTool,unitName:this.getUnit()}:void 0},getUnit:function(){return"unit"!==this._unitDropDown.label?this._unitDropDown.label:void 0},_setupLocationTool:function(){this._map.navigationManager.setImmediateClick(!0);this._measureGraphics=[];this._map.graphics.remove(this._locationGraphic);this._createLocationUnitList();"PCS"===this._map.cs&&
(this._projectMapExtent(this._map.extent),this._mapExtentChangeHandler=b.connect(this._map,"onExtentChange",a.hitch(this,this._projectMapExtent)));this._clickMapHandler=b.connect(this._map,"onClick",this,"_locationClickHandler");"esriDegreeMinuteSeconds"!==this.currentLocationUnit&&"esriDecimalDegrees"!==this.currentLocationUnit||(this._mouseMoveMapHandler=b.connect(this._map,"onMouseMove",this,"_locationMoveHandler"))},_locationButtonToggle:function(){this.clearResult();this.setTool("location")},
_measureCustomPoint:function(a){this.setTool("location",!0);"Web Mercator"===this._map.cs&&a.spatialReference!==this._map.spatialReference&&(a=z.geographicToWebMercator(a));this._measureGraphic=new D;this._measureGraphic.setSymbol(this._pointSymbol);this._measureGraphic.setGeometry(a);this._measureGraphics.push(this._measureGraphic);this._map.graphics.add(this._measureGraphic);this._currentGeometry=a;this._calculateLocation(a,!0)},_calculateLocation:function(c,d){var e=!("esriDegreeMinuteSeconds"===
this.currentLocationUnit||"esriDecimalDegrees"===this.currentLocationUnit);e&&this._mouseMoveMapHandler&&(b.disconnect(this._mouseMoveMapHandler),this._mouseMoveMapHandler=null);var f=a.clone(c);if(d){if("Web Mercator"!==this.map.cs&&this.map.spatialReference&&4326!==this.map.spatialReference.wkid)return void this._projectLocation(f,e);this._updateMarkerLocation(f.x,f.y)}f=this._getGCSLocation(f);this._advancedLocationDisplayHandler(f,e,d)},_projectLocation:function(b,c){this._geometryService.project([b],
new Q({wkid:4326}),a.hitch(this,function(a){this._advancedLocationDisplayHandler(a[0],c,!0)}),a.hitch(this,function(a){}))},_advancedLocationDisplayHandler:function(a,b,c){var d;b?this._updateGeocoordinateStringLocation({coordinates:[[a.x,a.y]],sr:{wkid:4326},conversionType:this._unitStrings[this.currentLocationUnit]},a):(d=this._calculateXY(a.x,a.y),c?(this._updateClickLocation(d[0],d[1]),this.onMeasureEnd(this.activeTool,a,[d[0],d[1]],this.getUnit())):this._updateMouseLocation(d[0],d[1]))},_updateMarkerLocation:function(a,
b){this.markerLocationX=a;this.markerLocationY=b},_updateMouseLocation:function(a,b){this.mouseLongitude.innerHTML=a;this.mouseLatitude.innerHTML=b},_updateClickLocation:function(a,b){this._updateMouseLocation(a,b);this.markerLongitude.innerHTML=a;this.markerLatitude.innerHTML=b},_updateGeocoordinateStringLocation:function(b,c){this.resultValue.setContent("\x26nbsp");this._geometryService.toGeoCoordinateString(b,a.hitch(this,function(a){clearTimeout(this._calcTimer);a?(this.resultValue.setContent(a[0]),
this.onMeasureEnd(this.activeTool,c,a,this.getUnit())):(this.resultValue.setContent(this._gsErrorMsg),this.onMeasureEnd(this.activeTool,null,null,this.getUnit()))}));clearTimeout(this._calcTimer);this._calcTimer=setTimeout(a.hitch(this,function(){this.resultValue.setContent(this._calculatingMsg)},1E3))},_switchLocationUnit:function(a){if(q.byNode(this._unitDropDown.domNode).set("label",this._unitStrings[a]),this.currentLocationUnit=a,b.disconnect(this._mouseMoveMapHandler),this._mouseMoveMapHandler=
null,this.onUnitChange(this._unitStrings[a],this.activeTool),"esriDegreeMinuteSeconds"===a||"esriDecimalDegrees"===a)this._mouseMoveMapHandler=b.connect(this._map,"onMouseMove",this,"_locationMoveHandler"),this._toggleLocationResultsTable(!0,!1),this._locationGraphic&&this._calculateLocation(this._locationGraphic.geometry,!0);else if((this._toggleLocationResultsTable(!1,!1),null!==this.resultValue&&(null!==this.markerLocationX||null!==this.markerLocationY))&&this._locationGraphic){var c=this._getGCSLocation(this._locationGraphic.geometry);
this._updateGeocoordinateStringLocation({coordinates:[[c.x,c.y]],sr:{wkid:4326},conversionType:this._unitStrings[a]},this._locationGraphic.geometry)}},_toggleLocationResultsTable:function(a,c){c&&(this.resultValue.setContent("\x26nbsp"),this.markerLongitude.innerHTML="---",this.markerLatitude.innerHTML="---",this.mouseLongitude.innerHTML="---",this.mouseLatitude.innerHTML="---");a?(J.show(this.resultTable.domNode),J.hide(this.resultValueContainer.domNode)):(J.hide(this.resultTable.domNode),J.show(this.resultValueContainer.domNode),
b.disconnect(this._mouseMoveMapHandler));"PCS"===this._map.cs&&J.hide(this._mouseRow)},_setupDistanceTool:function(){this._map.navigationManager.setImmediateClick(!0);"PCS"===this._map.cs&&(this._projectMapExtent(this._map.extent),this._mapExtentChangeHandler=b.connect(this._map,"onExtentChange",this,"_projectMapExtent"));this._inputPoints=[];this._createDistanceUnitList();this._mouseClickMapHandler=b.connect(this._map,"onClick",this,"_measureDistanceMouseClickHandler");this._doubleClickMapHandler=
b.connect(this._map,"onDblClick",this,"_measureDistanceDblClickHandler")},_distanceButtonToggle:function(){this.clearResult();this.setTool("distance")},_measureCustomDistance:function(b){if(1<b.paths[0].length){this.setTool("distance",!0);this._inputPoints=[];d.forEach(b.paths[0],a.hitch(this,function(a,c){this._inputPoints.push(a);var d=new D(new A(a[0],a[1],b.spatialReference),this._pointSymbol);this._measureGraphics.push(d);this._map.graphics.add(d);0!==c&&(this.result+=this._geodesicDistance(a,
b.paths[0][c-1]))}));this._measureGraphic=new D;this._measureGraphic.setSymbol(this._lineSymbol);this._measureGraphics.push(this._measureGraphic);var c=this._densifyGeometry(b);this._measureGraphic.setGeometry(c);this._map.graphics.add(this._measureGraphic);this._inputPoints=[];c=this._outputResult(this.result,this.getUnit());this._currentGeometry=b;this.onMeasureEnd(this.activeTool,b,c,this.getUnit())}},_showDistance:function(a){a&&this._outputResult(a,q.byNode(this._unitDropDown.domNode).label)},
_setupAreaTool:function(){this._map.navigationManager.setImmediateClick(!0);this._inputPoints=[];this._createAreaUnitList();this._tempGraphic=new D;this._tempGraphic.setSymbol(this._areaLineSymbol);this._tempGraphic.setGeometry(new B(this._map.spatialReference));this._map.graphics.add(this._tempGraphic);"PCS"===this._map.cs&&(this._geometryAreaHandler=b.connect(this._geometryService,"onAreasAndLengthsComplete",this,"_outputArea"));this._mouseClickMapHandler=b.connect(this._map,"onClick",this,"_measureAreaMouseClickHandler");
this._doubleClickMapHandler=b.connect(this._map,"onDblClick",this,"_measureAreaDblClickHandler")},_areaButtonToggle:function(){this.clearResult();this.setTool("area")},_generatePolygonFromPaths:function(){var b=[];d.forEach(this._polylineGraphics,a.hitch(this,function(c){d.forEach(c.geometry.paths,a.hitch(this,function(c){d.forEach(c,a.hitch(this,function(a){b.push(a)}))}))}));b.push(b[0]);var c=new C(this._map.spatialReference);c.addRing(b);var c=this._densifyGeometry(c),e=new D;return e.setGeometry(c),
e.setSymbol(this._borderlessFillSymbol),this._measureGraphic=e,this._measureGraphics.push(e),e},_getArea:function(b){var c=[],e=new E;if(e.areaUnit=H.UNIT_SQUARE_METERS,e.calculationType="geodesic",C.prototype.isSelfIntersecting(b))this._geometryService.simplify([b],a.hitch(this,function(b){d.forEach(b,a.hitch(this,function(a){return"PCS"===this._map.cs?(e.polygons=b,void this._geometryService.areasAndLengths(e)):("Web Mercator"===this._map.cs&&(a=z.webMercatorToGeographic(a)),void c.push(a))}));
var f=y.geodesicAreas(c,M.SQUARE_METERS);this._showArea(f[0])}));else{if("Web Mercator"===this._map.cs&&(b=z.webMercatorToGeographic(b)),c.push(b),"PCS"===this._map.cs)return e.polygons=c,void this._geometryService.areasAndLengths(e);b=y.geodesicAreas(c,M.SQUARE_METERS);this._showArea(Math.abs(b[0]))}},_outputArea:function(a){this._showArea(Math.abs(a.areas[0]))},_showArea:function(a){a&&(this.result=a,a=q.byNode(this._unitDropDown.domNode).label,a=this._outputResult(this.result,a),this._mouseMoveMapHandler?
this.onMeasure(this.activeTool,this._currentGeometry,a,this.getUnit(),null):this.onMeasureEnd(this.activeTool,this._currentGeometry,a,this.getUnit()))},_measureCustomArea:function(a){this.setTool("area",!0);this._inputPoints=[];var b=this._densifyGeometry(a);this._currentGeometry=a;this._measureGraphic=new D;this._measureGraphic.setGeometry(b);this._measureGraphic.setSymbol(this._fillSymbol);this._measureGraphics.push(this._measureGraphic);this._map.graphics.add(this._measureGraphic);this._getArea(a);
this._inputPoints=[]},_resetToolState:function(){var a=this._map;a.navigationManager.setImmediateClick(!1);this._dblClickZoom&&a.enableDoubleClickZoom();this._inputPoints=[];b.disconnect(this._mouseClickMapHandler);b.disconnect(this._mouseMoveMapHandler);b.disconnect(this._doubleClickMapHandler);b.disconnect(this._mouseDragMapHandler);b.disconnect(this._clickMapHandler);b.disconnect(this._mapExtentChangeHandler);b.disconnect(this._geometryAreaHandler);this._mouseClickMapHandler=this._mouseMoveMapHandler=
this._doubleClickMapHandler=this._mouseDragMapHandler=this._clickMapHandler=this._mapExtentChangeHandler=this._geometryAreaHandler=null;a.snappingManager&&a.snappingManager._snappingGraphic&&a.graphics.remove(a.snappingManager._snappingGraphic);this._map.snappingManager&&(this._map.snappingManager._stopSelectionLayerQuery(),this._map.snappingManager._killOffSnapping());this._unitDropDown._opened&&this._unitDropDown.closeDropDown()},_measureCustomGeometry:function(a){switch(this.clearResult(),a.type){case "point":this._measureCustomPoint(a);
break;case "polyline":this._measureCustomDistance(a);break;case "polygon":this._measureCustomArea(a)}},_densifyGeometry:function(a){"Web Mercator"===this._map.cs&&(a=z.webMercatorToGeographic(a));var b;return b="PCS"===this._map.cs?a:y.geodesicDensify(a,5E5),"Web Mercator"===this._map.cs&&(b=z.geographicToWebMercator(b)),b},_geodesicDistance:function(a,b){var c=new B(this._map.spatialReference);return"PCS"===this._map.cs&&(a=this._getGCSLocation(a),b=this._getGCSLocation(b)),c.addPath([a,b]),"Web Mercator"===
this._map.cs&&(c=z.webMercatorToGeographic(c)),y.geodesicLengths([c],M.METERS)[0]},_calculateXY:function(a,b){var c,d,e=U.widgets.measurement,f=this._map.getScale();if(this.getUnit()===e.NLS_decimal_degrees)d=500<=f?6:500>f&&50<=f?7:50>f&&5<=f?8:9,c=a.toFixed(d),this._map.spatialReference._isWrappable()||(c=this._roundX(c)),c=I.format(c),d=I.format(this._roundY(b.toFixed(d)));else if(this.getUnit()===e.NLS_deg_min_sec){var g,k,h,m,l=e=!1;d=9E4<=f?0:9E4>f&&9E3<=f?1:9E3>f&&900<=f?2:900>f&&90<f?3:4;
0>a&&(e=!0,a=Math.abs(a));0>b&&(l=!0,b=Math.abs(b));b=this._roundY(b);this._map.spatialReference._isWrappable()||(a=this._roundX(a));g=Math.floor(b)+"\u00b0";c=Math.floor(a)+"\u00b0";k=Math.floor(this._getDegreeMinutes(b))+"'";f=Math.floor(this._getDegreeMinutes(a))+"'";h=I.format(this._getDegreeSeconds(b).toFixed(d))+'"';m=I.format(this._getDegreeSeconds(a).toFixed(d))+'"';d=g+k+h;c=c+f+m;e&&(c="-"+c);l&&(d="-"+d)}return[c,d]},_getDegreeMinutes:function(a){return 60*(a-Math.floor(a))},_getDegreeSeconds:function(a){return 60*
(60*(a-Math.floor(a))-Math.floor(60*(a-Math.floor(a))))},_roundY:function(a){return 90<a?a=90:-90>a&&(a=-90),a},_roundX:function(a){return 180<a?a=180:-180>a&&(a=-180),a},_getGCSLocation:function(b){b=a.clone(b);if("Web Mercator"===this._map.cs)b=z.webMercatorToGeographic(b);else if("PCS"===this._map.cs){if(this._map._newExtent){var c=Math.abs((this._map._newExtent.xmax-this._map._newExtent.xmin)/(this._map.extent.xmax-this._map.extent.xmin)),d=Math.abs((this._map._newExtent.ymax-this._map._newExtent.ymin)/
(this._map.extent.ymax-this._map.extent.ymin));b=new A((b.x-this._map.extent.xmin)*c+this._map._newExtent.xmin,(b.y-this._map.extent.ymin)*d+this._map._newExtent.ymin,this._map.spatialReference)}}else b=b.normalize();return b},_projectMapExtent:function(c){c=new D(c);var d=new Q({wkid:4326});this._geometryService.project([c.geometry],d,a.hitch(this,function(c){this._mouseMoveMapHandler||"location"!==this.activeTool||(("esriDegreeMinuteSeconds"===this.currentLocationUnit||"esriDecimalDegrees"===this.currentLocationUnit)&&
(this._mouseMoveMapHandler=b.connect(this._map,"onMouseMove",a.hitch(this,this._locationMoveHandler))),this._mouseMoveMapHandler=b.connect(this._map,"onMouseMove",a.hitch(this,this._locationMoveHandler)));this._map._newExtent=c[0]}))},_checkCS:function(a){return a.wkid?3857===a.wkid||102100===a.wkid||102113===a.wkid?"Web Mercator":L.isDefined(N[a.wkid])?"PCS":"GCS":a.wkt?-1!==a.wkt.indexOf("WGS_1984_Web_Mercator")?"Web Mercator":0===a.wkt.indexOf("PROJCS")?"PCS":"GCS":void 0},_switchUnit:function(a){if("distance"===
this.activeTool?this.currentDistanceUnit=a:"area"===this.activeTool?this.currentAreaUnit=a:"location"===this.activeTool&&(this.currentLocationUnit=a),q.byNode(this._unitDropDown.domNode).set("label",this._unitStrings[a]),null!==this.result){var b=this._outputResult(this.result,this._unitStrings[a]);if(this.onUnitChange(this._unitStrings[a],this.activeTool),null!==this._currentGeometry||null!==this._measureGraphic)a=this._currentGeometry||this._measureGraphic.geometry,this._mouseMoveMapHandler?this.onMeasure(this.activeTool,
a,b,this.getUnit(),null):this.onMeasureEnd(this.activeTool,a,b,this.getUnit())}},_setupDictionaries:function(){var a=U.widgets.measurement;this._unitDictionary[a.NLS_length_meters]=1;this._unitDictionary[a.NLS_length_kilometers]=1E3;this._unitDictionary[a.NLS_length_feet]=.3048;this._unitDictionary[a.NLS_length_miles]=1609.344;this._unitDictionary[a.NLS_length_yards]=.9144;this._unitDictionary[a.NLS_length_nautical_miles]=1852;this._unitDictionary[a.NLS_length_miles_us]=1609.347218694438;this._unitDictionary[a.NLS_length_feet_us]=
.3048006096012192;this._unitDictionary[a.NLS_length_yards_us]=.9144018288036576;this._unitDictionary[a.NLS_area_sq_meters]=1;this._unitDictionary[a.NLS_area_sq_kilometers]=1E6;this._unitDictionary[a.NLS_area_sq_feet]=.09290304;this._unitDictionary[a.NLS_area_acres]=4046.8564224;this._unitDictionary[a.NLS_area_sq_miles]=2589988.110336;this._unitDictionary[a.NLS_area_hectares]=1E4;this._unitDictionary[a.NLS_area_sq_yards]=.83612736;this._unitDictionary[a.NLS_area_sq_nautical_miles]=3429904;this._unitDictionary[a.NLS_area_acres_us]=
4046.872609874252;this._unitDictionary[a.NLS_area_sq_miles_us]=2589998.470319522;this._unitDictionary[a.NLS_area_sq_feet_us]=.09290341161327487;this._unitDictionary[a.NLS_area_sq_yards_us]=.8361307045194736;this._unitStrings={esriMiles:a.NLS_length_miles,esriKilometers:a.NLS_length_kilometers,esriFeet:a.NLS_length_feet,esriFeetUS:a.NLS_length_feet_us,esriMeters:a.NLS_length_meters,esriYards:a.NLS_length_yards,esriNauticalMiles:a.NLS_length_nautical_miles,esriMilesUS:a.NLS_length_miles_us,esriYardsUS:a.NLS_length_yards_us,
esriAcres:a.NLS_area_acres,esriSquareMiles:a.NLS_area_sq_miles,esriSquareKilometers:a.NLS_area_sq_kilometers,esriHectares:a.NLS_area_hectares,esriSquareYards:a.NLS_area_sq_yards,esriSquareFeet:a.NLS_area_sq_feet,esriSquareFeetUS:a.NLS_area_sq_feet_us,esriSquareMeters:a.NLS_area_sq_meters,esriAcresUS:a.NLS_area_acres_us,esriSquareMilesUS:a.NLS_area_sq_miles_us,esriSquareYardsUS:a.NLS_area_sq_yards_us,esriSquareNauticalMiles:a.NLS_area_sq_nautical_miles,esriDecimalDegrees:a.NLS_decimal_degrees,esriDegreeMinuteSeconds:a.NLS_deg_min_sec,
esriMGRS:a.NLS_MGRS,esriUSNG:a.NLS_USNG,esriUTM:a.NLS_UTM,esriGARS:a.NLS_GARS,esriGeoRef:a.NLS_GeoRef,esriDDM:a.NLS_DDM,esriDD:a.NLS_DD};this._locationUnitStrings=[a.NLS_decimal_degrees,a.NLS_deg_min_sec,a.NLS_MGRS,a.NLS_USNG,a.NLS_UTM,a.NLS_GeoRef,a.NLS_GARS];this._locationUnitStringsLong="esriDecimalDegrees esriDegreeMinuteSeconds esriMGRS esriUSNG esriUTM esriGeoRef esriGARS".split(" ");this._distanceUnitStrings=[a.NLS_length_miles,a.NLS_length_kilometers,a.NLS_length_feet,a.NLS_length_feet_us,
a.NLS_length_meters,a.NLS_length_yards,a.NLS_length_nautical_miles];this._distanceUnitStringsLong="esriMiles esriKilometers esriFeet esriFeetUS esriMeters esriYards esriNauticalMiles".split(" ");this._areaUnitStrings=[a.NLS_area_acres,a.NLS_area_sq_miles,a.NLS_area_sq_kilometers,a.NLS_area_hectares,a.NLS_area_sq_yards,a.NLS_area_sq_feet,a.NLS_area_sq_feet_us,a.NLS_area_sq_meters];this._areaUnitStringsLong="esriAcres esriSquareMiles esriSquareKilometers esriHectares esriSquareYards esriSquareFeet esriSquareFeetUS esriSquareMeters".split(" ");
this._buttonDijits={area:this._areaButton,distance:this._distanceButton,location:this._locationButton};q.byNode(this._distanceButton.domNode).setLabel(a.NLS_distance);q.byNode(this._areaButton.domNode).setLabel(a.NLS_area);q.byNode(this._locationButton.domNode).setLabel(a.NLS_location);q.byNode(this.resultLabel.domNode).setContent(a.NLS_resultLabel)},onToolChange:function(){},onUnitChange:function(){},onMeasureStart:function(){},onMeasure:function(){},onMeasureEnd:function(){},_measureAreaMouseClickHandler:function(a){var c;
this._map.snappingManager&&(c=this._map.snappingManager._snappingPoint);c=c||a.mapPoint;if(this._inputPoints.push(c),this._currentStartPt=c,1===this._inputPoints.length){this._tempGraphic.setGeometry(new B(this._map.spatialReference));for(a=0;a<this._measureGraphics.length;a++)this._map.graphics.remove(this._measureGraphics[a]);this._measureGraphics=[];this.result=0;this._outputResult(this.result,U.widgets.measurement.NLS_area_sq_meters);this._mouseMoveMapHandler=b.connect(this._map,"onMouseMove",
this,"_measureAreaMouseMoveHandler");this.onMeasureStart(this.activeTool,this.getUnit())}if(this._measureGraphic=new D,this._measureGraphic.setSymbol(this._areaLineSymbol),this._measureGraphics.push(this._measureGraphic),1<this._inputPoints.length){a=new B(this._map.spatialReference);a.addPath([this._inputPoints[this._inputPoints.length-2],c]);var d=new B(this._map.spatialReference);d.addPath([this._inputPoints[0],c]);c=this._densifyGeometry(a);d=this._densifyGeometry(d);this._tempGraphic.setGeometry(d);
this._measureGraphic.setGeometry(c);this._map.graphics.add(this._measureGraphic);c=new D;if(c.setGeometry(a),this._polylineGraphics.push(c),2<this._inputPoints.length){c=new C(this._map.spatialReference);d=[];for(a=0;a<this._inputPoints.length;a++)d.push([this._inputPoints[a].x,this._inputPoints[a].y]);d.push([this._inputPoints[0].x,this._inputPoints[0].y]);c.addRing(d);this._currentGeometry=c;this._polygonGraphic?(this._map.graphics.remove(this._polygonGraphic),this._polylineGraphics.push(this._tempGraphic),
this._polygonGraphic=this._generatePolygonFromPaths(),this._map.graphics.add(this._polygonGraphic),this._measureGraphic=this._polygonGraphic,this._polylineGraphics.pop()):(this._polygonGraphic=this._generatePolygonFromPaths(),this._map.graphics.add(this._polygonGraphic));this._getArea(c)}}else this._polygonGraphic&&(this._map.graphics.remove(this._polygonGraphic),this._polygonGraphic=null)},_measureAreaMouseMoveHandler:function(a){var b;if(0<this._inputPoints.length){var c,d=new B(this._map.spatialReference);
this._map.snappingManager&&(c=this._map.snappingManager._snappingPoint);b=c||a.mapPoint;d.addPath([this._currentStartPt,b]);a=this._densifyGeometry(d);this._tempGraphic.setGeometry(a)}1<this._inputPoints.length&&(a=new B(this._map.spatialReference),a.addPath([b,this._inputPoints[0]]),b=this._densifyGeometry(a),this._tempGraphic.setGeometry(this._tempGraphic.geometry.addPath(b.paths[0])))},_measureAreaDblClickHandler:function(a){b.disconnect(this._mouseMoveMapHandler);this._mouseMoveMapHandler=null;
"touch"===this._map.navigationManager.eventModel&&m("ios")&&this._measureAreaMouseClickHandler(a);var c=new C(this._map.spatialReference),d=[];for(a=0;a<this._inputPoints.length;a++)d.push([this._inputPoints[a].x,this._inputPoints[a].y]);d.push([this._inputPoints[0].x,this._inputPoints[0].y]);c.addRing(d);this._inputPoints=[];this._currentGeometry=c;this._polygonGraphic&&(this._map.graphics.remove(this._polygonGraphic),this._polylineGraphics.push(this._tempGraphic),this._polygonGraphic=this._generatePolygonFromPaths(),
this._map.graphics.add(this._polygonGraphic));this._getArea(c);this._polylineGraphics=[]},_measureDistanceMouseClickHandler:function(a){var c;this._map.snappingManager&&(c=this._map.snappingManager._snappingPoint);a=c||a.mapPoint;if(this._inputPoints.push(a),this._currentStartPt=a,1===this._inputPoints.length){for(c=0;c<this._measureGraphics.length;c++)this._map.graphics.remove(this._measureGraphics[c]);this._map.graphics.remove(this._tempGraphic);this._measureGraphics=[];this.result=0;this._outputResult(this.result,
U.widgets.measurement.NLS_length_meters);this._tempGraphic=new D;this._tempGraphic.setSymbol(this._lineSymbol);this._map.graphics.add(this._tempGraphic);this._mouseMoveMapHandler=b.connect(this._map,"onMouseMove",this,"_measureDistanceMouseMoveHandler");this.onMeasureStart(this.activeTool,this.getUnit())}this._tempGraphic.setGeometry(new B(this._map.spatialReference));c=new D;if(c.setSymbol(this._pointSymbol),c.setGeometry(a),this._measureGraphics.push(c),this._map.graphics.add(c),1<this._inputPoints.length){this._measureGraphic=
new D;this._measureGraphic.setSymbol(this._lineSymbol);this._measureGraphics.push(this._measureGraphic);c=new B(this._map.spatialReference);c.addPath([this._inputPoints[this._inputPoints.length-2],a]);var d=this._densifyGeometry(c);(this._measureGraphic.setGeometry(d),this._map.graphics.add(this._measureGraphic),"PCS"===this._map.cs)?this._geometryServiceLength(c,!1):(d=this._geodesicDistance(this._inputPoints[this._inputPoints.length-2],a),c=this._outputResult(d,this.getUnit()),this.result+=d,this._showDistance(this.result),
d=this._outputResult(this.result,this.getUnit()),this.onMeasure(this.activeTool,a,d,this.getUnit(),c))}else c.setSymbol(this._pointSymbol)},_measureDistanceMouseMoveHandler:function(a){if(0<this._inputPoints.length){var b,c=new B(this._map.spatialReference);this._map.snappingManager&&(b=this._map.snappingManager._snappingPoint);a=b||a.mapPoint;c.addPath([this._currentStartPt,a]);c=this._densifyGeometry(c);if(this._tempGraphic.setGeometry(c),"PCS"!==this._map.cs)b=this._geodesicDistance(this._currentStartPt,
a),c=this._outputResult(b,this.getUnit()),b+=this.result,this._showDistance(b),b=this._outputResult(b,this.getUnit()),this.onMeasure(this.activeTool,a,b,this.getUnit(),c)}},_measureDistanceDblClickHandler:function(a){var c;b.disconnect(this._mouseMoveMapHandler);this._mouseMoveMapHandler=null;"touch"===this._map.navigationManager.eventModel&&m("ios")&&this._measureDistanceMouseClickHandler(a);a=new B(this._map.spatialReference);a.addPath(this._inputPoints);this._currentGeometry=a;c=this._densifyGeometry(a);
this._measureGraphic.geometry=c;"PCS"===this._map.cs?this._geometryServiceLength(a,!0):(this._inputPoints=[],this.onMeasureEnd(this.activeTool,a,this._outputResult(this.result,this.getUnit()),this.getUnit()))},_geometryServiceLength:function(b,c){var d=new F;d.polylines=[b];d.lengthUnit=9001;d.calculationType="geodesic";this._geometryService.lengths(d,a.hitch(this,function(a){a=a.lengths[0];if(c)this.result=a,this._showDistance(this.result),this._inputPoints=[],this.onMeasureEnd(this.activeTool,b,
this._outputResult(this.result,this.getUnit()),this.getUnit());else{var d=this._outputResult(a,this.getUnit());this.result+=a;this._showDistance(this.result);this.onMeasure(this.activeTool,b,this._outputResult(this.result,this.getUnit()),this.getUnit(),d)}}))},_locationClickHandler:function(a){var b;this._map.snappingManager&&(b=this._map.snappingManager._snappingPoint);a=b||a.mapPoint;this._locationButtonToggle();this._locationGraphic=new D;this._locationGraphic.setGeometry(a);this._locationGraphic.setSymbol(this._pointSymbol);
this._map.graphics.add(this._locationGraphic);this._measureGraphics.push(this._locationGraphic);this._calculateLocation(a,!0)},_locationMoveHandler:function(a){var b;this._map.snappingManager&&(b=this._map.snappingManager._snappingPoint);this._calculateLocation(b||a.mapPoint,!1)},_outputResult:function(a,b){var c=a/this._unitDictionary[b];return 0===c?this.resultValue.setContent("\x26nbsp"):1E6<c?this.resultValue.setContent(I.format(c.toPrecision(9),{pattern:this.numberPattern})+" "+b):10>c?this.resultValue.setContent(I.format(c.toFixed(2),
{pattern:this.numberPattern+"0"})+" "+b):this.resultValue.setContent(I.format(c.toFixed(2),{pattern:this.numberPattern})+" "+b),c},_createDistanceUnitList:function(){var b,c=new r({style:"display: none;"});d.forEach(this._distanceUnitStrings,a.hitch(this,function(b,d){var e=new u({label:b,onClick:a.hitch(this,function(){this._switchUnit(this._distanceUnitStringsLong[d])})});e.set("class","unitDropDown");c.addChild(e)}));q.byNode(this._unitDropDown.domNode).set("dropDown",c);this.currentDistanceUnit?
(b=this._unitStrings[this.currentDistanceUnit],q.byNode(this._unitDropDown.domNode).set("label",b)):(b=this._unitStrings[this._defaultDistanceUnit],q.byNode(this._unitDropDown.domNode).set("label",b),this.currentDistanceUnit=this._defaultDistanceUnit)},_createAreaUnitList:function(){var b,c=new r({style:"display: none;"});d.forEach(this._areaUnitStrings,a.hitch(this,function(b,d){var e=new u({label:b,onClick:a.hitch(this,function(){this._switchUnit(this._areaUnitStringsLong[d])})});e.set("class",
"unitDropDown");c.addChild(e)}));q.byNode(this._unitDropDown.domNode).set("dropDown",c);this.currentAreaUnit?(b=this._unitStrings[this.currentAreaUnit],q.byNode(this._unitDropDown.domNode).set("label",b)):(b=this._unitStrings[this._defaultAreaUnit],q.byNode(this._unitDropDown.domNode).set("label",b),this.currentAreaUnit=this._defaultAreaUnit)},_createLocationUnitList:function(){var b;b=this._locationUnitStrings;var c=new r({style:"display: none;"});null!==this._geometryService&&!1!==this.advancedLocationUnits||
(b=b.slice(0,2));d.forEach(b,a.hitch(this,function(b,d){var e=new u({label:b,onClick:a.hitch(this,function(){this._switchLocationUnit(this._locationUnitStringsLong[d])})});e.set("class","unitDropDown");c.addChild(e)}));q.byNode(this._unitDropDown.domNode).set("dropDown",c);this.currentLocationUnit||(this.currentLocationUnit=this._defaultLocationUnit);b=this._unitStrings[this.currentLocationUnit];q.byNode(this._unitDropDown.domNode).set("label",b);"esriDegreeMinuteSeconds"!==this.currentLocationUnit&&
"esriDecimalDegrees"!==this.currentLocationUnit||this._toggleLocationResultsTable(!0,!1)},_drawPointGraphics:function(b){var d,f,k=this._pointSymbol;b=e.create("div",{"class":"esriLocationResultSymbol"},b);b=c.createSurface(b,10,10);9>m("ie")&&(d=b.getEventSource(),g.set(d,"position","relative"),g.set(d.parentNode,"position","relative"));d=k.getShapeDescriptors();try{f=b.createShape(d.defaultShape).setFill(d.fill).setStroke(d.stroke)}catch(h){return b.clear(),void b.destroy()}var l=f.getBoundingBox();
d=l.width;var k=l.height,n=-(l.x+d/2),l=-(l.y+k/2);b=b.getDimensions();b={dx:n+b.width/2,dy:l+b.height/2};if(10<d||10<k)d=5/(d/10>k/10?d:k),a.mixin(b,{xx:d,yy:d});f.applyTransform(b)}});return m("extend-esri")&&a.setObject("dijit.Measurement",l,G),l})},"esri/tasks/AreasAndLengthsParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel".split(" "),function(h,l,a,d,b,f){h=h(null,{declaredClass:"esri.tasks.AreasAndLengthsParameters",polygons:null,
lengthUnit:null,areaUnit:null,calculationType:null,toJson:function(){var b=a.map(this.polygons,function(a){return a.toJson()}),f={};f.polygons=d.toJson(b);b=this.polygons[0].spatialReference;return f.sr=b.wkid?b.wkid:d.toJson(b.toJson()),this.lengthUnit&&(f.lengthUnit=this.lengthUnit),this.areaUnit&&(l.isString(this.areaUnit)?f.areaUnit=d.toJson({areaUnit:this.areaUnit}):f.areaUnit=this.areaUnit),this.calculationType&&(f.calculationType=this.calculationType),f}});return b("extend-esri")&&l.setObject("tasks.AreasAndLengthsParameters",
h,f),h})},"esri/tasks/LengthsParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel".split(" "),function(h,l,a,d,b,f){h=h(null,{declaredClass:"esri.tasks.LengthsParameters",polylines:null,lengthUnit:null,geodesic:null,calculationType:null,toJson:function(){var b=a.map(this.polylines,function(a){return a.toJson()}),f={};f.polylines=d.toJson(b);b=this.polylines[0].spatialReference;return f.sr=b.wkid?b.wkid:d.toJson(b.toJson()),this.lengthUnit&&
(f.lengthUnit=this.lengthUnit),this.geodesic&&(f.geodesic=this.geodesic),this.calculationType&&(f.calculationType=this.calculationType),f}});return b("extend-esri")&&l.setObject("tasks.LengthsParameters",h,f),h})},"cmv/viewer/js/gis/dijit/Print":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/tasks/PrintTask dojo/store/Memory dojo/_base/lang dojo/_base/array dojo/topic dojo/dom-style dojo/dom-construct dojo/dom-class dojo/date/locale dojo/text!./Print/templates/Print.html dojo/text!./Print/templates/PrintResult.html esri/tasks/PrintTemplate esri/tasks/PrintParameters esri/request esri/urlUtils dojo/i18n!./Print/nls/resource dijit/form/Form dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/form/NumberTextBox dijit/form/Button dijit/form/CheckBox dijit/ProgressBar dijit/form/DropDownButton dijit/TooltipDialog dijit/form/RadioButton xstyle/css!./Print/css/Print.css".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y){var z=h([l,a,d],{widgetsInTemplate:!0,templateString:u,i18n:y,url:null,fileHandle:null,resultOrder:"last",postCreate:function(){this.inherited(arguments);this.fileHandle.then(k.hitch(this,"_onPrintComplete"),k.hitch(this,"_onPrintError"))},_onPrintComplete:function(a){if(a.url){var b=x.getProxyRule(a.url);this.url=b&&b.proxyUrl?b.proxyUrl+"?"+a.url:a.url;this.nameNode.innerHTML='\x3cspan class\x3d"bold"\x3e'+this.docName+"\x3c/span\x3e";n.add(this.resultNode,
"printResultHover")}else this._onPrintError(this.i18n.printResults.errorMessage)},_onPrintError:function(a){g.publish("viewer/handleError",{source:"Print",error:a});this.nameNode.innerHTML='\x3cspan class\x3d"bold"\x3e'+y.printResults.errorMessage+"\x3c/span\x3e";n.add(this.resultNode,"printResultError")},_openPrint:function(){null!==this.url&&window.open(this.url)},_handleStatusUpdate:function(a){"esriJobFailed"===a.jobInfo.jobStatus&&this._onPrintError(this.i18n.printResults.errorMessage)}});return h([l,
a,d],{widgetsInTemplate:!0,templateString:r,i18n:y,map:null,count:1,results:[],authorText:null,copyrightText:null,defaultTitle:null,defaultFormat:null,defaultLayout:null,baseClass:"gis_PrintDijit",pdfIcon:require.toUrl("gis/dijit/Print/images/pdf.png"),imageIcon:require.toUrl("gis/dijit/Print/images/image.png"),printTaskURL:null,printTask:null,postCreate:function(){this.inherited(arguments);this.printparams=new t;this.printparams.map=this.map;this.printparams.outSpatialReference=this.map.spatialReference;
w({url:this.printTaskURL,content:{f:"json"},handleAs:"json",callbackParamName:"callback",load:k.hitch(this,"_handlePrintInfo"),error:k.hitch(this,"_handleError")})},operationalLayersInspector:function(a){m.forEach(a,function(a){"Measurement_graphicslayer"===a.id&&m.forEach(a.featureCollection.layers,function(a){m.forEach(a.featureSet.features,function(a){delete a.attributes;a.symbol.font.family="Courier"})})});return a},_handleError:function(a){g.publish("viewer/handleError",{source:"Print",error:a})},
_handlePrintInfo:function(a){this.printTask=new b(this.printTaskURL,{async:"esriExecutionTypeAsynchronous"===a.executionType});var c=m.filter(a.parameters,function(a){return"Layout_Template"===a.name});if(0===c.length)g.publish("viewer/handleError",{source:"Print",error:"Print service parameters name for templates must be 'Layout_Template'"});else{var d=m.map(c[0].choiceList,function(a){return{name:a,id:a}});d.sort(function(a,b){return a.name>b.name?1:b.name>a.name?-1:0});d=new f({data:d});this.layoutDijit.set("store",
d);this.defaultLayout?this.layoutDijit.set("value",this.defaultLayout):this.layoutDijit.set("value",c[0].defaultValue);a=m.filter(a.parameters,function(a){return"Format"===a.name});0===a.length?g.publish("viewer/handleError",{source:"Print",error:"Print service parameters name for format must be 'Format'"}):(c=m.map(a[0].choiceList,function(a){return{name:a,id:a}}),c.sort(function(a,b){return a.name>b.name?1:b.name>a.name?-1:0}),c=new f({data:c}),this.formatDijit.set("store",c),this.defaultFormat?
this.formatDijit.set("value",this.defaultFormat):this.formatDijit.set("value",a[0].defaultValue))}},print:function(){if(this.printSettingsFormDijit.isValid()){var a=this.printSettingsFormDijit.get("value"),b=this.preserveFormDijit.get("value");k.mixin(a,b);var b=this.layoutFormDijit.get("value"),c=this.mapQualityFormDijit.get("value"),d=this.mapOnlyFormDijit.get("value");k.mixin(d,c);c=new v;c.format=a.format;c.layout=a.layout;c.preserveScale=eval(a.preserveScale);c.label=a.title;c.exportOptions=
d;c.layoutOptions={authorText:this.authorText,copyrightText:this.copyrightText,legendLayers:0<b.legend.length&&b.legend[0]?null:[],titleText:a.title,scalebarUnit:b.scalebarUnit};this.printparams.template=c;b=this.printTask.execute(this.printparams);a=(new z({count:this.count.toString(),icon:"PDF"===a.format?this.pdfIcon:this.imageIcon,docName:a.title,title:a.format+", "+a.layout+", "+q.format(new Date,{formatLength:"short"}),fileHandle:b})).placeAt(this.printResultsNode,this.resultOrder);this.printTask.async&&
a.own(this.printTask.printGp.on("status-update",k.hitch(a,"_handleStatusUpdate")));e.set(this.clearActionBarNode,"display","block");this.count++}else this.printSettingsFormDijit.validate()},clearResults:function(){c.empty(this.printResultsNode);e.set(this.clearActionBarNode,"display","none");this.count=1}})})},"esri/tasks/PrintTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../lang ../layerUtils ../deferredUtils ../Color ../urlUtils ./Task ../geometry/Polygon ../renderers/SimpleRenderer ../geometry/scaleUtils ../symbols/FillSymbol ./Geoprocessor ./PrintTemplate dojo/dom-attr dojo/dom-construct dojox/gfx/_base dojox/gfx/canvas dojox/json/query require require".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C){h=h(q,{declaredClass:"esri.tasks.PrintTask",constructor:function(a,b){this.url=a;this.printGp=new w(this.url);this._handler=l.hitch(this,this._handler);b&&b.async&&(this.async=b.async);this._colorEvaluator=C("$..color")},_handler:function(a,b,c,d,e){try{var f;this.async?"esriJobSucceeded"===a.jobStatus&&this.printGp.getResultData(a.jobId,"Output_File",l.hitch(this,function(a){f=a.value;this._successHandler([f],"onComplete",c,e)})):(f=a[0].value,
this._successHandler([f],"onComplete",c,e))}catch(g){this._errorHandler(g,d,e)}},execute:function(c,f,g){var k=this._handler,h=this._errorHandler,n=c.template||new x;n.hasOwnProperty("showLabels")||(n.showLabels=!0);var r,q=n.exportOptions;q&&(r={outputSize:[q.width,q.height],dpi:q.dpi});var u,q=n.layoutOptions,t=[];if(q){this.legendAll=!1;q.legendLayers?a.forEach(q.legendLayers,function(a){var b={};b.id=a.layerId;a.subLayerIds&&(b.subLayerIds=a.subLayerIds);t.push(b)}):this.legendAll=!0;var v,w;
"Miles"===q.scalebarUnit||"Kilometers"===q.scalebarUnit?(v="esriKilometers",w="esriMiles"):("Meters"===q.scalebarUnit||"Feet"===q.scalebarUnit)&&(v="esriMeters",w="esriFeet");u={esriMiles:"mi",esriKilometers:"km",esriFeet:"ft",esriMeters:"m"};u={titleText:q.titleText,authorText:q.authorText,copyrightText:q.copyrightText,customTextElements:q.customTextElements,scaleBarOptions:{metricUnit:v,metricLabel:u[v],nonMetricUnit:w,nonMetricLabel:u[w]},legendOptions:{operationalLayers:t}}}v=this._getPrintDefinition(c.map,
n);if(c.outSpatialReference&&(v.mapOptions.spatialReference=c.outSpatialReference.toJson()),c.template&&m.isDefined(c.template.showAttribution)&&(v.mapOptions.showAttribution=c.template.showAttribution),l.mixin(v,{exportOptions:r,layoutOptions:u}),this.allLayerslegend&&l.mixin(v.layoutOptions,{legendOptions:{operationalLayers:this.allLayerslegend}}),v.operationalLayers){var y,q=v.operationalLayers,C=function(a){return m.fixJson(l.mixin(a,{type:"esriSLS",cap:void 0,join:void 0,meterLimit:void 0}))};
for(r=0;r<q.length;r++)if(q[r].featureCollection&&q[r].featureCollection.layers)for(u=0;u<q[r].featureCollection.layers.length;u++){var z=q[r].featureCollection.layers[u];if(z.layerDefinition&&z.layerDefinition.drawingInfo&&z.layerDefinition.drawingInfo.renderer&&z.layerDefinition.drawingInfo.renderer.symbol&&(y=z.layerDefinition.drawingInfo.renderer,"esriCLS"===y.symbol.type?y.symbol=C(y.symbol):y.symbol.outline&&"esriCLS"===y.symbol.outline.type&&(y.symbol.outline=C(y.symbol.outline))),z.featureSet&&
z.featureSet.features)for(w=0;w<z.featureSet.features.length;w++)y=z.featureSet.features[w],y.symbol&&("esriCLS"===y.symbol.type?y.symbol=C(y.symbol):y.symbol.outline&&"esriCLS"===y.symbol.outline.type&&(y.symbol.outline=C(y.symbol.outline)))}}n={Web_Map_as_JSON:d.toJson(m.fixJson(v)),Format:n.format,Layout_Template:n.layout};c.extraParameters&&(n=l.mixin(n,c.extraParameters));var A=new b(e._dfdCanceller);c=function(a,b){k(a,b,f,g,A)};y=function(a){h(a,g,A)};return this.async?A._pendingDfd=this.printGp.submitJob(n,
c,null,y):A._pendingDfd=this.printGp.execute(n,c,y),A},onComplete:function(){},_createMultipointLayer:function(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}},_createPolygonLayer:function(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}},_createPointLayer:function(){return{layerDefinition:{name:"pointLayer",
geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}},_createPolylineLayer:function(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}},_convertSvgSymbol:function(a){if(!(8>=f("ie")||!a.path&&"image/svg+xml"!==a.contentType)){var b,c=B.createSurface(z.create("div"),1024,1024);b="image/svg+xml"===a.contentType?
c.createObject(B.Image,{src:"data:image/svg+xml;base64,"+a.imageData,width:A.pt2px(a.width),height:A.pt2px(a.height),x:0,y:0}):c.createObject(B.Path,a.path).setFill(a.color).setStroke(a.outline);"pendingRender"in c&&c._render(!0);var d=c.rawNode.getContext("2d"),e=Math.ceil(b.getBoundingBox().width),g=Math.ceil(b.getBoundingBox().height);b=d.getImageData(b.getBoundingBox().x,b.getBoundingBox().y,e,g);d.canvas.width=e;d.canvas.height=g;d.putImageData(b,0,0);d=d.canvas.toDataURL("image/png");a={type:"esriPMS",
imageData:d.substr(22,d.length),angle:a.angle,contentType:"image/png",height:a.size?a.size:A.px2pt(g),width:a.size?e/g*a.size:A.px2pt(e),xoffset:a.xoffset,yoffset:a.yoffset};return c.destroy(),a}},_convertSvgRenderer:function(b){"simple"===b.type&&b.symbol&&(b.symbol.path||"image/svg+xml"===b.symbol.contentType)?b.symbol=this._convertSvgSymbol(b.symbol):"uniqueValue"===b.type?(b.defaultSymbol&&(b.defaultSymbol.path||"image/svg+xml"===b.defaultSymbol.contentType)&&(b.defaultSymbol=this._convertSvgSymbol(b.defaultSymbol)),
b.uniqueValueInfos&&a.forEach(b.uniqueValueInfos,function(a){(a.symbol.path||"image/svg+xml"===a.symbol.contentType)&&(a.symbol=this._convertSvgSymbol(a.symbol))},this)):"classBreaks"===b.type&&(b.defaultSymbol&&(b.defaultSymbol.path||"image/svg+xml"===b.defaultSymbol.contentType)&&(b.defaultSymbol=this._convertSvgSymbol(b.defaultSymbol)),b.classBreakInfos&&a.forEach(b.classBreakInfos,function(a){(a.symbol.path||"image/svg+xml"===a.symbol.contentType)&&(a.symbol=this._convertSvgSymbol(a.symbol))},
this))},_createFeatureCollection:function(b,c,d){var e=this._createPolygonLayer(),f=this._createPolylineLayer(),g=this._createPointLayer(),k=this._createMultipointLayer(),h=this._createPointLayer();if(h.layerDefinition.name="textLayer",delete h.layerDefinition.drawingInfo,("esri.layers.FeatureLayer"===b.declaredClass||"esri.layers.StreamLayer"===b.declaredClass)&&(e.layerDefinition.name=f.layerDefinition.name=g.layerDefinition.name=k.layerDefinition.name=l.getObject("arcgisProps.title",!1,b)||b.name||
b.id),b.renderer&&!l.isFunction(b.renderer.attributeField)){var m=b.renderer.toJson();if("temporal"===m.type){var m={latestObservationRenderer:m.latestObservationRenderer,trackLinesRenderer:m.trackRenderer,observationAger:m.observationAger,renderer:m.observationRenderer},n={};b._trackIdField&&(n.trackIdField=b._trackIdField);b._startTimeField&&(n.startTimeField=b._startTimeField);b._endTimeField&&(n.endTimeField=b._endTimeField);e.layerDefinition.drawingInfo=m;e.layerDefinition.timeInfo=n;f.layerDefinition.drawingInfo=
m;f.layerDefinition.timeInfo=n;g.layerDefinition.drawingInfo=m;g.layerDefinition.timeInfo=n;k.layerDefinition.drawingInfo=m;k.layerDefinition.timeInfo=n}else e.layerDefinition.drawingInfo.renderer=m,f.layerDefinition.drawingInfo.renderer=m,g.layerDefinition.drawingInfo.renderer=m,k.layerDefinition.drawingInfo.renderer=m}else delete e.layerDefinition.drawingInfo,delete f.layerDefinition.drawingInfo,delete g.layerDefinition.drawingInfo,delete k.layerDefinition.drawingInfo;(m=b.fields)||!b.renderer||
l.isFunction(b.renderer.attributeField)||("esri.renderer.ClassBreaksRenderer"===b.renderer.declaredClass?(m=[{name:b.renderer.attributeField,type:"esriFieldTypeDouble"}],b.renderer.normalizationField&&m.push({name:b.renderer.normalizationField,type:"esriFieldTypeDouble"})):"esri.renderer.UniqueValueRenderer"===b.renderer.declaredClass&&(m=[{name:b.renderer.attributeField,type:"esriFieldTypeString"}],b.renderer.attributeField2&&m.push({name:b.renderer.attributeField2,type:"esriFieldTypeString"}),b.renderer.attributeField3&&
m.push({name:b.renderer.attributeField3,type:"esriFieldTypeString"})));m&&(e.layerDefinition.fields=m,f.layerDefinition.fields=m,g.layerDefinition.fields=m,k.layerDefinition.fields=m);for(var q,n=b.graphics.length,m=0;n>m;m++){var u=b.graphics[m];if(!1!==u.visible&&u.geometry){if(q=u.toJson(),q.symbol&&q.symbol.outline&&q.symbol.outline.color&&q.symbol.outline.color[3]&&(q.symbol.outline.color[3]=255),b.renderer&&!q.symbol&&(l.isFunction(b.renderer.attributeField)||this._isFeatureCollectionRequired(b.renderer)||
"esri.renderer.DotDensityRenderer"===b.renderer.declaredClass||d)){d=d||b.renderer;var t=d.getSymbol(u);if(!t)continue;q.symbol=t.toJson();this._isFeatureCollectionRequired(d)&&this._applyVisualVariables(q.symbol,{renderer:d,graphic:u,symbol:t,mapResolution:c&&c.getResolutionInMeters(),mapScale:c&&c.getScale()})}switch(q.symbol&&(q.symbol.path||"image/svg+xml"===q.symbol.contentType?q.symbol=this._convertSvgSymbol(q.symbol):q.symbol.text&&delete q.attributes),u.geometry.type){case "polygon":e.featureSet.features.push(q);
break;case "polyline":f.featureSet.features.push(q);break;case "point":q.symbol&&q.symbol.text?h.featureSet.features.push(q):g.featureSet.features.push(q);break;case "multipoint":k.featureSet.features.push(q);break;case "extent":q.geometry=r.fromExtent(u.geometry).toJson(),e.featureSet.features.push(q)}}}c=[];0<e.featureSet.features.length&&c.push(e);0<f.featureSet.features.length&&c.push(f);0<k.featureSet.features.length&&c.push(k);0<g.featureSet.features.length&&c.push(g);0<h.featureSet.features.length&&
c.push(h);a.forEach(c,function(b){b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.renderer&&a.every(b.featureSet.features,function(a){return a.symbol})&&delete b.layerDefinition.drawingInfo});a.forEach(c,function(a){a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&this._convertSvgRenderer(a.layerDefinition.drawingInfo.renderer)},this);return{id:b.id,opacity:b.opacity,minScale:b.minScale||0,maxScale:b.maxScale||0,featureCollection:{layers:c}}},_getPrintDefinition:function(a,
b){var c={operationalLayers:this._createOperationalLayers(a,b)},d=a.extent,e=a.spatialReference;a.spatialReference._isWrappable()&&(d=d._normalize(!0),e=d.spatialReference);d={mapOptions:{showAttribution:a.showAttribution,extent:d.toJson(),spatialReference:e.toJson()}};b.preserveScale&&l.mixin(d.mapOptions,{scale:b.outScale||v.getScale(a)});a.timeExtent&&l.mixin(d.mapOptions,{time:[a.timeExtent.startTime.getTime(),a.timeExtent.endTime.getTime()]});e={};return l.mixin(e,d,c),e},_createOperationalLayers:function(b,
c){var e,f,k,h,m=[];this.legendAll?this.allLayerslegend=[]:this.allLayerslegend=null;var r=a.map(b.layerIds,b.getLayer,b);b._mapImageLyr&&r.push(b._mapImageLyr);for(e=0;e<r.length;e++)if(f=r[e],f.loaded&&f.visible)switch(k=f.declaredClass,h={id:f.id,title:l.getObject("arcgisProps.title",!1,f)||f.id,opacity:f.opacity,minScale:f.minScale||0,maxScale:f.maxScale||0},h=l.mixin(h,this._getUrlAndToken(f)),f.getNode()&&y.get(f.getNode(),"data-reference")&&(h._isRefLayer=!0),k){case "esri.layers.ArcGISDynamicMapServiceLayer":var q=
[],t=!!f._params.layers;if(f._params.dynamicLayers)t=d.fromJson(f._params.dynamicLayers),a.forEach(t,function(a){q.push({id:a.id,name:a.name,layerDefinition:a});delete a.id;delete a.name;delete a.maxScale;delete a.minScale}),0===q.length&&(h.visibleLayers=[-1]);else if(f.supportsDynamicLayers){if(t||f.layerDefinitions||f.layerTimeOptions){var v=f.createDynamicLayerInfosFromLayerInfos(),w=null;t&&(w=f.visibleLayers);var w=g._getVisibleLayers(v,w),x=g._getLayersForScale(c.outScale||b.getScale(),v);
a.forEach(v,function(b){if(!b.subLayerIds){var c=b.id;-1<a.indexOf(w,c)&&-1<a.indexOf(x,c)&&(b={source:b.source.toJson()},f.layerDefinitions&&f.layerDefinitions[c]&&(b.definitionExpression=f.layerDefinitions[c]),f.layerTimeOptions&&f.layerTimeOptions[c]&&(b.layerTimeOptions=f.layerTimeOptions[c].toJson()),q.push({id:c,layerDefinition:b}))}});0===q.length&&(h.visibleLayers=[-1])}}else a.forEach(f.layerInfos,function(a){var b={id:a.id,layerDefinition:{}};f.layerDefinitions&&f.layerDefinitions[a.id]&&
(b.layerDefinition.definitionExpression=f.layerDefinitions[a.id]);f.layerTimeOptions&&f.layerTimeOptions[a.id]&&(b.layerDefinition.layerTimeOptions=f.layerTimeOptions[a.id].toJson());(b.layerDefinition.definitionExpression||b.layerDefinition.layerTimeOptions)&&q.push(b)}),t&&(h.visibleLayers=f.visibleLayers);q.length&&(h.layers=q);m.push(h);this.allLayerslegend&&this.allLayerslegend.push({id:f.id,subLayerIds:f.visibleLayers});break;case "esri.layers.ArcGISImageServiceLayer":h=l.mixin(h,{url:f.url,
bandIds:f.bandIds,compressionQuality:f.compressionQuality,format:f.format,interpolation:f.interpolation});f.mosaicRule&&l.mixin(h,{mosaicRule:f.mosaicRule.toJson()});f.renderingRule&&l.mixin(h,{renderingRule:f.renderingRule.toJson()});m.push(h);this.allLayerslegend&&this.allLayerslegend.push({id:f.id});break;case "esri.layers.WMSLayer":h=l.mixin(h,{url:f.url,title:f.title,type:"wms",version:f.version,transparentBackground:f.imageTransparency,visibleLayers:f.visibleLayers});m.push(h);this.allLayerslegend&&
this.allLayerslegend.push({id:f.id,subLayerIds:f.visibleLayers});break;case "esri.virtualearth.VETiledLayer":t=f.mapStyle;"aerialWithLabels"===t&&(t="Hybrid");h=l.mixin(h,{visibility:f.visible,type:"BingMaps"+t,culture:f.culture,key:f.bingMapsKey});m.push(h);break;case "esri.layers.OpenStreetMapLayer":h=l.mixin(h,{credits:f.copyright,type:"OpenStreetMap",url:n.getAbsoluteUrl(f.tileServers[0])});m.push(h);break;case "esri.layers.WMTSLayer":h=l.mixin(h,{url:f.url,type:"wmts",layer:f._identifier,style:f._style,
format:f.format,tileMatrixSet:f._tileMatrixSetId});m.push(h);break;case "esri.layers.MapImageLayer":t=f.getImages();a.forEach(t,function(a,b){a.href&&(h={id:f.id+"_image"+b,type:"image",title:f.id,minScale:f.minScale||0,maxScale:f.maxScale||0,opacity:f.opacity*a.opacity,extent:a.extent.toJson()},"data:image/png;base64,"===a.href.substr(0,22)?h.imageData=a.href.substr(22):h.url=a.href,m.push(h))});break;case "esri.layers.VectorTileLayer":t=/^https?:\/\/basemaps(dev)?\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/World_Basemap\/VectorTileServer/i;
!h._isRefLayer&&f.currentStyleInfo&&t.test(f.currentStyleInfo.serviceUrl)&&(h.url="http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer",m.push(h));break;case "esri.layers.WebTiledLayer":t=f.url.replace(/\$\{/g,"{");h=l.mixin(h,{type:"WebTiledLayer",urlTemplate:t,credits:f.copyright});f.subDomains&&0<f.subDomains.length&&(h.subDomains=f.subDomains);f._wmtsInfo&&(h.wmtsInfo=f._wmtsInfo);delete h.url;m.push(h);break;default:(f.getTileUrl||f.getImageUrl)&&(h=l.mixin(h,{url:f.url}),
m.push(h))}for(e=0;e<b.graphicsLayerIds.length;e++)if(f=b.getLayer(b.graphicsLayerIds[e]),f.loaded&&f.visible){k=f.declaredClass;var C;switch(k){case "esri.layers.FeatureLayer":case "esri.layers.LabelLayer":case "esri.layers.CSVLayer":case "esri.layers.StreamLayer":if("esri.layers.LabelLayer"===k&&!c.showLabels||f.renderer&&"esri.renderer.HeatmapRenderer"===f.renderer.declaredClass)continue;if(C=null,f.url&&f.renderer&&("esri.renderer.ScaleDependentRenderer"===f.renderer.declaredClass?"scale"===f.renderer.rangeType?
C=f.renderer.getRendererInfoByScale(b.getScale())&&f.renderer.getRendererInfoByScale(b.getScale()).renderer:"zoom"===f.renderer.rangeType&&(C=f.renderer.getRendererInfoByZoom(b.getZoom())&&f.renderer.getRendererInfoByZoom(b.getZoom()).renderer):C=f.renderer),C&&("esri.renderer.SimpleRenderer"===C.declaredClass||"esri.renderer.TemporalRenderer"===C.declaredClass||l.isString(C.attributeField)&&f._getField(C.attributeField,!0))&&!this._isFeatureCollectionRequired(C)&&"esri.renderer.DotDensityRenderer"!==
C.declaredClass&&"esri.layers.CSVLayer"!==f.declaredClass&&"esri.layers.StreamLayer"!==f.declaredClass){if(h={id:f.id,title:l.getObject("arcgisProps.title",!1,f)||f.id,opacity:f.opacity,minScale:f.minScale||0,maxScale:f.maxScale||0,layerDefinition:{drawingInfo:{renderer:C.toJson()}}},h=l.mixin(h,this._getUrlAndToken(f)),"esri.renderer.TemporalRenderer"===C.declaredClass)k=h.layerDefinition.drawingInfo,k.latestObservationRenderer=k.renderer.latestObservationRenderer,k.trackLinesRenderer=k.renderer.trackRenderer,
k.observationAger=k.renderer.observationAger,k.renderer=k.renderer.observationRenderer,f._trackIdField&&(h.layerDefinition.timeInfo={trackIdField:f._trackIdField});if(this._convertSvgRenderer(h.layerDefinition.drawingInfo.renderer),1>f.opacity||"esri.renderer.TemporalRenderer"===C.declaredClass||this._updateLayerOpacity(h))if(f._params.source&&(k=f._params.source.toJson(),l.mixin(h.layerDefinition,{source:k})),f.getDefinitionExpression()&&l.mixin(h.layerDefinition,{definitionExpression:f.getDefinitionExpression()}),
2!==f.mode)0<f.getSelectedFeatures().length&&(k=a.map(f.getSelectedFeatures(),function(a){return a.attributes[f.objectIdField]}),0<k.length&&f.getSelectionSymbol()&&l.mixin(h,{selectionObjectIds:k,selectionSymbol:f.getSelectionSymbol().toJson()}));else{k=a.map(f.getSelectedFeatures(),function(a){return a.attributes[f.objectIdField]});if(0===k.length||!f._params.drawMode)break;l.mixin(h.layerDefinition,{objectIds:k});k=null;f.getSelectionSymbol()&&(k=new u(f.getSelectionSymbol()));l.mixin(h.layerDefinition.drawingInfo,
{renderer:k&&k.toJson()})}else h=this._createFeatureCollection(f,b)}else h=C&&(this._isFeatureCollectionRequired(C)||"esri.renderer.DotDensityRenderer"===C.declaredClass)?this._createFeatureCollection(f,b,C):this._createFeatureCollection(f,b);m.push(h);this.allLayerslegend&&this.allLayerslegend.push({id:f.id});break;case "esri.layers.GraphicsLayer":case "esri.layers.WFSLayer":h=this._createFeatureCollection(f,b),m.push(h),this.allLayerslegend&&this.allLayerslegend.push({id:f.id})}}return b.graphics&&
0<b.graphics.graphics.length&&(h=this._createFeatureCollection(b.graphics,b),m.push(h)),b._labels&&c.showLabels&&(h=this._createFeatureCollection(b._labels,b),m.push(h)),a.forEach(m,function(a,b,c){a._isRefLayer&&(delete a._isRefLayer,c.splice(b,1),c.push(a))}),m},_getUrlAndToken:function(a){return{token:a._getToken(),url:a._url?a._url.path:null}},_updateLayerOpacity:function(b){var c=this._colorEvaluator(b),c=a.filter(c,function(a){return l.isArray(a)&&4===a.length}),d=!0;if(c.length){var e,f=c[0][3];
for(e=1;e<c.length;e++)if(f!==c[e][3]){d=!1;break}if(d)for(b.opacity=f/255,e=0;e<c.length;e++)c[e][3]=255}return d},_isFeatureCollectionRequired:function(a){return a.hasVisualVariables("sizeInfo")||a.hasVisualVariables("colorInfo")||a.hasVisualVariables("opacityInfo")},_getVariable:function(a,b,c){var d,e;return a&&(d=a.getVisualVariablesForType(b,c),e=d&&d[0]),e},_applyVisualVariables:function(a,b){var d=b.renderer,e=b.graphic,f=b.symbol,g=b.mapResolution,k=b.mapScale,h=f.type;if("textsymbol"!==
h&&"shieldlabelsymbol"!==h){var m=this._getVariable(d,"sizeInfo",!1),l=this._getVariable(d,"colorInfo",!1),n=this._getVariable(d,"opacityInfo",!1);if(f instanceof t&&(m=this._getVariable(d,"sizeInfo","outline")||m),m)f=d.getSize(e,{sizeInfo:m,shape:"simplemarkersymbol"===h?f.style:null,resolution:g,scale:k}),null!=f&&("simplemarkersymbol"===h?a.size=A.px2pt(f):"picturemarkersymbol"===h?(a.width=A.px2pt(f),a.height=A.px2pt(f)):"simplelinesymbol"===h?a.width=A.px2pt(f):a.outline&&(a.outline.width=A.px2pt(f)));
l&&(l=d.getColor(e,{colorInfo:l}))&&("simplemarkersymbol"===h||"simplelinesymbol"===h||"simplefillsymbol"===h)&&(a.color=c.toJsonColor(l));n&&(d=d.getOpacity(e,{opacityInfo:n}),null!=d&&a.color&&(a.color[3]=Math.round(255*d)))}}});return f("extend-esri")&&l.setObject("tasks.PrintTask",h,k),h})},"esri/tasks/Geoprocessor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has dojo/io-query ../kernel ../request ../deferredUtils ../geometry/normalizeUtils ./Task ./FeatureSet ./JobInfo ./GPMessage ./LinearUnit ./DataFile ./RasterData ./Date ./ParameterValue ./GPResultImageLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/MapImage".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B){h=h(n,{declaredClass:"esri.tasks.Geoprocessor",_eventMap:{"execute-complete":["results","messages"],"get-result-data-complete":["result"],"get-result-image-complete":["mapImage"],"get-result-image-layer-complete":["layer"],"job-cancel":["jobInfo"],"job-complete":["jobInfo"],"status-update":["jobInfo"]},constructor:function(a){this._jobUpdateHandler=l.hitch(this,this._jobUpdateHandler);this._getJobStatus=l.hitch(this,this._getJobStatus);this._getResultDataHandler=
l.hitch(this,this._getResultDataHandler);this._getResultImageHandler=l.hitch(this,this._getResultImageHandler);this._executeHandler=l.hitch(this,this._executeHandler);this._updateTimers=[];this.registerConnectEvents()},updateDelay:1E3,processSpatialReference:null,outputSpatialReference:null,outSpatialReference:null,setUpdateDelay:function(a){this.updateDelay=a},setProcessSpatialReference:function(a){this.processSpatialReference=a},setOutputSpatialReference:function(a){this._setOutSR(a)},setOutSpatialReference:function(a){this._setOutSR(a)},
__msigns:[{n:"execute",c:3,a:[{i:0,p:["*"]}],e:2,f:1},{n:"submitJob",c:4,a:[{i:0,p:["*"]}],e:3}],_setOutSR:function(a){this.outSpatialReference=this.outputSpatialReference=a},_getOutSR:function(){return this.outSpatialReference||this.outputSpatialReference},_gpEncode:function(c,d,e){for(var f in c){var g=c[f];l.isArray(g)?c[f]=b.toJson(a.map(g,function(a){return this._gpEncode({item:a},!0).item},this)):g instanceof Date&&(c[f]=g.getTime())}return this._encode(c,d,e)},_decode:function(b){var c=b.dataType,
d=new y(b);if(-1!==a.indexOf(["GPBoolean","GPDouble","GPLong","GPString"],c))return d;if("GPLinearUnit"===c)d.value=new v(d.value);else if("GPFeatureRecordSetLayer"===c||"GPRecordSet"===c)d.value=new q(d.value);else if("GPDataFile"===c)d.value=new t(d.value);else if("GPDate"===c)b=d.value,l.isString(b)?d.value=new x({date:b}):d.value=new Date(b);else if("GPRasterData"===c||"GPRasterDataLayer"===c)(b=b.value.mapImage)?d.value=new B(b):d.value=new w(d.value);else if(-1!==c.indexOf("GPMultiValue:")){var e=
c.split(":")[1];b=d.value;d.value=a.map(b,function(a){return this._decode({paramName:"_name",dataType:e,value:a}).value},this)}else d=null;return d},submitJob:function(a,c,d,e,f){var k=this._getOutSR(),h=f.assembly;a=this._gpEncode(l.mixin({},this._url.query,{f:"json","env:outSR":k?k.wkid||b.toJson(k.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||b.toJson(this.processSpatialReference.toJson()):null},a),null,h&&h[0]);var m=this._jobUpdateHandler,n=this._errorHandler;
return g({url:this._url.path+"/submitJob",content:a,callbackParamName:"callback",load:function(a,b){m(a,b,!1,c,d,f.dfd)},error:function(a){n(a,e,f.dfd)}})},_jobUpdateHandler:function(a,b,c,d,e,f){var g=a.jobId;b=new r(a);if(this._successHandler([b],"onStatusUpdate",e,c&&f),!c)switch(clearTimeout(this._updateTimers[g]),this._updateTimers[g]=null,f&&f.progress(b),a.jobStatus){case r.STATUS_SUBMITTED:case r.STATUS_EXECUTING:case r.STATUS_WAITING:case r.STATUS_NEW:var k=this._getJobStatus;this._updateTimers[g]=
setTimeout(function(){k(g,c,d,e,f)},this.updateDelay);break;default:this._successHandler([b],"onJobComplete",d,f)}},_getJobStatus:function(a,b,c,d,e){var f=this._jobUpdateHandler;g({url:this._url.path+"/jobs/"+a,content:l.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,g){f(a,g,b,c,d,e)},error:this._errorHandler})},_getResultDataHandler:function(a,b,c,d,e){try{var f=this._decode(a);this._successHandler([f],"onGetResultDataComplete",c,e)}catch(g){this._errorHandler(g,
d,e)}},getResultData:function(a,b,c,f){var k=this._getResultDataHandler,h=this._errorHandler,m=new d(e._dfdCanceller);return m._pendingDfd=g({url:this._url.path+"/jobs/"+a+"/results/"+b,content:l.mixin({},this._url.query,{f:"json",returnType:"data"}),callbackParamName:"callback",load:function(a,b){k(a,b,c,f,m)},error:function(a){h(a,f,m)}}),m},checkJobStatus:function(a,b,c){var f=this._jobUpdateHandler,k=this._errorHandler,h=new d(e._dfdCanceller);return h._pendingDfd=g({url:this._url.path+"/jobs/"+
a,content:l.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,c){f(a,c,!0,null,b,h)},error:function(a){k(a,c,h)}}),h},cancelJob:function(a,b,c){var f=this._errorHandler,k=new d(e._dfdCanceller);return k._pendingDfd=g({url:this._url.path+"/jobs/"+a+"/cancel",content:l.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:l.hitch(this,function(a,c){this._successHandler([a],"onJobCancel",b,k)}),error:function(a){f(a,c,k)}}),k},execute:function(a,c,d,e){var f=
this._getOutSR(),k=e.assembly;a=this._gpEncode(l.mixin({},this._url.query,{f:"json","env:outSR":f?f.wkid||b.toJson(f.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||b.toJson(this.processSpatialReference.toJson()):null},a),null,k&&k[0]);var h=this._executeHandler,m=this._errorHandler;return g({url:this._url.path+"/execute",content:a,callbackParamName:"callback",load:function(a,b){h(a,b,c,d,e.dfd)},error:function(a){m(a,d,e.dfd)}})},_executeHandler:function(a,
b,c,d,e){try{var f,g,k=a.results,h=a.messages;f=0;for(g=k.length;g>f;f++)k[f]=this._decode(k[f]);f=0;for(g=h.length;g>f;f++)h[f]=new u(h[f]);this._successHandler([k,h],"onExecuteComplete",c,e)}catch(m){this._errorHandler(m,d,e)}},_getResultImageHandler:function(a,b,c,d,e){try{var f=this._decode(a);this._successHandler([f],"onGetResultImageComplete",c,e)}catch(g){this._errorHandler(g,d,e)}},getResultImage:function(a,b,c,f,k){var h=this._getResultImageHandler,m=this._errorHandler;c=this._gpEncode(l.mixin({},
this._url.query,{f:"json"},c.toJson()));var n=new d(e._dfdCanceller);return n._pendingDfd=g({url:this._url.path+"/jobs/"+a+"/results/"+b,content:c,callbackParamName:"callback",load:function(a,b){h(a,b,f,k,n)},error:function(a){m(a,k,n)}}),n},cancelJobStatusUpdates:function(a){clearTimeout(this._updateTimers[a]);this._updateTimers[a]=null},getResultImageLayer:function(a,b,c,d){var e;if(null==b){var f=this._url.path.indexOf("/GPServer/");a=this._url.path.substring(0,f)+"/MapServer/jobs/"+a}else a=this._url.path+
"/jobs/"+a+"/results/"+b;return this._url.query&&(a+="?"+k.objectToQuery(this._url.query)),e=null==b?new A(a,{imageParameters:c}):new z(a,{imageParameters:c},!0),this.onGetResultImageLayerComplete(e),d&&d(e),e},onStatusUpdate:function(){},onJobComplete:function(){},onExecuteComplete:function(){},onGetResultDataComplete:function(){},onGetResultImageComplete:function(){},onGetResultImageLayerComplete:function(){},onJobCancel:function(){}});return c._createWrappers(h),f("extend-esri")&&l.setObject("tasks.Geoprocessor",
h,m),h})},"esri/tasks/JobInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./GPMessage"],function(h,l,a,d,b){h=h(null,{declaredClass:"esri.tasks.JobInfo",constructor:function(a){this.messages=[];l.mixin(this,a);var d=this.messages,h=d.length;for(a=0;h>a;a++)d[a]=new b(d[a])},jobId:"",jobStatus:""});return l.mixin(h,{STATUS_CANCELLED:"esriJobCancelled",STATUS_CANCELLING:"esriJobCancelling",STATUS_DELETED:"esriJobDeleted",STATUS_DELETING:"esriJobDeleting",STATUS_EXECUTING:"esriJobExecuting",
STATUS_FAILED:"esriJobFailed",STATUS_NEW:"esriJobNew",STATUS_SUBMITTED:"esriJobSubmitted",STATUS_SUCCEEDED:"esriJobSucceeded",STATUS_TIMED_OUT:"esriJobTimedOut",STATUS_WAITING:"esriJobWaiting"}),a("extend-esri")&&l.setObject("tasks.JobInfo",h,d),h})},"esri/tasks/GPMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.tasks.GPMessage",constructor:function(a){l.mixin(this,a)}});return l.mixin(h,{TYPE_INFORMATIVE:"esriJobMessageTypeInformative",
TYPE_PROCESS_DEFINITION:"esriJobMessageTypeProcessDefinition",TYPE_PROCESS_START:"esriJobMessageTypeProcessStart",TYPE_PROCESS_STOP:"esriJobMessageTypeProcessStop",TYPE_WARNING:"esriJobMessageTypeWarning",TYPE_ERROR:"esriJobMessageTypeError",TYPE_EMPTY:"esriJobMessageTypeEmpty",TYPE_ABORT:"esriJobMessageTypeAbort"}),a("extend-esri")&&l.setObject("tasks.GPMessage",h,d),h})},"esri/tasks/LinearUnit":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=
h(null,{declaredClass:"esri.tasks.LinearUnit",constructor:function(a){a&&l.mixin(this,a)},distance:0,units:null,toJson:function(){var a={};return this.distance&&(a.distance=this.distance),this.units&&(a.units=this.units),a}});return a("extend-esri")&&l.setObject("tasks.LinearUnit",h,d),h})},"esri/tasks/DataFile":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.tasks.DataFile",constructor:function(a){a&&l.mixin(this,a)},
url:null,itemID:null,toJson:function(){var a={};return this.url&&(a.url=this.url),this.itemID&&(a.itemID=this.itemID),a}});return a("extend-esri")&&l.setObject("tasks.DataFile",h,d),h})},"esri/tasks/RasterData":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.tasks.RasterData",constructor:function(a){a&&l.mixin(this,a)},url:null,format:null,itemID:null,toJson:function(){var a={};return this.url&&(a.url=this.url),this.format&&
(a.format=this.format),this.itemID&&(a.itemID=this.itemID),a}});return a("extend-esri")&&l.setObject("tasks.RasterData",h,d),h})},"esri/tasks/Date":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/date/locale","dojo/has","../kernel"],function(h,l,a,d,b){h=h(null,{declaredClass:"esri.tasks.Date",constructor:function(b){b&&(b.format&&(this.format=b.format),this.date=a.parse(b.date,{selector:"date",datePattern:this.format}))},date:new Date,format:"EEE MMM dd HH:mm:ss zzz yyyy",toJson:function(){return{date:a.format(this.date,
{selector:"date",datePattern:this.format}),format:this.format}}});return d("extend-esri")&&l.setObject("tasks.Date",h,b),h})},"esri/tasks/ParameterValue":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.tasks.ParameterValue",constructor:function(a){l.mixin(this,a)}});return a("extend-esri")&&l.setObject("tasks.ParameterValue",h,d),h})},"esri/tasks/GPResultImageLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has dojo/io-query ../kernel ../layers/ArcGISDynamicMapServiceLayer".split(" "),
function(h,l,a,d,b,f,k){h=h(k,{declaredClass:"esri.tasks._GPResultImageLayer",constructor:function(a,b){b&&b.imageParameters&&b.imageParameters.extent&&(this.initialExtent=this.fullExtent=b.imageParameters.extent,this.spatialReference=this.initialExtent.spatialReference);this.getImageUrl=l.hitch(this,this.getImageUrl);this.loaded=!0;this.onLoad(this)},getImageUrl:function(d,f,e,c){var k=d.spatialReference.wkid;c(this._url.path+"?"+b.objectToQuery(l.mixin(this._params,{f:"image",bbox:a.toJson(d.toJson()),
bboxSR:k,imageSR:k,size:f+","+e})))}});return d("extend-esri")&&l.setObject("tasks._GPResultImageLayer",h,f),h})},"esri/tasks/PrintTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.tasks.PrintTemplate",label:null,exportOptions:{width:800,height:1100,dpi:96},layoutOptions:null,format:"PNG32",layout:"MAP_ONLY",outScale:0,preserveScale:!0,showAttribution:null,showLabels:!0});return a("extend-esri")&&l.setObject("tasks.PrintTemplate",
h,d),h})},"dojox/gfx/canvas":function(){define("./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q){function r(a,b,c,d,e,f,g,k,h,m){var l,n,r=b.length,q=0;m?(n=m.l/e,q=m.i):n=b[0]/e;for(;f<g;)f+n>g&&(l={l:(f+n-g)*e,i:q},n=g-f),q%2||(a.beginPath(),a.arc(c,d,e,f,f+n,k),h&&a.stroke()),f+=n,++q,n=b[q%r]/e;return l}function u(a,b,c,d){var e=0,f=0,
g,k=0;d?(g=d.l,k=d.i):g=b[0];for(;1>f;)f=q.tAtLength(a,g),1==f&&(e=q.computeLength(a),e={l:g-e,i:k}),a=q.splitBezierAtT(a,f),k%2||c.push(a[0]),a=a[1],++k,g=b[k%b.length];return e}function v(a,b,c,d){var e=[b.last.x,b.last.y].concat(c),f=!(a instanceof Array);c=4===c.length?"quadraticCurveTo":"bezierCurveTo";var g=[];b=u(e,b.canvasDash,g,d);for(d=0;d<g.length;++d)e=g[d],f?(a.moveTo(e[0],e[1]),a[c].apply(a,e.slice(2))):(a.push("moveTo",[e[0],e[1]]),a.push(c,e.slice(2)));return b}function t(a,b,c,d,
e,f,g){var k=0,h=0,m=0,l=q.distance(c,d,e,f),n=0;b=b.canvasDash;var r=c,u=d,t,v=!(a instanceof Array);g?(m=g.l,n=g.i):m+=b[0];for(;.01<Math.abs(1-h);)m>l&&(k={l:m-l,i:n},m=l),h=m/l,g=c+(e-c)*h,t=d+(f-d)*h,n++%2||(v?(a.moveTo(r,u),a.lineTo(g,t)):(a.push("moveTo",[r,u]),a.push("lineTo",[g,t]))),r=g,u=t,m+=b[n%b.length];return k}var w=h.canvas={},x=null,y=c.multiplyPoint,z=Math.PI,A=2*z,B=z/2;n=l.extend;if(b.global.CanvasRenderingContext2D){b=b.doc.createElement("canvas").getContext("2d");var C="function"==
typeof b.setLineDash,D="function"==typeof b.fillText}var E={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};w.Shape=d("dojox.gfx.canvas.Shape",m.Shape,{_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);this._renderShape(a);this._renderFill(a,!0);this._renderStroke(a,!0);a.restore()},_renderClip:function(a){this.canvasClip&&
(this.canvasClip.render(a),a.clip())},_renderTransform:function(a){if("canvasTransform"in this){var b=this.canvasTransform;a.translate(b.dx,b.dy);a.rotate(b.angle2);a.scale(b.sx,b.sy);a.rotate(b.angle1)}},_renderShape:function(a){},_renderFill:function(a,b){if("canvasFill"in this){var c=this.fillStyle;if("canvasFillImage"in this){var d=c.width,e=c.height,f=this.canvasFillImage.width,g=this.canvasFillImage.height,k=Math.min(d==f?1:d/f,e==g?1:e/g),h=(d-k*f)/2,m=(e-k*g)/2;x.width=d;x.height=e;var l=
x.getContext("2d");l.clearRect(0,0,d,e);l.drawImage(this.canvasFillImage,0,0,f,g,h,m,k*f,k*g);this.canvasFill=a.createPattern(x,"repeat");delete this.canvasFillImage}a.fillStyle=this.canvasFill;b&&("pattern"!==c.type||0===c.x&&0===c.y||a.translate(c.x,c.y),a.fill())}else a.fillStyle="rgba(0,0,0,0.0)"},_renderStroke:function(a,b){var c=this.strokeStyle;c?(a.strokeStyle=c.color.toString(),a.lineWidth=c.width,a.lineCap=c.cap,"number"==typeof c.join?(a.lineJoin="miter",a.miterLimit=c.join):a.lineJoin=
c.join,this.canvasDash?C?(a.setLineDash(this.canvasDash),b&&a.stroke()):this._renderDashedStroke(a,b):b&&a.stroke()):b||(a.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(a,b){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,setClip:function(a){this.inherited(arguments);var b=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&!b)return this;this.canvasClip=a?F(b,a):null;this.parent&&
this.parent._makeDirty();return this}});var F=function(a,b){switch(a){case "ellipse":return{canvasEllipse:J({shape:b}),render:function(a){return w.Ellipse.prototype._renderShape.call(this,a)}};case "rect":return{shape:l.delegate(b,{r:0}),render:function(a){return w.Rect.prototype._renderShape.call(this,a)}};case "path":return{canvasPath:H(b),render:function(a){this.canvasPath._renderShape(a)}};case "polyline":return{canvasPolyline:b.points,render:function(a){return w.Polyline.prototype._renderShape.call(this,
a)}}}return null},H=function(a){var b=new dojox.gfx.canvas.Path;b.canvasPath=[];b._setPath(a.d);return b},G=function(a,b,c){var d=a.prototype[b];a.prototype[b]=c?function(){this.parent&&this.parent._makeDirty();d.apply(this,arguments);c.call(this);return this}:function(){this.parent&&this.parent._makeDirty();return d.apply(this,arguments)}};G(w.Shape,"setTransform",function(){this.matrix?this.canvasTransform=h.decompose(this.matrix):delete this.canvasTransform});G(w.Shape,"setFill",function(){var b=
this.fillStyle,c;if(b){if("object"==typeof b&&"type"in b){var d=this.surface.rawNode.getContext("2d");switch(b.type){case "linear":case "radial":c="linear"==b.type?d.createLinearGradient(b.x1,b.y1,b.x2,b.y2):d.createRadialGradient(b.cx,b.cy,0,b.cx,b.cy,b.r);a.forEach(b.colors,function(a){c.addColorStop(a.offset,h.normalizeColor(a.color).toString())});break;case "pattern":x||(x=document.createElement("canvas")),d=new Image,this.surface.downloadImage(d,b.src),this.canvasFillImage=d}}else c=b.toString();
this.canvasFill=c}else delete this.canvasFill});G(w.Shape,"setStroke",function(){var a=this.strokeStyle;if(a){var b=this.strokeStyle.style.toLowerCase();b in E&&(b=E[b]);if(b instanceof Array){this.canvasDash=b=b.slice();var c;for(c=0;c<b.length;++c)b[c]*=a.width;if("butt"!=a.cap){for(c=0;c<b.length;c+=2)b[c]-=a.width,1>b[c]&&(b[c]=1);for(c=1;c<b.length;c+=2)b[c]+=a.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!C&&!!this.canvasDash});G(w.Shape,"setShape");w.Group=
d("dojox.gfx.canvas.Group",w.Shape,{constructor:function(){m.Container._init.call(this)},_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},destroy:function(){m.Container.clear.call(this,!0);w.Shape.prototype.destroy.apply(this,arguments)}});w.Rect=d("dojox.gfx.canvas.Rect",[w.Shape,m.Rect],{_renderShape:function(a){var b=this.shape,c=Math.min(b.r,b.height/2,b.width/2),d=b.x,e=d+b.width,f=b.y,b=
f+b.height,g=d+c,k=e-c,h=f+c,m=b-c;a.beginPath();a.moveTo(g,f);c?(a.arc(k,h,c,-B,0,!1),a.arc(k,m,c,0,B,!1),a.arc(g,m,c,B,z,!1),a.arc(g,h,c,z,z+B,!1)):(a.lineTo(k,f),a.lineTo(e,m),a.lineTo(g,b),a.lineTo(d,h));a.closePath()},_renderDashedStroke:function(a,b){var c=this.shape,d=Math.min(c.r,c.height/2,c.width/2),e=c.x,f=e+c.width,g=c.y,k=g+c.height,h=e+d,m=f-d,l=g+d,n=k-d;d?(a.beginPath(),c=t(a,this,h,g,m,g),b&&a.stroke(),c=r(a,this.canvasDash,m,l,d,-B,0,!1,b,c),a.beginPath(),c=t(a,this,f,l,f,n,c),b&&
a.stroke(),c=r(a,this.canvasDash,m,n,d,0,B,!1,b,c),a.beginPath(),c=t(a,this,m,k,h,k,c),b&&a.stroke(),c=r(a,this.canvasDash,h,n,d,B,z,!1,b,c),a.beginPath(),c=t(a,this,e,n,e,l,c),b&&a.stroke(),r(a,this.canvasDash,h,l,d,z,z+B,!1,b,c)):(a.beginPath(),c=t(a,this,h,g,m,g),c=t(a,this,m,g,f,n,c),c=t(a,this,f,n,h,k,c),t(a,this,h,k,e,l,c),b&&a.stroke())}});var K=[];(function(){var a=e.curvePI4;K.push(a.s,a.c1,a.c2,a.e);for(var b=45;360>b;b+=45){var d=c.rotateg(b);K.push(y(d,a.c1),y(d,a.c2),y(d,a.e))}})();var J=
function(a){var b,d,e,f=[],g=a.shape,k=c.normalize([c.translate(g.cx,g.cy),c.scale(g.rx,g.ry)]);b=y(k,K[0]);f.push([b.x,b.y]);for(g=1;g<K.length;g+=3)d=y(k,K[g]),e=y(k,K[g+1]),b=y(k,K[g+2]),f.push([d.x,d.y,e.x,e.y,b.x,b.y]);if(a._needsDash){b=[];d=f[0];for(g=1;g<f.length;++g)e=[],u(d.concat(f[g]),a.canvasDash,e),d=[f[g][4],f[g][5]],b.push(e);a._dashedPoints=b}return f};w.Ellipse=d("dojox.gfx.canvas.Ellipse",[w.Shape,m.Ellipse],{setShape:function(){this.inherited(arguments);this.canvasEllipse=J(this);
return this},setStroke:function(){this.inherited(arguments);C||(this.canvasEllipse=J(this));return this},_renderShape:function(a){var b=this.canvasEllipse,c;a.beginPath();a.moveTo.apply(a,b[0]);for(c=1;c<b.length;++c)a.bezierCurveTo.apply(a,b[c]);a.closePath()},_renderDashedStroke:function(a,b){var c=this._dashedPoints;a.beginPath();for(var d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.length;++f){var g=e[f];a.moveTo(g[0],g[1]);a.bezierCurveTo(g[2],g[3],g[4],g[5],g[6],g[7])}b&&a.stroke()}});w.Circle=
d("dojox.gfx.canvas.Circle",[w.Shape,m.Circle],{_renderShape:function(a){var b=this.shape;a.beginPath();a.arc(b.cx,b.cy,b.r,0,A,1)},_renderDashedStroke:function(a,b){var c=this.shape,d=0,e,f=this.canvasDash.length;for(i=0;d<A;)e=this.canvasDash[i%f]/c.r,i%2||(a.beginPath(),a.arc(c.cx,c.cy,c.r,d,d+e,0),b&&a.stroke()),d+=e,++i}});w.Line=d("dojox.gfx.canvas.Line",[w.Shape,m.Line],{_renderShape:function(a){var b=this.shape;a.beginPath();a.moveTo(b.x1,b.y1);a.lineTo(b.x2,b.y2)},_renderDashedStroke:function(a,
b){var c=this.shape;a.beginPath();t(a,this,c.x1,c.y1,c.x2,c.y2);b&&a.stroke()}});w.Polyline=d("dojox.gfx.canvas.Polyline",[w.Shape,m.Polyline],{setShape:function(){this.inherited(arguments);var a=this.shape.points,b=a[0],c,d;this.bbox=null;this._normalizePoints();if(a.length)if("number"==typeof b)b=a;else for(b=[],d=0;d<a.length;++d)c=a[d],b.push(c.x,c.y);else b=[];this.canvasPolyline=b;return this},_renderShape:function(a){var b=this.canvasPolyline;if(b.length){a.beginPath();a.moveTo(b[0],b[1]);
for(var c=2;c<b.length;c+=2)a.lineTo(b[c],b[c+1])}},_renderDashedStroke:function(a,b){var c=this.canvasPolyline,d=0;a.beginPath();for(var e=0;e<c.length;e+=2)d=t(a,this,c[e],c[e+1],c[e+2],c[e+3],d);b&&a.stroke()}});w.Image=d("dojox.gfx.canvas.Image",[w.Shape,m.Image],{setShape:function(){this.inherited(arguments);var a=new Image;this.surface.downloadImage(a,this.shape.src);this.canvasImage=a;return this},_renderShape:function(a){var b=this.shape;a.drawImage(this.canvasImage,b.x,b.y,b.width,b.height)}});
w.Text=d("dojox.gfx.canvas.Text",[w.Shape,m.Text],{_setFont:function(){this.fontStyle?this.canvasFont=h.makeFontString(this.fontStyle):delete this.canvasFont},getTextWidth:function(){var a=this.shape,b=0,c;a.text&&(c=this.surface.rawNode.getContext("2d"),c.save(),this._renderTransform(c),this._renderFill(c,!1),this._renderStroke(c,!1),this.canvasFont&&(c.font=this.canvasFont),b=c.measureText(a.text).width,c.restore());return b},_render:function(a){a.save();this._renderTransform(a);this._renderFill(a,
!1);this._renderStroke(a,!1);this._renderShape(a);a.restore()},_renderShape:function(a){var b,c=this.shape;c.text&&(b="middle"===c.align?"center":c.align,a.textAlign=b,this.canvasFont&&(a.font=this.canvasFont),this.canvasFill&&a.fillText(c.text,c.x,c.y),this.strokeStyle&&(a.beginPath(),a.strokeText(c.text,c.x,c.y),a.closePath()))}});G(w.Text,"setFont");D||w.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var I={M:"_moveToA",m:"_moveToR",
L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};w.Path=d("dojox.gfx.canvas.Path",[w.Shape,g.Path],{constructor:function(){this.lastControl={}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);
C||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(a){var b=l.clone(this.last);this[I[a.action]](this.canvasPath,a.action,a.args,this._needsDash?this._dashedPath:null);this.last=b;this.inherited(arguments)},_renderShape:function(a){var b=this.canvasPath;a.beginPath();for(var c=0;c<b.length;c+=2)a[b[c]].apply(a,b[c+1])},_renderDashedStroke:C?function(){}:function(a,b){var c=this._dashedPath;
a.beginPath();for(var d=0;d<c.length;d+=2)a[c[d]].apply(a,c[d+1]);b&&a.stroke()},_moveToA:function(a,b,c,d){a.push("moveTo",[c[0],c[1]]);d&&d.push("moveTo",[c[0],c[1]]);for(b=2;b<c.length;b+=2)a.push("lineTo",[c[b],c[b+1]]),d&&(this._dashResidue=t(d,this,c[b-2],c[b-1],c[b],c[b+1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl={}},_moveToR:function(a,b,c,d){b="x"in this.last?[this.last.x+=c[0],this.last.y+=c[1]]:[this.last.x=c[0],this.last.y=c[1]];a.push("moveTo",
b);d&&d.push("moveTo",b);for(b=2;b<c.length;b+=2)a.push("lineTo",[this.last.x+=c[b],this.last.y+=c[b+1]]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(a,b,c,d){for(b=0;b<c.length;b+=2)d&&(this._dashResidue=t(d,this,this.last.x,this.last.y,c[b],c[b+1],this._dashResidue)),a.push("lineTo",[c[b],c[b+1]]);this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl={}},_lineToR:function(a,b,c,
d){for(b=0;b<c.length;b+=2)a.push("lineTo",[this.last.x+=c[b],this.last.y+=c[b+1]]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_hLineToA:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[c[b],this.last.y]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],c[b],this.last.y,this._dashResidue));this.last.x=c[c.length-1];this.lastControl={}},_hLineToR:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",
[this.last.x+=c[b],this.last.y]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_vLineToA:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x,c[b]]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,c[b],this._dashResidue));this.last.y=c[c.length-1];this.lastControl={}},_vLineToR:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x,this.last.y+=c[b]]),d&&
(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(a,b,c,d){for(b=0;b<c.length;b+=6)a.push("bezierCurveTo",c.slice(b,b+6)),d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type="C"},_curveToR:function(a,b,c,d){for(b=0;b<c.length;b+=6)a.push("bezierCurveTo",
[this.last.x+c[b],this.last.y+c[b+1],this.lastControl.x=this.last.x+c[b+2],this.lastControl.y=this.last.y+c[b+3],this.last.x+c[b+4],this.last.y+c[b+5]]),d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+4],this.last.y+=c[b+5];this.lastControl.type="C"},_smoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4){var e="C"==this.lastControl.type;a.push("bezierCurveTo",[e?2*this.last.x-this.lastControl.x:this.last.x,e?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+
1],c[b+2],c[b+3]]);d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=c[b];this.lastControl.y=c[b+1];this.lastControl.type="C"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_smoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4){var e="C"==this.lastControl.type;a.push("bezierCurveTo",[e?2*this.last.x-this.lastControl.x:this.last.x,e?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]);d&&
(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=this.last.x+c[b];this.lastControl.y=this.last.y+c[b+1];this.lastControl.type="C";this.last.x+=c[b+2];this.last.y+=c[b+3]}},_qCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",c.slice(b,b+4));d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type=
"Q"},_qCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",[this.lastControl.x=this.last.x+c[b],this.lastControl.y=this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]),d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+2],this.last.y+=c[b+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=2){var e="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=e?2*this.last.x-this.lastControl.x:
this.last.x,this.lastControl.y=e?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+1]]);d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_qSmoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=2){var e="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=e?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=e?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],
this.last.y+c[b+1]]);d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=c[b];this.last.y+=c[b+1]}},_arcTo:function(b,c,d,f){c="a"==c;for(var g=0;g<d.length;g+=7){var k=d[g+5],h=d[g+6];c&&(k+=this.last.x,h+=this.last.y);var m=e.arcAsBezier(this.last,d[g],d[g+1],d[g+2],d[g+3]?1:0,d[g+4]?1:0,k,h);a.forEach(m,function(a){b.push("bezierCurveTo",a)});f&&(this._dashResidue=v(f,this,p,this._dashResidue));this.last.x=k;this.last.y=h}this.lastControl={}},
_closePath:function(a,b,c,d){a.push("closePath",[]);d&&(this._dashResidue=t(d,this,this.last.x,this.last.y,d[1][0],d[1][1],this._dashResidue));this.lastControl={}}});a.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),function(a){G(w.Path,a)});w.TextPath=d("dojox.gfx.canvas.TextPath",[w.Shape,g.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});w.Surface=d("dojox.gfx.canvas.Surface",m.Surface,{constructor:function(){m.Container._init.call(this);
this.pendingImageCount=0;this.makeDirty()},destroy:function(){m.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(a,b){this.width=h.normalizedLength(a);this.height=h.normalizedLength(b);if(!this.rawNode)return this;var c=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,c=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,c=!0);c&&this.makeDirty();return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:
null},_render:function(a){!this.rawNode||!a&&this.pendingImageCount||(a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender))},render:function(a){a.save();for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},makeDirty:function(){this.pendingImagesCount||"pendingRender"in this||this._batch||(this.pendingRender=setTimeout(l.hitch(this,this._render),
0))},downloadImage:function(a,b){var c=l.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=c;a.onerror=c;a.onabort=c;a.src=b},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},on:function(){}});w.createSurface=function(a,b,c){if(!b&&!c){var d=f.position(a);
b=b||d.w;c=c||d.h}"number"==typeof b&&(b+="px");"number"==typeof c&&(c+="px");d=new w.Surface;a=k.byId(a);var e=a.ownerDocument.createElement("canvas");e.width=h.normalizedLength(b);e.height=h.normalizedLength(c);a.appendChild(e);d.rawNode=e;d._parent=a;return d.surface=d};var L=m.Container;d={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},add:function(a){this._makeDirty();
return L.add.apply(this,arguments)},remove:function(a,b){this._makeDirty();return L.remove.apply(this,arguments)},clear:function(){this._makeDirty();return L.clear.apply(this,arguments)},getBoundingBox:L.getBoundingBox,_moveChildToFront:function(a){this._makeDirty();return L._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return L._moveChildToBack.apply(this,arguments)}};g={createObject:function(a,b){var c=new a;c.surface=this.surface;c.setShape(b);this.add(c);
return c}};n(w.Group,d);n(w.Group,m.Creator);n(w.Group,g);n(w.Surface,d);n(w.Surface,m.Creator);n(w.Surface,g);w.fixTarget=function(a,b){return!0};return w})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(h,l,a,d,b,f,k,m,g,e){function c(a,b){if(!n)return a.splice(b,1);var c=a.length;if(c){for(;b<c;)a[b]=a[b+1],b++;a.length--}}var n=!!b("chrome"),
q=h.shape={};q.Shape=a("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(b("gfxRegistry")){var a=q.register(this);this.getUID=function(){return a}}},destroy:function(){b("gfxRegistry")&&q.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},
getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var b=this._getRealMatrix();return[e.multiplyPoint(b,a.x,a.y),e.multiplyPoint(b,a.x+a.width,a.y),e.multiplyPoint(b,a.x+a.width,a.y+a.height),e.multiplyPoint(b,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},setClip:function(a){this.clip=
a},getClip:function(){return this.clip},setShape:function(a){this.shape=h.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=h.makeParameters(h.defaultLinearGradient,a);break;case "radial":b=h.makeParameters(h.defaultRadialGradient,a);break;case "pattern":b=h.makeParameters(h.defaultPattern,a)}else b=h.normalizeColor(a);this.fillStyle=b;return this},setStroke:function(a){if(!a)return this.strokeStyle=
null,this;if("string"==typeof a||l.isArray(a)||a instanceof g)a={color:a};a=this.strokeStyle=h.makeParameters(h.defaultStroke,a);a.color=h.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=e.clone(a?e.normalize(a):e.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=this.getParent();a&&(a._moveChildToBack(this),
this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&this.parent.remove(this,a);return this},_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},_updateParentMatrix:function(a){this.parentMatrix=
a?e.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,b=this.parent;b;)b.matrix&&(a=e.multiply(b.matrix,a)),b=b.parent;return a}});q._eventsProcessing={on:function(a,b){return f(this.getEventSource(),a,q.fixCallback(this,h.fixTarget,b))},connect:function(a,b,c){"on"==a.substring(0,2)&&(a=a.substring(2));return this.on(a,c?l.hitch(b,c):b)},disconnect:function(a){return a.remove()}};q.fixCallback=function(a,b,c,e){e||(e=c,c=null);if(l.isString(e)){c=c||d.global;
if(!c[e])throw['dojox.gfx.shape.fixCallback: scope["',e,'"] is null (scope\x3d"',c,'")'].join("");return function(d){return b(d,a)?c[e].apply(c,arguments||[]):void 0}}return c?function(d){return b(d,a)?e.apply(c,arguments||[]):void 0}:function(d){return b(d,a)?e.apply(c,arguments):void 0}};l.extend(q.Shape,q._eventsProcessing);q.Container={_init:function(){this.children=[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(a){var b=a.getParent();b&&b.remove(a,
!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,b){for(var d=0;d<this.children.length;++d)if(this.children[d]==a){b||(a.parent=null,a.parentMatrix=null);c(this.children,d);break}return this},clear:function(a){for(var b,c=0;c<this.children.length;++c)b=this.children[c],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=[];return this},getBoundingBox:function(){if(this.children){var a=null;k.forEach(this.children,function(b){var c=b.getBoundingBox();
c&&((b=b.getTransform())&&(c=e.multiplyRectangle(b,c)),a?(a.x=Math.min(a.x,c.x),a.y=Math.min(a.y,c.y),a.endX=Math.max(a.endX,c.x+c.width),a.endY=Math.max(a.endY,c.y+c.height)):a={x:c.x,y:c.y,endX:c.x+c.width,endY:c.y+c.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){c(this.children,b);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==
a){c(this.children,b);this.children.unshift(a);break}return this}};q.Surface=a("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){k.forEach(this._nodes,m.destroy);this._nodes=[];k.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;if(b("ie"))for(;this._parent.lastChild;)m.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},
_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(a,b){var c=l.hitch(a,b);if(this.isLoaded)c(this);else f.once(this,"load",function(a){c(a)})}});l.extend(q.Surface,q._eventsProcessing);q.Rect=a("dojox.gfx.shape.Rect",q.Shape,{constructor:function(a){this.shape=h.getDefault("Rect");this.rawNode=a},getBoundingBox:function(){return this.shape}});q.Ellipse=a("dojox.gfx.shape.Ellipse",q.Shape,{constructor:function(a){this.shape=h.getDefault("Ellipse");this.rawNode=
a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});q.Circle=a("dojox.gfx.shape.Circle",q.Shape,{constructor:function(a){this.shape=h.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});q.Line=a("dojox.gfx.shape.Line",q.Shape,{constructor:function(a){this.shape=h.getDefault("Line");this.rawNode=
a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});q.Polyline=a("dojox.gfx.shape.Polyline",q.Shape,{constructor:function(a){this.shape=h.getDefault("Polyline");this.rawNode=a},setShape:function(a,b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);
return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var c=[],d=0;d<b;d+=2)c.push({x:a[d],y:a[d+1]});this.shape.points=c}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,c=a[0],d=c.x,e=c.y,f=c.x,g=c.y,k=1;k<b;++k)c=a[k],d>c.x&&(d=c.x),f<c.x&&(f=c.x),e>c.y&&(e=c.y),g<c.y&&(g=c.y);this.bbox={x:d,y:e,width:f-d,height:g-e}}return this.bbox}});q.Image=a("dojox.gfx.shape.Image",q.Shape,
{constructor:function(a){this.shape=h.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});q.Text=a(q.Shape,{constructor:function(a){this.fontStyle=null;this.shape=h.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?h.splitFontString(a):h.makeParameters(h.defaultFont,a);this._setFont();return this},getBoundingBox:function(){var a=
null;this.getShape().text&&(a=h._base._computeTextBoundingBox(this));return a}});q.Creator={createShape:function(a){switch(a.type){case h.defaultPath.type:return this.createPath(a);case h.defaultRect.type:return this.createRect(a);case h.defaultCircle.type:return this.createCircle(a);case h.defaultEllipse.type:return this.createEllipse(a);case h.defaultLine.type:return this.createLine(a);case h.defaultPolyline.type:return this.createPolyline(a);case h.defaultImage.type:return this.createImage(a);
case h.defaultText.type:return this.createText(a);case h.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(h.Group)},createRect:function(a){return this.createObject(h.Rect,a)},createEllipse:function(a){return this.createObject(h.Ellipse,a)},createCircle:function(a){return this.createObject(h.Circle,a)},createLine:function(a){return this.createObject(h.Line,a)},createPolyline:function(a){return this.createObject(h.Polyline,a)},createImage:function(a){return this.createObject(h.Image,
a)},createText:function(a){return this.createObject(h.Text,a)},createPath:function(a){return this.createObject(h.Path,a)},createTextPath:function(a){return this.createObject(h.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return q})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(h,l,a,d,b){b=a("dojox.gfx.path.Path",b.Shape,{constructor:function(a){this.shape=l.clone(h.defaultPath);this.segments=[];this.tbbox=
null;this.absolute=!0;this.last={};this.rawNode=a;this.segmented=!1},setAbsoluteMode:function(a){this._confirmSegmented();this.absolute="string"==typeof a?"absolute"==a:a;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;
var a=this.bbox,b=this._getRealMatrix();this.bbox=null;for(var d=0,g=this.segments.length;d<g;++d)this._updateWithSegment(this.segments[d],b);b=this.bbox;this.bbox=a;return this.tbbox=b?[{x:b.l,y:b.t},{x:b.r,y:b.t},{x:b.r,y:b.b},{x:b.l,y:b.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(a,b,h){h&&(b=d.multiplyPoint(h,a,b),a=b.x,b=b.y);this.bbox&&"l"in
this.bbox?(this.bbox.l>a&&(this.bbox.l=a),this.bbox.r<a&&(this.bbox.r=a),this.bbox.t>b&&(this.bbox.t=b),this.bbox.b<b&&(this.bbox.b=b)):this.bbox={l:a,b:b,r:a,t:b}},_updateWithSegment:function(a,b){var d=a.args,g=d.length,e;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(e=0;e<g;e+=2)this._updateBBox(d[e],d[e+1],b);this.last.x=d[g-2];this.last.y=d[g-1];this.absolute=!0;break;case "H":for(e=0;e<g;++e)this._updateBBox(d[e],this.last.y,b);this.last.x=d[g-1];this.absolute=!0;
break;case "V":for(e=0;e<g;++e)this._updateBBox(this.last.x,d[e],b);this.last.y=d[g-1];this.absolute=!0;break;case "m":e=0;"x"in this.last||(this._updateBBox(this.last.x=d[0],this.last.y=d[1],b),e=2);for(;e<g;e+=2)this._updateBBox(this.last.x+=d[e],this.last.y+=d[e+1],b);this.absolute=!1;break;case "l":case "t":for(e=0;e<g;e+=2)this._updateBBox(this.last.x+=d[e],this.last.y+=d[e+1],b);this.absolute=!1;break;case "h":for(e=0;e<g;++e)this._updateBBox(this.last.x+=d[e],this.last.y,b);this.absolute=!1;
break;case "v":for(e=0;e<g;++e)this._updateBBox(this.last.x,this.last.y+=d[e],b);this.absolute=!1;break;case "c":for(e=0;e<g;e+=6)this._updateBBox(this.last.x+d[e],this.last.y+d[e+1],b),this._updateBBox(this.last.x+d[e+2],this.last.y+d[e+3],b),this._updateBBox(this.last.x+=d[e+4],this.last.y+=d[e+5],b);this.absolute=!1;break;case "s":case "q":for(e=0;e<g;e+=4)this._updateBBox(this.last.x+d[e],this.last.y+d[e+1],b),this._updateBBox(this.last.x+=d[e+2],this.last.y+=d[e+3],b);this.absolute=!1;break;
case "A":for(e=0;e<g;e+=7)this._updateBBox(d[e+5],d[e+6],b);this.last.x=d[g-2];this.last.y=d[g-1];this.absolute=!0;break;case "a":for(e=0;e<g;e+=7)this._updateBBox(this.last.x+=d[e+5],this.last.y+=d[e+6],b);this.absolute=!1}var c=[a.action];for(e=0;e<g;++e)c.push(h.formatNumber(d[e],!0));if("string"==typeof this.shape.path)this.shape.path+=c.join("");else for(e=0,g=c.length;e<g;++e)this.shape.path.push(c[e])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(a,b){this.tbbox=
null;var d=this._validSegments[a.toLowerCase()];"number"==typeof d&&(d?b.length>=d&&(d={action:a,args:b.slice(0,b.length-b.length%d)},this.segments.push(d),this._updateWithSegment(d)):(d={action:a,args:[]},this.segments.push(d),this._updateWithSegment(d)))},_collectArgs:function(a,b){for(var d=0;d<b.length;++d){var g=b[d];"boolean"==typeof g?a.push(g?1:0):"number"==typeof g?a.push(g):g instanceof Array?this._collectArgs(a,g):"x"in g&&"y"in g&&a.push(g.x,g.y)}},moveTo:function(){this._confirmSegmented();
var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"M":"m",a);return this},lineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"L":"l",a);return this},hLineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"H":"h",a);return this},vLineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"V":"v",a);
return this},curveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"C":"c",a);return this},smoothCurveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"S":"s",a);return this},qCurveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"Q":"q",a);return this},qSmoothCurveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,
arguments);this._pushSegment(this.absolute?"T":"t",a);return this},arcTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"A":"a",a);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var a=this.shape.path;this.shape.path=[];this._setPath(a);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(a){a=l.isArray(a)?a:a.match(h.pathSvgRegExp);
this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(a){for(var b="",d=[],g=a.length,e=0;e<g;++e){var c=a[e],n=parseFloat(c);isNaN(n)?(b&&this._pushSegment(b,d),d=[],b=c):d.push(n)}this._pushSegment(b,d)}},setShape:function(a){this.inherited(arguments,["string"==typeof a?{path:a}:a]);this.segmented=!1;this.segments=[];h.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});a=a("dojox.gfx.path.TextPath",b,{constructor:function(a){"text"in this||(this.text=l.clone(h.defaultTextPath));
"fontStyle"in this||(this.fontStyle=l.clone(h.defaultFont))},getText:function(){return this.text},setText:function(a){this.text=h.makeParameters(this.text,"string"==typeof a?{text:a}:a);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?h.splitFontString(a):h.makeParameters(h.defaultFont,a);this._setFont();return this}});return h.path={Path:b,TextPath:a}})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],
function(h,l,a){function d(a){var b=Math.cos(a);a=Math.sin(a);var d={x:b+4/3*(1-b),y:a-4/3*b*(1-b)/a};return{s:{x:b,y:-a},c1:{x:d.x,y:-d.y},c2:d,e:{x:b,y:a}}}var b=2*Math.PI,f=Math.PI/4,k=Math.PI/8,m=f+k,g=d(k);return h.arc={unitArcAsBezier:d,curvePI4:g,arcAsBezier:function(e,c,h,l,r,u,v,t){r=Boolean(r);u=Boolean(u);var w=a._degToRad(l);l=c*c;var x=h*h,y=a.multiplyPoint(a.rotate(-w),{x:(e.x-v)/2,y:(e.y-t)/2}),z=y.x*y.x,A=y.y*y.y;l=Math.sqrt((l*x-l*A-x*z)/(l*A+x*z));isNaN(l)&&(l=0);l={x:l*c*y.y/h,
y:-l*h*y.x/c};r==u&&(l={x:-l.x,y:-l.y});l=a.multiplyPoint([a.translate((e.x+v)/2,(e.y+t)/2),a.rotate(w)],l);c=a.normalize([a.translate(l.x,l.y),a.rotate(w),a.scale(c,h)]);l=a.invert(c);e=a.multiplyPoint(l,e);t=a.multiplyPoint(l,v,t);v=Math.atan2(e.y,e.x);t=Math.atan2(t.y,t.x);l=v-t;u&&(l=-l);0>l?l+=b:l>b&&(l-=b);h=k;t=g;h=u?h:-h;e=[];for(r=l;0<r;r-=f)r<m&&(h=r/2,t=d(h),h=u?h:-h,r=0),y=a.normalize([c,a.rotate(v+h)]),u?(l=a.multiplyPoint(y,t.c1),w=a.multiplyPoint(y,t.c2),y=a.multiplyPoint(y,t.e)):(l=
a.multiplyPoint(y,t.c2),w=a.multiplyPoint(y,t.c1),y=a.multiplyPoint(y,t.s)),e.push([l.x,l.y,w.x,w.y,y.x,y.y]),v+=2*h;return e}}})},"dojox/gfx/decompose":function(){define(["./_base","dojo/_base/lang","./matrix"],function(h,l,a){function d(a,b){return Math.abs(a-b)<=1E-6*(Math.abs(a)+Math.abs(b))}function b(a,b,c,d){if(!isFinite(a))return c;if(!isFinite(c))return a;b=Math.abs(b);d=Math.abs(d);return(b*a+d*c)/(b+d)}function f(b){b=a.normalize(b);var e=-b.xx-b.yy,c=b.xx*b.yy-b.xy*b.yx,f=Math.sqrt(e*
e-4*c),e=-(e+(0>e?-f:f))/2,c=c/e,f=b.xy/(e-b.xx),k=1,h=b.xy/(c-b.xx),m=1;d(e,c)&&(f=1,h=k=0,m=1);isFinite(f)||(f=1,k=(e-b.xx)/b.xy,isFinite(k)||(f=(e-b.yy)/b.yx,k=1,isFinite(f)||(f=1,k=b.yx/(e-b.yy))));isFinite(h)||(h=1,m=(c-b.xx)/b.xy,isFinite(m)||(h=(c-b.yy)/b.yx,m=1,isFinite(h)||(h=1,m=b.yx/(c-b.yy))));b=Math.sqrt(f*f+k*k);var l=Math.sqrt(h*h+m*m);isFinite(f/=b)||(f=0);isFinite(k/=b)||(k=0);isFinite(h/=l)||(h=0);isFinite(m/=l)||(m=0);return{value1:e,value2:c,vector1:{x:f,y:k},vector2:{x:h,y:m}}}
function k(a,d){var c=0>a.xx*a.yy||0<a.xy*a.yx?-1:1,f=d.angle1=(Math.atan2(a.yx,a.yy)+Math.atan2(-c*a.xy,c*a.xx))/2,c=Math.cos(f),f=Math.sin(f);d.sx=b(a.xx/c,c,-a.xy/f,f);d.sy=b(a.yy/c,c,a.yx/f,f);return d}function m(a,d){var c=0>a.xx*a.yy||0<a.xy*a.yx?-1:1,f=d.angle2=(Math.atan2(c*a.yx,c*a.xx)+Math.atan2(-a.xy,a.yy))/2,c=Math.cos(f),f=Math.sin(f);d.sx=b(a.xx/c,c,a.yx/f,f);d.sy=b(a.yy/c,c,-a.xy/f,f);return d}return h.decompose=function(b){var e=a.normalize(b);b={dx:e.dx,dy:e.dy,sx:1,sy:1,angle1:0,
angle2:0};if(d(e.xy,0)&&d(e.yx,0))return l.mixin(b,{sx:e.xx,sy:e.yy});if(d(e.xx*e.yx,-e.xy*e.yy))return k(e,b);if(d(e.xx*e.xy,-e.yx*e.yy))return m(e,b);var c,h=new a.Matrix2D(e);c=l.mixin(h,{dx:0,dy:0,xy:h.yx,yx:h.xy});h=f([e,c]);c=f([c,e]);h=new a.Matrix2D({xx:h.vector1.x,xy:h.vector2.x,yx:h.vector1.y,yy:h.vector2.y});c=new a.Matrix2D({xx:c.vector1.x,xy:c.vector1.y,yx:c.vector2.x,yy:c.vector2.y});e=new a.Matrix2D([a.invert(h),e,a.invert(c)]);k(c,b);e.xx*=b.sx;e.yy*=b.sy;m(h,b);e.xx*=b.sx;e.yy*=b.sy;
return l.mixin(b,{sx:e.xx,sy:e.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(h){h=h.bezierutils={};h.tAtLength=function(b,h){var g=0,e=6==b.length,c=0,l=0,q=e?d:f,r=function(d,f){for(var t=0,w=0;w<d.length-2;w+=2)t+=a(d[w],d[w+1],d[w+2],d[w+3]);w=e?a(b[0],b[1],b[4],b[5]):a(b[0],b[1],b[6],b[7]);t-w>f||c+t>h+f?(++l,t=q(d,.5),r(t[0],f),Math.abs(c-h)<=f||r(t[1],f)):(c+=t,g+=1/(1<<l))};h&&r(b,.5);return g};var l=h.computeLength=function(f){for(var h=6==f.length,g=0,e=0;e<f.length-
2;e+=2)g+=a(f[e],f[e+1],f[e+2],f[e+3]);e=h?a(f[0],f[1],f[4],f[5]):a(f[0],f[1],f[6],f[7]);.1<g-e&&(f=h?d(f,.5):b(f,.5),g=l(f[0],h),g+=l(f[1],h));return g},a=h.distance=function(a,b,d,e){return Math.sqrt((d-a)*(d-a)+(e-b)*(e-b))},d=function(a,b){var d=1-b,e=d*d,c=b*b,f=a[0],h=a[1],l=a[2],u=a[3],v=a[4],t=a[5],w=e*f+2*d*b*l+c*v,e=e*h+2*d*b*u+c*t;return[[f,h,d*f+b*l,d*h+b*u,w,e],[w,e,d*l+b*v,d*u+b*t,v,t]]},b=function(a,b){var d=1-b,e=d*d,c=e*d,f=b*b,h=f*b,l=a[0],u=a[1],v=a[2],t=a[3],w=a[4],x=a[5],y=a[6],
z=a[7],A=c*l+3*e*b*v+3*d*f*w+h*y,c=c*u+3*e*b*t+3*d*f*x+h*z;return[[l,u,d*l+b*v,d*u+b*t,e*l+2*d*b*v+f*w,e*u+2*d*b*t+f*x,A,c],[A,c,e*v+2*d*b*w+f*y,e*t+2*d*b*x+f*z,d*w+b*y,d*x+b*z,y,z]]},f=h.splitBezierAtT=function(a,f){return 6==a.length?d(a,f):b(a,f)};return h})},"dojox/json/query":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojox","dojo/_base/array"],function(h,l,a){l.getObject("json",!0,a);a.json._slice=function(a,b,f,k){var h=a.length,g=[];f=f||h;b=0>b?Math.max(0,b+h):Math.min(h,b);
for(f=0>f?Math.max(0,f+h):Math.min(h,f);b<f;b+=k)g.push(a[b]);return g};a.json._find=function(a,b){function f(a){b&&(!0!==b||a instanceof Array?a[b]&&k.push(a[b]):k.push(a));for(var d in a){var c=a[d];b?c&&"object"==typeof c&&f(c):k.push(c)}}var k=[];if(b instanceof Array){if(1==b.length)return a[b[0]];for(var h=0;h<b.length;h++)k.push(a[b[h]])}else f(a);return k};a.json._distinctFilter=function(a,b){for(var f=[],k={},h=0,g=a.length;h<g;++h){var e=a[h];b(e,h,a)&&("object"==typeof e&&e?e.__included||
(e.__included=!0,f.push(e)):k[e+typeof e]||(k[e+typeof e]=!0,f.push(e)))}h=0;for(g=f.length;h<g;++h)f[h]&&delete f[h].__included;return f};return a.json.query=function(a,b){function f(a){e=a+"("+e}function k(a,b,c,d,e,f,k,h){return g[h].match(/[\*\?]/)||"~"==k?"/^"+g[h].substring(1,g[h].length-1).replace(/\\([btnfr\\"'])|([^\w\*\?])/g,"\\$1$2").replace(/([\*\?])/g,"[\\w\\W]$1")+("~"==k?"$/i":"$/")+".test("+b+")":a}var h=0,g=[];a=a.replace(/"(\\.|[^"\\])*"|'(\\.|[^'\\])*'|[\[\]]/g,function(a){h+="["==
a?1:"]"==a?-1:0;return"]"==a&&0<h?"`]":'"'==a.charAt(0)||"'"==a.charAt(0)?"`"+(g.push(a)-1):a});var e="";a.replace(/(\]|\)|push|pop|shift|splice|sort|reverse)\s*\(/,function(){throw Error("Unsafe function call");});a=a.replace(/([^<>=]=)([^=])/g,"$1\x3d$2").replace(/@|(\.\s*)?[a-zA-Z\$_]+(\s*:)?/g,function(a){return"."==a.charAt(0)?a:"@"==a?"$obj":(a.match(/:|^(\$|Math|true|false|null)$/)?"":"$obj.")+a}).replace(/\.?\.?\[(`\]|[^\]])*\]|\?.*|\.\.([\w\$_]+)|\.\*/g,function(a,b,c){return(b=a.match(/^\.?\.?(\[\s*\^?\?|\^?\?|\[\s*==)(.*?)\]?$/))?
(c="",a.match(/^\./)&&(f("dojox.json._find"),c=",true)"),f(b[1].match(/\=/)?"dojo.map":b[1].match(/\^/)?"dojox.json._distinctFilter":"dojo.filter"),c+",function($obj){return "+b[2]+"})"):(b=a.match(/^\[\s*([\/\\].*)\]/))?".concat().sort(function(a,b){"+b[1].replace(/\s*,?\s*([\/\\])\s*([^,\\\/]+)/g,function(a,b,c){return"var av\x3d "+c.replace(/\$obj/,"a")+",bv\x3d "+c.replace(/\$obj/,"b")+";if(av\x3ebv||bv\x3d\x3dnull){return "+("/"==b?1:-1)+";}\nif(bv\x3eav||av\x3d\x3dnull){return "+("/"==b?-1:
1)+";}\n"})+"return 0;})":(b=a.match(/^\[(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)\]/))?(f("dojox.json._slice"),","+(b[1]||0)+","+(b[2]||0)+","+(b[3]||1)+")"):a.match(/^\.\.|\.\*|\[\s*\*\s*\]|,/)?(f("dojox.json._find"),("."==a.charAt(1)?",'"+c+"'":a.match(/,/)?","+a:"")+")"):a}).replace(/(\$obj\s*((\.\s*[\w_$]+\s*)|(\[\s*`([0-9]+)\s*`\]))*)(==|~)\s*`([0-9]+)/g,k).replace(/`([0-9]+)\s*(==|~)\s*(\$obj\s*((\.\s*[\w_$]+)|(\[\s*`([0-9]+)\s*`\]))*)/g,function(a,b,c,d,e,f,g,h){return k(a,d,e,f,g,h,c,b)});a=e+("$"==
a.charAt(0)?"":"$")+a.replace(/`([0-9]+|\])/g,function(a,b){return"]"==b?"]":g[b]});for(var c=eval("1\x26\x26function($,$1,$2,$3,$4,$5,$6,$7,$8,$9){var $obj\x3d$;return "+a+"}"),l=0;l<arguments.length-1;l++)arguments[l]=arguments[l+1];return b?c.apply(this,arguments):c}})},"esri/tasks/PrintParameters":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.tasks.PrintParameters",map:null,template:null,outSpatialReference:null,
extraParameters:null});return a("extend-esri")&&l.setObject("tasks.PrintParameters",h,d),h})},"cmv/viewer/js/gis/dijit/Print/nls/resource":function(){define({root:{title:"Title",format:"Format",layout:"Layout",settings:"Settings",mapScaleExtent:"Map scale/extent",preserve:"Preserve",mapScale:"map scale",mapExtent:"map extent",fullLayoutOptions:"Full layout options",scaleBarUnits:"Scale bar units",miles:"Miles",kilometers:"Kilometers",meters:"Meters",feet:"Feet",includeLegend:"Include legend",printQualityOptions:"Print quality options",
dpiInput:{label:"DPI",invalidMessage:"Please enter a numeric value.",rangeMessage:"Please enter a value between 100 and 300."},mapOnlyOptions:"MAP_ONLY options",width:"Width",height:"Height",printButton:{busyLabel:"printing",label:"Print"},clearHistoryButton:{label:"Clear Print History"},printResults:{progressBar:{label:"Creating Print"},errorMessage:"Error, try again"}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],
function(h,l,a){return h("dijit.form.RadioButton",[l,a],{baseClass:"dijitRadio"})})},"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "),function(h,l,a,d,b,f){return l("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){var a=[];b("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(d.hitch(this,function(b){b.name==this.name&&b.form==this.focusNode.form&&
(b=f.getEnclosingWidget(b))&&a.push(b)}));return a},_setCheckedAttr:function(a){this.inherited(arguments);this._created&&a&&h.forEach(this._getRelatedWidgets(),d.hitch(this,function(a){a!=this&&a.checked&&a.set("checked",!1)}))},_getSubmitValue:function(a){return null==a?"on":a},_onClick:function(b){if(this.checked||this.disabled)return b.stopPropagation(),b.preventDefault(),!1;if(this.readOnly)return b.stopPropagation(),b.preventDefault(),h.forEach(this._getRelatedWidgets(),d.hitch(this,function(b){a.set(this.focusNode||
this.domNode,"checked",b.checked)})),!1;var f=!1,g;h.some(this._getRelatedWidgets(),function(a){return a.checked?(g=a,!0):!1});this.checked=!0;g&&(g.checked=!1);if(!1===this.onClick(b)||b.defaultPrevented)f=!0;this.checked=!1;g&&(g.checked=!0);f?b.preventDefault():this.set("checked",!0);return!f}})})},"cmv/viewer/js/gis/dijit/Directions":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin esri/dijit/Directions dojo/text!./Directions/templates/Directions.html dojo/_base/lang dijit/Menu dijit/MenuItem dijit/PopupMenuItem dijit/MenuSeparator esri/geometry/Point esri/SpatialReference dojo/topic dojo/i18n!./Directions/nls/resource dojo/dom-style".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u){return h([l,a],{templateString:b,i18n:r,postCreate:function(){this.inherited(arguments);this.directions=new d(f.mixin({map:this.map},this.options),this.directionsNode);this.directions.startup();this.directions._activateButton?u.set(this.directions._activateButton,"display","none"):this.directions._activateButtonNode&&(u.set(this.directions._activateButtonNode,"display","none"),u.set(this.directions._addDestinationNode,"float","inherit"),u.set(this.directions._optionsButtonNode,
{"float":"inherit",marginRight:"5px"}));this.mapRightClickMenu&&this.addRightClickMenu()},addRightClickMenu:function(){this.map.on("MouseDown",f.hitch(this,function(a){this.mapRightClickPoint=a.mapPoint}));this.menu=new k;this.menu.addChild(new m({label:this.i18n.labels.directionsFromHere,onClick:f.hitch(this,"directionsFrom")}));this.menu.addChild(new m({label:this.i18n.labels.directionsToHere,onClick:f.hitch(this,"directionsTo")}));this.menu.addChild(new e);this.menu.addChild(new m({label:this.i18n.labels.addStop,
onClick:f.hitch(this,"addStop")}));this.menu.addChild(new e);this.menu.addChild(new m({label:this.i18n.labels.useMyLocationAsStart,onClick:f.hitch(this,"getGeoLocation","directionsFrom")}));this.menu.addChild(new m({label:this.i18n.labels.useMyLocationAsEnd,onClick:f.hitch(this,"getGeoLocation","directionsTo")}));this.mapRightClickMenu.addChild(new g({label:this.i18n.labels.directions,popup:this.menu}))},clearStops:function(){this.directions.reset()},directionsFrom:function(){this.directions.updateStop(this.mapRightClickPoint,
0).then(f.hitch(this,"doRoute"))},directionsTo:function(){this.directions.updateStop(this.mapRightClickPoint,this.directions.stops.length-1).then(f.hitch(this,"doRoute"))},addStop:function(){this.directions.addStop(this.mapRightClickPoint,this.directions.stops.length-1).then(f.hitch(this,"doRoute"))},doRoute:function(){this.parentWidget&&!this.parentWidget.open&&this.parentWidget.toggle();this.directions.stops[0]&&this.directions.stops[1]&&this.directions.getDirections()},startAtMyLocation:function(){this.getGeoLocation("directionsFrom")},
endAtMyLocation:function(){this.getGeoLocation("directionsTo")},getGeoLocation:function(a){navigator&&navigator.geolocation?navigator.geolocation.getCurrentPosition(f.hitch(this,"locationSuccess",a),f.hitch(this,"locationError")):q.publish("growler/growl",{title:this.i18n.errors.geoLocation.title,message:this.i18n.errors.geoLocation.message,level:"default",timeout:1E4,opacity:1})},locationSuccess:function(a,b){this.mapRightClickPoint=new c(b.coords.longitude,b.coords.latitude,new n({wkid:4326}));
this[a]()},locationError:function(a){q.publish("growler/growl",{title:this.i18n.errors.location.title,message:this.i18n.errors.location.message+a.message,level:"default",timeout:1E4,opacity:1})}})})},"esri/dijit/Directions":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/_base/array dojo/_base/Color dijit/a11yclick dijit/_TemplatedMixin dijit/form/Select dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/TimeTextBox dojo/store/Memory dojo/data/ObjectStore dojo/keys dojo/has dojo/on dojo/mouse dojo/dom dojo/dom-geometry dojo/dom-style dojo/dom-class dojo/dom-attr dojo/query dojo/number dojo/i18n!../nls/jsapi dojo/text!./templates/Directions.html ./Search dojo/dom-construct dojo/promise/all dojo/Deferred dojo/dnd/Source dojo/json ../kernel ../urlUtils ../graphic ../units ../TimeExtent ../InfoTemplate ../SpatialReference ../layers/ArcGISDynamicMapServiceLayer ../layers/GraphicsLayer ../geometry/webMercatorUtils ../geometry/geodesicUtils ../arcgis/utils ../geometry/Point ../geometry/Extent ../geometry/Polyline ../geometry/mathUtils ../symbols/SimpleMarkerSymbol ../symbols/PictureMarkerSymbol ../symbols/CartographicLineSymbol ../symbols/TextSymbol ../renderers/UniqueValueRenderer ../symbols/Font ./_EventedWidget ../tasks/FeatureSet ../tasks/RouteTask ../tasks/RouteParameters ../tasks/GeometryService ../tasks/DistanceParameters ../tasks/PrintTask ../tasks/PrintParameters ../tasks/PrintTemplate ../toolbars/edit ../config ../tasks/ProjectParameters dojo/uacss".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K,J,I,L,M,N,Q,O,T,S,R,U,W,fa,ea,oa,pa,Aa,ta,va,ua,qa,ca,ja,la,ka,sa,Ea,ra,za,wa,Ha,Ga,Ca,Sa,Ka,Wa,Pa){var La=N.getProtocolForWebResource();l=l("esri.dijit.Directions",[sa,m],{templateString:F,mapClickActive:!1,_eventMap:{activate:!0,deactivate:!1,load:!0,"directions-start":!0,"directions-finish":["result"],"directions-clear":!0,"segment-select":["graphic"],"segment-highlight":["graphic"],error:["error"],"stops-update":["stops"],"route-item-created":!0,
"route-item-updated":!0,"feature-collection-created":!0},_emptyStop:{name:""},constructor:function(b,c){if(!b.map)throw Error('Required "map" parameter is missing. Cannot instantiate Directions Widget.');if(!c)throw Error('Required "srcNodeRef" parameter is missing. Cannot instantiate Directions Widget.');this._i18n=E;this._css={widgetContainerClass:"esriDirectionsContainer",searchSourceContainerClass:"esriSearchSourceContainer",stopsContainerClass:"esriStopsContainer",stopsTableContainerClass:"esriStopsTableContainer",
stopsTableCoverClass:"esriStopsTableCover",reverseStopsClass:"esriStopsReverse",addStopsClass:"esriStopsAdd",stopsClass:"esriStops",stopsRemovableClass:"esriStopsRemovable",stopsButtonContainerClass:"esriStopsButtons",stopsOptionsButtonClass:"esriStopsOptionsButton",stopsAddDestinationClass:"esriStopsAddDestination",stopsAddDestinationBtnClass:"esriStopsAddDestinationBtn",stopsGetDirectionsContainerClass:"esriStopsGetDirectionsContainer",stopsGetDirectionsClass:"esriStopsGetDirections",stopsClearDirectionsClass:"esriStopsClearDirections",
stopsInnerGeocoderClass:"esriInnerGeocoder",stopsOptionsOptionsEnabledClass:"esriStopsOptionsEnabled",stopsOptionsMenuClass:"esriStopsOptionsMenu",stopsFindOptimalOrderClass:"esriFindOptimalOrderOption",stopsUseTrafficClass:"esriUseTrafficOption",stopsReturnToStartClass:"esriReturnToStartOption",stopsOptionsCheckboxesClass:"esriOptionsCheckboxes",stopsOptionsToggleContainerClass:"esriOptionsToggleContainer",stopsOptionsUnitsContainerClass:"esriOptionsUnitsContainer",stopsOptionsUnitsMiClass:"esriOptionsUnitsMi",
stopsOptionsUnitsKmClass:"esriOptionsUnitsKm",stopsOptionsImpedanceContainerClass:"esriOptionsImpedanceContainer",stopsOptionsImpedanceTimeClass:"esriOptionsImpedanceTime",stopsOptionsImpedanceDistanceClass:"esriOptionsImpedanceDistance",stopClass:"esriStop",stopOriginClass:"esriStopOrigin",stopDestinationClass:"esriStopDestination",stopUnreachedFirstOrLastClass:"esriStopUnreachedFirstOrLast",stopUnreachedClass:"esriStopUnreached",esriStopGeocoderColumnClass:"esriStopGeocoderColumn",esriStopReverseColumnClass:"esriStopReverseColumn",
stopDnDHandleClass:"esriStopDnDHandle",stopDnDHandleClassHidden:"esriStopDnDHandleHidden",stopIconColumnClass:"esriStopIconColumn",stopIconClass:"esriStopIcon",stopIconRemoveColumnClass:"esriStopIconRemoveColumn",stopIconRemoveClass:"esriStopIconRemove",stopIconRemoveClassHidden:"esriStopIconRemoveHidden",resultsContainerClass:"esriResultsContainer",resultsLoadingClass:"esriResultsLoading",resultsPrintClass:"esriResultsPrint",resultsSaveClass:"esriResultsSave",resultsSummaryClass:"esriResultsSummary",
routesContainerClass:"esriRoutesContainer",routesClass:"esriRoutes",routesErrorClass:"esriRoutesError",routesInfoClass:"esriRoutesInfo",routeClass:"esriRoute",routeTextColumnClass:"esriRouteTextColumn",routeTextClass:"esriRouteText",routeLengthClass:"esriRouteLength",routeOriginClass:"esriDMTStopOrigin",routeDestinationClass:"esriDMTStopDestination",routeInfoClass:"esriRouteInfo",routeIconColumnClass:"esriRouteIconColumn",routeIconClass:"esriRouteIcon",infoWindowRouteClass:"esriInfoWindowRoute",routeZoomClass:"esriRouteZoom",
esriPrintPageClass:"esriPrintPage",esriPrintBarClass:"esriPrintBar",esriPrintButtonClass:"esriPrintButton",esriCloseButtonClass:"esriCloseButton",esriPrintMainClass:"esriPrintMain",esriPrintHeaderClass:"esriPrintHeader",esriPrintLogoClass:"esriPrintLogo",esriPrintMapClass:"esriPrintMap",esriPrintNameClass:"esriPrintName",esriPrintNotesClass:"esriPrintNotes",esriPrintLengthClass:"esriPrintLength",esriPrintDirectionsClass:"esriPrintDirections",esriPrintFooterClass:"esriPrintFooter",esriPrintStopLabelClass:"esriPrintStopLabel",
clearClass:"esriClear",dndDragBodyClass:"esriDndDragDirection",stopsButtonClass:"esriDirectionsButton",stopsButtonTabClass:"esriDirectionsTabButton",stopsButtonTabLastClass:"esriDirectionsTabLastButton",stopsPressedButtonClass:"esriDirectionsPressedButton",linkButtonClass:"esriLinkButton",activateButtonClass:"esriActivateButton",travelModesContainerClass:"esriTravelModesContainer"};this.options={map:null,autoSolve:!0,minStops:2,maxStops:20,theme:"simpleDirections",alphabet:"1234567890",directions:null,
returnToStart:!1,optimalRoute:!1,routeTaskUrl:La+"//route.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",printTaskUrl:La+"//utility.arcgisonline.com/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task",geometryTaskUrl:La+"//utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",routeParams:{},stops:["",""],searchOptions:{},stopsInfoTemplate:new S(E.widgets.directions.stop,"${address}${error}"),waypointInfoTemplate:new S(E.widgets.directions.maneuver,
E.widgets.directions.waypoint),segmentInfoTemplate:new S(E.widgets.directions.maneuver,'\x3cdiv class\x3d"${maneuverType}"\x3e\x3cdiv class\x3d"'+this._css.routeIconClass+" "+this._css.infoWindowRouteClass+'"\x3e\x3cstrong\x3e${step}.\x3c/strong\x3e ${formattedText}\x3c/div\x3e\x3c/div\x3e'),textSymbolFont:new ka("11px",ka.STYLE_NORMAL,ka.VARIANT_NORMAL,ka.WEIGHT_NORMAL,"Arial, Helvetica, sans-serif"),textSymbolColor:new f([255,255,255]),textSymbolOffset:{x:0,y:10.875},fromSymbol:(new qa({url:h.toUrl("./images/Directions/greenPoint.png"),
height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),fromSymbolDrag:(new qa({url:h.toUrl("./images/Directions/greenPointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),stopSymbol:(new qa({url:h.toUrl("./images/Directions/bluePoint.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),stopSymbolDrag:(new qa({url:h.toUrl("./images/Directions/bluePointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),toSymbol:(new qa({url:h.toUrl("./images/Directions/redPoint.png"),
height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),toSymbolDrag:(new qa({url:h.toUrl("./images/Directions/redPointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),unreachedSymbol:(new qa({url:h.toUrl("./images/Directions/grayPoint.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),unreachedSymbolDrag:(new qa({url:h.toUrl("./images/Directions/grayPointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),waypointSymbol:new ua({color:[255,
255,255,255],size:10,type:"esriSMS",style:"esriSMSCircle",outline:{color:[20,89,127,255],width:2.5,type:"esriSLS",style:"esriSLSSolid"}}),maneuverSymbol:new ua({color:[255,255,255,255],size:4,type:"esriSMS",style:"esriSMSCircle",outline:{color:[30,99,137,255],width:1,type:"esriSLS",style:"esriSLSSolid"}}),routeSymbol:(new ca).setColor(new f([20,89,127,1])).setWidth(10).setCap(ca.CAP_ROUND).setJoin(ca.JOIN_ROUND),segmentSymbol:(new ca).setColor(new f([255,255,255,1])).setWidth(6).setCap(ca.CAP_ROUND).setJoin(ca.JOIN_ROUND),
barrierRenderer:new la({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{type:"esriPMS",imageData:"PHN2ZyB3aWR0aD0iMjIyIiBoZWlnaHQ9IjIyMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGc+CjxlbGxpcHNlIGZpbGw9IiNmZjAwMDAiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLXdpZHRoPSIyMCIgY3g9IjExMiIgY3k9IjExMSIgaWQ9InN2Z181IiByeD0iMTAwIiByeT0iMTAwIi8+CjxlbGxpcHNlIGZpbGw9IiNmZjAwMDAiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLXdpZHRoPSIyMCIgY3g9IjExMiIgY3k9IjExMSIgaWQ9InN2Z182IiByeD0iOTUiIHJ5PSI5NSIvPgo8cmVjdCBmaWxsPSIjZmYwMDAwIiBzdHJva2Utd2lkdGg9IjIwIiB4PSI2NC41IiB5PSIxMDIiIHdpZHRoPSI5NSIgaGVpZ2h0PSIxOCIgaWQ9InN2Z183IiBzdHJva2U9IiNmZmZmZmYiLz4KPC9nPgo8L3N2Zz4\x3d",
contentType:"image/svg+xml",width:18,height:18},uniqueValueInfos:[{value:"2",symbol:{type:"esriPMS",imageData:"PHN2ZyB3aWR0aD0iMjg2IiBoZWlnaHQ9IjI1NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGc+CjxwYXRoIGZpbGw9IiNmZmYiIHN0cm9rZS13aWR0aD0iMTAiIGQ9Im04Ljc0OTk5MiwyNTEuNzQ5OTk3bDEzNC45OTk5OTgsLTI0MS45OTk5OThsMTM0Ljk5OTk5OCwyNDEuOTk5OTk4bC0yNjkuOTk5OTk1LDBsLTAuMDAwMDAxLDB6IiBpZD0ic3ZnXzEiIHN0cm9rZT0iIzAwMCIvPgo8cGF0aCBzdHJva2U9IiNmZmYiIGZpbGw9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMTUiIGQ9Im0yMy41MDAwMDQsMjQyLjUwMDAwNWwxMTkuOTk5OTkyLC0yMTUuOTk5OTk5bDExOS45OTk5OTIsMjE1Ljk5OTk5OWwtMjM5Ljk5OTk4MywwbC0wLjAwMDAwMSwweiIgaWQ9InN2Z18yIi8+Cjx0ZXh0IGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSIjZmZmZmZmIiBzdHJva2U9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMCIgeD0iMTA5IiB5PSIyMjIuNzUiIGlkPSJzdmdfNSIgZm9udC1zaXplPSIxODAiIGZvbnQtZmFtaWx5PSJHZW9yZ2lhLCBUaW1lcywgJ1RpbWVzIE5ldyBSb21hbicsIHNlcmlmIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIHhtbDpzcGFjZT0icHJlc2VydmUiPiE8L3RleHQ+CjwvZz4KPC9zdmc+",
contentType:"image/svg+xml",width:19,height:18}}]}),polylineBarrierRenderer:new la({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{color:[255,0,0,184],width:7.5,type:"esriSLS",style:"esriSLSSolid"},uniqueValueInfos:[{value:"1",symbol:{color:[255,85,0,184],width:7.5,type:"esriSLS",style:"esriSLSSolid"}}]}),polygonBarrierRenderer:new la({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{color:[255,0,0,156],outline:{color:[255,0,0,153],width:2.4,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",
style:"esriSFSSolid"},uniqueValueInfos:[{value:"1",symbol:{color:[255,170,0,156],outline:{color:[255,0,0,153],width:7.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}]}),printPage:"",printTemplate:"",focusOnNewStop:!0,dragging:!0,canModifyStops:!0,canModifyWaypoints:!0,directionsLengthUnits:null,directionsLanguage:null,traffic:!1,trafficLayer:null,showPrintPage:!0,showSaveButton:!1,showSegmentPopup:!1,showSegmentHighlight:!0,showReverseStopsButton:!0,showReturnToStartOption:!0,
showOptimalRouteOption:!0,showTravelModesOption:!0,showMilesKilometersOption:!0,showClearButton:!1,showActivateButton:!0,loaded:!1,routeLayer:{itemId:null,title:null,isItemOwner:!0,ownerFolder:null},startTime:"now"};if(this.userOptions=b,this.defaults=a.mixin({},this.options,b,{_waypointName:"DWWP",_userDefinedStopName:"UserDefinedStopName",_solveInProgress:!1,_moveInProgress:!1,_stopSequence:1E3}),(!this.defaults.minStops||2>this.defaults.minStops)&&(this.defaults.minStops=2),2<this.defaults.minStops&&
this.defaults.stops&&","===this.defaults.stops.toString())for(var d=2;d<this.defaults.minStops;d++)this.defaults.stops.splice(0,0,"");this.domNode=c},postCreate:function(){this.inherited(arguments);this.own(t(this._activateButtonNode,k,a.hitch(this,function(){this.mapClickActive?this.deactivate():this.activate()})));this.own(t(this._addDestinationNode,k,a.hitch(this,this._addStopButton)));this.own(t(this._optionsButtonNode,k,a.hitch(this,this._toggleOptionsMenu)));this.own(t(this._saveMenuButton,
k,a.hitch(this,this._toggleSaveMenu)));this.own(t(this._saveButton,k,a.hitch(this,function(){this._saveButton._enabled&&this._storeRouteUI()})));this.own(t(this._saveAsButton,k,a.hitch(this,function(){a.mixin(this.routeLayer,{itemId:null,title:null,ownerFolder:null});this._storeRouteUI()})));this.own(t(this._findOptimalOrderNode,k,a.hitch(this,this._toggleCheckbox)));this.own(t(this._returnToStartNode,k,a.hitch(this,this._toggleCheckbox)));this.own(t(this._useTrafficNode,k,a.hitch(this,this._toggleCheckbox)));
this.own(t(this._useMilesNode,k,a.hitch(this,this._toggleUnits)));this.own(t(this._useKilometersNode,k,a.hitch(this,this._toggleUnits)));this.own(t(this._getDirectionsButtonNode,k,a.hitch(this,this.getDirections)));this.own(t(this._clearDirectionsButtonNode,k,a.hitch(this,function(){this.clearDirections()})));var c=a.hitch(this,function(){clearTimeout(this._startTimeMenu._hideTimer);this._startTimeMenu._hideTimer=setTimeout(a.hitch(this,function(){z.set(this._startTimeMenu,"display","none")}),100)});
this.own(t(this._startTimeButtonNode,k,a.hitch(this,function(){this._startTimeButtonNode.disabled||"block"===z.get(this._startTimeMenu,"display")?z.set(this._startTimeMenu,"display","none"):(z.set(this._startTimeMenu,"display","block"),this[isNaN(this.startTime)?"_startTimeMenuLeaveNow":"_startTimeMenuDepartAt"].focus())})));this.own(t(this._startTimeMenuLeaveNow,"blur",c));this.own(t(this._startTimeMenuDepartAt,"blur",c));this.own(t(this._startTimeMenuLeaveNow,"mousedown",a.hitch(this,function(){this.startTime=
"now";this._updateStartTimeUI();this._clearDisplayBeforeSolve()})));this.own(t(this._startTimeMenuDepartAt,"mousedown",a.hitch(this,function(){this.startTime=(new Date).getTime();this._updateStartTimeUI();this._clearDisplayBeforeSolve()})));this._symbolEventPaddingDirections=(new ca).setColor(new f([0,255,0,0])).setWidth(20).setCap(ca.CAP_ROUND);this._stopLayer=new W({id:"directions_stopLayer_"+this.id,displayOnPan:!0});this._routeLayer=new W({id:"directions_routeLayer_"+this.id,displayOnPan:!0});
this._waypointsEventLayer=new W({id:"directions_waypointsEventLayer_"+this.id,displayOnPan:!0});this._barriersLayer=new W({id:"directions_barriersLayer_"+this.id,displayOnPan:!0});this._polylineBarriersLayer=new W({id:"directions_polylineBarriersLayer_"+this.id,displayOnPan:!0});this._polygonBarriersLayer=new W({id:"directions_polygonBarriersLayer_"+this.id,displayOnPan:!0});this._barriersLayer.setRenderer(this.defaults.barrierRenderer);this._polylineBarriersLayer.setRenderer(this.defaults.polylineBarrierRenderer);
this._polygonBarriersLayer.setRenderer(this.defaults.polygonBarrierRenderer);this.map.addLayer(this._routeLayer);this.map.addLayer(this._polygonBarriersLayer);this.map.addLayer(this._polylineBarriersLayer);this.map.addLayer(this._barriersLayer);this.map.addLayer(this._stopLayer);this._snappingManager=this.map.enableSnapping({layerInfos:[{layer:this._waypointsEventLayer,snapToVertex:!1,snapToPoint:!0,snapToEdge:!0}],tolerance:15});this._setWidgetProperties();var d=new Q(null,this.waypointSymbol,{}),
c=a.hitch(this,function(){this._moveInProgress||this._solveInProgress||!d._isShown()||(this.editToolbar.deactivate(),this._stopLayer.remove(d),clearTimeout(d._solveTimeout),d._solveTimeout=null,d.attributes.isWaypoint=!0,d._isStopIcon&&this.stopGraphics[d._index]&&(this._stopLayer.add(this.stopGraphics[d._index]),this._stopLayer.add(this.textGraphics[d._index])));d._showTooltip()});this._handle=a.mixin(d,{_isHandle:!0,_tooltip:G.create("div",{className:this.theme+" esriDirectionsRouteTooltip",onmouseover:c},
this.map.container),_showTooltip:a.hitch(this,function(a){d._tooltip.style.display=!a||a instanceof MouseEvent?"none":"inline";a&&(a="string"==typeof a?a:"\x3ctable class\x3d'esriRoutesTooltip'\x3e"+this._renderDirectionsItemTR(a)+"\x3c/table\x3e",d._tooltip.innerHTML!==a&&(d._tooltip.innerHTML=a))}),_isShown:a.hitch(this,function(){return-1<b.indexOf(this._stopLayer.graphics,d)}),_remove:c});this._activate(this.mapClickActive)},startup:function(){return this.inherited(arguments),this._enqueue(this._init)},
destroy:function(){this.deactivate();this.map.removeLayer(this._barriersLayer);this.map.removeLayer(this._polylineBarriersLayer);this.map.removeLayer(this._polygonBarriersLayer);this.map.removeLayer(this._routeLayer);this.map.removeLayer(this._stopLayer);this.map.removeLayer(this._waypointsEventLayer);this._disconnectEvents();G.empty(this.domNode);this.inherited(arguments)},activate:function(){return this._enqueue(function(){this.set("mapClickActive",!0)})},deactivate:function(){return this._enqueue(function(){this.set("mapClickActive",
!1)})},clearDirections:function(){return this._enqueue(function(){return this.clearMessages(),this._clearDirections()})},reset:function(){return this._enqueue(this._reset)},modifyStopSequence:function(a,b){return this._enqueue(function(){return this._modifyStopSequence(a,b)})},onActivate:function(){},onDeactivate:function(){},onLoad:function(){this._enableButton(this._getDirectionsButtonNode)},onDirectionsStart:function(){this._clearDisplayBeforeSolve();this.set("solving",!0);this._showLoadingSpinner(!0)},
onDirectionsFinish:function(){this._showLoadingSpinner(!1);this.set("solving",!1)},onDirectionsClear:function(){},onSegmentSelect:function(){},onSegmentHighlight:function(){},onStopsUpdate:function(){},onRouteItemCreated:function(){},onRouteItemUpdated:function(){},onFeatureCollectionCreated:function(){},onError:function(){},removeStops:function(){return this.reset()},removeStop:function(a,b,c){return this._enqueue(function(){return this.clearMessages(),this._removeStop(a,b,c)})},updateStops:function(a){return this._enqueue(function(){return this._updateStops(a)})},
addStops:function(b,c){return this._enqueue(function(){return this._addStops(b,c)}).then(a.hitch(this,this.zoomToFullRoute))},addStop:function(a,b){return this._enqueue(function(){return this._addStop(a,b)},{_incrementalSolveStopRange:this._incrementalSolveStopRange})},updateStop:function(a,b,c){return this._enqueue(function(){return this._updateStop(a,b,c)},{_incrementalSolveStopRange:this._incrementalSolveStopRange})},clearMessages:function(){this.messages=[];this._msgNode&&(this._msgNode.innerHTML=
"")},getDirections:function(b){return this._enqueue(function(){return this._getDirections().then(a.hitch(this,function(){!0!==b&&this.zoomToFullRoute()}))})},selectSegment:function(a){if(!(!this.directions||!this.directions.features||0>a||a>=this.directions.features.length))for(var b=C("[data-segment]",this._resultsNode),c=0;c<b.length;c++){var d=parseInt(B.get(b[c],"data-segment"),10);if(a===d&&b[c]!==this._focusedDirectionsItem){this._focusedDirectionsItem=b[c];this.centerAtSegmentStart(a);this.onSegmentSelect(this.directions.features[a]);
b[c].focus();break}}},unhighlightSegment:function(a){var b=this._segmentGraphics;if(b&&(!this._focusedDirectionsItem||a)){for(a=0;a<b.length;a++)this._routeLayer.remove(b[a]);this._segmentGraphics=[]}},highlightSegment:function(b,c){if(!(this._focusedDirectionsItem&&!c||b>=this.directions.features.length)){b=b||0;var d=a.hitch(this,function(a){var b=this.map.toMap({x:0,y:0});return this.map.toScreen(b.offset(a,0)).x}),e=a.hitch(this,function(a){for(var b=0,c=0;c<a.length;c++)for(var e=1;e<a[c].length;e++)var f=
a[c][e-1],g=a[c][e],b=b+d(Math.sqrt((f[0]-g[0])*(f[0]-g[0])+(f[1]-g[1])*(f[1]-g[1])));return b}),g=a.hitch(this,function(a){var b=this.map.toMap({x:0,y:0});return this.map.toMap({x:a,y:0}).x-b.x}),k=function(a,b,c){b=Math.max(1,b);for(var e,f,g,k=c?a[0].length-1:0,h=0,m=[[a[0][c?k:0]]];c&&0<k||!c&&k<a[0].length-1;){if(f=a[0][c?k-1:k],g=a[0][c?k:k+1],e=d(Math.sqrt((f[0]-g[0])*(f[0]-g[0])+(f[1]-g[1])*(f[1]-g[1])))){if(!(b>h+e)){b=(b-h)/e;c?m[0].splice(0,0,[g[0]-(g[0]-f[0])*b,g[1]-(g[1]-f[1])*b]):m[0].push([f[0]+
(g[0]-f[0])*b,f[1]+(g[1]-f[1])*b]);break}c?m[0].splice(0,0,f):m[0].push(g);h+=e}k+=c?-1:1}return 0<h+e?m:a},h=this.get("directions").features[b],m=new ta(h.geometry),l=40*Math.PI/180;if(a.mixin(h.attributes,{_index:b}),b){var n=k(this.get("directions").features[b-1].geometry.paths,25,!0),q="esriDMTStop"!==h.attributes.maneuverType?k(m.paths,25,!1):n,n=q!==n?[n[0].concat(q[0])]:q,r=(new ta(q)).getExtent();if(1<q[0].length&&15<=d(Math.max(r.getWidth(),r.getHeight()))){for(var u,k=15*Math.cos(l/2),l=
15*Math.sin(l/2),t=q[0].length-2,e=q[0][t+1],r=0;0<=t&&!r;)u=q[0][t],r=d(Math.sqrt((u[0]-e[0])*(u[0]-e[0])+(u[1]-e[1])*(u[1]-e[1]))),t--;22>r&&(q=r+(22-r)/3,t=r+2*(22-r)/3,t=[u[0]+t/r*(e[0]-u[0]),u[1]+t/r*(e[1]-u[1])],u=[e[0]-q/r*(e[0]-u[0]),e[1]-q/r*(e[1]-u[1])],e=t,r=22);var v,w,q=k/r,k=[e[0]-(e[0]-u[0])*q,e[1]-(e[1]-u[1])*q];u[1]!==e[1]?(q=(e[0]-u[0])/(e[1]-u[1]),v=g(l/Math.sqrt(1+q*q)),w=q*v):(v=0,w=g(l));Math.abs(v)===1/0||Math.abs(w)===1/0||isNaN(v)||isNaN(w)||(n[0].push(e),n[0].push([k[0]-
v,k[1]+w]),n[0].push([k[0]+v,k[1]-w]),n[0].push(e))}else n=k(n,2*e(q),!0);m.paths=n}this.unhighlightSegment(this._segmentGraphics&&this._segmentGraphics.length);g=a.clone(this.routeSymbol).setWidth(this.segmentSymbol.width).setColor(new f([parseInt(.9*this.segmentSymbol.color.r),parseInt(.9*this.segmentSymbol.color.g),parseInt(.9*this.segmentSymbol.color.b)]));this._segmentGraphics=[new Q(h.geometry,g,h.attributes,this.get("segmentInfoTemplate")),new Q(m,this.routeSymbol,h.attributes,this.get("segmentInfoTemplate")),
new Q(m,this.segmentSymbol,h.attributes,this.get("segmentInfoTemplate"))];this.get("showSegmentHighlight")&&(this._routeLayer.add(this._segmentGraphics[0]),this._routeLayer.add(this._segmentGraphics[1]),this._routeLayer.add(this._segmentGraphics[2]));h=a.hitch(this,function(a){if(0<a&&a<this.directions.features.length){a=this.directions.features[a]._associatedFeaturesWithWaypoints;for(var b=0;b<a.length;b++)a[b]._associatedSnapFeature&&a[b]._associatedSnapFeature.getDojoShape()&&a[b]._associatedSnapFeature.getDojoShape().moveToFront()}});
h(b-1);h(b);this.onSegmentHighlight(this.directions.features[b])}},zoomToSegment:function(b){var c,d=new J;return this.directions&&this.directions.features?(c=Math.max(0,Math.min(this.directions.features.length-1,b||0)),this.map.setExtent(this.get("directions").features[c].geometry.getExtent(),!0).promise.always(a.hitch(this,function(){this.highlightSegment(c);d.resolve()}))):d.reject(Error("No directions.")),d.promise},centerAtSegmentStart:function(b){var c,d=new J;if(this.directions&&this.directions.features){c=
Math.max(0,Math.min(this.directions.features.length-1,b||0));var e=this.directions.features[c];this.map.centerAt(e.geometry.getPoint(0,0)).promise.always(a.hitch(this,function(){this.highlightSegment(c,!0);this._showSegmentPopup(e,c);d.resolve()}))}else d.reject(Error("No directions."));return d.promise},zoomToFullRoute:function(){var a=new J;return this.directions&&this.directions.features?(this._clearInfoWindow(),this.unhighlightSegment(),this.get("map").setExtent(this.get("directions").extent,
!0).promise.always(a.resolve)):a.reject(Error("No directions.")),a.promise},setListIcons:function(){var a,b=this._dnd.getAllNodes();for(a=0;a<b.length;a++){var c=C("."+this._css.stopIconClass,b[a])[0];c&&(c.innerHTML=this._getLetter(a));A.remove(b[a],this._css.stopOriginClass+" "+this._css.stopDestinationClass+" "+this._css.stopUnreachedClass+" "+this._css.stopUnreachedFirstOrLastClass);c=this._getStopSymbol(this.stops[a]);c===this.fromSymbol?A.add(b[a],this._css.stopOriginClass):c===this.toSymbol?
A.add(b[a],this._css.stopDestinationClass):c===this.unreachedSymbol&&A.add(b[a],this._css.stopUnreachedClass)}a=C("[data-reverse-td]",this._dndNode)[0];G.destroy(a);this.get("showReverseStopsButton")&&G.create("td",{"data-reverse-td":"true",rowspan:b.length,className:this._css.esriStopReverseColumnClass,innerHTML:'\x3cdiv role\x3d"button" class\x3d"'+this._css.reverseStopsClass+'" data-reverse-stops\x3d"true" title\x3d"'+E.widgets.directions.reverseDirections+'"\x3e\x3c/div\x3e',onmouseover:function(a){a.stopPropagation()},
onmouseout:function(a){a.stopPropagation()}},b[0])},addRouteSymbols:function(){if(this.stopGraphics.length){this._moveLayersToFront();for(var a=0;a<this.stopGraphics.length;a++)if(this.stopGraphics[a]&&(!this._handle._isShown()||this._handle._isShown()&&this._handle._index!==a)){this._stopLayer.add(this.stopGraphics[a]);var b=this.stopGraphics[a].getDojoShape();b&&b.moveToFront();this._stopLayer.add(this.textGraphics[a]);(b=this.textGraphics[a].getDojoShape())&&b.moveToFront()}this._moveInProgress&&
!this._handle.attributes.isWaypoint&&this._handle.getDojoShape()&&this._handle.getDojoShape().moveToFront()}},createRouteSymbols:function(){this._clearStopGraphics();for(var b=this.stops,c=function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&0===c.indexOf("Attr_")&&(b[c]=a[c]);return b},d=0;d<b.length;d++){var e=b[d];if(e&&e.feature){var f=e.feature.attributes,g=f?f.Status:void 0,k=null;this._isStopAWaypoint(e)||(k=new ja(this._getLetter(d),this.get("textSymbolFont"),this.get("textSymbolColor")),
this.get("textSymbolOffset")&&k.setOffset(this.get("textSymbolOffset").x,this.get("textSymbolOffset").y));k=new Q(e.feature.geometry,k,{address:e.name},this.get("stopsInfoTemplate"));k._isStopLabel=!0;k._index=d;e=new Q(e.feature.geometry,this._getStopSymbol(e),a.mixin({address:e.name,Status:void 0===g?0:g,CurbApproach:f&&f.CurbApproach?f.CurbApproach:null,TimeWindowStart:f&&f.TimeWindowStart?f.TimeWindowStart:null,TimeWindowEnd:f&&f.TimeWindowEnd?f.TimeWindowEnd:null,isWaypoint:this._isStopAWaypoint(e)},
c(f)),this.get(this._isStopAWaypoint(e)?"waypointInfoTemplate":"stopsInfoTemplate"));e._isStopIcon=!0;e._index=d;this.stopGraphics[d]=e;this.textGraphics[d]=k}}this.set("stopGraphics",this.stopGraphics);this.set("textGraphics",this.textGraphics);this.addRouteSymbols();this.setListIcons()},setTravelMode:function(a){return this._enqueue(function(){return this.clearMessages(),this._travelModeSelector.setValue(a),this._setTravelMode(a)})},getSupportedTravelModeNames:function(){var a=[],b=this.serviceDescription;
if(b&&b.supportedTravelModes&&b.supportedTravelModes.length)for(var b=b.supportedTravelModes,c=0;c<b.length;c++)a.push(b[c].name);return a},setDirectionsLengthUnits:function(){var a=1===arguments.length?arguments[0]:this.get("directionsLengthUnits");return this._enqueue(function(){return this.clearMessages(),this._setDirectionsLengthUnits(a)})},setDirectionsLanguage:function(){var a=1===arguments.length?arguments[0]:this.get("directionsLanguage");return this._enqueue(function(){return this.clearMessages(),
this._setDirectionsLanguage(a)})},useMyCurrentLocation:function(a){return this.clearMessages(),this._createLocateButton(this.geocoders[a],!0,!0)},loadRoute:function(b){return this._enqueue(a.hitch(this,function(){return this._loadRoute(b)}))},_getStopsAttr:function(){return this.returnToStart&&this._returnToStartStop?this.stops.concat(this._returnToStartStop):this.stops},_getTravelModeNameAttr:function(){return this.routeParams&&this.routeParams.travelMode&&this.routeParams.travelMode.name},_reset:function(){var b=
this.mapClickActive;return this._clearBarriersGraphics(),this._setWidgetProperties(),this._init().then(a.hitch(this,function(){this.mapClickActive=b;this._searchSourceSelector&&this._searchSourceSelector.setValue("all")}))},_activate:function(){var b=this.get("mapClickActive"),c=a.hitch(this,function(a){for(var b=a?[this.textGraphics,this.stopGraphics,this.displayedManeuverPointGraphics,this.displayedRouteGraphics]:[this.displayedRouteGraphics,this.displayedManeuverPointGraphics,this.stopGraphics,
this.textGraphics],c=0;c<b.length;c++)for(var d=b[c],e=0;e<d.length;e++){var f=d[e].getDojoShape();f&&f[a?"moveToBack":"moveToFront"].call(f)}});this._addStopOnMapClickListener&&this._addStopOnMapClickListener.remove();b?(this.map.activeDirectionsWidget&&this.map.activeDirectionsWidget!==this&&this.map.activeDirectionsWidget.deactivate(),this.map.activeDirectionsWidget=this,this._addStopOnMapClickListener=t(this.map,"click",a.hitch(this,function(a){this.canModifyStops&&!this._solveInProgress&&(this.map.infoWindow.hide(),
this.addStop(new Q(a.mapPoint)))})),this.map.addLayer(this._waypointsEventLayer),this._moveLayersToFront(),A.add(this._activateButtonNode,this._css.stopsPressedButtonClass),this.onActivate()):(this.map.removeLayer(this._waypointsEventLayer),A.remove(this._activateButtonNode,this._css.stopsPressedButtonClass),this.onDeactivate());c(!b);this.emit("map-click-active",{mapClickActive:this.mapClickActive})},_moveLayersToFront:function(){var a=this.get("map"),b=a.graphicsLayerIds.length-1;a.reorderLayer(this._routeLayer,
b);a.reorderLayer(this._polygonBarriersLayer,b);a.reorderLayer(this._polylineBarriersLayer,b);a.reorderLayer(this._barriersLayer,b);a.reorderLayer(this._waypointsEventLayer,b);a.reorderLayer(this._stopLayer,b)},_destroyGeocoders:function(){for(;this.geocoders&&this.geocoders.length;)this.geocoders[0]&&this.geocoders[0].destroy(),this.geocoders.splice(0,1);this.geocoders=[]},_disconnectEvents:function(){var a,b=this._clearDirections(!0);if(this._watchEvents&&this._watchEvents.length)for(a=0;a<this._watchEvents.length;a++)this._watchEvents[a].unwatch();
if(this._onEvents&&this._onEvents.length)for(a=0;a<this._onEvents.length;a++)this._onEvents[a].remove();if(this._geocoderEvents)for(a=0;a<this._geocoderEvents.length;a++)this._geocoderEvents[a].value.unwatch(),this._geocoderEvents[a].blur.remove(),this._geocoderEvents[a].select.remove(),this._geocoderEvents[a].suggest.remove();return this._onEvents=[],this._watchEvents=[],this._geocoderEvents=[],this._disconnectResults(),this._destroyGeocoders(),this._destroyGlobalGeocoder(),this._destroyDnD(),b},
_getDirections:function(){var b=new J;return this._removeEmptyStops(),1<this._getStopCount()+this._getWaypointCount()&&this.loaded?(this.onDirectionsStart(),this.clearMessages(),this._dnd.sync(),this._sortGeocoders(),this._getCandidates(this.stops).then(a.hitch(this,function(c){this.stops=c;this._setStops();this._configureRoute().always(a.hitch(this,function(a){b.resolve(a)}))}),a.hitch(this,function(a){this.set("directions",null);this._clearRouteGraphics();b.reject(a);this.onDirectionsFinish(a)}))):
this._clearDirections(!0).always(a.hitch(this,function(){this.createRouteSymbols();b.reject(Error(this.loaded?E.widgets.directions.error.notEnoughStops:E.widgets.directions.error.notReady))})),b.promise},_clearDirections:function(){var a=new J;return this._handle&&this._handle._remove(),this.get("routeParams")&&this.get("routeParams").stops?this.get("routeParams").stops.features.length?(this._clearBarriersGraphics(),this.get("routeParams").stops.features=[],this.onDirectionsClear(),a.resolve()):arguments.length?
a.resolve():this._reset().then(a.resolve,a.reject):a.resolve(),this.set("directions",null),this._clearDisplayBeforeSolve(),this._clearDisplayAfterSolve(),this._routeLayer.clear(),this._waypointsEventLayer.clear(),this._stopLayer.clear(),a.promise},_setTravelMode:function(a){var b,c=new J;b=this.serviceDescription;var d=function(){c.resolve(a)};if(b&&b.supportedTravelModes&&b.supportedTravelModes.length){var e=b.supportedTravelModes,f=!1;for(b=0;b<e.length;b++)if(e[b].name===a){f=!0;!this.routeParams.travelMode||
this.routeParams.travelMode&&this.routeParams.travelMode.name!==a?(this.routeParams.travelMode=e[b].impedanceAttributeName?e[b]:e[b].itemId,this._checkStartTimeUIAvailability(),this._solveAndZoom().always(d)):d();break}f||c.reject(a)}else c.reject(a);return c.promise},_setDirectionsLengthUnits:function(a){this._clearDisplayBeforeSolve();var b=new J;return A.remove(this._useMilesNode,this._css.stopsPressedButtonClass),A.remove(this._useKilometersNode,this._css.stopsPressedButtonClass),a===O.KILOMETERS?
A.add(this._useKilometersNode,this._css.stopsPressedButtonClass):a===O.MILES&&A.add(this._useMilesNode,this._css.stopsPressedButtonClass),a===O.KILOMETERS||a===O.METERS||a===O.MILES||a===O.FEET||a===O.NAUTICAL_MILES?(this.directionsLengthUnits=a,b.resolve(a)):b.reject(a),b.promise},_setDirectionsLanguage:function(a){this._clearDisplayBeforeSolve();var b=new J;return a=this._setDirectionsLanguageByLocale(a),this._solveAndZoom().always(function(){b.resolve(a)},b.reject),b.promise},_showLoadingSpinner:function(a){void 0===
a&&(a=this._requestQueueTail&&!this._requestQueueTail.isFulfilled()||this._moveInProgress);a?(A.add(this._widgetContainer,this._css.resultsLoadingClass),A.add(this._resultsNode,"esriRoutesContainerBusy")):(A.remove(this._widgetContainer,this._css.resultsLoadingClass),A.remove(this._resultsNode,"esriRoutesContainerBusy"))},_enqueue:function(b,c){var d=new J;return this._requestQueueTail||(this._requestQueueTail=new J,this._requestQueueTail.resolve()),this._requestQueueTail.promise.always(a.hitch(this,
function(){try{a.mixin(this,{_incrementalSolveStopRange:null},c);var e=b.call(this);e&&"object"==typeof e&&e.hasOwnProperty("isFulfilled")?e.then(a.hitch(this,function(a){d.resolve(a);this._showLoadingSpinner()}),a.hitch(this,function(a){d.reject(a);this._showLoadingSpinner()})):(d.resolve(e),this._showLoadingSpinner())}catch(f){d.reject(f),this._showLoadingSpinner()}})),this._requestQueueTail=d,this._showLoadingSpinner(),d.promise},_createDnD:function(){this._dnd=new I(this._dndNode,{skipForm:!0,
withHandles:!0})},_destroyDnD:function(){G.empty(this._dndNode);this._dnd&&(this._dnd.destroy(),this._dnd=null)},_createDepartAtControls:function(){if(this._departAtTime)this.map&&(this.map.timeExtent=null),this._useTrafficItemNode.title=E.widgets.directions.trafficLabelLive,A.remove(this._departAtContainer,"departAtContainerVisible"),this.startTime="now",this._updateStartTimeUI();else{var a=this,b=function(){this._keepDirections||a._clearDisplayBeforeSolve();this._keepDirections=!1};this._departAtTime=
new n({required:!0,value:new Date,onChange:b},this._departAtTimeContainer);this._departAtDate=new c({required:!0,value:new Date,onChange:b,constraints:{min:new Date(864E5)}},this._departAtDateContainer)}},_setStartTime:function(a,b,c){if(isNaN(c))this.startTime="now";else{b=c instanceof Date?c:new Date(c);c=this.directions&&this.directions.features&&this.directions.features[0]&&this.directions.features[0].attributes;var d=6E4*-b.getTimezoneOffset();b=new Date(b-d+(c&&c.arriveTimeUTC?c.ETA-c.arriveTimeUTC:
d));this._departAtTime._keepDirections=!a;this._departAtDate._keepDirections=!a;this._departAtTime.setValue(b);this._departAtDate.setValue(b)}this._updateStartTimeUI()},_checkStartTimeUIAvailability:function(){var a=this._getImpedanceAttribute(),a=this._isTimeUnits(a?a.units:"");this._startTimeButtonNode.disabled=!a;A[a?"remove":"add"].apply(this,[this._startTimeButtonNode,"startTimeMenuButtonDisabled"]);a||this.set("startTime","now")},_usingAGOL:function(a){return a||(a=this.routeTaskUrl),-1<a.search(/^(https?:)*\/\/*[^.]*\.arcgis\.com.*$/i)},
_usingRouteAGOL:function(){return-1<this.get("routeTaskUrl").search(/^(https?:)*\/\/route*[^.]*\.arcgis\.com.*$/i)},_setSearchOptions:function(){var b={map:this.get("map"),autoNavigate:!1,enableInfoWindow:!1,enableHighlight:!1,enableSourcesMenu:!1};this.searchOptions=a.mixin({maxResults:1,locationToAddressDistance:100},this.defaults.searchOptions,b)},_setDefaultUnits:function(){if(!this.get("directionsLengthUnits")){var a="EN-US"===d.locale.toUpperCase()?O.MILES:O.KILOMETERS;this.defaults.directionsLengthUnits?
a=this.defaults.directionsLengthUnits:this.userOptions.routeParams&&this.userOptions.routeParams.directionsLengthUnits&&(a=this.userOptions.routeParams.directionsLengthUnits);this.set("directionsLengthUnits",a)}this._setDirectionsLengthUnits(this.directionsLengthUnits)},_setTrafficOptions:function(){this._usingRouteAGOL()&&!this.trafficLayer&&(this.trafficLayer=new U(La+"//traffic.arcgis.com/arcgis/rest/services/World/Traffic/MapServer",{opacity:.4}));this.trafficLayer&&this.trafficLayer.url&&this._usingAGOL(this.trafficLayer.url)&&
(this._trafficAvailabilityButton.style.display="inline-block");this.set("showTrafficOption",(this.defaults.showTrafficOption||!this.defaults.hasOwnProperty("showTrafficOption"))&&this.trafficLayer);this._optionsMenu()},_updateCanModifyStops:function(a,b){this.canModifyStops||this.canModifyWaypoints||this.set("mapClickActive",!1);b||!this.canModifyStops||this.canModifyWaypoints||this.set("mapClickActive",!0);this._showAddDestination();this._showMapClickActiveButton();this._stopsTableCover.style.display=
this.canModifyStops?"none":"inline"},_updateCanAddWaypoints:function(a,b){this.canModifyStops||this.canModifyWaypoints||this.set("mapClickActive",!1);b||this.canModifyStops||!this.canModifyWaypoints||this.set("mapClickActive",!0);this._showMapClickActiveButton();this._handle._remove()},_updateStartTimeUI:function(){isNaN(this.startTime)?(this._startTimeButtonNode.innerHTML=this._i18n.widgets.directions.leaveNow,A.remove(this._startTimeButtonNodeContainer,"departAtButton"),A.remove(this._departAtContainer,
"departAtContainerVisible")):(A.add(this._startTimeButtonNodeContainer,"departAtButton"),A.add(this._departAtContainer,"departAtContainerVisible"),this._startTimeButtonNode.innerHTML=this._i18n.widgets.directions.departAt)},_setWidgetProperties:function(){this._disconnectEvents();this.set(this.defaults);this.routeLayer=a.clone(this.defaults.routeLayer);this._folderSelector&&(this._outputLayer.setValue(""),this._outputLayer.set("disabled",!0),this._folderSelector.set("disabled",!0));this.set("stops",
[]);this._updateCanModifyStops()},_updateStops:function(b){var c=new J;return b?this.get("loaded")?this._reset().then(a.hitch(this,function(){this._addStops(b).then(c.resolve,c.reject)}),c.reject):this._addStops(b).then(c.resolve,c.reject):c.reject(),c.promise},_removeStop:function(b,c,d,e){var f=new J,g=a.hitch(this,function(a){this.stops.splice(a,1);var b=this._dnd.getAllNodes()[a],c=this.get("geocoders");c[a].destroy();c.splice(a,1);this.set("geocoders",c);this._geocoderEvents[b.id]&&(this._geocoderEvents[b.id].blur.remove(),
this._geocoderEvents[b.id].select.remove(),this._geocoderEvents[b.id].suggest.remove(),this._geocoderEvents[b.id].value.unwatch());G.destroy(b);this._dnd.sync();this._stopsRemovable();this._optionsMenu();this._checkMaxStops();this.setListIcons();this._sortGeocoders()});(0>b||b>=this.stops.length||void 0===b)&&(b=this.stops.length-1);var k=!1;for(e=this.stopGraphics[b]&&this._isStopAWaypoint(this.stops[b])||e;!k;)g(b),e?k=!0:(b-=0>=b||b<this.stops.length&&this._isStopAWaypoint(this.stops[b])?0:1,k=
!this._isStopAWaypoint(this.stops[b]));for(;this.stops.length-this._getWaypointCount()<this.minStops;)this._addStop();return this._setStops(),this.createRouteSymbols(),d?(this._clearDisplayBeforeSolve(),this._clearDisplayAfterSolve(),this.createRouteSymbols(),f.resolve()):this._solveAndZoom(c).then(f.resolve,f.reject),f.promise},_removeTrafficLayer:function(){this.trafficLayer&&this.map&&this.map.removeLayer(this.trafficLayer);this._trafficLayerAdded=!1},_addStops:function(b,c){var d=new J,e=[],f=
this.autoSolve;this.autoSolve=!1;void 0===c&&(c=this._getStopCount());for(var g=0;g<Math.min(b.length,this.maxStops-this._getStopCount());g++){var k=new J;this._addStop(b[g],c+g,!0).always(k.resolve);e.push(k)}return K(e).always(a.hitch(this,function(){this.autoSolve=f;this._getDirections().always(function(){d.resolve(b)})})),d.promise},_addStop:function(b,c,d){var e=new J;return this._checkMaxStops(),this.maxStopsReached?(this._showMessage(E.widgets.directions.error.maximumStops),e.reject(Error(E.widgets.directions.error.maximumStops))):
(void 0===b&&void 0===c&&(c=this.stops.length),b instanceof Q&&b.attributes&&b.attributes.isWaypoint&&(!c||c===this.stops.length||2>this._getStopCount())&&!d?(this._showMessage(E.widgets.directions.error.waypointShouldBeInBetweenStops),e.reject(Error(E.widgets.directions.error.waypointShouldBeInBetweenStops))):this._getCandidate(b).then(a.hitch(this,function(a){this._insertStop(a,c);this.autoSolve&&""!==a.name?this._getDirections().always(function(){e.resolve(a,c)}):e.resolve(a,c)}),a.hitch(this,
function(a){e.reject(a)}))),e.promise},_removeEmptyStops:function(){for(var a=0,b=this.stops.length-this._getWaypointCount()-this.minStops;a<this.stops.length&&0<b;)this.stops[a]&&this.stops[a].name?a++:(this._removeStop(a,!0,!0,!0),b--,this._moveInProgress&&this._handle._index>=a&&this._handle._isStopIcon&&this._handle._index--)},_setReverseGeocode:function(b,c,d){if(b.feature.geometry&&-1<d){var e={address:b.name};this.stopGraphics[d]&&(a.mixin(this.stopGraphics[d].attributes,e),this.stopGraphics[d].setGeometry(c));
this.textGraphics[d]&&(a.mixin(this.textGraphics[d].attributes,e),this.textGraphics[d].setGeometry(c));this.set("stopGraphics",this.stopGraphics);this.set("textGraphics",this.textGraphics);e=this.geocoders[d];return e&&e.inputNode&&(e.value=b.name,e.inputNode.value=b.name),a.mixin(b.feature.attributes,this.stops[d].feature.attributes),this.stops[d]=b,this.stops[d].feature.setGeometry(c),this._setStops(),this._enqueue(function(){return this._getDirections()})}},_insertStop:function(a,b){var c,d;if(void 0===
b)for(c=0;c<this.geocoders.length;c++){if(!this.geocoders[c].get("value")){d=this.geocoders[c];break}}else c=b,this.geocoders[c]&&!this.geocoders[c].get("value")&&(d=this.geocoders[c]);!d||void 0!==b&&b!==c||this._isStopAWaypoint(a)?(void 0===b&&(b=this.geocoders.length),this.stops.splice(b,0,a),this._createGeocoder(a,b)):(this.stops[c]=a,d.set("value",a.name),d._stopReference=a);this._optionsMenu()},_createGeocoder:function(c,d){var e=this._dnd.getAllNodes(),f=!1,g=!1,k=e.length;e[d]?(g=e[d],f=!0):
(g=!1,f=!1);var h=a.hitch(this,function(a,b){var c=b?this._css.stopDnDHandleClass:this._css.stopDnDHandleClassHidden,d=b?this._css.stopDnDHandleClassHidden:this._css.stopDnDHandleClass;A.replace(a.children[0],c,d);2<this.geocoders.length&&(c=b?this._css.stopIconRemoveClass:this._css.stopIconRemoveClassHidden,d=b?this._css.stopIconRemoveClassHidden:this._css.stopIconRemoveClass,A.replace(a.children[3].children[0],c,d))}),m=G.create("tr",{className:this._css.stopClass,style:this._isStopAWaypoint(c)?
"display:none;":"",onmouseover:function(){h(this,!0)},onmouseout:function(){h(this,!1)}});G.create("td",{className:this._css.stopDnDHandleClassHidden+" dojoDndHandle"},m);e=G.create("td",{className:this._css.stopIconColumnClass},m);G.create("div",{className:this._css.stopIconClass+" dojoDndHandle",innerHTML:this._getLetter(k),"data-center-at":"true"},e);k=G.create("td",{className:this._css.esriStopGeocoderColumnClass},m);k=G.create("div",{},k);e=G.create("td",{className:this._css.stopIconRemoveColumnClass},
m);G.create("div",{className:this._css.stopIconRemoveClassHidden,role:"button","data-remove":"true"},e);this._dnd.insertNodes(!1,[m],f,g);var f=a.mixin({},this.get("searchOptions"),{value:c.name,activeSourceIndex:this._globalGeocoder.activeSourceIndex}),l=new H(f,k),n=a.hitch(this,function(a,c){this._enqueue(function(){if(c!==a&&l._stopReference&&l._stopReference.name!==c){var d=b.indexOf(this.stops,l._stopReference);this.stops[d]={name:c};this._handle._remove();this._removeSomeWaypoints(this._markWPsForRemovalAfterUserChangedStopSequence(d));
this._setStops();this._clearDisplayBeforeSolve();this._clearDisplayAfterSolve();this.createRouteSymbols()}})});l._tr=m;l._stopReference=c;l.startup();this.geocoders.splice(d,0,l);this._geocoderEvents[m.id]={blur:l.on("blur",function(){""!==this.value&&this._stopReference&&!this._stopReference.feature&&this.search()}),select:l.on("select-result",a.hitch(this,function(a){var c=!0;if(a&&(a.results||a.result)){var d=this._dnd.getAllNodes(),d=b.indexOf(d,m),e=l.value,f=a.results&&a.results.results&&a.results.results.length?
a.results.results[0]:a.result;f?(f.name=e,this.stops[d]=this._toPointGeometry(f),this.geocoders[d]._stopReference=this.stops[d],n("",e)):(this.removeStop(d),this.set("directions",null),this._showMessage(E.widgets.directions.error.unknownStop.replace("\x3cname\x3e",a.target.get("value"))),this._clearRouteGraphics(),c=!1);c&&this.getDirections()}})),suggest:l.on("suggest-results",function(){if(document.activeElement===this.inputNode)for(var a=C("LI[role\x3d'menuitem']",this.suggestionsNode),b=0;b<a.length;b++)B.set(a[b],
"tabindex",-1);else this._hideSuggestionsMenu()}),value:l.watch("value",function(a,b,c){n(b,c)})};this._checkMaxStops();this.setListIcons();this._stopsRemovable();this._optionsMenu();this._sortGeocoders()},_blurGeocoders:function(){if(document.activeElement)for(var a=0;a<this.geocoders.length;a++)if(this.geocoders[a].inputNode===document.activeElement){this.geocoders[a]._hideSuggestionsMenu();this.geocoders[a].inputNode.blur();1<this._getStopCount()+this._getWaypointCount()&&this.getDirections(!0);
break}},_decorateEmptyAGOLGeocoderResponse:function(a){return a&&", , "===a.name&&(a.feature&&a.feature.attributes&&a.feature.attributes.Match_addr?a.name=a.feature.attributes.Match_addr+("POI"===a.feature.attributes.Addr_type&&a.feature.attributes.City&&-1===a.feature.attributes.Match_addr.indexOf(a.feature.attributes.City)?", "+a.feature.attributes.City:""):a.name=""),a},_toPointGeometry:function(a){var b=a.feature.geometry;b&&(b.getCentroid?a.feature.geometry=b.getCentroid():b.getExtent&&(b=b.getExtent())&&
(a.feature.geometry=b.getCenter()));return a},_removeLocateButtonVisibilityEvents:function(){for(var a=0;a<this.geocoders.length;a++){var b=this.geocoders[a];b._onMouseEnter&&b._onMouseEnter.remove();b._onMouseOut&&b._onMouseOut.remove();b._onKeyPress&&b._onKeyPress.remove();b._locateButton&&(b._locateButton._onMouseEnter&&b._locateButton._onMouseEnter.remove(),b._locateButton._onMouseOut&&b._locateButton._onMouseOut.remove())}},_setLocateButtonVisibilityEvents:function(){this._removeLocateButtonVisibilityEvents();
for(var b=this,c=function(a){a instanceof FocusEvent?this._geocoder._lbShown_f=!0:this._geocoder._lbShown_g=!0;b._createLocateButton(this._geocoder,!0)},d=function(c){c instanceof FocusEvent?this._geocoder._lbShown_f=!1:this._geocoder._lbShown_g=!1;clearTimeout(this._destroyTimeout);this._destroyTimeout=setTimeout(a.hitch(this,function(){this._geocoder._lbShown_lb||this._geocoder._lbShown_f||b._destroyLocateButton(this._locateButton)}),400)},e=function(){this._geocoder._lbShown_g=!0;clearTimeout(this._destroyTimeout);
this._destroyTimeout=setTimeout(a.hitch(this,function(){""===this.value?b._createLocateButton(this._geocoder,!0):b._destroyLocateButton(this._locateButton)}),400)},f=function(){this._geocoder._lbShown_lb=!0;clearTimeout(this._geocoder._destroyTimeout)},g=function(){this._geocoder._lbShown_lb=!1;clearTimeout(this._geocoder._destroyTimeout);this._geocoder._destroyTimeout=setTimeout(a.hitch(this,function(){this._geocoder._lbShown_g||this._geocoder._lbShown_f||b._destroyLocateButton(this._geocoder.inputNode._locateButton)}),
400)},k=0;k<this.geocoders.length;k++){var h=this.geocoders[k];h&&h.inputNode&&(h.inputNode._geocoder=h,h._onMouseEnter=t(h.inputNode,w.enter,c),h._onMouseOut=t(h.inputNode,[w.leave,"blur"],d),h._onKeyPress=t(h.inputNode,"keydown",e),h.inputNode._locateButton)&&(h=h.inputNode._locateButton,h._onMouseEnter=t(h.domNode,w.enter,f),h._onMouseOut=t(h.domNode,w.leave,g))}},_createLocateButton:function(c,d,e){var f=new J;return c.inputNode._locateButton&&c.inputNode._locateButton._locating?f.resolve():h(["./LocateButton"],
a.hitch(this,function(g){if(this._destroyLocateButton(c.inputNode._locateButton),c&&!this._solveInProgress){var h=G.create("div",{},c.domNode);A.add(c.domNode,this._css.stopsInnerGeocoderClass);var m=new g({map:this.map,highlightLocation:!1,centerAt:!1,setScale:!1,useTracking:!1},h);m.startup();c.inputNode._locateButton=m;m.domNode._geocoder=c;this._setLocateButtonVisibilityEvents();g=a.hitch(this,function(){m._locating=!0;c.set("value","");c.inputNode.placeholder=E.widgets.directions.retrievingMyLocation.toUpperCase()});
m._onBeforeLocate=t(m._locateNode,k,g);m._onLocate=t(m,"locate",a.hitch(this,function(e){m._locating=!1;e.graphic?(d&&this._destroyLocateButton(c.inputNode._locateButton),this.updateStop(new Q(e.graphic.geometry),b.indexOf(this.geocoders,c)).then(a.hitch(this,function(){1<this.stopGraphics.length?this.getDirections().always(function(){f.resolve(e)}):f.resolve(e)}))):(c.set("value",""),c.inputNode.placeholder=E.widgets.directions.myLocationError.toUpperCase(),console.error(e.error),f.reject(e.error))}));
e?(g(),m.locate().then(null,f.reject)):f.resolve()}else f.resolve()})),f.promise},_destroyLocateButton:function(b){if(b){var c=b.domNode._geocoder;clearTimeout(c._destroyTimeout);b._locating?c._destroyTimeout=setTimeout(a.hitch(this,function(){c._lbShown_lb||c._lbShown_f||this._destroyLocateButton(b)}),100):(b.clear(),b._onBeforeLocate.remove(),b._onLocate.remove(),b._onMouseEnter&&b._onMouseEnter.remove(),b._onMouseOut&&b._onMouseOut.remove(),b.destroy(),c.inputNode&&(c.inputNode._locateButton=null,
c._setPlaceholder(c.activeSourceIndex)))}},_sortStops:function(){this.stops.length&&(this.stops.sort(a.hitch(this,function(a,b){for(var c,d,e=0;e<this.get("geocoders").length;e++)this.geocoders[e]._stopReference===a?c=e:this.geocoders[e]._stopReference===b&&(d=e);return c>d?1:d>c?-1:0})),this._setStops())},_getCandidate:function(b){var c=new J,d=typeof b;b?"object"===d&&b.hasOwnProperty("feature")&&b.hasOwnProperty("name")?(b.feature.attributes&&void 0!==b.feature.attributes.displayName&&!this._isStopAWaypoint(b)&&
(b.name=b.feature.attributes.displayName,b.feature.attributes.Name=this._userDefinedStopName),b.name=this._isStopAWaypoint(b)?this._waypointName:String(b.name),"point"!==b.feature.geometry.type&&(b.feature.geometry=new pa([b.feature.geometry.x,b.feature.geometry.y],this.map.spatialReference)),c.resolve(b)):"object"===d&&b.hasOwnProperty("address")&&b.hasOwnProperty("location")?(b=this._globalGeocoder._hydrateResult(b),c.resolve(b)):"object"!==d||!b.hasOwnProperty("name")||null!==b.name&&""!==b.name?
b instanceof Q&&b.attributes&&(void 0!==b.attributes.Name||b.attributes.isWaypoint)?(d=this._addStopWrapperToGraphic(b,b.attributes.isWaypoint?this._waypointName:String(b.attributes.Name)),String(b.attributes.Name)&&(d.feature.attributes.Name=this._userDefinedStopName),c.resolve(d)):("object"===d&&b.hasOwnProperty("name")&&(b=String(b.name)),this._reverseGeocode(b).then(c.resolve,c.reject)):c.resolve(a.clone(this._emptyStop)):c.resolve(a.clone(this._emptyStop));return c.promise},_reverseGeocode:function(b){var c,
d=new J,e=b.geometry?b.geometry:b;if(this._globalGeocoder){var f=a.hitch(this,function(a){var b=new J,c=500;if(this.map){var d=this.map.toScreen(e);(d.x+=oa._calculateClickTolerance([a]),this.map.spatialReference.isWebMercator())?(c=Math.abs(this.map.toMap(d).x-e.x),b.resolve(c)):4326===this.map.spatialReference.wkid?(c=Math.abs(fa.geographicToWebMercator(this.map.toMap(d)).x-fa.geographicToWebMercator(e).x),b.resolve(c)):this._geometryService&&(a=new Ha,a.distanceUnit=wa.UNIT_METER,a.geometry1=e,
a.geometry2=this.map.toMap(d),this._geometryService.distance(a,function(a){c=a;b.resolve(c)},function(){b.resolve(c)}))}return b.promise}),g=[],k=this._globalGeocoder.sources,h=function(){k[c].featureLayer&&g.push(f(k[c].featureLayer).then(a.hitch(k[c],function(b){this.searchQueryParams=a.mixin(this.searchQueryParams,{distance:b})})))};if("all"===this._globalGeocoder.activeSourceIndex)for(c=0;c<k.length;c++)h();else c=this._globalGeocoder.activeSourceIndex,h();K(g).always(a.hitch(this,function(){this._globalGeocoder.search(e).then(a.hitch(this,
function(a){var f=!1;if(a){var g,k=null;for(c=0;c<this._globalGeocoder.sources.length;c++)if(a[c]&&a[c].length){g=a[c];break}if(g.length&&(f=!0,k=g[0],this._globalGeocoder.sources[c].featureLayer))for(a=Number.POSITIVE_INFINITY,c=0;c<g.length;c++){g[c]=this._toPointGeometry(g[c]);var h=ea.geodesicLengths([new ta({paths:[[fa.xyToLngLat(e.x,e.y),fa.xyToLngLat(g[c].feature.geometry.x,g[c].feature.geometry.y)]],spatialReference:{wkid:this.map.spatialReference.wkid}})],"esriMeters")[0];a>h&&(a=h,k=g[c])}(k=
this._decorateEmptyAGOLGeocoderResponse(k))&&""!==k.name&&null!==k.name&&void 0!==k.name?(k.name=String(k.name),isNaN(e.x)||isNaN(e.y)||this.map.spatialReference.wkid!==e.spatialReference.wkid?!k.feature.geometry||isNaN(k.feature.geometry.x)||isNaN(k.feature.geometry.y)?(this._showMessage(E.widgets.directions.error.locator),d.reject(Error(E.widgets.directions.error.locator))):d.resolve(k):(k.feature.geometry=e,d.resolve(k))):f=!1}f||(b instanceof pa?b=new Q(b):b instanceof Array&&(b=new Q(new pa(b[0],
b[1]))),b instanceof Q?this._decorateUngeocodedStop(b).then(d.resolve,d.reject):(this._showMessage(E.widgets.directions.error.unknownStop.replace("\x3cname\x3e",b.toString())),d.reject(Error(E.widgets.directions.error.unknownStop.replace("\x3cname\x3e",b.toString())))))}))}))}else this._showMessage(E.widgets.directions.error.locatorUndefined),d.reject(Error(E.widgets.directions.error.locatorUndefined));return d.promise},_updateStop:function(b,c,d){var e=new J;return this.stops&&this.stops[c]?b instanceof
Q&&b.attributes&&b.attributes.isWaypoint&&(!c||c===this.stops.length-1||2>this._getStopCount())?(this._showMessage(E.widgets.directions.error.waypointShouldBeInBetweenStops),e.reject(Error(E.widgets.directions.error.waypointShouldBeInBetweenStops))):this._getCandidate(b).then(a.hitch(this,function(a){var b=a.feature,b=b?b.geometry:null,f=this.stops[c].feature,f=f?f.geometry:null,b=b&&f&&(b.x!==f.x||b.y!==f.y)||!b&&f;this.stops[c]=a;this.geocoders[c]||this._createGeocoder(a,c);f=this.geocoders[c];
f._stopReference=a;f._tr.style.display=this._isStopAWaypoint(a)?"none":"";f.value=a.name;f.inputNode&&(f.inputNode.value=a.name);b&&this.autoSolve&&1<this._getStopCount()+this._getWaypointCount()||d?this._getDirections().then(e.resolve,e.reject):(this._setStops(),e.resolve(a))}),a.hitch(this,function(a){e.reject(a)})):(this._showMessage(E.widgets.directions.error.couldNotUpdateStop),e.reject(Error(E.widgets.directions.error.couldNotUpdateStop))),this._optionsMenu(),e.promise},_renderDirections:function(){var c=
this.get("directions"),d;this._resultsNode&&(d=""+('\x3cdiv class\x3d"'+this._css.clearClass+'"\x3e\x3c/div\x3e'),d+=this._renderDirectionsSummary(c),d+='\x3cdiv class\x3d"'+this._css.clearClass+'"\x3e\x3c/div\x3e',d+='\x3cdiv class\x3d"'+this._css.routesClass+'"\x3e',d+=this._renderDirectionsTable(c),d+="\x3cdiv class\x3d'esriPrintFooter'\x3e"+E.widgets.directions.printDisclaimer+"\x3c/div\x3e",this._resultsNode&&(this._resultsNode.innerHTML=d+"\x3c/div\x3e"),this._disconnectResults(),(c=C("[data-segment]",
this._resultsNode))&&c.length&&b.forEach(c,a.hitch(this,function(b){this._resultEvents.push(t(b,w.enter,a.hitch(this,function(){if(!this._focusedDirectionsItem){var a=parseInt(B.get(b,"data-segment"),10);this.highlightSegment(a)}})));this._resultEvents.push(t(b,"focusout",a.hitch(this,function(){this._focusedDirectionsItem=null;this.unhighlightSegment(!0)})));this._resultEvents.push(t(b,w.leave,this.unhighlightSegment));this._resultEvents.push(t(b,"click, keydown",a.hitch(this,function(a){a&&("click"===
a.type||"keydown"===a.type&&a.keyCode===u.ENTER)&&(this._focusedDirectionsItem!==b?this.selectSegment(parseInt(B.get(b,"data-segment"),10)):(b.blur(),this.map.infoWindow.hide(),this._focusedDirectionsItem=null,this.unhighlightSegment(!0)))})))})))},_renderDirectionsSummary:function(a){var b="";if(a.totalLength||a.totalTime){var c={},d=this._getImpedanceAttribute();if(b+="\x3cdiv class\x3d'"+this._css.resultsSummaryClass+"' data-full-route\x3d'true'\x3e\x3cdiv class\x3d'esriImpedanceCost'\x3e",this._isTimeUnits(d.units)){for(var e=
this._getCostAttribute(d.timeNeutralAttributeName)||{},f=0,g=0,k=this.get("stops"),h=k.length-1;0<=h;h--)if(null!==k[h].feature.attributes.ArriveCurbApproach){c=k[h].feature.attributes;break}for(var m in c)c.hasOwnProperty(m)&&(m==="Cumul_"+d.name&&(f=c[m]),m==="Cumul_"+e.name&&(g=c[m]));c="esriTrafficLabelHidden";k=E.widgets.directions.noTraffic;h=a.totalTime-a.totalDriveTime;h=(g-this._convertCostValue(h,d.units,e.units))/(f-h||1);0<h&&.8>h?(c="esriTrafficLabelHeavy",k=E.widgets.directions.heavyTraffic):
1===h?(c="esriTrafficLabelNone",k=E.widgets.directions.noTraffic):1.25<h&&(c="esriTrafficLabelLight",k=E.widgets.directions.ligthTraffic);e=this._formatTime(g,!1,e.units);b+=this._formatTime(f,!0,d.units)+"\x3cdiv class\x3d'esriImpedanceCostHrMin'\x3e\x3cdiv class\x3d'esriImpedanceCostHr'\x3e"+E.widgets.directions.time.hr+"\x3c/div\x3e\x3cdiv class\x3d'esriImpedanceCostMin'\x3e"+E.widgets.directions.time.min+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'esriOtherCosts'\x3e"+(g?"\x3cdiv class\x3d'esriTrafficLabel "+
c+"'\x3e"+k+"\x3c/div\x3e"+(1!==h&&e?e+" "+E.widgets.directions.onAverage+"\x3cbr\x3e":""):"")+this._formatDistance(a.totalLength)}else d=(d=E.widgets.directions.units[this.directionsLengthUnits])?d.name:"",b+=D.format(a.totalLength,{places:1})+"\x3cdiv class\x3d'esriImpedanceCostDist'\x3e"+d+"\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'esriOtherCosts'\x3e"+this._formatTime(a.totalTime);b+="\x3c/div\x3e\x3c/div\x3e"}return b},_renderDirectionsTable:function(a){for(var b=0,c=0,d=0,e='\x3ctable summary\x3d"'+
a.routeName+'"\x3e\x3ctbody role\x3d"menu"\x3e',f=0;f<a.features.length;f++){var g=a.features[f].attributes;"esriDMTDepart"===g.maneuverType&&(d=0,c=0);d+=g.length;c+=g.time;b+=g.time;e+=this._renderDirectionsItemTR(a.features[f],d,c,b)}return e+"\x3c/tbody\x3e\x3c/table\x3e"},_renderDirectionsItemTR:function(a,c,d,e){var f=this.directions,g=f?b.indexOf(f.features,a):-1;e="";var k=this._css.routeClass,h=a._associatedStopWithReturnToStart&&a._associatedStopWithReturnToStart.attributes,m=a.attributes;
if(-1<g){m&&(m.step=g+1);m.maneuverType&&(k+=" "+m.maneuverType);h&&null===h.ArriveCurbApproach&&null!==h.DepartCurbApproach?k+=" "+this._css.routeOriginClass:h&&null!==h.ArriveCurbApproach&&null===h.DepartCurbApproach&&(k+=" "+this._css.routeDestinationClass+" "+this._css.routeLastClass);e+='\x3ctr tabindex\x3d"0" role\x3d"menuitem" class\x3d"'+k+" "+this._css.routeZoomClass+'" data-segment\x3d"'+g+'"\x3e';e+='\x3ctd class\x3d"'+this._css.routeIconColumnClass+'"\x3e';e+='\x3cdiv class\x3d"'+this._css.routeIconClass+
'"\x3e';e+=this._getLetter(a._associatedStop);e+="\x3c/div\x3e\x3c/td\x3e";e+='\x3ctd class\x3d"'+this._css.routeTextColumnClass+'"\x3e';e+='\x3cdiv class\x3d"'+this._css.routeInfoClass+'"\x3e';e+='\x3cdiv class\x3d"'+this._css.routeTextClass+'"\x3e';f=(f.strings[g]||[]).slice();if("esriDMTDepart"===m.maneuverType||"esriDMTStop"===m.maneuverType)for(a=0;a<this.stops.length;a++)this.stops[a]&&this.stops[a].name&&f.push({string:this.stops[a].name});if(f){k=m.text;for(a=0;a<f.length;a++)k=this._boldText(k,
f[a].string);m.formattedText=k}else m.formattedText=m.text;if("esriDMTStop"===m.maneuverType&&(c||d)||"esriDMTDepart"===m.maneuverType&&0===g)c=this._formatDistance(c-m.length,!0),d=this._formatTime(d-m.time),g=this._formatTime(m.time),a=this._formatDistance(m.length,!0),m.formattedText+="\x3cdiv class\x3d'esriRouteTextColumnCumulative'\x3e"+c+(c&&d?" \x26middot; ":"")+d+(c||d?"\x3cbr\x3e":"")+(g?E.widgets.directions.serviceTime+":\x26nbsp;"+g:"")+(g&&a?"\x3cbr\x3e":"")+(a?E.widgets.directions.serviceDistance+
":\x26nbsp;"+a:"")+"\x3c/div\x3e";e+="\x3cstrong\x3e"+D.format(m.step)+".\x3c/strong\x3e "+m.formattedText;e+="\x3c/div\x3e";c=this._formatDistance(m.length,!0);d=this._formatTime(m.time);"esriDMTStop"!==m.maneuverType&&"esriDMTDepart"!==m.maneuverType||!this.routeParams.startTime||-22091616E5===m.ETA?c&&(e+='\x3cdiv class\x3d"'+this._css.routeLengthClass+'"\x3e',e+=c,d&&(e+="\x26nbsp;\x26middot;\x3cwbr\x3e\x26nbsp;"+d),e+="\x3c/div\x3e"):e+='\x3cdiv class\x3d"'+this._css.routeLengthClass+'"\x3e'+
this._toSpatiallyLocalTimeString(m.arriveTimeUTC,m.ETA)+"\x3c/div\x3e";e+="\x3c/div\x3e";e+="\x3c/td\x3e";e+="\x3c/tr\x3e"}return e},_toSpatiallyLocalTimeString:function(a,b){var c=new Date(b),e=new Date(c.getTime()+6E4*c.getTimezoneOffset()),e=d.date.locale.format(e,{selector:"time"}),f="";a?(f=(b-a)/1E3/60/60,c=Math.floor(f),f=60*(f-c),c=E.widgets.directions.GMT+(0>c?"":"+")+D.format(c,{pattern:"00"})+D.format(f,{pattern:"00"}),f=e+" "+c):f="now"===this.startTime?d.date.locale.format(c,{selector:"time"}):
e;return f},_addStopWrapperToGraphic:function(a,b){return{extent:new Aa({xmin:a.geometry.x-.25,ymin:a.geometry.y-.25,xmax:a.geometry.x+.25,ymax:a.geometry.y+.25,spatialReference:a.geometry.spatialReference}),feature:a,name:b}},_clearBarriersGraphics:function(){this._barriersLayer.clear();this._polylineBarriersLayer.clear();this._polygonBarriersLayer.clear()},_showBarriers:function(){this._clearBarriersGraphics();var c=this.routeParams,d=c.polylineBarriers&&c.polylineBarriers.features||[],e=c.polygonBarriers&&
c.polygonBarriers.features||[];b.forEach(c.barriers&&c.barriers.features||[],a.hitch(this,function(a){this._barriersLayer.add(a)}));b.forEach(d,a.hitch(this,function(a){this._polylineBarriersLayer.add(a)}));b.forEach(e,a.hitch(this,function(a){this._polygonBarriersLayer.add(a)}))},_showRoute:function(a){this._clearDisplayAfterSolve();var b=a.routeResults[0].directions,c=new J;if(b){this.set("solveResult",a);this.set("directions",b);var d,e,f=a.routeResults[0].stops;if(f&&f.length){var g=[];for(d=
0;d<f.length;d++){var k=f[d];k.attributes.isWaypoint=k.attributes.Name===this._waypointName||k.attributes.isWaypoint;k=this._addStopWrapperToGraphic(k,k.attributes.Name);this.stops[d]&&this.stops[d].feature&&this.stops[d].feature.attributes&&this.stops[d].feature.attributes.Name===this._userDefinedStopName&&(k.feature.attributes.Name=this._userDefinedStopName);this._returnToStartStop&&this._returnToStartStop._resultsStopIndex===d?this._returnToStartStop=k:g.push(k)}if(this.stops.length>g.length)for(d=
0;d<this.stops.length;d++)this.stops[d].feature||""!==this.stops[d].name||g.splice(d,0,this._emptyStop);this.stops=g;for(d=0;d<this.stops.length;d++)this._updateStop(this.stops[d],d);this._setStops();this._setMenuNodeValues()}this.set("mergedRouteGraphic",new Q(b.mergedGeometry,this.get("routeSymbol")));f=[];g=[];for(d=k=0;d<b.featuresWithWaypoints.length;d++){var h=b.featuresWithWaypoints[d];if("esriDMTDepart"===h.attributes.maneuverType)for(e=0;e<this.stops.length;e++)if(this.stops[e].feature===
h._associatedStop){k=e+1;break}h.setSymbol(this.get("routeSymbol"));this._routeLayer.add(h);f.push(h);(e=h.getDojoShape())&&e.moveToBack();e=new Q(h.geometry,this._symbolEventPaddingDirections,h.attributes);if(e._nextStopIndex=k-.5,e._isSnapFeature=!0,h._associatedSnapFeature=e,this._waypointsEventLayer.add(e),"esriDMTDepart"!==h.attributes.maneuverType)if(e=h.geometry.getPoint(0,0))e=new Q(e,this.maneuverSymbol),e._directionsFeature=h._associatedFeatureNoWaypoints,g.push(e),this._waypointsEventLayer.add(g[g.length-
1])}this.set("displayedRouteGraphics",f);this.set("displayedManeuverPointGraphics",g);this._renderDirections();for(d=0;d<this.stops.length;d++)if(this._isStopAWaypoint(this.stops[d])&&this._modifiedWaypointIndex===d){for(e=0;e<b.featuresWithWaypoints.length;e++)if(f=b.featuresWithWaypoints[e],f._associatedStop===this.stops[d].feature){("esriDMTStop"===f.attributes.maneuverType||"esriDMTDepart"===f.attributes.maneuverType)&&(this.stops[d].feature.geometry.x=f.geometry.paths[0][0][0],this.stops[d].feature.geometry.y=
f.geometry.paths[0][0][1]);break}this._modifiedWaypointIndex=null;break}z.set(this._savePrintBtnContainer,"display","inline-block");this.onDirectionsFinish(a)}else a=a.routeResults[0].route,a.setSymbol(this.routeSymbol),this._routeLayer.add(a),this._incrementalRouteSegment=a;c.resolve();return this._moveLayersToFront(),this.createRouteSymbols(),c.promise},_setGeocodersStopReference:function(){if(this.geocoders)for(var a=0;a<this.geocoders.length;a++)this.geocoders[a]&&this.stops[a]&&(this.geocoders[a]._stopReference=
this.stops[a])},_setStops:function(){this._setGeocodersStopReference();this.createRouteSymbols();this._set("stops",this.stops);this.onStopsUpdate(this.stops)},_getCandidates:function(a){var b=[];if(a&&a.length){for(var c=0;c<a.length;c++)b.push(this._getCandidate(a[c]));return K(b)}a=new J;return a.resolve([]),a.promise},_clearResultsHTML:function(){this._resultsNode.innerHTML="";z.set(this._savePrintBtnContainer,"display","none")},_showSegmentPopup:function(a){if(a&&this.get("showSegmentPopup")&&
this.get("map").infoWindow){var b=a.geometry.getPoint(0,0);a=new Q(b,null,a.attributes,this.get("segmentInfoTemplate"));var c=this.get("map").infoWindow;c.setFeatures([a]);c.show(b)}},_addStopButton:function(){this.addStop().then(a.hitch(this,function(){this.get("focusOnNewStop")&&this.geocoders[this.stops.length-1].focus()}))},_sortGeocoders:function(){var c=this._dnd.getAllNodes();this.geocoders.sort(a.hitch(this,function(a,d){return a.domNode&&a.domNode.parentNode&&a.domNode.parentNode.parentNode&&
d.domNode&&d.domNode.parentNode&&d.domNode.parentNode.parentNode?b.indexOf(c,a.domNode.parentNode.parentNode)>b.indexOf(c,d.domNode.parentNode.parentNode)?1:-1:0}));this.stops.length===this.geocoders.length&&this._sortStops();for(var d=0;d<this.geocoders.length;d++)this.geocoders[d]&&this.geocoders[d].inputNode&&(this.geocoders[d].inputNode.title=E.widgets.directions.stopNoTitle+(d+1));this._setLocateButtonVisibilityEvents()},_disconnectResults:function(){if(this._resultEvents&&this._resultEvents.length)for(var a=
0;a<this._resultEvents.length;a++)this._resultEvents[a]&&this._resultEvents[a].remove();this._resultEvents=[]},_formatArbitraryCostsForRouteTooltip:function(a){var b="",c;for(c in a)if(0===c.indexOf("Total_")&&a.hasOwnProperty(c)){var d=this._getCostAttribute(c.substr(6));d&&(b+=this._isTimeUnits(d.units)?this._formatTime(a[c],!1,d.units):this._formatDistance(a[c],!0,d.units),b+=b?" \x26middot; ":"")}return b&&(b=E.widgets.directions.toNearbyStops+": \x3cb\x3e"+b.substr(0,b.length-10)+"\x3c/b\x3e"),
b},_formatTime:function(a,b,c){c||(c=(this._getDirectionsTimeAttribute()||{}).units);var d,e,f="";a=Math.round(this._convertCostValue(a,c,"esriNAUMinutes"));return d=Math.floor(a/60),e=Math.floor(a%60),b?f=D.format(d,{pattern:"00"})+":"+D.format(e,{pattern:"00"}):(d&&(f+=d+" "+E.widgets.directions.time.hr+" "),f+=d||e?e+" "+E.widgets.directions.time.min:""),f},_formatDistance:function(a,b,c){c||(c=this.directionsLengthUnits);var d=this.directionsLengthUnits,e=E.widgets.directions.units[d],f=d.replace("esri",
"").toLowerCase();a=this._convertCostValue(a,c,d);return e&&(f=b?e.abbr:e.name),a?D.format(a,{locale:"root",places:2})+" "+f:""},_editToolbar:function(){this.set("editToolbar",new Ka(this.get("map")))},_destroyGlobalGeocoder:function(){this._globalGeocoder&&(this._globalGeocoder.destroy(),this._globalGeocoder=null)},_createGlobalGeocoder:function(){var b=new J;return this._globalGeocoder=new H(this.get("searchOptions")),t.once(this._globalGeocoder,"load",a.hitch(this,function(){for(var a=0;a<this._globalGeocoder.sources.length;a++){var c=
this._globalGeocoder.sources[a].locator;if(c&&c.url&&(-1<c.url.toUpperCase().indexOf(this._globalGeocoder.defaultSource.locator.url.toUpperCase())||-1<c.url.toUpperCase().indexOf("//GEOCODEDEV.ARCGIS.COM/ARCGIS/REST/SERVICES/WORLD/GEOCODESERVER"))&&!this._globalGeocoder.sources[a].searchTemplate){this._globalGeocoder.sources[a].searchTemplate="${Address}, ${City}, ${Region}";break}}b.resolve()},function(a){b.reject(a)})),this._globalGeocoder.startup(),b.promise},_init:function(){var b=new J;return this.set("loaded",
!1),this._enableButton(this._getDirectionsButtonNode,!1),z.set(this._saveAsButton,"display","none"),this.clearMessages(),this.get("map").loaded?this._configure().always(b.resolve):t.once(this.get("map"),"load",a.hitch(this,function(){this._configure().always(b.resolve)})),b.promise},_setDefaultStops:function(){var b=new J;return this.defaults.stops&&this.defaults.stops.length?this._updateStops(this.defaults.stops).then(a.hitch(this,function(){this._removeEmptyStops();b.resolve()}),b.reject):b.resolve(),
b.promise},_configure:function(){var b=new J;return this._handle&&this._handle._remove(),this._createDnD(),this._createDepartAtControls(),this._setSearchOptions(),this._createGlobalGeocoder().then(a.hitch(this,function(){this._editToolbar();this._usingAGOL()||(this.geometryTaskUrl=null,this.printTaskUrl=null);this._createGeometryTask();this._createPrintTask();this._showActivateButton();this._createTravelModesDDL();this._createSearchSourceDDL();var c=[this._createRouteTask(),this._setDefaultStops()];
K(c).then(a.hitch(this,function(){this._setDefaultUnits();this._setTrafficOptions();this._setMenuNodeValues();this._setupEvents();var c=this.directionsLanguage||this.userOptions.routeParams&&this.userOptions.routeParams.directionsLanguage||d.locale.toLowerCase();this._setDirectionsLanguageByLocale(c);this._setupTravelModes().then(a.hitch(this,function(){this.set("loaded",!0);this.onLoad();b.resolve(!0)}),function(a){b.reject(a)})}),function(a){b.reject(a)})}),function(a){b.reject(a)}),this._naRouteSharing=
null,b.promise},_setDirectionsLanguageByLocale:function(a){var b=this.serviceDescription.directionsSupportedLanguages,c=function(a){if(b)for(var c=0;c<b.length;c++)if(b[c].toLowerCase().substr(0,2)===a)return b[c];return null},d=c(a);return d||(a=a.substr(0,2),d=c(a)),this.directionsLanguage=d,this.routeParams.directionsLanguage=d,d},_getStopSymbol:function(a,b){var c=a&&(a.feature&&a.feature.attributes||a.attributes),d=this.stopSymbol;return c&&(d=this._isStopAWaypoint(a)?this.waypointSymbol:void 0===
c.Status||0===c.Status||6===c.Status?null===c.ArriveCurbApproach&&null!==c.DepartCurbApproach?this.get(b?"fromSymbolDrag":"fromSymbol"):null!==c.ArriveCurbApproach&&null===c.DepartCurbApproach?this.get(b?"toSymbolDrag":"toSymbol"):this.get(b?"stopSymbolDrag":"stopSymbol"):this.get(b?"unreachedSymbolDrag":"unreachedSymbol")),d},_addTrafficLayer:function(){this.trafficLayer&&!this._trafficLayerAdded&&this.map&&(this.map.addLayer(this.trafficLayer),this.trafficLayer.show(),this._trafficLayerAdded=!0)},
_toggleUnits:function(a){a.target===this._useMilesNode?this.setDirectionsLengthUnits(O.MILES):a.target===this._useKilometersNode&&this.setDirectionsLengthUnits(O.KILOMETERS)},_toggleCheckbox:function(a){var b=B.get(a.target,"checked");a.target===this._findOptimalOrderNode?this.set("optimalRoute",b):a.target===this._useTrafficNode?this.set("traffic",b):a.target===this._returnToStartNode&&this.set("returnToStart",b)},_isStopLocated:function(a){return a&&a.feature&&a.feature.attributes&&(!a.feature.attributes.Status||
6===a.feature.attributes.Status)},_configureRouteOptions:function(){var a,c=this.get("routeParams");if(this.get("directionsLengthUnits")?c.directionsLengthUnits=this.get("directionsLengthUnits"):this.set("directionsLengthUnits",c.directionsLengthUnits),c.findBestSequence=this.get("optimalRoute"),c.findBestSequence)for(c.preserveFirstStop=this._isStopLocated(this.stops[0]),c.preserveLastStop=!this.returnToStart&&this._isStopLocated(this.stops[this.stops.length-1])||this.returnToStart&&this._isStopLocated(this.stops[0]),
a=0;a<this.stops.length;)this._isStopAWaypoint(this.stops[a])?this._removeStop(a,!0,!0):a++;if(!this.returnToStart&&this.stops.length&&this._isStopAWaypoint(this.stops[this.stops.length-1]))for(a=this.stops.length-1;0<a;)this._isStopAWaypoint(this.stops[a])&&this._removeStop(a,!0,!0),a--;if(this._isTimeUnits(this._getImpedanceAttribute().units))if(c.useTimeWindows=!0,"now"===this.startTime)c.timeWindowsAreUTC=!0,c.startTimeIsUTC=!0,c.startTime=new Date;else{c.timeWindowsAreUTC=!1;c.startTimeIsUTC=
!1;var d=this._departAtTime,e=6E4*d.getValue().getTimezoneOffset(),d=new Date(d.getValue().getTime()+this._departAtDate.getValue().getTime()-e),d=new Date(d.getTime()-6E4*d.getTimezoneOffset());c.startTime=d}else c.startTime=null,c.useTimeWindows=!1;var d=this._getImpedanceAttribute(),e=this._getCostAttribute(d.timeNeutralAttributeName),f=this.routeParams.accumulateAttributes||this.serviceDescription.accumulateAttributeNames;e&&-1===b.indexOf(f,e.name)&&f.push(e.name);this.routeParams.accumulateAttributes=
f;c.returnStops=!0;f=[];for(a=0;a<this.stopGraphics.length;a++)if(this.stopGraphics[a]&&(f.push(new Q(this.stopGraphics[a].toJson())),a)){var g=f[0].attributes,k=f[a].attributes,h;for(h in k)k.hasOwnProperty(h)&&!g.hasOwnProperty(h)&&(g[h]=null)}this.get("returnToStart")&&this.stopGraphics.length&&this._isStopLocated(this.stops[0])?(h=new Q(this.stopGraphics[0].toJson()),this._returnToStartStop=this._addStopWrapperToGraphic(h,h.attributes.Name),f.push(h)):this._returnToStartStop=null;if(c.stops.features=
f,e)for(a=0;a<f.length;a++)f[a].attributes["Attr_"+e.name]=this._convertCostValue(f[a].attributes["Attr_"+d.name],d.units,e.units);this.set("routeParams",c)},_configureRoute:function(){var b=new J;if(b.promise.always(a.hitch(this,function(){this._checkMaxStops()})),this.createRouteSymbols(),this._configureRouteOptions(),this.routeParams.returnRoutes&&this._incrementalSolveStopRange){var c=this._incrementalSolveStopRange;c.start<c.end?this.routeParams.stops.features=this.routeParams.stops.features.slice(c.start,
c.end+1):c.start>c.end&&(this.routeParams.stops.features=this.routeParams.stops.features.slice(c.start,this.routeParams.stops.features.length-1).concat(this.routeParams.stops.features.slice(0,c.end+1)))}else this._incrementalSolveStopRange=null;for(var d,e,f={},g=this.routeParams.stops.features,c=0;c<g.length;c++)e=g[c].attributes.address,d=(c===this._handle._index&&!this._handle.attributes.isWaypoint&&this._incrementalSolveStopRange?this._waypointName:e)+"_"+this._stopSequence++,g[c].attributes.Name=
d,f[d]=e,delete g[c].attributes.address,delete g[c].attributes.isWaypoint,delete g[c].attributes.Status;this._solveInProgress=!0;var k={_incrementalSolveStopRange:this._incrementalSolveStopRange};return this.routeTask.solve(this.routeParams,a.hitch(this,function(a){this._solveResultProcessing(a,f,k).then(b.resolve,b.reject)}),a.hitch(this,function(c){a.mixin(this,k);this._solveInProgress=!1;for(var d=0;d<this.stops.length;d++)this.stops[d].feature&&(this.stops[d].feature.attributes=a.mixin(this.stops[d].feature.attributes,
{Status:5}));this.set("directions",null);this._clearDisplayAfterSolve();this.createRouteSymbols();this._routeTaskError(c);b.reject(c)})),b.promise},_solveResultProcessing:function(b,c,d){var e=new J;a.mixin(this,d);this._solveInProgress=!1;var f;d=b.routeResults[0];var g=d.directions;d=d.stops;if(g){this._solverMessages=b.messages;var k=function(a){for(var b in c)if(a&&0===g.routeName.indexOf(b)||!a&&0<g.routeName.indexOf(b))return c[b];return""};f=k(!0);k=k(!1);g.routeName=(f!==this._waypointName?
f:E.widgets.directions.waypoint)+" \u2014 "+(k!==this._waypointName?k:E.widgets.directions.waypoint);for(f=0;f<g.features.length;f++)if(k=g.features[f].attributes,"esriDMTDepart"===k.maneuverType||"esriDMTStop"===k.maneuverType)for(var h in c)if(c.hasOwnProperty(h)&&-1<k.text.indexOf(h)){k.text=k.text.replace(h,c[h]);for(var m=0;m<d.length;m++)if(d[m].attributes.Name===h){a.mixin(g.features[f],{_associatedStop:d[this.returnToStart&&m===d.length-1?0:m],_associatedStopWithReturnToStart:d[m]});break}}for(f=
0;f<d.length;f++)this._returnToStartStop&&d[f].attributes.Name===this._returnToStartStop.feature.attributes.Name&&(this._returnToStartStop._resultsStopIndex=f),d[f].attributes.Name=c[d[f].attributes.Name];this._directionsPostprocessing(g);h=g.features[0].attributes;this._updateMapTimeExtent(h.arriveTimeUTC);this._useTrafficItemNode.title=E.widgets.directions.trafficLabelDepartAt+": "+this._toSpatiallyLocalTimeString(h.arriveTimeUTC,h.ETA)}return this._showRoute(b).always(a.hitch(this,function(){this._incrementalSolveStopRange=
null;e.resolve(b)})),this._showBarriers(),e.promise},_directionsPostprocessing:function(b){var c,d,e=function(a,c){var d=b.features[a]._associatedFeaturesWithWaypoints||[];d.push(b.featuresWithWaypoints[c]);b.features[a]._associatedFeaturesWithWaypoints=d;b.featuresWithWaypoints[c]._associatedFeatureNoWaypoints=b.features[a]};d=a.hitch(this,function(a){return"\x3cdiv class\x3d'"+this.theme+"'\x3e\x3ctable class\x3d'esriRoutesTooltip'\x3e"+this._renderDirectionsItemTR(a._associatedFeatureNoWaypoints)+
"\x3c/table\x3e\x3c/div\x3e"});b.featuresWithWaypoints=[];for(c=0;c<b.features.length;c++){var f=new Q(b.features[c].toJson());f.setInfoTemplate(new S({title:this._i18n.widgets.directions.maneuver,content:d}));b.featuresWithWaypoints.push(f);b.featuresWithWaypoints[c]._associatedStop=b.features[c]._associatedStop;b.featuresWithWaypoints[c]._associatedStopWithReturnToStart=b.features[c]._associatedStopWithReturnToStart}b.stringsWithWaypoints=a.mixin([],b.strings);b.eventsWithWaypoints=a.mixin([],b.events);
for(d=c=0;c<b.features.length;)b.features[c]._associatedStop&&b.features[c]._associatedStop.attributes.Name===this._waypointName?(b.features.splice(c,c?2:1),b.strings.splice(c,c?2:1),b.events.splice(c,c?2:1),c&&b.features[c]&&"esriDMTStraight"===b.features[c].attributes.maneuverType)?(f=b.features.splice(c,1)[0],b.strings[c-1]=(b.strings[c-1]||[]).concat(b.strings.splice(c,1)[0]||[]),b.strings[c-1].length||(b.strings[c-1]=void 0),b.events[c-1]=(b.events[c-1]||[]).concat(b.events.splice(c,1)[0]||[]),
b.events[c-1].length||(b.events[c-1]=void 0),b.features[c-1].attributes.length+=f.attributes.length,b.features[c-1].attributes.time+=f.attributes.time,b.features[c-1].geometry.paths[0]=b.features[c-1].geometry.paths[0].concat(f.geometry.paths[0]),e(c-1,d++),e(c-1,d++),e(c-1,d++)):(c&&e(c-1,d++),c<b.features.length&&e(c,d++)):(e(c,d++),c++)},_boldText:function(a,b){return a.replace(new RegExp("(^|\\s|\\W)("+b+")(\\W|\\s|$)","ig"),"$1\x3cstrong\x3e$2\x3c/strong\x3e$3")},_clearStopGraphics:function(){if(this.stopGraphics&&
this.stopGraphics.length)for(var a=0;a<this.stopGraphics.length;a++)this._stopLayer.remove(this.stopGraphics[a]),this._stopLayer.remove(this.textGraphics[a]);this.set("stopGraphics",[]);this.set("textGraphics",[])},_updateMapTimeExtent:function(a){this.map&&(a=new Date(a),this.map.setTimeExtent(new T(a,a)))},_clearRouteGraphics:function(){for(var a=this.displayedRouteGraphics,c=this.displayedManeuverPointGraphics,d=this._routeLayer,e=this._waypointsEventLayer,f=0,g=0,k=this._incrementalSolveStopRange?
this._incrementalSolveStopRange:{start:0,end:this.stops?this.stops.length:-1};a&&g<a.length;){if(a[g]._associatedStop)for(var h=0;h<this.stops.length;h++)if(this.stops[h].feature===a[g]._associatedStop){f=h;break}f>=k.start&&f<k.end||k.start>=k.end&&(f>=k.start||f<k.end)?(d.remove(a[g]),a.splice(g,1)):g++}d.remove(this._incrementalRouteSegment);this.set("displayedRouteGraphics",a?a:[]);c&&c.length&&b.forEach(c,function(a){e.remove(a)});this.set("displayedManeuverPointGraphics",[]);this._waypointsEventLayer.clear();
this.unhighlightSegment(!0)},_clearInfoWindow:function(){var a=this.get("map").infoWindow;a&&(a.hide(),a.clearFeatures())},_clearDisplayBeforeSolve:function(){this._toggleSaveMenu(!1);this._clearInfoWindow();this._clearResultsHTML()},_clearDisplayAfterSolve:function(){this._clearStopGraphics();this._clearRouteGraphics();this.clearMessages()},_getLetter:function(b){var c=this.alphabet,d="",e=function(a){var b="";return"0123456789"===c||"1234567890"===c?b=String(a+1):(a=a||0,a>=c.length&&(b=e(Math.floor(a/
c.length)-1),a%=c.length),b+=c[a]),b},f=b instanceof Q?a.hitch(this,function(){for(var a=this.get("returnToStart")?0:-1,c=0;c<this.stops.length;c++)if(this.stops[c].feature===b){a=c;break}return a})():b;if(-1<f&&c&&c.length){c instanceof Array&&(c=c.toString().replace(/,/g,""));for(var d=-1,g=0;f>=g;g++)d+=this._isStopAWaypoint(this.stops[g])?0:1;d=e(d)}return d},_solveAndZoom:function(b){if(this.autoSolve)return this._getDirections().then(a.hitch(this,function(){b||this.zoomToFullRoute()}));var c=
new J;return c.resolve(),c.promise},_setupEvents:function(){this._onEvents.push(t(this.domNode,"[data-blur-on-click]:click",function(){this.blur()}));this._onEvents.push(t(this._dndNode,"[data-reverse-stops]:click, [data-reverse-stops]:keydown",a.hitch(this,function(a){a&&("click"===a.type||"keydown"===a.type&&a.keyCode===u.ENTER)&&this.modifyStopSequence()})));this._onEvents.push(t(this._printButton,"click, keydown",a.hitch(this,function(a){a&&("click"===a.type||"keydown"===a.type&&a.keyCode===u.ENTER)&&
this._printDirections()})));this._onEvents.push(t(this._resultsNode,"[data-full-route]:click, [data-full-route]:keydown",a.hitch(this,function(a){a&&("click"===a.type||"keydown"===a.type&&a.keyCode===u.ENTER)&&this.zoomToFullRoute()})));this._onEvents.push(t(this._dndNode,"[data-remove]:click, [data-remove]:keydown",a.hitch(this,function(a){if(a&&("click"===a.type||"keydown"===a.type&&a.keyCode===u.ENTER)){var c=C("[data-remove]",this._dndNode);a=b.indexOf(c,a.target);this.removeStop(a)}})));this._onEvents.push(t(this._dndNode,
"[data-center-at]:click, [data-center-at]:keydown",a.hitch(this,function(a){if(a&&("click"===a.type||"keydown"===a.type&&a.keyCode===u.ENTER)){var c=C("[data-center-at]",this._dndNode);a=b.indexOf(c,a.target);this.stops[a]&&this.stops[a].feature&&this.stops[a].feature.geometry&&this.map.centerAndZoom(this.stops[a].feature.geometry)}})));this._onEvents.push(t(this.map,"zoom-end",a.hitch(this,function(){var a=this._segmentGraphics;a&&a[0]&&void 0!==a[0].attributes._index&&this.highlightSegment(a[0].attributes._index,
!0)})));this._onEvents.push(t(this._dnd,"Drop",a.hitch(this,function(){this._dnd.sync();this.set("optimalRoute",!1);var a,c,d=!1,e=[],f=this._dnd.getAllNodes();for(a=0;a<this.geocoders.length;a++)if(c=b.indexOf(f,this.geocoders[a]._tr),-1<c&&a!==c&&a!==c-1){for(;0<c&&this._isStopAWaypoint(this.stops[c]);)c--;d=!0;break}d&&(e=this._markWPsForRemovalAfterUserChangedStopSequence(a,c));this._sortGeocoders();this.setListIcons();this._removeSomeWaypoints(e);this.stops[c].name&&this.getDirections()})));
this._onEvents.push(t(this._dnd,"DndStart",a.hitch(this,function(){var a=C("body")[0];A.add(a,this._css.dndDragBodyClass);this._removeLocateButtonVisibilityEvents()})));this._onEvents.push(t(this._dnd,"DndDrop, DndCancel",a.hitch(this,function(){var a=C("body")[0];A.remove(a,this._css.dndDragBodyClass);this._setLocateButtonVisibilityEvents()})));var c=this._handle,d=a.hitch(this,function(d){var e=a.hitch(this,function(a,b,e,f,g){var k=c._isShown();if(c.setGeometry(a),c._tooltip.style.left=d.screenPoint.x+
"px",c._tooltip.style.top=d.screenPoint.y+"px",!k||c._index===e&&c.attributes.isWaypoint===f||(c._remove(),k=!1),c.setSymbol(b),c._index=e,c._isStopIcon=c._index===Math.floor(c._index),c.attributes.isWaypoint=f,c._isStopIcon&&(c.attributes.address=this.stopGraphics[e].attributes.address,c.setInfoTemplate(this.stopGraphics[e].infoTemplate)),this.canModifyWaypoints||c._isStopIcon)k||(this._stopLayer.add(c),(a=c.getDojoShape())&&a[f?"moveToBack":"moveToFront"].call(a)),this.editToolbar.activate(Ka.MOVE,
c);f=f?c._isStopIcon?E.widgets.directions.dragWaypoint:this.canModifyWaypoints?E.widgets.directions.dragRoute:"":E.widgets.directions.dragStop;c._showTooltip(g||f)});if(this.unhighlightSegment(),this.mapClickActive&&this.dragging&&!this._solveInProgress&&!this._moveInProgress&&!c._solveTimeout)if(clearTimeout(c._removeTimeout),(d.graphic._isStopIcon||d.graphic._isStopLabel)&&!d.graphic.attributes.isWaypoint&&this.canModifyStops||d.graphic._isStopIcon&&d.graphic.attributes.isWaypoint&&this.canModifyWaypoints){var f=
d.graphic._isStopLabel?this.stopGraphics[d.graphic._index]:d.graphic;e(f.geometry,this._getStopSymbol(this.stops[f._index],!0),f._index,!0===f.attributes.isWaypoint);this._stopLayer.remove(this.stopGraphics[f._index]);this._stopLayer.remove(this.textGraphics[f._index])}else(d.graphic._isSnapFeature||d.graphic._isHandle&&!d.graphic._isStopIcon)&&(this._snappingManager||(this._snappingManager=this.map.snappingManager),this._snappingManager.getSnappingPoint(d.screenPoint).then(a.hitch(this,function(a){if(!this.maxStopsReached&&
!this._moveInProgress&&a){for(var f=this.displayedManeuverPointGraphics,g=null,k=0;k<f.length;k++)if(f[k].geometry.x===a.x&&f[k].geometry.y===a.y){g=f[k]._directionsFeature;f=b.indexOf(this.directions.features,g);-1<f&&this.highlightSegment(f);break}e(a,d.graphic._isHandle?c.symbol:this.waypointSymbol,d.graphic._isHandle?c._index:d.graphic._nextStopIndex,d.graphic._isHandle?c.attributes.isWaypoint:!0,g)}})))}),e=a.hitch(this,function(){clearTimeout(c._removeTimeout);c._removeTimeout=setTimeout(c._remove,
100);this.unhighlightSegment()});this._onEvents.push(this._waypointsEventLayer.on("mouse-move",d));this._onEvents.push(this._waypointsEventLayer.on("mouse-out",e));this._onEvents.push(this._stopLayer.on("mouse-move",d));this._onEvents.push(this._stopLayer.on("mouse-out",e));this._editToolbarEvents();this._watchEvents.push(this.watch("theme",this._updateThemeWatch));this._watchEvents.push(this.watch("canModifyStops",this._updateCanModifyStops));this._watchEvents.push(this.watch("canModifyWaypoints",
this._updateCanAddWaypoints));this._watchEvents.push(this.watch("showReturnToStartOption",this._optionsMenu));this._watchEvents.push(this.watch("showOptimalRouteOption",this._optionsMenu));this._watchEvents.push(this.watch("returnToStart",this._setMenuNodeValues));this._watchEvents.push(this.watch("optimalRoute",this._setMenuNodeValues));this._watchEvents.push(this.watch("startTime",this._setStartTime));this._watchEvents.push(this.watch("traffic",this._setMenuNodeValues));this._watchEvents.push(this.watch("trafficLayer",
this._trafficLayerUpdate));this._watchEvents.push(this.watch("routeTaskUrl",a.hitch(this,function(){this._createRouteTask();this._setTrafficOptions()})));this._watchEvents.push(this.watch("printTaskUrl",a.hitch(this,function(){this._createPrintTask()})));this._watchEvents.push(this.watch("geometryTaskUrl",a.hitch(this,function(){this._createGeometryTask()})));this._watchEvents.push(this.watch("routeParams",a.hitch(this,function(){this._createRouteParams();this._setDefaultUnits()})));this._watchEvents.push(this.watch("searchOptions",
a.hitch(this,function(){this._setSearchOptions();this._createGlobalGeocoder();var a=this.get("searchOptions").sources;if(a)for(var b=0;b<this.geocoders.length;b++)this.geocoders[b].set("sources",a)})));this._watchEvents.push(this.watch("showReverseStopsButton",this.setListIcons));this._watchEvents.push(this.watch("editToolbar",this._editToolbarEvents));this._watchEvents.push(this.watch("showTravelModesOption",this._showTravelModesOption));this._watchEvents.push(this.watch("showMilesKilometersOption",
this._showMilesKilometersOption));this._watchEvents.push(this.watch("showClearButton",this._showClearButton));this._watchEvents.push(this.watch("directionsLengthUnits",this.setDirectionsLengthUnits));this._watchEvents.push(this.watch("directionsLanguage",this.setDirectionsLanguage));this._watchEvents.push(this.watch("mapClickActive",this._activate));this._watchEvents.push(this.watch("showActivateButton",this._showActivateButton));this._watchEvents.push(this.watch("showPrintPage",function(){z.set(this._printButton,
"display",this.showPrintPage?"inline-block":"none")}));this._watchEvents.push(this.watch("showSaveButton",function(){z.set(this._saveMenuButton,"display",this.showSaveButton&&this.owningSystemUrl?"inline-block":"none")}))},_editToolbarEvents:function(){var b=a.hitch(this,function(a){var b="";if((a=a.routeResults?a.routeResults[0]:null)&&a.route){a=a.route.attributes;var c=this.routeParams.travelMode;if(c)var b=b+("\x3cb\x3e"+c.name+"\x3c/b\x3e "+E.widgets.directions.toNearbyStops+": "),d=void 0!==
a["Total_"+c.timeAttributeName]?this._formatTime(a["Total_"+c.timeAttributeName],!1,this._getCostAttribute(c.timeAttributeName).units):"",b=b+((void 0!==a["Total_"+c.distanceAttributeName]?this._formatDistance(a["Total_"+c.distanceAttributeName],!0,this._getCostAttribute(c.distanceAttributeName).units):"")+(d?" \x26middot; "+d:""));else b=this._formatArbitraryCostsForRouteTooltip(a)}this._handle._showTooltip(b)}),c=a.hitch(this,function(d,e){var f=new J,g=this._handle,k=this.map.toScreen(g._origPoint).offset(d.transform.dx+
g.symbol.xoffset,d.transform.dy+g.symbol.yoffset);if(d.origMapPoint||(d.origMapPoint=this.map.toMap(k)),z.set(g._tooltip,"left",k.x+"px"),z.set(g._tooltip,"top",k.y+"px"),clearTimeout(g._solveTimeout),this._solveInProgress||!this._requestQueueTail.isFulfilled())g._solveTimeout=setTimeout(function(){c(d,e).always(f.resolve)},100);else if(g._isStopIcon){var k=d.graphic._index,h=this.stops[k];(h=h?{name:h.name,extent:h.extent,feature:new Q(h.feature.toJson())}:null)?(h.feature.setGeometry(d.origMapPoint),
this._modifiedWaypointIndex=this._isStopAWaypoint(this.stops[k])?k:null,this._incrementalSolveStopRange={start:this.returnToStart?(this.stops.length+k-1)%this.stops.length:Math.max(0,k-1),end:this.returnToStart?(k+1)%this.stops.length:Math.min(this.stops.length-1,k+1)},this.updateStop(h,k,e).always(a.hitch(this,function(a){g._solveTimeout=null;a.routeResults&&b(a);f.resolve()}))):f.resolve()}else f.resolve();return f.promise});this._onEvents.push(t(this.editToolbar,"graphic-click",a.hitch(this,function(b){if(b.graphic.attributes.isWaypoint)!b.graphic._isStopIcon||
this._moveInProgress||this._solveInProgress||(this._handle._remove(),this._moveInProgress=!0,this.removeStop(b.graphic._index,!0).always(a.hitch(this,function(){this._moveInProgress=!1})));else{var c=this.get("map").infoWindow;c&&(c.setFeatures([b.graphic]),c.show(b.graphic.geometry))}})));this._onEvents.push(t(this.editToolbar,"graphic-move-start",a.hitch(this,function(a){this._blurGeocoders();this._moveInProgress=!0;this._removeEmptyStops();this.routeParams.returnDirections=!1;this.routeParams.returnRoutes=
!0;a=a.graphic;a._origPoint=new pa(a.geometry.toJson());a._maxDeviation=0;a._solveHasHappened=!1;this.map.disableMapNavigation()})));this._onEvents.push(t(this.editToolbar,"graphic-move-stop",a.hitch(this,function(b){if(this.map.enableMapNavigation(),this.routeParams.returnDirections=!0,this.routeParams.returnRoutes=!1,this._handle._isStopIcon)if(this._handle._solveHasHappened)if(this._handle.attributes.isWaypoint)c(b,!0).always(a.hitch(this,function(){this._moveInProgress=!1;this._handle._isStopIcon=
!0;this._handle._remove();this._showLoadingSpinner()}));else{clearTimeout(this._handle._solveTimeout);this._handle._solveTimeout=null;var d=this.stops[b.graphic._index],e=(d&&d.feature&&d.feature.attributes.Name)===this._userDefinedStopName,f=d&&d.name;this._reverseGeocode(new Q(b.graphic.toJson())).then(a.hitch(this,function(c){e&&(c.name=f,c.feature.attributes.Name=this._userDefinedStopName);this._setReverseGeocode(c,c.feature.geometry,b.graphic._index).always(a.hitch(this,function(){this._moveInProgress=
!1;this._handle._remove();this._showLoadingSpinner()}))}))}else this._moveInProgress=!1;else this._moveInProgress=!1})));this._onEvents.push(t(this.editToolbar,"graphic-move",a.hitch(this,function(a){var b=this._handle,d=a.transform;if(d.dx&&d.dy&&(a.graphic._maxDeviation=Math.max(b._maxDeviation,Math.sqrt(d.dx*d.dx+d.dy*d.dy))),10<b._maxDeviation)(b._solveHasHappened=!0,a.graphic===b&&b.attributes.isWaypoint&&!b._isStopIcon)?(this.set("optimalRoute",!1),b._index+=.5,b._isStopIcon=!0,a.graphic._stopIndex=
b._index,this._incrementalSolveStopRange={start:this.returnToStart?(this.stops.length+b._index-1)%this.stops.length:Math.max(0,b._index-1),end:this.returnToStart?(b._index+1)%(this.stops.length+1):Math.min(this.stops.length,b._index+1)},this.addStop({name:this._waypointName,feature:new Q(b.geometry,b.symbol,{isWaypoint:!0,CurbApproach:3})},a.graphic._stopIndex)):((b=a.graphic.getDojoShape())&&b.moveToFront(),c(a))})))},_isStopAWaypoint:function(a){return a&&a.feature&&a.feature.attributes&&a.feature.attributes.isWaypoint},
_getStopCount:function(){var a,b=0;for(a=0;a<this.stops.length;a++)b+=!this._isStopAWaypoint(this.stops[a])&&this.stops[a].name?1:0;return b},_getWaypointCount:function(){var a,b=0;for(a=0;a<this.stops.length;a++)b+=this._isStopAWaypoint(this.stops[a])?1:0;return b},_decorateUngeocodedStop:function(b){var c=new J,d=function(a,d){c.resolve({name:void 0===a?E.widgets.directions.unlocatedStop:a.toFixed(6)+" "+d.toFixed(6),feature:b})};if(b.geometry)if(b.geometry.spatialReference&&4326!==b.geometry.spatialReference.wkid)if(this.map&&
this.map.spatialReference&&this.map.spatialReference.isWebMercator()){var e=fa.xyToLngLat(b.geometry.x,b.geometry.y);d(e[0],e[1])}else this._geometryService?(e=new Pa,e.outSR=new R(4326),e.geometries=[b.geometry],this._geometryService.project(e).then(a.hitch(this,function(a){a&&a.length?d(a[0].x,a[0].y):d(b.geometry.x,b.geometry.y)}),a.hitch(this,function(){d()}))):d(b.geometry.x,b.geometry.y);else d(b.geometry.x,b.geometry.y);else d();return c.promise},_trafficLayerUpdate:function(a,b,c){a=this.get("map");
b&&this._trafficLayerAdded&&(a.removeLayer(b),this._trafficLayerAdded=!1);c&&this.get("traffic")&&!this._trafficLayerAdded&&(a.addLayer(c),c.show(),this._trafficLayerAdded=!0)},_routeTaskError:function(a){var b=E.widgets.directions.error.routeTask,c=a.details;c&&1===c.length&&("The distance between any inputs must be less than 50 miles (80 kilometers) when walking."===c[0]?b=E.widgets.directions.error.maxWalkingDistance:"Driving a truck is currently not supported outside of North America and Central America."===
c[0]&&(b=E.widgets.directions.error.nonNAmTruckingMode));this._showMessage(b);this.onDirectionsFinish(a)},_showMessage:function(a,b){var c="";if(this.messages.push({msg:a,error:!b}),this.messages.length){for(var c=c+"\x3cul\x3e",d=0;d<this.messages.length;d++)c+='\x3cli class\x3d"'+(this.messages[d].error?this._css.routesErrorClass:this._css.routesInfoClass)+'"\x3e'+this.messages[d].msg+"\x3c/li\x3e";c+="\x3c/ul\x3e"}this._msgNode&&(this._msgNode.innerHTML=c);b||this.onError(a)},_isTimeUnits:function(a){return"esriNAUSeconds"===
a||"esriNAUMinutes"===a||"esriNAUHours"===a||"esriNAUDays"===a},_getImpedanceAttribute:function(){return this._getCostAttribute(this.routeParams&&this.routeParams.travelMode&&this.routeParams.travelMode.impedanceAttributeName||this.routeParams.impedanceAttribute||this.serviceDescription.impedance)},_getDirectionsTimeAttribute:function(){return this._getCostAttribute(this.routeParams&&this.routeParams.travelMode&&this.routeParams.travelMode.timeAttributeName||this.routeParams.directionsTimeAttribute||
this.serviceDescription.directionsTimeAttribute)},_getCostAttribute:function(a){for(var b,c=this.serviceDescription&&this.serviceDescription.networkDataset.networkAttributes||[],d=0;d<c.length;d++)if(c[d].name===a&&"esriNAUTCost"===c[d].usageType){b=c[d];break}return b},_convertCostValue:function(a,b,c){var d=this._isTimeUnits(b),e=this._isTimeUnits(c);b=d?this._toMinutes(a,b):this._toMeters(a,b);return d===e?e?this._fromMinutes(b,c):this._fromMeters(b,c):a},_toMinutes:function(a,b,c){switch(a=a||
0,b){case "esriNAUSeconds":a/=Math.pow(60,c?-1:1);break;case "esriNAUHours":a*=Math.pow(60,c?-1:1);break;case "esriNAUDays":a*=Math.pow(1440,c?-1:1)}return a},_fromMinutes:function(a,b){return this._toMinutes(a,b,!0)},_toMeters:function(a,b,c){switch(a=a||0,(b||"").replace("esriNAU","esri")){case "esriInches":a*=Math.pow(.0254,c?-1:1);break;case "esriFeet":a*=Math.pow(.3048,c?-1:1);break;case "esriYards":a*=Math.pow(.9144,c?-1:1);break;case "esriMiles":a*=Math.pow(1609.344,c?-1:1);break;case "esriNauticalMiles":a*=
Math.pow(1851.995396854,c?-1:1);break;case "esriMillimeters":a/=Math.pow(1E3,c?-1:1);break;case "esriCentimeters":a/=Math.pow(100,c?-1:1);break;case "esriKilometers":a*=Math.pow(1E3,c?-1:1);break;case "esriDecimeters":a/=Math.pow(10,c?-1:1)}return a},_fromMeters:function(a,b){return this._toMeters(a,b,!0)},_createRouteTask:function(){var b=new J;return this.set("routeTask",new ra(this.get("routeTaskUrl"))),this._createRouteParams(),this.routeTask.getServiceDescription(this.travelModesServiceUrl,this.doNotFetchTravelModesFromOwningSystem).then(a.hitch(this,
function(c){c.networkDataset?(this.set("serviceDescription",c),this.set("maxStops",parseInt(this.userOptions.maxStops||c.serviceLimits&&c.serviceLimits.Route_MaxStops||this.defaults.maxStops)),this.defaults.portalUrl?(this.owningSystemUrl=this.defaults.portalUrl,b.resolve()):this.routeTask.getOwningSystemUrl().then(a.hitch(this,function(a){this.owningSystemUrl=a;b.resolve()}),b.reject)):(this._showMessage(E.widgets.directions.error.cantFindRouteServiceDescription),b.reject(Error(E.widgets.directions.error.cantFindRouteServiceDescription)))}),
a.hitch(this,function(){this._showMessage(E.widgets.directions.error.cantFindRouteServiceDescription);b.reject(Error(E.widgets.directions.error.cantFindRouteServiceDescription));this.mapClickActive=!1;this._activate()})),b.promise},_createSearchSourceDDL:function(){if(this._globalGeocoder&&this._globalGeocoder.sources&&1<this._globalGeocoder.sources.length){var b=a.hitch(this,function(a){this._searchSourceSelector.domNode.blur();this._globalGeocoder.set("activeSourceIndex",a);for(var b=0;b<this.geocoders.length;b++)this.geocoders[b].set("activeSourceIndex",
a)});if(!this._searchSourceSelector){for(var c=[{value:"all",label:E.widgets.Search.main.all,selected:!0}],d=0;d<this._globalGeocoder.sources.length;d++)c.push({value:String(d),label:this._globalGeocoder.sources[d].name});this._searchSourceSelector=new g({className:"esriSearchSourcesDDL",style:"width:100%;",options:c},this._searchSourceSelectorContainer);this._searchSourceSelector.startup();this._searchSourceSelector.on("change",b);this._searchSourceSelector.domNode.style.width=""}b("all")}else 2>
this._globalGeocoder.sources.length&&(this._searchSourceContainerNode.style.display="none")},_createTravelModesDDL:function(){this._travelModeSelector||(this._travelModeSelector=new g({className:"esriTravelModesDDL",style:"width:100%;"},this._travelModeSelectorContainer),this._travelModeSelector.startup(),this._travelModeSelector._interractive=!0,this._travelModeSelector.on("change",a.hitch(this,function(b){this._travelModeSelector._interractive?this._enqueue(function(){return this._setTravelMode(b).always(a.hitch(this,
function(){this._travelModeSelector._interractive=!0}))}):this._travelModeSelector._interractive=!0})))},_setupTravelModes:function(){var a=this.get("serviceDescription"),b=a.supportedTravelModes,c=new J;if(b&&b.length&&this._travelModeSelector){for(var d=b[0].name,e=[],f=0;f<b.length;f++){for(var g="AUTOMOBILE"===b[f].type?"Driving":"TRUCK"===b[f].type?"Trucking":"WALK"===b[f].type?"Walking":"Other",k="",h=a.networkDataset.networkAttributes,m=0;m<h.length;m++){var l=h[m];if(l.name===b[f].impedanceAttributeName){"esriNAUCentimeters"===
l.units||"esriNAUDecimalDegrees"===l.units||"esriNAUDecimeters"===l.units||"esriNAUFeet"===l.units||"esriNAUInches"===l.units||"esriNAUKilometers"===l.units||"esriNAUMeters"===l.units||"esriNAUMiles"===l.units||"esriNAUMillimeters"===l.units||"esriNAUNauticalMiles"===l.units||"esriNAUYards"===l.units?k="Distance":("esriNAUDays"===l.units||"esriNAUHours"===l.units||"esriNAUMinutes"===l.units||"esriNAUSeconds"===l.units)&&(k="Time");break}}e.push({id:b[f].name,label:'\x3cdiv class\x3d"esriTravelModesDirectionsIcon esriTravelModesType'+
g+k+'"\x3e\x26nbsp;\x3c/div\x3e\x3cdiv class\x3d"esriTravelModesTypeName"\x3e'+b[f].name+"\x3c/div\x3e"});!a.defaultTravelMode||b[f].id!==a.defaultTravelMode&&b[f].itemId!==a.defaultTravelMode||(d=b[f].name)}this._showTravelModesOption();this._travelModeSelector.setStore(new r({objectStore:new q({data:e})}));this._travelModeSelector._interractive=!1;this._travelModeSelector.setValue(d);this._setTravelMode(d).always(c.resolve)}else this.set("showTravelModesOption",!1),c.resolve();return c.promise},
_createPrintTask:function(){this._printService=(this.printTaskUrl=this._usingAGOL()?this.printTaskUrl:this.defaults.printTaskUrl)?new Ga(this.printTaskUrl,{async:!1}):null;var a=new Sa;a.exportOptions={width:670,height:750,dpi:96};a.format="PNG32";a.layout="MAP_ONLY";a.preserveScale=!1;a.showAttribution=!1;var b=new Ca;b.map=this.map;b.outSpatialReference=this.map.spatialReference;b.template=a;this._printParams=b},_createGeometryTask:function(){this._geometryService=null;this._usingAGOL()?this._geometryService=
new wa(this.geometryTaskUrl):(this._geometryService=this.defaults.geometryTaskUrl?new wa(this.defaults.geometryTaskUrl):Wa.defaults.geometryService,this.geometryTaskUrl=this._geometryService?this._geometryService.url:null)},_showTravelModesOption:function(){var a=this.get("serviceDescription");z.set(this._travelModeContainerNode,"display",this.showTravelModesOption&&a&&a.supportedTravelModes&&a.supportedTravelModes.length&&!this.doNotFetchTravelModesFromOwningSystem?"block":"none")},_showMilesKilometersOption:function(){z.set(this._agolDistanceUnitsNode,
"display",this.showMilesKilometersOption?"block":"none")},_showClearButton:function(){z.set(this._clearDirectionsButtonNode,"display",this.showClearButton?"inline-block":"none")},_showActivateButton:function(){z.set(this._activateButtonNode,"display",this.showActivateButton?"inline-block":"none");this.showActivateButton||this.deactivate()},_createRouteParams:function(){var b={returnDirections:!0,returnRoutes:!1,outputLines:"esriNAOutputLineTrueShape",preserveFirstStop:!0,preserveLastStop:!0,directionsOutputType:"complete",
stops:new Ea,ignoreInvalidLocations:!0,doNotLocateOnRestrictedElements:!0,outSpatialReference:this.get("map").spatialReference};this.get("routeParams")||(this.routeParams={});var c=new za;this.routeParams=a.mixin(c,{outputGeometryPrecision:0,outputGeometryPrecisionUnits:"esriMeters",restrictUTurns:"esriNFSBAtDeadEndsOnly"},this.get("routeParams"),b)},_markWPsForRemovalAfterUserChangedStopSequence:function(a,b){for(var c=a-1,d=[];0<=c&&this._isStopAWaypoint(this.stops[c]);)d.push(this.stops[c]),c--;
for(c=a+1;c<this.stops.length&&this._isStopAWaypoint(this.stops[c]);)d.push(this.stops[c]),c++;if(b>a)for(c=b+1;c<this.stops.length&&this._isStopAWaypoint(this.stops[c]);)d.push(this.stops[c]),c++;else if(void 0!==b)for(c=b-1;0<=c&&this._isStopAWaypoint(this.stops[c]);)d.push(this.stops[c]),c--;else if(this.returnToStart&&0===a)for(c=this.stops.length-1;0<=c&&this._isStopAWaypoint(this.stops[c]);)d.push(this.stops[c]),c--;return d},_removeSomeWaypoints:function(a){for(var c=new J,d=[],e=0;e<a.length;e++){var f=
b.indexOf(this.stops,a[e]);-1<f&&d.push(this._removeStop(f,!0,!0))}return K(d).always(c.resolve),c.promise},_modifyStopSequence:function(b,c){var d,e=this._dnd.getAllNodes(),f=new J,g=[];if(e.length)if(this._removeLocateButtonVisibilityEvents(),arguments.length&&void 0!==b)if(0<=b&&0<=c&&b<this.stops.length&&c<this.stops.length&&b!==c){var e=this._markWPsForRemovalAfterUserChangedStopSequence(b,c),k=this.stops.splice(b,1);this.stops.splice(c,0,k[0]);for(d=0;d<this.stops.length;d++)g.push(this._updateStop(this.stops[d],
d));g.push(this._removeSomeWaypoints(e));K(g).always(a.hitch(this,function(){this._solveAndZoom().always(f.resolve)}))}else f.reject("Invalid From and To values.");else{for(d=0;d<this.stops.length;)this._isStopAWaypoint(this.stops[d])?g.push(this._removeStop(d,!0,!0)):d++;K(g).always(a.hitch(this,function(){g=[];this.stops.reverse();for(d=0;d<this.stops.length;d++)g.push(this._updateStop(this.stops[d],d));K(g).always(a.hitch(this,function(){this._solveAndZoom().always(f.resolve)}))}))}else f.resolve();
return f.promise},_setMenuNodeValues:function(a){"traffic"!==a&&this._clearDisplayBeforeSolve();a=this.get("optimalRoute");if(this._findOptimalOrderNode&&B.set(this._findOptimalOrderNode,"checked",a),this._returnToStartNode)a=this.returnToStart&&!this.maxStopsReached&&this.stops[0]&&(!this.stops[0].feature||this._isStopLocated(this.stops[0])),B.set(this._returnToStartNode,"checked",a),this.set("returnToStart",a),this.maxStopsReached&&this.returnToStart&&this._showMessage(E.widgets.directions.error.maximumStops);
if(!this.returnToStart&&!this._incrementalSolveStopRange&&this.directions)for(this._incrementalSolveStopRange={start:this.stops.length-1,end:this.stops.length},this._clearRouteGraphics(),this._incrementalSolveStopRange=null,a=this.stops.length;0<a--&&this._isStopAWaypoint(this.stops[a]);)this._removeSomeWaypoints([this.stops[a]]);this._useTrafficNode&&(B.set(this._useTrafficNode,"checked",this.traffic),this.traffic?this._addTrafficLayer():this._removeTrafficLayer());switch(this.get("directionsLengthUnits")){case O.KILOMETERS:B.set(this._useKilometersNode,
"checked",!0);B.set(this._useMilesNode,"checked",!1);break;case O.MILES:B.set(this._useKilometersNode,"checked",!1),B.set(this._useMilesNode,"checked",!0)}z.set(this._printButton,"display",this.showPrintPage?"inline-block":"none");z.set(this._saveMenuButton,"display",this.showSaveButton&&this.owningSystemUrl?"inline-block":"none");this._showMilesKilometersOption();this._showClearButton()},_optionsMenu:function(){(this._useTrafficItemNode&&z.set(this._useTrafficItemNode,"display",this.get("showTrafficOption")?
"block":"none"),this._returnToStartItemNode&&z.set(this._returnToStartItemNode,"display",this.get("showReturnToStartOption")?"block":"none"),this._findOptimalOrderItemNode&&z.set(this._findOptimalOrderItemNode,"display",this.get("showOptimalRouteOption")&&3<this._getStopCount()?"block":"none"),this.stops.length>=this.get("minStops"))?A.add(this._widgetContainer,this._css.stopsOptionsOptionsEnabledClass):(A.remove(this._widgetContainer,this._css.stopsOptionsOptionsEnabledClass),this._optionsMenuNode)&&
"block"===z.get(this._optionsMenuNode,"display")&&this._toggleOptionsMenu()},_stopsRemovable:function(){2<this._dnd.getAllNodes().length-this._getWaypointCount()?A.add(this._widgetContainer,this._css.stopsRemovableClass):A.remove(this._widgetContainer,this._css.stopsRemovableClass)},_checkMaxStops:function(){this.set("maxStopsReached",this._getStopCount()+this._getWaypointCount()+(this.returnToStart?1:0)>=this.maxStops);this._showAddDestination()},_updateThemeWatch:function(a,b,c){A.remove(this.domNode,
b);A.add(this.domNode,c)},_toggleOptionsMenu:function(){"block"===z.get(this._optionsMenuNode,"display")?(z.set(this._optionsMenuNode,"display","none"),A.remove(this._optionsButtonNode,"esriStopsOptionsOpen"),this._optionsButtonNode.innerHTML=E.widgets.directions.showOptions):(z.set(this._optionsMenuNode,"display","block"),A.add(this._optionsButtonNode,"esriStopsOptionsOpen"),this._optionsButtonNode.innerHTML=E.widgets.directions.hideOptions)},_toggleSaveMenu:function(b){"block"===z.get(this._saveMenuNode,
"display")||!1===b?(z.set(this._saveMenuNode,"display","none"),A.remove(this._saveMenuButton,this._css.stopsPressedButtonClass)):(this.clearMessages(),z.set(this._saveMenuNode,"display","block"),A.add(this._saveMenuButton,this._css.stopsPressedButtonClass),this._enableSharing().then(a.hitch(this,function(){if(this._outputLayer.setValue(this.routeLayer.title?this.routeLayer.title:this.directions&&this.directions.routeName),this.routeLayer.ownerFolder)for(var a=this._folderSelector.store.objectStore.data,
b=0;b<a.length;b++)if(a[b].folderId===this.routeLayer.ownerFolder){this._folderSelector.getValue()!==a[b].id&&(this._folderSelector._interractive=!1,this._folderSelector.setValue(a[b].id));break}this._enableButton(this._saveButton,this.routeLayer.isItemOwner||!this._userCanCreatePortalItem);this._outputLayer.set("disabled",!1)})))},_showToolbar:function(){A[this.stops.length<this.maxStops&&this.canModifyStops||this.canModifyWaypoints?"add":"remove"].call(G,this._widgetContainer,this._css.addStopsClass)},
_showAddDestination:function(){this._showToolbar();this._addDestinationNode.style.display=this.stops.length<this.maxStops&&this.canModifyStops?"inline":"none"},_showMapClickActiveButton:function(){this._showToolbar();this._activateButtonNode.style.display=this.canModifyStops||this.canModifyWaypoints?"inline-block":"none"},_getAbsoluteUrl:function(a){return a=h.toUrl(a),/^https?\:/i.test(a)?a:/^\/\//i.test(a)?La+a:/^\//i.test(a)?La+"//"+window.location.host+a:a},_getManeuverImage:function(a){return a?
"esriDMTStop"===a||"esriDMTDepart"===a?"":this._getAbsoluteUrl("./images/Directions/maneuvers/"+a+".png"):""},_loadPrintDirections:function(b){var c=this.get("printTemplate"),d=new J;this.directionsLengthUnits!==this.routeParams.directionsLengthUnits?this.getDirections().then(d.resolve,d.reject):d.resolve();d.then(a.hitch(this,function(){if(!c&&this.directions){var a,d=this._getAbsoluteUrl("./css/Directions.css"),e=this._getAbsoluteUrl("./css/DirectionsPrint.css"),f=this._getAbsoluteUrl("./images/Directions/print-logo.png");
a=y.isBodyLtr()?"ltr":"rtl";c="";c+="\x3c!DOCTYPE HTML\x3e";c+='\x3chtml lang\x3d"en" class\x3d"'+this.get("theme")+'" dir\x3d"'+a+'"\x3e';c+="\x3chead\x3e";c+='\x3cmeta charset\x3d"utf-8"\x3e';c+='\x3cmeta http-equiv\x3d"X-UA-Compatible" content\x3d"IE\x3dEdge,chrome\x3d1"\x3e';c+="\x3ctitle\x3e"+this.get("directions").routeName+"\x3c/title\x3e";c+='\x3clink rel\x3d"stylesheet" media\x3d"screen" type\x3d"text/css" href\x3d"'+d+'" /\x3e';c+='\x3clink rel\x3d"stylesheet" media\x3d"print" type\x3d"text/css" href\x3d"'+
e+'" /\x3e';c+="\x3c/head\x3e";c+='\x3cbody class\x3d"'+this._css.esriPrintPageClass+'"\x3e';c+='\x3cdiv class\x3d"'+this._css.esriPrintBarClass+'"\x3e';c+='\x3cdiv class\x3d"'+this._css.esriCloseButtonClass+'" title\x3d"'+E.common.close+'" onclick\x3d"window.close();"\x3e'+E.common.close+"\x3c/div\x3e";c+='\x3cdiv id\x3d"printButton" class\x3d"'+this._css.esriPrintButtonClass+'" title\x3d"'+E.widgets.directions.print+'" onclick\x3d"window.print();"\x3e'+E.widgets.directions.print+"\x3c/div\x3e";
c+="\x3c/div\x3e";c+='\x3cdiv class\x3d"'+this._css.esriPrintMainClass+'"\x3e';c+='\x3cdiv class\x3d"'+this._css.esriPrintHeaderClass+'"\x3e';c+='\x3cimg class\x3d"'+this._css.esriPrintLogoClass+'" src\x3d"'+f+'" /\x3e';c+='\x3cdiv class\x3d"'+this._css.esriPrintNameClass+'"\x3e'+this.get("directions").routeName+"\x3c/div\x3e";c+=this._renderDirectionsSummary(this.directions);b&&(c+='\x3cdiv id\x3d"divMap" class\x3d"esriPrintMap esriPrintWait"\x3e\x3c/div\x3e',c+='\x3chr class\x3d"esriNoPrint"/\x3e');
c+='\x3cdiv id\x3d"print_helper"\x3e\x3c/div\x3e';c+='\x3ctextarea onkeyup\x3d"document.getElementById(\'print_helper\').innerHTML\x3dthis.value;" id\x3d"print_area" class\x3d"'+this._css.esriPrintNotesClass+'" placeholder\x3d"'+E.widgets.directions.printNotes+'"\x3e\x3c/textarea\x3e';c+='\x3cdiv class\x3d"'+this._css.clearClass+'"\x3e\x3c/div\x3e';c+="\x3c/div\x3e";c+='\x3cdiv class\x3d"'+this._css.esriPrintDirectionsClass+'"\x3e';c+=this._renderDirectionsTable(this.directions);c+="\x3c/div\x3e";
c+='\x3cdiv class\x3d"'+this._css.esriPrintFooterClass+'"\x3e';c+="\x3cp\x3e"+E.widgets.directions.printDisclaimer+"\x3c/p\x3e";c+="\x3c/div\x3e";c+="\x3c/div\x3e";c+="\x3c/body\x3e";c+="\x3c/html\x3e"}this._printWindow.document.open("text/html","replace");this._printWindow.document.write(c);this._printWindow.document.close()}))},_printDirections:function(){if(this.directions){var b=screen.width/2,c=screen.height/1.5,b="toolbar\x3dno, location\x3dno, directories\x3dno, status\x3dyes, menubar\x3dno, scrollbars\x3dyes, resizable\x3dyes, width\x3d"+
b+", height\x3d"+c+", top\x3d"+(screen.height/2-c/2)+", left\x3d"+(screen.width/2-b/2);this.get("printPage")?(window.directions=this.get("directions"),window.open(this.get("printPage"),"directions_widget_print",b,!0)):(this._printWindow=window.open("","directions_widget_print",b,!0),this._loadPrintDirections(!!this._printService),this._printService&&h(["dojo/_base/window"],a.hitch(this,function(b){this.zoomToFullRoute().then(a.hitch(this,function(){this._printService.execute(this._printParams,a.hitch(this,
function(a){b.withDoc(this._printWindow.document,function(){var b=x.byId("divMap");b&&(A.remove(b,"esriPrintWait"),A.add(b,"esriPageBreak"),G.create("img",{src:a.url,"class":"esriPrintMapImg"},b))})}),a.hitch(this,function(a){b.withDoc(this._printWindow.document,function(){var a=x.byId("divMap");a&&A.remove(a,"esriPrintWait")});console.error("Error while calling print service:\n "+a)}))}))})))}},_enableButton:function(a,b){var c=b||void 0===b;A[c?"remove":"add"].apply(this,[a,"esriDisabledDirectionsButton"]);
a._enabled=c},_enableSharing:function(){var b=new J;return!this._naRouteSharing&&this.owningSystemUrl?h(["../tasks/NARouteSharing"],a.hitch(this,function(c){this._naRouteSharing=new c(this.owningSystemUrl,this.map.spatialReference);this._folderSelector||(this._folderSelector=new g({className:"esriFoldersDDL",style:"width: 100%;",sortByLabel:!1,disabled:!0,_interractive:!0,onChange:a.hitch(this,function(){this._folderSelector._interractive?this._enableButton(this._saveButton,!this.routeLayer.itemId):
this._folderSelector._interractive=!0})},this._folderSelectorContainer),this._folderSelector.startup(),this._outputLayer=new e({style:"width: 100%",required:!0,trim:!0,regExp:'[^:|\x26|\x3c|\x3e|%|#|?|\\|"|/|+]+',maxLength:98,disabled:!0,onKeyPress:a.hitch(this,function(){this._enableButton(this._saveButton,!this.routeLayer.itemId||!this._userCanCreatePortalItem)})},this._outputLayerContainer),this._outputLayer.startup());this._naRouteSharing.getFolders().then(a.hitch(this,function(c){for(var d=[],
e=0;e<c.length;e++)d.push({id:c[e].url,folderId:c[e].id,label:c[e].title});this._folderSelector.setStore(new r({objectStore:new q({data:d})}));this._naRouteSharing.canCreateItem().then(a.hitch(this,function(a){this._folderSelector.set("disabled",!a);this._userCanCreatePortalItem=a}));this._enableButton(this._saveButton);b.resolve()}),a.hitch(this,function(a){this._naRouteSharing=null;this._toggleSaveMenu(!1);b.reject(a)}))})):this.owningSystemUrl?b.resolve():(b.reject(Error("Owning system is not defined, or the Directions widget is not done initializing.")),
this._naRouteSharing=null),b.promise},_storeRouteUI:function(){var a=new J;return this._outputLayer&&this._outputLayer.isValid()?this._storeRoute(this._outputLayer.getValue(),this._folderSelector.getValue(),this._folderSelector.store.objectStore.get(this._folderSelector.getValue()).folderId).then(a.resolve,a.reject):(this._outputLayer&&this._outputLayer.focus(),a.reject(Error("Need result layer name specified."))),a.promise},_storeRoute:function(c,d,e){var f=new J,g=this.directions;if(this._savingRoute||
!this._naRouteSharing)return this._saveButton.blur(),f.reject(Error("Not ready to store route.")),f.promise;if(this.clearMessages(),f.then(null,a.hitch(this,function(a){this._showMessage(E.widgets.directions.error.cantSaveRoute)})),f.promise.always(a.hitch(this,function(){this._enableButton(this._saveButton);z.set(this._saveAsButton,"display",this.routeLayer.itemId&&this._userCanCreatePortalItem?"inline-block":"none");this._showLoadingSpinner();this._savingRoute=!1})),g&&g.features&&g.features.length&&
this.stops&&this.stops.length)if(this.owningSystemUrl)if(this.routeParams&&this.routeParams.travelMode)if(c&&d){var k,h,m;k=a.hitch(this,function(a){return this._naRouteSharing.getAttributeUnits(a,this.serviceDescription)});var l=this.routeParams.travelMode.timeAttributeName,n=this.routeParams.travelMode.distanceAttributeName,q=k(l),r=k(n),u=this.routeParams.directionsLengthUnits||this.serviceDescription.directionsLengthUnits,t=this._naRouteSharing.toMeters,v=this._naRouteSharing.toMinutes,w=function(a,
c,d){var e,f;for(f in a)a.hasOwnProperty(f)&&0===f.indexOf(c)&&-1===b.indexOf(d,f.substr(c.length))&&(e=e||{},e[f.substr(c.length)]=a[f]);return e},x=[],y=[],C=[];if(l&&q&&n&&r){var A=[];m=this.routeParams.accumulateAttributes||this.serviceDescription.accumulateAttributeNames||[];h=this.serviceDescription.networkDataset.networkAttributes;for(k=0;k<h.length;k++)"esriNAUTCost"===h[k].usageType&&-1===b.indexOf(m,h[k].name)&&h[k].name!==l&&h[k].name!==n&&A.push(h[k].name);m=this.get("stops");var B={xmin:1/
0,ymin:1/0,xmax:-(1/0),ymax:-(1/0)};for(k=0;k<m.length;k++)if(m[k].feature&&m[k].feature.toJson){h=m[k].feature.toJson();var D=h.attributes,F=h.geometry,fa=this._naRouteSharing.getUTCOffset(D.ArriveTime,D.ArriveTimeUTC),G=this._naRouteSharing.getUTCOffset(D.DepartTime,D.DepartTimeUTC);a.mixin(B,{xmin:B.xmin>F.x?F.x:B.xmin,ymin:B.ymin>F.y?F.y:B.ymin,xmax:B.xmax<F.x?F.x:B.xmax,ymax:B.ymax<F.y?F.y:B.ymax});h.attributes={CurbApproach:D.CurbApproach,ArrivalCurbApproach:D.ArriveCurbApproach,DepartureCurbApproach:D.DepartCurbApproach,
Name:D.Name===this._waypointName?E.widgets.directions.waypoint:D.Name===this._userDefinedStopName?m[k].name:D.Name,Sequence:D.Sequence,Status:D.Status,LocationType:D.isWaypoint?1:0,TimeWindowStart:D.TimeWindowStart,TimeWindowEnd:D.TimeWindowEnd,ServiceMinutes:v(D["Attr_"+l],q),ServiceMeters:t(D["Attr_"+n],r),ServiceCosts:L.stringify(w(D,"Attr_",A)),CumulativeMinutes:v(D["Cumul_"+l],q),CumulativeMeters:t(D["Cumul_"+n],r),CumulativeCosts:L.stringify(w(D,"Cumul_",A)),LateMinutes:v(D["Violation_"+l],
q),WaitMinutes:v(D["Wait_"+l],q),ArrivalTime:this._naRouteSharing.toUTCTime(D.ArriveTime,fa),DepartureTime:this._naRouteSharing.toUTCTime(D.DepartTime,G),ArrivalUTCOffset:fa,DepartureUTCOffset:G};x.push(h)}l=0;n=function(a){var b;try{a.strings=L.parse(a.strings)}catch(c){H.strings=void 0}if(a.strings&&a.strings.length){for(var d=0;d<a.strings.length;d++)if("esriDSTGeneral"===a.strings[d].stringType){b=a.strings[d].string;a.strings.splice(d,1);break}a.strings=L.stringify(a.strings)}return b};for(k=
0;k<g.featuresWithWaypoints.length;k++){h=g.featuresWithWaypoints[k];r=h.toJson();F=r.attributes;D=r.geometry&&r.geometry.paths&&r.geometry.paths[0]||[];m=this._naRouteSharing.getUTCOffset(F.ETA,F.arriveTimeUTC);r.attributes={Sequence:k+1,StopSequence:h._associatedStopWithReturnToStart&&h._associatedStopWithReturnToStart.attributes.Sequence,ArrivalTime:this._naRouteSharing.toUTCTime(F.ETA,m),UTCOffset:m,ManeuverType:F.maneuverType,Meters:t(F.length,u),Minutes:v(F.time,q),DirectionText:h._associatedStopWithReturnToStart&&
h._associatedStopWithReturnToStart.attributes.isWaypoint?F.text.replace(this._waypointName,E.widgets.directions.waypoint):F.text,ManeuverMessages:L.stringify(g.stringsWithWaypoints[k])};delete r.symbol;delete r.infoTemplate;m=!0;for(h=0;h<D.length-1;h++)if(D[h][0]!==D[h+1][0]||D[h][1]!==D[h+1][1]){m=!1;break}m&&delete r.geometry;y.push(r);var H=g.eventsWithWaypoints[r.attributes.Sequence]||[];for(h=0;h<H.length;h++)D=H[h].toJson(),F=D.attributes,m=this._naRouteSharing.getUTCOffset(F.ETA,F.arriveTimeUTC),
D.attributes={DirectionSequence:r.attributes.Sequence,Sequence:++l,ArrivalTime:this._naRouteSharing.toUTCTime(F.ETA,m),UTCOffset:m,EventText:n(F),EventMessages:F.strings},C.push(D)}var r=this.routeParams.barriers&&this.routeParams.barriers.features||[],K=[];for(k=0;k<r.length;k++)l=r[k].toJson(),n=l.attributes,l.attributes={BarrierType:n.BarrierType||0,FullEdge:n.FullEdge||!1,AddedCost:n["Attr_"+this._getImpedanceAttribute().name]||0,Costs:L.stringify(w(n,"Attr_",A)),CurbApproach:n.CurbApproach||
0,Name:n.Name},K.push(l);var r=this.routeParams.polylineBarriers&&this.routeParams.polylineBarriers.features||[],I=[];for(k=0;k<r.length;k++)l=r[k].toJson(),n=l.attributes,l.attributes={BarrierType:n.BarrierType||0,ScaleFactor:n["Attr_"+this._getImpedanceAttribute().name]||1,Costs:L.stringify(w(n,"Attr_",A)),Name:n.Name},I.push(l);var r=this.routeParams.polygonBarriers&&this.routeParams.polygonBarriers.features||[],ea=[];for(k=0;k<r.length;k++)l=r[k].toJson(),n=l.attributes,l.attributes={BarrierType:n.BarrierType||
0,ScaleFactor:n["Attr_"+this._getImpedanceAttribute().name]||1,Costs:L.stringify(w(n,"Attr_",A)),Name:n.Name},ea.push(l);var Q={geometry:g.mergedGeometry,attributes:{RouteName:g.routeName,TotalMinutes:v(g.totalTime,q),TotalMeters:t(g.totalLength,u),TotalLateMinutes:function(){for(var a=0,b=0;b<x.length;b++)a+=x[b].attributes.LateMinutes||0;return a}(),TotalWaitMinutes:function(){for(var a=0,b=0;b<x.length;b++)a+=x[b].attributes.WaitMinutes||0;return a}(),TotalCosts:x[x.length-1].attributes.CumulativeCosts,
StartTime:x[0].attributes.ArrivalTime,EndTime:x[x.length-1].attributes.DepartureTime,StartUTCOffset:x[0].attributes.ArrivalUTCOffset,EndUTCOffset:x[x.length-1].attributes.DepartureUTCOffset,Messages:L.stringify(this._solverMessages),AnalysisSettings:L.stringify({travelMode:a.hitch(this,function(){var b=a.clone(this.routeParams.travelMode);return"\x26lt;"===b.name.substr(0,4)&&"\x26gt;"===b.name.substr(b.name.length-4,4)&&(b.name=b.name.substr(4,b.name.length-8)),b})(),directionsLanguage:this.routeParams.directionsLanguage||
this.serviceDescription.directionsLanguage,startTimeIsUTC:this.routeParams.startTimeIsUTC,timeWindowsAreUTC:this.routeParams.timeWindowsAreUTC,findBestSequence:this.routeParams.findBestSequence,preserveFirstStop:this.routeParams.preserveFirstStop,preserveLastStop:this.routeParams.preserveLastStop,accumulateAttributeNames:this.routeParams.accumulateAttributes||this.serviceDescription.accumulateAttributeNames})}};this._enableButton(this._saveButton,!1);this._savingRoute=!0;this._showLoadingSpinner(!0);
a.hitch(this,function(){var b=new J;return this._printService?this.zoomToFullRoute().then(a.hitch(this,function(){var a=this._printParams.template,c=a.exportOptions;a.exportOptions={width:200,height:133,dpi:96};this._printService.execute(this._printParams,function(d){a.exportOptions=c;b.resolve(d.url)},function(d){a.exportOptions=c;console.error("Error while calling print service:\n "+d);b.resolve()})})):b.resolve(),b.promise})().then(a.hitch(this,function(b){var k={folder:d,name:c,stops:x,directions:y,
directionEvents:C,barriers:K,polylineBarriers:I,polygonBarriers:ea,extent:a.mixin(a.clone(g.extent),{xmin:B.xmin>g.extent.xmin?g.extent.xmin:B.xmin,ymin:B.ymin>g.extent.ymin?g.extent.ymin:B.ymin,xmax:B.xmax<g.extent.xmax?g.extent.xmax:B.xmax,ymax:B.ymax<g.extent.ymax?g.extent.ymax:B.ymax}),routeInfo:Q,thumbnail:b};this._userCanCreatePortalItem?this._naRouteSharing.store(k,this.routeLayer.itemId).then(a.hitch(this,function(b){if(b.success){var c=this._naRouteSharing.portal,c="//"+(c.isPortal?c.portalHostname:
c.urlKey+"."+c.customBaseUrl);this._toggleSaveMenu();this._showMessage(E.widgets.directions.routeIsSaved+"\x3cbr/\x3e\x3ca class\x3d'esriLinkButton' target\x3d'_blank' href\x3d'"+c+"/home/item.html?id\x3d"+b.id+"'\x3e"+E.widgets.directions.share+"\x3c/a\x3e",!0);this.routeLayer.itemId?this.onRouteItemUpdated(b.id):this.onRouteItemCreated(b.id);a.mixin(this.routeLayer,{itemId:b.id,title:k.name,isItemOwner:!0,ownerFolder:e});f.resolve(b)}else f.reject(b)}),f.reject):this._naRouteSharing.createFeatureCollection(k).then(a.hitch(this,
function(a){f.resolve(a);this._toggleSaveMenu();this.onFeatureCollectionCreated(a)}),f.reject)}))}else f.reject(Error("Cannot deduce the impedance used."))}else f.reject(Error("Missing required parameter: layerName, folder must be specified."));else f.reject(Error("Shared route must be built using a Travel Mode."));else f.reject(Error("Cannot store route: owning system to store routes is not defined. Please specify Portal or ArcGIS Online Url in constructor."));else f.reject(Error("No route to share. Build a route first."));
return f.promise},_loadRoute:function(b){var c=new J;return c.promise.always(a.hitch(this,function(){this._showLoadingSpinner(!1);z.set(this._saveAsButton,"display",this.routeLayer.itemId&&this._userCanCreatePortalItem?"inline-block":"none");this._enableButton(this._saveButton,this.routeLayer.isItemOwner)})),this._reset().then(a.hitch(this,function(){this._showLoadingSpinner(!0);this._enableSharing().then(a.hitch(this,function(){var d,e,f,g,k=a.clone(this.serviceDescription),h=a.hitch(this,function(c){a.mixin(this.routeLayer,
{itemId:b,title:c.title,isItemOwner:c.isItemOwner,ownerFolder:c.ownerFolder})});k.directionsLengthUnits=this.directionsLengthUnits;this._naRouteSharing.load(b,k).then(a.hitch(this,function(b){if(b.routeParameters){a.mixin(this.routeParams,b.routeParameters);this.routeParams.accumulateAttributes=b.routeParameters.accumulateAttributeNames;this.set("optimalRoute",this.routeParams.findBestSequence);this.startTime=this.routeParams.startTime?this.routeParams.startTime:"now";this._setStartTime(void 0,void 0,
this.startTime);var m=b.routeParameters.travelMode,l=m?this._getCostAttribute(m.impedanceAttributeName):void 0,l=l?this._isTimeUnits(l.units)?"Time":"Distance":"";if(g=k.supportedTravelModes&&k.supportedTravelModes.length?this._travelModeSelector.store.objectStore.data.slice():[],l){var n="AUTOMOBILE"===m.type?"Driving":"TRUCK"===m.type?"Trucking":"WALK"===m.type?"Walking":"Other";m.name="\x26lt;"+m.name+"\x26gt;";this.serviceDescription.supportedTravelModes=(k.supportedTravelModes||[]).concat(m);
g.push({id:m.name,label:'\x3cdiv class\x3d"esriTravelModesDirectionsIcon esriTravelModesType'+n+l+'"\x3e\x26nbsp;\x3c/div\x3e\x3cdiv class\x3d"esriTravelModesTypeName"\x3e'+m.name+"\x3c/div\x3e"});this._travelModeSelector.setStore(new r({objectStore:new q({data:g})}));this._travelModeSelector._interractive=!1;this._travelModeSelector.setValue(m.name)}else if(console.warn("Cost attribute with such name was not found in the remote service, defaulting to the service travel mode."),m=k.defaultTravelMode,
g=k.supportedTravelModes,m&&g)for(d=0;d<g.length;d++){if(g[d].id===m){this.routeParams.travelMode=g[d].impedanceAttributeName?g[d]:g[d].itemId;break}}else this.routeParams.travelMode=null;this._checkStartTimeUIAvailability()}if(b.solveResult&&b.solveResult.routeResults){var u,t,v,n=1/0,w=-(1/0),m=b.solveResult.routeResults[0].stops,x=b.solveResult.routeResults[0].directions.features,l={};for(d=0;d<m.length;d++){var y=m[d].attributes;if(y.isWaypoint)for(e=0;e<x.length;e++)u=x[e].attributes,u._stopSequence===
y.Sequence&&(u.text=u.text.replace(y.Name,this._waypointName));f=y.Name+"_"+this._stopSequence++;l[f]=y.isWaypoint?this._waypointName:y.Name;y.Name=f;y.Sequence<n&&(null!==y.ArriveCurbApproach||null!==y.DepartCurbApproach)&&(t=y.Name,n=y.Sequence);y.Sequence>w&&(null!==y.ArriveCurbApproach||null!==y.DepartCurbApproach)&&(v=y.Name,w=y.Sequence)}f=t+" - "+v;b.solveResult.routeResults[0].routeName=f;b.solveResult.routeResults[0].directions.routeName=f;for(d=0;d<x.length;d++)if(u=x[d].attributes,void 0!==
u._stopSequence)for(e=0;e<m.length;e++)if(u._stopSequence===m[e].attributes.Sequence){f=m[e].attributes.Name;u.text=(u.text||"").replace(l[f],f);delete u._stopSequence;break}u=m[m.length-1];m[0].geometry.x===u.geometry.x&&m[0].geometry.y===u.geometry.y&&(this._returnToStartStop=this._addStopWrapperToGraphic(new Q(u.geometry,null,u.attributes),l[u.attributes.Name]),this.set("returnToStart",!0));this._solveResultProcessing(b.solveResult,l).then(a.hitch(this,function(){h(b);this.zoomToFullRoute();c.resolve(b)}),
c.reject)}else{if(b.routeParameters){u=b.routeParameters.stops.features;this.stops=[];for(d=0;d<u.length;d++)this.stops.push(this._addStopWrapperToGraphic(u[d],u[d].attributes.Name)),this._updateStop(this.stops[d],d);this._setStops();b.loadMessages.push({message:E.widgets.directions.routeLayerStopsOnly,messageType:"Warning"})}else b.loadMessages.push({message:E.widgets.directions.routeLayerEmpty,messageType:"Warning"});h(b);c.resolve(b)}for(d=0;d<b.loadMessages.length;d++)this._showMessage(b.loadMessages[d].message)}),
a.hitch(this,function(a){c.reject(a);this._showMessage("GWM_0003"===a.messageCode?E.widgets.directions.error.accessDenied+this._naRouteSharing.portal.getPortalUser().username:E.widgets.directions.error.loadError)}))}),c.reject)}),c.reject),c.promise}});return v("extend-esri")&&a.setObject("dijit.Directions",l,M),l})},"dijit/form/Select":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x){function y(a){return function(b){this._isLoaded?this.inherited(a,arguments):this.loadDropDown(m.hitch(this,a,b))}}var z=l("dijit.form._SelectMenu",q,{autoFocus:!0,buildRendering:function(){this.inherited(arguments);this.domNode.setAttribute("role","listbox")},postCreate:function(){this.inherited(arguments);this.own(g(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}))},focus:function(){var a=!1,b=this.parentWidget.value;
m.isArray(b)&&(b=b[b.length-1]);b&&h.forEach(this.parentWidget._getChildren(),function(c){c.option&&b===c.option.value&&(a=!0,this.focusChild(c,!1))},this);a||this.inherited(arguments)}});b=l("dijit.form.Select"+(e("dojo-bidi")?"_NoBidi":""),[c,n,t],{baseClass:"dijitSelect dijitValidationTextBox",templateString:x,_buttonInputDisabled:e("ie")?"disabled":"",required:!1,state:"",message:"",tooltipPosition:[],emptyLabel:"\x26#160;",_isLoaded:!1,_childrenLoaded:!1,labelType:"html",_fillContent:function(){this.inherited(arguments);
if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this._set("value",this.options[0<=a?a:0].value)}this.dropDown=new z({id:this.id+"_menu",parentWidget:this});d.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "))},_getMenuItemForOption:function(a){if(a.value||a.label){var b=m.hitch(this,"_setValueAttr",a);a=new r({option:a,label:("text"===this.labelType?(a.label||"").toString().replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a.label)||this.emptyLabel,
onClick:b,ownerDocument:this.ownerDocument,dir:this.dir,textDir:this.textDir,disabled:a.disabled||!1});a.focusNode.setAttribute("role","option");return a}return new u({ownerDocument:this.ownerDocument})},_addOptionItem:function(a){this.dropDown&&this.dropDown.addChild(this._getMenuItemForOption(a))},_getChildren:function(){return this.dropDown?this.dropDown.getChildren():[]},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},focusChild:function(a){a&&this.set("value",
a.option)},_getFirst:function(){var a=this._getChildren();return a.length?a[0]:null},_getLast:function(){var a=this._getChildren();return a.length?a[a.length-1]:null},childSelector:function(a){return(a=w.byNode(a))&&a.getParent()==this.dropDown},onKeyboardSearch:function(a,b,c,d){a&&this.focusChild(a)},_loadChildren:function(a){if(!0===a)if(this.dropDown&&(delete this.dropDown.focusedChild,this.focusedChild=null),this.options.length)this.inherited(arguments);else{h.forEach(this._getChildren(),function(a){a.destroyRecursive()});
var b=new r({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(b)}else this._updateSelection();this._isLoaded=!1;this._childrenLoaded=!0;this._loadingStore||this._setValueAttr(this.value,!1)},_refreshState:function(){this._started&&this.validate(this.focused)},startup:function(){this.inherited(arguments);this._refreshState()},_setValueAttr:function(b){this.inherited(arguments);a.set(this.valueNode,"value",this.get("value"));this._refreshState()},_setNameAttr:"valueNode",
_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setOptionsAttr:function(a){this._isLoaded=!1;this._set("options",a)},_setDisplay:function(a){a=("text"===this.labelType?(a||"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a)||this.emptyLabel;this.containerNode.innerHTML='\x3cspan role\x3d"option" aria-selected\x3d"true" class\x3d"dijitReset dijitInline '+
this.baseClass.replace(/\s+|$/g,"Label ")+'"\x3e'+a+"\x3c/span\x3e"},validate:function(a){a=this.disabled||this.isValid(a);this._set("state",a?"":this._hasBeenBlurred?"Error":"Incomplete");this.focusNode.setAttribute("aria-invalid",a?"false":"true");var b=a?"":this._missingMsg;b&&this.focused&&this._hasBeenBlurred?v.show(b,this.domNode,this.tooltipPosition,!this.isLeftToRight()):v.hide(this.domNode);this._set("message",b);return a},isValid:function(){return!this.required||0===this.value||!/^\s*$/.test(this.value||
"")},reset:function(){this.inherited(arguments);v.hide(this.domNode);this._refreshState()},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=f.getLocalization("dijit.form","validate",this.lang).missingMessage},postCreate:function(){this.inherited(arguments);this.own(g(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}));this.domNode.setAttribute("aria-expanded","false");var a=this._keyNavCodes;delete a[k.LEFT_ARROW];delete a[k.RIGHT_ARROW]},_setStyleAttr:function(a){this.inherited(arguments);
d.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width)},isLoaded:function(){return this._isLoaded},loadDropDown:function(a){this._loadChildren(!0);this._isLoaded=!0;a()},destroy:function(a){this.dropDown&&!this.dropDown._destroyed&&(this.dropDown.destroyRecursive(a),delete this.dropDown);v.hide(this.domNode);this.inherited(arguments)},_onFocus:function(){this.validate(!0)},_onBlur:function(){v.hide(this.domNode);this.inherited(arguments);this.validate(!1)}});
e("dojo-bidi")&&(b=l("dijit.form.Select",b,{_setDisplay:function(a){this.inherited(arguments);this.applyTextDir(this.containerNode)}}));b._Menu=z;b.prototype._onContainerKeydown=y("_onContainerKeydown");b.prototype._onContainerKeypress=y("_onContainerKeypress");return b})},"dijit/form/_FormSelectWidget":function(){define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q){return b("dijit.form._FormSelectWidget",q,{multiple:!1,options:null,store:null,_setStoreAttr:function(a){this._created&&this._deprecatedSetStore(a)},query:null,_setQueryAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{query:a})},queryOptions:null,_setQueryOptionsAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{queryOptions:a})},labelAttr:"",onFetch:null,sortByLabel:!0,loadChildrenOnOpen:!1,
onLoadDeferred:null,getOptions:function(a){var b=this.options||[];if(null==a)return b;if(g.isArrayLike(a))return h.map(a,"return this.getOptions(item);",this);g.isString(a)&&(a={value:a});g.isObject(a)&&(h.some(b,function(b,c){for(var d in a)if(!(d in b)||b[d]!=a[d])return!1;a=c;return!0})||(a=-1));return 0<=a&&a<b.length?b[a]:null},addOption:function(a){h.forEach(g.isArrayLike(a)?a:[a],function(a){a&&g.isObject(a)&&this.options.push(a)},this);this._loadChildren()},removeOption:function(a){a=this.getOptions(g.isArrayLike(a)?
a:[a]);h.forEach(a,function(a){a&&(this.options=h.filter(this.options,function(b){return b.value!==a.value||b.label!==a.label}),this._removeOptionItem(a))},this);this._loadChildren()},updateOption:function(a){h.forEach(g.isArrayLike(a)?a:[a],function(a){var b=this.getOptions({value:a.value}),c;if(b)for(c in a)b[c]=a[c]},this);this._loadChildren()},setStore:function(a,b,c){m.deprecated(this.declaredClass+"::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
"","2.0");this._deprecatedSetStore(a,b,c)},_deprecatedSetStore:function(b,e,f){var k=this.store;f=f||{};if(k!==b){for(var m;m=this._notifyConnections.pop();)m.remove();b.get||(g.mixin(b,{_oldAPI:!0,get:function(a){var b=new l;this.fetchItemByIdentity({identity:a,onItem:function(a){b.resolve(a)},onError:function(a){b.reject(a)}});return b.promise},query:function(a,b){var c=new l(function(){d.abort&&d.abort()});c.total=new l;var d=this.fetch(g.mixin({query:a,onBegin:function(a){c.total.resolve(a)},
onComplete:function(a){c.resolve(a)},onError:function(a){c.reject(a)}},b));return new n(c)}}),b.getFeatures()["dojo.data.api.Notification"]&&(this._notifyConnections=[a.after(b,"onNew",g.hitch(this,"_onNewItem"),!0),a.after(b,"onDelete",g.hitch(this,"_onDeleteItem"),!0),a.after(b,"onSet",g.hitch(this,"_onSetItem"),!0)]));this._set("store",b)}this.options&&this.options.length&&this.removeOption(this.options);this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&
(this._observeHandle.remove(),this._observeHandle=null);f.query&&this._set("query",f.query);f.queryOptions&&this._set("queryOptions",f.queryOptions);b&&b.query&&(this._loadingStore=!0,this.onLoadDeferred=new l,this._queryRes=b.query(this.query,this.queryOptions),c(this._queryRes,g.hitch(this,function(a){if(this.sortByLabel&&!f.sort&&a.length)if(b.getValue)a.sort(d.createSortFunction([{attribute:b.getLabelAttributes(a[0])[0]}],b));else{var c=this.labelAttr;a.sort(function(a,b){return a[c]>b[c]?1:b[c]>
a[c]?-1:0})}f.onFetch&&(a=f.onFetch.call(this,a,f));h.forEach(a,function(a){this._addOptionForItem(a)},this);this._queryRes.observe&&(this._observeHandle=this._queryRes.observe(g.hitch(this,function(a,b,c){b==c?this._onSetItem(a):(-1!=b&&this._onDeleteItem(a),-1!=c&&this._onNewItem(a))}),!0));this._loadingStore=!1;this.set("value","_pendingValue"in this?this._pendingValue:e);delete this._pendingValue;this.loadChildrenOnOpen?this._pseudoLoadChildren(a):this._loadChildren();this.onLoadDeferred.resolve(!0);
this.onSetStore()}),g.hitch(this,function(a){console.error("dijit.form.Select: "+a.toString());this.onLoadDeferred.reject(a)})));return k},_setValueAttr:function(a,b){this._onChangeActive||(b=null);if(this._loadingStore)this._pendingValue=a;else if(null!=a){a=g.isArrayLike(a)?h.map(a,function(a){return g.isObject(a)?a:{value:a}}):g.isObject(a)?[a]:[{value:a}];a=h.filter(this.getOptions(a),function(a){return a&&a.value});var c=this.getOptions()||[];this.multiple||a[0]&&a[0].value||!c.length||(a[0]=
c[0]);h.forEach(c,function(b){b.selected=h.some(a,function(a){return a.value===b.value})});c=h.map(a,function(a){return a.value});if("undefined"!=typeof c&&"undefined"!=typeof c[0]){var d=h.map(a,function(a){return a.label});this._setDisplay(this.multiple?d:d[0]);this.inherited(arguments,[this.multiple?c:c[0],b]);this._updateSelection()}}},_getDisplayedValueAttr:function(){var a=h.map([].concat(this.get("selectedOptions")),function(a){return a&&"label"in a?a.label:a?a.value:null},this);return this.multiple?
a:a[0]},_setDisplayedValueAttr:function(a){this.set("value",this.getOptions("string"==typeof a?{label:a}:a))},_loadChildren:function(){this._loadingStore||(h.forEach(this._getChildren(),function(a){a.destroyRecursive()}),h.forEach(this.options,this._addOptionItem,this),this._updateSelection())},_updateSelection:function(){this.focusedChild=null;this._set("value",this._getValueFromOpts());var a=[].concat(this.value);if(a&&a[0]){var b=this;h.forEach(this._getChildren(),function(c){var d=h.some(a,function(a){return c.option&&
a===c.option.value});d&&!b.multiple&&(b.focusedChild=c);k.toggle(c.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),d);c.domNode.setAttribute("aria-selected",d?"true":"false")},this)}},_getValueFromOpts:function(){var a=this.getOptions()||[];if(!this.multiple&&a.length){var b=h.filter(a,function(a){return a.selected})[0];if(b&&b.value)return b.value;a[0].selected=!0;return a[0].value}return this.multiple?h.map(h.filter(a,function(a){return a.selected}),function(a){return a.value})||[]:""},
_onNewItem:function(a,b){b&&b.parent||this._addOptionForItem(a)},_onDeleteItem:function(a){this.removeOption({value:this.store.getIdentity(a)})},_onSetItem:function(a){this.updateOption(this._getOptionObjForItem(a))},_getOptionObjForItem:function(a){var b=this.store,c=this.labelAttr&&this.labelAttr in a?a[this.labelAttr]:b.getLabel(a);return{value:c?b.getIdentity(a):null,label:c,item:a}},_addOptionForItem:function(a){var b=this.store;b.isItemLoaded&&!b.isItemLoaded(a)?b.loadItem({item:a,onItem:function(a){this._addOptionForItem(a)},
scope:this}):(a=this._getOptionObjForItem(a),this.addOption(a))},constructor:function(a){this._oValue=(a||{}).value||null;this._notifyConnections=[]},buildRendering:function(){this.inherited(arguments);f.setSelectable(this.focusNode,!1)},_fillContent:function(){this.options||(this.options=this.srcNodeRef?e("\x3e *",this.srcNodeRef).map(function(a){return"separator"===a.getAttribute("type")?{value:"",label:"",selected:!1,disabled:!1}:{value:a.getAttribute("data-"+m._scopeName+"-value")||a.getAttribute("value"),
label:String(a.innerHTML),selected:a.getAttribute("selected")||!1,disabled:a.getAttribute("disabled")||!1}},this):[]);this.value?this.multiple&&"string"==typeof this.value&&this._set("value",this.value.split(",")):this._set("value",this._getValueFromOpts())},postCreate:function(){this.inherited(arguments);a.after(this,"onChange",g.hitch(this,"_updateSelection"));var b=this.store;b&&(b.getIdentity||b.getFeatures()["dojo.data.api.Identity"])&&(this.store=null,this._deprecatedSetStore(b,this._oValue,
{query:this.query,queryOptions:this.queryOptions}));this._storeInitialized=!0},startup:function(){this._loadChildren();this.inherited(arguments)},destroy:function(){for(var a;a=this._notifyConnections.pop();)a.remove();this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&(this._observeHandle.remove(),this._observeHandle=null);this.inherited(arguments)},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return[]},
_getSelectedOptionsAttr:function(){return this.getOptions({selected:!0})},_pseudoLoadChildren:function(){},onSetStore:function(){}})})},"dojo/data/ObjectStore":function(){define("../_base/lang ../Evented ../_base/declare ../_base/Deferred ../_base/array ../_base/connect ../regexp".split(" "),function(h,l,a,d,b,f,k){function m(a){return"*"==a?".*":"?"==a?".":a}return a("dojo.data.ObjectStore",[l],{objectStore:null,constructor:function(a){this._dirtyObjects=[];a.labelAttribute&&(a.labelProperty=a.labelAttribute);
h.mixin(this,a)},labelProperty:"label",getValue:function(a,b,c){return"function"===typeof a.get?a.get(b):b in a?a[b]:c},getValues:function(a,b){var c=this.getValue(a,b);return c instanceof Array?c:void 0===c?[]:[c]},getAttributes:function(a){var b=[],c;for(c in a)!a.hasOwnProperty(c)||"_"==c.charAt(0)&&"_"==c.charAt(1)||b.push(c);return b},hasAttribute:function(a,b){return b in a},containsValue:function(a,d,c){return-1<b.indexOf(this.getValues(a,d),c)},isItem:function(a){return"object"==typeof a&&
a&&!(a instanceof Date)},isItemLoaded:function(a){return a&&"function"!==typeof a.load},loadItem:function(a){var b;"function"===typeof a.item.load?d.when(a.item.load(),function(c){b=c;var d=c instanceof Error?a.onError:a.onItem;d&&d.call(a.scope,c)}):a.onItem&&a.onItem.call(a.scope,a.item);return b},close:function(a){return a&&a.abort&&a.abort()},fetch:function(a){function e(b){a.onError&&a.onError.call(f,b,a)}a=h.delegate(a,a&&a.queryOptions);var c=this,f=a.scope||c,l=a.query;if("object"==typeof l){var l=
h.delegate(l),r;for(r in l){var u=l[r];"string"==typeof u&&(l[r]=RegExp("^"+k.escapeString(u,"*?\\").replace(/\\.|\*|\?/g,m)+"$",a.ignoreCase?"mi":"m"),l[r].toString=function(a){return function(){return a}}(u))}}var v=this.objectStore.query(l,a);d.when(v.total,function(b){d.when(v,function(c){a.onBegin&&a.onBegin.call(f,b||c.length,a);if(a.onItem)for(var d=0;d<c.length;d++)a.onItem.call(f,c[d],a);a.onComplete&&a.onComplete.call(f,a.onItem?null:c,a);return c},e)},e);a.abort=function(){v.cancel&&v.cancel()};
v.observe&&(this.observing&&this.observing.cancel(),this.observing=v.observe(function(a,d,e){if(-1==b.indexOf(c._dirtyObjects,a))if(-1==d)c.onNew(a);else if(-1==e)c.onDelete(a);else for(var f in a)if(f!=c.objectStore.idProperty)c.onSet(a,f,null,a[f])},!0));this.onFetch(v);a.store=this;return a},getFeatures:function(){return{"dojo.data.api.Read":!!this.objectStore.get,"dojo.data.api.Identity":!0,"dojo.data.api.Write":!!this.objectStore.put,"dojo.data.api.Notification":!0}},getLabel:function(a){if(this.isItem(a))return this.getValue(a,
this.labelProperty)},getLabelAttributes:function(a){return[this.labelProperty]},getIdentity:function(a){return this.objectStore.getIdentity?this.objectStore.getIdentity(a):a[this.objectStore.idProperty||"id"]},getIdentityAttributes:function(a){return[this.objectStore.idProperty]},fetchItemByIdentity:function(a){var b;d.when(this.objectStore.get(a.identity),function(c){b=c;a.onItem.call(a.scope,c)},function(b){a.onError.call(a.scope,b)});return b},newItem:function(a,b){if(b){var c=this.getValue(b.parent,
b.attribute,[]),c=c.concat([a]);a.__parent=c;this.setValue(b.parent,b.attribute,c)}this._dirtyObjects.push({object:a,save:!0});this.onNew(a);return a},deleteItem:function(a){this.changing(a,!0);this.onDelete(a)},setValue:function(a,b,c){var d=a[b];this.changing(a);a[b]=c;this.onSet(a,b,d,c)},setValues:function(a,b,c){if(!h.isArray(c))throw Error("setValues expects to be passed an Array object as its value");this.setValue(a,b,c)},unsetAttribute:function(a,b){this.changing(a);var c=a[b];delete a[b];
this.onSet(a,b,c,void 0)},changing:function(a,b){a.__isDirty=!0;for(var c=0;c<this._dirtyObjects.length;c++){var d=this._dirtyObjects[c];if(a==d.object){b&&(d.object=!1,this._saveNotNeeded||(d.save=!0));return}}d=a instanceof Array?[]:{};for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);this._dirtyObjects.push({object:!b&&a,old:d,save:!this._saveNotNeeded})},save:function(a){a=a||{};var b,c=[],k=[],h=this,m=this._dirtyObjects,l=m.length;try{f.connect(a,"onError",function(){if(!1!==a.revertOnError){var b=
m;m=k;h.revert();h._dirtyObjects=b}else h._dirtyObjects=m.concat(k)});if(this.objectStore.transaction)var v=this.objectStore.transaction();for(var t=0;t<m.length;t++){var w=m[t],x=w.object,y=w.old;delete x.__isDirty;x?b=this.objectStore.put(x,{overwrite:!!y}):"undefined"!=typeof y&&(b=this.objectStore.remove(this.getIdentity(y)));k.push(w);m.splice(t--,1);d.when(b,function(b){--l||a.onComplete&&a.onComplete.call(a.scope,c)},function(b){l=-1;a.onError.call(a.scope,b)})}v&&v.commit()}catch(z){a.onError.call(a.scope,
value)}},revert:function(){for(var a=this._dirtyObjects,b=a.length;0<b;){b--;var c=a[b],d=c.object,c=c.old;if(d&&c){for(var f in c)c.hasOwnProperty(f)&&d[f]!==c[f]&&(this.onSet(d,f,d[f],c[f]),d[f]=c[f]);for(f in d)c.hasOwnProperty(f)||(this.onSet(d,f,d[f]),delete d[f])}else if(c)this.onNew(c);else this.onDelete(d);delete (d||c).__isDirty;a.splice(b,1)}},isDirty:function(a){return a?a.__isDirty:!!this._dirtyObjects.length},onSet:function(){},onNew:function(){},onDelete:function(){},onFetch:function(a){}})})},
"esri/dijit/Search":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/normalizeUtils ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K,J,I,L,M,N,Q,O,T,S,R,U,W){l=l([w,x,y,b],{declaredClass:"esri.dijit.Search",templateString:t,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(b,c){this.css={searchGroup:"searchGroup",searchInput:"searchInput",searchInputGroup:"searchInputGroup",searchBtn:"searchBtn",searchSubmit:"searchSubmit",searchIcon:"searchIcon esri-icon-search",searchButtonText:"searchButtonText",searchToggle:"searchToggle",searchToggleIcon:"searchIcon esri-icon-down-arrow",
searchMenu:"searchMenu",searchMenuHeader:"menuHeader",searchClear:"searchClear",searchClearIcon:"searchIcon esri-icon-close searchClose",searchSpinner:"searchIcon esri-icon-loading-indicator searchSpinner",searchSourceName:"sourceName",suggestionsMenu:"suggestionsMenu",sourcesMenu:"sourcesMenu",activeSource:"active",hasValue:"hasValue",hasButtonMode:"hasButtonMode",hasMultipleSources:"hasMultipleSources",showSuggestions:"showSuggestions",showSources:"showSources",showNoResults:"showNoResults",searchLoading:"searchLoading",
latLonHeader:"searchLatLongHeader",searchMoreResults:"moreResults",searchMoreResultsList:"resultsList",searchMoreResultsHeader:"moreHeader",searchMoreResultsItem:"moreItem",searchMoreResultsListHeader:"popupHeader",searchShowMoreResults:"showMoreResults",searchNoResultsMenu:"noResultsMenu",searchNoResultsBody:"noResultsBody",searchNoResultsHeader:"noResultsHeader",searchNoValueIcon:"noValueIcon esri-icon-notice-triangle",searchNoValueText:"noValueText",searchNoResultsText:"noResultsText",searchExpandContainer:"searchExpandContainer",
searchAnimateContainer:"searchAnimate",searchExpanded:"searchExpanded",searchCollapsed:"searchCollapsed",searchClearFloat:"searchClearFloat"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this._sourceNames=[];this.defaultSource={locator:new S("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),singleLineFieldName:"SingleLine",outFields:["Addr_type","Match_addr","StAddr","City"],name:v.widgets.Search.main.esriLocatorName,localSearchOptions:{minScale:3E5,
distance:5E4},placeholder:v.widgets.Search.main.placeholder,highlightSymbol:(new G(h.toUrl("./Search/images/search-pointer.png"),36,36)).setOffset(9,18)};this.options={map:null,theme:"arcgisSearch",visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:150,enableSourcesMenu:!0,enableSuggestionsMenu:!0,enableInfoWindow:!0,showInfoWindowOnSelect:!0,enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,
graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,enableLabel:!1,labelSymbol:(new L).setColor(new U([181,56,46,.9])).setFont(new M("14px",M.STYLE_NORMAL,M.VARIANT_NORMAL,M.WEIGHT_BOLD,"Arial")),labelGraphic:null,infoTemplate:new C(v.widgets.Search.main.searchResult,'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),
searchResults:null,suggestResults:null,selectedResult:null,magicKey:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:1,enableSearchingAll:!0};var d=a.mixin({},this.options,b);this.set(d);this._updateActiveSource();this._i18n=v;this._defaultSR=new E(4326);this.domNode=c},startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);this._mapLoaded().then(a.hitch(this,this._init))},postCreate:function(){var b=this;this.inherited(arguments);
this._moreResultsId=this.id+"_more_results";this.own(m(this.submitNode,z,a.hitch(this,this._searchButton)));this.own(m(this.sourcesBtnNode,z,a.hitch(this,this._toggleSourcesMenu)));this.own(m(this.inputNode,z,a.hitch(this,this._inputClick)));this.own(m(this.clearNode,z,a.hitch(this,this._clearButton)));this.own(m(this.formNode,"submit",a.hitch(this,function(a){a.preventDefault();this._cancelSuggest();this.search()})));this.own(m(this.inputNode,"keyup",a.hitch(this,function(a){this._inputKey(a)})));
this.own(m(this.sourcesBtnNode,"keyup",a.hitch(this,function(a){this._sourceBtnKey(a)})));this.own(m(this.suggestionsNode,"li:click, li:keyup",function(a){b._suggestionsEvent(a,this)}));this.own(m(this.sourcesNode,"li:click, li:keyup",function(a){b._sourcesEvent(a,this)}));this.own(m(this.inputNode,"input, paste",a.hitch(this,function(){this._suggestDelay()})));this.map&&this.map.infoWindow&&this.map.infoWindow.domNode&&this.enableInfoWindow&&(this.own(m(this.map.infoWindow.domNode,"#"+this._moreResultsId+
"_show:click",a.hitch(this,function(a){this._showMoreResultsClick(a)}))),this.own(m(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_list li a:click",a.hitch(this,function(a){this._moreResultsClick(a)}))),this.own(m(this.map.infoWindow.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",a.hitch(this,function(a){this._switchCoordinatesClick(a)}))));this.value&&this._checkStatus();this._hideMenus();this._updateVisible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);
this._updateButtonMode(this.enableButtonMode);this.toggle(this.expanded)},destroy:function(){this.clear();u.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();n.get(this.inputNode,"value")&&n.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);this.set("magicKey",null);q.remove(this.containerNode,this.css.hasValue);n.set(this.clearNode,"title","");this._hideMenus();
this._closePopup();this._hideLoading();this.emit("clear-search")},show:function(){r.set(this.domNode,"display","block")},hide:function(){r.set(this.domNode,"display","none")},expand:function(){this.enableButtonMode&&(q.add(this.containerNode,this.css.searchExpanded),q.remove(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!0))},collapse:function(){this.enableButtonMode&&(q.remove(this.containerNode,this.css.searchExpanded),q.add(this.containerNode,this.css.searchCollapsed),
this._hideMenus(),this.set("expanded",!1))},toggle:function(a){this.enableButtonMode&&("undefined"==typeof a&&(a=!this.expanded),a?this.expand():this.collapse())},search:function(b){var c=new f;return this._mapLoaded().then(a.hitch(this,function(){this._searchDeferred(b).then(a.hitch(this,function(a){var b=a.results;this.set("searchResults",b);0===a.numResults&&(this._noResults(a.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",a);this._selectFirstResult(b,a.activeSourceIndex);
c.resolve(b)}),a.hitch(this,function(a){c.reject(a)}))})),c.promise},suggest:function(b){var c=new f;return this._mapLoaded().then(a.hitch(this,function(){this._suggestDeferred(b).then(a.hitch(this,function(a){if(a){var b=a.results;this.set("suggestResults",b);this._insertSuggestions(b,a.value);this.emit("suggest-results",a);c.resolve(b)}}),a.hitch(this,function(a){c.reject(a)}))})),c.promise},select:function(b){var c,d=this._getDefaultSymbol(b),e=this.labelSymbol,f=this.sources,g=this.activeSourceIndex,
k=this.enableHighlight,h=this.enableLabel,m=this.autoNavigate,l=this.showInfoWindowOnSelect,n=this.enableInfoWindow,q=this.infoTemplate,r=new F(b.feature.toJson());if(g===this._allIndex){var u=this._getSourceIndexOfResult(b);null!==u&&(c=f[u],g=u)}else c=f[g];if(c&&(c.hasOwnProperty("highlightSymbol")&&(d=c.highlightSymbol),c.hasOwnProperty("labelSymbol")&&(e=c.labelSymbol),c.hasOwnProperty("enableHighlight")&&(k=c.enableHighlight),c.hasOwnProperty("enableLabel")&&(h=c.enableLabel),c.hasOwnProperty("autoNavigate")&&
(m=c.autoNavigate),c.hasOwnProperty("showInfoWindowOnSelect")&&(l=c.showInfoWindowOnSelect),c.hasOwnProperty("enableInfoWindow")&&(n=c.enableInfoWindow),c.hasOwnProperty("infoTemplate")?q=c.infoTemplate:c.featureLayer&&c.featureLayer.infoTemplate&&(q=c.featureLayer.infoTemplate)),this._hideMenus(),this._hideLoading(),r){var f=this.highlightGraphic,t=this.graphicsLayer,u=this.labelGraphic,v=a.mixin({},r.attributes,{searchTheme:this.theme,searchResult:this._searchResultHTML(b),searchMoreResults:this.css.searchMoreResults,
searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(b)}),w=null;if(n&&(w=q),u?(u.setGeometry(r.geometry),u.setAttributes(v),u.setSymbol(e),e&&"textsymbol"===e.type&&u.symbol.setText(b.name)):(u=new F(r.geometry,e,v),e&&"textsymbol"===e.type&&u.symbol.setText(b.name),h&&(t?t.add(u):this.map&&this.map.graphics&&this.map.graphics.add(u))),f?(f.setGeometry(r.geometry),f.setAttributes(v),f.setInfoTemplate(w),f.setSymbol(d)):
(f=new F(r.geometry,d,v,w),k&&(t?t.add(f):this.map&&this.map.graphics&&this.map.graphics.add(f))),f&&f.symbol&&"textsymbol"===f.symbol.type&&f.symbol.setText(b.name),this.map&&this.map.infoWindow&&n&&l)this.map.infoWindow.setFeatures([f]),d=this._getPointFromGeometry(f.geometry),this.map.infoWindow.show(d);this.map&&m&&b&&b.hasOwnProperty("extent")&&"function"==typeof this.map.setExtent&&this.map.setExtent(b.extent);this.set("highlightGraphic",f);this.set("labelGraphic",u)}this.set("selectedResult",
b);this.emit("select-result",{result:b,source:c,sourceIndex:g})},focus:function(){A.focus(this.inputNode)},blur:function(){this.inputNode.blur();A.curNode&&A.curNode.blur()},clearGraphics:function(){var a=this.highlightGraphic,b=this.graphicsLayer,c=this.labelGraphic;a&&(b?b.remove(a):this.map&&this.map.graphics&&this.map.graphics.remove(a));c&&(b?b.remove(c):this.map&&this.map.graphics&&this.map.graphics.remove(c));this.set("labelGraphic",null);this.set("highlightGraphic",null)},_mapLoaded:function(){var b=
new f;return this.map?this.map.loaded?b.resolve():m.once(this.map,"load",a.hitch(this,function(){b.resolve()})):b.resolve(),b.promise},_init:function(){this._getMapLayers().then(a.hitch(this,function(){this.set("loaded",!0);this.emit("load")}))},_clearButton:function(){this.clear();A.focus(this.inputNode)},_error:function(a){return Error(this.declaredClass+" "+a)},_searchDeferred:function(b){var c,d=new f,e=this.value,g=this.activeSourceIndex;b&&b.hasOwnProperty("index")&&(g=b.index);this._showLoading();
this._hideMenus();this._closePopup();this.clearGraphics();var k={magicKey:this.magicKey,text:e};return b?"string"==typeof b?(k.text=b,c=this._searchQueries(k)):c="object"==typeof b&&b.hasOwnProperty("magicKey")?this._searchQueries(b):"object"==typeof b&&b.hasOwnProperty("geometry")?this._searchQueries({geometry:b}):"object"==typeof b&&b.hasOwnProperty(this._objectIdIdentifier)?this._searchQueries(b):"object"==typeof b&&"point"===b.type?this._searchQueries({point:b}):b instanceof Array&&2===b.length?
this._searchQueries({latlon:b}):this._searchQueries(k):c=this._searchQueries(k),c.always(a.hitch(this,function(a){a=this._formatResults(a,g,e);d.resolve(a)})),d.promise},_suggestDeferred:function(b){var c,d=new f;this._deferreds.push(d);b||(b=this.value);var e=this.activeSourceIndex;return c=this._suggestQueries({text:b}),c.always(a.hitch(this,function(a){var c;if(a)for(var f=0;f<a.length;f++)a[f]&&(c=!0);c?(a=this._formatResults(a,e,b),d.resolve(a)):d.resolve()})),d.promise},_getDefaultSymbol:function(a){var b,
c,d,e;this.map&&(e=this.map.getBasemap());e||(e="topo");a&&a.feature&&a.feature.geometry&&(d=a.feature.geometry.type);"polyline"===d?d="line":"circle"===d||"extent"===d?d="polygon":"multipoint"===d&&(d="point");if(d&&((a=W.getSchemes({theme:"default",basemap:e,geometryType:d}))&&(c=a.primaryScheme),c)){c.color&&c.hasOwnProperty("opacity")&&(c.color.a=c.opacity);b=c;a=c.color;c=c.size;var f;switch(d){case "point":f=new K;f.setColor(a);f.setSize(null!==c?c:b.size);d=new J;d.setColor(b.outline.color);
d.setWidth(b.outline.width);f.setOutline(d);break;case "line":f=new J;f.setColor(a);f.setWidth(null!==c?c:b.width);break;case "polygon":f=new I,f.setColor(a),d=new J,d.setColor(b.outline.color),d.setWidth(b.outline.width),f.setOutline(d)}b=f}return b},_selectFirstResult:function(a,b){if(this.autoSelect&&a){var c;b===this._allIndex?c=this._getFirstResult(a):a[b]&&a[b][0]&&(c=a[b][0]);c&&this.select(c)}},_getSourceIndexOfResult:function(a){var b=this.searchResults;if(b)for(var c in b)if(b[c]&&b[c].length)for(var d=
0;d<b[c].length;d++)if(b[c][d]===a)return parseInt(c,10);return null},_getFirstResult:function(a){if(a)for(var b in a)if(a[b]&&a[b][0])return a[b][0];return!1},_onFocus:function(){this.map&&"function"==typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation();this.emit("focus");this.inherited(arguments)},_onBlur:function(){this._hideMenus();this.map&&"function"==typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();this.enableButtonMode&&this.loaded&&
this.collapse();this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var b=new f;if(this.addLayersFromMap&&this.map){var c=[],d=this.map.graphicsLayerIds;if(d&&d.length){for(var e=0;e<d.length;e++){var g=this.map.getLayer(d[e]);g&&c.push(this._featureLayerLoaded(g))}H(c).always(a.hitch(this,function(a){for(var c,d=this.sources,e=0;e<a.length;e++)a[e]&&a[e].loaded&&"Feature Layer"===a[e].type&&(d.push({featureLayer:a[e],enableSuggestions:!0}),c=!0);c&&this.set("sources",d);b.resolve()}))}else b.resolve()}else b.resolve();
return b.promise},_switchCoordinatesClick:function(a){a.preventDefault();(a=n.get(a.target,"data-switch-coordinates"))&&(this._cancelSuggest(),this.set("value",a),this.search())},_moreResultsClick:function(a){a.preventDefault();var b=a.target;a=parseInt(n.get(b,"data-source-index"),10);var b=parseInt(n.get(b,"data-index"),10),c=this.searchResults;c&&c[a]&&(a=c[a][b])&&this.select(a)},_showMoreResultsClick:function(a){a.preventDefault();if(a=c.byId(this._moreResultsId)){q.toggle(a,this.css.searchShowMoreResults);
var b=c.byId(this._moreResultsId+"_show");b&&(q.contains(a,this.css.searchShowMoreResults)?n.set(b,"textContent",v.widgets.Search.main.hideMoreResults):n.set(b,"textContent",v.widgets.Search.main.showMoreResults))}},_featureLayerLoaded:function(b){var c=new f;if(b.loaded)c.resolve(b);else if(b.loadError)c.reject(this._error("Layer failed to load."));else{var d,e;d=m.once(b,"load",a.hitch(this,function(){e.remove();c.resolve(b)}));e=m.once(b,"error",a.hitch(this,function(){d.remove();c.reject(this._error("Layer could not be loaded."))}))}return c.promise},
_getObjectSize:function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},_sourcesEvent:function(a,b){var c=n.get(b,"data-index"),e=g("li",this.sourcesNode),f=d.indexOf(e,b);c!==this._allIndex&&(c=parseInt(c,10));var h;"click"===a.type||a.keyCode===k.ENTER?(this.set("activeSourceIndex",c),A.focus(this.inputNode),this._hideSourcesMenu()):a.keyCode===k.UP_ARROW?(a.stopPropagation(),a.preventDefault(),h=f-1,0>h?A.focus(this.sourcesBtnNode):A.focus(e[h])):a.keyCode===k.DOWN_ARROW?(a.stopPropagation(),
a.preventDefault(),h=f+1,h>=e.length?A.focus(this.sourcesBtnNode):A.focus(e[h])):a.keyCode===k.ESCAPE&&(this._hideSourcesMenu(),A.focus(this.inputNode))},_suggestionsEvent:function(a,b){var c=n.get(b,"data-source-index"),e=parseInt(n.get(b,"data-index"),10),f=g("li",this.suggestionsNode),h=this.sources,m=d.indexOf(f,b);c!==this._allIndex&&(c=parseInt(c,10));var l;if(this._clearQueryTimeout(),"click"===a.type||a.keyCode===k.ENTER){var q,f=this.suggestResults;if(f&&f[c]&&f[c][e]&&(q=f[c][e]),q)(q.index=
c,h[c].featureLayer)?q[this._objectIdIdentifier]=q.feature.attributes[h[c].featureLayer.objectIdField]:q.magicKey&&q.text&&(this.set("value",q.text),this.set("magicKey",q.magicKey)),this.search(q),A.focus(this.inputNode)}else a.keyCode===k.BACKSPACE||a.keyCode===k.DELETE?A.focus(this.inputNode):a.keyCode===k.UP_ARROW?(a.stopPropagation(),a.preventDefault(),l=m-1,0>l?A.focus(this.inputNode):A.focus(f[l])):a.keyCode===k.DOWN_ARROW?(a.stopPropagation(),a.preventDefault(),l=m+1,l>=f.length?A.focus(this.inputNode):
A.focus(f[l])):a.keyCode===k.ESCAPE&&(this._hideMenus(),A.focus(this.inputNode))},_getResultName:function(a){var b;return a.hasOwnProperty("name")&&null!==a.name&&(b=a.name.toString()),b||(b=v.widgets.Search.main.untitledResult),b},_getSuggestionName:function(a){var b,c;return a.hasOwnProperty("name")&&(c=a.name.toString()),b=a.text||c,b||(b=v.widgets.Search.main.untitledResult),b},_searchResultHTML:function(a){var b="";if(a.feature&&a.feature.attributes&&a.feature.attributes.Addr_type&&"LatLong"===
a.feature.attributes.Addr_type){var c,d,e=a.name.split(" ");(2===e.length&&(c=e[0],d=e[1]),d&&c)?(a=parseFloat(c),d=parseFloat(d),c=d+", "+a,b+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e',b+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+v.widgets.Search.main.lonlat+"\x3c/div\x3e",b+=a+", "+d,b=b+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),a===d||90<a||-90>a||180<d||-180>d||(b+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+v.widgets.Search.main.reverseLonLatHeader+
"\x3c/div\x3e",b+='\x3ca data-switch-coordinates\x3d"'+c+'" tabindex\x3d"0" href\x3d"#"\x3e'+c+"\x3c/a\x3e",b+="\x3c/div\x3e")):b=a.name}else b=a.name;return b},_moreResultsHTML:function(a){var b="",c="",d=this.searchResults,e=this.sources,f=0;if(d){var c=c+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),c=c+('\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+v.widgets.Search.main.showMoreResults+"\x3c/a\x3e"),c=c+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsList+
'"\x3e'),c=c+('\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e'),g;for(g in d)if(d[g]){var k=d[g].length;if(k){var h=1===k&&d[g][0]===a;if(1<this._getObjectSize(d)&&!h)var m=this._getSourceName(g),c=c+('\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+m+"\x3c/div\x3e");if(k&&!h){c+="\x3cul\x3e";m=e[g].maxResults||this.maxResults;for(h=0;k>h&&m>h;++h)if(d[g][h]!==a){var l=this._getResultName(d[g][h]),c=c+('\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+h+'" data-source-index\x3d"'+
g+'" href\x3d"#"\x3e'+l+"\x3c/a\x3e\x3c/li\x3e");f++}c+="\x3c/ul\x3e"}}}c+="\x3c/div\x3e";c+="\x3c/div\x3e"}return f&&(b+=c),b},_validField:function(a,b){return a.getField(b)},_validFields:function(a,b){if(a&&b&&b.length){for(var c=0;c<b.length;c++)if(!this._validField(a,b[c]))return!1;return!0}return!1},_getCodedName:function(a,b){if(a&&a.length)for(var c=0,d=a.length;d>c;c++){var e=a[c];if(e.code===b)return e.name}},_getCodedValue:function(a,b,c){if(a&&a.length)for(var d=0,e=a.length;e>d;d++){var f=
a[d],g=f.name,k=b;if(c||(g=g.toLowerCase(),k=k.toLowerCase()),g===k)return f.code}return!1},_whereClause:function(a,b,c,d){var e=null;if(a){var f="";if(this.reHostedFS.test(b.url)&&this._containsNonLatinCharacter(a)&&(f="N"),c&&c.length)for(var g=0,k=c.length;k>g;g++){var h="",m=a.replace(/\'/g,"''"),h=c[g],l=b.getField(h),n=b.getDomain(h);if(n&&"codedValue"===n.type&&(m=this._getCodedValue(n.codedValues,m,d)),!1!==m)l=l.type,"esriFieldTypeString"===l||"esriFieldTypeDate"===l?h=d?h+" \x3d "+f+"'"+
m+"'":"UPPER("+h+") LIKE "+f+"'%"+m.toUpperCase()+"%'":"esriFieldTypeOID"===l||"esriFieldTypeSmallInteger"===l||"esriFieldTypeInteger"===l||"esriFieldTypeSingle"===l||"esriFieldTypeDouble"===l?(m=parseFloat(m),h=isNaN(m)?!1:h+" \x3d "+m):h=h+" \x3d "+m,h&&(e?e+=" or ":e="",e+=h)}}return e},_suggest:function(b){b||(b={index:this.activeSourceIndex,text:this.value});var c=new f,e=b.index,g=this.sources[e],k=this.enableSuggestions;g.hasOwnProperty("enableSuggestions")&&(k=g.enableSuggestions);var h,m=
0;b.hasOwnProperty("text")&&b.text&&(h=a.trim(b.text),m=b.text.length);b=g.minCharacters||this.minCharacters;if(k&&h&&m>=b&&this._supportsPagination(g)){var l="";g.prefix&&(l+=g.prefix);l+=h;g.suffix&&(l+=g.suffix);var n=this._defaultSR;this.map&&(n=this.map.spatialReference);k={};if(g.locator){if(g.categories&&(k.categories=g.categories),g.locator.outSpatialReference=n,this.map&&g.localSearchOptions&&g.localSearchOptions.hasOwnProperty("distance")&&g.localSearchOptions.hasOwnProperty("minScale"))h=
this._getScale(),(!g.localSearchOptions.minScale||h&&h<=parseFloat(g.localSearchOptions.minScale))&&(k.location=this.map.extent.getCenter(),k.distance=g.localSearchOptions.distance);k.text=l;g.useMapExtent&&this.map&&this.map.extent&&(k.searchExtent=this.map.extent);g.searchExtent&&(k.searchExtent=g.searchExtent);k.maxSuggestions=g.maxSuggestions||this.maxSuggestions;g.sourceCountry&&(k.countryCode=g.sourceCountry);g.countryCode&&(k.countryCode=g.countryCode);g.locator.suggestLocations(k).then(a.hitch(this,
function(a){c.resolve(a)}),a.hitch(this,function(a){a||(a=this._error("Locator suggestLocations could not be performed."));c.reject(a)}))}else g.featureLayer?this._featureLayerLoaded(g.featureLayer).then(a.hitch(this,function(){var b=this._getDisplayField(g),f=g.searchFields||[b],k=[];g.suggestionTemplate?g.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,function(a,b){k.push(b)}):k=[b];-1===d.indexOf(k,g.featureLayer.objectIdField)&&k.push(g.featureLayer.objectIdField);var b=this._validField(g.featureLayer,
b),h=this._validFields(g.featureLayer,k),m=this._validFields(g.featureLayer,f);if(b&&h&&m){b=new R;g.hasOwnProperty("suggestQueryParams")&&a.mixin(b,g.suggestQueryParams);b.outSpatialReference=n;b.returnGeometry=!1;b.num=g.maxSuggestions||this.maxSuggestions;b.outFields=k;g.useMapExtent&&this.map&&this.map.extent&&(b.geometry=this.map.extent);g.searchExtent&&(b.geometry=g.searchExtent);var q;(f=this._whereClause(l,g.featureLayer,f,!1))&&(b.where=f,q=!0);q?g.featureLayer.queryFeatures(b,a.hitch(this,
function(a){var b;(a=a.features)&&(b=this._hydrateResults(a,e,!0));c.resolve(b)}),a.hitch(this,function(a){a||(a=this._error("FeatureLayer queryFeatures errored with suggestions"));c.reject(a)})):c.resolve()}else c.reject(this._error("Invalid FeatureLayer field"))})):c.reject(this._error("Invalid source"))}else c.resolve();return c.promise},_supportsPagination:function(a){var b;return a.locator?b=!0:a.featureLayer&&a.featureLayer.advancedQueryCapabilities&&a.featureLayer.advancedQueryCapabilities.supportsPagination&&
(b=!0),b},_suggestQueries:function(a){var b,c=this.sources,d=this.activeSourceIndex,e=[];if(d===this._allIndex)for(d=0;d<c.length;d++)b=a,b.index=d,b=this._suggest(b),e.push(b);else a.index=d,b=this._suggest(a),e.push(b);return H(e)},_getPointFromGeometry:function(a){var b;switch(a.type){case "extent":b=a.getCenter();break;case "multipoint":b=a.getPoint(0);break;case "point":b=a;break;case "polygon":b=a.getCentroid();break;case "polyline":b=a.getPoint(0,0)}return b},_searchQueries:function(a){a.hasOwnProperty("index")||
(a.index=this.activeSourceIndex);var b,c=[];if(a.index===this._allIndex)for(var d=this.sources,e=0;e<d.length;e++)b=a,b.index=e,b=this._search(b),c.push(b);else a=this._search(a),c.push(a);return H(c)},_searchButton:function(){this.enableButtonMode&&!this.expanded?(this.expand(),A.focus(this.inputNode)):(this._cancelSuggest(),this.search())},_search:function(b){b||(b={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});var c,d,e=new f,g=b.index,k=this.sources[g];
if(b.hasOwnProperty("text")&&b.text&&(d=a.trim(b.text)),k){var h="";k.prefix&&!b.magicKey&&(h+=k.prefix);h+=d;k.suffix&&!b.magicKey&&(h+=k.suffix);var m=this._defaultSR;if(this.map&&(m=this.map.spatialReference),k.locator)if(b.hasOwnProperty("text")&&d){var l={};if(k.categories&&(l.categories=k.categories),m&&(k.locator.outSpatialReference=m),this.map&&k.localSearchOptions&&k.localSearchOptions.hasOwnProperty("distance")&&k.localSearchOptions.hasOwnProperty("minScale")){var n=this._getScale();(!k.localSearchOptions.minScale||
n&&n<=parseFloat(k.localSearchOptions.minScale))&&(l.location=this.map.extent.getCenter(),l.distance=k.localSearchOptions.distance)}l.address={};l.maxLocations=k.maxResults||this.maxResults;k.useMapExtent&&this.map&&this.map.extent&&(l.searchExtent=this.map.extent);k.searchExtent&&(l.searchExtent=k.searchExtent);k.sourceCountry&&(l.countryCode=k.sourceCountry);k.countryCode&&(l.countryCode=k.countryCode);b.magicKey&&(l.magicKey=b.magicKey);k.singleLineFieldName?l.address[k.singleLineFieldName]=h:
l.address["Single Line Input"]=h;k.outFields&&(l.outFields=k.outFields);k.locator.addressToLocations(l).then(a.hitch(this,function(a){a=this._hydrateResults(a,g,!1);e.resolve(a)}),a.hitch(this,function(a){a||(a=this._error("Locator addressToLocations could not be performed"));e.reject(a)}))}else b.geometry?(c=this._getPointFromGeometry(b.geometry.geometry))?this._reverseGeocodePoint(g,c).then(function(a){e.resolve(a)},function(a){e.reject(a)}):e.reject(this._error("Invalid point to reverse geocode")):
b.point?this._reverseGeocodePoint(g,b.point).then(function(a){e.resolve(a)},function(a){e.reject(a)}):b.latlon?(l=new N(b.latlon,this._defaultSR),this._reverseGeocodePoint(g,l).then(function(a){e.resolve(a)},function(a){e.reject(a)})):b.hasOwnProperty("text")&&!d?e.resolve([]):e.reject(this._error("Invalid query type for Locator"));else k.featureLayer?this._featureLayerLoaded(k.featureLayer).then(a.hitch(this,function(){var f=this._getDisplayField(k),l=k.searchFields||[f],f=this._validField(k.featureLayer,
f),n=this._validFields(k.featureLayer,l);if(f&&n){f=new R;if(k.hasOwnProperty("searchQueryParams")&&a.mixin(f,k.searchQueryParams),m)f.outSpatialReference=m,(n=T.getUnitValueForSR(m))&&(f.maxAllowableOffset=n);f.returnGeometry=!0;k.outFields&&(f.outFields=k.outFields);var q;b.hasOwnProperty(this._objectIdIdentifier)||(this._supportsPagination(k)&&(f.num=k.maxResults||this.maxResults),k.useMapExtent&&this.map&&this.map.extent&&(f.geometry=this.map.extent),k.searchExtent&&(f.geometry=k.searchExtent),
q=k.exactMatch);var r;b.hasOwnProperty("text")&&d?(l=this._whereClause(h,k.featureLayer,l,q))?(f.where=l,r=!0):r=!1:b.hasOwnProperty(this._objectIdIdentifier)?(f.objectIds=[b[this._objectIdIdentifier]],r=!0):b.geometry?(f.geometry=b.geometry,r=!0):b.point?(f.geometry=b.point,r=!0):b.latlon?(c=new N(b.latlon,this._defaultSR),f.geometry=c,r=!0):b.hasOwnProperty("text")&&!d?(e.resolve([]),r=!1):(e.reject(this._error("Invalid query type for FeatureLayer")),r=!1);r?k.featureLayer.queryFeatures(f,a.hitch(this,
function(a){var b;(a=a.features)&&(b=this._hydrateResults(a,g,!1));e.resolve(b)}),a.hitch(this,function(a){a||(a=this._error("FeatureLayer queryFeatures could not be performed"));e.reject(a)})):e.resolve()}else e.reject(this._error("Invalid FeatureLayer field"))})):e.reject(this._error("Invalid source"))}else e.reject(this._error("Source is undefined"));return e.promise},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_formatResults:function(a,b,c){c={activeSourceIndex:b,
value:c,numResults:0,numErrors:0,errors:null,results:null};var d={},e={};if(a)if(b===this._allIndex)for(b=0;b<a.length;b++)a[b]&&(a[b]instanceof Error?(d[b]=a[b],c.numErrors++):(e[b]=a[b],c.numResults+=a[b].length));else a[0]&&(a[0]instanceof Error?(d[b]=a[0],c.numErrors++):(e[b]=a[0],c.numResults+=a[0].length));return c.numErrors&&(c.errors=d),c.numResults&&(c.results=e),c},_reverseGeocodePoint:function(b,c){var d=new f,e=this.sources[b];if(c&&e){var g=e.locationToAddressDistance||this.locationToAddressDistance;
e.locator.outSpatialReference=this._defaultSR;this.map&&(e.locator.outSpatialReference=this.map.spatialReference);e.locator.locationToAddress(c,g,a.hitch(this,function(a){a=this._hydrateResults([a],b,!1);d.resolve(a)}),a.hitch(this,function(a){a||(a=this._error("Locator locationToAddress could not be performed"));d.reject(a)}))}else d.reject(this._error("No point or source defined for reverse geocoding"));return d.promise},_cancelDeferreds:function(){if(this._deferreds&&this._deferreds.length)for(var a=
0;a<this._deferreds.length;a++)this._deferreds[a].cancel(this.declaredClass+" cancelling request");this._deferreds=[]},_sourceBtnKey:function(a){if(a){var b=g("li",this.sourcesNode);a.keyCode===k.UP_ARROW?(a.stopPropagation(),a.preventDefault(),this._showSourcesMenu(),(a=b.length)&&A.focus(b[a-1])):a.keyCode===k.DOWN_ARROW&&(a.stopPropagation(),a.preventDefault(),this._showSourcesMenu(),b[0]&&A.focus(b[0]))}},_inputKey:function(a){if(a){var b=g("li",this.suggestionsNode),c=this.suggestResults;if(a.keyCode===
k.TAB||a.keyCode===k.ESCAPE)this._cancelSuggest(),this._hideMenus();else if(a.keyCode===k.UP_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),c&&this._showSuggestionsMenu(),(a=b.length)&&A.focus(b[a-1]);else if(a.keyCode===k.DOWN_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),c&&this._showSuggestionsMenu(),b[0]&&A.focus(b[0]);else{if(a.ctrlKey||a.metaKey||a.keyCode===k.copyKey||a.keyCode===k.LEFT_ARROW||a.keyCode===k.RIGHT_ARROW||a.keyCode===k.ENTER)return a;
this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();this._changeValue();this._queryTimer=setTimeout(a.hitch(this,function(){this.suggest()}),this.suggestionDelay)},_changeValue:function(){this.set("magicKey",null);this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},_getSourceName:function(a){return this._sourceNames[a]},
_loadSources:function(a){a=d.filter(a,function(a){return!!a.featureLayer});a=d.map(a,function(a){return this._featureLayerLoaded(a.featureLayer)},this);return H(a)},_createSourceNameMap:function(b){return this._loadSources(b).then(a.hitch(this,function(){var a=d.map(b,function(a){return a.name||a.featureLayer&&a.featureLayer.name||v.widgets.Search.main.untitledSource});return this._preventDuplicateSourceNames(b,a),a}))},_getDuplicateSourceNameIndexes:function(a){var b={},c=[];return d.forEach(a,function(d,
e){b.hasOwnProperty(d)?(-1===c.indexOf(b[d])&&c.push(b[d]),c.push(e)):a.lastIndexOf(d)!==e&&(b[d]=e)}),c},_preventDuplicateSourceNames:function(a,b){if(b&&1<b.length){var c=this._getDuplicateSourceNameIndexes(b);d.forEach(c,function(c){b[c]+=this._getFieldsString(a[c])},this)}},_getFieldsString:function(a){var b="",c=a.featureLayer;if(c){a=a.searchFields||[this._getDisplayField(a)];for(var d=0;d<a.length;d++)var b=b+(0===d?": ":", "),e=a[d],f=c.getFieldLabel(e),b=b+(f||e)}return b},_insertSuggestions:function(a,
b){if(this.enableSuggestionsMenu&&this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();var c,d=this.sources;if(a){c=u.create("div");for(var e in a)if(a[e]&&a[e].length){var f=this._getSourceName(e);1<d.length&&this.activeSourceIndex===this._allIndex&&u.create("div",{className:this.css.searchMenuHeader,textContent:f},c);for(var f=u.create("ul",{role:"menu"},c),g=d[e].maxSuggestions||this.maxSuggestions,k=0;k<a[e].length&&g>k;++k)for(var h=u.create("li",{"data-index":k,"data-source-index":e,
role:"menuitem",tabindex:0},f),m=new RegExp("("+b+")","gi"),m=this._getSuggestionName(a[e][k]).replace(m,"|$1|").split("|"),l=m.length,n=0;l>n;n++){var q=m[n];q.toLowerCase()===b.toLowerCase()?u.create("strong",{textContent:q},h):(q=document.createTextNode(q),u.place(q,h))}}}c?(u.place(c,this.suggestionsNode,"only"),this._showSuggestionsMenu()):(u.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},_insertSources:function(a){if(this.enableSourcesMenu&&a&&1<a.length){var b,c,d=this.activeSourceIndex,
e=u.create("ul",{role:"menu"});this.enableSearchingAll&&(b="",d===this._allIndex&&(b="active"),u.create("li",{"data-index":this._allIndex,role:"menuitem",className:b,tabIndex:0,textContent:v.widgets.Search.main.all},e));for(c=0;c<a.length;c++){b="";c===d&&(b=this.css.activeSource);var f=this._getSourceName(c);u.create("li",{"data-index":c,role:"menuitem",className:b,tabIndex:0,textContent:f},e)}q.add(this.containerNode,this.css.hasMultipleSources);u.place(e,this.sourcesNode,"only")}else q.remove(this.containerNode,
this.css.hasMultipleSources),u.empty(this.sourcesNode)},_showLoading:function(){q.add(this.containerNode,this.css.searchLoading)},_hideLoading:function(){q.remove(this.containerNode,this.css.searchLoading)},_checkStatus:function(){this.value?(q.add(this.containerNode,this.css.hasValue),n.set(this.clearNode,"title",v.widgets.Search.main.clearButtonTitle)):this.clear()},_closePopup:function(){this.enableInfoWindow&&this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_noResults:function(b){var c;
b&&(c=a.trim(b));var d=u.create("div",{className:this.css.searchNoResultsBody});b&&c?(u.create("div",{className:this.css.searchNoResultsHeader,textContent:v.widgets.Search.main.noResults},d),u.create("div",{className:this.css.searchNoResultsText,textContent:B.substitute({value:'"'+b+'"'},v.widgets.Search.main.noResultsFound)},d)):(b=u.create("div",{},d),u.create("span",{"aria-hidden":"true",className:this.css.searchNoValueIcon},b),u.create("span",{className:this.css.searchNoValueText,textContent:v.widgets.Search.main.emptyValue},
b));u.place(d,this.noResultsMenuNode,"only")},_hideMenus:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();this._hideNoResultsMenu()},_hideNoResultsMenu:function(){q.remove(this.containerNode,this.css.showNoResults)},_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();q.add(this.containerNode,this.css.showNoResults)},_hideSourcesMenu:function(){q.remove(this.containerNode,this.css.showSources)},_hideSuggestionsMenu:function(){q.remove(this.containerNode,
this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();q.add(this.containerNode,this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();this._hideNoResultsMenu();q.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();q.toggle(this.containerNode,this.css.showSources)},_getFirstStringField:function(a){if(a&&(a=a.fields)&&a.length)for(var b=0;b<
a.length;b++){var c=a[b];if("esriFieldTypeString"===c.type)return c.name}return""},_getDisplayField:function(a){return a.displayField||a.featureLayer.displayField||this._getFirstStringField(a.featureLayer)},_validExtent:function(a){return a&&a.xmin&&"NaN"!==a.xmin&&a.ymin&&"NaN"!==a.ymin&&a.xmax&&"NaN"!==a.xmax&&a.ymax&&"NaN"!==a.ymax?!0:!1},_hydrateResult:function(a,b,c){var d,e={},f=this._defaultSR;b=this.sources[b];if(this.map&&(f=this.map.spatialReference),a.hasOwnProperty("text")&&a.hasOwnProperty("magicKey"))return a;
if(a.hasOwnProperty("geometry"))d=new F(a.toJson()),e.feature=d,(d=e.feature.geometry)&&d.setSpatialReference(f);else if(a.hasOwnProperty("location")){var g=new N(a.location.x,a.location.y,f);d={};a.hasOwnProperty("attributes")&&(d=a.attributes);a.hasOwnProperty("score")&&(d.score=a.score);e.feature=new F(g,null,d,null)}else e.feature=null;if(a.hasOwnProperty("extent")&&this._validExtent(a.extent))e.extent=new Q(a.extent),e.extent.setSpatialReference(f);else if(e.feature&&e.feature.geometry)switch(e.feature.geometry.type){case "extent":e.extent=
e.feature.geometry;break;case "multipoint":e.extent=O.getDenormalizedExtent(e.feature.geometry);break;case "polygon":e.extent=O.getDenormalizedExtent(e.feature.geometry);break;case "polyline":e.extent=O.getDenormalizedExtent(e.feature.geometry);break;case "point":this.map?(f=this.zoomScale,b&&b.zoomScale&&(f=b.zoomScale),this._getScale()>f?e.extent=T.getExtentForScale(this.map,f).centerAt(e.feature.geometry):e.extent=this.map.extent.centerAt(e.feature.geometry)):e.extent=new Q({xmin:e.feature.geometry.x-
.25,ymin:e.feature.geometry.y-.25,xmax:e.feature.geometry.x+.25,ymax:e.feature.geometry.y+.25,spatialReference:this._defaultSR})}else e.extent=null;(e.name="",b.featureLayer)?b.suggestionTemplate&&c?e.name=B.substitute(a.attributes,b.suggestionTemplate):b.searchTemplate?e.name=B.substitute(a.attributes,b.searchTemplate):(c=this._getDisplayField(b),b=b.featureLayer.getDomain(c),c&&a.hasOwnProperty("attributes")&&a.attributes.hasOwnProperty(c)&&(a=a.attributes[c],b&&"codedValue"===b.type?e.name=this._getCodedName(b.codedValues,
a):e.name=a)):a.address&&b.searchTemplate?e.name=B.substitute(a.address,b.searchTemplate):a.hasOwnProperty("name")?e.name=a.name:a.hasOwnProperty("attributes")&&"object"==typeof a.attributes&&a.attributes.Match_addr?(e.name=a.attributes.Match_addr,a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&a.attributes.StAddr&&a.attributes.City&&(e.name+=" - "+a.attributes.StAddr+", "+a.attributes.City)):a.hasOwnProperty("address")&&"string"==typeof a.address?e.name=a.address:a.hasOwnProperty("address")&&
"object"==typeof a.address&&a.address.hasOwnProperty("Address")?e.name=a.address.Address:e.feature&&e.feature.geometry&&(e.name=e.feature.geometry.x+","+e.feature.geometry.y);return e},_getScale:function(){var a;return this.map&&"function"==typeof this.map.getScale&&(a=this.map.getScale()),a},_hydrateResults:function(a,b,c,d){d=[];var e=0;if(a&&a.length)for(e;e<a.length;e++){var f=this._hydrateResult(a[e],b,c);d.push(f)}return d},_containsNonLatinCharacter:function(a){for(var b=0;b<a.length;b++)if(255<
a.charCodeAt(b))return!0;return!1},_setPlaceholder:function(a){var b="",c=this.sources[a];a===this._allIndex?b=this.allPlaceholder||v.widgets.Search.main.allPlaceholder:c&&c.placeholder&&(b=c.placeholder);var d=v.widgets.Search.main.all;c&&(d=this._getSourceName(a));n.set(this.sourceNameNode,"textContent",d);n.set(this.inputNode,"placeholder",b);n.set(this.inputNode,"title",b)},_updateActiveSource:function(){var a,b=this.sources,c=this.activeSourceIndex;b&&b[c]&&(a=b[c]);a?this.set("activeSource",
a):this.set("activeSource",null)},_updateVisible:function(){this.visible?this.show():this.hide()},_updateButtonMode:function(a){a?(q.toggle(this.containerNode,this.css.searchExpanded,this.expanded),q.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),q.add(this.containerNode,this.css.hasButtonMode)):(q.remove(this.containerNode,this.css.searchExpanded),q.remove(this.containerNode,this.css.searchCollapsed),q.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(){var a=
this.sources;a&&1===a.length||!this.enableSearchingAll?this.set("activeSourceIndex",0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(a){this._set("enableSourcesMenu",a);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(a){this._set("enableSearchingAll",a);this._created&&(this._setDefaultActiveSourceIndex(),this._hideMenus(),this._insertSources(this.sources))},_setSourcesAttr:function(b){this._createSourceNameMap(b).then(a.hitch(this,
function(a){this._sourceNames=a;this._created&&(this._setDefaultActiveSourceIndex(),this._hideMenus(),this._insertSources(b))}));this._set("sources",b)},_setAllPlaceholderAttr:function(a){this._set("allPlaceholder",a);this._created&&this._setPlaceholder(this.activeSourceIndex)},_setActiveSourceIndexAttr:function(a){this._set("activeSourceIndex",a);this._updateActiveSource();this._created&&(this._setPlaceholder(a),this._hideMenus(),this._insertSources(this.sources))},_setMaxLengthAttr:function(a){this._set("maxLength",
a);this._created&&n.set(this.inputNode,"maxLength",a)},_setValueAttr:function(a){this.set("magicKey",null);this._set("value",a);this._created&&(n.set(this.inputNode,"value",a),this._checkStatus())},_setVisibleAttr:function(a){this._set("visible",a);this._created&&this._updateVisible()},_setEnableButtonModeAttr:function(a){this._set("enableButtonMode",a);this._created&&this._updateButtonMode(a)},_setThemeAttr:function(a){this._created&&(q.remove(this.domNode,this.theme),q.add(this.domNode,a));this._set("theme",
a)}});return e("extend-esri")&&a.setObject("dijit.Search",l,D),l})},"esri/promiseList":function(){define(["dojo/_base/array","dojo/Deferred","dojo/when"],function(h,l,a){var d=h.forEach;return function(b){function f(a,b){g[b]=a;n.progress([a,b]);0===--q&&n.resolve(g)}var k,h;b instanceof Array?h=b:b&&"object"==typeof b&&(k=b);var g,e=[];if(k){h=[];for(var c in k)Object.hasOwnProperty.call(k,c)&&(e.push(c),h.push(k[c]));g={}}else h&&(g=[]);if(!h||!h.length)return(new l).resolve(g);var n=new l;n.promise.always(function(){g=
e=null});var q=h.length;return d(h,function(b,c){k||e.push(c);a(b,function(a){f(a,e[c])},function(a){f(a,e[c])})}),n.promise}})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),function(h,l,a,d,b,f,k,m,g,e,c){h=h(e,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],
"location-to-address-complete":["address"],"suggest-locations-complete":["suggestions"]},constructor:function(a){this._geocodeHandler=l.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=l.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=l.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},outSpatialReference:null,setOutSpatialReference:function(a){this.outSpatialReference=a},_geocodeHandler:function(a,b,d,e,f){try{var g,k,h,m=a.candidates;b=[];
var l=m.length,A=a.spatialReference;for(k=0;l>k;k++)g=m[k],(h=g.location)&&(h.spatialReference=A),b[k]=new c(g);this._successHandler([b],"onAddressToLocationsComplete",d,f)}catch(B){this._errorHandler(B,e,f)}},_geocodeAddressesHandler:function(a,b,d,e,f){try{var g,k,h=a.locations;b=[];var m=h.length,l=a.spatialReference;for(g=0;m>g;g++)(k=h[g].location)&&(k.spatialReference=l),b[g]=new c(h[g]);this._successHandler([b],"onAddressesToLocationsComplete",d,f)}catch(A){this._errorHandler(A,e,f)}},addressToLocations:function(a,
c,e,f,k){var h,w,x,y,z,A,B;a.address&&(f=e,e=c,c=a.outFields,k=a.searchExtent,B=a.countryCode,h=a.magicKey,w=a.distance,A=a.categories,a.location&&this.normalization&&(x=a.location.normalize()),y=a.maxLocations,z=a.forStorage,a=a.address);k&&(k=k.shiftCentralMeridian());var C=this.outSpatialReference;a=this._encode(l.mixin({},this._url.query,a,{f:"json",outSR:C&&b.toJson(C.toJson()),outFields:c&&c.join(",")||null,searchExtent:k&&b.toJson(k.toJson()),category:A&&A.join(",")||null,countryCode:B||null,
magicKey:h||null,distance:w||null,location:x||null,maxLocations:y||null,forStorage:z||null}));var D=this._geocodeHandler,E=this._errorHandler,F=new d(g._dfdCanceller);return F._pendingDfd=m({url:this._url.path+"/findAddressCandidates",content:a,callbackParamName:"callback",load:function(a,b){D(a,b,e,f,F)},error:function(a){E(a,f,F)}}),F},suggestLocations:function(a){var c;c=new d(g._dfdCanceller);a.hasOwnProperty("location")&&this.normalization&&(a.location=a.location.normalize());a.searchExtent&&
(a.searchExtent=a.searchExtent.shiftCentralMeridian());a=this._encode(l.mixin({},this._url.query,{f:"json",text:a.text,maxSuggestions:a.maxSuggestions,searchExtent:a.searchExtent&&b.toJson(a.searchExtent.toJson()),category:a.categories&&a.categories.join(",")||null,countryCode:a.countryCode||null,location:a.location||null,distance:a.distance||null},{f:"json"}));a=m({url:this._url.path+"/suggest",content:a,callbackParamName:"callback"});return c._pendingDfd=a,a.then(l.hitch(this,function(a){a=a.suggestions||
[];this.onSuggestLocationsComplete(a);c.resolve(a)}),l.hitch(this,function(a){this._errorHandler(a);c.reject(a)})),c},addressesToLocations:function(c,e,f){var k=this.outSpatialReference,h=[],t=c.categories,w=c.countryCode;a.forEach(c.addresses,function(a,b){h.push({attributes:a})});c=this._encode(l.mixin({},this._url.query,{category:t&&t.join(",")||null,sourceCountry:w||null},{addresses:b.toJson({records:h})},{f:"json",outSR:k&&b.toJson(k.toJson())}));var x=this._geocodeAddressesHandler,y=this._errorHandler,
z=new d(g._dfdCanceller);return z._pendingDfd=m({url:this._url.path+"/geocodeAddresses",content:c,callbackParamName:"callback",load:function(a,b){x(a,b,e,f,z)},error:function(a){y(a,f,z)}}),z},_reverseGeocodeHandler:function(a,b,d,e,f){try{var g=new c({address:a.address,location:a.location,score:100});this._successHandler([g],"onLocationToAddressComplete",d,f)}catch(k){this._errorHandler(k,e,f)}},locationToAddress:function(a,c,e,f){a&&this.normalization&&(a=a.normalize());var k=this.outSpatialReference;
a=this._encode(l.mixin({},this._url.query,{outSR:k&&b.toJson(k.toJson()),location:a&&b.toJson(a.toJson()),distance:c,f:"json"}));var h=this._reverseGeocodeHandler,w=this._errorHandler,x=new d(g._dfdCanceller);return x._pendingDfd=m({url:this._url.path+"/reverseGeocode",content:a,callbackParamName:"callback",load:function(a,b){h(a,b,e,f,x)},error:function(a){w(a,f,x)}}),x},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},onAddressesToLocationsComplete:function(){},
onLocationToAddressComplete:function(){}});return f("extend-esri")&&l.setObject("tasks.Locator",h,k),h})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(h,l,a,d,b){h=h(null,{declaredClass:"esri.tasks.AddressCandidate",constructor:function(a){l.mixin(this,a);this.location=new b(this.location)}});return a("extend-esri")&&l.setObject("tasks.AddressCandidate",h,d),h})},"esri/styles/basic":function(){define(["dojo/_base/array",
"dojo/_base/lang","dojo/has","../kernel","../Color"],function(h,l,a,d,b){function f(a,d){var e;if(a)switch(e={},e.color=new b(a.color),e.opacity=a.opacity||1,d){case "point":e.outline={color:new b(a.outline.color),width:a.outline.width};e.size=a.size;break;case "line":e.width=a.width;break;case "polygon":e.outline={color:new b(a.outline.color),width:a.outline.width}}return e}function k(a){return"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?a="point":"esriGeometryPolyline"===a?a="line":"esriGeometryPolygon"===
a&&(a="polygon"),a}var m={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm".split(" "),dark:["satellite","hybrid","dark-gray"]},pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,255,1],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,1],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,1],width:1},
size:8}]},dark:{primary:{color:[255,255,255,1],outline:{color:[26,26,26,1],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,1],width:1},size:8},{color:[26,26,26,1],outline:{color:[178,178,178,1],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,77,77,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[255,255,255,1],width:2}]},dark:{primary:{color:[255,255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,
139,79,1],outline:{color:[255,255,255,1],width:1},opacity:.8},secondary:[{color:[128,128,128,1],outline:{color:[255,255,255,1],width:1},opacity:.8},{color:[255,255,255,1],outline:{color:[128,128,128,1],width:1},opacity:.8}]},dark:{primary:{color:[227,139,79,1],outline:{color:[51,51,51,1],width:1},opacity:.8},secondary:[{color:[178,178,178,1],outline:{color:[51,51,51,1],width:1},opacity:.8},{color:[26,26,26,1],outline:{color:[128,128,128,1],width:1},opacity:.8}]}}}},g={};(function(){var a,b,d,e,f,
k,h,l;for(a in m)for(e in b=m[a],d=b.basemapGroups,f=g[a]={basemaps:[].concat(d.light).concat(d.dark),point:{},line:{},polygon:{}},d)for(k=d[e],h=0;h<k.length;h++)l=k[h],b.pointSchemes&&(f.point[l]=b.pointSchemes[e]),b.lineSchemes&&(f.line[l]=b.lineSchemes[e]),b.polygonSchemes&&(f.polygon[l]=b.polygonSchemes[e])})();var e={getAvailableThemes:function(a){var b,d,e,f=[];for(b in m)d=m[b],e=g[b],a&&-1===h.indexOf(e.basemaps,a)||f.push({name:d.name,label:d.label,description:d.description,basemaps:e.basemaps.slice(0)});
return f},getSchemes:function(a){var b,d,e=a.theme,m=a.basemap,l=k(a.geometryType);a=g[e];return b=a&&a[l],b=b&&b[m],b&&(d={primaryScheme:f(b.primary,l),secondarySchemes:h.map(b.secondary,function(a){return f(a,l)})}),d},cloneScheme:function(a){var d;return a&&(d=l.mixin({},a),d.color&&(d.color=new b(d.color)),d.outline&&(d.outline={color:d.outline.color&&new b(d.outline.color),width:d.outline.width})),d}};return a("extend-esri")&&l.setObject("styles.basic",e,d),e})},"esri/arcgis/utils":function(){define("require dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/on dojo/DeferredList dojo/dom-construct dojo/sniff ../kernel ../config ../lang ../request ../SpatialReference ../map ../urlUtils ../geometry/ScreenPoint ../geometry/Extent ../geometry/webMercatorUtils ../symbols/jsonUtils ../renderers/jsonUtils ../dijit/PopupTemplate ../dijit/Popup ../tasks/query ../tasks/GeometryService ../layers/ArcGISTiledMapServiceLayer ../layers/FeatureLayer dojo/i18n!../nls/jsapi".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K){function J(a){return u({url:xa.arcgisUrl+"/"+a.itemId+"/data",content:{f:"json"},callbackParamName:"callback"},{disableIdentityLookup:!0,_preLookup:!0})}function I(a,b){var c={f:"json"};b&&(c.token=b);return u({url:a,content:c,callbackParamName:"callback"},{disableIdentityLookup:!0})}function L(a){!a.layerDefinition||a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.labelingInfo||(a.showLabels=!1);a.itemProperties.layerDefinition&&
(a.layerDefinition?(a.layerDefinition.drawingInfo||(a.layerDefinition.drawingInfo=a.itemProperties.layerDefinition.drawingInfo),r.isDefined(a.layerDefinition.definitionExpression)||(a.layerDefinition.definitionExpression=a.itemProperties.layerDefinition.definitionExpression),r.isDefined(a.layerDefinition.minScale)||(a.layerDefinition.minScale=a.itemProperties.layerDefinition.minScale),r.isDefined(a.layerDefinition.maxScale)||(a.layerDefinition.maxScale=a.itemProperties.layerDefinition.maxScale)):
a.layerDefinition=a.itemProperties.layerDefinition);!a.itemProperties.popupInfo||a.popupInfo||a.disablePopup||(a.popupInfo=a.itemProperties.popupInfo);r.isDefined(a.itemProperties.showLabels)&&!r.isDefined(a.showLabels)&&(a.showLabels=a.itemProperties.showLabels);r.isDefined(a.itemProperties.showLegend)&&!r.isDefined(a.showLegend)&&(a.showLegend=a.itemProperties.showLegend);r.isDefined(a.itemProperties.refreshInterval)&&!r.isDefined(a.refreshInterval)&&(a.refreshInterval=a.itemProperties.refreshInterval)}
function M(a){L(a);a.itemProperties.layerDefinition&&a.layerDefinition&&(!r.isDefined(a.layerDefinition.maximumTrackPoints)&&r.isDefined(a.itemProperties.layerDefinition.maximumTrackPoints)&&(a.layerDefinition.maximumTrackPoints=a.itemProperties.layerDefinition.maximumTrackPoints),!a.layerDefinition.definitionGeometry&&a.itemProperties.layerDefinition.definitionGeometry&&(a.layerDefinition.definitionGeometry=a.itemProperties.layerDefinition.definitionGeometry));a.itemProperties.purgeOptions&&!a.purgeOptions&&
(a.purgeOptions=a.itemProperties.purgeOptions)}function N(c,d){var e=new b,f=c.itemData,k=[],h=[];if(a.forEach(f.operationalLayers,function(a){if(a.itemId&&!a.type){var b=a.url.toLowerCase();-1<b.indexOf("/featureserver")||-1<b.indexOf("/mapserver/")?(h.push(a),k.push(J(a))):-1<b.indexOf("/mapserver")&&-1===b.indexOf("/mapserver/")&&(!a.layers||!r.isDefined(a.minScale)&&!r.isDefined(a.maxScale))?(h.push(a),k.push(J(a))):-1<b.indexOf("/imageserver")&&!r.isDefined(a.minScale)&&!r.isDefined(a.maxScale)?
(h.push(a),k.push(J(a))):-1<b.indexOf("/streamserver")&&(h.push(a),k.push(J(a)))}}),f.baseMap&&f.baseMap.baseMapLayers&&a.forEach(f.baseMap.baseMapLayers,function(a){a.itemId&&"VectorTileLayer"!==a.layerType&&(h.push(a),k.push(J(a)))}),0<k.length){var m={};(new g(k)).addCallback(function(b){a.forEach(h,function(c,d){var e=b[d][1];if(e&&!(e instanceof Error)&&(m[c.itemId]=e,!c.type)){var f=c.url.toLowerCase();(-1<f.indexOf("/featureserver")||-1<f.indexOf("/mapserver/"))&&e.layers?a.forEach(e.layers,
function(a){var b="/featureserver/"+a.id;(b=f.match(b+"$")==b)||(b="/mapserver/"+a.id,b=f.match(b+"$")==b);b&&(c.itemProperties=a,L(c))}):-1<f.indexOf("/streamserver")?(c.itemProperties=e,M(c)):-1<f.indexOf("/mapserver")?(e.layers&&!c.layers&&(c.layers=e.layers),r.isDefined(e.minScale)&&!r.isDefined(c.minScale)&&(c.minScale=e.minScale),r.isDefined(e.maxScale)&&!r.isDefined(c.maxScale)&&(c.maxScale=e.maxScale),r.isDefined(e.refreshInterval)&&!r.isDefined(c.refreshInterval)&&(c.refreshInterval=e.refreshInterval),
e.visibleLayers&&!c.visibleLayers&&(c.visibleLayers=e.visibleLayers)):-1<f.indexOf("/imageserver")&&(r.isDefined(e.minScale)&&!r.isDefined(c.minScale)&&(c.minScale=e.minScale),r.isDefined(e.maxScale)&&!r.isDefined(c.maxScale)&&(c.maxScale=e.maxScale),r.isDefined(e.refreshInterval)&&!r.isDefined(c.refreshInterval)&&(c.refreshInterval=e.refreshInterval),!e.popupInfo||c.popupInfo||c.disablePopup||(c.popupInfo=e.popupInfo),e.renderingRule&&!c.renderingRule&&(c.renderingRule=e.renderingRule,e.renderingRule.functionName&&
(c.renderingRule.rasterFunction=e.renderingRule.functionName)),e.bandIds&&!c.bandIds&&(c.bandIds=e.bandIds),e.mosaicRule&&!c.mosaicRule&&(c.mosaicRule=e.mosaicRule),e.format&&!c.format&&(c.format=e.format),r.isDefined(e.compressionQuality)&&!r.isDefined(c.compressionQuality)&&(c.compressionQuality=e.compressionQuality),!e.layerDefinition||!e.layerDefinition.definitionExpression||r.isDefined(c.layerDefinition)&&r.isDefined(c.layerDefinition.definitionExpression)||(c.layerDefinition=c.layerDefinition||
{},c.layerDefinition.definitionExpression=e.layerDefinition.definitionExpression))}});c.relatedItemsData=m;e.callback(c)})}else e.callback(c);return e}function Q(a,c){var e=new b,f=a.itemData,g=f.baseMap.baseMapLayers[0];if("BingMapsAerial"===g.type||"BingMapsRoad"===g.type||"BingMapsHybrid"===g.type)if(g.portalUrl&&n.id)delete c.bingMapsKey,n.id.checkSignInStatus(w.urlToObject(xa.arcgisUrl).path).then(l.hitch(null,function(a,b,c,d,e){I(g.portalUrl,e.token).then(l.hitch(null,T,a,b,c,d),l.hitch(null,
S,a,b,c,d))},a,c,f,e),l.hitch(null,function(a,b,c,d,e){I(g.portalUrl).then(l.hitch(null,T,a,b,c,d),l.hitch(null,S,a,b,c,d))},a,c,f,e));else if(c.bingMapsKey){var k=new Va({bingMapsKey:c.bingMapsKey,mapStyle:Va.MAP_STYLE_AERIAL});d.connect(k,"onLoad",l.hitch(this,function(){e.callback([a,c])}));d.connect(k,"onError",function(b){delete c.bingMapsKey;a.itemData=R(f);g=a.itemData.baseMap.baseMapLayers[0];g.errors=[];g.errors.push({message:"The owner of the application has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});
e.callback([a,c])})}else a.itemData=R(f),g=a.itemData.baseMap.baseMapLayers[0],g.errors=[],g.errors.push({message:"The owner of the application has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."}),e.callback([a,c]);else e.callback([a,c]);return e}function O(a){var c,d,e=new b;a=a.itemData;var f=a.baseMap&&a.baseMap.baseMapLayers;if(qb&&!qb.supported())for(a=0;a<f.length;a++){var g=f[a];if(!g.isReference){"VectorTileLayer"===g.layerType&&(c=g.itemId,d=a);break}}return c?
ia(c,!1).addBoth(function(a){var b=/^https?:\/\/basemaps(dev)?\.arcgis\.com\/arcgis\/rest\/services\/World_Basemap\/VectorTileServer/i;a&&a.item&&b.test(a.item.url)&&(f[d]={id:"FB_"+g.id,layerType:"ArcGISTiledMapServiceLayer",opacity:"opacity"in g?g.opacity:1,visibility:"visibility"in g?g.visibility:!0,url:"http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer"});e.resolve()}):e.resolve(),e}function T(a,b,c,e,f){f.bingKey?(b.bingMapsKey=f.bingKey,f=new Va({bingMapsKey:b.bingMapsKey,
mapStyle:Va.MAP_STYLE_AERIAL}),d.connect(f,"onLoad",l.hitch(this,function(){e.callback([a,b])})),d.connect(f,"onError",function(d){delete b.bingMapsKey;a.itemData=R(c);d=a.itemData.baseMap.baseMapLayers[0];d.errors=[];d.errors.push({message:"The owner of the map has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});e.callback([a,b])})):S(a,b,c,e)}function S(a,b,c,d){delete b.bingMapsKey;a.itemData=R(c);c=a.itemData.baseMap.baseMapLayers[0];c.errors=[];c.errors.push({message:"The owner of the map has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."});
d.callback([a,b])}function R(a){return"BingMapsAerial"===a.baseMap.baseMapLayers[0].type?a.baseMap={title:"Imagery",baseMapLayers:[{id:"World_Imagery_2017",visibility:!0,opacity:1,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]}:"BingMapsRoad"===a.baseMap.baseMapLayers[0].type?a.baseMap={title:"Streets",baseMapLayers:[{id:"World_Street_Map_8421",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]}:a.baseMap=
{title:"Imagery with Labels",baseMapLayers:[{id:"World_Imagery_6611",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{id:"World_Boundaries_and_Places_1145",isReference:!0,opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer"}]},a}function U(b,c,d,e){var f=b.dynamicLayerInfos||b.layerInfos,g=c.layers;if(g&&f)if(e.usePopupManager){var k;a.forEach(f,function(a){var b=
a.id;if(!a.subLayerIds)for(a=0;a<g.length;a++){var c=g[a];if(c.id===b&&c.popupInfo){k||(k={});k[b]={infoTemplate:new d(c.popupInfo),layerUrl:c.layerUrl};break}}});k&&b.setInfoTemplates(k)}else{var h=[],m=[],l=[],n=[],q=[],u=[];a.forEach(f,function(c){var d=c.id;if(!c.subLayerIds&&-1!==a.indexOf(b.visibleLayers,d))for(c=0;c<g.length;c++){var e=g[c];if(e.id===d){m.push(d);h.push(e.popupInfo);l.push(e.layerUrl||"");e.layerDefinition&&e.layerDefinition.definitionExpression?n.push(e.layerDefinition.definitionExpression):
n.push("");q.push(r.isDefined(e.minScale)?e.minScale:null);u.push(r.isDefined(e.maxScale)?e.maxScale:null);break}}});h.length&&(b.__popups=h,b.__popupIds=m,b.__popupUrls=l,b.__popupWhereClauses=n,b.__popupMinScales=q,b.__popupMaxScales=u,b.__resourceInfo=c.resourceInfo)}}function W(a){if(!a)return!1;var b=(new k(xa.arcgisUrl)).authority;return-1!==a.indexOf(".arcgis.com/")||-1!==a.indexOf(b)}function fa(a){return a?-1!==a.indexOf("/services.arcgisonline.com/")||-1!==a.indexOf("/server.arcgisonline.com/"):
!1}function ea(a){return"https:"===location.protocol&&(W(a)||fa(a))&&(a=a.replace("http:","https:")),a}function oa(b,c,d){var e,f=[];b.displayLevels||(f=a.map(b.resourceInfo.tileInfo.lods,function(a){return a.level}));b.exclusionAreas&&(e=l.clone(b.exclusionAreas),e=a.map(e,function(a){return a.geometry=new y(a.geometry),a}));e=new H(ea(b.url),{resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,displayLevels:b.displayLevels||f,id:b.id,minScale:b.minScale,maxScale:b.maxScale,refreshInterval:b.refreshInterval,
exclusionAreas:e});return d.ignorePopups||U(e,b,c,d),e}function pa(a,b){if(!a||!b||0===b.length)return[];var c,d=","+b+",",e=[],f=",";for(c=0;c<a.length;c++)null!==a[c].subLayerIds?(-1===d.indexOf(","+a[c].id+",")||-1<f.indexOf(","+a[c].id+","))&&(f+=a[c].subLayerIds.toString()+","):-1<d.indexOf(","+a[c].id+",")&&-1===f.indexOf(","+a[c].id+",")&&e.push(a[c].id);return e}function Aa(b,c,d){var e=new da;e.format="png24";b.resourceInfo&&b.resourceInfo.supportedImageFormatTypes&&-1<b.resourceInfo.supportedImageFormatTypes.indexOf("PNG32")&&
(e.format="png32");var e=new X(ea(b.url),{resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,id:b.id,imageParameters:e,minScale:b.minScale,maxScale:b.maxScale,refreshInterval:b.refreshInterval}),f=b.visibleLayers;if(!b.visibleLayers){var g="";a.forEach(e.layerInfos,function(a){a.defaultVisibility&&(g+=(0<g.length?",":"")+a.id)});f=g}if(b.layers&&0<b.layers.length){var k,h,m,n=[],q=[],r=[];a.forEach(b.layers,function(c){if(c.layerDefinition&&c.layerDefinition.definitionExpression&&
(n[c.id]=c.layerDefinition.definitionExpression),c.layerDefinition&&c.layerDefinition.source){if(k=null,m=c.layerDefinition.source,"mapLayer"===m.type){var d=a.filter(b.resourceInfo.layers,function(a){return a.id===m.mapLayerId});d.length&&(k=l.mixin(d[0],c))}else k=l.mixin({},c);if(k){if(k.source=m,delete k.popupInfo,k=new na(k),b.visibleLayers)d="string"==typeof b.visibleLayers?b.visibleLayers.split(","):b.visibleLayers,-1<a.indexOf(d,c.id)?k.defaultVisibility=!0:k.defaultVisibility=!1;q.push(k)}}c.layerDefinition&&
c.layerDefinition.source&&c.layerDefinition.drawingInfo&&(h=new gb(c.layerDefinition.drawingInfo),r[c.id]=h)},this);0<n.length&&e.setLayerDefinitions(n);0<q.length?(e.setDynamicLayerInfos(q,!0),0<r.length&&e.setLayerDrawingOptions(r,!0)):(f=pa(e.layerInfos,f),e.setVisibleLayers(f))}else f=pa(e.layerInfos,f),e.setVisibleLayers(f);return d.ignorePopups||U(e,b,c,d),e}function ta(a,b,c){var d=new V;if(d.bandIds=a.bandIds,null!=a.format&&(d.format=a.format,null!=a.compressionQuality&&(d.compressionQuality=
a.compressionQuality)),a.renderingRule&&a.renderingRule.rasterFunction){var e=new ib(a.renderingRule);d.renderingRule=e}a.mosaicRule&&(e=new xb(a.mosaicRule),d.mosaicRule=e);r.isDefined(a.noData)&&(d.noData=a.noData);r.isDefined(a.noDataInterpretation)&&(d.noDataInterpretation=a.noDataInterpretation);r.isDefined(a.interpolation)&&(d.interpolation=a.interpolation);e=a.layerType?"ArcGISImageServiceVectorLayer"===a.layerType:!1;r.isDefined(a.layerType)||(e=a.resourceInfo.hasMultidimensions&&("esriImageServiceDataTypeVector-UV"===
a.resourceInfo.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===a.resourceInfo.serviceDataType));d={resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,id:a.id,imageServiceParameters:d,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval};if(d=e?new P(ea(a.url),d):new ma(ea(a.url),d),a.layerDefinition)a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&(e=B.fromJson(a.layerDefinition.drawingInfo.renderer),d.setRenderer(e)),a.layerDefinition.definitionExpression&&
d.setDefinitionExpression(a.layerDefinition.definitionExpression,!0);return!c.ignorePopups&&a.popupInfo&&d.setInfoTemplate(new b(a.popupInfo)),d}function va(b,c,d){var e=[102113,102100,3857],f=d||new v(c[0].layerObject.fullExtent.spatialReference),g=new v(b.resourceInfo.fullExtent.spatialReference);return f.wkt==g.wkt&&(f.wkid==g.wkid||r.isDefined(f.latestWkid)&&f.latestWkid==g.wkid||r.isDefined(g.latestWkid)&&f.wkid==g.latestWkid||r.isDefined(f.latestWkid)&&f.latestWkid==g.latestWkid)?!0:f.wkid&&
g.wkid&&a.some(e,function(a){return a===g.wkid})&&a.some(e,function(a){return a===f.wkid})?!0:!1}function ua(a,b,c){if(!b[0].layerObject.tileInfo)return!1;a=a.resourceInfo.tileInfo;b=b[0].layerObject.tileInfo;c=c.width>c.height?c.width:c.height;for(var d=!1,e=!1,f=0;f<a.lods.length;f++){for(var g=a.lods[f].scale/a.dpi,k=0;k<b.lods.length;k++){var h=b.lods[k].scale/b.dpi;if(Math.abs(h-g)/h<1/c){if(d){e=!0;break}d=!0}}if(e)break}return e?!0:!d||1!==a.lods.length&&1!==b.lods.length?!1:!0}function qa(b,
c,e,g,k,h){var q,u,t=e._clazz;if("OpenStreetMap"===b.type)q=new Jb({id:b.id,opacity:b.opacity,visible:null!==b.visibility&&void 0!==b.visibility?b.visibility:!0});else if("WFS"===b.type)g={customParameters:b.wfsInfo.customParameters,geometryType:b.layerDefinition.geometryType,id:b.id,labelingInfo:b.layerDefinition.drawingInfo.labelingInfo,maxFeatures:b.wfsInfo.maxFeatures,mode:b.mode,name:b.wfsInfo.name,showLabels:!0,swapXY:b.wfsInfo.swapXY,title:b.title,url:b.url,version:b.wfsInfo.version,visible:b.visibility,
wkid:b.layerDefinition.spatialReference.wkid},q=new Xa,q.fromJson(g,function(){r.isDefined(b.opacity)&&q.setOpacity(b.opacity);r.isDefined(b.visibility)&&q.setVisibility(b.visibility);(b.minScale||b.maxScale)&&q.setScaleRange(b.minScale,b.maxScale);q.renderer=B.fromJson(b.layerDefinition.drawingInfo.renderer);!e.ignorePopups&&b.popupInfo&&q.setInfoTemplate(new t(b.popupInfo));q.emit("fromJsonComplete")});else if("WMS"===b.type){var x=[],z=[];a.forEach(b.layers,function(a){z.push(new Pb({name:a.name,
title:a.title,legendURL:a.legendURL,queryable:a.queryable,showPopup:a.showPopup}));x.push(a.name)},this);b.visibleLayers&&(x=b.visibleLayers);g=new y(b.extent[0][0],b.extent[0][1],b.extent[1][0],b.extent[1][1],new v({wkid:4326}));g={customLayerParameters:b.customLayerParameters,customParameters:b.customParameters,extent:g,layerInfos:z,version:b.version,maxWidth:b.maxWidth,maxHeight:b.maxHeight,featureInfoFormat:b.featureInfoFormat,getFeatureInfoURL:b.featureInfoUrl,getMapURL:b.mapUrl,spatialReferences:b.spatialReferences,
title:b.title,copyright:b.copyright,minScale:b.minScale||0,maxScale:b.maxScale||0,format:b.format};q=new bb(b.url,{id:b.id,visibleLayers:x,format:"png",transparent:b.firstLayer?!1:!0,opacity:b.opacity,visible:null!==b.visibility?b.visibility:!0,resourceInfo:g,refreshInterval:b.refreshInterval});q.spatialReference.wkid=g.spatialReferences[0]}else if("KML"===b.type){if(u=b.url,n.id){var D=n.id.findCredential(w.urlToObject(xa.arcgisUrl).path);if(D){var E=xa.arcgisUrl.substring(xa.arcgisUrl.indexOf("//")+
2,xa.arcgisUrl.indexOf("/",xa.arcgisUrl.indexOf("//")+3));c=E.split(".");c=c[c.length-2]+"."+c[c.length-1];k=u.indexOf(c);-1<k&&(u="https://"+E+u.substring(k+c.length),u+="?token\x3d"+D.token)}}q=new rb(u,{id:b.id,visible:null!==b.visibility?b.visibility:!0,outSR:g,refreshInterval:b.refreshInterval});d.connect(q,"onLoad",function(){(b.opacity||0===b.opacity)&&q.setOpacity(b.opacity);r.isDefined(b.minScale)&&r.isDefined(b.maxScale)&&q.setScaleRange(b.minScale,b.maxScale);b.visibleFolders&&a.forEach(q.folders,
function(c){-1<a.indexOf(b.visibleFolders,c.id)?q.setFolderVisibility(c,!0):q.setFolderVisibility(c,!1)},this)})}else if("WebTiledLayer"===b.type)q=new Nb(b.templateUrl,{id:b.id,visible:null!==b.visibility?b.visibility:!0,opacity:b.opacity,copyright:b.copyright,fullExtent:b.fullExtent&&new y(b.fullExtent),initialExtent:b.fullExtent&&new y(b.fullExtent),subDomains:b.subDomains,tileInfo:b.tileInfo?new Mb(b.tileInfo):null,refreshInterval:b.refreshInterval,wmtsInfo:b.wmtsInfo}),d.connect(q,"onLoad",function(){(r.isDefined(b.minScale)||
r.isDefined(b.maxScale))&&q.setScaleRange(b.minScale,b.maxScale)});else if("GeoRSS"===b.type)q=new ba(b.url,{id:b.id,opacity:b.opacity,outSpatialReference:g,refreshInterval:b.refreshInterval}),d.connect(q,"onLoad",function(){!1===b.visibility&&q.hide();r.isDefined(b.minScale)&&r.isDefined(b.maxScale)&&q.setScaleRange(b.minScale,b.maxScale);var c=q.getFeatureLayers();a.forEach(c,function(a){b.pointSymbol&&"esriGeometryPoint"===a.geometryType?(a.renderer.symbol=A.fromJson(b.pointSymbol),1===c.length&&
(q.pointSymbol=A.fromJson(b.pointSymbol))):b.lineSymbol&&"esriGeometryPolyline"===a.geometryType?(a.renderer.symbol=A.fromJson(b.lineSymbol),1===c.length&&(q.polylineSymbol=A.fromJson(b.lineSymbol))):b.polygonSymbol&&"esriGeometryPolygon"===a.geometryType&&(a.renderer.symbol=A.fromJson(b.polygonSymbol),1===c.length&&(q.polygonSymbol=A.fromJson(b.polygonSymbol)))})});else if("CSV"==b.type&&b.url)g={layerDefinition:b.layerDefinition,columnDelimiter:b.columnDelimiter,id:b.id?b.id:null,visible:null!==
b.visibility?b.visibility:!0,opacity:b.opacity,refreshInterval:b.refreshInterval},b.locationInfo&&(g.latitudeFieldName=b.locationInfo.latitudeFieldName,g.longitudeFieldName=b.locationInfo.longitudeFieldName),e.ignorePopups||(g.infoTemplate=new C(b.popupInfo?b.popupInfo:ha.generateDefaultPopupInfo(b))),q=new ga(b.url,g);else if("VectorTileLayer"===b.layerType&&b.styleUrl)q=new qb(b.styleUrl,{id:b.id,minScale:b.minScale,maxScale:b.maxScale,opacity:b.opacity,visible:b.visibility});else if(b.layerDefinition&&
!b.url)g=f.fromJson(f.toJson(b)),delete g.id,delete g.opacity,delete g.visibility,q=new G(g,{id:b.id,opacity:b.opacity,visible:b.visibility,outFields:["*"],autoGeneralize:!0}),!e.ignorePopups&&g.popupInfo&&q.setInfoTemplate(new t(g.popupInfo)),ka(q);else if("BingMapsAerial"===b.type||"BingMapsRoad"===b.type||"BingMapsHybrid"===b.type)e.bingMapsKey?(g=Va.MAP_STYLE_AERIAL_WITH_LABELS,"BingMapsAerial"===b.type?g=Va.MAP_STYLE_AERIAL:"BingMapsRoad"===b.type&&(g=Va.MAP_STYLE_ROAD),q=new Va({bingMapsKey:e.bingMapsKey,
mapStyle:g,opacity:b.opacity,id:b.id}),d.connect(q,"onError",l.hitch(this,function(a){a.errors=a.errors||[];a.errors.push({message:"This application does not have a valid Bing Key for the Bing layer that is included in this map. [type:"+a.type+"]"})},b))):(b.errors=b.errors||[],b.errors.push({message:"This application does not provide a Bing Key for the Bing layer that is included in this map. [type:"+b.type+"]"}));else if(b.resourceInfo&&b.resourceInfo.mapName)q=!0===b.resourceInfo.singleFusedMapCache&&
(b.baseMapLayer||va(b,c,g)&&ua(b,k,h))?oa(b,t,e):Aa(b,t,e);else if(b.resourceInfo&&b.resourceInfo.pixelSizeX)q=!0===b.resourceInfo.singleFusedMapCache&&(b.baseMapLayer||va(b,c,g)&&ua(b,k,h))?oa(b,t,e):ta(b,t,e);else if(b.resourceInfo&&"Feature Layer"===b.resourceInfo.type){if(b.capabilities&&(b.resourceInfo.capabilities=b.capabilities),q=new G(ea(b.url),{resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,id:b.id,mode:b.mode===G.MODE_SELECTION?G.MODE_SELECTION:G.MODE_AUTO,editable:!1===
e.editable?!1:void 0,outFields:["*"],autoGeneralize:!0,refreshInterval:b.refreshInterval}),!e.ignorePopups&&b.popupInfo&&q.setInfoTemplate(new t(b.popupInfo)),b.layerDefinition)b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.renderer&&(g=B.fromJson(b.layerDefinition.drawingInfo.renderer),g.isMaxInclusive=!0,q.setRenderer(g)),b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.labelingInfo&&(g=a.map(b.layerDefinition.drawingInfo.labelingInfo,function(a){return new hb(a)}),q.setLabelingInfo(g)),
b.layerDefinition.definitionExpression&&q.setDefinitionExpression(b.layerDefinition.definitionExpression),r.isDefined(b.layerDefinition.minScale)&&q.setMinScale(b.layerDefinition.minScale),r.isDefined(b.layerDefinition.maxScale)&&q.setMaxScale(b.layerDefinition.maxScale);ka(q)}else b.resourceInfo&&b.resourceInfo.streamUrls&&(g={resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,id:b.id},b.layerDefinition&&(D=b.layerDefinition.drawingInfo,b.layerDefinition.definitionGeometry&&(u=u||
{},u.geometry=b.layerDefinition.definitionGeometry),r.isDefined(b.layerDefinition.definitionExpression)&&(u=u||{},u.where=b.layerDefinition.definitionExpression),r.isDefined(b.layerDefinition.maximumTrackPoints)&&(g.maximumTrackPoints=b.layerDefinition.maximumTrackPoints)),u&&(g.filter=u),b.purgeOptions&&(g.purgeOptions=b.purgeOptions),q=new jb(ea(b.url),g),D&&D.renderer&&(E=D.renderer,q.setRenderer(B.fromJson(E))),!e.ignorePopups&&b.popupInfo&&q.setInfoTemplate(new t(b.popupInfo)),b.layerDefinition&&
(r.isDefined(b.layerDefinition.minScale)&&q.setMinScale(b.layerDefinition.minScale),r.isDefined(b.layerDefinition.maxScale)&&q.setMaxScale(b.layerDefinition.maxScale)),m.once(q,"error",function(a){b.errors.push({message:"Error loading stream layer. Check websocket url"})}));return q&&(q.arcgisProps={title:b.title},b.baseMapLayer&&(b.isReference?(q.attr("data-reference",!0),q._basemapGalleryLayerType="reference"):q._basemapGalleryLayerType="basemap")),q}function ca(b,c,d,e,f){a.forEach(b,function(a){a.layerObject=
qa(a,b,c,d,e,f)});var g=a.filter(b,function(a){return!a.isReference}),k=a.filter(b,function(a){return!!a.isReference});return b=g.concat(k)}function ja(a){var b=null;a=a[0];return a.url&&!a.type?a.resourceInfo.spatialReference&&(b=new v,a.resourceInfo.spatialReference.wkid&&(b.wkid=a.resourceInfo.spatialReference.wkid),a.resourceInfo.spatialReference.wkt&&(b.wkt=a.resourceInfo.spatialReference.wkt)):a.type&&(-1<a.type.indexOf("BingMaps")||"OpenStreetMap"==a.type?b=new v({wkid:102100}):"WMS"==a.type&&
(b=new v({wkid:a.spatialReferences[0]}))),b}function la(b,c,d,e,f,g,k,h){return a.forEach(c,function(a){a.url&&!a.type&&(a.resourceInfo=b[a.deferredsPos][1],delete a.deferredsPos)}),g=g||ja(c),c=ca(c,d,g,k,h),f.callback(c),f}function ka(a){!window.CanvasRenderingContext2D&&a.renderer&&"esri.renderer.HeatmapRenderer"===a.renderer.declaredClass&&a.setRenderer(B.fromJson({type:"simple",symbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,
255,255,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}}}))}function sa(a,b){var c=ea(a);return u({url:c,content:{f:"json"},callbackParamName:"callback",error:function(a,d){a.message?a.message+=" [url:"+c+"]":a.message="[url:"+c+"]";b.push(a);q.defaults.io.errorHandler(a,d)}})}function Ea(a){var b=xa.arcgisUrl+"/"+a.itemId+"/data";return u({url:b,content:{f:"json"},callbackParamName:"callback",error:function(c,d){c.message?c.message+=" [url:"+b+"]":c.message="[url:"+b+"]";a.errors=a.errors||[];
a.errors.push(c);q.defaults.io.errorHandler(c,d)}})}function ra(c,d,e){var g=new b;return e.featureCollection&&e.featureCollection.layers||e.layers?(e.layers&&(e.featureCollection={layers:e.layers},delete e.layers,r.isDefined(e.showLegend)&&(e.featureCollection.showLegend=e.showLegend,delete e.showLegend)),za(c,e.featureCollection,d).then(function(b){e.featureCollection=b;c.featureCollection&&c.featureCollection.layers?a.forEach(e.featureCollection.layers,function(a,b){var d=c.featureCollection.layers[b];
d.popupInfo||d.layerDefinition?d.layerDefinition?(r.isDefined(d.layerDefinition.minScale)&&r.isDefined(d.layerDefinition.maxScale)&&(d.layerDefinition.minScale!==a.layerDefinition.minScale||d.layerDefinition.maxScale!==a.layerDefinition.maxScale)&&(delete a.layerDefinition.minScale,delete a.layerDefinition.maxScale),d.layerDefinition.drawingInfo&&f.toJson(d.layerDefinition.drawingInfo)!==f.toJson(a.layerDefinition.drawingInfo)&&delete a.layerDefinition.drawingInfo,d.layerDefinition.showLegend!==a.layerDefinition.showLegend&&
delete a.layerDefinition.showLegend,d.layerDefinition=l.mixin(d.layerDefinition,a.layerDefinition)):d.layerDefinition=a.layerDefinition:(d.popupInfo=a.popupInfo,d.layerDefinition=a.layerDefinition);d.featureSet=a.featureSet;d.nextObjectId=a.nextObjectId}):(c.featureCollection=c.featureCollection||{},c.featureCollection=l.mixin(c.featureCollection,e.featureCollection));g.callback(c)}),g):(c.errors=c.errors||[],c.errors.push({message:"Invalid Feature Collection item data. [item id: "+c.itemId+"]"}),
g.errback(),g)}function za(c,d,e){var f=new b;return h(["./csv"],function(b){var k=[];a.forEach(d.layers,function(a){a.featureSet&&a.featureSet.features&&a.featureSet.features.length&&a.featureSet.features[0].geometry&&a.featureSet.features[0].geometry.spatialReference&&(a.deferredsPos=k.length,k.push(b.projectFeatureCollection(a,e,a.featureSet.features[0].geometry.spatialReference)))});(new g(k)).addCallback(function(){a.forEach(d.layers,function(a){r.isDefined(a.deferredsPos)&&(k[a.deferredsPos].results&&
k[a.deferredsPos].results.length?a=k[a.deferredsPos].results[0]:(a.errors=a.errors||[],a.errors.push({message:"Errors projecting feature collection. ["+c.title+" - "+a.layerDefinition.name+"]"})),delete a.deferredsPos)});f.callback(d)})}),f}function wa(c,d,e,f,k){var n,q=new b,r=new b,u=[];return a.forEach(c.operationalLayers,function(a){a.itemId&&"Feature Collection"==a.type&&u.push(Ea(a).then(l.hitch(null,ra,a,e)))}),0===u.length?Ha(c,d,e,f,r,k):(n=new g(u),n.addCallback(function(a){Ha(c,d,e,f,
r,k)})),r.then(function(c){if(u=[],a.forEach(c,function(a){var c;a=a.layerObject;a instanceof G&&!a.loaded&&!a.loadError?(c=new b,m.once(a,"load, error",function(){c.callback(a)}),u.push(c)):a&&"esri.layers.WFSLayer"===a.declaredClass&&!a.loadError&&(c=new b,m.once(a,"fromJsonComplete, error",function(b){c.callback(a)}),u.push(c))}),u.length){var d=new b;return n=new g(u),n.addCallback(function(){d.callback(c)}),d.promise}return c}).then(function(b){var c=[];a.forEach(b,function(a){var b=a.layerObject;
b instanceof G?b.loaded&&b.labelingInfo&&(a.showLabels||b._collection)&&c.push(b):b&&"esri.layers.WFSLayer"===b.declaredClass&&b.loaded&&b.labelingInfo&&c.push(b)});c.length?h(["../layers/LabelLayer"],function(d){var e=new d;a.forEach(c,function(a){e.addFeatureLayer(a)});b.push({layerObject:e});q.callback(b)}):q.callback(b)}),q}function Ha(b,c,d,e,f,k){var h=[],m=[],l=[];(a.forEach(b.operationalLayers,function(b,c){if(b.featureCollection&&b.featureCollection.layers){var d=b.featureCollection.layers.length;
a.forEach(b.featureCollection.layers,function(e,f){var g=!0;b.visibleLayers&&-1==a.indexOf(b.visibleLayers,f)&&(g=!1);e.visibility=b.visibility&&g;e.opacity=b.opacity;e.id=(b.id||"operational"+c)+"_"+f;b.title&&(1!==d&&e.layerDefinition.name&&b.title!==e.layerDefinition.name?e.title=b.title+" - "+e.layerDefinition.name:e.title=b.title);l.push(e)},this)}else l.push(b)}),a.forEach(b.baseMap.baseMapLayers,function(a,b){a.baseMapLayer=!0;a.id=a.id||"base"+b;h.push(a)}),a.forEach(l,function(a,b){a.id=
a.id||"operational"+b;h.push(a)}),a.forEach(h,function(a){a.url&&!a.type&&(a.deferredsPos=m.length,a.errors=a.errors||[],m.push(sa(a.url,a.errors)))}),0===m.length)?(d=d||ja(h),h=ca(h,c,d,e,k),f.callback(h)):(new g(m)).addCallback(function(a){la(a,h,c,m,f,d,e,k)});return f}function Ga(b,c,d,e){var f=b.minScale,g=b.maxScale;if(10.1>=d.version&&c)for(b=c.length-1;0<=b;b--){if(c[b].id==e){if(0==f&&0<c[b].minScale?f=c[b].minScale:0<f&&0==c[b].minScale?f=d.minScale:0<f&&0<c[b].minScale&&(f=Math.min(f,
c[b].minScale)),g=Math.max(d.maxScale||0,c[b].maxScale||0),d.setScaleRange(f,g),!(-1<c[b].parentLayerId))break;e=c[b].parentLayerId}}else 10.1<d.version&&(a.forEach(b.layerInfos,function(a){a.id==e&&(0==f&&0<a.minScale?f=a.minScale:0<f&&0==a.minScale||0<f&&0<a.minScale&&(f=Math.min(f,a.minScale)),g=Math.max(g||0,a.maxScale||0))}),d.setScaleRange(f,g))}function Ca(b,c,e,f){var g=b.url,k=b.__popupIds,h=b.__popupUrls,m=b.__popupWhereClauses,n=b.__popupMinScales,q=b.__popupMaxScales,u=b.__resourceInfo,
t=[];if(a.forEach(b.__popups,function(f,l){if(f){var v,w=[];if(a.forEach(f.fieldInfos,function(a){"shape"!==a.fieldName.toLowerCase()&&w.push(a.fieldName)}),b.dynamicLayerInfos&&0<b.dynamicLayerInfos.length){var x=a.filter(b.dynamicLayerInfos,function(a){return k[l]==a.id})[0].source;v=new G(g+"/dynamicLayer",{id:b.id+"_"+k[l],source:x,outFields:w,mode:G.MODE_SELECTION,infoTemplate:f&&new e(f),drawMode:!1,visible:b.visible,autoGeneralize:!0});var y=function(a,d){if(0<m[a].length&&d.setDefinitionExpression(m[a]),
r.isDefined(n[a])||r.isDefined(q[a]))if(r.isDefined(b.minScale)||r.isDefined(b.maxScale)){var e=b.minScale,f=b.maxScale;0==e&&0<n[a]?e=n[a]:0<e&&0==n[a]||0<e&&0<n[a]&&(e=Math.min(e,n[a]));f=Math.max(f||0,q[a]||0);d.setScaleRange(e,f)}else d.setScaleRange(n[a],q[a]);else Ga(b,c||u.layers,d,k[a])};v.loaded?y(l,v):d.connect(v,"onLoad",function(a){y(l,v)})}else{var C=null,z=g+"/"+k[l];if(h[l].length)z=h[l];else if(c)for(x=0;x<c.length;x++)if(c[x].id===k[l]){C=c[x];break}v=new G(ea(z),{id:b.id+"_"+k[l],
outFields:w,mode:G.MODE_SELECTION,infoTemplate:f&&new e(f),drawMode:!1,visible:b.visible,resourceInfo:C,autoGeneralize:!0});v.loaded?(0<m[l].length&&v.setDefinitionExpression(m[l]),Ga(b,c||u.layers,v,k[l])):d.connect(v,"onLoad",function(a){0<m[l].length&&v.setDefinitionExpression(m[l]);Ga(b,c||u.layers,a,k[l])})}t.push(v)}}),0<t.length)d.connect(b,"onVisibilityChange",l.hitch(this,function(b,c){a.forEach(b,function(a){c?a.show():a.hide()})},t)),d.connect(f,"onLayerRemove",l.hitch(this,function(b,
c,d){b.id===d.id&&a.forEach(c,function(a){f.removeLayer(a)})},b,t));return delete b.__popups,delete b.__popupIds,delete b.__popupUrls,delete b.__popupWhereClauses,delete b.__popupMinScales,delete b.__popupMaxScales,delete b.__resourceInfo,t}function Sa(a){return u({url:ea(a.url+"/layers"),content:{f:"json"},callbackParamName:"callback",error:function(){}})}function Ka(b,c,d){var e=[];a.forEach(b,function(a){var b=a.__popups;b&&1<b.length&&10<=a.version&&(a.__deferredsPos=e.length,e.push(Sa(a)))});
var f=[];0<e.length?(new g(e)).addCallback(function(e){a.forEach(b,function(a){a.__popups&&0<a.__popups.length&&(a.__deferredsPos||0===a.__deferredsPos?(f=f.concat(Ca(a,e[a.__deferredsPos][1].layers,d,c)),delete a.__deferredsPos):f=f.concat(Ca(a,null,d,c)))});c.addLayers(f)}):(a.forEach(b,function(a){a.__popups&&0<a.__popups.length&&(f=f.concat(Ca(a,null,d,c)))}),c.addLayers(f))}function Wa(b){a.forEach(b,function(b){var c=b.layer;c.toJson&&(b=c.toJson(),b.featureSet&&c.name&&-1<c.name.indexOf("Text")&&
a.forEach(b.featureSet.features,function(a,b){if(a.attributes.TEXT){var d=c.graphics[b];d.symbol.setText(a.attributes.TEXT);a.symbol.horizontalAlignment&&(d.symbol.align=a.symbol.horizontalAlignment);d.setSymbol(d.symbol);d.setAttributes(a.attributes)}},this))})}function Pa(b){var c=6;return a.forEach(b,function(b){if(b=b.renderer)"esri.renderer.SimpleRenderer"===b.declaredClass?((b=b.symbol)&&b.xoffset&&(c=Math.max(c,Math.abs(b.xoffset))),b&&b.yoffset&&(c=Math.max(c,Math.abs(b.yoffset)))):"esri.renderer.UniqueValueRenderer"!==
b.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==b.declaredClass||a.forEach(b.infos,function(a){(a=a.symbol)&&a.xoffset&&(c=Math.max(c,Math.abs(a.xoffset)));a&&a.yoffset&&(c=Math.max(c,Math.abs(a.yoffset)))})}),c}function La(c){var d=this,e=d.infoWindow,f=c.graphic;if(d.loaded){e.hide();e.clearFeatures();var g=[];if(a.forEach(d.graphicsLayerIds,function(a){(a=d.getLayer(a))&&a instanceof G&&a.loaded&&a.visible&&(a.clearSelection(),a.infoTemplate&&!a.suspended&&g.push(a))}),a.forEach(d.layerIds,
function(a){(a=d.getLayer(a))&&-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")&&a.loaded&&a.visible&&a.infoTemplate&&g.push(a)}),f=f&&f.getInfoTemplate()?f:null,g.length||f){var k=Pa(g),h=c.screenPoint,m=d.toMap(new x(h.x-k,h.y+k)),k=d.toMap(new x(h.x+k,h.y-k)),m=new y(m.x,m.y,k.x,k.y,d.spatialReference),l=new E;l.geometry=m;l.timeExtent=d.timeExtent;var n=!0,m=a.map(g,function(a){var b;-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")?(l.geometry=c.mapPoint,n=!1,b=a.queryVisibleRasters(l,
{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),b.addCallback(function(){return a.getVisibleRasters()})):(b=a.selectFeatures(l),b.addCallback(function(){return a.getSelectedFeatures()}));return b});f&&(k=new b,k.callback([f]),m.splice(0,0,k));if(!a.some(m,function(a){return-1===a.fired})){var q=f?1:0;if(a.forEach(g,function(a){q+=-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")?a.getVisibleRasters().length:a.getSelectedFeatures().length}),!q)return}e.setFeatures(m);e.show(c.mapPoint,
{closestFirst:n})}}}function Ta(a,b){var c,f=b.mapOptions||{};f.infoWindow||(c=new D({visibleWhenEmpty:!1},e.create("div")),f.infoWindow=c);r.isDefined(f.showInfoWindowOnClick)||b.usePopupManager||(f.showInfoWindowOnClick=!1);c=new t(a,f);return d.connect(c,"onLayersAddResult",Wa),c}function Na(b,c,e,f,g,k){var h,m,l,n;f.map?(h=f.map,m=f.clickEventHandle,l=f.clickEventListener,n=f.errors):(h=Ta(f,g),g.ignorePopups||g.disableClickBehavior||g.usePopupManager||(m=d.connect(h,"onClick",La),l=La));h.addLayers(b);
g.ignorePopups||g.usePopupManager||Ka(b,h,g._clazz);var q=n||[];a.forEach(c,function(a){a.errors&&(q=q.concat(a.errors))},this);h.loaded?k.callback({map:h,itemInfo:e,errors:q,clickEventHandle:m,clickEventListener:l}):d.connect(h,"onLoad",function(){k.callback({map:h,itemInfo:e,errors:q,clickEventHandle:m,clickEventListener:l})})}function Y(b,c,d,e,f){var g=[];if(a.forEach(f,function(b){l.isArray(b.layerObject)?a.forEach(b.layerObject,function(a){g.push(a)}):g.push(b.layerObject)}),"BingMapsAerial"===
f[0].type||"BingMapsRoad"===f[0].type||"BingMapsHybrid"===f[0].type)var k=setInterval(function(){if(f[0].layerObject&&f[0].layerObject.loaded)clearInterval(k),Ia(b,c,d,e,f,g);else if(f[0].errors){clearInterval(k);var a="";f[0].errors&&f[0].errors.length&&(a=" ("+f[0].errors[0].message+")");e.errback(Error(K.arcgis.utils.baseLayerError+a))}},10);else if(!g[0]&&f[0].baseMapLayer){var h="";f[0].errors&&f[0].errors.length&&(h=" ("+f[0].errors[0].message+")");e.errback(Error(K.arcgis.utils.baseLayerError+
h))}else Ia(b,c,d,e,f,g)}function Ia(b,c,d,e,f,g){try{var k=d.mapOptions||{};d.mapOptions=k;var h=b.item;if(g=a.filter(g,r.isDefined),h)if(h.extent&&h.extent.length)if(k.extent)Na(g,f,b,c,d,e);else{var m=new y(h.extent[0][0],h.extent[0][1],h.extent[1][0],h.extent[1][1],new v({wkid:4326})),l=g[0].spatialReference;4326===l.wkid?(k.extent=m,Na(g,f,b,c,d,e)):102100===l.wkid||102113===l.wkid||3857===l.wkid?(m.xmin=Math.max(m.xmin,-180),m.xmax=Math.min(m.xmax,180),m.ymin=Math.max(m.ymin,-89.99),m.ymax=
Math.min(m.ymax,89.99),k.extent=z.geographicToWebMercator(m),Na(g,f,b,c,d,e)):d.geometryServiceURL||q.defaults.geometryService?(d.geometryServiceURL?new F(d.geometryServiceURL):q.defaults.geometryService).project([m],l,function(a){a=a[0];k.extent=k.extent||a;Na(g,f,b,c,d,e)},function(){Na(g,f,b,c,d,e)}):e.errback(Error(K.arcgis.utils.geometryServiceError))}else Na(g,f,b,c,d,e);else Na(g,f,b,c,d,e)}catch(n){e.errback(n)}}function Ya(b){var c=[];return a.forEach(b.operationalLayers,function(a){a.featureCollection?
c.push({featureCollection:a.featureCollection,visibility:a.visibility,title:a.title}):a.layerObject&&c.push({layer:a.layerObject,visibility:a.visibility,title:a.title})}),c}function aa(b){var c=[];b=b.baseMap.baseMapLayers.concat(b.operationalLayers);return a.forEach(b,function(b){var d={};if(b.featureCollection&&"CSV"!==b.type)!0===b.featureCollection.showLegend&&a.forEach(b.featureCollection.layers,function(a){if(!1!==a.showLegend){var e=a.layerObject.renderer;d={layer:a.layerObject,title:b.title,
defaultSymbol:e&&e.defaultSymbol&&e.defaultLabel?!0:!1};1<b.featureCollection.layers.length&&(d.title+=" - "+a.layerDefinition.name);c.push(d)}});else if(b.baseMapLayer&&!0===b.showLegend&&b.layerObject||!b.baseMapLayer&&!1!==b.showLegend&&b.layerObject&&!(b.layerObject instanceof G&&b.layerObject.mode===G.MODE_SELECTION)){var e=b.layerObject.renderer,f=b.layerObject.declaredClass,e=!e||e&&e.defaultSymbol&&e.defaultLabel?!0:!1;if((10.1>b.layerObject.version&&("esri.layers.ArcGISDynamicMapServiceLayer"===
f||"esri.layers.ArcGISTiledMapServiceLayer"===f)||"esri.layers.ArcGISImageServiceLayer"===f)&&(e=!0),d={layer:b.layerObject,title:b.title,defaultSymbol:e},b.layers)f=a.map(a.filter(b.layers,function(a){return!1===a.showLegend}),function(a){return a.id}),f.length&&(d.hideLayers=f);c.push(d)}}),c}function Ua(c,d){function e(b,c){a.forEach(b,function(a,b){switch(a){case eb:X=c[b];break;case vb:ma=c[b];break;case wb:P=c[b];break;case yb:ha=c[b];break;case sb:ga=c[b];break;case Kb:na=c[b];break;case zb:ba=
c[b];break;case fb:da=c[b];break;case Fa:V=c[b];break;case Ab:rb=c[b];break;case kb:hb=c[b];break;case Bb:gb=c[b];break;case Za:xb=c[b];break;case Db:Jb=c[b];break;case Ra:ib=c[b];break;case Eb:jb=c[b];break;case Fb:Mb=c[b];break;case nb:qb=c[b];break;case Ba:Va=c[b];break;case Gb:Nb=c[b];break;case Hb:Xa=c[b];break;case ob:bb=c[b];break;case Ib:Pb=c[b]}})}var f=new b,g=c.itemData,k=[];g.baseMap&&g.baseMap.baseMapLayers&&(k=k.concat(g.baseMap.baseMapLayers));g.operationalLayers&&(k=k.concat(g.operationalLayers));
for(var g=a.map(k,function(a){return a&&a.layerType}),m=[],l=[],k=!1,n=0;n<g.length;n++){switch(g[n]){case "ArcGISFeatureLayer":-1===a.indexOf(m,kb)&&m.push(kb);break;case "ArcGISImageServiceLayer":case "ArcGISTiledImageServiceLayer":-1===a.indexOf(m,vb)&&(m.push(vb),l.push(Fa),l.push(Za),l.push(Ra));break;case "ArcGISImageServiceVectorLayer":-1===a.indexOf(m,wb)&&(m.push(wb),l.push(Fa),l.push(Za),l.push(Ra));break;case "ArcGISMapServiceLayer":case "ArcGISTiledMapServiceLayer":-1===a.indexOf(m,eb)&&
(m.push(eb),l.push(Kb),l.push(fb),l.push(Bb));break;case "ArcGISStreamLayer":-1===a.indexOf(m,Eb)&&m.push(Eb);break;case "BingMapsAerial":case "BingMapsHybrid":case "BingMapsRoad":-1===a.indexOf(m,Ba)&&m.push(Ba);break;case "CSV":-1===a.indexOf(m,sb)&&(m.push(sb),l.push(yb));break;case "GeoRSS":-1===a.indexOf(m,zb)&&m.push(zb);break;case "KML":-1===a.indexOf(m,Ab)&&m.push(Ab);break;case "OpenStreetMap":-1===a.indexOf(m,Db)&&m.push(Db);break;case "VectorTileLayer":-1===a.indexOf(m,nb)&&m.push(nb);
break;case "WebTiledLayer":-1===a.indexOf(m,Gb)&&(m.push(Gb),l.push(Fb));break;case "WFS":-1===a.indexOf(m,Hb)&&m.push(Hb);break;case "WMS":-1===a.indexOf(m,ob)&&(m.push(ob),l.push(Ib));break;default:k=!0}if(k)break}return k&&(m=Lb,l=Yb),m.length?h(m,function(){e(m,arguments);l.length?h(l,function(){e(l,arguments);f.resolve()}):f.resolve()}):f.resolve(),f}function Ma(c,d,e,f){var g=f.itemData;g.baseMap&&g.baseMap.baseMapLayers&&g.baseMap.baseMapLayers.length&&(g.baseMap.baseMapLayers[0].firstLayer=
!0);var k=d.layerMixins,h=k&&k.length;if(h){var m=function(a){for(var b=0;h>b;b++){var c=k[b];if(c.mixin)if(c.hasOwnProperty("id")){if(a.id===c.id){l.mixin(a,c.mixin);break}}else if(a.url===c.url){l.mixin(a,c.mixin);break}}};a.forEach(g.baseMap&&g.baseMap.baseMapLayers,m);a.forEach(g.operationalLayers,m)}Ua(f,d).then(function(){return O(f,d)}).then(function(){return Q(f,d)}).then(function(d){var f=d[0],g=d[1];if(f.itemData.operationalLayers&&0!==f.itemData.operationalLayers.length){var k=new b,h=
f.itemData.baseMap.baseMapLayers.slice(),m=a.filter(f.itemData.baseMap.baseMapLayers,function(a){return!a.isReference});d={item:f.item,itemData:{baseMap:{baseMapLayers:m}}};f.itemData.baseMap.baseMapLayers=a.filter(f.itemData.baseMap.baseMapLayers,function(a){return a.isReference});N(d,g).addCallback(function(a){wa(a.itemData,g).addCallback(l.hitch(null,Y,a,c,g,k))});k.then(function(a){N(f,g).addCallback(function(b){wa(b.itemData,g,a.map.spatialReference,m,a.map).addCallback(function(c){b.itemData.baseMap.baseMapLayers=
h;Y(b,a,g,e,c)})})},l.hitch(e,e.errback))}else N(f,g).addCallback(function(a){wa(a.itemData,g).addCallback(l.hitch(null,Y,a,c,g,e))})})}function ia(a,c){"undefined"==typeof c&&(c=!0);xa._arcgisUrl&&0<xa._arcgisUrl.length&&(xa.arcgisUrl=xa._arcgisUrl);var d=xa.arcgisUrl+"/"+a,e={},f=new b;return u({url:d,content:{f:"json"},callbackParamName:"callback",load:function(a){return e.item=a,c?void u({url:d+"/data",content:{f:"json"},callbackParamName:"callback",load:function(a){e.itemData=a;f.callback(e)},
error:function(a){f.errback(a)}}):void f.callback(e)},error:function(a){f.errback(a)}}),f}var xa,X,ma,P,ha,ga,na,ba,da,V,rb,hb,gb,xb,Jb,ib,jb,Mb,qb,Va,Nb,Xa,bb,Pb,eb="../layers/ArcGISDynamicMapServiceLayer",vb="../layers/ArcGISImageServiceLayer",wb="../layers/ArcGISImageServiceVectorLayer",yb="./csv",sb="../layers/CSVLayer",Kb="../layers/DynamicLayerInfo",zb="../layers/GeoRSSLayer",fb="../layers/ImageParameters",Fa="../layers/ImageServiceParameters",Ab="../layers/KMLLayer",kb="../layers/LabelClass",
Bb="../layers/LayerDrawingOptions",Za="../layers/MosaicRule",Db="../layers/OpenStreetMapLayer",Ra="../layers/RasterFunction",Eb="../layers/StreamLayer",Fb="../layers/TileInfo",nb="../layers/VectorTileLayer",Ba="../virtualearth/VETiledLayer",Gb="../layers/WebTiledLayer",Hb="../layers/WFSLayer",ob="../layers/WMSLayer",Ib="../layers/WMSLayerInfo",Lb=[eb,vb,wb,sb,zb,Ab,kb,Db,Eb,nb,Ba,Gb,Hb,ob],Yb=[yb,Kb,fb,Fa,Bb,Za,Ra,Fb,Ib];return xa={arcgisUrl:w.getProtocolForWebResource()+"//www.arcgis.com/sharing/rest/content/items",
getItem:ia,createMap:function(a,c,d){var e=new b;d=d||{};var f=d.infoTemplateClass;return d._clazz=f&&(l.isObject(f)?f:l.getObject(f))||C,l.isString(a)?ia(a).addCallback(l.hitch(null,Ma,c,d,e)).addErrback(l.hitch(e,e.errback)):Ma(c,d,e,a),e},getLayerList:function(a){return a&&a.itemInfo&&a.itemInfo.itemData?Ya(a.itemInfo.itemData):[]},getLegendLayers:function(a){return a&&a.itemInfo&&a.itemInfo.itemData?aa(a.itemInfo.itemData):[]},_arcgisUrl:null,_getItemProps:N,_getItemData:J,_getBingKey:I,_portalUrlResponse:T,
_portalUrlFailure:S,_processFSItemProperties:L,_processSSItemProperties:M,_getLayers:wa,_preBuildLayerObjects:la,_buildLayerObjects:ca,_preCreateMap:Y,_getMapSR:ja,_createMap:Na,_addSelectionLayers:Ka,_createSelectionFeatureLayers:Ca,_getServiceInfo:sa,_getFeatureCollectionItem:Ea,_mergeFeatureCollectionItem:ra,_projectFeatureCollection:za,_getLayersInfo:Sa,_initLayer:qa,_loadAsCached:oa,_loadAsDynamic:Aa,_processPopups:U,_onLayersAddResult:Wa,_sameSpatialReferenceAsBasemap:va,_sameTilingSchemeAsBasemap:ua,
_showPopup:La,_calculateClickTolerance:Pa,_getVisibleFeatureLayers:pa,_updateLayerScaleInfo:Ga,_checkUrl:ea,_isHostedService:W,_isAgolService:fa,_getLegendLayers:aa},l.setObject("arcgis.utils",xa,n),xa})},"esri/tasks/RouteTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../request ../geometry/normalizeUtils ./Task ./RouteResult ./NAMessage ./NAServiceDescription".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n){h=h([g,n],{declaredClass:"esri.tasks.RouteTask",
_eventMap:{"solve-complete":["result"]},constructor:function(a){this._url.orig=this._url.path;this._url.path+="/solve";this._handler=l.hitch(this,this._handler);this.registerConnectEvents()},__msigns:[{n:"solve",c:3,a:[{i:0,p:["stops.features","barriers.features","polylineBarriers.features","polygonBarriers.features"]}],e:2}],_handler:function(b,d,g,k,h){try{var m,l,n=[],z=[],A=b.directions||[],B=b.routes?b.routes.features:[],C=b.stops?b.stops.features:[],D=b.barriers?b.barriers.features:[],E=b.polygonBarriers?
b.polygonBarriers.features:[],F=b.polylineBarriers?b.polylineBarriers.features:[],H=b.messages,G=a.forEach,K=a.indexOf,J=!0,I=b.routes&&b.routes.spatialReference||b.stops&&b.stops.spatialReference||b.barriers&&b.barriers.spatialReference||b.polygonBarriers&&b.polygonBarriers.spatialReference||b.polylineBarriers&&b.polylineBarriers.spatialReference;this._chk=b.checksum;G(A,function(a){n.push(m=a.routeName);z[m]={directions:a}});G(B,function(a){-1===K(n,m=a.attributes.Name)&&(n.push(m),z[m]={});z[m].route=
a});G(C,function(a){l=a.attributes;-1===K(n,m=l.RouteName||"esri.tasks.RouteTask.NULL_ROUTE_NAME")&&(n.push(m),z[m]={});"esri.tasks.RouteTask.NULL_ROUTE_NAME"!==m&&(J=!1);void 0===z[m].stops&&(z[m].stops=[]);z[m].stops.push(a)});0<C.length&&!0===J&&(z[n[0]].stops=z["esri.tasks.RouteTask.NULL_ROUTE_NAME"].stops,delete z["esri.tasks.RouteTask.NULL_ROUTE_NAME"],n.splice(a.indexOf(n,"esri.tasks.RouteTask.NULL_ROUTE_NAME"),1));var L=[];G(n,function(a,b){z[a].routeName="esri.tasks.RouteTask.NULL_ROUTE_NAME"===
a?null:a;z[a].spatialReference=I;L.push(new e(z[a]))});b=function(a){return G(a,function(b,c){b.geometry&&(b.geometry.spatialReference=I);a[c]=new f(b)}),a};G(H,function(a,b){H[b]=new c(a)});var M={routeResults:L,barriers:b(D),polygonBarriers:b(E),polylineBarriers:b(F),messages:H};this._successHandler([M],"onSolveComplete",g,h)}catch(N){this._errorHandler(N,k,h)}},solve:function(a,b,c,d){var e=d.assembly;a=this._encode(l.mixin({},this._url.query,{f:"json"},a.toJson(e&&e[0]),this._chk?{checksum:this._chk}:
{}));var f=this._handler,g=this._errorHandler;return k({url:this._url.path,content:a,callbackParamName:"callback",load:function(a,e){f(a,e,b,c,d.dfd)},error:function(a){g(a,c,d.dfd)}})},onSolveComplete:function(){}});return m._createWrappers(h),d("extend-esri")&&l.setObject("tasks.RouteTask",h,b),h})},"esri/tasks/RouteResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ./DirectionsFeatureSet".split(" "),function(h,l,a,d,b,f,k){h=h(null,{declaredClass:"esri.tasks.RouteResult",
constructor:function(b){var d=b.spatialReference,e=b.route;if(b.directions){var c=[],h=[],l=[];a.forEach(b.directions.features,function(a,b){h[b]=a.compressedGeometry;c[b]=a.strings;l[b]=a.events});b.directions.strings=c;b.directions.events=l;this.directions=new k(b.directions,h)}if(this.routeName=b.routeName,e&&(e.geometry&&(e.geometry.spatialReference=d),this.route=new f(e)),b.stops){var r=this.stops=[];a.forEach(b.stops,function(a,b){a.geometry&&(a.geometry.spatialReference=d);r[a.attributes.Sequence-
1]=new f(a)})}},routeName:null,directions:null,route:null,stops:null});return d("extend-esri")&&l.setObject("tasks.RouteResult",h,b),h})},"esri/tasks/DirectionsFeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/json ../kernel ../geometry/Extent ../geometry/Polyline ../geometry/Point ../graphic ./FeatureSet".split(" "),function(h,l,a,d,b,f,k,m,g,e,c){h=h(c,{declaredClass:"esri.tasks.DirectionsFeatureSet",constructor:function(c,d){this.routeId=c.routeId;
this.routeName=c.routeName;l.mixin(this,c.summary);this.extent=new k(this.envelope);var f=this._fromCompressedGeometry,h=this.features,m=this.extent.spatialReference,t=[];a.forEach(d,function(a,b){h[b].setGeometry(t[b]=a?f(a,m):h[b].geometry)});this.mergedGeometry=this._mergePolylinesToSinglePath(t,m);this.geometryType="esriGeometryPolyline";a.forEach(c.events,function(d,f){a.forEach(d,function(a,c){d[c]=new e(new g(a.point.x,a.point.y,m),null,{ETA:a.ETA,strings:b.stringify(a.strings),arriveTimeUTC:a.arriveTimeUTC})});
c.events[f]=d});delete this.envelope},_fromCompressedGeometry:function(b,c){var d,e,f,g,k,h,l,z,A=0,B=0,C=0,D=0,E=[],F=0,H=0,G=0;(k=b.match(/((\+|\-)[^\+\-\|]+|\|)/g),k||(k=[]),0===parseInt(k[F],32))?(F=2,d=parseInt(k[F],32),F++,h=parseInt(k[F],32),F++,1&d&&(H=a.indexOf(k,"|")+1,l=parseInt(k[H],32),H++),2&d&&(G=a.indexOf(k,"|",H)+1,z=parseInt(k[G],32),G++)):(h=parseInt(k[F],32),F++);for(;F<k.length&&"|"!==k[F];)d=parseInt(k[F],32)+A,F++,A=d,e=parseInt(k[F],32)+B,F++,B=e,d=[d/h,e/h],H&&(g=parseInt(k[H],
32)+C,H++,C=g,d.push(g/l)),G&&(f=parseInt(k[G],32)+D,G++,D=f,d.push(f/z)),E.push(d);f=new m({paths:[E],hasZ:0<H,hasM:0<G});return f.setSpatialReference(c),f},_mergePolylinesToSinglePath:function(b,c){var d=[];a.forEach(b,function(b){a.forEach(b.paths,function(a){d=d.concat(a)})});var e=[],f=[0,0];return a.forEach(d,function(a){(a[0]!==f[0]||a[1]!==f[1])&&(e.push(a),f=a)}),(new m({paths:[e]})).setSpatialReference(c)}});return d("extend-esri")&&l.setObject("tasks.DirectionsFeatureSet",h,f),h})},"esri/tasks/NAMessage":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(h,l,a,d){h=h(null,{declaredClass:"esri.tasks.NAMessage",constructor:function(a){l.mixin(this,a)}});return l.mixin(h,{TYPE_INFORMATIVE:0,TYPE_PROCESS_DEFINITION:1,TYPE_PROCESS_START:2,TYPE_PROCESS_STOP:3,TYPE_WARNING:50,TYPE_ERROR:100,TYPE_EMPTY:101,TYPE_ABORT:200}),a("extend-esri")&&l.setObject("tasks.NAMessage",h,d),h})},"esri/tasks/NAServiceDescription":function(){define(["dojo/_base/declare","dojo/json","dojo/Deferred","dojo/_base/lang","../request"],
function(h,l,a,d,b){return h(null,{declaredClass:"esri.tasks._NAServiceDescription",_sd:null,getServiceDescription:function(f,k){var h=new a;if(this._sd)h.resolve(this._sd);else if(this._url&&this._url.orig){var g,e=this._url.orig,c=(this._url.path.match(/\/solve$/)||[]).length?"Route":(this._url.path.match(/\/solveClosestFacility$/)||[]).length?"ClosestFacility":"ServiceAreas",n=function(a){b({url:a+("/"===a[a.length-1]?"":"/")+"GetTravelModes/execute",content:{f:"json",serviceName:c},callbackParamName:"callback"}).then(function(a){var b=
[],c=null;if(a&&a.results&&a.results.length)for(var d=0;d<a.results.length;d++)if("supportedTravelModes"===a.results[d].paramName){if(a.results[d].value&&a.results[d].value.features)for(var e=0;e<a.results[d].value.features.length;e++)if(a.results[d].value.features[e].attributes){var f=l.parse(a.results[d].value.features[e].attributes.TravelMode);b.push(f)}}else"defaultTravelMode"===a.results[d].paramName&&(c=a.results[d].value);g.supportedTravelModes=b;g.defaultTravelMode=c;h.resolve(g)},function(a){h.reject(a)})};
b({url:e,content:{f:"json"},callbackParamName:"callback"}).then(function(a){g=a;g.supportedTravelModes||(g.supportedTravelModes=[]);for(a=0;a<g.supportedTravelModes.length;a++)g.supportedTravelModes[a].id||(g.supportedTravelModes[a].id=g.supportedTravelModes[a].itemId);k?h.resolve(g):f?n(f):10.4<=g.currentVersion?b({url:e+("/"===e[e.length-1]?"":"/")+"retrieveTravelModes",content:{f:"json"},callbackParamName:"callback"}).then(function(a){g.supportedTravelModes=a.supportedTravelModes;g.defaultTravelMode=
a.defaultTravelMode;h.resolve(g)},function(a){h.reject(a)}):b({url:e.substring(0,e.indexOf("/rest/")+6)+"info",content:{f:"json"},callbackParamName:"callback"}).then(function(a){a.owningSystemUrl?(e=a.owningSystemUrl,b({url:e+("/"===e[e.length-1]?"":"/")+"sharing/rest/portals/self",content:{f:"json"},callbackParamName:"callback"}).then(function(a){a&&a.helperServices&&a.helperServices.routingUtilities&&a.helperServices.routingUtilities.url?n(a.helperServices.routingUtilities.url):h.resolve(g)},function(a){h.reject(a)})):
h.resolve(g)},function(a){h.reject(a)})},function(a){h.reject(a)})}else h.reject("NA Task has no URL specified.");return h.then(d.hitch(this,function(a){this._sd=a}),d.hitch(this,function(){this._sd=null})),h.promise},getOwningSystemUrl:function(){var d=new a;if(this._url&&this._url.orig){var k=this._url.orig;b({url:k.substring(0,k.indexOf("/rest/")+6)+"info",content:{f:"json"},callbackParamName:"callback"}).promise.always(function(a){d.resolve(a.owningSystemUrl)})}else d.resolve(void 0);return d.promise}})})},
"esri/tasks/RouteParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang ../graphicsUtils ./NATypes".split(" "),function(h,l,a,d,b,f,k,m){h=h(null,{declaredClass:"esri.tasks.RouteParameters",accumulateAttributes:null,attributeParameterValues:null,barriers:null,directionsLanguage:null,directionsLengthUnits:null,directionsOutputType:null,directionsStyleName:null,directionsTimeAttribute:null,doNotLocateOnRestrictedElements:!0,findBestSequence:null,
ignoreInvalidLocations:null,impedanceAttribute:null,outputLines:"esriNAOutputLineTrueShape",outputGeometryPrecision:null,outputGeometryPrecisionUnits:null,outSpatialReference:null,polygonBarriers:null,polylineBarriers:null,preserveFirstStop:null,preserveLastStop:null,restrictionAttributes:null,restrictUTurns:null,returnBarriers:!1,returnDirections:!1,returnPolygonBarriers:!1,returnPolylineBarriers:!1,returnRoutes:!0,returnStops:!1,returnZ:!0,startTime:null,startTimeIsUTC:null,timeWindowsAreUTC:null,
stops:null,useHierarchy:null,useTimeWindows:null,travelMode:null,toJson:function(b){var d={returnDirections:this.returnDirections,returnRoutes:this.returnRoutes,returnZ:this.returnZ,returnStops:this.returnStops,returnBarriers:this.returnBarriers,returnPolygonBarriers:this.returnPolygonBarriers,returnPolylineBarriers:this.returnPolylineBarriers,attributeParameterValues:this.attributeParameterValues&&a.toJson(this.attributeParameterValues),outSR:this.outSpatialReference?this.outSpatialReference.wkid||
a.toJson(this.outSpatialReference.toJson()):null,outputLines:this.outputLines,findBestSequence:this.findBestSequence,preserveFirstStop:this.preserveFirstStop,preserveLastStop:this.preserveLastStop,useTimeWindows:this.useTimeWindows,startTime:this.startTime?this.startTime.getTime():null,startTimeIsUTC:this.startTimeIsUTC,timeWindowsAreUTC:this.timeWindowsAreUTC,accumulateAttributeNames:this.accumulateAttributes?this.accumulateAttributes.join(","):null,ignoreInvalidLocations:this.ignoreInvalidLocations,
impedanceAttributeName:this.impedanceAttribute,restrictionAttributeNames:this.restrictionAttributes?this.restrictionAttributes.join(","):null,restrictUTurns:this.restrictUTurns,useHierarchy:this.useHierarchy,directionsLanguage:this.directionsLanguage,outputGeometryPrecision:this.outputGeometryPrecision,outputGeometryPrecisionUnits:this.outputGeometryPrecisionUnits,directionsLengthUnits:m.LengthUnit[this.directionsLengthUnits],directionsTimeAttributeName:this.directionsTimeAttribute,directionsStyleName:this.directionsStyleName,
travelMode:"object"==typeof this.travelMode?a.toJson(this.travelMode):this.travelMode},c=this.stops;if("esri.tasks.FeatureSet"===c.declaredClass&&0<c.features.length?d.stops=a.toJson({type:"features",features:k._encodeGraphics(c.features,b&&b["stops.features"]),doNotLocateOnRestrictedElements:this.doNotLocateOnRestrictedElements}):"esri.tasks.DataLayer"===c.declaredClass?d.stops=c:"esri.tasks.DataFile"===c.declaredClass&&(d.stops=a.toJson({type:"features",url:c.url,doNotLocateOnRestrictedElements:this.doNotLocateOnRestrictedElements})),
this.directionsOutputType)switch(this.directionsOutputType.toLowerCase()){case "complete":d.directionsOutputType="esriDOTComplete";break;case "complete-no-events":d.directionsOutputType="esriDOTCompleteNoEvents";break;case "instructions-only":d.directionsOutputType="esriDOTInstructionsOnly";break;case "standard":d.directionsOutputType="esriDOTStandard";break;case "summary-only":d.directionsOutputType="esriDOTSummaryOnly";break;default:d.directionsOutputType=this.directionsOutputType}c=function(c,
d){return c?"esri.tasks.FeatureSet"===c.declaredClass?0<c.features.length?a.toJson({type:"features",features:k._encodeGraphics(c.features,b&&b[d])}):null:"esri.tasks.DataLayer"===c.declaredClass?c:"esri.tasks.DataFile"===c.declaredClass?a.toJson({type:"features",url:c.url}):a.toJson(c):null};return this.barriers&&(d.barriers=c(this.barriers,"barriers.features")),this.polygonBarriers&&(d.polygonBarriers=c(this.polygonBarriers,"polygonBarriers.features")),this.polylineBarriers&&(d.polylineBarriers=
c(this.polylineBarriers,"polylineBarriers.features")),f.filter(d,function(a){return null!==a?!0:void 0})}});return d("extend-esri")&&l.setObject("tasks.RouteParameters",h,b),h})},"esri/tasks/NATypes":function(){define(["dojo/_base/lang","dojo/has","../kernel"],function(h,l,a){var d={esriFeet:"esriNAUFeet",esriKilometers:"esriNAUKilometers",esriMeters:"esriNAUMeters",esriMiles:"esriNAUMiles",esriNauticalMiles:"esriNAUNauticalMiles",esriYards:"esriNAUYards"},b={NONE:"esriNAOutputLineNone",STRAIGHT:"esriNAOutputLineStraight",
TRUE_SHAPE:"esriNAOutputLineTrueShape",TRUE_SHAPE_WITH_MEASURE:"esriNAOutputLineTrueShapeWithMeasure"},f={ALLOW_BACKTRACK:"esriNFSBAllowBacktrack",AT_DEAD_ENDS_ONLY:"esriNFSBAtDeadEndsOnly",NO_BACKTRACK:"esriNFSBNoBacktrack",AT_DEAD_ENDS_AND_INTERSECTIONS:"esriNFSBAtDeadEndsAndIntersections"},k={NONE:"esriNAOutputPolygonNone",SIMPLIFIED:"esriNAOutputPolygonSimplified",DETAILED:"esriNAOutputPolygonDetailed"},m={FROM_FACILITY:"esriNATravelDirectionFromFacility",TO_FACILITY:"esriNATravelDirectionToFacility"},
g={LengthUnit:d,OutputLine:b,UTurn:f,OutputPolygon:k,TravelDirection:m};return l("extend-esri")&&(h.setObject("tasks._NALengthUnit",d,a),h.setObject("tasks.NAOutputLine",b,a),h.setObject("tasks.NAUTurn",f,a),h.setObject("tasks.NAOutputPolygon",k,a),h.setObject("tasks.NATravelDirection",m,a)),g})},"esri/tasks/DistanceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),function(h,l,a,d,b,f){h=h(null,{declaredClass:"esri.tasks.DistanceParameters",
geometry1:null,geometry2:null,distanceUnit:null,geodesic:null,toJson:function(){var b={},d=this.geometry1;d&&(b.geometry1=a.toJson({geometryType:f.getJsonType(d),geometry:d}));d=this.geometry2;return d&&(b.geometry2=a.toJson({geometryType:f.getJsonType(d),geometry:d})),b.sr=a.toJson(this.geometry1.spatialReference.toJson()),this.distanceUnit&&(b.distanceUnit=this.distanceUnit),this.geodesic&&(b.geodesic=this.geodesic),b}});return d("extend-esri")&&l.setObject("tasks.DistanceParameters",h,b),h})},
"cmv/viewer/js/gis/dijit/Directions/nls/resource":function(){define({root:{labels:{startAtMyLocation:"start at my location",endAtMyLocation:"end at my location",clearStops:"clear stops",addStop:"Add stop",directionsToHere:"Directions to here",directionsFromHere:"Directions from here",useMyLocationAsStart:"Use my location as start point",useMyLocationAsEnd:"Use my location as end point",directions:"Directions"},errors:{geoLocation:{title:"Error",message:"GeoLocation not supported by your browser."},
location:{title:"Error",message:"There was a problem getting your location: "}}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/Editor":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/dom-construct dojo/topic dojo/aspect dojo/text!./Editor/templates/Editor.html dojo/i18n!./Editor/nls/resource dijit/form/Button".split(" "),function(h,l,a,d,b,f,k,m,g,e){return h([l,a,d],{templateString:g,i18n:e,widgetsInTemplate:!0,
editor:null,isEdit:!1,mapClickMode:null,postCreate:function(){this.inherited(arguments);this.own(k.subscribe("mapClickMode/currentSet",b.hitch(this,"setMapClickMode")));this.parentWidget&&this.parentWidget.toggleable&&this.own(m.after(this.parentWidget,"toggle",b.hitch(this,function(){this.onLayoutChange(this.parentWidget.open)})))},toggleEditing:function(){if(this.isEdit)this.endEditing(),k.publish("mapClickMode/setDefault");else{var a=b.clone(this.settings);a.map=this.map;a.layerInfos=this.layerInfos;
var d=f.create("div",{innerHTML:'\x3cimg style\x3d"display:inline;" src\x3d"data:image/gif;base64,R0lGODlhIAAgALMAAP///7Ozs/v7+9bW1uHh4fLy8rq6uoGBgTQ0NAEBARsbG8TExJeXl/39/VRUVAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFBQAAACwAAAAAIAAgAAAE5xDISSlLrOrNp0pKNRCdFhxVolJLEJQUoSgOpSYT4RowNSsvyW1icA16k8MMMRkCBjskBTFDAZyuAEkqCfxIQ2hgQRFvAQEEIjNxVDW6XNE4YagRjuBCwe60smQUDnd4Rz1ZAQZnFAGDd0hihh12CEE9kjAEVlycXIg7BAsMB6SlnJ87paqbSKiKoqusnbMdmDC2tXQlkUhziYtyWTxIfy6BE8WJt5YEvpJivxNaGmLHT0VnOgGYf0dZXS7APdpB309RnHOG5gDqXGLDaC457D1zZ/V/nmOM82XiHQjYKhKP1oZmADdEAAAh+QQFBQAAACwAAAAAGAAXAAAEchDISasKNeuJFKoHs4mUYlJIkmjIV54Soypsa0wmLSnqoTEtBw52mG0AjhYpBxioEqRNy8V0qFzNw+GGwlJki4lBqx1IBgjMkRIghwjrzcDti2/Gh7D9qN774wQGAYOEfwCChIV/gYmDho+QkZKTR3p7EQAh+QQFBQAAACwBAAAAHQAOAAAEchDISWdANesNHHJZwE2DUSEo5SjKKB2HOKGYFLD1CB/DnEoIlkti2PlyuKGEATMBaAACSyGbEDYD4zN1YIEmh0SCQQgYehNmTNNaKsQJXmBuuEYPi9ECAU/UFnNzeUp9VBQEBoFOLmFxWHNoQw6RWEocEQAh+QQFBQAAACwHAAAAGQARAAAEaRDICdZZNOvNDsvfBhBDdpwZgohBgE3nQaki0AYEjEqOGmqDlkEnAzBUjhrA0CoBYhLVSkm4SaAAWkahCFAWTU0A4RxzFWJnzXFWJJWb9pTihRu5dvghl+/7NQmBggo/fYKHCX8AiAmEEQAh+QQFBQAAACwOAAAAEgAYAAAEZXCwAaq9ODAMDOUAI17McYDhWA3mCYpb1RooXBktmsbt944BU6zCQCBQiwPB4jAihiCK86irTB20qvWp7Xq/FYV4TNWNz4oqWoEIgL0HX/eQSLi69boCikTkE2VVDAp5d1p0CW4RACH5BAUFAAAALA4AAAASAB4AAASAkBgCqr3YBIMXvkEIMsxXhcFFpiZqBaTXisBClibgAnd+ijYGq2I4HAamwXBgNHJ8BEbzgPNNjz7LwpnFDLvgLGJMdnw/5DRCrHaE3xbKm6FQwOt1xDnpwCvcJgcJMgEIeCYOCQlrF4YmBIoJVV2CCXZvCooHbwGRcAiKcmFUJhEAIfkEBQUAAAAsDwABABEAHwAABHsQyAkGoRivELInnOFlBjeM1BCiFBdcbMUtKQdTN0CUJru5NJQrYMh5VIFTTKJcOj2HqJQRhEqvqGuU+uw6AwgEwxkOO55lxIihoDjKY8pBoThPxmpAYi+hKzoeewkTdHkZghMIdCOIhIuHfBMOjxiNLR4KCW1ODAlxSxEAIfkEBQUAAAAsCAAOABgAEgAABGwQyEkrCDgbYvvMoOF5ILaNaIoGKroch9hacD3MFMHUBzMHiBtgwJMBFolDB4GoGGBCACKRcAAUWAmzOWJQExysQsJgWj0KqvKalTiYPhp1LBFTtp10Is6mT5gdVFx1bRN8FTsVCAqDOB9+KhEAIfkEBQUAAAAsAgASAB0ADgAABHgQyEmrBePS4bQdQZBdR5IcHmWEgUFQgWKaKbWwwSIhc4LonsXhBSCsQoOSScGQDJiWwOHQnAxWBIYJNXEoFCiEWDI9jCzESey7GwMM5doEwW4jJoypQQ743u1WcTV0CgFzbhJ5XClfHYd/EwZnHoYVDgiOfHKQNREAIfkEBQUAAAAsAAAPABkAEQAABGeQqUQruDjrW3vaYCZ5X2ie6EkcKaooTAsi7ytnTq046BBsNcTvItz4AotMwKZBIC6H6CVAJaCcT0CUBTgaTg5nTCu9GKiDEMPJg5YBBOpwlnVzLwtqyKnZagZWahoMB2M3GgsHSRsRACH5BAUFAAAALAEACAARABgAAARcMKR0gL34npkUyyCAcAmyhBijkGi2UW02VHFt33iu7yiDIDaD4/erEYGDlu/nuBAOJ9Dvc2EcDgFAYIuaXS3bbOh6MIC5IAP5Eh5fk2exC4tpgwZyiyFgvhEMBBEAIfkEBQUAAAAsAAACAA4AHQAABHMQyAnYoViSlFDGXBJ808Ep5KRwV8qEg+pRCOeoioKMwJK0Ekcu54h9AoghKgXIMZgAApQZcCCu2Ax2O6NUud2pmJcyHA4L0uDM/ljYDCnGfGakJQE5YH0wUBYBAUYfBIFkHwaBgxkDgX5lgXpHAXcpBIsRADs\x3d"/\x3e',
style:"text-align:center;"},this.containerNode,"only");require(["esri/dijit/editing/Editor"],b.hitch(this,function(b){this.editor=new b({settings:a},d);this.editor.startup()}));this.toggleBTN.set("label",this.i18n.labels.stopEditing);this.toggleBTN.set("class","danger");this.isEdit=!0;k.publish("mapClickMode/setCurrent","editor")}},endEditing:function(){this.editor&&this.editor.destroyRecursive&&this.editor.destroyRecursive();this.toggleBTN.set("label",this.i18n.labels.startEditing);this.toggleBTN.set("class",
"success");this.isEdit=!1;this.editor=null},onLayoutChange:function(a){a||"editor"!==this.mapClickMode||(this.endEditing(),k.publish("mapClickMode/setDefault"))},setMapClickMode:function(a){this.mapClickMode=a;"editor"!==a&&this.endEditing()}})})},"cmv/viewer/js/gis/dijit/Editor/nls/resource":function(){define({root:{labels:{startEditing:"Start editing",stopEditing:"Stop editing"}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/StreetView":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/aspect dojo/topic esri/layers/GraphicsLayer esri/graphic esri/renderers/SimpleRenderer dojo/text!./StreetView/templates/StreetView.html esri/symbols/PictureMarkerSymbol dojo/dom-style dojo/dom-geometry esri/geometry/Point esri/SpatialReference dijit/MenuItem proj4js/proj4 dojo/i18n!./StreetView/nls/resource gis/plugins/Google dijit/form/ToggleButton xstyle/css!./StreetView/css/StreetView.css".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y){var z;return h([l,a,d],{widgetsInTemplate:!0,templateString:c,i18n:x,mapClickMode:null,panoOptions:null,proj4BaseURL:"https://epsg.io/",proj4Catalog:"EPSG",proj4CustomURL:null,postCreate:function(){this.inherited(arguments);y.load(b.hitch(this,function(a){z=a;this.panoOptions={addressControlOptions:{position:z.maps.ControlPosition.TOP_RIGHT},linksControl:!1,panControl:!1,zoomControlOptions:{style:z.maps.ZoomControlStyle.SMALL},enableCloseButton:!1};
this.createGraphicsLayer();this.map.on("click",b.hitch(this,"getStreetView"));this.own(k.subscribe("mapClickMode/currentSet",b.hitch(this,"setMapClickMode")));this.parentWidget&&(this.parentWidget.toggleable&&this.own(f.after(this.parentWidget,"toggle",b.hitch(this,function(){this.onLayoutChange(this.parentWidget.open)}))),this.own(f.after(this.parentWidget,"resize",b.hitch(this,"resize"))),this.own(k.subscribe(this.parentWidget.id+"/resize/resize",b.hitch(this,"resize"))));window.proj4||(window.proj4=
w);this.mapRightClickMenu&&this.addRightClickMenu()}))},createGraphicsLayer:function(){this.pointSymbol=new n(require.toUrl("gis/dijit/StreetView/images/blueArrow.png"),30,30);this.pointGraphics=new m({id:"streetview_graphics",title:"Street View"});this.pointRenderer=new e(this.pointSymbol);this.pointRenderer.label="Street View";this.pointRenderer.description="Street View";this.pointGraphics.setRenderer(this.pointRenderer);this.map.addLayer(this.pointGraphics)},addRightClickMenu:function(){this.map.on("MouseDown",
b.hitch(this,function(a){this.mapRightClickPoint=a.mapPoint}));this.mapRightClickMenu.addChild(new t({label:this.i18n.rightClickMenuItem.label,onClick:b.hitch(this,"streetViewFromMapRightClick")}))},onOpen:function(){this.pointGraphics.show();this.panorama&&this.panoramaService||(this.panorama=new z.maps.StreetViewPanorama(this.panoNode,this.panoOptions),this.panoramaService=new z.maps.StreetViewService)},onClose:function(){this.pointGraphics.hide();"streetview"===this.mapClickMode&&this.connectMapClick()},
onLayoutChange:function(a){if(a)this.onOpen();else this.onClose()},placePoint:function(){this.streetViewButtonDijit.get("checked")?this.disconnectMapClick():this.connectMapClick()},disconnectMapClick:function(){this.streetViewButtonDijit.set("checked",!0);this.map.setMapCursor("crosshair");k.publish("mapClickMode/setCurrent","streetview")},connectMapClick:function(){this.streetViewButtonDijit.set("checked",!1);this.map.setMapCursor("auto");k.publish("mapClickMode/setDefault")},clearGraphics:function(){this.pointGraphics.clear();
q.set(this.noStreetViewResults,"display","block")},enableStreetViewClick:function(){this.disconnectMapClick()},disableStreetViewClick:function(){this.connectMapClick()},getStreetView:function(a,c){if("streetview"===this.mapClickMode||c){var d=a.mapPoint;if(d){this.parentWidget&&!this.parentWidget.open&&this.parentWidget.toggle();var e=null,f=d.spatialReference.wkid;102100===f&&(f=3857);var g=this.proj4Catalog+":"+String(f);w.defs[g]?((d=w(w.defs[g]).inverse([d.x,d.y]))&&(e={x:d[0],y:d[1]}),q.set(this.streetViewInstructions,
"display","none"),e?(q.set(this.noStreetViewResults,"display","none"),this.getPanoramaLocation(e)):(this.setPanoPlace=null,this.clearGraphics(),q.set(this.noStreetViewResults,"display","block"))):require([this.proj4CustomURL||this.proj4BaseURL+String(f)+".js"],b.hitch(this,"getStreetView",a,!0))}}},getPanoramaLocation:function(a){var c=new z.maps.LatLng(a.y,a.x);this.panoramaService.getPanoramaByLocation(c,50,b.hitch(this,"getPanoramaByLocationComplete",a));z.maps.event.addListener(this.panorama,
"position_changed",b.hitch(this,"setPlaceMarkerPosition"));z.maps.event.addListener(this.panorama,"pov_changed",b.hitch(this,"setPlaceMarkerRotation"))},getPanoramaByLocationComplete:function(a,b,c){"OK"===c?(this.disableStreetViewClick(),this.setPanoPlace=a=new z.maps.LatLng(a.y,a.x),this.firstSet=!0,this.panorama.setPosition(a)):"ZERO_RESULTS"===c?(this.setPanoPlace=null,this.clearGraphics(),this.connectMapClick(),q.set(this.noStreetViewResults,"display","block")):(this.setPanoPlace=null,this.clearGraphics(),
k.publish("viewer/handleError",{source:"StreetView",error:"Unknown."}))},resize:function(a){a&&a.h&&r.setContentSize(this.containerNode,{h:a.h-2});this.panorama&&z.maps.event.trigger(this.panorama,"resize")},setPlaceMarkerPosition:function(){this.placeMarker&&0!==this.pointGraphics.graphics.length||(this.placeMarker=new g,this.pointGraphics.add(this.placeMarker));var a=this.panorama.getPosition(),c=a.lat(),d=a.lng();if(!isNaN(c)&&!isNaN(d)){var e=null,f=this.map.spatialReference.wkid;102100===f&&
(f=3857);e=this.proj4Catalog+":"+String(f);if(w.defs[e]){if(e=w(w.defs[e]).forward([d,c]))c=new u(e,new v({wkid:f})),this.placeMarker.setGeometry(c),this.setPanoPlace&&!this.firstSet?(a=z.maps.geometry.spherical.computeHeading(a,this.setPanoPlace),this.panorama.setPov({heading:a,pitch:0}),setTimeout(b.hitch(this,function(){this.setPanoPlace=null}),1E3)):this.firstSet=!1}else require([this.proj4CustomURL||this.proj4BaseURL+String(f)+".js"],b.hitch(this,"setPlaceMarkerPosition"))}},setPlaceMarkerRotation:function(){if(this.placeMarker){var a=
this.panorama.getPov();this.pointSymbol.setAngle(a.heading);this.pointGraphics.refresh()}},streetViewFromMapRightClick:function(){this.getStreetView({mapPoint:this.mapRightClickPoint},!0)},setMapClickMode:function(a){this.mapClickMode=a}})})},"app/vendor/proj4":function(){!function(h){if("object"==typeof exports)module.exports=h();else if("function"==typeof define&&define.amd)define(h);else{var l;"undefined"!=typeof window?l=window:"undefined"!=typeof global?l=global:"undefined"!=typeof self&&(l=
self);l.proj4=h()}}(function(){return function l(a,d,b){function f(g,e){if(!d[g]){if(!a[g]){var c="function"==typeof require&&require;if(!e&&c)return c(g,!0);if(k)return k(g,!0);throw Error("Cannot find module '"+g+"'");}c=d[g]={exports:{}};a[g][0].call(c.exports,function(b){var c=a[g][1][b];return f(c?c:b)},c,c.exports,l,a,d,b)}return d[g].exports}for(var k="function"==typeof require&&require,m=0;m<b.length;m++)f(b[m]);return f}({1:[function(l,a,d){function b(a,d,f){if(!(this instanceof b))return new b(a,
d,f);Array.isArray(a)?(this.x=a[0],this.y=a[1],this.z=a[2]||0):"object"==typeof a?(this.x=a.x,this.y=a.y,this.z=a.z||0):"string"==typeof a&&"undefined"==typeof d?(a=a.split(","),this.x=parseFloat(a[0],10),this.y=parseFloat(a[1],10),this.z=parseFloat(a[2],10)||0):(this.x=a,this.y=d,this.z=f||0);console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var f=l("mgrs");b.fromMGRS=function(a){return new b(f.toPoint(a))};b.prototype.toMGRS=function(a){return f.forward([this.x,this.y],
a)};a.exports=b},{mgrs:67}],2:[function(l,a,d){function b(a,d){if(!(this instanceof b))return new b(a);d=d||function(a){if(a)throw a;};var c=f(a);if("object"!=typeof c)return void d(a);var c=m(c),l=b.projections.get(c.projName);l?(k(this,c),k(this,l),this.init(),d(null,this)):d(a)}var f=l("./parseCode"),k=l("./extend");d=l("./projections");var m=l("./deriveConstants");b.projections=d;b.projections.start();a.exports=b},{"./deriveConstants":33,"./extend":34,"./parseCode":37,"./projections":39}],3:[function(l,
a,d){a.exports=function(a,d,k){var m,g,e,c=k.x,l=k.y,q=k.z||0;for(e=0;3>e;e++)if(!d||2!==e||void 0!==k.z)switch(0===e?(m=c,g="x"):1===e?(m=l,g="y"):(m=q,g="z"),a.axis[e]){case "e":k[g]=m;break;case "w":k[g]=-m;break;case "n":k[g]=m;break;case "s":k[g]=-m;break;case "u":void 0!==k[g]&&(k.z=m);break;case "d":void 0!==k[g]&&(k.z=-m);break;default:return null}return k}},{}],4:[function(l,a,d){var b=Math.PI/2,f=l("./sign");a.exports=function(a){return Math.abs(a)<b?a:a-f(a)*Math.PI}},{"./sign":21}],5:[function(l,
a,d){var b=2*Math.PI,f=l("./sign");a.exports=function(a){return 3.14159265359>=Math.abs(a)?a:a-f(a)*b}},{"./sign":21}],6:[function(l,a,d){a.exports=function(a){return 1<Math.abs(a)&&(a=1<a?1:-1),Math.asin(a)}},{}],7:[function(l,a,d){a.exports=function(a){return 1-.25*a*(1+a/16*(3+1.25*a))}},{}],8:[function(l,a,d){a.exports=function(a){return.375*a*(1+.25*a*(1+.46875*a))}},{}],9:[function(l,a,d){a.exports=function(a){return.05859375*a*a*(1+.75*a)}},{}],10:[function(l,a,d){a.exports=function(a){return 35/
3072*a*a*a}},{}],11:[function(l,a,d){a.exports=function(a,d,k){d*=k;return a/Math.sqrt(1-d*d)}},{}],12:[function(l,a,d){a.exports=function(a,d,k,m,g){var e,c;e=a/d;for(var l=0;15>l;l++)if(c=(a-(d*e-k*Math.sin(2*e)+m*Math.sin(4*e)-g*Math.sin(6*e)))/(d-2*k*Math.cos(2*e)+4*m*Math.cos(4*e)-6*g*Math.cos(6*e)),e+=c,1E-10>=Math.abs(c))return e;return 0/0}},{}],13:[function(l,a,d){var b=Math.PI/2;a.exports=function(a,d){var m=1-(1-a*a)/(2*a)*Math.log((1-a)/(1+a));if(1E-6>Math.abs(Math.abs(d)-m))return 0>
d?-1*b:b;for(var g,e,c,l,m=Math.asin(.5*d),q=0;30>q;q++)if(e=Math.sin(m),c=Math.cos(m),l=a*e,g=Math.pow(1-l*l,2)/(2*c)*(d/(1-a*a)-e/(1-l*l)+.5/a*Math.log((1-l)/(1+l))),m+=g,1E-10>=Math.abs(g))return m;return 0/0}},{}],14:[function(l,a,d){a.exports=function(a,d,k,m,g){return a*g-d*Math.sin(2*g)+k*Math.sin(4*g)-m*Math.sin(6*g)}},{}],15:[function(l,a,d){a.exports=function(a,d,k){a*=d;return k/Math.sqrt(1-a*a)}},{}],16:[function(l,a,d){var b=Math.PI/2;a.exports=function(a,d){for(var m,g,e=.5*a,c=b-2*
Math.atan(d),l=0;15>=l;l++)if(m=a*Math.sin(c),g=b-2*Math.atan(d*Math.pow((1-m)/(1+m),e))-c,c+=g,1E-10>=Math.abs(g))return c;return-9999}},{}],17:[function(l,a,d){a.exports=function(a){var d=[];d[0]=1-a*(.25+a*(.046875+a*(.01953125+.01068115234375*a)));d[1]=a*(.75-a*(.046875+a*(.01953125+.01068115234375*a)));var k=a*a;return d[2]=k*(.46875-a*(.013020833333333334+.007120768229166667*a)),k*=a,d[3]=k*(.3645833333333333-.005696614583333333*a),d[4]=k*a*.3076171875,d}},{}],18:[function(l,a,d){var b=l("./pj_mlfn");
a.exports=function(a,d,m){for(var g=1/(1-d),e=a,c=20;c;--c){var l=Math.sin(e),q=1-d*l*l;if(q=(b(e,l,Math.cos(e),m)-a)*q*Math.sqrt(q)*g,e-=q,1E-10>Math.abs(q))break}return e}},{"./pj_mlfn":19}],19:[function(l,a,d){a.exports=function(a,d,k,m){return k*=d,d*=d,m[0]*a-k*(m[1]+d*(m[2]+d*(m[3]+d*m[4])))}},{}],20:[function(l,a,d){a.exports=function(a,d){var k;return 1E-7<a?(k=a*d,(1-a*a)*(d/(1-k*k)-.5/a*Math.log((1-k)/(1+k)))):2*d}},{}],21:[function(l,a,d){a.exports=function(a){return 0>a?-1:1}},{}],22:[function(l,
a,d){a.exports=function(a,d){return Math.pow((1-a)/(1+a),d)}},{}],23:[function(l,a,d){a.exports=function(a){var d={x:a[0],y:a[1]};return 2<a.length&&(d.z=a[2]),3<a.length&&(d.m=a[3]),d}},{}],24:[function(l,a,d){var b=Math.PI/2;a.exports=function(a,d,m){m*=a;return m=Math.pow((1-m)/(1+m),.5*a),Math.tan(.5*(b-d))/m}},{}],25:[function(l,a,d){d.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};d.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};d.ggrs87={towgs84:"-199.87,74.79,246.62",
ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};d.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};d.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};d.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};d.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};d.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",
datumName:"Hermannskogel"};d.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};d.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};d.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};d.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};d.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",
datumName:"S-JTSK (Ferro)"};d.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};d.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};d.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],26:[function(l,a,d){d.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};d.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};d.GRS80={a:6378137,rf:298.257222101,
ellipseName:"GRS 1980(IUGG, 1980)"};d.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};d.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"};d.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};d.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};d.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"};d.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};d.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl \x26 S. Amer. 1969"};
d.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};d.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"};d.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};d.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"};d.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."};d.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"};d.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};d.delmbr=
{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};d.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"};d.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"};d.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"};d.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"};d.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"};d.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah \x26 Sarawak)"};d.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};
d.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};d.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};d.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};d.hough={a:6378270,rf:297,ellipseName:"Hough"};d.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};d.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};d.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};d.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};d.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"};
d.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};d.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};d.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"};d.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"};d.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};d.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};d.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};d.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};d.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r\x3d6370997)"}},
{}],27:[function(l,a,d){d.greenwich=0;d.lisbon=-9.131906111111;d.paris=2.337229166667;d.bogota=-74.080916666667;d.madrid=-3.687938888889;d.rome=12.452333333333;d.bern=7.439583333333;d.jakarta=106.807719444444;d.ferro=-17.666666666667;d.brussels=4.367975;d.stockholm=18.058277777778;d.athens=23.7163375;d.oslo=10.722916666667},{}],28:[function(l,a,d){d.ft={to_meter:.3048};d["us-ft"]={to_meter:1200/3937}},{}],29:[function(l,a,d){function b(a,b,d){var f;return Array.isArray(d)?(f=m(a,b,d),3===d.length?
[f.x,f.y,f.z]:[f.x,f.y]):m(a,b,d)}function f(a){return a instanceof k?a:a.oProj?a.oProj:k(a)}var k=l("./Proj"),m=l("./transform"),g=k("WGS84");a.exports=function(a,c,d){a=f(a);var k,m=!1;return"undefined"==typeof c?(c=a,a=g,m=!0):("undefined"!=typeof c.x||Array.isArray(c))&&(d=c,c=a,a=g,m=!0),c=f(c),d?b(a,c,d):(k={forward:function(d){return b(a,c,d)},inverse:function(d){return b(c,a,d)}},m&&(k.oProj=c),k)}},{"./Proj":2,"./transform":65}],30:[function(l,a,d){var b=Math.PI/2,f=function(a){if(!(this instanceof
f))return new f(a);if(this.datum_type=4,a){if(a.datumCode&&"none"===a.datumCode&&(this.datum_type=5),a.datum_params){for(var b=0;b<a.datum_params.length;b++)a.datum_params[b]=parseFloat(a.datum_params[b]);0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(this.datum_type=1);3<a.datum_params.length&&(0!==a.datum_params[3]||0!==a.datum_params[4]||0!==a.datum_params[5]||0!==a.datum_params[6])&&(this.datum_type=2,a.datum_params[3]*=4.84813681109536E-6,a.datum_params[4]*=4.84813681109536E-6,
a.datum_params[5]*=4.84813681109536E-6,a.datum_params[6]=a.datum_params[6]/1E6+1)}this.datum_type=a.grids?3:this.datum_type;this.a=a.a;this.b=a.b;this.es=a.es;this.ep2=a.ep2;this.datum_params=a.datum_params;3===this.datum_type&&(this.grids=a.grids)}};f.prototype={compare_datums:function(a){return this.datum_type!==a.datum_type?!1:this.a!==a.a||5E-11<Math.abs(this.es-a.es)?!1:1===this.datum_type?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===
a.datum_params[2]:2===this.datum_type?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===a.datum_params[2]&&this.datum_params[3]===a.datum_params[3]&&this.datum_params[4]===a.datum_params[4]&&this.datum_params[5]===a.datum_params[5]&&this.datum_params[6]===a.datum_params[6]:3===this.datum_type||3===a.datum_type?this.nadgrids===a.nadgrids:!0},geodetic_to_geocentric:function(a){var d,f,e,c,l,q,r,u=a.x,v=a.y,t=a.z?a.z:0;if(-b>v&&v>-1.001*b)v=-b;
else if(v>b&&1.001*b>v)v=b;else if(-b>v||v>b)return null;return u>Math.PI&&(u-=2*Math.PI),l=Math.sin(v),r=Math.cos(v),q=l*l,c=this.a/Math.sqrt(1-this.es*q),d=(c+t)*r*Math.cos(u),f=(c+t)*r*Math.sin(u),e=(c*(1-this.es)+t)*l,a.x=d,a.y=f,a.z=e,0},geocentric_to_geodetic:function(a){var b,d,e,c,f,l,r,u,v,t,w,x;e=a.x;t=a.y;var y=a.z?a.z:0;if(b=Math.sqrt(e*e+t*t),d=Math.sqrt(e*e+t*t+y*y),1E-12>b/this.a){if(t=0,1E-12>d/this.a)return}else t=Math.atan2(t,e);e=y/d;d=b/d;c=1/Math.sqrt(1-this.es*(2-this.es)*d*
d);l=d*(1-this.es)*c;r=e*c;v=0;do v++,f=this.a/Math.sqrt(1-this.es*r*r),x=b*l+y*r-f*(1-this.es*r*r),f=this.es*f/(f+x),c=1/Math.sqrt(1-f*(2-f)*d*d),f=d*(1-f)*c,c*=e,u=c*l-f*r,l=f,r=c;while(1E-24<u*u&&30>v);return w=Math.atan(c/Math.abs(f)),a.x=t,a.y=w,a.z=x,a},geocentric_to_geodetic_noniter:function(a){var d,f,e,c,l,q,r,u,v,t,w,x,y,z,A,B,C,D=a.x,E=a.y,F=a.z?a.z:0;if(D=parseFloat(D),E=parseFloat(E),F=parseFloat(F),C=!1,0!==D)d=Math.atan2(E,D);else if(0<E)d=b;else if(0>E)d=-b;else if(C=!0,d=0,0<F)f=
b;else{if(!(0>F))return;f=-b}return l=D*D+E*E,c=Math.sqrt(l),q=1.0026*F,u=Math.sqrt(q*q+l),t=q/u,x=c/u,w=t*t*t,r=F+this.b*this.ep2*w,B=c-this.a*this.es*x*x*x,v=Math.sqrt(r*r+B*B),y=r/v,z=B/v,A=this.a/Math.sqrt(1-this.es*y*y),e=.3826834323650898<=z?c/z-A:-.3826834323650898>=z?c/-z-A:F/y+A*(this.es-1),!1===C&&(f=Math.atan(y/z)),a.x=d,a.y=f,a.z=e,a},geocentric_to_wgs84:function(a){if(1===this.datum_type)a.x+=this.datum_params[0],a.y+=this.datum_params[1],a.z+=this.datum_params[2];else if(2===this.datum_type){var b=
this.datum_params[3],d=this.datum_params[4],e=this.datum_params[5],c=this.datum_params[6],f=c*(e*a.x+a.y-b*a.z)+this.datum_params[1],b=c*(-d*a.x+b*a.y+a.z)+this.datum_params[2];a.x=c*(a.x-e*a.y+d*a.z)+this.datum_params[0];a.y=f;a.z=b}},geocentric_from_wgs84:function(a){if(1===this.datum_type)a.x-=this.datum_params[0],a.y-=this.datum_params[1],a.z-=this.datum_params[2];else if(2===this.datum_type){var b=this.datum_params[3],d=this.datum_params[4],e=this.datum_params[5],c=this.datum_params[6],f=(a.x-
this.datum_params[0])/c,l=(a.y-this.datum_params[1])/c,c=(a.z-this.datum_params[2])/c;a.x=f+e*l-d*c;a.y=-e*f+l+b*c;a.z=d*f-b*l+c}}};a.exports=f},{}],31:[function(l,a,d){a.exports=function(a,d,k){function m(a){return 1===a||2===a}var g,e,c;if(a.compare_datums(d)||5===a.datum_type||5===d.datum_type)return k;var l=a.a,q=a.es,r=d.a,u=d.es;g=a.datum_type;if(3===g)if(0===this.apply_gridshift(a,0,k))a.a=6378137,a.es=.006694379990141316;else{if(!a.datum_params)return a.a=l,a.es=a.es,k;g=1;e=0;for(c=a.datum_params.length;c>
e;e++)g*=a.datum_params[e];if(0===g)return a.a=l,a.es=a.es,k;g=3<a.datum_params.length?2:1}return 3===d.datum_type&&(d.a=6378137,d.es=.006694379990141316),(a.es!==d.es||a.a!==d.a||m(g)||m(d.datum_type))&&(a.geodetic_to_geocentric(k),m(a.datum_type)&&a.geocentric_to_wgs84(k),m(d.datum_type)&&d.geocentric_from_wgs84(k),d.geocentric_to_geodetic(k)),3===d.datum_type&&this.apply_gridshift(d,1,k),a.a=l,a.es=q,d.a=r,d.es=u,k}},{}],32:[function(l,a,d){function b(a){var d=this;if(2===arguments.length){var e=
arguments[1];b[a]="string"==typeof e?"+"===e.charAt(0)?f(arguments[1]):k(arguments[1]):e}else if(1===arguments.length){if(Array.isArray(a))return a.map(function(a){Array.isArray(a)?b.apply(d,a):b(a)});if("string"==typeof a){if(a in b)return b[a]}else"EPSG"in a?b["EPSG:"+a.EPSG]=a:"ESRI"in a?b["ESRI:"+a.ESRI]=a:"IAU2000"in a&&(b["IAU2000:"+a.IAU2000]=a)}}d=l("./global");var f=l("./projString"),k=l("./wkt");d(b);a.exports=b},{"./global":35,"./projString":38,"./wkt":66}],33:[function(l,a,d){var b=l("./constants/Datum"),
f=l("./constants/Ellipsoid"),k=l("./extend"),m=l("./datum");a.exports=function(a){if(a.datumCode&&"none"!==a.datumCode){var d=b[a.datumCode];d&&(a.datum_params=d.towgs84?d.towgs84.split(","):null,a.ellps=d.ellipse,a.datumName=d.datumName?d.datumName:a.datumCode)}a.a||k(a,f[a.ellps]?f[a.ellps]:f.WGS84);return a.rf&&!a.b&&(a.b=(1-1/a.rf)*a.a),(0===a.rf||1E-10>Math.abs(a.a-a.b))&&(a.sphere=!0,a.b=a.a),a.a2=a.a*a.a,a.b2=a.b*a.b,a.es=(a.a2-a.b2)/a.a2,a.e=Math.sqrt(a.es),a.R_A&&(a.a*=1-a.es*(.16666666666666666+
a.es*(.04722222222222222+.022156084656084655*a.es)),a.a2=a.a*a.a,a.b2=a.b*a.b,a.es=0),a.ep2=(a.a2-a.b2)/a.b2,a.k0||(a.k0=1),a.axis||(a.axis="enu"),a.datum||(a.datum=m(a)),a}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":30,"./extend":34}],34:[function(l,a,d){a.exports=function(a,d){a=a||{};var k,m;if(!d)return a;for(m in d)k=d[m],void 0!==k&&(a[m]=k);return a}},{}],35:[function(l,a,d){a.exports=function(a){a("EPSG:4326","+title\x3dWGS 84 (long/lat) +proj\x3dlonglat +ellps\x3dWGS84 +datum\x3dWGS84 +units\x3ddegrees");
a("EPSG:4269","+title\x3dNAD83 (long/lat) +proj\x3dlonglat +a\x3d6378137.0 +b\x3d6356752.31414036 +ellps\x3dGRS80 +datum\x3dNAD83 +units\x3ddegrees");a("EPSG:3857","+title\x3dWGS 84 / Pseudo-Mercator +proj\x3dmerc +a\x3d6378137 +b\x3d6378137 +lat_ts\x3d0.0 +lon_0\x3d0.0 +x_0\x3d0.0 +y_0\x3d0 +k\x3d1.0 +units\x3dm +nadgrids\x3d@null +no_defs");a.WGS84=a["EPSG:4326"];a["EPSG:3785"]=a["EPSG:3857"];a.GOOGLE=a["EPSG:3857"];a["EPSG:900913"]=a["EPSG:3857"];a["EPSG:102113"]=a["EPSG:3857"]}},{}],36:[function(l,
a,d){d=l("./core");d.defaultDatum="WGS84";d.Proj=l("./Proj");d.WGS84=new d.Proj("WGS84");d.Point=l("./Point");d.toPoint=l("./common/toPoint");d.defs=l("./defs");d.transform=l("./transform");d.mgrs=l("mgrs");d.version=l("../package.json").version;l("./includedProjections")(d);a.exports=d},{"../package.json":68,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":29,"./defs":32,"./includedProjections":"hTEDpn","./transform":65,mgrs:67}],37:[function(l,a,d){function b(a){return["GEOGCS","GEOCCS","PROJCS",
"LOCAL_CS"].reduce(function(b,c){return b+1+a.indexOf(c)},0)}var f=l("./defs"),k=l("./wkt"),m=l("./projString");a.exports=function(a){return"string"==typeof a?a in f?f[a]:b(a)?k(a):"+"===a[0]?m(a):void 0:a}},{"./defs":32,"./projString":38,"./wkt":66}],38:[function(l,a,d){var b=l("./constants/PrimeMeridian"),f=l("./constants/units");a.exports=function(a){var d={},g={};a.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).forEach(function(a){a=a.split("\x3d");a.push(!0);g[a[0].toLowerCase()]=
a[1]});var e,c,l={proj:"projName",datum:"datumCode",rf:function(a){d.rf=parseFloat(a)},lat_0:function(a){d.lat0=.017453292519943295*a},lat_1:function(a){d.lat1=.017453292519943295*a},lat_2:function(a){d.lat2=.017453292519943295*a},lat_ts:function(a){d.lat_ts=.017453292519943295*a},lon_0:function(a){d.long0=.017453292519943295*a},lon_1:function(a){d.long1=.017453292519943295*a},lon_2:function(a){d.long2=.017453292519943295*a},alpha:function(a){d.alpha=.017453292519943295*parseFloat(a)},lonc:function(a){d.longc=
.017453292519943295*a},x_0:function(a){d.x0=parseFloat(a)},y_0:function(a){d.y0=parseFloat(a)},k_0:function(a){d.k0=parseFloat(a)},k:function(a){d.k0=parseFloat(a)},a:function(a){d.a=parseFloat(a)},b:function(a){d.b=parseFloat(a)},r_a:function(){d.R_A=!0},zone:function(a){d.zone=parseInt(a,10)},south:function(){d.utmSouth=!0},towgs84:function(a){d.datum_params=a.split(",").map(function(a){return parseFloat(a)})},to_meter:function(a){d.to_meter=parseFloat(a)},units:function(a){d.units=a;f[a]&&(d.to_meter=
f[a].to_meter)},from_greenwich:function(a){d.from_greenwich=.017453292519943295*a},pm:function(a){d.from_greenwich=.017453292519943295*(b[a]?b[a]:parseFloat(a))},nadgrids:function(a){"@null"===a?d.datumCode="none":d.nadgrids=a},axis:function(a){3===a.length&&-1!=="ewnsud".indexOf(a.substr(0,1))&&-1!=="ewnsud".indexOf(a.substr(1,1))&&-1!=="ewnsud".indexOf(a.substr(2,1))&&(d.axis=a)}};for(e in g)a=g[e],e in l?(c=l[e],"function"==typeof c?c(a):d[c]=a):d[e]=a;return"string"==typeof d.datumCode&&"WGS84"!==
d.datumCode&&(d.datumCode=d.datumCode.toLowerCase()),d}},{"./constants/PrimeMeridian":27,"./constants/units":28}],39:[function(l,a,d){function b(a,b){var c=m.length;return a.names?(m[c]=a,a.names.forEach(function(a){k[a.toLowerCase()]=c}),this):!0}var f=[l("./projections/merc"),l("./projections/longlat")],k={},m=[];d.add=b;d.get=function(a){if(!a)return!1;a=a.toLowerCase();return"undefined"!=typeof k[a]&&m[k[a]]?m[k[a]]:void 0};d.start=function(){f.forEach(b)}},{"./projections/longlat":51,"./projections/merc":52}],
40:[function(l,a,d){var b=l("../common/msfnz"),f=l("../common/qsfnz"),k=l("../common/adjust_lon"),m=l("../common/asinz");d.init=function(){1E-10>Math.abs(this.lat1+this.lat2)||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=b(this.e3,this.sin_po,this.cos_po),this.qs1=f(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),
this.t2=this.sin_po,this.ms2=b(this.e3,this.sin_po,this.cos_po),this.qs2=f(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=f(this.e3,this.sin_po,this.cos_po),this.ns0=1E-10<Math.abs(this.lat1-this.lat2)?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)};d.forward=function(a){var b=a.x,c=a.y;this.sin_phi=
Math.sin(c);this.cos_phi=Math.cos(c);var c=f(this.e3,this.sin_phi,this.cos_phi),c=this.a*Math.sqrt(this.c-this.ns0*c)/this.ns0,d=this.ns0*k(b-this.long0),b=c*Math.sin(d)+this.x0,c=this.rh-c*Math.cos(d)+this.y0;return a.x=b,a.y=c,a};d.inverse=function(a){var b,c,d,f,m,l;return a.x-=this.x0,a.y=this.rh-a.y+this.y0,0<=this.ns0?(b=Math.sqrt(a.x*a.x+a.y*a.y),d=1):(b=-Math.sqrt(a.x*a.x+a.y*a.y),d=-1),f=0,0!==b&&(f=Math.atan2(d*a.x,d*a.y)),d=b*this.ns0/this.a,this.sphere?l=Math.asin((this.c-d*d)/(2*this.ns0)):
(c=(this.c-d*d)/this.ns0,l=this.phi1z(this.e3,c)),m=k(f/this.ns0+this.long0),a.x=m,a.y=l,a};d.phi1z=function(a,b){var c,d,f,k,l,v=m(.5*b);if(1E-10>a)return v;for(var t=a*a,w=1;25>=w;w++)if(c=Math.sin(v),d=Math.cos(v),f=a*c,k=1-f*f,l=.5*k*k/d*(b/(1-t)-c/k+.5/a*Math.log((1-f)/(1+f))),v+=l,1E-7>=Math.abs(l))return v;return null};d.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],41:[function(l,a,d){var b=l("../common/adjust_lon"),
f=Math.PI/2,k=l("../common/mlfn"),m=l("../common/e0fn"),g=l("../common/e1fn"),e=l("../common/e2fn"),c=l("../common/e3fn"),n=l("../common/gN"),q=l("../common/asinz"),r=l("../common/imlfn");d.init=function(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)};d.forward=function(a){var d,l,q,r,y,z,A,B,C,D,E,F,H,G,K,J,I,L,M,N,Q,O,T,S=a.x,R=a.y,U=Math.sin(a.y),W=Math.cos(a.y),S=b(S-this.long0);return this.sphere?1E-10>=Math.abs(this.sin_p12-1)?(a.x=this.x0+this.a*(f-R)*Math.sin(S),a.y=this.y0-
this.a*(f-R)*Math.cos(S),a):1E-10>=Math.abs(this.sin_p12+1)?(a.x=this.x0+this.a*(f+R)*Math.sin(S),a.y=this.y0+this.a*(f+R)*Math.cos(S),a):(L=this.sin_p12*U+this.cos_p12*W*Math.cos(S),J=Math.acos(L),I=J/Math.sin(J),a.x=this.x0+this.a*I*W*Math.sin(S),a.y=this.y0+this.a*I*(this.cos_p12*U-this.sin_p12*W*Math.cos(S)),a):(d=m(this.es),l=g(this.es),q=e(this.es),r=c(this.es),1E-10>=Math.abs(this.sin_p12-1)?(y=this.a*k(d,l,q,r,f),z=this.a*k(d,l,q,r,R),a.x=this.x0+(y-z)*Math.sin(S),a.y=this.y0-(y-z)*Math.cos(S),
a):1E-10>=Math.abs(this.sin_p12+1)?(y=this.a*k(d,l,q,r,f),z=this.a*k(d,l,q,r,R),a.x=this.x0+(y+z)*Math.sin(S),a.y=this.y0+(y+z)*Math.cos(S),a):(A=U/W,B=n(this.a,this.e,this.sin_p12),C=n(this.a,this.e,U),D=Math.atan((1-this.es)*A+this.es*B*this.sin_p12/(C*W)),E=Math.atan2(Math.sin(S),this.cos_p12*Math.tan(D)-this.sin_p12*Math.cos(S)),M=0===E?Math.asin(this.cos_p12*Math.sin(D)-this.sin_p12*Math.cos(D)):1E-10>=Math.abs(Math.abs(E)-Math.PI)?-Math.asin(this.cos_p12*Math.sin(D)-this.sin_p12*Math.cos(D)):
Math.asin(Math.sin(S)*Math.cos(D)/Math.sin(E)),F=this.e*this.sin_p12/Math.sqrt(1-this.es),H=this.e*this.cos_p12*Math.cos(E)/Math.sqrt(1-this.es),G=F*H,K=H*H,N=M*M,Q=N*M,O=Q*M,T=O*M,J=B*M*(1-N*K*(1-K)/6+Q/8*G*(1-2*K)+O/120*(K*(4-7*K)-3*F*F*(1-7*K))-T/48*G),a.x=this.x0+J*Math.sin(E),a.y=this.y0+J*Math.cos(E),a))};d.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var d,l,w,x,y,z,A,B,C,D,E,F,H,G,K,J,I,L,M,N,Q,O,T;return this.sphere?(d=Math.sqrt(a.x*a.x+a.y*a.y),d>2*f*this.a)?void 0:(l=d/this.a,w=Math.sin(l),
x=Math.cos(l),y=this.long0,1E-10>=Math.abs(d)?z=this.lat0:(z=q(x*this.sin_p12+a.y*w*this.cos_p12/d),A=Math.abs(this.lat0)-f,y=b(1E-10>=Math.abs(A)?0<=this.lat0?this.long0+Math.atan2(a.x,-a.y):this.long0-Math.atan2(-a.x,a.y):this.long0+Math.atan2(a.x*w,d*this.cos_p12*x-a.y*this.sin_p12*w))),a.x=y,a.y=z,a):(B=m(this.es),C=g(this.es),D=e(this.es),E=c(this.es),1E-10>=Math.abs(this.sin_p12-1)?(F=this.a*k(B,C,D,E,f),d=Math.sqrt(a.x*a.x+a.y*a.y),H=F-d,z=r(H/this.a,B,C,D,E),y=b(this.long0+Math.atan2(a.x,
-1*a.y)),a.x=y,a.y=z,a):1E-10>=Math.abs(this.sin_p12+1)?(F=this.a*k(B,C,D,E,f),d=Math.sqrt(a.x*a.x+a.y*a.y),H=d-F,z=r(H/this.a,B,C,D,E),y=b(this.long0+Math.atan2(a.x,a.y)),a.x=y,a.y=z,a):(d=Math.sqrt(a.x*a.x+a.y*a.y),J=Math.atan2(a.x,a.y),G=n(this.a,this.e,this.sin_p12),I=Math.cos(J),L=this.e*this.cos_p12*I,M=-L*L/(1-this.es),N=3*this.es*(1-M)*this.sin_p12*this.cos_p12*I/(1-this.es),Q=d/G,O=Q-M*(1+M)*Math.pow(Q,3)/6-N*(1+3*M)*Math.pow(Q,4)/24,T=1-M*O*O/2-Q*O*O*O/6,K=Math.asin(this.sin_p12*Math.cos(O)+
this.cos_p12*Math.sin(O)*I),y=b(this.long0+Math.asin(Math.sin(J)*Math.sin(O)/Math.cos(K))),z=Math.atan((1-this.es*T*this.sin_p12/Math.sin(K))*Math.tan(K)/(1-this.es)),a.x=y,a.y=z,a))};d.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(l,a,d){var b=l("../common/mlfn"),f=l("../common/e0fn"),k=l("../common/e1fn"),m=
l("../common/e2fn"),g=l("../common/e3fn"),e=l("../common/gN"),c=l("../common/adjust_lon"),n=l("../common/adjust_lat"),q=l("../common/imlfn"),r=Math.PI/2;d.init=function(){this.sphere||(this.e0=f(this.es),this.e1=k(this.es),this.e2=m(this.es),this.e3=g(this.es),this.ml0=this.a*b(this.e0,this.e1,this.e2,this.e3,this.lat0))};d.forward=function(a){var d,f,g=a.x,k=a.y;if(g=c(g-this.long0),this.sphere)d=this.a*Math.asin(Math.cos(k)*Math.sin(g)),f=this.a*(Math.atan2(Math.tan(k),Math.cos(g))-this.lat0);else{f=
Math.sin(k);var m=Math.cos(k),l=e(this.a,this.e,f),n=Math.tan(k)*Math.tan(k);d=g*Math.cos(k);var g=d*d,q=this.es*m*m/(1-this.es),k=this.a*b(this.e0,this.e1,this.e2,this.e3,k);d=l*d*(1-g*n*(1/6-(8-n+8*q)*g/120));f=k-this.ml0+l*f/m*g*(.5+(5-n+6*q)*g/24)}return a.x=d+this.x0,a.y=f+this.y0,a};d.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b,d,f=a.x/this.a;b=a.y/this.a;if(this.sphere)d=b+this.lat0,b=Math.asin(Math.sin(d)*Math.cos(f)),d=Math.atan2(Math.tan(f),Math.cos(d));else{d=q(this.ml0/this.a+
b,this.e0,this.e1,this.e2,this.e3);if(1E-10>=Math.abs(Math.abs(d)-r))return a.x=this.long0,a.y=r,0>b&&(a.y*=-1),a;b=e(this.a,this.e,Math.sin(d));var g=b*b*b/this.a/this.a*(1-this.es),k=Math.pow(Math.tan(d),2),f=f*this.a/b,m=f*f;b=d-b*Math.tan(d)/g*f*f*(.5-(1+3*k)*f*f/24);d=f*(1-m*(k/3+(1+3*k)*k*m/15))/Math.cos(d)}return a.x=c(d+this.long0),a.y=n(b),a};d.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,
"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],43:[function(l,a,d){var b=l("../common/adjust_lon"),f=l("../common/qsfnz"),k=l("../common/msfnz"),m=l("../common/iqsfnz");d.init=function(){this.sphere||(this.k0=k(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))};d.forward=function(a){var d,c;c=a.y;d=b(a.x-this.long0);this.sphere?(d=this.x0+this.a*d*Math.cos(this.lat_ts),c=this.y0+this.a*Math.sin(c)/Math.cos(this.lat_ts)):(c=f(this.e,Math.sin(c)),d=this.x0+this.a*
this.k0*d,c=this.y0+this.a*c*.5/this.k0);return a.x=d,a.y=c,a};d.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var d,c;return this.sphere?(d=b(this.long0+a.x/this.a/Math.cos(this.lat_ts)),c=Math.asin(a.y/this.a*Math.cos(this.lat_ts))):(c=m(this.e,2*a.y*this.k0/this.a),d=b(this.long0+a.x/(this.a*this.k0))),a.x=d,a.y=c,a};d.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],44:[function(l,a,d){var b=l("../common/adjust_lon"),f=l("../common/adjust_lat");
d.init=function(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Equidistant Cylindrical (Plate Carre)";this.rc=Math.cos(this.lat_ts)};d.forward=function(a){var d=a.y,g=b(a.x-this.long0),d=f(d-this.lat0);return a.x=this.x0+this.a*g*this.rc,a.y=this.y0+this.a*d,a};d.inverse=function(a){var d=a.y;return a.x=b(this.long0+(a.x-this.x0)/(this.a*this.rc)),a.y=f(this.lat0+(d-this.y0)/this.a),a};d.names=["Equirectangular",
"Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],45:[function(l,a,d){var b=l("../common/e0fn"),f=l("../common/e1fn"),k=l("../common/e2fn"),m=l("../common/e3fn"),g=l("../common/msfnz"),e=l("../common/mlfn"),c=l("../common/adjust_lon"),n=l("../common/adjust_lat"),q=l("../common/imlfn");d.init=function(){1E-10>Math.abs(this.lat1+this.lat2)||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=b(this.es),
this.e1=f(this.es),this.e2=k(this.es),this.e3=m(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=g(this.e,this.sinphi,this.cosphi),this.ml1=e(this.e0,this.e1,this.e2,this.e3,this.lat1),1E-10>Math.abs(this.lat1-this.lat2)?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=g(this.e,this.sinphi,this.cosphi),this.ml2=e(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+
this.ms1/this.ns,this.ml0=e(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))};d.forward=function(a){var b,d=a.x;b=a.y;this.sphere||(b=e(this.e0,this.e1,this.e2,this.e3,b));b=this.a*(this.g-b);var f=this.ns*c(d-this.long0),d=this.x0+b*Math.sin(f);b=this.y0+this.rh-b*Math.cos(f);return a.x=d,a.y=b,a};d.inverse=function(a){a.x-=this.x0;a.y=this.rh-a.y+this.y0;var b,d,e,f;0<=this.ns?(d=Math.sqrt(a.x*a.x+a.y*a.y),b=1):(d=-Math.sqrt(a.x*a.x+a.y*a.y),b=-1);var g=0;return(0!==
d&&(g=Math.atan2(b*a.x,b*a.y)),this.sphere)?(f=c(this.long0+g/this.ns),e=n(this.g-d/this.a),a.x=f,a.y=e,a):(e=q(this.g-d/this.a,this.e0,this.e1,this.e2,this.e3),f=c(this.long0+g/this.ns),a.x=f,a.y=e,a)};d.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],46:[function(l,a,d){var b=Math.PI/4,f=l("../common/srat"),k=Math.PI/
2;d.init=function(){var a=Math.sin(this.lat0),d=Math.cos(this.lat0),d=d*d;this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a);this.C=Math.sqrt(1+this.es*d*d/(1-this.es));this.phic0=Math.asin(a/this.C);this.ratexp=.5*this.C*this.e;this.K=Math.tan(.5*this.phic0+b)/(Math.pow(Math.tan(.5*this.lat0+b),this.C)*f(this.e*a,this.ratexp))};d.forward=function(a){var d=a.x,e=a.y;return a.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*e+b),this.C)*f(this.e*Math.sin(e),this.ratexp))-k,a.x=this.C*d,a};d.inverse=function(a){for(var d=
a.x/this.C,e=a.y,c=Math.pow(Math.tan(.5*e+b)/this.K,1/this.C),l=20;0<l&&(e=2*Math.atan(c*f(this.e*Math.sin(a.y),-.5*this.e))-k,!(1E-14>Math.abs(e-a.y)));--l)a.y=e;return l?(a.x=d,a.y=e,a):null};d.names=["gauss"]},{"../common/srat":22}],47:[function(l,a,d){var b=l("../common/adjust_lon"),f=l("../common/asinz");d.init=function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1E3*this.a;this.rc=1};d.forward=function(a){var d,f,e,c,l,q,r,u=a.y;return e=b(a.x-this.long0),
d=Math.sin(u),f=Math.cos(u),c=Math.cos(e),l=this.sin_p14*d+this.cos_p14*f*c,0<l||1E-10>=Math.abs(l)?(q=this.x0+1*this.a*f*Math.sin(e)/l,r=this.y0+1*this.a*(this.cos_p14*d-this.sin_p14*f*c)/l):(q=this.x0+this.infinity_dist*f*Math.sin(e),r=this.y0+this.infinity_dist*(this.cos_p14*d-this.sin_p14*f*c)),a.x=q,a.y=r,a};d.inverse=function(a){var d,g,e,c,l,q;return a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,(d=Math.sqrt(a.x*a.x+a.y*a.y))?(c=Math.atan2(d,this.rc),g=Math.sin(c),
e=Math.cos(c),q=f(e*this.sin_p14+a.y*g*this.cos_p14/d),l=Math.atan2(a.x*g,d*this.cos_p14*e-a.y*this.sin_p14*g),l=b(this.long0+l)):(q=this.phic0,l=0),a.x=l,a.y=q,a};d.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],48:[function(l,a,d){var b=l("../common/adjust_lon");d.init=function(){this.a=6377397.155;this.es=.006674372230614;this.e=Math.sqrt(this.es);this.lat0||(this.lat0=.863937979737193);this.long0||(this.long0=.4334234309119251);this.k0||(this.k0=.9999);this.s45=.785398163397448;
this.s90=2*this.s45;this.fi0=this.lat0;this.e2=this.es;this.e=Math.sqrt(this.e2);this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2));this.uq=1.04216856380474;this.u0=Math.asin(Math.sin(this.fi0)/this.alfa);this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2);this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g;this.k1=this.k0;this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),
2));this.s0=1.37008346281555;this.n=Math.sin(this.s0);this.ro0=this.k1*this.n0/Math.tan(this.s0);this.ad=this.s90-this.uq};d.forward=function(a){var d,m,g,e,c,l,q,r=a.y,u=b(a.x-this.long0);return d=Math.pow((1+this.e*Math.sin(r))/(1-this.e*Math.sin(r)),this.alfa*this.e/2),m=2*(Math.atan(this.k*Math.pow(Math.tan(r/2+this.s45),this.alfa)/d)-this.s45),g=-u*this.alfa,e=Math.asin(Math.cos(this.ad)*Math.sin(m)+Math.sin(this.ad)*Math.cos(m)*Math.cos(g)),c=Math.asin(Math.cos(m)*Math.sin(g)/Math.cos(e)),l=
this.n*c,q=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(e/2+this.s45),this.n),a.y=q*Math.cos(l)/1,a.x=q*Math.sin(l)/1,this.czech||(a.y*=-1,a.x*=-1),a};d.inverse=function(a){var b,d,g;b=a.x;a.x=a.y;a.y=b;this.czech||(a.y*=-1,a.x*=-1);b=Math.sqrt(a.x*a.x+a.y*a.y);d=Math.atan2(a.y,a.x)/Math.sin(this.s0);g=2*(Math.atan(Math.pow(this.ro0/b,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45);b=Math.asin(Math.cos(this.ad)*Math.sin(g)-Math.sin(this.ad)*Math.cos(g)*Math.cos(d));d=
Math.asin(Math.cos(g)*Math.sin(d)/Math.cos(b));a.x=this.long0-d/this.alfa;d=b;var e=g=0;do a.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(b/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(d))/(1-this.e*Math.sin(d)),this.e/2))-this.s45),1E-10>Math.abs(d-a.y)&&(g=1),d=a.y,e+=1;while(0===g&&15>e);return 15<=e?null:a};d.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],49:[function(l,a,d){var b=Math.PI/2,f=Math.PI/4,k=l("../common/qsfnz"),m=l("../common/adjust_lon");d.S_POLE=
1;d.N_POLE=2;d.EQUIT=3;d.OBLIQ=4;d.init=function(){var a=Math.abs(this.lat0);if(this.mode=1E-10>Math.abs(a-b)?0>this.lat0?this.S_POLE:this.N_POLE:1E-10>Math.abs(a)?this.EQUIT:this.OBLIQ,0<this.es)switch(this.qp=k(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp);this.dd=1/this.rq;this.xmf=1;this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),
a=Math.sin(this.lat0),this.sinb1=k(this.e,a)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*a*a)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))};d.forward=function(a){var d,c,l,q,r,u,v,t,w;q=a.x;var x=a.y;if(q=m(q-this.long0),this.sphere)if(r=Math.sin(x),u=Math.cos(x),l=Math.cos(q),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c=
this.mode===this.EQUIT?1+u*l:1+this.sinph0*r+this.cosph0*u*l,1E-10>=c)return null;c=Math.sqrt(2/c);d=c*u*Math.sin(q);c*=this.mode===this.EQUIT?r:this.cosph0*r-this.sinph0*u*l}else{if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(l=-l),1E-10>Math.abs(x+this.phi0))return null;c=f-.5*x;c=2*(this.mode===this.S_POLE?Math.cos(c):Math.sin(c));d=c*Math.sin(q);c*=l}}else{switch(v=0,t=0,w=0,l=Math.cos(q),q=Math.sin(q),r=Math.sin(x),u=k(this.e,r),(this.mode===this.OBLIQ||this.mode===
this.EQUIT)&&(v=u/this.qp,t=Math.sqrt(1-v*v)),this.mode){case this.OBLIQ:w=1+this.sinb1*v+this.cosb1*t*l;break;case this.EQUIT:w=1+t*l;break;case this.N_POLE:w=b+x;u=this.qp-u;break;case this.S_POLE:w=x-b,u=this.qp+u}if(1E-10>Math.abs(w))return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:w=Math.sqrt(2/w);c=this.mode===this.OBLIQ?this.ymf*w*(this.cosb1*v-this.sinb1*t*l):(w=Math.sqrt(2/(1+t*l)))*v*this.ymf;d=this.xmf*w*t*q;break;case this.N_POLE:case this.S_POLE:0<=u?(d=(w=Math.sqrt(u))*
q,c=l*(this.mode===this.S_POLE?w:-w)):d=c=0}}return a.x=this.a*d+this.x0,a.y=this.a*c+this.y0,a};d.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var d,c,f,k,l;d=a.x/this.a;var u=a.y/this.a;if(this.sphere){k=l=0;if(f=Math.sqrt(d*d+u*u),c=.5*f,1<c)return null;switch(c=2*Math.asin(c),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(k=Math.sin(c),l=Math.cos(c)),this.mode){case this.EQUIT:c=1E-10>=Math.abs(f)?0:Math.asin(u*k/f);d*=k;u=l*f;break;case this.OBLIQ:c=1E-10>=Math.abs(f)?this.phi0:Math.asin(l*
this.sinph0+u*k*this.cosph0/f);d=d*k*this.cosph0;u=(l-Math.sin(c)*this.sinph0)*f;break;case this.N_POLE:u=-u;c=b-c;break;case this.S_POLE:c-=b}d=0!==u||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(d,u):0}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(d/=this.dd,u*=this.dd,l=Math.sqrt(d*d+u*u),1E-10>l)return a.x=0,a.y=this.phi0,a;k=2*Math.asin(.5*l/this.rq);f=Math.cos(k);d*=k=Math.sin(k);this.mode===this.OBLIQ?(c=f*this.sinb1+u*k*this.cosb1/l,u=l*this.cosb1*f-u*this.sinb1*
k):(c=u*k/l,u=l*f)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(u=-u),k=d*d+u*u,!k)return a.x=0,a.y=this.phi0,a;c=1-k/this.qp;this.mode===this.S_POLE&&(c=-c)}d=Math.atan2(d,u);c=this.authlat(Math.asin(c),this.apa)}return a.x=m(this.long0+d),a.y=c,a};d.P00=.3333333333333333;d.P01=.17222222222222222;d.P02=.10257936507936508;d.P10=.06388888888888888;d.P11=.0664021164021164;d.P20=.016415012942191543;d.authset=function(a){var b,c=[];return c[0]=a*this.P00,b=a*
a,c[0]+=b*this.P01,c[1]=b*this.P10,b*=a,c[0]+=b*this.P02,c[1]+=b*this.P11,c[2]=b*this.P20,c};d.authlat=function(a,b){var c=a+a;return a+b[0]*Math.sin(c)+b[1]*Math.sin(c+c)+b[2]*Math.sin(c+c+c)};d.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],50:[function(l,a,d){var b=l("../common/msfnz"),f=l("../common/tsfnz"),k=Math.PI/2,m=l("../common/sign"),g=l("../common/adjust_lon"),e=l("../common/phi2z");d.init=function(){if(this.lat2||
(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(1E-10>Math.abs(this.lat1+this.lat2))){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var a=Math.sin(this.lat1),d=Math.cos(this.lat1),d=b(this.e,a,d),e=f(this.e,this.lat1,a),g=Math.sin(this.lat2),k=Math.cos(this.lat2),k=b(this.e,g,k),g=f(this.e,this.lat2,g),m=f(this.e,this.lat0,Math.sin(this.lat0));this.ns=1E-10<Math.abs(this.lat1-this.lat2)?Math.log(d/k)/Math.log(e/g):a;isNaN(this.ns)&&(this.ns=a);this.f0=d/(this.ns*Math.pow(e,
this.ns));this.rh=this.a*this.f0*Math.pow(m,this.ns);this.title||(this.title="Lambert Conformal Conic")}};d.forward=function(a){var b=a.x,d=a.y;1E-10>=Math.abs(2*Math.abs(d)-Math.PI)&&(d=m(d)*(k-2E-10));var e=Math.abs(Math.abs(d)-k);if(1E-10<e)d=f(this.e,d,Math.sin(d)),d=this.a*this.f0*Math.pow(d,this.ns);else{if(e=d*this.ns,0>=e)return null;d=0}b=this.ns*g(b-this.long0);return a.x=this.k0*d*Math.sin(b)+this.x0,a.y=this.k0*(this.rh-d*Math.cos(b))+this.y0,a};d.inverse=function(a){var b,d,f,m,l,t=(a.x-
this.x0)/this.k0,w=this.rh-(a.y-this.y0)/this.k0;0<this.ns?(b=Math.sqrt(t*t+w*w),d=1):(b=-Math.sqrt(t*t+w*w),d=-1);var x=0;if(0!==b&&(x=Math.atan2(d*t,d*w)),0!==b||0<this.ns){if(d=1/this.ns,f=Math.pow(b/(this.a*this.f0),d),m=e(this.e,f),-9999===m)return null}else m=-k;return l=g(x/this.ns+this.long0),a.x=l,a.y=m,a};d.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,
"../common/sign":21,"../common/tsfnz":24}],51:[function(l,a,d){function b(a){return a}d.init=function(){};d.forward=b;d.inverse=b;d.names=["longlat","identity"]},{}],52:[function(l,a,d){var b=l("../common/msfnz"),f=Math.PI/2,k=l("../common/adjust_lon"),m=Math.PI/4,g=l("../common/tsfnz"),e=l("../common/phi2z");d.init=function(){var a=this.b/this.a;this.es=1-a*a;"x0"in this||(this.x0=0);"y0"in this||(this.y0=0);this.e=Math.sqrt(this.es);this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):b(this.e,
Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)};d.forward=function(a){var b=a.x,d=a.y;if(90<57.29577951308232*d&&-90>57.29577951308232*d&&180<57.29577951308232*b&&-180>57.29577951308232*b||1E-10>=Math.abs(Math.abs(d)-f))return null;if(this.sphere)b=this.x0+this.a*this.k0*k(b-this.long0),d=this.y0+this.a*this.k0*Math.log(Math.tan(m+.5*d));else var e=Math.sin(d),d=g(this.e,d,e),b=this.x0+this.a*this.k0*k(b-this.long0),d=this.y0-this.a*this.k0*Math.log(d);return a.x=
b,a.y=d,a};d.inverse=function(a){var b,d,g=a.x-this.x0,m=a.y-this.y0;if(this.sphere)d=f-2*Math.atan(Math.exp(-m/(this.a*this.k0)));else if(m=Math.exp(-m/(this.a*this.k0)),d=e(this.e,m),-9999===d)return null;return b=k(this.long0+g/(this.a*this.k0)),a.x=b,a.y=d,a};d.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],53:[function(l,a,d){var b=l("../common/adjust_lon");
d.init=function(){};d.forward=function(a){var d=a.y,m=b(a.x-this.long0),m=this.x0+this.a*m,d=this.y0+this.a*Math.log(Math.tan(Math.PI/4+d/2.5))*1.25;return a.x=m,a.y=d,a};d.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var d=b(this.long0+a.x/this.a),m=2.5*(Math.atan(Math.exp(.8*a.y/this.a))-Math.PI/4);return a.x=d,a.y=m,a};d.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],54:[function(l,a,d){var b=l("../common/adjust_lon");d.init=function(){};d.forward=function(a){for(var d=a.y,m=
b(a.x-this.long0),g=d,e=Math.PI*Math.sin(d),c=0;;c++){var l=-(g+Math.sin(g)-e)/(1+Math.cos(g));if(g+=l,1E-10>Math.abs(l))break}g/=2;1E-10>Math.PI/2-Math.abs(d)&&(m=0);d=.900316316158*this.a*m*Math.cos(g)+this.x0;g=1.4142135623731*this.a*Math.sin(g)+this.y0;return a.x=d,a.y=g,a};d.inverse=function(a){var d;a.x-=this.x0;a.y-=this.y0;d=a.y/(1.4142135623731*this.a);.999999999999<Math.abs(d)&&(d=.999999999999);d=Math.asin(d);var m=b(this.long0+a.x/(.900316316158*this.a*Math.cos(d)));m<-Math.PI&&(m=-Math.PI);
m>Math.PI&&(m=Math.PI);d=(2*d+Math.sin(2*d))/Math.PI;1<Math.abs(d)&&(d=1);d=Math.asin(d);return a.x=m,a.y=d,a};d.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],55:[function(l,a,d){d.iterations=1;d.init=function(){this.A=[];this.A[1]=.6399175073;this.A[2]=-.1358797613;this.A[3]=.063294409;this.A[4]=-.02526853;this.A[5]=.0117879;this.A[6]=-.0055161;this.A[7]=.0026906;this.A[8]=-.001333;this.A[9]=6.7E-4;this.A[10]=-3.4E-4;this.B_re=[];this.B_im=[];this.B_re[1]=.7557853228;this.B_im[1]=0;this.B_re[2]=
.249204646;this.B_im[2]=.003371507;this.B_re[3]=-.001541739;this.B_im[3]=.04105856;this.B_re[4]=-.10162907;this.B_im[4]=.01727609;this.B_re[5]=-.26623489;this.B_im[5]=-.36249218;this.B_re[6]=-.6870983;this.B_im[6]=-1.1651967;this.C_re=[];this.C_im=[];this.C_re[1]=1.3231270439;this.C_im[1]=0;this.C_re[2]=-.577245789;this.C_im[2]=-.007809598;this.C_re[3]=.508307513;this.C_im[3]=-.112208952;this.C_re[4]=-.15094762;this.C_im[4]=.18200602;this.C_re[5]=1.01418179;this.C_im[5]=1.64497696;this.C_re[6]=1.9660549;
this.C_im[6]=2.5127645;this.D=[];this.D[1]=1.5627014243;this.D[2]=.5185406398;this.D[3]=-.03333098;this.D[4]=-.1052906;this.D[5]=-.0368594;this.D[6]=.007317;this.D[7]=.0122;this.D[8]=.00394;this.D[9]=-.0013};d.forward=function(a){var d,k=(a.y-this.lat0)/4.84813681109536E-6*1E-5,m=a.x-this.long0,g=1,e=0;for(d=1;10>=d;d++)g*=k,e+=this.A[d]*g;var c,g=e,e=1,l=c=0,q=0;for(d=1;6>=d;d++)k=e*g-c*m,c=c*g+e*m,e=k,l=l+this.B_re[d]*e-this.B_im[d]*c,q=q+this.B_im[d]*e+this.B_re[d]*c;return a.x=q*this.a+this.x0,
a.y=l*this.a+this.y0,a};d.inverse=function(a){var d,k,m,g=(a.y-this.y0)/this.a,e=(a.x-this.x0)/this.a,c=1,l=m=0,q=0;for(d=1;6>=d;d++)k=c*g-m*e,m=m*g+c*e,c=k,l=l+this.C_re[d]*c-this.C_im[d]*m,q=q+this.C_im[d]*c+this.C_re[d]*m;for(k=0;k<this.iterations;k++){var r,u,v=l;u=q;c=g;m=e;for(d=2;6>=d;d++)r=v*l-u*q,u=u*l+v*q,v=r,c+=(d-1)*(this.B_re[d]*v-this.B_im[d]*u),m+=(d-1)*(this.B_im[d]*v+this.B_re[d]*u);v=1;u=0;var t=this.B_re[1],w=this.B_im[1];for(d=2;6>=d;d++)r=v*l-u*q,u=u*l+v*q,v=r,t+=d*(this.B_re[d]*
v-this.B_im[d]*u),w+=d*(this.B_im[d]*v+this.B_re[d]*u);q=t*t+w*w;l=(c*t+m*w)/q;q=(m*t-c*w)/q}g=l;e=1;l=0;for(d=1;9>=d;d++)e*=g,l+=this.D[d]*e;d=this.lat0+.484813681109536*l;return a.x=this.long0+q,a.y=d,a};d.names=["New_Zealand_Map_Grid","nzmg"]},{}],56:[function(l,a,d){var b=l("../common/tsfnz"),f=l("../common/adjust_lon"),k=l("../common/phi2z"),m=Math.PI/2,g=Math.PI/4;d.init=function(){this.no_off=this.no_off||!1;this.no_rot=this.no_rot||!1;isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),
c=Math.cos(this.lat0),d=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(c,4));this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-d*d);a=b(this.e,this.lat0,a);c=this.bl/c*Math.sqrt((1-this.es)/(1-d*d));1>c*c&&(c=1);var g;if(isNaN(this.longc)){d=b(this.e,this.lat1,Math.sin(this.lat1));g=b(this.e,this.lat2,Math.sin(this.lat2));this.el=0<=this.lat0?(c+Math.sqrt(c*c-1))*Math.pow(a,this.bl):(c-Math.sqrt(c*c-1))*Math.pow(a,this.bl);var d=Math.pow(d,this.bl),k=Math.pow(g,this.bl);g=this.el/
d;a=.5*(g-1/g);g=(this.el*this.el-k*d)/(this.el*this.el+k*d);d=(k-d)/(k+d);k=f(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(g*Math.tan(.5*this.bl*k)/d)/this.bl;this.long0=f(this.long0);d=f(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*d)/a);this.alpha=Math.asin(c*Math.sin(this.gamma0))}else g=0<=this.lat0?c+Math.sqrt(c*c-1):c-Math.sqrt(c*c-1),this.el=g*Math.pow(a,this.bl),a=.5*(g-1/g),this.gamma0=Math.asin(Math.sin(this.alpha)/c),this.long0=this.longc-Math.asin(a*
Math.tan(this.gamma0))/this.bl;this.uc=this.no_off?0:0<=this.lat0?this.al/this.bl*Math.atan2(Math.sqrt(c*c-1),Math.cos(this.alpha)):-1*this.al/this.bl*Math.atan2(Math.sqrt(c*c-1),Math.cos(this.alpha))};d.forward=function(a){var c,d,k=a.y;c=f(a.x-this.long0);if(1E-10>=Math.abs(Math.abs(k)-m))c=0<k?-1:1,d=this.al/this.bl*Math.log(Math.tan(g+c*this.gamma0*.5)),c=-1*c*m*this.al/this.bl;else{k=b(this.e,k,Math.sin(k));d=this.el/Math.pow(k,this.bl);k=.5*(d-1/d);d=.5*(d+1/d);var l=Math.sin(this.bl*c);d=(k*
Math.sin(this.gamma0)-l*Math.cos(this.gamma0))/d;d=1E-10>=Math.abs(Math.abs(d)-1)?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-d)/(1+d))/this.bl;c=1E-10>=Math.abs(Math.cos(this.bl*c))?this.al*this.bl*c:this.al*Math.atan2(k*Math.cos(this.gamma0)+l*Math.sin(this.gamma0),Math.cos(this.bl*c))/this.bl}return this.no_rot?(a.x=this.x0+c,a.y=this.y0+d):(c-=this.uc,a.x=this.x0+d*Math.cos(this.alpha)+c*Math.sin(this.alpha),a.y=this.y0+c*Math.cos(this.alpha)-d*Math.sin(this.alpha)),a};d.inverse=function(a){var b,
d;this.no_rot?(d=a.y-this.y0,b=a.x-this.x0):(d=(a.x-this.x0)*Math.cos(this.alpha)-(a.y-this.y0)*Math.sin(this.alpha),b=(a.y-this.y0)*Math.cos(this.alpha)+(a.x-this.x0)*Math.sin(this.alpha),b+=this.uc);var g=Math.exp(-1*this.bl*d/this.al);d=.5*(g-1/g);var l=.5*(g+1/g),g=Math.sin(this.bl*b/this.al),l=(g*Math.cos(this.gamma0)+d*Math.sin(this.gamma0))/l,u=Math.pow(this.el/Math.sqrt((1+l)/(1-l)),1/this.bl);return 1E-10>Math.abs(l-1)?(a.x=this.long0,a.y=m):1E-10>Math.abs(l+1)?(a.x=this.long0,a.y=-1*m):
(a.y=k(this.e,u),a.x=f(this.long0-Math.atan2(d*Math.cos(this.gamma0)-g*Math.sin(this.gamma0),Math.cos(this.bl*b/this.al))/this.bl)),a};d.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],57:[function(l,a,d){var b=l("../common/e0fn"),f=l("../common/e1fn"),k=l("../common/e2fn"),m=l("../common/e3fn"),g=l("../common/adjust_lon"),
e=l("../common/adjust_lat"),c=l("../common/mlfn"),n=l("../common/gN");d.init=function(){this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=b(this.es);this.e1=f(this.es);this.e2=k(this.es);this.e3=m(this.es);this.ml0=this.a*c(this.e0,this.e1,this.e2,this.e3,this.lat0)};d.forward=function(a){var b,d,f,k=a.y,m=g(a.x-this.long0);(f=m*Math.sin(k),this.sphere)?1E-10>=Math.abs(k)?(b=this.a*m,d=-1*this.a*this.lat0):(b=this.a*Math.sin(f)/Math.tan(k),d=this.a*(e(k-this.lat0)+
(1-Math.cos(f))/Math.tan(k))):1E-10>=Math.abs(k)?(b=this.a*m,d=-1*this.ml0):(d=n(this.a,this.e,Math.sin(k))/Math.tan(k),b=d*Math.sin(f),d=this.a*c(this.e0,this.e1,this.e2,this.e3,k)-this.ml0+d*(1-Math.cos(f)));return a.x=b+this.x0,a.y=d+this.y0,a};d.inverse=function(a){var b,d,e,f,k,m,l;if(b=a.x-this.x0,e=a.y-this.y0,this.sphere)if(1E-10>=Math.abs(e+this.a*this.lat0))b=g(b/this.a+this.long0),d=0;else{f=this.lat0+e/this.a;k=b*b/this.a/this.a+f*f;m=f;var n;for(e=20;e;--e)if(n=Math.tan(m),l=-1*(f*(m*
n+1)-m-.5*(m*m+k)*n)/((m-f)/n-1),m+=l,1E-10>=Math.abs(l)){d=m;break}b=g(this.long0+Math.asin(b*Math.tan(m)/this.a)/Math.sin(d))}else if(1E-10>=Math.abs(e+this.ml0))d=0,b=g(this.long0+b/this.a);else{f=(this.ml0+e)/this.a;k=b*b/this.a/this.a+f*f;m=f;var A,B,C,D,E;for(e=20;e;--e)if(E=this.e*Math.sin(m),A=Math.sqrt(1-E*E)*Math.tan(m),B=this.a*c(this.e0,this.e1,this.e2,this.e3,m),C=this.e0-2*this.e1*Math.cos(2*m)+4*this.e2*Math.cos(4*m)-6*this.e3*Math.cos(6*m),D=B/this.a,l=(f*(A*D+1)-D-.5*A*(D*D+k))/(this.es*
Math.sin(2*m)*(D*D+k-2*f*D)/(4*A)+(f-D)*(A*C-2/Math.sin(2*m))-C),m-=l,1E-10>=Math.abs(l)){d=m;break}A=Math.sqrt(1-this.es*Math.pow(Math.sin(d),2))*Math.tan(d);b=g(this.long0+Math.asin(b*A/this.a)/Math.sin(d))}return a.x=b,a.y=d,a};d.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],58:[function(l,a,d){var b=l("../common/adjust_lon"),f=l("../common/adjust_lat"),
k=l("../common/pj_enfn"),m=l("../common/pj_mlfn"),g=l("../common/pj_inv_mlfn"),e=Math.PI/2,c=l("../common/asinz");d.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=k(this.es)};d.forward=function(a){var c,d;c=a.x;d=a.y;if(c=b(c-this.long0),this.sphere){if(this.m)for(var e=this.n*Math.sin(d),f=20;f;--f){var g=(this.m*d+Math.sin(d)-e)/(this.m+Math.cos(d));if(d-=g,1E-10>Math.abs(g))break}else d=1!==this.n?Math.asin(this.n*
Math.sin(d)):d;c=this.a*this.C_x*c*(this.m+Math.cos(d));d*=this.a*this.C_y}else e=Math.sin(d),f=Math.cos(d),d=this.a*m(d,e,f,this.en),c=this.a*c*f/Math.sqrt(1-this.es*e*e);return a.x=c,a.y=d,a};d.inverse=function(a){var d,k,m,l;return a.x-=this.x0,m=a.x/this.a,a.y-=this.y0,d=a.y/this.a,this.sphere?(d/=this.C_y,m/=this.C_x*(this.m+Math.cos(d)),this.m?d=c((this.m*d+Math.sin(d))/this.n):1!==this.n&&(d=c(Math.sin(d)/this.n)),m=b(m+this.long0),d=f(d)):(d=g(a.y/this.a,this.es,this.en),l=Math.abs(d),e>l?
(l=Math.sin(d),k=this.long0+a.x*Math.sqrt(1-this.es*l*l)/(this.a*Math.cos(d)),m=b(k)):e>l-1E-10&&(m=this.long0)),a.x=m,a.y=d,a};d.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],59:[function(l,a,d){d.init=function(){var a=this.lat0;this.lambda0=this.long0;var d=Math.sin(a),k=this.a,m=1/this.rf,g=2*m-Math.pow(m,2),m=this.e=Math.sqrt(g);this.R=this.k0*k*Math.sqrt(1-g)/(1-g*
Math.pow(d,2));this.alpha=Math.sqrt(1+g/(1-g)*Math.pow(Math.cos(a),4));this.b0=Math.asin(d/this.alpha);k=Math.log(Math.tan(Math.PI/4+this.b0/2));a=Math.log(Math.tan(Math.PI/4+a/2));d=Math.log((1+m*d)/(1-m*d));this.K=k-this.alpha*a+this.alpha*m/2*d};d.forward=function(a){var d=Math.log(Math.tan(Math.PI/4-a.y/2)),k=this.e/2*Math.log((1+this.e*Math.sin(a.y))/(1-this.e*Math.sin(a.y))),k=2*(Math.atan(Math.exp(-this.alpha*(d+k)+this.K))-Math.PI/4),m=this.alpha*(a.x-this.lambda0),d=Math.atan(Math.sin(m)/
(Math.sin(this.b0)*Math.tan(k)+Math.cos(this.b0)*Math.cos(m))),k=Math.asin(Math.cos(this.b0)*Math.sin(k)-Math.sin(this.b0)*Math.cos(k)*Math.cos(m));return a.y=this.R/2*Math.log((1+Math.sin(k))/(1-Math.sin(k)))+this.y0,a.x=this.R*d+this.x0,a};d.inverse=function(a){for(var d=(a.x-this.x0)/this.R,k=2*(Math.atan(Math.exp((a.y-this.y0)/this.R))-Math.PI/4),m=Math.asin(Math.cos(this.b0)*Math.sin(k)+Math.sin(this.b0)*Math.cos(k)*Math.cos(d)),d=Math.atan(Math.sin(d)/(Math.cos(this.b0)*Math.cos(d)-Math.sin(this.b0)*
Math.tan(k))),d=this.lambda0+d/this.alpha,k=0,g=m,e=-1E3,c=0;1E-7<Math.abs(g-e);){if(20<++c)return;k=1/this.alpha*(Math.log(Math.tan(Math.PI/4+m/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(g))/2));e=g;g=2*Math.atan(Math.exp(k))-Math.PI/2}return a.x=d,a.y=g,a};d.names=["somerc"]},{}],60:[function(l,a,d){var b=Math.PI/2,f=l("../common/sign"),k=l("../common/msfnz"),m=l("../common/tsfnz"),g=l("../common/phi2z"),e=l("../common/adjust_lon");d.ssfn_=function(a,d,e){return d*=
e,Math.tan(.5*(b+a))*Math.pow((1-d)/(1+d),.5*e)};d.init=function(){this.coslat0=Math.cos(this.lat0);this.sinlat0=Math.sin(this.lat0);this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&1E-10>=Math.abs(this.coslat0)&&(this.k0=.5*(1+f(this.lat0)*Math.sin(this.lat_ts))):(1E-10>=Math.abs(this.coslat0)&&(this.con=0<this.lat0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&1E-10>=Math.abs(this.coslat0)&&(this.k0=.5*this.cons*k(this.e,Math.sin(this.lat_ts),
Math.cos(this.lat_ts))/m(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=k(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-b,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))};d.forward=function(a){var d,f,g,k,l,t,w=a.x,x=a.y,y=Math.sin(x),z=Math.cos(x),A=e(w-this.long0);return 1E-10>=Math.abs(Math.abs(w-this.long0)-Math.PI)&&1E-10>=Math.abs(x+this.lat0)?(a.x=0/0,a.y=0/0,a):this.sphere?(d=2*this.k0/(1+this.sinlat0*y+this.coslat0*
z*Math.cos(A)),a.x=this.a*d*z*Math.sin(A)+this.x0,a.y=this.a*d*(this.coslat0*y-this.sinlat0*z*Math.cos(A))+this.y0,a):(f=2*Math.atan(this.ssfn_(x,y,this.e))-b,k=Math.cos(f),g=Math.sin(f),1E-10>=Math.abs(this.coslat0)?(l=m(this.e,x*this.con,this.con*y),t=2*this.a*this.k0*l/this.cons,a.x=this.x0+t*Math.sin(w-this.long0),a.y=this.y0-this.con*t*Math.cos(w-this.long0),a):(1E-10>Math.abs(this.sinlat0)?(d=2*this.a*this.k0/(1+k*Math.cos(A)),a.y=d*g):(d=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*
g+this.cosX0*k*Math.cos(A))),a.y=d*(this.cosX0*g-this.sinX0*k*Math.cos(A))+this.y0),a.x=d*k*Math.sin(A)+this.x0,a))};d.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var d,f,k,m=Math.sqrt(a.x*a.x+a.y*a.y);if(this.sphere)return k=2*Math.atan(m/(.5*this.a*this.k0)),d=this.long0,f=this.lat0,1E-10>=m?(a.x=d,a.y=f,a):(f=Math.asin(Math.cos(k)*this.sinlat0+a.y*Math.sin(k)*this.coslat0/m),d=e(1E-10>Math.abs(this.coslat0)?0<this.lat0?this.long0+Math.atan2(a.x,-1*a.y):this.long0+Math.atan2(a.x,a.y):this.long0+
Math.atan2(a.x*Math.sin(k),m*this.coslat0*Math.cos(k)-a.y*this.sinlat0*Math.sin(k))),a.x=d,a.y=f,a);if(1E-10>=Math.abs(this.coslat0)){if(1E-10>=m)return f=this.lat0,d=this.long0,a.x=d,a.y=f,a;a.x*=this.con;a.y*=this.con;d=m*this.cons/(2*this.a*this.k0);f=this.con*g(this.e,d);d=this.con*e(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else f=2*Math.atan(m*this.cosX0/(2*this.a*this.k0*this.ms1)),d=this.long0,1E-10>=m?k=this.X0:(k=Math.asin(Math.cos(f)*this.sinX0+a.y*Math.sin(f)*this.cosX0/m),d=e(this.long0+
Math.atan2(a.x*Math.sin(f),m*this.cosX0*Math.cos(f)-a.y*this.sinX0*Math.sin(f)))),f=-1*g(this.e,Math.tan(.5*(b+k)));return a.x=d,a.y=f,a};d.names=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],61:[function(l,a,d){var b=l("./gauss"),f=l("../common/adjust_lon");d.init=function(){b.init.apply(this);this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),
this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))};d.forward=function(a){var d,g,e,c;return a.x=f(a.x-this.long0),b.forward.apply(this,[a]),d=Math.sin(a.y),g=Math.cos(a.y),e=Math.cos(a.x),c=this.k0*this.R2/(1+this.sinc0*d+this.cosc0*g*e),a.x=c*g*Math.sin(a.x),a.y=c*(this.cosc0*d-this.sinc0*g*e),a.x=this.a*a.x+this.x0,a.y=this.a*a.y+this.y0,a};d.inverse=function(a){var d,g,e,c;(a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,c=Math.sqrt(a.x*
a.x+a.y*a.y))?(e=2*Math.atan2(c,this.R2),d=Math.sin(e),g=Math.cos(e),e=Math.asin(g*this.sinc0+a.y*d*this.cosc0/c),d=Math.atan2(a.x*d,c*this.cosc0*g-a.y*this.sinc0*d)):(e=this.phic0,d=0);return a.x=d,a.y=e,b.inverse.apply(this,[a]),a.x=f(a.x+this.long0),a};d.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":46}],62:[function(l,a,d){var b=l("../common/e0fn"),f=l("../common/e1fn"),k=l("../common/e2fn"),
m=l("../common/e3fn"),g=l("../common/mlfn"),e=l("../common/adjust_lon"),c=Math.PI/2,n=l("../common/sign"),q=l("../common/asinz");d.init=function(){this.e0=b(this.es);this.e1=f(this.es);this.e2=k(this.es);this.e3=m(this.es);this.ml0=this.a*g(this.e0,this.e1,this.e2,this.e3,this.lat0)};d.forward=function(a){var b,c,d;d=a.y;var f=e(a.x-this.long0);b=Math.sin(d);var k=Math.cos(d);if(this.sphere){var m=k*Math.sin(f);if(1E-10>Math.abs(Math.abs(m)-1))return 93;c=.5*this.a*this.k0*Math.log((1+m)/(1-m));b=
Math.acos(k*Math.cos(f)/Math.sqrt(1-m*m));0>d&&(b=-b);d=this.a*this.k0*(b-this.lat0)}else{c=k*f;var f=Math.pow(c,2),k=this.ep2*Math.pow(k,2),m=Math.tan(d),l=Math.pow(m,2);b=1-this.es*Math.pow(b,2);b=this.a/Math.sqrt(b);d=this.a*g(this.e0,this.e1,this.e2,this.e3,d);c=this.k0*b*c*(1+f/6*(1-l+k+f/20*(5-18*l+Math.pow(l,2)+72*k-58*this.ep2)))+this.x0;d=this.k0*(d-this.ml0+b*m*f*(.5+f/24*(5-l+9*k+4*Math.pow(k,2)+f/30*(61-58*l+Math.pow(l,2)+600*k-330*this.ep2))))+this.y0}return a.x=c,a.y=d,a};d.inverse=
function(a){var b,d,f,g;if(this.sphere){d=Math.exp(a.x/(this.a*this.k0));var k=.5*(d-1/d);f=this.lat0+a.y/(this.a*this.k0);g=Math.cos(f);b=Math.sqrt((1-g*g)/(1+k*k));d=q(b);0>f&&(d=-d);b=0===k&&0===g?this.long0:e(Math.atan2(k,g)+this.long0)}else{var k=a.x-this.x0,m=a.y-this.y0;d=b=(this.ml0+m/this.k0)/this.a;for(g=0;f=(b+this.e1*Math.sin(2*d)-this.e2*Math.sin(4*d)+this.e3*Math.sin(6*d))/this.e0-d,d+=f,!(1E-10>=Math.abs(f));g++)if(6<=g)return 95;if(Math.abs(d)<c){b=Math.sin(d);f=Math.cos(d);var l=
Math.tan(d);g=this.ep2*Math.pow(f,2);var m=Math.pow(g,2),A=Math.pow(l,2),B=Math.pow(A,2);b=1-this.es*Math.pow(b,2);var C=this.a/Math.sqrt(b);b=C*(1-this.es)/b;var k=k/(C*this.k0),D=Math.pow(k,2);d-=C*l*D/b*(.5-D/24*(5+3*A+10*g-4*m-9*this.ep2-D/30*(61+90*A+298*g+45*B-252*this.ep2-3*m)));b=e(this.long0+k*(1-D/6*(1+2*A+g-D/20*(5-2*g+28*A-3*m+8*this.ep2+24*B)))/f)}else d=c*n(m),b=this.long0}return a.x=b,a.y=d,a};d.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,
"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],63:[function(l,a,d){var b=l("./tmerc");d.dependsOn="tmerc";d.init=function(){this.zone&&(this.lat0=0,this.long0=.017453292519943295*(6*Math.abs(this.zone)-183),this.x0=5E5,this.y0=this.utmSouth?1E7:0,this.k0=.9996,b.init.apply(this),this.forward=b.forward,this.inverse=b.inverse)};d.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":62}],64:[function(l,
a,d){var b=l("../common/adjust_lon"),f=Math.PI/2,k=l("../common/asinz");d.init=function(){this.R=this.a};d.forward=function(a){var d,e,c=a.y;d=b(a.x-this.long0);1E-10>=Math.abs(c)&&(e=this.y0);var l=k(2*Math.abs(c/Math.PI));(1E-10>=Math.abs(d)||1E-10>=Math.abs(Math.abs(c)-f))&&(e=0<=c?this.y0+Math.PI*this.R*Math.tan(.5*l):this.y0+Math.PI*this.R*-Math.tan(.5*l));var q=.5*Math.abs(Math.PI/d-d/Math.PI),r=q*q,u=Math.sin(l),l=Math.cos(l),l=l/(u+l-1),u=l*(2/u-1),v=u*u,t=Math.PI*this.R*(q*(l-v)+Math.sqrt(r*
(l-v)*(l-v)-(v+r)*(l*l-v)))/(v+r);0>d&&(t=-t);d=this.x0+t;l=r+l;return t=Math.PI*this.R*(u*l-q*Math.sqrt((v+r)*(r+1)-l*l))/(v+r),e=0<=c?this.y0+t:this.y0-t,a.x=d,a.y=e,a};d.inverse=function(a){var d,e,c,f,k,l,u,v,t,w,x,y,z;return a.x-=this.x0,a.y-=this.y0,x=Math.PI*this.R,c=a.x/x,f=a.y/x,k=c*c+f*f,l=-Math.abs(f)*(1+k),u=l-2*f*f+c*c,v=-2*l+1+2*f*f+k*k,z=f*f/v+(2*u*u*u/v/v/v-9*l*u/v/v)/27,t=(l-u*u/3/v)/v,w=2*Math.sqrt(-t/3),x=3*z/t/w,1<Math.abs(x)&&(x=0<=x?1:-1),y=Math.acos(x)/3,e=0<=a.y?(-w*Math.cos(y+
Math.PI/3)-u/3/v)*Math.PI:-(-w*Math.cos(y+Math.PI/3)-u/3/v)*Math.PI,d=1E-10>Math.abs(c)?this.long0:b(this.long0+Math.PI*(k-1+Math.sqrt(1+2*(c*c-f*f)+k*k))/2/c),a.x=d,a.y=e,a};d.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],65:[function(l,a,d){var b=l("./datum_transform"),f=l("./adjust_axis"),k=l("./Proj"),m=l("./common/toPoint");a.exports=function e(a,d,l){var r;return Array.isArray(l)&&(l=m(l)),a.datum&&d.datum&&((1===a.datum.datum_type||2===
a.datum.datum_type)&&"WGS84"!==d.datumCode||(1===d.datum.datum_type||2===d.datum.datum_type)&&"WGS84"!==a.datumCode)&&(r=new k("WGS84"),e(a,r,l),a=r),"enu"!==a.axis&&f(a,!1,l),"longlat"===a.projName?(l.x*=.017453292519943295,l.y*=.017453292519943295):(a.to_meter&&(l.x*=a.to_meter,l.y*=a.to_meter),a.inverse(l)),a.from_greenwich&&(l.x+=a.from_greenwich),l=b(a.datum,d.datum,l),d.from_greenwich&&(l.x-=d.from_greenwich),"longlat"===d.projName?(l.x*=57.29577951308232,l.y*=57.29577951308232):(d.forward(l),
d.to_meter&&(l.x/=d.to_meter,l.y/=d.to_meter)),"enu"!==d.axis&&f(d,!0,l),l}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":31}],66:[function(l,a,d){function b(a,b,d){a[b]=d.map(function(a){var b={};return f(a,b),b}).reduce(function(a,b){return e(a,b)},{})}function f(a,d){var e;return Array.isArray(a)?(e=a.shift(),"PARAMETER"===e&&(e=a.shift()),1===a.length?Array.isArray(a[0])?(d[e]={},f(a[0],d[e])):d[e]=a[0]:a.length?"TOWGS84"===e?d[e]=a:(d[e]={},-1<["UNIT","PRIMEM","VERT_DATUM"].indexOf(e)?
(d[e]={name:a[0].toLowerCase(),convert:a[1]},3===a.length&&(d[e].auth=a[2])):"SPHEROID"===e?(d[e]={name:a[0],a:a[1],rf:a[2]},4===a.length&&(d[e].auth=a[3])):-1<"GEOGCS GEOCCS DATUM VERT_CS COMPD_CS LOCAL_CS FITTED_CS LOCAL_DATUM".split(" ").indexOf(e)?(a[0]=["name",a[0]],b(d,e,a)):a.every(function(a){return Array.isArray(a)})?b(d,e,a):f(a,d[e])):d[e]=!0,void 0):void(d[a]=!0)}function k(a){return a*g}function m(a){function b(d){var e=a.to_meter||1;return parseFloat(d,10)*e}"GEOGCS"===a.type?a.projName=
"longlat":"LOCAL_CS"===a.type?(a.projName="identity",a.local=!0):a.projName="object"==typeof a.PROJECTION?Object.keys(a.PROJECTION)[0]:a.PROJECTION;a.UNIT&&(a.units=a.UNIT.name.toLowerCase(),"metre"===a.units&&(a.units="meter"),a.UNIT.convert&&(a.to_meter=parseFloat(a.UNIT.convert,10)));a.GEOGCS&&(a.datumCode=a.GEOGCS.DATUM?a.GEOGCS.DATUM.name.toLowerCase():a.GEOGCS.name.toLowerCase(),"d_"===a.datumCode.slice(0,2)&&(a.datumCode=a.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===a.datumCode||
"new_zealand_1949"===a.datumCode)&&(a.datumCode="nzgd49"),"wgs_1984"===a.datumCode&&("Mercator_Auxiliary_Sphere"===a.PROJECTION&&(a.sphere=!0),a.datumCode="wgs84"),"_ferro"===a.datumCode.slice(-6)&&(a.datumCode=a.datumCode.slice(0,-6)),"_jakarta"===a.datumCode.slice(-8)&&(a.datumCode=a.datumCode.slice(0,-8)),~a.datumCode.indexOf("belge")&&(a.datumCode="rnb72"),a.GEOGCS.DATUM&&a.GEOGCS.DATUM.SPHEROID&&(a.ellps=a.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===
a.ellps.toLowerCase().slice(0,13)&&(a.ellps="intl"),a.a=a.GEOGCS.DATUM.SPHEROID.a,a.rf=parseFloat(a.GEOGCS.DATUM.SPHEROID.rf,10)),~a.datumCode.indexOf("osgb_1936")&&(a.datumCode="osgb36"));a.b&&!isFinite(a.b)&&(a.b=a.a);[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],
["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",k],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",k],["x0","false_easting",b],["y0","false_northing",b],["long0","central_meridian",k],["lat0","latitude_of_origin",k],["lat0","standard_parallel_1",k],["lat1","standard_parallel_1",k],["lat2","standard_parallel_2",k],["alpha","azimuth",k],["srsCode","name"]].forEach(function(b){var d=b[0],e=b[1];
!(d in a)&&e in a&&(a[d]=a[e],3===b.length&&(a[d]=b[2](a[d])))});a.long0||!a.longc||"Albers_Conic_Equal_Area"!==a.projName&&"Lambert_Azimuthal_Equal_Area"!==a.projName||(a.long0=a.longc);a.lat_ts||!a.lat1||"Stereographic_South_Pole"!==a.projName&&"Polar Stereographic (variant B)"!==a.projName||(a.lat0=(0<a.lat1?90:-90)*g,a.lat_ts=a.lat1)}var g=.017453292519943295,e=l("./extend");a.exports=function(a,b){var d=JSON.parse((","+a).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,
',"$1"]').replace(/,\["VERTCS".+/,"")),g=d.shift(),k=d.shift();d.unshift(["name",k]);d.unshift(["type",g]);d.unshift("output");g={};return f(d,g),m(g.output),e(b,g.output)}},{"./extend":34}],67:[function(l,a,d){function b(a){var d=a.northing,c=a.easting,f=a.zoneLetter,k=a.zoneNumber;if(0>k||60<k)return null;var m,l,v;l=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562));c-=5E5;"N">f&&(d-=1E7);f=6*(k-1)-180+3;k=d/.9996/6367449.145945056;d=k+(3*l/2-27*l*l*l/32)*Math.sin(2*k)+(21*l*l/16-55*l*l*l*l/32)*
Math.sin(4*k)+151*l*l*l/96*Math.sin(6*k);m=6378137/Math.sqrt(1-.00669438*Math.sin(d)*Math.sin(d));l=Math.tan(d)*Math.tan(d);k=.006739496752268451*Math.cos(d)*Math.cos(d);v=6335439.32722994/Math.pow(1-.00669438*Math.sin(d)*Math.sin(d),1.5);c/=.9996*m;m=d-m*Math.tan(d)/v*(c*c/2-(5+3*l+10*k-4*k*k-.06065547077041606)*c*c*c*c/24+(61+90*l+298*k+45*l*l-1.6983531815716497-3*k*k)*c*c*c*c*c*c/720);m=m/Math.PI*180;c=(c-(1+2*l+k)*c*c*c/6+(5-2*k+28*l-3*k*k+.05391597401814761+24*l*l)*c*c*c*c*c/120)/Math.cos(d);
c=f+c/Math.PI*180;a.accuracy?(a=b({northing:a.northing+a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber}),a={top:a.lat,right:a.lon,bottom:m,left:c}):a={lat:m,lon:c};return a}function f(a){a%=m;return 0===a&&(a=m),a}function k(a){var b;switch(a){case "C":b=11E5;break;case "D":b=2E6;break;case "E":b=28E5;break;case "F":b=37E5;break;case "G":b=46E5;break;case "H":b=55E5;break;case "J":b=64E5;break;case "K":b=73E5;break;case "L":b=82E5;break;case "M":b=91E5;break;
case "N":b=0;break;case "P":b=8E5;break;case "Q":b=17E5;break;case "R":b=26E5;break;case "S":b=35E5;break;case "T":b=44E5;break;case "U":b=53E5;break;case "V":b=62E5;break;case "W":b=7E6;break;case "X":b=79E5;break;default:b=-1}if(0<=b)return b;throw"Invalid zone letter: "+a;}var m=6;d.forward=function(a,b){b=b||5;var c,d,k,m,l,v,t=a[1];c=a[0];var w=Math.PI/180*t,x=Math.PI/180*c;v=Math.floor((c+180)/6)+1;180===c&&(v=60);56<=t&&64>t&&3<=c&&12>c&&(v=32);72<=t&&84>t&&(0<=c&&9>c?v=31:9<=c&&21>c?v=33:
21<=c&&33>c?v=35:33<=c&&42>c&&(v=37));m=Math.PI/180*(6*(v-1)-180+3);c=6378137/Math.sqrt(1-.00669438*Math.sin(w)*Math.sin(w));d=Math.tan(w)*Math.tan(w);k=.006739496752268451*Math.cos(w)*Math.cos(w);m=Math.cos(w)*(x-m);l=6378137*(.9983242984503243*w-.002514607064228144*Math.sin(2*w)+2.639046602129982E-6*Math.sin(4*w)-3.4180461016968582E-9*Math.sin(6*w));x=.9996*c*(m+(1-d+k)*m*m*m/6+(5-18*d+d*d+72*k-.39089081163157013)*m*m*m*m*m/120)+5E5;w=.9996*(l+c*Math.tan(w)*(m*m/2+(5-d+9*k+4*k*k)*m*m*m*m/24+(61-
58*d+d*d+600*k-2.2240339282485886)*m*m*m*m*m*m/720));0>t&&(w+=1E7);d=Math.round(w);k=Math.round(x);x=v;v="Z";c=(84>=t&&72<=t?v="X":72>t&&64<=t?v="W":64>t&&56<=t?v="V":56>t&&48<=t?v="U":48>t&&40<=t?v="T":40>t&&32<=t?v="S":32>t&&24<=t?v="R":24>t&&16<=t?v="Q":16>t&&8<=t?v="P":8>t&&0<=t?v="N":0>t&&-8<=t?v="M":-8>t&&-16<=t?v="L":-16>t&&-24<=t?v="K":-24>t&&-32<=t?v="J":-32>t&&-40<=t?v="H":-40>t&&-48<=t?v="G":-48>t&&-56<=t?v="F":-56>t&&-64<=t?v="E":-64>t&&-72<=t?v="D":-72>t&&-80<=t&&(v="C"),v);t=b;v=""+
k;w=""+d;c=x+c;m=f(x);k=Math.floor(k/1E5);x=Math.floor(d/1E5)%20;--m;d="AJSAJS".charCodeAt(m);m="AFAFAF".charCodeAt(m);k=d+k-1;x=m+x;l=!1;90<k&&(k=k-90+65-1,l=!0);(73===k||73>d&&73<k||(73<k||73>d)&&l)&&k++;(79===k||79>d&&79<k||(79<k||79>d)&&l)&&(k++,73===k&&k++);90<k&&(k=k-90+65-1);86<x?(x=x-86+65-1,l=!0):l=!1;(73===x||73>m&&73<x||(73<x||73>m)&&l)&&x++;(79===x||79>m&&79<x||(79<x||79>m)&&l)&&(x++,73===x&&x++);86<x&&(x=x-86+65-1);d=String.fromCharCode(k)+String.fromCharCode(x);return c+d+v.substr(v.length-
5,t)+w.substr(w.length-5,t)};d.inverse=function(a){if((a=a.toUpperCase())&&0===a.length)throw"MGRSPoint coverting from nothing";for(var d,c=a.length,m=null,l="",r=0;!/[A-Z]/.test(d=a.charAt(r));){if(2<=r)throw"MGRSPoint bad conversion from: "+a;l+=d;r++}d=parseInt(l,10);if(0===r||r+3>c)throw"MGRSPoint bad conversion from: "+a;l=a.charAt(r++);if("A">=l||"B"===l||"Y"===l||"Z"<=l||"I"===l||"O"===l)throw"MGRSPoint zone letter "+l+" not handled: "+a;var m=a.substring(r,r+=2),u=f(d),v;v=m.charAt(0);for(var t=
"AJSAJS".charCodeAt(u-1),w=1E5,x=!1;t!==v.charCodeAt(0);){if(t++,73===t&&t++,79===t&&t++,90<t){if(x)throw"Bad character: "+v;t=65;x=!0}w+=1E5}v=w;m=m.charAt(1);if("V"<m)throw"MGRSPoint given invalid Northing "+m;u="AFAFAF".charCodeAt(u-1);t=0;for(w=!1;u!==m.charCodeAt(0);){if(u++,73===u&&u++,79===u&&u++,86<u){if(w)throw"Bad character: "+m;u=65;w=!0}t+=1E5}for(u=t;u<k(l);)u+=2E6;c-=r;if(0!==c%2)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+
a;var y,z,A,B,C,t=c/2,m=c=0;a=(0<t&&(y=1E5/Math.pow(10,t),z=a.substring(r,r+t),c=parseFloat(z)*y,A=a.substring(r+t),m=parseFloat(A)*y),B=c+v,C=m+u,{easting:B,northing:C,zoneLetter:l,zoneNumber:d,accuracy:y});y=b(a);return[y.left,y.bottom,y.right,y.top]};d.toPoint=function(a){a=d.inverse(a);return[(a[2]+a[0])/2,(a[3]+a[1])/2]}},{}],68:[function(l,a,d){a.exports={name:"proj4",version:"2.3.6",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",
main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},author:"",license:"MIT",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",
browserify:"~3.24.5","grunt-browserify":"~1.3.0","grunt-contrib-uglify":"~0.3.2",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"0.0.0"}}},{}],"./includedProjections":[function(l,a,d){a.exports=l("hTEDpn")},{}],hTEDpn:[function(l,a,d){var b=[l("./lib/projections/tmerc"),l("./lib/projections/utm"),l("./lib/projections/sterea"),l("./lib/projections/stere"),l("./lib/projections/somerc"),l("./lib/projections/omerc"),l("./lib/projections/lcc"),l("./lib/projections/krovak"),
l("./lib/projections/cass"),l("./lib/projections/laea"),l("./lib/projections/aea"),l("./lib/projections/gnom"),l("./lib/projections/cea"),l("./lib/projections/eqc"),l("./lib/projections/poly"),l("./lib/projections/nzmg"),l("./lib/projections/mill"),l("./lib/projections/sinu"),l("./lib/projections/moll"),l("./lib/projections/eqdc"),l("./lib/projections/vandg"),l("./lib/projections/aeqd")];a.exports=function(a){b.forEach(function(b){a.Proj.projections.add(b)})}},{"./lib/projections/aea":40,"./lib/projections/aeqd":41,
"./lib/projections/cass":42,"./lib/projections/cea":43,"./lib/projections/eqc":44,"./lib/projections/eqdc":45,"./lib/projections/gnom":47,"./lib/projections/krovak":48,"./lib/projections/laea":49,"./lib/projections/lcc":50,"./lib/projections/mill":53,"./lib/projections/moll":54,"./lib/projections/nzmg":55,"./lib/projections/omerc":56,"./lib/projections/poly":57,"./lib/projections/sinu":58,"./lib/projections/somerc":59,"./lib/projections/stere":60,"./lib/projections/sterea":61,"./lib/projections/tmerc":62,
"./lib/projections/utm":63,"./lib/projections/vandg":64}]},{},[36])(36)})},"cmv/viewer/js/gis/dijit/StreetView/nls/resource":function(){define({root:{messages:{instructions:"Click the StreetView button then click the map at your desired location.",notAvailable:"Unfortunately, Google StreetView imagery is not yet available at that location."},rightClickMenuItem:{label:"Google StreetView here"}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/LocateButton":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/LocateButton esri/renderers/SimpleRenderer esri/symbols/PictureMarkerSymbol esri/layers/GraphicsLayer esri/InfoTemplate dojo/topic".split(" "),
function(h,l,a,d,b,f,k,m){return h(null,{growlTemplate:"latitude: {latitude}\x3cbr/\x3elongitude: {longitude}\x3cbr/\x3eaccuracy: {accuracy}\x3cbr/\x3ealtitude: {altitude}\x3cbr/\x3ealtitude accuracy: {altitudeAccuracy}\x3cbr/\x3eheading: {heading}\x3cbr/\x3espeed: {speed}",constructor:function(a,b){this.options=a;this.parentNode=b},startup:function(){var g=new b("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABJhJREFUeNrcmN9PW2UYx7/n9ATKj7QMMUCxmSxlCRI3BzF6MRO9WOyVN5sJFxqvNCa7MmbphTG78Iprwx+weEMiF8bdLNFojBhNDEwu3ObWjo2uLUXKaIFSCqdnz7e8hx1WdOcUij+e5ElLOe3zyfd93ud9nlezLAte7LOv0S4vZ8VPi0eU72dx5bPiU+Jr9j8+fevpcTS3YALUIy/viUdRn10TvyK+cChgTwL5dOCZNqA7CARbgIB//+8VSkB+A8jmgdw6YFb2AgrcQt1gAsUli4m3E6gnAAx0A61N3qQqloE7WZGqsAvIZR0TuCnPYAJ1UV4u8H2oAzhZB9B+gLcFML2y+9GkwI27BhOomL10g71AfxcO1eaWgJuZx0srcGNPBbOV4tK9emInjxphzL9f7u4ubY1y+j45VV2+RkLR+NuMoeyCil0LpnZfzF6+RkI54RhLWUwx1CjGktDORD/snPo7YyzGZGzF8BhMkUaZV9x9R22M6duRKGqrpjvUqtapg5aEeowxGdvJoquzr6rWgEe1uJ8rFrSy+EYFOp3v+ZnlEW5gr2rthjqQq8eMF7UYvGRBL5jwFbZhFCs76rfqqAQMbAd8MP0aKroGy61qZFhcrf551lBdQvXs8wK1VoFvoYym+5vwT6ceBrMrq36YW+gOtJRGng/ljzej1NOEcrsO0y0cGRTYacNuW9yWB0agUoSaLpiBianfw5l7ydbBvle0Yi6Dn+IT1s8n+ouj588nR441F55rxmaLBlNzWT6URXbB/qpLqAETtbh8VGrih9nwYHi47e33TyErx3Lhfhc6Zl7Ufrs62TaxfiXc9eEHCS4rl1RzoZqDIaJ73UHbbGkkp64/WAqm/7jROvAacGtTzj5Zgrvii5YJq/N1pH/8tvX6rTtBPrtdx071DGaKYkz0zFLOf/LZF7TMn0BqXlqaJJBZLCOVzwEbq7CWwlpmPunns/yO1zhG3cVHEn0rn8bq3DBK0s4UimsoPlzZaboyImFB1tY06/55z4r5JFdYEno7g6W5+HfW9vwGyullbKSkl7knaiXyVdcqv1q9faESn/W53JUHAqPETOgz/eF8KDJYnPnmC6wncrASotRN6aFnRKnclwi9ca545tRQns8adSoWt3t0N8bdxeLJOjX6zrvJQMfq+vJXFy1c/Rz4fhz68kdW3zn/+ugnl5N8hs9qLhVzMMQNBRZh4+amZDCLuf1ZPEc6/YWuSx8npt+MBrMPUn5UKugOXSqNDL+0W2CrpcJD8+gE49wX5TQTPuZSZlGAFZ3Fk0t1/OWhUnFk6EBHEo0MymYNNYzGOGJxWHB7XjIgKzqDdxrYsksCE91QS+6lRjA2GZRN6dJrc5S6xt6bI5YX0xRgEyFFKTrf6x6haIyt+n8OJ2v2ruSEXC1BJD9qY0zGdrLo6i5hwVbtdvbowW6k96i18GQdI+kah1HOfUdljKVaHabUeE2BVaTVwZPDqGPrNswYwzH4jql8r6386i5hku85jDYSzh54HVcFU//NK4JGX6ow0VVOeb9U+VdfQzX44m7cmej/r6vOf+py+JEAAwDRMD/uB0XQuQAAAABJRU5ErkJggg\x3d\x3d",
38,38);this.graphics=new f({id:"GeoLocationGraphics"});g=new d(g);g.label="GPS Position";g.description="GPS Position";this.graphics.setRenderer(g);this.options.map.addLayer(this.graphics);this.options.graphicsLayer=this.graphics;this.options.infoTemplate=new k("GPS Position","${*}");this.options.symbol=null;this.locateButton=new a(this.options,this.parentNode);this.locateButton.startup();this.locateButton.on("locate",l.hitch(this,"_growlLocation"))},_growlLocation:function(a){a={accuracy:a.position.coords.accuracy?
a.position.coords.accuracy:"",altitude:a.position.coords.altitude?a.position.coords.altitude:"",altitudeAccuracy:a.position.coords.altitudeAccuracy?a.position.coords.altitudeAccuracy:"",heading:a.position.coords.heading?a.position.coords.heading:"",latitude:a.position.coords.latitude?a.position.coords.latitude:"",longitude:a.position.coords.longitude?a.position.coords.longitude:"",speed:a.position.coords.speed?a.position.coords.speed:""};0<this.graphics.graphics.length&&(this.graphics.graphics[0].attributes=
a);this.options.publishGPSPosition&&m.publish("growler/growl",{title:"GPS Position",message:l.replace(this.growlTemplate,a),level:"default",timeout:1E4,opacity:1})}})})},"esri/dijit/LocateButton":function(){define("require dojo/Evented dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../config dijit/_WidgetBase dijit/a11yclick dijit/_TemplatedMixin dojo/on dojo/Deferred dojo/text!./templates/LocateButton.html dojo/i18n!../nls/jsapi dojo/dom-class dojo/dom-style dojo/dom-attr ../geometry/webMercatorUtils ../geometry/Point ../SpatialReference ../graphic ../symbols/PictureMarkerSymbol ../tasks/ProjectParameters".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B){h=a("esri.dijit.LocateButton",[m,e,l],{templateString:q,options:{theme:"LocateButton",map:null,visible:!0,highlightLocation:!0,symbol:new A(h.toUrl("./images/sdk_gps_location.png"),28,28),infoTemplate:null,scale:null,useTracking:!1,clearOnTrackingStop:!1,setScale:!0,centerAt:!0,timeout:15E3,graphicsLayer:null,geolocationOptions:{maximumAge:0,timeout:15E3,enableHighAccuracy:!0}},constructor:function(a,b){var c=d.mixin({},this.options,a);this.domNode=
b;this._i18n=r;var e=navigator.geolocation,f=window.hasOwnProperty("isSecureContext");(f&&window.isSecureContext||!f&&"https:"===window.location.protocol)&&e||(c.visible=!1);this.set("map",c.map);this.set("theme",c.theme);this.set("visible",c.visible);this.set("scale",c.scale);this.set("highlightLocation",c.highlightLocation);this.set("symbol",c.symbol);this.set("infoTemplate",c.infoTemplate);this.set("geolocationOptions",c.geolocationOptions);this.set("useTracking",c.useTracking);this.set("setScale",
c.setScale);this.set("centerAt",c.centerAt);this.set("timeout",c.timeout);this.set("graphicsLayer",c.graphicsLayer);this.set("clearOnTrackingStop",c.clearOnTrackingStop);this.watch("theme",this._updateThemeWatch);this.watch("visible",this._visible);this.watch("tracking",this._locate);this.watch("useTracking",d.hitch(this,function(){this.get("tracking")&&!this.get("useTracking")&&this._stopTracking();this._setTitle()}));this._css={container:"locateContainer",locate:"zoomLocateButton",loading:"loading",
tracking:"tracking"}},postCreate:function(){this.inherited(arguments);this.own(c(this._locateNode,g,d.hitch(this,this.locate)))},startup:function(){this.inherited(arguments);this.get("map")||this.set("visible",!1);this.get("map").loaded?this._init():c.once(this.get("map"),"load",d.hitch(this,function(){this._init()}))},destroy:function(){this.clear();this._graphicsEvent&&this._graphicsEvent.remove();this._removeWatchPosition();this.inherited(arguments)},clear:function(){var a=this.get("highlightGraphic"),
b=this.get("graphicsLayer");a&&(b?b.remove(a):this.get("map").graphics.remove(a),this.set("highlightGraphic",null))},locate:function(){return this.get("useTracking")&&this.set("tracking",!this.get("tracking")),this._locate()},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},_setTitle:function(){this.get("useTracking")?this.get("tracking")?t.set(this._locateNode,"title",this._i18n.widgets.locateButton.locate.stopTracking):t.set(this._locateNode,"title",this._i18n.widgets.locateButton.locate.tracking):
t.set(this._locateNode,"title",this._i18n.widgets.locateButton.locate.title)},_removeWatchPosition:function(){this.get("watchId")&&(navigator.geolocation.clearWatch(this.get("watchId")),this.set("watchId",null));this._removePrivateVars()},_stopTracking:function(){u.remove(this._locateNode,this._css.tracking);this._removeWatchPosition();this.get("clearOnTrackingStop")&&this.clear();this._hideLoading()},_positionToObject:function(a){return a?{coords:d.mixin({},a.coords),timestamp:a.timestamp}:{}},_startTracking:function(){u.add(this._locateNode,
this._css.tracking);this._removeWatchPosition();var a=navigator.geolocation.watchPosition(d.hitch(this,function(a){a=this._positionToObject(a);this._setPosition(a).then(d.hitch(this,function(a){this._locateEvent(a)}),d.hitch(this,function(a){a||(a=Error("LocateButton::Error setting the position."));this._locateError(a)}))}),d.hitch(this,function(a){this.set("tracking",!1);a||(a=Error("LocateButton::Could not get tracking position."));this._locateError(a)}),this.get("geolocationOptions"));this.set("watchId",
a)},_removePrivateVars:function(){this._scale=this._position=this._graphic=null},_getCurrentPosition:function(){var a=new n;this._removePrivateVars();var b=setTimeout(d.hitch(this,function(){clearTimeout(b);a.reject(Error("LocateButton::time expired for getting location."))}),this.get("timeout"));return navigator.geolocation.getCurrentPosition(d.hitch(this,function(c){c=this._positionToObject(c);clearTimeout(b);this._setPosition(c).then(d.hitch(this,function(b){a.resolve(b)}),d.hitch(this,function(b){b||
(b=Error("LocateButton::Error setting map position."));a.reject(b)}))}),d.hitch(this,function(b){b||(b=Error("LocateButton::Could not get current position."));a.reject(b)}),this.get("geolocationOptions")),a.promise},_locate:function(){var a=new n;if(this._showLoading(),navigator.geolocation)this.get("useTracking")?this.get("tracking")?(this._startTracking(),a.resolve({tracking:!0})):(this._stopTracking(),a.resolve({tracking:!1})):this._getCurrentPosition().then(d.hitch(this,function(b){this._locateEvent(b);
a.resolve(b)}),d.hitch(this,function(b){b||(b=Error("LocateButton::Could not get current position."));this._locateError(b);a.reject(b)}));else{var b=Error("LocateButton::geolocation unsupported");this._locateError(b);a.reject(b)}return this._setTitle(),a.promise},_projectPoint:function(a){var b=new n,c=this.get("map").spatialReference,e=c.wkid;c.isWebMercator()?(a=w.geographicToWebMercator(a),b.resolve(a)):k.defaults.geometryService&&4326!==e?(e=new B,e.geometries=[a],e.outSR=c,k.defaults.geometryService.project(e).then(d.hitch(this,
function(a){a&&a.length?b.resolve(a[0]):b.reject(Error("LocateButton::Point was not projected."))}),function(a){a||(a=Error("LocateButton::please specify a geometry service on esri/config to project."));b.reject(a)})):b.resolve(a);return b.promise},_getScale:function(a){var b=this.get("scale");return a&&a.coords?b||a.coords.accuracy||5E4:b||5E4},_createPoint:function(a){var b;a&&a.coords&&(b=new x([a.coords.longitude,a.coords.latitude],new y({wkid:4326})));return b},_setPosition:function(a){var b,
c,e=new n;if(this._removePrivateVars(),this._position=a,a&&a.coords){var f=this._createPoint(a);f&&(c=this._createGraphic(f,a),this._graphic=c);var g=this._getScale(a);this._scale=g;f?this._projectPoint(f).then(d.hitch(this,function(b){this._graphic=c=this._createGraphic(b,a);var f={graphic:c,scale:g,position:a};this.get("setScale")&&this.get("map").setScale(g);this.get("centerAt")?this.get("map").centerAt(b).then(d.hitch(this,function(){e.resolve(f)}),d.hitch(this,function(a){a||(a=Error("LocateButton::Could not center map."));
e.reject(a)})):e.resolve(f)}),d.hitch(this,function(a){a||(a=Error("LocateButton::Error projecting point."));e.reject(a)})):(b=Error("LocateButton::Invalid point"),e.reject(b))}else b=Error("LocateButton::Invalid position"),e.reject(b);return e.promise},_createGraphic:function(a,b){var c;a&&(c={position:b},c=new z(a,this.get("symbol"),c,this.get("infoTemplate")));return c},_locateEvent:function(a){if(a.graphic){var b=this.get("highlightGraphic"),c=this.get("graphicsLayer");b?(b.setGeometry(a.graphic.geometry),
b.setAttributes(a.graphic.attributes),b.setInfoTemplate(a.graphic.infoTemplate),b.setSymbol(a.graphic.symbol)):(b=a.graphic,this.get("highlightLocation")&&(c?c.add(b):this.get("map").graphics.add(b)));this.set("highlightGraphic",b)}this._hideLoading();this.emit("locate",a)},_locateError:function(a){a={graphic:this._graphic,scale:this._scale,position:this._position,error:a};this._hideLoading();this.emit("locate",a)},_showLoading:function(){this.get("useTracking")||u.add(this._locateNode,this._css.loading)},
_hideLoading:function(){this.get("useTracking")||u.remove(this._locateNode,this._css.loading)},_init:function(){this._visible();this._setTitle();this.get("tracking")&&this.get("useTracking")&&this._locate();this.set("loaded",!0);this.emit("load",{})},_updateThemeWatch:function(a,b,c){u.remove(this.domNode,b);u.add(this.domNode,c)},_visible:function(){this.get("visible")?v.set(this.domNode,"display","block"):v.set(this.domNode,"display","none")}});return b("extend-esri")&&d.setObject("dijit.LocateButton",
h,f),h})},"cmv/viewer/js/gis/dijit/Locale":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/on dojo/dom-style dojo/_base/array dojo/_base/kernel dojo/io-query dijit/form/DropDownButton dijit/DropDownMenu dijit/MenuItem ./Locale/countries dojo/text!./Locale/templates/Locale.html dojo/i18n!./Locale/nls/resource xstyle/css!flag-icon-css/css/flag-icon.min.css xstyle/css!./Locale/css/Locale.css".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u){return h([l,
a],{templateString:r,i18n:u,baseClass:"cmvLocaleDijit",currentLocale:null,includeFlag:!0,includeCountry:!0,includeLanguage:!0,languages:{en:"English",es:"Espa\u00f1ol",fr:"Fran\u00e7ais",pt:"Portugu\u00eas"},locales:"es-ar es-bo pt-br en-ca fr-ca es-cl es-co es-cr es-do es-ec es-sv fr-FR es-gt fr-ht es-hn en-in es-mx es-pa es-pe es-pr pt-pt es-py es-es en-gb en-us es-us es-uy es-ve".split(" "),postCreate:function(){this.inherited(arguments);this.currentLocale=m.locale;this.parentWidget&&this.parentWidget.toggleable&&
f.set(this.localeLabelContainer,"display","block");var a=new c({baseClass:"localeMenu"});k.forEach(this.locales,d.hitch(this,function(b){var c=b.split("-"),e=this.languages[c[0]];if(e){var f="",g=null,k=null;c[1]&&(this.includeFlag&&(k="flag-icon flag-icon-"+c[1].toLowerCase()),(g=q[c[1].toUpperCase()])&&this.includeCountry&&(f=g));this.includeLanguage&&(0<f.length&&(f+=" - "),f+=e);b=new n({id:b,label:f,iconClass:k,onClick:d.hitch(this,"switchLocale",b)});a.addChild(b)}}));a.startup();var b=this.currentLocale.split("-"),
g=this.languages[b[0]],h="",l=null;b[1]&&(this.includeFlag&&(h='\x3cdiv class\x3d"flag-icon flag-icon-'+b[1].toLowerCase()+'"\x3e\x3c/div\x3e'),(l=q[b[1].toUpperCase()])&&this.includeCountry&&(h+=l),this.includeLanguage&&(l&&this.includeCountry&&(h+=" - "),h+=g));b=new e({label:h,dropDown:a});this.localeDropDownContainer.appendChild(b.domNode)},switchLocale:function(a){if(a!==this.currentLocale){var b=window.location.href,c={};-1<b.indexOf("?")&&(b=b.substring(b.indexOf("?")+1,b.length),c=g.queryToObject(b));
c.locale=a;window.location=window.location.pathname+"?"+g.objectToQuery(c)}}})})},"cmv/viewer/js/gis/dijit/Locale/countries":function(){define({AF:"Afghanistan",AX:"\u00c5land Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",
BT:"Bhutan",BO:"Bolivia",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, The Democratic Republic of the",CK:"Cook Islands",CR:"Costa Rica",
CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",
GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic Of",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"Democratic People's Republic of Korea",
KR:"Korea, Republic of",XK:"Kosovo",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia, The Former Yugoslav Republic of",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States of",MD:"Moldova, Republic of",
MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory, Occupied",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",
PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",SH:"Saint Helena",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",ES:"Spain",
LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania, United Republic of",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Minor Outlying Islands",
UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"})},"cmv/viewer/js/gis/dijit/Locale/nls/resource":function(){define({root:{selectLocale:"Select Your Locale:"},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"dojox/gfx/svg":function(){define("dojo/_base/lang dojo/_base/sniff dojo/_base/window dojo/dom dojo/_base/declare dojo/_base/array dojo/dom-geometry dojo/dom-attr dojo/_base/Color ./_base ./shape ./path".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n){function q(b,c){return a.doc.createElementNS?a.doc.createElementNS(b,c):a.doc.createElement(c)}function r(a,b,c,d){return a.setAttributeNS?a.setAttributeNS(b,c,d):a.setAttribute(c,d)}function u(b){return v.useSvgWeb?a.doc.createTextNode(b,!0):a.doc.createTextNode(b)}var v=e.svg={};v.useSvgWeb="undefined"!=typeof window.svgweb;var t=navigator.userAgent,w=l("ios"),x=l("android"),y=l("chrome")||x&&4<=x?"auto":"optimizeLegibility";v.xmlns={xlink:"http://www.w3.org/1999/xlink",
svg:"http://www.w3.org/2000/svg"};v.getRef=function(a){return a&&"none"!=a?a.match(/^url\(#.+\)$/)?d.byId(a.slice(5,-1)):a.match(/^#dojoUnique\d+$/)?d.byId(a.slice(1)):null:null};v.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};var z=0;v.Shape=b("dojox.gfx.svg.Shape",c.Shape,{destroy:function(){if(this.fillStyle&&"type"in this.fillStyle){var a=
this.rawNode.getAttribute("fill");(a=v.getRef(a))&&a.parentNode.removeChild(a)}this.clip&&(a=this.rawNode.getAttribute("clip-path"))&&(a=d.byId(a.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);c.Shape.prototype.destroy.apply(this,arguments)},setFill:function(a){if(!a)return this.fillStyle=null,this.rawNode.setAttribute("fill","none"),this.rawNode.setAttribute("fill-opacity",0),this;var b,c=function(a){this.setAttribute(a,b[a].toFixed(8))};if("object"==typeof a&&"type"in a){switch(a.type){case "linear":b=
e.makeParameters(e.defaultLinearGradient,a);a=this._setFillObject(b,"linearGradient");f.forEach(["x1","y1","x2","y2"],c,a);break;case "radial":b=e.makeParameters(e.defaultRadialGradient,a);a=this._setFillObject(b,"radialGradient");f.forEach(["cx","cy","r"],c,a);break;case "pattern":b=e.makeParameters(e.defaultPattern,a),a=this._setFillObject(b,"pattern"),f.forEach(["x","y","width","height"],c,a)}this.fillStyle=b;return this}this.fillStyle=b=e.normalizeColor(a);this.rawNode.setAttribute("fill",b.toCss());
this.rawNode.setAttribute("fill-opacity",b.a);this.rawNode.setAttribute("fill-rule","evenodd");return this},setStroke:function(a){var b=this.rawNode;if(!a)return this.strokeStyle=null,b.setAttribute("stroke","none"),b.setAttribute("stroke-opacity",0),this;if("string"==typeof a||h.isArray(a)||a instanceof g)a={color:a};a=this.strokeStyle=e.makeParameters(e.defaultStroke,a);a.color=e.normalizeColor(a.color);if(a){var c=0>a.width?0:a.width;b.setAttribute("stroke",a.color.toCss());b.setAttribute("stroke-opacity",
a.color.a);b.setAttribute("stroke-width",c);b.setAttribute("stroke-linecap",a.cap);"number"==typeof a.join?(b.setAttribute("stroke-linejoin","miter"),b.setAttribute("stroke-miterlimit",a.join)):b.setAttribute("stroke-linejoin",a.join);var d=a.style.toLowerCase();d in v.dasharray&&(d=v.dasharray[d]);if(d instanceof Array){var d=h._toArray(d),f;for(f=0;f<d.length;++f)d[f]*=c;if("butt"!=a.cap){for(f=0;f<d.length;f+=2)d[f]-=c,1>d[f]&&(d[f]=1);for(f=1;f<d.length;f+=2)d[f]+=c}d=d.join(",")}b.setAttribute("stroke-dasharray",
d);b.setAttribute("dojoGfxStrokeStyle",a.style)}return this},_getParentSurface:function(){for(var a=this.parent;a&&!(a instanceof e.Surface);a=a.parent);return a},_setFillObject:function(a,b){var c=v.xmlns.svg;this.fillStyle=a;var d=this._getParentSurface().defNode,f=this.rawNode.getAttribute("fill");if(f=v.getRef(f))if(f.tagName.toLowerCase()!=b.toLowerCase()){var g=f.id;f.parentNode.removeChild(f);f=q(c,b);f.setAttribute("id",g);d.appendChild(f)}else for(;f.childNodes.length;)f.removeChild(f.lastChild);
else f=q(c,b),f.setAttribute("id",e._base._getUniqueId()),d.appendChild(f);if("pattern"==b)f.setAttribute("patternUnits","userSpaceOnUse"),c=q(c,"image"),c.setAttribute("x",0),c.setAttribute("y",0),c.setAttribute("width",(0>a.width?0:a.width).toFixed(8)),c.setAttribute("height",(0>a.height?0:a.height).toFixed(8)),r(c,v.xmlns.xlink,"xlink:href",a.src),f.appendChild(c);else for(f.setAttribute("gradientUnits","userSpaceOnUse"),d=0;d<a.colors.length;++d){var g=a.colors[d],k=q(c,"stop"),h=g.color=e.normalizeColor(g.color);
k.setAttribute("offset",g.offset.toFixed(8));k.setAttribute("stop-color",h.toCss());k.setAttribute("stop-opacity",h.a);f.appendChild(k)}this.rawNode.setAttribute("fill","url(#"+f.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");this.rawNode.setAttribute("fill-rule","evenodd");return f},_applyTransform:function(){if(this.matrix){var a=this.matrix;this.rawNode.setAttribute("transform","matrix("+a.xx.toFixed(8)+","+a.yx.toFixed(8)+","+a.xy.toFixed(8)+","+a.yy.toFixed(8)+","+a.dx.toFixed(8)+
","+a.dy.toFixed(8)+")")}else this.rawNode.removeAttribute("transform");return this},setRawNode:function(a){a=this.rawNode=a;"image"!=this.shape.type&&a.setAttribute("fill","none");a.setAttribute("fill-opacity",0);a.setAttribute("stroke","none");a.setAttribute("stroke-opacity",0);a.setAttribute("stroke-width",1);a.setAttribute("stroke-linecap","butt");a.setAttribute("stroke-linejoin","miter");a.setAttribute("stroke-miterlimit",4);a.__gfxObject__=this},setShape:function(a){this.shape=e.makeParameters(this.shape,
a);for(var b in this.shape)if("type"!=b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}this.bbox=null;return this},_moveToFront:function(){this.rawNode.parentNode.appendChild(this.rawNode);return this},_moveToBack:function(){this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild);return this},setClip:function(a){this.inherited(arguments);var b=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;
if(a&&!b)return this;"polyline"===b&&(a=h.clone(a),a.points=a.points.join(","));var c,e=m.get(this.rawNode,"clip-path");e&&(c=d.byId(e.match(/gfx_clip[\d]+/)[0]))&&c.removeChild(c.childNodes[0]);a?(c?(b=q(v.xmlns.svg,b),c.appendChild(b)):(e="gfx_clip"+ ++z,this.rawNode.setAttribute("clip-path","url(#"+e+")"),c=q(v.xmlns.svg,"clipPath"),b=q(v.xmlns.svg,b),c.appendChild(b),this.rawNode.parentNode.insertBefore(c,this.rawNode),m.set(c,"id",e)),m.set(b,a)):(this.rawNode.removeAttribute("clip-path"),c&&
c.parentNode.removeChild(c));return this},_removeClipNode:function(){var a,b=m.get(this.rawNode,"clip-path");b&&(a=d.byId(b.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);return a}});v.Group=b("dojox.gfx.svg.Group",v.Shape,{constructor:function(){c.Container._init.call(this)},setRawNode:function(a){this.rawNode=a;this.rawNode.__gfxObject__=this},destroy:function(){this.clear(!0);v.Shape.prototype.destroy.apply(this,arguments)}});v.Group.nodeType="g";v.Rect=b("dojox.gfx.svg.Rect",[v.Shape,
c.Rect],{setShape:function(a){this.shape=e.makeParameters(this.shape,a);this.bbox=null;for(var b in this.shape)if("type"!=b&&"r"!=b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}null!=this.shape.r&&(this.rawNode.setAttribute("ry",this.shape.r),this.rawNode.setAttribute("rx",this.shape.r));return this}});v.Rect.nodeType="rect";v.Ellipse=b("dojox.gfx.svg.Ellipse",[v.Shape,c.Ellipse],{});v.Ellipse.nodeType="ellipse";v.Circle=b("dojox.gfx.svg.Circle",[v.Shape,
c.Circle],{});v.Circle.nodeType="circle";v.Line=b("dojox.gfx.svg.Line",[v.Shape,c.Line],{});v.Line.nodeType="line";v.Polyline=b("dojox.gfx.svg.Polyline",[v.Shape,c.Polyline],{setShape:function(a,b){a&&a instanceof Array?(this.shape=e.makeParameters(this.shape,{points:a}),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.shape=e.makeParameters(this.shape,a);this.bbox=null;this._normalizePoints();for(var c=[],d=this.shape.points,f=0;f<d.length;++f)c.push(d[f].x.toFixed(8),
d[f].y.toFixed(8));this.rawNode.setAttribute("points",c.join(" "));return this}});v.Polyline.nodeType="polyline";v.Image=b("dojox.gfx.svg.Image",[v.Shape,c.Image],{setShape:function(a){this.shape=e.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;for(var b in this.shape)if("type"!=b&&"src"!=b){var c=this.shape[b];if("width"===b||"height"===b)c=0>c?0:c;a.setAttribute(b,c)}a.setAttribute("preserveAspectRatio","none");r(a,v.xmlns.xlink,"xlink:href",this.shape.src);a.__gfxObject__=this;return this}});
v.Image.nodeType="image";v.Text=b("dojox.gfx.svg.Text",[v.Shape,c.Text],{setShape:function(a){this.shape=e.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;var b=this.shape;a.setAttribute("x",b.x);a.setAttribute("y",b.y);a.setAttribute("text-anchor",b.align);a.setAttribute("text-decoration",b.decoration);a.setAttribute("rotate",b.rotated?90:0);a.setAttribute("kerning",b.kerning?"auto":0);a.setAttribute("text-rendering",y);a.firstChild?a.firstChild.nodeValue=b.text:a.appendChild(u(b.text));
return this},getTextWidth:function(){var a=this.rawNode,b=a.parentNode,a=a.cloneNode(!0);a.style.visibility="hidden";var c=0,d=a.firstChild.nodeValue;b.appendChild(a);if(""!=d)for(;!c;)c=a.getBBox?parseInt(a.getBBox().width):68;b.removeChild(a);return c},getBoundingBox:function(){var a=null;if(this.getShape().text)try{a=this.rawNode.getBBox()}catch(b){a={x:0,y:0,width:0,height:0}}return a}});v.Text.nodeType="text";v.Path=b("dojox.gfx.svg.Path",[v.Shape,n.Path],{_updateWithSegment:function(a){this.inherited(arguments);
"string"==typeof this.shape.path&&this.rawNode.setAttribute("d",this.shape.path)},setShape:function(a){this.inherited(arguments);this.shape.path?this.rawNode.setAttribute("d",this.shape.path):this.rawNode.removeAttribute("d");return this}});v.Path.nodeType="path";v.TextPath=b("dojox.gfx.svg.TextPath",[v.Shape,n.TextPath],{_updateWithSegment:function(a){this.inherited(arguments);this._setTextPath()},setShape:function(a){this.inherited(arguments);this._setTextPath();return this},_setTextPath:function(){if("string"==
typeof this.shape.path){var a=this.rawNode;if(!a.firstChild){var b=q(v.xmlns.svg,"textPath"),c=u("");b.appendChild(c);a.appendChild(b)}b=(b=a.firstChild.getAttributeNS(v.xmlns.xlink,"href"))&&v.getRef(b);if(!b&&(c=this._getParentSurface())){var c=c.defNode,b=q(v.xmlns.svg,"path"),d=e._base._getUniqueId();b.setAttribute("id",d);c.appendChild(b);r(a.firstChild,v.xmlns.xlink,"xlink:href","#"+d)}b&&b.setAttribute("d",this.shape.path)}},_setText:function(){var a=this.rawNode;if(!a.firstChild){var b=q(v.xmlns.svg,
"textPath"),c=u("");b.appendChild(c);a.appendChild(b)}a=a.firstChild;b=this.text;a.setAttribute("alignment-baseline","middle");switch(b.align){case "middle":a.setAttribute("text-anchor","middle");a.setAttribute("startOffset","50%");break;case "end":a.setAttribute("text-anchor","end");a.setAttribute("startOffset","100%");break;default:a.setAttribute("text-anchor","start"),a.setAttribute("startOffset","0%")}a.setAttribute("baseline-shift","0.5ex");a.setAttribute("text-decoration",b.decoration);a.setAttribute("rotate",
b.rotated?90:0);a.setAttribute("kerning",b.kerning?"auto":0);a.firstChild.data=b.text}});v.TextPath.nodeType="text";var A=534<function(){var a=/WebKit\/(\d*)/.exec(t);return a?a[1]:0}();v.Surface=b("dojox.gfx.svg.Surface",c.Surface,{constructor:function(){c.Container._init.call(this)},destroy:function(){c.Container.clear.call(this,!0);this.defNode=null;this.inherited(arguments)},setDimensions:function(a,b){if(!this.rawNode)return this;var c=0>a?0:a,d=0>b?0:b;this.rawNode.setAttribute("width",c);this.rawNode.setAttribute("height",
d);A&&(this.rawNode.style.width=c,this.rawNode.style.height=d);return this},getDimensions:function(){return this.rawNode?{width:e.normalizedLength(this.rawNode.getAttribute("width")),height:e.normalizedLength(this.rawNode.getAttribute("height"))}:null}});v.createSurface=function(a,b,c){var f=new v.Surface;f.rawNode=q(v.xmlns.svg,"svg");f.rawNode.setAttribute("overflow","hidden");b&&f.rawNode.setAttribute("width",0>b?0:b);c&&f.rawNode.setAttribute("height",0>c?0:c);b=q(v.xmlns.svg,"defs");f.rawNode.appendChild(b);
f.defNode=b;f._parent=d.byId(a);f._parent.appendChild(f.rawNode);e._base._fixMsTouchAction(f);return f};l={_setFont:function(){var a=this.fontStyle;this.rawNode.setAttribute("font-style",a.style);this.rawNode.setAttribute("font-variant",a.variant);this.rawNode.setAttribute("font-weight",a.weight);this.rawNode.setAttribute("font-size",a.size);this.rawNode.setAttribute("font-family",a.family)}};var B=c.Container;b=v.Container={openBatch:function(){if(!this._batch){var b;b=v.useSvgWeb?a.doc.createDocumentFragment(!0):
a.doc.createDocumentFragment();this.fragment=b}++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this.fragment&&!this._batch&&(this.rawNode.appendChild(this.fragment),delete this.fragment);return this},add:function(a){this!=a.getParent()&&(this.fragment?this.fragment.appendChild(a.rawNode):this.rawNode.appendChild(a.rawNode),B.add.apply(this,arguments),a.setClip(a.clip));return this},remove:function(a,b){this==a.getParent()&&(this.rawNode==a.rawNode.parentNode&&
this.rawNode.removeChild(a.rawNode),this.fragment&&this.fragment==a.rawNode.parentNode&&this.fragment.removeChild(a.rawNode),a._removeClipNode(),B.remove.apply(this,arguments));return this},clear:function(){for(var a=this.rawNode;a.lastChild;)a.removeChild(a.lastChild);var b=this.defNode;if(b){for(;b.lastChild;)b.removeChild(b.lastChild);a.appendChild(b)}return B.clear.apply(this,arguments)},getBoundingBox:B.getBoundingBox,_moveChildToFront:B._moveChildToFront,_moveChildToBack:B._moveChildToBack};
n=v.Creator={createObject:function(a,b){if(!this.rawNode)return null;var c=new a,d=q(v.xmlns.svg,a.nodeType);c.setRawNode(d);c.setShape(b);this.add(c);return c}};h.extend(v.Text,l);h.extend(v.TextPath,l);h.extend(v.Group,b);h.extend(v.Group,c.Creator);h.extend(v.Group,n);h.extend(v.Surface,b);h.extend(v.Surface,c.Creator);h.extend(v.Surface,n);v.fixTarget=function(a,b){a.gfxTarget||(a.gfxTarget=w&&a.target.wholeText?a.target.parentElement.__gfxObject__:a.target.__gfxObject__);return!0};v.useSvgWeb&&
(v.createSurface=function(a,b,c){var f=new v.Surface;b=0>b?0:b;c=0>c?0:c;if(!b||!c){var g=k.position(a);b=b||g.w;c=c||g.h}a=d.byId(a);var g=a.id?a.id+"_svgweb":e._base._getUniqueId(),h=q(v.xmlns.svg,"svg");h.id=g;h.setAttribute("width",b);h.setAttribute("height",c);svgweb.appendChild(h,a);h.addEventListener("SVGLoad",function(){f.rawNode=this;f.isLoaded=!0;var a=q(v.xmlns.svg,"defs");f.rawNode.appendChild(a);f.defNode=a;if(f.onLoad)f.onLoad(f)},!1);f.isLoaded=!1;return f},v.Surface.extend({destroy:function(){var a=
this.rawNode;svgweb.removeChild(a,a.parentNode)}}),l={connect:function(a,b,c){"on"===a.substring(0,2)&&(a=a.substring(2));c=2==arguments.length?b:h.hitch(b,c);this.getEventSource().addEventListener(a,c,!1);return[this,a,c]},disconnect:function(a){this.getEventSource().removeEventListener(a[1],a[2],!1);delete a[0]}},h.extend(v.Shape,l),h.extend(v.Surface,l));return v})},"dojox/gfx/filters":function(){define(["dojo/_base/lang","dojo/_base/array"],function(h,l){var a={},d={x:"0%",y:"0%",width:"100%",
height:"100%"},b={};a.createFilter=function(a,b){var c=h.mixin({},d,a);c.primitives||(c.primitives=[]);b&&Array.prototype.push.apply(c.primitives,b);return c};var f=function(a,b,c){b instanceof Array&&(c=b,b=null);b=h.mixin({},b);b.children=c;b.tag=a;return b};l.forEach("feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feFlood feGaussianBlur feImage feMorphology feOffset feSpecularLighting feTile feTurbulence feDistantLight fePointLight feSpotLight feMergeNode feFuncA feFuncR feFuncG feFuncB".split(" "),
function(b){a[b]=function(a,c){return f(b,a,c)}});a.feMerge=function(b,c){if("string"===typeof b){for(var d=[],e=0;e<arguments.length;++e)d.push(a.feMergeNode({"in":arguments[e]}));return f("feMerge",{},d)}return f("feMerge",b,c)};var k=a.createFilter;b.convolutions=[k({_gfxName:"boxBlur3"},[a.feConvolveMatrix({"in":"SourceGraphic",order:3,divisor:9,kernelMatrix:"1,1,1,1,1,1,1,1,1"})]),k({_gfxName:"boxBlur5"},[a.feConvolveMatrix({"in":"SourceGraphic",order:5,divisor:25,kernelMatrix:"1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1"})]),
k({_gfxName:"verticalEdges",filterUnits:"objectBoundingBox"},[a.feConvolveMatrix({"in":"SourceGraphic",result:"kernel",order:3,divisor:1,kernelMatrix:"-1 0 1 -1 0 1 -1 0 1"}),a.feComponentTransfer({"in":"kernel"},[a.feFuncA({type:"table",tableValues:"1,1"})])]),k({_gfxName:"horizontalEdges",filterUnits:"objectBoundingBox"},[a.feConvolveMatrix({"in":"SourceGraphic",result:"kernel",order:3,divisor:1,kernelMatrix:"1 1 1 0 0 0 -1 -1 -1"}),a.feComponentTransfer({"in":"kernel"},[a.feFuncA({type:"table",
tableValues:"1,1"})])]),k({_gfxName:"allEdges3",filterUnits:"objectBoundingBox"},[a.feConvolveMatrix({"in":"SourceGraphic",result:"kernel",order:3,divisor:1,kernelMatrix:"-1 -1 -1 -1 8 -1 -1 -1 -1"}),a.feComponentTransfer({"in":"kernel"},[a.feFuncA({type:"table",tableValues:"1,1"})])]),k({_gfxName:"edgeEnhance",filterUnits:"objectBoundingBox"},[a.feConvolveMatrix({"in":"SourceGraphic",result:"kernel",order:3,divisor:-1,kernelMatrix:"0 1 0 1 -5 1 0 1 0"}),a.feComponentTransfer({"in":"kernel"},[a.feFuncA({type:"table",
tableValues:"1,1"})])])];l.forEach(b.convolutions,function(a){h.mixin(a,d)});b.shadows=[k({_gfxName:"fastSmallDropShadow"},[a.feColorMatrix({"in":"SourceAlpha",type:"matrix",result:"grey",values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0.7,0"}),a.feOffset({dx:3,dy:3,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),k({_gfxName:"fastDropShadow"},[a.feColorMatrix({"in":"SourceAlpha",type:"matrix",result:"grey",values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0.7,0"}),
a.feOffset({dx:5,dy:5,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),k({_gfxName:"fastDropShadowLight"},[a.feColorMatrix({"in":"SourceAlpha",type:"matrix",result:"grey",values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0.4,0"}),a.feOffset({dx:5,dy:5,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),k({_gfxName:"dropShadow"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:4}),a.feOffset({dx:5,dy:5,result:"offsetBlur"}),a.feMerge("offsetBlur",
"SourceGraphic")]),k({_gfxName:"dropShadowLight"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:4,result:"blur"}),a.feComponentTransfer({"in":"blur",result:"lessblur"},[a.feFuncA({type:"linear",slope:.5})]),a.feOffset({"in":"lessblur",dx:5,dy:5,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),k({_gfxName:"smallDropShadow"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:3}),a.feOffset({dx:2,dy:2,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),k({_gfxName:"smallDropShadowLight"},
[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:3,result:"blur"}),a.feComponentTransfer({"in":"blur",result:"lessblur"},[a.feFuncA({type:"linear",slope:.5})]),a.feOffset({"in":"lessblur",dx:2,dy:2,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")])];var m={x:"-10%",y:"-10%",width:"125%",height:"125%"};l.forEach(b.shadows,function(a){h.mixin(a,m)});b.blurs=[k({_gfxName:"blur1",x:"-5%",y:"-5%",width:"110%",height:"110%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:1})]),k({_gfxName:"blur2",
x:"-15%",y:"-15%",width:"130%",height:"130%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:2})]),k({_gfxName:"blur4",x:"-15%",y:"-15%",width:"130%",height:"130%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:4})]),k({_gfxName:"blur8",x:"-20%",y:"-20%",width:"140%",height:"140%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:8})]),k({_gfxName:"glow",x:"-10%",y:"-10%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:2}),a.feComponentTransfer([a.feFuncA({type:"linear",
slope:10})])])];b.colors=[k({_gfxName:"negate"},[a.feComponentTransfer([a.feFuncR({type:"table",tableValues:"1,0"}),a.feFuncG({type:"table",tableValues:"1,0"}),a.feFuncB({type:"table",tableValues:"1,0"})])]),k({_gfxName:"sepia"},[a.feColorMatrix({result:"grey",values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,1,0"}),a.feComponentTransfer({"in":"grey"},[a.feFuncR({type:"linear",slope:.5,intercept:.5}),a.feFuncB({type:"table",tableValues:"0,0"})])]),k({_gfxName:"grayscale"},
[a.feColorMatrix({values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,1,0"})]),k({_gfxName:"showRed"},[a.feComponentTransfer([a.feFuncG({type:"table",tableValues:"0,0"}),a.feFuncB({type:"table",tableValues:"0,0"})])]),k({_gfxName:"showGreen"},[a.feComponentTransfer([a.feFuncR({type:"table",tableValues:"0,0"}),a.feFuncB({type:"table",tableValues:"0,0"})])]),k({_gfxName:"showBlue"},[a.feComponentTransfer([a.feFuncR({type:"table",tableValues:"0,0"}),a.feFuncG({type:"table",
tableValues:"0,0"})])]),k({_gfxName:"hueRotate60"},[a.feColorMatrix({type:"hueRotate",values:60})]),k({_gfxName:"hueRotate120"},[a.feColorMatrix({type:"hueRotate",values:120})]),k({_gfxName:"hueRotate180"},[a.feColorMatrix({type:"hueRotate",values:180})]),k({_gfxName:"hueRotate270"},[a.feColorMatrix({type:"hueRotate",values:270})])];l.forEach(b.colors,function(a){h.mixin(a,d)});b.miscs=[k({_gfxName:"thinEmbossDropShadow",x:"-5%",y:"-5%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceAlpha",
stdDeviation:1,result:"blur"}),a.feOffset({"in":"blur",dx:6,dy:6,result:"offsetBlur"}),a.feSpecularLighting({"in":"blur",surfaceScale:8,specularConstant:1,specularExponent:12,result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",result:"litPaint",k1:0,k2:1,k3:1,k4:0}),a.feMerge("offsetBlur","litPaint")]),k({_gfxName:"embossDropShadow",
x:"-5%",y:"-5%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"4",result:"blur"}),a.feOffset({"in":"blur",dx:4,dy:4,result:"offsetBlur"}),a.feSpecularLighting({"in":"blur",surfaceScale:5,specularConstant:.75,specularExponent:20,"lighting-color":"#bbbbbb",result:"specOut"},[a.fePointLight({x:-5E3,y:-1E4,z:2E4})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,
k2:1,k3:1,k4:0,result:"litPaint"}),a.feMerge("offsetBlur","litPaint")]),k({_gfxName:"largeEmbossDropShadow",x:"-20%",y:"-20%",width:"140%",height:"140%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:5,result:"blur"}),a.feOffset({"in":"blur",dx:6,dy:6,result:"offsetBlur"}),a.feSpecularLighting({"in":"blur",surfaceScale:8,specularConstant:1,specularExponent:12,result:"spec"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"spec",in2:"SourceGraphic",operator:"in",result:"specOut"}),
a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",result:"litPaint",k1:0,k2:1,k3:1,k4:0}),a.feMerge("offsetBlur","litPaint")]),k({_gfxName:"thinEmbossDropShadowLight",x:"-5%",y:"-5%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:1,result:"blur"}),a.feComponentTransfer({"in":"blur",result:"lessblur"},[a.feFuncA({type:"linear",slope:"0.5"})]),a.feOffset({"in":"lessblur",dx:"6",dy:"6",result:"offsetBlur"}),a.feSpecularLighting({"in":"lessblur",surfaceScale:8,
specularConstant:1,specularExponent:"12",result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",result:"litPaint",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0}),a.feMerge("offsetBlur","litPaint")]),k({_gfxName:"embossDropShadowLight",x:"-5%",y:"-5%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"3",result:"blur"}),a.feComponentTransfer({"in":"blur",
result:"lessblur"},[a.feFuncA({type:"linear",slope:"0.5"})]),a.feOffset({"in":"lessblur",dx:"6",dy:"6",result:"offsetBlur"}),a.feSpecularLighting({"in":"lessblur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",result:"litPaint",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0"}),a.feMerge("offsetBlur",
"litPaint")]),k({_gfxName:"largeEmbossDropShadowLight",x:"-20%",y:"-20%",width:"140%",height:"140%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"5",result:"blur"}),a.feComponentTransfer({"in":"blur",result:"lessblur"},[a.feFuncA({type:"linear",slope:"0.5"})]),a.feOffset({"in":"lessblur",dx:"6",dy:"6",result:"offsetBlur"}),a.feSpecularLighting({"in":"blur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"spec"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"spec",
in2:"SourceGraphic",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0",result:"litPaint"}),a.feMerge("offsetBlur","litPaint")]),k({_gfxName:"fuzzy",x:"-10%",y:"-10%",width:"120%",height:"120%"},[a.feTurbulence({type:"fractalNoise",baseFrequency:"0.1",numOctaves:"1",result:"turb2"}),a.feDisplacementMap({"in":"SourceGraphic",in2:"turb2",result:"turb2",scale:"20",xChannelSelector:"R",yChannelSelector:"G"})]),k({_gfxName:"veryFuzzy",
x:"-20%",y:"-20%",width:"140%",height:"140%"},[a.feTurbulence({type:"fractalNoise",baseFrequency:"0.1",numOctaves:"1",result:"turb2"}),a.feDisplacementMap({"in":"SourceGraphic",in2:"turb2",result:"turb2",scale:"35",xChannelSelector:"R",yChannelSelector:"G"})]),k({_gfxName:"melting",x:"-10%",y:"-10%",width:"120%",height:"120%"},[a.feTurbulence({type:"fractalNoise",baseFrequency:"0.1",numOctaves:"2",result:"turb"}),a.feDisplacementMap({result:"bended","in":"SourceGraphic",in2:"turb",scale:"25",xChannelSelector:"R",
yChannelSelector:"G"}),a.feGaussianBlur({"in":"bended",stdDeviation:"1",result:"bb"}),a.feComponentTransfer({"in":"bb",result:"BendedSource"},[a.feFuncA({type:"linear",slope:10,intercept:"-1"})]),a.feComponentTransfer({"in":"BendedSource",result:"BendedAlpha"},[a.feFuncR({type:"linear",slope:"0",intercept:"0"}),a.feFuncG({type:"linear",slope:"0",intercept:"0"}),a.feFuncB({type:"linear",slope:"0",intercept:"0"}),a.feFuncA({type:"linear",slope:"1",intercept:"0"})]),a.feGaussianBlur({"in":"BendedAlpha",
stdDeviation:"1",result:"blur"}),a.feSpecularLighting({"in":"blur","lighting-color":"rgb(80%, 80%, 80%)",surfaceScale:"5",specularConstant:"1",specularExponent:"10",result:"specularOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"20000"})]),a.feComposite({"in":"specularOut",in2:"BendedAlpha",operator:"in",result:"specularOut"}),a.feComposite({"in":"BendedSource",in2:"specularOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0",result:"litPaint"})]),k({_gfxName:"impressionist",x:"0%",y:"0%",width:"100%",
height:"100%"},[a.feMorphology({"in":"SourceGraphic",operator:"dilate",radius:"2"})]),k({_gfxName:"holes",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feTurbulence({type:"fractalNoise",baseFrequency:"0.1",numOctaves:"1",result:"texture"}),a.feComponentTransfer({"in":"texture",result:"holes"},[a.feFuncA({type:"discrete",tableValues:"0,1"})]),a.feComposite({"in":"SourceGraphic",in2:"holes",operator:"out"})]),k({_gfxName:"holesComplement",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feTurbulence({type:"fractalNoise",
baseFrequency:"0.1",numOctaves:"1",result:"texture"}),a.feComponentTransfer({"in":"texture",result:"holes"},[a.feFuncA({type:"discrete",tableValues:"1,0"})]),a.feComposite({"in":"SourceGraphic",in2:"holes",operator:"out"})])];b.reliefs=[k({_gfxName:"bumpIn",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feColorMatrix({"in":"SourceGraphic",type:"luminanceToAlpha",result:"lumalpha"}),a.feComponentTransfer({"in":"lumalpha",result:"invertedalpha"},[a.feFuncA({type:"table",tableValues:"1,0"})]),a.feDiffuseLighting({"in":"invertedalpha",
"lighting-color":"rgb(60%, 60%, 60%)",result:"diffuse",surfaceScale:"5"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feSpecularLighting({"in":"invertedalpha",result:"specular",surfaceScale:"5",specularExponent:"6"},[a.feDistantLight({azimuth:"135",elevation:"30"})]),a.feComposite({"in":"diffuse",in2:"specular",operator:"arithmetic",k2:"1.0",k3:"1.0"})]),k({_gfxName:"bumpOut",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feColorMatrix({"in":"SourceGraphic",type:"luminanceToAlpha",result:"lumalpha"}),
a.feDiffuseLighting({"in":"lumalpha","lighting-color":"rgb(60%, 60%, 60%)",result:"diffuse",surfaceScale:"5"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feSpecularLighting({"in":"lumalpha",result:"specular",surfaceScale:"5",specularExponent:"6"},[a.feDistantLight({azimuth:"135",elevation:"30"})]),a.feComposite({"in":"diffuse",in2:"specular",operator:"arithmetic",k2:"1.0",k3:"1.0"})]),k({_gfxName:"thinEmboss",x:"-5%",y:"-5%",width:"110%",height:"110%"},[a.feGaussianBlur({"in":"SourceAlpha",
stdDeviation:"1",result:"blur"}),a.feSpecularLighting({"in":"blur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0"})]),k({_gfxName:"emboss",x:"-5%",y:"-5%",width:"110%",height:"110%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"3",
result:"blur"}),a.feSpecularLighting({"in":"blur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0"})]),k({_gfxName:"largeEmboss",x:"-5%",y:"-5%",width:"110%",height:"110%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"5",result:"blur"}),
a.feSpecularLighting({"in":"blur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0"})])];b.textures=[k({_gfxName:"paper",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feTurbulence({type:"turbulence",baseFrequency:"0.01",numOctaves:"5",result:"texture"}),
a.feDiffuseLighting({"in":"texture",result:"diffuse",surfaceScale:"-10"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feComposite({"in":"diffuse",in2:"SourceGraphic",operator:"arithmetic",k1:"1",k2:"0",k3:"0",k4:"0"})]),k({_gfxName:"swirl",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feTurbulence({type:"turbulence",baseFrequency:"0.05",numOctaves:"1",result:"texture"}),a.feDiffuseLighting({"in":"texture",result:"diffuse",surfaceScale:"-10"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),
a.feComposite({"in":"diffuse",in2:"SourceGraphic",operator:"arithmetic",k1:"1",k2:"0",k3:"0",k4:"0"})]),k({_gfxName:"swirl2",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feTurbulence({type:"turbulence",baseFrequency:"0.15",numOctaves:"1",result:"texture"}),a.feDiffuseLighting({"in":"texture",result:"diffuse",surfaceScale:"-10"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feComposite({"in":"diffuse",in2:"SourceGraphic",operator:"arithmetic",k1:"1",k2:"0",k3:"0",k4:"0"})]),k({_gfxName:"gold",
x:"-5%",y:"-5%",width:"115%",height:"110%"},[a.feTurbulence({baseFrequency:"0.2",numOctaves:"1",type:"turbulence",result:"turb"}),a.feComposite({"in":"SourceGraphic",in2:"turb",operator:"arithmetic",k2:"0.6",k3:"0.4",result:"turb"}),a.feComposite({"in":"turb",in2:"SourceGraphic",operator:"in",result:"bump"}),a.feDiffuseLighting({"in":"turb",surfaceScale:"6.0","lighting-color":"rgb(60%, 50%, 0%)",diffuseConstant:"1.0",result:"diffuse"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feSpecularLighting({"in":"bump",
surfaceScale:"6.0",specularConstant:"1.0",specularExponent:"10.0",result:"specularOut"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feComposite({"in":"specularOut",in2:"SourceGraphic",operator:"in",result:"specularOut"}),a.feComposite({"in":"bump",in2:"diffuse",operator:"arithmetic",k1:"0.7",k2:"0.3",result:"litPaint"}),a.feComposite({"in":"litPaint",in2:"specularOut",operator:"arithmetic",k2:"1.0",k3:"0.7",result:"litPaint"})])];for(var g in b)if(b.hasOwnProperty(g)){a[g]={};for(var e=
b[g],c=0;c<e.length;++c)(function(){var b=e[c];a[g][b._gfxName]=function(a){return h.delegate(b,a)}})()}return a})},"dojox/gfx/svgext":function(){define(["dojo/dom","dojo/_base/array","dojo/_base/window","./_base","./svg"],function(h,l,a,d,b){function f(a,d){var e=d.ownerDocument.createElementNS(b.xmlns.svg,a.tag);d.appendChild(e);for(var c in a)c in k||e.setAttribute(c,a[c]);a.children&&l.forEach(a.children,function(a){f(a,e)});return e}a=d.svgext={};var k={primitives:null,tag:null,children:null};
b.Shape.extend({addRenderingOption:function(a,b){this.rawNode.setAttribute(a,b);return this},setFilter:function(a){if(!a)return this.rawNode.removeAttribute("filter"),this.filter=null,this;this.filter=a;a.id=a.id||d._base._getUniqueId();var g=h.byId(a.id);if(!g){g=this.rawNode.ownerDocument.createElementNS(b.xmlns.svg,"filter");g.setAttribute("filterUnits","userSpaceOnUse");for(var e in a)e in k||g.setAttribute(e,a[e]);l.forEach(a.primitives,function(a){f(a,g)});(e=this._getParentSurface())&&e.defNode.appendChild(g)}this.rawNode.setAttribute("filter",
"url(#"+a.id+")");return this},getFilter:function(){return this.filter}});return a})},"esri/dijit/Attribution":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-geometry ../kernel ../lang ../SpatialReference ../geometry/webMercatorUtils ../geometry/Extent".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w){h=h(null,{declaredClass:"esri.dijit.Attribution",
itemDelimiter:" | ",listClass:"esriAttributionList",itemClass:"esriAttributionItem",lastItemClass:"esriAttributionLastItem",delimiterClass:"esriAttributionDelim",constructor:function(a,c){try{l.mixin(this,a);this._attributions={};this._pendingDfds={};this._activeLayers=[];this._sharedLayers=[];var e=this.domNode=m.byId(c),f=this.map,k="\x3cspan class\x3d'"+this.listClass+"'\x3e\x3c/span\x3e";if(e&&(g.set(e,"innerHTML",k),this.listNode=b.query(".esriAttributionList",e)[0],this.itemNodes={}),this._eventConnections=
[d.connect(f,"onLayerAdd",this,this._onLayerAdd),d.connect(f,"onLayerRemove",this,this._onLayerRemove),d.connect(f,"onLayerSuspend",this,this._onLayerSuspend),d.connect(f,"onLayerResume",this,this._onLayerResume),d.connect(f,"onResize",this,this._adjustFocus),d.connect(f,"onExtentChange",this,this._onExtentChange)],f.loaded){var h,n,q=f.layerIds.concat(f.graphicsLayerIds),r=q.length;for(n=0;r>n;n++)h=f.getLayer(q[n]),h.loaded&&this._onLayerAdd(h)}}catch(t){}},startup:function(){},destroy:function(){a.forEach(this._eventConnections,
d.disconnect);e.destroy(this.listNode);this.map=this.domNode=this._eventConnections=this.listNode=this._attributions=this._pendingDfds=this.itemNodes=this._activeLayers=this._lastItem=this._sharedLayers=null},_onLayerAdd:function(a){try{var b=this._attributions,c=a.id;if(!u.isDefined(b[c])&&a.showAttribution)if(a.hasAttributionData){var d=a.getAttributionData();this._pendingDfds[c]=1;b[c]=d;d.addBoth(l.partial(this._onAttributionLoad,this,a))}else b[c]=a.copyright||a.copyrightText||"",b[c]?(a.suspended||
this._activeLayers.push(c),this._createNode(c)):this._onLayerRemove(a)}catch(e){}},_onAttributionLoad:function(a,b,c){var d=a._attributions,e=a._pendingDfds,f=b.id;e&&e[f]&&(delete e[f],(!c||c instanceof Error)&&(c=""),c?d[f]=a._createIndexByLevel(c,-1!==b.declaredClass.toLowerCase().indexOf("vetiledlayer")):d[f]=b.copyright||b.copyrightText||"",d[f]?(b.suspended||a._activeLayers.push(f),a._createNode(f)):a._onLayerRemove(b))},_onLayerRemove:function(b){try{var c,d=b.id,f=this.itemNodes,g=-1;this._onLayerSuspend(b);
delete this._attributions[d];delete this._pendingDfds[d];c=this._getGroupIndex(d);-1!==c&&(g=a.indexOf(this._sharedLayers[c],d),-1!==g&&(this._sharedLayers[c].splice(g,1),1>=this._sharedLayers[c].length&&this._sharedLayers.splice(c,1)));f[d]&&-1===g&&e.destroy(f[d]);delete f[d];this._updateLastItem()}catch(k){}},_onLayerSuspend:function(b){try{var c=b.id;if(this._attributions[c]){var d=a.indexOf(this._activeLayers,c),e=this.itemNodes[c];-1!==d&&this._activeLayers.splice(d,1);e&&this._toggleItem(e,
!1,this._getGroupIndex(c))}}catch(f){}},_adjustFocus:function(){var a=this.domNode.scrollWidth>this.domNode.clientWidth,b=n.contains(this.domNode,"esriAttributionOpen");g.set(this.domNode,"tabIndex",a||b?"0":"")},_onLayerResume:function(b){try{var c=b.id,d=this._attributions[c],e=this.itemNodes[c];if(d&&(-1===a.indexOf(this._activeLayers,c)&&this._activeLayers.push(c),e)){var f=l.isString(d)?d:this._getContributorsList(d,this.map.extent,this.map.getLevel());l.isString(d)||g.set(e,"innerHTML",f?f+
this._getDelimiter():"");f&&this._toggleItem(e,!0,this._getGroupIndex(c))}}catch(k){}},_onExtentChange:function(a,b,c,d){try{var e,f,k,h,m=this._activeLayers,n=this._attributions,q=this.itemNodes,r=m.length||0;for(h=0;r>h;h++)if(f=m[h],k=n[f],e=q[f],e&&!l.isString(k)){var t=this._getContributorsList(k,a,d?d.level:-1);g.set(e,"innerHTML",t?t+this._getDelimiter():"");this._toggleItem(e,!!t,-1)}}catch(u){}this._adjustCursorStyle()},_createNode:function(a){if(this.domNode){var b,c=this._checkShareInfo(a),
d=c&&c.sharedWith,d=d&&this.itemNodes[d],f=this.map,g=this._attributions[a],g=l.isString(g)?g:this._getContributorsList(g,f.extent,f.getLevel()),f=!!g&&!f.getLayer(a).suspended;d?(this.itemNodes[a]=d,this._toggleItem(d,f,c.index)):(b=this.itemNodes[a]=e.create("span",{"class":this.itemClass,innerHTML:g?g+this._getDelimiter():"",style:{display:f?"inline":"none"}},this.listNode),f&&this._setLastItem(b));this._adjustCursorStyle()}},_checkShareInfo:function(b){var c,d,e,f=this._attributions,g=-1,k=f[b];
if(k&&l.isString(k)){for(d in f)if(c=f[d],d!==b&&c&&l.isString(c)&&c.length===k.length&&c.toLowerCase()===k.toLowerCase()){e=d;break}var h;c=this._sharedLayers;f=c.length;if(e){for(d=0;f>d;d++)if(h=c[d],-1!==a.indexOf(h,e)){g=d;h.push(b);break}-1===g&&(g=c.push([e,b])-1)}}return-1<g?{index:g,sharedWith:e}:null},_getGroupIndex:function(b){var c,d=this._sharedLayers,e=d.length,f=-1;for(c=0;e>c;c++)if(-1!==a.indexOf(d[c],b)){f=c;break}return f},_getDelimiter:function(){var a=this.itemDelimiter;return a?
"\x3cspan class\x3d'"+this.delimiterClass+"'\x3e"+a+"\x3c/span\x3e":""},_toggleItem:function(b,d,e){if(-1<e&&!d){var f=this._sharedLayers[e],g=f.length,k=this._activeLayers;for(e=0;g>e;e++)if(-1!==a.indexOf(k,f[e]))return}c.set(b,"display",d?"inline":"none");this._updateLastItem()},_updateLastItem:function(){var a,b,d=this.listNode.childNodes;if(a=d.length)for(--a;0<=a;a--)if(b=d[a],"none"!==c.get(b,"display")){this._setLastItem(b);break}this._adjustCursorStyle()},_setLastItem:function(a){var b=this.itemClass,
c=this.lastItemClass;this._lastItem&&n.replace(this._lastItem,b,c);a&&(n.replace(a,c,b),this._lastItem=a)},_createIndexByLevel:function(a,b){var c,d,e,f,g,k,h,m=a.contributors,l=m?m.length:0,n=new v(4326),q={};for(f=0;l>f;f++)for(c=m[f],k=(d=c.coverageAreas)?d.length:0,g=0;k>g;g++)for(e=d[g],h=e.bbox,h={extent:t.geographicToWebMercator(new w(h[1],h[0],h[3],h[2],n)),attribution:c.attribution||"",zoomMin:e.zoomMin-(b&&e.zoomMin?1:0),zoomMax:e.zoomMax-(b&&e.zoomMax?1:0),score:u.isDefined(e.score)?e.score:
100,objectId:f},e=h.zoomMin;e<=h.zoomMax;e++)q[e]=q[e]||[],q[e].push(h);return q},_getContributorsList:function(a,b,c){var d="";if(b&&u.isDefined(c)&&-1<c){a=a[c];var d=b.getCenter().normalize(),e=a?a.length:0,f=[],g={};for(c=0;e>c;c++)b=a[c],!g[b.objectId]&&b.extent.contains(d)&&(g[b.objectId]=1,f.push(b));f.sort(function(a,b){return b.score-a.score||a.objectId-b.objectId});e=f.length;for(c=0;e>c;c++)f[c]=f[c].attribution;d=f.join(", ")}return d},_adjustCursorStyle:function(){var a=q.position(this.listNode.parentNode,
!0).h;n.contains(this.listNode.parentNode,"esriAttributionOpen")?(n.remove(this.listNode.parentNode,"esriAttributionOpen"),a>q.position(this.listNode.parentNode,!0).h?(c.set(this.listNode.parentNode,"cursor","pointer"),n.add(this.listNode.parentNode,"esriAttributionOpen")):c.set(this.listNode.parentNode,"cursor","default")):(n.add(this.listNode.parentNode,"esriAttributionOpen"),a<q.position(this.listNode.parentNode,!0).h?c.set(this.listNode.parentNode,"cursor","pointer"):c.set(this.listNode.parentNode,
"cursor","default"),n.remove(this.listNode.parentNode,"esriAttributionOpen"));this._adjustFocus()}});return f("extend-esri")&&l.setObject("dijit.Attribution",h,r),h})},"esri/layers/VectorTileLayerImpl":function(){define("dojo/_base/lang dojo/has dojo/dom-construct dojo/dom-style dojo/io-query ../geometry/Extent ../geometry/screenUtils ../geometry/scaleUtils ../SpatialReference ../config ../lang ../domUtils ../urlUtils ../kernel ./layer ./TileInfo ./unitBezier ./vectorTiles/request ./vectorTiles/core/promiseUtils ./vectorTiles/core/urlUtils ./vectorTiles/layers/support/vectorTileLayerLoader ./vectorTiles/views/vectorTiles/style/StyleRepository ./vectorTiles/views/vectorTiles/VectorTileContainer ./vectorTiles/views/vectorTiles/TileHandler ./vectorTiles/views/2d/engine/StageGL ./vectorTiles/views/2d/FrameBudget ./vectorTiles/views/2d/layers/support/TileInfoView ./vectorTiles/views/2d/layers/support/TileStrategy ./vectorTiles/views/2d/layers/support/TileKey ./vectorTiles/views/webgl/webgl-utils".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K){var J=t.ease;k=u.createSubclass({declaredClass:"esri.layers.VectorTileLayer",_mapsWithAttribution:["World_Basemap"],_eventMap:{"style-change":["style"]},constructor:function(a,b){this._frame=this._frame.bind(this);this._params=b||{};b&&b.tileServers&&b.tileServers.length&&(this.tileServers=b.tileServers=b.tileServers.map(function(a){return q.getAbsoluteUrl(a)},this));this._viewState={scale:0,width:0,height:0,size:[0,0],rotation:0,
resolution:1,center:[0,0],toScreen:function(a,b){var c=this.center[1]+this.resolution*this.height*.5;return a[0]=(b[0]-(this.center[0]-this.resolution*this.width*.5))/this.resolution,a[1]=(c-b[1])/this.resolution,a},toMap:function(a,b){var c=this.center[1]+this.resolution*this.height*.5;return a[0]=this.center[0]-this.resolution*this.width*.5+b[0]*this.resolution,a[1]=c-b[1]*this.resolution,a}};this._budget=new E(6);this._renderParameters={budget:this._budget,state:this._viewState,devicePixelRatio:window.devicePixelRatio,
stationary:!0};this._updateParameters={budget:this._budget,state:this._viewState,devicePixelRatio:window.devicePixelRatio,stationary:!0};this.setStyle(a);this.registerConnectEvents()},setStyle:function(a){return this.loadStyle(a)},getStyle:function(){return this.currentStyleInfo&&this.currentStyleInfo.style||null},opacity:1,setOpacity:function(a){this.opacity!=a&&this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_pinching:!1,_refreshTS:null,_reCheckTS:/[\?\&]_ts=/gi,_reReplaceTS:/([\?\&]_ts=)[0-9]+/gi,
addTimestampToURL:function(a){var b=this._refreshTS;return b&&(this._reCheckTS.test(a)?a=a.replace(this._reReplaceTS,"$$$1"+b):a+=(-1===a.indexOf("?")?"?":"\x26")+"_ts\x3d"+b),a},getTileUrl:function(a,c,d){var e=this._getToken(),f=this._url&&this._url.query,g=this.tileServers[c%this.tileServers.length];return g=g.replace(/\{z\}/gi,a.toString()).replace(/\{level\}/gi,a.toString()).replace(/\{y\}/gi,c.toString()).replace(/\{row\}/gi,c.toString()).replace(/\{x\}/gi,d.toString()).replace(/\{col\}/gi,
d.toString()),f&&(g+="?"+b.objectToQuery(f)),!e||f&&f.token||(g+=(-1===g.indexOf("?")?"?":"\x26")+"token\x3d"+e),g=this.addTimestampToURL(g),q.addProxy(g)},loadStyle:function(a){if(this._loadingPromise&&"string"==typeof a&&this.url===a)return this._loadingPromise;this._stopDisplay();var b=this._loadingPromise;return this._loadingPromise=z.loadMetadata(a).then(function(a){this.url=a.url;this._url=a.parsedUrl;this.currentStyleInfo={serviceUrl:a.serviceUrl,styleUrl:a.styleUrl,style:a.style,layerDefinition:a.layerDefinition};
this.styleRepository=new A(a.style,a);this._read(a.layerDefinition);this.onStyleChange(this.getStyle())}.bind(this)).then(function(){this.loaded||(this.loaded=!0,this.onLoad(this));this.suspended||this._tileHandler||this._startDisplay()}.bind(this)).otherwise(function(a){throw this._errorHandler(a),a;}.bind(this)),b&&!b.isFulfilled()&&b.cancel(),this._loadingPromise},refresh:function(){this.suspended||(this._refreshTS=Date.now(),this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD))},
takeScreenshot:function(a){return this._stageGL?this._stageGL.takeScreenshot(a):x.reject("No valid GL context!")},_setMap:function(b,c,e){this.inherited(arguments);this._map=b;var f=this._div=a.create("div",null,c);if(d.set(f,{position:"absolute",width:b.width+"px",height:b.height+"px",overflow:"visible",opacity:this.opacity}),this._onResizeHandle=b.on("resize",h.hitch(this,this._onResizeHandler)),this._onOpacityHandle=this.on("opacity-change",h.hitch(this,this._opacityChangeHandler)),this._onScaleVisHandle=
this.on("scale-visibility-change",h.hitch(this,function(){})),this._onVisibilityHandle=this.on("visibility-change",h.hitch(this,function(){})),this._stageGL=new D,this._stageGL.setElement(this._stageGL.createElement()),this._div.appendChild(this._stageGL.element),this._stageGL.parent={requestChildRender:this._scheduleRender.bind(this)},this._stageGL.attach(this._renderParameters),this._startDisplay(),this.evaluateSuspension(),this.suspended&&!b.loaded)var g=b.on("load",h.hitch(this,function(){g.remove();
this.evaluateSuspension()}));return f},_unsetMap:function(b,c){this._map=null;this.suspended||this._stopDisplay();this._stageGL.detach(this._renderParameters);this._stageGL=null;a.destroy(this._div);this._div=null;this._handles&&this._handles.forEach(function(a){a.remove()});this._handles=null;this._onResizeHandle=this._onResizeHandle&&this._onResizeHandle.remove()&&null;this._onOpacityHandle=this._onOpacityHandle&&this._onOpacityHandle.remove()&&null;this._onScaleVisHandle=this._onScaleVisHandle&&
this._onScaleVisHandle.remove()&&null;this._onVisibilityHandle=this._onVisibilityHandle&&this._onVisibilityHandle.remove()&&null;this.inherited(arguments)},_read:function(a){this.version=a.currentVersion||a.version;this.fullExtent=new f(a.fullExtent);this.initialExtent=new f(a.initialExtent);this.spatialReference=this.fullExtent.spatialReference;this.tileInfo=new v(a.tileInfo);this.tileInfo.size=[this.tileInfo.cols,this.tileInfo.height];this.tileInfo.spatialReference.isWrappable=this.tileInfo.spatialReference._isWrappable();
this.tileInfo.scales=this.tileInfo.lods.map(function(a){return a.scale});this.tileInfo.scaleToZoom=function(a){for(var b=this.scales,c=b.length-1,d=0;c>d;d++){var e=b[d],f=b[d+1];if(a>=e)break;if(f===a)return d+1;if(e>a&&a>f)return d+1-(a-f)/(e-f)}return d};this._hasMin||this.setMinScale(a.minScale);this._hasMax||this.setMaxScale(a.maxScale);a.tileMap&&(this.tileIndexUrl=y.join(this.currentStyleInfo.serviceUrl,a.tileMap));this._params.tileServers||(this.currentStyleInfo.serviceUrl?this.tileServers=
a.tiles.map(function(a,b,c){return y.join(this.currentStyleInfo.serviceUrl,a)},this):this.tileServers=a.tiles);a=null;this.currentStyleInfo.serviceUrl&&(a=y.urlToObject(this.currentStyleInfo.serviceUrl),a=this._getDefaultAttribution(a.path));a?(this.attributionDataUrl=a,this.hasAttributionData=!0):(this.attributionDataUrl=null,this.hasAttributionData=!1)},_getDefaultAttribution:function(a){var b=a.match(/^https?:\/\/(basemaps|basemapsbeta)\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);
if(b&&(a=b[3])){var c,b=b[2]||"";a=a.toLowerCase();for(var d=0,e=this._mapsWithAttribution.length;e>d;d++)if(c=this._mapsWithAttribution[d],-1<c.toLowerCase().indexOf(a))return a=window.location.protocol,("http:"===a||"https:"===a?a:"https:")+"//static.arcgis.com/attribution/Vector"+b+"/"+c}},_startDisplay:function(){var a={styleRepository:this.styleRepository,tileIndexUrl:this.tileIndexUrl,tileInfo:this.tileInfo,fullExtent:{width:this.fullExtent.getWidth()},getTileUrl:this.getTileUrl.bind(this)};
this._renderParameters.devicePixelRatio=this._updateParameters.devicePixelRatio=window.devicePixelRatio;this._vectorTileContainer=new B;this._stageGL.addChild(this._vectorTileContainer);this._tileHandler=new C(a,this._scheduleUpdate.bind(this));this._tileInfoView=new F(this.tileInfo,this.fullExtent);this._tileHandler.updateTile.bind(this._tileHandler);this._tileHandler.start().then(function(){this._tileStrategy=new H(this._vectorTileContainer,this._tileInfoView,this._scheduleUpdate.bind(this),function(a,
b){return this._tileHandler.getVectorTile(G.fromId(a),b)}.bind(this));this._vectorTileContainer.initialize(this._tileHandler.spriteMosaic,this._tileHandler.glyphMosaic,this.tileInfo,this._tileInfoView);this._scheduleUpdate()}.bind(this))},_stopDisplay:function(){this._tileStrategy&&(this._renderRequested=!1,this._updateRequested=!1,this._frameRequested=!1,this._animation&&(this._animation.stop(),this._animation=null),this._vectorTileContainer.removeAllChildren(),this._stageGL.removeChild(this._vectorTileContainer),
this._vectorTileContainer=null,this._tileHandler.stop(),this._tileHandler.destroy(),this._tileStrategy.destroy(),this._tileInfoView=this._tileHandler=this._tileStrategy=null)},_scheduleRender:function(){this._renderRequested=!0;this._map&&this._tileStrategy&&this._scheduleFrame()},_scheduleUpdate:function(){this._updateRequested=!0;this._map&&this._tileStrategy&&this._scheduleFrame()},_scheduleFrame:function(){this._map&&(this._frameRequested||(this._frameRequested=!0,N(this._frame)))},_frame:function(){if(this._frameRequested){this._frameRequested=
!1;this._renderParameters.devicePixelRatio!==window.devicePixelRatio&&(this._renderParameters.devicePixelRatio=this._updateParameters.devicePixelRatio=window.devicePixelRatio,this._stopDisplay(),this._startDisplay());this._animation&&(this._animation.step(),this._animation.running||(this._animation=null));if(this._updateParameters.stationary=this._renderParameters.stationary=!this._animation&&!this._pinching&&!this._panning,this._budget.reset(),this._viewState.resolution=this._viewState.scale/(39.37*
m.getUnitValueForSR(this.spatialReference)*96),this._renderRequested&&(this._renderRequested=!1,this._stageGL.render(this._renderParameters)),this._updateRequested){this._updateRequested=!1;var a=this._tileHandler.updateTile.bind(this._tileHandler);this._tileStrategy.updateTiles(a,this._updateParameters);this._tileStrategy.update(this._updateParameters)}this._animation&&(this._scheduleRender(),this._scheduleUpdate())}},_setViewState:function(a){a=h.mixin(this._viewState,a);a.center.type&&(a.center=
[a.center.x,a.center.y]);this._scheduleRender();this._scheduleUpdate()},_animateViewState:function(a,b){var c=b.immediate||0===e.defaults.map.zoomDuration;if(this._animation=null,c)return void this._setViewState(a);var c=this._viewState,d=e.defaults.map.zoomDuration,f=L()+16,g=c.center[0],k=c.center[1],h=c.scale,m=Array.isArray(a.center)?a.center[0]:a.center.x,l=Array.isArray(a.center)?a.center[1]:a.center.y,n=a.scale||c.scale,q=this;this._animation={running:!0,stop:function(){this.running=!1},step:function(){if(this.running){var a=
(L()+16-f)/d;1<=a&&(a=1,this.running=!1);a=J(a);q._setViewState({center:[g+(m-g)*a,k+(l-k)*a],scale:h+(n-h)*a})}}};this._scheduleRender();this._scheduleUpdate()},onStyleChange:function(a){},_opacityChangeHandler:function(a){this._div&&(this._div.style.opacity=a.opacity)},_onResizeHandler:function(a){var b=this._div&&this._div.style;b&&(b.width=a.width+"px",b.height=a.height+"px",this._map,this._setViewState({center:a.extent.getCenter(),width:a.width,height:a.height,size:[a.width,a.height]}))},onResume:function(){var a=
this._map;this.inherited(arguments);n.show(this._div);this._setViewState({center:a.extent.getCenter(),scale:a.getScale(),width:a.width,height:a.height,size:[a.width,a.height]});this._handles=[a.on("pan-end",h.hitch(this,this._onPanEndHandler)),a.on("pan",h.hitch(this,this._onPanExtentChangeHandler)),a.on("extent-change",h.hitch(this,this._onExtentChangeHandler)),a.on("scale",h.hitch(this,this._onScaleHandler))]},onSuspend:function(){this.inherited(arguments);n.hide(this._div);this._handles.forEach(function(a){a.remove()});
this._handles=null},_onPanEndHandler:function(a){this._panning=!1;this._setViewState({center:a.extent.getCenter(),scale:this._map.getScale()})},_onPanExtentChangeHandler:function(a){this._panning=!0;this._animation&&(this._animation.stop(),this._animation=null);this._setViewState({center:a.extent.getCenter(),scale:this._map.getScale()})},_onExtentChangeHandler:function(a){var b=this._pinching||a.immediate;this._animateViewState({center:a.extent.getCenter(),scale:a.lod.scale},{immediate:b});this._pinching=
!1},_onScaleHandler:function(a){this._animation&&(this._animation.stop(),this._animation=null);var b=this._map;if(b._zoomAnimDiv.extent)return this._panning=!1,this._pinching=!1,void this._animateViewState({center:b._zoomAnimDiv.extent.getCenter(),scale:b._zoomAnimDiv.newLod.scale},{immediate:a.immediate});var c,d,e,f,g;a=b.navigationManager;var k=a._dragOrigin,h=b.extent.getCenter(),m=k.x-.5*b.width,k=k.y-.5*b.height,l=b.extent.getWidth()/b.width;a._pinchScale?(this._pinching=!0,c=a._pinchScale,
d=l/c,e=m*(d-l),f=k*(d-l),h.x-=e,h.y+=f,g=b.__LOD.scale/c,this._setViewState({center:h,scale:g})):a._zoomEndExtent&&(this._pinching=!1,c=b.getScale()/b.navigationManager._zoomEndLod.scale,d=l/c,e=m*(d-l),f=k*(d-l),h.x-=e,h.y+=f,g=b.navigationManager._zoomEndLod.scale,this._animateViewState({center:h,scale:g},{immediate:!1}))}});k.ACCESS_TOKEN=null;k.supported=function(){return K.detectWebGL()[0]};var I,L=function(){var a,b=window.performance||{},c=b.now||b.webkitNow||b.msNow||b.oNow||b.mozNow;return void 0!==
c?function(){return c.call(b)}:(a=window.performance&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.timing.navigationStart:(new Date).getTime(),function(){return(new Date).getTime()-a})}();g=l("ff");c=l("ie");r=l("webkit");l=l("opera");var M=(new Date).getTime(),N=window.requestAnimationFrame;return N||(I=r&&"webkit"||g&&"moz"||l&&"o"||c&&"ms",N=window[I+"RequestAnimationFrame"],N||(N=function(a){var b=L(),c=Math.max(0,16-(b-M)),d=window.setTimeout(function(){a(L())},
c);return M=b+c,d})),k})},"esri/layers/unitBezier":function(){define([],function(){var h=function(a,d,b,f){function k(a,b){var c,d,f,k,l;b=null==b?1E-6:b;f=a;for(l=0;8>l;l++){if(k=((e*f+g)*f+h)*f-a,Math.abs(k)<b)return f;if(d=(3*e*f+2*g)*f+h,1E-6>Math.abs(d))break;f-=k/d}if(c=0,d=1,f=a,c>f)return c;if(f>d)return d;for(;d>c&&!(k=((e*f+g)*f+h)*f,Math.abs(k-a)<b);)a>k?c=f:d=f,f=.5*(d-c)+c;return f}var h=3*a,g=3*(b-a)-h,e=1-h-g,c=3*d,l=3*(f-d)-c,q=1-c-l;return function(a,b){var d=k(a,b);return((q*d+l)*
d+c)*d}},l=/^cubic-bezier\((.*)\)/;return h.parse=function(a){var d=h[a]||null;!d&&(a=l.exec(a))&&(a=a[1].split(",").map(function(a){return parseFloat(a.trim())}),4!==a.length||a.some(function(a){return isNaN(a)})||(d=h.apply(h,a)));return d},h.ease=h(.25,.1,.25,1),h.linear=h(0,0,1,1),h.easeIn=h["ease-in"]=h(.42,0,1,1),h.easeOut=h["ease-out"]=h(0,0,.58,1),h.easeInOut=h["ease-in-out"]=h(.42,0,.58,1),h})},"esri/layers/vectorTiles/request":function(){define(["require","exports","esri/request","dojo/_base/lang"],
function(h,l,a,d){return function(b,f){var k=d.mixin({},{url:b,failOk:!0},f);return"array-buffer"===f.responseType?(k.handleAs="arraybuffer",delete k.responseType):f.responseType&&(k.handleAs=f.responseType,delete k.responseType),null!==f.query&&(k.content=k.query,delete k.query),a(k).then(function(a){return{data:a}})}})},"esri/layers/vectorTiles/core/promiseUtils":function(){define(["require","exports","dojo/Deferred","./Error"],function(h,l,a,d){l.eachAlways=function(b){var d=new a,k=[],h=b.length;
return 0===h&&d.resolve(k),b.forEach(function(a){var b={promise:a};k.push(b);a.then(function(a){b.value=a}).otherwise(function(a){b.error=a}).then(function(){--h;0===h&&d.resolve(k)})}),d.promise};l.create=function(b){var d=new a;return b(function(a){return void 0===a&&(a=null),d.resolve(a)},d.reject),d.promise};l.reject=function(b){var d=new a;return d.reject(b),d.promise};l.resolve=function(b){void 0===b&&(b=null);var d=new a;return d.resolve(b),d.promise};l.after=function(b,d){void 0===d&&(d=null);
var k=0,h=new a(function(){k&&(clearTimeout(k),k=0)});return k=setTimeout(function(){h.resolve(d)},b),h.promise};l.timeout=function(b,f,k){var h=0,g=new a(b.cancel);return b.then(function(a){g.isFulfilled()||(g.resolve(a),h&&(clearTimeout(h),h=0))}),b.otherwise(function(a){g.isFulfilled()||(g.reject(a),h&&(clearTimeout(h),h=0))}),h=setTimeout(function(){var a=k||new d("promiseUtils:timeout","The wrapped promise did not resolve within "+f+" ms");g.reject(a)},f),g.promise};l.wrapCallback=function(b){var d=
!1,k=new a(function(){return d=!0});return b(function(a){d||k.resolve(a)}),k.promise}})},"esri/layers/vectorTiles/core/Error":function(){define(["require","exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","./Message"],function(h,l,a,d,b){h=function(b){function d(){b.apply(this,arguments)}return a(d,b),d}(b);return h.prototype.type="error",h})},"esri/layers/vectorTiles/core/tsSupport/extendsHelper":function(){define([],function(){return function(h,l){function a(){this.constructor=
h}for(var d in l)l.hasOwnProperty(d)&&(h[d]=l[d]);h.prototype=null===l?Object.create(l):(a.prototype=l.prototype,new a)}})},"esri/layers/vectorTiles/core/tsSupport/decorateHelper":function(){define([],function(){return function(h,l,a,d){var b,f=arguments.length,k=3>f?l:null===d?d=Object.getOwnPropertyDescriptor(l,a):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)k=Reflect.decorate(h,l,a,d);else for(var m=h.length-1;0<=m;m--)(b=h[m])&&(k=(3>f?b(k):3<f?b(l,a,k):b(l,a))||k);return 3<
f&&k&&Object.defineProperty(l,a,k),k}})},"esri/layers/vectorTiles/core/Message":function(){define(["require","exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","dojo/string"],function(h,l,a,d,b){return function(){function a(d,f,g){this.name=d;this.message=f&&b.substitute(f,g,function(a){return null==a?"":a})||"";this.details=g}return a.prototype.toString=function(){return"["+this.name+"]: "+this.message},a}()})},"esri/layers/vectorTiles/core/urlUtils":function(){define(["require",
"exports","esri/urlUtils","dojo/_base/url"],function(h,l,a,d){function b(a){return f(a)||c.test(a)}function f(a){return a&&"/"===a[0]&&"/"===a[1]}function k(a){return"string"==typeof a?new d(m(a)):(a.scheme||(a.scheme=l.appUrl.scheme),a)}function m(a,b){void 0===b&&(b=l.appBaseUrl);var d;if(f(a))d="file"===l.appUrl.scheme?"https:"+a:l.appUrl.scheme+":"+a;else if(c.test(a))d=a;else{d=g;var e;if("/"===a[0]){e=b;var k=e.indexOf("//"),k=e.indexOf("/",k+2);e=-1===k?e:e.slice(0,k)}else e=b;d=d(e,a)}return d}
function g(){for(var a=[],c=0;c<arguments.length;c++)a[c-0]=arguments[c];if(a&&a.length){c=[];if(b(a[0])){var d=a[0],f=d.indexOf("//");c.push(d.slice(0,f+1));e.test(a[0])&&(c[0]+="/");a[0]=d.slice(f+2)}else"/"===a[0][0]&&c.push("");a=a.reduce(function(a,b){return a.concat(b.split("/"))},[]);for(d=0;d<a.length;d++)f=a[d],".."===f&&0<c.length?c.pop():!f||"."===f&&0!==c.length||c.push(f);return c.join("/")}}l.normalize=function(b){return a.normalize(b)};l.canUseXhr=function(b){return a.canUseXhr(b)};
h=Function("return this")();l.appUrl=new d(h.location);l.appBaseUrl=function(){var a=l.appUrl.path,a=a.substring(0,a.lastIndexOf(a.split("/")[a.split("/").length-1]));return""+(l.appUrl.scheme+"://"+l.appUrl.host+(null!=l.appUrl.port?":"+l.appUrl.port:""))+a}();var e=/^\s*file:/i,c=/^\s*[a-z][a-z0-9-+.]*:[^0-9]/i;l.isAbsolute=b;l.urlToObject=function(b){return a.urlToObject(b)};l.getOrigin=function(a){if("data:"===a.slice(0,5))return null;var b=a.indexOf("://");if(-1===b&&f(a))b=2;else{if(-1===b)return null;
b+=3}b=a.indexOf("/",b);return-1===b?a:a.slice(0,b)};l.makeAbsolute=m;l.hasSameOrigin=function(a,b,c){void 0===c&&(c=!1);a=k(a);b=k(b);return c||a.scheme===b.scheme?a.host.toLowerCase()===b.host.toLowerCase()&&a.port===b.port:!1};l.join=g})},"esri/layers/vectorTiles/layers/support/vectorTileLayerLoader":function(){define("require exports dojo/has dojo/_base/lang ../../core/promiseUtils ../../core/urlUtils ../../config ../../request".split(" "),function(h,l,a,d,b,f,k,m){function g(a){if(a){var b=f.getOrigin(a);
return f.canUseXhr(b)||-1!==v.indexOf(b)||v.push(b),a}}function e(a,b,d){if(null!=b.sources){d&&-1!==d.path.indexOf("root.json")&&(d.path=d.path.substr(0,d.path.indexOf("root.json")),a.styleUrl=d.path);var e=q(b,d),g=b.sprite,k=b.glyphs;e&&e.url&&(e=d&&d.path?d.path:e.url,b.sprite&&!f.isAbsolute(b.sprite)&&(g=f.join(e,b.sprite)),b.glyphs&&!f.isAbsolute(b.glyphs)&&(k=f.join(e,b.glyphs)));return a.style=b,a.spriteUrl=g,a.glyphsUrl=k,n(a,b,d)}return b.hasOwnProperty("tileInfo")?(a.layerDefinition=b,
a.serviceUrl=d.path,c(a,b,d)):void 0}function c(a,b,c){if(u&&!b.hasOwnProperty("defaultStyles"))throw Error("Service definition must have 'defaultStyles' element!");b=b.defaultStyles;return f.isAbsolute(b)?a.styleUrl=f.normalize(b):a.styleUrl=f.normalize(f.join(c.path,b)),g(a.styleUrl),m(f.join(a.styleUrl,"root.json"),{responseType:"json"}).then(function(b){var c=b.data.sprite,d=b.data.glyphs;return c&&!f.isAbsolute(c)&&(c=f.join(a.styleUrl,c)),d&&!f.isAbsolute(d)&&(d=f.join(a.styleUrl,d)),a.spriteUrl=
c,a.glyphsUrl=d,a.style=b.data,b.data})}function n(a,c,d){c=q(c,d);return c||b.reject("Source isn't available in the syle object!"),c.url?(a.serviceUrl=c.url,f.isAbsolute(a.serviceUrl)||(a.serviceUrl=f.join(d.path,a.serviceUrl)),g(a.serviceUrl),m(a.serviceUrl,{query:{f:"json"},responseType:"json"}).then(function(b){return a.layerDefinition=r(b.data),a})):(a.layerDefinition=r(c),b.resolve(a))}function q(a,b){if(!a.sources)return null;var c=a.sources,d=null;if(c.esri){if(d=c.esri,b&&d.url&&!f.isAbsolute(d.url))c=
b.path.substring(0,b.path.lastIndexOf("/")),d.url=f.join(c,d.url)}else{for(var e=0,g=Object.keys(c);e<g.length;e++){var k=g[e];if(-1!==k.toLocaleLowerCase().indexOf("street")&&"vector"===d.type){d=c[k];break}}if(!d)for(e=0,g=Object.keys(c);e<g.length&&(k=g[e],d=c[k],"vector"!==d.type);e++);}return d}function r(a){if(a.hasOwnProperty("tileInfo"))return a;for(var b={xmin:-2.0037507067161843E7,ymin:-2.0037507067161843E7,xmax:2.0037507067161843E7,ymax:2.0037507067161843E7,spatialReference:{wkid:102100}},
c=(b.xmax-b.xmin)/512,d=[],e=a.hasOwnProperty("minzoom")?parseFloat(a.minzoom):0,f=a.hasOwnProperty("maxzoom")?parseFloat(a.maxzoom):16;f>e;e++){var k=c/Math.pow(2,e);d.push({level:e,scale:Math.floor(3779.527559055118*k),resolution:k})}return a.tiles.forEach(g),{capabilities:"TilesOnly",initialExtent:b,fullExtent:b,minScale:d[0].scale,maxScale:d[d.length-1].scale,tiles:a.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-2.0037508342787E7,y:2.0037508342787E7},lods:d,spatialReference:{wkid:102100}}}}
var u=a("dojo-debug-messages"),v=k.defaults&&k.defaults.io.corsEnabledServers||k.request.corsEnabledServers;l.loadMetadata=function(a){if(!a)return b.reject("invalid input URL!");var c={layerDefinition:null,parsedUrl:null,serviceUrl:null,style:null,styleUrl:null,url:null,spriteUrl:null,glyphsUrl:null};if("string"!=typeof a)return e(c,a,null).then(function(){return c});a=c.url=f.normalize(a);var k=c.parsedUrl=f.urlToObject(a);return g(a),m(k.path,{responseType:"json",query:d.mixin({f:"json"},k.query)}).then(function(a){return e(c,
a.data,k)}).then(function(){return c})}})},"esri/layers/vectorTiles/config":function(){define(["require","exports","esri/config"],function(h,l,a){return a})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleRepository":function(){define(["require","exports","./StyleLayer"],function(h,l,a){return function(){function d(a,f){this.styleJSON=a;this.version=parseFloat(a.version);this.sprite=f?f.spriteUrl:a.sprite;this.glyphs=f?f.glyphsUrl:a.glyphs;this.layers=(a.layers||[]).map(d._create);this._identifyRefLayers()}
return d.prototype._identifyRefLayers=function(){for(var a=[],d=[],k=0,h=this.layers;k<h.length;k++){var g=h[k];if(1===g.type){var e=g.sourceLayer,e=e+("|"+JSON.stringify(g.minzoom)),e=e+("|"+JSON.stringify(g.maxzoom)),e=e+("|"+JSON.stringify(g.filter));a.push({key:e,layer:g})}2===g.type&&(e=g.sourceLayer,e+="|"+JSON.stringify(g.minzoom),e+="|"+JSON.stringify(g.maxzoom),e+="|"+JSON.stringify(g.filter),e+="|"+JSON.stringify(g.layout["line-cap"]),e+="|"+JSON.stringify(g.layout["line-join"]),d.push({key:e,
layer:g}))}this._assignRefLayers(a);this._assignRefLayers(d)},d.prototype._assignRefLayers=function(a){a.sort(function(a,b){return a.key<b.key?-1:a.key>b.key?1:0});for(var d,k,h=a.length,g=0;h>g;g++){var e=a[g];if(e.key===d)e.layer.refLayerId=k;else if(d=e.key,k=e.layer.id,1===e.layer.type&&!e.layer.hasPaintProperty("fill-outline-color"))for(var c=g+1;h>c;c++){var l=a[c];if(l.key!==d)break;if(l.layer.hasPaintProperty("fill-outline-color")){a[g]=l;a[c]=e;k=l.layer.id;break}}}},d._create=function(b,
d,k){d=1-1/(k.length+1)*(1+d);switch(b.type){case "background":return new a.StyleLayer(0,b,d);case "fill":return new a.StyleLayer(1,b,d);case "line":return new a.StyleLayer(2,b,d);case "symbol":return new a.StyleLayer(3,b,d);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":throw Error("Unsupported vector tile circle layer");}throw Error("Unknown vector tile layer");},d}()})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleLayer":function(){define(["require","exports",
"./StyleDefinition","./StyleProperty","./Filter"],function(h,l,a,d,b){h=function(){function f(b,d,f){switch(this.type=b,this.id=d.id,this.source=d.source,this.sourceLayer=d["source-layer"],this.minzoom=d.minzoom,this.maxzoom=d.maxzoom,this.filter=d.filter,this.layout=d.layout,this.paint=d.paint,this.z=f,b){case 0:this._layoutDefinition=a.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=a.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=a.StyleDefinition.fillLayoutDefinition;
this._paintDefinition=a.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=a.StyleDefinition.lineLayoutDefinition;this._paintDefinition=a.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=a.StyleDefinition.symbolLayoutDefinition,this._paintDefinition=a.StyleDefinition.symbolPaintDefinition}this._layoutProperties=this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}return f.prototype.getFeatureFilter=function(){return void 0!==
this._featureFilter?this._featureFilter:this._featureFilter=b.createFilter(this.filter)},f.prototype.hasLayoutProperty=function(a){var b=this._layoutProperties;return b&&b[a]?!0:!1},f.prototype.hasPaintProperty=function(a){var b=this._paintProperties;return b?void 0!==b[a]:!1},f.prototype.getLayoutValue=function(a,b){var d,e=this._layoutProperties;e&&(e=e[a])&&(d=e.getValue(b));e=this._layoutDefinition[a];return void 0===d&&(d=e["default"]),"enum"===e.type&&(d=e.values.indexOf(d)),d},f.prototype.getPaintValue=
function(a,b){var d,e=this._paintProperties;e&&(e=e[a])&&(d=e.getValue(b));e=this._paintDefinition[a];return void 0===d&&(d=e["default"]),"enum"===e.type&&(d=e.values.indexOf(d)),d},f.prototype._parseLayout=function(a){var b={},f;for(f in a)b[f]=new d(this._layoutDefinition[f],a[f]);return b},f.prototype._parsePaint=function(a){var b={},f;for(f in a)b[f]=new d(this._paintDefinition[f],a[f]);return b},f}();l.StyleLayer=h;h=function(){return function(a,b){this.cap=a.getLayoutValue("line-cap",b);this.join=
a.getLayoutValue("line-join",b);this.miterLimit=a.getLayoutValue("line-miter-limit",b);this.roundLimit=a.getLayoutValue("line-round-limit",b)}}();l.LineLayout=h;h=function(){return function(a,b,d){this.allowOverlap=a.getLayoutValue("icon-allow-overlap",b);this.ignorePlacement=a.getLayoutValue("icon-ignore-placement",b);this.optional=a.getLayoutValue("icon-optional",b);this.rotationAlignment=a.getLayoutValue("icon-rotation-alignment",b);this.size=a.getLayoutValue("icon-size",b);this.rotate=a.getLayoutValue("icon-rotate",
b);this.padding=a.getLayoutValue("icon-padding",b);this.keepUpright=a.getLayoutValue("icon-keep-upright",b);this.offset=a.getLayoutValue("icon-offset",b);d&&1===this.rotationAlignment&&!a.hasLayoutProperty("icon-rotation-alignment")&&(this.rotationAlignment=0)}}();l.IconLayout=h;h=function(){return function(a,b,d){this.allowOverlap=a.getLayoutValue("text-allow-overlap",b);this.ignorePlacement=a.getLayoutValue("text-ignore-placement",b);this.optional=a.getLayoutValue("text-optional",b);this.rotationAlignment=
a.getLayoutValue("text-rotation-alignment",b);this.font=a.getLayoutValue("text-font",b);this.maxWidth=a.getLayoutValue("text-max-width",b);this.lineHeight=a.getLayoutValue("text-line-height",b);this.letterSpacing=a.getLayoutValue("text-letter-spacing",b);this.justify=a.getLayoutValue("text-justify",b);this.anchor=a.getLayoutValue("text-anchor",b);this.maxAngle=a.getLayoutValue("text-max-angle",b);this.size=a.getLayoutValue("text-size",b);this.rotate=a.getLayoutValue("text-rotate",b);this.padding=
a.getLayoutValue("text-padding",b);this.keepUpright=a.getLayoutValue("text-keep-upright",b);this.transform=a.getLayoutValue("text-transform",b);this.offset=a.getLayoutValue("text-offset",b);d&&1===this.rotationAlignment&&!a.hasLayoutProperty("text-rotation-alignment")&&(this.rotationAlignment=0)}}();l.TextLayout=h})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(h,l){var a=function(){function a(){}return a.backgroundLayoutDefinition=
{visibility:{type:"enum",values:["visible","none"],"default":"visible"}},a.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"}},a.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"line-cap":{type:"enum",values:["butt","round","square"],"default":"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],"default":"miter"},"line-miter-limit":{type:"number","default":2},"line-round-limit":{type:"number","default":1.05}},
a.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"symbol-placement":{type:"enum",values:["point","line"],"default":"point"},"symbol-spacing":{type:"number",minimum:1,"default":250},"symbol-avoid-edges":{type:"boolean","default":!1},"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean","default":!1},"icon-ignore-placement":{type:"boolean","default":!1},"icon-optional":{type:"boolean","default":!1},"icon-rotation-alignment":{type:"enum",values:["map",
"viewport"],"default":"viewport"},"icon-size":{type:"number",minimum:0,"default":1},"icon-rotate":{type:"number","default":0},"icon-padding":{type:"number",minimum:0,"default":2},"icon-keep-upright":{type:"boolean","default":!0},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport"],"default":"viewport"},"text-font":{type:"array",value:"string","default":["Open Sans Regular","Arial Unicode MS Regular"]},
"text-size":{type:"number",minimum:0,"default":16},"text-max-width":{type:"number",minimum:0,"default":10},"text-line-height":{type:"number","default":1.2},"text-letter-spacing":{type:"number","default":0},"text-justify":{type:"enum",values:["left","center","right"],"default":"center"},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),"default":"center"},"text-max-angle":{type:"number",minimum:0,"default":45},"text-rotate":{type:"number",
"default":0},"text-padding":{type:"number",minimum:0,"default":2},"text-keep-upright":{type:"boolean","default":!0},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],"default":"none"},"text-offset":{type:"array",value:"number",length:2,"default":[0,0]},"text-allow-overlap":{type:"boolean","default":!1},"text-ignore-placement":{type:"boolean","default":!1},"text-optional":{type:"boolean","default":!1}},a.backgroundPaintDefinition={"background-opacity":{type:"number",minimum:0,maximum:1,
"default":1},"background-color":{type:"color","default":[0,0,0,1]},"background-pattern":{type:"string"}},a.fillPaintDefinition={"fill-opacity":{type:"number",minimum:0,maximum:1,"default":1},"fill-antialias":{type:"boolean","default":!0},"fill-color":{type:"color","default":[0,0,0,1]},"fill-outline-color":{type:"color","default":[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"fill-pattern":{type:"string"}},
a.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,"default":1},"line-color":{type:"color","default":[0,0,0,1]},"line-translate":{type:"array",value:"number",length:2,"default":[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"line-width":{type:"number",minimum:0,"default":1},"line-gap-width":{type:"number",minimum:0,"default":0},"line-offset":{type:"number","default":0},"line-blur":{type:"number",minimum:0,"default":0},"line-dasharray":{type:"array",
value:"number","default":[]},"line-pattern":{type:"string"}},a.symbolPaintDefinition={"icon-opacity":{type:"number",minimum:0,maximum:1,"default":1},"icon-color":{type:"color","default":[0,0,0,1]},"icon-halo-color":{type:"color","default":[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,"default":0},"icon-halo-blur":{type:"number",minimum:0,"default":0},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},
"text-opacity":{type:"number",minimum:0,maximum:1,"default":1},"text-color":{type:"color","default":[0,0,0,1]},"text-halo-color":{type:"color","default":[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,"default":0},"text-halo-blur":{type:"number",minimum:0,"default":0},"text-translate":{type:"array",value:"number",length:2,"default":[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}},a.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,
"default":1},"raster-hue-rotate":{type:"number","default":0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,"default":0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,"default":1},"raster-saturation":{type:"number",minimum:-1,maximum:1,"default":0},"raster-contrast":{type:"number",minimum:-1,maximum:1,"default":0},"raster-fade-duration":{type:"number",minimum:0,"default":300}},a.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,"default":1},"circle-radius":{type:"number",
minimum:0,"default":5},"circle-color":{type:"color","default":[0,0,0,1]},"circle-blur":{type:"number",minimum:0,"default":0},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}},a}();l.StyleDefinition=a})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleProperty":function(){define(["require","exports","../../../Color","../GeometryUtils"],function(h,l,a,d){return function(){function b(a,d){var h;
switch(a.type){case "number":h=!0;break;case "color":h=!0;d=b._parseColor(d);break;case "array":h="number"===a.value;break;default:h=!1}h?this.getValue=this._interpolate(d):this.getValue=this._piecewise(d)}return b.prototype._piecewise=function(a){var b=a.stops;return b?function(a){var d=b.length;if(0!==d){for(var e=0,c=0;d>c&&b[c][0]<=a;c++)e=c;return b[e][1]}}:function(){return a}},b.prototype._interpolate=function(a){var b=a.stops;if(b){var h=a.base||1;return function(a){for(var e,c,f=b.length,
l=0;f>l;l++){var r=b[l];if(!(r[0]<=a)){c=r;break}e=r}if(e&&c){l=c[0]-e[0];a-=e[0];a=1===h?a/l:(Math.pow(h,a)-1)/(Math.pow(h,l)-1);if(Array.isArray(e[1])){e=e[1];c=c[1];f=[];for(l=0;l<e.length;l++)f.push(d.interpolate(e[l],c[l],a));return f}return d.interpolate(e[1],c[1],a)}return e?e[1]:c?c[1]:void 0}}return function(){return a}},b._parseColor=function(d){if(Array.isArray(d))return d;if("string"==typeof d){var k=new a(d);if(k)return[k.r/255,k.g/255,k.b/255,k.a||1]}if(d&&d.stops)return d.stops=d.stops.map(function(a){return[a[0],
b._parseColor(a[1])]}),d;throw Error("Incorrect color definition "+d);},b}()})},"esri/layers/vectorTiles/Color":function(){define(["require","exports","esri/Color"],function(h,l,a){return function(){return function(d){return new a(d)}}()})},"esri/layers/vectorTiles/views/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(h,l){function a(a,d){return a%=d,0<=a?a:a+d}l.C_INFINITY=Number.POSITIVE_INFINITY;l.C_PI=Math.PI;l.C_2PI=2*l.C_PI;l.C_PI_BY_2=l.C_PI/2;l.C_RAD_TO_256=128/
l.C_PI;l.C_256_TO_RAD=l.C_PI/128;l.C_DEG_TO_256=256/360;l.C_DEG_TO_RAD=l.C_PI/180;l.C_SQRT2=1.414213562;l.C_SQRT2_INV=1/l.C_SQRT2;var d=1/Math.LN2;l.positiveMod=a;l.radToByte=function(b){return a(b*l.C_RAD_TO_256,256)};l.degToByte=function(b){return a(b*l.C_DEG_TO_256,256)};l.log2=function(a){return Math.log(a)*d};l.sqr=function(a){return a*a};l.clamp=function(a,d,k){return Math.min(Math.max(a,d),k)};l.interpolate=function(a,d,k){return a*(1-k)+d*k};l.between=function(a,d,k){return a>=d&&k>=a||a>=
k&&d>=a}})},"esri/layers/vectorTiles/views/vectorTiles/style/Filter":function(){define(["require","exports"],function(h,l){return function(){function a(d,b,f){this._op=d;"$type"===b?(f instanceof Array?this._val=f.map(function(b){return a._types.indexOf(b)}):this._val=a._types.indexOf(f),this._op+=11):(this._key=b,this._val=f)}return a.prototype.filter=function(a){switch(this._op){case 0:return this._val;case 1:return a.values[this._key]===this._val;case 2:return a.values[this._key]!==this._val;case 3:return a.values[this._key]<
this._val;case 4:return a.values[this._key]>this._val;case 5:return a.values[this._key]<=this._val;case 6:return a.values[this._key]>=this._val;case 7:return-1!==this._val.indexOf(a.values[this._key]);case 8:return-1===this._val.indexOf(a.values[this._key]);case 9:for(var b=0,f=this._val;b<f.length;b++){var k=f[b];if(k.filter(a))return!0}return!1;case 10:b=0;for(f=this._val;b<f.length;b++)if(k=f[b],!k.filter(a))return!1;return!0;case 11:b=0;for(f=this._val;b<f.length;b++)if(k=f[b],k.filter(a))return!1;
return!0;case 12:return a.type===this._val;case 13:return a.type!==this._val;case 14:return a.type<this._val;case 15:return a.type>this._val;case 16:return a.type>=this._val;case 17:return a.type<=this._val;case 18:return-1!==this._val.indexOf(a.type);case 19:return-1===this._val.indexOf(a.type)}},a.createFilter=function(d){if(!d)return new a(0,void 0,!0);var b=d[0];if(1>=d.length)return new a(0,void 0,"any"!==b);switch(b){case "\x3d\x3d":return new a(1,d[1],d[2]);case "!\x3d":return new a(2,d[1],
d[2]);case "\x3e":return new a(4,d[1],d[2]);case "\x3c":return new a(3,d[1],d[2]);case "\x3e\x3d":return new a(6,d[1],d[2]);case "\x3c\x3d":return new a(5,d[1],d[2]);case "in":return new a(7,d[1],d.slice(2));case "!in":return new a(8,d[1],d.slice(2));case "any":return new a(9,void 0,d.slice(1).map(a.createFilter.bind(this)));case "all":return new a(10,void 0,d.slice(1).map(a.createFilter.bind(this)));case "none":return new a(11,void 0,d.slice(1).map(a.createFilter.bind(this)));default:throw Error("invalid operator: "+
b);}},a._types=["Unknown","Point","LineString","Polygon"],a}()})},"esri/layers/vectorTiles/views/vectorTiles/VectorTileContainer":function(){define("require exports ../../core/tsSupport/extendsHelper dojo/has ../../core/libs/gl-matrix/vec3 ../../core/libs/gl-matrix/mat4 ../2d/engine/Container ./renderers/Renderer ./GeometryUtils ./StencilClipGenerator".split(" "),function(h,l,a,d,b,f,k,m,g,e){var c=d("dojo-debug-messages");return function(d){function k(){d.call(this);this.isInitialized=!1;this._displayHeight=
this._displayWidth=0;this._clip=new e;this._tileCoordinateScale=b.create();this._orientationVec=b.create();this._displayScale=b.create();this._orientationVec.set([0,0,1]);this._defaultTransform=f.create()}return a(k,d),k.prototype.initialize=function(a,b,c,d){this._renderer=new m(a,b);this._tileInfoView=d;this._tileInfo=c;this.isInitialized=!0},k.prototype.prepareChildrenRenderParameters=function(a){var b=a.state;return b&&this._tileInfo&&this.isInitialized?(a.displayLevel=this._tileInfo.scaleToZoom(b.scale),
a.requiredLevel=this._tileInfoView.getClosestInfoForScale(b.scale).level,a.renderer=this._renderer,a):a},k.prototype.renderChildren=function(a){if(0!==this.children.length&&this.isInitialized&&a&&a.state){this.sortChildren(function(a,b){return b.resolution-a.resolution});this._clip.update(this.children);this._updateTilesTransform(a.state,this._tileInfoView.getClosestInfoForScale(a.state.scale).level);var b=a.context;if(b.setDepthWriteEnabled(!0),this._renderer.setStateParams(a.state,a.devicePixelRatio,
a.displayLevel),this._renderer.drawClippingMasks(b,this.children),b.setStencilWriteMask(0),b.setBlendFunctionSeparate(1,771,1,771),b.setStencilOp(7680,7680,7681),b.setDepthFunction(515),b.setBlendingEnabled(!1),b.setStencilTestEnabled(!0),b.setDepthTestEnabled(!0),b.setDepthWriteEnabled(!0),a.drawphase=0,d.prototype.renderChildren.call(this,a),b.setDepthWriteEnabled(!1),b.setBlendingEnabled(!0),a.drawphase=1,d.prototype.renderChildren.call(this,a),a.drawphase=2,d.prototype.renderChildren.call(this,
a),b.setStencilTestEnabled(!1),b.setDepthTestEnabled(!1),c){a=0;for(var e=this.children;a<e.length;a++){var f=e[a];f.attached&&f.visible&&this._renderer.renderTileInfo(b,f)}}this._renderer.needsRedraw()&&this.requestRender()}},k.prototype.attachChild=function(a,b){return a.attach(b)},k.prototype.detachChild=function(a,b){a.detach(b)},k.prototype.renderChild=function(a,b){a.render(b)},k.prototype._updateTilesTransform=function(a,b){var c=1/a.width,d=1/a.height,e=[0,0];this._calculateRelativeViewProjMat(this._tileInfo.lods[b].resolution,
a.resolution,a.rotation,this._tileInfo.size[1],4096,a.width,a.height,this._defaultTransform);for(var f=0,g=this.children;f<g.length;f++){var k=g[f];a.toScreen(e,k.topLeft);e[1]=a.height-e[1];k.tileTransform.displayCoord[0]=2*e[0]*c-1;k.tileTransform.displayCoord[1]=2*e[1]*d-1;k.key.level===b&&4096===k.coordRange?k.tileTransform.transform.set(this._defaultTransform):this._calculateRelativeViewProjMat(this._tileInfo.lods[k.key.level].resolution,a.resolution,a.rotation,this._tileInfo.size[1],k.coordRange,
a.width,a.height,k.tileTransform.transform)}},k.prototype._calculateRelativeViewProjMat=function(a,b,c,d,e,k,h,l){var m=.125;512!==d&&4096!==e&&(m=d/e);a=a/b*m;this._tileCoordinateScale.set([a,a,1]);(k!==this._displayWidth||h!==this._displayHeight)&&(this._displayScale.set([2/k,-2/h,1]),this._displayWidth=k,this._displayHeight=h);f.identity(l);f.scale(l,l,this._tileCoordinateScale);f.rotate(l,l,-c*g.C_DEG_TO_RAD,this._orientationVec);f.scale(l,l,this._displayScale);f.transpose(l,l)},k}(k)})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec3":function(){define(["./common"],
function(h){var l={};return l.create=function(){var a=new h.ARRAY_TYPE(3);return a[0]=0,a[1]=0,a[2]=0,a},l.clone=function(a){var d=new h.ARRAY_TYPE(3);return d[0]=a[0],d[1]=a[1],d[2]=a[2],d},l.fromValues=function(a,d,b){var f=new h.ARRAY_TYPE(3);return f[0]=a,f[1]=d,f[2]=b,f},l.copy=function(a,d){return a[0]=d[0],a[1]=d[1],a[2]=d[2],a},l.set=function(a,d,b,f){return a[0]=d,a[1]=b,a[2]=f,a},l.add=function(a,d,b){return a[0]=d[0]+b[0],a[1]=d[1]+b[1],a[2]=d[2]+b[2],a},l.subtract=function(a,d,b){return a[0]=
d[0]-b[0],a[1]=d[1]-b[1],a[2]=d[2]-b[2],a},l.sub=l.subtract,l.multiply=function(a,d,b){return a[0]=d[0]*b[0],a[1]=d[1]*b[1],a[2]=d[2]*b[2],a},l.mul=l.multiply,l.divide=function(a,d,b){return a[0]=d[0]/b[0],a[1]=d[1]/b[1],a[2]=d[2]/b[2],a},l.div=l.divide,l.ceil=function(a,d){return a[0]=Math.ceil(d[0]),a[1]=Math.ceil(d[1]),a[2]=Math.ceil(d[2]),a},l.floor=function(a,d){return a[0]=Math.floor(d[0]),a[1]=Math.floor(d[1]),a[2]=Math.floor(d[2]),a},l.min=function(a,d,b){return a[0]=Math.min(d[0],b[0]),a[1]=
Math.min(d[1],b[1]),a[2]=Math.min(d[2],b[2]),a},l.max=function(a,d,b){return a[0]=Math.max(d[0],b[0]),a[1]=Math.max(d[1],b[1]),a[2]=Math.max(d[2],b[2]),a},l.round=function(a,d){return a[0]=Math.round(d[0]),a[1]=Math.round(d[1]),a[2]=Math.round(d[2]),a},l.scale=function(a,d,b){return a[0]=d[0]*b,a[1]=d[1]*b,a[2]=d[2]*b,a},l.scaleAndAdd=function(a,d,b,f){return a[0]=d[0]+b[0]*f,a[1]=d[1]+b[1]*f,a[2]=d[2]+b[2]*f,a},l.distance=function(a,d){var b=d[0]-a[0],f=d[1]-a[1],k=d[2]-a[2];return Math.sqrt(b*b+
f*f+k*k)},l.dist=l.distance,l.squaredDistance=function(a,d){var b=d[0]-a[0],f=d[1]-a[1],k=d[2]-a[2];return b*b+f*f+k*k},l.sqrDist=l.squaredDistance,l.length=function(a){var d=a[0],b=a[1];a=a[2];return Math.sqrt(d*d+b*b+a*a)},l.len=l.length,l.squaredLength=function(a){var d=a[0],b=a[1];a=a[2];return d*d+b*b+a*a},l.sqrLen=l.squaredLength,l.negate=function(a,d){return a[0]=-d[0],a[1]=-d[1],a[2]=-d[2],a},l.inverse=function(a,d){return a[0]=1/d[0],a[1]=1/d[1],a[2]=1/d[2],a},l.normalize=function(a,d){var b=
d[0],f=d[1],k=d[2],b=b*b+f*f+k*k;return 0<b&&(b=1/Math.sqrt(b),a[0]=d[0]*b,a[1]=d[1]*b,a[2]=d[2]*b),a},l.dot=function(a,d){return a[0]*d[0]+a[1]*d[1]+a[2]*d[2]},l.cross=function(a,d,b){var f=d[0],k=d[1];d=d[2];var h=b[0],g=b[1];b=b[2];return a[0]=k*b-d*g,a[1]=d*h-f*b,a[2]=f*g-k*h,a},l.lerp=function(a,d,b,f){var k=d[0],h=d[1];d=d[2];return a[0]=k+f*(b[0]-k),a[1]=h+f*(b[1]-h),a[2]=d+f*(b[2]-d),a},l.hermite=function(a,d,b,f,k,h){var g=h*h,e=g*(2*h-3)+1,c=g*(h-2)+h,l=g*(h-1);h=g*(3-2*h);return a[0]=d[0]*
e+b[0]*c+f[0]*l+k[0]*h,a[1]=d[1]*e+b[1]*c+f[1]*l+k[1]*h,a[2]=d[2]*e+b[2]*c+f[2]*l+k[2]*h,a},l.bezier=function(a,d,b,f,k,h){var g=1-h,e=g*g,c=h*h,l=e*g,e=3*h*e,g=3*c*g;h*=c;return a[0]=d[0]*l+b[0]*e+f[0]*g+k[0]*h,a[1]=d[1]*l+b[1]*e+f[1]*g+k[1]*h,a[2]=d[2]*l+b[2]*e+f[2]*g+k[2]*h,a},l.random=function(a,d){d=d||1;var b=2*h.RANDOM()*Math.PI,f=2*h.RANDOM()-1,k=Math.sqrt(1-f*f)*d;return a[0]=Math.cos(b)*k,a[1]=Math.sin(b)*k,a[2]=f*d,a},l.transformMat4=function(a,d,b){var f=d[0],k=d[1];d=d[2];var h=b[3]*
f+b[7]*k+b[11]*d+b[15];return h=h||1,a[0]=(b[0]*f+b[4]*k+b[8]*d+b[12])/h,a[1]=(b[1]*f+b[5]*k+b[9]*d+b[13])/h,a[2]=(b[2]*f+b[6]*k+b[10]*d+b[14])/h,a},l.transformMat3=function(a,d,b){var f=d[0],k=d[1];d=d[2];return a[0]=f*b[0]+k*b[3]+d*b[6],a[1]=f*b[1]+k*b[4]+d*b[7],a[2]=f*b[2]+k*b[5]+d*b[8],a},l.transformQuat=function(a,d,b){var f=d[0],k=d[1],h=d[2];d=b[0];var g=b[1],e=b[2];b=b[3];var c=b*f+g*h-e*k,l=b*k+e*f-d*h,q=b*h+d*k-g*f,f=-d*f-g*k-e*h;return a[0]=c*b+f*-d+l*-e-q*-g,a[1]=l*b+f*-g+q*-d-c*-e,a[2]=
q*b+f*-e+c*-g-l*-d,a},l.rotateX=function(a,d,b,f){var k=[],h=[];return k[0]=d[0]-b[0],k[1]=d[1]-b[1],k[2]=d[2]-b[2],h[0]=k[0],h[1]=k[1]*Math.cos(f)-k[2]*Math.sin(f),h[2]=k[1]*Math.sin(f)+k[2]*Math.cos(f),a[0]=h[0]+b[0],a[1]=h[1]+b[1],a[2]=h[2]+b[2],a},l.rotateY=function(a,d,b,f){var k=[],h=[];return k[0]=d[0]-b[0],k[1]=d[1]-b[1],k[2]=d[2]-b[2],h[0]=k[2]*Math.sin(f)+k[0]*Math.cos(f),h[1]=k[1],h[2]=k[2]*Math.cos(f)-k[0]*Math.sin(f),a[0]=h[0]+b[0],a[1]=h[1]+b[1],a[2]=h[2]+b[2],a},l.rotateZ=function(a,
d,b,f){var k=[],h=[];return k[0]=d[0]-b[0],k[1]=d[1]-b[1],k[2]=d[2]-b[2],h[0]=k[0]*Math.cos(f)-k[1]*Math.sin(f),h[1]=k[0]*Math.sin(f)+k[1]*Math.cos(f),h[2]=k[2],a[0]=h[0]+b[0],a[1]=h[1]+b[1],a[2]=h[2]+b[2],a},l.forEach=function(){var a=l.create();return function(d,b,f,k,h,g){b||(b=3);f||(f=0);for(k=k?Math.min(k*b+f,d.length):d.length;k>f;f+=b)a[0]=d[f],a[1]=d[f+1],a[2]=d[f+2],h(a,a,g),d[f]=a[0],d[f+1]=a[1],d[f+2]=a[2];return d}}(),l.angle=function(a,d){var b=l.fromValues(a[0],a[1],a[2]),f=l.fromValues(d[0],
d[1],d[2]);l.normalize(b,b);l.normalize(f,f);b=l.dot(b,f);return 1<b?0:Math.acos(b)},l.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"},l.exactEquals=function(a,d){return a[0]===d[0]&&a[1]===d[1]&&a[2]===d[2]},l.equals=function(a,d){var b=a[0],f=a[1],k=a[2],l=d[0],g=d[1],e=d[2];return Math.abs(b-l)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(l))&&Math.abs(f-g)<=h.EPSILON*Math.max(1,Math.abs(f),Math.abs(g))&&Math.abs(k-e)<=h.EPSILON*Math.max(1,Math.abs(k),Math.abs(e))},l})},"esri/layers/vectorTiles/core/libs/gl-matrix/common":function(){define([],
function(){var h={EPSILON:1E-6};h.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array;h.RANDOM=Math.random;h.ENABLE_SIMD=!1;h.SIMD_AVAILABLE=h.ARRAY_TYPE===Float32Array&&"SIMD"in this;h.USE_SIMD=h.ENABLE_SIMD&&h.SIMD_AVAILABLE;h.setMatrixArrayType=function(a){h.ARRAY_TYPE=a};var l=Math.PI/180;return h.toRadian=function(a){return a*l},h.equals=function(a,d){return Math.abs(a-d)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))},h})},"esri/layers/vectorTiles/core/libs/gl-matrix/mat4":function(){define(["./common"],
function(h){var l={scalar:{},SIMD:{}};return l.create=function(){var a=new h.ARRAY_TYPE(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},l.clone=function(a){var d=new h.ARRAY_TYPE(16);return d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],d[4]=a[4],d[5]=a[5],d[6]=a[6],d[7]=a[7],d[8]=a[8],d[9]=a[9],d[10]=a[10],d[11]=a[11],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15],d},l.copy=function(a,d){return a[0]=d[0],a[1]=d[1],a[2]=
d[2],a[3]=d[3],a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],a[9]=d[9],a[10]=d[10],a[11]=d[11],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15],a},l.fromValues=function(a,d,b,f,k,l,g,e,c,n,q,r,u,v,t,w){var x=new h.ARRAY_TYPE(16);return x[0]=a,x[1]=d,x[2]=b,x[3]=f,x[4]=k,x[5]=l,x[6]=g,x[7]=e,x[8]=c,x[9]=n,x[10]=q,x[11]=r,x[12]=u,x[13]=v,x[14]=t,x[15]=w,x},l.set=function(a,d,b,f,k,h,g,e,c,l,q,r,u,v,t,w,x){return a[0]=d,a[1]=b,a[2]=f,a[3]=k,a[4]=h,a[5]=g,a[6]=e,a[7]=c,a[8]=l,a[9]=q,a[10]=r,a[11]=
u,a[12]=v,a[13]=t,a[14]=w,a[15]=x,a},l.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},l.scalar.transpose=function(a,d){if(a===d){var b=d[1],f=d[2],k=d[3],h=d[6],g=d[7],e=d[11];a[1]=d[4];a[2]=d[8];a[3]=d[12];a[4]=b;a[6]=d[9];a[7]=d[13];a[8]=f;a[9]=h;a[11]=d[14];a[12]=k;a[13]=g;a[14]=e}else a[0]=d[0],a[1]=d[4],a[2]=d[8],a[3]=d[12],a[4]=d[1],a[5]=d[5],a[6]=d[9],a[7]=d[13],a[8]=d[2],a[9]=d[6],a[10]=d[10],
a[11]=d[14],a[12]=d[3],a[13]=d[7],a[14]=d[11],a[15]=d[15];return a},l.SIMD.transpose=function(a,d){var b,f,k,h,g,e,c,l,q,r;return b=SIMD.Float32x4.load(d,0),f=SIMD.Float32x4.load(d,4),k=SIMD.Float32x4.load(d,8),h=SIMD.Float32x4.load(d,12),g=SIMD.Float32x4.shuffle(b,f,0,1,4,5),e=SIMD.Float32x4.shuffle(k,h,0,1,4,5),c=SIMD.Float32x4.shuffle(g,e,0,2,4,6),l=SIMD.Float32x4.shuffle(g,e,1,3,5,7),SIMD.Float32x4.store(a,0,c),SIMD.Float32x4.store(a,4,l),g=SIMD.Float32x4.shuffle(b,f,2,3,6,7),e=SIMD.Float32x4.shuffle(k,
h,2,3,6,7),q=SIMD.Float32x4.shuffle(g,e,0,2,4,6),r=SIMD.Float32x4.shuffle(g,e,1,3,5,7),SIMD.Float32x4.store(a,8,q),SIMD.Float32x4.store(a,12,r),a},l.transpose=h.USE_SIMD?l.SIMD.transpose:l.scalar.transpose,l.scalar.invert=function(a,d){var b=d[0],f=d[1],k=d[2],h=d[3],g=d[4],e=d[5],c=d[6],l=d[7],q=d[8],r=d[9],u=d[10],v=d[11],t=d[12],w=d[13],x=d[14],y=d[15],z=b*e-f*g,A=b*c-k*g,B=b*l-h*g,C=f*c-k*e,D=f*l-h*e,E=k*l-h*c,F=q*w-r*t,H=q*x-u*t,G=q*y-v*t,K=r*x-u*w,J=r*y-v*w,I=u*y-v*x,L=z*I-A*J+B*K+C*G-D*H+E*
F;return L?(L=1/L,a[0]=(e*I-c*J+l*K)*L,a[1]=(k*J-f*I-h*K)*L,a[2]=(w*E-x*D+y*C)*L,a[3]=(u*D-r*E-v*C)*L,a[4]=(c*G-g*I-l*H)*L,a[5]=(b*I-k*G+h*H)*L,a[6]=(x*B-t*E-y*A)*L,a[7]=(q*E-u*B+v*A)*L,a[8]=(g*J-e*G+l*F)*L,a[9]=(f*G-b*J-h*F)*L,a[10]=(t*D-w*B+y*z)*L,a[11]=(r*B-q*D-v*z)*L,a[12]=(e*H-g*K-c*F)*L,a[13]=(b*K-f*H+k*F)*L,a[14]=(w*A-t*C-x*z)*L,a[15]=(q*C-r*A+u*z)*L,a):null},l.SIMD.invert=function(a,d){var b,f,k,h,g,e,c,l,q,r,u=SIMD.Float32x4.load(d,0),v=SIMD.Float32x4.load(d,4),t=SIMD.Float32x4.load(d,8),
w=SIMD.Float32x4.load(d,12);return g=SIMD.Float32x4.shuffle(u,v,0,1,4,5),f=SIMD.Float32x4.shuffle(t,w,0,1,4,5),b=SIMD.Float32x4.shuffle(g,f,0,2,4,6),f=SIMD.Float32x4.shuffle(f,g,1,3,5,7),g=SIMD.Float32x4.shuffle(u,v,2,3,6,7),h=SIMD.Float32x4.shuffle(t,w,2,3,6,7),k=SIMD.Float32x4.shuffle(g,h,0,2,4,6),h=SIMD.Float32x4.shuffle(h,g,1,3,5,7),g=SIMD.Float32x4.mul(k,h),g=SIMD.Float32x4.swizzle(g,1,0,3,2),e=SIMD.Float32x4.mul(f,g),c=SIMD.Float32x4.mul(b,g),g=SIMD.Float32x4.swizzle(g,2,3,0,1),e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,
g),e),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,g),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),g=SIMD.Float32x4.mul(f,k),g=SIMD.Float32x4.swizzle(g,1,0,3,2),e=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,g),e),q=SIMD.Float32x4.mul(b,g),g=SIMD.Float32x4.swizzle(g,2,3,0,1),e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(h,g)),q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,g),q),q=SIMD.Float32x4.swizzle(q,2,3,0,1),g=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,3,0,1),h),g=SIMD.Float32x4.swizzle(g,1,0,3,2),k=SIMD.Float32x4.swizzle(k,
2,3,0,1),e=SIMD.Float32x4.add(SIMD.Float32x4.mul(k,g),e),l=SIMD.Float32x4.mul(b,g),g=SIMD.Float32x4.swizzle(g,2,3,0,1),e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(k,g)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,g),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),g=SIMD.Float32x4.mul(b,f),g=SIMD.Float32x4.swizzle(g,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,g),l),q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(k,g),q),g=SIMD.Float32x4.swizzle(g,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,g),l),q=SIMD.Float32x4.sub(q,
SIMD.Float32x4.mul(k,g)),g=SIMD.Float32x4.mul(b,h),g=SIMD.Float32x4.swizzle(g,1,0,3,2),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(k,g)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,g),l),g=SIMD.Float32x4.swizzle(g,2,3,0,1),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(k,g),c),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(f,g)),g=SIMD.Float32x4.mul(b,k),g=SIMD.Float32x4.swizzle(g,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,g),c),q=SIMD.Float32x4.sub(q,SIMD.Float32x4.mul(f,g)),g=SIMD.Float32x4.swizzle(g,2,
3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(h,g)),q=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,g),q),r=SIMD.Float32x4.mul(b,e),r=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(r,2,3,0,1),r),r=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(r,1,0,3,2),r),g=SIMD.Float32x4.reciprocalApproximation(r),r=SIMD.Float32x4.sub(SIMD.Float32x4.add(g,g),SIMD.Float32x4.mul(r,SIMD.Float32x4.mul(g,g))),(r=SIMD.Float32x4.swizzle(r,0,0,0,0))?(SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(r,e)),SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(r,
c)),SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(r,l)),SIMD.Float32x4.store(a,12,SIMD.Float32x4.mul(r,q)),a):null},l.invert=h.USE_SIMD?l.SIMD.invert:l.scalar.invert,l.scalar.adjoint=function(a,d){var b=d[0],f=d[1],k=d[2],h=d[3],g=d[4],e=d[5],c=d[6],l=d[7],q=d[8],r=d[9],u=d[10],v=d[11],t=d[12],w=d[13],x=d[14],y=d[15];return a[0]=e*(u*y-v*x)-r*(c*y-l*x)+w*(c*v-l*u),a[1]=-(f*(u*y-v*x)-r*(k*y-h*x)+w*(k*v-h*u)),a[2]=f*(c*y-l*x)-e*(k*y-h*x)+w*(k*l-h*c),a[3]=-(f*(c*v-l*u)-e*(k*v-h*u)+r*(k*l-h*c)),a[4]=-(g*
(u*y-v*x)-q*(c*y-l*x)+t*(c*v-l*u)),a[5]=b*(u*y-v*x)-q*(k*y-h*x)+t*(k*v-h*u),a[6]=-(b*(c*y-l*x)-g*(k*y-h*x)+t*(k*l-h*c)),a[7]=b*(c*v-l*u)-g*(k*v-h*u)+q*(k*l-h*c),a[8]=g*(r*y-v*w)-q*(e*y-l*w)+t*(e*v-l*r),a[9]=-(b*(r*y-v*w)-q*(f*y-h*w)+t*(f*v-h*r)),a[10]=b*(e*y-l*w)-g*(f*y-h*w)+t*(f*l-h*e),a[11]=-(b*(e*v-l*r)-g*(f*v-h*r)+q*(f*l-h*e)),a[12]=-(g*(r*x-u*w)-q*(e*x-c*w)+t*(e*u-c*r)),a[13]=b*(r*x-u*w)-q*(f*x-k*w)+t*(f*u-k*r),a[14]=-(b*(e*x-c*w)-g*(f*x-k*w)+t*(f*c-k*e)),a[15]=b*(e*u-c*r)-g*(f*u-k*r)+q*(f*c-
k*e),a},l.SIMD.adjoint=function(a,d){var b,f,k,h,g,e,c,l,q,r,u,v,t;b=SIMD.Float32x4.load(d,0);f=SIMD.Float32x4.load(d,4);k=SIMD.Float32x4.load(d,8);h=SIMD.Float32x4.load(d,12);return q=SIMD.Float32x4.shuffle(b,f,0,1,4,5),e=SIMD.Float32x4.shuffle(k,h,0,1,4,5),g=SIMD.Float32x4.shuffle(q,e,0,2,4,6),e=SIMD.Float32x4.shuffle(e,q,1,3,5,7),q=SIMD.Float32x4.shuffle(b,f,2,3,6,7),l=SIMD.Float32x4.shuffle(k,h,2,3,6,7),c=SIMD.Float32x4.shuffle(q,l,0,2,4,6),l=SIMD.Float32x4.shuffle(l,q,1,3,5,7),q=SIMD.Float32x4.mul(c,
l),q=SIMD.Float32x4.swizzle(q,1,0,3,2),r=SIMD.Float32x4.mul(e,q),u=SIMD.Float32x4.mul(g,q),q=SIMD.Float32x4.swizzle(q,2,3,0,1),r=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,q),r),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,q),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),q=SIMD.Float32x4.mul(e,c),q=SIMD.Float32x4.swizzle(q,1,0,3,2),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,q),r),t=SIMD.Float32x4.mul(g,q),q=SIMD.Float32x4.swizzle(q,2,3,0,1),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(l,q)),t=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,
q),t),t=SIMD.Float32x4.swizzle(t,2,3,0,1),q=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,2,3,0,1),l),q=SIMD.Float32x4.swizzle(q,1,0,3,2),c=SIMD.Float32x4.swizzle(c,2,3,0,1),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,q),r),v=SIMD.Float32x4.mul(g,q),q=SIMD.Float32x4.swizzle(q,2,3,0,1),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(c,q)),v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,q),v),v=SIMD.Float32x4.swizzle(v,2,3,0,1),q=SIMD.Float32x4.mul(g,e),q=SIMD.Float32x4.swizzle(q,1,0,3,2),v=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,
q),v),t=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,q),t),q=SIMD.Float32x4.swizzle(q,2,3,0,1),v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,q),v),t=SIMD.Float32x4.sub(t,SIMD.Float32x4.mul(c,q)),q=SIMD.Float32x4.mul(g,l),q=SIMD.Float32x4.swizzle(q,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(c,q)),v=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,q),v),q=SIMD.Float32x4.swizzle(q,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,q),u),v=SIMD.Float32x4.sub(v,SIMD.Float32x4.mul(e,q)),q=SIMD.Float32x4.mul(g,c),
q=SIMD.Float32x4.swizzle(q,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,q),u),t=SIMD.Float32x4.sub(t,SIMD.Float32x4.mul(e,q)),q=SIMD.Float32x4.swizzle(q,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(l,q)),t=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,q),t),SIMD.Float32x4.store(a,0,r),SIMD.Float32x4.store(a,4,u),SIMD.Float32x4.store(a,8,v),SIMD.Float32x4.store(a,12,t),a},l.adjoint=h.USE_SIMD?l.SIMD.adjoint:l.scalar.adjoint,l.determinant=function(a){var d=a[0],b=a[1],f=a[2],k=a[3],h=a[4],g=a[5],
e=a[6],c=a[7],l=a[8],q=a[9],r=a[10],u=a[11],v=a[12],t=a[13],w=a[14];a=a[15];return(d*g-b*h)*(r*a-u*w)-(d*e-f*h)*(q*a-u*t)+(d*c-k*h)*(q*w-r*t)+(b*e-f*g)*(l*a-u*v)-(b*c-k*g)*(l*w-r*v)+(f*c-k*e)*(l*t-q*v)},l.SIMD.multiply=function(a,d,b){var f=SIMD.Float32x4.load(d,0),k=SIMD.Float32x4.load(d,4),h=SIMD.Float32x4.load(d,8);d=SIMD.Float32x4.load(d,12);var g=SIMD.Float32x4.load(b,0),g=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,0,0,0,0),f),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,
1,1,1,1),k),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,2,2,2,2),h),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,3,3,3,3),d))));SIMD.Float32x4.store(a,0,g);g=SIMD.Float32x4.load(b,4);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,0,0,0,0),f),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,1,1,1,1),k),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,2,2,2,2),h),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,3,3,3,3),d))));SIMD.Float32x4.store(a,
4,g);g=SIMD.Float32x4.load(b,8);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,0,0,0,0),f),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,1,1,1,1),k),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,2,2,2,2),h),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,3,3,3,3),d))));SIMD.Float32x4.store(a,8,g);b=SIMD.Float32x4.load(b,12);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,0,0,0,0),f),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,
1,1,1,1),k),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,2,2,2,2),h),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,3,3,3,3),d))));return SIMD.Float32x4.store(a,12,f),a},l.scalar.multiply=function(a,d,b){var f=d[0],k=d[1],h=d[2],g=d[3],e=d[4],c=d[5],l=d[6],q=d[7],r=d[8],u=d[9],v=d[10],t=d[11],w=d[12],x=d[13],y=d[14];d=d[15];var z=b[0],A=b[1],B=b[2],C=b[3];return a[0]=z*f+A*e+B*r+C*w,a[1]=z*k+A*c+B*u+C*x,a[2]=z*h+A*l+B*v+C*y,a[3]=z*g+A*q+B*t+C*d,z=b[4],A=b[5],B=b[6],C=b[7],a[4]=z*f+
A*e+B*r+C*w,a[5]=z*k+A*c+B*u+C*x,a[6]=z*h+A*l+B*v+C*y,a[7]=z*g+A*q+B*t+C*d,z=b[8],A=b[9],B=b[10],C=b[11],a[8]=z*f+A*e+B*r+C*w,a[9]=z*k+A*c+B*u+C*x,a[10]=z*h+A*l+B*v+C*y,a[11]=z*g+A*q+B*t+C*d,z=b[12],A=b[13],B=b[14],C=b[15],a[12]=z*f+A*e+B*r+C*w,a[13]=z*k+A*c+B*u+C*x,a[14]=z*h+A*l+B*v+C*y,a[15]=z*g+A*q+B*t+C*d,a},l.multiply=h.USE_SIMD?l.SIMD.multiply:l.scalar.multiply,l.mul=l.multiply,l.scalar.translate=function(a,d,b){var f,k,h,g,e,c,l,q,r,u,v,t,w=b[0],x=b[1];b=b[2];return d===a?(a[12]=d[0]*w+d[4]*
x+d[8]*b+d[12],a[13]=d[1]*w+d[5]*x+d[9]*b+d[13],a[14]=d[2]*w+d[6]*x+d[10]*b+d[14],a[15]=d[3]*w+d[7]*x+d[11]*b+d[15]):(f=d[0],k=d[1],h=d[2],g=d[3],e=d[4],c=d[5],l=d[6],q=d[7],r=d[8],u=d[9],v=d[10],t=d[11],a[0]=f,a[1]=k,a[2]=h,a[3]=g,a[4]=e,a[5]=c,a[6]=l,a[7]=q,a[8]=r,a[9]=u,a[10]=v,a[11]=t,a[12]=f*w+e*x+r*b+d[12],a[13]=k*w+c*x+u*b+d[13],a[14]=h*w+l*x+v*b+d[14],a[15]=g*w+q*x+t*b+d[15]),a},l.SIMD.translate=function(a,d,b){var f=SIMD.Float32x4.load(d,0),k=SIMD.Float32x4.load(d,4),h=SIMD.Float32x4.load(d,
8),g=SIMD.Float32x4.load(d,12);b=SIMD.Float32x4(b[0],b[1],b[2],0);d!==a&&(a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],a[9]=d[9],a[10]=d[10],a[11]=d[11]);f=SIMD.Float32x4.mul(f,SIMD.Float32x4.swizzle(b,0,0,0,0));k=SIMD.Float32x4.mul(k,SIMD.Float32x4.swizzle(b,1,1,1,1));h=SIMD.Float32x4.mul(h,SIMD.Float32x4.swizzle(b,2,2,2,2));d=SIMD.Float32x4.add(f,SIMD.Float32x4.add(k,SIMD.Float32x4.add(h,g)));return SIMD.Float32x4.store(a,12,d),a},l.translate=h.USE_SIMD?
l.SIMD.translate:l.scalar.translate,l.scalar.scale=function(a,d,b){var f=b[0],k=b[1];b=b[2];return a[0]=d[0]*f,a[1]=d[1]*f,a[2]=d[2]*f,a[3]=d[3]*f,a[4]=d[4]*k,a[5]=d[5]*k,a[6]=d[6]*k,a[7]=d[7]*k,a[8]=d[8]*b,a[9]=d[9]*b,a[10]=d[10]*b,a[11]=d[11]*b,a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15],a},l.SIMD.scale=function(a,d,b){var f,k,h;b=SIMD.Float32x4(b[0],b[1],b[2],0);return f=SIMD.Float32x4.load(d,0),SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(f,SIMD.Float32x4.swizzle(b,0,0,0,0))),k=SIMD.Float32x4.load(d,
4),SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(k,SIMD.Float32x4.swizzle(b,1,1,1,1))),h=SIMD.Float32x4.load(d,8),SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(h,SIMD.Float32x4.swizzle(b,2,2,2,2))),a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15],a},l.scale=h.USE_SIMD?l.SIMD.scale:l.scalar.scale,l.rotate=function(a,d,b,f){var k,l,g,e,c,n,q,r,u,v,t,w,x,y,z,A,B,C,D,E,F,H,G,K,J=f[0],I=f[1];f=f[2];var L=Math.sqrt(J*J+I*I+f*f);return Math.abs(L)<h.EPSILON?null:(L=1/L,J*=L,I*=L,f*=L,k=Math.sin(b),l=Math.cos(b),
g=1-l,e=d[0],c=d[1],n=d[2],q=d[3],r=d[4],u=d[5],v=d[6],t=d[7],w=d[8],x=d[9],y=d[10],z=d[11],A=J*J*g+l,B=I*J*g+f*k,C=f*J*g-I*k,D=J*I*g-f*k,E=I*I*g+l,F=f*I*g+J*k,H=J*f*g+I*k,G=I*f*g-J*k,K=f*f*g+l,a[0]=e*A+r*B+w*C,a[1]=c*A+u*B+x*C,a[2]=n*A+v*B+y*C,a[3]=q*A+t*B+z*C,a[4]=e*D+r*E+w*F,a[5]=c*D+u*E+x*F,a[6]=n*D+v*E+y*F,a[7]=q*D+t*E+z*F,a[8]=e*H+r*G+w*K,a[9]=c*H+u*G+x*K,a[10]=n*H+v*G+y*K,a[11]=q*H+t*G+z*K,d!==a&&(a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15]),a)},l.scalar.rotateX=function(a,d,b){var f=Math.sin(b);
b=Math.cos(b);var k=d[4],h=d[5],g=d[6],e=d[7],c=d[8],l=d[9],q=d[10],r=d[11];return d!==a&&(a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15]),a[4]=k*b+c*f,a[5]=h*b+l*f,a[6]=g*b+q*f,a[7]=e*b+r*f,a[8]=c*b-k*f,a[9]=l*b-h*f,a[10]=q*b-g*f,a[11]=r*b-e*f,a},l.SIMD.rotateX=function(a,d,b){var f=SIMD.Float32x4.splat(Math.sin(b));b=SIMD.Float32x4.splat(Math.cos(b));d!==a&&(a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15]);var k=SIMD.Float32x4.load(d,
4);d=SIMD.Float32x4.load(d,8);return SIMD.Float32x4.store(a,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(k,b),SIMD.Float32x4.mul(d,f))),SIMD.Float32x4.store(a,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,b),SIMD.Float32x4.mul(k,f))),a},l.rotateX=h.USE_SIMD?l.SIMD.rotateX:l.scalar.rotateX,l.scalar.rotateY=function(a,d,b){var f=Math.sin(b);b=Math.cos(b);var k=d[0],h=d[1],g=d[2],e=d[3],c=d[8],l=d[9],q=d[10],r=d[11];return d!==a&&(a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=
d[15]),a[0]=k*b-c*f,a[1]=h*b-l*f,a[2]=g*b-q*f,a[3]=e*b-r*f,a[8]=k*f+c*b,a[9]=h*f+l*b,a[10]=g*f+q*b,a[11]=e*f+r*b,a},l.SIMD.rotateY=function(a,d,b){var f=SIMD.Float32x4.splat(Math.sin(b));b=SIMD.Float32x4.splat(Math.cos(b));d!==a&&(a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15]);var k=SIMD.Float32x4.load(d,0);d=SIMD.Float32x4.load(d,8);return SIMD.Float32x4.store(a,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(k,b),SIMD.Float32x4.mul(d,f))),SIMD.Float32x4.store(a,
8,SIMD.Float32x4.add(SIMD.Float32x4.mul(k,f),SIMD.Float32x4.mul(d,b))),a},l.rotateY=h.USE_SIMD?l.SIMD.rotateY:l.scalar.rotateY,l.scalar.rotateZ=function(a,d,b){var f=Math.sin(b);b=Math.cos(b);var k=d[0],h=d[1],g=d[2],e=d[3],c=d[4],l=d[5],q=d[6],r=d[7];return d!==a&&(a[8]=d[8],a[9]=d[9],a[10]=d[10],a[11]=d[11],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15]),a[0]=k*b+c*f,a[1]=h*b+l*f,a[2]=g*b+q*f,a[3]=e*b+r*f,a[4]=c*b-k*f,a[5]=l*b-h*f,a[6]=q*b-g*f,a[7]=r*b-e*f,a},l.SIMD.rotateZ=function(a,d,b){var f=
SIMD.Float32x4.splat(Math.sin(b));b=SIMD.Float32x4.splat(Math.cos(b));d!==a&&(a[8]=d[8],a[9]=d[9],a[10]=d[10],a[11]=d[11],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15]);var k=SIMD.Float32x4.load(d,0);d=SIMD.Float32x4.load(d,4);return SIMD.Float32x4.store(a,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(k,b),SIMD.Float32x4.mul(d,f))),SIMD.Float32x4.store(a,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,b),SIMD.Float32x4.mul(k,f))),a},l.rotateZ=h.USE_SIMD?l.SIMD.rotateZ:l.scalar.rotateZ,l.fromTranslation=function(a,
d){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=d[0],a[13]=d[1],a[14]=d[2],a[15]=1,a},l.fromScaling=function(a,d){return a[0]=d[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=d[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=d[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},l.fromRotation=function(a,d,b){var f,k,l,g=b[0],e=b[1];b=b[2];var c=Math.sqrt(g*g+e*e+b*b);return Math.abs(c)<h.EPSILON?null:(c=1/c,g*=c,e*=c,b*=c,f=Math.sin(d),k=Math.cos(d),l=1-k,a[0]=g*g*l+k,a[1]=
e*g*l+b*f,a[2]=b*g*l-e*f,a[3]=0,a[4]=g*e*l-b*f,a[5]=e*e*l+k,a[6]=b*e*l+g*f,a[7]=0,a[8]=g*b*l+e*f,a[9]=e*b*l-g*f,a[10]=b*b*l+k,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)},l.fromXRotation=function(a,d){var b=Math.sin(d),f=Math.cos(d);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=b,a[7]=0,a[8]=0,a[9]=-b,a[10]=f,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},l.fromYRotation=function(a,d){var b=Math.sin(d),f=Math.cos(d);return a[0]=f,a[1]=0,a[2]=-b,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=b,a[9]=0,
a[10]=f,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},l.fromZRotation=function(a,d){var b=Math.sin(d),f=Math.cos(d);return a[0]=f,a[1]=b,a[2]=0,a[3]=0,a[4]=-b,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},l.fromRotationTranslation=function(a,d,b){var f=d[0],k=d[1],h=d[2],g=d[3],e=f+f,c=k+k,l=h+h;d=f*e;var q=f*c,f=f*l,r=k*c,k=k*l,h=h*l,e=g*e,c=g*c,g=g*l;return a[0]=1-(r+h),a[1]=q+g,a[2]=f-c,a[3]=0,a[4]=q-g,a[5]=1-(d+h),a[6]=k+e,a[7]=0,a[8]=f+c,a[9]=k-e,a[10]=1-
(d+r),a[11]=0,a[12]=b[0],a[13]=b[1],a[14]=b[2],a[15]=1,a},l.getTranslation=function(a,d){return a[0]=d[12],a[1]=d[13],a[2]=d[14],a},l.getRotation=function(a,d){var b=d[0]+d[5]+d[10],f=0;return 0<b?(f=2*Math.sqrt(b+1),a[3]=.25*f,a[0]=(d[6]-d[9])/f,a[1]=(d[8]-d[2])/f,a[2]=(d[1]-d[4])/f):d[0]>d[5]&d[0]>d[10]?(f=2*Math.sqrt(1+d[0]-d[5]-d[10]),a[3]=(d[6]-d[9])/f,a[0]=.25*f,a[1]=(d[1]+d[4])/f,a[2]=(d[8]+d[2])/f):d[5]>d[10]?(f=2*Math.sqrt(1+d[5]-d[0]-d[10]),a[3]=(d[8]-d[2])/f,a[0]=(d[1]+d[4])/f,a[1]=.25*
f,a[2]=(d[6]+d[9])/f):(f=2*Math.sqrt(1+d[10]-d[0]-d[5]),a[3]=(d[1]-d[4])/f,a[0]=(d[8]+d[2])/f,a[1]=(d[6]+d[9])/f,a[2]=.25*f),a},l.fromRotationTranslationScale=function(a,d,b,f){var k=d[0],h=d[1],g=d[2],e=d[3],c=k+k,l=h+h,q=g+g;d=k*c;var r=k*l,k=k*q,u=h*l,h=h*q,g=g*q,c=e*c,l=e*l,e=e*q,q=f[0],v=f[1];f=f[2];return a[0]=(1-(u+g))*q,a[1]=(r+e)*q,a[2]=(k-l)*q,a[3]=0,a[4]=(r-e)*v,a[5]=(1-(d+g))*v,a[6]=(h+c)*v,a[7]=0,a[8]=(k+l)*f,a[9]=(h-c)*f,a[10]=(1-(d+u))*f,a[11]=0,a[12]=b[0],a[13]=b[1],a[14]=b[2],a[15]=
1,a},l.fromRotationTranslationScaleOrigin=function(a,d,b,f,k){var h=d[0],g=d[1],e=d[2],c=d[3],l=h+h,q=g+g,r=e+e;d=h*l;var u=h*q,h=h*r,v=g*q,g=g*r,e=e*r,l=c*l,q=c*q,c=c*r,r=f[0],t=f[1];f=f[2];var w=k[0],x=k[1];k=k[2];return a[0]=(1-(v+e))*r,a[1]=(u+c)*r,a[2]=(h-q)*r,a[3]=0,a[4]=(u-c)*t,a[5]=(1-(d+e))*t,a[6]=(g+l)*t,a[7]=0,a[8]=(h+q)*f,a[9]=(g-l)*f,a[10]=(1-(d+v))*f,a[11]=0,a[12]=b[0]+w-(a[0]*w+a[4]*x+a[8]*k),a[13]=b[1]+x-(a[1]*w+a[5]*x+a[9]*k),a[14]=b[2]+k-(a[2]*w+a[6]*x+a[10]*k),a[15]=1,a},l.fromQuat=
function(a,d){var b=d[0],f=d[1],h=d[2],l=d[3],g=b+b,e=f+f,c=h+h,b=b*g,n=f*g,f=f*e,q=h*g,r=h*e,h=h*c,g=l*g,e=l*e,l=l*c;return a[0]=1-f-h,a[1]=n+l,a[2]=q-e,a[3]=0,a[4]=n-l,a[5]=1-b-h,a[6]=r+g,a[7]=0,a[8]=q+e,a[9]=r-g,a[10]=1-b-f,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},l.frustum=function(a,d,b,f,h,l,g){var e=1/(b-d),c=1/(h-f),n=1/(l-g);return a[0]=2*l*e,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*l*c,a[6]=0,a[7]=0,a[8]=(b+d)*e,a[9]=(h+f)*c,a[10]=(g+l)*n,a[11]=-1,a[12]=0,a[13]=0,a[14]=g*l*2*n,a[15]=0,a},l.perspective=
function(a,d,b,f,h){d=1/Math.tan(d/2);var l=1/(f-h);return a[0]=d/b,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=d,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(h+f)*l,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*h*f*l,a[15]=0,a},l.perspectiveFromFieldOfView=function(a,d,b,f){var h=Math.tan(d.upDegrees*Math.PI/180),l=Math.tan(d.downDegrees*Math.PI/180),g=Math.tan(d.leftDegrees*Math.PI/180);d=Math.tan(d.rightDegrees*Math.PI/180);var e=2/(g+d),c=2/(h+l);return a[0]=e,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=c,a[6]=0,a[7]=0,a[8]=-((g-d)*e*.5),
a[9]=(h-l)*c*.5,a[10]=f/(b-f),a[11]=-1,a[12]=0,a[13]=0,a[14]=f*b/(b-f),a[15]=0,a},l.ortho=function(a,d,b,f,h,l,g){var e=1/(d-b),c=1/(f-h),n=1/(l-g);return a[0]=-2*e,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*c,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*n,a[11]=0,a[12]=(d+b)*e,a[13]=(h+f)*c,a[14]=(g+l)*n,a[15]=1,a},l.lookAt=function(a,d,b,f){var k,m,g,e,c,n,q,r,u,v,t=d[0],w=d[1];d=d[2];var x=f[0],y=f[1];f=f[2];var z=b[0],A=b[1];b=b[2];return Math.abs(t-z)<h.EPSILON&&Math.abs(w-A)<h.EPSILON&&Math.abs(d-b)<h.EPSILON?
l.identity(a):(q=t-z,r=w-A,u=d-b,v=1/Math.sqrt(q*q+r*r+u*u),q*=v,r*=v,u*=v,k=y*u-f*r,m=f*q-x*u,g=x*r-y*q,v=Math.sqrt(k*k+m*m+g*g),v?(v=1/v,k*=v,m*=v,g*=v):(k=0,m=0,g=0),e=r*g-u*m,c=u*k-q*g,n=q*m-r*k,v=Math.sqrt(e*e+c*c+n*n),v?(v=1/v,e*=v,c*=v,n*=v):(e=0,c=0,n=0),a[0]=k,a[1]=e,a[2]=q,a[3]=0,a[4]=m,a[5]=c,a[6]=r,a[7]=0,a[8]=g,a[9]=n,a[10]=u,a[11]=0,a[12]=-(k*t+m*w+g*d),a[13]=-(e*t+c*w+n*d),a[14]=-(q*t+r*w+u*d),a[15]=1,a)},l.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+
", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"},l.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))},l.add=function(a,d,b){return a[0]=d[0]+b[0],a[1]=d[1]+b[1],a[2]=
d[2]+b[2],a[3]=d[3]+b[3],a[4]=d[4]+b[4],a[5]=d[5]+b[5],a[6]=d[6]+b[6],a[7]=d[7]+b[7],a[8]=d[8]+b[8],a[9]=d[9]+b[9],a[10]=d[10]+b[10],a[11]=d[11]+b[11],a[12]=d[12]+b[12],a[13]=d[13]+b[13],a[14]=d[14]+b[14],a[15]=d[15]+b[15],a},l.subtract=function(a,d,b){return a[0]=d[0]-b[0],a[1]=d[1]-b[1],a[2]=d[2]-b[2],a[3]=d[3]-b[3],a[4]=d[4]-b[4],a[5]=d[5]-b[5],a[6]=d[6]-b[6],a[7]=d[7]-b[7],a[8]=d[8]-b[8],a[9]=d[9]-b[9],a[10]=d[10]-b[10],a[11]=d[11]-b[11],a[12]=d[12]-b[12],a[13]=d[13]-b[13],a[14]=d[14]-b[14],a[15]=
d[15]-b[15],a},l.sub=l.subtract,l.multiplyScalar=function(a,d,b){return a[0]=d[0]*b,a[1]=d[1]*b,a[2]=d[2]*b,a[3]=d[3]*b,a[4]=d[4]*b,a[5]=d[5]*b,a[6]=d[6]*b,a[7]=d[7]*b,a[8]=d[8]*b,a[9]=d[9]*b,a[10]=d[10]*b,a[11]=d[11]*b,a[12]=d[12]*b,a[13]=d[13]*b,a[14]=d[14]*b,a[15]=d[15]*b,a},l.multiplyScalarAndAdd=function(a,d,b,f){return a[0]=d[0]+b[0]*f,a[1]=d[1]+b[1]*f,a[2]=d[2]+b[2]*f,a[3]=d[3]+b[3]*f,a[4]=d[4]+b[4]*f,a[5]=d[5]+b[5]*f,a[6]=d[6]+b[6]*f,a[7]=d[7]+b[7]*f,a[8]=d[8]+b[8]*f,a[9]=d[9]+b[9]*f,a[10]=
d[10]+b[10]*f,a[11]=d[11]+b[11]*f,a[12]=d[12]+b[12]*f,a[13]=d[13]+b[13]*f,a[14]=d[14]+b[14]*f,a[15]=d[15]+b[15]*f,a},l.exactEquals=function(a,d){return a[0]===d[0]&&a[1]===d[1]&&a[2]===d[2]&&a[3]===d[3]&&a[4]===d[4]&&a[5]===d[5]&&a[6]===d[6]&&a[7]===d[7]&&a[8]===d[8]&&a[9]===d[9]&&a[10]===d[10]&&a[11]===d[11]&&a[12]===d[12]&&a[13]===d[13]&&a[14]===d[14]&&a[15]===d[15]},l.equals=function(a,d){var b=a[0],f=a[1],k=a[2],l=a[3],g=a[4],e=a[5],c=a[6],n=a[7],q=a[8],r=a[9],u=a[10],v=a[11],t=a[12],w=a[13],
x=a[14],y=a[15],z=d[0],A=d[1],B=d[2],C=d[3],D=d[4],E=d[5],F=d[6],H=d[7],G=d[8],K=d[9],J=d[10],I=d[11],L=d[12],M=d[13],N=d[14],Q=d[15];return Math.abs(b-z)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(z))&&Math.abs(f-A)<=h.EPSILON*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(k-B)<=h.EPSILON*Math.max(1,Math.abs(k),Math.abs(B))&&Math.abs(l-C)<=h.EPSILON*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(g-D)<=h.EPSILON*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(e-E)<=h.EPSILON*Math.max(1,Math.abs(e),Math.abs(E))&&
Math.abs(c-F)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(n-H)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(H))&&Math.abs(q-G)<=h.EPSILON*Math.max(1,Math.abs(q),Math.abs(G))&&Math.abs(r-K)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(K))&&Math.abs(u-J)<=h.EPSILON*Math.max(1,Math.abs(u),Math.abs(J))&&Math.abs(v-I)<=h.EPSILON*Math.max(1,Math.abs(v),Math.abs(I))&&Math.abs(t-L)<=h.EPSILON*Math.max(1,Math.abs(t),Math.abs(L))&&Math.abs(w-M)<=h.EPSILON*Math.max(1,Math.abs(w),Math.abs(M))&&Math.abs(x-
N)<=h.EPSILON*Math.max(1,Math.abs(x),Math.abs(N))&&Math.abs(y-Q)<=h.EPSILON*Math.max(1,Math.abs(y),Math.abs(Q))},l})},"esri/layers/vectorTiles/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(h,l,a,d){var b;!function(a){a[a.BEFORE=0]="BEFORE";a[a.ATTACHING=1]="ATTACHING";a[a.DETACHING=2]="DETACHING";a[a.RENDERING=3]="RENDERING";a[a.AFTER=4]="AFTER";a[a.DONE=5]="DONE"}(b||(b={}));return function(d){function h(){d.apply(this,
arguments);this._childrenSet=new Set;this._childrenToAttach=[];this._childrenToDetach=[];this._renderPhase=b.DONE;this.children=[]}return a(h,d),Object.defineProperty(h.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0}),h.prototype.attach=function(a){return!0},h.prototype.detach=function(a){var b=this.children;a=this.prepareChildrenRenderParameters(a);for(var d=0,c=b.length;c>d;d++){var f=b[d];f.attached&&(this.detachChild(f,a),f.attached=!1,f.parent=
null)}},h.prototype.render=function(a){var d=this.prepareChildrenRenderParameters(a);this._renderPhase=b.BEFORE;this.beforeRenderChildren(a,d);this._renderPhase=b.ATTACHING;this.attachChildren(d)||this.requestRender();this._renderPhase=b.DETACHING;for(var e=this._childrenToDetach;0<e.length;){var c=e.shift();this.detachChild(c,d);c.attached=!1;c.parent=null}this._renderPhase=b.RENDERING;this.renderChildren(d);this._renderPhase=b.AFTER;this.afterRenderChildren(a,d);this._renderPhase=b.DONE},h.prototype.addChild=
function(a){return this.addChildAt(a,this.children.length)},h.prototype.addChildAt=function(a,d){if((void 0===d&&(d=this.numChildren),!a)||this.contains(a))return a;var e=a.parent;e&&e!==this&&e.removeChild(a);d>=this.numChildren?this.children.push(a):this.children.splice(d,0,a);this._childrenSet.add(a);e=this._childrenToDetach.indexOf(a);return-1<e&&this._childrenToDetach.splice(e,1),this._childrenToAttach.push(a),this._renderPhase>=b.RENDERING&&this.requestRender(),a},h.prototype.contains=function(a){return this._childrenSet.has(a)},
h.prototype.getChildIndex=function(a){return this.children.indexOf(a)},h.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]},h.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)},h.prototype.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.getChildIndex(a)):a},h.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet["delete"](a);
if(a.attached)this._childrenToDetach.push(a),this._renderPhase>=b.RENDERING&&this.requestRender();else{var d=this._childrenToAttach.indexOf(a);-1<d&&this._childrenToAttach.splice(d,1)}return a},h.prototype.requestChildRender=function(a){a&&a.parent===this&&this._renderPhase>=b.RENDERING&&this.requestRender()},h.prototype.setChildIndex=function(a,d){var e=this.getChildIndex(a);-1<e&&(this.children.splice(e,1),this.children.splice(d,0,a),this._renderPhase>=b.RENDERING&&this.requestRender())},h.prototype.sortChildren=
function(a){return this._renderPhase>b.RENDERING&&this.requestRender(),this.children.sort(a)},h.prototype.attachChildren=function(a){var b=this._childrenToAttach;if(0===b.length)return!0;for(var d=0===b.length;!d;)d=b.shift(),this.attachChild(d,a)&&(d.attached=!0,d.parent=this),d=0===b.length;return 0===b.length},h.prototype.renderChildren=function(a){for(var b=this.children,d=0,c=b.length;c>d;d++){var f=b[d];f.attached&&this.renderChild(f,a)}},h.prototype.beforeRenderChildren=function(a,b){},h.prototype.afterRenderChildren=
function(a,b){},h}(d)})},"esri/layers/vectorTiles/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper"],function(h,l,a){var d=0;return function(){function a(){this.attached=!1;this._opacity=1;this._visible=!0;Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-do-"+d++})}return Object.defineProperty(a.prototype,"opacity",{get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=
a,this.requestRender())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0}),a.prototype.requestRender=function(){this.parent&&this.parent.requestChildRender(this)},a.prototype.dispose=function(){},a}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/Renderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../GeometryUtils ./BackgroundRenderer ./LineRenderer ./FillRenderer ./SymbolRenderer ./TileInfoRenderer ./FadeRecorder".split(" "),
function(h,l,a,d,b,f,k,m,g,e){return function(){function c(a,c,d){void 0===d&&(d=!0);this._extrudeRotateVector=new Float32Array([0,0,1]);this._extrudeScaleVector=new Float32Array([1,1,1]);this._state={rotation:0,width:0,height:0};this._cachedRotation=this._cachedHeight=this._cachedWidth=0;this._pixelRatio=1;this._SpriteMosaic=a;this._glyphMosaic=c;this._ignoreSpeed=!d;this._backgroundRenderer=new b;this._lineRenderer=new f;this._fillRenderer=new k;this._symbolRenderer=new m;this._tileInfoRenderer=
new g;this._fadeRecorder=new e.FadeRecorder(300);this._extrudeMatrix=new Float32Array(16);this._extrudeNoRotationMatrix=new Float32Array(16);this._backgroundColor=new Float32Array([1,0,0,1])}return c.prototype.setStateParams=function(b,c,e){this._pixelRatio=c;this._fadeRecorder.recordLevel(e);this._state=b;(this._state.width!==this._cachedWidth||this._state.height!==this._cachedHeight||this._state.rotation!==this._cachedRotation)&&(this._extrudeScaleVector[0]=2/b.width,this._extrudeScaleVector[1]=
-2/b.height,a.identity(this._extrudeMatrix),a.rotate(this._extrudeMatrix,this._extrudeMatrix,-b.rotation*d.C_DEG_TO_RAD,this._extrudeRotateVector),a.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector),a.transpose(this._extrudeMatrix,this._extrudeMatrix),a.identity(this._extrudeNoRotationMatrix),a.scale(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix,this._extrudeScaleVector),a.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix),this._cachedWidth=
this._state.width,this._cachedHeight=this._state.height,this._cachedRotation=this._state.rotation)},c.prototype.drawClippingMasks=function(a,b){if(0!==b.length){a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setClearStencil(0);a.clear(a.gl.STENCIL_BUFFER_BIT);for(var c=0;c<b.length;c++){var d=b[c];d.attached&&d.visible&&(a.setStencilFunctionSeparate(1032,519,d.stencilData.reference,
d.stencilData.mask),a.setStencilWriteMask(d.stencilData.mask),this._backgroundRenderer.renderSolidColor(a,{u_matrix:d.tileTransform.transform,u_normalized_origin:d.tileTransform.displayCoord,u_coord_range:d.coordRange,u_depth:0,u_color:this._backgroundColor}))}a.setColorMask(!0,!0,!0,!0);a.setBlendingEnabled(!0);a.setStencilWriteMask(255)}},c.prototype.renderDebug=function(a,b){var c=b.key;this._backgroundColor.set([c.col%2,c.row%2,0===c.col%2&&0===c.row%2?1:0,.5]);this._backgroundRenderer.renderSolidColor(a,
{u_matrix:b.tileTransform.transform,u_normalized_origin:b.tileTransform.displayCoord,u_coord_range:b.coordRange,u_depth:0,u_color:this._backgroundColor})},c.prototype.renderBucket=function(a,b,c,d,e,f,g,h){switch(b.type){case 0:2!==e&&this._renderBackground(a,c,e,f,g,h);break;case 1:2!==e&&this._renderFill(a,b,c,e,f,g,h);break;case 2:1===e&&this._renderLine(a,b,c,f,g,h);break;case 3:2===e&&this._renderSymbol(a,b,c,d,f,g,h)}},c.prototype.renderTileInfo=function(a,b){this._tileInfoRenderer.render(a,
b)},c.prototype.needsRedraw=function(){return this._fadeRecorder.needsRedraw()},c.prototype._renderBackground=function(a,b,c,d,e,f){this._backgroundRenderer.render(a,b,c,d,e,this._SpriteMosaic,this._SpriteMosaic.pixelRatio,f)},c.prototype._renderLine=function(a,b,c,d,e,f){this._lineRenderer.render(a,b,c,this._state,d,e,this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio,f)},c.prototype._renderFill=function(a,b,c,d,e,f,g){this._fillRenderer.render(a,b,c,this._state.rotation,d,e,f,
this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio,g)},c.prototype._renderSymbol=function(a,b,c,d,e,f,g){var h=!0;d===e.key.level&&(h=!1);a.setStencilTestEnabled(h);this._symbolRenderer.render(a,b,c,this._state.rotation,this._fadeRecorder.getFadeValues(this._ignoreSpeed),e,f,this._SpriteMosaic,this._glyphMosaic,this._extrudeMatrix,this._extrudeNoRotationMatrix,this._SpriteMosaic.pixelRatio,g)},c}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/BackgroundRenderer":function(){define("require exports dojo/text!./shaders/background.vs.glsl dojo/text!./shaders/background.fs.glsl dojo/text!./shaders/patternFillShader.vs.glsl dojo/text!./shaders/patternFillShader.fs.glsl ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c){return function(){function h(){this._patternMatrix=k.create();this._color=m.create();this._initialized=!1}return h.prototype.renderSolidColor=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix4fv("u_transformMatrix",b.u_matrix);this._solidProgram.setUniform2fv("u_normalized_origin",b.u_normalized_origin);this._solidProgram.setUniform1f("u_coord_range",b.u_coord_range||
4096);this._solidProgram.setUniform1f("u_depth",b.u_depth||0);this._solidProgram.setUniform4fv("u_color",b.u_color||new Float32Array([1,0,0,1]));a.drawArrays(5,0,4);a.bindVAO()},h.prototype.render=function(a,b,c,d,e,f,g,h){this._initialized||this._initialize(a);var l=e.getPaintValue("background-color",b);h*=e.getPaintValue("background-opacity",b);var m=e.getPaintValue("background-pattern",b),n=void 0!==m,C=l[3]*h,D=n||1>C;if(!(D&&0===c||!D&&1===c)){if(n){a.bindVAO(this._patternVertexArrayObject);
a.bindProgram(this._patternProgram);c=f.getMosaicItemPosition(m,!0);if(!c)return;b=d.coordRange/512/Math.pow(2,Math.floor(b)-d.key.level)/g;k.identity(this._patternMatrix);g=1/(c.size[1]*b);this._patternMatrix[0]=1/(c.size[0]*b);this._patternMatrix[4]=g;f.bind(a,9729,0);this._patternProgram.setUniformMatrix4fv("u_transformMatrix",d.tileTransform.transform);this._patternProgram.setUniform2fv("u_normalized_origin",d.tileTransform.displayCoord);this._patternProgram.setUniform1f("u_depth",e.z);this._patternProgram.setUniformMatrix3fv("u_pattern_matrix",
this._patternMatrix);this._patternProgram.setUniform1f("u_opacity",h);this._patternProgram.setUniform2f("u_pattern_tl",c.tl[0],c.tl[1]);this._patternProgram.setUniform2f("u_pattern_br",c.br[0],c.br[1]);this._patternProgram.setUniform1i("u_texture",0)}else this._color[0]=C*l[0],this._color[1]=C*l[1],this._color[2]=C*l[2],this._color[3]=C,a.bindVAO(this._solidVertexArrayObject),a.bindProgram(this._solidProgram),this._solidProgram.setUniformMatrix4fv("u_transformMatrix",d.tileTransform.transform),this._solidProgram.setUniform2fv("u_normalized_origin",
d.tileTransform.displayCoord),this._solidProgram.setUniform1f("u_coord_range",d.coordRange),this._solidProgram.setUniform1f("u_depth",e.z||0),this._solidProgram.setUniform4fv("u_color",this._color);a.drawArrays(5,0,4);a.bindVAO()}},h.prototype._initialize=function(h){if(this._initialized)return!0;var k={a_pos:0},l=new g(h,a,d,k);if(!l)return!1;var m=new g(h,b,f,k);if(!m)return!1;var n={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},w=new Int8Array([0,0,1,0,
0,1,1,1]),x=c.createVertex(h,35044,w),x=new e(h,k,n,{geometry:x}),w=new Int16Array([0,0,4096,0,0,4096,4096,4096]),w=c.createVertex(h,35044,w);h=new e(h,k,{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:w});return this._solidProgram=l,this._patternProgram=m,this._vertexAttributes=n,this._solidVertexArrayObject=x,this._patternVertexArrayObject=h,this._initialized=!0,!0},h}()})},"esri/layers/vectorTiles/core/libs/gl-matrix/mat3":function(){define(["./common"],
function(h){var l={};return l.create=function(){var a=new h.ARRAY_TYPE(9);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},l.fromMat4=function(a,d){return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[4],a[4]=d[5],a[5]=d[6],a[6]=d[8],a[7]=d[9],a[8]=d[10],a},l.clone=function(a){var d=new h.ARRAY_TYPE(9);return d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],d[4]=a[4],d[5]=a[5],d[6]=a[6],d[7]=a[7],d[8]=a[8],d},l.copy=function(a,d){return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[4]=d[4],a[5]=
d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],a},l.fromValues=function(a,d,b,f,k,l,g,e,c){var n=new h.ARRAY_TYPE(9);return n[0]=a,n[1]=d,n[2]=b,n[3]=f,n[4]=k,n[5]=l,n[6]=g,n[7]=e,n[8]=c,n},l.set=function(a,d,b,f,h,l,g,e,c,n){return a[0]=d,a[1]=b,a[2]=f,a[3]=h,a[4]=l,a[5]=g,a[6]=e,a[7]=c,a[8]=n,a},l.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},l.transpose=function(a,d){if(a===d){var b=d[1],f=d[2],h=d[5];a[1]=d[3];a[2]=d[6];a[3]=b;a[5]=d[7];a[6]=f;a[7]=h}else a[0]=
d[0],a[1]=d[3],a[2]=d[6],a[3]=d[1],a[4]=d[4],a[5]=d[7],a[6]=d[2],a[7]=d[5],a[8]=d[8];return a},l.invert=function(a,d){var b=d[0],f=d[1],h=d[2],l=d[3],g=d[4],e=d[5],c=d[6],n=d[7],q=d[8],r=q*g-e*n,u=-q*l+e*c,v=n*l-g*c,t=b*r+f*u+h*v;return t?(t=1/t,a[0]=r*t,a[1]=(-q*f+h*n)*t,a[2]=(e*f-h*g)*t,a[3]=u*t,a[4]=(q*b-h*c)*t,a[5]=(-e*b+h*l)*t,a[6]=v*t,a[7]=(-n*b+f*c)*t,a[8]=(g*b-f*l)*t,a):null},l.adjoint=function(a,d){var b=d[0],f=d[1],h=d[2],l=d[3],g=d[4],e=d[5],c=d[6],n=d[7],q=d[8];return a[0]=g*q-e*n,a[1]=
h*n-f*q,a[2]=f*e-h*g,a[3]=e*c-l*q,a[4]=b*q-h*c,a[5]=h*l-b*e,a[6]=l*n-g*c,a[7]=f*c-b*n,a[8]=b*g-f*l,a},l.determinant=function(a){var d=a[3],b=a[4],f=a[5],h=a[6],l=a[7],g=a[8];return a[0]*(g*b-f*l)+a[1]*(-g*d+f*h)+a[2]*(l*d-b*h)},l.multiply=function(a,d,b){var f=d[0],h=d[1],l=d[2],g=d[3],e=d[4],c=d[5],n=d[6],q=d[7];d=d[8];var r=b[0],u=b[1],v=b[2],t=b[3],w=b[4],x=b[5],y=b[6],z=b[7];b=b[8];return a[0]=r*f+u*g+v*n,a[1]=r*h+u*e+v*q,a[2]=r*l+u*c+v*d,a[3]=t*f+w*g+x*n,a[4]=t*h+w*e+x*q,a[5]=t*l+w*c+x*d,a[6]=
y*f+z*g+b*n,a[7]=y*h+z*e+b*q,a[8]=y*l+z*c+b*d,a},l.mul=l.multiply,l.translate=function(a,d,b){var f=d[0],h=d[1],l=d[2],g=d[3],e=d[4],c=d[5],n=d[6],q=d[7];d=d[8];var r=b[0];b=b[1];return a[0]=f,a[1]=h,a[2]=l,a[3]=g,a[4]=e,a[5]=c,a[6]=r*f+b*g+n,a[7]=r*h+b*e+q,a[8]=r*l+b*c+d,a},l.rotate=function(a,d,b){var f=d[0],h=d[1],l=d[2],g=d[3],e=d[4],c=d[5],n=d[6],q=d[7];d=d[8];var r=Math.sin(b);b=Math.cos(b);return a[0]=b*f+r*g,a[1]=b*h+r*e,a[2]=b*l+r*c,a[3]=b*g-r*f,a[4]=b*e-r*h,a[5]=b*c-r*l,a[6]=n,a[7]=q,a[8]=
d,a},l.scale=function(a,d,b){var f=b[0];b=b[1];return a[0]=f*d[0],a[1]=f*d[1],a[2]=f*d[2],a[3]=b*d[3],a[4]=b*d[4],a[5]=b*d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],a},l.fromTranslation=function(a,d){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=d[0],a[7]=d[1],a[8]=1,a},l.fromRotation=function(a,d){var b=Math.sin(d),f=Math.cos(d);return a[0]=f,a[1]=b,a[2]=0,a[3]=-b,a[4]=f,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},l.fromScaling=function(a,d){return a[0]=d[0],a[1]=0,a[2]=0,a[3]=0,a[4]=d[1],a[5]=0,a[6]=0,a[7]=0,
a[8]=1,a},l.fromMat2d=function(a,d){return a[0]=d[0],a[1]=d[1],a[2]=0,a[3]=d[2],a[4]=d[3],a[5]=0,a[6]=d[4],a[7]=d[5],a[8]=1,a},l.fromQuat=function(a,d){var b=d[0],f=d[1],h=d[2],l=d[3],g=b+b,e=f+f,c=h+h,b=b*g,n=f*g,f=f*e,q=h*g,r=h*e,h=h*c,g=l*g,e=l*e,l=l*c;return a[0]=1-f-h,a[3]=n-l,a[6]=q+e,a[1]=n+l,a[4]=1-b-h,a[7]=r-g,a[2]=q-e,a[5]=r+g,a[8]=1-b-f,a},l.normalFromMat4=function(a,d){var b=d[0],f=d[1],h=d[2],l=d[3],g=d[4],e=d[5],c=d[6],n=d[7],q=d[8],r=d[9],u=d[10],v=d[11],t=d[12],w=d[13],x=d[14],y=d[15],
z=b*e-f*g,A=b*c-h*g,B=b*n-l*g,C=f*c-h*e,D=f*n-l*e,E=h*n-l*c,F=q*w-r*t,H=q*x-u*t,q=q*y-v*t,G=r*x-u*w,r=r*y-v*w,u=u*y-v*x;return(v=z*u-A*r+B*G+C*q-D*H+E*F)?(v=1/v,a[0]=(e*u-c*r+n*G)*v,a[1]=(c*q-g*u-n*H)*v,a[2]=(g*r-e*q+n*F)*v,a[3]=(h*r-f*u-l*G)*v,a[4]=(b*u-h*q+l*H)*v,a[5]=(f*q-b*r-l*F)*v,a[6]=(w*E-x*D+y*C)*v,a[7]=(x*B-t*E-y*A)*v,a[8]=(t*D-w*B+y*z)*v,a):null},l.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"},l.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))},l.add=function(a,d,b){return a[0]=d[0]+b[0],a[1]=d[1]+b[1],a[2]=d[2]+b[2],a[3]=d[3]+b[3],a[4]=d[4]+b[4],a[5]=d[5]+b[5],a[6]=d[6]+b[6],a[7]=d[7]+b[7],a[8]=d[8]+b[8],a},l.subtract=function(a,d,b){return a[0]=d[0]-b[0],a[1]=d[1]-b[1],a[2]=d[2]-b[2],a[3]=d[3]-b[3],a[4]=d[4]-b[4],a[5]=d[5]-b[5],a[6]=d[6]-b[6],a[7]=d[7]-b[7],a[8]=d[8]-b[8],a},l.sub=l.subtract,l.multiplyScalar=
function(a,d,b){return a[0]=d[0]*b,a[1]=d[1]*b,a[2]=d[2]*b,a[3]=d[3]*b,a[4]=d[4]*b,a[5]=d[5]*b,a[6]=d[6]*b,a[7]=d[7]*b,a[8]=d[8]*b,a},l.multiplyScalarAndAdd=function(a,d,b,f){return a[0]=d[0]+b[0]*f,a[1]=d[1]+b[1]*f,a[2]=d[2]+b[2]*f,a[3]=d[3]+b[3]*f,a[4]=d[4]+b[4]*f,a[5]=d[5]+b[5]*f,a[6]=d[6]+b[6]*f,a[7]=d[7]+b[7]*f,a[8]=d[8]+b[8]*f,a},l.exactEquals=function(a,d){return a[0]===d[0]&&a[1]===d[1]&&a[2]===d[2]&&a[3]===d[3]&&a[4]===d[4]&&a[5]===d[5]&&a[6]===d[6]&&a[7]===d[7]&&a[8]===d[8]},l.equals=function(a,
d){var b=a[0],f=a[1],k=a[2],l=a[3],g=a[4],e=a[5],c=a[6],n=a[7],q=a[8],r=d[0],u=d[1],v=d[2],t=d[3],w=d[4],x=d[5],y=a[6],z=d[7],A=d[8];return Math.abs(b-r)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(r))&&Math.abs(f-u)<=h.EPSILON*Math.max(1,Math.abs(f),Math.abs(u))&&Math.abs(k-v)<=h.EPSILON*Math.max(1,Math.abs(k),Math.abs(v))&&Math.abs(l-t)<=h.EPSILON*Math.max(1,Math.abs(l),Math.abs(t))&&Math.abs(g-w)<=h.EPSILON*Math.max(1,Math.abs(g),Math.abs(w))&&Math.abs(e-x)<=h.EPSILON*Math.max(1,Math.abs(e),Math.abs(x))&&
Math.abs(c-y)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(n-z)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(z))&&Math.abs(q-A)<=h.EPSILON*Math.max(1,Math.abs(q),Math.abs(A))},l})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec4":function(){define(["./common"],function(h){var l={};return l.create=function(){var a=new h.ARRAY_TYPE(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a},l.clone=function(a){var d=new h.ARRAY_TYPE(4);return d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],d},l.fromValues=function(a,
d,b,f){var k=new h.ARRAY_TYPE(4);return k[0]=a,k[1]=d,k[2]=b,k[3]=f,k},l.copy=function(a,d){return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a},l.set=function(a,d,b,f,h){return a[0]=d,a[1]=b,a[2]=f,a[3]=h,a},l.add=function(a,d,b){return a[0]=d[0]+b[0],a[1]=d[1]+b[1],a[2]=d[2]+b[2],a[3]=d[3]+b[3],a},l.subtract=function(a,d,b){return a[0]=d[0]-b[0],a[1]=d[1]-b[1],a[2]=d[2]-b[2],a[3]=d[3]-b[3],a},l.sub=l.subtract,l.multiply=function(a,d,b){return a[0]=d[0]*b[0],a[1]=d[1]*b[1],a[2]=d[2]*b[2],a[3]=d[3]*
b[3],a},l.mul=l.multiply,l.divide=function(a,d,b){return a[0]=d[0]/b[0],a[1]=d[1]/b[1],a[2]=d[2]/b[2],a[3]=d[3]/b[3],a},l.div=l.divide,l.ceil=function(a,d){return a[0]=Math.ceil(d[0]),a[1]=Math.ceil(d[1]),a[2]=Math.ceil(d[2]),a[3]=Math.ceil(d[3]),a},l.floor=function(a,d){return a[0]=Math.floor(d[0]),a[1]=Math.floor(d[1]),a[2]=Math.floor(d[2]),a[3]=Math.floor(d[3]),a},l.min=function(a,d,b){return a[0]=Math.min(d[0],b[0]),a[1]=Math.min(d[1],b[1]),a[2]=Math.min(d[2],b[2]),a[3]=Math.min(d[3],b[3]),a},
l.max=function(a,d,b){return a[0]=Math.max(d[0],b[0]),a[1]=Math.max(d[1],b[1]),a[2]=Math.max(d[2],b[2]),a[3]=Math.max(d[3],b[3]),a},l.round=function(a,d){return a[0]=Math.round(d[0]),a[1]=Math.round(d[1]),a[2]=Math.round(d[2]),a[3]=Math.round(d[3]),a},l.scale=function(a,d,b){return a[0]=d[0]*b,a[1]=d[1]*b,a[2]=d[2]*b,a[3]=d[3]*b,a},l.scaleAndAdd=function(a,d,b,f){return a[0]=d[0]+b[0]*f,a[1]=d[1]+b[1]*f,a[2]=d[2]+b[2]*f,a[3]=d[3]+b[3]*f,a},l.distance=function(a,d){var b=d[0]-a[0],f=d[1]-a[1],h=d[2]-
a[2],l=d[3]-a[3];return Math.sqrt(b*b+f*f+h*h+l*l)},l.dist=l.distance,l.squaredDistance=function(a,d){var b=d[0]-a[0],f=d[1]-a[1],h=d[2]-a[2],l=d[3]-a[3];return b*b+f*f+h*h+l*l},l.sqrDist=l.squaredDistance,l.length=function(a){var d=a[0],b=a[1],f=a[2];a=a[3];return Math.sqrt(d*d+b*b+f*f+a*a)},l.len=l.length,l.squaredLength=function(a){var d=a[0],b=a[1],f=a[2];a=a[3];return d*d+b*b+f*f+a*a},l.sqrLen=l.squaredLength,l.negate=function(a,d){return a[0]=-d[0],a[1]=-d[1],a[2]=-d[2],a[3]=-d[3],a},l.inverse=
function(a,d){return a[0]=1/d[0],a[1]=1/d[1],a[2]=1/d[2],a[3]=1/d[3],a},l.normalize=function(a,d){var b=d[0],f=d[1],h=d[2],l=d[3],g=b*b+f*f+h*h+l*l;return 0<g&&(g=1/Math.sqrt(g),a[0]=b*g,a[1]=f*g,a[2]=h*g,a[3]=l*g),a},l.dot=function(a,d){return a[0]*d[0]+a[1]*d[1]+a[2]*d[2]+a[3]*d[3]},l.lerp=function(a,d,b,f){var h=d[0],l=d[1],g=d[2];d=d[3];return a[0]=h+f*(b[0]-h),a[1]=l+f*(b[1]-l),a[2]=g+f*(b[2]-g),a[3]=d+f*(b[3]-d),a},l.random=function(a,d){return d=d||1,a[0]=h.RANDOM(),a[1]=h.RANDOM(),a[2]=h.RANDOM(),
a[3]=h.RANDOM(),l.normalize(a,a),l.scale(a,a,d),a},l.transformMat4=function(a,d,b){var f=d[0],h=d[1],l=d[2];d=d[3];return a[0]=b[0]*f+b[4]*h+b[8]*l+b[12]*d,a[1]=b[1]*f+b[5]*h+b[9]*l+b[13]*d,a[2]=b[2]*f+b[6]*h+b[10]*l+b[14]*d,a[3]=b[3]*f+b[7]*h+b[11]*l+b[15]*d,a},l.transformQuat=function(a,d,b){var f=d[0],h=d[1],l=d[2],g=b[0],e=b[1],c=b[2];b=b[3];var n=b*f+e*l-c*h,q=b*h+c*f-g*l,r=b*l+g*h-e*f,f=-g*f-e*h-c*l;return a[0]=n*b+f*-g+q*-c-r*-e,a[1]=q*b+f*-e+r*-g-n*-c,a[2]=r*b+f*-c+n*-e-q*-g,a[3]=d[3],a},
l.forEach=function(){var a=l.create();return function(d,b,f,h,l,g){b||(b=4);f||(f=0);for(h=h?Math.min(h*b+f,d.length):d.length;h>f;f+=b)a[0]=d[f],a[1]=d[f+1],a[2]=d[f+2],a[3]=d[f+3],l(a,a,g),d[f]=a[0],d[f+1]=a[1],d[f+2]=a[2],d[f+3]=a[3];return d}}(),l.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},l.exactEquals=function(a,d){return a[0]===d[0]&&a[1]===d[1]&&a[2]===d[2]&&a[3]===d[3]},l.equals=function(a,d){var b=a[0],f=a[1],k=a[2],l=a[3],g=d[0],e=d[1],c=d[2],n=d[3];return Math.abs(b-
g)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(g))&&Math.abs(f-e)<=h.EPSILON*Math.max(1,Math.abs(f),Math.abs(e))&&Math.abs(k-c)<=h.EPSILON*Math.max(1,Math.abs(k),Math.abs(c))&&Math.abs(l-n)<=h.EPSILON*Math.max(1,Math.abs(l),Math.abs(n))},l})},"esri/layers/vectorTiles/views/webgl/Program":function(){define(["require","exports","dojo/has"],function(h,l,a){var d=a("dojo-debug-messages");return function(){function a(d,h,l,g,e){this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=
!1;this._fShader=this._vShader=null;this._defines=void 0;this._nameToUniformLocation={};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};d||console.error("RenderingContext isn't initialized!");0===h.length&&console.error("Shaders source should not be empty!");this._context=d;this._vertexShaderSource=h;this._fragmentShaderSource=l;this._defines=e;this._id=a._nextId++;
this._locations=g}return Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){var a=this._context.gl;this._vShader&&(a.deleteShader(this._vShader),this._vShader=null);this._fShader&&(a.deleteShader(this._fShader),
this._fShader=null);this._glName&&(a.deleteProgram(this._glName),this._glName=null)},a.prototype.initialize=function(){if(!this._initialized){this._vShader=this._loadShader(35633);this._fShader=this._loadShader(35632);this._vShader&&this._fShader||console.error("Error loading shaders!");var a=this._context.gl,b=a.createProgram();a.attachShader(b,this._vShader);a.attachShader(b,this._fShader);for(var d in this._locations)a.bindAttribLocation(b,this._locations[d],d);a.linkProgram(b);a.getProgramParameter(b,
a.LINK_STATUS)||console.error("Could not initialize shader\nVALIDATE_STATUS: "+a.getProgramParameter(b,a.VALIDATE_STATUS)+", gl error ["+a.getError()+"]infoLog: "+a.getProgramInfoLog(b));this._glName=b;this._initialized=!0}},a.prototype.getUniformLocation=function(a){return this.initialize(),void 0===this._nameToUniformLocation[a]&&(this._nameToUniformLocation[a]=this._context.gl.getUniformLocation(this._glName,a)),this._nameToUniformLocation[a]},a.prototype.hasUniform=function(a){return null!==this.getUniformLocation(a)},
a.prototype.getAttribLocation=function(a){return this.initialize(),void 0===this._nameToAttribLocation[a]&&(this._nameToAttribLocation[a]=this._context.gl.getAttribLocation(this._glName,a)),this._nameToAttribLocation[a]},a.prototype.setUniform1i=function(a,b){var d=this._nameToUniform1[a];if(void 0===d||b!==d)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(a),b),this._nameToUniform1[a]=b},a.prototype.setUniform1f=function(a,b){var d=this._nameToUniform1[a];if(void 0===
d||b!==d)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(a),b),this._nameToUniform1[a]=b},a.prototype.setUniform1fv=function(d,h){var l=this._nameToUniform2[d];void 0!==l&&a._arraysEqual(h,l)||(this._context.bindProgram(this),this._context.gl.uniform1fv(this.getUniformLocation(d),h),void 0===l?this._nameToUniform2[d]=new Float32Array(h):l.set(h))},a.prototype.setUniform2f=function(a,b,d){var g=this._nameToUniform2[a];if(void 0===g||b!==g[0]||d!==g[1])this._context.bindProgram(this),
this._context.gl.uniform2f(this.getUniformLocation(a),b,d),void 0===g?this._nameToUniform2[a]=new Float32Array([b,d]):(g[0]=b,g[1]=d)},a.prototype.setUniform2fv=function(f,h){d&&0!==h.length%2&&console.error("Value array must have even number of elements!");var l=this._nameToUniform2[f];void 0!==l&&a._arraysEqual(h,l)||(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(f),h),void 0===l?this._nameToUniform2[f]=new Float32Array(h):l.set(h))},a.prototype.setUniform3f=
function(a,b,d,g){var e=this._nameToUniform3[a];if(void 0===e||b!==e[0]||d!==e[1]||g!==e[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(a),b,d,g),void 0===e?this._nameToUniform3[a]=new Float32Array([b,d,g]):(e[0]=b,e[1]=d,e[2]=g)},a.prototype.setUniform3fv=function(f,h){d&&0!==h.length%3&&console.error("Value array must contain sets of three values!");var l=this._nameToUniform3[f];void 0!==l&&a._arraysEqual(h,l)||(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(f),
h),void 0===l?this._nameToUniform3[f]=new Float32Array(h):l.set(h))},a.prototype.setUniform4f=function(a,b,d,g,e){var c=this._nameToUniform4[a];if(void 0===c||b!==c[0]||d!==c[1]||g!==c[2]||e!==c[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(a),b,d,g,e),void 0===c?this._nameToUniform4[a]=new Float32Array([b,d,g,e]):(c[0]=b,c[1]=d,c[2]=g,c[3]=e)},a.prototype.setUniform4fv=function(f,h){d&&0!==h.length%4&&console.error("Value array must contain sets of four values!");
var l=this._nameToUniform4[f];void 0!==l&&a._arraysEqual(h,l)||(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(f),h),void 0===l?this._nameToUniform4[f]=new Float32Array(h):l.set(h))},a.prototype.setUniformMatrix3fv=function(f,h,l){void 0===l&&(l=!1);d&&0!==h.length%9&&console.error("Matrix array must contain sets ot 9 elements!");var g=this._nameToUniformMatrix3[f];void 0!==g&&(9===g.length?a._matrix3Equal(g,h):a._arraysEqual(h,g))||(this._context.bindProgram(this),
this._context.gl.uniformMatrix3fv(this.getUniformLocation(f),l,h),void 0===g?this._nameToUniformMatrix3[f]=new Float32Array(h):g.set(h))},a.prototype.setUniformMatrix4fv=function(f,h,l){void 0===l&&(l=!1);d&&0!==h.length%16&&console.error("Matrix array must contain sets ot 16 elements!");var g=this._nameToUniformMatrix4[f];void 0!==g&&(16===g.length?a._matrix4Equal(g,h):a._arraysEqual(h,g))||(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(f),l,h),void 0===
g?this._nameToUniformMatrix4[f]=new Float32Array(h):g.set(h))},a._padToThree=function(a){var b=a.toString();return 1E3>a&&(b=("  "+a).slice(-3)),b},a.prototype._addLineNumbers=function(d){var h=2;return d.replace(/\n/g,function(){return"\n"+a._padToThree(h++)+":"})},a.prototype._loadShader=function(a){var b=35633===a?this._vertexShaderSource:this._fragmentShaderSource;if(void 0!==this._defines){var d="";if(Array.isArray(this._defines))for(var g=0,e=this._defines;g<e.length;g++)var c=e[g],d=d+("#define "+
c+"\n");else for(c in this._defines)d+="#define "+c+"\n";b=d+b}d=this._context.gl;a=d.createShader(a);return d.shaderSource(a,b),d.compileShader(a),d.getShaderParameter(a,d.COMPILE_STATUS)||(console.error(d.getShaderInfoLog(a)),console.error(this._addLineNumbers(b))),a},a._matrix4Equal=function(a,b){return d&&(16!==a.length||16!==b.length)&&console.error("Matrix object must contain 16 elements!"),a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&
a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]},a._matrix3Equal=function(a,b){return d&&(9!==a.length||9!==b.length)&&console.error("Matrix object must contain 16 elements!"),a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]},a._arraysEqual=function(a,b){if(a.length!==b.length)return!1;for(var d=0;d<a.length;++d)if(a[d]!==b[d])return!1;return!0},a._nextId=0,a}()})},
"esri/layers/vectorTiles/views/webgl/VertexArrayObject":function(){define(["require","exports"],function(h,l){return function(){function a(d,b,f,h,l){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=!1;this._context=d;this._layout=f;this._buffers=h;this._locations=b;l&&(this._indexBuffer=l);this._id=a._nextId++}return Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,
"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},
enumerable:!0,configurable:!0}),a.prototype.dispose=function(a){void 0===a&&(a=!0);var b=this._context.extensions.vao;b&&this._glName&&(b.deleteVertexArrayOES(this._glName),this._glName=null);if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),a){for(var f in this._buffers)this._buffers[f].dispose(),delete this._buffers[f];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}},a.prototype.initialize=function(){if(!this._initialized){var a=this._context.extensions.vao;
if(a){var b=a.createVertexArrayOES();a.bindVertexArrayOES(b);this._bindLayout();a.bindVertexArrayOES(null);this._glName=b}this._initialized=!0}},a.prototype.bind=function(){this.initialize();var a=this._context.extensions.vao;a?a.bindVertexArrayOES(this.glName):(this._context.bindVAO(null),this._bindLayout())},a.prototype._bindLayout=function(){var a=this._buffers,b=this._context.extensions.vao,f=this._layout,h=this._indexBuffer;a||console.error("Vertex buffer dictionary is empty!");var l,g,e=this._context.gl,
c=0,n;for(n in a)for((l=a[n])||console.error("Vertex buffer is uninitialized!"),(g=f[n])||console.error("Vertex element descriptor is empty!"),this._context.bindBuffer(l),c=0;c<g.length;++c){l=g[c];var q=this._locations[l.name];if(void 0===q&&console.error("There is no location for vertex attribute '"+l.name+" defined."),4>=l.count){if(e.enableVertexAttribArray(q),e.vertexAttribPointer(q,l.count,l.type,l.normalized,l.stride,l.offset),l.divisor&&0<l.divisor){var r=this._context.extensions.angleInstancedArrays;
r&&r.vertexAttribDivisorANGLE(q,l.divisor)}}else if(16===l.count&&5126===l.type)for(var u=0;4>u;u++)(e.enableVertexAttribArray(q+u),e.vertexAttribPointer(q+u,4,l.type,l.normalized,l.stride,l.offset+16*u),l.divisor&&0<l.divisor)&&(r=this._context.extensions.angleInstancedArrays)&&r.vertexAttribDivisorANGLE(q+u,l.divisor);else console.error("Unsupported vertex attribute element count: "+l.count)}h&&(b?e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,h.glName):this._context.bindBuffer(h))},a.prototype.unbind=function(){this.initialize();
var a=this._context.extensions.vao;a?a.bindVertexArrayOES(null):this._unbindLayout()},a.prototype._unbindLayout=function(){var a=this._buffers,b=this._layout,f=this._locations,h=this._context;a||console.error("Vertex buffer dictionary is empty!");var l,g,e,c=h.gl,n=0,q=0,r;for(r in a){(l=a[r])||console.error("Vertex buffer is uninitialized!");g=b[r];n=0;for(q=g.length;q>n;++n)e=g[n],c.disableVertexAttribArray(f[e.name]);h.unbindBuffer(l.bufferType)}(a=this._indexBuffer)&&h.unbindBuffer(a.bufferType)},
a._nextId=0,a}()})},"esri/layers/vectorTiles/views/webgl/BufferObject":function(){define(["require","exports"],function(h,l){return function(){function a(d,b,f,h){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=d;this._bufferType=b;this._usage=f;this._id=a._nextId++;this._glName=this._context.gl.createBuffer();h&&this.setData(h)}return a.createIndex=function(d,b,f){return new a(d,34963,b,f)},a.createVertex=function(d,b,f){return new a(d,
34962,b,f)},Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bufferType",{get:function(){return this._bufferType},
enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null)},a.prototype.setData=function(a){if(a){if("number"==typeof a)0>
a&&console.error("Buffer size cannot be negative!"),this._size=a;else{var b=a.byteLength;a instanceof Uint16Array&&(b/=2,this._indexType=5123);a instanceof Uint32Array&&(b/=4,this._indexType=5125);this._size=b}b=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,a,this._usage);this._context.bindVAO(b)}},a.prototype.setSubData=function(a,b,f,h){if(void 0===b&&(b=0),void 0===f&&(f=0),a){(0>b||b>=this._size)&&console.error("offset is out of range!");
var l=b,g=f,e=h,c=a.byteLength;a instanceof Uint16Array&&(c/=2,l*=2,g*=2,e*=2);a instanceof Uint32Array&&(c/=4,l*=4,g*=4,e*=2);void 0===h&&(h=c-1);f>=h&&console.error("end must be bigger than start!");b+f-h>this._size&&console.error("An attempt to write beyond the end of the buffer!");b=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferSubData(this._bufferType,l,(a instanceof ArrayBuffer?a:a.buffer).slice(g,e));this._context.bindVAO(b)}},
a._nextId=0,a}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/LineRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 ../../../core/libs/gl-matrix/vec2 dojo/text!./shaders/lineShader.vs.glsl dojo/text!./shaders/lineShader.fs.glsl dojo/text!./shaders/patternLineShader.vs.glsl dojo/text!./shaders/patternLineShader.fs.glsl dojo/text!./shaders/lineJoinShader.vs.glsl dojo/text!./shaders/lineJoinShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u){return function(){function h(){this._joinAttributeLocations={a_pos:0,a_vertexOffset:1};this._triangleAttributeLocations={a_pos:0,a_offset:1,a_accumulatedDistance:2};this._initialized=!1;this._viewProjMat=a.create();this._offsetVector=b.create();this._screenSize=f.create();this._color=d.create();this._dashArray=f.create()}return h.prototype.render=function(b,c,d,e,f,g,h,k,l,m){if(0!==c.triangleElementCount){this._initialized||this._initialize(b);var n=f.tileTransform.transform,
q=f.coordRange/512,r=g.getPaintValue("line-translate",d);if(0!==r[0]||0!==r[1]){a.copy(this._viewProjMat,f.tileTransform.transform);var n=r[0],r=r[1],v=0,J=0,J=(1<<f.key.level)/Math.pow(2,d)*q,v=e.rotation;if(1===g.getPaintValue("line-translate-anchor",d))var I=Math.sin(u.C_DEG_TO_RAD*-v),L=Math.cos(u.C_DEG_TO_RAD*-v),v=J*(n*L-r*I),J=J*(n*I+r*L);else v=J*n,J*=r;this._offsetVector[0]=v;this._offsetVector[1]=J;this._offsetVector[2]=0;a.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);
n=this._viewProjMat}I=g.getPaintValue("line-pattern",d);L=void 0!==I;v=1/l;r=g.getPaintValue("line-blur",d)+v;J=g.getPaintValue("line-width",d);v=.5*(J+v);m*=g.getPaintValue("line-opacity",d);var M=g.getPaintValue("line-color",d),N=M[3]*m;this._color[0]=N*M[0];this._color[1]=N*M[1];this._color[2]=N*M[2];this._color[3]=N;1<v&&0<c.joinCount&&!L&&(this._screenSize[0]=.5*e.width,this._screenSize[1]=.5*e.height,e=Math.ceil(2*v),M=v-.25,N=this._getJoinsVAO(b,f))&&(b.bindVAO(N),b.bindProgram(this._joinProgram),
N=1/(0<l?l:1),this._joinProgram.setUniformMatrix4fv("u_transformMatrix",n),this._joinProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),this._joinProgram.setUniform1f("u_depth",g.z),this._joinProgram.setUniform2fv("u_screen",this._screenSize),this._joinProgram.setUniform1f("u_size",e),this._joinProgram.setUniform4fv("u_color",this._color),this._joinProgram.setUniform1f("u_lineHalfWidth",M),this._joinProgram.setUniform1f("u_pixelRatio",l),this._joinProgram.setUniform1f("u_oneOverPixelRatio",
N),b.drawArrays(0,c.joinStart,c.joinCount),b.bindVAO());if(l=this._getTrianglesVAO(b,f))(b.bindVAO(l),L)?(d=h.getMosaicItemPosition(I,!0))&&(h.bind(b,9729,0),b.bindProgram(this._patternLineProgram),this._patternLineProgram.setUniformMatrix4fv("u_transformMatrix",n),this._patternLineProgram.setUniformMatrix4fv("u_extrudeMatrix",k),this._patternLineProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),this._patternLineProgram.setUniform1f("u_depth",g.z),this._patternLineProgram.setUniform1f("u_lineHalfWidth",
v),this._patternLineProgram.setUniform1f("u_blur",r),this._patternLineProgram.setUniform1f("u_opacity",m),this._patternLineProgram.setUniform2f("u_pattern_tl",d.tl[0],d.tl[1]),this._patternLineProgram.setUniform2f("u_pattern_br",d.br[0],d.br[1]),this._patternLineProgram.setUniform2f("u_spriteSize",q*d.size[0],d.size[1]),this._patternLineProgram.setUniform1i("u_texture",0)):(h=g.getPaintValue("line-dasharray",d),2>h.length&&(h=[1,-1]),q*=J,this._dashArray[0]=q*h[0],this._dashArray[1]=q*h[1],b.bindProgram(this._triangleslProgram),
this._triangleslProgram.setUniformMatrix4fv("u_transformMatrix",n),this._triangleslProgram.setUniformMatrix4fv("u_extrudeMatrix",k),this._triangleslProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),this._triangleslProgram.setUniform1f("u_depth",g.z),this._triangleslProgram.setUniform4fv("u_color",this._color),this._triangleslProgram.setUniform1f("u_lineHalfWidth",v),this._triangleslProgram.setUniform2fv("u_dasharray",this._dashArray),this._triangleslProgram.setUniform1f("u_blur",
r)),b.drawElements(4,c.triangleElementCount,5125,12*c.triangleElementStart),b.bindVAO()}},h.prototype._initialize=function(a){if(this._initialized)return!0;var b=new q(a,k,m,this._triangleAttributeLocations),d=new q(a,g,e,this._triangleAttributeLocations);a=new q(a,c,n,this._joinAttributeLocations);return this._triangleslProgram=b,this._patternLineProgram=d,this._trianglesVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,
type:5122,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:12,normalized:!1,divisor:0}]},this._joinProgram=a,this._joinVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},this._initialized=!0,!0},h.prototype._getTrianglesVAO=function(a,b){if(b.lineTrianglesVertexArrayObject)return b.lineTrianglesVertexArrayObject;var c=b.lineVertexBuffer,d=b.lineTrianglesIndexBuffer;return c&&d?(b.lineTrianglesVertexArrayObject=
new r(a,this._triangleAttributeLocations,this._trianglesVertexAttributes,{geometry:c},d),b.lineTrianglesVertexArrayObject):null},h.prototype._getJoinsVAO=function(a,b){if(b.lineJoinsVertexArrayObject)return b.lineJoinsVertexArrayObject;var c=b.lineJoinVertexBuffer;return c?(b.lineJoinsVertexArrayObject=new r(a,this._joinAttributeLocations,this._joinVertexAttributes,{geometry:c}),b.lineJoinsVertexArrayObject):null},h}()})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec2":function(){define(["./common"],
function(h){var l={};return l.create=function(){var a=new h.ARRAY_TYPE(2);return a[0]=0,a[1]=0,a},l.clone=function(a){var d=new h.ARRAY_TYPE(2);return d[0]=a[0],d[1]=a[1],d},l.fromValues=function(a,d){var b=new h.ARRAY_TYPE(2);return b[0]=a,b[1]=d,b},l.copy=function(a,d){return a[0]=d[0],a[1]=d[1],a},l.set=function(a,d,b){return a[0]=d,a[1]=b,a},l.add=function(a,d,b){return a[0]=d[0]+b[0],a[1]=d[1]+b[1],a},l.subtract=function(a,d,b){return a[0]=d[0]-b[0],a[1]=d[1]-b[1],a},l.sub=l.subtract,l.multiply=
function(a,d,b){return a[0]=d[0]*b[0],a[1]=d[1]*b[1],a},l.mul=l.multiply,l.divide=function(a,d,b){return a[0]=d[0]/b[0],a[1]=d[1]/b[1],a},l.div=l.divide,l.ceil=function(a,d){return a[0]=Math.ceil(d[0]),a[1]=Math.ceil(d[1]),a},l.floor=function(a,d){return a[0]=Math.floor(d[0]),a[1]=Math.floor(d[1]),a},l.min=function(a,d,b){return a[0]=Math.min(d[0],b[0]),a[1]=Math.min(d[1],b[1]),a},l.max=function(a,d,b){return a[0]=Math.max(d[0],b[0]),a[1]=Math.max(d[1],b[1]),a},l.round=function(a,d){return a[0]=Math.round(d[0]),
a[1]=Math.round(d[1]),a},l.scale=function(a,d,b){return a[0]=d[0]*b,a[1]=d[1]*b,a},l.scaleAndAdd=function(a,d,b,f){return a[0]=d[0]+b[0]*f,a[1]=d[1]+b[1]*f,a},l.distance=function(a,d){var b=d[0]-a[0],f=d[1]-a[1];return Math.sqrt(b*b+f*f)},l.dist=l.distance,l.squaredDistance=function(a,d){var b=d[0]-a[0],f=d[1]-a[1];return b*b+f*f},l.sqrDist=l.squaredDistance,l.length=function(a){var d=a[0];a=a[1];return Math.sqrt(d*d+a*a)},l.len=l.length,l.squaredLength=function(a){var d=a[0];a=a[1];return d*d+a*
a},l.sqrLen=l.squaredLength,l.negate=function(a,d){return a[0]=-d[0],a[1]=-d[1],a},l.inverse=function(a,d){return a[0]=1/d[0],a[1]=1/d[1],a},l.normalize=function(a,d){var b=d[0],f=d[1],b=b*b+f*f;return 0<b&&(b=1/Math.sqrt(b),a[0]=d[0]*b,a[1]=d[1]*b),a},l.dot=function(a,d){return a[0]*d[0]+a[1]*d[1]},l.cross=function(a,d,b){d=d[0]*b[1]-d[1]*b[0];return a[0]=a[1]=0,a[2]=d,a},l.lerp=function(a,d,b,f){var h=d[0];d=d[1];return a[0]=h+f*(b[0]-h),a[1]=d+f*(b[1]-d),a},l.random=function(a,d){d=d||1;var b=
2*h.RANDOM()*Math.PI;return a[0]=Math.cos(b)*d,a[1]=Math.sin(b)*d,a},l.transformMat2=function(a,d,b){var f=d[0];d=d[1];return a[0]=b[0]*f+b[2]*d,a[1]=b[1]*f+b[3]*d,a},l.transformMat2d=function(a,d,b){var f=d[0];d=d[1];return a[0]=b[0]*f+b[2]*d+b[4],a[1]=b[1]*f+b[3]*d+b[5],a},l.transformMat3=function(a,d,b){var f=d[0];d=d[1];return a[0]=b[0]*f+b[3]*d+b[6],a[1]=b[1]*f+b[4]*d+b[7],a},l.transformMat4=function(a,d,b){var f=d[0];d=d[1];return a[0]=b[0]*f+b[4]*d+b[12],a[1]=b[1]*f+b[5]*d+b[13],a},l.forEach=
function(){var a=l.create();return function(d,b,f,h,l,g){b||(b=2);f||(f=0);for(h=h?Math.min(h*b+f,d.length):d.length;h>f;f+=b)a[0]=d[f],a[1]=d[f+1],l(a,a,g),d[f]=a[0],d[f+1]=a[1];return d}}(),l.str=function(a){return"vec2("+a[0]+", "+a[1]+")"},l.exactEquals=function(a,d){return a[0]===d[0]&&a[1]===d[1]},l.equals=function(a,d){var b=a[0],f=a[1],k=d[0],l=d[1];return Math.abs(b-k)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(k))&&Math.abs(f-l)<=h.EPSILON*Math.max(1,Math.abs(f),Math.abs(l))},l})},"esri/layers/vectorTiles/views/vectorTiles/renderers/FillRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 dojo/text!./shaders/solidFillShader.vs.glsl dojo/text!./shaders/solidFillShader.fs.glsl dojo/text!./shaders/patternFillShader.vs.glsl dojo/text!./shaders/patternFillShader.fs.glsl dojo/text!./shaders/fillOutlineShader.vs.glsl dojo/text!./shaders/fillOutlineShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u){var v=1/65536;return function(){function h(){this._outlineAttributeLocations={a_pos:0,a_offset:1,a_xnormal:2};this._fillAttributeLocations={a_pos:0};this._initialized=!1;this._viewProjMat=a.create();this._offsetVector=f.create();this._patternMatrix=d.create();this._color=b.create();this._outlineColor=b.create()}return h.prototype.render=function(b,c,e,f,g,h,k,l,m,n,q){this._initialized||this._initialize(b);var r=k.getPaintValue("fill-pattern",e),t=void 0!==
r;if(!t||0!==g){var J=k.getPaintValue("fill-antialias",e)&&!t;q*=k.getPaintValue("fill-opacity",e);var I=k.getPaintValue("fill-color",e),L=!1;if(!t){var M=I[3]*q;1===M&&0===g&&(L=!0);1>M&&1===g&&(L=!0)}if(L||0!==g){var N=h.tileTransform.transform,M=h.coordRange/512,Q=k.getPaintValue("fill-translate",e);if(0!==Q[0]||0!==Q[1]){a.copy(this._viewProjMat,h.tileTransform.transform);var N=Q[0],Q=Q[1],O=0,T=0,M=(1<<h.key.level)/Math.pow(2,e)*M;1===k.getPaintValue("fill-translate-anchor",e)?(T=Math.sin(u.C_DEG_TO_RAD*
-f),f=Math.cos(u.C_DEG_TO_RAD*-f),O=M*(N*f-Q*T),T=M*(N*T+Q*f)):(O=M*N,T=M*Q);this._offsetVector[0]=O;this._offsetVector[1]=T;this._offsetVector[2]=0;a.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);N=this._viewProjMat}if(f=this._getTrianglesVAO(b,h))if(t?1===g&&(r=l.getMosaicItemPosition(r,!0))&&(M=h.coordRange/512/Math.pow(2,Math.round(e)-h.key.level)/n,d.identity(this._patternMatrix),t=1/(r.size[1]*M),this._patternMatrix[0]=1/(r.size[0]*M),this._patternMatrix[4]=t,b.bindVAO(f),
l.bind(b,9729,0),b.bindProgram(this._patternFillProgram),this._patternFillProgram.setUniformMatrix4fv("u_transformMatrix",N),this._patternFillProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._patternFillProgram.setUniform1f("u_depth",k.z),this._patternFillProgram.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix),this._patternFillProgram.setUniform1f("u_opacity",q),this._patternFillProgram.setUniform2f("u_pattern_tl",r.tl[0],r.tl[1]),this._patternFillProgram.setUniform2f("u_pattern_br",
r.br[0],r.br[1]),this._patternFillProgram.setUniform1i("u_texture",0),b.drawElements(4,c.triangleElementCount,5125,12*c.triangleElementStart),b.bindVAO()):L&&(M=I[3]*q,this._color[0]=M*I[0],this._color[1]=M*I[1],this._color[2]=M*I[2],this._color[3]=M,b.bindVAO(f),b.bindProgram(this._solidFillProgram),this._solidFillProgram.setUniformMatrix4fv("u_transformMatrix",N),this._solidFillProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._solidFillProgram.setUniform1f("u_depth",
k.z+v),this._solidFillProgram.setUniform4fv("u_color",this._color),b.drawElements(4,c.triangleElementCount,5125,12*c.triangleElementStart),b.bindVAO()),J&&0<c.outlineElementCount&&1===g){e=k.getPaintValue("fill-outline-color",e);if(0===e[3]){if(1!==this._color[3])return;e=I}n=.75/n;q*=e[3];this._outlineColor[0]=q*e[0];this._outlineColor[1]=q*e[1];this._outlineColor[2]=q*e[2];this._outlineColor[3]=q;if(q=this._getOutlineVAO(b,h))b.bindVAO(q),b.bindProgram(this._outlineProgram),this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",
N),this._outlineProgram.setUniformMatrix4fv("u_extrudeMatrix",m),this._outlineProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._outlineProgram.setUniform1f("u_depth",k.z),this._outlineProgram.setUniform1f("u_outline_width",n),this._outlineProgram.setUniform4fv("u_color",this._outlineColor),b.drawElements(4,c.outlineElementCount,5125,12*c.outlineElementStart),b.bindVAO()}}}},h.prototype._initialize=function(a){if(this._initialized)return!0;var b=new q(a,k,m,{a_pos:0});
if(!b)return!1;var d=new q(a,g,e,this._fillAttributeLocations);if(!d)return!1;a=new q(a,c,n,this._outlineAttributeLocations);return this._solidFillProgram=b,this._patternFillProgram=d,this._trianglesVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},this._outlineProgram=a,this._outlineVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,
divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]},this._initialized=!0,!0},h.prototype._getTrianglesVAO=function(a,b){if(b.polygonTrianglesVertexArrayObject)return b.polygonTrianglesVertexArrayObject;var c=b.polygonTrianglesVertexBuffer,d=b.polygonTrianglesIndexBuffer;return c&&d?(b.polygonTrianglesVertexArrayObject=new r(a,this._fillAttributeLocations,this._trianglesVertexAttributes,{geometry:c},d),b.polygonTrianglesVertexArrayObject):null},h.prototype._getOutlineVAO=
function(a,b){if(b.polygonOutlineVertexArrayObject)return b.polygonOutlineVertexArrayObject;var c=b.polygonOutlinesVertexBuffer,d=b.polygonOutlinesIndexBuffer;return c&&d?(b.polygonOutlineVertexArrayObject=new r(a,this._outlineAttributeLocations,this._outlineVertexAttributes,{geometry:c},d),b.polygonOutlineVertexArrayObject):null},h}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/SymbolRenderer":function(){define(["require","exports","./IconRenderer","./SDFRenderer"],function(h,l,a,d){return function(){function b(){this._iconRenderer=
new a;this._sdfRenderer=new d}return b.prototype.render=function(a,b,d,g,e,c,h,l,r,u,v,t,w){b.hasData()&&(0<b.marketElementCount&&(b.isSDF||this._iconRenderer.render(a,b,d,g,e,c,h,l,u,v,w)),0<b.textElementCount&&this._sdfRenderer.render(a,b,d,g,e,c,h,r,u,v,t,w))},b}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/IconRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec3 dojo/text!./shaders/iconShader.vs.glsl dojo/text!./shaders/iconShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(h,l,a,d,b,f,k,m,g){return function(){function e(){this._attributeLocations={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._spritesTextureSize=new Float32Array(2);this._initialized=!1;this._extrudeMat=a.create();this._scaleVec=d.create()}return e.prototype.render=function(b,d,e,f,h,k,l,m,x,y,z){this._initialized||this._initialize(b);z*=l.getPaintValue("icon-opacity",e);var A=l.getLayoutValue("icon-rotation-alignment",e);1===A&&(1!==l.getLayoutValue("symbol-placement",e)||l.hasLayoutProperty("icon-rotation-alignment")||
(A=0));var B=0===A,A=l.getLayoutValue("icon-keep-upright",e)&&B,C=l.getLayoutValue("icon-size",e);f=g.degToByte(f);this._spritesTextureSize[0]=m.width/4;this._spritesTextureSize[1]=m.height/4;B?a.copy(this._extrudeMat,x):a.copy(this._extrudeMat,y);1!==C&&(this._scaleVec[0]=C,this._scaleVec[1]=C,this._scaleVec[2]=1,a.scale(this._extrudeMat,this._extrudeMat,this._scaleVec));m.bind(b,9729,0);b.bindProgram(this._iconProgram);(m=this._getIconVAO(b,k))&&(b.bindVAO(m),this._iconProgram.setUniformMatrix4fv("u_transformMatrix",
k.tileTransform.transform),this._iconProgram.setUniformMatrix4fv("u_extrudeMatrix",this._extrudeMat),this._iconProgram.setUniform2fv("u_normalized_origin",k.tileTransform.displayCoord),this._iconProgram.setUniform1f("u_depth",l.z),this._iconProgram.setUniform2fv("u_mosaicSize",this._spritesTextureSize),this._iconProgram.setUniform1f("u_mapRotation",f),this._iconProgram.setUniform1f("u_keepUpright",A?1:0),this._iconProgram.setUniform1f("u_level",10*e),this._iconProgram.setUniform1f("u_fadeSpeed",10*
h.fadeSpeed),this._iconProgram.setUniform1f("u_minfadeLevel",10*h.minfadeLevel),this._iconProgram.setUniform1f("u_maxfadeLevel",10*h.maxfadeLevel),this._iconProgram.setUniform1f("u_fadeChange",10*(e+h.fadeChange)),this._iconProgram.setUniform1f("u_opacity",z),this._iconProgram.setUniform1i("u_texture",0),b.drawElements(4,d.marketElementCount,5125,12*d.markerElementStart),b.bindVAO())},e.prototype._initialize=function(a){return this._initialized?!0:(this._iconProgram=new k(a,b,f,this._attributeLocations),
this._iconVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]},this._initialized=!0,!0)},e.prototype._getIconVAO=function(a,b){if(b.iconVertexArrayObject)return b.iconVertexArrayObject;var d=b.iconVertexBuffer,
e=b.iconIndexBuffer;return d&&e?(b.iconVertexArrayObject=new m(a,this._attributeLocations,this._iconVertexAttributes,{geometry:d},e),b.iconVertexArrayObject):null},e}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/SDFRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 dojo/text!./shaders/sdfShader.vs.glsl dojo/text!./shaders/sdfShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(h,l,a,d,b,f,k,m,g,e){return function(){function c(){this._attributeLocations={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._initialized=!1;this._extrudeMat=a.create();this._haloColor=d.create();this._sdfColor=d.create();this._scaleVec=b.create()}return c.prototype.render=function(b,c,d,f,g,h,k,l,m,z,A,B){this._initialized||this._initialize(b);var C=k.getLayoutValue("text-size",d),D=C/24;f=e.degToByte(f);var E=k.getLayoutValue("text-rotation-alignment",d);1===E&&(1!==k.getLayoutValue("symbol-placement",
d)||k.hasLayoutProperty("text-rotation-alignment")||(E=0));var F=0===E,E=k.getLayoutValue("text-keep-upright",d)&&F;A=.1*24/C/A;B*=k.getPaintValue("text-opacity",d);this._glyphTextureSize||(this._glyphTextureSize=new Float32Array([l.width/4,l.height/4]));F?a.copy(this._extrudeMat,m):a.copy(this._extrudeMat,z);this._scaleVec[0]=D;this._scaleVec[1]=D;this._scaleVec[2]=1;a.scale(this._extrudeMat,this._extrudeMat,this._scaleVec);l.bind(b,9729,0);b.bindProgram(this._sdfProgram);if(l=this._getSDFVAO(b,
h))b.bindVAO(l),this._sdfProgram.setUniformMatrix4fv("u_transformMatrix",h.tileTransform.transform),this._sdfProgram.setUniformMatrix4fv("u_extrudeMatrix",this._extrudeMat),this._sdfProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._sdfProgram.setUniform1f("u_depth",k.z),this._sdfProgram.setUniform2fv("u_mosaicSize",this._glyphTextureSize),this._sdfProgram.setUniform1f("u_mapRotation",f),this._sdfProgram.setUniform1f("u_keepUpright",E?1:0),this._sdfProgram.setUniform1f("u_level",
10*d),this._sdfProgram.setUniform1f("u_fadeSpeed",10*g.fadeSpeed),this._sdfProgram.setUniform1f("u_minfadeLevel",10*g.minfadeLevel),this._sdfProgram.setUniform1f("u_maxfadeLevel",10*g.maxfadeLevel),this._sdfProgram.setUniform1f("u_fadeChange",10*(d+g.fadeChange)),this._sdfProgram.setUniform1f("u_opacity",B),this._sdfProgram.setUniform1i("u_texture",0),g=k.getPaintValue("text-halo-color",d),0<g[3]&&(h=g[3]*B,this._haloColor[0]=h*g[0],this._haloColor[1]=h*g[1],this._haloColor[2]=h*g[2],this._haloColor[3]=
h,g=A+k.getPaintValue("text-halo-blur",d)/D/8,D=.75-k.getPaintValue("text-halo-width",d)/D/8,this._sdfProgram.setUniform4fv("u_color",this._haloColor),this._sdfProgram.setUniform1f("u_edgeDistance",D),this._sdfProgram.setUniform1f("u_edgeWidth",g),b.drawElements(4,c.textElementCount,5125,12*c.textElementStart)),d=k.getPaintValue("text-color",d),0<d[3]&&(k=d[3]*B,this._sdfColor[0]=k*d[0],this._sdfColor[1]=k*d[1],this._sdfColor[2]=k*d[2],this._sdfColor[3]=k,this._sdfProgram.setUniform4fv("u_color",
this._sdfColor),this._sdfProgram.setUniform1f("u_edgeDistance",.75),this._sdfProgram.setUniform1f("u_edgeWidth",A),b.drawElements(4,c.textElementCount,5125,12*c.textElementStart),b.bindVAO())},c.prototype._initialize=function(a){return this._initialized?!0:(this._sdfProgram=new m(a,f,k,this._attributeLocations),this._sdfVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},
{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]},this._initialized=!0,!0)},c.prototype._getSDFVAO=function(a,b){if(b.textVertexArrayObject)return b.textVertexArrayObject;var c=b.textVertexBuffer,d=b.textIndexBuffer;return c&&d?(b.textVertexArrayObject=new g(a,this._attributeLocations,this._sdfVertexAttributes,{geometry:c},d),b.textVertexArrayObject):null},c}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/TileInfoRenderer":function(){define("require exports dojo/text!./shaders/background.vs.glsl dojo/text!./shaders/background.fs.glsl dojo/text!./shaders/tileInfo.vs.glsl dojo/text!./shaders/tileInfo.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject ../../webgl/Texture ../GeometryUtils".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c){return function(){function h(){this._initialized=!1;this._maxWidth=0;this._color=new Float32Array([1,0,0,1])}return h.prototype.render=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform);this._outlineProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord);this._outlineProgram.setUniform1f("u_coord_range",
b.coordRange);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.setLineWidth(2);a.drawArrays(3,0,4);a.bindVAO();var c=this._getTexture(a,b);c&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(c,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord),this._tileInfoProgram.setUniform1f("u_depth",
0),this._tileInfoProgram.setUniform1f("u_coord_ratio",b.coordRange/512),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",c.descriptor.width,c.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())},h.prototype._initialize=function(c){if(this._initialized)return!0;var e={a_pos:0},h=new k(c,a,d,e),l=new k(c,b,f,e),n={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},w=new Int8Array([0,0,1,0,1,1,0,1]),w=g.createVertex(c,
35044,w),w=new m(c,e,n,{geometry:w}),x=new Int8Array([0,0,1,0,0,1,1,1]),x=g.createVertex(c,35044,x);c=new m(c,e,n,{geometry:x});return this._outlineProgram=h,this._tileInfoProgram=l,this._vertexAttributes=n,this._outlineVertexArrayObject=w,this._tileInfoVertexArrayObject=c,this._initialized=!0,!0},h.prototype._getTexture=function(a,b){if(b.texture)return b.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width",
"256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var d=b.key.id,f=this._canvas.getContext("2d");f.font="24px sans-serif";f.textAlign="left";f.textBaseline="middle";var g=f.measureText(d),g=Math.pow(2,Math.ceil(c.log2(g.width+2)));g>this._maxWidth&&(this._maxWidth=g);return f.clearRect(0,0,this._maxWidth,32),f.fillStyle=b.key.level>b.refKey.level?"red":"blue",f.fillText(d,0,16),b.texture=new e(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},
this._canvas),b.texture},h}()})},"esri/layers/vectorTiles/views/webgl/Texture":function(){define(["require","exports"],function(h,l){return function(){function a(d,b,f){this._glName=this._context=null;this._id=-1;this._desc=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._context=d;this._desc={pixelFormat:b.pixelFormat,dataType:b.dataType,target:b.target?b.target:3553,samplingMode:b.samplingMode?b.samplingMode:9729,wrapMode:b.wrapMode?b.wrapMode:10497,maxAnisotropy:b.maxAnisotropy,flipped:void 0!==
b.flipped?b.flipped:!1,hasMipmap:void 0!==b.hasMipmap?b.hasMipmap:!1,level:void 0!==b.level?b.level:0,unpackAlignment:b.unpackAlignment?b.unpackAlignment:4,width:b.width,height:b.height};this._id=++a._nextId;this.setData(f)}return Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._desc},
enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this._context&&this._glName&&(this._context.gl.deleteTexture(this._glName),this._glName=null)},a.prototype.resize=function(a,b){var f=this._desc;f.width===a&&f.height===b||(f.width=a,f.height=b,this.setData(null))},a.prototype.setData=function(d){var b=this._context.gl;this._glName||(this._glName=b.createTexture());void 0===d&&(d=null);null===d&&(this._desc.width=this._desc.width||4,this._desc.height=this._desc.height||4);var f=this._context.getBoundTexture(0);
this._context.bindTexture(this,0);var h=this._desc;a._validateTexture(h);b.pixelStorei(b.UNPACK_ALIGNMENT,h.unpackAlignment);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,h.flipped?1:0);d instanceof ImageData||d instanceof HTMLImageElement||d instanceof HTMLCanvasElement||d instanceof HTMLVideoElement?(b.texImage2D(b.TEXTURE_2D,h.level,h.pixelFormat,h.pixelFormat,h.dataType,d),void 0===this._desc.width&&(this._desc.width=d.width),void 0===this._desc.height&&(this._desc.height=d.height)):((null==h.width||null==
h.height)&&console.error("Width and height must be specified!"),b.texImage2D(b.TEXTURE_2D,h.level,h.pixelFormat,h.width,h.height,0,h.pixelFormat,h.dataType,d));h.hasMipmap&&this.generateMipmap();a._applySamplingMode(b,this._desc);a._applyWrapMode(b,this._desc);a._applyAnisotropicFilteringParameters(this._context,this._desc);this._context.bindTexture(f,0)},a.prototype.updateData=function(a,b,f,h,l,g){g||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");
var e=this._context.gl,c=this._desc,n=this._context.getBoundTexture(0);this._context.bindTexture(this,0);(0>b||0>f||h>c.width||l>c.height||b+h>c.width||f+l>c.height)&&console.error("An attempt to update out of bounds of the texture!");g instanceof ImageData||g instanceof HTMLImageElement||g instanceof HTMLCanvasElement||g instanceof HTMLVideoElement?e.texSubImage2D(e.TEXTURE_2D,a,b,f,c.pixelFormat,c.dataType,g):e.texSubImage2D(e.TEXTURE_2D,a,b,f,h,l,c.pixelFormat,c.dataType,g);this._context.bindTexture(n,
0)},a.prototype.generateMipmap=function(){var d=this._desc;d.hasMipmap||(d.hasMipmap=!0,a._validateTexture(d));9729===d.samplingMode?(this._samplingModeDirty=!0,d.samplingMode=9985):9728===d.samplingMode&&(this._samplingModeDirty=!0,d.samplingMode=9984);d=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var b=this._context.gl;b.generateMipmap(b.TEXTURE_2D);this._context.bindTexture(d,0)},a.prototype.setSamplingMode=function(d){d!==this._desc.samplingMode&&(this._desc.samplingMode=
d,a._validateTexture(this._desc),this._samplingModeDirty=!0)},a.prototype.setWrapMode=function(d){d!==this._desc.wrapMode&&(this._desc.wrapMode=d,a._validateTexture(this._desc),this._wrapModeDirty=!0)},a.prototype.applyChanges=function(){var d=this._context.gl,b=this._desc;this._samplingModeDirty&&(a._applySamplingMode(d,b),this._samplingModeDirty=!1);this._wrapModeDirty&&(a._applyWrapMode(d,b),this._wrapModeDirty=!1)},a._isPowerOfTwo=function(a){return 0===(a&a-1)},a._validateTexture=function(d){(0>
d.width||0>d.height)&&console.error("Negative dimension parameters are not allowed!");a._isPowerOfTwo(d.width)&&a._isPowerOfTwo(d.height)||(33071!==d.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),d.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))},a._applySamplingMode=function(a,b){var f=b.samplingMode;9985===f||9987===f?f=9729:(9984===f||9986===f)&&(f=9728);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,f);a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_MIN_FILTER,b.samplingMode)},a._applyWrapMode=function(a,b){a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,b.wrapMode);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,b.wrapMode)},a._applyAnisotropicFilteringParameters=function(a,b){if(null!=b.maxAnisotropy){var f=a.extensions.textureFilterAnisotropic;if(f){var h=a.gl;h.texParameterf(h.TEXTURE_2D,f.TEXTURE_MAX_ANISOTROPY_EXT,b.maxAnisotropy)}}},a._nextId=0,a}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/FadeRecorder":function(){define(["require",
"exports","../../../core/now"],function(h,l,a){h=(function(){return function(a,b){this.level=a;this.now=b}}(),function(){return function(a,b,f,h){this.fadeSpeed=a;this.minfadeLevel=b;this.maxfadeLevel=f;this.fadeChange=h}}());l.FadeProperties=h;h=function(){function d(a){void 0===a&&(a=300);this._levelSnapshots=[];this._duration=a}return d.prototype.recordLevel=function(b){var d=a(),h=this._levelSnapshots;0===h.length&&(h.push({level:b,now:0}),h.push({level:b,now:0}));2!==h.length&&h[0].level===b||
h.push({level:b,now:d})},d.prototype.needsRedraw=function(){if(0===this._levelSnapshots.length)return!1;for(var a=this._duration,d=this._levelSnapshots,h=d.length,l=d[h-1],g=-1;h>g+1&&d[g+1].now+a<l.now;)g++;for(0>g&&(g=0);h>g;g++)if(d[g].level!==l.level)return!0;return!1},d.prototype.getFadeValues=function(b){void 0===b&&(b=!1);for(var d=this._duration,h=a(),l=this._levelSnapshots;3<l.length&&l[1].now+d<h;)l.shift();l[1].now+d<h&&(l[0].level=l[1].level);var g=l[0].level,e=l[l.length-1],c=e.level,
n=Math.min(g,c),g=Math.max(g,c),l=(e.level-l[1].level)/((e.now-l[1].now)/d),d=(h-e.now)/d*l;return b?{fadeSpeed:0,minfadeLevel:n,maxfadeLevel:g,fadeChange:0}:{fadeSpeed:l,minfadeLevel:n,maxfadeLevel:g,fadeChange:d}},d}();l.FadeRecorder=h})},"esri/layers/vectorTiles/core/now":function(){define(["require","exports","./global"],function(h,l,a){return function(){var d=a.performance||{};if(d.now)return function(){return d.now()};if(d.webkitNow)return function(){return d.webkitNow()};if(d.mozNow)return function(){return d.mozNow()};
if(d.msNow)return function(){return d.msNow()};if(d.oNow)return function(){return d.oNow()};var b;return b=d.timing&&d.timing.navigationStart?d.timing.navigationStart:Date.now(),function(){return Date.now()-b}}()})},"esri/layers/vectorTiles/core/global":function(){define(["require","exports"],function(h,l){return"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{}})},"esri/layers/vectorTiles/views/vectorTiles/StencilClipGenerator":function(){define(["require",
"exports","./GeometryUtils"],function(h,l,a){var d=function(){function a(b){this.children=[];this.stageTile=b}return a.prototype.tryAdd=function(d){if(a.isChildOf(d,this.stageTile.key)){for(var h=0,l=this.children;h<l.length;h++)if(a.isChildOf(d,l[h]))return;this.children.push(d)}},a.prototype.equals=function(a){if(this.stageTile.key.id!==a.stageTile.key.id||this.children.length!==a.children.length)return!1;for(var b=0;b<this.children.length;b++)if(this.children[b].id!==a.children[b].id)return!1;
return!0},a.isChildOf=function(a,b){if(a.level<=b.level)return!1;var d=a.level-b.level,g=a.col>>d;return a.row>>d===b.row&&g===b.col},a}();return function(){function b(){this._tileGroups=[];this._bitOffset=0}return b.prototype.update=function(b){if(this._tileGroups=[],this._bitOffset=0,0!==b.length){for(var h=[],l=b.length,g=0;l>g;g++)if(b[g].attached&&b[g].visible){for(var e=new d(b[g]),c=g+1;l>c;c++)e.tryAdd(b[c].key);e.children.sort(function(a,b){return a.level<b.level?-1:1});this._reuseExisting(e)||
h.push(e)}if(0<h.length){b=Math.ceil(a.log2(h.length+1));l=(1<<b)-1<<this._bitOffset;g=1;e=void 0;for(c=0;c<h.length;c++){var n=h[c],e=g++<<this._bitOffset;n.stageTile.stencilData.mask=l;n.stageTile.stencilData.reference=e}this._bitOffset+=b;this._tileGroups.push(h)}}},b.prototype._reuseExisting=function(a){for(var b=0,d=this._tileGroups;b<d.length;b++)for(var g=0,e=d[b];g<e.length;g++){var c=e[g];if(c.equals(a)&&c.stageTile.stencilData.mask===a.stageTile.stencilData.mask&&c.stageTile.stencilData.reference===
a.stageTile.stencilData.reference)return!0}return!1},b}()})},"esri/layers/vectorTiles/views/vectorTiles/TileHandler":function(){define("require exports module dojo/Deferred dojo/promise/all ../../core/workers ../../core/promiseUtils ../../core/requireUtils ../../request ../2d/layers/support/TileKey ./TileIndex ./SpriteMosaic ./SpriteSource ./GlyphMosaic ./GlyphSource ./VectorTileDisplayObject ./GeometryUtils".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t){return function(){function l(a,b,
c,d){void 0===d&&(d=!1);this.devicePixelRatio=c;this.allowUpdates=d;this._tileIndex=this._connection=this._glyphMosaic=this._spriteMosaic=null;this._ongoingRequests={};this._vectorTileLayer=a;this._requestUpdate=b}return l.prototype.destroy=function(){this.stop();this._vectorTileLayer=this._requestUpdate=null},Object.defineProperty(l.prototype,"spriteMosaic",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"glyphMosaic",{get:function(){return this._glyphMosaic},
enumerable:!0,configurable:!0}),l.prototype.start=function(){var c=this;this.stop();var e=this._vectorTileLayer.styleRepository,g=new q(e.sprite,this.devicePixelRatio);g.devicePixelRatio=devicePixelRatio;var k=g.load().then(function(){c._spriteMosaic=new n(1024,1024);c._spriteMosaic.setSpriteSource(g)}),l=new u(e.glyphs);this._glyphMosaic=new r(1024,1024,l);var t=this._fetchTileMap(this._vectorTileLayer.tileIndexUrl),v=f.open(this,m.getAbsMid("./WorkerTileHandler",h,a)).then(function(a){c._connection=
a}),w=new d(function(a){k.isFulfilled()||k.cancel();t.isFulfilled()||t.cancel();v.isFulfilled()||v.cancel()});return b([k,t,v]).then(function(a){b(c._connection.broadcast("setLayers",e.styleJSON)).then(function(){w.resolve()})}),this._broadcastPromise=w.promise,this._broadcastPromise},l.prototype.stop=function(){this._broadcastPromise&&!this._broadcastPromise.isFulfilled()&&this._broadcastPromise.cancel();this._connection&&(this._connection.close(),this._connection=null)},l.prototype.updateTile=function(a,
b){if(this.allowUpdates){if(!this._broadcastPromise.isFulfilled()||!this._connection)return k.reject(Error("no connection"));var c=Math.round(t.degToByte(b.state.rotation));return a.rotation===c?null:(a.rotation=c,this._connection.invoke("update",{key:a.id,rotation:c},[],{id:a.workerID}).then(function(b){return a.updateSymbolData(b),a}))}},l.prototype.getVectorTileWithLRC=function(a,b,c,d){return void 0===d&&(d=0),this.getVectorTile(e.from(a,b,c,0),{state:{rotation:d}})},l.prototype.getVectorTile=
function(a,b){var c=this;if(!this._broadcastPromise.isFulfilled()||!this._connection)return k.reject(Error("no connection"));var d=this._vectorTileLayer.tileInfo,e=Math.round(b?b.state.rotation:0);if(d.lods.length<=a.level)return k.reject("Cannot create tile for the requested level");var f=this._tileIndex?this._tileIndex.dataKey(a):a;return f?this._getTileData(this._connection,a,f,e).then(function(b){if(!b||!b.tileData)return k.reject("No data");var g=d.size[0]*d.lods[a.level].resolution,h=d.origin,
l=h.x+a.col*g+a.world*c._vectorTileLayer.fullExtent.width,m=l+g,h=h.y-a.row*g,g=h-g;return c._requestUpdate(),new v(a,f,[l,h,m,g],c._vectorTileLayer.tileInfo.size[1],4096,e,b.tileData,c._vectorTileLayer.styleRepository,c._glyphMosaic,c.allowUpdates?b.workerId:-1,c._connection)}):k.reject(Error("no data"))},l.prototype.fetchTileData=function(a){a=e.fromId(a);a=this._vectorTileLayer.getTileUrl(a.level,a.row,a.col);return g(a,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){return{data:{protobuff:a.data},
buffers:[a.data]}})},l.prototype.getSprites=function(a){return k.resolve({data:{spriteItems:this._spriteMosaic.getSpriteItems(a.sprites)}})},l.prototype.getGlyphs=function(a){return this._glyphMosaic.getGlyphItems(a.tileID,a.font,a.codePoints).then(function(a){return{data:{glyphItems:a}}})},l.prototype.getStyleRepository=function(){return this._vectorTileLayer.styleRepository},l.prototype.getTileIndex=function(){return this._tileIndex},l.prototype._getTileData=function(a,b,c,d){var e=this,f={id:null};
return(a=this._ongoingRequests[b.id])?a:(a=this._connection.invoke("getTile",{key:b.id,refKey:c.id,rotation:d,cacheTile:this.allowUpdates},[],f).then(function(a){return delete e._ongoingRequests[b.id],{tileData:a,workerId:f.id}}).otherwise(function(a){return delete e._ongoingRequests[b.id],e.allowUpdates&&e._connection.invoke("destructTileData",{key:b.id},[],f),k.reject(a)}),this._ongoingRequests[b.id]=a,a)},l.prototype._fetchTileMap=function(a){var b=this;return a?g(a,{callbackParamName:"callback",
responseType:"json"}).then(function(a){b._tileIndex=new c(a.data)}):null},l}()})},"esri/layers/vectorTiles/core/workers":function(){define(["require","exports","./workers/workers"],function(h,l,a){for(var d in a)l.hasOwnProperty(d)||(l[d]=a[d])})},"esri/layers/vectorTiles/core/workers/workers":function(){define("require exports dojo/Deferred dojo/promise/all ../promiseUtils ./Connection ./JobProxy".split(" "),function(h,l,a,d,b,f,k){function m(a,b){for(var c=[],e=0,f=q.length;f>e;e++)c.push(q[e].openConnection(a,
b));return d(c).then(function(a){})}function g(a){if((r[a]=!0,!n)&&r.every(function(a){return a})){for(var b in w)(a=t[b])&&w[b].resolve(a);w={};n=!0}}function e(b){var c=v++;b=new f(b,c);var d=new a;return t[c]=b,n?d.resolve(b):w[c]=d,d.promise}var c=Math.max((navigator.hardwareConcurrency||2)-1,2),n=!1,q=[],r=[],u=0,v=0,t={},w={},x=!1;l.open=function(a,d){if(!1===x){for(var f=0;c>f;++f){var h=new k(t,f,g);q.push(h);r.push(!1)}x=!0}return e(a).then(function(a){return m(d,a.id).then(function(){return a}).otherwise(function(a){return b.reject(a)})})};
l.terminate=function(){for(var a=0,b=q.length;b>a;a++)q[a].terminate();q=[];r=[];n=!1};l.closeConnection=function(a){if(a)if(t[a.id]&&delete t[a.id],n)for(var b=0,c=q.length;c>b;b++)q[b].closeConnection(a.id);else(b=w[a.id])&&(b.promise.cancel(),delete w[a.id])};l.invoke=function(a,c,d,e,f){var g=null;if(e&&(g=e.id),null===g&&(g=u=(u+1)%q.length,!r[g]&&!q.some(function(a,b,c){return g=(g+1)%c.length,r[g]})))return b.reject(Error("No worker available"));a=q[g].invoke(a,c,d,f);return e&&(e.id=g),a};
l.broadcast=function(a,b,c,d){for(var e=[],f=0,g=q.length;g>f;f++)r[f]&&e.push(q[f].invoke(a,b,c,d));return e}})},"esri/layers/vectorTiles/core/workers/Connection":function(){define(["require","exports","./workers"],function(h,l,a){return function(){function d(a,d){this.client=a;this.id=d}return d.prototype.invoke=function(b,d,h,l){return a.invoke(b,d,h,l,this.id)},d.prototype.broadcast=function(b,d,h){return a.broadcast(b,d,h,this.id)},d.prototype.close=function(){a.closeConnection(this)},d}()})},
"esri/layers/vectorTiles/core/workers/JobProxy":function(){define("require exports dojo/_base/kernel dojo/_base/lang dojo/_base/url dojo/Deferred ../../kernel ../../config ../../request ../Logger ../urlUtils ./WorkerFallbackImpl".split(" "),function(h,l,a,d,b,f,k,m,g,e,c,n){function q(){if(!x){var a=void 0;try{a=new Worker(v)}catch(c){u.warn("Failed to create Worker. Fallback to execute module in main thread",event),a=new n}return r(a)}if(!y){var a=new b(v),d=m.defaults?m.defaults.io.corsEnabledServers:
m.request.corsEnabledServers;-1===d.indexOf(a.host)&&d.push(a.host);y=g(v,{responseType:"text"})}return y.then(function(a){var b;try{b=new Worker(URL.createObjectURL(new Blob([a.data],{type:"text/javascript"})))}catch(c){u.warn("Failed to create Worker. Fallback to execute module in main thread",c),b=new n}return r(b)})}function r(b){function c(f){if(f&&f.data&&f.data.type)if(f=f.data.type,"\x3cworker-loaded\x3e"===f){f=b;var h;null!=m["default"]?(h=d.mixin({},m),delete h["default"],h=JSON.parse(JSON.stringify(h))):
h=JSON.parse(JSON.stringify(m));f.postMessage({type:"\x3cconfigure\x3e",configure:{esriConfig:h,dojoConfig:{async:!0,baseUrl:w,locale:a.locale,has:{"esri-cors":1,"dojo-test-sniff":0,"config-deferredInstrumentation":0},paths:{esri:"esri",dojo:"dojo",dojox:"dojox",dstore:"dstore",moment:"moment"}},loaderUrl:t}})}else"\x3cworker-configured\x3e"===f&&(b.removeEventListener("message",c),b.removeEventListener("error",e),g.resolve(b))}function e(a){a.preventDefault();b.removeEventListener("message",c);b.removeEventListener("error",
e);u.warn("Failed to create Worker. Fallback to execute module in main thread",a);b=new n;b.addEventListener("message",c);b.addEventListener("error",e)}var g=new f;return b.addEventListener("message",c),b.addEventListener("error",e),g.promise}var u=e.getLogger("esri.core.workers"),v=c.makeAbsolute(h.toUrl("./worker.js")),t=c.makeAbsolute(h.toUrl("./worker-init.js")),w=c.makeAbsolute("../../../../../../",t)+"/",x=!c.hasSameOrigin(v,location.href),y=null;return function(){function a(b,c,d){var e=this;
this.connections=b;this.index=c;this.workerInitCallback=d;this.msgCount=0;this.outgoingJobs={};this.incomingJobs={};this.incomingStaticJobs={};q().then(function(a){e.worker=a;e.worker.addEventListener("message",e.message.bind(e));e.worker.addEventListener("error",function(a){a.preventDefault();u.error(a)});e.workerInitCallback(e.index)})}return a.prototype.terminate=function(){this.worker.terminate()},a.prototype.openConnection=function(a,b){return this.invoke("\x3copen-connection\x3e",{path:a},void 0,
b)},a.prototype.closeConnection=function(a){this.invoke("\x3cclose-connection\x3e",void 0,void 0,a)},a.prototype.invoke=function(a,b,c,d){var e=this,g=++this.msgCount,h=new f(function(a){e.worker.postMessage({type:"\x3ccancel\x3e",id:g,connection:d,data:{reason:a}});e.outgoingJobs[g]&&delete e.outgoingJobs[g]});return this.outgoingJobs[g]=h,this.worker.postMessage({type:a,id:g,connection:d,data:b},c),h.promise},a.prototype.message=function(a){var b=this;if(a&&a.data){var c=a.data.type;if(c){var d=
a.data,e=a.data.id;if("\x3cresponse\x3e"===c&&e){if(a=this.outgoingJobs[e])delete this.outgoingJobs[e],d.error?a.reject(d.error):a.resolve(d.data)}else if("\x3ccancel\x3e"===c&&e)a=this.incomingJobs[e],(a&&a.cancel(d.data.reason),d.staticMsg)&&(a=this.incomingStaticJobs[e])&&a.cancel(d.data.reason);else if("\x3cstatic-message\x3e"===c){var f=d.staticMsg;a=k.workerMessages[f];if(!a||"function"!=typeof a)return void this.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:f,id:e,error:a+" message type is not available on the kernel!"});
d=a.call(this,d.data);this.incomingStaticJobs[e]=d;d.then(function(a){b.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:f,id:e,data:a.data},a.buffers)}).otherwise(function(a){a||(a="Error encountered at method"+f);a.dojoType&&"cancel"===a.dojoType||b.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:f,id:e,error:a})}).always(function(){delete b.incomingStaticJobs[e]})}else{var g=d.connection;if(a=this.connections[g])if(a=a.client){var h=a[c];"function"==typeof h&&(d=h.call(a,
d.data),this.incomingJobs[e]=d,d.then(function(a){b.worker.postMessage({type:"\x3cresponse\x3e",id:e,connection:g,error:a.error,data:a.data},a.buffers)}).otherwise(function(a){a||(a="Error encountered at method"+c);a.dojoType&&"cancel"===a.dojoType||b.worker.postMessage({type:"\x3cresponse\x3e",id:e,connection:g,error:a})}).always(function(){delete b.incomingJobs[e]}))}}}}},a}()})},"esri/layers/vectorTiles/kernel":function(){define(["require","exports","esri/kernel","./identity/IdentityManager"],
function(h,l,a,d){return function(){function b(){}return Object.defineProperty(b,"id",{get:function(){return a.id?d:null},enumerable:!0,configurable:!0}),b.workerMessages={},b}()})},"esri/layers/vectorTiles/identity/IdentityManager":function(){define(["require","exports","esri/IdentityManager"],function(h,l,a){l.findCredential=function(d){return a.findCredential(d)}})},"esri/layers/vectorTiles/core/Logger":function(){define(["require","exports","dojo/has"],function(h,l,a){var d={info:0,warn:1,error:2};
h=function(){function a(d){void 0===d&&(d={});this.module=d.module||"";this.writer=d.writer||null;this.level=d.level||null;null!=d.enabled&&(this.enabled=!!d.enabled);a._loggers[this.module]=this;d=this.module.lastIndexOf(".");-1!==d&&(this.parent=a.getLogger(this.module.slice(0,d)))}return a.prototype.log=function(a){for(var b=[],d=1;d<arguments.length;d++)b[d-1]=arguments[d];this._isEnabled()&&this._matchLevel(a)&&(d=this._inheritedWriter())&&d.apply(void 0,[a,this.module].concat(b))},a.prototype.error=
function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];this.log.apply(this,["error"].concat(a))},a.prototype.warn=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];this.log.apply(this,["warn"].concat(a))},a.prototype.info=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];this.log.apply(this,["info"].concat(a))},a.prototype.getLogger=function(d){return a.getLogger(this.module+"."+d)},a.getLogger=function(d){var h=a._loggers[d];return h||(h=
new a({module:d})),h},a.prototype._parentWithMember=function(a,b){for(var d=this;d&&null==d[a];)d=d.parent;return d?d[a]:b},a.prototype._inheritedWriter=function(){return this._parentWithMember("writer",this._consoleWriter)},a.prototype._consoleWriter=function(a,b){for(var d=[],g=2;g<arguments.length;g++)d[g-2]=arguments[g];console[a].apply(console,["["+b+"]"].concat(d))},a.prototype._matchLevel=function(a){return d[this._parentWithMember("level","error")]<=d[a]},a.prototype._isEnabled=function(){return this._parentWithMember("enabled",
!0)},a._loggers={},a}();l=h.getLogger("esri");return a("dojo-debug-messages")?l.level="info":l.level="warn",h})},"esri/layers/vectorTiles/core/workers/WorkerFallbackImpl":function(){define(["require","exports"],function(h,l){var a=function(){return this}(),d=function(){return function(){var a=this,b=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(function(d){a[d]=function(){for(var a=[],c=0;c<arguments.length;c++)a[c-0]=arguments[c];return b[d].apply(b,
a)}})}}(),b=a.MutationObserver||a.WebKitMutationObserver,f=function(){var d;if(a.process&&a.process.nextTick)d=function(b){a.process.nextTick(b)};else if(a.Promise)d=function(b){a.Promise.resolve().then(b)};else if(b){var f=[],g=document.createElement("div");(new b(function(){for(;0<f.length;)f.shift()()})).observe(g,{attributes:!0});d=function(a){f.push(a);g.setAttribute("queueStatus","1")}}return d}();return function(){function a(){this._dispatcher=new d;this._connections={};this._outgoingStaticMessages=
{};this._isInitialized=!1;this._workerPostMessage({type:"\x3cworker-loaded\x3e"})}return a.prototype.terminate=function(){this._connections={}},Object.defineProperty(a.prototype,"onmessage",{get:function(){return this._onmessageHandler},set:function(a){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler);(this._onmessageHandler=a)&&this.addEventListener("message",a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onerror",{get:function(){return this._onerrorHandler},
set:function(a){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler);(this._onerrorHandler=a)&&this.addEventListener("error",a)},enumerable:!0,configurable:!0}),a.prototype.postMessage=function(a,b){var d=this;f(function(){d._workerMessageHandler(new MessageEvent("message",{data:a}))})},a.prototype.dispatchEvent=function(a){return this._dispatcher.dispatchEvent(a)},a.prototype.addEventListener=function(a,b,d){this._dispatcher.addEventListener(a,b,d)},a.prototype.removeEventListener=
function(a,b,d){this._dispatcher.removeEventListener(a,b,d)},a.prototype._workerPostMessage=function(a,b){var d=this;f(function(){d.dispatchEvent(new MessageEvent("message",{data:a}))})},a.prototype._workerMessageHandler=function(a){var b=this,d=a.data;if(d){var c=d.connection,f=d.type;if("\x3cconfigure\x3e"===f)this._isInitialized||this._workerPostMessage({type:"\x3cworker-configured\x3e"});else if("\x3copen-connection\x3e"===f){a=d.data.path;var k=d.id;if(this._connections[c])return void this._workerPostMessage({type:"\x3cresponse\x3e",
id:k,connection:c});h(["./WorkerConnection",a],function(a,d){b._connections[c]=new a(d,{postMessage:function(a,c){return b._workerPostMessage(a,c)}},c);b._workerPostMessage({type:"\x3cresponse\x3e",id:k,data:{connection:c},error:void 0})})}else"\x3cclose-connection\x3e"===f?this._connections[c]&&delete this._connections[c]:"\x3cstatic-message\x3e"===f?(a=d.id,this._outgoingStaticMessages[a]&&(f=this._outgoingStaticMessages[a],delete this._outgoingStaticMessages[a],d.error?f.reject(d.error):f.resolve(d.data))):
f&&(d=this._connections[c])&&d.proxy.message(a)}},a}()})},"esri/layers/vectorTiles/core/requireUtils":function(){define(["require","exports","dojo/Deferred"],function(h,l,a){function d(b,f){if(Array.isArray(f)){var h=new a;return b(f,function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];h.resolve(a)}),h.promise}return d(b,[f]).then(function(a){return a[0]})}l.when=d;l.getAbsMid=function(a,d,h){return d.toAbsMid?d.toAbsMid(a):h.id.replace(/\/[^\/]*$/gi,"/")+a}})},"esri/layers/vectorTiles/views/2d/layers/support/TileKey":function(){define(["require",
"exports"],function(h,l){return function(){function a(a,b,f,h){this.level=a;this.row=b;this.col=f;this.world=h}return a.from=function(d,b,f,h){var l=typeof d;return"object"===l?d:"string"===l?a.fromId(d):new a(d,b,f,h)},a.fromId=function(d){d=d.split("/");var b=d[1],f=d[2],h=d[3];return new a(parseFloat(d[0]),parseFloat(b),parseFloat(f),parseFloat(h))},a.getId=function(a,b,f,h){return"object"==typeof a?a.level+"/"+a.row+"/"+a.col+"/"+a.world:a+"/"+b+"/"+f+"/"+h},Object.defineProperty(a.prototype,
"id",{get:function(){return a.getId(this)},enumerable:!0,configurable:!0}),a}()})},"esri/layers/vectorTiles/views/vectorTiles/TileIndex":function(){define(["require","exports","../2d/layers/support/TileKey"],function(h,l,a){return function(){function d(a){if(!("index"in a))throw Error("The tilemap is missing the 'index' property.");this._tilemap=a.index}return d.prototype.dataKey=function(b){var d=[b];if(0>b.level||0>b.row||0>b.col||0<b.row>>b.level||0<b.col>>b.level)return null;for(;0!==b.level;)b=
new a(b.level-1,b.row>>1,b.col>>1,b.world),d.push(b);var h,l=this._tilemap,g=d.pop();if(1===l)return g;for(;d.length;){b=d.pop();h=g.level+1;var e=2*g.row,c=2*g.col;if(h=[a.getId(h,e,c,b.world),a.getId(h,e,c+1,b.world),a.getId(h,e+1,c,b.world),a.getId(h,e+1,c+1,b.world)].indexOf(b.id),l){if(0===l[h]){g=null;break}if(1===l[h]){g=b;break}g=b;l=l[h]}}return g},d.prototype.forEach=function(a,d,h,l,g){this._callback=g;this._maxLevel=d+a;this._forEach(this._tilemap,d,h,l)},d.prototype._forEach=function(a,
d,h,l){0!==a&&(this._callback(d,h,l),d!==this._maxLevel&&"object"==typeof a&&(this._forEach(a[0],d+1,2*h,2*l),this._forEach(a[1],d+1,2*h,2*l+1),this._forEach(a[2],d+1,2*h+1,2*l),this._forEach(a[3],d+1,2*h+1,2*l+1)))},d}()})},"esri/layers/vectorTiles/views/vectorTiles/SpriteMosaic":function(){define(["require","exports","./Rect","./RectangleBinPack","../webgl/Texture"],function(h,l,a,d,b){return function(){function f(a,b){this._height=this._width=0;this._mosaicRects={};this._dirty=!1;this.pixelRatio=
1;(0>=a||0>=b)&&console.error("Sprites mosaic width and height must be greater than zero!");this._width=a;this._height=b;this._binPack=new d(a,b)}return Object.defineProperty(f.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),f.prototype.setSpriteSource=function(a){(this._dispose(),this.pixelRatio=a.devicePixelRatio,this._mosaicData)||(this._binPack=
new d(this._width,this._height),this._mosaicData=new Uint32Array(Math.floor(this._width)*Math.floor(this._height)));this._sprites=a},f.prototype.getSpriteItem=function(a,b){void 0===b&&(b=!1);var d=this._mosaicRects[a];if(d)return d;if(!this._sprites||"loaded"!==this._sprites.loadStatus)return null;var e=this._sprites.getSpritePosition(a);if(!e||!e.width||!e.height)return null;var c=this._allocateImage(e.width,e.height);return 0>=c.width?null:(d={rect:c,width:e.width,height:e.height,sdf:e.sdf,pixelRatio:e.pixelRatio},
this._copy(c,e,b),this._mosaicRects[a]=d,d)},f.prototype.getSpriteItems=function(a){for(var b={},d=0;d<a.length;d++){var e=a[d];b[e]=this.getSpriteItem(e)}return b},f.prototype.getMosaicItemPosition=function(a,b){var d=this.getSpriteItem(a,b),e=d&&d.rect;if(!e)return null;e.width=d.width;e.height=d.height;return{size:[d.width,d.height],tl:[(e.x+1)/this._width,(e.y+1)/this._height],br:[(e.x+1+d.width)/this._width,(e.y+1+d.height)/this._height]}},f.prototype.bind=function(a,d,f){void 0===f&&(f=0);this._texture||
(this._texture=new b(a,{pixelFormat:6408,dataType:5121,width:this._width,height:this._height},new Uint8Array(this._mosaicData.buffer)));this._texture.setSamplingMode(d);a.bindTexture(this._texture,f);this._dirty&&this._texture.setData(new Uint8Array(this._mosaicData.buffer));this._dirty=!1},f._copyBits=function(a,b,d,e,c,f,h,l,u,v,t){var w=e*b+d;h=l*f+h;if(t)for(h-=f,t=-1;v>=t;t++,w=((t+v)%v+e)*b+d,h+=f)for(l=-1;u>=l;l++)c[h+l]=a[w+(l+u)%u];else for(t=0;v>t;t++){for(l=0;u>l;l++)c[h+l]=a[w+l];w+=b;
h+=f}},f.prototype._copy=function(a,b,d){if(this._sprites&&"loaded"===this._sprites.loadStatus){var e=new Uint32Array(this._sprites.image.buffer),c=this._mosaicData;c&&e||console.error("Source or target images are uninitialized!");f._copyBits(e,this._sprites.width,b.x,b.y,c,this._width,a.x+1,a.y+1,b.width,b.height,d);this._dirty=!0}},f.prototype._allocateImage=function(b,d){b+=2;d+=2;var f=this._binPack.allocate(b+(b%4?4-b%4:0),d+(d%4?4-d%4:0));return 0>=f.width&&(console.warn("Out of sprite mosaic space!"),
f=new a(0,0,0,0)),f},f.prototype._dispose=function(){this._binPack=this._mosaicData=null;this._mosaicRects={};this._dirty=!0},f}()})},"esri/layers/vectorTiles/views/vectorTiles/Rect":function(){define(["require","exports"],function(h,l){return function(){function a(a,b,f,h){void 0===a&&(a=0);void 0===b&&(b=0);void 0===f&&(f=0);void 0===h&&(h=0);this.x=a;this.y=b;this.width=f;this.height=h}return Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,
configurable:!0}),a}()})},"esri/layers/vectorTiles/views/vectorTiles/RectangleBinPack":function(){define(["require","exports","./Rect"],function(h,l,a){return function(){function d(b,d){this._height=this._width=0;this._free=[];this._width=b;this._height=d;this._free.push(new a(0,0,b,d))}return d.prototype.allocate=function(b,d){for(var h=null,l=-1,g=0;g<this._free.length;++g){var e=this._free[g];b<=e.width&&d<=e.height&&(null===h||e.y<=h.y&&e.x<=h.x)&&(h=e,l=g)}return null===h?new a:(this._free.splice(l,
1),h.width<h.height?(h.width>b&&this._free.push(new a(h.x+b,h.y,h.width-b,d)),h.height>d&&this._free.push(new a(h.x,h.y+d,h.width,h.height-d))):(h.width>b&&this._free.push(new a(h.x+b,h.y,h.width-b,h.height)),h.height>d&&this._free.push(new a(h.x,h.y+d,b,h.height-d))),new a(h.x,h.y,b,d))},d.prototype.release=function(a){for(var d=0;d<this._free.length;++d){var h=this._free[d];if(h.y===a.y&&h.height===a.height&&h.x+h.width===a.x)h.width+=a.width;else if(h.x===a.x&&h.width===a.width&&h.y+h.height===
a.y)h.height+=a.height;else if(a.y===h.y&&a.height===h.height&&a.x+a.width===h.x)h.x=a.x,h.width+=a.width;else{if(a.x!==h.x||a.width!==h.width||a.y+a.height!==h.y)continue;h.y=a.y;h.height+=a.height}this._free.splice(d,1);this.release(a)}this._free.push(a)},d}()})},"esri/layers/vectorTiles/views/vectorTiles/SpriteSource":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper dojo/Deferred dojo/promise/all ../../request ../../kernel ../../core/promiseUtils".split(" "),
function(h,l,a,d,b,f,k,m,g){return function(){function a(b,d){this.baseURL=b;this.devicePixelRatio=d;this._isRetina=!1;this._spritesData={};this.height=this.width=this.image=null;this.loadStatus="not-loaded"}return a.prototype.getSpritePosition=function(a){return this._spritesData[a]},a.prototype.load=function(){var a=this;return this.loadStatus="loading",this.baseURL?this._loadSprites().then(function(){return a.loadStatus="loaded",a}).otherwise(function(b){return a.loadStatus="failed",a}):g.resolve(this)},
a.prototype._loadSprites=function(){var a=this;this._isRetina=1.15<this.devicePixelRatio?!0:!1;var d=this.baseURL,e=this._isRetina?"@2x":"",g=k(d+e+".json",{callbackParamName:"callback",responseType:"json"}).then(function(b){a._spritesData=b.data}),h=new b,l=new Image;l.crossOrigin="anonymous";l.onload=function(){l.onload=null;a.width=l.width;a.height=l.height;var b=document.createElement("canvas");b.width=l.width;b.height=l.height;b=b.getContext("2d");b.drawImage(l,0,0,l.width,l.height);for(var b=
b.getImageData(0,0,l.width,l.height),d=new Uint8Array(b.data),e=0;e<d.length;e+=4)b=d[e+3]/255,d[e]*=b,d[e+1]*=b,d[e+2]*=b;a.image=d;h.resolve()};d=""+d+e+".png";m.id&&(e=m.id.findCredential(d))&&e.token&&(d+="?token\x3d"+e.token);return l.src=d,f([g,h.promise])},a}()})},"esri/layers/vectorTiles/views/vectorTiles/GlyphMosaic":function(){define("require exports dojo/promise/all dojo/Deferred ./Rect ../webgl/Texture ./RectangleBinPack".split(" "),function(h,l,a,d,b,f,k){return function(){function h(a,
b,c){this.height=this.width=0;this._dirty=!1;this._glyphIndex={};this._rangePromises={};(0>=a||0>=b)&&console.error("Glyph mosaic width and height must be greater than zero!");this.width=a;this.height=b;this._glyphSource=c;this._binPack=new k(a,b);this._glyphData=new Uint8Array(a*b)}return h.prototype.getGlyphItems=function(f,e,c){for(var h=this,k=[],l=this._glyphSource,m=new Set,v=1/256,t=0;t<c.length;t++)m.add(Math.floor(c[t]*v));var w=[];return m.forEach(function(a){if(256>=a){var b=new d;w.push(b.promise);
var c=e+a,f=h._rangePromises[c];f?f.push(b):(h._rangePromises[c]=[b],l.getRange(e,a).then(function(){var a=h._rangePromises[c];delete h._rangePromises[c];for(var b=0;b<a.length;b++)a[b].resolve()}))}}),a(w).then(function(a){(a=h._glyphIndex[e])||(a={},h._glyphIndex[e]=a);for(var d=0;d<c.length;d++){var m=c[d],t=a[m];if(t)t.tileIDs.add(f),k[m]={rect:t.rect,metrics:t.metrics};else{var u=l.getGlyph(e,m);if(u&&u.metrics){var t=u.metrics,v=void 0;if(0===t.width)v=new b(0,0,0,0);else{var w=t.width+6,E=
t.height+6,v=h._binPack.allocate(w+(w%4?4-w%4:0),E+(E%4?4-E%4:0));0>=v.width&&(v=new b(0,0,0,0));var u=u.bitmap,F=void 0,H=void 0;if(u)for(var G=0;E>G;G++)for(var F=w*G,H=h.width*(v.y+G)+v.x,K=0;w>K;K++)h._glyphData[H+K]=u[F+K]}w=new Set;w.add(f);a[m]={rect:v,metrics:t,tileIDs:w};k[m]={rect:v,metrics:t};h._dirty=!0}}}return k})},h.prototype.removeGlyphs=function(a){for(var b in this._glyphIndex){var c=this._glyphIndex[b];if(c){var d=void 0,f;for(f in c)if(d=c[f],d.tileIDs["delete"](a),0===d.tileIDs.size){for(var h=
d.rect,k=void 0,l=void 0,m=0;m<h.height;m++)for(k=this.width*(h.y+m)+h.x,l=0;l<h.width;l++)this._glyphData[k+l]=0;delete c[f];this._dirty=!0}}}},h.prototype.bind=function(a,b,c){void 0===c&&(c=0);this._texture||(this._texture=new f(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));this._texture.setSamplingMode(b);a.bindTexture(this._texture,c);this._dirty&&this._texture.setData(this._glyphData);this._dirty=!1},h}()})},"esri/layers/vectorTiles/views/vectorTiles/GlyphSource":function(){define(["require",
"exports","../../core/promiseUtils","../../request","../../core/pbf"],function(h,l,a,d,b){var f=function(){function a(b){this._metrics=[];for(this._bitmaps=[];b.next();)switch(b.tag()){case 1:for(var d=b.getMessage();d.next();)switch(d.tag()){case 3:for(var c=d.getMessage(),f=void 0,h=void 0,k=void 0,l=void 0,m=void 0,t=void 0,w=void 0;c.next();)switch(c.tag()){case 1:f=c.getUInt32();break;case 2:h=c.getBytes();break;case 3:k=c.getUInt32();break;case 4:l=c.getUInt32();break;case 5:m=c.getSInt32();
break;case 6:t=c.getSInt32();break;case 7:w=c.getUInt32();break;default:c.skip()}f&&(this._metrics[f]={width:k,height:l,left:m,top:t,advance:w},this._bitmaps[f]=h);break;default:d.skip()}break;default:b.skip()}}return a.prototype.getMetrics=function(a){return this._metrics[a]},a.prototype.getBitmap=function(a){return this._bitmaps[a]},a}(),k=function(){function a(){this._ranges=[]}return a.prototype.getRange=function(a){return this._ranges[a]},a.prototype.addRange=function(a,b){this._ranges[a]=b},
a}();return function(){function h(a){this._glyphInfo={};this._baseURL=a}return h.prototype.getRange=function(g,e){var c=this._getFontStack(g);if(c.getRange(e))return a.resolve();var h=256*e,k=h+255,h=this._baseURL.replace("{fontstack}",g).replace("{range}",h+"-"+k);return d(h,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){c.addRange(e,new f(new b(new Uint8Array(a.data),new DataView(a.data))))})},h.prototype.getGlyph=function(a,b){var c=this._getFontStack(a);if(c){var d=
Math.floor(b/256);if(!(256<d)&&(c=c.getRange(d)))return{metrics:c.getMetrics(b),bitmap:c.getBitmap(b)}}},h.prototype._getFontStack=function(a){var b=this._glyphInfo[a];return b||(b=this._glyphInfo[a]=new k),b},h}()})},"esri/layers/vectorTiles/core/pbf":function(){define(["require","exports"],function(h,l){return function(){function a(a,b,f,h){this._tag=0;this._dataType=99;this._data=a;this._dataView=b;this._pos=f||0;this._end=h||a.byteLength}return a.prototype.clone=function(){return new a(this._data,
this._dataView,this._pos,this._end)},a.prototype.next=function(a){for(;;){if(this._pos===this._end)return!1;var b=this._decodeVarint();if(this._tag=b>>3,this._dataType=7&b,!a||a===this._tag)break;this.skip()}return!0},a.prototype.empty=function(){return this._pos>=this._end},a.prototype.tag=function(){return this._tag},a.prototype.getInt32=function(){return this._decodeVarint()},a.prototype.getInt64=function(){return this._decodeVarint()},a.prototype.getUInt32=function(){return this._decodeVarint()},
a.prototype.getUInt64=function(){return this._decodeVarint()},a.prototype.getSInt32=function(){return this._decodeSVarint()},a.prototype.getSInt64=function(){return this._decodeSVarint()},a.prototype.getBool=function(){var a=0!==this._data[this._pos];return this._skip(1),a},a.prototype.getEnum=function(){return this._decodeVarint()},a.prototype.getFixed64=function(){var a=this._dataView,b=this._pos,a=a.getUint32(b,!0)+4294967296*a.getUint32(b+4,!0);return this._skip(8),a},a.prototype.getSFixed64=
function(){var a=this._dataView,b=this._pos,a=a.getUint32(b,!0)+4294967296*a.getInt32(b+4,!0);return this._skip(8),a},a.prototype.getDouble=function(){var a=this._dataView.getFloat64(this._pos,!0);return this._skip(8),a},a.prototype.getFixed32=function(){var a=this._dataView.getUint32(this._pos,!0);return this._skip(4),a},a.prototype.getSFixed32=function(){var a=this._dataView.getInt32(this._pos,!0);return this._skip(4),a},a.prototype.getFloat=function(){var a=this._dataView.getFloat32(this._pos,
!0);return this._skip(4),a},a.prototype.getString=function(){var a=this._getLength(),b=this._pos,b=this._toString(this._data,b,b+a);return this._skip(a),b},a.prototype.getBytes=function(){var a=this._getLength(),b=this._pos,b=this._toBytes(this._data,b,b+a);return this._skip(a),b},a.prototype.getMessage=function(){var d=this._getLength(),b=this._pos,b=new a(this._data,this._dataView,b,b+d);return this._skip(d),b},a.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;
case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw Error("Invalid data type!");}},a.prototype._skip=function(a){if(this._pos+a>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=a},a.prototype._decodeVarint=function(){var a,b=this._data,f=this._pos,h=0;if(10<=this._end-f){if(a=b[f++],h|=127&a,0!==(128&a))if(a=b[f++],h|=(127&a)<<7,0!==(128&a))if(a=b[f++],h|=(127&a)<<14,0!==(128&a))if(a=b[f++],h|=(127&a)<<21,0!==(128&
a))if(a=b[f++],h+=268435456*(127&a),0!==(128&a))if(a=b[f++],h+=34359738368*(127&a),0!==(128&a))if(a=b[f++],h+=4398046511104*(127&a),0!==(128&a))if(a=b[f++],h+=562949953421312*(127&a),0!==(128&a))if(a=b[f++],h+=72057594037927936*(127&a),0!==(128&a))if(a=b[f++],h+=0x7fffffffffffffff*(127&a),0!==(128&a))throw Error("Varint too long!");}else{for(var l=1;f!==this._end&&(a=b[f],0!==(128&a));)++f,h+=(127&a)*l,l*=128;if(f===this._end)throw Error("Varint overrun!");++f;h+=a*l}return this._pos=f,h},a.prototype._decodeSVarint=
function(){var a=this._decodeVarint();return a%2?-(a+1)/2:a/2},a.prototype._getLength=function(){if(2!==this._dataType)throw Error("Not a delimited data type!");return this._decodeVarint()},a.prototype._toString=function(a,b,f){var h="",l="";for(f=Math.min(this._end,f);f>b;++b){var g=a[b];128&g?l+="%"+g.toString(16):(h+=decodeURIComponent(l)+String.fromCharCode(g),l="")}return l.length&&(h+=decodeURIComponent(l)),h},a.prototype._toBytes=function(a,b,f){return f=Math.min(this._end,f),new Uint8Array(a.buffer,
b,f-b)},a}()})},"esri/layers/vectorTiles/views/vectorTiles/VectorTileDisplayObject":function(){define("require exports ../../core/tsSupport/extendsHelper ../webgl/BufferObject ../2d/engine/DisplayObject ../../core/libs/gl-matrix/vec2 ../../core/libs/gl-matrix/mat4 ./RenderBucket".split(" "),function(h,l,a,d,b,f,k,m){return function(b){function e(a,d,e,h,l,m,t,w,x,y,z){b.call(this);this._renderBuckets=[];this._symbolUpdateData=this._vectorTileData=null;this.topLeft=[0,0];this.bottomRight=[0,0];this.tileTransform=
{transform:Float32Array[16],displayCoord:Float32Array[2]};this.stencilData={mask:0,reference:0};this.key=a;this.refKey=d;this.topLeft[0]=e[0];this.topLeft[1]=e[1];this.bottomRight[0]=e[2];this.bottomRight[1]=e[3];this.widthInPixels=h;this.coordRange=l;this.rotation=m;this._vectorTileData=t;this.styleLayers=w;this._glyphsMosaic=x;this.workerID=y;this._connection=z;this.id=a.id;this.status=3;this.tileTransform.transform=k.create();this.tileTransform.displayCoord=f.create()}return a(e,b),e.prototype.updateSymbolData=
function(a){a&&(this._symbolUpdateData=a,this.requestRender())},e.prototype.dispose=function(){-1!==this.workerID&&this._connection&&6!==this.status&&7!==this.status&&this._connection.broadcast("destructTileData",{key:this.id,worker:this.workerID},[]);this.polygonTrianglesVertexArrayObject&&(this.polygonTrianglesVertexArrayObject.dispose(),this.polygonTrianglesVertexArrayObject=null);this.polygonOutlineVertexArrayObject&&(this.polygonOutlineVertexArrayObject.dispose(),this.polygonOutlineVertexArrayObject=
null);this.lineTrianglesVertexArrayObject&&(this.lineTrianglesVertexArrayObject.dispose(),this.lineTrianglesVertexArrayObject=null);this.lineJoinsVertexArrayObject&&(this.lineJoinsVertexArrayObject.dispose(),this.lineJoinsVertexArrayObject=null);this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this.polygonTrianglesVertexBuffer&&(this.polygonTrianglesVertexBuffer.dispose(),
this.polygonTrianglesVertexBuffer=null);this.polygonTrianglesIndexBuffer&&(this.polygonTrianglesIndexBuffer.dispose(),this.polygonTrianglesIndexBuffer=null);this.polygonOutlinesVertexBuffer&&(this.polygonOutlinesVertexBuffer.dispose(),this.polygonOutlinesVertexBuffer=null);this.polygonOutlinesIndexBuffer&&(this.polygonOutlinesIndexBuffer.dispose(),this.polygonOutlinesIndexBuffer=null);this.lineVertexBuffer&&(this.lineVertexBuffer.dispose(),this.lineVertexBuffer=null);this.lineTrianglesIndexBuffer&&
(this.lineTrianglesIndexBuffer.dispose(),this.lineTrianglesIndexBuffer=null);this.lineJoinVertexBuffer&&(this.lineJoinVertexBuffer.dispose(),this.lineJoinVertexBuffer=null);this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null);
this._renderBuckets=[];this.status=7},e.prototype.attach=function(a){if(this.status=3,!this._vectorTileData)return!1;if(0===this._renderBuckets.length)for(var b=new Uint32Array(this._vectorTileData.bucketDataInfo),e=b.length,f=0;e>f;){var g=b[f],h=b[f+1];0===h?(h=new m.BackgroundRenderBucket,h.layerID=g,this._renderBuckets.push(h),f+=2):1===h?(h=new m.FillRenderBucket,h.layerID=g,h.triangleElementStart=b[f+2],h.triangleElementCount=b[f+3],h.outlineElementStart=b[f+4],h.outlineElementCount=b[f+5],
this._renderBuckets.push(h),f+=6):2===h?(h=new m.LineRenderBucket,h.layerID=g,h.triangleElementStart=b[f+2],h.triangleElementCount=b[f+3],h.joinStart=b[f+4],h.joinCount=b[f+5],this._renderBuckets.push(h),f+=6):3===h?(h=new m.SymbolRenderBucket,h.layerID=g,h.markerElementStart=b[f+2],h.marketElementCount=b[f+3],h.textElementStart=b[f+4],h.textElementCount=b[f+5],h.isSDF=0!==b[f+6],this._renderBuckets.push(h),f+=7):console.error("Bad bucket type!")}b=a.context;a=a.budget;e=new Uint32Array(this._vectorTileData.bufferDataInfo);
f=e.length;for(h=g=0;f>h;h+=2,g++){var k=e[h],l=e[h+1];if(!(0>=l||0===this._vectorTileData.bufferData[g].byteLength)){if(a&&a.done)return!1;switch(k){case 2:this.polygonTrianglesVertexBuffer||(this.polygonTrianglesVertexBuffer=d.createVertex(b,35044,this._vectorTileData.bufferData[g]));break;case 6:this.polygonTrianglesIndexBuffer||(this.polygonTrianglesIndexBuffer=d.createIndex(b,35044,new Uint32Array(this._vectorTileData.bufferData[g],0,l/4)));break;case 3:this.polygonOutlinesVertexBuffer||(this.polygonOutlinesVertexBuffer=
d.createVertex(b,35044,this._vectorTileData.bufferData[g]));break;case 7:this.polygonOutlinesIndexBuffer||(this.polygonOutlinesIndexBuffer=d.createIndex(b,35044,new Uint32Array(this._vectorTileData.bufferData[g],0,l/4)));break;case 0:this.lineVertexBuffer||(this.lineVertexBuffer=d.createVertex(b,35044,this._vectorTileData.bufferData[g]));break;case 8:this.lineTrianglesIndexBuffer||(this.lineTrianglesIndexBuffer=d.createIndex(b,35044,this._vectorTileData.bufferData[g]));break;case 1:this.lineJoinVertexBuffer||
(this.lineJoinVertexBuffer=d.createVertex(b,35044,this._vectorTileData.bufferData[g]));break;case 4:this.iconVertexBuffer||(this.iconVertexBuffer=d.createVertex(b,35044,this._vectorTileData.bufferData[g]));break;case 9:this.iconIndexBuffer||(this.iconIndexBuffer=d.createIndex(b,35044,new Uint32Array(this._vectorTileData.bufferData[g],0,l/4)));break;case 5:this.textVertexBuffer||(this.textVertexBuffer=d.createVertex(b,35044,this._vectorTileData.bufferData[g]));break;case 10:this.textIndexBuffer||(this.textIndexBuffer=
d.createIndex(b,35044,new Uint32Array(this._vectorTileData.bufferData[g],0,l/4)))}}}return this.status=4,!0},e.prototype.detach=function(a){},e.prototype.render=function(a){if(this.visible&&4===this.status){var b=a.context,d=a.renderer;if(b&&d){var e=a.drawphase;this._symbolUpdateData&&this._updateSymbolData(a);b.setStencilFunction(514,this.stencilData.reference,this.stencilData.mask);var f=this.styleLayers,g=void 0!==a.layerOpacity?a.layerOpacity:1;if(0!==g){var h,k=this._renderBuckets.length,l=
0;if(0===e)for(l=k-1;0<=l;l--)h=this._renderBuckets[l],3!==h.type&&h.hasData()&&d.renderBucket(b,h,a.displayLevel,a.requiredLevel,e,this,f.layers[h.layerID],g);else for(l=0;k>l;l++)h=this._renderBuckets[l],h.hasData()&&d.renderBucket(b,h,a.displayLevel,a.requiredLevel,e,this,f.layers[h.layerID],g)}}}},e.prototype._updateSymbolData=function(a){var b=new Uint32Array(this._symbolUpdateData.bucketDataInfo),e=b.length;if(0===e)return this._symbolUpdateData=null,!0;if(1>a.budget.remaining)return this.requestRender(),
!1;a=a.context;a.bindVAO(null);for(var f=new Uint32Array(this._symbolUpdateData.bufferDataInfo),g=f.length,h=0,k=0;g>k;k+=2,h++){var l=f[k],x=f[k+1];if(!(0>=x||0===this._symbolUpdateData.bufferData[h].byteLength))switch(l){case 4:this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconVertexBuffer=d.createVertex(a,35044,this._symbolUpdateData.bufferData[h]);break;case 9:this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.iconIndexBuffer=
d.createIndex(a,35044,new Uint32Array(this._symbolUpdateData.bufferData[h],0,x/4));break;case 5:this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textVertexBuffer=d.createVertex(a,35044,this._symbolUpdateData.bufferData[h]);break;case 10:this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null),this.textIndexBuffer=d.createIndex(a,35044,new Uint32Array(this._symbolUpdateData.bufferData[h],0,x/4))}}a=0;for(f=this._renderBuckets.length;f>
a;a++)this._renderBuckets[a]instanceof m.SymbolRenderBucket&&(g=this._renderBuckets[a],g.markerElementStart=0,g.marketElementCount=0,g.textElementStart=0,g.textElementCount=0);for(g=0;e>g;){k=b[g];h=-1;a=0;for(f=this._renderBuckets.length;f>a;a++)if(this._renderBuckets[a].layerID===k){h=a;break}(a=this._renderBuckets[h])?(a.markerElementStart=b[g+2],a.marketElementCount=b[g+3],a.textElementStart=b[g+4],a.textElementCount=b[g+5],g+=7):g+=7}return this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),
this.iconVertexArrayObject=null),this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null),this._symbolUpdateData=null,!0},e}(b)})},"esri/layers/vectorTiles/views/vectorTiles/RenderBucket":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper"],function(h,l,a,d){h=function(){return function(a){this.type=a}}();l.RenderBucket=h;d=function(b){function d(){b.call(this,2);this.joinCount=this.joinStart=this.triangleElementCount=
this.triangleElementStart=0}return a(d,b),d.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.joinCount},d}(h);l.LineRenderBucket=d;d=function(b){function d(){b.call(this,1);this.outlineElementCount=this.outlineElementStart=this.triangleElementCount=this.triangleElementStart=0}return a(d,b),d.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.outlineElementCount},d}(h);l.FillRenderBucket=d;d=function(b){function d(){b.call(this,3);this.textElementCount=this.textElementStart=
this.marketElementCount=this.markerElementStart=0;this.isSDF=!1}return a(d,b),d.prototype.hasData=function(){return 0<this.marketElementCount||0<this.textElementCount},d}(h);l.SymbolRenderBucket=d;h=function(b){function d(){b.call(this,0)}return a(d,b),d.prototype.hasData=function(){return!0},d}(h);l.BackgroundRenderBucket=h})},"esri/layers/vectorTiles/views/2d/engine/StageGL":function(){define("require exports ../../../core/tsSupport/extendsHelper ./../math/vec2 ./../math/mat2d dojo/text!./webgl/stencil.vs.glsl dojo/text!./webgl/stencil.fs.glsl ./webgl/BitBlitRenderer ../../support/screenshotUtils ../../../core/promiseUtils ../math/common ./Container ../../webgl/RenderingContext ../../webgl/FramebufferObject ../../webgl/webgl-utils ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject".split(" "),
function(h,l,a,d,b,f,k,m,g,e,c,n,q,r,u,v,t,w){function x(a){return{budget:a.budget,state:a.state,devicePixelRatio:a.devicePixelRatio,stationary:a.stationary}}var y={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"};return function(h){function l(){h.apply(this,arguments);this._clipData=new Float32Array(8);this._upperLeft=d.create();this._upperRight=d.create();this._lowerLeft=d.create();this._lowerRight=d.create();this._mat2=b.create();this._clipRendererInitialized=!1}return a(l,h),l.prototype.createElement=
function(){var a=document.createElement("canvas");return a.setAttribute("class","esri-display-object"),a},l.prototype.setElement=function(a){this.element=a},l.prototype.attach=function(a){this._resizeCanvas(a);var b=u.setupWebGL(this.element,{alpha:!0,antialias:!1,depth:!0,stencil:!0});return this._renderingContext=new q(b[0]),this.attached=!0,this._cachedRenderParams=x(a),h.prototype.attach.call(this,a)},l.prototype.detach=function(a){h.prototype.detach.call(this,a);this._cachedRenderParams=this._renderingContext=
null},l.prototype.beforeRenderChildren=function(a,e){var f=a.state;if(!(f.spatialReference&&(f.spatialReference._isWrappable?f.spatialReference._isWrappable():f.spatialReference.isWrappable)))return void(this._clipFrame=!1);var g=f.width,h=f.height,k=f.rotation,l=this._renderingContext,g=g*a.devicePixelRatio,h=h*a.devicePixelRatio,m=c.toRadian(k),n=Math.abs(Math.cos(m)),q=Math.abs(Math.sin(m)),t=Math.round(g*n+h*q),u=Math.round(f.worldScreenWidth);if(u>=t)return void(this._clipFrame=!1);this._clipFBO&&
this._clipFBO.width===g&&this._clipFBO.height===h||(this._clipFBO=new r(l,{colorTarget:0,depthStencilTarget:3,width:g,height:h}));var v=.5*g,w=.5*h,t=1/g,f=1/h,u=.5*u*a.devicePixelRatio,x=.5*(g*q+h*n),g=this._upperLeft,n=this._upperRight,q=this._lowerLeft,y=this._lowerRight;d.set(g,-u,-x);d.set(n,u,-x);d.set(q,-u,x);d.set(y,u,x);b.identity(this._mat2);b.translate(this._mat2,this._mat2,[v,w]);0!==k&&b.rotate(this._mat2,this._mat2,m);d.transformMat2d(g,g,this._mat2);d.transformMat2d(n,n,this._mat2);
d.transformMat2d(q,q,this._mat2);d.transformMat2d(y,y,this._mat2);k=this._clipData;k.set([2*q[0]*t-1,2*(h-q[1])*f-1,2*y[0]*t-1,2*(h-y[1])*f-1,2*g[0]*t-1,2*(h-g[1])*f-1,2*n[0]*t-1,2*(h-n[1])*f-1]);this._clipRendererInitialized||this._initializeClipRenderer(l);this._clipVBO.setData(k);l.bindFramebuffer(this._clipFBO);l.setDepthWriteEnabled(!0);l.setStencilWriteMask(255);l.setClearColor(0,0,0,0);l.setClearDepth(1);l.setClearStencil(0);l.clear(l.gl.COLOR_BUFFER_BIT|l.gl.DEPTH_BUFFER_BIT|l.gl.STENCIL_BUFFER_BIT);
this._clipFrame=!0},l.prototype.afterRenderChildren=function(a,b){if(this._clipFrame&&this._clipRendererInitialized){var c=this._renderingContext;c.bindFramebuffer();c.bindVAO(this._clipVAO);c.bindProgram(this._clipStencilProgram);c.setDepthWriteEnabled(!1);c.setDepthTestEnabled(!1);c.setStencilTestEnabled(!0);c.setBlendingEnabled(!1);c.setColorMask(!1,!1,!1,!1);c.setStencilOp(7680,7680,7681);c.setStencilWriteMask(255);c.setStencilFunction(519,1,255);c.drawElements(4,6,5123,0);c.bindVAO();c.setColorMask(!0,
!0,!0,!0);c.setBlendingEnabled(!0);c.setStencilWriteMask(255);c.setStencilFunction(514,1,255);this._blitRenderer.render(c,this._clipFBO.colorTexture,9728,1);c.setStencilTestEnabled(!1)}},l.prototype.render=function(a){var b=this.element.style;return this.visible?(b.display="block",b.opacity=""+this.opacity,this._resizeCanvas(a),h.prototype.render.call(this,a),void(this._cachedRenderParams=x(a))):void(b.display="none")},l.prototype.takeScreenshot=function(a){var b=this._cachedRenderParams.devicePixelRatio,
c=b*this._cachedRenderParams.state.width,d=b*this._cachedRenderParams.state.height,f=0,h=0,k=c,l=d,m=c,n=d,m=a.area;(m&&(f=b*m.x,h=b*m.y,k=b*m.width,l=b*m.height),void 0!==a.width&&void 0!==a.height)?(m=a.width/a.height,l*m<k?(m*=l,f+=Math.floor((k-m)/2),k=Math.floor(m)):(m=k/m,h+=Math.floor((l-m)/2),l=Math.floor(m)),m=a.width,n=a.height):(m=k,n=l);b=document.createElement("canvas");b.width=m;b.height=n;var q=b.getContext("2d"),t=new Uint8Array(k*l*4),u=this._renderingContext,v=r.create(u,{colorTarget:1,
depthStencilTarget:3,width:c,height:d});u.bindFramebuffer(v);u.setViewport(0,0,c,d);this._cachedRenderParams.budget&&this._cachedRenderParams.budget.reset(Number.MAX_VALUE);var w=this._cachedRenderParams,x=this._renderingContext.gl;this._renderingContext.setClearColor(1,1,1,1);this._renderingContext.setClearDepth(1);this._renderingContext.setClearStencil(0);this._renderingContext.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT|x.STENCIL_BUFFER_BIT);w.context=this._renderingContext;this.renderChildren(w);
v.readPixels(f,d-(h+l),k,l,6408,5121,t);u.bindFramebuffer();u=q.getImageData(0,0,m,n);if(0!==f||0!==h||k!==c||l!==d||m!==c||n!==d)g.resampleHermite(t,k,l,u.data,m,n,!0);else{for(var c=l-1,d=0,k=4*k,z=x=w=v=l=h=f=void 0;c>d;){x=d*k;z=c*k;for(f=0;k>f;f+=4)h=t[x+f],l=t[x+f+1],v=t[x+f+2],w=t[x+f+3],t[x+f]=t[z+f],t[x+f+1]=t[z+f+1],t[x+f+2]=t[z+f+2],t[x+f+3]=t[z+f+3],t[z+f]=h,t[z+f+1]=l,t[z+f+2]=v,t[z+f+3]=w;d++;c--}k=u.data;c=0;for(d=t.length;d>c;c++)k[c]=t[c]}q.putImageData(u,0,0);q=y[a.format?a.format.toLowerCase():
"png"];t=1;void 0!==a.quality&&(t=a.quality/100);a=b.toDataURL(q,t);return e.resolve({dataURL:a,x:0,y:0,width:m,height:n})},l.prototype.prepareChildrenRenderParameters=function(a){if(!this.attached||!this._renderingContext)return null;var b=this._renderingContext,c=b.gl;return b.setDepthWriteEnabled(!0),b.setStencilWriteMask(255),b.setClearColor(0,0,0,0),b.setClearDepth(1),b.setClearStencil(0),b.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT),b.setViewport(0,0,this.element.width,
this.element.height),b.setDepthWriteEnabled(!1),a.context=b,a},l.prototype.attachChild=function(a,b){return a.attach(b)},l.prototype.detachChild=function(a,b){return a.detach(b)},l.prototype.renderChild=function(a,b){return a.render(b)},l.prototype._resizeCanvas=function(a){var b=this.element,c=b.style,d=a.state,e=a.devicePixelRatio;a=d.width*e;e*=d.height;(b.width!==a||b.height!==e)&&(b.width=a,b.height=e,c.width=d.width+"px",c.height=d.height+"px")},l.prototype._initializeClipRenderer=function(a){if(this._clipRendererInitialized)return!0;
this._blitRenderer=new m;var b={a_pos:0},c=new v(a,f,k,b);if(!c)return!1;var d=w.createVertex(a,35040,32),e=new Uint16Array([0,1,2,2,1,3]),e=w.createIndex(a,35044,e);a=new t(a,b,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:d},e);return this._clipStencilProgram=c,this._clipVBO=d,this._clipVAO=a,this._clipRendererInitialized=!0,!0},l}(n)})},"esri/layers/vectorTiles/views/2d/math/vec2":function(){define(["./common"],function(h){var l=h.GLMAT_ARRAY_TYPE,
a=h.GLMAT_RANDOM,d={};return d.create=function(){var a=new l(2);return a[0]=0,a[1]=0,a},d.clone=function(a){var d=new l(2);return d[0]=a[0],d[1]=a[1],d},d.fromValues=function(a,d){var h=new l(2);return h[0]=a,h[1]=d,h},d.copy=function(a,d){return a[0]=d[0],a[1]=d[1],a},d.set=function(a,d,h){return a[0]=d,a[1]=h,a},d.add=function(a,d,h){return a[0]=d[0]+h[0],a[1]=d[1]+h[1],a},d.subtract=function(a,d,h){return a[0]=d[0]-h[0],a[1]=d[1]-h[1],a},d.sub=d.subtract,d.multiply=function(a,d,h){return a[0]=
d[0]*h[0],a[1]=d[1]*h[1],a},d.mul=d.multiply,d.divide=function(a,d,h){return a[0]=d[0]/h[0],a[1]=d[1]/h[1],a},d.div=d.divide,d.min=function(a,d,h){return a[0]=Math.min(d[0],h[0]),a[1]=Math.min(d[1],h[1]),a},d.max=function(a,d,h){return a[0]=Math.max(d[0],h[0]),a[1]=Math.max(d[1],h[1]),a},d.scale=function(a,d,h){return a[0]=d[0]*h,a[1]=d[1]*h,a},d.scaleAndAdd=function(a,d,h,l){return a[0]=d[0]+h[0]*l,a[1]=d[1]+h[1]*l,a},d.distance=function(a,d){var h=d[0]-a[0],l=d[1]-a[1];return Math.sqrt(h*h+l*l)},
d.dist=d.distance,d.squaredDistance=function(a,d){var h=d[0]-a[0],l=d[1]-a[1];return h*h+l*l},d.sqrDist=d.squaredDistance,d.length=function(a){var d=a[0];a=a[1];return Math.sqrt(d*d+a*a)},d.len=d.length,d.squaredLength=function(a){var d=a[0];a=a[1];return d*d+a*a},d.sqrLen=d.squaredLength,d.negate=function(a,d){return a[0]=-d[0],a[1]=-d[1],a},d.inverse=function(a,d){return a[0]=1/d[0],a[1]=1/d[1],a},d.normalize=function(a,d){var h=d[0],l=d[1],h=h*h+l*l;return 0<h&&(h=1/Math.sqrt(h),a[0]=d[0]*h,a[1]=
d[1]*h),a},d.dot=function(a,d){return a[0]*d[0]+a[1]*d[1]},d.cross=function(a,d,h){d=d[0]*h[1]-d[1]*h[0];return a[0]=a[1]=0,a[2]=d,a},d.lerp=function(a,d,h,l){var g=d[0];d=d[1];return a[0]=g+l*(h[0]-g),a[1]=d+l*(h[1]-d),a},d.random=function(b,d){d=d||1;var h=2*a()*Math.PI;return b[0]=Math.cos(h)*d,b[1]=Math.sin(h)*d,b},d.transformMat2=function(a,d,h){var l=d[0];d=d[1];return a[0]=h[0]*l+h[2]*d,a[1]=h[1]*l+h[3]*d,a},d.transformMat2d=function(a,d,h){var l=d[0];d=d[1];return a[0]=h[0]*l+h[2]*d+h[4],
a[1]=h[1]*l+h[3]*d+h[5],a},d.transformMat3=function(a,d,h){var l=d[0];d=d[1];return a[0]=h[0]*l+h[3]*d+h[6],a[1]=h[1]*l+h[4]*d+h[7],a},d.transformMat4=function(a,d,h){var l=d[0];d=d[1];return a[0]=h[0]*l+h[4]*d+h[12],a[1]=h[1]*l+h[5]*d+h[13],a},d.forEach=function(){var a=d.create();return function(d,h,l,g,e,c){h||(h=2);l||(l=0);for(g=g?Math.min(g*h+l,d.length):d.length;g>l;l+=h)a[0]=d[l],a[1]=d[l+1],e(a,a,c),d[l]=a[0],d[l+1]=a[1];return d}}(),d.str=function(a){return"vec2("+a[0]+", "+a[1]+")"},d})},
"esri/layers/vectorTiles/views/2d/math/common":function(){define([],function(){if(!h)var h=1E-6;if(!l)var l="undefined"!=typeof Float32Array?Float32Array:Array;if(!a)var a=Math.random;var d={GLMAT_EPSILON:h,GLMAT_ARRAY_TYPE:l,GLMAT_RANDOM:a,setMatrixArrayType:function(a){d.GLMAT_ARRAY_TYPE=a}},b=Math.PI/180,f=180/Math.PI;return d.toRadian=function(a){return a*b},d.toDegree=function(a){return a*f},d.setMatrixArrayType(Array),d})},"esri/layers/vectorTiles/views/2d/math/mat2d":function(){define(["./common"],
function(h){var l=h.GLMAT_ARRAY_TYPE;h={};return h.create=function(){var a=new l(6);return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},h.clone=function(a){var d=new l(6);return d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],d[4]=a[4],d[5]=a[5],d},h.copy=function(a,d){return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[4]=d[4],a[5]=d[5],a},h.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},h.invert=function(a,d){var b=d[0],f=d[1],h=d[2],l=d[3],g=d[4],e=d[5],c=b*l-f*h;return c?(c=1/c,
a[0]=l*c,a[1]=-f*c,a[2]=-h*c,a[3]=b*c,a[4]=(h*e-l*g)*c,a[5]=(f*g-b*e)*c,a):null},h.determinant=function(a){return a[0]*a[3]-a[1]*a[2]},h.multiply=function(a,d,b){var f=d[0],h=d[1],l=d[2],g=d[3],e=d[4];d=d[5];var c=b[0],n=b[1],q=b[2],r=b[3],u=b[4];b=b[5];return a[0]=f*c+l*n,a[1]=h*c+g*n,a[2]=f*q+l*r,a[3]=h*q+g*r,a[4]=f*u+l*b+e,a[5]=h*u+g*b+d,a},h.mul=h.multiply,h.rotate=function(a,d,b){var f=d[0],h=d[1],l=d[2],g=d[3],e=d[4];d=d[5];var c=Math.sin(b);b=Math.cos(b);return a[0]=f*b+l*c,a[1]=h*b+g*c,a[2]=
f*-c+l*b,a[3]=h*-c+g*b,a[4]=e,a[5]=d,a},h.scale=function(a,d,b){var f=d[1],h=d[2],l=d[3],g=d[4],e=d[5],c=b[0];b=b[1];return a[0]=d[0]*c,a[1]=f*c,a[2]=h*b,a[3]=l*b,a[4]=g,a[5]=e,a},h.translate=function(a,d,b){var f=d[0],h=d[1],l=d[2],g=d[3],e=d[4];d=d[5];var c=b[0];b=b[1];return a[0]=f,a[1]=h,a[2]=l,a[3]=g,a[4]=f*c+l*b+e,a[5]=h*c+g*b+d,a},h.fromRotation=function(a,d){var b=Math.sin(d),f=Math.cos(d);return a[0]=f,a[1]=b,a[2]=-b,a[3]=f,a[4]=0,a[5]=0,a},h.fromScaling=function(a,d){return a[0]=d[0],a[1]=
0,a[2]=0,a[3]=d[1],a[4]=0,a[5]=0,a},h.fromTranslation=function(a,d){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=d[0],a[5]=d[1],a},h.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"},h.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)},h})},"esri/layers/vectorTiles/views/2d/engine/webgl/BitBlitRenderer":function(){define("require exports dojo/text!./bitblit.vs.glsl dojo/text!./bitblit.fs.glsl ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject".split(" "),
function(h,l,a,d,b,f,k){return function(){function h(){this._initialized=!1}return h.prototype.render=function(a,b,c,d){a&&b&&(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),b.setSamplingMode(c),a.bindTexture(b,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",d),a.drawArrays(5,0,4),a.bindVAO())},h.prototype._initialize=function(g){if(this._initialized)return!0;var e={a_pos:0,
a_tex:1},c=new b(g,a,d,e);if(!c)return!1;var h=new Int8Array(16);h[0]=-1;h[1]=-1;h[2]=0;h[3]=0;h[4]=1;h[5]=-1;h[6]=1;h[7]=0;h[8]=-1;h[9]=1;h[10]=0;h[11]=1;h[12]=1;h[13]=1;h[14]=1;h[15]=1;g=new f(g,e,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:k.createVertex(g,35044,h)});return this._program=c,this._vertexArrayObject=g,this._initialized=!0,!0},h}()})},"esri/layers/vectorTiles/views/support/screenshotUtils":function(){define(["require",
"exports","dojo/_base/lang"],function(h,l,a){l.adjustScreenshotSettings=function(d,b){d=a.mixin({format:"png",quality:100},d||{});var f,h;d.includePadding?(f=b.width,h=b.height):(f=b.width-b.padding.left-b.padding.right,h=b.height-b.padding.top-b.padding.bottom);var l=f/h;return void 0!==d.width&&void 0===d.height?d.height=d.width/l:void 0!==d.height&&void 0===d.width&&(d.width=l*d.height),void 0!==d.height&&(d.height=Math.floor(d.height)),void 0!==d.width&&(d.width=Math.floor(d.width)),d.area||d.includePadding||
(d.area={x:b.padding.left,y:b.padding.top,width:f,height:h}),d};l.resampleHermite=function(a,b,f,h,l,g,e){void 0===e&&(e=!0);var c=b/l;f/=g;for(var n=Math.ceil(c/2),q=Math.ceil(f/2),r=0;g>r;r++)for(var u=0;l>u;u++){for(var v=4*(u+(e?g-r-1:r)*l),t=0,w=0,x=0,y=0,z=0,A=0,B=0,C=(r+.5)*f,D=Math.floor(r*f);(r+1)*f>D;D++)for(var E=Math.abs(C-(D+.5))/q,F=(u+.5)*c,E=E*E,H=Math.floor(u*c);(u+1)*c>H;H++){var G=Math.abs(F-(H+.5))/n,K=Math.sqrt(E+G*G);-1<=K&&1>=K&&(t=2*K*K*K-3*K*K+1,0<t&&(G=4*(H+D*b),B+=t*a[G+
3],x+=t,255>a[G+3]&&(t=t*a[G+3]/250),y+=t*a[G],z+=t*a[G+1],A+=t*a[G+2],w+=t))}h[v]=y/w;h[v+1]=z/w;h[v+2]=A/w;h[v+3]=B/x}}})},"esri/layers/vectorTiles/views/webgl/RenderingContext":function(){define(["require","exports","./enums","./Extensions"],function(h,l,a,d){return function(){function b(a,b){this.gl=null;this._extensions=void 0;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};
this._colorMaskState={r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=
1;this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680};this._lineWidth=1;this._clearColor={r:0,g:0,b:0,a:0};this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap={};this.gl=a;this._extensions=new d(a,b);var h=a.getParameter(a.VIEWPORT);this._viewport={x:h[0],y:h[1],width:h[2],height:h[3]};h=this.extensions.textureFilterAnisotropic;this._parameters={versionString:a.getParameter(a.VERSION),
maxVertexTextureImageUnits:a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:a.getParameter(a.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:h?a.getParameter(h.MAX_TEXTURE_MAX_ANISOTROPY_EXT):void 0,maxTextureImageUnits:a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS)};this.enforceState()}return Object.defineProperty(b.prototype,"extensions",{get:function(){return this._extensions},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},
enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"parameters",{get:function(){return this._parameters},enumerable:!0,configurable:!0}),b.prototype.setBlendingEnabled=function(a){this._blendEnabled!==a&&(!0===a?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=a)},b.prototype.setBlendColor=function(a,b,d,g){(a!==this._blendColorState.r||b!==this._blendColorState.g||d!==this._blendColorState.b||g!==this._blendColorState.a)&&(this.gl.blendColor(a,b,d,g),
this._blendColorState.r=a,this._blendColorState.g=b,this._blendColorState.b=d,this._blendColorState.a=g)},b.prototype.setBlendFunction=function(a,b){(a!==this._blendFunctionState.srcRGB||b!==this._blendFunctionState.dstRGB)&&(this.gl.blendFunc(a,b),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=a,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=b)},b.prototype.setBlendFunctionSeparate=function(a,b,d,g){(this._blendFunctionState.srcRGB!==a||this._blendFunctionState.srcAlpha!==
d||this._blendFunctionState.dstRGB!==b||this._blendFunctionState.dstAlpha!==g)&&(this.gl.blendFuncSeparate(a,b,d,g),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=d,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=g)},b.prototype.setBlendEquation=function(a){this._blendEquationState.mode!==a&&(this.gl.blendEquation(a),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=a)},b.prototype.setBlendEquationSeparate=function(a,b){(this._blendEquationState.mode!==
a||this._blendEquationState.modeAlpha!==b)&&(this.gl.blendEquationSeparate(a,b),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=b)},b.prototype.setColorMask=function(a,b,d,g){(this._colorMaskState.r!==a||this._colorMaskState.g!==b||this._colorMaskState.b!==d||this._colorMaskState.a!==g)&&(this.gl.colorMask(a,b,d,g),this._colorMaskState.r=a,this._colorMaskState.g=b,this._colorMaskState.b=d,this._colorMaskState.a=g)},b.prototype.setClearColor=function(a,b,d,g){(this._clearColor.r!==
a||this._clearColor.g!==b||this._clearColor.b!==d||this._clearColor.a!==g)&&(this.gl.clearColor(a,b,d,g),this._clearColor.r=a,this._clearColor.g=b,this._clearColor.b=d,this._clearColor.a=g)},b.prototype.setFaceCullingEnabled=function(a){this._polygonCullingEnabled!==a&&(!0===a?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=a)},b.prototype.setPolygonOffsetFillEnabled=function(a){this._polygonOffsetFillEnabled!==a&&(!0===a?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):
this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=a)},b.prototype.setPolygonOffset=function(a,b){this._polygonOffset[0]===a&&this._polygonOffset[1]===b||(this._polygonOffset[0]=a,this._polygonOffset[1]=b,this.gl.polygonOffset(a,b))},b.prototype.setCullFace=function(a){this._cullFace!==a&&(this.gl.cullFace(a),this._cullFace=a)},b.prototype.setFrontFace=function(a){this._frontFace!==a&&(this.gl.frontFace(a),this._frontFace=a)},b.prototype.setScissorTestEnabled=function(a){this._scissorTestEnabled!==
a&&(!0===a?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=a)},b.prototype.setScissorRect=function(a,b,d,g){(this._scissorRect.x!==a||this._scissorRect.y!==b||this._scissorRect.width!==d||this._scissorRect.height!==g)&&(this.gl.scissor(a,b,d,g),this._scissorRect.x=a,this._scissorRect.y=b,this._scissorRect.width=d,this._scissorRect.height=g)},b.prototype.setDepthTestEnabled=function(a){this._depthTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.DEPTH_TEST):
this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=a)},b.prototype.setClearDepth=function(a){this._clearDepth!==a&&(this.gl.clearDepth(a),this._clearDepth=a)},b.prototype.setDepthFunction=function(a){this._depthFunction!==a&&(this.gl.depthFunc(a),this._depthFunction=a)},b.prototype.setDepthWriteEnabled=function(a){this._depthWriteEnabled!==a&&(this.gl.depthMask(a),this._depthWriteEnabled=a)},b.prototype.setDepthRange=function(a,b){(this._depthRange.zNear!==a||this._depthRange.zFar!==b)&&(this.gl.depthRange(a,
b),this._depthRange.zNear=a,this._depthRange.zFar=b)},b.prototype.setStencilTestEnabled=function(a){this._stencilTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=a)},b.prototype.setClearStencil=function(a){a!==this._clearStencil&&(this.gl.clearStencil(a),this._clearStencil=a)},b.prototype.setStencilFunction=function(a,b,d){(this._stencilFunction.func!==a||this._stencilFunction.ref!==b||this._stencilFunction.mask!==d)&&(this.gl.stencilFunc(a,
b,d),this._stencilFunction.face=1032,this._stencilFunction.func=a,this._stencilFunction.ref=b,this._stencilFunction.mask=d)},b.prototype.setStencilFunctionSeparate=function(a,b,d,g){(this._stencilFunction.face!==a||this._stencilFunction.func!==b||this._stencilFunction.ref!==d||this._stencilFunction.mask!==g)&&(this.gl.stencilFuncSeparate(a,b,d,g),this._stencilFunction.face=a,this._stencilFunction.func=b,this._stencilFunction.ref=d,this._stencilFunction.mask=g)},b.prototype.setStencilWriteMask=function(a){this._stencilWriteMask!==
a&&(this.gl.stencilMask(a),this._stencilWriteMask=a)},b.prototype.setStencilOp=function(a,b,d){(this._stencilOperation.fail!==a||this._stencilOperation.zFail!==b||this._stencilOperation.zPass!==d)&&(this.gl.stencilOp(a,b,d),this._stencilOperation.face=1032,this._stencilOperation.fail=a,this._stencilOperation.zFail=b,this._stencilOperation.zPass=d)},b.prototype.setStencilOpSeparate=function(a,b,d,g){(this._stencilOperation.face!==a||this._stencilOperation.fail!==b||this._stencilOperation.zFail!==d||
this._stencilOperation.zPass!==g)&&(this.gl.stencilOpSeparate(a,b,d,g),this._stencilOperation.face=a,this._stencilOperation.face=a,this._stencilOperation.fail=b,this._stencilOperation.zFail=d,this._stencilOperation.zPass=g)},b.prototype.setLineWidth=function(a){var b=this._lineWidth;return this._lineWidth!==a&&(this.gl.lineWidth(a),this._lineWidth=a),b},b.prototype.setActiveTexture=function(b){var d=this._activeTextureUnit;return 0<=b&&b!==this._activeTextureUnit&&(this.gl.activeTexture(a.BASE_TEXTURE_UNIT+
b),this._activeTextureUnit=b),d},b.prototype.clear=function(a){a&&this.gl.clear(a)},b.prototype.drawArrays=function(a,b,d){this.gl.drawArrays(a,b,d)},b.prototype.drawElements=function(a,b,d,g){return 5123===d?void this.gl.drawElements(a,b,d,g):void(5125===d&&this._extensions.elementIndexUint?this.gl.drawElements(a,b,d,g):console.warn("Data type is uint however extension OES_Element_index_unit is not supported therefore this draw call cannot be made"))},b.prototype.drawArraysInstanced=function(a,b,
d,g){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawArraysInstancedANGLE(a,b,d,g):console.error("Extension ANGLE_instanced_arrays isn't supported!")},b.prototype.drawElementsInstanced=function(a,b,d,g,e){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawElementsInstancedANGLE(a,b,d,g,e):console.error("Extension ANGLE_instanced_arrays isn't supported!")},b.prototype.setViewport=function(a,b,d,g){var e=this._viewport;e.x===a&&e.y===b&&e.width===
d&&e.height===g||(e.x=a,e.y=b,e.width=d,e.height=g,this.gl.viewport(a,b,d,g))},b.prototype.getViewport=function(){return this._viewport},b.prototype.bindProgram=function(a){return a?void(this._activeShaderProgram!==a&&(a.initialize(),this.gl.useProgram(a.glName),this._activeShaderProgram=a)):(this.gl.useProgram(null),void(this._activeShaderProgram=null))},b.prototype.bindTexture=function(a,d){void 0===d&&(d=0);-1===b._MAX_TEXTURE_IMAGE_UNITS&&(b._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));
(d>=b._MAX_TEXTURE_IMAGE_UNITS||0>d)&&console.error("Input texture unit is out of range of available units!");var h=this._textureUnitMap[d];return this.setActiveTexture(d),null==a?(null!=h&&this.gl.bindTexture(h.descriptor.target,null),void(this._textureUnitMap[d]=null)):h&&h.id===a.id?void a.applyChanges():(this.gl.bindTexture(a.descriptor.target,a.glName),a.applyChanges(),void(this._textureUnitMap[d]=a))},b.prototype.bindFramebuffer=function(a){return a?void(this._activeFramebuffer!==a&&(a.initialize()||
this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.glName),this._activeFramebuffer=a)):(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),void(this._activeFramebuffer=null))},b.prototype.bindBuffer=function(a){a&&(34962===a.bufferType?this._activeVertexBuffer=b._bindBuffer(this.gl,a,a.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=b._bindBuffer(this.gl,a,a.bufferType,this._activeIndexBuffer))},b.prototype.unbindBuffer=function(a){34962===a?this._activeVertexBuffer=b._bindBuffer(this.gl,null,
a,this._activeVertexBuffer):this._activeIndexBuffer=b._bindBuffer(this.gl,null,a,this._activeIndexBuffer)},b.prototype.bindVAO=function(a){return a?void(this._activeVertexArrayObject&&this._activeVertexArrayObject.id===a.id||(a.bind(),this._activeVertexArrayObject=a)):void(this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null))},b.prototype.getBoundTexture=function(a){return this._textureUnitMap[a]},b.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer},
b.prototype.getBoundVAO=function(){return this._activeVertexArrayObject},b.prototype.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);this.unbindBuffer(34963);for(var a=0;a<this.parameters.maxTextureImageUnits;a++)this.bindTexture(null,a);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);
this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,
this.gl.canvas.height)},b.prototype.enforceState=function(){var b=this.gl,d=this._extensions.vao;d&&d.bindVertexArrayOES(null);for(var h=0;h<this.parameters.maxVertexAttributes;h++)b.disableVertexAttribArray(h);if(this._activeVertexBuffer?b.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):b.bindBuffer(34962,null),this._activeIndexBuffer?b.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):b.bindBuffer(34963,null),d&&this._activeVertexArrayObject)(d=
this._activeVertexArrayObject)&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null),this.bindVAO(d);b.bindFramebuffer(b.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:null);b.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);b.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);!0===this._blendEnabled?b.enable(this.gl.BLEND):b.disable(this.gl.BLEND);b.blendEquationSeparate(this._blendEquationState.mode,
this._blendEquationState.modeAlpha);b.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);b.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);b.clearDepth(this._clearDepth);b.clearStencil(this._clearStencil);b.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);b.cullFace(this._cullFace);b.depthFunc(this._depthFunction);
b.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST);b.depthMask(this._depthWriteEnabled);b.frontFace(this._frontFace);b.lineWidth(this._lineWidth);!0===this._polygonCullingEnabled?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE);b.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?b.enable(b.POLYGON_OFFSET_FILL):b.disable(b.POLYGON_OFFSET_FILL);b.scissor(this._scissorRect.x,
this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?b.enable(b.SCISSOR_TEST):b.disable(b.SCISSOR_TEST);b.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask);b.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST);b.stencilMask(this._stencilWriteMask);for(d=
0;d<this.parameters.maxTextureImageUnits;d++)b.activeTexture(a.BASE_TEXTURE_UNIT+d),b.bindTexture(3553,null),(h=this._textureUnitMap[d])&&b.bindTexture(h.descriptor.target,h.glName);b.activeTexture(a.BASE_TEXTURE_UNIT+this._activeTextureUnit);b.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)},b._bindBuffer=function(a,b,d,g){return b?g===b?g:(a.bindBuffer(d,b.glName),b):(a.bindBuffer(d,null),null)},b._MAX_TEXTURE_IMAGE_UNITS=-1,b}()})},"esri/layers/vectorTiles/views/webgl/enums":function(){define(["require",
"exports"],function(h,l){l.BASE_TEXTURE_UNIT=33984})},"esri/layers/vectorTiles/views/webgl/Extensions":function(){define(["require","exports"],function(h,l){return function(){function a(a,b){if(this._vaoInit=!1,this._angleInstancedArraysInit=!1,this._standardDerivativesInit=!1,this._elementIndexUintInit=!1,this._depthTextureInit=!1,this._textureFilterAnisotropicInit=!1,this._shaderTextureLODInit=!1,this._compressedTextureS3TCInit=!1,this._gl=a,b&&b.disabledExtensions){var f=b.disabledExtensions;f.vao&&
(this._vao=null,this._vaoInit=!0);f.angleInstancedArrays&&(this._angleInstancedArrays=null,this._angleInstancedArraysInit=!0);f.standardDerivatives&&(this._standardDerivatives=null,this._standardDerivativesInit=!0);f.elementIndexUint&&(this._elementIndexUint=null,this._elementIndexUintInit=!0);f.depthTexture&&(this._depthTexture=null,this._depthTextureInit=!0);f.textureFilterAnisotropic&&(this._textureFilterAnisotropic=null,this._textureFilterAnisotropicInit=!0);f.compressedTextureS3TC&&(this._compressedTextureS3TC=
null,this._compressedTextureS3TCInit=!0);f.shaderTextureLOD&&(this._shaderTextureLOD=null,this._shaderTextureLODInit=!0)}}return Object.defineProperty(a.prototype,"vao",{get:function(){return this._vaoInit||(this._vao=this._gl.getExtension("OES_vertex_array_object")||this._gl.getExtension("MOZ_OES_vertex_array_object")||this._gl.getExtension("WEBKIT_OES_vertex_array_object"),this._vaoInit=!0),this._vao},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"angleInstancedArrays",{get:function(){return this._angleInstancedArraysInit||
(this._angleInstancedArrays=this._gl.getExtension("ANGLE_instanced_arrays"),this._angleInstancedArraysInit=!0),this._angleInstancedArrays},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"standardDerivatives",{get:function(){return this._standardDerivativesInit||(this._standardDerivatives=this._gl.getExtension("OES_standard_derivatives"),this._standardDerivativesInit=!0),this._standardDerivatives},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"elementIndexUint",
{get:function(){return this._elementIndexUintInit||(this._elementIndexUint=this._gl.getExtension("OES_element_index_uint"),this._elementIndexUintInit=!0),this._elementIndexUint},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"depthTexture",{get:function(){return this._depthTextureInit||(this._depthTexture=this._gl.getExtension("WEBGL_depth_texture")||this._gl.getExtension("MOZ_WEBGL_depth_texture")||this._gl.getExtension("WEBKIT_WEBGL_depth_texture"),this._depthTextureInit=!0),
this._depthTexture},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"textureFilterAnisotropic",{get:function(){return this._textureFilterAnisotropicInit||(this._textureFilterAnisotropic=this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this._textureFilterAnisotropicInit=!0),this._textureFilterAnisotropic},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,
"shaderTextureLOD",{get:function(){return this._shaderTextureLODInit||(this._shaderTextureLOD=this._gl.getExtension("EXT_shader_texture_lod"),this._shaderTextureLODInit=!0),this._shaderTextureLOD},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"compressedTextureS3TC",{get:function(){return this._compressedTextureS3TCInit||(this._compressedTextureS3TC=this._gl.getExtension("WEBGL_compressed_texture_s3tc"),this._compressedTextureS3TCInit=!0),this._compressedTextureS3TC},enumerable:!0,
configurable:!0}),a}()})},"esri/layers/vectorTiles/views/webgl/FramebufferObject":function(){define(["require","exports","./Texture"],function(h,l,a){return function(){function d(b,f,h,l){if(this._context=null,this._glName=null,this._depthAttachment=null,this._stencilAttachment=null,this._colorAttachment=null,this._initialized=!1,this._context=b,this._desc={colorTarget:f.colorTarget,depthStencilTarget:f.depthStencilTarget,width:f.width,height:f.height,multisampled:f.multisampled},this._id=d._nextId++,
h)b=void 0,h instanceof a?(this._colorAttachment=h,b=h.descriptor):(b=h,this._colorAttachment=new a(this._context,b)),0!==this._desc.colorTarget&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),d._validateTextureDimensions(b,this._desc);l&&(this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),
h=void 0,l instanceof a?(this._depthStencilTexture=l,h=this._depthStencilTexture.descriptor):(h=l,this._depthStencilTexture=new a(this._context,h)),d._validateTextureDimensions(h,this._desc))}return d.create=function(a,f){return new d(a,f)},d.createWithAttachments=function(a,f,h,l){return new d(a,h,f,l)},Object.defineProperty(d.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"glName",{get:function(){return this._glName},enumerable:!0,
configurable:!0}),Object.defineProperty(d.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"colorTexture",{get:function(){return this._colorAttachment instanceof a?this._colorAttachment:null},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"width",{get:function(){return this._desc.width},
enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"height",{get:function(){return this._desc.height},enumerable:!0,configurable:!0}),d.prototype.dispose=function(){this._context&&this._glName&&(this._disposeColorAttachment(),this._disposeDepthStencilAttachments(),this._context.gl.deleteFramebuffer(this._glName),this._glName=null)},d.prototype.attachColorTexture=function(a){if(a){if(d._validateTextureDimensions(a.descriptor,this._desc),this._disposeColorAttachment(),this._initialized){this._context.bindFramebuffer(this);
var f=this._context.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,a.glName,0)}this._colorAttachment=a}},d.prototype.detachColorTexture=function(){var b=void 0;if(this._colorAttachment instanceof a){if(b=this._colorAttachment,this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;this._context.gl.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,null,0)}this._colorAttachment=null}return b},d.prototype.attachDepthStencilTexture=function(a){if(a){var f=
a.descriptor;if(34041!==f.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!"),34042!==f.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8_WEBGL!"),this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!"),d._validateTextureDimensions(f,this._desc),4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4),
this._disposeDepthStencilAttachments(),this._initialized)this._context.bindFramebuffer(this),f=this._context.gl,f.framebufferTexture2D(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.TEXTURE_2D,a.glName,0);this._depthStencilTexture=a}},d.prototype.detachDepthStencilTexture=function(){var a=this._depthStencilTexture;if(a&&this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;this._context.gl.framebufferTexture2D(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.TEXTURE_2D,null,0)}return this._depthStencilTexture=
null,a},d.prototype.copyToTexture=function(a,d,h,l,g,e,c){(0>a||0>d||0>g||0>e)&&console.error("Offsets cannot be negative!");(0>=h||0>=l)&&console.error("Copy width and height must be greater than zero!");var n=this._desc,q=c.descriptor;3553!==c.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");(a+h>n.width||d+l>n.height||g+h>q.width||e+l>q.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");n=this._context;n.bindTexture(c);
n.bindFramebuffer(this);n.gl.copyTexSubImage2D(3553,0,g,e,a,d,h,l)},d.prototype.readPixels=function(a,d,h,l,g,e,c){(0>=h||0>=l)&&console.error("Copy width and height must be greater than zero!");c||console.error("Target memory is not initialized!");this._context.bindFramebuffer(this);this._context.gl.readPixels(a,d,h,l,g,e,c)},d.prototype.resize=function(b,f){var h=this._desc;if(h.width!==b||h.height!==f){if(!this._initialized){if(h.width=b,h.height=f,this._colorAttachment instanceof a)h=this._colorAttachment,
h.resize(b,f);return void(this._depthStencilTexture&&this._depthStencilTexture.resize(b,f))}if(h.width=b,h.height=f,this._colorAttachment instanceof a){var h=this._colorAttachment,l=h.descriptor;l.width=b;l.height=f;this._colorAttachment=new a(this._context,l);d._validateTextureDimensions(h.descriptor,this._desc)}else this._colorAttachment=null;null!=this._depthStencilTexture&&(l=this._depthStencilTexture.descriptor,l.width=b,l.height=f,this._depthStencilTexture=new a(this._context,l));this._initialized=
!1}},d.prototype.initialize=function(){if(this._initialized)return!1;var b=this._context.gl,d=b.createFramebuffer(),h=this._desc;if(b.bindFramebuffer(b.FRAMEBUFFER,d),!this._colorAttachment)if(0===h.colorTarget)this._colorAttachment=new a(this._context,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:h.width,height:h.height});else{var l=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,l);b.renderbufferStorage(b.RENDERBUFFER,b.RGBA4,h.width,h.height);b.framebufferRenderbuffer(b.FRAMEBUFFER,
b.COLOR_ATTACHMENT0,b.RENDERBUFFER,l);this._colorAttachment=l}this._colorAttachment instanceof a&&b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,this._colorAttachment.glName,0);switch(h.depthStencilTarget){case 1:case 3:l=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,l);var g=1===h.depthStencilTarget?b.DEPTH_ATTACHMENT:b.DEPTH_STENCIL_ATTACHMENT;b.renderbufferStorage(b.RENDERBUFFER,1===h.depthStencilTarget?b.DEPTH_COMPONENT16:b.DEPTH_STENCIL,h.width,h.height);b.framebufferRenderbuffer(b.FRAMEBUFFER,
g,b.RENDERBUFFER,l);this._depthAttachment=l;break;case 2:l=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,l);b.renderbufferStorage(b.RENDERBUFFER,b.STENCIL_INDEX8,h.width,h.height);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.STENCIL_ATTACHMENT,b.RENDERBUFFER,l);this._stencilAttachment=l;break;case 4:this._depthStencilTexture||(this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),
this._depthStencilTexture=new a(this._context,{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:h.width,height:h.height})),b.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,this._depthStencilTexture.glName,0)}return b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!"),this._glName=d,this._initialized=!0,!0},d.prototype._disposeColorAttachment=function(){if(this._colorAttachment instanceof
a){var b=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,null,0)}b.dispose()}else this._colorAttachment instanceof WebGLRenderbuffer&&(b=this._colorAttachment,d=this._context.gl,this._initialized&&(this._context.bindFramebuffer(this),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(b));this._colorAttachment=
null},d.prototype._disposeDepthStencilAttachments=function(){var a=this._context.gl;if(this._depthAttachment){if(this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,1===this._desc.depthStencilTarget?d.DEPTH_ATTACHMENT:d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,null)}a.deleteRenderbuffer(this._depthAttachment);this._depthAttachment=null}this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),d=this._context.gl,
d.framebufferRenderbuffer(d.FRAMEBUFFER,d.STENCIL_ATTACHMENT,d.RENDERBUFFER,null)),a.deleteRenderbuffer(this._stencilAttachment),this._stencilAttachment=null);this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),a=this._context.gl,a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)},d._validateTextureDimensions=function(a,d){3553!==a.target&&console.error("Texture type must be TEXTURE_2D!");
void 0!==d.width&&0<=d.width&&void 0!==d.height&&0<=d.height?(d.width!==a.width||d.height!==a.height)&&console.error("Color attachment texture must match the framebuffer's!"):(d.width=a.width,d.height=a.height)},d._nextId=0,d}()})},"esri/layers/vectorTiles/views/webgl/webgl-utils":function(){define([],function(){var h=function(a,b){for(var f=["webgl","experimental-webgl","webkit-3d","moz-webgl"],h=null,l=0;l<f.length;++l){try{h=a.getContext(f[l],b)}catch(g){}if(h)break}return h},l=(window.requestAnimationFrame||
window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){return window.setTimeout(a,1E3/60)}).bind(window),a=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout).bind(window);return{create3DContext:h,setupWebGL:function(a,b){function f(b){var f=a.parentNode;f&&(f.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+
b+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}if(!window.WebGLRenderingContext)return f('This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),[null,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'];var k=h(a,b);return k?[k]:(f('It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'),
[null,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'])},detectWebGL:function(){var a;try{a=window.WebGLRenderingContext}catch(b){a=[!1,0]}var f;try{f=h(document.createElement("canvas"))}catch(k){f=[!1,1]}a?f?(a=f,a=[!0,{VERSION:a.getParameter(a.VERSION),SHADING_LANGUAGE_VERSION:a.getParameter(a.SHADING_LANGUAGE_VERSION),VENDOR:a.getParameter(a.VENDOR),RENDERER:a.getParameter(a.RENDERER),
EXTENSIONS:a.getSupportedExtensions(),MAX_TEXTURE_SIZE:a.getParameter(a.MAX_TEXTURE_SIZE),MAX_RENDERBUFFER_SIZE:a.getParameter(a.MAX_RENDERBUFFER_SIZE),MAX_VERTEX_TEXTURE_IMAGE_UNITS:a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}]):a=[!1,1]:a=[!1,0];return a},requestAnimFrame:l,cancelAnimFrame:a}})},"esri/layers/vectorTiles/views/2d/FrameBudget":function(){define(["require","exports","../../core/now"],function(h,l,a){return function(){function d(a){void 0===a&&(a=Number.MAX_VALUE);this._budget=
this._begin=0;this.enabled=!0;this.reset(a)}return d.now=function(){return a()},Object.defineProperty(d.prototype,"done",{get:function(){return this.enabled&&this.elapsed>=this._budget},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"elapsed",{get:function(){return a()-this._begin},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"remaining",{get:function(){return Math.max(this._budget-this.elapsed,0)},enumerable:!0,configurable:!0}),d.prototype.reset=function(b){void 0===
b&&(b=Number.MAX_VALUE);this._begin=a();this._budget=this.enabled?b:Number.MAX_VALUE},d}()})},"esri/layers/vectorTiles/views/2d/layers/support/TileInfoView":function(){define("require exports ./LODInfo ./TileKey ./TileSpan ./TileCoverage".split(" "),function(h,l,a,d,b,f){var k=function(){function a(b,c,d,f,g,h,k,l){this.x=b;this.ymin=c;this.ymax=d;this.invM=f;this.leftAdjust=g;this.rightAdjust=h;this.leftBound=k;this.rightBound=l}return a.create=function(b,c){b[1]>c[1]&&(d=[c,b],b=d[0],c=d[1]);var d=
b[0],f=b[1],h=c[0],k=c[1],l=h-d,m=k-f,m=0!==m?l/m:0,w=(Math.ceil(f)-f)*m,x=(Math.floor(f)-f)*m;return new a(d,Math.floor(f),Math.ceil(k),m,0>l?w:x,0>l?x:w,0>l?h:d,0>l?d:h);var d},a.prototype.incrRow=function(){this.x+=this.invM},a.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)},a.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)},a}(),m=[[0,0],[0,0],[0,0],[0,0]];return function(){function g(b,c){var d=this;this.scales=
[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var f=b.lods.slice();f.sort(function(a,b){return b.scale-a.scale});var g=this._lodInfos=f.map(function(d){return a.create(b,d,c)});f.forEach(function(a,b){d._infoByLevel[a.level]=g[b];d._infoByScale[a.scale]=g[b];d.scales[b]=a.scale},this);this._wrap=b.spatialReference.isWrappable}return g.prototype.getTileTopLeft=function(a,b){var d=this._infoByLevel[b.level];return d?d.getTileTopLeft(a,b):a},g.prototype.getTileBottomRight=function(a,
b){var d=this._infoByLevel[b.level];return d?d.getTileBottomRight(a,b):a},g.prototype.getTileResolution=function(a){return(a=this._infoByLevel[a.level])?a.resolution:-1},g.prototype.getTileParentId=function(a){a=d.from(a);var b=this._lodInfos.indexOf(this._infoByLevel[a.level])-1;return 0>b?null:this.getTileIdAtParent(this._lodInfos[b],a)},g.prototype.getTileIdAtParent=function(a,b){var f=d.from(b),g=this._infoByLevel[f.level];if(a.resolution<g.resolution)throw Error("Cannot calculate parent tile. destination LOD's resolution "+
a.resolution+" is not a parent resolution of "+g.resolution);return a.resolution===g.resolution?f.id:d.getId(a.level,Math.floor(f.row*g.resolution/a.resolution+.01),Math.floor(f.col*g.resolution/a.resolution+.01),f.world)},g.prototype.getTileCoverage=function(a){var c,d,g,h=this.getClosestInfoForScale(a.scale),l=this._wrap;c=+(1/0);var v=-(1/0),t=[];m[0][0]=m[0][1]=m[1][1]=m[3][0]=0;m[1][0]=m[2][0]=a.size[0];m[2][1]=m[3][1]=a.size[1];for(var w=m.map(function(b){return a.toMap(b,b),b[0]=h.getColumnForX(b[0]),
b[1]=h.getRowForY(b[1]),b}),x=[],y=3,z=0;4>z;z++)w[z][1]!==w[y][1]&&(y=k.create(w[z],w[y]),c=Math.min(y.ymin,c),v=Math.max(y.ymax,v),void 0===x[y.ymin]&&(x[y.ymin]=[]),x[y.ymin].push(y)),y=z;if(null==c||null==v||100<v-c)return null;for(w=[];v>c;){null!=x[c]&&(w=w.concat(x[c]));d=+(1/0);g=-(1/0);for(z=w.length-1;0<=z;z--)y=w[z],d=Math.min(d,y.getLeftCol()),g=Math.max(g,y.getRightCol());if(d=Math.floor(d),g=Math.floor(g),c>=h.first[1]&&c<=h.last[1])if(l)if(h.size[0]<h.worldSize[0])for(z=Math.floor(d/
h.worldSize[0]),y=Math.floor(g/h.worldSize[0]);y>=z;z++)t.push(new b(c,Math.max(h.getFirstColumnForWorld(z),d),Math.min(h.getLastColumnForWorld(z),g)));else t.push(new b(c,d,g));else d>h.last[0]||g<h.first[0]||(d=Math.max(d,h.first[0]),g=Math.min(g,h.last[0]),t.push(new b(c,d,g)));c+=1;for(z=w.length-1;0<=z;z--)y=w[z],y.ymax>=c?y.incrRow():w.splice(z,1)}return new f(h,t)},g.prototype.intersects=function(a,b){var f=d.from(b),g=this._infoByLevel[f.level],h=a.lodInfo;if(h.resolution>g.resolution){var k=
d.fromId(this.getTileIdAtParent(h,f)),l=h.denormalizeCol(k.col,k.world);return a.spans.some(function(a){return a.row===k.row&&a.colFrom<=l&&a.colTo>=l})}if(h.resolution<g.resolution){var m=a.spans.reduce(function(a,b){return a[0]=Math.min(a[0],b.row),a[1]=Math.max(a[1],b.row),a[2]=Math.min(a[2],b.colFrom),a[3]=Math.max(a[3],b.colTo),a},[+(1/0),-(1/0),+(1/0),-(1/0)]),w=m[0],x=m[1],y=m[2],m=m[3],z=g.denormalizeCol(f.col,f.world),A=h.getColumnForX(g.getXForColumn(z)),B=h.getRowForY(g.getYForRow(f.row)),
z=h.getColumnForX(g.getXForColumn(z+1))-1,g=h.getRowForY(g.getYForRow(f.row+1))-1;return!(A>m||y>z||B>x||w>g)}var C=h.denormalizeCol(f.col,f.world);return a.spans.some(function(a){return a.row===f.row&&a.colFrom<=C&&a.colTo>=C})},g.prototype.getClosestInfoForScale=function(a){var b=this.scales;return this._infoByScale[a]?this._infoByScale[a]:(a=b.reduce(function(b,c,d,f){return Math.abs(c-a)<Math.abs(b-a)?c:b},b[0]),this._infoByScale[a])},g}()})},"esri/layers/vectorTiles/views/2d/layers/support/LODInfo":function(){define(["require",
"exports","./TileKey","../../../../geometry/support/spatialReferenceUtils"],function(h,l,a,d){function b(a,b,d){return a[0]=b,a[1]=d,a}return function(){function f(a,b,d,e,c,f,h,l,u,v,t){this.level=a;this.resolution=b;this.origin=d;this.first=e;this.last=c;this.size=f;this.norm=h;this.worldStart=l;this.worldEnd=u;this.worldSize=v;this.wrap=t}return f.create=function(a,h,g){var e=d.getInfo(a.spatialReference),c=[a.origin.x,a.origin.y],l=[a.size[0]*h.resolution,a.size[1]*h.resolution],q=[-(1/0),-(1/
0)],r=[+(1/0),+(1/0)],u=[+(1/0),+(1/0)];g&&(b(q,Math.max(0,Math.floor((g.xmin-c[0])/l[0])),Math.max(0,Math.floor((c[1]-g.ymax)/l[1]))),b(r,Math.max(0,Math.floor((g.xmax-c[0])/l[0])),Math.max(0,Math.floor((c[1]-g.ymin)/l[1]))),b(u,r[0]-q[0]+1,r[1]-q[1]+1));var v;e?(a=[Math.ceil(Math.round(2*e.origin[1]/h.resolution)/a.size[0]),u[1]],e=[Math.floor((e.origin[0]-c[0])/l[0]),q[1]],g=[a[0]-e[0]-1,r[1]],v=!0):(e=q,g=r,a=u,v=!1);return new f(h.level,h.resolution,c,q,r,u,l,e,g,a,v)},f.prototype.normalizeCol=
function(a){if(!this.wrap)return a;var b=this.worldSize[0];return 0>a?b-1-Math.abs((a+1)%b):a%b},f.prototype.denormalizeCol=function(a,b){return this.wrap?this.worldSize[0]*b+a:a},f.prototype.getWorldForColumn=function(a){return this.wrap?Math.floor(a/this.worldSize[0]):0},f.prototype.getFirstColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]},f.prototype.getLastColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]+this.size[0]-1},f.prototype.getColumnForX=function(a){return(a-
this.origin[0])/this.norm[0]},f.prototype.getXForColumn=function(a){return this.origin[0]+a*this.norm[0]},f.prototype.getRowForY=function(a){return(this.origin[1]-a)/this.norm[1]},f.prototype.getYForRow=function(a){return this.origin[1]-a*this.norm[1]},f.prototype.getTileTopLeft=function(d,f){var g=a.from(f);return b(d,this.getXForColumn(this.denormalizeCol(g.col,g.world)),this.getYForRow(g.row))},f.prototype.getTileBottomRight=function(d,f){var g=a.from(f);return b(d,this.getXForColumn(this.denormalizeCol(g.col,
g.world)+1),this.getYForRow(g.row+1))},f}()})},"esri/layers/vectorTiles/geometry/support/spatialReferenceUtils":function(){define(["require","exports","./WKIDUnitConversion"],function(h,l,a){l.isGeographic=function(b){return b.wkid?null==a[b.wkid]:b.wkt?/^\s*GEOGCS/i.test(b.wkt):!1};l.getInfo=function(a){return a.wkid?d[a.wkid]:null};h=[-2.0037508342788905E7,2.0037508342788905E7];l=[-2.0037508342787E7,2.0037508342787E7];var d={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:h,origin:l,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:h,origin:l,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:h,origin:l,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:h,origin:l,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}}})},"esri/layers/vectorTiles/geometry/support/WKIDUnitConversion":function(){define([],function(){var h,l={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5E4,15E4],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,
2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,
3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,
3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,
3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,
5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,
6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,
6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,
6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,
6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,
7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,
7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,
26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53034:0,
53048:0,53049:0,54034:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,
103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,
103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,
103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,
103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103695:2};for(h=2E3;2045>=h;h++)l[h]=0;for(h=2056;2065>=h;h++)l[h]=0;for(h=2067;2135>=h;h++)l[h]=0;for(h=2137;2154>=h;h++)l[h]=0;for(h=2161;2170>=h;h++)l[h]=0;for(h=2172;2193>=h;h++)l[h]=0;for(h=2195;2198>=h;h++)l[h]=0;for(h=2200;2203>=h;h++)l[h]=0;for(h=2205;2217>=h;h++)l[h]=0;for(h=2222;2224>=h;h++)l[h]=1;for(h=2225;2250>=h;h++)l[h]=
2;for(h=2251;2253>=h;h++)l[h]=1;for(h=2257;2264>=h;h++)l[h]=2;for(h=2274;2279>=h;h++)l[h]=2;for(h=2280;2282>=h;h++)l[h]=1;for(h=2283;2289>=h;h++)l[h]=2;for(h=2290;2292>=h;h++)l[h]=0;for(h=2308;2313>=h;h++)l[h]=0;for(h=2315;2491>=h;h++)l[h]=0;for(h=2494;2866>=h;h++)l[h]=0;for(h=2867;2869>=h;h++)l[h]=1;for(h=2870;2888>=h;h++)l[h]=2;for(h=2891;2895>=h;h++)l[h]=2;for(h=2896;2898>=h;h++)l[h]=1;for(h=2902;2908>=h;h++)l[h]=2;for(h=2915;2920>=h;h++)l[h]=2;for(h=2921;2923>=h;h++)l[h]=1;for(h=2924;2930>=h;h++)l[h]=
2;for(h=2931;2962>=h;h++)l[h]=0;for(h=2964;2968>=h;h++)l[h]=2;for(h=2969;2973>=h;h++)l[h]=0;for(h=2975;2991>=h;h++)l[h]=0;for(h=2995;3051>=h;h++)l[h]=0;for(h=3054;3079>=h;h++)l[h]=0;for(h=3081;3088>=h;h++)l[h]=0;for(h=3092;3101>=h;h++)l[h]=0;for(h=3106;3138>=h;h++)l[h]=0;for(h=3146;3151>=h;h++)l[h]=0;for(h=3153;3166>=h;h++)l[h]=0;for(h=3168;3172>=h;h++)l[h]=0;for(h=3174;3203>=h;h++)l[h]=0;for(h=3294;3358>=h;h++)l[h]=0;for(h=3367;3403>=h;h++)l[h]=0;for(h=3408;3416>=h;h++)l[h]=0;for(h=3417;3438>=h;h++)l[h]=
2;for(h=3441;3446>=h;h++)l[h]=2;for(h=3447;3450>=h;h++)l[h]=0;for(h=3451;3459>=h;h++)l[h]=2;for(h=3460;3478>=h;h++)l[h]=0;for(h=3554;3559>=h;h++)l[h]=0;for(h=3560;3570>=h;h++)l[h]=2;for(h=3571;3581>=h;h++)l[h]=0;for(h=3594;3597>=h;h++)l[h]=0;for(h=3601;3604>=h;h++)l[h]=0;for(h=3637;3639>=h;h++)l[h]=0;for(h=3665;3667>=h;h++)l[h]=0;for(h=3693;3695>=h;h++)l[h]=0;for(h=3701;3727>=h;h++)l[h]=0;for(h=3728;3739>=h;h++)l[h]=2;for(h=3740;3751>=h;h++)l[h]=0;for(h=3753;3760>=h;h++)l[h]=2;for(h=3761;3773>=h;h++)l[h]=
0;for(h=3775;3777>=h;h++)l[h]=0;for(h=3779;3781>=h;h++)l[h]=0;for(h=3783;3785>=h;h++)l[h]=0;for(h=3788;3791>=h;h++)l[h]=0;for(h=3797;3802>=h;h++)l[h]=0;for(h=3814;3816>=h;h++)l[h]=0;for(h=3825;3829>=h;h++)l[h]=0;for(h=3832;3841>=h;h++)l[h]=0;for(h=3844;3852>=h;h++)l[h]=0;for(h=3873;3885>=h;h++)l[h]=0;for(h=3890;3893>=h;h++)l[h]=0;for(h=3907;3912>=h;h++)l[h]=0;for(h=3942;3950>=h;h++)l[h]=0;for(h=3968;3970>=h;h++)l[h]=0;for(h=3973;3976>=h;h++)l[h]=0;for(h=3986;3989>=h;h++)l[h]=0;for(h=3994;3997>=h;h++)l[h]=
0;for(h=4048;4051>=h;h++)l[h]=0;for(h=4056;4063>=h;h++)l[h]=0;for(h=4093;4096>=h;h++)l[h]=0;for(h=4390;4398>=h;h++)l[h]=0;for(h=4399;4413>=h;h++)l[h]=2;for(h=4418;4433>=h;h++)l[h]=2;for(h=4455;4457>=h;h++)l[h]=2;for(h=4484;4489>=h;h++)l[h]=0;for(h=4491;4554>=h;h++)l[h]=0;for(h=4568;4589>=h;h++)l[h]=0;for(h=4652;4656>=h;h++)l[h]=0;for(h=4766;4800>=h;h++)l[h]=0;for(h=5014;5016>=h;h++)l[h]=0;for(h=5069;5072>=h;h++)l[h]=0;for(h=5105;5130>=h;h++)l[h]=0;for(h=5173;5188>=h;h++)l[h]=0;for(h=5253;5259>=h;h++)l[h]=
0;for(h=5269;5275>=h;h++)l[h]=0;for(h=5292;5311>=h;h++)l[h]=0;for(h=5329;5331>=h;h++)l[h]=0;for(h=5343;5349>=h;h++)l[h]=0;for(h=5355;5357>=h;h++)l[h]=0;for(h=5387;5389>=h;h++)l[h]=0;for(h=5459;5463>=h;h++)l[h]=0;for(h=5479;5482>=h;h++)l[h]=0;for(h=5518;5520>=h;h++)l[h]=0;for(h=5530;5539>=h;h++)l[h]=0;for(h=5550;5552>=h;h++)l[h]=0;for(h=5562;5583>=h;h++)l[h]=0;for(h=5623;5625>=h;h++)l[h]=2;for(h=5631;5639>=h;h++)l[h]=0;for(h=5649;5653>=h;h++)l[h]=0;for(h=5663;5680>=h;h++)l[h]=0;for(h=5682;5685>=h;h++)l[h]=
0;for(h=5875;5877>=h;h++)l[h]=0;for(h=5921;5940>=h;h++)l[h]=0;for(h=6050;6125>=h;h++)l[h]=0;for(h=6244;6275>=h;h++)l[h]=0;for(h=6328;6348>=h;h++)l[h]=0;for(h=6350;6356>=h;h++)l[h]=0;for(h=6366;6372>=h;h++)l[h]=0;for(h=6381;6387>=h;h++)l[h]=0;for(h=6393;6404>=h;h++)l[h]=0;for(h=6480;6483>=h;h++)l[h]=0;for(h=6511;6514>=h;h++)l[h]=0;for(h=6579;6581>=h;h++)l[h]=0;for(h=6619;6624>=h;h++)l[h]=0;for(h=6625;6627>=h;h++)l[h]=2;for(h=6628;6632>=h;h++)l[h]=0;for(h=6634;6637>=h;h++)l[h]=0;for(h=6669;6692>=h;h++)l[h]=
0;for(h=6707;6709>=h;h++)l[h]=0;for(h=6720;6723>=h;h++)l[h]=0;for(h=6732;6738>=h;h++)l[h]=0;for(h=6931;6933>=h;h++)l[h]=0;for(h=6956;6959>=h;h++)l[h]=0;for(h=7005;7007>=h;h++)l[h]=0;for(h=7057;7070>=h;h++)l[h]=2;for(h=7074;7082>=h;h++)l[h]=0;for(h=7109;7118>=h;h++)l[h]=0;for(h=7119;7127>=h;h++)l[h]=1;for(h=7374;7376>=h;h++)l[h]=0;for(h=7528;7586>=h;h++)l[h]=0;for(h=7587;7645>=h;h++)l[h]=2;for(h=7845;7859>=h;h++)l[h]=0;for(h=20002;20032>=h;h++)l[h]=0;for(h=20062;20092>=h;h++)l[h]=0;for(h=20135;20138>=
h;h++)l[h]=0;for(h=20248;20258>=h;h++)l[h]=0;for(h=20348;20358>=h;h++)l[h]=0;for(h=20436;20440>=h;h++)l[h]=0;for(h=20822;20824>=h;h++)l[h]=0;for(h=20934;20936>=h;h++)l[h]=0;for(h=21035;21037>=h;h++)l[h]=0;for(h=21095;21097>=h;h++)l[h]=0;for(h=21148;21150>=h;h++)l[h]=0;for(h=21413;21423>=h;h++)l[h]=0;for(h=21473;21483>=h;h++)l[h]=0;for(h=21780;21782>=h;h++)l[h]=0;for(h=21891;21894>=h;h++)l[h]=0;for(h=21896;21899>=h;h++)l[h]=0;for(h=22171;22177>=h;h++)l[h]=0;for(h=22181;22187>=h;h++)l[h]=0;for(h=22191;22197>=
h;h++)l[h]=0;for(h=22234;22236>=h;h++)l[h]=0;for(h=22521;22525>=h;h++)l[h]=0;for(h=22991;22994>=h;h++)l[h]=0;for(h=23028;23038>=h;h++)l[h]=0;for(h=23830;23853>=h;h++)l[h]=0;for(h=23866;23872>=h;h++)l[h]=0;for(h=23877;23884>=h;h++)l[h]=0;for(h=23886;23894>=h;h++)l[h]=0;for(h=23946;23948>=h;h++)l[h]=0;for(h=24311;24313>=h;h++)l[h]=0;for(h=24342;24347>=h;h++)l[h]=0;for(h=24370;24374>=h;h++)l[h]=10;for(h=24375;24381>=h;h++)l[h]=0;for(h=24718;24721>=h;h++)l[h]=0;for(h=24817;24821>=h;h++)l[h]=0;for(h=24877;24882>=
h;h++)l[h]=0;for(h=24891;24893>=h;h++)l[h]=0;for(h=25391;25395>=h;h++)l[h]=0;for(h=25828;25838>=h;h++)l[h]=0;for(h=26191;26195>=h;h++)l[h]=0;for(h=26391;26393>=h;h++)l[h]=0;for(h=26701;26722>=h;h++)l[h]=0;for(h=26729;26799>=h;h++)l[h]=2;for(h=26801;26803>=h;h++)l[h]=2;for(h=26811;26813>=h;h++)l[h]=2;for(h=26847;26870>=h;h++)l[h]=2;for(h=26891;26899>=h;h++)l[h]=0;for(h=26901;26923>=h;h++)l[h]=0;for(h=26929;26946>=h;h++)l[h]=0;for(h=26948;26998>=h;h++)l[h]=0;for(h=27037;27040>=h;h++)l[h]=0;for(h=27205;27232>=
h;h++)l[h]=0;for(h=27258;27260>=h;h++)l[h]=0;for(h=27391;27398>=h;h++)l[h]=0;for(h=27561;27564>=h;h++)l[h]=0;for(h=27571;27574>=h;h++)l[h]=0;for(h=27581;27584>=h;h++)l[h]=0;for(h=27591;27594>=h;h++)l[h]=0;for(h=28191;28193>=h;h++)l[h]=0;for(h=28348;28358>=h;h++)l[h]=0;for(h=28402;28432>=h;h++)l[h]=0;for(h=28462;28492>=h;h++)l[h]=0;for(h=29118;29122>=h;h++)l[h]=0;for(h=29168;29172>=h;h++)l[h]=0;for(h=29177;29185>=h;h++)l[h]=0;for(h=29187;29195>=h;h++)l[h]=0;for(h=29900;29903>=h;h++)l[h]=0;for(h=30161;30179>=
h;h++)l[h]=0;for(h=30491;30494>=h;h++)l[h]=0;for(h=30729;30732>=h;h++)l[h]=0;for(h=31251;31259>=h;h++)l[h]=0;for(h=31265;31268>=h;h++)l[h]=0;for(h=31275;31279>=h;h++)l[h]=0;for(h=31281;31297>=h;h++)l[h]=0;for(h=31461;31469>=h;h++)l[h]=0;for(h=31491;31495>=h;h++)l[h]=0;for(h=31917;31922>=h;h++)l[h]=0;for(h=31965;32E3>=h;h++)l[h]=0;for(h=32001;32003>=h;h++)l[h]=2;for(h=32005;32031>=h;h++)l[h]=2;for(h=32033;32060>=h;h++)l[h]=2;for(h=32064;32067>=h;h++)l[h]=2;for(h=32074;32077>=h;h++)l[h]=2;for(h=32081;32086>=
h;h++)l[h]=0;for(h=32107;32130>=h;h++)l[h]=0;for(h=32133;32158>=h;h++)l[h]=0;for(h=32164;32167>=h;h++)l[h]=2;for(h=32180;32199>=h;h++)l[h]=0;for(h=32201;32260>=h;h++)l[h]=0;for(h=32301;32360>=h;h++)l[h]=0;for(h=32601;32662>=h;h++)l[h]=0;for(h=32664;32667>=h;h++)l[h]=2;for(h=32701;32761>=h;h++)l[h]=0;for(h=53001;53004>=h;h++)l[h]=0;for(h=53008;53019>=h;h++)l[h]=0;for(h=53021;53032>=h;h++)l[h]=0;for(h=53042;53046>=h;h++)l[h]=0;for(h=53074;53080>=h;h++)l[h]=0;for(h=54001;54004>=h;h++)l[h]=0;for(h=54008;54019>=
h;h++)l[h]=0;for(h=54021;54032>=h;h++)l[h]=0;for(h=54042;54046>=h;h++)l[h]=0;for(h=54048;54053>=h;h++)l[h]=0;for(h=54074;54080>=h;h++)l[h]=0;for(h=102001;102040>=h;h++)l[h]=0;for(h=102042;102063>=h;h++)l[h]=0;for(h=102065;102067>=h;h++)l[h]=0;for(h=102070;102117>=h;h++)l[h]=0;for(h=102122;102216>=h;h++)l[h]=0;for(h=102221;102377>=h;h++)l[h]=0;for(h=102382;102388>=h;h++)l[h]=0;for(h=102389;102398>=h;h++)l[h]=2;for(h=102399;102444>=h;h++)l[h]=0;for(h=102445;102447>=h;h++)l[h]=2;for(h=102448;102458>=
h;h++)l[h]=0;for(h=102459;102468>=h;h++)l[h]=2;for(h=102469;102496>=h;h++)l[h]=0;for(h=102500;102519>=h;h++)l[h]=1;for(h=102520;102524>=h;h++)l[h]=0;for(h=102525;102529>=h;h++)l[h]=2;for(h=102530;102561>=h;h++)l[h]=0;for(h=102570;102588>=h;h++)l[h]=0;for(h=102590;102598>=h;h++)l[h]=0;for(h=102601;102603>=h;h++)l[h]=0;for(h=102605;102628>=h;h++)l[h]=0;for(h=102629;102646>=h;h++)l[h]=2;for(h=102648;102700>=h;h++)l[h]=2;for(h=102701;102703>=h;h++)l[h]=0;for(h=102707;102730>=h;h++)l[h]=2;for(h=102733;102758>=
h;h++)l[h]=2;for(h=102767;102798>=h;h++)l[h]=0;for(h=102965;102969>=h;h++)l[h]=0;for(h=102971;102973>=h;h++)l[h]=0;for(h=102975;102989>=h;h++)l[h]=0;for(h=102990;102992>=h;h++)l[h]=1;for(h=102997;103002>=h;h++)l[h]=0;for(h=103003;103008>=h;h++)l[h]=2;for(h=103009;103011>=h;h++)l[h]=0;for(h=103012;103014>=h;h++)l[h]=2;for(h=103019;103021>=h;h++)l[h]=0;for(h=103022;103024>=h;h++)l[h]=2;for(h=103029;103031>=h;h++)l[h]=0;for(h=103032;103034>=h;h++)l[h]=2;for(h=103065;103068>=h;h++)l[h]=0;for(h=103074;103076>=
h;h++)l[h]=0;for(h=103077;103079>=h;h++)l[h]=1;for(h=103080;103082>=h;h++)l[h]=0;for(h=103083;103085>=h;h++)l[h]=2;for(h=103090;103093>=h;h++)l[h]=0;for(h=103097;103099>=h;h++)l[h]=0;for(h=103100;103102>=h;h++)l[h]=2;for(h=103107;103109>=h;h++)l[h]=0;for(h=103110;103112>=h;h++)l[h]=2;for(h=103113;103116>=h;h++)l[h]=0;for(h=103117;103120>=h;h++)l[h]=2;for(h=103153;103157>=h;h++)l[h]=0;for(h=103158;103162>=h;h++)l[h]=2;for(h=103163;103165>=h;h++)l[h]=0;for(h=103166;103168>=h;h++)l[h]=1;for(h=103169;103171>=
h;h++)l[h]=2;for(h=103186;103188>=h;h++)l[h]=0;for(h=103189;103191>=h;h++)l[h]=2;for(h=103192;103195>=h;h++)l[h]=0;for(h=103196;103199>=h;h++)l[h]=2;for(h=103200;103224>=h;h++)l[h]=0;for(h=103225;103227>=h;h++)l[h]=1;for(h=103232;103237>=h;h++)l[h]=0;for(h=103238;103243>=h;h++)l[h]=2;for(h=103244;103246>=h;h++)l[h]=0;for(h=103247;103249>=h;h++)l[h]=2;for(h=103254;103256>=h;h++)l[h]=0;for(h=103257;103259>=h;h++)l[h]=2;for(h=103264;103266>=h;h++)l[h]=0;for(h=103267;103269>=h;h++)l[h]=2;for(h=103300;103375>=
h;h++)l[h]=0;for(h=103381;103383>=h;h++)l[h]=0;for(h=103384;103386>=h;h++)l[h]=1;for(h=103387;103389>=h;h++)l[h]=0;for(h=103390;103392>=h;h++)l[h]=2;for(h=103397;103399>=h;h++)l[h]=0;for(h=103400;103471>=h;h++)l[h]=2;for(h=103476;103478>=h;h++)l[h]=0;for(h=103479;103481>=h;h++)l[h]=2;for(h=103486;103488>=h;h++)l[h]=0;for(h=103489;103491>=h;h++)l[h]=2;for(h=103492;103495>=h;h++)l[h]=0;for(h=103496;103499>=h;h++)l[h]=2;for(h=103528;103543>=h;h++)l[h]=0;for(h=103544;103548>=h;h++)l[h]=2;for(h=103549;103551>=
h;h++)l[h]=0;for(h=103552;103554>=h;h++)l[h]=1;for(h=103555;103557>=h;h++)l[h]=2;for(h=103558;103560>=h;h++)l[h]=0;for(h=103571;103573>=h;h++)l[h]=0;for(h=103574;103576>=h;h++)l[h]=2;for(h=103577;103580>=h;h++)l[h]=0;for(h=103581;103583>=h;h++)l[h]=2;for(h=103600;103694>=h;h++)l[h]=0;for(h=103700;103793>=h;h++)l[h]=2;for(h=103794;103871>=h;h++)l[h]=0;for(h=103900;103971>=h;h++)l[h]=2;return l})},"esri/layers/vectorTiles/views/2d/layers/support/TileSpan":function(){define(["require","exports"],function(h,
l){return function(){return function(a,d,b){this.row=a;this.colFrom=d;this.colTo=b}}()})},"esri/layers/vectorTiles/views/2d/layers/support/TileCoverage":function(){define(["require","exports"],function(h,l){return function(){return function(a,d){this.lodInfo=a;this.spans=d}}()})},"esri/layers/vectorTiles/views/2d/layers/support/TileStrategy":function(){define(["require","exports","../../../../core/LRUCache","./TileKey"],function(h,l,a,d){function b(a,b){a["delete"](b)}var f=[],k=[],m=[null,null],
g=[],e=new a(30);return function(){function a(b,c,d,e,f){void 0===f&&(f=null);this.container=b;this.tileInfoView=c;this.requestUpdate=d;this.fetchTile=e;this.tileFilter=f;this._tiles=new Map;this._tilesToRender=new Map;this._requests=new Map;this._updates=new Map;this._prevResolution=Number.POSITIVE_INFINITY;this._isStationary=!1}return a.prototype.destroy=function(){this._requests&&(this._requests.forEach(function(a){a.isFulfilled()||a.cancel()}),this._requests=null,this._tilesToRender=null)},Object.defineProperty(a.prototype,
"updating",{get:function(){return 0!==this._requests.size||0!==this._updates.size},enumerable:!0,configurable:!0}),a.prototype.update=function(a){var c=this,h=this._tiles,k=this._tilesToRender,l=this._requests,m=this._updates,w=this.tileInfoView.getTileCoverage(a.state);if(w){var x=w.lodInfo.level,y=a.state.resolution>this._prevResolution;this._createCoverageList(f,w);var z=this.tileFilter?this.tileFilter([],f):f;k.clear();for(var A=0,B=0;B<z.length;B++){var C=z[B];if(h.has(C)){var D=h.get(C);(k.set(C,
D),A++,D.attached)||y||this._addParentTile(C,k)}else e.has(C)?A++:l.has(C)||this._getTile(C,a),y||this._addParentTile(C,k)}var E=A===z.length;!this._isStationary&&a.stationary&&this.requestUpdate();this._isStationary=a.stationary;var F,H=[],G=[];h.forEach(function(a,b){F=d.from(b);k.has(b)||(!y&&E||!c.tileInfoView.intersects(w,F)?(F.level>x||!c.tileInfoView.intersects(w,F))&&H.push(b):G.push(b))});for(D=0;D<G.length;D++)C=G[D],k.set(C,h.get(C));for(a=0;a<H.length;a++)C=H[a],m.has(C)&&(m.get(C).cancel(C),
b(m,C)),D=h.get(C),D.dispose(),b(h,C);this.container.removeAllChildren();k.forEach(function(a){return c.container.addChild(a)});l.forEach(function(a,b){F=d.from(b);(F.level>x||!c.tileInfoView.intersects(w,F))&&(a.cancel(),g.push(b))});for(h=0;h<g.length;h++)C=g[h],b(l,C);g.length=0}},a.prototype.updateTiles=function(a,c){var d=this;this._tilesToRender.forEach(function(e,f){if(e.attached){var g=a(e,c);g&&(d._updates.has(f)&&(d._updates.get(f).cancel(),b(d._updates,f)),g.then(function(a){b(d._updates,
f);d._tilesToRender.has(f)&&d._tilesToRender.set(f,a)}).otherwise(function(a){if(b(d._updates,f),a&&"cancel"!==a.dojoType)throw a;}),d._updates.set(f,g))}})},a.prototype._addParentTile=function(a,b){this._getAvailableParentTile(m,a);m[0]&&!b.has(m[0])&&b.set(m[0],m[1])},a.prototype._getTile=function(a,c){var f=this,g=this.fetchTile(a,c).then(function(c){var e=d.fromId(a);f.tileInfoView.getTileTopLeft(c.topLeft,e);f.tileInfoView.getTileBottomRight(c.bottomRight,e);c.resolution=f.tileInfoView.getTileResolution(e);
f._tiles.set(a,c);b(f._requests,a);f.requestUpdate()}).otherwise(function(c){c&&"no data"===c.message&&e.insert(a,a);b(f._requests,a)});this._requests.set(a,g)},a.prototype._getAvailableParentTile=function(a,b){a[0]=null;a[1]=null;for(var c=b;c=this.tileInfoView.getTileParentId(c);)if(this._tiles.has(c)){a[0]=c;a[1]=this._tiles.get(c);break}return a},a.prototype._createCoverageList=function(a,b){a.length=0;k.length=0;var c=b.spans;if(0!==c.length){for(var e=0,f=0,g=1/0,h=-(1/0),e=c[0].row,f=c[c.length-
1].row,l=0;l<c.length;l++)for(var m=c[l],z=m.colFrom,m=m.colTo;m>=z;z++)g=Math.min(g,z),h=Math.max(h,z);var A,l=b.lodInfo,z=l.level,f=e+Math.floor((f-e)/2),g=g+Math.floor((h-g)/2),m=f-e;0<=m&&m<c.length&&(A=d.from(z,f,l.normalizeCol(g),l.getWorldForColumn(g)),k.push({dist:0,id:A.id}));for(var B,h=0;h<c.length;h++)for(m=c[h],e=m.row,z=m.colFrom,m=m.colTo;m>=z;z++)B=Math.abs(z-g)+Math.abs(e-f),0!==B&&(A.row=e,A.col=l.normalizeCol(z),A.world=l.getWorldForColumn(z),k.push({dist:B,id:A.id}));k.sort(function(a,
b){return a.dist-b.dist});for(c=0;c<k.length;c++)a.push(k[c].id)}},a}()})},"esri/layers/vectorTiles/core/LRUCache":function(){define(["require","exports"],function(h,l){return function(){function a(a){if(this._cache={},this._lruQueue=[],0>=a)throw Error("LRU cache size must be bigger than zero!");this._maxSize=a}return a.prototype.has=function(a){return void 0!==this._cache[a]},a.prototype.insert=function(a,b){return null!==this.use(a)?void(this._cache[a]=b):(this._collect(),this._cache[a]=b,void this._lruQueue.unshift(a))},
a.prototype.use=function(a){var b=this._cache[a];return b?(this._lruQueue.splice(this._lruQueue.indexOf(a),1),this._lruQueue.unshift(a),b):null},a.prototype.print=function(){for(var a=0,b=this._lruQueue;a<b.length;a++);},a.prototype._collect=function(){if(!(this._lruQueue.length<this._maxSize)){var a=this._lruQueue.pop(),b=this._cache[a];b&&b.dispose&&b.dispose();delete this._cache[a]}},a}()})},"dgrid/util/touch":function(){define(["dojo/on","dojo/query"],function(h,l){function a(a,f,k,l){if(!(1<
k.targetTouches.length)){var g=k.changedTouches[0],e=g.screenX,c=g.screenY;l&&k.preventDefault();var n=h(a,"touchend",function(a){var b=a.changedTouches[0];a.targetTouches.length||(Math.abs(b.screenX-e)<d.tapRadius&&Math.abs(b.screenY-c)<d.tapRadius&&(l&&a.preventDefault(),f.call(this,a)),n.remove())})}}var d={tapRadius:10,dbltapTime:250,selector:function(a,d,k){return function(m,g){var e=d.bubble;e?d=e:!1!==k&&(k=!0);return h(m,d,function(c){var d=c.target;3==d.nodeType&&(d=d.parentNode);for(;!l.matches(d,
a,m);)if(d==m||!k||!(d=d.parentNode))return;return g.call(d,c)})}},countCurrentTouches:function(a,d){if(!("touches"in a))return-1;var h,l,g;for(l=h=0;g=a.touches[h];++h)d.contains(g.target)&&++l;return l},tap:function(b,d){return h(b,"touchstart",function(h){a(b,d,h)})},dbltap:function(b,f){var k,l;return h(b,"touchstart",function(g){k?a(b,function(a){if(k){var b=a.changedTouches[0];Math.abs(b.screenX-k.screenX)<d.tapRadius&&Math.abs(b.screenY-k.screenY)<d.tapRadius&&(l&&clearTimeout(l),k=l=null,
f.call(this,a))}},g,!0):a(b,function(a){k=a.changedTouches[0];l=setTimeout(function(){k=l=null},d.dbltapTime)},g)})}};return d})},"dgrid/TouchScroll":function(){define("dojo/_base/declare dojo/on ./util/touch ./util/has-css3 put-selector/put xstyle/css!./css/TouchScroll.css".split(" "),function(h,l,a,d,b){function f(a,b,c,d){d=a.touchNode;var e=r[a.id],f,g,h;"object"!==typeof b?(h=b,b=c,c=g=!0):(c="x"in b,g="y"in b,c&&g||(f=a.getScrollPosition()),h=c?b.x:f.x,b=g?b.y:f.y);d.style[B]=C+-h+"px,"+-b+
"px"+D;e&&c&&a._scrollbarXNode&&(a._scrollbarXNode.style[B]=C+h*e.parentWidth/e.scrollWidth+"px,0"+D);e&&g&&a._scrollbarYNode&&(a._scrollbarYNode.style[B]=C+"0,"+b*e.parentHeight/e.scrollHeight+"px"+D);l.emit(a.touchNode.parentNode,"scroll",{scrollLeft:h,scrollTop:b})}function k(a){return r[a.id]?t.exec(window.getComputedStyle(a.touchNode)[B]):v.exec(a.touchNode.style[B])}function m(a){var c=this.widget,c=[this.node,c._scrollbarXNode,c._scrollbarYNode],d=c.length;this.timer&&(clearTimeout(this.timer),
this.timer=null);for(this.transitionHandler&&this.transitionHandler.remove();d--;)c[d]&&(c[d].style[A+"Duration"]="0");a&&a.preserveScrollbars||b(this.node.parentNode,".touchscroll-fadeout");delete this.resetEffects}function g(b){var c=b.widget,d=c.touchNode,e=c.id,f=0,g=0,h;if(a.countCurrentTouches(b,d)===c.touchesToScroll){if(h=k(c))f=+h[1],g=+h[2];if(h=r[e])h.resetEffects&&h.resetEffects({preserveScrollbars:!0}),d.style[B]=C+f+"px,"+g+"px"+D,u[e]=h;b=b.targetTouches[0];h=r[e]={widget:c,node:d,
startX:f-b.pageX,startY:g-b.pageY,lastX:f,lastY:g,pageX:b.pageX,pageY:b.pageY,tickFunc:function(){var a=r[e],b,c;a&&(b=a.node,(c=v.exec(b.style[B]))?(b=+c[1],c=+c[2],a.velX=b-a.lastX,a.velY=c-a.lastY,a.lastX=b,a.lastY=c):a.lastX=a.lastY=0,a.timer=setTimeout(a.tickFunc,50))}};h.timer=setTimeout(h.tickFunc,50)}}function e(c){var d=c.widget,e=d.id,g=d.touchesToScroll,h=r[e],k,l;if(h&&(k=a.countCurrentTouches(c,d.touchNode))===g){k=c.targetTouches;g=k[0];if(!h.scrollbarsShown&&(u[e]||Math.abs(g.pageX-
h.pageX)>d.scrollThreshold||Math.abs(g.pageY-h.pageY)>d.scrollThreshold)){var e=d.touchNode,m=e.parentNode,n=m.offsetWidth-8,q=m.offsetHeight-8,t=h.scrollWidth=e.scrollWidth,v=h.scrollHeight=e.scrollHeight,w=h.parentWidth=m.offsetWidth,x=h.parentHeight=m.offsetHeight;t>w?(d._scrollbarXNode||(l=b(m,"div.touchscroll-x")),l=d._scrollbarXNode=d._scrollbarXNode||b(l,"div.touchscroll-bar"),l.style.width=n*n/t+"px",l.style.left=e.offsetLeft+"px",b(m,".touchscroll-scrollable-x"),h.scrollableX=!0):b(m,"!touchscroll-scrollable-x");
v>x?(d._scrollbarYNode||(l=b(m,"div.touchscroll-y")),l=d._scrollbarYNode=d._scrollbarYNode||b(l,"div.touchscroll-bar"),l.style.height=q*q/v+"px",l.style.top=e.offsetTop+"px",b(m,".touchscroll-scrollable-y"),h.scrollableY=!0):b(m,"!touchscroll-scrollable-y");b(m,"!touchscroll-fadeout");h.scrollbarsShown=!0;for(l=k.length;l--;)k[l].touchScrolled=!0}h.scrollbarsShown&&(h.scrollableX||h.scrollableY)&&(c.preventDefault(),c=h.scrollableX?h.startX+g.pageX:0,g=h.scrollableY?h.startY+g.pageY:0,l=h.scrollableX?
-(h.scrollWidth-h.parentWidth):0,h=h.scrollableY?-(h.scrollHeight-h.parentHeight):0,0<c?c/=2:c<l&&(c=l-(l-c)/2),0<g?g/=2:g<h&&(g=h-(h-g)/2),f(d,-c,-g))}else k>g&&d.cancelTouchScroll()}function c(b){var c=b.widget,d=c.id;r[d]&&a.countCurrentTouches(b,c.touchNode)==c.touchesToScroll-1&&q(d)}function n(a,b,c){function d(){delete e.transitionHandler;e.resetEffects();delete r[a]}var e=r[a],f=e.widget,g=e.node,h=e.scrollableX?Math.max(Math.min(0,b),-(e.scrollWidth-e.parentWidth)):b,k=e.scrollableY?Math.max(Math.min(0,
c),-(e.scrollHeight-e.parentHeight)):c;delete e.timer;h!=b||k!=c?(e.transitionHandler=l.once(g,x,d),g.style[A+"Duration"]=f.bounceDuration+"ms",g.style[B]=C+h+"px,"+k+"px"+D,h!=b&&e.scrollableX&&(g=e.widget._scrollbarXNode,g.style[A+"Duration"]=f.bounceDuration+"ms",g.style[B]=b>h?C+"0,0"+D:C+(g.parentNode.offsetWidth-g.offsetWidth)+"px,0"+D),k!=c&&e.scrollableY&&(g=e.widget._scrollbarYNode,g.style[A+"Duration"]=f.bounceDuration+"ms",g.style[B]=c>k?C+"0,0"+D:C+"0,"+(g.parentNode.offsetHeight-g.offsetHeight)+
"px"+D)):d()}function q(a){var b=r[a],c=u[a],d,e;delete u[a];b.timer&&clearTimeout(b.timer);b.resetEffects=m;(d=v.exec(b.node.style[B]))?(e=+d[1],d=+d[2]):e=d=0;!b.velX&&!b.velY||(0<=e||e<=-(b.scrollWidth-b.parentWidth))&&(0<=d||d<=-(b.scrollHeight-b.parentHeight))?n(a,e,d):(c&&(c.velX||c.velY)&&(0>=b.velX&&0>=c.velX||0<=b.velX&&0<=c.velX)&&(0>=b.velY&&0>=c.velY||0<=b.velY&&0<=c.velY)&&(b.velX=1.15*(b.velX+c.velX),b.velY=1.15*(b.velY+c.velY)),b.lastX=e,b.lastY=d,b.calcFunc=function(){var b=r[a],c,
d,e,g,h,k;if(b)if(c=b.widget,h=c.glideDecel(b.velX),k=c.glideDecel(b.velY),1<=Math.abs(h)||1<=Math.abs(k)){e=b.lastX+h;g=b.lastY+k;if(0<e||e<-(b.scrollWidth-b.parentWidth))for(d=6;d--;)h=c.glideDecel(h);if(0<g||g<-(b.scrollHeight-b.parentHeight))for(d=6;d--;)k=c.glideDecel(k);f(c,-e,-g);b.lastX=e;b.lastY=g;b.velX=h;b.velY=k;b.timer=setTimeout(b.calcFunc,30)}else n(a,b.lastX,b.lastY)},b.timer=setTimeout(b.calcFunc,30))}var r={},u={},v=/^translate(?:3d)?\((-?\d+)(?:\.\d*)?(?:px)?, (-?\d+)/,t=/^matrix\(1, 0, 0, 1, (-?\d+)(?:\.\d*)?(?:px)?, (-?\d+)/,
w=d("css-transitions"),x=d("transitionend"),y=d("css-transforms");d=d("css-transforms3d");var z,A,B,C,D;d?(C="translate3d(",D=",0)"):y&&(C="translate(",D=")");if(!w||!C)return console.warn("CSS3 features unavailable for touch scroll effects."),function(){};B=d||y;B=!0===B?"transform":B+"Transform";A=!0===w?"transition":w+"Transition";z=!0===y?"":"-"+y.toLowerCase()+"-";return h("dgrid.TouchScroll",null,{touchesToScroll:1,touchNode:null,scrollThreshold:10,bounceDuration:300,postCreate:function(){this._initTouch();
this.inherited(arguments)},_initTouch:function(){function a(){f.cancelTouchScroll()}function b(c){return function(b){b.widget=f;b.cancelTouchScroll=a;c.call(this,b)}}var d=this.touchNode=this.touchNode||this.containerNode,f=this,h;d&&d.parentNode?(h=d.parentNode,h.style.overflow="hidden",d.style[A+"Property"]=z+"transform",d.style[A+"TimingFunction"]="cubic-bezier(0.33, 0.66, 0.66, 1)",this._touchScrollListeners=[l(h,"touchstart",b(g)),l(h,"touchmove",b(e)),l(h,"touchend,touchcancel",b(c))]):console.warn("TouchScroll requires a nested node upon which to operate.")},
destroy:function(){for(var a=this._touchScrollListeners.length;a--;)this._touchScrollListeners[a].remove();delete r[this.id];this.inherited(arguments)},scrollTo:function(a){var b=r[this.id],c=this.touchNode,d=c.parentNode;!a.preserveMomentum&&b&&b.resetEffects&&b.resetEffects();a.x&&(a.x=Math.max(0,Math.min(a.x,c.scrollWidth-d.offsetWidth)));a.y&&(a.y=Math.max(0,Math.min(a.y,c.scrollHeight-d.offsetHeight)));f(this,a)},getScrollPosition:function(){var a=k(this);return a?{x:-a[1],y:-a[2]}:{x:0,y:0}},
cancelTouchScroll:function(){var a=r[this.id];a&&(a.resetEffects?a.resetEffects():(a.timer&&clearTimeout(a.timer),b(a.node.parentNode,".touchscroll-fadeout")),delete r[this.id])},glideDecel:function(a){return.9*a}})})},"dgrid/util/has-css3":function(){define(["dojo/has"],function(h){function l(d,b){var f=d.style,h;if(b in f)return!0;b=b.slice(0,1).toUpperCase()+b.slice(1);for(h=a.length;h--;)if(a[h]+b in f)return a[h];return!1}var a=["ms","O","Moz","Webkit"];h.add("css-transitions",function(a,b,f){return l(f,
"transitionProperty")});h.add("css-transforms",function(a,b,f){return l(f,"transform")});h.add("css-transforms3d",function(a,b,f){return l(f,"perspective")});h.add("transitionend",function(){var a=h("css-transitions");return a?!0===a?"transitionend":{ms:"MSTransitionEnd",O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[a]:!1});return h})},"url:cmv/viewer/js/viewer/templates/mapOverlay.html":'\x3cdiv style\x3d"position:absolute;bottom:0;left:0;z-index:40;"\x3e\n    \x3cdiv id\x3d"mapInfoDijit"\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n\x3cdiv style\x3d"position:absolute;top:20px;right:20px;z-index:40;"\x3e\n    \x3cdiv id\x3d"basemapsDijit"\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n\x3cdiv style\x3d"position:absolute;top:60px;right:20px;z-index:40;width:250px;"\x3e\n    \x3cdiv id\x3d"growlerDijit"\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n\x3cdiv style\x3d"position: absolute;left:19px;top:94px;z-index:40;"\x3e\n    \x3cdiv id\x3d"homeButton"\x3e\n    \x3c/div\x3e\n    \x3cdiv id\x3d"locateButton"\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n\x3cdiv style\x3d"position:absolute;top:20px;left:64px;z-index:40;"\x3e\n    \x3cdiv id\x3d"geocoderButton"\x3e\n    \x3c/div\x3e\n\x3c/div\x3e',
"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\n\t\t\x3c/span\x3e\n\t\x3c/div\x3e\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\n\t${!actionBarTemplate}\n\x3c/div\x3e\n\n',
"url:dijit/form/templates/Button.html":'\x3cspan class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" role\x3d"presentation"\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\n\t\t\t\tid\x3d"${id}_label"\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\n\t\t\t\x3e\x3c/span\n\t\t\x3e\x3c/span\n\t\x3e\x3c/span\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen"\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\n\t\ttabIndex\x3d"-1" aria-hidden\x3d"true" data-dojo-attach-point\x3d"valueNode"\n/\x3e\x3c/span\x3e\n',
"url:dijit/form/templates/TextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"presentation"\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',"url:dijit/templates/Tooltip.html":'\x3cdiv class\x3d"dijitTooltip dijitTooltipLeft" id\x3d"dojoTooltip" data-dojo-attach-event\x3d"mouseenter:onMouseEnter,mouseleave:onMouseLeave"\n\t\x3e\x3cdiv class\x3d"dijitTooltipConnector" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitTooltipContainer dijitTooltipContents" data-dojo-attach-point\x3d"containerNode" role\x3d\'alert\'\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"url:dijit/form/templates/ValidationTextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tid\x3d"widget_${id}" role\x3d"presentation"\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\n\t   cellspacing\x3d"0"\x3e\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\n\x3c/table\x3e\n',"url:dijit/templates/TitlePane.html":'\x3cdiv\x3e\n\t\x3cdiv data-dojo-attach-event\x3d"ondijitclick:_onTitleClick, onkeydown:_onTitleKey"\n\t\t\tclass\x3d"dijitTitlePaneTitle" data-dojo-attach-point\x3d"titleBarNode" id\x3d"${id}_titleBarNode"\x3e\n\t\t\x3cdiv class\x3d"dijitTitlePaneTitleFocus" data-dojo-attach-point\x3d"focusNode"\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"arrowNode" class\x3d"dijitInline dijitArrowNode" role\x3d"presentation"\x3e\x3c/span\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"arrowNodeInner" class\x3d"dijitArrowNodeInner"\x3e\x3c/span\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitTitlePaneTextNode"\x3e\x3c/span\x3e\n\t\t\x3c/div\x3e\n\t\x3c/div\x3e\n\t\x3cdiv class\x3d"dijitTitlePaneContentOuter" data-dojo-attach-point\x3d"hideNode" role\x3d"presentation"\x3e\n\t\t\x3cdiv class\x3d"dijitReset" data-dojo-attach-point\x3d"wipeNode" role\x3d"presentation"\x3e\n\t\t\t\x3cdiv class\x3d"dijitTitlePaneContentInner" data-dojo-attach-point\x3d"containerNode" role\x3d"region" id\x3d"${id}_pane" aria-labelledby\x3d"${id}_titleBarNode"\x3e\n\t\t\t\t\x3c!-- nested divs because wipeIn()/wipeOut() doesn\'t work right on node w/padding etc.  Put padding on inner div. --\x3e\n\t\t\t\x3c/div\x3e\n\t\t\x3c/div\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e\n',
"url:dojox/layout/resources/ResizeHandle.css":{},"url:cmv/viewer/js/gis/dijit/FloatingTitlePane/css/FloatingTitlePane.css":{},"url:app/css/main.css":{},"url:cmv/viewer/js/gis/dijit/LayerControl/css/LayerControl.css":{},"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\n\t\t\x3c/span\x3e\n\t\x3c/td\x3e\n\x3c/tr\x3e\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\n\t\x3c/td\x3e\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\n\t\x3c/td\x3e\n\x3c/tr\x3e\n',
"url:dijit/templates/TooltipDialog.html":'\x3cdiv role\x3d"alertdialog" tabIndex\x3d"-1"\x3e\n\t\x3cdiv class\x3d"dijitTooltipContainer" role\x3d"presentation"\x3e\n\t\t\x3cdiv data-dojo-attach-point\x3d"contentsNode" class\x3d"dijitTooltipContents dijitTooltipFocusNode"\x3e\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\n\t\t\t${!actionBarTemplate}\n\t\t\x3c/div\x3e\n\t\x3c/div\x3e\n\t\x3cdiv class\x3d"dijitTooltipConnector" role\x3d"presentation" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\x3e\n\x3c/div\x3e\n',
"url:dijit/form/templates/HorizontalSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown, onkeyup:_onKeyUp"\n\trole\x3d"presentation"\n\t\x3e\x3ctr class\x3d"dijitReset"\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\x3e\x3c/tr\n\t\x3e\x3ctr class\x3d"dijitReset"\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset"\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\n\t\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitSliderBarContainerH" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" data-dojo-attach-event\x3d"press:_onBarClick"\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\n\t\t\t\t\t\x3e\x3c/div\n\t\t\t\t\x3e\x3c/div\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c/div\n\t\t\t\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\x3e\x3c/tr\n\t\x3e\x3ctr class\x3d"dijitReset"\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\x3e\x3c/tr\n\x3e\x3c/table\x3e\n',
"url:cmv/viewer/js/gis/dijit/LayerControl/controls/templates/Control.html":'\x3cdiv class\x3d"layerControl"\x3e\n    \x3ctable class\x3d"layerControlTable"\x3e\n        \x3ctr data-dojo-attach-point\x3d"expandClickNode"\x3e\n            \x3ctd class\x3d"layerControlTableExpand"\x3e\n                \x3ci data-dojo-attach-point\x3d"expandIconNode" class\x3d"fa ${icons.expand} layerControlIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableCheck"\x3e\n                \x3ci data-dojo-attach-point\x3d"checkNode" class\x3d"fa ${icons.unchecked} layerControlIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableLabel"\x3e\n                \x3cspan data-dojo-attach-point\x3d"labelNode"\x3e\x3c/span\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableUpdate"\x3e\n                \x3ci data-dojo-attach-point\x3d"layerUpdateNode" class\x3d"fa ${icons.update} fa-spin layerControlUpdateIcon" style\x3d"display:none;"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd data-dojo-attach-point\x3d"menuClickNode" class\x3d"layerControlTableMenu"\x3e\n                \x3ci data-dojo-attach-point\x3d"menuNode" class\x3d"fa ${icons.menu} layerControlMenuIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n        \x3c/tr\x3e\n    \x3c/table\x3e\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"layerControlIndent layerControlExpand" style\x3d"display:none;"\x3e\x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/LayerControl/controls/templates/Sublayer.html":'\x3cdiv class\x3d"layerControl layerControlSublayer"\x3e\n    \x3ctable class\x3d"layerControlTable"\x3e\n        \x3ctr data-dojo-attach-point\x3d"expandClickNode"\x3e\n            \x3ctd class\x3d"layerControlTableExpand"\x3e\n                \x3ci data-dojo-attach-point\x3d"expandIconNode" class\x3d"fa ${icons.expand} layerControlIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableCheck"\x3e\n                \x3ci data-dojo-attach-point\x3d"checkNode" class\x3d"fa ${icons.unchecked} layerControlIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableLabel"\x3e\n                \x3cspan data-dojo-attach-point\x3d"labelNode"\x3e\x3c/span\x3e\n                \x3cspan data-dojo-attach-point\x3d"iconNode" class\x3d"icon-extra"\x3e\x3c/span\x3e\n            \x3ctd class\x3d"layerControlTableUpdate"\x3e\n                \x3ci data-dojo-attach-point\x3d"layerUpdateNode" class\x3d"fa ${icons.update} fa-spin layerControlUpdateIcon" style\x3d"display:none;"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd data-dojo-attach-point\x3d"menuClickNode" class\x3d"layerControlTableMenu"\x3e\n                \x3ci data-dojo-attach-point\x3d"menuNode" class\x3d"fa ${icons.menu} layerControlMenuIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n        \x3c/tr\x3e\n    \x3c/table\x3e\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"layerControlIndent layerControlExpand" style\x3d"display:none;"\x3e\x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/LayerControl/controls/templates/Folder.html":'\x3cdiv class\x3d"layerControl layerControlFolder"\x3e\n    \x3ctable class\x3d"layerControlTable"\x3e\n        \x3ctr data-dojo-attach-point\x3d"expandClickNode"\x3e\n            \x3ctd class\x3d"layerControlTableExpand"\x3e\n                \x3ci data-dojo-attach-point\x3d"expandIconNode" class\x3d"fa ${icons.folder} layerControlIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableCheck"\x3e\n                \x3ci data-dojo-attach-point\x3d"checkNode" class\x3d"fa ${icons.unchecked} layerControlIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableLabel"\x3e\n                \x3cspan data-dojo-attach-point\x3d"labelNode"\x3e\x3c/span\x3e\n            \x3c/td\x3e\n        \x3c/tr\x3e\n    \x3c/table\x3e\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"layerControlIndent" style\x3d"display:none;"\x3e\x3c/div\x3e\n\x3c/div\x3e\n',
"url:esri/dijit/templates/HomeButton.html":'\x3cdiv class\x3d"${theme}" role\x3d"presentation"\x3e\n    \x3cdiv class\x3d"${_css.container}"\x3e\n            \x3cdiv data-dojo-attach-point\x3d"_homeNode" title\x3d"${_i18n.widgets.homeButton.home.title}" role\x3d"button" class\x3d"${_css.home}" tabindex\x3d"0"\x3e\x3cspan\x3e${_i18n.widgets.homeButton.home.button}\x3c/span\x3e\x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e',"url:esri/dijit/templates/OverviewMap.html":'\x3cdiv class\x3d"esriOverviewMap"\x3e\n  \x3cdiv class\x3d"ovwContainer" dojoattachpoint\x3d"_body" style\x3d"width: ${width}px; height: ${height}px;"\x3e\n    \x3cdiv id\x3d"${id}-map" style\x3d"width: 100%; height: 100%;"\x3e\n      \x3cdiv class\x3d"ovwHighlight" dojoattachpoint\x3d"_focusDiv" title\x3d"${NLS_drag}" style\x3d"border: 1px solid ${color}; background-color: ${color};"\x3e\x3c/div\x3e\n    \x3c/div\x3e\n  \x3c/div\x3e\n  \x3cdiv class\x3d"ovwButton ovwController" title\x3d"${NLS_show}" dojoattachpoint\x3d"_controllerDiv" dojoattachevent\x3d"onclick: _visibilityHandler"\x3e\n  \x3c/div\x3e\n  \x3cdiv class\x3d"ovwButton ovwMaximizer" title\x3d"${NLS_maximize}" dojoattachpoint\x3d"_maximizerDiv" dojoattachevent\x3d"onclick: _maximizeHandler"\x3e\n  \x3c/div\x3e\n\x3c/div\x3e\n',
"url:dijit/form/templates/DropDownButton.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\n\t\x3e\x3cspan class\x3d\'dijitReset dijitInline dijitButtonNode\'\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" data-dojo-attach-point\x3d"_buttonNode"\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\n\t\t\tdata-dojo-attach-point\x3d"focusNode,titleNode,_arrowWrapperNode,_popupStateNode"\n\t\t\trole\x3d"button" aria-haspopup\x3d"true" aria-labelledby\x3d"${id}_label"\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon"\n\t\t\t\tdata-dojo-attach-point\x3d"iconNode"\n\t\t\t\x3e\x3c/span\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\n\t\t\t\tid\x3d"${id}_label"\n\t\t\t\x3e\x3c/span\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonInner"\x3e\x3c/span\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonChar"\x3e\x26#9660;\x3c/span\n\t\t\x3e\x3c/span\n\t\x3e\x3c/span\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1"\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick" data-dojo-attach-point\x3d"valueNode" aria-hidden\x3d"true"\n/\x3e\x3c/span\x3e\n',
"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\n\t\x3e\x3c/div\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\n\x3e\x3c/div\x3e\n',
"url:esri/dijit/editing/templates/AttachmentEditor.html":"\x3cdiv class\x3d\"attachmentEditor\"\x3e\n    \x3cbr /\x3e\n    \x3cdiv\x3e\n        \x3cb\x3e${NLS_attachments}\x3c/b\x3e\n        \x3chr /\x3e\n        \x3cdiv dojoAttachPoint\x3d\"_attachmentError\" style\x3d'color:red;display:none'\x3e\x3c/div\x3e\n        \x3cbr /\x3e\n        \x3cspan dojoAttachPoint\x3d'_attachmentList' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e\n        \x3cbr\x3e\x3cbr\x3e\n        \x3cdiv data-dojo-type\x3d\"dijit/ProgressBar\" dojoAttachPoint\x3d\"_attachmentProgress\" indeterminate\x3d\"true\" style\x3d'display:none'\x3e\x3c/div\x3e\n        \x3cbr /\x3e        \n        \x3cform dojoAttachPoint\x3d'_uploadForm'\x3e ${NLS_add}:\x26nbsp;\x26nbsp;\x3cinput type\x3d'file' name\x3d'attachment' dojoAttachPoint\x3d'_uploadField' /\x3e \x3c/form\x3e\n    \x3c/div\x3e\n\x3c/div\x3e",
"url:dijit/templates/Calendar.html":'\x3cdiv class\x3d"dijitCalendarContainer dijitInline" role\x3d"presentation" aria-labelledby\x3d"${id}_mddb ${id}_year"\x3e\n\t\x3cdiv class\x3d"dijitReset dijitCalendarMonthContainer" role\x3d"presentation"\x3e\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarDecrementArrow\' data-dojo-attach-point\x3d"decrementMonth"\x3e\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"/\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\n\t\t\x3c/div\x3e\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarIncrementArrow\' data-dojo-attach-point\x3d"incrementMonth"\x3e\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"/\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\n\t\t\x3c/div\x3e\n\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode" class\x3d"dijitInline"\x3e\x3c/div\x3e\n\t\x3c/div\x3e\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"grid" data-dojo-attach-point\x3d"gridNode"\x3e\n\t\t\x3cthead\x3e\n\t\t\t\x3ctr role\x3d"row"\x3e\n\t\t\t\t${!dayCellsHtml}\n\t\t\t\x3c/tr\x3e\n\t\t\x3c/thead\x3e\n\t\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\n\t\t\t\t${!dateRowsHtml}\n\t\t\x3c/tbody\x3e\n\t\x3c/table\x3e\n\t\x3cdiv class\x3d"dijitReset dijitCalendarYearContainer" role\x3d"presentation"\x3e\n\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\n\t\t\x3c/div\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e\n',
"url:dijit/form/templates/DropDownBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tid\x3d"widget_${id}"\n\trole\x3d"combobox"\n\taria-haspopup\x3d"true"\n\tdata-dojo-attach-point\x3d"_popupStateNode"\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\n\t\tdata-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\n\t\t\t${_buttonInputDisabled}\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' ${!nameAttrSetting} type\x3d"${type}" autocomplete\x3d"off"\n\t\t\tdata-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"url:dijit/form/templates/Spinner.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tid\x3d"widget_${id}" role\x3d"presentation"\n\t\x3e\x3cdiv class\x3d"dijitReset dijitButtonNode dijitSpinnerButtonContainer"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitSpinnerButtonInner" type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton"\n\t\t\tdata-dojo-attach-point\x3d"upArrowNode"\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9650; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/\x3e\x3c/div\n\t\t\x3e\x3c/div\n\t\t\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton"\n\t\t\tdata-dojo-attach-point\x3d"downArrowNode"\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/\x3e\x3c/div\n\t\t\x3e\x3c/div\n\t\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' data-dojo-attach-point\x3d"textbox,focusNode" type\x3d"${type}" data-dojo-attach-event\x3d"onkeydown:_onKeyDown"\n\t\t\trole\x3d"spinbutton" autocomplete\x3d"off" ${!nameAttrSetting}\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"url:esri/dijit/templates/AttributeInspector.html":'\x3cdiv class\x3d"esriAttributeInspector"\x3e\n    \x3cdiv class\x3d"atiLayerName" dojoAttachPoint\x3d"layerName"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"atiAttributes" dojoAttachPoint\x3d"attributeTable"\x3e\x3c/div\x3e\n    \x3cdiv dojoAttachPoint\x3d"attachmentEditor"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"atiEditorTrackingInfo" dojoAttachPoint\x3d"editorTrackingInfoDiv"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"atiButtons" dojoAttachPoint\x3d"editButtons"\x3e\n        \x3cbutton  dojoType\x3d"dijit.form.Button" class\x3d"atiButton atiDeleteButton"  dojoAttachPoint\x3d"deleteBtn" dojoAttachEvent\x3d"onClick: onDeleteBtn" showLabel\x3d"true" type\x3d"button"\x3e${NLS_deleteFeature}\x3c/button\x3e\n        \x3cdiv class\x3d"atiNavButtons" dojoAttachPoint\x3d"navButtons"\x3e\n            \x3cdiv class\x3d"atiNavMessage" dojoAttachPoint\x3d"navMessage"\x3e\x3c/div\x3e\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiFirstIcon" dojoAttachPoint\x3d"firstFeatureButton" dojoAttachEvent\x3d"onClick: onFirstFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_first}\x3c/button\x3e\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiPrevIcon" dojoAttachPoint\x3d"prevFeatureButton" dojoAttachEvent\x3d"onClick: onPreviousFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_previous}\x3c/button\x3e\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiNextIcon" dojoAttachPoint\x3d"nextFeatureButton" dojoAttachEvent\x3d"onClick: onNextFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_next}\x3c/button\x3e\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiLastIcon" dojoAttachPoint\x3d"lastFeatureButton" dojoAttachEvent\x3d"onClick: onLastFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_last}\x3c/button\x3e\n        \x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:dijit/form/templates/ComboButton.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tcellspacing\x3d\'0\' cellpadding\x3d\'0\' role\x3d"presentation"\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonNode" data-dojo-attach-point\x3d"buttonNode" data-dojo-attach-event\x3d"ondijitclick:__onClick,onkeydown:_onButtonKeyDown"\n\t\t\x3e\x3cdiv id\x3d"${id}_button" class\x3d"dijitReset dijitButtonContents"\n\t\t\tdata-dojo-attach-point\x3d"titleNode"\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode" role\x3d"presentation"\x3e\x3c/div\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitButtonText" id\x3d"${id}_label" data-dojo-attach-point\x3d"containerNode" role\x3d"presentation"\x3e\x3c/div\n\t\t\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd id\x3d"${id}_arrow" class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton\'\n\t\t\tdata-dojo-attach-point\x3d"_popupStateNode,focusNode,_buttonNode"\n\t\t\tdata-dojo-attach-event\x3d"onkeydown:_onArrowKeyDown"\n\t\t\ttitle\x3d"${optionsTitle}"\n\t\t\trole\x3d"button" aria-haspopup\x3d"true"\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonInner" role\x3d"presentation"\x3e\x3c/div\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonChar" role\x3d"presentation"\x3e\x26#9660;\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd style\x3d"display:none !important;"\n\t\t\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" data-dojo-attach-point\x3d"valueNode"\n\t\t\t\tclass\x3d"dijitOffScreen" aria-hidden\x3d"true" data-dojo-attach-event\x3d"onclick:_onClick"\n\t\t/\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\n\x3e\x3c/table\x3e\n',
"url:dojox/grid/resources/View.html":'\x3cdiv class\x3d"dojoxGridView" role\x3d"presentation"\x3e\n\t\x3cdiv class\x3d"dojoxGridHeader" dojoAttachPoint\x3d"headerNode" role\x3d"presentation"\x3e\n\t\t\x3cdiv dojoAttachPoint\x3d"headerNodeContainer" style\x3d"width:9000em" role\x3d"presentation"\x3e\n\t\t\t\x3cdiv dojoAttachPoint\x3d"headerContentNode" role\x3d"row"\x3e\x3c/div\x3e\n\t\t\x3c/div\x3e\n\t\x3c/div\x3e\n\t\x3cinput type\x3d"checkbox" class\x3d"dojoxGridHiddenFocus" dojoAttachPoint\x3d"hiddenFocusNode" aria-hidden\x3d"true" /\x3e\n\t\x3cinput type\x3d"checkbox" class\x3d"dojoxGridHiddenFocus" aria-hidden\x3d"true" /\x3e\n\t\x3cdiv class\x3d"dojoxGridScrollbox" dojoAttachPoint\x3d"scrollboxNode" role\x3d"presentation"\x3e\n\t\t\x3cdiv class\x3d"dojoxGridContent" dojoAttachPoint\x3d"contentNode" hidefocus\x3d"hidefocus" role\x3d"presentation"\x3e\x3c/div\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e\n',
"url:dijit/templates/CheckedMenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"${role}" tabIndex\x3d"-1" aria-checked\x3d"${checked}"\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\n\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuItemIcon dijitCheckedMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\t\x3cspan class\x3d"dijitMenuItemIconChar dijitCheckedMenuItemIconChar"\x3e${!checkedChar}\x3c/span\x3e\n\t\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,labelNode,textDirNode"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\x26#160;\x3c/td\x3e\n\x3c/tr\x3e\n',
"url:dojox/grid/resources/_Grid.html":'\x3cdiv hidefocus\x3d"hidefocus" role\x3d"grid" dojoAttachEvent\x3d"onmouseout:_mouseOut"\x3e\n\t\x3cdiv class\x3d"dojoxGridMasterHeader" dojoAttachPoint\x3d"viewsHeaderNode" role\x3d"presentation"\x3e\x3c/div\x3e\n\t\x3cdiv class\x3d"dojoxGridMasterView" dojoAttachPoint\x3d"viewsNode" role\x3d"presentation"\x3e\x3c/div\x3e\n\t\x3cdiv class\x3d"dojoxGridMasterMessages" style\x3d"display: none;" dojoAttachPoint\x3d"messagesNode"\x3e\x3c/div\x3e\n\t\x3cspan dojoAttachPoint\x3d"lastFocusNode" tabindex\x3d"0"\x3e\x3c/span\x3e\n\x3c/div\x3e\n',
"url:esri/dijit/editing/templates/TemplatePicker.html":'\x3cdiv class\x3d"templatePicker"\x3e\n\n  \x3ctable dojoType\x3d"dojox.grid.DataGrid" noDataMessage\x3d"${emptyMessage}" selectionMode\x3d"none" autoHeight\x3d"${_rows}" autoWidth\x3d"${_autoWidth}"\n         query\x3d"{ query: \'*\' }" dojoAttachPoint\x3d"grid" class\x3d"grid"\x3e\n  \x3c/table\x3e\n  \n\x3c/div\x3e',"url:esri/dijit/editing/templates/Editor.html":'\x3cdiv class\x3d"esriEditor"\x3e\n    \x3cdiv class\x3d"esriTemplatePicker" dojoAttachPoint\x3d"templatePickerDiv"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"esriDrawingToolbar" dojoAttachPoint\x3d"drawingToolbarDiv"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"progressBar" dojoAttachPoint\x3d"progressBar" indeterminate\x3d"true" dojoType\x3d"dijit.ProgressBar" /\x3e\n\x3c/div\x3e',
"url:cmv/viewer/js/gis/dijit/Growler/css/Growler.css":{},"url:esri/dijit/templates/BasemapGallery.html":'\x3cdiv class\x3d"esriBasemapGallery"\x3e\n  \x3cdiv dojoAttachPoint\x3d"flowContainer"\x3e\n  \x3c/div\x3e\n\x3c/div\x3e',"url:cmv/viewer/js/gis/dijit/Basemaps/templates/Basemaps.html":'\x3cdiv\x3e\n    \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton" data-dojo-props\x3d"iconClass:\'basemapsIcon\'" data-dojo-attach-point\x3d"dropDownButton"\x3e\n        \x3cspan\x3e\n            ${title}\n        \x3c/span\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/Basemaps/css/Basemaps.css":{},"url:cmv/viewer/js/gis/dijit/Help/templates/HelpDialog.html":'\x3cdiv class\x3d"helpDijit"\x3e\n    \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"containerNode" class\x3d"helpContainer"\x3e\n        \x3cdiv class\x3d"helpNode"\x3e\n            \x3cdiv data-dojo-type\x3d"dijit/layout/TabContainer" class\x3d"helpTabContainer"\x3e\n                \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${i18n.navigation.title}"\x3e\n                    \x3ctable\x3e\n                        \x3ctbody\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${i18n.navigation.description}\n                                    \x3cul class\x3d"listdbootstrapFix"\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.pan1}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.recenter}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomIn1}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomOut1}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomIn2}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomOut2}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.pan2}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomInLevel}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomOutLevel}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomCenter}\n                                        \x3c/li\x3e\n                                    \x3c/ul\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/tbody\x3e\n                    \x3c/table\x3e\n                \x3c/div\x3e\n                \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${i18n.search.title}"\x3e\n                    ${i18n.search.description}\n                    \x3cul class\x3d"listdbootstrapFix"\x3e\n                        \x3cli\x3e\n                            ${i18n.search.address}\n                        \x3c/li\x3e\n                        \x3cli\x3e\n                            ${i18n.search.place}\n                        \x3c/li\x3e\n                        \x3cli\x3e\n                            ${i18n.search.etc}\n                        \x3c/li\x3e\n                    \x3c/ul\x3e\n                \x3c/div\x3e\n                \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${i18n.tools.title}"\x3e\n                    ${i18n.tools.description}\n                    \x3cul class\x3d"listdbootstrapFix"\x3e\n                        \x3cli\x3e\n                            ${i18n.tools.measure.title}\n                        \x3c/li\x3e\n                        \x3cdiv\x3e\n                            ${i18n.tools.measure.description}\n                        \x3c/div\x3e\n                        \x3cli\x3e\n                            ${i18n.tools.print.title}\n                        \x3c/li\x3e\n                        \x3cdiv\x3e\n                            ${i18n.tools.print.description}\n                        \x3c/div\x3e\n                    \x3c/ul\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n        \x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:dijit/layout/templates/TabContainer.html":'\x3cdiv class\x3d"dijitTabContainer"\x3e\n\t\x3cdiv class\x3d"dijitTabListWrapper" data-dojo-attach-point\x3d"tablistNode"\x3e\x3c/div\x3e\n\t\x3cdiv data-dojo-attach-point\x3d"tablistSpacer" class\x3d"dijitTabSpacer ${baseClass}-spacer"\x3e\x3c/div\x3e\n\t\x3cdiv class\x3d"dijitTabPaneWrapper ${baseClass}-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\n\x3c/div\x3e\n',"url:dijit/layout/templates/_TabButton.html":'\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"titleNode,innerDiv,tabContent" class\x3d"dijitTabInner dijitTabContent"\x3e\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTabButtonIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\x3cspan data-dojo-attach-point\x3d\'containerNode,focusNode\' class\x3d\'tabLabel\'\x3e\x3c/span\x3e\n\t\x3cspan class\x3d"dijitInline dijitTabCloseButton dijitTabCloseIcon" data-dojo-attach-point\x3d\'closeNode\'\n\t\t  role\x3d"presentation"\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d\'closeText\' class\x3d\'dijitTabCloseText\'\x3e[x]\x3c/span\n\t\t\t\t\x3e\x3c/span\x3e\n\x3c/div\x3e\n',
"url:dijit/layout/templates/ScrollingTabController.html":'\x3cdiv class\x3d"dijitTabListContainer-${tabPosition}" style\x3d"visibility:hidden"\x3e\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerMenuButton"\n\t\t class\x3d"tabStripButton-${tabPosition}"\n\t\t id\x3d"${id}_menuBtn"\n\t\t data-dojo-props\x3d"containerId: \'${containerId}\', iconClass: \'dijitTabStripMenuIcon\',\n\t\t\t\t\tdropDownPosition: [\'below-alt\', \'above-alt\']"\n\t\t data-dojo-attach-point\x3d"_menuBtn" showLabel\x3d"false" title\x3d""\x3e\x26#9660;\x3c/div\x3e\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\n\t\t class\x3d"tabStripButton-${tabPosition}"\n\t\t id\x3d"${id}_leftBtn"\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideLeftIcon\', showLabel:false, title:\'\'"\n\t\t data-dojo-attach-point\x3d"_leftBtn" data-dojo-attach-event\x3d"onClick: doSlideLeft"\x3e\x26#9664;\x3c/div\x3e\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\n\t\t class\x3d"tabStripButton-${tabPosition}"\n\t\t id\x3d"${id}_rightBtn"\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideRightIcon\', showLabel:false, title:\'\'"\n\t\t data-dojo-attach-point\x3d"_rightBtn" data-dojo-attach-event\x3d"onClick: doSlideRight"\x3e\x26#9654;\x3c/div\x3e\n\t\x3cdiv class\x3d\'dijitTabListWrapper\' data-dojo-attach-point\x3d\'tablistWrapper\'\x3e\n\t\t\x3cdiv role\x3d\'tablist\' data-dojo-attach-event\x3d\'onkeydown:onkeydown\'\n\t\t\t data-dojo-attach-point\x3d\'containerNode\' class\x3d\'nowrapTabStrip\'\x3e\x3c/div\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e',
"url:dijit/layout/templates/_ScrollingTabControllerButton.html":'\x3cdiv data-dojo-attach-event\x3d"ondijitclick:_onClick" class\x3d"dijitTabInnerDiv dijitTabContent dijitButtonContents"  data-dojo-attach-point\x3d"focusNode" role\x3d"button"\x3e\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitTabStripIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\x3cspan data-dojo-attach-point\x3d"containerNode,titleNode" class\x3d"dijitButtonText"\x3e\x3c/span\x3e\n\x3c/div\x3e',"url:cmv/viewer/js/gis/dijit/Help/css/Help.css":{},
"url:cmv/viewer/js/gis/dijit/Bookmarks/css/Bookmarks.css":{},"url:dgrid/css/dgrid.css":{},"url:dgrid/css/extensions/ColumnResizer.css":{},"url:cmv/viewer/js/gis/dijit/Find/templates/Find.html":'\x3cdiv class\x3d"gis_AdvancedFindDijit" \x3e\n    \x3cdiv class\x3d"formContainer"\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"searchFormDijit"\x3e\n            \x3cdiv data-dojo-attach-point\x3d"querySelectDom"\x3e\n                \x3clabel\x3e${i18n.selectQuery}:\x3c/label\x3e\x3cbr/\x3e\n    \t\t\t\x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"name:\'query\',autoComplete:true,required:true,searchAttr:\'description\',\'class\':\'querySelect\'" data-dojo-attach-point\x3d"querySelectDijit" data-dojo-attach-event\x3d"onChange:_onQueryChange"/\x3e\n            \x3c/div\x3e\n            \x3cdiv data-dojo-attach-point\x3d"queryTextDom"\x3e\n                \x3clabel\x3e${i18n.searchText.label}:\x3c/label\x3e\x3cbr/\x3e\n    \t\t\t\x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"searchTextDijit" data-dojo-props\x3d"name:\'searchText\',trim:true,required:true,value:\'\',placeholder:\'${i18n.searchText.placeholder}\',\'class\':\'searchText\'" /\x3e\x3cbr/\x3e\n            \x3c/div\x3e\n            \x3cdiv data-dojo-attach-point\x3d"queryContainsDom"\x3e\n                \x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"containsSearchText" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"\'class\':\'optionsCheckBox\'"/\x3e\n                \x3clabel\x3e${i18n.exactMatches}\x3c/label\x3e\n            \x3c/div\x3e\n\n            \x3cdiv class\x3d"buttonActionBar"\x3e\n\n                \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'fa fa-history fa-fw\',\'class\':\'clearButton actionBarButton\'" data-dojo-attach-event\x3d"onClick:clearResults" data-dojo-attach-point\x3d"clearButtonDijit"\x3e\n                    ${i18n.clearButton.label}\n                \x3c/div\x3e\n\n                \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"busyLabel:\'${i18n.searchButton.busyLabel}\',iconClass:\'fa fa-search fa-fw\',\'class\':\'searchButton actionBarButton\'" data-dojo-attach-event\x3d"onClick:search" data-dojo-attach-point\x3d"searchButtonDijit"\x3e\n                    ${i18n.searchButton.label}\n                \x3c/div\x3e\n\n                \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton" data-dojo-props\x3d"iconClass:\'fa fa-cog fa-fw\',showLabel:true,\'class\':\'actionBarButton\',style:\'display:none;\'" data-dojo-attach-point\x3d"optionsDropDownDijit"\x3e\n                    \x3cspan\x3e\n                        ${i18n.optionsLabel}\n                    \x3c/span\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog"\x3e\n                        \x3cdiv style\x3d"width:260px;"\x3e\n                            \x3cdiv data-dojo-attach-point\x3d"zoomOptionsSelectDom"\x3e\n                                \x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"zoomOptionsSelect" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"\'class\':\'optionsCheckBox\',\'checked\':${zoomOptions.select}" data-dojo-attach-event\x3d"onChange:onZoomOptionsSelectChange"/\x3e\n                                \x3clabel\x3e${i18n.zoomOnSelect}\x3c/label\x3e\n                            \x3c/div\x3e\n                            \x3cdiv data-dojo-attach-point\x3d"zoomOptionsDeselectDom"\x3e\n                                \x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"zoomOptionsDeselect" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"\'class\':\'optionsCheckBox\',\'checked\':${zoomOptions.deselect}" data-dojo-attach-event\x3d"onChange:onZoomOptionsDeselectChange"/\x3e\n                                \x3clabel\x3e${i18n.zoomOnDeselect}\x3c/label\x3e\n                            \x3c/div\x3e\n                        \x3c/div\x3e\n                    \x3c/div\x3e\n                \x3c/div\x3e\n\n            \x3c/div\x3e\n\n\n    \t\x3c/div\x3e\n\t\x3c/div\x3e\n\n    \x3cdiv data-dojo-attach-point\x3d"findResultsNode" class\x3d"resultsContainer"\x3e\x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"findResultsGrid" class\x3d"resultsGrid"\x3e\x3c/div\x3e\n\x3c/div\x3e',
"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\n\t\x3e\x3cinput\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\n\t\tdata-dojo-attach-point\x3d"focusNode"\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\n/\x3e\x3c/div\x3e\n',"url:cmv/viewer/js/gis/dijit/Find/css/Find.css":{},"url:cmv/viewer/js/gis/dijit/Identify/templates/Identify.html":'\x3cdiv class\x3d"gis_IdentifyDijit"\x3e\n    \x3cdiv class\x3d"formContainer"\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"identifyFormDijit"\x3e\n            \x3clabel\x3e${i18n.labels.selectLayer}\x3c/label\x3e\x3cbr/\x3e\n            \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"name:\'identifyLayer\',autoComplete:true,required:true,searchAttr:\'name\',maxHeight:250,\'class\':\'identifySelect\'"\n                data-dojo-attach-point\x3d"identifyLayerDijit" /\x3e\n        \x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/Identify/css/Identify.css":{},"url:cmv/viewer/js/gis/dijit/Draw/templates/Draw.html":'\x3cdiv class\x3d"gis_DrawDijit"\x3e\n    \x3cdiv class\x3d"formContainer"\x3e\n        \x3cul class\x3d"list-unstyled outerList"\x3e\n            \x3cli\x3e\n                \x3cul class\x3d"list-inline list-unstyled"\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'adw-icon-point fa fa-fw\',showLabel:false"\n                                data-dojo-attach-event\x3d"onClick:drawPoint"\n                                class\x3d"drawButton"\n                                title\x3d"${i18n.labels.point}"\x3e\n                            ${i18n.labels.point}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'adw-icon-circle fa fa-fw\',showLabel:false,drawType:\'CIRCLE\'"\n                                data-dojo-attach-event\x3d"onClick:drawCircle"\n                                class\x3d"drawButton"\n                                title\x3d"${i18n.labels.circle}"\x3e\n                            ${i18n.labels.circle}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'adw-icon-polyline fa fa-fw\',showLabel:false"\n                                data-dojo-attach-event\x3d"onClick:drawLine"\n                                class\x3d"drawButton"\n                                title\x3d"${i18n.labels.polyline}"\x3e\n                            ${i18n.labels.polyline}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'adw-icon-freehand-polyline fa fa-fw\',showLabel:false"\n                                data-dojo-attach-event\x3d"onClick:drawFreehandLine"\n                                class\x3d"drawButton"\n                                title\x3d"${i18n.labels.freehandPolyline}"\x3e\n                            ${i18n.labels.freehandPolyline}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'adw-icon-polygon fa fa-fw\',showLabel:false"\n                                data-dojo-attach-event\x3d"onClick:drawPolygon"\n                                class\x3d"drawButton"\n                                title\x3d"${i18n.labels.polygon}"\x3e\n                            ${i18n.labels.polygon}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'adw-icon-freehand-polygon fa fa-fw\',showLabel:false"\n                                data-dojo-attach-event\x3d"onClick:drawFreehandPolygon"\n                                class\x3d"drawButton"\n                                title\x3d"${i18n.labels.freehandPolygon}"\x3e\n                            ${i18n.labels.freehandPolygon}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button"\n                             data-dojo-attach-point\x3d"stopDrawingButton"\n                             data-dojo-props\x3d"iconClass:\'fa fa-stop fa-fw\',showLabel:false,disabled:true"\n                             data-dojo-attach-event\x3d"onClick:stopDrawing"\n                             class\x3d"drawButton"\n                             title\x3d"${i18n.labels.stopDrawing}"\x3e\n                            ${i18n.labels.stopDrawing}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button"\n                             data-dojo-attach-point\x3d"eraseDrawingButton"\n                             data-dojo-props\x3d"iconClass:\'fa fa-history fa-fw\',showLabel:false,disabled:true"\n                             data-dojo-attach-event\x3d"onClick:clearGraphics"\n                             class\x3d"drawButton"\n                             title\x3d"${i18n.labels.clearDrawing}"\x3e\n                            ${i18n.labels.clearDrawing}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                \x3c/ul\x3e\n            \x3c/li\x3e\n            \x3cli\x3e\n                \x3cdiv class\x3d"drawModeIndicatorNode"\x3e\n                    \x3cspan style\x3d"font-weight: bold"\x3e${i18n.labels.currentDrawMode}\x3c/span\x3e\n                    \x3cspan data-dojo-attach-point\x3d"drawModeTextNode"\x3e${i18n.labels.currentDrawModeNone}\x3c/span\x3e\n                \x3c/div\x3e\n            \x3c/li\x3e\n\n        \x3c/ul\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/Draw/css/Draw.css":{},"url:cmv/viewer/js/gis/dijit/Draw/css/adw-icons.css":{},"url:esri/dijit/templates/Measurement.html":"\x3cdiv class\x3d\"esriMeasurement\"\x3e\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' class\x3d'esriMeasurementButtonContainer'\x3e\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'_areaButton' iconClass\x3d'areaIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:_areaButtonToggle'\x3e\x3c/div\x3e\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'_distanceButton' iconClass\x3d'distanceIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:_distanceButtonToggle'\x3e\x3c/div\x3e\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'_locationButton' iconClass\x3d'locationIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:_locationButtonToggle'\x3e\x3c/div\x3e\n    \x3cdiv class\x3d\"esriMeasurementSeparator\"\x3e|\x3c/div\x3e\n    \x3cbutton dojoType\x3d'dijit.form.DropDownButton' baseClass\x3d'esriToggleButton' dojoAttachPoint\x3d'_unitDropDown' label\x3d'unit' value\x3d'unit' style\x3d'visibility:hidden;'\x3e\x3c/button\x3e\n  \x3c/div\x3e\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultLabel' class\x3d'resultLabel esriMeasurementResultLabel'\x3e\x3c/div\x3e\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultValueContainer' align\x3d'leading' class\x3d\"esriMeasurementResultValue\"\x3e\n    \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultValue' class\x3d'result'\x3e\x26nbsp;\x3c/div\x3e\n  \x3c/div\x3e\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultTable' align\x3d'leading' class\x3d\"resultTable esriMeasurementTableContainer\" style\x3d\"display:none;\"\x3e\n    \x3ctable class\x3d\"esriMeasurementResultTable\"\x3e\n      \x3ctr\x3e\n        \x3ctd class\x3d\"esriMeasurementTableHeader\" colspan\x3d\"2\"\x3e${_NLS_Lat}\x3c/td\x3e\x3ctd class\x3d\"esriMeasurementTableHeader\"\x3e${_NLS_Lon}\x3c/td\x3e\n      \x3c/tr\x3e\n      \x3ctr class\x3d\"esriMeasurementTableRow\" dojoAttachPoint\x3d\"_mouseRow\"\x3e\n        \x3ctd dojoAttachPoint\x3d\"mouseCell\"\x3e\x3c/td\x3e\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\n          \x3cspan dojoAttachPoint\x3d\"mouseLatitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\n        \x3c/td\x3e\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\n          \x3cspan dojoAttachPoint\x3d\"mouseLongitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\n        \x3c/td\x3e\n      \x3c/tr\x3e\n      \x3ctr class\x3d\"esriMeasurementTableRow\"\x3e\n        \x3ctd dojoAttachPoint\x3d\"pinCell\"\x3e\x3c/td\x3e\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\n          \x3cspan dojoAttachPoint\x3d\"markerLatitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\n        \x3c/td\x3e\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\n          \x3cspan dojoAttachPoint\x3d\"markerLongitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\n        \x3c/td\x3e\n      \x3c/tr\x3e\n    \x3c/table\x3e\n  \x3c/div\x3e\n\x3c/div\x3e",
"url:cmv/viewer/js/gis/dijit/Print/templates/Print.html":'\x3cdiv class\x3d"gis_PrintDijit"\x3e\n    \x3cdiv class\x3d"formContainer"\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"printSettingsFormDijit"\x3e\n            \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\n                \x3ctr\x3e\n                    \x3ctd style\x3d"width:50px;"\x3e\n                        ${i18n.title}:\n                    \x3c/td\x3e\n                    \x3ctd\x3e\n                        \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'title\',trim:true,required:true,style:\'width:100%;\',value:\'${defaultTitle}\'" /\x3e\n                    \x3c/td\x3e\n                \x3c/tr\x3e\n                \x3ctr\x3e\n                    \x3ctd\x3e\n                        ${i18n.format}:\n                    \x3c/td\x3e\n                    \x3ctd\x3e\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"name:\'format\',autoComplete:true,required:true,searchAttr:\'name\',style:\'width:100%;\'" data-dojo-attach-point\x3d"formatDijit" /\x3e\n                    \x3c/td\x3e\n                \x3c/tr\x3e\n                \x3ctr\x3e\n                    \x3ctd\x3e\n                        ${i18n.layout}:\n                    \x3c/td\x3e\n                    \x3ctd\x3e\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"name:\'layout\',autoComplete:true,required:true,searchAttr:\'name\',style:\'width:100%;\'" data-dojo-attach-point\x3d"layoutDijit" /\x3e\n                    \x3c/td\x3e\n                \x3c/tr\x3e\n            \x3c/table\x3e\n        \x3c/div\x3e\n    \x3c/div\x3e\n    \x3cdiv class\x3d"buttonActionBar"\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton" data-dojo-props\x3d"iconClass:\'fa fa-cog fa-fw\',showLabel:true" data-dojo-attach-point\x3d"layoutDropDownDijit"\x3e\n            \x3cspan\x3e\n                ${i18n.settings}\n            \x3c/span\x3e\n            \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog"\x3e\n                \x3cdiv style\x3d"width:260px;"\x3e\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\n                        ${i18n.mapScaleExtent}:\n                    \x3c/div\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"preserveFormDijit"\x3e\n                        \x3ctable cellspacing\x3d"5"\x3e\n                            \x3ctr\x3e\n                                \x3ctd style\x3d"vertical-align:top;"\x3e\n                                    ${i18n.preserve}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',checked:true,value:\'true\'" /\x3e\n                                    ${i18n.mapScale}\x3cbr/\x3e\n                                    \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'false\'" /\x3e\n                                    ${i18n.mapExtent}\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/table\x3e\n                    \x3c/div\x3e\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\n                        ${i18n.fullLayoutOptions}:\n                    \x3c/div\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutFormDijit"\x3e\n                        \x3ctable cellspacing\x3d"5"\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${i18n.scaleBarUnits}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cselect data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"name:\'scalebarUnit\',style:\'width:100px;\'"\x3e\n                                        \x3coption value\x3d"Miles" selected\x3d"selected"\x3e\n                                            ${i18n.miles}\n                                        \x3c/option\x3e\n                                        \x3coption value\x3d"Kilometers"\x3e\n                                            ${i18n.kilometers}\n                                        \x3c/option\x3e\n                                        \x3coption value\x3d"Meters"\x3e\n                                            ${i18n.meters}\n                                        \x3c/option\x3e\n                                        \x3coption value\x3d"Feet"\x3e\n                                            ${i18n.feet}\n                                        \x3c/option\x3e\n                                    \x3c/select\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${i18n.includeLegend}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'legend\',value:true,checked:true" /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/table\x3e\n                    \x3c/div\x3e\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\n                        ${i18n.printQualityOptions}:\n                    \x3c/div\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapQualityFormDijit"\x3e\n                        \x3ctable cellspacing\x3d"5"\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${i18n.dpiInput.label}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'dpi\',required:true,value:150,constraints:{min:100,max:300,places:0},invalidMessage:\'${i18n.dpiInput.invalidMessage}\',rangeMessage:\'${i18n.dpiInput.rangeMessage}\',style:\'width:100px;\'" /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/table\x3e\n                    \x3c/div\x3e\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\n                        ${i18n.mapOnlyOptions}:\n                    \x3c/div\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapOnlyFormDijit"\x3e\n                        \x3ctable cellspacing\x3d"5"\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${i18n.width}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'width\',required:true,value:3300,style:\'width:100px;\'" /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${i18n.height}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'height\',required:true,value:2550,style:\'width:100px;\'" /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/table\x3e\n                    \x3c/div\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n        \x3c/div\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"busyLabel:\'${i18n.printButton.busyLabel}\',iconClass:\'fa fa-print fa-fw\'" data-dojo-attach-event\x3d"onClick:print" data-dojo-attach-point\x3d"printButtonDijit"\x3e\n            ${i18n.printButton.label}\n        \x3c/div\x3e\n    \x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"printResultsNode" class\x3d"resultsContainer"\x3e\n    \x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"clearActionBarNode" class\x3d"buttonActionBar" style\x3d"display:none;padding:0;"\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'fa fa-history fa-fw\'" data-dojo-attach-event\x3d"onClick:clearResults"\x3e\n            ${i18n.clearHistoryButton.label}\n        \x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/Print/templates/PrintResult.html":'\x3cdiv class\x3d"printResult" data-dojo-attach-point\x3d"resultNode" data-dojo-attach-event\x3d"onclick:_openPrint"\x3e\n    \x3ctable class\x3d"printResultTable"\x3e\n        \x3ctr\x3e\n            \x3ctd width\x3d"25px"\x3e\n                \x3cspan class\x3d"bold"\x3e${count}.\x3c/span\x3e\n            \x3c/td\x3e\n            \x3ctd width\x3d"30px"\x3e\n                \x3cimg src\x3d"${icon}"\x3e\n            \x3c/td\x3e\n            \x3ctd data-dojo-attach-point\x3d"nameNode"\x3e\n                \x3cdiv data-dojo-type\x3d"dijit/ProgressBar" data-dojo-props\x3d"value:Infinity,label:\'${i18n.printResults.progressBar.label}\'"\x3e\n                \x3c/div\x3e\n            \x3c/td\x3e\n        \x3c/tr\x3e\n    \x3c/table\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/Print/css/Print.css":{},"url:dijit/form/templates/Select.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\n\trole\x3d"listbox" aria-haspopup\x3d"true"\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t/\x3e\x3c/div\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\n\t\t/\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t\t${_buttonInputDisabled}\n\t\t/\x3e\x3c/td\n\t\x3e\x3c/tr\x3e\x3c/tbody\n\x3e\x3c/table\x3e\n',
"url:esri/dijit/templates/Directions.html":'\x3cdiv class\x3d"${options.theme}" role\x3d"presentation"\x3e\n    \x3cdiv data-dojo-attach-point\x3d"_widgetContainer" class\x3d"${_css.widgetContainerClass}" role\x3d"presentation"\x3e\n        \x3cdiv class\x3d"${_css.stopsContainerClass}" role\x3d"presentation"\x3e\n            \x3cdiv id\x3d"search-source-container" class\x3d"${_css.searchSourceContainerClass}" data-dojo-attach-point\x3d"_searchSourceContainerNode"\x3e\n                \x3cdiv data-dojo-attach-point\x3d"_searchSourceSelectorContainer"\x3e\x3c/div\x3e\n            \x3c/div\x3e\n            \x3cdiv class\x3d"${_css.stopsTableContainerClass}"\x3e\n                \x3ctable class\x3d"${_css.stopsClass}" data-dojo-attach-point\x3d"_dndNode"\x3e\x3c/table\x3e\n                \x3cdiv class\x3d"${_css.stopsTableCoverClass}" data-dojo-attach-point\x3d"_stopsTableCover"\x3e\x3c/div\x3e\n            \x3c/div\x3e\n            \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\n            \x3cdiv class\x3d"${_css.stopsButtonContainerClass}"\x3e\n                \x3cdiv class\x3d"${_css.stopsAddDestinationClass}"\x3e\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" data-dojo-attach-point\x3d"_activateButtonNode" title\x3d"${_i18n.widgets.directions.activate}" class\x3d"${_css.activateButtonClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass} ${_css.stopsPressedButtonClass}" data-blur-on-click\x3d"true"\x3e\x3c/div\x3e\n                    \x3cdiv role\x3d"button" tabindex\x3d"0" class\x3d"${_css.linkButtonClass} ${_css.stopsAddDestinationBtnClass}" data-dojo-attach-point\x3d"_addDestinationNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.addDestination}\x3c/div\x3e\n                \x3c/div\x3e\n                \x3cdiv class\x3d"${_css.travelModesContainerClass}" data-dojo-attach-point\x3d"_travelModeContainerNode"\x3e\n                    \x3cdiv data-dojo-attach-point\x3d"_travelModeSelectorContainer"\x3e\x3c/div\x3e\n                \x3c/div\x3e\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.linkButtonClass} startTimeMenuButton" data-blur-on-click\x3d"true" data-dojo-attach-point\x3d"_startTimeButtonNodeContainer"\x3e\n                    \x3cdiv data-dojo-attach-point\x3d"_startTimeButtonNode"\x3e${_i18n.widgets.directions.leaveNow}\x3c/div\x3e\n                    \x3cdiv class\x3d"startTimeMenu" data-dojo-attach-point\x3d"_startTimeMenu"\x3e\n                        \x3cul role\x3d"menu"\x3e\n                            \x3cli data-dojo-attach-point\x3d"_startTimeMenuLeaveNow" tabindex\x3d"0" class\x3d"esriRouteZoom startTimeMenuItem" role\x3d"menuitemradio" aria-checked\x3d"true"\x3e${_i18n.widgets.directions.leaveNow}\x3c/li\x3e\n                            \x3cli data-dojo-attach-point\x3d"_startTimeMenuDepartAt" tabindex\x3d"0" class\x3d"esriRouteZoom startTimeMenuItem" role\x3d"menuitemradio"\x3e${_i18n.widgets.directions.departAt}\x3c/li\x3e\n                        \x3c/ul\x3e\n                    \x3c/div\x3e\n                \x3c/div\x3e\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.linkButtonClass} ${_css.stopsOptionsButtonClass}" data-dojo-attach-point\x3d"_optionsButtonNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.showOptions}\x3c/div\x3e\n            \t\x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\n                \x3cdiv class\x3d"departAtContainer" data-dojo-attach-point\x3d"_departAtContainer"\x3e\n                    \x3cdiv id\x3d"${id}_directionsDepartAtTime" data-dojo-attach-point\x3d"_departAtTimeContainer"\x3e\x3c/div\x3e\n                    \x3cdiv id\x3d"${id}_directionsDepartAtDate" data-dojo-attach-point\x3d"_departAtDateContainer"\x3e\x3c/div\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n            \x3cdiv role\x3d"presentation" class\x3d"${_css.stopsOptionsMenuClass}" data-dojo-attach-point\x3d"_optionsMenuNode"\x3e\n                \x3cdiv class\x3d"${_css.stopsOptionsCheckboxesClass}"\x3e\n                    \x3cul\x3e\n                        \x3cli class\x3d"${_css.stopsFindOptimalOrderClass}" data-dojo-attach-point\x3d"_findOptimalOrderItemNode"\x3e\x3cinput tabindex\x3d"0" data-dojo-attach-point\x3d"_findOptimalOrderNode" type\x3d"checkbox" id\x3d"${id}_find_optimal_order" /\x3e\x3clabel for\x3d"${id}_find_optimal_order"\x3e${_i18n.widgets.directions.findOptimalOrder}\x3c/label\x3e\x3c/li\x3e\n                        \x3cli class\x3d"${_css.stopsReturnToStartClass}" data-dojo-attach-point\x3d"_returnToStartItemNode"\x3e\x3cinput tabindex\x3d"0" data-dojo-attach-point\x3d"_returnToStartNode" type\x3d"checkbox" id\x3d"${id}_stopsReturnToStart" /\x3e\x3clabel for\x3d"${id}_stopsReturnToStart"\x3e${_i18n.widgets.directions.returnToStart}\x3c/label\x3e\x3c/li\x3e\n                        \x3cli class\x3d"${_css.stopsUseTrafficClass}" data-dojo-attach-point\x3d"_useTrafficItemNode" title\x3d"${_i18n.widgets.directions.trafficLabelLive}"\x3e\n                            \x3cinput tabindex\x3d"0" data-dojo-attach-point\x3d"_useTrafficNode" type\x3d"checkbox" id\x3d"${id}_stopsUseTraffic" /\x3e\x3clabel for\x3d"${id}_stopsUseTraffic"\x3e${_i18n.widgets.directions.useTraffic}\x3c/label\x3e\n                            \x3ca data-dojo-attach-point\x3d"_trafficAvailabilityButton" style\x3d"display: none;" href\x3d"http://www.arcgis.com/home/item.html?id\x3db7a893e8e1e04311bd925ea25cb8d7c7" target\x3d"_blank"\x3e\x3cdiv class\x3d"esriTrafficAvailabilityButton" title\x3d"${_i18n.widgets.directions.seeTrafficAvailability}"\x3e\x3c/div\x3e\x3c/a\x3e\n                        \x3c/li\x3e\n                    \x3c/ul\x3e\n                \x3c/div\x3e\n                \x3cdiv class\x3d"${_css.stopsOptionsToggleContainerClass}"\x3e\n                    \x3cdiv class\x3d"${_css.stopsOptionsUnitsContainerClass}"  data-dojo-attach-point\x3d"_agolDistanceUnitsNode"\x3e\n                        \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsOptionsUnitsMiClass} ${_css.stopsButtonClass}" data-dojo-attach-point\x3d"_useMilesNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.units.esriMiles.abbr}\x3c/div\x3e\n                        \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsOptionsUnitsKmClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabLastClass} ${_css.stopsPressedButtonClass}" data-dojo-attach-point\x3d"_useKilometersNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.units.esriKilometers.abbr}\x3c/div\x3e\n                        \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\n                    \x3c/div\x3e\n                    \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\n                \x3c/div\x3e\n                \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\n            \x3c/div\x3e\n            \x3cdiv class\x3d"${_css.stopsGetDirectionsContainerClass}"\x3e\n                \x3cdiv class\x3d"getDirectionsBtnContainer"\x3e\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsButtonClass} ${_css.stopsGetDirectionsClass} esriDisabledDirectionsButton" data-dojo-attach-point\x3d"_getDirectionsButtonNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.getDirections}\x3c/div\x3e\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.linkButtonClass} ${_css.stopsClearDirectionsClass}" data-dojo-attach-point\x3d"_clearDirectionsButtonNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.clearDirections}\x3c/div\x3e\n                \x3c/div\x3e\n                \x3cdiv class\x3d"savePrintBtnContainer" data-dojo-attach-point\x3d"_savePrintBtnContainer"\x3e\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.resultsSaveClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass}" data-blur-on-click\x3d"true" data-dojo-attach-point\x3d"_saveMenuButton" title\x3d"${_i18n.widgets.directions.saveTitle}" \x3e\x3c/div\x3e\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.resultsPrintClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass}" data-blur-on-click\x3d"true" data-dojo-attach-point\x3d"_printButton" title\x3d"${_i18n.widgets.directions.print}" \x3e\x3c/div\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n            \x3cdiv role\x3d"presentation" class\x3d"${_css.stopsOptionsMenuClass} esriSaveContainer" data-dojo-attach-point\x3d"_saveMenuNode"\x3e\n                \x3cdiv class\x3d"esriLayerNameLabel"\x3e${_i18n.widgets.directions.layerName}\x3c/div\x3e\n                \x3cinput type\x3d"text" data-dojo-attach-point\x3d"_outputLayerContainer"\x3e\n                \x3cdiv data-dojo-attach-point\x3d"_folderSelectorContainer"\x3e\x3c/div\x3e\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsButtonClass} esriSaveButton esriDisabledDirectionsButton" data-dojo-attach-point\x3d"_saveButton" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.save}\x3c/div\x3e\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"esriLinkButton esriSaveAsButton" data-dojo-attach-point\x3d"_saveAsButton" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.saveAs}\x3c/div\x3e\n            \x3c/div\x3e\n    \t\x3c/div\x3e\n    \t\x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\n    \t\x3cdiv data-dojo-attach-point\x3d"_msgNode" role\x3d"presentation"\x3e\x3c/div\x3e\n    \t\x3cdiv class\x3d"${_css.resultsContainerClass}" role\x3d"presentation"\x3e\n        \t\x3cdiv class\x3d"${_css.routesContainerClass}" data-dojo-attach-point\x3d"_resultsNode" role\x3d"presentation"\x3e\x3c/div\x3e\n    \t\x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e',
"url:esri/dijit/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\n        \x3c/div\x3e\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\n          \x3c/form\x3e\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\n          \x3c/div\x3e\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\n        \x3c/div\x3e\n      \x3c/div\x3e\n    \x3c/div\x3e\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\n    \x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\n  \x3c/div\x3e\n\x3c/div\x3e',
"url:cmv/viewer/js/gis/dijit/Directions/templates/Directions.html":'\x3cdiv\x3e\n\t\x3cdiv style\x3d"text-align:right;font-size:11px;"\x3e\n\t\t\x3ca href\x3d"#" data-dojo-attach-event\x3d"onclick:startAtMyLocation"\x3e${i18n.labels.startAtMyLocation}\x3c/a\x3e | \x3ca href\x3d"#" data-dojo-attach-event\x3d"onclick:endAtMyLocation"\x3e${i18n.labels.endAtMyLocation}\x3c/a\x3e | \x3ca href\x3d"#" data-dojo-attach-event\x3d"onclick:clearStops"\x3e${i18n.labels.clearStops}\x3c/a\x3e\n\t\x3c/div\x3e\n\t\x3cdiv data-dojo-attach-point\x3d"directionsNode"\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e',
"url:cmv/viewer/js/gis/dijit/Editor/templates/Editor.html":'\x3cdiv\x3e\n    \x3cdiv style\x3d"text-align:center;"\x3e\n\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button"\n                data-dojo-attach-event\x3d"onClick:toggleEditing" \n                data-dojo-props\x3d"label:\'${i18n.labels.startEditing}\',\'class\':\'success\'"\n                data-dojo-attach-point\x3d"toggleBTN"\x3e\x3c/button\x3e\n\n    \x3c/div\x3e\n    \n    \x3cdiv class\x3d"editDijit" \n         style\x3d"margin-top:5px;" \n         data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\n\n\x3c/div\x3e',
"url:cmv/viewer/js/gis/dijit/StreetView/templates/StreetView.html":'\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"gis_StreetView"\x3e\n    \x3cdiv data-dojo-attach-point\x3d"panoNode" class\x3d"streetViewPano"\x3e\n        \x3cbutton data-dojo-type\x3d"dijit/form/ToggleButton" class\x3d"streetViewButton" data-dojo-attach-point\x3d"streetViewButtonDijit" data-dojo-props\x3d"iconClass:\'fa fa-street-view fa-fw\',showLabel:false" data-dojo-attach-event\x3d"onClick:placePoint"\x3e\x3c/button\x3e\n        \x3cspan data-dojo-attach-point\x3d"streetViewInstructions" class\x3d"streetViewInstructions"\x3e\n            \x3cdiv class\x3d"streetViewInstructionsText"\x3e\n                ${i18n.messages.instructions}\n            \x3c/div\x3e\n        \x3c/span\x3e\n    \t\x3cspan data-dojo-attach-point\x3d"noStreetViewResults" class\x3d"noStreetViewResults"\x3e\n            \x3cdiv class\x3d"noStreetViewResultsText"\x3e\n                ${i18n.messages.notAvailable}\n            \x3c/div\x3e\n        \x3c/span\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/StreetView/css/StreetView.css":{},"url:esri/dijit/templates/LocateButton.html":'\x3cdiv class\x3d"${theme}" role\x3d"presentation"\x3e\n    \x3cdiv class\x3d"${_css.container}"\x3e\n            \x3cdiv data-dojo-attach-point\x3d"_locateNode" role\x3d"button" class\x3d"${_css.locate}" tabindex\x3d"0"\x3e\x3cspan\x3e${_i18n.widgets.locateButton.locate.button}\x3c/span\x3e\x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',"url:cmv/viewer/js/gis/dijit/Locale/templates/Locale.html":'\x3cdiv class\x3d"cmvLocaleDijit"\x3e\n    \x3cdiv data-dojo-attach-point\x3d"localeLabelContainer" style\x3d"display:none;"\x3e\n        \x3clabel\x3e${i18n.selectLocale}\x3c/label\x3e\n    \x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"localeDropDownContainer"\x3e\x3c/div\x3e\n\x3c/div\x3e',
"url:flag-icon-css/css/flag-icon.min.css":{},"url:cmv/viewer/js/gis/dijit/Locale/css/Locale.css":{},"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/background.vs.glsl":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform mediump vec2 u_normalized_origin;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n\nvoid main() {\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/background.fs.glsl":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/patternFillShader.vs.glsl":"uniform highp mat4 u_transformMatrix;\nuniform highp vec2 u_normalized_origin;\nuniform mediump float u_depth;\nuniform mediump mat3 u_pattern_matrix; // can we use meduim precision??\n\nattribute vec2 a_pos;\n\nvarying mediump vec2 v_tileTextureCoord;\n\nvoid main()\n{\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\n  // calculate the texture coordinates of the current vertex. It will of course get interpolated.\n  // The pattern matrix is a 3x3 scale matrix which 'tiles' the texture inside the tile, translating from tile coordinates\n  // (-4k to 8k -1) to texture coordinates.\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/patternFillShader.fs.glsl":"uniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\n\nvarying mediump vec2 v_tileTextureCoord;\n\nvoid main()\n{\n  // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\n  // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\n  // we need to only sample from area that has our sprite in the mosaic.\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  // sample the sprite mosaic\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineShader.vs.glsl":"/* The implementation of the renderer is based on the article and implementation of MB described here:\n* https://www.mapbox.com/blog/drawing-antialiased-lines/\n*/\n\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute float a_accumulatedDistance;\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n// the z of the layer. Given by the order of the layers in the style\nuniform mediump float u_depth;\n// the inset and outset of the line\nuniform mediump float u_lineHalfWidth;\n// the interpolated normal to the line. the information is packed into the LSB of the vertex coordinate\nvarying mediump vec2 v_normal;\n// the accumulated distance along the line. We need this information in order to render the dashes.\nvarying highp float v_accumulatedDistance;\n\nconst float scale \x3d 1.0 / 31.0;\n\nvoid main()\n{\n  // extract the normal from the list significat bit. It has a value of 0 or 1, but we need it to be either -1 or 1 therefore\n  // we need to change 0 to -1.\n  lowp vec2 normal \x3d mod(a_pos, 2.0);\n  normal.y \x3d normal.y \x3d\x3d 0.0 ? -1.0 : 1.0;\n  v_normal \x3d normal;\n\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\n  mediump vec2 dist \x3d u_lineHalfWidth * a_offset * scale;\n\n  // transform the vertex\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), 0.0, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\n\n  // the accumulated distance will be used to calculate the dashes (or the no-data...)\n  v_accumulatedDistance \x3d a_accumulatedDistance;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineShader.fs.glsl":"/* The implementation of the renderer is based on the article and implementation of MB described here:\n* https://www.mapbox.com/blog/drawing-antialiased-lines/\n*/\n\nuniform mediump float u_lineHalfWidth;\nuniform lowp vec4 u_color;\nuniform mediump vec2 u_dasharray;\nuniform lowp float u_blur;\n\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\n\nvoid main()\n{\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\n  mediump float fragDist \x3d length(v_normal) * u_lineHalfWidth;\n\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\n  // We need to count for both sides of the line.\n  lowp float alpha \x3d clamp( min(fragDist + u_blur + 1.0, u_lineHalfWidth - fragDist) / u_blur, 0.0, 1.0);\n\n  // now calculate the dashes given the accumulated distance of the line:\n  // start with calculating a normalized position along the line\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, u_dasharray.x + u_dasharray.y);\n\n  // calculate the contribution to the alpha of the dash part. It is provided by the shortest portion of the position along the dash.\n  // we must clamp since the value might be bigger than 1 or smaller than zero (when over a dash).\n  //   | \x3c--- pos along the dash part\n  // -------_______-------_______\n  // when the dashPos is over the 'gap' part of the dash u_dasharray.x - dashPos is negative and therefore the alpha will\n  // get clamped to zero.\n  // when u_dasharray.x - dashPos is positive, or when dashPos is smaller than 1.0, it gives us a soft edge to each dash part.\n  // along the direction of the line.\n  lowp float dashAlpha \x3d clamp( min(dashPos, u_dasharray.x - dashPos), 0.0, 1.0);\n\n  // if we don't have a no-data part to the dash then it is a solid line\n  dashAlpha \x3d max(sign(-u_dasharray.y), dashAlpha); //sign(-u_dasharray.y) \x3e 0.0 ? 1.0 : dashAlpha;\n  // finally multiply the fragment's alpha by the calculated dash-alpha\n  alpha *\x3d dashAlpha;\n\n  // output the fragment color\n gl_FragColor \x3d alpha * u_color;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/patternLineShader.vs.glsl":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute float a_accumulatedDistance;\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n// the z of the layer. Given by the order of the layers in the style\nuniform mediump float u_depth;\n// the inset and outset of the line\nuniform mediump float u_lineHalfWidth;\n// the interpolated normal to the line. the information is packed into the LSB of the vertex coordinate\nvarying mediump vec2 v_normal;\n// the accumulated distance along the line. We need this information in order to render the dashes.\nvarying highp float v_accumulatedDistance;\n\nconst float scale \x3d 1.0 / 31.0;\n\nvoid main()\n{\n  // extract the normal from the list significat bit. It has a value of 0 or 1, but we need it to be either -1 or 1 therefore\n  // we need to change 0 to -1.\n  lowp vec2 normal \x3d mod(a_pos, 2.0);\n  normal.y \x3d normal.y \x3d\x3d 0.0 ? -1.0 : 1.0;\n  v_normal \x3d normal;\n\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\n  mediump vec2 dist \x3d u_lineHalfWidth * a_offset * scale;\n\n  // transform the vertex\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), 0.0, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\n\n  // the accumulated distance will be used to calculate the dashes (or the no-data...)\n  v_accumulatedDistance \x3d a_accumulatedDistance;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/patternLineShader.fs.glsl":"uniform mediump float u_lineHalfWidth;\nuniform lowp float u_blur;\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\n\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\n\nvoid main()\n{\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\n  mediump float fragDist \x3d length(v_normal) * u_lineHalfWidth;\n\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\n  // We need to count for both sides of the line.\n  lowp float alpha \x3d clamp( min(fragDist + u_blur + 1.0, u_lineHalfWidth - fragDist) / u_blur, 0.0, 1.0);\n  // add the line's opacity to the alpha\n  alpha *\x3d u_opacity;\n\n  // we need to calculate the relative portion of the line texture along the line given the accumulated distance aliong the line\n  // The computed value should is anumber btween 0 and 1 which will later be used to interpolate btween the BR and TL values\n  mediump float relativeTexX \x3d mod(v_accumulatedDistance / u_spriteSize.x, 1.0);\n\n  // in order to calculate the texture coordinates prependicular to the line (Y axis), we use the interpolated normal values\n  // which range from -1.0 to 1.0. On the line's centerline, the value of the interpolated normal is 0.0, however the relative\n  // texture value shpould be 0.5 (given that at the bottom of the line, the texture coordinate must be equal to 0.0)\n  // (TL) ---------------------------      --\x3e left edge of line. Interpolatedf normal is 1.0\n  //              | -\x3e linwe-width / 2\n  //      - - - - - - - - - - - - - -\n  //              | -\x3e linwe-width / 2\n  //      ---------------------------- (BR)--\x3e right edge of line. Interpolatedf normal is -1.0\n\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * u_lineHalfWidth / u_spriteSize.y);\n\n  // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n\n  // get the color from the texture\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n\n  // 'un-premultiply' the color\n  lowp float inv_alpha \x3d (1.0 / clamp(color.a, 0.00390625, 1.0));\n  // finally write the fragment value\n  gl_FragColor \x3d alpha * color;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineJoinShader.vs.glsl":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform highp vec2 u_normalized_origin;\nuniform highp float u_depth;\nuniform highp vec2 u_screen;\nuniform mediump float u_size;\nuniform mediump float u_pixelRatio;\n\nvarying mediump vec2 v_vertexPosition;\n\nvoid main()\n{\n  gl_PointSize \x3d u_pixelRatio * u_size;\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\n\n  // calculate the vertex position in pixels (we need to add one in order to shift the origin from the center of the viewport)\n  v_vertexPosition \x3d (gl_Position.xy + 1.0) * u_screen;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineJoinShader.fs.glsl":"uniform lowp vec4 u_color;\nuniform mediump float u_lineHalfWidth;\nuniform mediump float u_oneOverPixelRatio;\n\nvarying mediump vec2 v_vertexPosition;\n\nvoid main()\n{\n  // get the distance of the current fragment from the actual vertex\n  mediump float fragDist \x3d length(v_vertexPosition - u_oneOverPixelRatio * gl_FragCoord.xy);\n\n  // rounding the quare: calculate the alpha given the difference between the line-width and the distance of the fragment\n  // from the center-line. We will end up with a nice round circle with a soft edge.\n  lowp float alpha \x3d clamp(u_lineHalfWidth - fragDist, 0.0, 1.0);\n\n  // finally output the fragment color\n  gl_FragColor \x3d alpha * u_color;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/solidFillShader.vs.glsl":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform highp vec2 u_normalized_origin;\nuniform mediump float u_depth;\n\nvoid main()\n{\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0, 1.0);\n}\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/solidFillShader.fs.glsl":"uniform lowp vec4 u_color;\nvoid main()\n{\n  gl_FragColor \x3d u_color;\n}",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/fillOutlineShader.vs.glsl":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n\nuniform highp mat4 u_transformMatrix;\nuniform highp mat4 u_extrudeMatrix;\nuniform highp vec2 u_normalized_origin;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\n\nvarying lowp vec2 v_normal;\n\nconst float scale \x3d 1.0 / 15.0;\n\nvoid main()\n{\n  v_normal \x3d a_xnormal;\n\n   // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n    // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\n  mediump vec4 dist \x3d vec4(u_outline_width * a_offset * scale, 0.0, 0.0);\n\n  // Remove the texture normal bit of the position before scaling it with the\n  // model/view matrix. Add the extrusion vector *after* the model/view matrix\n  // because we're extruding the line in pixel space, regardless of the current\n  // tile's zoom level.\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * dist;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/fillOutlineShader.fs.glsl":"uniform lowp vec4 u_color;\nvarying mediump vec2 v_normal;\n\nvoid main()\n{\n  // Calculate the distance of the pixel from the line in pixels.\n  lowp float dist \x3d abs(v_normal.y);\n\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * u_color;\n}\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/iconShader.vs.glsl":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n// the size of the mosaic given in pixels\nuniform vec2 u_mosaicSize;\n// the z of the layer. Given by the order of the layers in the style\nuniform mediump float u_depth;\n// the map's rotation from the north\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\n// indicate whether the current set of iconst should be kept upright when the map is rotated\nuniform lowp float u_keepUpright;\n// the rate of the change in the opacity (fade) of the icons\nuniform mediump float u_fadeSpeed;\n// the low level we transition (to/from)\nuniform mediump float u_minfadeLevel;\n// the high level we transition (to/from)\nuniform mediump float u_maxfadeLevel;\n// the amount of fade given teh current time past the last recorded level\nuniform mediump float u_fadeChange;\n// the opacity of the layer given by the painter\nuniform mediump float u_opacity;\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\nvarying lowp vec2 v_tex;\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n// opacity of the layer given by the painter\nvarying lowp float v_transparency;\n\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\n// by 16 and then at the shader devide by the same number\nconst float offsetPrecision \x3d 1.0 / 32.0;\n\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle        \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\n  mediump float delta_z \x3d 0.0;\n\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\n  mediump float rotated \x3d mod(a_angle - u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright,0.0)) * step(65.0,rotated) * (1.0 - step(193.0,rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (65 \x3c\x3d rotated) \x26\x26 (rotated \x3c 193)\n\n  // u_level is the current service level adjusted for the change in font size\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\n  delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\n\n  // calculate the alpha given the change in the fade and the fade-speed\n  lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\n\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n      v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n      v_transparency \x3d 1.0;\n  }\n\n  // if label had been faded out, clip it\n  delta_z +\x3d step(v_transparency, 0.0);\n\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n\n  v_transparency *\x3d u_opacity;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/iconShader.fs.glsl":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\n\nvoid main()\n{\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_transparency * color;\n}\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/sdfShader.vs.glsl":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n\n// attribute bool a_visible; // --\x3e a one bit controlling the visibility of the vertex\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n// the size of the mosaic given in pixels\nuniform vec2 u_mosaicSize;\n// the z of the layer. Given by the order of the layers in the style\nuniform mediump float u_depth;\n// the map's rotation from the north\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\n// indicate whether the current set of iconst should be kept upright when the map is rotated\nuniform lowp float u_keepUpright;\n// the rate of the change in the opacity (fade) of the icons\nuniform mediump float u_fadeSpeed;\n// the low level we transition (to/from)\nuniform mediump float u_minfadeLevel;\n// the high level we transition (to/from)\nuniform mediump float u_maxfadeLevel;\n// the amount of fade given teh current time past the last recorded level\nuniform mediump float u_fadeChange;\n// the opacity of the layer given by the painter\nuniform mediump float u_opacity;\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\nvarying lowp vec2 v_tex;\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n// opacity of the layer given by the painter\nvarying lowp float v_transparency;\n\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\n// by 16 and then at the shader devide by the same number\nconst float offsetPrecision \x3d 1.0 / 32.0;\n\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle        \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\n  mediump float delta_z \x3d 0.0;\n\n  // TODO: force clipping the vertex in case that the vertex isn't visible\n  //delta_z +\x3d a_visible ? 0.0 : 1.0;\n\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\n  mediump float rotated \x3d mod(a_angle - u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(65.0, rotated) * (1.0 - step(193.0, rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (65 \x3c\x3d rotated) \x26\x26 (rotated \x3c 193)\n\n  // u_level is the current service level adjusted for the change in font size\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\n  delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\n\n  // calculate the alpha given the change in the fade and the fade-speed\n  lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\n\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n      v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n      v_transparency \x3d 1.0;\n  }\n\n  // if label has been faded out, clip it\n  delta_z +\x3d step(v_transparency, 0.0);\n\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n\n  v_transparency *\x3d u_opacity;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/sdfShader.fs.glsl":"uniform lowp sampler2D u_texture;\nuniform lowp vec4 u_color;\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeWidth;\n\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\n\n// this is taken from http://www.valvesoftware.com/publications/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\n// and https://www.mapbox.com/blog/text-signed-distance-fields/\n// http://metalbyexample.com/rendering-text-in-metal-with-signed-distance-fields/\n\nvoid main()\n{\n  // read the distance from the SDF texture\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  // use a smooth-step in order to calculate the geometry of the shape given by the distance field\n  mediump float alpha \x3d smoothstep(u_edgeDistance - u_edgeWidth, u_edgeDistance + u_edgeWidth, dist) * v_transparency;\n\n  gl_FragColor \x3d alpha * u_color;\n\n// YF: this code allow having both a fill and an outline colors combined in a single pass\n//  lowp float geometryAlpha \x3d smoothstep(0.75 - 0.21, 0.75 + 0.21, dist) * v_transparency;\n//  lowp vec4 geometryColor \x3d vec4(u_color.rgb, geometryAlpha * u_color.a);\n//\n//  if (true) {\n//    lowp float haloAlpha \x3d smoothstep(0.0 - 0.1, 0.0 + 0.1, dist) * v_transparency;\n//    lowp vec4 haloColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n//    haloColor \x3d vec4(haloColor.rgb, haloAlpha);\n//\n//    // calculate the composite color\n//    lowp float compositeAlpha \x3d geometryColor.a + haloColor.a * (1.0 - geometryColor.a);\n//    lowp vec3 compositeColor \x3d vec3(geometryColor) * geometryColor.a + vec3(haloColor) * haloColor.a * (1.0 - geometryColor.a);\n//    compositeColor /\x3d compositeAlpha;\n//    gl_FragColor \x3d vec4(compositeColor, compositeAlpha);\n//  }\n//  else {\n//    gl_FragColor \x3d geometryColor;\n//  }\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/tileInfo.vs.glsl":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform mediump vec2 u_normalized_origin;\nuniform mediump float u_depth;\nuniform mediump float u_coord_ratio;\nuniform mediump vec2 u_delta; // in tile coordinates\nuniform mediump vec2 u_dimensions; // in tile coordinates\n\nvarying mediump vec2 v_tex;\n\nvoid main() {\n  mediump vec2 offests \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\n\n  v_tex \x3d a_pos;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/tileInfo.fs.glsl":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\n\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}\n","url:esri/layers/vectorTiles/views/2d/engine/webgl/stencil.vs.glsl":"attribute vec2 a_pos;\n\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}\n","url:esri/layers/vectorTiles/views/2d/engine/webgl/stencil.fs.glsl":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}\n",
"url:esri/layers/vectorTiles/views/2d/engine/webgl/bitblit.vs.glsl":"attribute vec2 a_pos;\nattribute vec2 a_tex;\n\nvarying mediump vec2 v_uv;\n\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}\n","url:esri/layers/vectorTiles/views/2d/engine/webgl/bitblit.fs.glsl":"\tuniform lowp sampler2D u_tex;\n\tuniform lowp float u_opacity;\n\n\tvarying mediump vec2 v_uv;\n\n\tvoid main() {\n\t\tlowp vec4 color \x3d texture2D(u_tex, v_uv);\n\n    // Note: output in pre-multiplied alpha for correct alpha compositing\n\t\tgl_FragColor \x3d color *  u_opacity;\n\t}\n",
"url:dgrid/css/TouchScroll.css":{},"*now":function(h){h(['dojo/i18n!*preload*dojo/nls/dojo*["ar","ca","cs","da","de","el","en-gb","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ru","sk","sl","sv","th","tr","zh-tw","zh-cn"]'])},"*noref":1}});(function(){var h=this.require;h({cache:{}});!h.async&&h(["dojo"]);h.boot&&h.apply(null,h.boot)})();