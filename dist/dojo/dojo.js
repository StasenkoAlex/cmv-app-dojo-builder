//>>built
(function(h,k){var a,f=function(){},b=function(a){for(var d in a)return 0;return 1},e={}.toString,l=function(a){return"[object Function]"==e.call(a)},m=function(a){return"[object String]"==e.call(a)},g=function(a){return"[object Array]"==e.call(a)},d=function(a,d){if(a)for(var c=0;c<a.length;)d(a[c++])},c=function(a,d){for(var c in d)a[c]=d[c];return a},n=function(a,d){return c(Error(a),{src:"dojoLoader",info:d})},q=1,t=function(){return"_"+q++},r=function(a,d,c){return wa(a,d,c,0,r)},v=this,u=v.document,
w=u&&u.createElement("DiV"),x=r.has=function(a){return l(y[a])?y[a]=y[a](v,u,w):y[a]},y=x.cache=k.hasCache;x.add=function(a,d,c,b){(void 0===y[a]||b)&&(y[a]=d);return c&&x(a)};x.add("host-webworker","undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope);x("host-webworker")&&(c(k.hasCache,{"host-browser":0,dom:0,"dojo-dom-ready-api":0,"dojo-sniff":0,"dojo-inject-api":1,"host-webworker":1,"dojo-guarantee-console":0}),k.loaderPatch={injectUrl:function(a,d){try{importScripts(a),d()}catch(Ya){console.error(Ya)}}});
for(var A in h.has)x.add(A,h.has[A],0,1);r.async=1;var z=x("csp-restrictions")?function(){}:new Function("return eval(arguments[0]);");r.eval=function(a,d){return z(a+"\r\n//# sourceURL\x3d"+d)};var B={},C=r.signal=function(a,c){var b=B[a];d(b&&b.slice(0),function(a){a.apply(null,g(c)?c:[c])})},D=r.on=function(a,d){var c=B[a]||(B[a]=[]);c.push(d);return{remove:function(){for(var a=0;a<c.length;a++)if(c[a]===d){c.splice(a,1);break}}}},E=[],F={},G=[],I={},J=r.map={},L=[],M={},H="",K={},P={};A={};var O=
0,S=function(a){var d,c,b,n;for(d in P)c=P[d],(b=d.match(/^url\:(.+)/))?K["url:"+Xa(b[1],a)]=c:"*now"==d?n=c:"*noref"!=d&&(b=Da(d,a,!0),K[b.mid]=K["url:"+b.url]=c);n&&n(oa(a));P={}},Q=function(a){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(a){return"\\"+a})},R=function(a,d){d.splice(0,d.length);for(var c in a)d.push([c,a[c],new RegExp("^"+Q(c)+"(/|$)"),c.length]);d.sort(function(a,d){return d[3]-a[3]});return d},aa=function(a,c){d(a,function(a){c.push([m(a[0])?new RegExp("^"+Q(a[0])+
"$"):a[0],a[1]])})},X=function(a){var d=a.name;d||(d=a,a={name:d});a=c({main:"main"},a);a.location=a.location?a.location:d;a.packageMap&&(J[d]=a.packageMap);a.main.indexOf("./")||(a.main=a.main.substring(2));I[d]=a},T=[],V=function(a,b,n){for(var g in a){"waitSeconds"==g&&(r.waitms=1E3*(a[g]||0));"cacheBust"==g&&(H=a[g]?m(a[g])?a[g]:(new Date).getTime()+"":"");if("baseUrl"==g||"combo"==g)r[g]=a[g];a[g]!==y&&(r.rawConfig[g]=a[g],"has"!=g&&x.add("config-"+g,a[g],0,b))}r.baseUrl||(r.baseUrl="./");/\/$/.test(r.baseUrl)||
(r.baseUrl+="/");for(g in a.has)x.add(g,a.has[g],0,b);d(a.packages,X);for(var e in a.packagePaths)d(a.packagePaths[e],function(a){var d=e+"/"+a;m(a)&&(a={name:a});a.location=d;X(a)});R(c(J,a.map),L);d(L,function(a){a[1]=R(a[1],[]);"*"==a[0]&&(L.star=a)});R(c(F,a.paths),G);aa(a.aliases,E);if(b)T.push({config:a.config});else for(g in a.config)b=Na(g,n),b.config=c(b.config||{},a.config[g]);a.cache&&(S(),P=a.cache,a.cache["*noref"]&&S());C("config",[a,r.rawConfig])};x("dojo-cdn");var da=u.getElementsByTagName("script");
a=0;for(var ga,la,Aa,ta;a<da.length;)if(ga=da[a++],(Aa=ga.getAttribute("src"))&&(ta=Aa.match(/(((.*)\/)|^)dojo\.js(\W|$)/i))&&(la=ta[3]||"",k.baseUrl=k.baseUrl||la,O=ga),Aa=ga.getAttribute("data-dojo-config")||ga.getAttribute("djConfig"))A=r.eval("({ "+Aa+" })","data-dojo-config"),O=ga;r.rawConfig={};V(k,1);x("dojo-cdn")&&((I.dojo.location=la)&&(la+="/"),I.dijit.location=la+"../dijit/",I.dojox.location=la+"../dojox/");V(h,1);V(A,1);var pa=function(a){N(function(){d(a.deps,pb)})},wa=function(a,d,b,
e,l){var q;if(m(a)){if((q=Na(a,e,!0))&&q.executed)return q.result;throw n("undefinedModule",a);}g(a)||(V(a,0,e),a=d,d=b);if(g(a))if(a.length){b="require*"+t();for(var u,v=[],w=0;w<a.length;)u=a[w++],v.push(Na(u,e));q=c(Ha("",b,0,""),{injected:2,deps:v,def:d||f,require:e?e.require:r,gc:1});M[q.mid]=q;pa(q);var h=ha&&!0;N(function(){W(q,h)});q.executed||ma.push(q);ea()}else d&&d();return l},oa=function(a){if(!a)return r;var d=a.require;d||(d=function(c,b,n){return wa(c,b,n,a,d)},a.require=c(d,r),d.module=
a,d.toUrl=function(d){return Xa(d,a)},d.toAbsMid=function(d){return Ta(d,a)});return d},ma=[],ia=[],ja={},za=function(a){a.injected=1;ja[a.mid]=1;a.url&&(ja[a.url]=a.pack||1);wb()},Ba=function(a){a.injected=2;delete ja[a.mid];a.url&&delete ja[a.url];b(ja)&&Ua()},ra=r.idle=function(){return!ia.length&&b(ja)&&!ma.length&&!ha},ua=function(a,d){if(d)for(var c=0;c<d.length;c++)if(d[c][2].test(a))return d[c];return 0},xa=function(a){var d=[],c,b;for(a=a.replace(/\\/g,"/").split("/");a.length;)c=a.shift(),
".."==c&&d.length&&".."!=b?(d.pop(),b=d[d.length-1]):"."!=c&&d.push(b=c);return d.join("/")},Ha=function(a,d,c,b){return{pid:a,mid:d,pack:c,url:b,executed:0,def:0}},Ia=function(a,c,b,g,e,f,q,m,r){var u,v,t,w;w=/^\./.test(a);if(/(^\/)|(\:)|(\.js$)/.test(a)||w&&!c)return Ha(0,a,0,a);a=xa(w?c.mid+"/../"+a:a);if(/^\./.test(a))throw n("irrationalPath",a);c&&(t=ua(c.mid,f));(t=(t=t||f.star)&&ua(a,t[1]))&&(a=t[1]+a.substring(t[3]));c=(ta=a.match(/^([^\/]+)(\/(.+))?$/))?ta[1]:"";(u=b[c])?a=c+"/"+(v=ta[3]||
u.main):c="";var h=0;d(m,function(d){var c=a.match(d[0]);c&&0<c.length&&(h=l(d[1])?a.replace(d[0],d[1]):d[1])});if(h)return Ia(h,0,b,g,e,f,q,m,r);if(b=g[a])return r?Ha(b.pid,b.mid,b.pack,b.url):g[a];g=(t=ua(a,q))?t[1]+a.substring(t[3]):c?u.location+"/"+v:a;/(^\/)|(\:)/.test(g)||(g=e+g);return Ha(c,a,u,xa(g+".js"))},Da=function(a,d,c){return Ia(a,d,I,M,r.baseUrl,c?[]:L,c?[]:G,c?[]:E)},Ja=function(a,d,c){return a.normalize?a.normalize(d,function(a){return Ta(a,c)}):Ta(d,c)},Ga=0,Na=function(a,d,c){var b,
n;(b=a.match(/^(.+?)\!(.*)$/))?(n=Na(b[1],d,c),5!==n.executed||n.load||Ra(n),n.load?(b=Ja(n,b[2],d),a=n.mid+"!"+(n.dynamic?++Ga+"!":"")+b):(b=b[2],a=n.mid+"!"+ ++Ga+"!waitingForPlugin"),a={plugin:n,mid:a,req:oa(d),prid:b}):a=Da(a,d);return M[a.mid]||!c&&(M[a.mid]=a)},Ta=r.toAbsMid=function(a,d){return Da(a,d).mid},Xa=r.toUrl=function(a,d){var c=Da(a+"/x",d),b=c.url;return ka(0===c.pid?a:b.substring(0,b.length-5))},Ma={injected:2,executed:5,def:3,result:3};la=function(a){return M[a]=c({mid:a},Ma)};
var Oa=la("require"),Y=la("exports"),va=la("module"),Ca={},fa=0,Ra=function(a){var d=a.result;a.dynamic=d.dynamic;a.normalize=d.normalize;a.load=d.load;return a},qa=function(a){var b={};d(a.loadQ,function(d){var n=Ja(a,d.prid,d.req.module),g=a.dynamic?d.mid.replace(/waitingForPlugin$/,n):a.mid+"!"+n,n=c(c({},d),{mid:g,prid:n,injected:0});M[g]&&M[g].injected||sa(M[g]=n);b[d.mid]=M[g];Ba(d);delete M[d.mid]});a.loadQ=0;var n=function(a){for(var d=a.deps||[],c=0;c<d.length;c++)(a=b[d[c].mid])&&(d[c]=
a)},g;for(g in M)n(M[g]);d(ma,n)},na=function(d){r.trace("loader-finish-exec",[d.mid]);d.executed=5;d.defOrder=fa++;d.loadQ&&(Ra(d),qa(d));for(a=0;a<ma.length;)ma[a]===d?ma.splice(a,1):a++;/^require\*/.test(d.mid)&&delete M[d.mid]},Va=[],W=function(a,d){if(4===a.executed)return r.trace("loader-circular-dependency",[Va.concat(a.mid).join("-\x3e")]),!a.def||d?Ca:a.cjs&&a.cjs.exports;if(!a.executed){if(!a.def)return Ca;var c=a.mid,b=a.deps||[],n,g=[],e=0;for(a.executed=4;n=b[e++];){n=n===Oa?oa(a):n===
Y?a.cjs.exports:n===va?a.cjs:W(n,d);if(n===Ca)return a.executed=0,r.trace("loader-exec-module",["abort",c]),Ca;g.push(n)}r.trace("loader-run-factory",[a.mid]);c=a.def;g=l(c)?c.apply(null,g):c;a.result=void 0===g&&a.cjs?a.cjs.exports:g;na(a)}return a.result},ha=0,N=function(a){try{ha++,a()}catch(hb){throw hb;}finally{ha--}ra()&&C("idle",[])},ea=function(){ha||N(function(){for(var a,d,c=0;c<ma.length;)a=fa,d=ma[c],W(d),a!=fa?c=0:c++})};void 0===x("dojo-loader-eval-hint-url")&&x.add("dojo-loader-eval-hint-url",
1);var ka="function"==typeof h.fixupUrl?h.fixupUrl:function(a){a+="";return a+(H?(/\?/.test(a)?"\x26":"?")+H:"")},sa=function(a){var d=a.plugin;5!==d.executed||d.load||Ra(d);var c=function(d){a.result=d;Ba(a);na(a);ea()};d.load?d.load(a.prid,a.req,c):d.loadQ?d.loadQ.push(a):(d.loadQ=[a],ma.unshift(d),pb(d))},ba=0,ca=0,U=0,yb=function(a,d){x("config-stripStrict")&&(a=a.replace(/(["'])use strict\1/g,""));U=1;a===ba?ba.call(null):r.eval(a,x("dojo-loader-eval-hint-url")?d.url:d.mid);U=0},pb=function(a){var d=
a.mid,b=a.url;if(!(a.executed||a.injected||ja[d]||a.url&&(a.pack&&ja[a.url]===a.pack||1==ja[a.url])))if(za(a),a.plugin)sa(a);else{var g=function(){zb(a);if(2!==a.injected){if(x("dojo-enforceDefine")){C("error",n("noDefine",a));return}Ba(a);c(a,Ma);r.trace("loader-define-nonmodule",[a.url])}ea()};(ba=K[d]||K["url:"+a.url])?(r.trace("loader-inject",["cache",a.mid,b]),yb(ba,a),g()):(r.trace("loader-inject",["script",a.mid,b]),ca=a,r.injectUrl(ka(b),g,a),ca=0)}},jb=function(a,d,b){r.trace("loader-define-module",
[a.mid,d]);if(2===a.injected)return C("error",n("multipleDefine",a)),a;c(a,{deps:d,def:b,cjs:{id:a.mid,uri:a.url,exports:a.result={},setExports:function(d){a.cjs.exports=d},config:function(){return a.config}}});for(var g=0;d[g];g++)d[g]=Na(d[g],a);Ba(a);l(b)||d.length||(a.result=b,na(a));return a},zb=function(a,c){for(var b=[],n,g;ia.length;)g=ia.shift(),c&&(g[0]=c.shift()),n=g[0]&&Na(g[0])||a,b.push([n,g[1],g[2]]);S(a);d(b,function(a){pa(jb.apply(null,a))})},Ua=f,wb=f;x.add("ie-event-behavior",u.attachEvent&&
"undefined"===typeof Windows&&("undefined"===typeof opera||"[object Opera]"!=opera.toString()));var rb=function(a,d,c,b){if(x("ie-event-behavior"))return a.attachEvent(c,b),function(){a.detachEvent(c,b)};a.addEventListener(d,b,!1);return function(){a.removeEventListener(d,b,!1)}},Ab=rb(window,"load","onload",function(){r.pageLoaded=1;try{"complete"!=u.readyState&&(u.readyState="complete")}catch(db){}Ab()}),da=u.getElementsByTagName("script");for(a=0;!O;)/^dojo/.test((ga=da[a++])&&ga.type)||(O=ga);
r.injectUrl=function(a,d,c){c=c.node=u.createElement("script");var b=rb(c,"load","onreadystatechange",function(a){a=a||window.event;var c=a.target||a.srcElement;if("load"===a.type||/complete|loaded/.test(c.readyState))b(),g(),d&&d()}),g=rb(c,"error","onerror",function(d){b();g();C("error",n("scriptError",[a,d]))});c.type="text/javascript";c.charset="utf-8";c.src=a;O.parentNode.insertBefore(c,O);return c};r.log=f;r.trace=f;ga=function(a,d,c){var b=arguments.length,g=["require","exports","module"],
e=[0,a,d];1==b?e=[0,l(a)?g:[],a]:2==b&&m(a)?e=[a,l(d)?g:[],d]:3==b&&(e=[a,d,c]);r.trace("loader-define",e.slice(0,2));if((b=e[0]&&Na(e[0]))&&!ja[b.mid])pa(jb(b,e[1],e[2]));else if(!x("ie-event-behavior")||U)ia.push(e);else{b=b||ca;if(!b)for(a in ja)if((g=M[a])&&g.node&&"interactive"===g.node.readyState){b=g;break}b?(S(b),pa(jb(b,e[1],e[2]))):C("error",n("ieDefineFailed",e[0]));ea()}};ga.amd={vendor:"dojotoolkit.org"};c(c(r,k.loaderPatch),h.loaderPatch);D("error",function(a){try{if(console.error(a),
a instanceof Error)for(var d in a);}catch(Ya){}});c(r,{uid:t,cache:K,packs:I});v.define||(v.define=ga,v.require=r,d(T,function(a){V(a)}),D=A.deps||h.deps||k.deps,A=A.callback||h.callback||k.callback,r.boot=D||A?[D||[],A]:0)})(this.dojoConfig||this.djConfig||this.require||{},{async:0,baseUrl:".",deps:["app/app"],hasCache:{"config-selectorEngine":"lite","config-tlmSiblingOfDojo":1,"dojo-built":1,"dojo-has-api":1,"dojo-loader":1,"dojo-undef-api":0,dom:1,"extend-esri":0,"host-browser":1},packages:[{location:"../cmv",
name:"cmv"},{location:"../dgrid",main:"OnDemandGrid",name:"dgrid"},{location:"../dgrid1",main:"OnDemandGrid",name:"dgrid1"},{location:"../dijit",name:"dijit"},{location:".",name:"dojo"},{location:"../dojox",name:"dojox"},{location:"../put-selector",main:"put",name:"put-selector"},{location:"../xstyle",name:"xstyle"},{location:"../esri",name:"esri"},{location:"../moment",name:"moment"},{location:"../dstore",main:"Store",name:"dstore"},{location:"../app",name:"app"},{location:"../flag-icon-css",name:"flag-icon-css"},
{location:"../font-awesome",name:"font-awesome"}],parseOnLoad:!0});
require({cache:{"app/app":function(){define("dojo/_base/declare viewer/_ControllerBase viewer/_ConfigMixin viewer/_LayoutMixin viewer/_MapMixin viewer/_WidgetsMixin xstyle/css!./css/main.css".split(" "),function(h,k,a,f,b,e){return h([a,f,b,e,k])})},"dojo/_base/declare":function(){define(["./kernel","../has","./lang"],function(h,k,a){function f(a,d){throw Error("declare"+(d?" "+d:"")+": "+a);}function b(a,d){for(var c=[],b=[{cls:0,refs:[]}],n={},g=1,e=a.length,l=0,q,m,r,u,v;l<e;++l){(q=a[l])?"[object Function]"!=
z.call(q)&&f("mixin #"+l+" is not a callable constructor.",d):f("mixin #"+l+" is unknown. Did you use dojo.require to pull it in?",d);m=q._meta?q._meta.bases:[q];r=0;for(q=m.length-1;0<=q;--q)u=m[q].prototype,u.hasOwnProperty("declaredClass")||(u.declaredClass="uniqName_"+C++),u=u.declaredClass,n.hasOwnProperty(u)||(n[u]={count:0,refs:[],cls:m[q]},++g),u=n[u],r&&r!==u&&(u.refs.push(r),++r.count),r=u;++r.count;b[0].refs.push(r)}for(;b.length;){r=b.pop();c.push(r.cls);for(--g;v=r.refs,1==v.length;){r=
v[0];if(!r||--r.count){r=0;break}c.push(r.cls);--g}if(r)for(l=0,e=v.length;l<e;++l)r=v[l],--r.count||b.push(r)}g&&f("can't build consistent linearization",d);q=a[0];c[0]=q?q._meta&&q===c[c.length-q._meta.bases.length]?q._meta.bases.length:1:0;return c}function e(a,d,c,b){var n,g,e,l,q,m,r=this._inherited=this._inherited||{};"string"===typeof a&&(n=a,a=d,d=c,c=b);if("function"===typeof a)e=a,a=d,d=c;else try{e=a.callee}catch(S){if(S instanceof TypeError)f("strict mode inherited() requires the caller function to be passed before arguments",
this.declaredClass);else throw S;}(n=n||e.nom)||f("can't deduce a name to call inherited()",this.declaredClass);c=b=0;l=this.constructor._meta;b=l.bases;m=r.p;if("constructor"!=n){if(r.c!==e&&(m=0,q=b[0],l=q._meta,l.hidden[n]!==e)){(g=l.chains)&&"string"==typeof g[n]&&f("calling chained method with inherited: "+n,this.declaredClass);do if(l=q._meta,g=q.prototype,l&&(g[n]===e&&g.hasOwnProperty(n)||l.hidden[n]===e))break;while(q=b[++m]);m=q?m:-1}if(q=b[++m])if(g=q.prototype,q._meta&&g.hasOwnProperty(n))c=
g[n];else{e=A[n];do if(g=q.prototype,(c=g[n])&&(q._meta?g.hasOwnProperty(n):c!==e))break;while(q=b[++m])}c=q&&c||A[n]}else{if(r.c!==e&&(m=0,(l=b[0]._meta)&&l.ctor!==e)){for((g=l.chains)&&"manual"===g.constructor||f("calling chained constructor with inherited",this.declaredClass);(q=b[++m])&&(!(l=q._meta)||l.ctor!==e););m=q?m:-1}for(;(q=b[++m])&&!(c=(l=q._meta)?l.ctor:q););c=q&&c}r.c=c;r.p=m;if(c)return!0===d?c:c.apply(this,d||a)}function l(a,d,c){return"string"===typeof a?"function"===typeof d?this.__inherited(a,
d,c,!0):this.__inherited(a,d,!0):"function"===typeof a?this.__inherited(a,d,!0):this.__inherited(a,!0)}function m(a,d,c,b){var n=this.getInherited(a,d,c);if(n)return n.apply(this,b||c||d||a)}function g(a){for(var d=this.constructor._meta.bases,c=0,b=d.length;c<b;++c)if(d[c]===a)return!0;return this instanceof a}function d(d,c){for(var b in c)"constructor"!=b&&c.hasOwnProperty(b)&&(d[b]=c[b]);if(k("bug-for-in-skips-shadowed"))for(var n=a._extraNames,g=n.length;g;)b=n[--g],"constructor"!=b&&c.hasOwnProperty(b)&&
(d[b]=c[b])}function c(a){x.safeMixin(this.prototype,a);return this}function n(a,d){a instanceof Array||"function"===typeof a||(d=a,a=void 0);d=d||{};a=a||[];return x([this].concat(a),d)}function q(a,d){return function(){var c=arguments,b=c,n=c[0],g,e;e=a.length;var f;if(!(this instanceof c.callee))return w(c);if(d&&(n&&n.preamble||this.preamble))for(f=Array(a.length),f[0]=c,g=0;;){(n=c[0])&&(n=n.preamble)&&(c=n.apply(this,c)||c);n=a[g].prototype;(n=n.hasOwnProperty("preamble")&&n.preamble)&&(c=n.apply(this,
c)||c);if(++g==e)break;f[g]=c}for(g=e-1;0<=g;--g)n=a[g],(n=(e=n._meta)?e.ctor:n)&&n.apply(this,f?f[g]:c);(n=this.postscript)&&n.apply(this,b)}}function t(a,d){return function(){var c=arguments,b=c,n=c[0];if(!(this instanceof c.callee))return w(c);d&&(n&&(n=n.preamble)&&(b=n.apply(this,b)||b),(n=this.preamble)&&n.apply(this,b));a&&a.apply(this,c);(n=this.postscript)&&n.apply(this,c)}}function r(a){return function(){var d=arguments,c=0,b,n;if(!(this instanceof d.callee))return w(d);for(;b=a[c];++c)if(b=
(n=b._meta)?n.ctor:b){b.apply(this,d);break}(b=this.postscript)&&b.apply(this,d)}}function v(a,d,c){return function(){var b,n,g=0,e=1;c&&(g=d.length-1,e=-1);for(;b=d[g];g+=e)n=b._meta,(b=(n?n.hidden:b.prototype)[a])&&b.apply(this,arguments)}}function u(a){B.prototype=a.prototype;a=new B;B.prototype=null;return a}function w(a){var d=a.callee,c=u(d);d.apply(c,a);return c}function x(m,w,h){"string"!=typeof m&&(h=w,w=m,m="");h=h||{};var C,B,E,F,G,K,P,O=1,S=w;"[object Array]"==z.call(w)?(K=b(w,m),E=K[0],
O=K.length-E,w=K[O]):(K=[0],w?"[object Function]"==z.call(w)?(E=w._meta,K=K.concat(E?E.bases:w)):f("base class is not a callable constructor.",m):null!==w&&f("unknown base class. Did you use dojo.require to pull it in?",m));if(w)for(B=O-1;;--B){C=u(w);if(!B)break;E=K[B];(E._meta?d:y)(C,E.prototype);F=k("csp-restrictions")?function(){}:new Function;F.superclass=w;F.prototype=C;w=C.constructor=F}else C={};x.safeMixin(C,h);E=h.constructor;E!==A.constructor&&(E.nom="constructor",C.constructor=E);for(B=
O-1;B;--B)(E=K[B]._meta)&&E.chains&&(P=y(P||{},E.chains));C["-chains-"]&&(P=y(P||{},C["-chains-"]));w&&w.prototype&&w.prototype["-chains-"]&&(P=y(P||{},w.prototype["-chains-"]));E=!P||!P.hasOwnProperty("constructor");K[0]=F=P&&"manual"===P.constructor?r(K):1==K.length?t(h.constructor,E):q(K,E);F._meta={bases:K,hidden:h,chains:P,parents:S,ctor:h.constructor};F.superclass=w&&w.prototype;F.extend=c;F.createSubclass=n;F.prototype=C;C.constructor=F;C.getInherited=l;C.isInstanceOf=g;C.inherited=D;C.__inherited=
e;m&&(C.declaredClass=m,a.setObject(m,F));if(P)for(G in P)C[G]&&"string"==typeof P[G]&&"constructor"!=G&&(E=C[G]=v(G,K,"after"===P[G]),E.nom=G);return F}var y=a.mixin,A=Object.prototype,z=A.toString,B,C=0;B=k("csp-restrictions")?function(){}:new Function;var D=h.config.isDebug?m:e;h.safeMixin=x.safeMixin=function(d,c){var b,n;for(b in c)n=c[b],n===A[b]&&b in A||"constructor"==b||("[object Function]"==z.call(n)&&(n.nom=b),d[b]=n);if(k("bug-for-in-skips-shadowed")&&c)for(var g=a._extraNames,e=g.length;e;)b=
g[--e],n=c[b],n===A[b]&&b in A||"constructor"==b||("[object Function]"==z.call(n)&&(n.nom=b),d[b]=n);return d};return h.declare=x})},"dojo/_base/kernel":function(){define(["../has","./config","require","module"],function(h,k,a,f){var b,e=function(){return this}(),l={},m={},g={config:k,global:e,dijit:l,dojox:m},l={dojo:["dojo",g],dijit:["dijit",l],dojox:["dojox",m]};f=a.map&&a.map[f.id.match(/[^\/]+/)[0]];for(b in f)l[b]?l[b][0]=f[b]:l[b]=[f[b],{}];for(b in l)f=l[b],f[1]._scopeName=f[0],k.noGlobals||
(e[f[0]]=f[1]);g.scopeMap=l;g.baseUrl=g.config.baseUrl=a.baseUrl;g.isAsync=a.async;g.locale=k.locale;k="$Rev: a1e2d9d $".match(/[0-9a-f]{7,}/);g.version={major:1,minor:12,patch:1,flag:"",revision:k?k[0]:NaN,toString:function(){var a=g.version;return a.major+"."+a.minor+"."+a.patch+a.flag+" ("+a.revision+")"}};h("csp-restrictions")||Function("d","d.eval \x3d function(){return d.global.eval ? d.global.eval(arguments[0]) : eval(arguments[0]);}")(g);g.exit=function(){};h("host-webworker");h.add("console-as-object",
function(){return Function.prototype.bind&&console&&"object"===typeof console.log});"undefined"!=typeof console||(console={});a="assert count debug dir dirxml error group groupEnd info profile profileEnd time timeEnd trace warn log".split(" ");var d;for(k=0;d=a[k++];)console[d]?h("console-as-object")&&(console[d]=Function.prototype.bind.call(console[d],console)):function(){var a=d+"";console[a]="log"in console?function(){var d=Array.prototype.slice.call(arguments);d.unshift(a+":");console.log(d.join(" "))}:
function(){};console[a]._fake=!0}();g.deprecated=g.experimental=function(){};g._hasResource={};return g})},"dojo/has":function(){define(["require","module"],function(h,k){var a=h.has||function(){};a.add("dom-addeventlistener",!!document.addEventListener);a.add("touch","ontouchstart"in document||"onpointerdown"in document&&0<navigator.maxTouchPoints||window.navigator.msMaxTouchPoints);a.add("touch-events","ontouchstart"in document);a.add("pointer-events","pointerEnabled"in window.navigator?window.navigator.pointerEnabled:
"PointerEvent"in window);a.add("MSPointer",window.navigator.msPointerEnabled);a.add("touch-action",a("touch")&&a("pointer-events"));a.add("device-width",screen.availWidth||innerWidth);var f=document.createElement("form");a.add("dom-attributes-explicit",0==f.attributes.length);a.add("dom-attributes-specified-flag",0<f.attributes.length&&40>f.attributes.length);a.clearElement=function(a){a.innerHTML="";return a};a.normalize=function(b,e){var f=b.match(/[\?:]|[^:\?]*/g),m=0,g=function(d){var c=f[m++];
if(":"==c)return 0;if("?"==f[m++]){if(!d&&a(c))return g();g(!0);return g(d)}return c||0};return(b=g())&&e(b)};a.load=function(a,e,f){a?e([a],f):f()};return a})},"dojo/_base/config":function(){define(["../has","require"],function(h,k){var a={},f=k.rawConfig,b;for(b in f)a[b]=f[b];!a.locale&&"undefined"!=typeof navigator&&(f=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language||navigator.userLanguage)&&(a.locale=f.toLowerCase());return a})},"dojo/_base/lang":function(){define(["./kernel",
"../has","../sniff"],function(h,k){k.add("bug-for-in-skips-shadowed",function(){for(var a in{toString:1})return 0;return 1});var a=k("bug-for-in-skips-shadowed")?"hasOwnProperty valueOf isPrototypeOf propertyIsEnumerable toLocaleString toString constructor".split(" "):[],f=a.length,b=function(a,c,b){b||(b=a[0]&&h.scopeMap[a[0]]?h.scopeMap[a.shift()][1]:h.global);try{for(var d=0;d<a.length;d++){var n=a[d];if(!(n in b))if(c)b[n]={};else return;b=b[n]}return b}catch(r){}},e=Object.prototype.toString,
l=function(a,c,b){return(b||[]).concat(Array.prototype.slice.call(a,c||0))},m=/\{([^\}]+)\}/g,g={_extraNames:a,_mixin:function(d,c,b){var n,g,e,l={};for(n in c)g=c[n],n in d&&(d[n]===g||n in l&&l[n]===g)||(d[n]=b?b(g):g);if(k("bug-for-in-skips-shadowed")&&c)for(e=0;e<f;++e)n=a[e],g=c[n],n in d&&(d[n]===g||n in l&&l[n]===g)||(d[n]=b?b(g):g);return d},mixin:function(a,c){a||(a={});for(var d=1,b=arguments.length;d<b;d++)g._mixin(a,arguments[d]);return a},setObject:function(a,c,n){var d=a.split(".");
a=d.pop();return(n=b(d,!0,n))&&a?n[a]=c:void 0},getObject:function(a,c,n){return a?b(a.split("."),c,n):n},exists:function(a,c){return void 0!==g.getObject(a,!1,c)},isString:function(a){return"string"==typeof a||a instanceof String},isArray:Array.isArray||function(a){return"[object Array]"==e.call(a)},isFunction:function(a){return"[object Function]"===e.call(a)},isObject:function(a){return void 0!==a&&(null===a||"object"==typeof a||g.isArray(a)||g.isFunction(a))},isArrayLike:function(a){return!!a&&
!g.isString(a)&&!g.isFunction(a)&&!(a.tagName&&"form"==a.tagName.toLowerCase())&&(g.isArray(a)||isFinite(a.length))},isAlien:function(a){return a&&!g.isFunction(a)&&/\{\s*\[native code\]\s*\}/.test(String(a))},extend:function(a,c){for(var d=1,b=arguments.length;d<b;d++)g._mixin(a.prototype,arguments[d]);return a},_hitchArgs:function(a,c){var d=g._toArray(arguments,2),b=g.isString(c);return function(){var n=g._toArray(arguments),e=b?(a||h.global)[c]:c;return e&&e.apply(a||this,d.concat(n))}},hitch:function(a,
c){if(2<arguments.length)return g._hitchArgs.apply(h,arguments);c||(c=a,a=null);if(g.isString(c)){a=a||h.global;if(!a[c])throw['lang.hitch: scope["',c,'"] is null (scope\x3d"',a,'")'].join("");return function(){return a[c].apply(a,arguments||[])}}return a?function(){return c.apply(a,arguments||[])}:c},delegate:function(){function a(){}return function(d,b){a.prototype=d;var c=new a;a.prototype=null;b&&g._mixin(c,b);return c}}(),_toArray:k("ie")?function(){function a(a,d,b){b=b||[];for(d=d||0;d<a.length;d++)b.push(a[d]);
return b}return function(d){return(d.item?a:l).apply(this,arguments)}}():l,partial:function(a){return g.hitch.apply(h,[null].concat(g._toArray(arguments)))},clone:function(a){if(!a||"object"!=typeof a||g.isFunction(a))return a;if(a.nodeType&&"cloneNode"in a)return a.cloneNode(!0);if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp)return new RegExp(a);var c,d,b;if(g.isArray(a))for(c=[],d=0,b=a.length;d<b;++d)d in a&&(c[d]=g.clone(a[d]));else c=a.constructor?new a.constructor:
{};return g._mixin(c,a,g.clone)},trim:String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replace:function(a,c,b){return a.replace(b||m,g.isFunction(c)?c:function(a,d){return g.getObject(d,!1,c)})}};g.mixin(h,g);return g})},"dojo/sniff":function(){define(["./has"],function(h){var k=navigator,a=k.userAgent,k=k.appVersion,f=parseFloat(k);h.add("air",0<=a.indexOf("AdobeAIR"));h.add("wp",parseFloat(a.split("Windows Phone")[1])||void 0);h.add("msapp",
parseFloat(a.split("MSAppHost/")[1])||void 0);h.add("khtml",0<=k.indexOf("Konqueror")?f:void 0);h.add("edge",parseFloat(a.split("Edge/")[1])||void 0);h.add("opr",parseFloat(a.split("OPR/")[1])||void 0);h.add("webkit",!h("wp")&&!h("edge")&&parseFloat(a.split("WebKit/")[1])||void 0);h.add("chrome",!h("edge")&&!h("opr")&&parseFloat(a.split("Chrome/")[1])||void 0);h.add("android",!h("wp")&&parseFloat(a.split("Android ")[1])||void 0);h.add("safari",!(0<=k.indexOf("Safari"))||h("wp")||h("chrome")||h("android")||
h("edge")||h("opr")?void 0:parseFloat(k.split("Version/")[1]));h.add("mac",0<=k.indexOf("Macintosh"));h.add("quirks","BackCompat"==document.compatMode);if(!h("wp")&&a.match(/(iPhone|iPod|iPad)/)){var b=RegExp.$1.replace(/P/,"p"),e=a.match(/OS ([\d_]+)/)?RegExp.$1:"1",e=parseFloat(e.replace(/_/,".").replace(/_/g,""));h.add(b,e);h.add("ios",e)}h.add("bb",(0<=a.indexOf("BlackBerry")||0<=a.indexOf("BB10"))&&parseFloat(a.split("Version/")[1])||void 0);h.add("trident",parseFloat(k.split("Trident/")[1])||
void 0);h.add("svg","undefined"!==typeof SVGAngle);h("webkit")||(0<=a.indexOf("Opera")&&h.add("opera",9.8<=f?parseFloat(a.split("Version/")[1])||f:f),!(0<=a.indexOf("Gecko"))||h("wp")||h("khtml")||h("trident")||h("edge")||h.add("mozilla",f),h("mozilla")&&h.add("ff",parseFloat(a.split("Firefox/")[1]||a.split("Minefield/")[1])||void 0),document.all&&!h("opera")&&(a=parseFloat(k.split("MSIE ")[1])||void 0,(k=document.documentMode)&&5!=k&&Math.floor(a)!=k&&(a=k),h.add("ie",a)),h.add("wii","undefined"!=
typeof opera&&opera.wiiremote));return h})},"cmv/viewer/js/viewer/_ControllerBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred"],function(h,k,a){return h(null,{constructor:function(a){k.mixin(this,a)},loadConfig:function(){return this.inherited(arguments)},postConfig:function(){return this.inherited(arguments)},startup:function(){var a=this.getInherited(arguments);this.startupDeferred=this.executeSync([this.loadConfig,this.postConfig]);this.startupDeferred.then(k.hitch(this,
function(){a.apply(this)}))},executeSync:function(f,b){b=b||new a;if(!f||!f.length)return b.resolve(),b;var e=k.hitch(this,f.splice(0,1)[0])();e?e.then(k.hitch(this,"executeSync",f,b)):this.executeSync(f,b);return b},handleError:function(a){if(this.config.isDebug&&"object"===typeof console)for(var b in a)a.hasOwnProperty(b)},mixinDeep:function(a,b){var e={},f;for(f in b)if(!(f in a&&(a[f]===b[f]||f in e&&e[f]===b[f])))try{a[f]=b[f].constructor===Object?this.mixinDeep(a[f],b[f]):b[f]}catch(m){a[f]=
b[f]}return a}})})},"dojo/Deferred":function(){define(["./has","./_base/lang","./errors/CancelError","./promise/Promise","require"],function(h,k,a,f,b){var e=Object.freeze||function(){},l=function(a,d,c,b,g){for(g=0;g<a.length;g++)m(a[g],d,c,b)},m=function(a,c,b,e){e=a[c];var n=a.deferred;if(e)try{var f=e(b);0===c?"undefined"!==typeof f&&d(n,c,f):f&&"function"===typeof f.then?(a.cancel=f.cancel,f.then(g(n,1),g(n,2),g(n,0))):d(n,1,f)}catch(w){d(n,2,w)}else d(n,c,b)},g=function(a,c){return function(b){d(a,
c,b)}},d=function(a,c,d){if(!a.isCanceled())switch(c){case 0:a.progress(d);break;case 1:a.resolve(d);break;case 2:a.reject(d)}},c=function(d){var b=this.promise=new f,n=this,g,v,u=!1,w=[];this.isResolved=b.isResolved=function(){return 1===g};this.isRejected=b.isRejected=function(){return 2===g};this.isFulfilled=b.isFulfilled=function(){return!!g};this.isCanceled=b.isCanceled=function(){return u};this.progress=function(a,c){if(g){if(!0===c)throw Error("This deferred has already been fulfilled.");return b}l(w,
0,a,null,n);return b};this.resolve=function(a,c){if(g){if(!0===c)throw Error("This deferred has already been fulfilled.");return b}l(w,g=1,v=a,null,n);w=null;return b};var h=this.reject=function(a,c){if(g){if(!0===c)throw Error("This deferred has already been fulfilled.");return b}l(w,g=2,v=a,void 0,n);w=null;return b};this.then=b.then=function(a,d,n){var e=[n,a,d];e.cancel=b.cancel;e.deferred=new c(function(a){return e.cancel&&e.cancel(a)});g&&!w?m(e,g,v,void 0):w.push(e);return e.deferred.promise};
this.cancel=b.cancel=function(c,b){if(!g){if(d){var n=d(c);c="undefined"===typeof n?c:n}u=!0;if(!g)return"undefined"===typeof c&&(c=new a),h(c),c;if(2===g&&v===c)return c}else if(!0===b)throw Error("This deferred has already been fulfilled.");};e(b)};c.prototype.toString=function(){return"[object Deferred]"};b&&b(c);return c})},"dojo/errors/CancelError":function(){define(["./create"],function(h){return h("CancelError",null,null,{dojoType:"cancel",log:!1})})},"dojo/errors/create":function(){define(["../_base/lang"],
function(h){return function(k,a,f,b){f=f||Error;var e=function(b){if(f===Error){Error.captureStackTrace&&Error.captureStackTrace(this,e);var l=Error.call(this,b),g;for(g in l)l.hasOwnProperty(g)&&(this[g]=l[g]);this.message=b;this.stack=l.stack}else f.apply(this,arguments);a&&a.apply(this,arguments)};e.prototype=h.delegate(f.prototype,b);e.prototype.name=k;return e.prototype.constructor=e}})},"dojo/promise/Promise":function(){define(["../_base/lang"],function(h){function k(){throw new TypeError("abstract");
}return h.extend(function(){},{then:function(a,f,b){k()},cancel:function(a,f){k()},isResolved:function(){k()},isRejected:function(){k()},isFulfilled:function(){k()},isCanceled:function(){k()},always:function(a){return this.then(a,a)},otherwise:function(a){return this.then(null,a)},trace:function(){return this},traceRejected:function(){return this},toString:function(){return"[object Promise]"}})})},"cmv/viewer/js/viewer/_ConfigMixin":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred"],
function(h,k,a){return h(null,{defaultConfig:"viewer",loadConfig:function(f){var b;f?(b=new a,f.then(k.hitch(this,function(){this.initConfigAsync().then(k.hitch(this,function(){this.initConfigSuccess(arguments);b.resolve()}),k.hitch(this,"initConfigError"))}))):(b=this.initConfigAsync(),b.then(k.hitch(this,"initConfigSuccess"),k.hitch(this,"initConfigError")));return this.inherited(arguments,[b])||b},initConfigAsync:function(){var f=new a,b="config/"+this.defaultConfig,e=window.location.search.match(/config=([^&]*)/i);
e&&0<e.length&&(b=e[1],0>b.indexOf("/")&&(b="config/"+b));require([b],function(a){f.resolve(a)});return f},initConfigSuccess:function(a){this.config=a;a.isDebug&&(window.app=this);this.mapClickMode={current:a.defaultMapClickMode,defaultMode:a.defaultMapClickMode}},initConfigError:function(a){this.handleError({source:"Controller",error:a})}})})},"cmv/viewer/js/viewer/_LayoutMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/topic dojo/_base/array dojo/on dojo/aspect dojo/dom dojo/query dojo/dom-style dojo/dom-class dojo/dom-geometry dojo/sniff dojo/Deferred put-selector dijit/layout/BorderContainer dijit/layout/ContentPane esri/dijit/PopupMobile dojo/text!./templates/mapOverlay.html".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w){return h(null,{panes:{left:{id:"sidebarLeft",placeAt:"outer",collapsible:!0,region:"left"},center:{id:"mapCenter",placeAt:"outer",region:"center",content:w}},collapseButtons:{},postConfig:function(){this.layoutDeferred=new q;return this.inherited(arguments)},startup:function(){this.config.layout=this.config.layout||{};this.addTopics();this.addTitles();this.detectTouchDevices();this.initPanes();this.mapDeferred.then(k.hitch(this,"createPanes"));this.layoutDeferred.resolve();
this.inherited(arguments)},addTopics:function(){a.subscribe("viewer/togglePane",k.hitch(this,function(a){this.togglePane(a.pane,a.show,a.suppressEvent)}));a.subscribe("viewer/loadWidget",k.hitch(this,function(a){this.widgetLoader(a.options,a.position)}));this.config.isDebug&&a.subscribe("viewer/handleError",k.hitch(this,"handleError"));a.subscribe("mapClickMode/setCurrent",k.hitch(this,function(c){this.mapClickMode.current=c;a.publish("mapClickMode/currentSet",c)}));a.subscribe("mapClickMode/setDefault",
k.hitch(this,function(){a.publish("mapClickMode/setCurrent",this.mapClickMode.defaultMode)}))},addTitles:function(){if(this.config.titles){var a=this.config.titles;if(a.header){var c=l.byId("headerTitleSpan");c&&(c.innerHTML=a.header)}a.subHeader&&(c=l.byId("subHeaderTitleSpan"))&&(c.innerHTML=a.subHeader);a.pageTitle&&(document.title=a.pageTitle)}},initPanes:function(){var a,c=this.config.panes||{};this.defaultPanes=k.clone(this.panes);for(a in this.panes)this.defaultPanes.hasOwnProperty(a)&&(c[a]=
k.mixin(this.defaultPanes[a],c[a]));var d=l.byId(this.config.layout.container)||document.body;this.panes.outer=(new r({id:"borderContainerOuter",design:"sidebar",gutters:!1})).placeAt(d);var b,n;for(a in c)c.hasOwnProperty(a)&&(d=k.clone(c[a]),b=this.panes[d.placeAt]||this.panes.outer,d.id=d.id||a,n=d.type,delete d.placeAt,delete d.type,delete d.collapsible,b&&("border"===n?this.panes[a]=(new r(d)).placeAt(b):d.region&&(this.panes[a]=(new v(d)).placeAt(b))));this.panes.outer.startup()},createPanes:function(){var a,
c=this.config.panes||{};for(a in this.panes)this.defaultPanes.hasOwnProperty(a)&&(c[a]=k.mixin(this.defaultPanes[a],c[a]));this.collapseButtonsPane=this.config.collapseButtonsPane||"outer";for(a in c)if(c.hasOwnProperty(a)){if(c[a].collapsible&&(this.collapseButtons[a]=t(this.panes[this.collapseButtonsPane].domNode,"div.sidebarCollapseButton.sidebar"+a+"CollapseButton.sidebarCollapseButton"+("bottom"===a||"top"===a?"Vert":"Horz")+" div.dijitIcon.button.close").parentNode,b(this.collapseButtons[a],
"click",k.hitch(this,"togglePane",a,null,!1)),this.positionSideBarToggle(a),"outer"===this.collapseButtonsPane)){var n=this.panes[a]._splitterWidget;n&&(e.after(n,"_startDrag",k.hitch(this,"_splitterStartDrag",a)),e.after(n,"_stopDrag",k.hitch(this,"_splitterStopDrag",a)))}void 0!==c[a].open&&this.togglePane(a,c[a].open,!0);"center"!==a&&this.panes[a]._splitterWidget&&(d.add(this.map.root.parentNode,"pane"+a),"right"===a&&this.panes.top&&d.add(this.panes.top.domNode,"pane"+a),"right"===a&&this.panes.bottom&&
d.add(this.panes.bottom.domNode,"pane"+a),"left"===a&&this.panes.top&&d.add(this.panes.top.domNode,"pane"+a),"left"===a&&this.panes.bottom&&d.add(this.panes.bottom.domNode,"pane"+a))}this.resizeLayout()},togglePane:function(c,d,b){if(this.panes[c]){var n=this.panes[c].domNode;if(n){var e=g.get(n,"display"),f;if("string"!==typeof d||"none"!==d&&"block"!==d)if("boolean"===typeof d)f=d?"block":"none";else if(void 0===d||null===d)f="none"===e?"block":"none";else{this.handleError({source:"_LayoutMixin",
error:'Invalid type passed as "show" property of "togglePane" function : '+typeof d});return}else f=d;d="block"===f;f!==e&&(g.set(n,"display",f),this.panes[c]._splitterWidget&&g.set(this.panes[c]._splitterWidget.domNode,"display",f),this.positionSideBarToggle(c),this.panes.outer&&this.panes.outer.resize(),b||a.publish("viewer/onTogglePane",{pane:c,show:d}))}}},positionSideBarToggle:function(a){var b=this.panes[a],n=this.collapseButtons[a];if(b&&n){var e=g.get(b.domNode,"display"),f="none"===e?"open":
"close";d.remove(n.children[0],"none"===e?"close":"open");d.add(n.children[0],f);if("outer"===this.collapseButtonsPane){var f=b._splitterWidget?0:-1,l="bottom"===a||"top"===a?"h":"w";"block"===e&&(f+=c.getMarginBox(b.domNode)[l]);b._splitterWidget&&(f+=c.getMarginBox(b._splitterWidget.domNode)[l]);g.set(n,a,f.toString()+"px");g.set(n,"display","block")}}},repositionSideBarButtons:function(){f.forEach(["left","right","top","bottom"],k.hitch(this,function(a){this.positionSideBarToggle(a)}))},resizeLayout:function(){this.panes.outer.resize()},
_splitterStartDrag:function(a){g.set(this.collapseButtons[a],"display","none")},_splitterStopDrag:function(a){this.positionSideBarToggle(a)},detectTouchDevices:function(){n("touch")&&(n("ios")||n("android")||n("bb"))&&(n.add("mobile",!0),500>screen.availWidth||500>screen.availHeight?n.add("phone",!0):n.add("tablet",!0),n("phone")&&!this.config.mapOptions.infoWindow&&(this.config.mapOptions.infoWindow=new u(null,t("div"))))}})})},"dojo/topic":function(){define(["./Evented"],function(h){var k=new h;
return{publish:function(a,f){return k.emit.apply(k,arguments)},subscribe:function(a,f){return k.on.apply(k,arguments)}}})},"dojo/Evented":function(){define(["./aspect","./on"],function(h,k){function a(){}var f=h.after;a.prototype={on:function(a,e){return k.parse(this,a,e,function(a,b){return f(a,"on"+b,e,!0)})},emit:function(a,e){var b=[this];b.push.apply(b,arguments);return k.emit.apply(k,b)}};return a})},"dojo/aspect":function(){define([],function(){function h(a,b,g,d){var c=a[b],n="around"==b,
e;if(n){var f=g(function(){return c.advice(this,arguments)});e={remove:function(){f&&(f=a=g=null)},advice:function(a,d){return f?f.apply(a,d):c.advice(a,d)}}}else e={remove:function(){if(e.advice){var c=e.previous,d=e.next;d||c?(c?c.next=d:a[b]=d,d&&(d.previous=c)):delete a[b];a=g=e.advice=null}},id:a.nextId++,advice:g,receiveArguments:d};if(c&&!n)if("after"==b){for(;c.next&&(c=c.next););c.next=e;e.previous=c}else"before"==b&&(a[b]=e,e.next=c,c.previous=e);else a[b]=e;return e}function k(b){return function(e,
g,d,c){var n=e[g],f;n&&n.target==e||(e[g]=f=function(){for(var c=f.nextId,d=arguments,b=f.before;b;)b.advice&&(d=b.advice.apply(this,d)||d),b=b.next;if(f.around)var n=f.around.advice(this,d);for(b=f.after;b&&b.id<c;){if(b.advice)if(b.receiveArguments)var g=b.advice.apply(this,d),n=g===a?n:g;else n=b.advice.call(this,n,d);b=b.next}return n},n&&(f.around={advice:function(a,c){return n.apply(a,c)}}),f.target=e,f.nextId=f.nextId||0);e=h(f||n,b,d,c);d=null;return e}}var a,f=k("after"),b=k("before"),e=
k("around");return{before:b,around:e,after:f}})},"dojo/on":function(){define(["./has!dom-addeventlistener?:./aspect","./_base/kernel","./sniff"],function(h,k,a){function f(c,d,b,e,f){if(e=d.match(/(.*):(.*)/))return d=e[2],e=e[1],m.selector(e,d).call(f,c,b);a("touch")&&(g.test(d)&&(b=B(b)),a("event-orientationchange")||"orientationchange"!=d||(d="resize",c=window,b=B(b)));t&&(b=t(b));if(c.addEventListener){var l=d in n,r=l?n[d]:d;c.addEventListener(r,b,l);return{remove:function(){c.removeEventListener(r,
b,l)}}}if(w&&c.attachEvent)return w(c,"on"+d,b);throw Error("Target must be an event emitter");}function b(){this.cancelable=!1;this.defaultPrevented=!0}function e(){this.bubbles=!1}var l=window.ScriptEngineMajorVersion;a.add("jscript",l&&l()+ScriptEngineMinorVersion()/10);a.add("event-orientationchange",a("touch")&&!a("android"));a.add("event-stopimmediatepropagation",window.Event&&!!window.Event.prototype&&!!window.Event.prototype.stopImmediatePropagation);a.add("event-focusin",function(a,c,d){return"onfocusin"in
d});a("touch")&&a.add("touch-can-modify-event-delegate",function(){var a=function(){};a.prototype=document.createEvent("MouseEvents");try{var c=new a;c.target=null;return null===c.target}catch(E){return!1}});var m=function(a,c,d,b){return"function"!=typeof a.on||"function"==typeof c||a.nodeType?m.parse(a,c,d,f,b,this):a.on(c,d)};m.pausable=function(a,c,d,b){var n;a=m(a,c,function(){if(!n)return d.apply(this,arguments)},b);a.pause=function(){n=!0};a.resume=function(){n=!1};return a};m.once=function(a,
c,d,b){var n=m(a,c,function(){n.remove();return d.apply(this,arguments)});return n};m.parse=function(a,c,d,b,n,g){var e;if(c.call)return c.call(g,a,d);c instanceof Array?e=c:-1<c.indexOf(",")&&(e=c.split(/\s*,\s*/));if(e){var f=[];c=0;for(var l;l=e[c++];)f.push(m.parse(a,l,d,b,n,g));f.remove=function(){for(var a=0;a<f.length;a++)f[a].remove()};return f}return b(a,c,d,n,g)};var g=/^touch/;m.matches=function(a,c,d,b,n){n=n&&"function"==typeof n.matches?n:k.query;b=!1!==b;1!=a.nodeType&&(a=a.parentNode);
for(;!n.matches(a,c,d);)if(a==d||!1===b||!(a=a.parentNode)||1!=a.nodeType)return!1;return a};m.selector=function(a,c,d){return function(b,n){function g(c){return m.matches(c,a,b,d,e)}var e="function"==typeof a?{matches:a}:this,f=c.bubble;return f?m(b,f(g),n):m(b,c,function(a){var c=g(a.target);if(c)return a.selectorTarget=c,n.call(c,a)})}};var d=[].slice,c=m.emit=function(a,c,n){var g=d.call(arguments,2),f="on"+c;if("parentNode"in a){var l=g[0]={},m;for(m in n)l[m]=n[m];l.preventDefault=b;l.stopPropagation=
e;l.target=a;l.type=c;n=l}do a[f]&&a[f].apply(a,g);while(n&&n.bubbles&&(a=a.parentNode));return n&&n.cancelable&&n},n=a("event-focusin")?{}:{focusin:"focus",focusout:"blur"};if(!a("event-stopimmediatepropagation"))var q=function(){this.modified=this.immediatelyStopped=!0},t=function(a){return function(c){if(!c.immediatelyStopped)return c.stopImmediatePropagation=q,a.apply(this,arguments)}};if(a("dom-addeventlistener"))m.emit=function(a,d,b){if(a.dispatchEvent&&document.createEvent){var n=(a.ownerDocument||
document).createEvent("HTMLEvents");n.initEvent(d,!!b.bubbles,!!b.cancelable);for(var g in b)g in n||(n[g]=b[g]);return a.dispatchEvent(n)&&n}return c.apply(m,arguments)};else{m._fixEvent=function(a,c){a||(a=(c&&(c.ownerDocument||c.document||c).parentWindow||window).event);if(!a)return a;try{r&&a.type==r.type&&a.srcElement==r.target&&(a=r)}catch(F){}if(!a.target)switch(a.target=a.srcElement,a.currentTarget=c||a.srcElement,"mouseover"==a.type&&(a.relatedTarget=a.fromElement),"mouseout"==a.type&&(a.relatedTarget=
a.toElement),a.stopPropagation||(a.stopPropagation=x,a.preventDefault=y),a.type){case "keypress":var d="charCode"in a?a.charCode:a.keyCode;10==d?(d=0,a.keyCode=13):13==d||27==d?d=0:3==d&&(d=99);a.charCode=d;d=a;d.keyChar=d.charCode?String.fromCharCode(d.charCode):"";d.charOrCode=d.keyChar||d.keyCode}return a};var r,v=function(a){this.handle=a};v.prototype.remove=function(){delete _dojoIEListeners_[this.handle]};var u=function(a){return function(c){c=m._fixEvent(c,this);var d=a.call(this,c);c.modified&&
(r||setTimeout(function(){r=null}),r=c);return d}},w=function(c,d,b){b=u(b);if(((c.ownerDocument?c.ownerDocument.parentWindow:c.parentWindow||c.window||window)!=top||5.8>a("jscript"))&&!a("config-_allow_leaks")){"undefined"==typeof _dojoIEListeners_&&(_dojoIEListeners_=[]);var n=c[d];if(!n||!n.listeners){var g=n,n=Function("event","var callee \x3d arguments.callee; for(var i \x3d 0; i\x3ccallee.listeners.length; i++){var listener \x3d _dojoIEListeners_[callee.listeners[i]]; if(listener){listener.call(this,event);}}");
n.listeners=[];c[d]=n;n.global=this;g&&n.listeners.push(_dojoIEListeners_.push(g)-1)}n.listeners.push(c=n.global._dojoIEListeners_.push(b)-1);return new v(c)}return h.after(c,d,b,!0)},x=function(){this.cancelBubble=!0},y=m._preventDefault=function(){this.bubbledKeyCode=this.keyCode;if(this.ctrlKey)try{this.keyCode=0}catch(C){}this.defaultPrevented=!0;this.returnValue=!1;this.modified=!0}}if(a("touch"))var A=function(){},z=window.orientation,B=function(c){return function(d){var b=d.corrected;if(!b){var n=
d.type;try{delete d.type}catch(J){}if(d.type){if(a("touch-can-modify-event-delegate"))A.prototype=d,b=new A;else{var b={},g;for(g in d)b[g]=d[g]}b.preventDefault=function(){d.preventDefault()};b.stopPropagation=function(){d.stopPropagation()}}else b=d,b.type=n;d.corrected=b;if("resize"==n){if(z==window.orientation)return null;z=window.orientation;b.type="orientationchange";return c.call(this,b)}"rotation"in b||(b.rotation=0,b.scale=1);var n=b.changedTouches[0],e;for(e in n)delete b[e],b[e]=n[e]}return c.call(this,
b)}};return m})},"dojo/_base/array":function(){define(["./kernel","../has","./lang"],function(h,k,a){function f(a){return l[a]=new Function("item","index","array",a)}function b(a){var c=!a;return function(d,b,g){var n=0,e=d&&d.length||0,m;e&&"string"==typeof d&&(d=d.split(""));"string"==typeof b&&(b=l[b]||f(b));if(g)for(;n<e;++n){if(m=!b.call(g,d[n],n,d),a^m)return!m}else for(;n<e;++n)if(m=!b(d[n],n,d),a^m)return!m;return c}}function e(a){var c=1,d=0,b=0;a||(c=d=b=-1);return function(n,e,f,l){if(l&&
0<c)return g.lastIndexOf(n,e,f);l=n&&n.length||0;var r=a?l+b:d;f===m?f=a?d:l+b:0>f?(f=l+f,0>f&&(f=d)):f=f>=l?l+b:f;for(l&&"string"==typeof n&&(n=n.split(""));f!=r;f+=c)if(n[f]==e)return f;return-1}}var l={},m,g={every:b(!1),some:b(!0),indexOf:e(!0),lastIndexOf:e(!1),forEach:function(a,c,b){var d=0,n=a&&a.length||0;n&&"string"==typeof a&&(a=a.split(""));"string"==typeof c&&(c=l[c]||f(c));if(b)for(;d<n;++d)c.call(b,a[d],d,a);else for(;d<n;++d)c(a[d],d,a)},map:function(a,c,b,g){var d=0,n=a&&a.length||
0;g=new (g||Array)(n);n&&"string"==typeof a&&(a=a.split(""));"string"==typeof c&&(c=l[c]||f(c));if(b)for(;d<n;++d)g[d]=c.call(b,a[d],d,a);else for(;d<n;++d)g[d]=c(a[d],d,a);return g},filter:function(a,c,b){var d=0,n=a&&a.length||0,g=[],e;n&&"string"==typeof a&&(a=a.split(""));"string"==typeof c&&(c=l[c]||f(c));if(b)for(;d<n;++d)e=a[d],c.call(b,e,d,a)&&g.push(e);else for(;d<n;++d)e=a[d],c(e,d,a)&&g.push(e);return g},clearCache:function(){l={}}};a.mixin(h,g);return g})},"dojo/dom":function(){define(["./sniff",
"./_base/window","./_base/kernel"],function(h,k,a){if(7>=h("ie"))try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}var f={};h("ie")?f.byId=function(a,b){if("string"!=typeof a)return a;var e=b||k.doc,g=a&&e.getElementById(a);if(!g||g.attributes.id.value!=a&&g.id!=a){e=e.all[a];if(!e||e.nodeName)e=[e];for(var d=0;g=e[d++];)if(g.attributes&&g.attributes.id&&g.attributes.id.value==a||g.id==a)return g}else return g}:f.byId=function(a,b){return("string"==typeof a?(b||k.doc).getElementById(a):
a)||null};a=a.global.document||null;h.add("dom-contains",!(!a||!a.contains));f.isDescendant=h("dom-contains")?function(a,b){return!(!(b=f.byId(b))||!b.contains(f.byId(a)))}:function(a,b){try{for(a=f.byId(a),b=f.byId(b);a;){if(a==b)return!0;a=a.parentNode}}catch(m){}return!1};h.add("css-user-select",function(a,b,f){if(!f)return!1;a=f.style;b=["Khtml","O","Moz","Webkit"];f=b.length;var g="userSelect";do if("undefined"!==typeof a[g])return g;while(f--&&(g=b[f]+"UserSelect"));return!1});var b=h("css-user-select");
f.setSelectable=b?function(a,l){f.byId(a).style[b]=l?"":"none"}:function(a,b){a=f.byId(a);var e=a.getElementsByTagName("*"),g=e.length;if(b)for(a.removeAttribute("unselectable");g--;)e[g].removeAttribute("unselectable");else for(a.setAttribute("unselectable","on");g--;)e[g].setAttribute("unselectable","on")};return f})},"dojo/_base/window":function(){define(["./kernel","./lang","../sniff"],function(h,k,a){var f={global:h.global,doc:h.global.document||null,body:function(a){a=a||h.doc;return a.body||
a.getElementsByTagName("body")[0]},setContext:function(a,e){h.global=f.global=a;h.doc=f.doc=e},withGlobal:function(a,e,l,m){var b=h.global;try{return h.global=f.global=a,f.withDoc.call(null,a.document,e,l,m)}finally{h.global=f.global=b}},withDoc:function(b,e,l,m){var g=f.doc,d=a("quirks"),c=a("ie"),n,q,t;try{return h.doc=f.doc=b,h.isQuirks=a.add("quirks","BackCompat"==h.doc.compatMode,!0,!0),a("ie")&&(t=b.parentWindow)&&t.navigator&&(n=parseFloat(t.navigator.appVersion.split("MSIE ")[1])||void 0,
(q=b.documentMode)&&5!=q&&Math.floor(n)!=q&&(n=q),h.isIE=a.add("ie",n,!0,!0)),l&&"string"==typeof e&&(e=l[e]),e.apply(l,m||[])}finally{h.doc=f.doc=g,h.isQuirks=a.add("quirks",d,!0,!0),h.isIE=a.add("ie",c,!0,!0)}}};k.mixin(h,f);return f})},"dojo/query":function(){define("./_base/kernel ./has ./dom ./on ./_base/array ./_base/lang ./selector/_loader ./selector/_loader!default".split(" "),function(h,k,a,f,b,e,l,m){function g(c,d){var n=function(b,n){if("string"==typeof n&&(n=a.byId(n),!n))return new d([]);
var g="string"==typeof b?c(b,n):b?b.end&&b.on?b:[b]:[];return g.end&&g.on?g:new d(g)};n.matches=c.match||function(a,c,d){return 0<n.filter([a],c,d).length};n.filter=c.filter||function(a,c,d){return n(c,d).filter(function(c){return-1<b.indexOf(a,c)})};if("function"!=typeof c){var g=c.search;c=function(a,c){return g(c||document,a)}}return n}k.add("array-extensible",function(){return 1==e.delegate([],{length:1}).length&&!k("bug-for-in-skips-shadowed")});var d=Array.prototype,c=d.slice,n=d.concat,q=b.forEach,
t=function(a,d,b){d=[0].concat(c.call(d,0));b=b||h.global;return function(c){d[0]=c;return a.apply(b,d)}},r=function(a){var c=this instanceof v&&k("array-extensible");"number"==typeof a&&(a=Array(a));var d=a&&"length"in a?a:arguments;if(c||!d.sort){for(var b=c?this:[],n=b.length=d.length,g=0;g<n;g++)b[g]=d[g];if(c)return b;d=b}e._mixin(d,u);d._NodeListCtor=function(a){return v(a)};return d},v=r,u=v.prototype=k("array-extensible")?[]:{};v._wrap=u._wrap=function(a,c,d){a=new (d||this._NodeListCtor||
v)(a);return c?a._stash(c):a};v._adaptAsMap=function(a,c){return function(){return this.map(t(a,arguments,c))}};v._adaptAsForEach=function(a,c){return function(){this.forEach(t(a,arguments,c));return this}};v._adaptAsFilter=function(a,c){return function(){return this.filter(t(a,arguments,c))}};v._adaptWithCondition=function(a,c,d){return function(){var b=arguments,n=t(a,b,d);if(c.call(d||h.global,b))return this.map(n);this.forEach(n);return this}};q(["slice","splice"],function(a){var c=d[a];u[a]=
function(){return this._wrap(c.apply(this,arguments),"slice"==a?this:null)}});q(["indexOf","lastIndexOf","every","some"],function(a){var d=b[a];u[a]=function(){return d.apply(h,[this].concat(c.call(arguments,0)))}});e.extend(r,{constructor:v,_NodeListCtor:v,toString:function(){return this.join(",")},_stash:function(a){this._parent=a;return this},on:function(a,c){var d=this.map(function(d){return f(d,a,c)});d.remove=function(){for(var a=0;a<d.length;a++)d[a].remove()};return d},end:function(){return this._parent?
this._parent:new this._NodeListCtor(0)},concat:function(a){var d=c.call(this,0),g=b.map(arguments,function(a){return c.call(a,0)});return this._wrap(n.apply(d,g),this)},map:function(a,c){return this._wrap(b.map(this,a,c),this)},forEach:function(a,c){q(this,a,c);return this},filter:function(a){var c=arguments,d=this,n=0;if("string"==typeof a){d=w._filterResult(this,c[0]);if(1==c.length)return d._stash(this);n=1}return this._wrap(b.filter(d,c[n],c[n+1]),this)},instantiate:function(a,c){var d=e.isFunction(a)?
a:e.getObject(a);c=c||{};return this.forEach(function(a){new d(c,a)})},at:function(){var a=new this._NodeListCtor(0);q(arguments,function(c){0>c&&(c=this.length+c);this[c]&&a.push(this[c])},this);return a._stash(this)}});var w=g(m,r);h.query=g(m,function(a){return r(a)});w.load=function(a,c,d){l.load(a,c,function(a){d(g(a,r))})};h._filterQueryResult=w._filterResult=function(a,c,d){return new r(w.filter(a,c,d))};h.NodeList=w.NodeList=r;return w})},"dojo/selector/_loader":function(){define(["../has",
"require"],function(h,k){if("undefined"!==typeof document){var a=document.createElement("div");h.add("dom-qsa2.1",!!a.querySelectorAll);h.add("dom-qsa3",function(){try{return a.innerHTML="\x3cp class\x3d'TEST'\x3e\x3c/p\x3e",1==a.querySelectorAll(".TEST:empty").length}catch(b){}})}var f;return{load:function(a,e,l,m){if(m&&m.isBuild)l();else{m=k;a="default"==a?h("config-selectorEngine")||"css3":a;a="css2"==a||"lite"==a?"./lite":"css2.1"==a?h("dom-qsa2.1")?"./lite":"./acme":"css3"==a?h("dom-qsa3")?
"./lite":"./acme":"acme"==a?"./acme":(m=e)&&a;if("?"==a.charAt(a.length-1)){a=a.substring(0,a.length-1);var b=!0}if(b&&(h("dom-compliant-qsa")||f))return l(f);m([a],function(d){"./lite"!=a&&(f=d);l(d)})}}}})},"dojo/selector/lite":function(){define(["../has","../_base/kernel"],function(h,k){var a=document.createElement("div"),f=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector,b=a.querySelectorAll,e=/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g;
h.add("dom-matches-selector",!!f);h.add("dom-qsa",!!b);var l=function(a,n){if(d&&-1<a.indexOf(","))return d(a,n);var c=n?n.ownerDocument||n:k.doc||document,e=(b?/^([\w]*)#([\w\-]+$)|^(\.)([\w\-\*]+$)|^(\w+$)/:/^([\w]*)#([\w\-]+)(?:\s+(.*))?$|(?:^|(>|.+\s+))([\w\-\*]+)(\S*$)/).exec(a);n=n||c;if(e){var f=8===h("ie")&&h("quirks")?n.nodeType===c.nodeType:null!==n.parentNode&&9!==n.nodeType&&n.parentNode===c;if(e[2]&&f){var v=k.byId?k.byId(e[2],c):c.getElementById(e[2]);if(!v||e[1]&&e[1]!=v.tagName.toLowerCase())return[];
if(n!=c)for(c=v;c!=n;)if(c=c.parentNode,!c)return[];return e[3]?l(e[3],v):[v]}if(e[3]&&n.getElementsByClassName)return n.getElementsByClassName(e[4]);if(e[5])if(v=n.getElementsByTagName(e[5]),e[4]||e[6])a=(e[4]||"")+e[6];else return v}if(b)return 1===n.nodeType&&"object"!==n.nodeName.toLowerCase()?m(n,a,n.querySelectorAll):n.querySelectorAll(a);v||(v=n.getElementsByTagName("*"));e=[];c=0;for(f=v.length;c<f;c++){var u=v[c];1==u.nodeType&&g(u,a,n)&&e.push(u)}return e},m=function(a,d,b){var c=a,n=a.getAttribute("id"),
g=n||"__dojo__",f=a.parentNode,l=/^\s*[+~]/.test(d);if(l&&!f)return[];n?g=g.replace(/'/g,"\\$\x26"):a.setAttribute("id",g);l&&f&&(a=a.parentNode);d=d.match(e);for(f=0;f<d.length;f++)d[f]="[id\x3d'"+g+"'] "+d[f];d=d.join(",");try{return b.call(a,d)}finally{n||c.removeAttribute("id")}};if(!h("dom-matches-selector"))var g=function(){function c(a,c,d){var b=c.charAt(0);if('"'==b||"'"==b)c=c.slice(1,-1);c=c.replace(/\\/g,"");var n=l[d||""];return function(d){return(d=d.getAttribute(a))&&n(d,c)}}function d(a){return function(c,
d){for(;(c=c.parentNode)!=d;)if(a(c,d))return!0}}function b(a){return function(c,d){c=c.parentNode;return a?c!=d&&a(c,d):c==d}}function g(a,c){return a?function(d,b){return c(d)&&a(d,b)}:c}var e="div"==a.tagName?"toLowerCase":"toUpperCase",f={"":function(a){a=a[e]();return function(c){return c.tagName==a}},".":function(a){var c=" "+a+" ";return function(d){return-1<d.className.indexOf(a)&&-1<(" "+d.className+" ").indexOf(c)}},"#":function(a){return function(c){return c.id==a}}},l={"^\x3d":function(a,
c){return 0==a.indexOf(c)},"*\x3d":function(a,c){return-1<a.indexOf(c)},"$\x3d":function(a,c){return a.substring(a.length-c.length,a.length)==c},"~\x3d":function(a,c){return-1<(" "+a+" ").indexOf(" "+c+" ")},"|\x3d":function(a,c){return 0==(a+"-").indexOf(c+"-")},"\x3d":function(a,c){return a==c},"":function(a,c){return!0}},m={};return function(a,n,e){var l=m[n];if(!l){if(n.replace(/(?:\s*([> ])\s*)|(#|\.)?((?:\\.|[\w-])+)|\[\s*([\w-]+)\s*(.?=)?\s*("(?:\\.|[^"])+"|'(?:\\.|[^'])+'|(?:\\.|[^\]])*)\s*\]/g,
function(a,n,e,m,r,u,q){m?l=g(l,f[e||""](m.replace(/\\/g,""))):n?l=(" "==n?d:b)(l):r&&(l=g(l,c(r,q,u)));return""}))throw Error("Syntax error in query");if(!l)return!0;m[n]=l}return l(a,e)}}();if(!h("dom-qsa"))var d=function(a,d){for(var c=a.match(e),b=[],n=0;n<c.length;n++){a=new String(c[n].replace(/\s*$/,""));a.indexOf=escape;for(var g=l(a,d),f=0,m=g.length;f<m;f++){var h=g[f];b[h.sourceIndex]=h}}c=[];for(n in b)c.push(b[n]);return c};l.match=f?function(a,d,b){return b&&9!=b.nodeType?m(b,d,function(c){return f.call(a,
c)}):f.call(a,d)}:g;return l})},"dojo/dom-style":function(){define(["./sniff","./dom","./_base/window"],function(h,k,a){function f(a,d,b){d=d.toLowerCase();if("auto"==b){if("height"==d)return a.offsetHeight;if("width"==d)return a.offsetWidth}if("fontweight"==d)switch(b){case 700:return"bold";default:return"normal"}d in c||(c[d]=n.test(d));return c[d]?l(a,b):b}var b,e={};b=h("webkit")?function(a){var c;if(1==a.nodeType){var d=a.ownerDocument.defaultView;c=d.getComputedStyle(a,null);!c&&a.style&&(a.style.display=
"",c=d.getComputedStyle(a,null))}return c||{}}:h("ie")&&(9>h("ie")||h("quirks"))?function(a){return 1==a.nodeType&&a.currentStyle?a.currentStyle:{}}:function(c){if(1===c.nodeType){var d=c.ownerDocument.defaultView;return(d.opener?d:a.global.window).getComputedStyle(c,null)}return{}};e.getComputedStyle=b;var l;l=h("ie")?function(a,c){if(!c)return 0;if("medium"==c)return 4;if(c.slice&&"px"==c.slice(-2))return parseFloat(c);var d=a.style,b=a.runtimeStyle,n=d.left,g=b.left;b.left=a.currentStyle.left;
try{d.left=c,c=d.pixelLeft}catch(y){c=0}d.left=n;b.left=g;return c}:function(a,c){return parseFloat(c)||0};e.toPixelValue=l;var m=function(a,c){try{return a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(v){return c?{}:null}},g=9>h("ie")||10>h("ie")&&h("quirks")?function(a){try{return m(a).Opacity/100}catch(r){return 1}}:function(a){return b(a).opacity},d=9>h("ie")||10>h("ie")&&h("quirks")?function(a,c){""===c&&(c=1);var b=100*c;1===c?(a.style.zoom="",m(a)&&(a.style.filter=a.style.filter.replace(/\s*progid:DXImageTransform.Microsoft.Alpha\([^\)]+?\)/i,
""))):(a.style.zoom=1,m(a)?m(a,1).Opacity=b:a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity\x3d"+b+")",m(a,1).Enabled=!0);if("tr"==a.tagName.toLowerCase())for(b=a.firstChild;b;b=b.nextSibling)"td"==b.tagName.toLowerCase()&&d(b,c);return c}:function(a,c){return a.style.opacity=c},c={left:!0,top:!0},n=/margin|padding|width|height|max|min|offset/,q={cssFloat:1,styleFloat:1,"float":1};e.get=function(a,c){var d=k.byId(a),b=arguments.length;if(2==b&&"opacity"==c)return g(d);c=q[c]?"cssFloat"in
d.style?"cssFloat":"styleFloat":c;var n=e.getComputedStyle(d);return 1==b?n:f(d,c,n[c]||d.style[c])};e.set=function(a,c,b){var n=k.byId(a),g=arguments.length,f="opacity"==c;c=q[c]?"cssFloat"in n.style?"cssFloat":"styleFloat":c;if(3==g)return f?d(n,b):n.style[c]=b;for(var l in c)e.set(a,l,c[l]);return e.getComputedStyle(n)};return e})},"dojo/dom-class":function(){define(["./_base/lang","./_base/array","./dom"],function(h,k,a){function f(a){if("string"==typeof a||a instanceof String){if(a&&!e.test(a))return l[0]=
a,l;a=a.split(e);a.length&&!a[0]&&a.shift();a.length&&!a[a.length-1]&&a.pop();return a}return a?k.filter(a,function(a){return a}):[]}var b,e=/\s+/,l=[""],m={};return b={contains:function(b,d){return 0<=(" "+a.byId(b).className+" ").indexOf(" "+d+" ")},add:function(b,d){b=a.byId(b);d=f(d);var c=b.className,n,c=c?" "+c+" ":" ";n=c.length;for(var g=0,e=d.length,l;g<e;++g)(l=d[g])&&0>c.indexOf(" "+l+" ")&&(c+=l+" ");n<c.length&&(b.className=c.substr(1,c.length-2))},remove:function(b,d){b=a.byId(b);var c;
if(void 0!==d){d=f(d);c=" "+b.className+" ";for(var n=0,g=d.length;n<g;++n)c=c.replace(" "+d[n]+" "," ");c=h.trim(c)}else c="";b.className!=c&&(b.className=c)},replace:function(g,d,c){g=a.byId(g);m.className=g.className;b.remove(m,c);b.add(m,d);g.className!==m.className&&(g.className=m.className)},toggle:function(g,d,c){g=a.byId(g);if(void 0===c){d=f(d);for(var n=0,e=d.length,l;n<e;++n)l=d[n],b[b.contains(g,l)?"remove":"add"](g,l)}else b[c?"add":"remove"](g,d);return c}}})},"dojo/dom-geometry":function(){define(["./sniff",
"./_base/window","./dom","./dom-style"],function(h,k,a,f){function b(a,c,b,g,e,f){f=f||"px";a=a.style;isNaN(c)||(a.left=c+f);isNaN(b)||(a.top=b+f);0<=g&&(a.width=g+f);0<=e&&(a.height=e+f)}function e(a){return"button"==a.tagName.toLowerCase()||"input"==a.tagName.toLowerCase()&&"button"==(a.getAttribute("type")||"").toLowerCase()}function l(a){return"border-box"==m.boxModel||"table"==a.tagName.toLowerCase()||e(a)}var m={boxModel:"content-box"};h("ie")&&(m.boxModel="BackCompat"==document.compatMode?
"border-box":"content-box");m.getPadExtents=function(d,c){d=a.byId(d);var b=c||f.getComputedStyle(d),g=f.toPixelValue,e=g(d,b.paddingLeft),l=g(d,b.paddingTop),m=g(d,b.paddingRight),b=g(d,b.paddingBottom);return{l:e,t:l,r:m,b:b,w:e+m,h:l+b}};m.getBorderExtents=function(d,c){d=a.byId(d);var b=f.toPixelValue,g=c||f.getComputedStyle(d),e="none"!=g.borderLeftStyle?b(d,g.borderLeftWidth):0,l="none"!=g.borderTopStyle?b(d,g.borderTopWidth):0,m="none"!=g.borderRightStyle?b(d,g.borderRightWidth):0,b="none"!=
g.borderBottomStyle?b(d,g.borderBottomWidth):0;return{l:e,t:l,r:m,b:b,w:e+m,h:l+b}};m.getPadBorderExtents=function(d,c){d=a.byId(d);var b=c||f.getComputedStyle(d),g=m.getPadExtents(d,b),b=m.getBorderExtents(d,b);return{l:g.l+b.l,t:g.t+b.t,r:g.r+b.r,b:g.b+b.b,w:g.w+b.w,h:g.h+b.h}};m.getMarginExtents=function(d,c){d=a.byId(d);var b=c||f.getComputedStyle(d),g=f.toPixelValue,e=g(d,b.marginLeft),l=g(d,b.marginTop),m=g(d,b.marginRight),b=g(d,b.marginBottom);return{l:e,t:l,r:m,b:b,w:e+m,h:l+b}};m.getMarginBox=
function(d,c){d=a.byId(d);var b=c||f.getComputedStyle(d),b=m.getMarginExtents(d,b),g=d.offsetLeft-b.l,e=d.offsetTop-b.t,l=d.parentNode,v=f.toPixelValue;8==h("ie")&&!h("quirks")&&l&&(l=f.getComputedStyle(l),g-="none"!=l.borderLeftStyle?v(d,l.borderLeftWidth):0,e-="none"!=l.borderTopStyle?v(d,l.borderTopWidth):0);return{l:g,t:e,w:d.offsetWidth+b.w,h:d.offsetHeight+b.h}};m.getContentBox=function(d,c){d=a.byId(d);var b=c||f.getComputedStyle(d),g=d.clientWidth,e,l=m.getPadExtents(d,b);e=m.getBorderExtents(d,
b);var b=d.offsetLeft+l.l+e.l,v=d.offsetTop+l.t+e.t;g?e=d.clientHeight:(g=d.offsetWidth-e.w,e=d.offsetHeight-e.h);if(8==h("ie")&&!h("quirks")){var u=d.parentNode,w=f.toPixelValue;u&&(u=f.getComputedStyle(u),b-="none"!=u.borderLeftStyle?w(d,u.borderLeftWidth):0,v-="none"!=u.borderTopStyle?w(d,u.borderTopWidth):0)}return{l:b,t:v,w:g-l.w,h:e-l.h}};m.setContentSize=function(d,c,n){d=a.byId(d);var g=c.w;c=c.h;l(d)&&(n=m.getPadBorderExtents(d,n),0<=g&&(g+=n.w),0<=c&&(c+=n.h));b(d,NaN,NaN,g,c)};var g={l:0,
t:0,w:0,h:0};m.setMarginBox=function(d,c,n){d=a.byId(d);var q=n||f.getComputedStyle(d);n=c.w;var t=c.h,r=l(d)?g:m.getPadBorderExtents(d,q),q=m.getMarginExtents(d,q);if(h("webkit")&&e(d)){var v=d.style;0<=n&&!v.width&&(v.width="4px");0<=t&&!v.height&&(v.height="4px")}0<=n&&(n=Math.max(n-r.w-q.w,0));0<=t&&(t=Math.max(t-r.h-q.h,0));b(d,c.l,c.t,n,t)};m.isBodyLtr=function(a){a=a||k.doc;return"ltr"==(k.body(a).dir||a.documentElement.dir||"ltr").toLowerCase()};m.docScroll=function(a){a=a||k.doc;var c=k.doc.parentWindow||
k.doc.defaultView;return"pageXOffset"in c?{x:c.pageXOffset,y:c.pageYOffset}:(c=h("quirks")?k.body(a):a.documentElement)&&{x:m.fixIeBiDiScrollLeft(c.scrollLeft||0,a),y:c.scrollTop||0}};m.getIeDocumentElementOffset=function(a){return{x:0,y:0}};m.fixIeBiDiScrollLeft=function(a,c){c=c||k.doc;var d=h("ie");if(d&&!m.isBodyLtr(c)){var b=h("quirks"),g=b?k.body(c):c.documentElement,e=k.global;6==d&&!b&&e.frameElement&&g.scrollHeight>g.clientHeight&&(a+=g.clientLeft);return 8>d||b?a+g.clientWidth-g.scrollWidth:
-a}return a};m.position=function(d,c){d=a.byId(d);var b=k.body(d.ownerDocument),g=d.getBoundingClientRect(),g={x:g.left,y:g.top,w:g.right-g.left,h:g.bottom-g.top};9>h("ie")&&(g.x-=h("quirks")?b.clientLeft+b.offsetLeft:0,g.y-=h("quirks")?b.clientTop+b.offsetTop:0);c&&(b=m.docScroll(d.ownerDocument),g.x+=b.x,g.y+=b.y);return g};m.getMarginSize=function(d,c){d=a.byId(d);var b=m.getMarginExtents(d,c||f.getComputedStyle(d)),g=d.getBoundingClientRect();return{w:g.right-g.left+b.w,h:g.bottom-g.top+b.h}};
m.normalizeEvent=function(a){"layerX"in a||(a.layerX=a.offsetX,a.layerY=a.offsetY);if(!("pageX"in a)){var c=a.target,c=c&&c.ownerDocument||document,d=h("quirks")?c.body:c.documentElement;a.pageX=a.clientX+m.fixIeBiDiScrollLeft(d.scrollLeft||0,c);a.pageY=a.clientY+(d.scrollTop||0)}};return m})},"put-selector/put":function(){(function(h){var k,a=/[-+,> ]/;h([],k=function(f,b){function e(c){function b(){u&&v&&u!=v&&(v==c&&(q||(q=a.test(A)&&f.createDocumentFragment()))?q:v).insertBefore(u,r||null)}for(var q,
t,r,v,u,w=arguments,h=w[0],k=0;k<w.length;k++){var A=w[k];if("object"==typeof A){t=!1;if(A instanceof Array){u=f.createDocumentFragment();for(var z=0;z<A.length;z++)u.appendChild(e(A[z]));A=u}if(A.nodeType)u=A,b(),v=A,r=0;else for(z in A)u[z]=A[z]}else if(t)t=!1,u.appendChild(f.createTextNode(A));else{1>k&&(c=null);t=!0;if(h=A.replace(l,function(a,n,l,q,t,h){n&&(b(),"-"==n||"+"==n?(v=(r=u||v).parentNode,u=null,"+"==n&&(r=r.nextSibling)):("\x3c"==n?v=u=(u||v).parentNode:(","==n?v=c:u&&(v=u),u=null),
r=0),u&&(v=u));if((a=!l&&q)||!u&&(l||t))"$"==a?(a=w[++k],v.appendChild(f.createTextNode(a))):(a=a||e.defaultTag,(n=d&&w[k+1]&&w[k+1].name)&&(a="\x3c"+a+' name\x3d"'+n+'"\x3e'),u=g&&~(m=a.indexOf("|"))?f.createElementNS(g[a.slice(0,m)],a.slice(m+1)):f.createElement(a));if(l)if("$"==q&&(q=w[++k]),"#"==l)u.id=q;else if(n=(a=u.className)&&(" "+a+" ").replace(" "+q+" "," "),"."==l)u.className=a?(n+q).substring(1):q;else if("!"==A){var x;d?e("div",u,"\x3c").innerHTML="":(x=u.parentNode)&&x.removeChild(u)}else n=
n.substring(1,n.length-1),n!=a&&(u.className=n);t&&("$"==h&&(h=w[++k]),"style"==t?u.style.cssText=h:(l="!"==t.charAt(0)?(t=t.substring(1))&&"removeAttribute":"setAttribute",h=""===h?t:h,g&&~(m=t.indexOf("|"))?u[l+"NS"](g[t.slice(0,m)],t.slice(m+1),h):u[l](t,h)));return""}))throw new SyntaxError("Unexpected char "+h+" in "+A);b();v=h=u||v}}c&&q&&c.appendChild(q);return h}a=b||a;var l=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w\u00A0-\uFFFF%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,m,g=!1;f=f||document;
var d="object"==typeof f.createElement;e.addNamespace=function(a,d){f.createElementNS?(g||(g={}))[a]=d:f.namespaces.add(a,d)};e.defaultTag="div";e.forDocument=k;return e})})(function(h,k,a){a=a||k;"function"===typeof define?define([],function(){return a()}):"undefined"==typeof window?require("./node-html")(module,a):put=a()})},"dijit/layout/BorderContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/touch ../_WidgetBase ../_Widget ../_TemplatedMixin ./LayoutContainer ./utils".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v){var u=a("dijit.layout._Splitter",[q,t],{live:!0,templateString:'\x3cdiv class\x3d"dijitSplitter" data-dojo-attach-event\x3d"onkeydown:_onKeyDown,press:_startDrag,onmouseenter:_onMouse,onmouseleave:_onMouse" tabIndex\x3d"0" role\x3d"separator"\x3e\x3cdiv class\x3d"dijitSplitterThumb"\x3e\x3c/div\x3e\x3c/div\x3e',constructor:function(){this._handlers=[]},postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);
this._factor=/top|left/.test(this.region)?1:-1;this._cookieName=this.container.id+"_"+this.region},buildRendering:function(){this.inherited(arguments);f.add(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));if(this.container.persist){var a=k(this._cookieName);a&&(this.child.domNode.style[this.horizontal?"height":"width"]=a)}},_computeMaxSize:function(){var a=this.horizontal?"h":"w",c=e.getMarginBox(this.child.domNode)[a],d=h.filter(this.container.getChildren(),function(a){return"center"==a.region})[0],
a=e.getContentBox(d.domNode)[a]-10;return Math.min(this.child.maxSize,c+a)},_startDrag:function(a){this.cover||(this.cover=b.place("\x3cdiv class\x3ddijitSplitterCover\x3e\x3c/div\x3e",this.child.domNode,"after"));f.add(this.cover,"dijitSplitterCoverActive");this.fake&&b.destroy(this.fake);(this._resize=this.live)||((this.fake=this.domNode.cloneNode(!0)).removeAttribute("id"),f.add(this.domNode,"dijitSplitterShadow"),b.place(this.fake,this.domNode,"after"));f.add(this.domNode,"dijitSplitterActive dijitSplitter"+
(this.horizontal?"H":"V")+"Active");this.fake&&f.remove(this.fake,"dijitSplitterHover dijitSplitter"+(this.horizontal?"H":"V")+"Hover");var n=this._factor,m=this.horizontal,u=m?"pageY":"pageX",r=a[u],q=this.domNode.style,m=m?"h":"w",v=l.getComputedStyle(this.child.domNode),t=e.getMarginBox(this.child.domNode,v)[m],h=this._computeMaxSize(),w=Math.max(this.child.minSize,e.getPadBorderExtents(this.child.domNode,v)[m]+10),m=this.region,x="top"==m||"bottom"==m?"top":"left",k=parseInt(q[x],10),L=this._resize,
M=g.hitch(this.container,"_layoutChildren",this.child.id),m=this.ownerDocument;this._handlers=this._handlers.concat([d(m,c.move,this._drag=function(a,c){var d=a[u]-r,b=n*d+t,g=Math.max(Math.min(b,h),w);(L||c)&&M(g);q[x]=d+k+n*(g-b)+"px"}),d(m,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),d(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();a.preventDefault()}),d(m,c.release,g.hitch(this,"_stopDrag"))]);a.stopPropagation();a.preventDefault()},_onMouse:function(a){a=
"mouseover"==a.type||"mouseenter"==a.type;f.toggle(this.domNode,"dijitSplitterHover",a);f.toggle(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V")+"Hover",a)},_stopDrag:function(a){try{this.cover&&f.remove(this.cover,"dijitSplitterCoverActive"),this.fake&&b.destroy(this.fake),f.remove(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active dijitSplitterShadow"),this._drag(a),this._drag(a,!0)}finally{this._cleanupHandlers(),delete this._drag}this.container.persist&&
k(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365})},_cleanupHandlers:function(){for(var a;a=this._handlers.pop();)a.remove()},_onKeyDown:function(a){this._resize=!0;var c=this.horizontal,d=1;switch(a.keyCode){case c?m.UP_ARROW:m.LEFT_ARROW:d*=-1;case c?m.DOWN_ARROW:m.RIGHT_ARROW:break;default:return}c=e.getMarginSize(this.child.domNode)[c?"h":"w"]+this._factor*d;this.container._layoutChildren(this.child.id,Math.max(Math.min(c,this._computeMaxSize()),this.child.minSize));
a.stopPropagation();a.preventDefault()},destroy:function(){this._cleanupHandlers();delete this.child;delete this.container;delete this.cover;delete this.fake;this.inherited(arguments)}}),w=a("dijit.layout._Gutter",[q,t],{templateString:'\x3cdiv class\x3d"dijitGutter" role\x3d"presentation"\x3e\x3c/div\x3e',postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region)},buildRendering:function(){this.inherited(arguments);f.add(this.domNode,"dijitGutter"+(this.horizontal?
"H":"V"))}});a=a("dijit.layout.BorderContainer",r,{gutters:!0,liveSplitters:!0,persist:!1,baseClass:"dijitBorderContainer",_splitterClass:u,postMixInProperties:function(){this.gutters||(this.baseClass+="NoGutter");this.inherited(arguments)},_setupChild:function(a){this.inherited(arguments);var c=a.region,d=a.isLeftToRight();"leading"==c&&(c=d?"left":"right");"trailing"==c&&(c=d?"right":"left");c&&"center"!=c&&(a.splitter||this.gutters)&&!a._splitterWidget&&(d=a.splitter?this._splitterClass:w,g.isString(d)&&
(d=g.getObject(d)),d=new d({id:a.id+"_splitter",container:this,child:a,region:c,live:this.liveSplitters}),d.isSplitter=!0,a._splitterWidget=d,c="bottom"==c||c==(this.isLeftToRight()?"right":"left"),b.place(d.domNode,a.domNode,c?"before":"after"),d.startup())},layout:function(){this._layoutChildren()},removeChild:function(a){var c=a._splitterWidget;c&&(c.destroy(),delete a._splitterWidget);this.inherited(arguments)},getChildren:function(){return h.filter(this.inherited(arguments),function(a){return!a.isSplitter})},
getSplitter:function(a){return h.filter(this.getChildren(),function(c){return c.region==a})[0]._splitterWidget},resize:function(a,c){if(!this.cs||!this.pe){var d=this.domNode;this.cs=l.getComputedStyle(d);this.pe=e.getPadExtents(d,this.cs);this.pe.r=l.toPixelValue(d,this.cs.paddingRight);this.pe.b=l.toPixelValue(d,this.cs.paddingBottom);l.set(d,"padding","0px")}this.inherited(arguments)},_layoutChildren:function(a,c){if(this._borderBox&&this._borderBox.h){var d=[];h.forEach(this._getOrderedChildren(),
function(a){d.push(a);a._splitterWidget&&d.push(a._splitterWidget)});v.layoutChildren(this.domNode,{l:this.pe.l,t:this.pe.t,w:this._borderBox.w-this.pe.w,h:this._borderBox.h-this.pe.h},d,a,c)}},destroyRecursive:function(){h.forEach(this.getChildren(),function(a){var c=a._splitterWidget;c&&c.destroy();delete a._splitterWidget});this.inherited(arguments)}});a.ChildWidgetProperties={splitter:!1,minSize:0,maxSize:Infinity};g.mixin(a.ChildWidgetProperties,r.ChildWidgetProperties);g.extend(n,a.ChildWidgetProperties);
a._Splitter=u;a._Gutter=w;return a})},"dojo/cookie":function(){define(["./_base/kernel","./regexp"],function(h,k){h.cookie=function(a,f,b){var e=document.cookie,l;if(1==arguments.length)l=(l=e.match(new RegExp("(?:^|; )"+k.escapeString(a)+"\x3d([^;]*)")))?decodeURIComponent(l[1]):void 0;else{b=b||{};e=b.expires;if("number"==typeof e){var m=new Date;m.setTime(m.getTime()+864E5*e);e=b.expires=m}e&&e.toUTCString&&(b.expires=e.toUTCString());f=encodeURIComponent(f);var e=a+"\x3d"+f,g;for(g in b)e+="; "+
g,m=b[g],!0!==m&&(e+="\x3d"+m);document.cookie=e}return l};h.cookie.isSupported=function(){"cookieEnabled"in navigator||(this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled="CookiesAllowed"==this("__djCookieTest__"),navigator.cookieEnabled&&this("__djCookieTest__","",{expires:-1}));return navigator.cookieEnabled};return h.cookie})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(h,k){var a={};k.setObject("dojo.regexp",a);a.escapeString=function(a,b){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,
function(a){return b&&-1!=b.indexOf(a)?a:"\\"+a})};a.buildGroupRE=function(f,b,e){if(!(f instanceof Array))return b(f);for(var l=[],m=0;m<f.length;m++)l.push(b(f[m]));return a.group(l.join("|"),e)};a.group=function(a,b){return"("+(b?"?:":"")+a+")"};return a})},"dojo/dom-construct":function(){define("exports ./_base/kernel ./sniff ./_base/window ./dom ./dom-attr".split(" "),function(h,k,a,f,b,e){function l(a,c){var d=c.parentNode;d&&d.insertBefore(a,c)}function m(a){if("innerHTML"in a)try{a.innerHTML=
"";return}catch(y){}for(var c;c=a.lastChild;)a.removeChild(c)}var g={option:["select"],tbody:["table"],thead:["table"],tfoot:["table"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","thead","tr"],legend:["fieldset"],caption:["table"],colgroup:["table"],col:["table","colgroup"],li:["ul"]},d=/<\s*([\w\:]+)/,c={},n=0,q="__"+k._scopeName+"ToDomId",t;for(t in g)g.hasOwnProperty(t)&&(k=g[t],k.pre="option"==t?'\x3cselect multiple\x3d"multiple"\x3e':"\x3c"+k.join("\x3e\x3c")+"\x3e",k.post="\x3c/"+
k.reverse().join("\x3e\x3c/")+"\x3e");var r;8>=a("ie")&&(r=function(a){a.__dojo_html5_tested="yes";var c=v("div",{innerHTML:"\x3cnav\x3ea\x3c/nav\x3e",style:{visibility:"hidden"}},a.body);1!==c.childNodes.length&&"abbr article aside audio canvas details figcaption figure footer header hgroup mark meter nav output progress section summary time video".replace(/\b\w+\b/g,function(c){a.createElement(c)});u(c)});h.toDom=function(b,e){e=e||f.doc;var l=e[q];l||(e[q]=l=++n+"",c[l]=e.createElement("div"));
8>=a("ie")&&!e.__dojo_html5_tested&&e.body&&r(e);b+="";var m=b.match(d),u=m?m[1].toLowerCase():"",l=c[l];if(m&&g[u])for(m=g[u],l.innerHTML=m.pre+b+m.post,m=m.length;m;--m)l=l.firstChild;else l.innerHTML=b;if(1==l.childNodes.length)return l.removeChild(l.firstChild);for(u=e.createDocumentFragment();m=l.firstChild;)u.appendChild(m);return u};h.place=function(a,c,d){c=b.byId(c);"string"==typeof a&&(a=/^\s*</.test(a)?h.toDom(a,c.ownerDocument):b.byId(a));if("number"==typeof d){var n=c.childNodes;!n.length||
n.length<=d?c.appendChild(a):l(a,n[0>d?0:d])}else switch(d){case "before":l(a,c);break;case "after":d=a;(n=c.parentNode)&&(n.lastChild==c?n.appendChild(d):n.insertBefore(d,c.nextSibling));break;case "replace":c.parentNode.replaceChild(a,c);break;case "only":h.empty(c);c.appendChild(a);break;case "first":if(c.firstChild){l(a,c.firstChild);break}default:c.appendChild(a)}return a};var v=h.create=function(a,c,d,n){var g=f.doc;d&&(d=b.byId(d),g=d.ownerDocument);"string"==typeof a&&(a=g.createElement(a));
c&&e.set(a,c);d&&h.place(a,d,n);return a};h.empty=function(a){m(b.byId(a))};var u=h.destroy=function(c){if(c=b.byId(c)){var d=c;c=c.parentNode;d.firstChild&&m(d);c&&(a("ie")&&c.canHaveChildren&&"removeNode"in d?d.removeNode(!1):c.removeChild(d))}}})},"dojo/dom-attr":function(){define("exports ./sniff ./_base/lang ./dom ./dom-style ./dom-prop".split(" "),function(h,k,a,f,b,e){function l(a,c){var d=a.getAttributeNode&&a.getAttributeNode(c);return!!d&&d.specified}var m={innerHTML:1,textContent:1,className:1,
htmlFor:k("ie"),value:1},g={classname:"class",htmlfor:"for",tabindex:"tabIndex",readonly:"readOnly"};h.has=function(a,c){var d=c.toLowerCase();return m[e.names[d]||c]||l(f.byId(a),g[d]||c)};h.get=function(d,c){d=f.byId(d);var b=c.toLowerCase(),q=e.names[b]||c,t=d[q];if(m[q]&&"undefined"!=typeof t)return t;if("textContent"==q)return e.get(d,q);if("href"!=q&&("boolean"==typeof t||a.isFunction(t)))return t;b=g[b]||c;return l(d,b)?d.getAttribute(b):null};h.set=function(d,c,n){d=f.byId(d);if(2==arguments.length){for(var l in c)h.set(d,
l,c[l]);return d}l=c.toLowerCase();var t=e.names[l]||c,r=m[t];if("style"==t&&"string"!=typeof n)return b.set(d,n),d;if(r||"boolean"==typeof n||a.isFunction(n))return e.set(d,c,n);d.setAttribute(g[l]||c,n);return d};h.remove=function(a,c){f.byId(a).removeAttribute(g[c.toLowerCase()]||c)};h.getNodeProp=function(a,c){a=f.byId(a);var d=c.toLowerCase(),b=e.names[d]||c;if(b in a&&"href"!=b)return a[b];d=g[d]||c;return l(a,d)?a.getAttribute(d):null}})},"dojo/dom-prop":function(){define("exports ./_base/kernel ./sniff ./_base/lang ./dom ./dom-style ./dom-construct ./_base/connect".split(" "),
function(h,k,a,f,b,e,l,m){function g(a){var c="";a=a.childNodes;for(var d=0,b;b=a[d];d++)8!=b.nodeType&&(c=1==b.nodeType?c+g(b):c+b.nodeValue);return c}var d={},c=1,n=k._scopeName+"attrid";a.add("dom-textContent",function(a,c,d){return"textContent"in d});h.names={"class":"className","for":"htmlFor",tabindex:"tabIndex",readonly:"readOnly",colspan:"colSpan",frameborder:"frameBorder",rowspan:"rowSpan",textcontent:"textContent",valuetype:"valueType"};h.get=function(c,d){c=b.byId(c);var n=d.toLowerCase(),
n=h.names[n]||d;return"textContent"!=n||a("dom-textContent")?c[n]:g(c)};h.set=function(g,t,r){g=b.byId(g);if(2==arguments.length&&"string"!=typeof t){for(var q in t)h.set(g,q,t[q]);return g}q=t.toLowerCase();q=h.names[q]||t;if("style"==q&&"string"!=typeof r)return e.set(g,r),g;if("innerHTML"==q)return a("ie")&&g.tagName.toLowerCase()in{col:1,colgroup:1,table:1,tbody:1,tfoot:1,thead:1,tr:1,title:1}?(l.empty(g),g.appendChild(l.toDom(r,g.ownerDocument))):g[q]=r,g;if("textContent"==q&&!a("dom-textContent"))return l.empty(g),
g.appendChild(g.ownerDocument.createTextNode(r)),g;if(f.isFunction(r)){var u=g[n];u||(u=c++,g[n]=u);d[u]||(d[u]={});var w=d[u][q];if(w)m.disconnect(w);else try{delete g[q]}catch(x){}r?d[u][q]=m.connect(g,q,r):g[q]=null;return g}g[q]=r;return g}})},"dojo/_base/connect":function(){define("./kernel ../on ../topic ../aspect ./event ../mouse ./sniff ./lang ../keys".split(" "),function(h,k,a,f,b,e,l,m){function g(a,c,d,b,n){b=m.hitch(d,b);if(!a||!a.addEventListener&&!a.attachEvent)return f.after(a||h.global,
c,b,!0);"string"==typeof c&&"on"==c.substring(0,2)&&(c=c.substring(2));a||(a=h.global);if(!n)switch(c){case "keypress":c=t;break;case "mouseenter":c=e.enter;break;case "mouseleave":c=e.leave}return k(a,c,b,n)}function d(a){a.keyChar=a.charCode?String.fromCharCode(a.charCode):"";a.charOrCode=a.keyChar||a.keyCode}l.add("events-keypress-typed",function(){var a={charCode:0};try{a=document.createEvent("KeyboardEvent"),(a.initKeyboardEvent||a.initKeyEvent).call(a,"keypress",!0,!0,null,!1,!1,!1,!1,9,3)}catch(u){}return 0==
a.charCode&&!l("opera")});var c={106:42,111:47,186:59,187:43,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39,229:113},n=l("mac")?"metaKey":"ctrlKey",q=function(a,c){var b=m.mixin({},a,c);d(b);b.preventDefault=function(){a.preventDefault()};b.stopPropagation=function(){a.stopPropagation()};return b},t;t=l("events-keypress-typed")?function(a,d){var b=k(a,"keydown",function(a){var b=a.keyCode,n=13!=b&&32!=b&&(27!=b||!l("ie"))&&(48>b||90<b)&&(96>b||111<b)&&(186>b||192<b)&&(219>b||222<b)&&
229!=b;if(n||a.ctrlKey){n=n?0:b;if(a.ctrlKey){if(3==b||13==b)return d.call(a.currentTarget,a);n=95<n&&106>n?n-48:!a.shiftKey&&65<=n&&90>=n?n+32:c[n]||n}b=q(a,{type:"keypress",faux:!0,charCode:n});d.call(a.currentTarget,b);if(l("ie"))try{a.keyCode=b.keyCode}catch(B){}}}),n=k(a,"keypress",function(a){var c=a.charCode;a=q(a,{charCode:32<=c?c:0,faux:!0});return d.call(this,a)});return{remove:function(){b.remove();n.remove()}}}:l("opera")?function(a,c){return k(a,"keypress",function(a){var d=a.which;3==
d&&(d=99);d=32>d&&!a.shiftKey?0:d;a.ctrlKey&&!a.shiftKey&&65<=d&&90>=d&&(d+=32);return c.call(this,q(a,{charCode:d}))})}:function(a,c){return k(a,"keypress",function(a){d(a);return c.call(this,a)})};var r={_keypress:t,connect:function(a,c,d,b,n){var e=arguments,f=[],l=0;f.push("string"==typeof e[0]?null:e[l++],e[l++]);var m=e[l+1];f.push("string"==typeof m||"function"==typeof m?e[l++]:null,e[l++]);for(m=e.length;l<m;l++)f.push(e[l]);return g.apply(this,f)},disconnect:function(a){a&&a.remove()},subscribe:function(c,
d,b){return a.subscribe(c,m.hitch(d,b))},publish:function(c,d){return a.publish.apply(a,[c].concat(d))},connectPublisher:function(a,c,d){var b=function(){r.publish(a,arguments)};return d?r.connect(c,d,b):r.connect(c,b)},isCopyKey:function(a){return a[n]}};r.unsubscribe=r.disconnect;m.mixin(h,r);return r})},"dojo/_base/event":function(){define(["./kernel","../on","../has","../dom-geometry"],function(h,k,a,f){if(k._fixEvent){var b=k._fixEvent;k._fixEvent=function(a,e){(a=b(a,e))&&f.normalizeEvent(a);
return a}}var e={fix:function(a,b){return k._fixEvent?k._fixEvent(a,b):a},stop:function(b){a("dom-addeventlistener")||b&&b.preventDefault?(b.preventDefault(),b.stopPropagation()):(b=b||window.event,b.cancelBubble=!0,k._preventDefault.call(b))}};h.fixEvent=e.fix;h.stopEvent=e.stop;return e})},"dojo/mouse":function(){define(["./_base/kernel","./on","./has","./dom","./_base/window"],function(h,k,a,f,b){function e(a,b){var g=function(d,c){return k(d,a,function(a){if(b)return b(a,c);if(!f.isDescendant(a.relatedTarget,
d))return c.call(this,a)})};g.bubble=function(d){return e(a,function(a,b){var c=d(a.target),n=a.relatedTarget;if(c&&c!=(n&&1==n.nodeType&&d(n)))return b.call(c,a)})};return g}a.add("dom-quirks",b.doc&&"BackCompat"==b.doc.compatMode);a.add("events-mouseenter",b.doc&&"onmouseenter"in b.doc.createElement("div"));a.add("events-mousewheel",b.doc&&"onmousewheel"in b.doc);b=a("dom-quirks")&&a("ie")||!a("dom-addeventlistener")?{LEFT:1,MIDDLE:4,RIGHT:2,isButton:function(a,b){return a.button&b},isLeft:function(a){return a.button&
1},isMiddle:function(a){return a.button&4},isRight:function(a){return a.button&2}}:{LEFT:0,MIDDLE:1,RIGHT:2,isButton:function(a,b){return a.button==b},isLeft:function(a){return 0==a.button},isMiddle:function(a){return 1==a.button},isRight:function(a){return 2==a.button}};h.mouseButtons=b;h=a("events-mousewheel")?"mousewheel":function(a,b){return k(a,"DOMMouseScroll",function(a){a.wheelDelta=-a.detail;b.call(this,a)})};return{_eventHandler:e,enter:e("mouseover"),leave:e("mouseout"),wheel:h,isLeft:b.isLeft,
isMiddle:b.isMiddle,isRight:b.isRight}})},"dojo/_base/sniff":function(){define(["./kernel","./lang","../sniff"],function(h,k,a){h._name="browser";k.mixin(h,{isBrowser:!0,isFF:a("ff"),isIE:a("ie"),isKhtml:a("khtml"),isWebKit:a("webkit"),isMozilla:a("mozilla"),isMoz:a("mozilla"),isOpera:a("opera"),isSafari:a("safari"),isChrome:a("chrome"),isMac:a("mac"),isIos:a("ios"),isAndroid:a("android"),isWii:a("wii"),isQuirks:a("quirks"),isAir:a("air")});return a})},"dojo/keys":function(){define(["./_base/kernel",
"./sniff"],function(h,k){return h.keys={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:k("webkit")?91:224,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,
NUMPAD_MINUS:109,NUMPAD_PERIOD:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,NUM_LOCK:144,SCROLL_LOCK:145,UP_DPAD:175,DOWN_DPAD:176,LEFT_DPAD:177,RIGHT_DPAD:178,copyKey:k("mac")&&!k("air")?k("safari")?91:224:17}})},"dojo/touch":function(){define("./_base/kernel ./aspect ./dom ./dom-class ./_base/lang ./on ./has ./mouse ./domReady ./_base/window".split(" "),function(h,k,a,f,b,e,l,m,g,d){function c(a,c,d){return r&&
d?function(a,c){return e(a,d,c)}:u?function(d,b){var n=e(d,c,function(a){b.call(this,a);F=(new Date).getTime()}),g=e(d,a,function(a){(!F||(new Date).getTime()>F+1E3)&&b.call(this,a)});return{remove:function(){n.remove();g.remove()}}}:function(c,d){return e(c,a,d)}}function n(a){do if(void 0!==a.dojoClick)return a;while(a=a.parentNode)}function q(c,b,g){if(!m.isRight(c)){var l=n(c.target);if(x=!c.target.disabled&&l&&l.dojoClick)if(A=(y="useTarget"==x)?l:c.target,y&&c.preventDefault(),z=c.changedTouches?
c.changedTouches[0].pageX-d.global.pageXOffset:c.clientX,B=c.changedTouches?c.changedTouches[0].pageY-d.global.pageYOffset:c.clientY,C=("object"==typeof x?x.x:"number"==typeof x?x:0)||4,D=("object"==typeof x?x.y:"number"==typeof x?x:0)||4,!w){c=function(a){d.doc.addEventListener(a,function(c){var d=c.target;x&&!c._dojo_click&&(new Date).getTime()<=E+1E3&&("INPUT"!=d.tagName||!f.contains(d,"dijitOffScreen"))&&(c.stopPropagation(),c.stopImmediatePropagation&&c.stopImmediatePropagation(),"click"==a&&
("INPUT"!=d.tagName||"radio"==d.type&&(f.contains(d,"dijitCheckBoxInput")||f.contains(d,"mblRadioButton"))||"checkbox"==d.type&&(f.contains(d,"dijitCheckBoxInput")||f.contains(d,"mblCheckBox")))&&"TEXTAREA"!=d.tagName&&"AUDIO"!=d.tagName&&"VIDEO"!=d.tagName&&c.preventDefault())},!0)};var u=function(c){x=y?a.isDescendant(d.doc.elementFromPoint(c.changedTouches?c.changedTouches[0].pageX-d.global.pageXOffset:c.clientX,c.changedTouches?c.changedTouches[0].pageY-d.global.pageYOffset:c.clientY),A):x&&(c.changedTouches?
c.changedTouches[0].target:c.target)==A&&Math.abs((c.changedTouches?c.changedTouches[0].pageX-d.global.pageXOffset:c.clientX)-z)<=C&&Math.abs((c.changedTouches?c.changedTouches[0].pageY-d.global.pageYOffset:c.clientY)-B)<=D};w=!0;d.doc.addEventListener(b,function(a){m.isRight(a)||(u(a),y&&a.preventDefault())},!0);d.doc.addEventListener(g,function(c){if(!m.isRight(c)&&(u(c),x)){var d=function(a){var d=document.createEvent("MouseEvents");d._dojo_click=!0;d.initMouseEvent(a,!0,!0,c.view,c.detail,n.screenX,
n.screenY,n.clientX,n.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,0,null);return d};E=(new Date).getTime();var b=y?A:c.target;"LABEL"===b.tagName&&(b=a.byId(b.getAttribute("for"))||b);var n=c.changedTouches?c.changedTouches[0]:c,g=d("mousedown"),f=d("mouseup"),l=d("click");setTimeout(function(){e.emit(b,"mousedown",g);e.emit(b,"mouseup",f);e.emit(b,"click",l);E=(new Date).getTime()},0)}},!0);c("click");c("mousedown");c("mouseup")}}}var t=5>l("ios"),r=l("pointer-events")||l("MSPointer"),v=function(){var a=
{},c;for(c in{down:1,move:1,up:1,cancel:1,over:1,out:1})a[c]=l("MSPointer")?"MSPointer"+c.charAt(0).toUpperCase()+c.slice(1):"pointer"+c;return a}(),u=l("touch-events"),w,x,y=!1,A,z,B,C,D,E,F,G;l("touch")&&(r?g(function(){d.doc.addEventListener(v.down,function(a){q(a,v.move,v.up)},!0)}):g(function(){function a(a){var c=b.delegate(a,{bubbles:!0});6<=l("ios")&&(c.touches=a.touches,c.altKey=a.altKey,c.changedTouches=a.changedTouches,c.ctrlKey=a.ctrlKey,c.metaKey=a.metaKey,c.shiftKey=a.shiftKey,c.targetTouches=
a.targetTouches);return c}G=d.body();d.doc.addEventListener("touchstart",function(a){F=(new Date).getTime();var c=G;G=a.target;e.emit(c,"dojotouchout",{relatedTarget:G,bubbles:!0});e.emit(G,"dojotouchover",{relatedTarget:c,bubbles:!0});q(a,"touchmove","touchend")},!0);e(d.doc,"touchmove",function(c){F=(new Date).getTime();var b=d.doc.elementFromPoint(c.pageX-(t?0:d.global.pageXOffset),c.pageY-(t?0:d.global.pageYOffset));b&&(G!==b&&(e.emit(G,"dojotouchout",{relatedTarget:b,bubbles:!0}),e.emit(b,"dojotouchover",
{relatedTarget:G,bubbles:!0}),G=b),e.emit(b,"dojotouchmove",a(c))||c.preventDefault())});e(d.doc,"touchend",function(c){F=(new Date).getTime();var b=d.doc.elementFromPoint(c.pageX-(t?0:d.global.pageXOffset),c.pageY-(t?0:d.global.pageYOffset))||d.body();e.emit(b,"dojotouchend",a(c))})}));k={press:c("mousedown","touchstart",v.down),move:c("mousemove","dojotouchmove",v.move),release:c("mouseup","dojotouchend",v.up),cancel:c(m.leave,"touchcancel",r?v.cancel:null),over:c("mouseover","dojotouchover",v.over),
out:c("mouseout","dojotouchout",v.out),enter:m._eventHandler(c("mouseover","dojotouchover",v.over)),leave:m._eventHandler(c("mouseout","dojotouchout",v.out))};return h.touch=k})},"dojo/domReady":function(){define(["./has"],function(h){function k(c){g.push(c);m&&a()}function a(){if(!d){for(d=!0;g.length;)try{g.shift()(b)}catch(v){console.error(v,"in domReady callback",v.stack)}d=!1;k._onQEmpty()}}var f=function(){return this}(),b=document,e={loaded:1,complete:1},l="string"!=typeof b.readyState,m=!!e[b.readyState],
g=[],d;k.load=function(a,c,d){k(d)};k._Q=g;k._onQEmpty=function(){};l&&(b.readyState="loading");if(!m){var c=[],n=function(c){c=c||f.event;m||"readystatechange"==c.type&&!e[b.readyState]||(l&&(b.readyState="complete"),m=1,a())},q=function(a,c){a.addEventListener(c,n,!1);g.push(function(){a.removeEventListener(c,n,!1)})};if(!h("dom-addeventlistener")){var q=function(a,c){c="on"+c;a.attachEvent(c,n);g.push(function(){a.detachEvent(c,n)})},t=b.createElement("div");try{t.doScroll&&null===f.frameElement&&
c.push(function(){try{return t.doScroll("left"),1}catch(v){}})}catch(v){}}q(b,"DOMContentLoaded");q(f,"load");"onreadystatechange"in b?q(b,"readystatechange"):l||c.push(function(){return e[b.readyState]});if(c.length){var r=function(){if(!m){for(var a=c.length;a--;)if(c[a]()){n("poller");return}setTimeout(r,30)}};r()}}return k})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B){function C(a){return function(c){m[c?"set":"remove"](this.domNode,a,c);this._set(a,c)}}q.add("dijit-legacy-requires",!t.isAsync);q.add("dojo-bidi",!1);q("dijit-legacy-requires")&&u(0,function(){h(["dijit/_base/manager"])});var D={};f=e("dijit._WidgetBase",[w,A],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:C("lang"),dir:"",_setDirAttr:C("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",a)},attributeMap:{},_blankGif:f.blankGif||h.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var c=a.prototype,d=a._setterAttrs=[],a=a._onMap={},b;for(b in c.attributeMap)d.push(b);for(b in c)/^on/.test(b)&&(a[b.substring(2).toLowerCase()]=b),/^_set[A-Z](.*)Attr$/.test(b)&&(b=b.charAt(4).toLowerCase()+
b.substr(5,b.length-9),c.attributeMap&&b in c.attributeMap||d.push(b))}},postscript:function(a,c){this.create(a,c)},create:function(a,c){this._introspect();this.srcNodeRef=l.byId(c);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&this.srcNodeRef.id&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);a&&(this.params=a,r.mixin(this,a));this.postMixInProperties();this.id||(this.id=B.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=
this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=y.body(this.ownerDocument);B.add(this);this.buildRendering();var d;if(this.domNode){this._applyAttributes();var b=this.srcNodeRef;b&&b.parentNode&&this.domNode!==b&&(b.parentNode.replaceChild(this.domNode,b),d=!0);this.domNode.setAttribute("widgetId",this.id)}this.postCreate();d&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},c;for(c in this.params||{})a[c]=this._get(c);
k.forEach(this.constructor._setterAttrs,function(c){if(!(c in a)){var d=this._get(c);d&&this.set(c,d)}},this);for(c in a)this.set(c,a[c])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var a=this.baseClass.split(" ");this.isLeftToRight()||(a=a.concat(k.map(a,function(a){return a+"Rtl"})));g.add(this.domNode,a)}},postCreate:function(){},startup:function(){this._started||(this._started=
!0,k.forEach(this.getChildren(),function(a){a._started||a._destroyed||!r.isFunction(a.startup)||(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function c(c){c.destroyRecursive?c.destroyRecursive(a):c.destroy&&c.destroy(a)}this._beingDestroyed=!0;this.uninitialize();k.forEach(this._connects,r.hitch(this,"disconnect"));k.forEach(this._supportingWidgets,c);this.domNode&&k.forEach(B.findWidgets(this.domNode,
this.containerNode),c);this.destroyRendering(a);B.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);this.domNode&&(a?m.remove(this.domNode,"widgetId"):d.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||d.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){k.forEach(this.getChildren(),function(c){c.destroyRecursive&&c.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(a){var c=
this.domNode;r.isObject(a)?n.set(c,a):c.style.cssText=c.style.cssText?c.style.cssText+("; "+a):a;this._set("style",a)},_attrToDom:function(a,c,d){d=3<=arguments.length?d:this.attributeMap[a];k.forEach(r.isArray(d)?d:[d],function(d){var b=this[d.node||d||"domNode"];switch(d.type||"attribute"){case "attribute":r.isFunction(c)&&(c=r.hitch(this,c));d=d.attribute?d.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;b.tagName?m.set(b,d,c):b.set(d,c);break;case "innerText":b.innerHTML="";b.appendChild(this.ownerDocument.createTextNode(c));
break;case "innerHTML":b.innerHTML=c;break;case "class":g.replace(b,c,this[a]);break;case "toggleClass":g.toggle(b,d.className||a,c)}},this)},get:function(a){var c=this._getAttrNames(a);return this[c.g]?this[c.g]():this._get(a)},set:function(a,c){if("object"===typeof a){for(var d in a)this.set(d,a[d]);return this}d=this._getAttrNames(a);var b=this[d.s];if(r.isFunction(b))var n=b.apply(this,Array.prototype.slice.call(arguments,1));else{var b=this.focusNode&&!r.isFunction(this.focusNode)?"focusNode":
"domNode",g=this[b]&&this[b].tagName,e;if((e=g)&&!(e=D[g])){e=this[b];var f={},l;for(l in e)f[l.toLowerCase()]=!0;e=D[g]=f}l=e;d=a in this.attributeMap?this.attributeMap[a]:d.s in this?this[d.s]:l&&d.l in l&&"function"!=typeof c||/^aria-|^data-|^role$/.test(a)?b:null;null!=d&&this._attrToDom(a,c,d);this._set(a,c)}return n||this},_attrPairNames:{},_getAttrNames:function(a){var c=this._attrPairNames;if(c[a])return c[a];var d=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-1).toUpperCase()});
return c[a]={n:a+"Node",s:"_set"+d+"Attr",g:"_get"+d+"Attr",l:d.toLowerCase()}},_set:function(a,c){var d=this[a];this[a]=c;!this._created||d===c||d!==d&&c!==c||(this._watchCallbacks&&this._watchCallbacks(a,d,c),this.emit("attrmodified-"+a,{detail:{prevValue:d,newValue:c}}))},_get:function(a){return this[a]},emit:function(a,c,d){c=c||{};void 0===c.bubbles&&(c.bubbles=!0);void 0===c.cancelable&&(c.cancelable=!0);c.detail||(c.detail={});c.detail.widget=this;var b,n=this["on"+a];n&&(b=n.apply(this,d?
d:[c]));this._started&&!this._beingDestroyed&&v.emit(this.domNode,a.toLowerCase(),c);return b},on:function(c,d){var b=this._onMap(c);return b?a.after(this,b,d,!0):this.own(v(this.domNode,c,d))[0]},_onMap:function(a){var c=this.constructor,d=c._onMap;if(!d){var d=c._onMap={},b;for(b in c.prototype)/^on/.test(b)&&(d[b.replace(/^on/,"").toLowerCase()]=b)}return d["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},getChildren:function(){return this.containerNode?
B.findWidgets(this.containerNode):[]},getParent:function(){return B.getEnclosingWidget(this.domNode.parentNode)},connect:function(a,c,d){return this.own(b.connect(a,c,this,d))[0]},disconnect:function(a){a.remove()},subscribe:function(a,c){return this.own(x.subscribe(a,r.hitch(this,c)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():c.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&"none"!=n.get(this.domNode,"display")},
placeAt:function(a,c){var b=!a.tagName&&B.byId(a);!b||!b.addChild||c&&"number"!==typeof c?(b=b&&"domNode"in b?b.containerNode&&!/after|before|replace/.test(c||"")?b.containerNode:b.domNode:l.byId(a,this.ownerDocument),d.place(this.domNode,b,c),!this._started&&(this.getParent()||{})._started&&this.startup()):b.addChild(this,c);return this},defer:function(a,c){var d=setTimeout(r.hitch(this,function(){d&&(d=null,this._destroyed||r.hitch(this,a)())}),c||0);return{remove:function(){d&&(clearTimeout(d),
d=null);return null}}}});q("dojo-bidi")&&f.extend(z);return f})},"dojo/ready":function(){define(["./_base/kernel","./has","require","./domReady","./_base/lang"],function(h,k,a,f,b){var e=0,l=[],m=0;k=function(){e=1;h._postLoad=h.config.afterOnLoad=!0;g()};var g=function(){if(!m){for(m=1;e&&(!f||0==f._Q.length)&&(a.idle?a.idle():1)&&l.length;){var c=l.shift();try{c()}catch(q){if(q.info=q.message,a.signal)a.signal("error",q);else throw q;}}m=0}};a.on&&a.on("idle",g);f&&(f._onQEmpty=g);var d=h.ready=
h.addOnLoad=function(a,c,d){var n=b._toArray(arguments);"number"!=typeof a?(d=c,c=a,a=1E3):n.shift();d=d?b.hitch.apply(h,n):function(){c()};d.priority=a;for(n=0;n<l.length&&a>=l[n].priority;n++);l.splice(n,0,d);g()},c=h.config.addOnLoad;if(c)d[b.isArray(c)?"apply":"call"](h,c);f?f(k):k();return d})},"dojo/Stateful":function(){define(["./_base/declare","./_base/lang","./_base/array","./when"],function(h,k,a,f){return h("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;
return b[a]?b[a]:b[a]={s:"_"+a+"Setter",g:"_"+a+"Getter"}},postscript:function(a){a&&this.set(a)},_get:function(a,e){return"function"===typeof this[e.g]?this[e.g]():this[a]},get:function(a){return this._get(a,this._getAttrNames(a))},set:function(a,e){if("object"===typeof a){for(var b in a)a.hasOwnProperty(b)&&"_watchCallbacks"!=b&&this.set(b,a[b]);return this}b=this._getAttrNames(a);var m=this._get(a,b);b=this[b.s];var g;"function"===typeof b?g=b.apply(this,Array.prototype.slice.call(arguments,1)):
this[a]=e;if(this._watchCallbacks){var d=this;f(g,function(){d._watchCallbacks(a,m,e)})}return this},_changeAttrValue:function(a,e){var b=this.get(a);this[a]=e;this._watchCallbacks&&this._watchCallbacks(a,b,e);return this},watch:function(b,e){var f=this._watchCallbacks;if(!f)var m=this,f=this._watchCallbacks=function(a,d,b,g){var c=function(c){if(c){c=c.slice();for(var n=0,g=c.length;n<g;n++)c[n].call(m,a,d,b)}};c(f["_"+a]);g||c(f["*"])};e||"function"!==typeof b?b="_"+b:(e=b,b="*");var g=f[b];"object"!==
typeof g&&(g=f[b]=[]);g.push(e);var d={};d.unwatch=d.remove=function(){var c=a.indexOf(g,e);-1<c&&g.splice(c,1)};return d}})})},"dojo/when":function(){define(["./Deferred","./promise/Promise"],function(h,k){return function(a,f,b,e){var l=a&&"function"===typeof a.then,m=l&&a instanceof k;if(!l)return 1<arguments.length?f?f(a):a:(new h).resolve(a);m||(l=new h(a.cancel),a.then(l.resolve,l.reject,l.progress),a=l.promise);return f||b||e?a.then(f,b,e):a}})},"dijit/Destroyable":function(){define(["dojo/_base/array",
"dojo/aspect","dojo/_base/declare"],function(h,k,a){return a("dijit.Destroyable",null,{destroy:function(a){this._destroyed=!0},own:function(){var a=["destroyRecursive","destroy","remove"];h.forEach(arguments,function(b){function e(){m.remove();h.forEach(g,function(a){a.remove()})}var f,m=k.before(this,"destroy",function(a){b[f](a)}),g=[];b.then?(f="cancel",b.then(e,e)):h.forEach(a,function(a){"function"===typeof b[a]&&(f||(f=a),g.push(k.after(b,a,e,!0)))})},this);return arguments}})})},"dijit/registry":function(){define(["dojo/_base/array",
"dojo/_base/window","./main"],function(h,k,a){var f={},b={},e={length:0,add:function(a){if(b[a.id])throw Error("Tried to register widget with id\x3d\x3d"+a.id+" but that id is already registered");b[a.id]=a;this.length++},remove:function(a){b[a]&&(delete b[a],this.length--)},byId:function(a){return"string"==typeof a?b[a]:a},byNode:function(a){return b[a.getAttribute("widgetId")]},toArray:function(){var a=[],e;for(e in b)a.push(b[e]);return a},getUniqueId:function(e){var l;do l=e+"_"+(e in f?++f[e]:
f[e]=0);while(b[l]);return"dijit"==a._scopeName?l:a._scopeName+"_"+l},findWidgets:function(a,e){function g(a){for(a=a.firstChild;a;a=a.nextSibling)if(1==a.nodeType){var c=a.getAttribute("widgetId");c?(c=b[c])&&d.push(c):a!==e&&g(a)}}var d=[];g(a);return d},_destroyAll:function(){a._curFocus=null;a._prevFocus=null;a._activeStack=[];h.forEach(e.findWidgets(k.body()),function(a){a._destroyed||(a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy())})},getEnclosingWidget:function(a){for(;a;){var e=
1==a.nodeType&&a.getAttribute("widgetId");if(e)return b[e];a=a.parentNode}return null},_hash:b};return a.registry=e})},"dijit/main":function(){define(["dojo/_base/kernel"],function(h){return h.dijit})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q){function t(){}
function r(c){return function(d,b,n,g){return d&&"string"==typeof b&&d[b]==t?d.on(b.substring(2).toLowerCase(),l.hitch(n,g)):c.apply(a,arguments)}}h.around(a,"connect",r);e.connect&&h.around(e,"connect",r);h=f("dijit._Widget",[c,n,q],{onClick:t,onDblClick:t,onKeyDown:t,onKeyPress:t,onKeyUp:t,onMouseDown:t,onMouseMove:t,onMouseOut:t,onMouseOver:t,onMouseLeave:t,onMouseEnter:t,onMouseUp:t,constructor:function(a){this._toConnect={};for(var c in a)this[c]===t&&(this._toConnect[c.replace(/^on/,"").toLowerCase()]=
a[c],delete a[c])},postCreate:function(){this.inherited(arguments);for(var a in this._toConnect)this.on(a,this._toConnect[a]);delete this._toConnect},on:function(c,d){return this[this._onMap(c)]===t?a.connect(this.domNode,c.toLowerCase(),this,d):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(a,c){e.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(a,c)},attr:function(a,
c){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,arguments):this.get(a)},getDescendants:function(){e.deprecated(this.declaredClass+"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?m("[widgetId]",this.containerNode).map(d.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});b("dijit-legacy-requires")&&g(0,function(){require(["dijit/_base"])});return h})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),
function(h,k,a,f,b,e){h=f("dijit._OnDijitClickMixin",null,{connect:function(a,b,g){return this.inherited(arguments,[a,"ondijitclick"==b?e:b,g])}});h.a11yclick=e;return h})},"dijit/a11yclick":function(){define(["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(h,k,a,f){function b(a){if((a.keyCode===h.ENTER||a.keyCode===h.SPACE)&&!/input|button|textarea/i.test(a.target.nodeName))for(a=a.target;a;a=a.parentNode)if(a.dojoClick)return!0}var e;a(document,"keydown",function(a){b(a)?(e=a.target,a.preventDefault()):
e=null});a(document,"keyup",function(f){b(f)&&f.target==e&&(e=null,a.emit(f.target,"click",{cancelable:!0,bubbles:!0,ctrlKey:f.ctrlKey,shiftKey:f.shiftKey,metaKey:f.metaKey,altKey:f.altKey,_origType:f.type}))});var l=function(b,g){b.dojoClick=!0;return a(b,"click",g)};l.click=l;l.press=function(b,g){var d=a(b,f.press,function(a){("mousedown"!=a.type||k.isLeft(a))&&g(a)}),c=a(b,"keydown",function(a){a.keyCode!==h.ENTER&&a.keyCode!==h.SPACE||g(a)});return{remove:function(){d.remove();c.remove()}}};
l.release=function(b,g){var d=a(b,f.release,function(a){("mouseup"!=a.type||k.isLeft(a))&&g(a)}),c=a(b,"keyup",function(a){a.keyCode!==h.ENTER&&a.keyCode!==h.SPACE||g(a)});return{remove:function(){d.remove();c.remove()}}};l.move=f.move;return l})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare","dojo/_base/lang"],function(h,k,a,f){f.extend(k,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});
return a("dijit._FocusMixin",null,{_focusManager:h})})},"dijit/focus":function(){define("dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Evented dojo/_base/lang dojo/on dojo/domReady dojo/sniff dojo/Stateful dojo/_base/window dojo/window ./a11y ./registry ./main".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u){var w,x,y=new (k([n,l],{curNode:null,activeStack:[],constructor:function(){var c=m.hitch(this,function(c){a.isDescendant(this.curNode,c)&&
this.set("curNode",null);a.isDescendant(this.prevNode,c)&&this.set("prevNode",null)});h.before(e,"empty",c);h.before(e,"destroy",c)},registerIframe:function(a){return this.registerWin(a.contentWindow,a)},registerWin:function(a,d){var b=this,n=a.document&&a.document.body;if(n){var e=c("pointer-events")?"pointerdown":c("MSPointer")?"MSPointerDown":c("touch-events")?"mousedown, touchstart":"mousedown",f=g(a.document,e,function(a){a&&a.target&&null==a.target.parentNode||b._onTouchNode(d||a.target,"mouse")}),
l=g(n,"focusin",function(a){if(a.target.tagName){var c=a.target.tagName.toLowerCase();"#document"!=c&&"body"!=c&&(r.isFocusable(a.target)?b._onFocusNode(d||a.target):b._onTouchNode(d||a.target))}}),m=g(n,"focusout",function(a){b._onBlurNode(d||a.target)});return{remove:function(){f.remove();l.remove();m.remove();n=f=l=m=null}}}},_onBlurNode:function(a){a=(new Date).getTime();a<w+100||(this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),this._clearFocusTimer=setTimeout(m.hitch(this,function(){this.set("prevNode",
this.curNode);this.set("curNode",null)}),0),this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),a<x+100||(this._clearActiveWidgetsTimer=setTimeout(m.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([])}),0)))},_onTouchNode:function(a,c){x=(new Date).getTime();this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer);b.contains(a,"dijitPopup")&&(a=a.firstChild);var d=[];try{for(;a;){var n=f.get(a,
"dijitPopupParent");if(n)a=v.byId(n).domNode;else if(a.tagName&&"body"==a.tagName.toLowerCase()){if(a===q.body())break;a=t.get(a.ownerDocument).frameElement}else{var g=a.getAttribute&&a.getAttribute("widgetId"),e=g&&v.byId(g);!e||"mouse"==c&&e.get("disabled")||d.unshift(g);a=a.parentNode}}}catch(G){}this._setStack(d,c)},_onFocusNode:function(a){a&&9!=a.nodeType&&(w=(new Date).getTime(),this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),delete this._clearFocusTimer),this._onTouchNode(a),a!=
this.curNode&&(this.set("prevNode",this.curNode),this.set("curNode",a)))},_setStack:function(a,c){var d=this.activeStack,b=d.length-1,n=a.length-1;if(a[n]!=d[b]){this.set("activeStack",a);var g;for(g=b;0<=g&&d[g]!=a[g];g--)if(b=v.byId(d[g]))b._hasBeenBlurred=!0,b.set("focused",!1),b._focusManager==this&&b._onBlur(c),this.emit("widget-blur",b,c);for(g++;g<=n;g++)if(b=v.byId(a[g]))b.set("focused",!0),b._focusManager==this&&b._onFocus(c),this.emit("widget-focus",b,c)}},focus:function(a){if(a)try{a.focus()}catch(B){}}}));
d(function(){var a=y.registerWin(t.get(document));c("ie")&&g(window,"unload",function(){a&&(a.remove(),a=null)})});u.focus=function(a){y.focus(a)};for(var A in y)/^_/.test(A)||(u.focus[A]="function"==typeof y[A]?m.hitch(y,A):y[A]);y.watch(function(a,c,d){u.focus[a]=d});return y})},"dojo/window":function(){define("./_base/lang ./sniff ./_base/window ./dom ./dom-geometry ./dom-style ./dom-construct".split(" "),function(h,k,a,f,b,e,l){k.add("rtl-adjust-position-for-verticalScrollBar",function(g,d){var c=
a.body(d),n=l.create("div",{style:{overflow:"scroll",overflowX:"visible",direction:"rtl",visibility:"hidden",position:"absolute",left:"0",top:"0",width:"64px",height:"64px"}},c,"last"),e=l.create("div",{style:{overflow:"hidden",direction:"ltr"}},n,"last"),f=0!=b.position(e).x;n.removeChild(e);c.removeChild(n);return f});k.add("position-fixed-support",function(g,d){var c=a.body(d),n=l.create("span",{style:{visibility:"hidden",position:"fixed",left:"1px",top:"1px"}},c,"last"),e=l.create("span",{style:{position:"fixed",
left:"0",top:"0"}},n,"last"),f=b.position(e).x!=b.position(n).x;n.removeChild(e);c.removeChild(n);return f});var m={getBox:function(g){g=g||a.doc;var d="BackCompat"==g.compatMode?a.body(g):g.documentElement,c=b.docScroll(g);if(k("touch")){var n=m.get(g);g=n.innerWidth||d.clientWidth;d=n.innerHeight||d.clientHeight}else g=d.clientWidth,d=d.clientHeight;return{l:c.x,t:c.y,w:g,h:d}},get:function(a){if(k("ie")&&m!==document.parentWindow){a.parentWindow.execScript("document._parentWindow \x3d window;",
"Javascript");var d=a._parentWindow;a._parentWindow=null;return d}return a.parentWindow||a.defaultView},scrollIntoView:function(g,d){try{g=f.byId(g);var c=g.ownerDocument||a.doc,n=a.body(c),l=c.documentElement||n.parentNode,m=k("ie")||k("trident"),r=k("webkit");if(g!=n&&g!=l)if(!(k("mozilla")||m||r||k("opera")||k("trident")||k("edge"))&&"scrollIntoView"in g)g.scrollIntoView(!1);else{var v="BackCompat"==c.compatMode,u=Math.min(n.clientWidth||l.clientWidth,l.clientWidth||n.clientWidth),h=Math.min(n.clientHeight||
l.clientHeight,l.clientHeight||n.clientHeight),c=r||v?n:l,x=d||b.position(g),y=g.parentNode,r=function(a){return 6>=m||7==m&&v?!1:k("position-fixed-support")&&"fixed"==e.get(a,"position").toLowerCase()},A=this,z=function(a,c,d){"BODY"==a.tagName||"HTML"==a.tagName?A.get(a.ownerDocument).scrollBy(c,d):(c&&(a.scrollLeft+=c),d&&(a.scrollTop+=d))};if(!r(g))for(;y;){y==n&&(y=c);var B=b.position(y),C=r(y),D="rtl"==e.getComputedStyle(y).direction.toLowerCase();if(y==c)B.w=u,B.h=h,c==l&&(m||k("trident"))&&
D&&(B.x+=c.offsetWidth-B.w),B.x=0,B.y=0;else{var E=b.getPadBorderExtents(y);B.w-=E.w;B.h-=E.h;B.x+=E.l;B.y+=E.t;var F=y.clientWidth,G=B.w-F;0<F&&0<G&&(D&&k("rtl-adjust-position-for-verticalScrollBar")&&(B.x+=G),B.w=F);F=y.clientHeight;G=B.h-F;0<F&&0<G&&(B.h=F)}C&&(0>B.y&&(B.h+=B.y,B.y=0),0>B.x&&(B.w+=B.x,B.x=0),B.y+B.h>h&&(B.h=h-B.y),B.x+B.w>u&&(B.w=u-B.x));var I=x.x-B.x,J=x.y-B.y,L=I+x.w-B.w,M=J+x.h-B.h,H,K;0<L*I&&(y.scrollLeft||y==c||y.scrollWidth>y.offsetHeight)&&(H=Math[0>I?"max":"min"](I,L),
D&&(8==m&&!v||5<=k("trident"))&&(H=-H),K=y.scrollLeft,z(y,H,0),H=y.scrollLeft-K,x.x-=H);0<M*J&&(y.scrollTop||y==c||y.scrollHeight>y.offsetHeight)&&(H=Math.ceil(Math[0>J?"max":"min"](J,M)),K=y.scrollTop,z(y,0,H),H=y.scrollTop-K,x.y-=H);y=y!=c&&!C&&y.parentNode}}}catch(P){console.error("scrollIntoView: "+P),g.scrollIntoView(!1)}}};h.setObject("dojo.window",m);return m})},"dijit/a11y":function(){define("dojo/_base/array dojo/dom dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/sniff ./main".split(" "),
function(h,k,a,f,b,e,l){var m={_isElementShown:function(b){var d=f.get(b);return"hidden"!=d.visibility&&"collapsed"!=d.visibility&&"none"!=d.display&&"hidden"!=a.get(b,"type")},hasDefaultTabStop:function(b){switch(b.nodeName.toLowerCase()){case "a":return a.has(b,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return!0;case "iframe":var d;try{var c=b.contentDocument;if("designMode"in c&&"on"==c.designMode)return!0;d=c.body}catch(n){try{d=b.contentWindow.document.body}catch(q){return!1}}return d&&
("true"==d.contentEditable||d.firstChild&&"true"==d.firstChild.contentEditable);default:return"true"==b.contentEditable}},effectiveTabIndex:function(b){if(!a.get(b,"disabled"))return a.has(b,"tabIndex")?+a.get(b,"tabIndex"):m.hasDefaultTabStop(b)?0:void 0},isTabNavigable:function(a){return 0<=m.effectiveTabIndex(a)},isFocusable:function(a){return-1<=m.effectiveTabIndex(a)},_getTabNavigable:function(b){function d(a){return a&&"input"==a.tagName.toLowerCase()&&a.type&&"radio"==a.type.toLowerCase()&&
a.name&&a.name.toLowerCase()}function c(a){return h[d(a)]||a}var n,g,f,l,v,u,h={},x=m._isElementShown,k=m.effectiveTabIndex,A=function(c){for(c=c.firstChild;c;c=c.nextSibling)if(!(1!=c.nodeType||9>=e("ie")&&"HTML"!==c.scopeName)&&x(c)){var b=k(c);if(0<=b){if(0==b)n||(n=c),g=c;else if(0<b){if(!f||b<l)l=b,f=c;if(!v||b>=u)u=b,v=c}b=d(c);a.get(c,"checked")&&b&&(h[b]=c)}"SELECT"!=c.nodeName.toUpperCase()&&A(c)}};x(b)&&A(b);return{first:c(n),last:c(g),lowest:c(f),highest:c(v)}},getFirstInTabbingOrder:function(a,
d){var c=m._getTabNavigable(k.byId(a,d));return c.lowest?c.lowest:c.first},getLastInTabbingOrder:function(a,d){var c=m._getTabNavigable(k.byId(a,d));return c.last?c.last:c.highest}};b.mixin(l,m);return m})},"dojo/uacss":function(){define(["./dom-geometry","./_base/lang","./domReady","./sniff","./_base/window"],function(h,k,a,f,b){var e=b.doc.documentElement;b=f("ie");var l=f("trident"),m=f("opera"),g=Math.floor,d=f("ff"),c=h.boxModel.replace(/-/,""),m={dj_quirks:f("quirks"),dj_opera:m,dj_khtml:f("khtml"),
dj_webkit:f("webkit"),dj_safari:f("safari"),dj_chrome:f("chrome"),dj_edge:f("edge"),dj_gecko:f("mozilla"),dj_ios:f("ios"),dj_android:f("android")};b&&(m.dj_ie=!0,m["dj_ie"+g(b)]=!0,m.dj_iequirks=f("quirks"));l&&(m.dj_trident=!0,m["dj_trident"+g(l)]=!0);d&&(m["dj_ff"+g(d)]=!0);m["dj_"+c]=!0;var n="",q;for(q in m)m[q]&&(n+=q+" ");e.className=k.trim(e.className+" "+n);a(function(){if(!h.isBodyLtr()){var a="dj_rtl dijitRtl "+n.replace(/ /g,"-rtl ");e.className=k.trim(e.className+" "+a+"dj_rtl dijitRtl "+
n.replace(/ /g,"-rtl "))}});return f})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(h,k,a,f){a(function(){k("highcontrast")&&h.add(f.body(),"dijit_a11y")});return k})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),function(h,k,a,f,b,e,l){b.add("highcontrast",function(){var a=l.doc.createElement("div");try{a.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+
(k.blankGif||h.toUrl("./resources/blank.gif"))+'");';l.body().appendChild(a);var g=f.getComputedStyle(a),d=g.backgroundImage;return g.borderTopColor==g.borderRightColor||d&&("none"==d||"url(invalid-url:)"==d)}catch(c){return console.warn("hccss: exception detecting high-contrast mode, document is likely hidden: "+c.toString()),!1}finally{8>=b("ie")?a.outerHTML="":l.body().removeChild(a)}});e(function(){b("highcontrast")&&a.add(l.body(),"dj_a11y")});return b})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),
function(h,k,a,f,b,e,l,m){var g=k("dijit._TemplatedMixin",m,{templateString:null,templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(a){var c=this.declaredClass,d=this;return l.substitute(a,this,function(a,b){"!"==b.charAt(0)&&(a=f.getObject(b.substr(1),!1,d));if("undefined"==typeof a)throw Error(c+" template:"+b);return null==a?"":"!"==b.charAt(0)?a:this._escapeValue(""+a)},this)},_escapeValue:function(a){return a.replace(/["'<>&]/g,function(a){return{"\x26":"\x26amp;",
"\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[a]})},buildRendering:function(){if(!this._rendered){this.templateString||(this.templateString=h(this.templatePath,{sanitize:!0}));var d=g.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),c;if(f.isString(d)){if(c=a.toDom(this._stringRepl(d),this.ownerDocument),1!=c.nodeType)throw Error("Invalid template: "+d);}else c=d.cloneNode(!0);this.domNode=c}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);
this._rendered=!0},_fillContent:function(a){var c=this.containerNode;if(a&&c)for(;a.hasChildNodes();)c.appendChild(a.firstChild)}});g._templateCache={};g.getCachedTemplate=function(d,c,b){var n=g._templateCache,e=d,f=n[e];if(f){try{if(!f.ownerDocument||f.ownerDocument==(b||document))return f}catch(v){}a.destroy(f)}d=l.trim(d);if(c||d.match(/\$\{([^\}]+)\}/g))return n[e]=d;c=a.toDom(d,b);if(1!=c.nodeType)throw Error("Invalid template: "+d);return n[e]=c};e("ie")&&b(window,"unload",function(){var d=
g._templateCache,c;for(c in d){var b=d[c];"object"==typeof b&&a.destroy(b);delete d[c]}});return g})},"dojo/cache":function(){define(["./_base/kernel","./text"],function(h){return h.cache})},"dojo/text":function(){define(["./_base/kernel","require","./has","./request"],function(h,k,a,f){var b;b=function(a,c,b){f(a,{sync:!!c,headers:{"X-Requested-With":null}}).then(b)};var e={},l=function(a){if(a){a=a.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var c=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);
c&&(a=c[1])}else a="";return a},m={},g={};h.cache=function(a,c,n){var d;"string"==typeof a?/\//.test(a)?(d=a,n=c):d=k.toUrl(a.replace(/\./g,"/")+(c?"/"+c:"")):(d=a+"",n=c);a=void 0!=n&&"string"!=typeof n?n.value:n;n=n&&n.sanitize;if("string"==typeof a)return e[d]=a,n?l(a):a;if(null===a)return delete e[d],null;d in e||b(d,!0,function(a){e[d]=a});return n?l(e[d]):e[d]};return{dynamic:!0,normalize:function(a,c){var d=a.split("!"),b=d[0];return(/^\./.test(b)?c(b):b)+(d[1]?"!"+d[1]:"")},load:function(a,
c,n){a=a.split("!");var d=1<a.length,f=a[0],r=c.toUrl(a[0]);a="url:"+r;var v=m,u=function(a){n(d?l(a):a)};f in e?v=e[f]:c.cache&&a in c.cache?v=c.cache[a]:r in e&&(v=e[r]);if(v===m)if(g[r])g[r].push(u);else{var h=g[r]=[u];b(r,!c.async,function(a){e[f]=e[r]=a;for(var c=0;c<h.length;)h[c++](a);delete g[r]})}else u(v)}}})},"dojo/request":function(){define(["./request/default!"],function(h){return h})},"dojo/request/default":function(){define(["exports","require","../has"],function(h,k,a){var f=a("config-requestProvider");
f||(f="./xhr");h.getPlatformDefaultId=function(){return"./xhr"};h.load=function(a,e,l,m){k(["platform"==a?"./xhr":f],function(a){l(a)})}})},"dojo/string":function(){define(["./_base/kernel","./_base/lang"],function(h,k){var a=/[&<>'"\/]/g,f={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;","/":"\x26#x2F;"},b={};k.setObject("dojo.string",b);b.escape=function(b){return b?b.replace(a,function(a){return f[a]}):""};b.rep=function(a,b){if(0>=b||!a)return"";for(var e=[];;){b&
1&&e.push(a);if(!(b>>=1))break;a+=a}return e.join("")};b.pad=function(a,f,m,g){m||(m="0");a=String(a);f=b.rep(m,Math.ceil((f-a.length)/m.length));return g?a+f:f+a};b.substitute=function(a,b,f,g){g=g||h.global;f=f?k.hitch(g,f):function(a){return a};return a.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,function(a,c,n){if(""==c)return"$";a=k.getObject(c,!1,b);n&&(a=k.getObject(n,!1,g).call(g,a,c));n=f(a,c);if("undefined"===typeof n)throw Error('string.substitute could not find key "'+c+'" in template');
return n.toString()})};b.trim=String.prototype.trim?k.trim:function(a){a=a.replace(/^\s+/,"");for(var b=a.length-1;0<=b;b--)if(/\S/.test(a.charAt(b))){a=a.substring(0,b+1);break}return a};return b})},"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(h,k,a,f,b,e,l,m,g){var d=b.delegate(m,{mouseenter:e.enter,mouseleave:e.leave,keypress:a._keypress}),c;a=f("dijit._AttachMixin",
null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);this._beforeFillContent()},_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var c=a;;)if(1==c.nodeType&&(this._processTemplateNode(c,function(a,c){return a.getAttribute(c)},this._attach)||this.searchContainerNode)&&c.firstChild)c=c.firstChild;else{if(c==a)break;for(;!c.nextSibling;)if(c=c.parentNode,c==a)return;c=
c.nextSibling}},_processTemplateNode:function(a,c,d){var n=!0,g=this.attachScope||this,e=c(a,"dojoAttachPoint")||c(a,"data-dojo-attach-point");if(e)for(var f=e.split(/\s*,\s*/);e=f.shift();)b.isArray(g[e])?g[e].push(a):g[e]=a,n="containerNode"!=e,this._attachPoints.push(e);if(c=c(a,"dojoAttachEvent")||c(a,"data-dojo-attach-event"))for(e=c.split(/\s*,\s*/),f=b.trim;c=e.shift();)if(c){var l=null;-1!=c.indexOf(":")?(l=c.split(":"),c=f(l[0]),l=f(l[1])):c=f(c);l||(l=c);this._attachEvents.push(d(a,c,b.hitch(g,
l)))}return n},_attach:function(a,b,g){b=b.replace(/^on/,"").toLowerCase();b="dijitclick"==b?c||(c=h("./a11yclick")):d[b]||b;return l(a,b,g)},_detachTemplateNodes:function(){var a=this.attachScope||this;k.forEach(this._attachPoints,function(c){delete a[c]});this._attachPoints=[];k.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});b.extend(g,{dojoAttachEvent:"",dojoAttachPoint:""});return a})},
"dijit/layout/LayoutContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-style dojo/_base/lang ../_WidgetBase ./_LayoutWidget ./utils".split(" "),function(h,k,a,f,b,e,l,m){k=k("dijit.layout.LayoutContainer",l,{design:"headline",baseClass:"dijitLayoutContainer",startup:function(){this._started||(h.forEach(this.getChildren(),this._setupChild,this),this.inherited(arguments))},_setupChild:function(b){this.inherited(arguments);b.region&&a.add(b.domNode,this.baseClass+
"Pane")},_getOrderedChildren:function(){var a=h.map(this.getChildren(),function(a,c){return{pane:a,weight:["center"==a.region?Infinity:0,a.layoutPriority,("sidebar"==this.design?1:-1)*(/top|bottom/.test(a.region)?1:-1),c]}},this);a.sort(function(a,c){for(var d=a.weight,b=c.weight,g=0;g<d.length;g++)if(d[g]!=b[g])return d[g]-b[g];return 0});return h.map(a,function(a){return a.pane})},layout:function(){m.layoutChildren(this.domNode,this._contentBox,this._getOrderedChildren())},addChild:function(a,d){this.inherited(arguments);
this._started&&this.layout()},removeChild:function(b){this.inherited(arguments);this._started&&this.layout();a.remove(b.domNode,this.baseClass+"Pane");f.set(b.domNode,{top:"auto",bottom:"auto",left:"auto",right:"auto",position:"static"});f.set(b.domNode,/top|bottom/.test(b.region)?"width":"height","auto")}});k.ChildWidgetProperties={region:"",layoutAlign:"",layoutPriority:0};b.extend(e,k.ChildWidgetProperties);return k})},"dijit/layout/_LayoutWidget":function(){define("dojo/_base/lang ../_Widget ../_Container ../_Contained ../Viewport dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style".split(" "),
function(h,k,a,f,b,e,l,m,g){return e("dijit.layout._LayoutWidget",[k,a,f],{baseClass:"dijitLayoutContainer",isLayoutContainer:!0,_setTitleAttr:null,buildRendering:function(){this.inherited(arguments);l.add(this.domNode,"dijitContainer")},startup:function(){if(!this._started){this.inherited(arguments);var a=this.getParent&&this.getParent();a&&a.isLayoutContainer||(this.resize(),this.own(b.on("resize",h.hitch(this,"resize"))))}},resize:function(a,c){var d=this.domNode;a&&m.setMarginBox(d,a);var b=c||
{};h.mixin(b,a||{});"h"in b&&"w"in b||(b=h.mixin(m.getMarginBox(d),b));var e=g.getComputedStyle(d),f=m.getMarginExtents(d,e),l=m.getBorderExtents(d,e),b=this._borderBox={w:b.w-(f.w+l.w),h:b.h-(f.h+l.h)},f=m.getPadExtents(d,e);this._contentBox={l:g.toPixelValue(d,e.paddingLeft),t:g.toPixelValue(d,e.paddingTop),w:b.w-f.w,h:b.h-f.h};this.layout()},layout:function(){},_setupChild:function(a){l.add(a.domNode,this.baseClass+"-child "+(a.baseClass?this.baseClass+"-"+a.baseClass:""))},addChild:function(a,
c){this.inherited(arguments);this._started&&this._setupChild(a)},removeChild:function(a){l.remove(a.domNode,this.baseClass+"-child"+(a.baseClass?" "+this.baseClass+"-"+a.baseClass:""));this.inherited(arguments)}})})},"dijit/_Container":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/kernel"],function(h,k,a,f){return k("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode)},addChild:function(b,
e){var f=this.containerNode;if(0<e){for(f=f.firstChild;0<e;)1==f.nodeType&&e--,f=f.nextSibling;f?e="before":(f=this.containerNode,e="last")}a.place(b.domNode,f,e);this._started&&!b._started&&b.startup()},removeChild:function(a){"number"==typeof a&&(a=this.getChildren()[a]);a&&(a=a.domNode)&&a.parentNode&&a.parentNode.removeChild(a)},hasChildren:function(){return 0<this.getChildren().length},_getSiblingOfChild:function(a,e){var b=this.getChildren(),f=h.indexOf(b,a);return b[f+e]},getIndexOfChild:function(a){return h.indexOf(this.getChildren(),
a)}})})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(h,k){return h("dijit._Contained",null,{_getSibling:function(a){var f=this.getParent();return f&&f._getSiblingOfChild&&f._getSiblingOfChild(this,"previous"==a?-1:1)||null},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var a=this.getParent();return a&&a.getIndexOfChild?a.getIndexOfChild(this):-1}})})},"dijit/Viewport":function(){define(["dojo/Evented",
"dojo/on","dojo/domReady","dojo/sniff","dojo/window"],function(h,k,a,f,b){var e=new h,l;a(function(){var a=b.getBox();e._rlh=k(window,"resize",function(){var d=b.getBox();if(a.h!=d.h||a.w!=d.w)a=d,e.emit("resize")});if(8==f("ie")){var g=screen.deviceXDPI;setInterval(function(){screen.deviceXDPI!=g&&(g=screen.deviceXDPI,e.emit("resize"))},500)}f("ios")&&(k(document,"focusin",function(a){l=a.target}),k(document,"focusout",function(a){l=null}))});e.getEffectiveBox=function(a){a=b.getBox(a);var g=l&&
l.tagName&&l.tagName.toLowerCase();f("ios")&&l&&!l.readOnly&&("textarea"==g||"input"==g&&/^(color|email|number|password|search|tel|text|url)$/.test(l.type))&&(a.h*=0==orientation||180==orientation?.66:.4,g=l.getBoundingClientRect(),a.h=Math.max(a.h,g.top+g.height));return a};return e})},"dijit/layout/utils":function(){define(["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],function(h,k,a,f,b){function e(a){return a.substring(0,1).toUpperCase()+a.substring(1)}
function l(g,d){var c=g.resize?g.resize(d):a.setMarginBox(g.domNode,d);c?b.mixin(g,c):(b.mixin(g,a.getMarginBox(g.domNode)),b.mixin(g,d))}var m={marginBox2contentBox:function(b,d){var c=f.getComputedStyle(b),n=a.getMarginExtents(b,c),g=a.getPadBorderExtents(b,c);return{l:f.toPixelValue(b,c.paddingLeft),t:f.toPixelValue(b,c.paddingTop),w:d.w-(n.w+g.w),h:d.h-(n.h+g.h)}},layoutChildren:function(a,d,c,n,f){d=b.mixin({},d);k.add(a,"dijitLayoutContainer");c=h.filter(c,function(a){return"center"!=a.region&&
"client"!=a.layoutAlign}).concat(h.filter(c,function(a){return"center"==a.region||"client"==a.layoutAlign}));h.forEach(c,function(a){var c=a.domNode,b=a.region||a.layoutAlign;if(!b)throw Error("No region setting for "+a.id);var g=c.style;g.left=d.l+"px";g.top=d.t+"px";g.position="absolute";k.add(c,"dijitAlign"+e(b));c={};n&&n==a.id&&(c["top"==a.region||"bottom"==a.region?"h":"w"]=f);"leading"==b&&(b=a.isLeftToRight()?"left":"right");"trailing"==b&&(b=a.isLeftToRight()?"right":"left");"top"==b||"bottom"==
b?(c.w=d.w,l(a,c),d.h-=a.h,"top"==b?d.t+=a.h:g.top=d.t+d.h+"px"):"left"==b||"right"==b?(c.h=d.h,l(a,c),d.w-=a.w,"left"==b?d.l+=a.w:g.left=d.l+d.w+"px"):"client"!=b&&"center"!=b||l(a,d)})}};b.setObject("dijit.layout.utils",m);return m})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when dojo/i18n!../nls/loading".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v){return g("dijit.layout.ContentPane",[a,f,b],{href:"",content:"",extractContent:!1,parseOnLoad:!0,parserScope:h._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",
isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(a,c,d){var b=new d(a,c);return!b.href&&b._contentSetter&&b._contentSetter.parseDeferred&&!b._contentSetter.parseDeferred.isFulfilled()?b._contentSetter.parseDeferred.then(function(){return b}):b},create:function(a,d){if(!(a&&a.template||!d||"href"in a||"content"in a)){d=c.byId(d);for(var b=d.ownerDocument.createDocumentFragment();d.firstChild;)b.appendChild(d.firstChild);
a=k.delegate(a,{content:b})}this.inherited(arguments,[a,d])},postMixInProperties:function(){this.inherited(arguments);var a=r.getLocalization("dijit","loading",this.lang);this.loadingMessage=e.substitute(this.loadingMessage,a);this.errorMessage=e.substitute(this.errorMessage,a)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&m.forEach(this._contentSetter.parseResults,
function(a){a._started||a._destroyed||!k.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},_startChildren:function(){m.forEach(this.getChildren(),function(a){a._started||a._destroyed||!k.isFunction(a.startup)||(a.startup(),a._started=!0)});this._contentSetter&&m.forEach(this._contentSetter.parseResults,function(a){a._started||a._destroyed||!k.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},setHref:function(a){h.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.",
"","2.0");return this.set("href",a)},_setHrefAttr:function(a){this.cancel();this.onLoadDeferred=new d(k.hitch(this,"cancel"));this.onLoadDeferred.then(k.hitch(this,"onLoad"));this._set("href",a);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(a){h.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",a)},_setContentAttr:function(a){this._set("href",
"");this.cancel();this.onLoadDeferred=new d(k.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(k.hitch(this,"onLoad"));this._setContent(a||"");this._isDownloaded=!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(a){this._beingDestroyed||
this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},refresh:function(){this.cancel();this.onLoadDeferred=new d(k.hitch(this,"cancel"));this.onLoadDeferred.then(k.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var a=this,c={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};
k.isObject(this.ioArgs)&&k.mixin(c,this.ioArgs);var d=this._xhrDfd=(this.ioMethod||t.get)(c),b;d.then(function(c){b=c;try{return a._isDownloaded=!0,a._setContent(c,!1)}catch(z){a._onError("Content",z)}},function(c){d.canceled||a._onError("Download",c);delete a._xhrDfd;return c}).then(function(){a.onDownloadEnd();delete a._xhrDfd;return b});delete this._hrefChanged},_onLoadHandler:function(a){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(a)}catch(w){console.error("Error "+this.widgetId+
" running custom onLoad code: "+w.message)}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(u){console.error("Error "+this.widgetId+" running custom onUnload code: "+u.message)}},destroyDescendants:function(a){this.isLoaded&&this._onUnloadHandler();var c=this._contentSetter;m.forEach(this.getChildren(),function(c){c.destroyRecursive?c.destroyRecursive(a):c.destroy&&c.destroy(a);c._destroyed=!0});c&&(m.forEach(c.parseResults,function(c){c._destroyed||(c.destroyRecursive?
c.destroyRecursive(a):c.destroy&&c.destroy(a),c._destroyed=!0)}),delete c.parseResults);a||q.empty(this.containerNode);delete this._singleChild},_setContent:function(a,c){a=this.preprocessContent(a);this.destroyDescendants();var d=this._contentSetter;d&&d instanceof l._ContentSetter||(d=this._contentSetter=new l._ContentSetter({node:this.containerNode,_onError:k.hitch(this,this._onError),onContentError:k.hitch(this,function(a){a=this.onContentError(a);try{this.containerNode.innerHTML=a}catch(B){console.error("Fatal "+
this.id+" could not change content due to "+B.message,B)}})}));var b=k.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!a.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{}),b=d.set(k.isObject(a)&&a.domNode?a.domNode:a,b),g=this;return v(b&&b.then?b:d.parseDeferred,function(){delete g._contentSetterParams;c||(g._started&&(g._startChildren(),g._scheduleLayout()),g._onLoadHandler(a))})},
preprocessContent:function(a){return a},_onError:function(a,c,d){this.onLoadDeferred.reject(c);a=this["on"+a+"Error"].call(this,c);d?console.error(d,c):a&&this._setContent(a,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),
function(h,k,a,f,b,e,l,m,g,d){return k("dijit.layout._ContentPaneResizeMixin",null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var a=this.getParent();this._childOfLayoutWidget=a&&a.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(g.on("resize",e.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var c=[],d=!1;l("\x3e *",this.containerNode).some(function(a){var b=
m.byNode(a);b&&b.resize?c.push(b):!/script|link|style/i.test(a.nodeName)&&a.offsetHeight&&(d=!0)});this._singleChild=1!=c.length||d?null:c[0];a.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(a,d){this._resizeCalled=!0;this._scheduleLayout(a,d)},_scheduleLayout:function(a,d){this._isShown()?this._layout(a,d):(this._needLayout=!0,this._changeSize=a,this._resultSize=d)},_layout:function(a,b){delete this._needLayout;this._wasShown||!1===this.open||this._onShow();
a&&f.setMarginBox(this.domNode,a);var c=this.containerNode;if(c===this.domNode){var g=b||{};e.mixin(g,a||{});"h"in g&&"w"in g||(g=e.mixin(f.getMarginBox(c),g));this._contentBox=d.marginBox2contentBox(c,g)}else this._contentBox=f.getContentBox(c);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var a=this._contentBox||f.getContentBox(this.containerNode);this._singleChild.resize({w:a.w,h:a.h})}else for(var a=this.getChildren(),
d,b=0;d=a[b++];)d.resize&&d.resize()},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var c=this.domNode,d=this.domNode.parentNode;return"none"!=c.style.display&&"hidden"!=c.style.visibility&&!a.contains(c,"dijitHidden")&&d&&d.style&&"none"!=d.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),
function(h,k,a,f,b,e,l){var m=0,g={_secureForInnerHtml:function(a){return a.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,"")},_emptyNode:e.empty,_setNodeContent:function(a,c){e.empty(a);if(c)if("number"==typeof c&&(c=c.toString()),"string"==typeof c&&(c=e.toDom(c,a.ownerDocument)),!c.nodeType&&k.isArrayLike(c))for(var d=c.length,b=0;b<c.length;b=d==c.length?b+1:0)e.place(c[b],a,"last");else e.place(c,a,"last");return a},_ContentSetter:f("dojo.html._ContentSetter",null,{node:"",
content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:h._scopeName,startup:!0,constructor:function(a,c){k.mixin(this,a||{});c=this.node=b.byId(this.node||c);this.id||(this.id=["Setter",c?c.id||c.tagName:"",m++].join("_"))},set:function(a,c){void 0!==a&&(this.content=a);"number"==typeof a&&(a=a.toString());c&&this._mixin(c);this.onBegin();this.setContent();var d=this.onEnd();return d&&d.then?d:this.node},setContent:function(){var a=this.node;if(!a)throw Error(this.declaredClass+
": setContent given no node");try{a=g._setNodeContent(a,this.content)}catch(n){var c=this.onContentError(n);try{a.innerHTML=c}catch(q){console.error("Fatal "+this.declaredClass+".setContent could not change content due to "+q.message,q)}}this.node=a},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(a.forEach(this.parseResults,function(a){a.destroy&&a.destroy()}),delete this.parseResults);
e.empty(this.node)},onBegin:function(){var a=this.content;if(k.isString(a)&&(this.cleanContent&&(a=g._secureForInnerHtml(a)),this.extractContent)){var c=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);c&&(a=c[1])}this.empty();this.content=a;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(a){return"Error occurred setting content: "+
a},onExecError:function(a){return"Error occurred executing scripts: "+a},_mixin:function(a){var c={},d;for(d in a)d in c||(this[d]=a[d])},_parse:function(){var d=this.node;try{var c={};a.forEach(["dir","lang","textDir"],function(a){this[a]&&(c[a]=this[a])},this);var b=this;this.parseDeferred=l.parse({rootNode:d,noStart:!this.startup,inherited:c,scope:this.parserScope}).then(function(a){return b.parseResults=a},function(a){b._onError("Content",a,"Error parsing in _ContentSetter#"+this.id)})}catch(q){this._onError("Content",
q,"Error parsing in _ContentSetter#"+this.id)}},_onError:function(a,c,b){a=this["on"+a+"Error"].call(this,c);b?console.error(b,c):a&&g._setNodeContent(this.node,a,!0)}}),set:function(a,c,b){void 0==c&&(console.warn("dojo.html.set: no cont argument provided, using empty string"),c="");"number"==typeof c&&(c=c.toString());return b?(new g._ContentSetter(k.mixin(b,{content:c,node:a}))).set():g._setNodeContent(a,c,!0)}};k.setObject("dojo.html",g);return g})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v){function u(a){return eval("("+a+")")}function w(a){var c=a._nameCaseMap,d=a.prototype;if(!c||c._extendCnt<y){var c=a._nameCaseMap={},b;for(b in d)"_"!==b.charAt(0)&&(c[b.toLowerCase()]=b);c._extendCnt=y}return c}function x(c,d){d||(d=h);var b=d._dojoParserCtorMap||(d._dojoParserCtorMap={}),g=c.join();if(!b[g]){for(var n=[],e=0,f=c.length;e<f;e++){var l=c[e];n[n.length]=b[l]=b[l]||a.getObject(l)||~l.indexOf("/")&&d(l)}e=n.shift();b[g]=n.length?e.createSubclass?
e.createSubclass(n):e.extend.apply(e,n):e}return b[g]}new Date("X");var y=0;g.after(a,"extend",function(){y++},!0);var A={_clearCache:function(){y++;_ctorMap={}},_functionFromScript:function(a,c){var d="",b="",g=a.getAttribute(c+"args")||a.getAttribute("args"),n=a.getAttribute("with"),g=(g||"").split(/\s*,\s*/);n&&n.length&&f.forEach(n.split(/\s*,\s*/),function(a){d+="with("+a+"){";b+="}"});return new Function(g,d+a.innerHTML+b)},instantiate:function(a,c,d){c=c||{};d=d||{};var b=(d.scope||k._scopeName)+
"Type",g="data-"+(d.scope||k._scopeName)+"-",n=g+"type",e=g+"mixins",l=[];f.forEach(a,function(a){var d=b in c?c[b]:a.getAttribute(n)||a.getAttribute(b);if(d){var g=a.getAttribute(e),d=g?[d].concat(g.split(/\s*,\s*/)):[d];l.push({node:a,types:d})}});return this._instantiate(l,c,d)},_instantiate:function(a,c,b,g){function n(a){c._started||b.noStart||f.forEach(a,function(a){"function"!==typeof a.startup||a._started||a.startup()});return a}a=f.map(a,function(a){var d=a.ctor||x(a.types,b.contextRequire);
if(!d)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(d,a.node,c,b,a.scripts,a.inherited)},this);return g?d(a).then(n):n(a)},construct:function(d,b,n,e,l,v){function h(c){E&&a.setObject(E,c);for(A=0;A<aa.length;A++)g[aa[A].advice||"after"](c,aa[A].method,a.hitch(c,aa[A].func),!0);for(A=0;A<X.length;A++)X[A].call(c);for(A=0;A<T.length;A++)c.watch(T[A].prop,T[A].func);for(A=0;A<V.length;A++)r(c,V[A].event,V[A].func);return c}var x=d&&d.prototype;e=e||{};
var y={};e.defaults&&a.mixin(y,e.defaults);v&&a.mixin(y,v);var z;q("dom-attributes-explicit")?z=b.attributes:q("dom-attributes-specified-flag")?z=f.filter(b.attributes,function(a){return a.specified}):(v=(/^input$|^img$/i.test(b.nodeName)?b:b.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),z=f.map(v.split(/\s+/),function(a){var c=a.toLowerCase();return{name:a,value:"LI"==b.nodeName&&"value"==a||"enctype"==c?b.getAttribute(c):
b.getAttributeNode(c).value}}));var C=e.scope||k._scopeName;v="data-"+C+"-";var B={};"dojo"!==C&&(B[v+"props"]="data-dojo-props",B[v+"type"]="data-dojo-type",B[v+"mixins"]="data-dojo-mixins",B[C+"type"]="dojotype",B[v+"id"]="data-dojo-id");for(var A=0,D,C=[],E,F;D=z[A++];){var Q=D.name,R=Q.toLowerCase();D=D.value;switch(B[R]||R){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":F=D;break;case "data-dojo-id":case "jsid":E=D;break;case "data-dojo-attach-point":case "dojoattachpoint":y.dojoAttachPoint=
D;break;case "data-dojo-attach-event":case "dojoattachevent":y.dojoAttachEvent=D;break;case "class":y["class"]=b.className;break;case "style":y.style=b.style&&b.style.cssText;break;default:if(Q in x||(Q=w(d)[R]||Q),Q in x)switch(typeof x[Q]){case "string":y[Q]=D;break;case "number":y[Q]=D.length?Number(D):NaN;break;case "boolean":y[Q]="false"!=D.toLowerCase();break;case "function":""===D||-1!=D.search(/[^\w\.]+/i)?y[Q]=new Function(D):y[Q]=a.getObject(D,!1)||new Function(D);C.push(Q);break;default:R=
x[Q],y[Q]=R&&"length"in R?D?D.split(/\s*,\s*/):[]:R instanceof Date?""==D?new Date(""):"now"==D?new Date:c.fromISOString(D):R instanceof m?k.baseUrl+D:u(D)}else y[Q]=D}}for(z=0;z<C.length;z++)B=C[z].toLowerCase(),b.removeAttribute(B),b[B]=null;if(F)try{F=u.call(e.propsThis,"{"+F+"}"),a.mixin(y,F)}catch(da){throw Error(da.toString()+" in data-dojo-props\x3d'"+F+"'");}a.mixin(y,n);l||(l=d&&(d._noScript||x._noScript)?[]:t("\x3e script[type^\x3d'dojo/']",b));var aa=[],X=[],T=[],V=[];if(l)for(A=0;A<l.length;A++)B=
l[A],b.removeChild(B),n=B.getAttribute(v+"event")||B.getAttribute("event"),e=B.getAttribute(v+"prop"),F=B.getAttribute(v+"method"),C=B.getAttribute(v+"advice"),z=B.getAttribute("type"),B=this._functionFromScript(B,v),n?"dojo/connect"==z?aa.push({method:n,func:B}):"dojo/on"==z?V.push({event:n,func:B}):y[n]=B:"dojo/aspect"==z?aa.push({method:F,advice:C,func:B}):"dojo/watch"==z?T.push({prop:e,func:B}):X.push(B);d=(l=d.markupFactory||x.markupFactory)?l(y,b,d):new d(y,b);return d.then?d.then(h):h(d)},
scan:function(a,c){function d(a){if(!a.inherited){a.inherited={};var c=a.node,b=d(a.parent),c={dir:c.getAttribute("dir")||b.dir,lang:c.getAttribute("lang")||b.lang,textDir:c.getAttribute(u)||b.textDir},g;for(g in c)c[g]&&(a.inherited[g]=c[g])}return a.inherited}var b=[],g=[],e={},l=(c.scope||k._scopeName)+"Type",m="data-"+(c.scope||k._scopeName)+"-",r=m+"type",u=m+"textdir",m=m+"mixins",q=a.firstChild,v=c.inherited;if(!v){var t=function(a,c){return a.getAttribute&&a.getAttribute(c)||a.parentNode&&
t(a.parentNode,c)},v={dir:t(a,"dir"),lang:t(a,"lang"),textDir:t(a,u)},w;for(w in v)v[w]||delete v[w]}for(var v={inherited:v},y,z;;)if(q)if(1!=q.nodeType)q=q.nextSibling;else if(y&&"script"==q.nodeName.toLowerCase())(B=q.getAttribute("type"))&&/^dojo\/\w/i.test(B)&&y.push(q),q=q.nextSibling;else if(z)q=q.nextSibling;else{var B=q.getAttribute(r)||q.getAttribute(l);w=q.firstChild;if(B||w&&(3!=w.nodeType||w.nextSibling)){z=null;if(B){var A=q.getAttribute(m);y=A?[B].concat(A.split(/\s*,\s*/)):[B];try{z=
x(y,c.contextRequire)}catch(X){}z||f.forEach(y,function(a){~a.indexOf("/")&&!e[a]&&(e[a]=!0,g[g.length]=a)});A=z&&!z.prototype._noScript?[]:null;v={types:y,ctor:z,parent:v,node:q,scripts:A};v.inherited=d(v);b.push(v)}else v={node:q,scripts:y,parent:v};y=A;z=q.stopParser||z&&z.prototype.stopParser&&!c.template;q=w}else q=q.nextSibling}else{if(!v||!v.node)break;q=v.node.nextSibling;z=!1;v=v.parent;y=v.scripts}var aa=new n;g.length?(c.contextRequire||h)(g,function(){aa.resolve(f.filter(b,function(a){if(!a.ctor)try{a.ctor=
x(a.types,c.contextRequire)}catch(da){}for(var d=a.parent;d&&!d.types;)d=d.parent;var b=a.ctor&&a.ctor.prototype;a.instantiateChildren=!(b&&b.stopParser&&!c.template);a.instantiate=!d||d.instantiate&&d.instantiateChildren;return a.instantiate}))}):aa.resolve(b);return aa.promise},_require:function(c,d){var b=u("{"+c.innerHTML+"}"),g=[],e=[],f=new n,l=d&&d.contextRequire||h,m;for(m in b)g.push(m),e.push(b[m]);l(e,function(){for(var c=0;c<g.length;c++)a.setObject(g[c],arguments[c]);f.resolve(arguments)});
return f.promise},_scanAmd:function(a,c){var d=new n,b=d.promise;d.resolve(!0);var g=this;t("script[type\x3d'dojo/require']",a).forEach(function(a){b=b.then(function(){return g._require(a,c)});a.parentNode.removeChild(a)});return b},parse:function(c,d){!c||"string"==typeof c||"nodeType"in c||(d=c,c=d.rootNode);var b=c?e.byId(c):l.body();d=d||{};var g=d.template?{template:!0}:{},n=[],f=this,m=this._scanAmd(b,d).then(function(){return f.scan(b,d)}).then(function(a){return f._instantiate(a,g,d,!0)}).then(function(a){return n=
n.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",a);throw a;});a.mixin(n,m);return n}};k.parser=A;b.parseOnLoad&&v(100,A,"parse");return A})},"dojo/_base/url":function(){define(["./kernel"],function(h){var k=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,a=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,f=function(){for(var b=arguments,e=[b[0]],l=1;l<b.length;l++)if(b[l]){var m=new f(b[l]+""),e=new f(e[0]+"");if(""==m.path&&!m.scheme&&
!m.authority&&!m.query)null!=m.fragment&&(e.fragment=m.fragment),m=e;else if(!m.scheme&&(m.scheme=e.scheme,!m.authority&&(m.authority=e.authority,"/"!=m.path.charAt(0)))){for(var e=(e.path.substring(0,e.path.lastIndexOf("/")+1)+m.path).split("/"),g=0;g<e.length;g++)"."==e[g]?g==e.length-1?e[g]="":(e.splice(g,1),g--):0<g&&(1!=g||""!=e[0])&&".."==e[g]&&".."!=e[g-1]&&(g==e.length-1?(e.splice(g,1),e[g-1]=""):(e.splice(g-1,2),g-=2));m.path=e.join("/")}e=[];m.scheme&&e.push(m.scheme,":");m.authority&&e.push("//",
m.authority);e.push(m.path);m.query&&e.push("?",m.query);m.fragment&&e.push("#",m.fragment)}this.uri=e.join("");b=this.uri.match(k);this.scheme=b[2]||(b[1]?"":null);this.authority=b[4]||(b[3]?"":null);this.path=b[5];this.query=b[7]||(b[6]?"":null);this.fragment=b[9]||(b[8]?"":null);null!=this.authority&&(b=this.authority.match(a),this.user=b[3]||null,this.password=b[4]||null,this.host=b[6]||b[7],this.port=b[9]||null)};f.prototype.toString=function(){return this.uri};return h._Url=f})},"dojo/promise/all":function(){define(["../_base/array",
"../Deferred","../when"],function(h,k,a){var f=h.some;return function(b){var e,l;b instanceof Array?l=b:b&&"object"===typeof b&&(e=b);var m,g=[];if(e){l=[];for(var d in e)Object.hasOwnProperty.call(e,d)&&(g.push(d),l.push(e[d]));m={}}else l&&(m=[]);if(!l||!l.length)return(new k).resolve(m);var c=new k;c.promise.always(function(){m=g=null});var n=l.length;f(l,function(d,b){e||g.push(b);a(d,function(a){c.isFulfilled()||(m[g[b]]=a,0===--n&&c.resolve(m))},c.reject);return c.isFulfilled()});return c.promise}})},
"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(h,k){var a={};h.setObject("dojo.date.stamp",a);a.fromISOString=function(f,b){a._isoRegExp||(a._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var e=a._isoRegExp.exec(f),l=null;if(e){e.shift();e[1]&&e[1]--;e[6]&&(e[6]*=1E3);b&&(b=new Date(b),k.forEach(k.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),function(a){return b["get"+
a]()}),function(a,c){e[c]=e[c]||a}));l=new Date(e[0]||1970,e[1]||0,e[2]||1,e[3]||0,e[4]||0,e[5]||0,e[6]||0);100>e[0]&&l.setFullYear(e[0]||1970);var m=0,g=e[7]&&e[7].charAt(0);"Z"!=g&&(m=60*(e[8]||0)+(Number(e[9])||0),"-"!=g&&(m*=-1));g&&(m-=l.getTimezoneOffset());m&&l.setTime(l.getTime()+6E4*m)}return l};a.toISOString=function(a,b){var e=function(a){return 10>a?"0"+a:a};b=b||{};var f=[],m=b.zulu?"getUTC":"get",g="";"time"!=b.selector&&(g=a[m+"FullYear"](),g=["0000".substr((g+"").length)+g,e(a[m+"Month"]()+
1),e(a[m+"Date"]())].join("-"));f.push(g);if("date"!=b.selector){g=[e(a[m+"Hours"]()),e(a[m+"Minutes"]()),e(a[m+"Seconds"]())].join(":");m=a[m+"Milliseconds"]();b.milliseconds&&(g+="."+(100>m?"0":"")+e(m));if(b.zulu)g+="Z";else if("time"!=b.selector)var m=a.getTimezoneOffset(),d=Math.abs(m),g=g+((0<m?"-":"+")+e(Math.floor(d/60))+":"+e(d%60));f.push(g)}return f.join("T")};return a})},"dojo/_base/Deferred":function(){define("./kernel ../Deferred ../promise/Promise ../errors/CancelError ../has ./lang ../when".split(" "),
function(h,k,a,f,b,e,l){var m=function(){},g=Object.freeze||function(){},d=h.Deferred=function(c){function n(a){if(r)throw Error("This deferred has already been resolved");t=a;r=!0;l()}function l(){for(var a;!a&&y;){var c=y;y=y.next;if(a=c.progress==m)r=!1;var d=h?c.error:c.resolved;b("config-useDeferredInstrumentation")&&h&&k.instrumentRejected&&k.instrumentRejected(t,!!d);if(d)try{var g=d(t);g&&"function"===typeof g.then?g.then(e.hitch(c.deferred,"resolve"),e.hitch(c.deferred,"reject"),e.hitch(c.deferred,
"progress")):(d=a&&void 0===g,a&&!d&&(h=g instanceof Error),c.deferred[d&&h?"reject":"resolve"](d?t:g))}catch(F){c.deferred.reject(F)}else h?c.deferred.reject(t):c.deferred.resolve(t)}}var t,r,v,u,h,x,y,A=this.promise=new a;this.isResolved=A.isResolved=function(){return 0==u};this.isRejected=A.isRejected=function(){return 1==u};this.isFulfilled=A.isFulfilled=function(){return 0<=u};this.isCanceled=A.isCanceled=function(){return v};this.resolve=this.callback=function(a){this.fired=u=0;this.results=
[a,null];n(a)};this.reject=this.errback=function(a){h=!0;this.fired=u=1;b("config-useDeferredInstrumentation")&&k.instrumentRejected&&k.instrumentRejected(a,!!y);n(a);this.results=[null,a]};this.progress=function(a){for(var c=y;c;){var d=c.progress;d&&d(a);c=c.next}};this.addCallbacks=function(a,c){this.then(a,c,m);return this};A.then=this.then=function(a,c,b){var g=b==m?this:new d(A.cancel);a={resolved:a,error:c,progress:b,deferred:g};y?x=x.next=a:y=x=a;r&&l();return g.promise};var z=this;A.cancel=
this.cancel=function(){if(!r){var a=c&&c(z);r||(a instanceof Error||(a=new f(a)),a.log=!1,z.reject(a))}v=!0};g(A)};e.extend(d,{addCallback:function(a){return this.addCallbacks(e.hitch.apply(h,arguments))},addErrback:function(a){return this.addCallbacks(null,e.hitch.apply(h,arguments))},addBoth:function(a){var c=e.hitch.apply(h,arguments);return this.addCallbacks(c,c)},fired:-1});d.when=h.when=l;return d})},"dojo/_base/xhr":function(){define("./kernel ./sniff require ../io-query ../dom ../dom-form ./Deferred ./config ./json ./lang ./array ../on ../aspect ../request/watch ../request/xhr ../request/util".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v){h._xhrObj=r._create;var u=h.config;h.objectToQuery=f.objectToQuery;h.queryToObject=f.queryToObject;h.fieldToObject=e.fieldToObject;h.formToObject=e.toObject;h.formToQuery=e.toQuery;h.formToJson=e.toJson;h._blockAsync=!1;k.add("native-xhr2-blob",function(){if(k("native-xhr2")){var a=new XMLHttpRequest;a.open("GET","/",!0);a.responseType="blob";var c=a.responseType;a.abort();return"blob"===c}});var w=h._contentHandlers=h.contentHandlers={text:function(a){return a.responseText},
json:function(a){return g.fromJson(a.responseText||null)},"json-comment-filtered":function(a){m.useCommentedJson||console.warn("Consider using the standard mimetype:application/json. json-commenting can introduce security issues. To decrease the chances of hijacking, use the standard the 'json' handler and prefix your json with: {}\x26\x26\nUse djConfig.useCommentedJson\x3dtrue to turn off this message.");a=a.responseText;var c=a.indexOf("/*"),d=a.lastIndexOf("*/");if(-1==c||-1==d)throw Error("JSON was not comment filtered");
return g.fromJson(a.substring(c+2,d))},javascript:function(a){return h.eval(a.responseText)},xml:function(a){var d=a.responseXML;d&&k("dom-qsa2.1")&&!d.querySelectorAll&&k("dom-parser")&&(d=(new DOMParser).parseFromString(a.responseText,"application/xml"));if(k("ie")&&(!d||!d.documentElement)){var b=function(a){return"MSXML"+a+".DOMDocument"},b=["Microsoft.XMLDOM",b(6),b(4),b(3),b(2)];c.some(b,function(c){try{var b=new ActiveXObject(c);b.async=!1;b.loadXML(a.responseText);d=b}catch(G){return!1}return!0})}return d},
"json-comment-optional":function(a){return a.responseText&&/^[^{\[]*\/\*/.test(a.responseText)?w["json-comment-filtered"](a):w.json(a)}};k("native-xhr2")&&(w.arraybuffer=w.blob=w.document=function(a,c){return"blob"!==c.args.handleAs||k("native-xhr2-blob")?a.response:new Blob([a.response],{type:a.getResponseHeader("Content-Type")})});h._ioSetArgs=function(a,c,g,n){var m={args:a,url:a.url},r=null;if(a.form){var r=b.byId(a.form),q=r.getAttributeNode("action");m.url=m.url||(q?q.value:h.doc?h.doc.URL:
null);r=e.toObject(r)}q=[{}];r&&q.push(r);a.content&&q.push(a.content);a.preventCache&&q.push({"dojo.preventCache":(new Date).valueOf()});m.query=f.objectToQuery(d.mixin.apply(null,q));m.handleAs=a.handleAs||"text";var v=new l(function(a){a.canceled=!0;c&&c(a);var d=a.ioArgs.error;d||(d=Error("request cancelled"),d.dojoType="cancel",a.ioArgs.error=d);return d});v.addCallback(g);var t=a.load;t&&d.isFunction(t)&&v.addCallback(function(c){return t.call(a,c,m)});var w=a.error;w&&d.isFunction(w)&&v.addErrback(function(c){return w.call(a,
c,m)});var x=a.handle;x&&d.isFunction(x)&&v.addBoth(function(c){return x.call(a,c,m)});v.addErrback(function(a){return n(a,v)});u.ioPublish&&h.publish&&!1!==m.args.ioPublish&&(v.addCallbacks(function(a){h.publish("/dojo/io/load",[v,a]);return a},function(a){h.publish("/dojo/io/error",[v,a]);return a}),v.addBoth(function(a){h.publish("/dojo/io/done",[v,a]);return a}));v.ioArgs=m;return v};var x=function(a){a=w[a.ioArgs.handleAs](a.ioArgs.xhr,a.ioArgs);return void 0===a?null:a},y=function(a,c){c.ioArgs.args.failOk||
console.error(a);return a},A=function(a){0>=z&&(z=0,u.ioPublish&&h.publish&&(!a||a&&!1!==a.ioArgs.args.ioPublish)&&h.publish("/dojo/io/stop"))},z=0;q.after(t,"_onAction",function(){--z});q.after(t,"_onInFlight",A);h._ioCancelAll=t.cancelAll;h._ioNotifyStart=function(a){u.ioPublish&&h.publish&&!1!==a.ioArgs.args.ioPublish&&(z||h.publish("/dojo/io/start"),z+=1,h.publish("/dojo/io/send",[a]))};h._ioWatch=function(a,c,b,g){a.ioArgs.options=a.ioArgs.args;d.mixin(a,{response:a.ioArgs,isValid:function(d){return c(a)},
isReady:function(c){return b(a)},handleResponse:function(c){return g(a)}});t(a);A(a)};h._ioAddQueryToUrl=function(a){a.query.length&&(a.url+=(-1==a.url.indexOf("?")?"?":"\x26")+a.query,a.query=null)};h.xhr=function(a,c,d){var b,g=h._ioSetArgs(c,function(a){b&&b.cancel()},x,y),n=g.ioArgs;"postData"in c?n.query=c.postData:"putData"in c?n.query=c.putData:"rawBody"in c?n.query=c.rawBody:(2<arguments.length&&!d||-1==="POST|PUT".indexOf(a.toUpperCase()))&&h._ioAddQueryToUrl(n);var e;k("native-xhr2")&&(e=
{arraybuffer:1,blob:1,document:1});e=k("native-xhr2")&&e[c.handleAs]?c.handleAs:"text";"blob"!==e||k("native-xhr2-blob")||(e="arraybuffer");e={method:a,handleAs:e,responseType:c.responseType,timeout:c.timeout,withCredentials:c.withCredentials,ioArgs:n};"undefined"!==typeof c.headers&&(e.headers=c.headers);"undefined"!==typeof c.contentType&&(e.headers||(e.headers={}),e.headers["Content-Type"]=c.contentType);"undefined"!==typeof n.query&&(e.data=n.query);"undefined"!==typeof c.sync&&(e.sync=c.sync);
h._ioNotifyStart(g);try{b=r(n.url,e,!0)}catch(J){return g.cancel(),g}g.ioArgs.xhr=b.response.xhr;b.then(function(){g.resolve(g)}).otherwise(function(a){n.error=a;a.response&&(a.status=a.response.status,a.responseText=a.response.text,a.xhr=a.response.xhr);g.reject(a)});return g};h.xhrGet=function(a){return h.xhr("GET",a)};h.rawXhrPost=h.xhrPost=function(a){return h.xhr("POST",a,!0)};h.rawXhrPut=h.xhrPut=function(a){return h.xhr("PUT",a,!0)};h.xhrDelete=function(a){return h.xhr("DELETE",a)};h._isDocumentOk=
function(a){return v.checkStatus(a.status)};h._getText=function(a){var c;h.xhrGet({url:a,sync:!0,load:function(a){c=a}});return c};d.mixin(h.xhr,{_xhrObj:h._xhrObj,fieldToObject:e.fieldToObject,formToObject:e.toObject,objectToQuery:f.objectToQuery,formToQuery:e.toQuery,formToJson:e.toJson,queryToObject:f.queryToObject,contentHandlers:w,_ioSetArgs:h._ioSetArgs,_ioCancelAll:h._ioCancelAll,_ioNotifyStart:h._ioNotifyStart,_ioWatch:h._ioWatch,_ioAddQueryToUrl:h._ioAddQueryToUrl,_isDocumentOk:h._isDocumentOk,
_getText:h._getText,get:h.xhrGet,post:h.xhrPost,put:h.xhrPut,del:h.xhrDelete});return h.xhr})},"dojo/io-query":function(){define(["./_base/lang"],function(h){var k={};return{objectToQuery:function(a){var f=encodeURIComponent,b=[],e;for(e in a){var l=a[e];if(l!=k[e]){var m=f(e)+"\x3d";if(h.isArray(l))for(var g=0,d=l.length;g<d;++g)b.push(m+f(l[g]));else b.push(m+f(l))}}return b.join("\x26")},queryToObject:function(a){var f=decodeURIComponent;a=a.split("\x26");for(var b={},e,l,m=0,g=a.length;m<g;++m)if(l=
a[m],l.length){var d=l.indexOf("\x3d");0>d?(e=f(l),l=""):(e=f(l.slice(0,d)),l=f(l.slice(d+1)));"string"==typeof b[e]&&(b[e]=[b[e]]);h.isArray(b[e])?b[e].push(l):b[e]=l}return b}}})},"dojo/dom-form":function(){define(["./_base/lang","./dom","./io-query","./json"],function(h,k,a,f){var b={fieldToObject:function(a){var b=null;if(a=k.byId(a)){var e=a.name,g=(a.type||"").toLowerCase();if(e&&g&&!a.disabled)if("radio"==g||"checkbox"==g)a.checked&&(b=a.value);else if(a.multiple)for(b=[],a=[a.firstChild];a.length;)for(e=
a.pop();e;e=e.nextSibling)if(1==e.nodeType&&"option"==e.tagName.toLowerCase())e.selected&&b.push(e.value);else{e.nextSibling&&a.push(e.nextSibling);e.firstChild&&a.push(e.firstChild);break}else b=a.value}return b},toObject:function(a){var e={};a=k.byId(a).elements;for(var f=0,g=a.length;f<g;++f){var d=a[f],c=d.name,n=(d.type||"").toLowerCase();if(c&&n&&0>"file|submit|image|reset|button".indexOf(n)&&!d.disabled){var q=e,t=c,d=b.fieldToObject(d);if(null!==d){var r=q[t];"string"==typeof r?q[t]=[r,d]:
h.isArray(r)?r.push(d):q[t]=d}"image"==n&&(e[c+".x"]=e[c+".y"]=e[c].x=e[c].y=0)}}return e},toQuery:function(e){return a.objectToQuery(b.toObject(e))},toJson:function(a,l){return f.stringify(b.toObject(a),null,l?4:0)}};return b})},"dojo/json":function(){define(["./has"],function(h){var k="undefined"!=typeof JSON;h.add("json-parse",k);h.add("json-stringify",k&&'{"a":1}'==JSON.stringify({a:0},function(a,b){return b||1}));if(h("json-stringify"))return JSON;var a=function(a){return('"'+a.replace(/(["\\])/g,
"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")};return{parse:h("json-parse")?JSON.parse:function(a,b){if(b&&!/^([\s\[\{]*(?:"(?:\\.|[^"])*"|-?\d[\d\.]*(?:[Ee][+-]?\d+)?|null|true|false|)[\s\]\}]*(?:,|:|$))+$/.test(a))throw new SyntaxError("Invalid characters in JSON");return eval("("+a+")")},stringify:function(f,b,e){function l(g,d,c){b&&(g=b(c,g));var n;n=typeof g;if("number"==n)return isFinite(g)?g+"":"null";if("boolean"==
n)return g+"";if(null===g)return"null";if("string"==typeof g)return a(g);if("function"==n||"undefined"==n)return m;if("function"==typeof g.toJSON)return l(g.toJSON(c),d,c);if(g instanceof Date)return'"{FullYear}-{Month+}-{Date}T{Hours}:{Minutes}:{Seconds}Z"'.replace(/\{(\w+)(\+)?\}/g,function(a,c,d){a=g["getUTC"+c]()+(d?1:0);return 10>a?"0"+a:a});if(g.valueOf()!==g)return l(g.valueOf(),d,c);var f=e?d+e:"",t=e?" ":"",r=e?"\n":"";if(g instanceof Array){var t=g.length,v=[];for(c=0;c<t;c++)n=l(g[c],f,
c),"string"!=typeof n&&(n="null"),v.push(r+f+n);return"["+v.join(",")+r+d+"]"}v=[];for(c in g){var u;if(g.hasOwnProperty(c)){if("number"==typeof c)u='"'+c+'"';else if("string"==typeof c)u=a(c);else continue;n=l(g[c],f,c);"string"==typeof n&&v.push(r+f+u+":"+t+n)}}return"{"+v.join(",")+r+d+"}"}var m;"string"==typeof b&&(e=b,b=null);return l(f,"","")}}})},"dojo/_base/json":function(){define(["./kernel","../json"],function(h,k){h.fromJson=function(a){return eval("("+a+")")};h._escapeString=k.stringify;
h.toJsonIndentStr="\t";h.toJson=function(a,f){return k.stringify(a,function(a,e){if(e){var b=e.__json__||e.json;if("function"==typeof b)return b.call(e)}return e},f&&h.toJsonIndentStr)};return h})},"dojo/request/watch":function(){define("./util ../errors/RequestTimeoutError ../errors/CancelError ../_base/array ../_base/window ../has!host-browser?dom-addeventlistener?:../on:".split(" "),function(h,k,a,f,b,e){function l(){for(var a=+new Date,b=0,e;b<d.length&&(e=d[b]);b++){var f=e.response,l=f.options;
e.isCanceled&&e.isCanceled()||e.isValid&&!e.isValid(f)?(d.splice(b--,1),m._onAction&&m._onAction()):e.isReady&&e.isReady(f)?(d.splice(b--,1),e.handleResponse(f),m._onAction&&m._onAction()):e.startTime&&e.startTime+(l.timeout||0)<a&&(d.splice(b--,1),e.cancel(new k("Timeout exceeded",f)),m._onAction&&m._onAction())}m._onInFlight&&m._onInFlight(e);d.length||(clearInterval(g),g=null)}function m(a){a.response.options.timeout&&(a.startTime=+new Date);a.isFulfilled()||(d.push(a),g||(g=setInterval(l,50)),
a.response.options.sync&&l())}var g=null,d=[];m.cancelAll=function(){try{f.forEach(d,function(c){try{c.cancel(new a("All requests canceled."))}catch(n){}})}catch(c){}};b&&e&&b.doc.attachEvent&&e(b.global,"unload",function(){m.cancelAll()});return m})},"dojo/request/util":function(){define("exports ../errors/RequestError ../errors/CancelError ../Deferred ../io-query ../_base/array ../_base/lang ../promise/Promise".split(" "),function(h,k,a,f,b,e,l,m){function g(a){return c(a)}function d(a){return void 0!==
a.data?a.data:a.text}h.deepCopy=function(a,c){for(var d in c){var b=a[d],g=c[d];b!==g&&(b&&"object"===typeof b&&g&&"object"===typeof g?h.deepCopy(b,g):a[d]=g)}return a};h.deepCreate=function(a,c){c=c||{};var d=l.delegate(a),b,g;for(b in a)(g=a[b])&&"object"===typeof g&&(d[b]=h.deepCreate(g,c[b]));return h.deepCopy(d,c)};var c=Object.freeze||function(a){return a};h.deferred=function(b,e,t,r,v,u){var n=new f(function(c){e&&e(n,b);return c&&(c instanceof k||c instanceof a)?c:new a("Request canceled",
b)});n.response=b;n.isValid=t;n.isReady=r;n.handleResponse=v;t=n.then(g).otherwise(function(a){a.response=b;throw a;});h.notify&&t.then(l.hitch(h.notify,"emit","load"),l.hitch(h.notify,"emit","error"));r=t.then(d);v=new m;for(var q in r)r.hasOwnProperty(q)&&(v[q]=r[q]);v.response=t;c(v);u&&n.then(function(a){u.call(n,a)},function(a){u.call(n,b,a)});n.promise=v;n.then=v.then;return n};h.addCommonMethods=function(a,c){e.forEach(c||["GET","POST","PUT","DELETE"],function(c){a[("DELETE"===c?"DEL":c).toLowerCase()]=
function(d,b){b=l.delegate(b||{});b.method=c;return a(d,b)}})};h.parseArgs=function(a,c,d){var g=c.data,e=c.query;!g||d||"object"!==typeof g||g instanceof ArrayBuffer||g instanceof Blob||(c.data=b.objectToQuery(g));e?("object"===typeof e&&(e=b.objectToQuery(e)),c.preventCache&&(e+=(e?"\x26":"")+"request.preventCache\x3d"+ +new Date)):c.preventCache&&(e="request.preventCache\x3d"+ +new Date);a&&e&&(a+=(~a.indexOf("?")?"\x26":"?")+e);return{url:a,options:c,getHeader:function(a){return null}}};h.checkStatus=
function(a){a=a||0;return 200<=a&&300>a||304===a||1223===a||!a}})},"dojo/errors/RequestError":function(){define(["./create"],function(h){return h("RequestError",function(h,a){this.response=a})})},"dojo/errors/RequestTimeoutError":function(){define(["./create","./RequestError"],function(h,k){return h("RequestTimeoutError",null,k,{dojoType:"timeout"})})},"dojo/request/xhr":function(){define(["../errors/RequestError","./watch","./handlers","./util","../has"],function(h,k,a,f,b){function e(c,d){var b=
c.xhr;c.status=c.xhr.status;try{c.text=b.responseText}catch(y){}"xml"===c.options.handleAs&&(c.data=b.responseXML);if(!d)try{a(c)}catch(y){d=y}var g;if(d)this.reject(d);else{try{a(c)}catch(y){g=y}f.checkStatus(b.status)?g?this.reject(g):this.resolve(c):(d=g?new h("Unable to load "+c.url+" status: "+b.status+" and an error in handleAs: transformation of response",c):new h("Unable to load "+c.url+" status: "+b.status,c),this.reject(d))}}function l(a){return this.xhr.getResponseHeader(a)}function m(a,
u,w){var v=b("native-formdata")&&u&&u.data&&u.data instanceof FormData,y=f.parseArgs(a,f.deepCreate(r,u),v);a=y.url;u=y.options;var A,z=f.deferred(y,q,d,c,e,function(){A&&A()}),B=y.xhr=m._create();if(!B)return z.cancel(new h("XHR was not created")),w?z:z.promise;y.getHeader=l;n&&(A=n(B,z,y));var C="undefined"===typeof u.data?null:u.data,D=!u.sync,E=u.method;try{B.open(E,a,D,u.user||t,u.password||t);u.withCredentials&&(B.withCredentials=u.withCredentials);b("native-response-type")&&u.handleAs in g&&
(B.responseType=g[u.handleAs]);var F=u.headers;a=v?!1:"application/x-www-form-urlencoded";if(F)for(var G in F)"content-type"===G.toLowerCase()?a=F[G]:F[G]&&B.setRequestHeader(G,F[G]);a&&!1!==a&&B.setRequestHeader("Content-Type",a);F&&"X-Requested-With"in F||B.setRequestHeader("X-Requested-With","XMLHttpRequest");f.notify&&f.notify.emit("send",y,z.promise.cancel);B.send(C)}catch(I){z.reject(I)}k(z);B=null;return w?z:z.promise}b.add("native-xhr",function(){return"undefined"!==typeof XMLHttpRequest});
b.add("dojo-force-activex-xhr",function(){return b("activex")&&"file:"===window.location.protocol});b.add("native-xhr2",function(){if(b("native-xhr")&&!b("dojo-force-activex-xhr")){var a=new XMLHttpRequest;return"undefined"!==typeof a.addEventListener&&("undefined"===typeof opera||"undefined"!==typeof a.upload)}});b.add("native-formdata",function(){return"undefined"!==typeof FormData});b.add("native-response-type",function(){return b("native-xhr")&&"undefined"!==typeof(new XMLHttpRequest).responseType});
b.add("native-xhr2-blob",function(){if(b("native-response-type")){var a=new XMLHttpRequest;a.open("GET","/",!0);a.responseType="blob";var c=a.responseType;a.abort();return"blob"===c}});var g={blob:b("native-xhr2-blob")?"blob":"arraybuffer",document:"document",arraybuffer:"arraybuffer"},d,c,n,q;b("native-xhr2")?(d=function(a){return!this.isFulfilled()},q=function(a,c){c.xhr.abort()},n=function(a,c,d){function b(a){c.handleResponse(d)}function g(a){a=new h("Unable to load "+d.url+" status: "+a.target.status,
d);c.handleResponse(d,a)}function e(a){a.lengthComputable?(d.loaded=a.loaded,d.total=a.total,c.progress(d)):3===d.xhr.readyState&&(d.loaded="loaded"in a?a.loaded:a.position,c.progress(d))}a.addEventListener("load",b,!1);a.addEventListener("error",g,!1);a.addEventListener("progress",e,!1);return function(){a.removeEventListener("load",b,!1);a.removeEventListener("error",g,!1);a.removeEventListener("progress",e,!1);a=null}}):(d=function(a){return a.xhr.readyState},c=function(a){return 4===a.xhr.readyState},
q=function(a,c){var d=c.xhr,b=typeof d.abort;"function"!==b&&"object"!==b&&"unknown"!==b||d.abort()});var t,r={data:null,query:null,sync:!1,method:"GET"};m._create=function(){throw Error("XMLHTTP not available");};if(b("native-xhr")&&!b("dojo-force-activex-xhr"))m._create=function(){return new XMLHttpRequest};else if(b("activex"))try{new ActiveXObject("Msxml2.XMLHTTP"),m._create=function(){return new ActiveXObject("Msxml2.XMLHTTP")}}catch(v){try{new ActiveXObject("Microsoft.XMLHTTP"),m._create=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}catch(u){}}f.addCommonMethods(m);
return m})},"dojo/request/handlers":function(){define(["../json","../_base/kernel","../_base/array","../has","../selector/_loader"],function(h,k,a,f){function b(a){var c=d[a.options.handleAs];a.data=c?c(a):a.data||a.text;return a}f.add("activex","undefined"!==typeof ActiveXObject);f.add("dom-parser",function(a){return"DOMParser"in a});var e;if(f("activex")){var l=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML.DOMDocument"],m;e=function(c){function d(a){try{var c=
new ActiveXObject(a);c.async=!1;c.loadXML(g);b=c;m=a}catch(u){return!1}return!0}var b=c.data,g=c.text;b&&f("dom-qsa2.1")&&!b.querySelectorAll&&f("dom-parser")&&(b=(new DOMParser).parseFromString(g,"application/xml"));b&&b.documentElement||m&&d(m)||a.some(l,d);return b}}var g=function(a){return f("native-xhr2-blob")||"blob"!==a.options.handleAs||"undefined"===typeof Blob?a.xhr.response:new Blob([a.xhr.response],{type:a.xhr.getResponseHeader("Content-Type")})},d={javascript:function(a){return k.eval(a.text||
"")},json:function(a){return h.parse(a.text||null)},xml:e,blob:g,arraybuffer:g,document:g};b.register=function(a,b){d[a]=b};return b})},"dojo/i18n":function(){define("./_base/kernel require ./has ./_base/array ./_base/config ./_base/lang ./_base/xhr ./json module".split(" "),function(h,k,a,f,b,e,l,m,g){a.add("dojo-preload-i18n-Api",1);l=h.i18n={};var d=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,c=function(a,c,d,b){var g=[d+b];c=c.split("-");for(var e="",n=0;n<c.length;n++)if(e+=(e?"-":"")+c[n],!a||
a[e])g.push(d+e+"/"+b),g.specificity=e;return g},n={},q=function(a,c,d){d=d?d.toLowerCase():h.locale;a=a.replace(/\./g,"/");c=c.replace(/\./g,"/");return/root/i.test(d)?a+"/nls/"+c:a+"/nls/"+d+"/"+c},t=h.getL10nName=function(a,c,d){return a=g.id+"!"+q(a,c,d)},r=function(a,d,b,g,f,l){a([d],function(m){var r=e.clone(m.root||m.ROOT),u=c(!m._v1x&&m,f,b,g);a(u,function(){for(var a=1;a<u.length;a++)r=e.mixin(e.clone(r),arguments[a]);n[d+"/"+f]=r;r.$locale=u.specificity;l()})})},v=function(a){var c=b.extraLocale||
[],c=e.isArray(c)?c:[c];c.push(a);return c},u=function(c,b,g){var l=d.exec(c),u=l[1]+"/",q=l[5]||l[4],t=u+q,w=(l=l[5]&&l[4])||h.locale||"",k=t+"/"+w,l=l?[w]:v(w),C=l.length,B=function(){--C||g(e.delegate(n[k]))},w=c.split("*"),D="preload"==w[1];if(a("dojo-preload-i18n-Api")){if(D&&(n[c]||(n[c]=1,A(w[2],m.parse(w[3]),1,b)),g(1)),(w=D)||(x&&y.push([c,b,g]),w=x&&!n[k]),w)return}else if(D){g(1);return}f.forEach(l,function(c){var d=t+"/"+c;a("dojo-preload-i18n-Api")&&z(d);n[d]?B():r(b,t,u,q,c,B)})};a("dojo-preload-i18n-Api");
var w=l.normalizeLocale=function(a){a=a?a.toLowerCase():h.locale;return"root"==a?"ROOT":a},x=0,y=[],A=l._preloadLocalizations=function(a,c,d,b){function g(a,c){b([a],c)}function l(a,c){for(var d=a.split("-");d.length;){if(c(d.join("-")))return;d.pop()}c("ROOT")}function m(){for(--x;!x&&y.length;)u.apply(null,y.shift())}function r(d){d=w(d);l(d,function(r){if(0<=f.indexOf(c,r)){var u=a.replace(/\./g,"/")+"_"+r;x++;g(u,function(a){for(var c in a){var g=a[c],f=c.match(/(.+)\/([^\/]+)$/),u;if(f&&(u=f[2],
f=f[1]+"/",g._localized)){var q;if("ROOT"===r){var v=q=g._localized;delete g._localized;v.root=g;n[k.toAbsMid(c)]=v}else q=g._localized,n[k.toAbsMid(f+u+"/"+r)]=g;r!==d&&function(a,c,g,f){var r=[],u=[];l(d,function(d){f[d]&&(r.push(k.toAbsMid(a+d+"/"+c)),u.push(k.toAbsMid(a+c+"/"+d)))});r.length?(x++,b(r,function(){for(var b=r.length-1;0<=b;b--)g=e.mixin(e.clone(g),arguments[b]),n[u[b]]=g;n[k.toAbsMid(a+c+"/"+d)]=e.clone(g);m()})):n[k.toAbsMid(a+c+"/"+d)]=g}(f,u,g,q)}}m()});return!0}return!1})}b=
b||k;r();f.forEach(h.config.extraLocale,r)},z=function(){},z=function(a){for(var c,d=a.split("/"),b=h.global[d[0]],g=1;b&&g<d.length-1;b=b[d[g++]]);b&&((c=b[d[g]])||(c=b[d[g].replace(/-/g,"_")]),c&&(n[a]=c));return c};l.getLocalization=function(a,c,d){var b;a=q(a,c,d);u(a,k,function(a){b=a});return b};return e.mixin(l,{dynamic:!0,normalize:function(a,c){return/^\./.test(a)?c(a):a},load:u,cache:n,getL10nName:t})})},"dijit/nls/loading":function(){define({root:{loadingState:"Loading...",errorState:"Sorry, an error occurred"},
bs:!0,mk:!0,sr:!0,zh:!0,"zh-tw":!0,vi:!0,uk:!0,tr:!0,th:!0,sv:!0,sl:!0,sk:!0,ru:!0,ro:!0,pt:!0,"pt-pt":!0,pl:!0,nl:!0,nb:!0,lv:!0,lt:!0,ko:!0,kk:!0,ja:!0,it:!0,id:!0,hu:!0,hr:!0,hi:!0,he:!0,fr:!0,fi:!0,eu:!0,et:!0,es:!0,el:!0,de:!0,da:!0,cs:!0,ca:!0,bg:!0,az:!0,ar:!0})},"esri/dijit/PopupMobile":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style ../InfoWindowBase ../PopupBase ./InfoView ./NavigationBar ../kernel ../domUtils dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z){h=k([v,u],{declaredClass:"esri.dijit.PopupMobile",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:10,marginTop:10,highlight:!0,popupNavigationBar:null,popupInfoView:null,location:null,xIcon:h.toUrl("./images/whitex.png"),dArrowIcon:h.toUrl("./images/whitedown.png"),lArrowIcon:h.toUrl("./images/whitel.png"),rArrowIcon:h.toUrl("./images/whiter.png"),constructor:function(b,g){this.initialize();a.mixin(this,b);this.domNode=d.byId(g);this._nls=a.mixin({},
z.widgets.popup);var e=this.domNode;n.add(e,"esriPopupMobile");c.set(e,"innerHTML","\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv style\x3d'text-align:center'\x3e\x3cdiv class\x3d'titleButton prev hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'footer' style\x3d'display:inline-block;width:60px;height:15px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton arrow hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer top hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer bottom hidden'\x3e\x3c/div\x3e");
var m=l.query(".titlePane",e)[0];this._arrowButton=l.query(".arrow",m)[0];this._pointerTop=l.query(".top",e)[0];this._pointerBottom=l.query(".bottom",e)[0];this._title=l.query(".title",m)[0];this._footer=l.query(".footer",m)[0];this._prev=l.query(".prev",m)[0];this._next=l.query(".next",m)[0];this._spinner=l.query(".spinner",m)[0];this._eventConnections=[f.connect(l.query(".close",m)[0],"onclick",this,this.hide),f.connect(this._arrowButton,"onclick",this,this._toggleView),f.connect(this._prev,"onclick",
this,function(){this.selectPrevious();this._updateUI()}),f.connect(this._next,"onclick",this,function(){this.selectNext();this._updateUI()})];this._initPopupNavigationBar();this._initPopupInfoView();A.hide(e);this.isShowing=!1},setMap:function(a){this.inherited(arguments);q.place(this.domNode,a.root);this.highlight&&this.enableHighlight(a)},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(a,c){this.destroyDijits(this._title);this.place(a,this._title);
this.destroyDijits(this._footer);this.place(c,this._footer);this.isShowing&&(this.startupDijits(this._title),this.startupDijits(this._footer))},setContent:function(a){this.destroyDijits(this._contentPane);this.place(a,this._contentPane);this.startupDijits(this._contentPane)},show:function(a){if(!a)return A.show(this.domNode),void(this.isShowing=!0);var c,d=this.map;a.spatialReference?(this.location=a,c=d.toScreen(a)):(this.location=d.toMap(a),c=a);this._maximized?this.restore():this._setPosition(c);
this.isShowing||(A.show(this.domNode),this.isShowing=!0,this.onShow())},hide:function(){this.isShowing&&(A.hide(this.domNode),this.isShowing=!1,this.onHide())},onShow:function(){this._followMap();this.startupDijits(this._title);this.showHighlight()},onHide:function(){this._unfollowMap();this.hideHighlight()},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);this.destroyDijits(this._footer);b.forEach(this._eventConnections,f.disconnect);
q.destroy(this.domNode)},selectNext:function(){this.select(this.selectedIndex+1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(){this.inherited(arguments);this._updateUI()},onSetFeatures:function(){},onClearFeatures:function(){this.setTitle("\x26nbsp;","\x26nbsp;");n.add(this._arrowButton,"hidden");this._updateUI();this.hideHighlight()},onSelectionChange:function(){var a=this.selectedIndex;this._updateUI();0<=a&&(this.setContent(this.features[a].getContent()),
this.updateHighlight(this.map,this.features[a]),this.isShowing&&this.showHighlight())},onDfdComplete:function(){this._updateUI()},_followMap:function(){this._unfollowMap();var a=this.map;this._handles=[f.connect(a,"onPanStart",this,this._onPanStart),f.connect(a,"onPan",this,this._onPan),f.connect(a,"onZoomStart",this,this._onZoomStart),f.connect(a,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var a=this._handles;a&&(b.forEach(a,f.disconnect),this._handles=null)},_onPanStart:function(){var a=
this.domNode.style;this._panOrigin={left:a.left,top:a.top,right:a.right,bottom:a.bottom}},_onPan:function(a,c){var d=this._panOrigin,b=c.x,g=c.y,e=d.left,n=d.top,f=d.right,d=d.bottom;e&&(e=parseFloat(e)+b+"px");n&&(n=parseFloat(n)+g+"px");f&&(f=parseFloat(f)-b+"px");d&&(d=parseFloat(d)-g+"px");r.set(this.domNode,{left:e,top:n,right:f,bottom:d})},_onZoomStart:function(){A.hide(this.domNode)},_onExtentChange:function(a,c,d){d&&(A.show(this.domNode),this.show(this._targetLocation||this.location),this._targetLocation=
null)},_setPosition:function(a){var c=a.x;a=a.y;var d=t.getContentBox(this.map.container),b=d.w,d=d.h,g=0,e=a+10,f=118,l=b-18;18<c&&l>c?(g=c-130,0>g?g=0:g>b-260&&(g=b-260)):18>=c?g=c-18:c>=l&&(g=b-260+(c-l));118<c&&b-130>c?f=118:118>=c?18<c?f=c-12:18>=c&&(f=6):c>=b-130&&(l>c?f=118+c-(b-130):c>=l&&(f=118+l-(b-130)));d/2>=a?(r.set(this.domNode,{left:g+"px",top:e+"px",bottom:null}),r.set(this._pointerTop,{left:f+"px"}),n.add(this._pointerBottom,"hidden"),n.remove(this._pointerTop,"hidden")):(r.set(this.domNode,
{left:g+"px",top:e-64+"px",bottom:null}),r.set(this._pointerBottom,{left:f+"px"}),n.add(this._pointerTop,"hidden"),n.remove(this._pointerBottom,"hidden"))},_showPointer:function(a){b.forEach(["topLeft","topRight","bottomRight","bottomLeft"],function(c){c===a?l.query(".pointer."+c,this.domNode).removeClass("hidden"):l.query(".pointer."+c,this.domNode).addClass("hidden")},this)},_toggleView:function(){this.popupNavigationBar||this._initPopupNavigationBar();this.popupInfoView||this._initPopupInfoView();
this.hide();A.show(this.popupNavigationBar.container);A.show(this.popupInfoView.container);0<=this.selectedIndex&&this.setContent(this.features[this.selectedIndex].getContent())},_handleNavigationBar:function(a){switch(this.popupInfoView.animateTo(0),a.name){case "CloseButton":A.hide(this.popupNavigationBar.container);A.hide(this.popupInfoView.container);this.hide();break;case "ToggleButton":A.hide(this.popupNavigationBar.container);A.hide(this.popupInfoView.container);this.show(this.location);break;
case "PreviousButton":this.selectPrevious();this._updateUI();break;case "NextButton":this.selectNext(),this._updateUI()}},_initPopupNavigationBar:function(){var a={};a.items=[{name:"CloseButton",type:"img",src:this.xIcon,srcAlt:this.xIcon,position:"left"},{name:"Title",type:"span",text:"",position:"center"},{name:"ToggleButton",type:"img",src:this.dArrowIcon,srcAlt:this.dArrowIcon,position:"right",toggleGroup:"toggle"},{name:"PreviousButton",type:"img",src:this.lArrowIcon,srcAlt:this.lArrowIcon,position:"right2",
toggleGroup:"previous"},{name:"NextButton",type:"img",src:this.rArrowIcon,srcAlt:this.rArrowIcon,position:"right1",toggleGroup:"next"}];this.popupNavigationBar=new x(a,q.create("div",{},e.body()));f.connect(this.popupNavigationBar,"onCreate",this,function(a){this._prevFeatureButton=a[3]._node;this._nextFeatureButton=a[4]._node});f.connect(this.popupNavigationBar,"onSelect",this,this._handleNavigationBar);f.connect(this.popupNavigationBar,"onUnSelect",this,this._handleNavigationBar);this.popupNavigationBar.startup();
A.hide(this.popupNavigationBar.container)},_initPopupInfoView:function(){this.popupInfoView=new w({items:[{name:"Navigator",type:"div",text:""},{name:"content",type:"div",text:""},{name:"attachment",type:"div",text:""}]},q.create("div",{},e.body()));n.add(this.popupInfoView.container,"esriMobilePopupInfoView");this.popupInfoView.enableTouchScroll();f.connect(this.popupInfoView,"onCreate",this,function(a){this._contentPane=a[1]._node;0<=this.selectedIndex&&this.setContent(this.features[this.selectedIndex].getContent())});
f.connect(this.popupInfoView,"onSwipeLeft",this,function(){});f.connect(this.popupInfoView,"onSwipeRight",this,function(){});this.popupInfoView.startup()},_updateUI:function(){var a="\x26nbsp;",c="\x26nbsp;",d=this.selectedIndex,b=this.features,g=this.deferreds,e=this._prevFeatureButton.parentNode,f=this._nextFeatureButton.parentNode,l=this._spinner,m=this._nls;b&&1<=b.length?(a=b[d].getTitle(),c=d+1+" of "+b.length,n.remove(this._arrowButton,"hidden"),0===d?(n.add(e,"hidden"),n.add(this._prev,"hidden")):
(n.remove(e,"hidden"),n.remove(this._prev,"hidden")),d===b.length-1?(n.add(f,"hidden"),n.add(this._next,"hidden")):(n.remove(f,"hidden"),n.remove(this._next,"hidden"))):(n.add(this._arrowButton,"hidden"),n.add(e,"hidden"),n.add(f,"hidden"),n.add(this._prev,"hidden"),n.add(this._next,"hidden"));this.setTitle(a,c);this.popupNavigationBar.getItems()[1]._node.innerHTML=c;g&&g.length?(n.remove(l,"hidden"),this.setTitle(m.NLS_searching+"...","\x26nbsp;")):(n.add(l,"hidden"),b&&b.length||this.setTitle("No Information",
"\x26nbsp;"))}});return m("extend-esri")&&a.setObject("dijit.PopupMobile",h,y),h})},"esri/InfoWindowBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/dom-construct dojo/has dijit/registry ./kernel ./lang ./geometry/ScreenPoint".split(" "),function(h,k,a,f,b,e,l,m,g,d,c){h=h(null,{declaredClass:"esri.InfoWindowBase",constructor:function(){var a=k.hitch;this.__set_title=a(this,this.__set_title);this.__err_title=a(this,this.__err_title);
this.__set_content=a(this,this.__set_content);this.__err_content=a(this,this.__err_content)},setMap:function(a){this.map=a},unsetMap:function(a){delete this.map},setTitle:function(){},setContent:function(){},show:function(){},hide:function(){},resize:function(){},onShow:function(){},onHide:function(){},place:function(a,c){d.isDefined(a)?k.isObject(a)?e.place(a,c,"only"):c.innerHTML=a:c.innerHTML=""},startupDijits:function(a){this._processDijits(a)},destroyDijits:function(a){this._processDijits(a,
!0)},_processDijits:function(c,d){if(c&&1===c.children.length){var b=c.children[0];if(b){var g=m.byNode(b),b=g?[g]:m.findWidgets(b);a.forEach(b,function(a){if(d){if(a._started&&!a._destroyed)try{a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy()}catch(u){}}else if(!a._started)try{a.startup()}catch(u){}})}}},__registerMapListeners:function(){this.__unregisterMapListeners();var a=this.map;this.__handles=[f.connect(a,"onPan",this,this.__onMapPan),f.connect(a,"onZoomStart",this,this.__onMapZmStart),
f.connect(a,"onExtentChange",this,this.__onMapExtChg)]},__unregisterMapListeners:function(){var c=this.__handles;c&&(a.forEach(c,f.disconnect,f),this.__handles=null)},__onMapPan:function(a,c){this.move(c,!0)},__onMapZmStart:function(){this.__mcoords=this.mapCoords||this.map.toMap(new c(this.coords));this.hide(null,!0)},__onMapExtChg:function(a,c,d){a=this.map;var b=this.mapCoords;b?this.show(b,null,!0):(c=d?a.toScreen(this.__mcoords):this.coords.offset(c&&c.x||0,c&&c.y||0),this.show(c,null,!0))},
__setValue:function(a,c){this[a].innerHTML="";var g="_dfd"+a,e=this[g];e&&-1===e.fired&&(e.cancel(),this[g]=null);d.isDefined(c)&&(c instanceof b?(this[g]=c,c.addCallbacks(this["__set"+a],this["__err"+a])):this.__render(a,c))},__set_title:function(a){this._dfd_title=null;this.__render("_title",a)},__err_title:function(a){this._dfd_title=null},__set_content:function(a){this._dfd_content=null;this.__render("_content",a)},__err_content:function(a){this._dfd_content=null},__render:function(a,c){var d=
this[a];this.place(c,d);this.isShowing&&(this.startupDijits(d),"_title"===a&&this._adjustContentArea&&this._adjustContentArea())}});return l("extend-esri")&&(g.InfoWindowBase=h),h})},"esri/kernel":function(){define(["dojo/_base/kernel","dojo/_base/config","dojo/has"],function(h,k,a){var f=function(){return this}(),b=f.location,e=b.pathname,l=b.protocol,b={version:"3.20",_appBaseUrl:l+"//"+b.host+e.substring(0,e.lastIndexOf(e.split("/")[e.split("/").length-1]))};k.noGlobals||(f.esri=b);h.isAsync||
a.add("extend-esri",1);return(b.dijit=b.dijit||{})._arcgisUrl=("http:"===l||"https:"===l?l:"http:")+"//www.arcgis.com/sharing/rest",b})},"esri/lang":function(){define("dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date dojo/has dojo/number dojo/date/locale ./kernel".split(" "),function(h,k,a,f,b,e,l,m,g){function d(c,d,b){return[f.isString(c)?c.split(""):c,d||a.global,f.isString(b)?new Function("item","index","array",b):b]}function c(a){return void 0!==a&&null!==a}function n(a){return c(a)?
a:""}function q(a,d,g){var e,u=g.match(/([^\(]+)(\([^\)]+\))?/i),q=f.trim(u[1]);g=d[a];var u=k.fromJson((u[2]?f.trim(u[2]):"()").replace(/^\(/,"({").replace(/\)$/,"})")),v=u.utcOffset;if(-1===h.indexOf(r,q))e=f.getObject(q),f.isFunction(e)&&(g=e(g,a,d,u));else if("number"==typeof g||"string"==typeof g&&g&&!isNaN(Number(g)))switch(g=Number(g),q){case "NumberFormat":return l.format(g,u);case "DateString":return e=new Date(g),u.local||u.systemLocale?u.systemLocale?e.toLocaleDateString()+(u.hideTime?
"":" "+e.toLocaleTimeString()):e.toDateString()+(u.hideTime?"":" "+e.toTimeString()):(e=e.toUTCString(),u.hideTime&&(e=e.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,"")),e);case "DateFormat":return e=new Date(g),c(v)&&(e=b.add(e,"minute",e.getTimezoneOffset()-v)),m.format(e,u)}return n(g)}function t(a,c){var d;if(c)for(d in a)a.hasOwnProperty(d)&&(void 0===a[d]?delete a[d]:a[d]instanceof Object&&t(a[d],!0));else for(d in a)a.hasOwnProperty(d)&&void 0===a[d]&&delete a[d];return a}var r=["NumberFormat",
"DateString","DateFormat"],v=/<\/?[^>]+>/g,u={valueOf:function(a,c){for(var d in a)if(a[d]==c)return d;return null},stripTags:function(a){if(a){var c=typeof a;if("string"===c)a=a.replace(v,"");else if("object"===c)for(var d in a)(c=a[d])&&"string"==typeof c&&(c=c.replace(v,"")),a[d]=c}return a},substitute:function(a,d,b){var g,e,l;if(c(b)&&(f.isObject(b)?(g=b.first,e=b.dateFormat,l=b.numberFormat):g=b),d&&"${*}"!==d)return f.replace(d,f.hitch({obj:a},function(a,c){var d=c.split(":");return 1<d.length?
(c=d[0],d.shift(),q(c,this.obj,d.join(":"))):e&&-1!==h.indexOf(e.properties||"",c)?q(c,this.obj,e.formatter||"DateString"):l&&-1!==h.indexOf(l.properties||"",c)?q(c,this.obj,l.formatter||"NumberFormat"):n(this.obj[c])}),/\$\{([^\}]+)\}/g);var m,u;d=[];for(u in a)if(m=a[u],e&&-1!==h.indexOf(e.properties||"",u)?m=q(u,a,e.formatter||"DateString"):l&&-1!==h.indexOf(l.properties||"",u)&&(m=q(u,a,l.formatter||"NumberFormat")),d.push(u+" \x3d "+n(m)+"\x3cbr/\x3e"),g)break;return d.join("")},filter:function(a,
c,b){var g;c=d(a,b,c);b={};a=c[0];for(g in a)c[2].call(c[g],a[g],g,a)&&(b[g]=a[g]);return b},startsWith:function(a,c,d){return d=d||0,a.indexOf(c,d)===d},endsWith:function(a,c,d){("number"!=typeof d||!isFinite(d)||Math.floor(d)!==d||d>a.length)&&(d=a.length);d-=c.length;a=a.indexOf(c,d);return-1!==a&&a===d},isDefined:c,fixJson:t};return e("extend-esri")&&(f.mixin(g,u),g._isDefined=c,g._getParts=d,g._sanitize=t),u})},"dojo/date":function(){define(["./has","./_base/lang"],function(h,k){var a={getDaysInMonth:function(f){var b=
f.getMonth();return 1==b&&a.isLeapYear(f)?29:[31,28,31,30,31,30,31,31,30,31,30,31][b]},isLeapYear:function(a){a=a.getFullYear();return!(a%400)||!(a%4)&&!!(a%100)},getTimezoneName:function(a){var b=a.toString(),e="",f=b.indexOf("(");if(-1<f)e=b.substring(++f,b.indexOf(")"));else if(f=/([A-Z\/]+) \d{4}$/,b=b.match(f))e=b[1];else if(b=a.toLocaleString(),f=/ ([A-Z\/]+)$/,b=b.match(f))e=b[1];return"AM"==e||"PM"==e?"":e},compare:function(a,b,e){a=new Date(+a);b=new Date(+(b||new Date));"date"==e?(a.setHours(0,
0,0,0),b.setHours(0,0,0,0)):"time"==e&&(a.setFullYear(0,0,0),b.setFullYear(0,0,0));return a>b?1:a<b?-1:0},add:function(a,b,e){var f=new Date(+a),m=!1,g="Date";switch(b){case "day":break;case "weekday":var d;(b=e%5)?d=parseInt(e/5):(b=0<e?5:-5,d=0<e?(e-5)/5:(e+5)/5);var c=a.getDay(),n=0;6==c&&0<e?n=1:0==c&&0>e&&(n=-1);c+=b;if(0==c||6==c)n=0<e?2:-2;e=7*d+b+n;break;case "year":g="FullYear";m=!0;break;case "week":e*=7;break;case "quarter":e*=3;case "month":m=!0;g="Month";break;default:g="UTC"+b.charAt(0).toUpperCase()+
b.substring(1)+"s"}if(g)f["set"+g](f["get"+g]()+e);m&&f.getDate()<a.getDate()&&f.setDate(0);return f},difference:function(f,b,e){b=b||new Date;e=e||"day";var l=b.getFullYear()-f.getFullYear(),m=1;switch(e){case "quarter":f=f.getMonth();b=b.getMonth();m=Math.floor(b/3)+1+4*l-(Math.floor(f/3)+1);break;case "weekday":l=Math.round(a.difference(f,b,"day"));e=parseInt(a.difference(f,b,"week"));if(0==l%7)l=5*e;else{var m=0,g=f.getDay(),d=b.getDay();e=parseInt(l/7);b=l%7;f=new Date(f);f.setDate(f.getDate()+
7*e);f=f.getDay();if(0<l)switch(!0){case 6==g:m=-1;break;case 0==g:m=0;break;case 6==d:m=-1;break;case 0==d:m=-2;break;case 5<f+b:m=-2}else if(0>l)switch(!0){case 6==g:m=0;break;case 0==g:m=1;break;case 6==d:m=2;break;case 0==d:m=1;break;case 0>f+b:m=2}l=l+m-2*e}m=l;break;case "year":m=l;break;case "month":m=b.getMonth()-f.getMonth()+12*l;break;case "week":m=parseInt(a.difference(f,b,"day")/7);break;case "day":m/=24;case "hour":m/=60;case "minute":m/=60;case "second":m/=1E3;case "millisecond":m*=
b.getTime()-f.getTime()}return Math.round(m)}};k.mixin(k.getObject("dojo.date",!0),a);return a})},"dojo/number":function(){define(["./_base/lang","./i18n","./i18n!./cldr/nls/number","./string","./regexp"],function(h,k,a,f,b){var e={};h.setObject("dojo.number",e);e.format=function(a,b){b=h.mixin({},b||{});var d=k.normalizeLocale(b.locale),d=k.getLocalization("dojo.cldr","number",d);b.customs=d;d=b.pattern||d[(b.type||"decimal")+"Format"];return isNaN(a)||Infinity==Math.abs(a)?null:e._applyPattern(a,
d,b)};e._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;e._applyPattern=function(a,b,d){d=d||{};var c=d.customs.group,g=d.customs.decimal;b=b.split(";");var f=b[0];b=b[0>a?1:0]||"-"+f;if(-1!=b.indexOf("%"))a*=100;else if(-1!=b.indexOf("\u2030"))a*=1E3;else if(-1!=b.indexOf("\u00a4"))c=d.customs.currencyGroup||c,g=d.customs.currencyDecimal||g,b=b.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/,function(a,c,b,g){return(a=d[["symbol","currency","displayName"][b.length-1]]||d.currency||"")?c+a+g:""});else if(-1!=
b.indexOf("E"))throw Error("exponential notation not supported");var l=e._numberPatternRE,f=f.match(l);if(!f)throw Error("unable to find a number expression in pattern: "+b);!1===d.fractional&&(d.places=0);return b.replace(l,e._formatAbsolute(a,f[0],{decimal:g,group:c,places:d.places,round:d.round}))};e.round=function(a,b,d){d=10/(d||10);return(d*+a).toFixed(b)/d};if(0==(.9).toFixed()){var l=e.round;e.round=function(a,b,d){var c=Math.pow(10,-b||0),g=Math.abs(a);if(!a||g>=c)c=0;else if(g/=c,.5>g||
.95<=g)c=0;return l(a,b,d)+(0<a?c:-c)}}e._formatAbsolute=function(a,b,d){d=d||{};!0===d.places&&(d.places=0);Infinity===d.places&&(d.places=6);b=b.split(".");var c="string"==typeof d.places&&d.places.indexOf(","),g=d.places;c?g=d.places.substring(c+1):0<=g||(g=(b[1]||[]).length);0>d.round||(a=e.round(a,g,d.round));a=String(Math.abs(a)).split(".");var l=a[1]||"";b[1]||d.places?(c&&(d.places=d.places.substring(0,c)),c=void 0!==d.places?d.places:b[1]&&b[1].lastIndexOf("0")+1,c>l.length&&(a[1]=f.pad(l,
c,"0",!0)),g<l.length&&(a[1]=l.substr(0,g))):a[1]&&a.pop();g=b[0].replace(",","");c=g.indexOf("0");-1!=c&&(c=g.length-c,c>a[0].length&&(a[0]=f.pad(a[0],c)),-1==g.indexOf("#")&&(a[0]=a[0].substr(a[0].length-c)));var g=b[0].lastIndexOf(","),m,r;-1!=g&&(m=b[0].length-g-1,b=b[0].substr(0,g),g=b.lastIndexOf(","),-1!=g&&(r=b.length-g-1));b=[];for(g=a[0];g;)c=g.length-m,b.push(0<c?g.substr(c):g),g=0<c?g.slice(0,c):"",r&&(m=r,r=void 0);a[0]=b.reverse().join(d.group||",");return a.join(d.decimal||".")};e.regexp=
function(a){return e._parseInfo(a).regexp};e._parseInfo=function(a){a=a||{};var g=k.normalizeLocale(a.locale),g=k.getLocalization("dojo.cldr","number",g),d=a.pattern||g[(a.type||"decimal")+"Format"],c=g.group,f=g.decimal,l=1;if(-1!=d.indexOf("%"))l/=100;else if(-1!=d.indexOf("\u2030"))l/=1E3;else{var m=-1!=d.indexOf("\u00a4");m&&(c=g.currencyGroup||c,f=g.currencyDecimal||f)}g=d.split(";");1==g.length&&g.push("-"+g[0]);g=b.buildGroupRE(g,function(d){d="(?:"+b.escapeString(d,".")+")";return d.replace(e._numberPatternRE,
function(d){var b={signed:!1,separator:a.strict?c:[c,""],fractional:a.fractional,decimal:f,exponent:!1};d=d.split(".");var g=a.places;1==d.length&&1!=l&&(d[1]="###");1==d.length||0===g?b.fractional=!1:(void 0===g&&(g=a.pattern?d[1].lastIndexOf("0")+1:Infinity),g&&void 0==a.fractional&&(b.fractional=!0),!a.places&&g<d[1].length&&(g+=","+d[1].length),b.places=g);d=d[0].split(",");1<d.length&&(b.groupSize=d.pop().length,1<d.length&&(b.groupSize2=d.pop().length));return"("+e._realNumberRegexp(b)+")"})},
!0);m&&(g=g.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(c,d,g,e){c=b.escapeString(a[["symbol","currency","displayName"][g.length-1]]||a.currency||"");if(!c)return"";d=d?"[\\s\\xa0]":"";e=e?"[\\s\\xa0]":"";return a.strict?d+c+e:(d&&(d+="*"),e&&(e+="*"),"(?:"+d+c+e+")?")}));return{regexp:g.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:c,decimal:f,factor:l}};e.parse=function(a,b){var d=e._parseInfo(b),c=(new RegExp("^"+d.regexp+"$")).exec(a);if(!c)return NaN;var g=c[1];if(!c[1]){if(!c[2])return NaN;
g=c[2];d.factor*=-1}g=g.replace(new RegExp("["+d.group+"\\s\\xa0]","g"),"").replace(d.decimal,".");return g*d.factor};e._realNumberRegexp=function(a){a=a||{};"places"in a||(a.places=Infinity);"string"!=typeof a.decimal&&(a.decimal=".");"fractional"in a&&!/^0/.test(a.places)||(a.fractional=[!0,!1]);"exponent"in a||(a.exponent=[!0,!1]);"eSigned"in a||(a.eSigned=[!0,!1]);var g=e._integerRegexp(a),d=b.buildGroupRE(a.fractional,function(c){var d="";c&&0!==a.places&&(d="\\"+a.decimal,d=Infinity==a.places?
"(?:"+d+"\\d+)?":d+("\\d{"+a.places+"}"));return d},!0),c=b.buildGroupRE(a.exponent,function(c){return c?"([eE]"+e._integerRegexp({signed:a.eSigned})+")":""}),g=g+d;d&&(g="(?:(?:"+g+")|(?:"+d+"))");return g+c};e._integerRegexp=function(a){a=a||{};"signed"in a||(a.signed=[!0,!1]);"separator"in a?"groupSize"in a||(a.groupSize=3):a.separator="";var g=b.buildGroupRE(a.signed,function(a){return a?"[-+]":""},!0),d=b.buildGroupRE(a.separator,function(c){if(!c)return"(?:\\d+)";c=b.escapeString(c);" "==c?
c="\\s":"\u00a0"==c&&(c="\\s\\xa0");var d=a.groupSize,g=a.groupSize2;return g?(c="(?:0|[1-9]\\d{0,"+(g-1)+"}(?:["+c+"]\\d{"+g+"})*["+c+"]\\d{"+d+"})",0<d-g?"(?:"+c+"|(?:0|[1-9]\\d{0,"+(d-1)+"}))":c):"(?:0|[1-9]\\d{0,"+(d-1)+"}(?:["+c+"]\\d{"+d+"})*)"},!0);return g+d};return e})},"dojo/cldr/nls/number":function(){define({root:{scientificFormat:"#E0","currencySpacing-afterCurrency-currencyMatch":"[:^S:]",infinity:"\u221e",superscriptingExponent:"\u00d7",list:";",percentSign:"%",minusSign:"-","currencySpacing-beforeCurrency-surroundingMatch":"[:digit:]",
"decimalFormat-short":"000T","currencySpacing-afterCurrency-insertBetween":"\u00a0",nan:"NaN",plusSign:"+","currencySpacing-afterCurrency-surroundingMatch":"[:digit:]","currencySpacing-beforeCurrency-currencyMatch":"[:^S:]",currencyFormat:"\u00a4\u00a0#,##0.00",perMille:"\u2030",group:",",percentFormat:"#,##0%","decimalFormat-long":"000T",decimalFormat:"#,##0.###",decimal:".","currencySpacing-beforeCurrency-insertBetween":"\u00a0",exponential:"E"},ar:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,"en-au":!0,
es:!0,et:!0,fi:!0,fr:!0,"fr-ch":!0,he:!0,hi:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,mk:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,pt:!0,"pt-pt":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,vi:!0,zh:!0,"zh-hant":!0,"zh-hk":!0,"zh-tw":!0})},"dojo/cldr/nls/en/number":function(){define({group:",",percentSign:"%",exponential:"E",scientificFormat:"#E0",percentFormat:"#,##0%",list:";",infinity:"\u221e",minusSign:"-",decimal:".",superscriptingExponent:"\u00d7",nan:"NaN",perMille:"\u2030",decimalFormat:"#,##0.###",
currencyFormat:"\u00a4#,##0.00;(\u00a4#,##0.00)",plusSign:"+","decimalFormat-long":"000 trillion","decimalFormat-short":"000T"})},"dojo/date/locale":function(){define("../_base/lang ../_base/array ../date ../cldr/supplemental ../i18n ../regexp ../string ../i18n!../cldr/nls/gregorian module".split(" "),function(h,k,a,f,b,e,l,m,g){function d(a,c,d,b){return b.replace(/([a-z])\1*/ig,function(g){var e,n,m=g.charAt(0);g=g.length;var r=["abbr","wide","narrow"];switch(m){case "G":e=c[4>g?"eraAbbr":"eraNames"][0>
a.getFullYear()?0:1];break;case "y":e=a.getFullYear();switch(g){case 1:break;case 2:if(!d.fullYear){e=String(e);e=e.substr(e.length-2);break}default:n=!0}break;case "Q":case "q":e=Math.ceil((a.getMonth()+1)/3);n=!0;break;case "M":case "L":e=a.getMonth();3>g?(e+=1,n=!0):(m=["months","L"==m?"standAlone":"format",r[g-3]].join("-"),e=c[m][e]);break;case "w":e=q._getWeekOfYear(a,0);n=!0;break;case "d":e=a.getDate();n=!0;break;case "D":e=q._getDayOfYear(a);n=!0;break;case "e":case "c":if(e=a.getDay(),2>
g){e=(e-f.getFirstDayOfWeek(d.locale)+8)%7;break}case "E":e=a.getDay();3>g?(e+=1,n=!0):(m=["days","c"==m?"standAlone":"format",r[g-3]].join("-"),e=c[m][e]);break;case "a":m=12>a.getHours()?"am":"pm";e=d[m]||c["dayPeriods-format-wide-"+m];break;case "h":case "H":case "K":case "k":n=a.getHours();switch(m){case "h":e=n%12||12;break;case "H":e=n;break;case "K":e=n%12;break;case "k":e=n||24}n=!0;break;case "m":e=a.getMinutes();n=!0;break;case "s":e=a.getSeconds();n=!0;break;case "S":e=Math.round(a.getMilliseconds()*
Math.pow(10,g-3));n=!0;break;case "v":case "z":if(e=q._getZone(a,!0,d))break;g=4;case "Z":m=q._getZone(a,!1,d);m=[0>=m?"+":"-",l.pad(Math.floor(Math.abs(m)/60),2),l.pad(Math.abs(m)%60,2)];4==g&&(m.splice(0,0,"GMT"),m.splice(3,0,":"));e=m.join("");break;default:throw Error("dojo.date.locale.format: invalid pattern char: "+b);}n&&(e=l.pad(e,g));return e})}function c(a,c,d,b){var g=function(a){return a};c=c||g;d=d||g;b=b||g;var e=a.match(/(''|[^'])+/g),f="'"==a.charAt(0);k.forEach(e,function(a,b){a?
(e[b]=(f?d:c)(a.replace(/''/g,"'")),f=!f):e[b]=""});return b(e.join(""))}function n(a,c,d,b){b=e.escapeString(b);d.strict||(b=b.replace(" a"," ?a"));return b.replace(/([a-z])\1*/ig,function(b){var g;g=b.charAt(0);var e=b.length,f="",n="";d.strict?(1<e&&(f="0{"+(e-1)+"}"),2<e&&(n="0{"+(e-2)+"}")):(f="0?",n="0{0,2}");switch(g){case "y":g="\\d{2,4}";break;case "M":case "L":2<e?(g=c["months-"+("L"==g?"standAlone":"format")+"-"+t[e-3]].slice(0).join("|"),d.strict||(g=g.replace(/\./g,""),g="(?:"+g+")\\.?")):
g="1[0-2]|"+f+"[1-9]";break;case "D":g="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+f+"[1-9][0-9]|"+n+"[1-9]";break;case "d":g="3[01]|[12]\\d|"+f+"[1-9]";break;case "w":g="[1-4][0-9]|5[0-3]|"+f+"[1-9]";break;case "E":case "e":case "c":g=".+?";break;case "h":g="1[0-2]|"+f+"[1-9]";break;case "k":g="1[01]|"+f+"\\d";break;case "H":g="1\\d|2[0-3]|"+f+"\\d";break;case "K":g="1\\d|2[0-4]|"+f+"[1-9]";break;case "m":case "s":g="[0-5]\\d";break;case "S":g="\\d{"+e+"}";break;case "a":e=d.am||c["dayPeriods-format-wide-am"];
f=d.pm||c["dayPeriods-format-wide-pm"];g=e+"|"+f;d.strict||(e!=e.toLowerCase()&&(g+="|"+e.toLowerCase()),f!=f.toLowerCase()&&(g+="|"+f.toLowerCase()),-1!=g.indexOf(".")&&(g+="|"+g.replace(/\./g,"")));g=g.replace(/\./g,"\\.");break;default:g=".*"}a&&a.push(b);return"("+g+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var q={};h.setObject(g.id.replace(/\//g,"."),q);q._getZone=function(c,d,b){return d?a.getTimezoneName(c):c.getTimezoneOffset()};q.format=function(a,g){g=g||{};var e=b.normalizeLocale(g.locale),
f=g.formatLength||"short",e=q._getGregorianBundle(e),n=[],l=h.hitch(this,d,a,e,g);if("year"==g.selector)return c(e["dateFormatItem-yyyy"]||"yyyy",l);var m;"date"!=g.selector&&(m=g.timePattern||e["timeFormat-"+f])&&n.push(c(m,l));"time"!=g.selector&&(m=g.datePattern||e["dateFormat-"+f])&&n.push(c(m,l));return 1==n.length?n[0]:e["dateTimeFormat-"+f].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(a,c){return n[c]})};q.regexp=function(a){return q._parseInfo(a).regexp};q._parseInfo=function(a){a=a||{};
var d=b.normalizeLocale(a.locale),d=q._getGregorianBundle(d),g=a.formatLength||"short",e=a.datePattern||d["dateFormat-"+g],f=a.timePattern||d["timeFormat-"+g],g="date"==a.selector?e:"time"==a.selector?f:d["dateTimeFormat-"+g].replace(/\{(\d+)\}/g,function(a,c){return[f,e][c]}),l=[];return{regexp:c(g,h.hitch(this,n,l,d,a)),tokens:l,bundle:d}};q.parse=function(c,d){var b=/[\u200E\u200F\u202A\u202E]/g,g=q._parseInfo(d),e=g.tokens,f=g.bundle,b=(new RegExp("^"+g.regexp.replace(b,"")+"$",g.strict?"":"i")).exec(c&&
c.replace(b,""));if(!b)return null;var n=["abbr","wide","narrow"],l=[1970,0,1,0,0,0,0],m="",b=k.every(b,function(a,c){if(!c)return!0;var b=e[c-1],g=b.length,b=b.charAt(0);switch(b){case "y":if(2!=g&&d.strict)l[0]=a;else if(100>a)a=Number(a),b=""+(new Date).getFullYear(),g=100*b.substring(0,2),b=Math.min(Number(b.substring(2,4))+20,99),l[0]=a<b?g+a:g-100+a;else{if(d.strict)return!1;l[0]=a}break;case "M":case "L":if(2<g){if(g=f["months-"+("L"==b?"standAlone":"format")+"-"+n[g-3]].concat(),d.strict||
(a=a.replace(".","").toLowerCase(),g=k.map(g,function(a){return a.replace(".","").toLowerCase()})),a=k.indexOf(g,a),-1==a)return!1}else a--;l[1]=a;break;case "E":case "e":case "c":g=f["days-"+("c"==b?"standAlone":"format")+"-"+n[g-3]].concat();d.strict||(a=a.toLowerCase(),g=k.map(g,function(a){return a.toLowerCase()}));a=k.indexOf(g,a);if(-1==a)return!1;break;case "D":l[1]=0;case "d":l[2]=a;break;case "a":g=d.am||f["dayPeriods-format-wide-am"];b=d.pm||f["dayPeriods-format-wide-pm"];if(!d.strict){var r=
/\./g;a=a.replace(r,"").toLowerCase();g=g.replace(r,"").toLowerCase();b=b.replace(r,"").toLowerCase()}if(d.strict&&a!=g&&a!=b)return!1;m=a==b?"p":a==g?"a":"";break;case "K":24==a&&(a=0);case "h":case "H":case "k":if(23<a)return!1;l[3]=a;break;case "m":l[4]=a;break;case "s":l[5]=a;break;case "S":l[6]=a}return!0}),g=+l[3];"p"===m&&12>g?l[3]=g+12:"a"===m&&12==g&&(l[3]=0);g=new Date(l[0],l[1],l[2],l[3],l[4],l[5],l[6]);d.strict&&g.setFullYear(l[0]);var r=e.join(""),u=-1!=r.indexOf("d"),r=-1!=r.indexOf("M");
if(!b||r&&g.getMonth()>l[1]||u&&g.getDate()>l[2])return null;if(r&&g.getMonth()<l[1]||u&&g.getDate()<l[2])g=a.add(g,"hour",1);return g};var t=["abbr","wide","narrow"],r=[],v={};q.addCustomFormats=function(a,c){r.push({pkg:a,name:c});v={}};q._getGregorianBundle=function(a){if(v[a])return v[a];var c={};k.forEach(r,function(d){d=b.getLocalization(d.pkg,d.name,a);c=h.mixin(c,d)},this);return v[a]=c};q.addCustomFormats(g.id.replace(/\/date\/locale$/,".cldr"),"gregorian");q.getNames=function(a,c,d,b){var g;
b=q._getGregorianBundle(b);a=[a,d,c];"standAlone"==d&&(d=a.join("-"),g=b[d],1==g[0]&&(g=void 0));a[1]="format";return(g||b[a.join("-")]).concat()};q.isWeekend=function(a,c){var d=f.getWeekend(c),b=(a||new Date).getDay();d.end<d.start&&(d.end+=7,b<d.start&&(b+=7));return b>=d.start&&b<=d.end};q._getDayOfYear=function(c){return a.difference(new Date(c.getFullYear(),0,1,c.getHours()),c)+1};q._getWeekOfYear=function(a,c){1==arguments.length&&(c=0);var d=(new Date(a.getFullYear(),0,1)).getDay(),b=(d-c+
7)%7,b=Math.floor((q._getDayOfYear(a)+b-1)/7);d==c&&b++;return b};return q})},"dojo/cldr/supplemental":function(){define(["../_base/lang","../i18n"],function(h,k){var a={};h.setObject("dojo.cldr.supplemental",a);a.getFirstDayOfWeek=function(f){f={bd:5,mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,jo:6,kw:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,
mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0}[a._region(f)];return void 0===f?1:f};a._region=function(a){a=k.normalizeLocale(a);a=a.split("-");var b=a[1];b?4==b.length&&(b=a[2]):b={aa:"et",ab:"ge",af:"za",ak:"gh",am:"et",ar:"eg",as:"in",av:"ru",ay:"bo",az:"az",ba:"ru",be:"by",bg:"bg",bi:"vu",bm:"ml",bn:"bd",bo:"cn",br:"fr",bs:"ba",ca:"es",ce:"ru",ch:"gu",co:"fr",cr:"ca",cs:"cz",cv:"ru",cy:"gb",da:"dk",de:"de",
dv:"mv",dz:"bt",ee:"gh",el:"gr",en:"us",es:"es",et:"ee",eu:"es",fa:"ir",ff:"sn",fi:"fi",fj:"fj",fo:"fo",fr:"fr",fy:"nl",ga:"ie",gd:"gb",gl:"es",gn:"py",gu:"in",gv:"gb",ha:"ng",he:"il",hi:"in",ho:"pg",hr:"hr",ht:"ht",hu:"hu",hy:"am",ia:"fr",id:"id",ig:"ng",ii:"cn",ik:"us","in":"id",is:"is",it:"it",iu:"ca",iw:"il",ja:"jp",ji:"ua",jv:"id",jw:"id",ka:"ge",kg:"cd",ki:"ke",kj:"na",kk:"kz",kl:"gl",km:"kh",kn:"in",ko:"kr",ks:"in",ku:"tr",kv:"ru",kw:"gb",ky:"kg",la:"va",lb:"lu",lg:"ug",li:"nl",ln:"cd",lo:"la",
lt:"lt",lu:"cd",lv:"lv",mg:"mg",mh:"mh",mi:"nz",mk:"mk",ml:"in",mn:"mn",mo:"ro",mr:"in",ms:"my",mt:"mt",my:"mm",na:"nr",nb:"no",nd:"zw",ne:"np",ng:"na",nl:"nl",nn:"no",no:"no",nr:"za",nv:"us",ny:"mw",oc:"fr",om:"et",or:"in",os:"ge",pa:"in",pl:"pl",ps:"af",pt:"br",qu:"pe",rm:"ch",rn:"bi",ro:"ro",ru:"ru",rw:"rw",sa:"in",sd:"in",se:"no",sg:"cf",si:"lk",sk:"sk",sl:"si",sm:"ws",sn:"zw",so:"so",sq:"al",sr:"rs",ss:"za",st:"za",su:"id",sv:"se",sw:"tz",ta:"in",te:"in",tg:"tj",th:"th",ti:"et",tk:"tm",tl:"ph",
tn:"za",to:"to",tr:"tr",ts:"za",tt:"ru",ty:"pf",ug:"cn",uk:"ua",ur:"pk",uz:"uz",ve:"za",vi:"vn",wa:"be",wo:"sn",xh:"za",yi:"il",yo:"ng",za:"cn",zh:"cn",zu:"za",ace:"id",ady:"ru",agq:"cm",alt:"ru",amo:"ng",asa:"tz",ast:"es",awa:"in",bal:"pk",ban:"id",bas:"cm",bax:"cm",bbc:"id",bem:"zm",bez:"tz",bfq:"in",bft:"pk",bfy:"in",bhb:"in",bho:"in",bik:"ph",bin:"ng",bjj:"in",bku:"ph",bqv:"ci",bra:"in",brx:"in",bss:"cm",btv:"pk",bua:"ru",buc:"yt",bug:"id",bya:"id",byn:"er",cch:"ng",ccp:"in",ceb:"ph",cgg:"ug",
chk:"fm",chm:"ru",chp:"ca",chr:"us",cja:"kh",cjm:"vn",ckb:"iq",crk:"ca",csb:"pl",dar:"ru",dav:"ke",den:"ca",dgr:"ca",dje:"ne",doi:"in",dsb:"de",dua:"cm",dyo:"sn",dyu:"bf",ebu:"ke",efi:"ng",ewo:"cm",fan:"gq",fil:"ph",fon:"bj",fur:"it",gaa:"gh",gag:"md",gbm:"in",gcr:"gf",gez:"et",gil:"ki",gon:"in",gor:"id",grt:"in",gsw:"ch",guz:"ke",gwi:"ca",haw:"us",hil:"ph",hne:"in",hnn:"ph",hoc:"in",hoj:"in",ibb:"ng",ilo:"ph",inh:"ru",jgo:"cm",jmc:"tz",kaa:"uz",kab:"dz",kaj:"ng",kam:"ke",kbd:"ru",kcg:"ng",kde:"tz",
kdt:"th",kea:"cv",ken:"cm",kfo:"ci",kfr:"in",kha:"in",khb:"cn",khq:"ml",kht:"in",kkj:"cm",kln:"ke",kmb:"ao",koi:"ru",kok:"in",kos:"fm",kpe:"lr",krc:"ru",kri:"sl",krl:"ru",kru:"in",ksb:"tz",ksf:"cm",ksh:"de",kum:"ru",lag:"tz",lah:"pk",lbe:"ru",lcp:"cn",lep:"in",lez:"ru",lif:"np",lis:"cn",lki:"ir",lmn:"in",lol:"cd",lua:"cd",luo:"ke",luy:"ke",lwl:"th",mad:"id",mag:"in",mai:"in",mak:"id",man:"gn",mas:"ke",mdf:"ru",mdh:"ph",mdr:"id",men:"sl",mer:"ke",mfe:"mu",mgh:"mz",mgo:"cm",min:"id",mni:"in",mnk:"gm",
mnw:"mm",mos:"bf",mua:"cm",mwr:"in",myv:"ru",nap:"it",naq:"na",nds:"de","new":"np",niu:"nu",nmg:"cm",nnh:"cm",nod:"th",nso:"za",nus:"sd",nym:"tz",nyn:"ug",pag:"ph",pam:"ph",pap:"bq",pau:"pw",pon:"fm",prd:"ir",raj:"in",rcf:"re",rej:"id",rjs:"np",rkt:"in",rof:"tz",rwk:"tz",saf:"gh",sah:"ru",saq:"ke",sas:"id",sat:"in",saz:"in",sbp:"tz",scn:"it",sco:"gb",sdh:"ir",seh:"mz",ses:"ml",shi:"ma",shn:"mm",sid:"et",sma:"se",smj:"se",smn:"fi",sms:"fi",snk:"ml",srn:"sr",srr:"sn",ssy:"er",suk:"tz",sus:"gn",swb:"yt",
swc:"cd",syl:"bd",syr:"sy",tbw:"ph",tcy:"in",tdd:"cn",tem:"sl",teo:"ug",tet:"tl",tig:"er",tiv:"ng",tkl:"tk",tmh:"ne",tpi:"pg",trv:"tw",tsg:"ph",tts:"th",tum:"mw",tvl:"tv",twq:"ne",tyv:"ru",tzm:"ma",udm:"ru",uli:"fm",umb:"ao",unr:"in",unx:"in",vai:"lr",vun:"tz",wae:"ch",wal:"et",war:"ph",xog:"ug",xsr:"np",yao:"mz",yap:"fm",yav:"cm",zza:"tr"}[a[0]];return b};a.getWeekend=function(f){var b=a._region(f);f={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,
tn:5}[b];b={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6}[b];void 0===f&&(f=6);void 0===b&&(b=0);return{start:f,end:b}};return a})},"dojo/cldr/nls/gregorian":function(){define({root:{"dateFormatItem-Ehm":"E h:mm a","days-standAlone-short":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"months-format-narrow":"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),"field-second-relative+0":"now","quarters-standAlone-narrow":["1","2","3","4"],"field-weekday":"Day of the Week",
"dateFormatItem-yQQQ":"y QQQ","dateFormatItem-yMEd":"y-MM-dd, E","field-wed-relative+0":"this Wednesday","field-wed-relative+1":"next Wednesday","dateFormatItem-GyMMMEd":"G y MMM d, E","dateFormatItem-MMMEd":"MMM d, E",eraNarrow:["BCE","CE"],"field-tue-relative+-1":"last Tuesday","days-format-short":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dateTimeFormats-appendItem-Day-Of-Week":"{0} {1}","dateFormat-long":"y MMMM d","field-fri-relative+-1":"last Friday","field-wed-relative+-1":"last Wednesday",
"months-format-wide":"M01 M02 M03 M04 M05 M06 M07 M08 M09 M10 M11 M12".split(" "),"dateTimeFormat-medium":"{1} {0}","dayPeriods-format-wide-pm":"PM","dateFormat-full":"y MMMM d, EEEE","field-thu-relative+-1":"last Thursday","dateFormatItem-Md":"MM-dd","dayPeriods-format-abbr-am":"AM","dateTimeFormats-appendItem-Second":"{0} ({2}: {1})","dayPeriods-format-wide-noon":"noon","dateFormatItem-yMd":"y-MM-dd","field-era":"Era","dateFormatItem-yM":"y-MM","months-standAlone-wide":"M01 M02 M03 M04 M05 M06 M07 M08 M09 M10 M11 M12".split(" "),
"timeFormat-short":"HH:mm","quarters-format-wide":["Q1","Q2","Q3","Q4"],"dateFormatItem-yQQQQ":"y QQQQ","timeFormat-long":"HH:mm:ss z","field-year":"Year","dateFormatItem-yMMM":"y MMM","dateTimeFormats-appendItem-Era":"{1} {0}","field-hour":"Hour","months-format-abbr":"M01 M02 M03 M04 M05 M06 M07 M08 M09 M10 M11 M12".split(" "),"field-sat-relative+0":"this Saturday","field-sat-relative+1":"next Saturday","timeFormat-full":"HH:mm:ss zzzz","dateTimeFormats-appendItem-Week":"{0} ({2}: {1})","field-day-relative+0":"today",
"field-thu-relative+0":"this Thursday","field-day-relative+1":"tomorrow","field-thu-relative+1":"next Thursday","dateFormatItem-GyMMMd":"G y MMM d","dateFormatItem-H":"HH","months-standAlone-abbr":"M01 M02 M03 M04 M05 M06 M07 M08 M09 M10 M11 M12".split(" "),"quarters-format-abbr":["Q1","Q2","Q3","Q4"],"quarters-standAlone-wide":["Q1","Q2","Q3","Q4"],"dateFormatItem-Gy":"G y","dateFormatItem-M":"L","days-standAlone-wide":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dayPeriods-format-abbr-noon":"noon",
"timeFormat-medium":"HH:mm:ss","field-sun-relative+0":"this Sunday","dateFormatItem-Hm":"HH:mm","field-sun-relative+1":"next Sunday","quarters-standAlone-abbr":["Q1","Q2","Q3","Q4"],eraAbbr:["BCE","CE"],"field-minute":"Minute","field-dayperiod":"Dayperiod","days-standAlone-abbr":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dateFormatItem-d":"d","dateFormatItem-ms":"mm:ss","quarters-format-narrow":["1","2","3","4"],"field-day-relative+-1":"yesterday","dateTimeFormat-long":"{1} {0}","dayPeriods-format-narrow-am":"a",
"dateFormatItem-h":"h a","dateFormatItem-MMMd":"MMM d","dateFormatItem-MEd":"MM-dd, E","dateTimeFormat-full":"{1} {0}","field-fri-relative+0":"this Friday","field-fri-relative+1":"next Friday","field-day":"Day","days-format-wide":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"field-zone":"Zone","months-standAlone-narrow":"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),"dateFormatItem-y":"y","dateTimeFormats-appendItem-Day":"{0} ({2}: {1})","field-year-relative+-1":"last year","field-month-relative+-1":"last month",
"dateTimeFormats-appendItem-Year":"{1} {0}","dateFormatItem-hm":"h:mm a","dateTimeFormats-appendItem-Hour":"{0} ({2}: {1})","dayPeriods-format-abbr-pm":"PM","days-format-abbr":"Sun Mon Tue Wed Thu Fri Sat".split(" "),eraNames:["BCE","CE"],"dateFormatItem-yMMMd":"y MMM d","days-format-narrow":"SMTWTFS".split(""),"field-month":"Month","days-standAlone-narrow":"SMTWTFS".split(""),"dateFormatItem-MMM":"LLL","field-tue-relative+0":"this Tuesday","dateTimeFormats-appendItem-Quarter":"{0} ({2}: {1})","field-tue-relative+1":"next Tuesday",
"dayPeriods-format-wide-am":"AM","dateTimeFormats-appendItem-Month":"{0} ({2}: {1})","dateTimeFormats-appendItem-Minute":"{0} ({2}: {1})","dateFormatItem-EHm":"E HH:mm","field-mon-relative+0":"this Monday","field-mon-relative+1":"next Monday","dateFormat-short":"y-MM-dd","dateFormatItem-EHms":"E HH:mm:ss","dateFormatItem-Ehms":"E h:mm:ss a","dayPeriods-format-narrow-noon":"n","field-second":"Second","field-sat-relative+-1":"last Saturday","dateFormatItem-yMMMEd":"y MMM d, E","field-sun-relative+-1":"last Sunday",
"field-month-relative+0":"this month","field-month-relative+1":"next month","dateTimeFormats-appendItem-Timezone":"{0} {1}","dateFormatItem-Ed":"d, E","field-week":"Week","dateFormat-medium":"y MMM d","field-week-relative+-1":"last week","field-year-relative+0":"this year","field-year-relative+1":"next year","dayPeriods-format-narrow-pm":"p","dateTimeFormat-short":"{1} {0}","dateFormatItem-Hms":"HH:mm:ss","dateFormatItem-hms":"h:mm:ss a","dateFormatItem-GyMMM":"G y MMM","field-mon-relative+-1":"last Monday",
"field-week-relative+0":"this week","field-week-relative+1":"next week"},ar:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,"en-au":!0,"en-ca":!0,"en-gb":!0,es:!0,et:!0,fi:!0,fr:!0,"fr-ch":!0,he:!0,hi:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,mk:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,pt:!0,"pt-pt":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,vi:!0,zh:!0,"zh-hant":!0,"zh-hk":!0,"zh-tw":!0})},"dojo/cldr/nls/en/gregorian":function(){define({"dateFormatItem-Ehm":"E h:mm a","days-standAlone-short":"Su Mo Tu We Th Fr Sa".split(" "),
"months-format-narrow":"JFMAMJJASOND".split(""),"field-second-relative+0":"now","quarters-standAlone-narrow":["1","2","3","4"],"field-weekday":"Day of the Week","dateFormatItem-yQQQ":"QQQ y","dateFormatItem-yMEd":"E, M/d/y","field-wed-relative+0":"this Wednesday","field-wed-relative+1":"next Wednesday","dateFormatItem-GyMMMEd":"E, MMM d, y G","dateFormatItem-MMMEd":"E, MMM d",eraNarrow:["B","A"],"field-tue-relative+-1":"last Tuesday","days-format-short":"Su Mo Tu We Th Fr Sa".split(" "),"dateTimeFormats-appendItem-Day-Of-Week":"{0} {1}",
"dateFormat-long":"MMMM d, y","field-fri-relative+-1":"last Friday","field-wed-relative+-1":"last Wednesday","months-format-wide":"January February March April May June July August September October November December".split(" "),"dateTimeFormat-medium":"{1}, {0}","dayPeriods-format-wide-pm":"PM","dateFormat-full":"EEEE, MMMM d, y","field-thu-relative+-1":"last Thursday","dateFormatItem-Md":"M/d","dateTimeFormats-appendItem-Second":"{0} ({2}: {1})","dayPeriods-format-wide-noon":"noon","dateFormatItem-yMd":"M/d/y",
"field-era":"Era","dateFormatItem-yM":"M/y","months-standAlone-wide":"January February March April May June July August September October November December".split(" "),"timeFormat-short":"h:mm a","quarters-format-wide":["1st quarter","2nd quarter","3rd quarter","4th quarter"],"dateFormatItem-yQQQQ":"QQQQ y","timeFormat-long":"h:mm:ss a z","field-year":"Year","dateFormatItem-yMMM":"MMM y","dateTimeFormats-appendItem-Era":"{0} {1}","field-hour":"Hour","months-format-abbr":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),
"field-sat-relative+0":"this Saturday","field-sat-relative+1":"next Saturday","timeFormat-full":"h:mm:ss a zzzz","dateTimeFormats-appendItem-Week":"{0} ({2}: {1})","field-day-relative+0":"today","field-thu-relative+0":"this Thursday","field-day-relative+1":"tomorrow","field-thu-relative+1":"next Thursday","dateFormatItem-GyMMMd":"MMM d, y G","dateFormatItem-H":"HH","months-standAlone-abbr":"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),"quarters-format-abbr":["Q1","Q2","Q3","Q4"],"quarters-standAlone-wide":["1st quarter",
"2nd quarter","3rd quarter","4th quarter"],"dateFormatItem-Gy":"y G","dateFormatItem-M":"L","days-standAlone-wide":"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),"timeFormat-medium":"h:mm:ss a","field-sun-relative+0":"this Sunday","dateFormatItem-Hm":"HH:mm","field-sun-relative+1":"next Sunday",eraAbbr:["BC","AD"],"field-minute":"Minute","field-dayperiod":"AM/PM","dateFormatItem-d":"d","dateFormatItem-ms":"mm:ss","field-day-relative+-1":"yesterday","dateFormatItem-h":"h a",
"dateTimeFormat-long":"{1} 'at' {0}","dayPeriods-format-narrow-am":"a","dateFormatItem-MMMd":"MMM d","dateFormatItem-MEd":"E, M/d","dateTimeFormat-full":"{1} 'at' {0}","field-fri-relative+0":"this Friday","field-fri-relative+1":"next Friday","field-day":"Day","days-format-wide":"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),"field-zone":"Time Zone","dateTimeFormats-appendItem-Day":"{0} ({2}: {1})","dateFormatItem-y":"y","months-standAlone-narrow":"JFMAMJJASOND".split(""),"field-year-relative+-1":"last year",
"field-month-relative+-1":"last month","dateFormatItem-hm":"h:mm a","dateTimeFormats-appendItem-Year":"{0} {1}","dateTimeFormats-appendItem-Hour":"{0} ({2}: {1})","days-format-abbr":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dateFormatItem-yMMMd":"MMM d, y",eraNames:["Before Christ","Anno Domini"],"days-standAlone-narrow":"SMTWTFS".split(""),"dateFormatItem-MMM":"LLL","field-month":"Month","field-tue-relative+0":"this Tuesday","dateTimeFormats-appendItem-Quarter":"{0} ({2}: {1})","field-tue-relative+1":"next Tuesday",
"dayPeriods-format-wide-am":"AM","dateTimeFormats-appendItem-Month":"{0} ({2}: {1})","dateTimeFormats-appendItem-Minute":"{0} ({2}: {1})","dateFormatItem-EHm":"E HH:mm","field-mon-relative+0":"this Monday","field-mon-relative+1":"next Monday","dateFormat-short":"M/d/yy","dateFormatItem-EHms":"E HH:mm:ss","dateFormatItem-Ehms":"E h:mm:ss a","dayPeriods-format-narrow-noon":"n","field-second":"Second","field-sat-relative+-1":"last Saturday","dateFormatItem-yMMMEd":"E, MMM d, y","field-sun-relative+-1":"last Sunday",
"field-month-relative+0":"this month","field-month-relative+1":"next month","dateFormatItem-Ed":"d E","dateTimeFormats-appendItem-Timezone":"{0} {1}","field-week":"Week","dateFormat-medium":"MMM d, y","field-year-relative+0":"this year","field-week-relative+-1":"last week","field-year-relative+1":"next year","dayPeriods-format-narrow-pm":"p","dateTimeFormat-short":"{1}, {0}","dateFormatItem-Hms":"HH:mm:ss","dateFormatItem-hms":"h:mm:ss a","dateFormatItem-GyMMM":"MMM y G","field-mon-relative+-1":"last Monday",
"field-week-relative+0":"this week","field-week-relative+1":"next week"})},"esri/geometry/ScreenPoint":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Point"],function(h,k,a,f,b){h=h(b,{declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}});return a("extend-esri")&&k.setObject("geometry.ScreenPoint",h,f),h})},"esri/geometry/Point":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ../srUtils".split(" "),
function(h,k,a,f,b,e,l,m){function g(a,d){89.99999<d?d=89.99999:-89.99999>d&&(d=-89.99999);var b=d*t;return[a*t*c,c/2*Math.log((1+Math.sin(b))/(1-Math.sin(b)))]}function d(a,d,b){a=a/c*q;return b?[a,(n/2-2*Math.atan(Math.exp(-1*d/c)))*q]:[a-360*Math.floor((a+180)/360),(n/2-2*Math.atan(Math.exp(-1*d/c)))*q]}var c=6378137,n=3.141592653589793,q=57.29577951308232,t=.017453292519943,r={type:"point",x:0,y:0};h=h(l,{declaredClass:"esri.geometry.Point",constructor:function(a,c,d){k.mixin(this,r);k.isArray(a)?
(this.x=a[0],this.y=a[1],this.spatialReference=c):k.isObject(a)?(k.mixin(this,a),b.isDefined(this.latitude)&&(this.y=this.latitude),b.isDefined(this.longitude)&&(this.x=this.longitude),this.spatialReference&&(this.spatialReference=m.createSpatialReference(this.spatialReference))):(this.x=a,this.y=c,this.spatialReference=d);this.verifySR()},offset:function(a,c){return new this.constructor(this.x+a,this.y+c,this.spatialReference)},setX:function(a){return this.x=a,this.clearCache(),this},setY:function(a){return this.y=
a,this.clearCache(),this},setLongitude:function(a){var c=this.spatialReference;return c&&(c._isWebMercator()?this.setX(g(a,this.y)[0]):4326===c.wkid&&this.setX(a)),this},setLatitude:function(a){var c=this.spatialReference;return c&&(c._isWebMercator()?this.setY(g(this.x,a)[1]):4326===c.wkid&&this.setY(a)),this},getLongitude:function(){var a,c=this.spatialReference;return c&&(c._isWebMercator()?a=d(this.x,this.y)[0]:4326===c.wkid&&(a=this.x)),a},getLatitude:function(){var a,c=this.spatialReference;
return c&&(c._isWebMercator()?a=d(this.x,this.y)[1]:4326===c.wkid&&(a=this.y)),a},update:function(a,c){return this.x=a,this.y=c,this.clearCache(),this},normalize:function(){var a=this.x,c=this.spatialReference;if(c){var d=c._getInfo();if(d){var b,g=d.valid[0],d=d.valid[1],e=2*d;a>d?(b=Math.ceil(Math.abs(a-d)/e),a-=b*e):g>a&&(b=Math.ceil(Math.abs(a-g)/e),a+=b*e)}}return new this.constructor(a,this.y,c)},toJson:function(){var a={x:this.x,y:this.y},c=this.spatialReference;return c&&(a.spatialReference=
c.toJson()),a}});return h.lngLatToXY=g,h.xyToLngLat=d,h.defaultProps=r,a("extend-esri")&&(k.setObject("geometry.Point",h,f),f.geometry.defaultPoint=r),h})},"esri/SpatialReference":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ./kernel ./lang".split(" "),function(h,k,a,f,b,e){var l=[-2.0037508342788905E7,2.0037508342788905E7],m=[-2.0037508342787E7,2.0037508342787E7];h=h(null,{declaredClass:"esri.SpatialReference",constructor:function(b){b&&(a.isObject(b)?a.mixin(this,
b):a.isString(b)?this.wkt=b:this.wkid=b)},wkid:null,wkt:null,_info:{102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:l,origin:m,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:l,origin:m,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:l,origin:m,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:l,origin:m,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",${Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}},_isWebMercator:function(){return-1!==k.indexOf([102113,102100,3857,3785],this.wkid)},_isWrappable:function(){return-1!==k.indexOf([102113,102100,3857,3785,4326],this.wkid)},_getInfo:function(){return this.wkid?this._info[this.wkid]:null},_canProject:function(a){var d=!1;return a&&(d=this.isWebMercator()&&4326===a.wkid||a.isWebMercator()&&4326===this.wkid),d},isWebMercator:function(){return this._isWebMercator()},equals:function(a){var d=!1;return a&&(this===
a&&(d=!0),this.wkid||a.wkid?d=this.wkid===a.wkid||this.isWebMercator()&&a.isWebMercator()||this.wkid===a.latestWkid||a.wkid===this.latestWkid:this.wkt&&a.wkt&&(d=this.wkt.toUpperCase()===a.wkt.toUpperCase())),d},toJson:function(){var a=null,d=e.isDefined;return d(this.wkid)?a={wkid:this.wkid}:d(this.wkt)&&(a={wkt:this.wkt}),a&&d(this.latestWkid)&&(a.latestWkid=this.latestWkid),a}});return f("extend-esri")&&(b.SpatialReference=h),h})},"esri/geometry/Geometry":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../SpatialReference"],function(h,k,a,f,b){h=h(null,{declaredClass:"esri.geometry.Geometry",spatialReference:null,type:null,cache:void 0,setSpatialReference:function(a){return this.spatialReference=a,this},verifySR:function(){this.spatialReference||this.setSpatialReference(new b(4326))},getExtent:function(){return null},clearCache:function(){this.cache=void 0},getCacheValue:function(a){return this.cache&&this.cache[a]},setCacheValue:function(a,b){this.cache||
(this.cache={});this.cache[a]=b}});return a("extend-esri")&&k.setObject("geometry.Geometry",h,f),h})},"esri/srUtils":function(){define(["./SpatialReference","./ImageSpatialReference","./kernel","./sniff","dojo/_base/lang"],function(h,k,a,f,b){function e(a){var b=!1;return a&&(a.ics||a.icsid)&&(b=!0),b}var l={isICS:e,createSpatialReference:function(a){var b=null;return a&&(b=e(a)?new k(a):new h(a)),b}};return f("extend-esri")&&b.mixin(a,l),l})},"esri/ImageSpatialReference":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./lang ./SpatialReference".split(" "),
function(h,k,a,f,b,e){h=h(e,{declaredClass:"esri.ImageSpatialReference",constructor:function(a){a&&(k.isObject(a)&&k.mixin(this,a),this.url||console.error("ImageSpatialReference: must provide image service URL."))},icsid:null,ics:null,_isWebMercator:function(){return!1},_isWrappable:function(){return!1},equals:function(a){var b=!1;return a&&(this.icsid&&a.icsid?b=this.icsid===a.icsid:this.ics&&a.ics&&(b=this.ics===a.ics)),b},toJson:function(a){var e=null,g=b.isDefined;return a=g(a)?a:!0,g(this.icsid)?
e={icsid:this.icsid}:g(this.ics)&&(e={ics:this.ics}),g(this.url)&&g(e)&&a&&(e.url=this.url),e}});return a("extend-esri")&&(f.ImageSpatialReference=h),h})},"esri/sniff":function(){define(["dojo/_base/sniff","./kernel"],function(h,k){var a,f=function(){return this}(),b=h("ff"),e=h("ie"),l=void 0===e&&7<=h("trident"),m=h("edge"),g=h("webkit"),d=h("opera"),c=h("chrome"),n=h("safari"),q=navigator.userAgent;return a=q.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+\_\d+)/i),a&&h.add("esri-iphone",parseFloat(a[2].replace("_",
"."))),a=q.match(/Android\s+(\d+\.\d+)/i),a&&h.add("esri-android",parseFloat(a[1])),a=q.match(/Fennec\/(\d+\.\d+)/i),a&&h.add("esri-fennec",parseFloat(a[1])),0<=q.indexOf("BlackBerry")&&0<=q.indexOf("WebKit")&&h.add("esri-blackberry",1),h.add("esri-touch",h("esri-iphone")||h("esri-android")||h("esri-blackberry")||6<=h("esri-fennec")||(b||g)&&document.createTouch?!0:!1),a=q.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i),a&&h.add("esri-mobile",a),h.add("esri-pointer",navigator.pointerEnabled||
navigator.msPointerEnabled),k._getDOMAccessor=function(a){var c="";return b?c="Moz":g?c="Webkit":e?c="ms":d&&(c="O"),c+a.charAt(0).toUpperCase()+a.substr(1)},h.add("esri-phonegap",!!f.cordova),h.add("esri-cors",h("esri-phonegap")||f.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),h.add("esri-file-upload",f.FormData&&f.FileList?!0:!1),h.add("esri-workers",f.Worker?!0:!1),h.add("esri-transforms",l||m||9<=e||3.5<=b||4<=c||3.1<=n||10.5<=d||3.2<=h("esri-iphone")||2.1<=h("esri-android")),h.add("esri-transitions",
l||m||10<=e||4<=b||4<=c||3.1<=n||10.5<=d||3.2<=h("esri-iphone")||2.1<=h("esri-android")),h.add("esri-transforms3d",l||m||10<=b||12<=c||4<=n||3.2<=h("esri-iphone")||3<=h("esri-android")),h.add("esri-url-encodes-apostrophe",function(){if(f.document)return!1;var a=f.document.createElement("a");return a.href="?'",-1<a.href.indexOf("?%27")}),3>h("esri-android")&&(h.add("esri-transforms",!1,!1,!0),h.add("esri-transitions",!1,!1,!0),h.add("esri-transforms3d",!1,!1,!0)),h.add("esri-will-change",h("esri-transforms")&&
(52<=c||9.1<=n)),k._css=function(a){var f=h("esri-transforms3d");void 0!==a&&null!==a?f=a:f&&(c||n&&!h("esri-iphone"))&&(f=!1);var l=f?"translate3d(":"translate(",m=f?c?",-1px)":",0px)":")",q=f?"scale3d(":"scale(",t=f?",1)":")",k=f?"rotate3d(0,0,1,":"rotate(",A=f?"matrix3d(":"matrix(",z=f?",0,0,":",",B=f?",0,0,0,0,1,0,":",",C=f?",0,1)":")";return{names:{transition:g&&"-webkit-transition"||b&&"MozTransition"||d&&"OTransition"||e&&"msTransition"||"transition",transform:g&&"-webkit-transform"||b&&"MozTransform"||
d&&"OTransform"||e&&"msTransform"||"transform",transformName:g&&"-webkit-transform"||b&&"-moz-transform"||d&&"-o-transform"||e&&"-ms-transform"||"transform",origin:g&&"-webkit-transform-origin"||b&&"MozTransformOrigin"||d&&"OTransformOrigin"||e&&"msTransformOrigin"||"transformOrigin",endEvent:g&&"webkitTransitionEnd"||b&&"transitionend"||d&&"oTransitionEnd"||e&&"MSTransitionEnd"||"transitionend"},translate:function(a,c){return l+a+"px,"+c+"px"+m},scale:function(a){return q+a+","+a+t},rotate:function(a){return k+
a+"deg)"},matrix:function(a){return A+a.xx+","+a.xy+z+a.yx+","+a.yy+B+a.dx.toFixed(10)+(b?"px,":",")+a.dy.toFixed(10)+(b?"px":"")+C},getScaleFromMatrix:function(a){if(!a)return 1;a=a.toLowerCase();var c=-1<a.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(a.substring(c.length,a.indexOf(",")))}}},h("extend-esri")&&(k.isiPhone=h("esri-iphone"),k.isAndroid=h("esri-android"),k.isFennec=h("esri-fennec"),k.isBlackBerry=h("esri-blackberry"),k.isTouchEnabled=h("esri-touch"),k.isPointerEnabled=h("esri-pointer"),
k._hasCors=h("esri-cors"),k._hasFileUpload=h("esri-file-upload"),k._hasTransforms=h("esri-transforms"),k._hasTransitions=h("esri-transitions"),k._has3DTransforms=h("esri-transforms3d")),h})},"esri/PopupBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/Deferred dojo/has ./kernel ./graphic ./geometry/Point ./geometry/jsonUtils ./geometry/mathUtils ./geometry/webMercatorUtils ./symbols/SimpleMarkerSymbol ./symbols/SimpleLineSymbol ./symbols/CartographicLineSymbol ./symbols/SimpleFillSymbol ./tasks/query ./Evented require".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w){function x(a){return"sizeInfo"===a.type}h=h(w,{declaredClass:"esri.PopupBase",_featureLayers:{},_updateEndHandles:[],_evtMap:{"set-features":!0,"clear-features":!0,"selection-change":!0,"dfd-complete":!0},onSetFeatures:function(){},onClearFeatures:function(){},onSelectionChange:function(){},onDfdComplete:function(){},initialize:function(){this.count=0;this.selectedIndex=-1;this.on("clear-features",k.hitch(this,this._resetUpdateEndListeners));this.on("dfd-complete",
k.hitch(this,this._processFeatures));this.on("set-features",k.hitch(this,this._processFeatures))},cleanup:function(){this.features=this.deferreds=null;this._resetUpdateEndListeners()},setFeatures:function(c){if(c&&c.length){this.clearFeatures();var d,g;c[0]instanceof b?g=c:d=c;d?this._updateFeatures(null,d):(this.deferreds=g,g=g.slice(0),a.forEach(g,function(a){a.addBoth(k.hitch(this,this._updateFeatures,a))},this))}},clearFeatures:function(){this.features=this.deferreds=this._marked=null;this.count=
0;var a=this.selectedIndex;this.selectedIndex=-1;-1<a&&this.onSelectionChange();this.onClearFeatures()},getSelectedFeature:function(){var a=this.features;return a?a[this.selectedIndex]:void 0},select:function(a){0>a||a>=this.count||(this.selectedIndex=a,this.onSelectionChange())},enableHighlight:function(a){(this._highlighted=a.graphics.add(new m(new g(0,0,a.spatialReference))),this._highlighted.hide(),this.markerSymbol)||(a=this.markerSymbol=new q,a.setStyle(q.STYLE_TARGET),a._setDim(16,16,0),a.setOutline(new r(t.STYLE_SOLID,
new f([0,255,255]),2,r.CAP_ROUND,r.JOIN_ROUND)),a.setColor(new f([0,0,0,0])));this.lineSymbol||(this.lineSymbol=new t(t.STYLE_SOLID,new f([0,255,255]),2));this.fillSymbol||(this.fillSymbol=new v(v.STYLE_NULL,new t(t.STYLE_SOLID,new f([0,255,255]),2),new f([0,0,0,0])))},disableHighlight:function(a){var c=this._highlighted;c&&(c.hide(),a.graphics.remove(c),delete this._highlighted);this.markerSymbol=this.lineSymbol=this.fillSymbol=null},showHighlight:function(){var a=this.features&&this.features[this.selectedIndex];
this._highlighted&&a&&a.geometry&&this._highlighted.show()},hideHighlight:function(){this._highlighted&&this._highlighted.hide()},updateHighlight:function(a,c){var b=c.geometry,g=this._highlighted;if(!b||!g)return void(g&&g.hide());g.hide();!g._graphicsLayer&&a&&a.graphics.add(g);g.setGeometry(d.fromJson(b.toJson()));var e;switch(b.type){case "point":case "multipoint":var f=c.getLayer(),b=c.symbol||f&&f._getSymbol(c);if(f&&b){var n,l,m=0,r=0,u=0;e=c.symbol?null:f._getRenderer(c);if(f=this._getSizeInfo(e))n=
l=e.getSize(c,{sizeInfo:f,shape:b.style,resolution:a&&a.getResolutionInMeters&&a.getResolutionInMeters()});else switch(b.type){case "simplemarkersymbol":n=l=b.size||0;break;case "picturemarkersymbol":n=b.width||0,l=b.height||0}m=b.xoffset||0;r=b.yoffset||0;u=b.angle||0;e=this.markerSymbol;e.setOffset(0,0);e.setAngle(0);n&&l&&e._setDim(n+1,l+1,0);e.setOffset(m,r);e.setAngle(u)}break;case "polyline":e=this.lineSymbol;break;case "polygon":e=this.fillSymbol}g.setSymbol(e)},showClosestFirst:function(a){var d=
this.features;if(d&&d.length){if(1<d.length){var b,g,e,f,l,m=1/0,r=-1,u=c.getLength,q=a.spatialReference;a=a.normalize();for(b=d.length-1;0<=b;b--)if(g=d[b].geometry){f=g.spatialReference;e=0;try{l="point"===g.type?g:g.getExtent().getCenter(),l=l.normalize(),q&&f&&!q.equals(f)&&q._canProject(f)&&(l=q.isWebMercator()?n.geographicToWebMercator(l):n.webMercatorToGeographic(l)),e=u(a,l)}catch(L){}0<e&&m>e&&(m=e,r=b)}0<r&&(d.splice(0,0,d.splice(r,1)[0]),this.select(0))}}else this.deferreds&&(this._marked=
a)},_unbind:function(c){c=a.indexOf(this.deferreds,c);if(-1!==c)return this.deferreds.splice(c,1),this.deferreds.length?1:(this.deferreds=null,2)},_fireComplete:function(a){var c=this._marked;c&&(this._marked=null,this.showClosestFirst(c));this.onDfdComplete(a)},_updateFeatures:function(c,d){if(c){if(this.deferreds){var b=this._unbind(c);if(b){if(d&&d instanceof Error)return this._fireComplete(d),void(2===b&&this.onSetFeatures());if(d&&d.length)if(this.features){var g=a.filter(d,function(c){return-1===
a.indexOf(this.features,c)},this);this.features=this.features.concat(g);this.count=this.features.length;this._fireComplete();2===b&&this.onSetFeatures()}else this.features=d,this.count=d.length,this.selectedIndex=0,this._fireComplete(),2===b&&this.onSetFeatures(),this.select(0);else this._fireComplete(),2===b&&this.onSetFeatures()}}}else this.features=d,this.count=d.length,this.selectedIndex=0,this.onSetFeatures(),this.select(0)},_getSizeInfo:function(c){return c?c.sizeInfo||a.filter(c.visualVariables,
x)[0]:null},_resetUpdateEndListeners:function(){this._featureLayers={};a.forEach(this._updateEndHandles,function(a){a.remove()});this._updateEndHandles=[]},_processFeatures:function(){a.forEach(this.features,function(a){(a=a.getLayer())&&!this._featureLayers[a.id]&&(1===a.currentMode||0===a.currentMode&&6===a.mode)&&a.objectIdField&&a.hasXYFootprint&&a.queryFeatures&&("esriGeometryPolygon"===a.geometryType||"esriGeometryPolyline"===a.geometryType||a.hasXYFootprint())&&(this._featureLayers[a.id]=a,
a=a.on("update-end",k.hitch(this,this._fLyrUpdateEndHandler)),this._updateEndHandles.push(a))},this)},_fLyrUpdateEndHandler:function(c){if(!c.error){var d=this,b=c.target,g=b.getSelectedFeatures(),e=0===b.currentMode&&6===b.mode,f={},n=[];if(a.forEach(this.features,function(a){if(a.getLayer()===b){var c=a.attributes[b.objectIdField];f[c]=a;n.push(c)}}),n.length)c=new u,c.objectIds=n,b.queryFeatures(c,function(c){a.forEach(c.features,function(c){var d=f[c.attributes[b.objectIdField]],n=!1;d.geometry!==
c.geometry?(d.setGeometry(c.geometry),n=!0):e&&g&&-1!==a.indexOf(g,c)&&(n=!0);n&&this._highlighted&&d===this.getSelectedFeature()&&this._highlighted.setGeometry(c.geometry)},d)})}}});return e("extend-esri")&&(l.PopupBase=h),h})},"dojo/_base/Color":function(){define(["./kernel","./lang","./array","./config"],function(h,k,a,f){var b=h.Color=function(a){a&&this.setColor(a)};b.named={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,
128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],transparent:f.transparentColor||[0,0,0,0]};k.extend(b,{r:255,g:255,b:255,a:1,_set:function(a,b,f,g){this.r=a;this.g=b;this.b=f;this.a=g},setColor:function(a){k.isString(a)?b.fromString(a,this):k.isArray(a)?b.fromArray(a,this):(this._set(a.r,a.g,a.b,a.a),a instanceof b||this.sanitize());return this},sanitize:function(){return this},toRgb:function(){return[this.r,
this.g,this.b]},toRgba:function(){return[this.r,this.g,this.b,this.a]},toHex:function(){return"#"+a.map(["r","g","b"],function(a){a=this[a].toString(16);return 2>a.length?"0"+a:a},this).join("")},toCss:function(a){var b=this.r+", "+this.g+", "+this.b;return(a?"rgba("+b+", "+this.a:"rgb("+b)+")"},toString:function(){return this.toCss(!0)}});b.blendColors=h.blendColors=function(e,f,m,g){var d=g||new b;a.forEach(["r","g","b","a"],function(a){d[a]=e[a]+(f[a]-e[a])*m;"a"!=a&&(d[a]=Math.round(d[a]))});
return d.sanitize()};b.fromRgb=h.colorFromRgb=function(a,f){var e=a.toLowerCase().match(/^rgba?\(([\s\.,0-9]+)\)/);return e&&b.fromArray(e[1].split(/\s*,\s*/),f)};b.fromHex=h.colorFromHex=function(e,f){var l=f||new b,g=4==e.length?4:8,d=(1<<g)-1;e=Number("0x"+e.substr(1));if(isNaN(e))return null;a.forEach(["b","g","r"],function(a){var c=e&d;e>>=g;l[a]=4==g?17*c:c});l.a=1;return l};b.fromArray=h.colorFromArray=function(a,f){var e=f||new b;e._set(Number(a[0]),Number(a[1]),Number(a[2]),Number(a[3]));
isNaN(e.a)&&(e.a=1);return e.sanitize()};b.fromString=h.colorFromString=function(a,f){var e=b.named[a];return e&&b.fromArray(e,f)||b.fromRgb(a,f)||b.fromHex(a,f)};return b})},"esri/graphic":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./domUtils ./lang ./InfoTemplate ./geometry/jsonUtils ./symbols/jsonUtils".split(" "),function(h,k,a,f,b,e,l,m,g){h=h(null,{declaredClass:"esri.Graphic",constructor:function(a,c,b,e){a&&!a.declaredClass?(this.geometry=a.geometry?m.fromJson(a.geometry):
null,this.symbol=a.symbol?g.fromJson(a.symbol):null,this.attributes=a.attributes||null,this.infoTemplate=a.infoTemplate?new l(a.infoTemplate):null):(this.geometry=a,this.symbol=c,this.attributes=b,this.infoTemplate=e)},_shape:null,_graphicsLayer:null,_visible:!0,visible:!0,getDojoShape:function(){return this._shape},getShapes:function(){var a=[];return this._shape&&a.push(this._shape),this._bgShape&&a.push(this._bgShape),a},getNode:function(){var a=this._shape&&this._shape.getNode();return a&&a.nodeType?
a:null},getNodes:function(){var a,c,b=this.getShapes(),g=b.length,e=[];for(c=0;g>c;c++)(a=b[c]&&b[c].getNode())&&a.nodeType&&e.push(a);return e},getLayer:function(){return this._layer},draw:function(){var a=this._graphicsLayer;return a&&a._draw(this,!0),this},setGeometry:function(a){this.geometry=a;a=this._graphicsLayer;return a&&(a._updateExtent(this),a._draw(this,!0)),this},setSymbol:function(a,c){var d=this._graphicsLayer,b=this._shape;return this.symbol=a,d&&(c&&b&&d._removeShape(this),d._draw(this,
!0)),this},setAttributes:function(a){return this.attributes=a,this._clearCache(),this},setInfoTemplate:function(a){return this.infoTemplate=a,this},getInfoTemplate:function(){return this._getEffInfoTemplate()},_getEffInfoTemplate:function(){var a=this.getLayer();return this.infoTemplate||a&&a.infoTemplate},getTitle:function(){var a=this.getInfoTemplate(),c=a&&a.title;if(k.isFunction(c))c=c.call(a,this);else if(k.isString(c))var b=(a=this.getLayer())&&a._getDateOpts,c=e.substitute(this.attributes,
c,{first:!0,dateFormat:b&&b.call(a)});return c},getContent:function(){var a=this.getInfoTemplate(),c=a&&a.content;if(k.isFunction(c))c=c.call(a,this);else if(k.isString(c))var b=(a=this.getLayer())&&a._getDateOpts,c=e.substitute(this.attributes,c,{dateFormat:b&&b.call(a)});return c},attr:function(a,c){var d,b=this.getNodes(),g=b.length;for(d=0;g>d;d++)null==c?b[d].removeAttribute(a):b[d].setAttribute(a,c);return this},show:function(){this.visible=this._visible=!0;var a,c,g;if(this.getShapes().length)for(a=
this.getNodes(),g=a.length,this.attr("data-hidden"),c=0;g>c;c++)b.show(a[c]);else this._graphicsLayer&&this._graphicsLayer._draw(this,!0);return this},hide:function(){this.visible=this._visible=!1;var a,c,g;if(c=this._graphicsLayer)if("canvas-2d"===c.surfaceType)c._removeShape(this);else if(a=this.getNodes(),g=a.length)for(this.attr("data-hidden",""),c=0;g>c;c++)b.hide(a[c]);return this},toJson:function(){var a={};return this.geometry&&(a.geometry=this.geometry.toJson()),this.attributes&&(a.attributes=
k.mixin({},this.attributes)),this.symbol&&(a.symbol=this.symbol.toJson()),this.infoTemplate&&(a.infoTemplate=this.infoTemplate.toJson()),a},_getView:function(a){return(a=(a=a||this.getLayer())&&a.getMap())&&a._getView()},_getDataValue:function(a,c,b,g){var d=this._getCacheItem(a,c);if(void 0===d.value){var e=null,f=this.attributes,n=a.field;c.hasExpr?e=b.executeFunction(c.compiledFunc,b.createExecContext(this,this._getView(g))):k.isFunction(n)?e=n(this,a):f&&(e=f[n],(a=a.normalizationField)&&this._isValidNumber(e)&&
(f=parseFloat(f[a]),this._isValidNumber(f)&&0!==f?e/=f:e=null));this._isValidNumber(e)||(e=null);d.value=e}return d.value},_isValidNumber:function(a){return"number"==typeof a&&!isNaN(a)&&a!==1/0&&a!==-(1/0)},_getCacheItem:function(a,c){var d=this._findCacheItem(a);return d?d.version!==c.version&&(d.version=c.version,d.value=void 0):d=this._createCacheItem(a,c),d},_findCacheItem:function(a){var c,d=this._cache;if(d){var b,g=d.length;for(b=0;g>b;b++){var e=d[b];if(e.variable===a){c=e;break}}}return c},
_createCacheItem:function(a,c){var d=this._cache;d||(d=this._cache=[]);var b={variable:a,version:c.version,value:void 0};return d.push(b),b},_clearCache:function(){this._cache=null}});return h.prototype.getShape=h.prototype.getDojoShape,a("extend-esri")&&(f.Graphic=h),h})},"esri/domUtils":function(){define(["./kernel","dojo/_base/connect","dojo/_base/lang","dojo/dom-style","dojo/has"],function(h,k,a,f,b){var e={show:function(a){(a=e.getNode(a))&&(a.style.display="block")},getNode:function(a){return a&&
a.domNode||a},hide:function(a){(a=e.getNode(a))&&(a.style.display="none")},toggle:function(a){(a=e.getNode(a))&&(a.style.display="none"===a.style.display?"block":"none")},documentBox:8>=b("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight},setScrollable:function(a){if(a=this.getNode(a)){var b=0,g=0,d=0,c=0,e=0,l=0;return[k.connect(a,"ontouchstart",function(f){b=f.touches[0].screenX;g=f.touches[0].screenY;d=a.scrollWidth;
c=a.scrollHeight;e=a.clientWidth;l=a.clientHeight}),k.connect(a,"ontouchmove",function(n){n.preventDefault();var m=a.firstChild;m instanceof Text&&(m=a.childNodes[1]);var q=m._currentX||0,u=m._currentY||0,q=q+(n.touches[0].screenX-b);0<q?q=0:0>q&&Math.abs(q)+e>d&&(q=-1*(d-e));m._currentX=q;u+=n.touches[0].screenY-g;0<u?u=0:0>u&&Math.abs(u)+l>c&&(u=-1*(c-l));m._currentY=u;f.set(m,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+q+"px, "+u+"px)"});b=n.touches[0].screenX;
g=n.touches[0].screenY})]}}};return b("extend-esri")&&a.mixin(h,e),e})},"esri/InfoTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(h,k,a,f,b){h=h(null,{declaredClass:"esri.InfoTemplate",constructor:function(a,b){a&&k.isObject(a)&&!k.isFunction(a)?k.mixin(this,a):(this.title=a||"${*}",this.content=b||"${*}")},setTitle:function(a){return this.title=a,this},setContent:function(a){return this.content=a,this},toJson:function(){return b.fixJson({title:this.title,
content:this.content})}});return a("extend-esri")&&(f.InfoTemplate=h),h})},"esri/geometry/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./Point ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(h,k,a,f,b,e,l,m){var g={fromJson:function(a){return void 0!==a.x&&void 0!==a.y?new f(a):void 0!==a.paths?new b(a):void 0!==a.rings?new e(a):void 0!==a.points?new l(a):void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax?new m(a):void 0},getJsonType:function(a){return a instanceof
f?"esriGeometryPoint":a instanceof b?"esriGeometryPolyline":a instanceof e?"esriGeometryPolygon":a instanceof m?"esriGeometryEnvelope":a instanceof l?"esriGeometryMultipoint":null},getGeometryType:function(a){return"esriGeometryPoint"===a?f:"esriGeometryPolyline"===a?b:"esriGeometryPolygon"===a?e:"esriGeometryEnvelope"===a?m:"esriGeometryMultipoint"===a?l:null}};return k("extend-esri")&&h.mixin(h.getObject("geometry",!0,a),g),g})},"esri/geometry/Polyline":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c){var n={type:"polyline",paths:null};h=h(m,{declaredClass:"esri.geometry.Polyline",constructor:function(d){a.mixin(this,n);this.paths=[];this._path=0;d&&(a.isArray(d)?this.paths=a.isArray(d[0][0])?d:[d]:d.paths?a.mixin(this,d):this.spatialReference=d,this.spatialReference&&(this.spatialReference=c.createSpatialReference(this.spatialReference)));this.verifySR()},addPath:function(c){return this.clearCache(),this._path=this.paths.length,this.paths[this._path]=[],a.isArray(c[0])?
k.forEach(c,this._addPointArr,this):k.forEach(c,this._addPoint,this),this},_addPointArr:function(a){this.paths[this._path].push(a)},_addPoint:function(a){this.paths[this._path].push([a.x,a.y])},_insertPoints:function(a,c){this.clearCache();this._path=c;this.paths[this._path]||(this.paths[this._path]=[]);k.forEach(a,this._addPoint,this)},_validateInputs:function(a,c){return null!==a&&void 0!==a&&(0>a||a>=this.paths.length)?!1:null!==c&&void 0!==a&&(0>c||c>=this.paths[a].length)?!1:!0},getPoint:function(a,
c){return this._validateInputs(a,c)?new g(this.paths[a][c],this.spatialReference):void 0},setPoint:function(a,c,d){return this._validateInputs(a,c)?(this.clearCache(),this.paths[a][c]=[d.x,d.y],this):void 0},insertPoint:function(a,c,d){return this._validateInputs(a)&&e.isDefined(c)&&0<=c&&c<=this.paths[a].length?(this.clearCache(),this.paths[a].splice(c,0,[d.x,d.y]),this):void 0},removePath:function(a){if(this._validateInputs(a,null)){this.clearCache();var c=this.paths.splice(a,1)[0],d=c.length,b=
this.spatialReference;for(a=0;d>a;a++)c[a]=new g(c[a],b);return c}},removePoint:function(a,c){return this._validateInputs(a,c)?(this.clearCache(),new g(this.paths[a].splice(c,1)[0],this.spatialReference)):void 0},getExtent:function(){var a,c=this.getCacheValue("_extent"),b=this.getCacheValue("_partwise");if(c)return a=new d(c),a._partwise=b,a;var g=this.paths,e=g.length;if(e&&g[0].length){var f,n,l,m,h,k,C,D,E,F,G,I,J=m=g[0][0][0],L=h=g[0][0][1],M=Math.min,H=Math.max,K=this.spatialReference,P=[];
for(k=0;e>k;k++){f=g[k];E=F=f[0]&&f[0][0];G=I=f[0]&&f[0][1];D=f.length;for(C=0;D>C;C++)n=f[C],l=n[0],n=n[1],J=M(J,l),L=M(L,n),m=H(m,l),h=H(h,n),E=M(E,l),G=M(G,n),F=H(F,l),I=H(I,n);P.push(new d({xmin:E,ymin:G,xmax:F,ymax:I,spatialReference:K?K.toJson():null}))}return c={xmin:J,ymin:L,xmax:m,ymax:h,spatialReference:K?K.toJson():null},b=1<P.length?P:null,this.setCacheValue("_extent",c),this.setCacheValue("_partwise",b),a=new d(c),a._partwise=b,a}},toJson:function(){var c={paths:a.clone(this.paths)},
d=this.spatialReference;return d&&(c.spatialReference=d.toJson()),c}});return h.defaultProps=n,f("extend-esri")&&(a.setObject("geometry.Polyline",h,b),b.geometry.defaultPolyline=n),h})},"esri/geometry/Extent":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./webMercatorUtils ./mathUtils ../srUtils".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n){var q={type:"extent",xmin:0,ymin:0,xmax:0,ymax:0},t=h(m,{declaredClass:"esri.geometry.Extent",
constructor:function(c,d,b,g,e){a.mixin(this,q);a.isObject(c)?(a.mixin(this,c),this.spatialReference&&(this.spatialReference=n.createSpatialReference(this.spatialReference))):this.update(c,d,b,g,e);this.verifySR()},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-this.ymin)},getCenter:function(){return new g((this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2,this.spatialReference)},centerAt:function(a){var c=this.getCenter(),d=a.x-c.x;a=a.y-c.y;
return new t(this.xmin+d,this.ymin+a,this.xmax+d,this.ymax+a,this.spatialReference)},update:function(a,c,d,b,g){return this.xmin=a,this.ymin=c,this.xmax=d,this.ymax=b,this.spatialReference=g,this.clearCache(),this},offset:function(a,c){return new t(this.xmin+a,this.ymin+c,this.xmax+a,this.ymax+c,this.spatialReference)},expand:function(a){var c=(1-a)/2;a=this.getWidth()*c;c*=this.getHeight();return new t(this.xmin+a,this.ymin+c,this.xmax-a,this.ymax-c,this.spatialReference)},intersects:function(a){if(!a)return!1;
var c=a.type,b=this.spatialReference,g=a.spatialReference;switch(b&&g&&!b.equals(g)&&b._canProject(g)&&(a=b.isWebMercator()?d.geographicToWebMercator(a):d.webMercatorToGeographic(a,!0)),c){case "point":return this.contains(a);case "multipoint":return this._intersectsMultipoint(a);case "extent":return this._intersectsExtent(a);case "polygon":return this._intersectsPolygon(a);case "polyline":return this._intersectsPolyline(a)}},normalize:function(){var c=this._normalize(!1,!0);return a.isArray(c)||
(c=[c]),c},shiftCentralMeridian:function(){return this._normalize(!0)},bisect:function(){var a=this.spatialReference,c=a&&a._getInfo(),d=[],b=0;if(c&&this._isOutOfBounds(c)){var g=this,b=g.xmin,e=g.ymin,f=g.ymax,n=c.valid[0],m=c.valid[1];g.getWidth()>2*m&&(g=g.getCenter(),g=new t(g.x-m,e,g.x+m,f,new l(a.toJson())));var b=g.xmin-b,q=this._normalizeX(g.xmin,c),c=this._normalizeX(g.xmax,c);q.frameId===c.frameId?d.push(new t(q.x,e,c.x,f,new l(a.toJson()))):d.push(new t(q.x,e,m,f,new l(a.toJson())),new t(n,
e,c.x,f,new l(a.toJson())))}else d.push(this.getExtent());return{extents:d,marginLeft:b}},_intersectsMultipoint:function(a){var c,d=a.points.length;for(c=0;d>c;c++)if(this.contains(a.getPoint(c)))return!0;return!1},_intersectsExtent:function(a){var c,d,b,g,e=!1;return this.xmin<=a.xmin?(c=a.xmin,this.xmax<c?e=!0:b=Math.min(this.xmax,a.xmax)-c):(c=this.xmin,a.xmax<c?e=!0:b=Math.min(this.xmax,a.xmax)-c),this.ymin<=a.ymin?(d=a.ymin,this.ymax<d?e=!0:g=Math.min(this.ymax,a.ymax)-d):(d=this.ymin,a.ymax<
d?e=!0:g=Math.min(this.ymax,a.ymax)-d),e?null:new t(c,d,c+b,d+g,this.spatialReference)},_intersectsPolygon:function(a){var c,d,b;c=[this.xmin,this.ymax];b=[this.xmax,this.ymax];var e=[this.xmin,this.ymin],f=[this.xmax,this.ymin],n=[c,b,e,f],e=[[e,c],[c,b],[b,f],[f,e]],f=a.rings,l=f.length,m=new g(0,0,this.spatialReference);b=n.length;for(c=0;b>c;c++)if(m.update(n[c][0],n[c][1]),a.contains(m))return!0;m.setSpatialReference(a.spatialReference);var r,q;for(c=0;l>c;c++)if(d=f[c],b=d.length){if(r=d[0],
m.update(r[0],r[1]),this.contains(m))return!0;for(a=1;b>a;a++){if(q=d[a],m.update(q[0],q[1]),this.contains(m)||this._intersectsLine([r,q],e))return!0;r=q}}return!1},_intersectsPolyline:function(a){var c,d,b,e,f,n=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],l=a.paths,m=l.length,r=new g(0,0,a.spatialReference);for(a=0;m>a;a++)if(d=l[a],b=d.length){if(e=d[0],r.update(e[0],
e[1]),this.contains(r))return!0;for(c=1;b>c;c++){if(f=d[c],r.update(f[0],f[1]),this.contains(r)||this._intersectsLine([e,f],n))return!0;e=f}}return!1},_intersectsLine:function(a,d){var b,g=c._getLineIntersection2,e=d.length;for(b=0;e>b;b++)if(g(a,d[b]))return!0;return!1},contains:function(a){if(!a)return!1;var c=a.type;if("point"===c){var d,c=this.spatialReference,b=a.spatialReference,e=a.x;a=a.y;return c&&b&&!c.equals(b)&&c._canProject(b)&&(d=c.isWebMercator()?g.lngLatToXY(e,a):g.xyToLngLat(e,a,
!0),e=d[0],a=d[1]),e>=this.xmin&&e<=this.xmax&&a>=this.ymin&&a<=this.ymax}return"extent"===c?this._containsExtent(a):!1},_containsExtent:function(a){var c=a.xmin,d=a.ymin,b=a.xmax,e=a.ymax,f=a.spatialReference;a=new g(c,d,f);c=new g(c,e,f);e=new g(b,e,f);d=new g(b,d,f);return this.contains(a)&&this.contains(c)&&this.contains(e)&&this.contains(d)?!0:!1},union:function(a){return new t(Math.min(this.xmin,a.xmin),Math.min(this.ymin,a.ymin),Math.max(this.xmax,a.xmax),Math.max(this.ymax,a.ymax),this.spatialReference)},
getExtent:function(){var a=this.spatialReference;return new t(this.xmin,this.ymin,this.xmax,this.ymax,a&&new l(a.toJson()))},_shiftCM:function(a){var c=this.getCacheValue("_shifted");if(!c){var c=new t(this.toJson()),b=c.spatialReference;if(a=a||b._getInfo()){var g=this._getCM(a);if(g){var f=b._isWebMercator()?d.webMercatorToGeographic(g):g;c.xmin-=g.x;c.xmax-=g.x;b._isWebMercator()||(f.x=this._normalizeX(f.x,a).x);c.setSpatialReference(new l(e.substitute({Central_Meridian:f.x},4326===b.wkid?a.altTemplate:
a.wkTemplate)))}}this.setCacheValue("_shifted",c)}return c},_getCM:function(a){var c;return this._isOutOfBounds(a)&&(c=this.getCenter()),c},_isOutOfBounds:function(a){var c=a.valid[0];a=a.valid[1];var d=this.xmin,b=this.xmax;return!(d>=c&&a>=d&&b>=c&&a>=b)},_normalize:function(a,c,d){var b=new t(this.toJson()),g=b.spatialReference;if(g&&(d=d||g._getInfo())){var e=k.map(this._getParts(d),function(a){return a.extent});return 2<e.length?a?this._shiftCM(d):b.update(d.valid[0],b.ymin,d.valid[1],b.ymax,
g):2===e.length?a?this._shiftCM(d):c?e:{rings:k.map(e,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:g}:e[0]||b}return b},_getParts:function(a){var c=this.getCacheValue("_parts");if(!c){var c=[],d,b,g,e,f=this.xmin,n=this.xmax,l=this.ymin,m=this.ymax,r=this.spatialReference,q=this.getWidth(),h=f,k=n,I=0,J=0;if(a=a||r._getInfo(),b=a.valid[0],g=a.valid[1],d=this._normalizeX(f,a),f=d.x,I=d.frameId,d=this._normalizeX(n,a),n=d.x,J=
d.frameId,e=f===n&&0<q,q>2*g){a=new t(k>h?f:n,l,g,m,r);f=new t(b,l,k>h?n:f,m,r);g=new t(0,l,g,m,r);l=new t(b,l,0,m,r);m=[];r=[];a.contains(g)&&m.push(I);a.contains(l)&&r.push(I);f.contains(g)&&m.push(J);f.contains(l)&&r.push(J);for(b=I+1;J>b;b++)m.push(b),r.push(b);c.push({extent:a,frameIds:[I]},{extent:f,frameIds:[J]},{extent:g,frameIds:m},{extent:l,frameIds:r})}else f>n||e?c.push({extent:new t(f,l,g,m,r),frameIds:[I]},{extent:new t(b,l,n,m,r),frameIds:[J]}):c.push({extent:new t(f,l,n,m,r),frameIds:[I]});
this.setCacheValue("_parts",c)}return c},_normalizeX:function(a,c){var d,b=0,g=c.valid[0],e=c.valid[1],f=2*e;return a>e?(d=Math.ceil(Math.abs(a-e)/f),a-=d*f,b=d):g>a&&(d=Math.ceil(Math.abs(a-g)/f),a+=d*f,b=-d),{x:a,frameId:b}},toJson:function(){var a={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax},c=this.spatialReference;return c&&(a.spatialReference=c.toJson()),a}});return t.defaultProps=q,f("extend-esri")&&(a.setObject("geometry.Extent",t,b),b.geometry.defaultExtent=q),t})},"esri/geometry/webMercatorUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point".split(" "),
function(h,k,a,f,b,e){function l(a,c,g,e){if("point"===a.type){var d=c(a.x,a.y,e);return new a.constructor(d[0],d[1],new b(g))}if("extent"===a.type){var d=c(a.xmin,a.ymin,e),f=c(a.xmax,a.ymax,e);return new a.constructor(d[0],d[1],f[0],f[1],new b(g))}if("polyline"===a.type||"polygon"===a.type){var n,d="polyline"===a.type,l=[];return h.forEach(d?a.paths:a.rings,function(a){l.push(n=[]);h.forEach(a,function(a){n.push(c(a[0],a[1],e))})}),d?new a.constructor({paths:l,spatialReference:new b(g)}):new a.constructor({rings:l,
spatialReference:new b(g)})}if("multipoint"===a.type){var m=[];return h.forEach(a.points,function(a){m.push(c(a[0],a[1],e))}),new a.constructor({points:m,spatialReference:new b(g)})}}function m(a,c){var d=a&&(null!=a.wkid?a:a.spatialReference),b=c&&(null!=c.wkid?c:c.spatialReference);return d&&b?b.equals(d)?!0:b._canProject(d):!1}var g={canProject:m,project:function(a,c){var d=a&&a.spatialReference,b=c&&(null!=c.wkid?c:c.spatialReference);return d&&b?d.equals(b)?a=new a.constructor(a.toJson()):m(d,
b)?b.isWebMercator()?a=l(a,e.lngLatToXY,{wkid:102100}):4326===b.wkid&&(a=l(a,e.xyToLngLat,{wkid:4326})):a=null:a=null,a},lngLatToXY:e.lngLatToXY,xyToLngLat:e.xyToLngLat,geographicToWebMercator:function(a){return l(a,e.lngLatToXY,{wkid:102100})},webMercatorToGeographic:function(a,c){return l(a,e.xyToLngLat,{wkid:4326},c)}};return a("extend-esri")&&k.mixin(k.getObject("geometry",!0,f),g),g})},"esri/geometry/mathUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","./Point"],function(h,
k,a,f){function b(a,d,c){return a instanceof f?new f(a.x+c*(d.x-a.x),a.y+c*(d.y-a.y)):[a[0]+c*(d[0]-a[0]),a[1]+c*(d[1]-a[1])]}function e(a,d){return 1E-8>Math.abs(a-d)}function l(a,d,c,b){var g,f,n=e(a[0],d[0])?1E10:(a[1]-d[1])/(a[0]-d[0]),l=e(c[0],b[0])?1E10:(c[1]-b[1])/(c[0]-b[0]),m=a[1]-n*a[0],h=c[1]-l*c[0];if(e(n,l)){if(e(m,h)){if(e(a[0],d[0])){if(!(Math.min(a[1],d[1])<Math.max(c[1],b[1])||Math.max(a[1],d[1])>Math.min(c[1],b[1])))return null;f=(a[1]+d[1]+c[1]+b[1]-Math.min(a[1],d[1],c[1],b[1])-
Math.max(a[1],d[1],c[1],b[1]))/2;g=(f-m)/n}else{if(!(Math.min(a[0],d[0])<Math.max(c[0],b[0])||Math.max(a[0],d[0])>Math.min(c[0],b[0])))return null;g=(a[0]+d[0]+c[0]+b[0]-Math.min(a[0],d[0],c[0],b[0])-Math.max(a[0],d[0],c[0],b[0]))/2;f=n*g+m}return[g,f]}return null}return e(n,1E10)?(g=a[0],f=l*g+h):e(l,1E10)?(g=c[0],f=n*g+m):(g=-(m-h)/(n-l),f=a[1]===d[1]?a[1]:c[1]===b[1]?c[1]:n*g+m),[g,f]}var m={getLength:function(a,d){var c=d.x-a.x,b=d.y-a.y;return Math.sqrt(c*c+b*b)},_getLength:function(a,d){var c=
d[0]-a[0],b=d[1]-a[1];return Math.sqrt(c*c+b*b)},getPointOnLine:b,getMidpoint:function(a,d){return b(a,d,.5)},_equals:e,_getLineIntersection:l,getLineIntersection:function(a,d,c,b,e){a=l([a.x,a.y],[d.x,d.y],[c.x,c.y],[b.x,b.y]);return a&&(a=new f(a[0],a[1],e)),a},_getLineIntersection2:function(a,d){var c,b,g,e,f=a[0],l=a[1],m=d[0],h=d[1],k=f[0],f=f[1],y=l[0],l=l[1],A=m[0],z=m[1],m=h[0]-A,A=k-A,B=y-k,h=h[1]-z,z=f-z,C=l-f,D=h*B-m*C;return 0===D?!1:(c=(m*z-h*A)/D,b=(B*z-C*A)/D,0<=c&&1>=c&&0<=b&&1>=b?
(g=k+c*(y-k),e=f+c*(l-f),[g,e]):!1)},_pointLineDistance:function(a,d){var c=d[0],b=d[1],g=c[0],e=c[1],c=a[0],f=a[1],l=b[0]-g,m=b[1]-e,h=c-g,k=f-e,b=Math.sqrt,y=Math.pow,A=b(y(l,2)+y(m,2)),h=(h*l+k*m)/(A*A),e=e+h*m;return b(y(c-(g+h*l),2)+y(f-e,2))}};return k("extend-esri")&&h.mixin(h.getObject("geometry",!0,a),m),m})},"esri/geometry/Polygon":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ./mathUtils ../srUtils".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n){var q={type:"polygon",rings:null},t=h(m,{declaredClass:"esri.geometry.Polygon",constructor:function(c){a.mixin(this,q);this.rings=[];this._ring=0;c&&(a.isArray(c)?this.rings=a.isArray(c[0][0])?c:[c]:c.rings?a.mixin(this,c):this.spatialReference=c,this.spatialReference&&(this.spatialReference=n.createSpatialReference(this.spatialReference)));this.verifySR()},addRing:function(c){return this.clearCache(),this._ring=this.rings.length,this.rings[this._ring]=[],a.isArray(c[0])?
k.forEach(c,this._addPointArr,this):k.forEach(c,this._addPoint,this),this},_addPointArr:function(a){this.rings[this._ring].push(a)},_addPoint:function(a){this.rings[this._ring].push([a.x,a.y])},_insertPoints:function(a,c){this.clearCache();this._ring=c;this.rings[this._ring]||(this.rings[this._ring]=[]);k.forEach(a,this._addPoint,this)},_validateInputs:function(a,c){return null!==a&&void 0!==a&&(0>a||a>=this.rings.length)?!1:null!==c&&void 0!==a&&(0>c||c>=this.rings[a].length)?!1:!0},getPoint:function(a,
c){return this._validateInputs(a,c)?new g(this.rings[a][c],this.spatialReference):void 0},setPoint:function(a,c,d){return this._validateInputs(a,c)?(this.clearCache(),this.rings[a][c]=[d.x,d.y],this):void 0},insertPoint:function(a,c,d){return this._validateInputs(a)&&e.isDefined(c)&&0<=c&&c<=this.rings[a].length?(this.clearCache(),this.rings[a].splice(c,0,[d.x,d.y]),this):void 0},removeRing:function(a){if(this._validateInputs(a,null)){this.clearCache();var c=this.rings.splice(a,1)[0],d=c.length,b=
this.spatialReference;for(a=0;d>a;a++)c[a]=new g(c[a],b);return c}},removePoint:function(a,c){return this._validateInputs(a,c)?(this.clearCache(),new g(this.rings[a].splice(c,1)[0],this.spatialReference)):void 0},getExtent:function(){var a,c=this.getCacheValue("_extent"),b=this.getCacheValue("_partwise");if(c)return a=new d(c),a._partwise=b,a;var g=this.rings,e=g.length;if(e&&g[0].length){var f,n,l,m,q,t,h,k,G,I,J,L,M=m=g[0][0][0],H=q=g[0][0][1],K=Math.min,P=Math.max,O=this.spatialReference,S=[];
for(t=0;e>t;t++){f=g[t];G=I=f[0]&&f[0][0];J=L=f[0]&&f[0][1];k=f.length;for(h=0;k>h;h++)n=f[h],l=n[0],n=n[1],M=K(M,l),H=K(H,n),m=P(m,l),q=P(q,n),G=K(G,l),J=K(J,n),I=P(I,l),L=P(L,n);S.push(new d({xmin:G,ymin:J,xmax:I,ymax:L,spatialReference:O?O.toJson():null}))}return c={xmin:M,ymin:H,xmax:m,ymax:q,spatialReference:O?O.toJson():null},b=1<S.length?S:null,this.setCacheValue("_extent",c),this.setCacheValue("_partwise",b),a=new d(c),a._partwise=b,a}},contains:function(a){var c,d,b,e,f,n,l,m=this.rings,
r=!1,q=m.length;d=this.spatialReference;b=a.spatialReference;var t=a.x;a=a.y;d&&b&&!d.equals(b)&&d._canProject(b)&&(c=d.isWebMercator()?g.lngLatToXY(t,a):g.xyToLngLat(t,a,!0),t=c[0],a=c[1]);for(l=0;q>l;l++)for(c=m[l],e=c.length,n=f=0;e>n;n++)f++,f===e&&(f=0),d=c[n],b=c[f],(d[1]<a&&b[1]>=a||b[1]<a&&d[1]>=a)&&d[0]+(a-d[1])/(b[1]-d[1])*(b[0]-d[0])<t&&(r=!r);return r},getCentroid:function(){var a=this.getCacheValue("_centroid");if(void 0!==a)return a;var c,d,b,e,f,n,l=this.rings,m=[],q=1/0,t=-(1/0),h=
1/0,F=-(1/0);(k.forEach(l,function(a){c=d=b=0;k.forEach(a,function(g,e){e<a.length-1&&(f=a[e+1],n=g[0]*f[1]-f[0]*g[1],c+=(g[0]+f[0])*n,d+=(g[1]+f[1])*n,b+=n,g[0]<q&&(q=g[0]),g[0]>t&&(t=g[0]),g[1]<h&&(h=g[1]),g[1]>F&&(F=g[1]))});0<b&&(b*=-1);b&&m.push([c,d,b/2])}),m.sort(function(a,c){return a[2]-c[2]}),c=d=void 0,m[0]&&(e=6*m[0][2],c=m[0][0]/e,d=m[0][1]/e,(q>c||c>t||h>d||d>F)&&(c=d=void 0)),void 0===c||void 0===d)&&(e=l[0]&&l[0].length?this._getLineCentroid(l[0]):null)&&(c=e.x,d=e.y);return a=isNaN(c)||
isNaN(d)?null:new g(c,d,this.spatialReference),this.setCacheValue("_centroid",a),a},_getLineCentroid:function(a){var d,b,g,e,f,n,l=0,m=0,q=0,r={x:0,y:0},t={x:0,y:0},h=a.length;for(e=0;h-1>e;e++)b=a[e],g=a[e+1],b&&g&&(r.x=b[0],r.y=b[1],t.x=g[0],t.y=g[1],d=c.getLength(r,t),0<d&&(l+=d,f=c.getMidpoint(b,g),m+=d*f[0],q+=d*f[1]));return 0<l?n={x:m/l,y:q/l}:a[0]&&(n={x:a[0][0],y:a[0][1]}),n},isClockwise:function(c){var d,b=0,g=c.length,e=a.isArray(c[0])?function(a,c){return a[0]*c[1]-c[0]*a[1]}:function(a,
c){return a.x*c.y-c.x*a.y};for(d=0;g>d;d++)b+=e(c[d],c[(d+1)%g]);return 0>=b/2},isSelfIntersecting:function(a){a=a||this;var d,b,g,e,f,n,l,m,q=a.rings.length;for(g=0;q>g;g++){for(d=0;d<a.rings[g].length-1;d++)for(f=[[a.rings[g][d][0],a.rings[g][d][1]],[a.rings[g][d+1][0],a.rings[g][d+1][1]]],b=g+1;q>b;b++)for(e=0;e<a.rings[b].length-1;e++)if(n=[[a.rings[b][e][0],a.rings[b][e][1]],[a.rings[b][e+1][0],a.rings[b][e+1][1]]],l=c._getLineIntersection2(f,n),l&&!(l[0]===f[0][0]&&l[1]===f[0][1]||l[0]===n[0][0]&&
l[1]===n[0][1]||l[0]===f[1][0]&&l[1]===f[1][1]||l[0]===n[1][0]&&l[1]===n[1][1]))return!0;if(m=a.rings[g].length,!(4>=m))for(d=0;m-3>d;d++)for(e=m-1,0===d&&(e=m-2),f=[[a.rings[g][d][0],a.rings[g][d][1]],[a.rings[g][d+1][0],a.rings[g][d+1][1]]],b=d+2;e>b;b++)if(n=[[a.rings[g][b][0],a.rings[g][b][1]],[a.rings[g][b+1][0],a.rings[g][b+1][1]]],l=c._getLineIntersection2(f,n),l&&!(l[0]===f[0][0]&&l[1]===f[0][1]||l[0]===n[0][0]&&l[1]===n[0][1]||l[0]===f[1][0]&&l[1]===f[1][1]||l[0]===n[1][0]&&l[1]===n[1][1]))return!0}return!1},
toJson:function(){var c={rings:a.clone(this.rings)},d=this.spatialReference;return d&&(c.spatialReference=d.toJson()),c}});return t.defaultProps=q,t.createEllipse=function(a){var c,d,b,g=a.center.x,e=a.center.y,f=a.longAxis,n=a.shortAxis,l=a.numberOfPoints,m=a.map,q=[],r=2*Math.PI/l;for(a=0;l>a;a++)c=Math.cos(a*r),d=Math.sin(a*r),c=m.toMap({x:f*c+g,y:n*d+e}),q.push(c);return q.push(q[0]),b=new t(m.spatialReference),b.addRing(q),b},t.createCircle=function(a){return t.createEllipse({center:a.center,
longAxis:a.r,shortAxis:a.r,numberOfPoints:a.numberOfPoints,map:a.map})},t.fromExtent=function(a){var c=a.normalize();a=a.spatialReference;return new t({rings:k.map(c,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:a?a.toJson():null})},f("extend-esri")&&(a.setObject("geometry.Polygon",t,b),b.geometry.defaultPolygon=q,b.geometry.createEllipse=t.createEllipse,b.geometry.createCircle=t.createCircle,b.geometry.isClockwise=t.prototype.isClockwise,
b.geometry.polygonSelfIntersecting=t.prototype.isSelfIntersecting),t})},"esri/geometry/Multipoint":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(h,k,a,f,b,e,l,m,g){var d={type:"multipoint",points:null};h=h(e,{declaredClass:"esri.geometry.Multipoint",constructor:function(a){k.mixin(this,d);this.points=[];a&&(a.points?k.mixin(this,a):this.spatialReference=a,this.spatialReference&&(this.spatialReference=
g.createSpatialReference(this.spatialReference)));this.verifySR()},addPoint:function(a){return this.clearCache(),k.isArray(a)?this.points.push(a):this.points.push([a.x,a.y]),this},removePoint:function(a){return this._validateInputs(a)?(this.clearCache(),new l(this.points.splice(a,1)[0],this.spatialReference)):void 0},getExtent:function(){var a=this.getCacheValue("_extent");if(a)return new m(a);var d=this.points,b=d.length;if(b){var g,e,f,l,h;l=d[0];var k=g=l[0],y=e=l[1],A=Math.min,z=Math.max,B=this.spatialReference;
for(h=0;b>h;h++)l=d[h],f=l[0],l=l[1],k=A(k,f),y=A(y,l),g=z(g,f),e=z(e,l);return a={xmin:k,ymin:y,xmax:g,ymax:e,spatialReference:B?B.toJson():null},this.setCacheValue("_extent",a),new m(a)}},_validateInputs:function(a){return null===a||0>a||a>=this.points.length?!1:!0},getPoint:function(a){if(this._validateInputs(a))return a=this.points[a],new l(a[0],a[1],this.spatialReference)},setPoint:function(a,d){return this._validateInputs(a)?(this.clearCache(),this.points[a]=[d.x,d.y],this):void 0},toJson:function(){var a=
{points:k.clone(this.points)},d=this.spatialReference;return d&&(a.spatialReference=d.toJson()),a}});return h.defaultProps=d,a("extend-esri")&&(k.setObject("geometry.Multipoint",h,f),f.geometry.defaultMultipoint=d),h})},"esri/symbols/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./SimpleMarkerSymbol ./PictureMarkerSymbol ./SimpleLineSymbol ./CartographicLineSymbol ./SimpleFillSymbol ./PictureFillSymbol ./TextSymbol".split(" "),function(h,k,a,f,b,e,l,m,g,d){var c={fromJson:function(a){var c=
null;switch(a.type){case "esriSMS":c=new f(a);break;case "esriPMS":c=new b(a);break;case "esriTS":c=new d(a);break;case "esriSLS":c=void 0!==a.cap?new l(a):new e(a);break;case "esriCLS":c=new l(a);break;case "esriSFS":c=new m(a);break;case "esriPFS":c=new g(a)}return c},getShapeDescriptors:function(a){return a&&a.getShapeDescriptors?a.getShapeDescriptors():{defaultShape:null,fill:null,stroke:null}}};return k("extend-esri")&&h.mixin(h.getObject("symbol",!0,a),c),c})},"esri/symbols/SimpleMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./MarkerSymbol ./SimpleLineSymbol".split(" "),
function(h,k,a,f,b,e,l,m,g){var d={STYLE_CIRCLE:"circle",STYLE_SQUARE:"square",STYLE_CROSS:"cross",STYLE_X:"x",STYLE_DIAMOND:"diamond",STYLE_PATH:"path",STYLE_TARGET:"target"},c={style:d.STYLE_CIRCLE,color:[255,255,255,.25],size:12,angle:0,xoffset:0,yoffset:0};h=h(m,{declaredClass:"esri.symbol.SimpleMarkerSymbol",type:"simplemarkersymbol",_styles:{circle:"esriSMSCircle",square:"esriSMSSquare",cross:"esriSMSCross",x:"esriSMSX",diamond:"esriSMSDiamond",path:"esriSMSPath"},constructor:function(e,f,m,
r){e?k.isString(e)?(this.style=e,f&&(this.size=f),m&&(this.outline=m),r&&(this.color=r)):(this.style=l.valueOf(this._styles,this.style),e.outline&&(this.outline=new g(e.outline))):(k.mixin(this,c),this.size=b.pt2px(this.size),this.outline=new g(this.outline),this.color=new a(this.color));this.style||(this.style=d.STYLE_CIRCLE)},setStyle:function(a){return this.style=a,this},setPath:function(a){return this.path=a,this.setStyle(d.STYLE_PATH),this},setOutline:function(a){return this.outline=a,this},
getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return this.color},_setDim:function(a,c,d){this._targetWidth=a;this._targetHeight=c;this._spikeSize=d},getShapeDescriptors:function(){var a,g,e,f=this.style,l=(this.size||b.pt2px(c.size))/2,m=0-l,h=0+l,k=0-l,y=0+l;switch(f){case d.STYLE_CIRCLE:a={type:"circle",cx:0,cy:0,r:l};g=this.getFill();(e=this.getStroke())&&(e.style=e.style||"Solid");break;case d.STYLE_CROSS:a={type:"path",path:"M "+m+",0 L "+h+",0 M 0,"+
k+" L 0,"+y+" E"};g=null;e=this.getStroke();break;case d.STYLE_DIAMOND:a={type:"path",path:"M "+m+",0 L 0,"+k+" L "+h+",0 L 0,"+y+" L "+m+",0 Z"};g=this.getFill();e=this.getStroke();break;case d.STYLE_SQUARE:a={type:"path",path:"M "+m+","+y+" L "+m+","+k+" L "+h+","+k+" L "+h+","+y+" L "+m+","+y+" Z"};g=this.getFill();e=this.getStroke();break;case d.STYLE_X:a={type:"path",path:"M "+m+","+y+" L "+h+","+k+" M "+m+","+k+" L "+h+","+y+" E"};g=null;e=this.getStroke();break;case d.STYLE_PATH:a={type:"path",
path:this.path||""},g=this.getFill(),e=this.getStroke()}return{defaultShape:a,fill:g,stroke:e}},toJson:function(){var a=this.style,c=this.outline,d=k.mixin(this.inherited("toJson",arguments),{type:"esriSMS",style:this._styles[a]});return c&&(d.outline=c.toJson()),("x"===a||"cross"===a)&&delete d.color,d.path=this.path,l.fixJson(d)}});return k.mixin(h,d),h.defaultProps=c,f("extend-esri")&&(k.setObject("symbol.SimpleMarkerSymbol",h,e),e.symbol.defaultSimpleMarkerSymbol=c),h})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),
function(h,k,a,f,b,e,l,m,g){var d=k.getObject("dojox.gfx",!0),c=d._base={};d._hasClass=function(a,c){var d=a.getAttribute("className");return d&&0<=(" "+d+" ").indexOf(" "+c+" ")};d._addClass=function(a,c){var d=a.getAttribute("className")||"";(!d||0>(" "+d+" ").indexOf(" "+c+" "))&&a.setAttribute("className",d+(d?" ":"")+c)};d._removeClass=function(a,c){var d=a.getAttribute("className");d&&a.setAttribute("className",d.replace(new RegExp("(^|\\s+)"+c+"(\\s+|$)"),"$1$2"))};c._getFontMeasurements=function(){var a=
{"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},c,d;f("ie")&&(d=b.doc.documentElement.style.fontSize||"",d||(b.doc.documentElement.style.fontSize="100%"));var g=m.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},b.body());for(c in a)g.style.fontSize=c,a[c]=16*Math.round(12*g.offsetHeight/16)/12/1E3;
f("ie")&&(b.doc.documentElement.style.fontSize=d);b.body().removeChild(g);return a};var n=null;c._getCachedFontMeasurements=function(a){if(a||!n)n=c._getFontMeasurements();return n};var q=null,t={};c._getTextBox=function(a,c,d){var e,f,n=arguments.length,l;q||(q=m.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},b.body()));e=q;e.className="";f=e.style;f.borderWidth="0";f.margin="0";f.padding="0";f.outline="0";if(1<n&&c)for(l in c)l in t||(f[l]=c[l]);2<n&&d&&(e.className=
d);e.innerHTML=a;e.getBoundingClientRect?(f=e.getBoundingClientRect(),f={l:f.left,t:f.top,w:f.width||f.right-f.left,h:f.height||f.bottom-f.top}):f=g.getMarginBox(e);e.innerHTML="";return f};c._computeTextLocation=function(a,c,d,b){var g={};switch(a.align){case "end":g.x=a.x-c;break;case "middle":g.x=a.x-c/2;break;default:g.x=a.x}g.y=a.y-d*(b?.75:1);return g};c._computeTextBoundingBox=function(a){if(!d._base._isRendered(a))return{x:0,y:0,width:0,height:0};var b;b=a.getShape();var g=a.getFont()||d.defaultFont;
a=a.getTextWidth();g=d.normalizedLength(g.size);b=c._computeTextLocation(b,a,g,!0);return{x:b.x,y:b.y,width:a,height:g}};c._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var r=0;c._getUniqueId=function(){var a;do a=h._scopeName+"xUnique"+ ++r;while(l.byId(a));return a};var v=f("pointer-events")?"touchAction":f("MSPointer")?"msTouchAction":null;c._fixMsTouchAction=v?function(a){a.rawNode.style[v]="none"}:function(){};k.mixin(d,{defaultPath:{type:"path",path:""},
defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},
defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a=
{};return function(c){var b=a[c];if(b)return new b;b=a[c]=new Function;b.prototype=d["default"+c];return new b}}(),normalizeColor:function(c){return c instanceof a?c:new a(c)},normalizeParameters:function(a,c){var d;if(c){var b={};for(d in a)d in c&&!(d in b)&&(a[d]=c[d])}return a},makeParameters:function(a,c){var d=null;if(!c)return k.delegate(a);var b={};for(d in a)d in b||(b[d]=k.clone(d in c?c[d]:a[d]));return b},formatNumber:function(a,c){var d=a.toString();if(0<=d.indexOf("e"))d=a.toFixed(4);
else{var b=d.indexOf(".");0<=b&&5<d.length-b&&(d=a.toFixed(4))}return 0>a?d:c?" "+d:d},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var c=d.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){c.style=a[0];c.variant=a[1];c.weight=a[2];var b=a[3].indexOf("/");c.size=0>b?a[3]:a[3].substring(0,b);var g=4;0>b&&("/"==a[4]?g=6:"/"==a[4].charAt(0)&&(g=5));g<a.length&&(c.family=a.slice(g).join(" "))}return c},cm_in_pt:72/2.54,mm_in_pt:7.2/
2.54,px_in_pt:function(){return d._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(a){return a*d.px_in_pt()},px2pt:function(a){return a/d.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var c=d.px_in_pt(),b=parseFloat(a);switch(a.slice(-2)){case "px":return b;case "pt":return b*c;case "in":return 72*b*c;case "pc":return 12*b*c;case "mm":return b*d.mm_in_pt*c;case "cm":return b*d.cm_in_pt*c}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,
pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(a,c){return a&&c&&a===c},switchTo:function(a){var c="string"==typeof a?d[a]:a;c&&(e.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath EsriPath Surface createSurface fixTarget".split(" "),function(a){d[a]=c[a]}),"string"==typeof a?d.renderer=a:e.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return d.renderer=d[a]&&d[a].Surface===d.Surface?a:null}))}});return d})},
"esri/symbols/MarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),function(h,k,a,f,b,e){h=h(e,{declaredClass:"esri.symbol.MarkerSymbol",angle:0,xoffset:0,yoffset:0,size:12,constructor:function(a){a&&k.isObject(a)&&(this.size="auto"===this.size?this.size:f.pt2px(this.size),this.xoffset=f.pt2px(this.xoffset),this.yoffset=f.pt2px(this.yoffset),this.angle&&(this.angle*=-1))},setAngle:function(a){return this.angle=a,this},setSize:function(a){return this.size=
a,this},setOffset:function(a,b){return this.xoffset=a,this.yoffset=b,this},toJson:function(){var a=f.px2pt(this.size),a=isNaN(a)?void 0:a,b=f.px2pt(this.xoffset),b=isNaN(b)?void 0:b,g=f.px2pt(this.yoffset);return g=isNaN(g)?void 0:g,k.mixin(this.inherited("toJson",arguments),{size:"auto"===this.size?this.size:a,angle:this.angle&&-1*this.angle,xoffset:b,yoffset:g})}});return a("extend-esri")&&k.setObject("symbol.MarkerSymbol",h,b),h})},"esri/symbols/Symbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../Color".split(" "),
function(h,k,a,f,b,e){h=h(null,{declaredClass:"esri.symbol.Symbol",color:new e([0,0,0,1]),type:null,constructor:function(a){a&&k.isObject(a)&&(k.mixin(this,a),this.color&&b.isDefined(this.color[0])&&(this.color=e.toDojoColor(this.color)),(a=this.type)&&0===a.indexOf("esri")&&(this.type={esriSMS:"simplemarkersymbol",esriPMS:"picturemarkersymbol",esriSLS:"simplelinesymbol",esriCLS:"cartographiclinesymbol",esriSFS:"simplefillsymbol",esriPFS:"picturefillsymbol",esriTS:"textsymbol",esriSHD:"shieldlabelsymbol"}[a]))},
setColor:function(a){return this.color=a,this},toJson:function(){return{color:e.toJsonColor(this.color)}}});return a("extend-esri")&&k.setObject("symbol.Symbol",h,f),h})},"esri/Color":function(){define(["dojo/_base/declare","dojo/_base/Color","dojo/has","./kernel"],function(h,k,a,f){h=h([k],{declaredClass:"esri.Color"});h.toJsonColor=function(a){return a&&[a.r,a.g,a.b,1<a.a?a.a:Math.round(255*a.a)]};h.toDojoColor=function(a){return a&&new k([a[0],a[1],a[2],a[3]/255])};var b,e="named blendColors fromRgb fromHex fromArray fromString".split(" ");
for(b=0;b<e.length;b++)h[e[b]]=k[e[b]];return a("extend-esri")&&(f.Color=h),h})},"esri/symbols/SimpleLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./LineSymbol".split(" "),function(h,k,a,f,b,e,l,m){var g={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",
STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot"},d={color:[0,0,0,1],style:g.STYLE_SOLID,width:1};h=h(m,{declaredClass:"esri.symbol.SimpleLineSymbol",type:"simplelinesymbol",_styles:{solid:"esriSLSSolid",dash:"esriSLSDash",dot:"esriSLSDot",dashdot:"esriSLSDashDot",longdashdotdot:"esriSLSDashDotDot",none:"esriSLSNull",insideframe:"esriSLSInsideFrame",shortdash:"esriSLSShortDash",shortdot:"esriSLSShortDot",shortdashdot:"esriSLSShortDashDot",shortdashdotdot:"esriSLSShortDashDotDot",
longdash:"esriSLSLongDash",longdashdot:"esriSLSLongDashDot"},constructor:function(c,e,f){c?k.isString(c)?(this.style=c,e&&(this.color=e),f&&(this.width=f)):this.style=l.valueOf(this._styles,c.style)||g.STYLE_SOLID:(k.mixin(this,d),this.color=new a(this.color),this.width=b.pt2px(this.width))},setStyle:function(a){return this.style=a,this},getStroke:function(){return this.style===g.STYLE_NULL||0===this.width?null:{color:this.color,style:this.style,width:this.width}},getFill:function(){return null},
getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){return l.fixJson(k.mixin(this.inherited("toJson",arguments),{type:"esriSLS",style:this._styles[this.style]}))}});return k.mixin(h,g),h.defaultProps=d,f("extend-esri")&&(k.setObject("symbol.SimpleLineSymbol",h,e),e.symbol.defaultSimpleLineSymbol=d),h})},"esri/symbols/LineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),
function(h,k,a,f,b,e){h=h(e,{declaredClass:"esri.symbol.LineSymbol",constructor:function(a){k.isObject(a)?this.width=f.pt2px(this.width):this.width=12},setWidth:function(a){return this.width=a,this},toJson:function(){var a=f.px2pt(this.width);return a=isNaN(a)?void 0:a,k.mixin(this.inherited("toJson",arguments),{width:a})}});return a("extend-esri")&&k.setObject("symbol.LineSymbol",h,b),h})},"esri/symbols/PictureMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol".split(" "),
function(h,k,a,f,b,e,l,m){var g={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};h=h(m,{declaredClass:"esri.symbol.PictureMarkerSymbol",type:"picturemarkersymbol",constructor:function(d,c,b){d?k.isString(d)?(this.url=d,c&&(this.width=c),b&&(this.height=b)):(this.width=f.pt2px(d.width),this.height=f.pt2px(d.height),c=d.imageData,9>a("ie")||!c||(b=this.url,this.url="data:"+(d.contentType||"image")+";base64,"+c,this.imageData=b)):(k.mixin(this,g),this.width=f.pt2px(this.width),this.height=f.pt2px(this.height))},
getStroke:function(){return null},getFill:function(){return null},setWidth:function(a){return this.width=a,this},setHeight:function(a){return this.height=a,this},setUrl:function(a){return a!==this.url&&(delete this.imageData,delete this.contentType),this.url=a,this},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var a=this.url,c=
this.imageData;if(0===a.indexOf("data:"))var b=a,a=c,c=b.indexOf(";base64,")+8,c=b.substr(c);!k.isString(a)||0!==a.indexOf("/")&&0!==a.indexOf("//")&&0!==a.indexOf("./")&&0!==a.indexOf("../")||(a=l.getAbsoluteUrl(a));var b=f.px2pt(this.width),b=isNaN(b)?void 0:b,g=f.px2pt(this.height),g=isNaN(g)?void 0:g,a=e.fixJson(k.mixin(this.inherited("toJson",arguments),{type:"esriPMS",url:a,imageData:c,contentType:this.contentType,width:b,height:g}));return delete a.color,delete a.size,a.imageData||delete a.imageData,
a}});return h.defaultProps=g,a("extend-esri")&&(k.setObject("symbol.PictureMarkerSymbol",h,b),b.symbol.defaultPictureMarkerSymbol=g),h})},"esri/urlUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/url dojo/io-query ./kernel ./lang ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),function(h,k,a,f,b,e,l,m,g){var d=function(){return this}(),c={},n=l.defaults.io,q=/^[a-z][a-z0-9\+\-\.]*:/i,t=/^\s*http:/i;return c.isHTTP=function(a){var c=d.location.protocol;return null==a?"http:"===
c||"https:"===c:a?"https:"===c:"http:"===c},c.getProtocolForWebResource=function(a){return c.isHTTP()?d.location.protocol:a?"https:":"http:"},c.urlToObject=function(c){var d={},b=new a(c),g=c.indexOf("?");return null===b.query?d={path:c,query:null}:(d.path=c.substring(0,g),d.query=f.queryToObject(b.query)),b.fragment&&(d.hash=b.fragment,null===b.query&&(d.path=d.path.substring(0,d.path.length-(b.fragment.length+1)))),d},c.getProxyUrl=function(a,b){var e,f,l,m,q=h.isString(a)?0===h.trim(a).toLowerCase().indexOf("https:"):
a,r=n.proxyUrl,t=g.io.proxyNotSet;if(h.isString(a)&&(m=c.getProxyRule(a),m&&(r=m.proxyUrl)),!r)throw Error(t);return q&&!1!==b&&0!==d.location.href.toLowerCase().indexOf("https:")&&(f=r,0!==f.toLowerCase().indexOf("http")&&(f=c.getAbsoluteUrl(f)),f=f.replace(/^http:/i,"https:"),c.canUseXhr(f)&&(r=f,l=1)),e=c.urlToObject(r),e._xo=l,e},c.addProxy=function(a){var d,b,g,e=c.getProxyRule(a);return e?d=c.urlToObject(e.proxyUrl):n.alwaysUseProxy&&(d=c.getProxyUrl()),d&&(b=c.urlToObject(a),a=d.path+"?"+b.path,
g=f.objectToQuery(h.mixin(d.query||{},b.query)),g&&(a+="?"+g)),a},c.addProxyRule=function(a){var d,b,g=a.urlPrefix=c.urlToObject(a.urlPrefix).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//gi,"").toLowerCase(),e=n.proxyRules,f=e.length,l=f;for(d=0;f>d;d++){if(b=e[d].urlPrefix,0===g.indexOf(b)){if(g.length===b)return-1;l=d;break}0===b.indexOf(g)&&(l=d+1)}return e.splice(l,0,a),l},c.getProxyRule=function(a){var d,b=n.proxyRules,g=b.length,e=c.urlToObject(a).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//gi,
"").toLowerCase();for(a=0;g>a;a++)if(0===e.indexOf(b[a].urlPrefix)){d=b[a];break}return d},c.hasSameOrigin=function(c,b,g){c=c.toLowerCase();b=b.toLowerCase();var e=d.location.href.toLowerCase();return c=0===c.indexOf("http")?new a(c):e=new a(e),b=0===b.indexOf("http")?new a(b):h.isString(e)?new a(e):e,(g||c.scheme===b.scheme)&&c.host===b.host&&c.port===b.port},c.canUseXhr=function(a,d){var b,g=m("esri-phonegap")?!0:!1,e=c.hasSameOrigin,f=n.corsEnabledServers,l=-1;return!g&&m("esri-cors")&&f&&f.length&&
(g=k.some(f,function(c,d){var g=c&&"object"==typeof c?c.host:c;return g&&(b=0!==h.trim(g).toLowerCase().indexOf("http"),e(a,b?"http://"+g:g)||b&&e(a,"https://"+g))?(l=d,!0):!1})),d?l:g},c.getAbsoluteUrl=function(a){var g=c.getProtocolForWebResource();return h.isString(a)&&!q.test(a)?0===a.indexOf("//")?g+a:0===a.indexOf("/")?g+"//"+d.location.host+a:b._appBaseUrl+a:a},c.fixUrl=function(a){return a=c.getAbsoluteUrl(a),a=c.upgradeToHTTPS(a),a=a.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")},c.normalize=
function(a){return c.fixUrl(a)},c.upgradeToHTTPS=function(a){var b=l.defaults.io.httpsDomains,g=c.isHTTP(!1),f=c.isHTTP(!0);if(!t.test(a))return a;a=h.trim(a);var n,m=a.indexOf("/",7);if(n=-1===m?a:a.slice(0,m),n=n.toLowerCase().slice(7),g&&n===d.location.host)return a;g=!1;if(f&&n===d.location.host)g=!0;else if(b)for(f=0;f<b.length;f++)if(m=b[f],n===m||e.endsWith(n,"."+m)){g=!0;break}return g&&(a=a.replace(t,"https:")),a},m("extend-esri")&&(h.mixin(b,c),b._getProxyUrl=c.getProxyUrl,b._getProxiedUrl=
c.addProxy,b._hasSameOrigin=c.hasSameOrigin,b._canDoXOXHR=c.canUseXhr,b._getAbsoluteUrl=c.getAbsoluteUrl,b.fixUrl=c.fixUrl),c})},"esri/config":function(){define(["dojo/_base/config","dojo/topic","dojo/has","./kernel"],function(h,k,a,f){var b=function(){return this}(),e={defaults:{screenDPI:96,geometryService:null,kmlService:null,map:{width:400,height:400,layerNamePrefix:"layer",graphicsLayerNamePrefix:"graphicsLayer",slider:{left:"30px",top:"30px",width:null,height:"200px"},sliderLabel:{tick:5,labels:null,
style:"width:2em; font-family:Verdana; font-size:75%;"},sliderChangeImmediate:!0,zoomSymbol:{color:[0,0,0,64],outline:{color:[255,0,0,255],width:1.25,style:"esriSLSSolid"},style:"esriSFSSolid"},zoomDuration:500,zoomRate:25,panDuration:350,panRate:25,logoLink:"http://www.esri.com"},autoSpatialIndexing:b.Worker&&!1,io:{errorHandler:function(a,b){k.publish("esri.Error",[a])},proxyUrl:null,alwaysUseProxy:!1,useCors:"with-credentials",corsEnabledServers:"server.arcgisonline.com services.arcgisonline.com www.arcgis.com tiles.arcgis.com tiles1.arcgis.com tiles2.arcgis.com tiles3.arcgis.com tiles4.arcgis.com basemaps.arcgis.com basemapsbeta.arcgis.com elevation3d.arcgis.com services.arcgis.com services1.arcgis.com services2.arcgis.com services3.arcgis.com services4.arcgis.com services5.arcgis.com services6.arcgis.com services7.arcgis.com static.arcgis.com utility.arcgisonline.com geocode.arcgis.com geoenrich.arcgis.com qaext.arcgis.com tilesqa.arcgis.com servicesqa.arcgis.com servicesqa1.arcgis.com servicesqa2.arcgis.com servicesqa3.arcgis.com geocodeqa.arcgis.com geoenrichqa.arcgis.com dev.arcgis.com devext.arcgis.com localvtiles.arcgis.com staticdev.arcgis.com tilesdevext.arcgis.com elevation3ddev.arcgis.com servicesdev.arcgis.com servicesdev1.arcgis.com servicesdev2.arcgis.com servicesdev3.arcgis.com geocodedev.arcgis.com geoenrichdev.arcgis.com basemapsdev.arcgis.com basemapsbetadev.arcgis.com".split(" "),
corsDetection:b.cordova?!1:!0,corsStatus:{},webTierAuthServers:[],proxyRules:[],postLength:2E3,timeout:6E4,useWorkers:"on-request",maxRequestWorkers:5,httpsDomains:"arcgis.com arcgisonline.com esrikr.com premiumservices.blackbridge.com esripremium.accuweather.com gbm.digitalglobe.com firstlook.digitalglobe.com msi.digitalglobe.com".split(" ")},workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}}}};return a("extend-esri")&&(f.config=e),h.noGlobals||(b.esriConfig=e),e})},"esri/nls/jsapi":function(){define({root:{io:{proxyNotSet:"esri.config.defaults.io.proxyUrl is not set. If making a request to a CORS enabled server, please push the domain into esri.config.defaults.io.corsEnabledServers."},
map:{deprecateReorderLayerString:"Map.reorderLayer(/*String*/ id, /*Number*/ index) deprecated. Use Map.reorderLayer(/*Layer*/ layer, /*Number*/ index).",deprecateShiftDblClickZoom:"Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported."},basemaps:{streets:"Streets",satellite:"Imagery",hybrid:"Imagery with Labels",terrain:"Terrain with Labels",topo:"Topographic",gray:"Light Gray Canvas","dark-gray":"Dark Gray Canvas",oceans:"Oceans","national-geographic":"National Geographic",
osm:"OpenStreetMap","streets-night-vector":"World Street Map (Night)","streets-relief-vector":"World Street Map (with Relief)","streets-navigation-vector":"World Navigation Map"},geometry:{deprecateToScreenPoint:"esri.geometry.toScreenPoint deprecated. Use esri.geometry.toScreenGeometry.",deprecateToMapPoint:"esri.geometry.toMapPoint deprecated. Use esri.geometry.toMapGeometry."},layers:{tiled:{tileError:"Unable to load tile"},dynamic:{imageError:"Unable to load image"},graphics:{drawingError:"Unable to draw graphic "},
agstiled:{deprecateRoundrobin:"Constructor option 'roundrobin' deprecated. Use option 'tileServers'."},imageParameters:{deprecateBBox:"Property 'bbox' deprecated. Use property 'extent'."},FeatureLayer:{noOIDField:"objectIdField is not set [url: ${url}]",fieldNotFound:"unable to find '${field}' field in the layer 'fields' information [url: ${url}]",noGeometryField:"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]",
invalidParams:"query contains one or more unsupported parameters",updateError:"an error occurred while updating the layer",createUserSeconds:"Created by ${userId} seconds ago",createUserMinute:"Created by ${userId} a minute ago",editUserSeconds:"Edited by ${userId} seconds ago",editUserMinute:"Edited by ${userId} a minute ago",createSeconds:"Created seconds ago",createMinute:"Created a minute ago",editSeconds:"Edited seconds ago",editMinute:"Edited a minute ago",createUserMinutes:"Created by ${userId} ${minutes} minutes ago",
createUserHour:"Created by ${userId} an hour ago",createUserHours:"Created by ${userId} ${hours} hours ago",createUserWeekDay:"Created by ${userId} on ${weekDay} at ${formattedTime}",createUserFull:"Created by ${userId} on ${formattedDate} at ${formattedTime}",editUserMinutes:"Edited by ${userId} ${minutes} minutes ago",editUserHour:"Edited by ${userId} an hour ago",editUserHours:"Edited by ${userId} ${hours} hours ago",editUserWeekDay:"Edited by ${userId} on ${weekDay} at ${formattedTime}",editUserFull:"Edited by ${userId} on ${formattedDate} at ${formattedTime}",
createUser:"Created by ${userId}",editUser:"Edited by ${userId}",createMinutes:"Created ${minutes} minutes ago",createHour:"Created an hour ago",createHours:"Created ${hours} hours ago",createWeekDay:"Created on ${weekDay} at ${formattedTime}",createFull:"Created on ${formattedDate} at ${formattedTime}",editMinutes:"Edited ${minutes} minutes ago",editHour:"Edited an hour ago",editHours:"Edited ${hours} hours ago",editWeekDay:"Edited on ${weekDay} at ${formattedTime}",editFull:"Edited on ${formattedDate} at ${formattedTime}"}},
tasks:{gp:{gpDataTypeNotHandled:"GP Data type not handled."},na:{route:{routeNameNotSpecified:"'RouteName' not specified for at least 1 stop in stops FeatureSet."}},query:{invalid:"Unable to perform query. Please check your parameters."}},toolbars:{draw:{convertAntiClockwisePolygon:"Polygons drawn in anti-clockwise direction will be reversed to be clockwise.",addPoint:"Click to add a point",addShape:"Click to add a shape, or press down to start and let go to finish",addMultipoint:"Click to start adding points",
freehand:"Press down to start and let go to finish",start:"Click to start drawing",resume:"Click to continue drawing",complete:"Double-click to complete",finish:"Double-click to finish",invalidType:"Unsupported geometry type"},edit:{invalidType:"Unable to activate the tool. Check if the tool is valid for the given geometry type.",deleteLabel:"Delete"}},virtualearth:{vetiledlayer:{bingMapsKeyNotSpecified:"BingMapsKey must be provided."},vegeocode:{bingMapsKeyNotSpecified:"BingMapsKey must be provided.",
requestQueued:"Server token not retrieved. Queing request to be executed after server token retrieved."}},widgets:{appProxySettings:{premiumContent:"Subscriber Content",untitled:"Untitled (${url})"},attributeInspector:{NLS_first:"First",NLS_previous:"Previous",NLS_next:"Next",NLS_last:"Last",NLS_deleteFeature:"Delete",NLS_title:"Edit Attributes",NLS_errorInvalid:"Invalid",NLS_validationInt:"Value must be an integer.",NLS_validationFlt:"Value must be a float.",NLS_of:"of",NLS_noFeaturesSelected:"No features selected"},
basemapToggle:{toggle:"Toggle basemap"},homeButton:{home:{button:"Home",title:"Default extent"}},layerSwipe:{title:"Drag to see underlying layer"},locateButton:{locate:{button:"My Location",title:"Find my location",tracking:"Track location",stopTracking:"Stop tracking location"}},overviewMap:{NLS_drag:"Drag To Change The Map Extent",NLS_show:"Show Map Overview",NLS_hide:"Hide Map Overview",NLS_maximize:"Maximize",NLS_restore:"Restore",NLS_noMap:"'map' not found in input parameters",NLS_noLayer:"main map does not have a base layer",
NLS_invalidSR:"spatial reference of the given layer is not compatible with the main map",NLS_invalidType:"unsupported layer type. Valid types are 'TiledMapServiceLayer' and 'DynamicMapServiceLayer'"},timeSlider:{NLS_first:"First",NLS_previous:"Previous",NLS_next:"Next",NLS_play:"Play/Pause",NLS_invalidTimeExtent:"TimeExtent not specified, or in incorrect format."},mdSlider:{NLS_play:"Play/Pause",NLS_previous:"Previous",NLS_next:"Next"},attachmentEditor:{NLS_attachments:"Attachments:",NLS_add:"Add",
NLS_none:"None",NLS_error:"There was an error.",NLS_fileNotSupported:"This file type is not supported."},directions:{error:{notEnoughStops:"Enter an origin and a destination.",notReady:"Directions Widget is not done loading, or there was an error during initialization.",unknownStop:"Location '\x3cname\x3e' could not be found.",routeTask:"Unable to route to these addresses.",locator:"Location could not be found.",invalidStopType:"Invalid stop type",locatorUndefined:"Unable to reverse geocode. Locator URL is undefined.",
noAddresses:"No addresses were returned.",noStops:"No stops were given to be added.",maximumStops:"The maximum number of stops has been reached.",cantFindRouteServiceDescription:"Route service description was not reached or recognized. Please check service URL and/or user credentials, if specified.",maxWalkingDistance:"The distance between any inputs must be less than 50 miles (80 kilometers) when walking.",nonNAmTruckingMode:"Calculating trucking routes outside of North and Central America is not currently supported.",
cantRemoveStop:"Failed to remove stop.",waypointShouldBeInBetweenStops:"A waypoint can only be inserted in between existing stops or other waypoints.",couldNotUpdateStop:"Could not update stop.",cantSaveRoute:"An error happened while saving the route.",accessDenied:"You do not have access to this route layer. You are currently signed in as: ",loadError:"Error loading route layer."},time:{min:"min",hr:"hr"},units:{esriKilometers:{name:"kilometers",abbr:"km"},esriMeters:{name:"meters",abbr:"m"},esriMiles:{name:"miles",
abbr:"mi"},esriFeet:{name:"feet",abbr:"ft"},esriYards:{name:"yards",abbr:"yd"},esriNauticalMiles:{name:"nautical miles",abbr:"nm"}},travelMode:{car:"By Car",truck:"By Truck",walking:"Walking"},impedance:{fastest:"Fastest",shortest:"Shortest"},unlocatedStop:"\x3cunknown location\x3e",leaveNow:"Leave Now",departAt:"Depart At",GMT:"GMT",showOptions:"Options",hideOptions:"Close",findOptimalOrder:"Optimize order",useTraffic:"Show traffic",trafficLabelLive:"As of now",trafficLabelDepartAt:"As of departure",
seeTrafficAvailability:"See availability",onAverage:"typically",noTraffic:"No Traffic info",heavyTraffic:"Heavy Traffic",ligthTraffic:"Light Traffic",returnToStart:"Return to start",addDestination:"Add",viewFullRoute:"Zoom to full route",getDirections:"Get Directions",clearDirections:"Clear",reverseDirections:"Reverse directions",activate:"Add stops by clicking on the map or modify route with waypoints",lineBarrier:"Barriers",lineBarrierFreehand:"Press down to start and let go to finish. Click to delete.",
print:"Print",printNotes:"Enter notes here",printDisclaimer:"Directions are provided for planning purposes only and are subject to \x3ca href\x3d'http://www.esri.com/legal/software-license' target\x3d'_blank'\x3eEsri's terms of use\x3c/a\x3e. Dynamic road conditions can exist that cause accuracy to differ from your directions and must be taken into account along with signs and legal restrictions. You assume all risk of use.",retrievingMyLocation:"Retrieving location...",myLocationError:"Cannot retrieve location",
setToMyLocation:"Use my current location",setToMyLocationTitle:"Depart from my current location",stopNoTitle:"Stop #",maneuver:"Route Maneuver",stop:"Location",waypoint:"Waypoint",dragRoute:"Drag to change route",dragStop:"Drag to change location or click to see details",dragWaypoint:"Drag to change location or click to remove",toNearbyStops:"to nearby stop(s)",saveTitle:"Save and share route",layerName:"Result layer name",save:"Save",saveAs:"Save as new",routeIsSaved:"Route was successfully saved.",
share:"Share the route",serviceTime:"Service time",serviceDistance:"Service distance",routeLayerEmpty:"Loaded layer is empty.",routeLayerStopsOnly:"Loaded layer has stops only. Click GET DIRECTIONS to build route."},editor:{tools:{NLS_attributesLbl:"Attributes",NLS_cutLbl:"Cut",NLS_deleteLbl:"Delete",NLS_extentLbl:"Extent",NLS_freehandPolygonLbl:"Freehand Polygon",NLS_freehandPolylineLbl:"Freehand Polyline",NLS_pointLbl:"Point",NLS_polygonLbl:"Polygon",NLS_polylineLbl:"Polyline",NLS_reshapeLbl:"Reshape",
NLS_selectionNewLbl:"New selection",NLS_selectionAddLbl:"Add to selection",NLS_selectionClearLbl:"Clear selection",NLS_selectionRemoveLbl:"Subtract from selection",NLS_selectionUnionLbl:"Union",NLS_autoCompleteLbl:"Auto Complete",NLS_unionLbl:"Union",NLS_rectangleLbl:"Rectangle",NLS_circleLbl:"Circle",NLS_ellipseLbl:"Ellipse",NLS_triangleLbl:"Triangle",NLS_arrowLbl:"Arrow",NLS_arrowLeftLbl:"Left Arrow",NLS_arrowUpLbl:"Up Arrow",NLS_arrowDownLbl:"Down Arrow",NLS_arrowRightLbl:"Right Arrow",NLS_undoLbl:"Undo",
NLS_redoLbl:"Redo"}},Search:{main:{searchButtonTitle:"Search",clearButtonTitle:"Clear search",placeholder:"Find address or place",searchIn:"Search in",lonlat:"Longitude, Latitude",reverseLonLatHeader:"Did you mean?",all:"All",allPlaceholder:"Find address or place",emptyValue:"Please enter a search term.",untitledResult:"Untitled",untitledSource:"Untitled source",noResults:"No results",noResultsFound:"There were no results found for ${value}.",showMoreResults:"Show more results",hideMoreResults:"Hide",
searchResult:"Search result",moreResultsHeader:"More results",esriLocatorName:"Esri World Geocoder"}},Geocoder:{main:{clearButtonTitle:"Clear Search",searchButtonTitle:"Search",geocoderMenuButtonTitle:"Change Geocoder",geocoderMenuHeader:"Search in",geocoderMenuCloseTitle:"Close Menu",untitledGeocoder:"Untitled geocoder"},esriGeocoderName:"Esri World Geocoder"},geocodeMatch:{match:{mapAllCandidatesLabel:"Map All Suggestions",defaultSortOrderLabel:"Default Sort Order",tableOptionsLabel:"Options",columnLabelAddress:"Address",
columnLabelType:"Type",columnLabelScore:"Score",noDataMsg:"No Results.",userCreatedLabel:"User Created",defaultMatchType:"DefaultMatch"},popup:{noAddress:"No Address Found.",matchButtonLabel:"Match",discardButtonLabel:"Discard",checkBoxLocation:"Location (X, Y)",checkBoxAddress:"Suggested Address",addressTitle:"Suggested Address",optionsTitle:"Match Options:",loadingPH:"Searching...",locationTitle:"Location",xTitle:"X: ",yTitle:"Y: "},customLabel:"Custom",idProperty:"id",gridTitle:"Suggestions",matchedLC:"matched",
matchedUC:"Matched",unmatchedLC:"unmatched",unmatchedUC:"Unmatched"},geocodeReview:{review:{noDataMsg1:"No Unmatched Features",noDataMsg2:"No Matched Features",noDataMsg3:"No Reviewed Features",columnOriginalLocation:"Original Location",columnSelectedLocation:"Selected Location",columnOriginalAddress:"Original Address",columnSelectedAddress:"Selected Address"},customLabel:"Custom",unmatchedLC:"unmatched",matchedLC:"matched",unmatchedUC:"Unmatched",matchedUC:"Matched",totalUC:"Total",remainingUC:"Remaining",
idProperty:"id",reviewedUC:"Reviewed",columnLabelAddress:"Address",of:"of",unmatchedTotal:"Unmatched (${count} Total)",unmatchedRemaining:"Unmatched (${count1} of ${count2} Remaining)",matchedTotal:"Matched (${count} Total)",reviewedTotal:"Reviewed (${count} Total)"},FeatureTable:{options:"Options",sortAsc:"Sort Ascending",sortDesc:"Sort Descending",defaultSort:"Default Sort Order",showSelected:"Show Selected Records",clearSelection:"Clear Selection",toggleColumns:"Show/Hide Columns",statistics:"Statistics",
close:"Close",untitled:"Untitled",loadingData:"Loading Feature Data...",noData:"No Data Found",dataError:"Data Error",gridHeader:"${gridTitle} (${featureCount} features, ${featureSelectedCount} selected)",add:"Add",show:"Show",hide:"Hide",relatedRecords:"Related Records",photosAndFiles:"Photos and Files",attachments:"Attachments",owners:"Owners",parenValue:"(${value})",date:"Date",number:"Number",string:"String",centerOnSelection:"Center on Selection",numberOfValues:"Number of Values",sumOfValues:"Sum of Values",
minimum:"Minimum",maximum:"Maximum",average:"Average",standardDeviation:"Standard Deviation",fieldLabel:"Field: ${fieldName}",view:"View",upload:"Upload",uploading:"Uploading...",uploadFail:"Upload Failed.",uploadSuccess:"Upload Successful!",deleting:"Deleting...",deleteSuccess:"Delete Successful.",deleteFail:"Delete Failed.",empty:"- empty -",showDetailedView:"Show Detailed View",B:"${fileSize} B",kB:"${fileSize} kB",MB:"${fileSize} MB",GB:"${fileSize} GB",TB:"${fileSize} TB",errorApplyFilter:"Unable to apply filter.",
errorGetStats:"Could not get statistics.",errorSelectFeatures:"Could not select features.",errorLoadRow:"Could not load the row. Selection failed.",errorValidExtent:"Could not generate valid extent.",errorRollback:"Could not rollback value.",errorUpdateFailed:"Update failed.",errorDomainType:"Domain type is not supported.",errorFeatureInfo:"Could not get feature information.",errorGenerateStore:"Could not generate store.",errorAccessingData:"Accessing data failed",showAllRecords:"Show All Records",
selected:"${num} selected",saveSelectionAsFilter:"Save Selection as Filter",allColums:"All Columns",selectVisibleRasters:"Select Visible Images",zeroRasters:"0 images",oneRaster:"1 image",moreRasters:"${num} images",lockRaster:"Display Selected Images",unlockRaster:"Display All Images",tableOptions:"Table Options",hideTable:"Hide Table",accessingData:"Please wait... Accessing data.",layerNotResponding:"Unable to display table. The layer is not responding."},FeatureAttachments:{add:"Add",view:"View",
upload:"Upload",close:"Close",uploading:"Uploading...",uploadFail:"Upload Failed.",uploadSuccess:"Upload Successful!",deleting:"Deleting...",deleteSuccess:"Delete Successful.",deleteFail:"Delete Failed.",error:"Error.",B:"${fileSize} B",kB:"${fileSize} kB",MB:"${fileSize} MB",GB:"${fileSize} GB",TB:"${fileSize} TB",fileNotSupported:"File type is not supported."},HistogramTimeSlider:{count:"Count: ${count}",dateRange:"Date Range: ${start} - ${end}"},layerList:{legend:"Legend",sublayers:"Sublayers",
opacity:"Opacity",expand:"Expand",collapse:"Collapse",noSublayers:"No sublayers to display",noLayers:"No layers to display."},legend:{NLS_points:"Points",NLS_lines:"Lines",NLS_areas:"Areas",NLS_creatingLegend:"Creating legend",NLS_noLegend:"No legend",NLS_dotValue:"1 Dot \x3d ${value} ${unit}",NLS_currentObservations:"Current observations",NLS_previousObservations:"Previous observations",high:"High",low:"Low",NLS_esriMetersPerSecond:"m/s",NLS_esriKilometersPerHour:"km/h",NLS_esriKnots:"knots",NLS_esriFeetPerSecond:"ft/sec",
NLS_esriMilesPerHour:"mph",showField:"${field}",showNormField:"${field} divided by ${normField}",showNormPct:"${field} as a percent of the total",showRatio:"Ratio of ${field} to ${normField}",showRatioPercent:"${field} as a percent of ${normField}",showRatioPercentTotal:"${field} as a percent of ${field} and ${normField}"},popup:{NLS_moreInfo:"More info",NLS_searching:"Searching",NLS_prevFeature:"Previous feature",NLS_nextFeature:"Next feature",NLS_close:"Close",NLS_prevMedia:"Previous media",NLS_nextMedia:"Next media",
NLS_noInfo:"No information available",NLS_noAttach:"No attachments found",NLS_maximize:"Maximize",NLS_restore:"Restore",NLS_zoomTo:"Zoom to",NLS_pagingInfo:"(${index} of ${total})",NLS_attach:"Attachments"},measurement:{NLS_distance:"Distance",NLS_area:"Area",NLS_location:"Location",NLS_resultLabel:"Measurement Result",NLS_length_miles:"Miles",NLS_length_kilometers:"Kilometers",NLS_length_feet:"Feet",NLS_length_meters:"Meters",NLS_length_yards:"Yards",NLS_length_nautical_miles:"Nautical Miles",NLS_area_acres:"Acres",
NLS_area_sq_miles:"Sq Miles",NLS_area_sq_kilometers:"Sq Kilometers",NLS_area_hectares:"Hectares",NLS_area_sq_yards:"Sq Yards",NLS_area_sq_feet:"Sq Feet",NLS_area_sq_meters:"Sq Meters",NLS_area_sq_nautical_miles:"Sq Nautical Miles",NLS_deg_min_sec:"DMS",NLS_decimal_degrees:"Degrees",NLS_map_coordinate:"Map Coordinate",NLS_longitude:"Longitude",NLS_latitude:"Latitude",NLS_MGRS:"MGRS",NLS_USNG:"USNG",NLS_UTM:"UTM",NLS_GeoRef:"GeoRef",NLS_GARS:"GARS",NLS_geometry_service_error:"Geometry Service Error",
NLS_calculating:"Calculating...",NLS_length_miles_us:"Miles (US)",NLS_area_sq_miles_us:"Sq Miles (US)",NLS_length_feet_us:"Feet (US)",NLS_area_sq_feet_us:"Sq Feet (US)",NLS_length_yards_us:"Yards (US)",NLS_area_sq_yards_us:"Sq Yards (US)",NLS_area_acres_us:"Acres (US)"},bookmarks:{NLS_add_bookmark:"Add Bookmark",NLS_new_bookmark:"Untitled",NLS_bookmark_edit:"Edit",NLS_bookmark_remove:"Remove"},print:{NLS_print:"Print",NLS_printing:"Printing",NLS_printout:"Printout"},textSymbolEditor:{symbolConfiguration:"Symbol Configuration",
alignment:"Alignment",color:"Color",halo:"Halo"},scalebar:{km:"km",mi:"mi",ft:"ft",m:"m"},templatePicker:{creationDisabled:"Feature creation is disabled for all layers.",loading:"Loading.."},renderingRule:{rendererLabelTitle:"Renderer",bandCombinationLabelTitle:"RGB composite",userDefinedRendererTitle:"User Defined Renderer",userDefinedRendererDesc:"A user defined renderer. Use different bands for inputs to the Red, Green, and Blue channels (multi-band services only). Apply different radiometric enhancement algorithms to make image look better.",
imageEnhancementLabelTitle:"Image Enhancement",stretchDescLabel:"Apply contrast enhancements to improve the image display.",stretchMethodLabel:"Stretch Type:",stretchMethodNoneDesc:"No additional enhancements applied.",stretchMethodMinMaxDesc:"Stretch to the entire range of pixel values.",numStdDevLabelTitle:"Trim extreme pixel values beyond",numStdDevEndLabelTitle:"standard deviations.",draLabelTitle:"Dynamic range adjustment",minMaxDescLabelTitle:"Trim extreme pixel values",minPercentLabelTitle:"Exclude bottom:",
maxPercentLabelTitle:"Exclude top:",percentLabelTitle:"%",gammaLabelTitle:"Gamma:",bandNamesRequestMsg:"Requesting band information...",noneStretchAlias:"None",minMaxStretchAlias:"Minimum and Maximum",stdDevStretchAlias:"Standard Deviation",percentClipStretchAlias:"Percent Clip",minGammaLabel:"0.1",maxGammaLabel:"10",colorRampTitle:"Color Ramp"},colorRampSelector:{colorRamps:{none:"None",blackToWhite_predefined:"Black to White",yellowToRed_predefined:"Yellow to Red",slope_predefined:"Slope",aspect_predefined:"Aspect",
errors_predefined:"Errors",heatmap1_predefined:"Heatmap #1",elevation1_predefined:"Elevation #1",elevation2_predefined:"Elevation #2",blueBright_predefined:"Blue Bright",blueLightToDark_predefined:"Blue Light to Dark",blueGreenBright_predefined:"Blue-Green Bright",blueGreenLightToDark_predefined:"Blue-Green Light to Dark",brownLightToDark_predefined:"Brown Light to Dark",brownToBlueGreenDivergingBright_predefined:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark_predefined:"Brown to Blue Green Diverging, Dark",
coefficientBias_predefined:"Coefficient Bias",coldToHotDiverging_predefined:"Cold to Hot Diverging",conditionNumber_predefined:"Condition Number",cyanToPurple_predefined:"Cyan to Purple",cyanLightToBlueDark_predefined:"Cyan-Light to Blue-Dark",distance_predefined:"Distance",grayLightToDark_predefined:"Gray Light to Dark",greenBright_predefined:"Green Bright",greenLightToDark_predefined:"Green Light to Dark",greenToBlue_predefined:"Green to Blue",orangeBright_predefined:"Orange Bright",orangeLightToDark_predefined:"Orange Light to Dark",
partialSpectrum_predefined:"Partial Spectrum",partialSpectrum1Diverging_predefined:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging_predefined:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright_predefined:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark_predefined:"Pink to YellowGreen Diverging, Dark",precipitation_predefined:"Precipitation",prediction_predefined:"Prediction",purpleBright_predefined:"Purple Bright",purpleToGreenDivergingBright_predefined:"Purple to Green Diverging, Bright",
purpleToGreenDivergingDark_predefined:"Purple to Green Diverging, Dark",purpleBlueBright_predefined:"Purple-Blue Bright",purpleBlueLightToDark_predefined:"Purple-Blue Light to Dark",purpleRedBright_predefined:"Purple-Red Bright",purpleRedLightToDark_predefined:"Purple-Red Light to Dark",redBright_predefined:"Red Bright",redLightToDark_predefined:"Red Light to Dark",redToBlueDivergingBright_predefined:"Red to Blue Diverging, Bright",redToBlueDivergingDark_predefined:"Red to Blue Diverging, Dark",redToGreen_predefined:"Red to Green",
redToGreenDivergingBright_predefined:"Red to Green Diverging, Bright",redToGreenDivergingDark_predefined:"Red to Green Diverging, Dark",spectrumFullBright_predefined:"Spectrum-Full Bright",spectrumFullDark_predefined:"Spectrum-Full Dark",spectrumFullLight_predefined:"Spectrum-Full Light",surface_predefined:"Surface",temperature_predefined:"Temperature",whiteToBlack_predefined:"White to Black",yellowToDarkRed_predefined:"Yellow to Dark Red",yellowToGreenToDarkBlue_predefined:"Yellow to Green to Dark Blue",
yellowGreenBright_predefined:"Yellow-Green Bright",yellowGreenLightToDark_predefined:"Yellow-Green Light to Dark"}},vectorFieldRenderer:{symbolTypeLabelTitle:"Symbol:",simpleScalarLabelTitle:"Simple Scalar",simpleScalarDesc:"Symbolizes the magnitude of the data using graduated symbol sizes.",singleArrowLabelTitle:"Single Arrow",singleArrowDesc:"Symbolizes the magnitude and direction of flow with an arrow. The size of the arrow represents flow magnitude and the direction of the arrow indicates direction of flow.",
windBarbsLabelTitle:"Wind Barbs",windBarbsDesc:"Symbolizes the magnitude and direction of wind using wind barbs. A long barb represents 10 knots, a short barb indicates 5 knots, and a black pennant represents 50 knots. The barb points to the direction where the wind originates.",beaufortLabelTitle:"Beaufort Wind Scale",beaufortDesc:"Symbolizes the magnitude and direction of wind using the Beaufort Wind Scale. The magnitude is categorized into levels 0 through 12, where 0 represents a calm wind (displayed in blue), and 12 represents a hurricane (red). The arrow points to the direction where the wind originates.",
oceanCurrentKnotsLabelTitle:"Ocean Current (Nine classes)",oceanCurrentKnotsDesc:"Symbolizes the magnitude and direction of ocean current using nine predefined categories that range from 0 to 4 knots. The arrows point to the current direction of flow.",oceanCurrentMpsLabelTitle:"Ocean Current (Four classes)",oceanCurrentMpsDesc:"Symbolizes the magnitude and direction of ocean current using four predefined categories that range from 0 to 2 m/s. The arrows point to the current direction of flow.",classifiedArrowLabelTitle:"Classified Arrow",
classifiedArrowDesc:"Symbolizes the magnitude and direction of flow, using categories calculated based on magnitude limits. Magnitude is represented using graduated symbol sizes and colors, ranging from green (low) to red (high).",dataTypeLabelTile:"Direction represents flow:",angleFromAlias:"From (Meteorological)",angleToAlias:"To (Oceanographic)",unitLabelTitle:"Convert magnitude ",outputUnitLabelTitle:"To: ",inputUnitLabelTitle:"From: ",symbolDensityLabelTitle:"Symbol density: ",sparseTileSizeAlias:"Sparse",
denseTileSizeAlias:"Dense",symbolSizeLabelTitle:"Symbol scaling:",minSymbolSizeAlias:"Minimum",maxSymbolSizeAlias:"Maximum",advancedOptionsTitle:"Advanced Settings",magnitudeLabelTitle:"Magnitude",minAlias:"Minimum:",maxAlias:"Maximum:",invalidNumberMessage:"Please enter a numeric value.",dataValueRangeLabelTitle:"Symbol sizes represent magnitude range. Define magnitude range",applyLabelTitle:"Apply",esriMetersPerSecond:"m/s",esriKilometersPerHour:"km/h",esriKnots:"knots",esriFeetPerSecond:"ft/sec",
esriMilesPerHour:"mph"},mosaicRule:{mosaicMethodLabel:"Prioritize imagery based on:",orderFieldLabel:"Attribute:",orderValueLabel:"Highest priority value:",lockRasterIdLabel:"Image IDs:",mosaicOperatorLabel:"Resolve overlapping pixels by:",descendingLabel:"Reverse the order",queryLabel:"Filter your images:",queryFieldLabel:"Field:",queryOperatorLabel:"Operator:",queryValueLabel:"Value:",selectAllLabel:"Select All",mosaicruleNotApplicable:"The image layer contains only one image and does not support changing image display order.",
lockRasterRequestMsg:"Searching...",lockRasterRequestDoneMsg:"Done...",lockRasterRequestErrorMsg:"Error searching...",lockRasterRequestNoRasterMsg:"No rasters found...",refreshLockRasterIdsLabel:"Refresh",orderFieldNotFound:"Not Available",byAttributeAlias:"An attribute",centerAlias:"Image center closest to view center",lockRasterAlias:"A list of images",nadirAlias:"Sensor location closest to view center",northWestAlias:"Fixed order with most North West on top",seamlineAlias:"Defined Seamlines",viewPointAlias:"View point",
noneAlias:"Only scale",firstAlias:"Only highest priority",lastAlias:"Only Lowest priority",minAlias:"Minimum of pixel values",maxAlias:"Maximum of pixel values",averageAlias:"Average of pixel values",blendAlias:"Blend pixel values",sumAlias:"Sum of pixel values"},multidimensionalFilter:{variableFilter:"Variable",filterByDimensionalValues:"Dimensions",fromTimeText:"Start Time:",toTimeText:"End Time:",fromNumericText:"From:",toNumericText:"To:",sliceTimeText:"Time:",sliceNumberText:"Value:",rangeText:"Define a range",
hasRangesInfoText1:"Data points are in the form of ranges.",hasRangesInfoText2:"Please select predefined range values.",defaultVariableText:"Default",dateSnapText:"Snapped to closest date",numSnapText:"Snapped to closest value",disabledNumericDimensionText:"*Disabled because dimension slider is active.",disabledTimeDimensionText:"*Disabled because time slider is active.",applyLabelTitle:"Apply",startNumberButtonTooltip:"First",nextButtonTooltip:"Next",previousButtonTooltip:"Previous",endNumberButtonTooltip:"Last",
startDateButtonTooltip:"Earliest",endDateButtonTooltip:"Latest",tooltipNumberFromValueText:"Minimum:",tooltipNumberToValueText:"Maximum:",tooltipCountText:"Count:",tooltipDateFromValueText:"Earliest:",tooltipDateToValueText:"Latest:"},imageServiceMeasure:{measureBtnText:"Measure",angularUnits:"Angular Units",linearUnits:"Linear Units",areaUnits:"Area Units",infoWindowTitle:"Measure Result",measure3DLabel:"Measure in 3D",settings:"Settings",mensurationCapabilitiesAbsentText:"Mensuration capabilities not supported by the layer.",
measurementErrorGeneric:"Unable to perform measurement. Invalid or missing input parameters.",operationLabel:{OPERATION_POINT:"Location",OPERATION_DISTANCE_ANGLE:"Distance and Angle",OPERATION_AREA_PERIMETER:"Area and Perimeter",OPERATION_BASE_TOP:"Height: Base to Top",OPERATION_BASE_TOP_SHADOW:"Height: Base to Top-Shadow",OPERATION_TOP_TOP_SHADOW:"Height: Top to Top-Shadow",OPERATION_CENTROID:"Centroid",OPERATION_POINT_3D:"Location (3D)",OPERATION_DISTANCE_ANGLE_3D:"Distance and Angle (3D)",OPERATION_AREA_PERIMETER_3D:"Area and Perimeter (3D)",
OPERATION_CENTROID_3D:"Centroid (3D)"},unitLabel:{INCHES:"Inches",FEET:"Feet",YARDS:"Yards",MILES:"Miles",NAUTICAL_MILES:"Nautical Miles",MILLIMETERS:"Millimeters",CENTIMETERS:"Centimeters",DECIMETERS:"Decimeters",METERS:"Meters",KILOMETERS:"Kilometers",RADIANS:"Radians",DECIMAL_DEGREES:"Degrees",SQUARE_INCHES:"Sq Inches",SQUARE_FEET:"Sq Feet",SQUARE_YARDS:"Sq Yards",ACRES:"Acres",SQUARE_MILES:"Sq Miles",SQUARE_MILLIMETERS:"Sq Millimeters",SQUARE_CENTIMETERS:"Sq Centimeters",SQUARE_DECIMETERS:"Sq Decimeters",
SQUARE_METERS:"Sq Meters",ARES:"Ares",HECTARES:"Hectares",SQUARE_KILOMETERS:"Sq Kilometers"},measureDialog:{Point:"Location",Centroid:"Centroid",X:"X",Y:"Y",Distance:"Distance",AzimuthAngle:"Azimuth Angle",ElevationAngle:"Elevation Angle",Area:"Area",Perimeter:"Perimeter",Height:"Height"}},obliqueViewer:{northTooltip:"Viewing angle towards north",southTooltip:"Viewing angle towards south",eastTooltip:"Viewing angle towards east",westTooltip:"Viewing angle towards west",nadirTooltip:"Center as viewed from above"},
tags:{addTags:"Add tag(s)",noTagsFound:"No existing tags match.",required:"One or more tags are required."},rendererSlider:{statsAvg:"Average : ${avg}",count:"Count : ${count}",percent:"${num}%",high:"High",low:"Low",color:{changeMinMaxToolTIp:"Type in a value.",handleToolTip:"Match data values to colors.",maxValueToolTip:"Type in the largest expected data value.",minValueToolTip:"Type in the smallest expected data value.",changeSymbol:"Change symbol"},size:{handleToolTip:"Match data values to symbol size.",
sizeInputBoxLines:"Set line thickness from 0 to 18 pixels.",sizeInputBoxPoints:"Set symbol size from 1 to 120 pixels"}},histogram:{statsAvg:"Average : ${avg}",statsSD:"Standard Deviation : ${sd}",count:"Count : ${count}",percent:"${num}%"},zoomSlider:{zoomIn:"Zoom In",zoomOut:"Zoom Out"},colorPicker:{transparency:"Transparency",suggested:"Suggested",recent:"Recent",more:"More",moreColorsTooltip:"See more colors.",paletteTooltip:"Select a color.",noColorTooltip:"No color",hexInputTooltip:"A custom color in hexadecimal notation (#FFFF00)."},
visibleScaleRangeSlider:{noLimit:"No Limit",preview:"Preview",currentScaleTooltip:"Current map scale (${scaleLabel})",customScaleInputTooltip:"Type in a scale.",current:"Current",setTo:"Set to",selectOne:"(select one)",setToSelectOne:"${setTo} ${selectOne}",useSameAs:"Use same as",layerNameAndType:"${name} (${type})",layer:"Layer",basemap:"Basemap",scaleRangeLabels:{world:"World",continent:"Continent",countries:"Countries",country:"Country",states:"States",state:"State",counties:"Counties",county:"County",
metropolitanArea:"Metropolitan Area",cities:"Cities",city:"City",town:"Town",neighborhood:"Neighborhood",streets:"Streets",street:"Street",buildings:"Buildings",building:"Building",smallBuilding:"Small Building",rooms:"Rooms",room:"Room"},featuredScaleLabels:{current:"Current Map View (${scaleLabel})",world:"World (${scaleLabel})",continent:"Continent (${scaleLabel})",countriesBig:"Countries - Big (${scaleLabel})",countriesSmall:"Countries - Small (${scaleLabel})",statesProvinces:"States / Provinces (${scaleLabel})",
stateProvince:"State/Province (${scaleLabel})",counties:"Counties (${scaleLabel})",county:"County (${scaleLabel})",metropolitanArea:"Metropolitan Area (${scaleLabel})",cities:"Cities (${scaleLabel})",city:"City (${scaleLabel})",town:"Town (${scaleLabel})",neighborhood:"Neighborhood (${scaleLabel})",streets:"Streets (${scaleLabel})",street:"Street (${scaleLabel})",buildings:"Buildings (${scaleLabel})",building:"Building (${scaleLabel})",smallBuilding:"Small Building (${scaleLabel})",rooms:"Rooms (${scaleLabel})",
room:"Room (${scaleLabel})"}},symbolEditor:{customImages:"Custom Images",preview:"Preview",shape:"Shape",fill:"Fill",outline:"Outline",px:"px",symbolSize:"Symbol Size",symbolSizeTooltip:"Set symbol size from ${min} to ${max} pixels.",useImage:"Use an Image",useImageTooltip:"Use a custom image.",imageUrlInputTooltip:"For best results, use a square image (PNG, GIF, or JPEG) no greater than 120 x 120 pixels. Other sizes will be adjusted to fit.",imageUrlInputPlaceholder:"https://\x3cimage URL\x3e",selectCategoryTooltip:"Select a category.",
imageLoadError:"Unable to load image.",symbolLoadError:"Unable to load symbols.",noFillTooltip:"No fill",symbolTransparencyTooltip:"Symbol transparency",lineWidth:"Line Width",lineWidthTooltip:"Set a line width from ${min} to ${max} pixels.",pattern:"Pattern",patternTooltip:"Line type",flipColors:"Flip Colors",flipColorsTooltip:"Invert color ramp.",noOutlineTooltip:"No outline",autoAdjustOutline:"Adjust outline automatically",saturation:"Saturation",saturationTooltip:"Adjust color intensity.",selectRampTooltip:"Select a color ramp."}},
arcgis:{utils:{baseLayerError:"Unable to load the base map layer",geometryServiceError:"Provide a geometry service to open Web Map.",showing:"Showing ${fieldAlias}"}},identity:{lblItem:"item",title:"Sign In",info:"Please sign in to access the item on ${server} ${resource}",oAuthInfo:"Please sign in to continue.",lblUser:"Username:",lblPwd:"Password:",lblOk:"OK",lblSigning:"Signing in...",lblCancel:"Cancel",errorMsg:"Invalid username/password. Please try again.",invalidUser:"The username or password you entered is incorrect.",
forbidden:"The username and password are valid, but you don't have access to this resource.",noAuthService:"Unable to access the authentication service."},common:{cancel:"Cancel",ok:"OK",create:"Create",close:"Close",done:"Done",apply:"Apply",remove:"Remove",open:"Open",edit:"Edit",share:"Share",save:"Save",help:"Help",warning:"Warning",deleteLabel:"Delete",titleLabel:"Title:",newLabel:"New",arcgis:"ArcGIS",previous:"Previous",submit:"Submit",next:"Next",yesLabel:"Yes",noLabel:"No",errorTitle:"Error",
upload:"Upload",sum:"Sum",minimum:"Minimum",maximum:"Maximum",mean:"Mean",average:"Average",median:"Median",standardDeviation:"Standard Deviation",variety:"Variety",standardDev:"Std Deviation",statistic:"Statistic",attribute:"Field",selectAttribute:"Select attribute",runAnalysis:"Run Analysis",oneLabel:"1",twoLabel:"2",threeLabel:"3",fourLabel:"4",fiveLabel:"5",sixLabel:"6",sevenLabel:"7",eightLabel:"8",nineLabel:"9",tenLabel:"10",elevenLabel:"11",outputnameMissingMsg:"Output name is required",miles:"Miles",
kilometers:"Kilometers",meters:"Meters",feet:"Feet",degree:"Decimal Degrees",inches:"Inches",nautMiles:"Nautical Miles",pointsUnit:"Point(s)",yards:"Yards",comingSoonLabel:"Coming Soon!",sqMiles:"Square Miles",sqFeet:"Square Feet",sqIn:"Square Inches",sqMapUnits:"Square Map Units",sqYards:"Square Yards",sqCm:"Square Centimeters",sqKm:"Square Kilometers",sqMeters:"Square Meters",hectares:"Hectares",acres:"Acres",seconds:"Seconds",minutes:"Minutes",hours:"Hours",count:"Count",min:"Min",max:"Max",stddev:"STDDEV",
variance:"Variance",range:"Range",days:"Days",weeks:"Weeks",years:"Years",months:"Months",today:"Today",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sunday:"Sunday",chooseSummarizeLabel:"Choose a layer to summarize",creditTitle:"Credit Usage Report",analysisLayers:"Analysis layers:",showCredits:"Show credits",learnMore:"Learn More",hoursSmall:"hr",minutesSmall:"min",secondsSmall:"sec",statsRequiredMsg:"At least one of the statistics parameters is required.",
nowLabel:"Now",hrsLabel:"hrs",groupLabel:"Group",ungroupLabel:"Ungroup",and:"and",or:"or",add:"Add",polygons:"Polygons",points:"Points",lines:"Lines",input:"Input",areas:"Areas",validateRouteIdMsg:"Layers must have the same number of records, or one layer must have one record only.",straightLineDistance:"Line distance",outputLabel:"Output:",addPoint:"Click to add a point",movePoint:"Click to move the point",selectAll:"Select All",unselectAll:"Unselect All",selectLabel:"Select",queryLabel:"Query",
drawnBoundary:"Drawn Boundary",basic:"Basic",intermediate:"Intermediate",advanced:"Advanced",majority:"Majority",minority:"Minority",addMinMajorityLable:"Add minority, majority",addPercentageLabel:"Add percentages",drivingMode:"Driving",truckingMode:"Trucking",walkingMode:"Walking",distanceMsg:"Only numeric values are allowed.",analysisLayerLabel:"Select the analysis layer",selectPointLayer:"You need to select a point feature layer to run ${toolName}.",selectPolyLayer:"You need to select an area (polygon) feature layer to run ${toolName}.",
hotspotsLineFeatureMsg:"Line features are not supported as input to ${toolName}.",areaFeatureInvalidMsg:"Area features are not supported as input to ${toolName}.",overlayValidationMsg:"You need to have two feature layers in the map to perform ${toolName}.",aggregatePolyMsg:"You need to have at least one area (polygon) feature layer to run ${toolName}.",odPointMsg:"You need to have at least two point feature layers to run ${toolName}.",mapNotesAllMsg:"Map note contains points, lines and areas.  Only areas will be used for ${toolName}.",
mapNotesPtsPoly:"Map note contains points and areas.  Only areas will be used for ${toolName}.",mapNotesLinesPoly:"Map note contains lines and areas.  Only areas will be used for ${toolName}.",mapNotesLinesPts:"Map note contains points and lines.  Only lines will be used for ${toolName}.",mergeValidationMsg:"Merge Layers requires at least two layers of the same feature type (point, line, area).",runAnalysisMsg:"Data is being extracted and will be available in My Content.",extractValidationMsg:"There is no data in the map that can be extracted. Data owner(s) must first allow others to export.",
analysisSignInErrorMsg:"Unable to access the analysis service.",addBufExp:"Add Buffer Expession",drawLabel:"Draw",noneLabel:"None",chooseLabel:"Choose ...",browseAnalysisTitle:"Choose Living Atlas Analysis Layer",addLayer:"Add layer to map",withinMapArea:"Within map area",back:"Back",insufficientCreditsMsg:"You do not have enough credits to perform this operation. Contact your ArcGIS System Administrator for assistance.",decimeters:"Decimeters",millimeters:"Millimeters",centimeters:"Centimeters",
noImageServiceMsg:"You need to have at least one image service layer to run ${toolName}.",noSingleBandISMsg:"You need to have a single band image service layer to run ${toolName}.",noMultiBandISMsg:"You need to have a multi-band image service layer to run ${toolName}.",browseLayers:"Browse Layers",addLayerBtnLabel:"Add Layer",timeEnabled:"Time Enabled",milliseconds:"Milliseconds",browseAnalysisLayers:"Choose Analysis Layer",listLabel:"Fields",allLabel:"All",geodesicLabel:"Geodesic",planarLabel:"Planar",
spatialReference:"Spatial Reference (WKID)",enterCoords:"Enter coordinates in Web Mercator",addStatsLabel:"Add statistics (optional)",fieldExpLabel:"Expression",datastoreLabel:"Choose datastore",relationalDS:"Relational",spatialDS:"Spatiotemporal",greaterThanZeroMsg:"Value must be numeric greater than zero.",any:"Any",hexagon:"Hexagon",square:"Square",polygon:"Polygon",createSpaceRunMsg:"Create Space Time cube analysis result will be available in My Content.",fill:"Fill",zeroes:"Zeroes",spatialneighbhors:"Spatial Neighbors",
spacetimeneighbors:"Space Time Neighbors",temporaltrend:"Temporal Trend",aggTimeStepsLabel:"Aggregate using time steps (optional)",intervalLabel:"Time step interval",repeatLabel:"How often to repeat the time step",timeRefLabel:"Time to align time steps to",choosePolyLayer:"Choose the polygon layer",selectSqBinSizeLbl:"Select the size for the square bins",selectHexBinSizeLbl:"Select the size for the hexagon bins",standard:"Standard Tools",bigData:"GeoAnalytics Tools",raster:"Raster Analysis",mostSimilar:"most",
leastSimilar:"least",both:"most and least",numItemsFound:"${total} items found",checkCriteria:"Checking items for required criteria",settings:"Settings",spatial:"Spatial",temporal:"Temporal",attributeLbl:"Attribute",chooseSpatialJoin:"Choose a spatial relationship",chooseAttrJoin:"Choose the fields to match",chooseTemporalJoin:"Choose a temporal relationship",theLabel:"the",outputCellsize:"Output cell size",table:"Table",optimizeFor:"Optimize for",speed:"Speed",accuracy:"Accuracy",precision:"Precision",
outputType:"Output type",featureLayer:"Feature Layer",routeLayers:"Route Layers",includeRouteLayers:"Include route layers",csv:"CSV",xls:"XLS",featureService:"Feature Service",notUsed:"Not Used"},analysisTools:{performAnalysis:"Perform Analysis",summarizeData:"Summarize Data",findLocations:"Find Locations",aggregateTool:"Aggregate Points",bufferTool:"Buffer Data",dataEnrichment:"Data Enrichment",analyzePatterns:"Analyze Patterns",useProximity:"Use Proximity",manageData:"Manage Data",aggregateToolName:"Aggregate Points",
bufferToolName:"Create Buffers",aggregatePoints:"Aggregate Points",summarizeWithin:"Summarize Within",summarizeNearby:"Summarize Nearby",reconstructTracks:"Reconstruct Tracks",enrichLayer:"Enrich Layer",findNearest:"Find Nearest",findHotSpots:"Find Hot Spots",createBuffers:"Create Buffers",dissolveBoundaries:"Dissolve Boundaries",mergeLayers:"Merge Layers",extractData:"Extract Data",overlayLayers:"Overlay Layers",fieldCalculator:"Field Calculator",createDriveTimeAreas:"Create Drive-Time Areas",deriveNewLocations:"Derive New Locations",
findExistingLocations:"Find Existing Locations",findSimilarLocations:"Find Similar Locations",exploreCorrelations:"Explore Correlations",findRoute:"Find Route",generateFleetPlan:"Generate Fleet-routing plan",createDensitySurface:"Create density surface",interpolatePoints:"Interpolate Points",orgUsrMsg:"You must be a member of an organization to run this service.",pubRoleMsg:"Your online account has not been assigned to the Publisher role.",servNameExists:"A result layer already exists with this name. Result layers must be named uniquely across the organization. Please use a different name.",
outputLayerLabel:"Result layer name",outputFileName:"Output file name",emptyResultInfoMsg:"The result of your analysis did not return any features. No layer will be created.",invalidServiceName:'The result layer name contains one or more invalid characters (\x3c, \x3e, #, %, :, ", ?, \x26, +, /, or \\).',invalidServiceNameLength:"The result layer name length should be no more than 98 characters.",invalidEncodedServiceNameLength:"The encoded result layer name length should be less than 170 characters.",
suggestedServiceNameLength:"The result layer name should be less than ${count} characters",requiredValue:"This value is required.",saveResultIn:"Save result in",useMapExtent:"Use current map extent",connectOriginsToDestinations:"Connect Origins to Destinations",planRoutes:"Plan Routes",calculateDensity:"Calculate Density",traceDownstream:"Trace Downstream",createWatershed:"Create Watersheds",createViewshed:"Create Viewshed",createWatersheds:"Create Watersheds",filterNoResults:"Filter did not return any results.",
chooseBestFacilities:"Choose Best Facilities",createPanel:"Create Panel",createSpaceTimeCube:"Create Space Time Cube",joinFeatures:"Join Features",analyzeImage:"Analyze Image",analyzeTerrain:"Analyze Terrain",summarizeRasterWithin:"Summarize Raster Within",histogramRasterWithin:"Histogram Raster Within",findSuitableLocations:"Find Suitable Locations",filterLocations:"Filter Locations",calculateDistance:"Calculate Distance",findShortestPath:"Find Shortest Path",segmentImage:"Segment Image",classifyImage:"Classify Image",
detectDifferences:"Detect Differences",monitorVegetation:"Monitor Vegetation",calculateSlope:"Calculate Slope",deriveAspect:"Derive Aspect",extractRaster:"Extract Raster",remapValues:"Remap Values",interpolatePointsRaster:"Interpolate Points",convertFeatureToRaster:"Convert Feature to Raster",convertRasterToFeature:"Convert Raster to Feature",rasterCalculator:"Raster Calculator",saveLayerType:"Output layer type",dynamicLayer:"Dynamic layer",permanentLayer:"Web Image layer",copytoDatastore:"Copy to Data Store",
summarizeAttributes:"Summarize Attributes",findOutliers:"Find Outliers",geocodeLocations:"Geocode Locations from Table"},aggregatePointsTool:{aggregateDefine:"Count \x3cb\x3e${layername}\x3c/b\x3e within",outputLayerName:"Aggregation of ${pointlayername} to ${polygonlayername}",groupByLabel:"Choose field to group by (optional)",itemDescription:"Feature layer generated from running the Aggregate Points solutions. Points from ${pointlayername} were aggregated to ${polygonlayername}",itemTags:"Analysis Result, Aggregate Points, ${pointlayername}, ${polygonlayername}",
itemSnippet:"Feature layer generated from Aggregate Points",removeAttrStats:"Remove Attribute Statistics",keepPolygonLabel:"Keep areas with no points",chooseAreaLabel:"Choose layer containing aggregation areas",analysisLayerLabel:"Choose layer containing points to aggregate into areas",binsLabel:"Choose a distance to generate bins and aggregate into",polygonLabel:"Choose a polygon layer to aggregate into",aggOption:"Choose an area layer to aggregate into",bins:"Bins",outputSquareType:"Aggregation of ${pointlayername} by square bins",
outputHexType:"Aggregation of ${pointlayername} by hexagon bins"},findHotSpotsTool:{hotspotsPolyDefine:"Analyze \x3cb\x3e${layername}\x3c/b\x3e  to find statistically significant hot and cold spots of ",hotspotsPointDefine:"Analyze \x3cb\x3e${layername}\x3c/b\x3e  to find statistically significant hot and cold spots ",fieldLabel:"with or without an analysis field",noAnalysisField:"No Analysis Field",hotspots:"Hot Spots",outputLayerName:"Hot Spots ${layername}",Options:"Options",defineBoundingLabel:"Define where points are possible",
provideAggLabel:"Count points within",defaultBoundingOption:"None",defaultAggregationOption:"Fishnet Grid",itemDescription:"Feature layer generated from running the Find Hot Spots solution.",itemTags:"Analysis Result, Hot Spots, ${layername}, ${fieldname}",itemSnippet:"Feature layer generated from Find Hot Spots",chooseAttributeLabel:"Find clusters of high and low",divideByLabel:"Divide by (optional)",blayerName:"Drawn Boundaries",analysisLayerLabel:"Choose layer for which hot spots will be calculated",
pointCounts:"Point Counts",enrichLabel:"Esri Population (uses credits)",binSizeLabel:"Select the bin size for aggregation",neighborhoodLabel:"Select the neighborhood size for hot spot calculations",aggTimeStepsLabel:"Find hot spots using time steps (optional)",intervalLabel:"Time step interval",repeatLabel:"Time step to aggregate into",timeRefLabel:"Reference time to align time step to",timeAlignLabel:"Choose how to align time steps",startTime:"Start Time",endTime:"End Time",referenceTime:"Reference Time",
referenceTimeLabel:"Select the reference time",overrideOptions:"Override Options",distanceBand:"Distance Band",cellSize:"Cell Size",hexagonGrid:"Hexagon Grid"},overlayLayersTool:{overlayDefine:"Overlay \x3cb\x3e${layername}\x3c/b\x3e with",chooseOverlayLayer:"Choose overlay layer",chooseOverlayMethod:"Choose overlay method",chooseOutputType:"Choose output type",itemDescription:"Feature layer generated from running the Overlay layers solution.",itemTags:"Analysis Result, Overlay layers, ${layername}",
itemSnippet:"Feature layer generated from Overlay layers",unionOutputLyrName:"Union of ${layername} and ${overlayname}",intersectOutputLyrName:"Intersect of ${layername} and ${overlayname}",eraseOutputLyrName:"Erase ${layername} with ${overlayname}",overlayLayerPolyMsg:"The Overlay layer should be a Polygon Layer for Union overlay",notSupportedEraseOverlayMsg:"This Overlay layer is not supported for Erase overlay. Defaults to Intersect overlay.",intersect:"Intersect",union:"Union",erase:"Erase",analysisLayerLabel:"Choose input layer"},
bufferTool:{bufferDefine:"Create buffers from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"Buffer of ${layername}",sizeLabel:"Enter buffer size",sizeHelp:"To create multiple buffers, enter distances separated by spaces (2 3 5).",typeLabel:"Buffer type",resultLabel:"Result layer name",optionsLabel:"Options",itemDescription:"Feature layer generated from running the Buffer Features solution. Input from ${layername} were buffered by ${distance_field} ${units}",itemTags:"Analysis Result, Buffer, ${layername}",
itemSnippet:"Feature layer generated from Buffer",overlap:"Overlap",dissolve:"Dissolve",include:"Include",exclude:"Exclude",around:"Around",sideType:"Side type",endType:"End type",left:"Left",right:"Right",round:"Round",flat:"Flat",multipleDistance:"Multiple distance buffers should be",rings:"Rings",disks:"Disks",areaofInputPoly:"Area of input polygons in buffer polygons",distance:"Distance",field:"Field",analysisLayerLabel:"Choose layer containing features to buffer",dissolveType:"Select the type of dissolve method",
method:"Select the buffer method",allowMulitipart:"Allow multipart features",bufferDefineBd:"Choose layer to apply buffer to",bufferTypeBd:"Select the type of buffer to apply",selectFieldToDissLabel:"Select the fields to dissolve on",enterBufDist:"Enter the buffer distance",selectBufField:"Select a field to buffer by",createBufExp:"Create an expression to buffer by"},driveTimes:{toolDefine:"Create areas around \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"Drive from ${layername} (${breakValues} ${breakUnits})",
outputModeLayerName:"${mode} from ${layername} (${breakValues} ${breakUnits})",driving:"Drive",trucking:"Truck",walking:"Walk",other:"Travel",measureLabel:"Measure",measureHelp:"To output multiple areas for each point, type sizes separated by spaces (2 3.5 5).",areaLabel:"Areas from different points",trafficLabel:"Use traffic",typicalTraffCdtnLabel:"Traffic based on typical conditions for",resultLabel:"Result layer name",liveTrafficLabel:"Live traffic",itemDescription:"Feature layer generated from running the Create Drive Times solution.",
itemTags:"Analysis Result, Drive Times, ${layername}",itemSnippet:"Feature layer generated from Create Drive Times",split:"Split",seeAvailability:"See availability.",timeOfDeparture:"Time of departure",drivingDistance:"Driving Distance",drivingTime:"Driving Time",truckingTime:"Trucking Time",truckingDistance:"Trucking Distance",walkingDistance:"Walking Distance",walkingTime:"Walking Time",liveSingularTimeLabel:"Live traffic +1 hr ${minute} min",liveSingularHourTimeLabel:"Live traffic +1 hr",liveTimeLabel:"Live traffic +${hour} hr ${minute} min",
liveTimeHoursLabel:"Live traffic +${hour} hr",liveTimeMinutesLabel:"Live traffic +${minute} min",analysisLayerLabel:"Choose point layer to calculate drive-time areas around"},routeOriginDestinationPairsTool:{toolDefine:"Route between pairs of points originating from \x3cb\x3e${layername}\x3c/b\x3e",labelOne:"Route to destinations in",pairPoints:"Points with matching IDs will connect:",originTripId:"ID field in origins",destnTripId:"Matching ID field in destinations",includeSegments:"Include individual road segments.",
inValidNumberRecordsMsg:"Layers must have the same number of records, or one layer must have one record only.",outputLayerName:"${layername} to ${destnlayername}",itemDescription:"Feature layer generated from running the Connect Origins to Destinations solution.",itemTags:"Analysis Result, Connect Origins to Destinations, ${layername}, ${destnlayername}",itemSnippet:"Feature layer generated from Connect Origins to Destinations",analysisLayerLabel:"Choose point layer representing the origin locations:"},
planRoutesTool:{toolDefine:"Route vehicles to stops in \x3cb\x3e${layername}\x3c/b\x3e",timeSpentLabel:"Time spent at each stop",defineRoutesLabel:"Define routes",startRoutesLabel:"Routes begin at",endRoutesLabel:"Routes end at",routes:"Routes",stops:"Stops",numRoutes:"Maximum number of vehicles to route",maxPtsRoute:"Maximum number of stops per vehicle",limitMaxTime:"Limit the total route time per vehicle",returnToStart:"Return to start",specifyStartTime:"Start time for all routes",createStartLoc:"Add point to map",
createEndLoc:"Add point to map",selectStartLoc:"Select starting location",selectEndLoc:"Select ending location",vehicles:"Vehicles",routeId:"Route ID field",selectRouteId:"Select RouteID",stopsLabel:"Your layer has ${numStops} stops.",stopsLabelByExtent:"The current map extent shows ${numStops} stops.",outputLayerName:"Routes to ${layername}",itemDescription:"Feature layer generated from running the Plan Routes solution.",itemTags:"Analysis Result, Plan Routes, ${layername}",itemSnippet:"Feature layer generated from Plan Routes",
startEndPtsValidMsg:"Start or end points not set",travelModeLabel:"Travel mode for routes",analysisLayerLabel:"Choose point layer representing stops to visit",resultLabel:"Result layer name",routeLayerTypeMsg:"Route Layers are being created and will be available in ${folderName} within My Content."},extractDataTool:{layersToExtract:"Layers to extract",studyArea:"Study area",outputDataFormat:"Output data format",filegdb:"File Geodatabase (.zip)",shpFile:"Shapefile (.zip)",lyrpkg:"Layer Package (.lpk)",
selectFtrs:"Select features",clipFtrs:"Clip features",sameAsDisplay:"Same as Display",sameAsLayer:"Same as ${layername}",outputfileName:"Extract Data ${datetime}",itemDescription:"File generated from running the Extract Data solution.",itemTags:"Analysis Result, Extract Data",itemSnippet:"Analysis File item generated from Extract Data",kml:"KML (.kmz or .zip)",csvPoints:"CSV (.csv or .zip)  ",linesCSVValidationMsg:"Line and area layers cannot be extracted to CSV.  Choose a different format or uncheck all line and area layers.",
runAnalysisMsg:"Data is being extracted and will be available in My Content."},summarizeWithinTool:{summarizeDefine:"For Features within \x3cb\x3e${sumWithinLayerName}\x3c/b\x3e",outputLayerName:"Summarize ${summaryLayerName} within ${sumWithinLayerName}",groupByLabel:"Choose field to group by (optional)",itemDescription:"Feature layer generated from running the Summarize Within solution. ${summaryLayerName} were summarized within ${sumWithinLayerName}",itemTags:"Analysis Result, Summarize Within, ${sumWithinLayerName}, ${summaryLayerName}",
itemSnippet:"Feature layer generated from Summarize Within",removeAttrStats:"Remove Attribute Statistics",summarizeMetricPoint:"Count of points",summarizeMetricLine:"Length of lines in",summarizeMetricPoly:"Sum Area in",addStatsLabel:"Attribute statistics",addStats:"Add statistics from the layer to summarize",sumLabel:"Summarize",analysisLayerLabel:"Choose an area layer to summarize other features within its boundaries",summDefineAnalysisLabel:"Choose type of area layer to summarize other features within its boundaries",
addNonWightLabel:"Add non-weighted statistics from the layer to summarize",addWeightLabel:"Add weighted statistics from the layer to summarize",aggTimeStepsLabel:"Summarize using time slices (optional)",intervalLabel:"Time interval to be summarize into",repeatLabel:"Time step to summarize into",outputSquareType:"Summarize ${summaryLayerName} within square bins",outputHexType:"Summarize ${summaryLayerName} within hexagon bins"},summarizeNearbyTool:{summarizeDefine:"Summarize what is nearby \x3cb\x3e${sumNearbyLayerName}\x3c/b\x3e",
findNearLabel:"Summarize nearest features using a",outputLayerName:"Summarize ${summaryLayerName} in ${sumNearbyLayerName}",groupByLabel:"Choose field to group by (optional)",itemDescription:"Feature layer generated from running the Summarize Nearby solution. ${sumNearbyLayerName} were summarized nearby ${summaryLayerName}",itemTags:"Analysis Result, Summarize Nearby, ${sumNearbyLayerName}, ${summaryLayerName}",itemSnippet:"Feature layer generated from Summarize Nearby",removeAttrStats:"Remove Attribute Statistics",
summarizeMetricPoint:"Count of points",summarizeMetricLine:"Total Length",summarizeMetricPoly:"Total Area",addStatsLabel:"Attribute statistics",addStats:"Add statistics from the layer to summarize",sumLabel:"Summarize",chooseLayer:"Choose layer to summarize",returnBdrycCheckLabel:"Return bounding areas",analysisLayerLabel:"Choose layer from which distances will be measured to features in the layer to summarize"},creditEstimator:{analysisLayersLabel:"Analysis layers:",totalRecordsLabel:"Total records:",
creditsAvailLabel:"Credits available:",creditsReqLabel:"Credits required:",ntwCreditsReqLabel:"Network credits required:",EnrichCreditsLabel:"Enrichment credits required",maxCreditsLabel:"Maximum credits required:"},enrichLayerTool:{selectCountryLabel:"Select country",enrichDefine:"Enrich \x3cb\x3e${inputLayerName}\x3c/b\x3e",chooseDataCollectionLabel:"Show available data for:",defAreasLabel:"Define areas to enrich",outputLayerName:"Enriched ${layername}",itemDescription:"Feature layer generated from running the Enrich layer solution. ${inputLayerName} were enriched",
itemTags:"Analysis Result, Enrich Layer, ${inputLayerName}",itemSnippet:"Feature layer generated from Enrich layer",straightLineDistance:"Line distance",selectDataVar:"Select Variables",clickDataVar:"Click Select Variables to open Data Browser and browse for variables",selectedVars:"Selected Variables",usCountryCode:"United States",canadaCountryCode:"Canada",albaniaCountryCode:"Albania",australiaCountryCode:"Australia",austriaCountryCode:"Austria",bahrainCountryCode:"Bahrain",belarusCountryCode:"Belarus",
bosniaCountryCode:"Bosnia and Herzegovina",botswanaCountryCode:"Botswana",belgiumCountryCode:"Belgium",brazilCountryCode:"Brazil",bulgariaCountryCode:"Bulgaria",chinaCountryCode:"China",colombiaCountryCode:"Colombia",croatiaCountryCode:"Croatia",cyprusCountryCode:"Cyprus",czechCountryCode:"Czech Republic",coteCountryCode:"Cote d'Ivoire",denmarkCountryCode:"Denmark",finlandCountryCode:"Finland",franceCountryCode:"France",germanyCountryCode:"Germany",ghanaCountryCode:"Ghana",greeceCountryCode:"Greece",
hungaryCountryCode:"Hungary",icelandCountryCode:"Iceland",indiaCountryCode:"India",indonesiaCountryCode:"Indonesia",irelandCountryCode:"Ireland",israelCountryCode:"Israel",italyCountryCode:"Italy",japanCountryCode:"Japan",kazakhstanCountryCode:"Kazakhstan",kenyaCountryCode:"Kenya",latviaCountryCode:"Latvia",liechtensteinCountryCode:"Liechtenstein",lithuaniaCountryCode:"Lithuania",luxembourgCountryCode:"Luxembourg",malawiCountryCode:"Malawi",malaysiaCountryCode:"Malaysia",maltaCountryCode:"Malta",
mauritiusCountryCode:"Mauritius",mexicoCountryCode:"Mexico",moldovaCountryCode:"Moldova",montenegroCountryCode:"Montenegro",mozambiqueCountryCode:"Mozambique",namibiaCountryCode:"Namibia",netherlandsCountryCode:"Netherlands",nzCountryCode:"New Zealand",nigeriaCountryCode:"Nigeria",norwayCountryCode:"Norway",peruCountryCode:"Peru",polandCountryCode:"Poland",portugalCountryCode:"Portugal",puertoCountryCode:"Puerto Rico",romaniaCountryCode:"Romania",reunionCountryCode:"Reunion",spainCountryCode:"Spain",
switzerlandCountryCode:"Switzerland",swedenCountryCode:"Sweden",turkeyCountryCode:"Turkey",ukCountryCode:"United Kingdom",zmCountryCode:"Zambia",ugandaCountryCode:"Uganda",mkCountryCode:"The Former Yugoslav Republic of Macedonia",uaeCountryCode:"United Arab Emirates",thCountryCode:"Thailand",twCountryCode:"Taiwan",szCountryCode:"Swaziland",krCountryCode:"South Korea",siCountryCode:"Slovenia",sgCountryCode:"Singapore",rsCountryCode:"Serbia",saCountryCode:"Saudi Arabia",tzCountryCode:"Tanzania",ukrCountryCode:"Ukraine",
globalCode:"Global",russiaCountryCode:"Russia",algCountryCode:"Algeria",andCountryCode:"Andorra",argCountryCode:"Argentina",azCountryCode:"Azerbaijan",baCountryCode:"Bangladesh",chCountryCode:"Chile",coCountryCode:"Costa Rica",egCountryCode:"Egypt",elCountryCode:"El Salvador",eeCountryCode:"Estonia",grCountryCode:"Georgia",gtCountryCode:"Guatemala",hoCountryCode:"Honduras",joCountryCode:"Jordan",kwCountryCode:"Kuwait",kzCountryCode:"Kyrgyzstan",lbCountryCode:"Lebanon",leCountryCode:"Lesotho",mgCountryCode:"Mongolia",
moCountryCode:"Morocco",niCountryCode:"Nicaragua",omCountryCode:"Oman",pkCountryCode:"Pakistan",phCountryCode:"Philippines",qaCountryCode:"Qatar",slCountryCode:"Slovakia",safCountryCode:"South Africa",sriCountryCode:"Sri Lanka",sdCountryCode:"Sudan",tnCountryCode:"Tunisia",ugCountryCode:"Uruguay",syCountryCode:"Syria",vzCountryCode:"Venezuela",vtCountryCode:"Vietnam",keyGlobalFacts:"Key Global Facts",age:"Age",husByOccupancy:"Housing Units By Occupancy",householdsByIncome:"Households by Income",keyUSFacts:"Key US Facts",
policy:"Policy Facts",raceAndEthnicity:"Race And Ethnicity",wealth:"Wealth Facts",keyCanFacts:"Key Canada Facts",aTSpend:"Austria Spending",aTFacts:"Austria Facts",bESpend:"Belgium Spending",bEFacts:"Belgium Facts",bRSpend:"Brazil Spending",bRFacts:"Brazil Facts",dKSpend:"Denmark Spending",dKFacts:"Denmark Facts",fISpend:"Finland Spending",fIFacts:"Finland Facts",fRSpend:"France Spending",fRFacts:"France Facts",dESpend:"Germany Spending",dEFacts:"Germany Facts",gRSpend:"Greece Spending",gRFacts:"Greece Facts",
iEFacts:"Ireland Facts",iESpend:"Ireland Spending",iNFacts:"India Facts",iNSpend:"India Spending",iTFacts:"Italy Facts",iTSpend:"Italy Spending",keyWEFacts:"Key Western Europe Facts",keyWESpend:"Key Western Europe Spending",jPFacts:"Japan Facts",jPSpend:"Japan Spending",lIFacts:"Liechtenstein Facts",lISpend:"Liechtenstein Spending",lUFacts:"Luxembourg Facts",lUSpend:"Luxembourg Spending",nLFacts:"Netherlands Facts",nLSpend:"Netherlands Spending",nOFacts:"Norway Facts",nOSpend:"Norway Spending",pTFacts:"Portugal Facts",
pTSpend:"Portugal Spending",eSSpend:"Spain Spending",eSFacts:"Spain Facts",sEFacts:"Sweden Facts",sESpend:"Sweden Spending",cHFacts:"Switzerland Facts",cHSpend:"Switzerland Spending",tRFacts:"Turkey Facts",tRSpend:"Turkey Spending",gBFacts:"United Kingdom Facts",gBSpend:"United Kigdom Spending",tapestry:"Tapestry",infrastructure:"Infrastructure",landCover:"Land Cover",landscapeFacts:"Landscape Facts",publicLands:"Public Lands",soils:"Soils",waterWetlands:"Water Wetlands",rUFacts:"Russia Facts",rUSpend:"Russia Spending",
analysisLayerLabel:"Choose layer to enrich with new data",returnBoundingAreas:"Return result as bounding areas"},dissolveBoundaries:{dissolveBoundariesDefine:"Dissolve \x3cb\x3e${layername}\x3c/b\x3e",chooseDissolveLabel:"Choose dissolve method",overlappingAreasLabel:"Areas that overlap or are adjacent",sameAttributeAreasLabel:"Areas with same field value",summarizeLabel:"Add statistic (optional)",itemDescription:"Feature layer generated from running the Dissolve Boundaries solution.",itemTags:"Analysis Result, Dissolve Boundaries, ${layername}",
itemSnippet:"Feature layer generated from Dissolve Boundaries",resultLabel:"Result layer name",outputLayerName:"Dissolve ${layername}",analysisLayerLabel:"Choose area layer whose boundaries will be dissolved"},FindNearestTool:{summarizeDefine:"For each location in \x3cb\x3e${sumNearbyLayerName}\x3c/b\x3e, find its nearest locations.",findNearLabel:"Find the nearest locations by measuring",outputLayerName:"Nearest ${layer} to ${sumNearbyLayerName}",groupByLabel:"Choose field to group by (optional)",
itemDescription:"Feature layer generated from running the Find Nearest solution. Nearest ${sumNearbyLayerName}",itemTags:"Analysis Result, Find Nearest, ${sumNearbyLayerName}, ${summaryLayerName}",itemSnippet:"Feature layer generated from Find Nearest",removeAttrStats:"Remove Attribute Statistics",forEachLocationLabel:"For each location in the input layer",findNearestLabel:"Limit the number of nearest locations to:",limitSearchRangeCheck:"Limit the search range to",addStats:"For each location in \x3cb\x3e${summaryLayerName}\x3c/b\x3e",
chooseLayer:"Choose a layer",findLocationsIn:"Find the nearest locations in:",outputLayersLabel:"Result layer names",straightLineDistance:"Line distance",resultLabel1:"Nearest locations layer",resultLabel2:"Connecting lines layer",outputConnectingLayerName:"Nearest ${layer} to ${sumNearbyLayerName} (Lines)",chooseLayerInfoLabel:"Both input layers must contain points to enable Driving distance and Driving time options",analysisLayerLabel:"Choose the layer from which the nearest locations are found:"},
mergeLayers:{mergeLayersDefine:"Merge \x3cb\x3e${layername}\x3c/b\x3e with",outputLayerName:"Merge ${layername} ${mergelayername}",chooseMergeLayer:"Choose layer to merge",mergeFieldsLabel:"Modify merging fields (optional)",itemDescription:"Feature layer generated from running the Merge Layers solution.",itemTags:"Analysis Result, Merge Layers, ${layername}",itemSnippet:"Feature layer generated from Merge Layers",resultLabel:"Result layer name",rename:"Rename",remove:"Remove",match:"Match",operation:"Operation",
fieldTypeMatchValidationMsg:"Fields to be matched must have the same type.  Transformation of types is supported (for example, double to integer, integer to string) except for string to numeric.",analysisLayerLabel:"Choose layer"},findExistingLocations:{findExpLabel:"Build a query to find features",outputLayerName:"Find Locations in ${analysisLayerName}",itemDescription:"Feature layer generated from running the Find Existing Locations solutions for  ${analysisLayerName}.",itemTags:"Analysis Result, Find Existing Locations, ${analysisLayerName}",
itemSnippet:"Feature layer generated from Find Existing Locations",analysisLayerLabel:"Choose layer containing features you want to find using attribute and spatial queries"},deriveNewLocations:{findExpLabel:"Derive new locations that match the following expression(s)",outputLayerName:"New Locations",itemDescription:"Feature layer generated from running the Derive New Locations solutions.",itemTags:"Analysis Result, Derive New Locations, ${analysisLayerName}",itemSnippet:"Feature layer generated from Find Existing Locations"},
findSimilarLocations:{toolDefine:"Find locations that are similar to: \x3cb\x3e${layername}\x3c/b\x3e",labelOneText:"You may use all locations or make a selection",labelTwoText:"Search for similar locations in",labelThreeText:"Base similarity on",labelFourText:"Show me",outputLayerName:"Most Similar ${analysisLayerName}",selectTargetFtrs:"Select one or more target features",useAllFtrs:"Use all features",itemDescription:"Feature layer generated from running the Find Similar Locations solutions for  ${analysisLayerName}.",
itemTags:"Analysis Result, Find Similar Locations, ${analysisLayerName}",itemSnippet:"Feature layer generated from Find Similar Locations",allResults:"all locations from most to least similar",justShowTop:"the top",selectSearchLayer:"Select the search layer",query:"Query",noFieldMatchMsg:"Search layer and input layer do not have any fields in common.",reqSelectionMsg:"You must select the feature(s) to match by making an interactive selection or by constructing a query.",selectedFeaturesLabel:"${total} feature(s) selected",
analysisLayerLabel:"Choose layer containing the reference locations",most:"most",least:"least",mostLeast:"most and least",chooseFldAdd:"Choose fields to add to results",determineLbl:"Determine the most and least similar using",fieldValues:"field values",fieldProfiles:"field profiles",similarLocations:"similar locations",fieldProfilesValidCheck:"You must provide at least two fields to base similarity on for the field profile method."},expressionGrid:{addExpr:"Add Expression",expression:"Expression",
editExpr:"Edit Expression",viewText:"View Text",viewGrid:"View Grid",addExprDescription:"Click Add Expression to begin building your query.",duplicateExpression:"This Expression already exists"},expressionForm:{where:"where (attribute query)",whereLabel:"where",intersects:"intersects",notIntersects:"does not intersect",withinDistance:"within a distance of",notWithinDistance:"not within a distance of",contains:"completely contains",notContains:"does not completely contain",completelyContains:"completely contains",
notCompletelyContains:"does not completely contain",within:"completely within",notWithin:"not completely within",completelyWithin:"completely within",notCompletelyWithin:"not completely within",identical:"are identical to",notIdentical:"are not identical to",touches:"touches",notTouches:"does not touch",crossesOutline:"crossed by the outline of",notCrossesOutline:"not crossed by the outline of",from:"from",inValidAttributeFilterMessage:"Layer ${layername} does not contain any attributes that can be used in an attribute query."},
interpolatePointsTool:{toolDefine:"Interpolate values from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"${layername} Prediction",interpolationMethod:"Interpolation method",selectAttributesLabel:"Choose field to interpolate",classifyLabel:"Classify by",classesCountLabel:"Number of classes",equalInterval:"Equal Interval",manual:"Manual",quantile:"Equal Area",geometricInterval:"Geometric Interval",outputPredictionErrors:"Output prediction errors",interpolateWithin:"Clip output to",predictLocLabel:"Predict at these locations",
choosePointLayer:"Choose point layer",pointlayerName:"Drawn Prediction Points",classBreakValues:"Class break values",defaultBoundingOption:"Choose study area",classBreaksHelp:"Enter break values separated by spaces: (10 20 30)",itemDescription:"Feature layer generated from running the Interpolate Points solution.",itemTags:"Analysis Result, Interpolate Points, ${layername}, ${fieldname}",itemSnippet:"Feature layer generated from Interpolate Points",analysisLayerLabel:"Choose point layer containing locations with known values"},
calculateDensityTool:{toolDefine:"Calculate density values from \x3cb\x3e${layername}\x3c/b\x3e",selectAttributesLabel:"Use a count field (optional)",outputAerealUnits:"Output area units",itemDescription:"Feature layer generated from running the Calculate Density solution.",itemTags:"Analysis Result, Calculate Density, ${layername}, ${fieldname}",itemSnippet:"Feature layer generated from Calculate Density",outputLayerName:"${layername} Density",searchDistance:"Search Distance",naturalBreaks:"Natural Breaks",
standardDeviation:"Standard Deviation",chooseCountField:"No count field",analysisLayerLabel:"Choose point or line layer from which to calculate density",analysisLayerLabelBigData:"Choose a point layer from which to calculate density",selectAttributesLabelBigData:"Choose one or more fields to calculate density on (optional)",binTypeLabel:"Choose a bin shape",square:"Square",hexagon:"Hexagon",chooseBinSizeLabel:"Select the bin size for aggregation",weightLabel:"Select the density weighting to apply",
uniform:"Uniform",kernel:"Kernel",selectNeighborhoodLabel:"Select the neighborhood size",areaLabel:"Choose the output units for density",calTimeSliceLabel:"Calculate density using time steps (optional)",intervalLabel:"Time step interval",repeatLabel:"How often to repeat the time step",timeRefLabel:"Time to align time steps to",smallBinErrorMsg:"Neighborhood size must be greater than bin size."},traceDownstreamTool:{toolDefine:"Trace downstream from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"${layername} Trace",
choosePointLayer:"Choose point layer",pointlayerName:"Drawn Input Points",defaultBoundingOption:"Choose study area",itemDescription:"Feature layer generated from running the Trace Downstream solution.",itemTags:"Analysis Result, Trace Downstream, ${layername}",itemSnippet:"Feature layer generated from Trace Downstream",clipOutputToLabel:"Clip output to",traceOptionsLabel:"Trace downstream settings (optional)",splitTraceLabel:"Split the trace into line segments",maxTraceLabel:"Maximum distance of the trace",
analysisLayerLabel:"Point features used as the starting locations for each downstream trace"},createWatershedTool:{toolDefine:"Create Watersheds from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"${layername} Watersheds",choosePointLayer:"Choose point layer",pointlayerName:"Drawn Input Points",defaultBoundingOption:"Choose study area",itemDescription:"Feature layer generated from running the Create Watershed solution.",itemTags:"Analysis Result, Create Watersheds, ${layername}",itemSnippet:"Feature layer generated from Create Watershed",
searchDistanceLabel:"Search distance to nearest drainage (optional)",analysisLayerLabel:"Point features to use for calculating watersheds"},chooseBestFacilitiesTool:{goalLabel:"Goal",facTodemLabel:"Facility to Demand",demTofacLabel:"Demand to Facility",demandLayer:"Demand Locations Layer",demandLabel:"Your layer has ${numberOf} demand locations.",demandExtentLabel:"The current map extent shows ${numberOf} demand locations.",facilitiesNumLabel:"Your layer has ${numberOf} required facilities.",facilitiesExtentLabel:"The current map extent shows ${numberOf} required facilities.",
candidateNumLabel:"Your layer has ${numberOf} candidate facilities.",candidateExtentLabel:"The current map extent shows ${numberOf} candidate facilities.",demandAmountLabel:"Amount of demand at each demand location:",constLabel:"Constant",maxTravelLabel:"Maximum travel range:",unlimitedLabel:"Unlimited",reqdFacilities:"Required Facilities Layer",candFacilities:"Candidate Facilities Layer",capacityLabel:"Capacity",minimizeImpedance:"Minimize travel",allocate:"Allocate to existing facilities",maximizeCoverage:"Maximize coverage",
maximizeCapacitatedCoverage:"Maximize coverage with capacity",percentCoverage:"Cover a percentage of demand",numberCandidates:"Number of candidates to choose:",travelDirection:"Travel Direction:",reqFacLayerLabel:"Required facilities point layer:",outputLayerName:"Assigned facilities for ${demandLayer}",delieveries:"Delieveries",demand:"Demand",pickups:"Pickups",weight:"Weight",demandPercentCover:"Percent of Demand to cover:",selectGoal:"Select the option that best fits your goal",allocateDesc:"Allocate demand locations to existing facilities based on the supply at the facility and the amount of demand from the surrounding area.",
minimizeImpedanceDesc:"Locate facilities such that the overall travel time or travel distance between the demand locations and facilities is minimized.",maximizeCoverageDesc:"Locate facilities such that the maximum amount of demand is allocated, with all the demand from each demand location allocated to the single facility closest to it.",maximizeCapacitatedCoverageDesc:"Locate facilities such that the maximum amount of demand is allocated, with all the demand from each demand location allocated to the single facility closest to it without exceeding the capacity of the facility.",
percentCoverageDesc:"Locate the minimum number of facilities that are required to cover the given percentage of demand.",candidateLayerLabel:"Candidate facilities point layer:",noneReqOption:"There are no facilities that must be always used",maxDemandLocationMsg:"Number of features in demand locations layer cannot be greater than ${maximumDemandPoints}.",maxFacilitiesMsg:"Number of features in required facilities layer  cannot be greater than ${maximumFacilities}.",candidateCountMsg:"Number of features in candidate facilities layer should be greater than number of candidates to choose.",
candidateCountValidMsg:"Sum of candidates to choose and number of features in required facilities layer cannot be greater than ${maximumFacilitiesToFind}."},createViewshedTool:{toolDefine:"Create areas that are visible from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"${layername} visible areas",itemDescription:"Feature layer generated from running the Create Viewshed solution.",itemTags:"Analysis Result, Create Viewshed, ${layername}",itemSnippet:"Feature layer generated from Create Viewshed",
maxDistanceLabel:"Maximum viewing distance",observerHghtLabel:"Height of observer locations",targetHghtLabel:"Height of other objects on the ground",viewshedOptionlabel:"Visibility settings (optional)",maxDistanceValidMsg:"The maximum viewing distance cannot be more than ${limit} ${units}.",maxdistanceInValidMsg:"Only integer values are allowed",analysisLayerLabel:"Point features that represent observer locations",pointlayerName:"Drawn Input Points"},calculateSlopeTool:{toolDefine:"Calculate Slope from \x3cb\x3e${layername}\x3c/b\x3e",
outputLayerName:"${layername} Slope",defaultBoundingOption:"Choose study area",itemDescription:"Analysis Image Service generated from Calculate Slope",itemTags:"Analysis Result, Calculate Slope, ${layername}",itemSnippet:"Analysis Image Service generated from Calculate Slope",zFactorInputLabel:"Specify scaling factor for elevation",analysisLayerLabel:"Choose input data to calculate slope"},deriveAspectTool:{toolDefine:"Derive Aspect from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"Aspect of ${layername}",
defaultBoundingOption:"Choose study area",itemDescription:"Analysis Image Service generated from Derive Aspect",itemTags:"Analysis Result, Derive Aspect, ${layername}",itemSnippet:"Analysis Image Service generated from Derive Aspect",analysisLayerLabel:"Choose input data to derive aspect"},monitorVegetationTool:{monitorVegetation:"Monitor Vegetation",toolDefine:"Monitor vegetation in \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"Monitor Vegetation of ${layername}",indexType:"Choose method to monitor vegetation",
bandIndexes:"Specify indexes of NIR band and Red band",nirBandIndex:"NIR band index",redBandIndex:"Red band index",greenVegetativeCover:"Amount of green vegetation cover",slopeOfSoilLine:"Slope of soil line",gradientOfSoilLine:"Intercept of soil line",adjustmentFactor:"Adjustment factor",NDVI:"Normalized Difference Vegetation Index",SAVI:"Soil-Adjusted Vegetation Index",TSAVI:"Transformed Soil-Adjusted Vegetation Index",GEMI:"Global Environmental Monitoring Index",PVI:"Perpendicular Vegetation Index",
MSAVI:"Modified Soil Adjusted Vegetation Index",GVITM:"Green Vegetation Index - Landsat TM",Sultan:"Sultan's Formula",Options:"Remap pixel values to new values",minimum:"Minimum",maximum:"Maximum",output:"Output",addItemLabel:"Add an entry",removeItemLabel:"Remove selected entry",analysisLayerLabel:"Select the input data",itemDescription:"Analysis Image Service generated from Monitor Vegetation",itemTags:"Analysis Result, Monitor Vegetation, ${layername}",itemSnippet:"Analysis Image Service generated from Monitor Vegetation"},
remapValuesTool:{toolDefine:"Remap Pixel Values in ${layername}",outputLayerName:"Remapped Raster from ${layername}",remapList:"Remap pixel values to new values",analysisLayerLabel:"Choose input data to remap values",itemDescription:"Analysis Image Service generated from Remap",itemTags:"Raster Analysis Result, Remap",itemSnippet:"Analysis Image Service generated from Remap",clipping:"Specify the area to be remapped",add:"Add",remove:"Remove",viewText:"View"},extractRasterTool:{toolDefine:"Extract Data from ${layername}",
outputLayerName:"Data extracted from ${layername}",clipping:"Specify clipping geometry",clippingInside:"Data inside the geometry",clippingOutside:"Data outside the geometry",clippingExtent:"Use current extent",clippingGeometry:"Choose study area",analysisLayerLabel:"Choose input data to extract",itemDescription:"Analysis Image Service generated from Extract Raster Data",itemTags:"Raster Analysis Result, Extract Raster Data",itemSnippet:"Analysis Image Service generated from Extract Raster Data"},
reconstructTracksTool:{inputFeatures:"Choose features to reconstruct tracks from",trackField:"Choose one or more fields to identify tracks",bufField:"Create an expression to buffer input features by (optional)",durSplit:"Select a time to split tracks by (optional)",methodLabel:"Choose method used to reconstruct tracks",itemDescription:"Feature layer generated from running the Reconstruct Tracks solution for ${inputLayername}.",itemTags:"Analysis Result, Reconstruct Tracks, ${inputLayername}",itemSnippet:"Feature layer generated from Reconstruct Tracks",
outputLayerName:"Reconstruct Tracks for ${inputLayername}"},summarizeAttributesTool:{inputFeatures:"Choose the input to summarize",fieldLabel:"Choose the fields to summarize",addStatsLabel:"Add statistics (optional)",itemDescription:"Feature layer generated from running the Summarize Attributes solution for ${inputLayername}.",itemTags:"Analysis Result, Summarize Attributes, ${inputLayername}",itemSnippet:"Feature layer generated from Summarize Attributes.",outputLayerName:"Summarize Attributes for ${inputLayername}"},
summarizeRasterWithinTool:{toolDefine:"Summarize Raster Within ${layername}",outputLayerName:"Summarize within ${layername}",outputLayerNameFull:"Summarize ${valuelayername} within ${layername}",statsLabel:"Choose statistic to calculate",fieldLabel:"Choose field to define the boundaries",summarizeLayerLabel:"Choose raster layer to summarize",ignoreNDLabel:"Ignore missing values in calculation",ignoreLabel:"Ignore",analysisLayerLabel:"Choose area layer to summarize a raster layer within defined boundaries",
itemDescription:"Analysis Image Service generated from Summarize Raster Within",itemTags:"Raster Analysis Result, Summarize Raster Within, ${layername}, ${valuelayername}",itemSnippet:"Analysis Image Service generated from Summarize Raster Within"},createSpaceTimeCubeTool:{inputLabel:"Choose input points to create a space time cube from",binSizeLabel:"Choose the bin size",binShapeLabel:"Choose a bin shape",timeIntervalSizeLabel:"Choose the time interval size",timeAlignLabel:"Choose how the time will be aligned",
startTime:"Start Time",endTime:"End Time",referenceTime:"Reference Time",referenceTimeLabel:"Select the reference time",summaryFieldsLabel:"Select the statistics you would like to calculate, and how to fill empty bins",itemDescription:"Feature layer generated from running the Create Space Time Cube solution for ${pointLayername}.",itemTags:"Analysis Result, Create Space Time Cube, ${pointLayername}",itemSnippet:"Feature layer generated from Create Space Time Cube.",outputLayerName:"Create Space Time Cube for ${pointLayername}"},
joinFeaturesTool:{joinFeaturesTitle:"Join Features",targetLayerLabel:"Choose target layer",joinLayerLabel:"Choose layer to join to target layer",joinTypeLabel:"Choose join operation",joinOptionsLabel:"Select one or more joins",spatialJoinLabel:"Spatial Join",temporalJoinLabel:"Temporal Join",attributeJoinLabel:"Attribute Join",statisticsLabel:"Add statistics (optional)",resultLabel:"Result layer name",runAnalysis:"Run Analysis",showCredits:"Show Credits",oneToOneLabel:"Join one to one",oneToManyLabel:"Join one to many",
selectJoinField:"Join field",selectTargetField:"Target field",near:"Near",equalsLabel:"Equals",intersectsLabel:"Intersects",crossesLabel:"Crosses",withinLabel:"Within",containsLabel:"Contains",touchesLabel:"Touches",overlapsLabel:"Overlaps",duringLabel:"During",finishesLabel:"Finishes",finishedByLabel:"Finished By",overlappedByLabel:"Overlapped By",startsLabel:"Starts",startedByLabel:"Started By",meetsLabel:"Meets",metByLabel:"Met By",equalSign:"\x3d",notEqualSign:"!\x3d",selectField:"Field",selectStats:"Statistic",
itemDescription:"Feature layer generated from running the Join Features solution",itemTags:"Analysis Result, Join Features",itemSnippet:"Feature layer generated from Join Features",saveResultIn:"Save result in",useMapExtent:"Use current map extent",selectTargetLayer:"Select the target layer",joinOperationLbl:"Build an expression to join features by (optional)",selectJoinLayer:"Select the join layer",selectJoinOpLabel:"Select the join operation",joinTypesErrorMsg:"Please select at least one type of join from Step 3.",
joinOpErrorMsg:"Please select a join operation from Step 3.",joinLayerErrorMsg:"Please select a valid layer from Step 2.",addJoinCondition:"Join Condition",joinOptionsStdLabel:"Select the type(s) of join",identical:"Identical to",withinDistance:"Within a distance of",completelyContains:"Completely contains",completelyWithin:"Completely within",outputLayerName:"Join Features to ${targetLayerName}"},copytoDatastoreTool:{inputLabel:"Choose layer to copy",dataStoreCopyLabel:"Choose the Data Store to copy to",
itemDescription:"Feature layer generated from running the Copy to Data Store solution for ${inputLayerName}.",itemTags:"Analysis Result, Copy to Data Store, ${inputLayerName}",itemSnippet:"Feature layer generated from Copy to Data Store.",outputLayerName:"Copy to Data Store for ${inputLayerName}"},convertFeatureToRasterTool:{toolDefine:"Convert Features in ${layername} To Raster",outputLayerName:"Rasterization ${layername}",pixelSize:"Output cell size",valueField:"Choose field",backgroundValue:"Background value (optional)",
analysisLayerLabel:"Choose feature layer to convert",itemDescription:"Analysis Image Service generated from Convert Feature To Raster",itemTags:"Raster Analysis Result, Convert Feature To Raster, ${layername}",itemSnippet:"Analysis Image Service generated from Convert Feature To Raster"},convertRasterToFeatureTool:{toolDefine:"Convert ${layername} To Feature",outputLayerName:"Vectorization of ${layername}",valueField:"Choose field",outputType:"Choose output type",point:"Point",line:"Line",polygon:"Polygon",
simplify:"Simplify lines or polygons",analysisLayerLabel:"Choose raster layer to convert",itemDescription:"Feature layer generated from Convert Raster To Feature",itemTags:"Raster Analysis Result, Convert Raster to Feature, ${layername}",itemSnippet:"Feature layer generated from Convert Raster To Feature"},calculateDensityRasterTool:{toolDefine:"Calculate density values from \x3cb\x3e${layername}\x3c/b\x3e",selectAttributesLabel:"Use a count field (optional)",outputAreaUnits:"Output area units (optional)",
searchDistance:"Search distance (optional)",searchDistanceHint:"Search distance",itemDescription:"Analysis Image Service generated from Calculate Density",itemTags:"Analysis Result, Calculate Density, ${layername}, ${fieldname}",itemSnippet:"Analysis Image Service generated from Calculate Density",outputLayerName:"${layername} Density",outputCellSize:"Output cell size (optional)",cellSizeHint:"Cell size",chooseCountField:"No count field",analysisLayerLabel:"Choose input point or line layer from which to calculate density"},
createViewshedRasterTool:{toolDefine:"Create areas that are visible from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"${layername} visible areas",outputAgLayerName:"${layername} height to become visible",itemDescription:"Analysis Image Service generated from Create Viewshed",itemTags:"Analysis Result, Create Viewshed, ${layername}",itemSnippet:"Analysis Image Service generated from Create Viewshed",elevationSurfaceLabel:"Elevation surface",inputObserverLabel:"Point feature that represent observer locations",
options:"Options",maxDistanceLabel:"Maximum viewing distance",minDistanceLabel:"Minimum viewing distance",observerEleLabel:"Elevation of observer locations",observerHghtLabel:"Height of observer",targetHghtLabel:"Height of target",resultAgLayer:"Output height to become visible (optional)",distance:"Distance",elevation:"Elevation",field:"Field",height:"Height",optimizeFor:"Optimize for",dist3D:"Distance is 3D",speed:"Speed",accuracy:"Accuracy",maxDistanceValidMsg:"The maximum viewing distance cannot be more than ${limit} ${units}.",
maxdistanceInValidMsg:"Only integer values are allowed",analysisLayerLabel:"Point features that represent observer locations"},interpolatePointsEBKTool:{toolDefine:"Interpolate values from \x3cb\x3e${layername}\x3c/b\x3e",outputLayerName:"${layername} Prediction",outputErrorLayerName:"${layername} Error",outputTableName:"${layername} Diag",interpolationMethod:"Interpolation method",optimizeFor:"Optimize for",selectAttributesLabel:"Choose field to interpolate",outputPredictionErrors:"Output prediction errors",
outputDiagnosticTable:"Output diagnostic table",choosePointLayer:"Choose point layer",itemDescription:"Analysis Raster Service generated from Interpolate Points",itemTags:"Analysis Result, Interpolate Points, ${layername}, ${fieldname}",itemSnippet:"Analysis Raster Service generated from Interpolate Points",speed:"Speed",accuracy:"Accuracy",options:"Options",optionalOutputs:"Optional outputs",outputCellsize:"Output cell size (optional)",enterDistance:"Enter distance",chooseField:"Choose field",transform:"Transform data to normal distribution",
sizeOfLocalModels:"Size of local models",numberOfNeighbors:"Number of neighbors",analysisLayerLabel:"Choose point layer containing locations with known values",sizeOfLocalModelsInValidMsg:"Size of local models must be in [30,500]",numberOfNeighborsInValidMsg:"Number of neighbors must be in [1,64]",cellsizeInValidMsg:"Cell Size must be \x3e 0"},analysisSettings:{overwriteResultLayer:"Overwrite result layer",closeAnalysisWisget:"Close analysis widget after running analysis",storeAnalysisResults:"Store feature analysis results as a Features",
analysisEnv:"Analysis Environments",CoordinateSys:"Coordinate Systems",outSR:"Output coordinate system",processSR:"Processing coordinate system",processExtent:"Processing Extent",extent:"Extent",defaultExtentLabel:"Same as input",extentSpecfiedBelow:"As specified",extentBelow:"As specified Below",xMin:"X min",xMax:"X max",yMin:"Y min",yMax:"Y max",rasterLabel:"Raster Analysis",cellSize:"Cell size",mask:"Mask",coordSysDialogTitle:"Coordinate System",geographicCS:"Geographic coordinate system",projCS:"Projected coordinate system",
spatiaReferences:"Spatial References",layers:"Layers",favorites:"Favorites",defaultLabel:"Default",extentAsDisplay:"Same as display",extentAsLayer:"Same as ${layername}",maxInputs:"Maximum of Inputs",minInputs:"Minimum of Inputs",extentUnion:"union of inputs",extentInter:"Intersection of inputs",snapRaster:"Snap Raster"},findOutliersTool:{chooseLayerLabel:"Choose the layer for which outliers will be calculated",chooseAttributeLabel:"Find outliers of",outputLayerName:"Find Outliers ${layername}",itemDescription:"Feature layer generated from running the Find Outliers solution.",
itemTags:"Analysis Result, Find Outliers, ${layername}, ${fieldname}",itemSnippet:"Feature layer generated from Find Outliers",cellSizeMsg:"Cell size should be less than distance band."},geocodeFromTableTool:{chooseFromTable:"Choose an input table",chooseLocator:"Choose a locator",chooseOutputFormat:"Choose an output format",outputResultName:"Output result name",locators:"Locators",inputGeocode:"Input to Geocode",country:"Country",selectDataFields:"Select Data Fields",singeField:"Single Field",multipleFields:"Multiple Fields",
locatorInputs:"Locator Inputs",dataFields:"Data Fields",outputLayerName:"Geocoded Results for ${inputTableName} ",itemDescription:"Geocoded results for ${inputTableName} generated from running the Geocode Locations from Table solution.",itemTags:"Analysis Result, Geocode Locations From Table, ${inputTableName}",itemSnippet:"Feature layer generated from Geocode Locations From Table"},analysisMsgCodes:{RA_120101:"The following table contains cross validation statistics:",RA_120102:"Mean Error",RA_120103:"Root Mean Square",
RA_120104:"Average Standard",RA_120105:"Mean Standardized",RA_120106:"Root Mean Square Standardized",SS_84493:"There was 1 outlier location; it was not used to compute ${AggregationType}.",SS_84492:"The total study area was ${Area}.",SS_84491:"There were ${NumFeatures} valid input aggregation areas.",SS_84490:"The aggregation process resulted in ${AggNumFeatures} weighted areas.",SS_84489:"Analysis was performed on all aggregation areas.",SS_84485:"There were ${NumFeatures} valid input features.",
SS_84477:"Blue output features represent cold spots where low ${FieldName} cluster.",SS_84476:"Red output features represent hot spots where high ${FieldName} cluster.",SS_84471:"Output",SS_84470:"There are ${NumSignificant} output features statistically significant based on a FDR correction for multiple testing and spatial dependence.",SS_84466:"Hot Spot Analysis",SS_84465:"The optimal fixed distance band was based on one standard distance of the features from the geometric mean: ${DistanceInfo}.",
SS_84464:"The optimal fixed distance band was based on the average distance to ${NumNeighs} nearest neighbors: ${DistanceInfo}.",SS_84461:"The optimal fixed distance band selected was based on peak clustering found at ${DistanceInfo}.",SS_84459:"Scale of Analysis",SS_84458:"Analysis was based on the number of points in each polygon cell.",SS_84457:"Points were aggregated to the fishnet polygon cells falling within the bounding areas provided.",SS_84453:"Analysis was performed on all fishnet polygon cells within the bounding area layer.",
SS_84452:"Analysis was performed on all fishnet polygon cells containing at least one point.",SS_84451:"Analysis was based on the number of points in each fishnet polygon cell.",SS_84450:"The polygon cell size was ${SnapInfo}.",SS_84449:"A fishnet polygon mesh was created for aggregating points.",SS_84446:"${VarName} Properties:",SS_84444:"Incident Aggregation",SS_84437:"There were no locational outliers.",SS_84434:"There were ${NumOutliers} outlier locations; these were not used to compute ${AggregationType}.",
SS_84428:"Initial Data Assessment.",SS_84271_0:"Min",SS_84272_0:"Max",SS_84261_0:"Mean",SS_84262_0:"Std. Dev.",SS_00002:"The following report outlines the workflow used to optimize your Find Hot Spots result:",AO_100001:"Aggregate Points failed.",AO_100002:"The geometry type of Point Layer must be points.",AO_100003:"The geometry type of  Polygon Layer must be polygons.",AO_100004:"The field  ${fieldName} provided for Summary Fields does not exist.",AO_100005:"The field  ${fieldName} provided for Summary Fields is not numeric.",
AO_100006:"The summary type ${summary} provided for field ${fieldName} is invalid.",AO_100007:"Find Hot Spots failed.",AO_100008:"The geometry type for the boundingPolygonLayer must be polygon.",AO_100009:"The geometry type of Analysis Layer must be points or polygons.",AO_100010:"The geometry type of Aggregation Polygon Layer must be polygon.",AO_100011:"Must provide an Analysis Field for polygon Analysis Layer.",AO_100012:"Create Buffers failed.",AO_100013:"Overlay Layers failed.",AO_100014:"Summarize Within failed.",
AO_100015:"The geometry type of Summarize Layer input must be point, line, or polygons.",AO_100016:"The geometry type of Summarize Layer input must be point or line.",AO_100017:"The geometry type of Summarize Layer input must be point.",AO_100018:"Sum Units ${sumUnits} is not applicable for ${shapeType} shape type.",AO_100019:"At least one of the parameters, Summarize Shape or  Summary Fields is required.",AO_468:"Input shape types are not equal.",AO_1156:"A field value was incompatible with the field type.",
AO_800:"The value is not a member of SUM | MEAN | MIN | MAX | RANGE | STD | COUNT | FIRST | LAST.",AO_728:"The analysisField ${fieldName} you specified does not exist in the analysisLayer.",AO_12:"Field to add already exists.",AO_539:"Expression is invalid.",AO_1115:"Layer description property must be set for ${layerName}.",AO_366:"Invalid geometry type.",AO_641:"This tool requires at least ${numFeatures} feature(s) to compute results.",AO_906:"Zero variance: all of the values for your input field are likely the same.",
AO_1533:"We were not able to compute hot and cold spots for the data provided. If appropriate, try specifying an Analysis Field.",AO_1534:"Hot and cold spots cannot be computed when the number of points in every polygon area is identical. Try different polygon areas or different analysis options.",AO_1535:"The analysis option you selected requires a minimum of ${minNumFeatures} aggregation areas.",AO_1536:"The analysis options you selected require a minimum of ${minNumIncidents} points to compute hot and cold spots.",
AO_1570:"The analysis option you selected requires a minimum of ${minNumIncidents} points to be inside the bounding polygon area(s).",AO_1571:"The analysis options you selected require a minimum of ${minNumFeatures} features with valid data in the analysis field in order to compute hot and cold spots.\t",AO_1572:"There is not enough variation in point locations to compute hot and cold spots. Coincident points, for example, reduce spatial variation. You can try providing a bounding area, aggregation areas (a minimum of 30), or an Analysis Field.",
AO_1573:"There is not enough variation among the points within the bounding polygon area(s). You can try providing larger boundaries.",AO_1574:"The analysis option you selected requires a minimum of ${minNumIncidents} points to be inside the aggregation polygons.",AO_1575:"All of the values for your analysis field are likely the same. Hot and cold spots cannot be computed when there is no variation in the field being analyzed.",AO_84426:"Must provide polygons for aggregating incidents into counts for this incident data aggregation method.",
AO_26:"Buffer distance is zero.",AO_109:"The buffer distance cannot be negative for lines and points.",AO_385:"The LINE option is not valid with point features.",AO_438:"Overlay not polygon.",AO_100020:"Enrich Layer failed.",AO_100021:"The geometry type of Input Layer must be point, line or polygon.",AO_100022:"Units ${units} is not supported for Buffer type ${bufferType}.",AO_100023:"Unable to enrich layer for input spatial reference ${spref}.",AO_100024:"The number of features in ${inputLayer} is zero.",
AO_100025:"Summarize Nearby failed.",AO_100026:"Extract Data failed.",AO_100027:"Dissolve Boundaries failed.",AO_100028:"Create Drive Time Areas failed.",AO_100029:"Merge Layers failed.",AO_100030:"Find Nearest failed.",AO_100031:"The number of nearest locations to find can not be greater than 100.",AO_100032:"The number of features in ${analysisLayer} is zero.",AO_100033:"The number of features in ${nearLayer} is zero.",AO_100034:"The number of features in ${analysisLayer} can not be greater than 1000.",
AO_100035:"The number of features in ${nearLayer} can not be greater than 1000.",AO_100036:"The ${analysisLayer} layer must have a point geometry type when using ${measurementType} as the measurement type.",AO_100037:"The ${nearLayer} layer must have a point geometry type when using ${measurementType} as the measurement type.",AO_100038:"The search cutoff cannot be less than zero.",AO_100039:"The ${inputLayer} must have a point geometry type.",AO_100040:"The number of features in ${inputLayer} can not be greater than ${max}.",
AO_100041:"Buffer type parameter is supported only for layers containing points or lines.",AO_100042:"The geometry type ${shapeType} of Nearby Layer is not supported for Near type ${nearType}",AO_100043:"Units ${units} is not supported for Near type ${nearType}.",AO_100044:"Distance value should be greater than 0",AO_100045:"Distance and units are required when Buffer type is specified",AO_100046:"Failed to access GeoEnrichment server.",AO_100047:"Enrichment may not be available for some features.",
AO_100048:"The input layer ${inputLayer} contains multipoint geometry and has been converted to single point geometry.",AO_100049:"No features in the processing extent for any input layers.",AO_100050:"No fields exist in the input layer for data extraction.",AO_100051:"No features in the processing extent for any input layers and none of the input layers have fields for data extraction. ",AO_100052:"The field name ${fieldName} does not exist in the ${paramName}.",AO_100053:"Required keys ${missingKeys} are missing in attribute expression ${expression}.",
AO_100054:"Required keys ${missingKeys} are missing in spatial relationship expression ${expression}.",AO_100055:"Invalid expression; malformed JSON.",AO_100056:"Invalid layer index in expression ${expression}.",AO_100057:"Layer index exceeds the number of input layers in expression ${expression}.",AO_100058:"${spatialRel} spatial relationship does not support ${lyrGeomType}/${selLyrGeomType} geometry types for layer/selectingLayer in expression ${expression}.",AO_100059:"Invalid spatial relationship {spatialRel} in expression ${expression}.",
AO_100060:"Query expression failed in expression ${expression}.",AO_100061:"FindExistingLocations failed.",AO_100062:"Invalid distance and/or units in expression ${expression}",AO_100063:"PlanRoutes failed.",AO_100064:"The number of features in ${stopsLayer} is zero.",AO_100065:"The number of features in ${startLayer} is zero.",AO_100066:"The maximum number of vehicles to route cannot be less than zero and greater than ${max}.",AO_100067:"The maximum number of stops per vehicle cannot be less than zero and greater than ${max}.",
AO_100068:"The number of features in ${stopsLayer} cannot be greater than ${max}.",AO_100069:"The number of features in ${startLayer} cannot be greater than ${max}.",AO_100070:"The number of features in ${endLayer} cannot be greater than ${max}.",AO_100071:"The ${stopsLayer} layer must have a point geometry type.",AO_100072:"The ${startLayer} layer must have a point geometry.",AO_100073:"The ${endLayer} layer must have a point geometry.",AO_100074:"The time spent at each stop cannot be less than zero.",
AO_100075:"The total route time per vehicle should be greater than zero and less than one year (525600 minutes).",AO_100076:"The ${endLayer} should not be specified if return to start is true.",AO_100077:"Find Similar Locations failed.",AO_100078:"Invalid field name in expression ${expression}",AO_100079:"Derive New Locations failed.",AO_100080:"Connect Origins To Destinations failed.",AO_100081:"Field Calculator failed.",AO_735:"Please provide at least one valid analysis field to base similarity on.",
AO_1589:"This tool requires a minimum of 2 locations to search.",AO_100082:"A field name and an expression are required.",AO_100083:"A field type is required for creating a new field.",AO_100084:"Field type is required to be String, Integer, Double or Date.",AO_1599:"Too few records for analysis. This tool requires at least 1 reference  location in the Input Layer to compute results.",AO_100088:"Field(s) ${attribute} must be in both the reference and candidate search layers.",AO_100089:"The following fields lack sufficient variation for use in this analysis: ${attribute}.",
AO_100090:"This tool requires at least 2 candidate search locations that are not also reference locations.",AO_100094:"The maximum number of vehicles to route must be equal to the number of features in ${startLayer}.",AO_100104:"InterpolatePoints failed.",AO_40039:"Not enough data to compute method. At least 10 points are required.",AO_40040:"Data is distributed along a straight line and cannot be processed.",AO_40069:"The variance of the data is too small to be calculated.",AO_100091:"The geometry type of ${paramName} must be Points",
AO_100092:"The geometry type of boundingPolygonLayer must be Polygons",AO_100093:"The classification type Manual requires classbreaks value.",AO_100095:"The number of features in ${endLayer} must be equal to the number of features in ${startLayer}.",AO_100096:"The ${startLayerRouteIDField} in ${startLayer} does not have unique values.",AO_100097:"The ${endLayerRouteIDField} in ${endLayer} does not have unique values.",AO_100098:"The values in ${startLayerRouteIDField} in ${startLayer} do not have a one-to-one match with the values in ${endLayerRouteIDField} in ${endLayer}.",
AO_100099:"All break values must be greater than zero.",AO_100100:"The features in ${inputLayer} are not within the data coverage area. See availability at ${url}.",AO_100101:"No features in ${inputLayer} are within a distance of ${max} kilometers from streets.",AO_100102:"All features in ${inputLayer} must be in the same time zone when using traffic and creating areas with dissolve or split options.",AO_100103:"The ${measureType} value cannot be greater than ${max} ${breakUnits}.",AO_100105:"CalculateDensity failed",
AO_100106:"Field ${fieldName} is not numeric.",AO_100107:"Field ${fieldName} does not have any positive values.",AO_100108:"Field ${fieldName} has negative values, only positive values will be considered for calculating density.",AO_100109:"The geometry type for the input layer must be points or lines.",AO_100110:"Your user role does not include the geoEnrichment privilege",AO_100111:"Your user role does not include the network analysis privilege",AO_100112:"Your user role does not include the publish hosted features privilege",
AO_100113:"None of the stops were assigned to any routes. Check the Status and Violated Constraints fields in the output unassigned stops layer for more information.",AO_100114:"The time spent at each stop, ${stopServiceTime} minutes, must be less than the total route time per vehicle, ${maxRouteTime} minutes.",AO_100115:"Some stops were not assigned to any routes. Check the Violated Constraints field in the output unassigned stops layer for more information.",AO_100116:"Only ${routesUsed} out of ${routeCount} routes are needed to reach all stops. If you want to use more routes, run Plan Routes again but reduce the limits on the maximum number of stops or the total route time per vehicle.",
AO_100117:"Driving a truck is currently not supported outside of North America and Central America.",AO_100118:"Your user role does not include the create, update and delete content privilege.",GPEXT_001:"Invalid parameter ${name} value",GPEXT_002:"Parameter missing ${name}",GPEXT_003:"Invalid parameter ${name}:property ${propname} is missing",GPEXT_004:"Invalid layer parameter property ${propname} is missing",GPEXT_005:"Failed to access url ${url}.",GPEXT_006:"Accessing url ${url} returned error ${error}.",
GPEXT_007:"Invalid item ${id}",GPEXT_008:"Failed to create service ${name}",GPEXT_009:"Failed to add layer ${lname} to service ${name}",GPEXT_010:"Failed to parse layer JSON",GPEXT_011:"Layer ${url} does not have Extract capability",GPEXT_012:"Invalid External Operation",GPEXT_013:"This tool uses the Geoenrichment Service.  Please refer to ArcGIS Online Service Credit Estimator for more details.",GPEXT_014:"This tool uses Network Analysis Services.  Please refer to ArcGIS Online Service Credit Estimator for more details.",
GPEXT_015:"Select appropriate helper services url from Portal for requested operation.",GPEXT_016:"Invalid layer object.",GPEXT_017:"Service ${name} already exists.",GPEXT_018:"The remote feature service ${url} exceeds the limit of 100,000 features. Create a hosted feature service to analyze large data.",GPEXT_019:"Invalid filter for layer ${url}.",SS_00003:"The following report outlines the summary of your Find Similar Locations result:",SS_00004:"The following report outlines the workflow used to optimize your Find Outliers result:",
SS_84698:"Using a hexagon of width ${HexWidth} and height ${HexHeight}",SS_84703:"The Neighborhood Distance used was ${NeiborDistance}.",SS_84705:"Creating the random reference distribution with ${NumPermutation} permutations.",SS_84708:"There are ${NumLowOutliers} statistically significant low outlier features.",SS_84709:"There are ${NumHighOutliers} statistically significant high outlier features.",SS_84710:"There are ${NumLowClusters} features part of statistically significant low clusters.",SS_84711:"There are ${NumHighClusters} features part of statistically significant high clusters.",
SS_84503:"Summary of Input Features to Match",SS_89997:'["Attribute", "Min", "Max", "SD", "Mean"]',SS_84504:"Summary of Attributes of Interest",SS_84512:'["Attribute", "Min", "Max", "SD", "Mean", "Input"]',SS_84505:"Top ${numResults} Most Similar Locations (Values)",SS_84506:" Top 10 of ${numResults} Most Similar Locations (Values)",SS_84510:'["OID", "SIMRANK", "SIMINDEX"]',SS_89998:' ["", "Total", ${sumIndex}] ',AO_100119:"The geometry type of WithinLayer input must be polygons",AO_100120:"The features in the layer are beyond max request size limit and cannot be enriched",
AO_100121:"CreateViewshed Failed",AO_100122:"TraceDownstream Failed",AO_100123:"CreateWatersheds Failed",AO_100124:"The geometry type of Input Layer must be point for buffer type ${bufferType}",AO_100125:"The groupby field ${fieldName} must be integers, text or date.",AO_100126:"The features in the input layer are beyond max request size and hence simplified",AO_100127:"All input points fall outside of the data coverage area.",AO_100128:"The point field provided must be string or integer",AO_100129:"The point falls outside the catchment extent",
AO_100130:"The point falls outside the processing unit extent",AO_100131:"The maximum viewing distance parameter cannot be more than ${max}${units}",AO_100132:"The DEM source data is not available in the input points area.",AO_100133:"The input DEM resolution is not supported at the specified maximum distance value. Specify a smaller maximum distance value.",AO_100136:"The geometry type for Extent Layer must be polygon.",AO_100137:"A value for the  ${parameterName} is required.",AO_100138:"Some origins were not connected to their paired destinations. Check the Status field in output unassigned origins and unassigned destinations layers for more information.",
AO_100139:"None of the origins could be connected to destinations.",AO_100140:"The features in the Extent Layer are beyond max request size and hence simplified.",AO_100141:"The features in the Extent Layer are beyond max request size limit and cannot be extracted.",AO_100142:"The extent of the input point features exceeds the allowed maximum extent.",AO_100143:"Your user role does not include the elevation analysis privilege.",AO_100144:"The ${serviceName} utility is not registered for the portal.",
AO_100145:"The following travel mode is invalid: ${travelMode}.",AO_100146:"The chosen break units, ${breakUnits}, and travel mode, ${travelMode}, are incompatible. They are not mutually time or distance values.",AO_100147:"The travel mode does not specify a time-based impedance attribute.",AO_100148:"You do not have permissions to access the utility ${serviceName}",AO_100149:"Unable to access registered url for utility ${serviceName}: ${msg}",AO_100150:"Choose Best Facilities failed.",AO_100151:"The chosen travel range units, ${travelRangeUnits}, and travel mode, ${travelMode}, are incompatible. They are not mutually time or distance values.",
AO_100152:"The combined count of features in ${requiredFacilitiesLayer} and ${candidateFacilitiesLayer} cannot be greater than ${max}.",AO_100153:"The value for the ${paramName} parameter must be greater than zero.",AO_100154:"Either specify a value for ${paramName1} or ${paramName2} parameter.",AO_100155:"The candidate facilities layer, ${candidateFacilitiesLayer}, should not be specified for Allocate goal.",AO_100156:"The percentage of demand to cover must be greater than zero and less than or equal to one hundred.",
AO_100157:"The number of candidates to choose cannot be less than the number of features in the required facilities layer.",AO_100158:"The number of candidates to choose cannot be greater than ${max}.",AO_100159:"The number of datacollections is greater than the max limit of ${maxDataCollections}.",BD_109:"Buffer distance cannot be negative for lines and points.",BD_101018:"One or more features were skipped because a negative or very small distance resulted in no geometry.",BD_110047:"The value for the Time Step Interval parameter must be positive and greater than zero.",
BD_110064:"Failed to create the Output Space Time Cube due to the Summary Field ${variableName}. Reconsider the chosen Statistic and Fill Type for this field.",BD_800:"The value is not a member of ${value}.",BD_101010:"The result of your analysis did not return any features. No layer will be created.",BD_101000:"Unable to perform query operation.",BD_101008:"Field '${requiredField}' is required.",BD_101001:"This operation requires time to be set on the source features, missing in '${paramName}'.",
BD_101028:"Starting new distributed job with ${totalTasks} tasks.",BD_101002:"This operation requires geometry to be set on the source features, missing in '${paramName}'.",BD_101003:"The distance interval type is not supported.",BD_101039:"The input ${paramName} is in a geographic coordinate system, but this operation requires a projected coordinate system. Please use a projected dataset or set the processing coordinate system for analysis to be a projected coordinate system.",BD_101004:"The given feature relationship '${targetType} ${relationshipType} ${joinType}' is not valid.",
BD_101005:"Field '${requiredField}' is required if '${setField}' is set.",BD_101006:"The time interval type is not supported. Only whole numbers are allowed.",BD_101007:"At least one relationship is required.",BD_101009:"Field(s) not found in dataset: ${fields}",BD_101011:"One of either '${firstField}' or '${secondField}' is required.",BD_101012:"Both '${firstField}' and '${secondField}' cannot be set at the same time.",BD_101013:"Wrong time type for '${paramName}'. Expected '${expectedType}', got '${actualType}'.",
BD_101014:"The given spatial relationship '${targetGeometryType} ${relationshipType} ${joinGeometryType}' is not valid.",BD_101015:"The set of relationships defined is not valid.",BD_101016:"A spatial reference is required when the GEODESIC option is selected.",BD_101017:"Some planar buffer results may exceed valid extent. Consider using a geodesic buffer to account for the shape of the earth.",BD_26:"Buffer distance is zero.",BD_101019:"One or more features were skipped because of a zero distance field value.",
BD_101020:"One or more features were skipped because of a NULL or EMPTY distance field value.",BD_101021:"One or more features were skipped because of an invalid buffer distance field value.",BD_101031:"Job has been cancelled.",BD_101022:"One or more features were skipped because of a non-linear buffer distance field value.",BD_101023:"One or more features were skipped because the buffer distance type is invalid.",BD_101024:"Using geodesic method for geographic coordinate system.",BD_101025:"Invalid buffer expression.",
BD_308:"Invalid field type.",BD_101026:"Parameter '${paramName}' is not valid.",BD_101027:"'${outputName}' is not a valid output name.",BD_101029:"${completedTasks}/${totalTasks} distributed tasks completed.",BD_101030:"Failed to execute ${toolName}. Please contact your administrator with job ID '${jobID}'.",BD_101032:"Value '${paramValue}' in parameter '${paramName}' does not fall within the valid range [${expectedRange}]",BD_101033:"'${paramName}' will be projected into the processing spatial reference.",
BD_101034:"'${paramName}' does not have a spatial reference and could not be projected to the processing spatial reference.",BD_101035:"'${paramName}' will be limited to the output extent.",BD_101036:"The '${statistic}' statistic is not valid for field '${fieldName}'.",BD_101037:"Neighborhood size must be greater than bin size.",BD_101038:"An error occurred while returning the result, however, the result should still be available in your Portal.",BD_110004:"A Space Time Cube must have at least 10 time slices.",
BD_641:"Too few records for analysis. This tool requires at least ${minFeatures} feature(s) to compute results.",BD_1022:"This tool requires a projected coordinate system.",BD_110005:"This Space Time cube cannot be created because it would have more than the maximum two billion bins.",BD_101041:"Failed to connect to data store. Please verify that the connection info is correct.",BD_101053:"Some records have time values that are not of type ${timeType}.",BD_101060:"There were ${numErrors} time steps that could not be calculated. The first ${numDisplay} errors have been displayed.",
BD_100090:"This tool requires at least 2 candidate search locations that are not also reference locations.",BD_84505:"Top '${numResults}' Most Similar Locations (Values).",BD_101057:"Unable to start distributed job. Please check your GeoAnalyticsTools service settings and ensure that there are enough resources available for the job to run.",BD_101046:"No results to return. Specify the number of results.",BD_84504:"Summary of Attributes of Interest,",BD_89997:'["Attribute", "Min", "Max", "SD", "Mean"].',
BD_3:"The following report outlines the summary of your Find Similar Locations result.",BD_101042:"Unable to access file share. Please verify that your ArcGIS Server user account has access to the file share.",BD_1599:"Too few records for analysis. This tool requires at least 1 reference location in the Input Layer to compute results.",BD_101052:"Some records have either missing or invalid time values.",BD_101063:"There is zero variance. All of the values for your input field are likely the same.",
BD_100084:"Field type is required to be String, Integer, Double or Date.",BD_101061:"The time step from ${startTime} to ${endTime} has too few records for analysis. Each time step requires at least ${minFeatures} feature(s) to compute results.",BD_101045:"You must provide at least two Attributes Of Interest for the Attribute Profile Match Method.",BD_100089:"The following fields lack sufficient variation for use in this analysis: ${attribute}.",BD_84506:"Top 10 of '${numResults}' Most Similar Locations (Values).",
BD_101049:"The number of results requested is greater than the number of results returned.",BD_84503:"Summary of Input Features to Match,",BD_101056:"Invalid summary shape unit ${unit} for geometry ${geomType}.",BD_84510:'["OID", "SIMRANK", "SIMINDEX"]',BD_101059:"No time steps could be calculated.",BD_84512:'["Attribute", "Min", "Max", "SD", "Mean", "Input"].',BD_101048:"Attributes of Interest has duplicates.",BD_1589:"Too few records for analysis. This tool requires at least 2 Candidate Features to compute results.",
BD_101062:"The time step from ${startTime} to ${endTime} has zero variance. All of the values for your input field in this time step are likely the same.",BD_101055:"Some records have geometries that are not of type ${geometryType}.",BD_101040:"A web layer named '${outputName}' already exists. Please choose a different name that is unique within your organization.",BD_100088:'Field(s) "${attribute}" must be in both the reference and candidate search layers.',BD_101050:"Selected attributes of interest field type is required to be Integer, Double.",
BD_101044:"${attribute}, ${min}, ${max}, ${sd}, ${mean}, ${input}.",BD_101054:"Some records have either missing or invalid geometries.",BD_101058:"Analysis requires more memory than is allocated. Please increase the memory allocated to your GeoAnalytics toolbox in ArcGIS Server Manager.",BD_100082:"A field name and an expression are required.",BD_89998:'["", "Total", ${sumIndex}]',BD_101047:"Number of results must be greater than 0.",BD_101051:"Possible issues were found while reading '${paramName}'.",
BD_101043:"${attribute}, ${min}, ${max}, ${sd}, ${mean}.",AO_100160:"Some of the features have invalid geometry and have been removed from the result",AO_100161:"Batch Geocode failed.",AO_100162:"Analyze Geocode Input failed.",AO_100163:"Your text qualifier is invalid.",AO_100164:"You must enter either inputTable, inputFileItem or columnNames. All three cannot be empty.",AO_100165:"If your header row does not exist, you must enter columnNames.",AO_100166:"If your fileType is table, then you must enter an inputTable.",
AO_100167:"CSV Collection is not a supported input type. Please input a CSV or Microsoft Excel spreadsheet.",AO_100168:"Your filename or extension is too long.",AO_100169:"Your zip file cannot be opened.",AO_100170:"There is no file of the specified format in your zip file.",AO_100171:"Invalid locator service URL: {service_url}.",AO_100172:"Invalid credentials or invalid locator service URL: ${service_url}..",AO_100173:"The user does not have geocoding privileges.",AO_100174:"The geocoding service must be on a federated server.",
AO_100175:"Invalid token.",AO_100176:"Your file must be UTF-8 encoded. Please resubmit your file..",AO_100177:"Your Excel file is corrupted and cannot be opened.",AO_100178:"Your file's first row is empty. Please edit your file and resubmit.",AO_100179:"You must define column widths if your file is fixed width.",AO_100180:"Your column widths must be integers separated by commas like so: 5,7,13.",AO_100181:"The file's header row could not be parsed.",AO_100182:"Field ${field} could map to 2 possible alias fields ${field_one} and ${field_two}.",
AO_100183:"Field mapping entered in an incorrect format.",AO_100184:"Incorrect outputFields. Enter outputFields like so: x,y,score,match_addr.",AO_100185:"chars_per_row must be an integer.",AO_100186:"Incorrect widths_of_cols. Enter widths_of_cols like so: 10,15,6.",AO_100187:"Your outputName must be blank to get out a Feature Collection.",AO_100188:"Your outputName cannot be empty.",AO_100189:"Incorrect geocodeServiceURL, verify that the geocoding service is online and has a valid geocodeAddresses REST endpoint.",
AO_100190:"There were more lines read than there are lines. Check your header_rows_to_skip parameter.",AO_100191:"Unable to write header: check to see if your headerRowsToSkip is incorrect or if the geocoding service is down.",AO_100192:"If your header row exists, you must provide the headerRowsToSkip.",AO_100193:"Your headerRowsToSkip must be a positive number less than the number of rows in the inputTable or inputFileItem.",AO_100194:"Results file is being edited by another program.",AO_100195:"File entered was empty, returning an empty file.",
AO_100196:"Field mapping must be a list of lists.",AO_100197:"Your geocodingServiceURL may be incorrect, it does not have a maxBatchSize on the info page.",AO_100198:"Edit your field mapping and resubmit, none of your fields are mapped to valid locator fields.",AO_100199:"Edit your field mapping and resubmit, your mapping includes a locator field that is not supported.",AO_100200:"Edit your field mapping and resubmit, your mapping includes an unsupported locator field. Supported locator fields are ${supported_fields}.",
AO_100201:"Your field_mapping includes an input field ${field} not present in your input file: ${supported_fields}.",AO_100202:"Could not make a REST request from the server machine verify that the server machine can connect to the internet.",AO_100203:"The geocodeServiceURL entered should be https instead of http.",AO_100204:"The inputTable has over 100,000 records and is not supported.",AO_100205:"Your column delimiter is invalid.",AO_100206:"Create Replica failed for the Url(s): ${failedUrls}",
AO_100207:"The total number of input fields and enrichment variables exceed the maximum limitation of ${maxCountOfFields}",AO_100208:"Your header row is not the same length as the number of lists in your field mapping.",AO_100209:"Your headerRowsToSkip must be a positive number less than the number of rows in the inputTable or inputFileItem.",AO_100210:"Your input file has too many rows. xls only supports up to 65536 rows. Please submit a different outputType.",AO_100211:"Create Route Layers failed.",
AO_100212:"Input route data file is not a valid zip file.",AO_100213:"Input route data does not contain the required Stops feature class.",AO_100214:"Input route data does not contain at least two stops.",AO_100215:"JoinFeatures failed.",AO_100216:"Find Outliers failed.",AO_100217:"Failed to save the result as route layers since the analysis did not produce any routes.",AO_100218:"Including route layers is not valid when measurementType is StraightLine.",AO_192:"Cell size should be smaller than Distance Band.",
AO_100219:"Invalid input for parameter ${paramName}",AO_100220:"The geometry type ${geomType} for ${paramName} is not supported for spatial relationship: ${spatialRel}.",AO_100221:"Attribute or Spatial Relationship must be specified.",AO_100222:"Spatial relationship is not supported for table inputs.",AO_100223:"Including route layers is not supported when requesting feature collection output.",AO_100224:"Failed to download route data from the route data item, {itemId}.",AO_100225:"Failed to delete the route data item, {itemId}.",
AO_100226:"Failed to extract route data from the route data file.",AO_100227:"Your header row is not the same length as the number of lists in your field mapping.",AO_100228:"Your headerRowsToSkip must be a positive number less than the number of rows in the inputTable or inputFileItem.",AO_100229:"Your input file has too many rows. xls only supports up to 65536 rows. Please submit a different outputType.",AO_100230:"Your file type is not supported. Supported file types are csv and xlsx.",AO_100231:"Your outputName is not formatted correctly.",
AO_100232:"Your user role does not include the geocode privilege.",AO_100233:"The number of records in the input table is greater than the maximum records allowed for geocoding.",AO_100234:"You cannot submit both a table and a file, please submit only one.",AO_100235:"Your inputFileParameters is not formatted correctly.",AO_100236:"If you are submitting a file you must specify inputFileParameters.",AO_100237:"This input table is invalid. Please select another table.",AO_100238:"This input file is invalid. Please select another file.",
AO_100239:"You must specify either an inputFile, inputTable or columnNames.",AO_100240:"Your geocodeParameters is not formatted correctly.",AO_100241:"Your output result name already exists, please choose a different name.",AO_100242:"You do not have enough credits to perform this operation. Contact your ArcGIS System Administrator for assistance."},geoenrichment:{task:{GeoenrichmentTask:{noData:"There is no data for the selected area"}},dijit:{AgePyramid:{maxLabel:"The largest group:",minLabel:"The smallest group:",
compLabel:"Dots show comparison to",menLabel:"Men",womenLabel:"Women"},BufferOptions:{studyArea:"Show data for:",ring:"Ring",driveTime:"Drive Times",driveDistance:"Drive Distance",radius:"Radius:",time:"Time:",distance:"Distance:",buffer:"Buffer:",units:{esriDriveTimeUnitsMinutes:"minutes",esriMiles:"miles",esriKilometers:"kilometers",esriFeet:"feet",esriMeters:"meters"}},bufferTitle:{pointRing:{esriFeet:"${radius}-feet ring",esriKilometers:"${radius}-km ring",esriMeters:"${radius}-meter ring",esriMiles:"${radius}-mile ring"},
pointDriveTime:{esriFeet:"${radius}-feet drive distance",esriKilometers:"${radius}-km drive distance",esriMeters:"${radius}-meter drive distance",esriMiles:"${radius}-mile drive distance",esriDriveTimeUnitsMinutes:"${radius}-minute drive time"},lineBuffer:{esriFeet:"${radius}-feet buffer",esriKilometers:"${radius}-km buffer",esriMeters:"${radius}-meter buffer",esriMiles:"${radius}-mile buffer"},polygon:"This area",stdGeo:"Intersecting ${level} feature"},VariableStore:{global:"Global",number:"#",percent:"%",
average:"Avg",index:"Index",reliability:"Reliability"},DataCategoriesPage:{loading:"Loading...",search:"Search for a variable name",noResults:"No results found for '${seachKey}'.",showFavorites:"Show Favorite Variables",allHierarchies:"All Data",hierarchy_census:"Standard Data",hierarchy_landscape:"Landscape Data",premiumHierarchy:"${name} Data"},DataCollectionsPage:{categoryName:"${categoryName} Variables",mapPopVar:"Choose a Popular Variable",keepBrowse:"Keep Browsing",showAll:"Show all ${categoryName} Variables",
noResults:"No results found for '${seachKey}'.",search:"Search within the current category"},DataVariablesPage:{allVariablesTitle:"All Variables",favoriteVariablesTitle:"Favorite Variables",groupVariables:"${groupName} variables",searchVariables:"'${searchKey}' variables",allVariables:"All variables",searchInGroupVariables:"'${searchKey}' variables from ${groupName}",favoriteVariables:"Favorite variables"},ShoppingCart:{selectedVars:"Selected Variables",noVariables:"No variables have yet been selected"},
VariableInfo:{name:"Name",variable:"Variable",source:"Source",vintage:"Vintage"},EnrichOptionsPage:{bufferRing:"1 mile circle around locations",bufferPolygon:"input polygons (buffer unavailable)",selectedVariables:"Selected Variables:",customize:"customize",bufferOptions:"Show data for:",edit:"edit",totalVars:"Total Variables: ${varCount} (${credits})",varsPerRow:"Variables per Row: ${varCount} (${credits})",credits:"${credits} credits",creditsCalc:"calculating...",totalVarsTooltip:"This operation will enrich ${rowCount} rows with ${varCount} variables and will cost ${credits}.",
varsPerRowTooltip:"This operation will enrich each row with ${varCount} variables and will cost ${credits} per row.",overwriteExisting:"Existing column values will be overwritten",varName:"Variable Name",column:"Column",newColumn:"\x3cCreate New\x3e",noColumn:"\x3cNone\x3e",back:"Back",finish:"Add data to system"},InfographicsMainPage:{mainTitle:"Configure Infographics",loading:"Loading...",chooseCountry:"Show available data for: ",chooseDataCollection:"Choose from popular data collections: ",chooseTheme:"Select color theme:",
dark:"Dark",light:"Light",addVariables:"Add more variables...",ok:"OK",add:"Add",cancel:"Cancel"},OneVar:{subtitleSite2:"for this area ",subtitleVar2:"${alias} is ",lessThan:"which is less than the average for ${site}",moreThan:"which is more than the average for ${site}",same:"which is the same as the average for ${site}",areaCol:"Area",valueCol:"Value"},RelatedVariables:{highLabel2:"The largest group: ${alias}",lowLabel2:"The smallest group: ${alias}",indicatorCol:"Indicator",valueCol:"Value",difCol:"Difference",
chartLabel:"Bars show deviation from"},Tapestry:{hhTypeLabel:"Household Type:",medianAgeLabel:"Median Age:",incomeLabel:"Income:",employmentLabel:"Employment:",educationLabel:"Education:",residentialLabel:"Residential:",raceEthnicityLabel:"Race / Ethnicity:",hhLabel:"households",adultsLabel:"adults",prtHhLabel:"of Households"},WizardButtons:{back:"Back",ok:"OK",apply:"Apply",cancel:"Cancel",next:"Next"},EnrichConfig:{title:"Enrich Layer"},DataBrowser:{title:"Data Browser"}}},filterDlg:{expressionTemplate:"${field_dropdown} ${operator_dropdown} ${values_input}",
filter:"Filter",applyFilter:"Apply Filter",applyFilterBtn:"Apply Filter",removeFilterBtn:"Remove Filter",view:"View",change:"Change",edit:"Edit",create:"Create",match1Msg:"Display features in the layer that match the following expression",matchMsg:"Display features in the layer that match ${any_or_all} of the following expressions",matchMsgSet:"${any_or_all} of the following expressions in this set are true",all:"All",any:"Any",andBetweenValues:"and",and:"and",or:"or",friendlyAnd:"All of these expressions must be true:",
friendlyOr:"Any of these expressions must be true:",friendlyDatePattern:"MM/dd/yyyy",addAnotherExpression:"Add another expression",addSet:"Add a set",askForValues:"Ask for values",value:"Value",valueTooltip:"Enter value",field:"Field",fieldTooltip:"Pick from existing field",uniqueValues:"Unique",uniqueValueTooltip:"Pick from unique values in selected field",toThisLayer:"To this layer",toNewLayer:"To a new layer",newLayerName:"New layer name",showFilterExpression:"Show filter's expressions",deleteExpression:"Delete this expression",
deleteSet:"Delete this set",addExpression:"Add an expression to this set",addSetTooltip:"Add a set to contain expressions",promptMsg:"Provide a prompt and some hint text to present this filter interactively to others",prompt:"Prompt",hint:"Hint",stringOperatorIs:"is",stringOperatorIsNot:"is not",stringOperatorStartsWith:"starts with",stringOperatorEndsWith:"ends with",stringOperatorContains:"contains",stringOperatorDoesNotContain:"does not contain",stringOperatorIsBlank:"is blank",stringOperatorIsNotBlank:"is not blank",
dateOperatorIsOn:"is on",dateOperatorIsNotOn:"is not on",dateOperatorIsBefore:"is before",dateOperatorIsAfter:"is after",dateOperatorDays:"days",dateOperatorWeeks:"weeks",dateOperatorMonths:"months",dateOperatorInTheLast:"in the last",dateOperatorNotInTheLast:"not in the last",dateOperatorIsBetween:"is between",dateOperatorIsNotBetween:"is not between",dateOperatorIsBlank:"is blank",dateOperatorIsNotBlank:"is not blank",numberOperatorIs:"is",numberOperatorIsNot:"is not",numberOperatorIsAtLeast:"is at least",
numberOperatorIsLessThan:"is less than",numberOperatorIsAtMost:"is at most",numberOperatorIsGreaterThan:"is greater than",numberOperatorIsBetween:"is between",numberOperatorIsNotBetween:"is not between",numberOperatorIsBlank:"is blank",numberOperatorIsNotBlank:"is not blank",emptyString:"empty string",error:{noUniqueValues:"The specified field has has no values.",generateRendererFailed:"Unique values could not be determined for the selected field.",missingValue:"there's a missing value in one of the expressions",
cantParseExpression:"Filter cannot be shown because one or more of its expressions cannot be parsed. To edit the filter expressions, clear the filter and create a new filter interactively."}},calculateFields:{addFieldTitle:"Add Field",nameLabel:"Name:",aliasLabel:"Alias:",typeLabel:"Type:",lengthLabel:"Length:",defaultValueLabel:"Default Value:",optional:"(Optional)",stringLabel:"String",integerLabel:"Integer",doubleLabel:"Double",dateLabel:"Date",expBuilderTitle:"Expression Builder",operators:"Operators",
availableFields:"Available Fields",helpers:"Helpers",functions:"Functions",numeric:"Numeric",clear:"Clear",validate:"Validate",addNewField:"Add New Field",add:"Add",close:"Close",calculate:"Calculate",deleteLabel:"Delete",exprLabel:"${fieldName} \x3d",layerReqMsg:"A layer is required parameter for calculate field",fieldReqMsg:"A calculate field has not been provided",lyrSupportCalMsg:"This layer ${layername} does not support calculate fields",lyrUpdateCapMsg:"Either update capability is not enabled on the layer ${layername} or, you do not have access to update features on this layer",
selectCalField:"Choose field to calculate:",firstOperatorMsg:"Operator '${operator}' cannot start an expression",completeHelperMsg:"Complete the helper method added previously",successMsg:"Successfully updated ${count} features ",deleteField:"Delete Field",deleteFieldConfirm:"Are you sure you want to delete '${field}' field from this layer?",fields:"Fields",exprFailedMsg:"Calculate for the expression '${expr}' failed.",inValidFielNameCharMsg:"The field name contains one or more invalid characters \x3cbr/\x3e(`~@#$%^\x26*()-+\x3d|\\\x3c\x3e?/{.!'[]:\n\r).",
inValidFieldStartCharMsg:"The field name cannot start with one of these invalid characters \x3cbr/\x3e(`~@#$%^\x26*()-+\x3d|\\\x3c\x3e?/{}.!'[]:;\n\r_012356789).",invalidSqlkeywordsMsg:"The field name cannot be the same as an SQL keyword.",invalidExpression:"The calculate expression is not valid",validExpression:"The expression was successfully verified.",sameFielNameMsg:"The field name cannot be same as an existing field name",invalidFieldLengthMsg:"The field name length should be less than 128 characters.",
errorCodes:{3001:"Sql expression is not supported.",3002:"Sql expression syntax error.",3004:"Sql expression semantic error.",3007:"Invalid table name ${tableName}.",3008:"Invalid field name ${fieldName}.",3009:"Unsafe sql expression is not allowed."},absFunc:"${functionName}: Returns the absolute (positive) value of ${num}.",castFunc:"${functionName}: Converts a ${num} to a different type. FLOAT converts ${num} to a double and INT converts to an integer.",ceilingFunc:"${functionName}: Returns the smallest integer greater than or equal to  ${num}.",
cosFunc:"${functionName}: Returns the trigonometric cosine of ${num}. ${num} is assumed to be an angle in radians.",floorFunc:"${functionName}: Returns the largest integer that is less than or equal to ${num}.",logFunc:"${functionName}: Returns the natural logarithm (base E) of ${num}.",log10Func:"${functionName}: Returns the base-10 logarithm of ${num}.",modFunc:"${functionName}: Returns the remainder after the division of n is performed on ${num}. Both ${n} and ${num} must be integer.",powerFunc:"${functionName}: Returns the value of ${num} raised to the specified power ${y}.",
roundFunc:"${functionName}: Rounds ${num} to the specified ${length}.",sinFunc:"${functionName}: Returns the trigonometric sine of ${num}. ${num} is assumed to be an angle in radians.",tanFunc:"${functionName}: Returns the tangent of ${num}. ${num} is assumed to be an angle in radians.",truncateFunc:"${functionName}: Truncates ${num} at the specified ${decimal_place}. A positive ${decimal_place} truncates while a negative ${decimal_place} rounds.",nullifFunc:"${functionName}: Returns null if ${num} equals ${value}. Commonly used to prevent divide-by-zero errors by setting ${value} to 0.",
char_lengthFunc:"${functionName}: Returns the number of characters in ${str}. The result is an integer.",concatFunc:"${functionName}: Concatenates two strings.",positionFunc:"${functionName}: Returns the position of the first occurrence of substring in ${str}. If substring is not found, the result is 0.",lowerFunc:"${functionName}: Returns a string where all characters in ${str} are converted to lowercase.",substringFunc:"${functionName}: Returns a part of ${str}. ${start} is an integer index specifying where the returned characters start. ${length} is the number of characters to be returned.",
trimFunc:"${functionName}: Returns a string where all leading or trailing spaces are removed from ${str}.",upperFunc:"${functionName}: Returns a string where all characters in ${str} are converted to uppercase.",current_dateFunc:"${functionName}: Returns the current date.",current_timeFunc:"${functionName}: Returns the current time (hours, minutes, seconds).",current_timestampFunc:"${functionName}: Returns the current time (hours, minutes, seconds, milliseconds).",asMetersFunc:"${functionName}: Applies the calculation assuming the value of ${num} is in meters.",
asKilometersFunc:"${functionName}: Applies the calculation assuming the value of ${num} is in kilometers.",asFeetFunc:"${functionName}: Applies the calculation assuming the value of ${num} is in feet.",asYardsFunc:"${functionName}: Applies the calculation assuming the value of ${num} is in yards.",asMilesFunc:"${functionName}: Applies the calculation assuming the value of ${num} is in miles.",asNuaticalMilesFunc:"${functionName}: Applies the calculation assuming the value of ${num} is in nautical miles.",
squareRootFunc:"${functionName}: Returns the square root of ${num}.",minFunc:"${functionName}: Returns the lowest valued ${num} in the array.",maxFunc:"${functionName}: Returns the highest valued ${num} in the array.",constrainFunc:"${functionName}: Returns the input value if it's within the constraining bounds. If the value is less than ${low}, it returns ${low}, if the value is greater than ${high} it returns the ${high} value.",iffFunc:"${functionName}: Returns one value if a condition evaluates to True, and another value if that condition evaluates to False",
whenFunc:"${functionName}: Evaluates a series of expressions in turn, until one evaluates to true.",decodeFunc:"${functionName}: Evaluates an expression, and then compares its value with subsequent parameters. If the expression matches it returns the next parameter value. If none match, there is the option for the last parameter to be a default return value.",extractFunc:"${functionName}: Returns a single part of a date/time, such as year, month, day, hour, minute, etc."},smartMapping:{other:"Other",
minToMax:"to",sumOfCategories:"Sum of categories",predominantCategory:"Predominant category",strengthOfPredominance:"Strength of predominance",ageInfo_years:"Age, in years, from ${startTime} to ${endTime}",ageInfo_months:"Age, in months, from ${startTime} to ${endTime}",ageInfo_days:"Age, in days, from ${startTime} to ${endTime}",ageInfo_hours:"Age, in hours, from ${startTime} to ${endTime}",ageInfo_minutes:"Age, in minutes, from ${startTime} to ${endTime}",ageInfo_seconds:"Age, in seconds, from ${startTime} to ${endTime}"},
networkAnalysis:{enums:{esriNAObjectStatus:{esriNAObjectStatusOK:"OK",esriNAObjectStatusNotLocated:"Not Located on Network",esriNAObjectStatusElementNotLocated:"Network Unbuilt",esriNAObjectStatusElementNotTraversable:"Prohibited Street",esriNAObjectStatusInvalidFieldValues:"Invalid Field Values",esriNAObjectStatusNotReached:"Cannot Reach",esriNAObjectStatusTimeWindowViolation:"Time Window Violation"},esriNACurbApproachType:{esriNAEitherSideOfVehicle:"Either side",esriNARightSideOfVehicle:"From the right",
esriNALeftSideOfVehicle:"From the left",esriNANoUTurn:"Depart in the same direction"},esriNALocationType:{stop:"Stop",waypoint:"Waypoint"},esriDirectionsManeuverType:{esriDMTBearLeft:"Bear left",esriDMTBearRight:"Bear right",esriDMTDepart:"Depart stop",esriDMTDoorPassage:"Door passage",esriDMTElevator:"Elevator",esriDMTEndOfFerry:"End of ferry",esriDMTEscalator:"Escalator",esriDMTFerry:"Take ferry",esriDMTForkCenter:"At fork keep center",esriDMTForkLeft:"At fork keep left",esriDMTForkRight:"At fork keep right",
esriDMTHighwayChange:"Go on another highway",esriDMTHighwayExit:"Exit highway",esriDMTHighwayMerge:"Merge to highway",esriDMTPedestrianRamp:"Pedestrian ramp",esriDMTRampLeft:"Ramp left",esriDMTRampRight:"Ramp right",esriDMTRoundabout:"Take roundabout",esriDMTSharpLeft:"Make sharp left",esriDMTSharpRight:"Make sharp right",esriDMTStairs:"Stairs",esriDMTStop:"Arrive at stop",esriDMTStraight:"Go straight",esriDMTTripItem:"Trip planning item",esriDMTTurnLeft:"Turn left",esriDMTTurnLeftLeft:"Turn left and immediately turn left",
esriDMTTurnLeftRight:"Turn left and immediately turn right",esriDMTTurnRight:"Turn right",esriDMTTurnRightLeft:"Turn right and immediately turn left",esriDMTTurnRightRight:"Turn right and immediately turn right",esriDMTUnknown:"Unknown",esriDMTUTurn:"Make U-turn"},esriDirectionItemType:{esriDITUnknown:"Unknown",esriDITManeuverArrive:"Arrive at stop",esriDITManeuverDepart:"Depart at stop",esriDITManeuverDoor:"Pass the door",esriDITManeuverBearLeft:"Bear left",esriDITManeuverBearRight:"Bear right",
esriDITManeuverElevator:"",esriDITManeuverElevatorUp:"Indicates up direction of elevator",esriDITManeuverElevatorDown:"Indicates down direction of elevator",esriDITManeuverEscalator:"Take escalator",esriDITManeuverEscalatorDown:"Indicates down direction of escalator",esriDITManeuverEscalatorUp:"Indicates up direction of escalator",esriDITManeuverFerryOn:"Take ferry",esriDITManeuverFerryOff:"Take off ferry",esriDITManeuverForkCenter:"Keep center at fork",esriDITManeuverForkLeft:"Keep left at fork",
esriDITManeuverForkRight:"Keep right at fork",esriDITManeuverPedestrianRamp:"Take pedestrian ramp",esriDITManeuverRampLeft:"Ramp left",esriDITManeuverRampRight:"Ramp right",esriDITManeuverRoundabout:"Take roundabout",esriDITManeuverRoundaboutLeft:"Take left-handed roundabout",esriDITManeuverRoundaboutRight:"Take right-handed roundabout",esriDITManeuverTurnLeft:"Turn left",esriDITManeuverTurnLeftLeft:"Turn left, followed by turn left",esriDITManeuverTurnLeftRight:"Turn left, followed by turn right",
esriDITManeuverTurnRight:"Turn right",esriDITManeuverTurnRightLeft:"Turn right, followed by turn left",esriDITManeuverTurnRightRight:"Turn right, followed by turn right",esriDITManeuverSharpLeft:"Make sharp left",esriDITManeuverSharpRight:"Make sharp right",esriDITManeuverStraight:"Go straight",esriDITManeuverStairs:"Take stairs",esriDITManeuverStairsUp:"Take up-stairs",esriDITManeuverStairsDown:"Take down-stairs",esriDITManeuverUTurn:"Make U-Turn",esriDITManeuverUTurnLeft:"Make left-handed U-Turn",
esriDITManeuverUTurnRight:"Make right-handed U-Turn",esriDITEvent:"General event",esriDITEventBarrier:"Scale cost barrier crossing",esriDITEventBoundary:"Administrative Border crossing",esriDITEventLandmark:"Landmark",esriDITEventTimeZone:"Time zone change",esriDITEventTraffic:"Heavy traffic segment",esriDITEventRestrictionViolation:"Restriction violation"},esriDirectionsLineType:{esriDLTUnknown:"Unknown",esriDLTSegment:"Segment",esriDLTSegmentManeuver:"Maneuver Segment",esriDLTSoftRestrictionViolation:"Restriction violation",
esriDLTBarrier:"Scale cost barrier crossing",esriDLTStopAndGoTraffic:"Heavy Traffic",esriDLTSlowTraffic:"Slow Traffic",esriDLTModerateTraffic:"Moderate Traffic"},esriNABarrierType:{esriNABTRestriction:"Restriction",esriNABTScaledCost:"Scaled Cost",esriNABTAddedCost:"Added Cost"},esriNAIntYesNo:{No:"No",Yes:"Yes"}},fields:{RouteId:"Route ID",stops:{CurbApproach:"Curb Approach",ArrivalCurbApproach:"Arrival Curb Approach",DepartureCurbApproach:"Departure Curb Approach",Name:"Name",Sequence:"Sequence",
Status:"Status",LocationType:"Location Type",TimeWindowStart:"Time Window Start",TimeWindowEnd:"Time Window End",ArrivalTime:"Arrival Time",DepartureTime:"Departure Time",ArrivalUTCOffset:"Arrival Time: Offset from UTC in Minutes",DepartureUTCOffset:"Departure Time: Offset from UTC in Minutes",ServiceMinutes:"Service Minutes",ServiceMeters:"Service Meters",ServiceCosts:"Service Costs",CumulativeMinutes:"Cumulative Minutes",CumulativeMeters:"Cumulative Meters",CumulativeCosts:"Cumulative Costs",LateMinutes:"Minutes Late",
WaitMinutes:"Minutes Early",Properties:"Additional Properties"},directions:{Sequence:"Sequence",StopSequence:"Sequence of Associated Stop",ArrivalTime:"Maneuver Starts at",UTCOffset:"Offset from UTC in Minutes",ManeuverType:"Maneuver",Meters:"Length in Meters",Minutes:"Duration in Minutes",DirectionText:"Direction Text",ManeuverMessages:"Maneuver Messages",ItemType:"Directions Item Type",StopID:"Stop ID",DisplayText:"Text to Display",Azimuth:"Azimuth",Name:"Primary Feature Name",AlternativeName:"Alternative Feature Name",
ExitName:"Highway Exit Name",IntersectingName:"Intersecting Feature Name",BranchName:"Signpost Branch Name",TowardName:"Signpost Toward Name",VoiceShortText:"Voice Instruction",VoiceFullText:"Voice Full Instruction",Level:"3D Logical Level"},directionEvents:{DirectionSequence:"Direction Sequence",Sequence:"Sequence",ArrivalTime:"Event Time",UTCOffset:"Offset from UTC in Minutes",EventText:"Event Text",EventMessages:"Event Messages"},directionLines:{DirectionSequence:"Direction Sequence",DirectionPointID:"Direction Point ID",
LineType:"Line Type",Meters:"Length in Meters",Minutes:"Duration in Minutes",LevelFrom:"Start from 3D Level",LevelTo:"End at 3D Level"},barriers:{BarrierType:"Barrier Type",FullEdge:"Affects Entire Street Segment",AddedCost:"Added Cost",Costs:"Costs",Status:"Status",CurbApproach:"Curb Approach",Name:"Name"},polylineBarriers:{BarrierType:"Barrier Type",ScaleCost:"Scale Factor",Costs:"Costs",Name:"Name"},polygonBarriers:{BarrierType:"Barrier Type",ScaleCost:"Scale Factor",Costs:"Costs",Name:"Name"},
routeInfo:{Version:"Version",RouteName:"Route Name",TotalMinutes:"Total Minutes",TotalMeters:"Total Meters",TotalLateMinutes:"Total Late Minutes",TotalWaitMinutes:"Total Wait Minutes",TotalCosts:"Total Costs",StartTime:"Start Time",StartUTCOffset:"Start Time: Offset from UTC in Minutes",EndTime:"End Time",EndUTCOffset:"End Time: Offset from UTC in Minutes",Messages:"Analysis Messages",AnalysisSettings:"Analysis Settings",Properties:"Additional Properties"}},sharing:{stopsLayer:"Stops",directionsLayer:"Directions",
directionPointsLayer:"Direction Points",directionLinesLayer:"Direction Lines",directionEventsLayer:"Direction Events",barriersLayer:"Barriers",polylineBarriersLayer:"Line Barriers",polygonBarriersLayer:"Polygon Barriers",routeInfoLayer:"Route Details",itemDescription:"Add an in-depth description of the item.",itemTags:"route, route layer",itemSnippet:"Route and directions for",rootFolder:"Home",Minutes:"minutes",Meters:"meters",Miles:"miles",StartTime:"Route start time:",costAttributeMissing:"Loaded Route Layer does not match the Route Service: cost attribute is missing.",
differentVersion:"A newer version of Route Layer is detected, not all data could have been loaded."}},browseLayersDlg:{browseTitle:"Browse Living Atlas Layers",categoryAll:"All Categories",categoryImagery:"Imagery",subCategoryBasemapImagery:"Basemap Imagery",subCategoryMultiSpectral:"Multispectral Imagery",subCategoryTemporal:"Temporal Imagery",subCategoryEvent:"Event Imagery",categoryBasemaps:"Basemaps",subCategoryEsriBasemaps:"Esri Basemaps",subCategoryPartnerBasemaps:"Partner Basemaps",subCategoryUserBasemaps:"User Basemaps",
categoryHistoricalMaps:"Historical Maps",categoryDemographics:"Demographics \x26 Lifestyle",subCategoryIncome:"Income \x26 Spending",subCategoryPopulation:"Population \x26 Housing",subCategorySegmentation:"Segmentation \x26 Behaviors",subCategoryBusiness:"Business \x26 Jobs",subCategoryAtRisk:"At Risk",categoryLandscape:"Landscape",subCategoryClimate:"Climate \x26 Weather",subCategoryEcology:"Ecology",subCategorySpecies:"Species Biology",subCategoryDisturbance:"Disturbance \x26 Impact",subCategoryElevation:"Elevation",
subCategoryLand:"Land Cover",subCategoryHazards:"Natural Hazards",subCategoryOceans:"Oceans",subCategorySoils:"Soils/Geology",subCategorySubsurface:"Subsurface",subCategoryWater:"Water",subCategoryWeather:"Weather",categoryEarthObservations:"Earth Observations",categoryUrbanSystems:"Urban Systems",subCategory3DCities:"3D Cities",subCategoryMovement:"Movement",subCategoryParcels:"Parcels",subCategoryPeople:"People",subCategoryPlanning:"Planning",subCategoryPublic:"Public",subCategoryWork:"Work",categoryTransportation:"Transportation",
categoryBoundaries:"Boundaries \x26 Places",subCategoryBoundaries:"Boundaries",subCategoryPlaces:"Places",categoryHexBins:"Hexbins",searchFor:"Search for",errorLabel:"Error",searchTitle:"Search",error:{wildCardSearchError:"Wildcard searches are not supported."}},gallery:{noFilterFields:"Layer ${name} has no fields that can be used for filtering.",addToViewer:"Add layer to map",noItemsToDisplay:"There are no items currently available to display.",searchFor:"Search for",searching:"Searching"},browseItems:{items:{organizationLabel:"My Organization",
onlineLabel:"ArcGIS Online",contentLabel:"My Content",favoritesLabel:"My Favorites",portalOrg:"Portal for ArcGIS"},title:"Select Web Map",searchTitle:"Search",ok:"Ok",cancel:"Cancel",placeholder:"Enter search term",instructionsLeft:"What do you want to do?",instructionsRight:"Select a configurable app.",go:"Go",selectDetails:"SELECT",configure:"Create",learnMoreConfigurableApps:"Learn more about configurable apps",noValidLayerMsg:"No layers meet the criteria of the input parameter."}},ar:1,bs:1,cs:1,
da:1,de:1,el:1,es:1,et:1,fi:1,fr:1,he:1,hi:1,hr:1,id:1,it:1,ja:1,ko:1,lv:1,lt:1,nl:1,nb:1,pl:1,"pt-br":1,"pt-pt":1,ro:1,ru:1,sr:1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1})},"esri/symbols/CartographicLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./SimpleLineSymbol".split(" "),function(h,k,a,f,b,e,l,m){var g={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",
STYLE_NULL:"none",STYLE_INSIDE_FRAME:"insideframe",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},d={color:[0,0,0,1],style:g.STYLE_SOLID,width:1,cap:g.CAP_BUTT,join:g.JOIN_MITER,miterLimit:10};h=h(m,{declaredClass:"esri.symbol.CartographicLineSymbol",
type:"cartographiclinesymbol",_caps:{butt:"esriLCSButt",round:"esriLCSRound",square:"esriLCSSquare"},_joins:{miter:"esriLJSMiter",round:"esriLJSRound",bevel:"esriLJSBevel"},constructor:function(c,g,e,f,m,h){c?k.isString(c)?(this.style=c,g&&(this.color=g),void 0!==e&&(this.width=e),f&&(this.cap=f),m&&(this.join=m),void 0!==h&&(this.miterLimit=h)):(this.cap=l.valueOf(this._caps,c.cap),this.join=l.valueOf(this._joins,c.join),this.width=b.pt2px(c.width),this.miterLimit=b.pt2px(c.miterLimit)):(k.mixin(this,
d),this.color=new a(this.color),this.width=b.pt2px(this.width),this.miterLimit=b.pt2px(this.miterLimit))},setCap:function(a){return this.cap=a,this},setJoin:function(a){return this.join=a,this},setMiterLimit:function(a){return this.miterLimit=a,this},getStroke:function(){return k.mixin(this.inherited("getStroke",arguments),{cap:this.cap,join:this.join===g.JOIN_MITER?this.miterLimit:this.join})},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},
fill:null,stroke:this.getStroke()}},toJson:function(){var a=b.px2pt(this.miterLimit);return a=isNaN(a)?void 0:a,l.fixJson(k.mixin(this.inherited("toJson",arguments),{type:"esriCLS",cap:this._caps[this.cap],join:this._joins[this.join],miterLimit:a}))}});return k.mixin(h,g),h.defaultProps=d,f("extend-esri")&&(k.setObject("symbol.CartographicLineSymbol",h,e),e.symbol.defaultCartographicLineSymbol=d),h})},"esri/symbols/SimpleFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./FillSymbol ./SimpleLineSymbol require".split(" "),
function(h,k,a,f,b,e,l,m,g,d){var c={STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forwarddiagonal",STYLE_BACKWARD_DIAGONAL:"backwarddiagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonalcross",STYLE_FORWARDDIAGONAL:"forwarddiagonal",STYLE_BACKWARDDIAGONAL:"backwarddiagonal",STYLE_DIAGONALCROSS:"diagonalcross"},n={style:c.STYLE_SOLID,color:[0,0,0,.25]};h=h(m,{declaredClass:"esri.symbol.SimpleFillSymbol",type:"simplefillsymbol",
_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical",forwarddiagonal:"esriSFSForwardDiagonal",backwarddiagonal:"esriSFSBackwardDiagonal",cross:"esriSFSCross",diagonalcross:"esriSFSDiagonalCross"},constructor:function(c,d,b){c?k.isString(c)?(this.style=c,void 0!==d&&(this.outline=d),void 0!==b&&(this.color=b)):this.style=l.valueOf(this._styles,c.style):(k.mixin(this,n),this.outline=new g(this.outline),this.color=new a(this.color))},setStyle:function(a){return this.style=
a,this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){var a=this.style;return a===c.STYLE_NULL?null:a===c.STYLE_SOLID?this.color:k.mixin({},b.defaultPattern,{src:d.toUrl("../images/symbol/sfs/"+a+".png"),width:10,height:10})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){return l.fixJson(k.mixin(this.inherited("toJson",arguments),
{type:"esriSFS",style:this._styles[this.style]}))}});return k.mixin(h,c),h.defaultProps=n,f("extend-esri")&&(k.setObject("symbol.SimpleFillSymbol",h,e),e.symbol.defaultSimpleFillSymbol=n),h})},"esri/symbols/FillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./Symbol ./SimpleLineSymbol".split(" "),function(h,k,a,f,b,e){h=h(b,{declaredClass:"esri.symbol.FillSymbol",constructor:function(a){a&&k.isObject(a)&&a.outline&&(this.outline=new e(a.outline))},setOutline:function(a){return this.outline=
a,this},toJson:function(){var a=this.inherited("toJson",arguments);return this.outline&&(a.outline=this.outline.toJson()),a}});return a("extend-esri")&&k.setObject("symbol.FillSymbol",h,f),h})},"esri/symbols/PictureFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./FillSymbol".split(" "),function(h,k,a,f,b,e,l,m){var g={xoffset:0,yoffset:0,width:12,height:12};h=h(m,{declaredClass:"esri.symbol.PictureFillSymbol",type:"picturefillsymbol",
xscale:1,yscale:1,xoffset:0,yoffset:0,constructor:function(d,c,b,e){d?k.isString(d)?(this.url=d,void 0!==c&&(this.outline=c),void 0!==b&&(this.width=b),void 0!==e&&(this.height=e)):(this.xoffset=f.pt2px(d.xoffset),this.yoffset=f.pt2px(d.yoffset),this.width=f.pt2px(d.width),this.height=f.pt2px(d.height),c=d.imageData,9>a("ie")||!c||(b=this.url,this.url="data:"+(d.contentType||"image")+";base64,"+c,this.imageData=b)):(k.mixin(this,g),this.width=f.pt2px(this.width),this.height=f.pt2px(this.height))},
setWidth:function(a){return this.width=a,this},setHeight:function(a){return this.height=a,this},setOffset:function(a,c){return this.xoffset=a,this.yoffset=c,this},setUrl:function(a){return a!==this.url&&(delete this.imageData,delete this.contentType),this.url=a,this},setXScale:function(a){return this.xscale=a,this},setYScale:function(a){return this.yscale=a,this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return k.mixin({},f.defaultPattern,{src:this.url,
width:this.width*this.xscale,height:this.height*this.yscale,x:this.xoffset,y:this.yoffset})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var a=this.url,c=this.imageData;if(0===a.indexOf("data:"))var b=a,a=c,c=b.indexOf(";base64,")+8,c=b.substr(c);!k.isString(a)||0!==a.indexOf("/")&&0!==a.indexOf("//")&&0!==a.indexOf("./")&&0!==a.indexOf("../")||(a=l.getAbsoluteUrl(a));
var b=f.px2pt(this.width),b=isNaN(b)?void 0:b,g=f.px2pt(this.height),g=isNaN(g)?void 0:g,m=f.px2pt(this.xoffset),m=isNaN(m)?void 0:m,r=f.px2pt(this.yoffset),r=isNaN(r)?void 0:r,a=e.fixJson(k.mixin(this.inherited("toJson",arguments),{type:"esriPFS",url:a,imageData:c,contentType:this.contentType,width:b,height:g,xoffset:m,yoffset:r,xscale:this.xscale,yscale:this.yscale}));return a.imageData||delete a.imageData,a}});return h.defaultProps=g,a("extend-esri")&&(k.setObject("symbol.PictureFillSymbol",h,
b),b.symbol.defaultPictureFillSymbol=g),h})},"esri/symbols/TextSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Symbol ./Font".split(" "),function(h,k,a,f,b,e,l,m,g){var d={type:"textsymbol",x:0,y:0,text:"",rotated:!1,kerning:!0,color:[0,0,0,1],font:f.defaultFont,angle:0,xoffset:0,yoffset:0,horizontalAlignment:"center"},c={start:"left",middle:"center",end:"right"},n={left:"start",center:"middle",right:"end",justify:"start"},q={top:"text-before-edge",
middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},t=document.createElement("canvas");h=h(m,{declaredClass:"esri.symbol.TextSymbol",angle:0,xoffset:0,yoffset:0,constructor:function(a,c,b){k.mixin(this,d);this.font=new g(this.font);this.color=new l(this.color);a&&(k.isObject(a)?(k.mixin(this,a),this.color&&e.isDefined(this.color[0])&&(this.color=l.toDojoColor(this.color)),this.type="textsymbol",this.font=new g(this.font),this.xoffset=f.pt2px(this.xoffset),this.yoffset=f.pt2px(this.yoffset),
this.angle&&(this.angle*=-1),this.haloSize&&(this.haloSize=f.pt2px(this.haloSize)),this.haloColor&&(this.haloColor=l.toDojoColor(this.haloColor))):(this.text=a,c&&(this.font=c),b&&(this.color=b)));this.setAlign(this.align||this.getSVGAlign())},setFont:function(a){return this.font=a,this},setSize:function(a){return this.font.size=a,this},setAngle:function(a){return this.angle=a,this},setOffset:function(a,c){return this.xoffset=a,this.yoffset=c,this},setHaloColor:function(a){return this.haloColor=a,
this},setHaloSize:function(a){return this.haloSize=a,this},setAlign:function(a){return this.align=a,this.setHorizontalAlignment(a&&c[a.toLowerCase()]||"center"),this},setHorizontalAlignment:function(a){return this.horizontalAlignment=a,this},getSVGAlign:function(){var a=this.horizontalAlignment;return a=a&&n[a.toLowerCase()]||"middle"},setVerticalAlignment:function(a){return this.verticalAlignment=a,this},getSVGBaseline:function(){var a=this.verticalAlignment;return a&&q[a.toLowerCase()]||"alphabetic"},
getSVGBaselineShift:function(){return"bottom"===this.verticalAlignment?"super":null},setDecoration:function(a){return this.decoration=a,this.font||this.setFont(new g),this.font.setDecoration(a),this},setRotated:function(a){return this.rotated=a,this},setKerning:function(a){return this.kerning=a,this},setText:function(a){return this.text=a,this},getStroke:function(){return null},getFill:function(){return this.color},getWidth:function(){var a=t&&t.getContext&&t.getContext("2d");if(a){var c=this.font;
return a.font=(c.style?c.style:f.defaultFont.style)+" "+(c.weight?c.weight:f.defaultFont.weight)+" "+(c.size?c.size:f.defaultFont.size)+"px "+(c.family?c.family:f.defaultFont.family),a.measureText(this.text).width}for(var d=this.getHeight(),b=0,a=0;a<this.text.length;a++)c=this.text.charAt(a),b+=c==c.toUpperCase()?.7*d:.5*d;return b},getHeight:function(){return f.normalizedLength(this.font.size)},getShapeDescriptors:function(){var a,c=this.font;return c&&(a={},c.size&&(a.size=c.size),c.style&&(a.style=
c.style),c.variant&&(a.variant=c.variant),c.decoration&&(a.decoration=c.decoration),c.weight&&(a.weight=c.weight),c.family&&(a.family=c.family)),{defaultShape:{type:"text",text:this.text,x:0,y:this.getHeight()/4,align:"middle",decoration:this.decoration||c&&c.decoration,rotated:this.rotated,kerning:this.kerning},font:a,fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var a=f.px2pt(this.xoffset),c=f.px2pt(this.yoffset),d=f.px2pt(this.haloSize);return a=isNaN(a)?void 0:a,c=isNaN(c)?void 0:
c,d=isNaN(d)?void 0:d,e.fixJson(k.mixin(this.inherited("toJson",arguments),{type:"esriTS",backgroundColor:this.backgroundColor,borderLineColor:this.borderLineColor,borderLineSize:this.borderLineSize,haloSize:d,haloColor:this.haloColor&&l.toJsonColor(this.haloColor),verticalAlignment:this.verticalAlignment,horizontalAlignment:this.horizontalAlignment,rightToLeft:this.rightToLeft,width:this.width,angle:this.angle&&-1*this.angle,xoffset:a,yoffset:c,text:this.text,rotated:this.rotated,kerning:this.kerning,
font:this.font.toJson()}))}});return k.mixin(h,{ALIGN_START:"start",ALIGN_MIDDLE:"middle",ALIGN_END:"end",DECORATION_NONE:"none",DECORATION_UNDERLINE:"underline",DECORATION_OVERLINE:"overline",DECORATION_LINETHROUGH:"line-through"}),h.defaultProps=d,a("extend-esri")&&(k.setObject("symbol.TextSymbol",h,b),b.symbol.defaultTextSymbol=d),h})},"esri/symbols/Font":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang".split(" "),function(h,k,a,f,b,e){h=h(null,
{declaredClass:"esri.symbol.Font",constructor:function(b,e,g,d,c){b?k.isObject(b)?k.mixin(this,b):(this.size=b,parseFloat(this.size)==this.size&&(this.size+="px"),void 0!==e&&(this.style=e),void 0!==g&&(this.variant=g),void 0!==d&&(this.weight=d),void 0!==c&&(this.family=c)):k.mixin(this,f.defaultFont);parseFloat(this.size)==this.size&&(this.size+="pt");9>a("ie")&&this.size&&k.isString(this.size)&&-1<this.size.indexOf("em")&&(this.size=f.pt2px(12*parseFloat(this.size))+"px");this.size=this._convert2PxSize(this.size)},
setSize:function(a){return this.size=this._convert2PxSize(a),this},_convert2PxSize:function(a){var b;return parseFloat(a)==a?b=a:k.isString(a)&&(-1<a.indexOf("pt")?b=f.pt2px(parseFloat(a)):-1<a.indexOf("px")?b=parseFloat(a):-1<a.indexOf("em")?b=f.pt2px(12*parseFloat(a)):-1<a.indexOf("%")&&(b=f.pt2px(.12*parseFloat(a)))),b},setStyle:function(a){return this.style=a,this},setVariant:function(a){return this.variant=a,this},setWeight:function(a){return this.weight=a,this},setFamily:function(a){return this.family=
a,this},setDecoration:function(a){return this.decoration=a,this},toJson:function(){return e.fixJson({size:f.px2pt(this.size),style:this.style,variant:this.variant,decoration:this.decoration,weight:this.weight,family:this.family})}});return k.mixin(h,{STYLE_NORMAL:"normal",STYLE_ITALIC:"italic",STYLE_OBLIQUE:"oblique",VARIANT_NORMAL:"normal",VARIANT_SMALLCAPS:"small-caps",WEIGHT_NORMAL:"normal",WEIGHT_BOLD:"bold",WEIGHT_BOLDER:"bolder",WEIGHT_LIGHTER:"lighter"}),a("extend-esri")&&k.setObject("symbol.Font",
h,b),h})},"esri/tasks/query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils ./SpatialRelationship require require require".split(" "),function(h,k,a,f,b,e,l,m){var g=h(null,{declaredClass:"esri.tasks.Query",constructor:function(){this.spatialRelationship=g.SPATIAL_REL_INTERSECTS},text:null,where:"",geometry:null,groupByFieldsForStatistics:null,objectIds:null,returnGeometry:!1,returnDistinctValues:!1,orderByFields:null,
outSpatialReference:null,outFields:null,outStatistics:null,timeExtent:null,relationParam:null,pixelSize:null,distance:null,units:null,resultOffset:null,resultRecordCount:null,resultType:null,sqlFormat:null,quantizationParameters:null,_units:{meters:"esriSRUnit_Meter",kilometers:"esriSRUnit_Kilometer",feet:"esriSRUnit_Foot",miles:"esriSRUnit_StatuteMile","nautical-miles":"esriSRUnit_NauticalMile","us-nautical-miles":"esriSRUnit_USNauticalMile"},toJson:function(d){var c={text:this.text,where:this.where,
returnGeometry:this.returnGeometry,spatialRel:this.spatialRelationship,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision,sqlFormat:this.sqlFormat},b=d&&d.geometry||this.geometry,e=this.objectIds,m=this.outFields,r=this.outSpatialReference,h=this.groupByFieldsForStatistics,u=this.orderByFields,k=this.outStatistics;d=this.distance;if(b&&(c.geometry=b,c.geometryType=l.getJsonType(b),c.inSR=b.spatialReference.wkid||f.toJson(b.spatialReference.toJson())),e&&(c.objectIds=
e.join(",")),m&&(c.outFields=m.join(",")),this.returnDistinctValues&&(c.returnDistinctValues=!0),h&&(c.groupByFieldsForStatistics=h.join(",")),u&&(c.orderByFields=u.join(",")),k){var x=[];a.forEach(k,function(a){x.push(a.toJson())});c.outStatistics=f.toJson(x)}r?c.outSR=r.wkid||f.toJson(r.toJson()):b&&(c.outSR=b.spatialReference.wkid||f.toJson(b.spatialReference.toJson()));b=this.timeExtent;c.time=b?b.toJson().join(","):null;b=this.relationParam;return b&&this.spatialRelationship===g.SPATIAL_REL_RELATION&&
(c.relationParam=b),d&&(c.distance=this.distance,this.hasOwnProperty("units")?c.units=this._units[this.units]||this._units.meters:(console.warn("esri/tasks/query::no distance unit provided, defaulting to meters"),c.units=this._units.meters)),this.hasOwnProperty("start")&&(c.resultOffset=this.start,c.resultRecordCount=10,""===c.where&&(c.where="1\x3d1")),this.hasOwnProperty("num")&&(c.resultRecordCount=this.num),c.resultType=this.resultType,c.pixelSize=this.pixelSize?f.toJson(this.pixelSize.toJson()):
null,c.multipatchOption=this.multipatchOption,this.quantizationParameters&&(c.quantizationParameters=f.toJson(this.quantizationParameters)),c._ts=this._ts,c}});return k.mixin(g,m),b("extend-esri")&&k.setObject("tasks.Query",g,e),g})},"esri/tasks/SpatialRelationship":function(){define(["dojo/_base/lang","dojo/has","../kernel"],function(h,k,a){var f={SPATIAL_REL_INTERSECTS:"esriSpatialRelIntersects",SPATIAL_REL_CONTAINS:"esriSpatialRelContains",SPATIAL_REL_CROSSES:"esriSpatialRelCrosses",SPATIAL_REL_ENVELOPEINTERSECTS:"esriSpatialRelEnvelopeIntersects",
SPATIAL_REL_INDEXINTERSECTS:"esriSpatialRelIndexIntersects",SPATIAL_REL_OVERLAPS:"esriSpatialRelOverlaps",SPATIAL_REL_TOUCHES:"esriSpatialRelTouches",SPATIAL_REL_WITHIN:"esriSpatialRelWithin",SPATIAL_REL_RELATION:"esriSpatialRelRelation"};return k("extend-esri")&&h.setObject("tasks._SpatialRelationship",f,a),f})},"esri/Evented":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/Evented dojo/has ./kernel".split(" "),function(h,k,a,f,b,e){h=h([f],{declaredClass:"esri.Evented",registerConnectEvents:function(){var a,
b,g,d,c=this.constructor;a=this.constructor._meta.parents;var e=[{}],f={},t=function(a,c){k.isArray(a)||(a=[a]);for(var d=0;d<a.length;d++){var b=a[d];b._meta&&b._meta.parents&&t(b._meta.parents,c);b.prototype._eventMap&&c.push(k.mixin({},b.prototype._eventMap))}return c};if(!c._onMap){t(a,e);e.push(this._eventMap);a=k.mixin.apply(this,e);for(b in this)/^on\w/.test(b)&&k.isFunction(this[b])&&(g=this._hyphenLower(b).toLowerCase(),a[g]||(f[g]={method:b}));for(d in a)b=this._onCamelCase(d),f[d]={method:b,
argKeys:a[d]};return c._onMap=f,c._onMap}},on:function(b,e){if(-1<b.indexOf(",")){for(var g=b.split(/\s*,\s*/),d=g.length,c=[];d--;)c.push(this.on(g[d],e));return c.remove=function(){for(var a=0;a<c.length;a++)c[a].remove()},c}var d=this.constructor._onMap||this.registerConnectEvents(),f="string"==typeof b&&b.toLowerCase(),l=this._onCamelCase(f),m=d&&d[f];return(l=m&&m.method||this[l]&&k.isFunction(this[l])&&l)?m&&k.isArray(m.argKeys)?(g=this._onArr2Obj(e,d[f].argKeys),a.after(this,l,g,!0)):a.after(this,
l,function(a){a=a||{};a.target||(a.target=this);e.call(this,a)},!0):this.inherited(arguments)},emit:function(a,b){var g,d,c,e,f,l=a.toLowerCase(),m=this._onCamelCase(a),h=this.constructor._onMap||this.registerConnectEvents();return c=h&&h[l]&&h[l].method||k.isFunction(this[m])&&m,e=c&&this[c],c&&h&&h[l]&&this._onObj2Arr(function(){d=Array.prototype.slice.call(arguments)},h[l].argKeys)(b),b=b||{},b.target||(b.target=this),e&&(f=d&&d.length?d:[b],g=e.apply(this,f)),this.inherited(arguments,[a,b]),g},
_onObj2Arr:function(a,b){if(b){var g=this;return function(d){var c,e=[],f=b.length;for(c=0;f>c;c++)e[c]=d[b[c]];a.apply(g,e)}}return a},_onArr2Obj:function(a,b){if(b){var g=this;return function(){var d,c={},e=arguments.length;for(d=0;e>d;d++)c[b[d]]=arguments[d];c.target||(c.target=g);a.call(g,c)}}return a},_hyphenLower:function(a){return a.replace(/^on/,"").replace(/[A-Z](?=[a-z])/g,function(a,b){return(b?"-":"")+a.toLowerCase()})},_onCamelCase:function(a){return"on"+a.substr(0,1).toUpperCase()+
a.substr(1).replace(/\-([a-z])/g,function(a,b){return b.toUpperCase()})}});return b("extend-esri")&&(e.Evented=h),h})},"esri/dijit/InfoView":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-geometry ../kernel ./_TouchBase".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q){h=h(null,{declaredClass:"esri.dijit.InfoView",_items:[],_top:null,_sections:[],_isDecelerate:!1,constructor:function(a,
c){var b;if(this.container=m.byId(c),this._touchBase=q(this.container,null),this._slideDiv=d.create("div",null,this.container,"first"),this.events=[],this._items=a.items,a.sections&&(this._sections=a.sections),g.add(this.container,"esriMobileInfoView"),0===this._sections.length)d.create("div",{},this._slideDiv);else for(b=0;b<this._sections.length;b++){var e=d.create("div",{"class":"esriMobileInfoViewSection"},this._slideDiv);d.create("div",{innerHTML:this._sections[b].title},e)}for(b=0;b<this._items.length;b++){var f,
e=0;switch(this._items[b].section&&(e=this._items[b].section),this._items[b].type){case "div":f=d.create("div",{"class":"esriMobileInfoViewItem",style:this._items[b].style},this._slideDiv.childNodes[e]),f=d.create("div",{innerHTML:this._items[b].text},f)}this._items[b].className&&g.add(f,this._items[b].className);f._index=b;f._item=this._items[b];this._items[b]._node=f}this.startTouchY=0},startup:function(){this.onCreate(this._items);this._animateTo(0)},destroy:function(){a.forEach(this.events,f.disconnect);
this._touchBase=null;b.query("img",this.container).forEach(function(a){a._index=null;a._item=null;d.destroy(a);a=null});this._items=null;d.destroy(this._slideDiv);d.destroy(this.container);this.container=this._slideDiv=null},getItems:function(){return this._items},setPreventDefault:function(a){this._touchBase.setPreventDefault(a)},enableTouchScroll:function(){this._touchBase.setPreventDefault(!0);this.events.push(f.connect(this._touchBase,"onTouchStart",this,this._onTouchStartHandler));this.events.push(f.connect(this._touchBase,
"onTouchMove",this,this._onTouchMoveHandler));this.events.push(f.connect(this._touchBase,"onTouchEnd",this,this._onTouchEndHandler));this._slideDiv.style.webkitTransform="translate3d(0,"+this._top+"px, 0)"},disableTouchScroll:function(){f.disconnect(this.events.pop());f.disconnect(this.events.pop());f.disconnect(this.events.pop());this._touchBase.setPreventDefault(!1);this._slideDiv.style.webkitTransform="translate3d(0, 0px, 0)"},animateTo:function(){this._slideDiv.style.WebkitTransitionDuration=
"0s";this._animateTo(0)},onSelect:function(a){},onUnSelect:function(a){},onCreate:function(a){},onClick:function(a){},onSwipeLeft:function(){},onSwipeRight:function(){},_onTouchStartHandler:function(a){this._slideDiv.style.WebkitTransitionDuration="0s";this._moveDirection=null;this._startTime=new Date;this.startTouchY=a.touches[0].clientY;this.contentStartOffsetY=this.contentOffsetY},_onTouchMoveHandler:function(a){(this._moveDirection||(Math.abs(a.curY)>Math.abs(a.curX)?this._moveDirection="vertical":
this._moveDirection="horizontal"),"horizontal"!==this._moveDirection&&"vertical"===this._moveDirection)&&this._animateTo(a.touches[0].clientY-this.startTouchY+this.contentStartOffsetY)},_onTouchEndHandler:function(a){this._endTime=new Date;this._deltaMovement=a.curY;"vertical"===this._moveDirection?this._shouldStartMomentum()?this._doMomentum():this._snapToBounds():"horizontal"===this._moveDirection&&("left"===a.swipeDirection?this.onSwipeLeft():"right"===a.swipeDirection&&this.onSwipeRight())},_shouldStartMomentum:function(){return this._diff=
this._endTime-this._startTime,this._velocity=this._deltaMovement/this._diff,.2<Math.abs(this._velocity)&&200>this._diff?!0:!1},_doMomentum:function(){var a,b;a=c.getContentBox(this.container);var d=0>this._velocity?.001:-.001;b=-(this._velocity*this._velocity)/(2*d);var g=-this._velocity/d,d=3*.6-0,e=1-d,f=3*.3,f=(1-f-(3*.7-f),0),n=0;if(a.h>this._slideDiv.scrollHeight)this.contentOffsetY=0,n=300;else if(0<this.contentOffsetY+b){a=0;for(b=Math.floor(g/20);b>a;a++)if(f=(20*e*a^3)+(20*d*a^2)+0*a+0,f=
0>this._velocity?-f:f,0<this.contentOffsetY+f){n=20*a;break}0===n&&(n=300);this.contentOffsetY=0}else if(Math.abs(this.contentOffsetY+b)+a.h>this._slideDiv.scrollHeight)for(this.contentOffsetY=a.h-this._slideDiv.scrollHeight,a=0,b=Math.floor(g/20);b>a;a++){if(f=(20*e*a^3)+(20*d*a^2)+0*a+0,f=0>this._velocity?-f:f,Math.abs(this.contentOffsetY+f)>this._slideDiv.scrollHeight){n=20*a;break}}else n=g,this.contentOffsetY+=b;this._slideDiv.style.webkitTransition="-webkit-transform "+n+"ms cubic-bezier(0, 0.3, 0.6, 1)";
this._animateTo(this.contentOffsetY)},_snapToBounds:function(){var a=c.getContentBox(this.container);a.h>this._slideDiv.scrollHeight?this.contentOffsetY=0:0<this.contentOffsetY?this.contentOffsetY=0:Math.abs(this.contentOffsetY)+a.h>this._slideDiv.scrollHeight&&(this.contentOffsetY=a.h-this._slideDiv.scrollHeight);this._slideDiv.style.WebkitTransitionDuration="0.5s";this._animateTo(this.contentOffsetY)},_animateTo:function(a){this.contentOffsetY=a;this._slideDiv.style.webkitTransform="translate3d(0, "+
a+"px, 0)"},_stopMomentum:function(){if(this._isDecelerating()){var a=document.defaultView.getComputedStyle(this._slideDiv,null),a=new WebKitCSSMatrix(a.webkitTransform);this._slideDiv.style.webkitTransition="";this.animateTo(a.m42)}},_isDecelerating:function(){return this.isDecelerate?!0:!1},_toggleNode:function(a,c){"ON"===c.toggleState?(c.toggleState="OFF",c.src&&(a.src=c.src.toString()),this.onUnSelect(c)):(c.toggleState="ON",c.srcAlt&&(a.src=c.srcAlt),this.onSelect(c))}});return e("extend-esri")&&
k.setObject("dijit.InfoView",h,n),h})},"esri/dijit/_TouchBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/dom dojo/has ../kernel".split(" "),function(h,k,a,f,b,e){h=h(null,{declaredClass:"esri.dijit._TouchBase",_preventDefault:!0,_swipeThreshold:20,constructor:function(b,e){this.domNode=f.byId(b);this.events=[a.connect(this.domNode,"touchstart",this,this._touchStartHandler),a.connect(this.domNode,"touchmove",this,this._touchMoveHandler),a.connect(this.domNode,"touchend",
this,this._touchEndHandler),a.connect(this.domNode,"onclick",this,this._clickHandler)]},setPreventDefault:function(a){this._preventDefault=a},disableOnClick:function(){a.disconnect(this.events.pop())},_clickHandler:function(a){this._moved?a.preventDefault():this.onclick(a)},_touchStartHandler:function(a){this._moved=!1;this.client_x=a.targetTouches[0].clientX;this.client_y=a.targetTouches[0].clientY;this.down_x=a.targetTouches[0].pageX;this.down_y=a.targetTouches[0].pageY;a.downX=this.down_x;a.downY=
this.down_y;this.onTouchStart(a)},_touchMoveHandler:function(a){this._preventDefault&&a.preventDefault();this._moved=!0;this.up_x=a.targetTouches[0].pageX;this.cur_x=a.targetTouches[0].pageX-this.down_x;this.cur_y=a.targetTouches[0].pageY-this.down_y;a.curX=this.cur_x;a.curY=this.cur_y;this.onTouchMove(a)},_touchEndHandler:function(a){this._moved?(a.curX=this.cur_x,a.curY=this.cur_y,this.down_x-this.up_x>this._swipeThreshold?a.swipeDirection="left":this.up_x-this.down_x>this._swipeThreshold&&(a.swipeDirection=
"right")):(a.clientX=this.client_x,a.clientY=this.client_y);this.onTouchEnd(a)},onTouchStart:function(a){},onTouchMove:function(a){},onTouchEnd:function(a){},onclick:function(a){}});return b("extend-esri")&&k.setObject("dijit._TouchBase",h,e),h})},"esri/dijit/NavigationBar":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct ./_TouchBase ../kernel".split(" "),function(h,k,a,f,b,e,
l,m,g,d,c,n){h=h(null,{declaredClass:"esri.dijit.NavigationBar",_items:[],constructor:function(b,e){var f;this.container=m.byId(e);this._touchBase=c(this.container,null);this._slideDiv=d.create("div",{},this.container,"first");this.events=[a.connect(this._touchBase,"onclick",this,this._onClickHandler)];this._items=b.items;g.add(this.container,"esriMobileNavigationBar");var n=d.create("div",{},this._slideDiv);for(f=0;f<this._items.length;f++){var l,q;switch(this._items[f].type){case "img":q=d.create("div",
{"class":"esriMobileNavigationItem"},n);l=d.create("img",{src:this._items[f].src.toString(),style:{width:"100%",height:"100%"}},q);break;case "span":q=d.create("div",{"class":"esriMobileNavigationItem"},n);l=d.create("span",{innerHTML:this._items[f].text},q);break;case "div":q=d.create("div",{"class":"esriMobileNavigationInfoPanel"},n),l=d.create("div",{innerHTML:this._items[f].text},q)}g.add(q,this._items[f].position);this._items[f].className&&g.add(l,this._items[f].className);l._index=f;l._item=
this._items[f];this._items[f]._node=l}},startup:function(){this.onCreate(this._items)},destroy:function(){f.forEach(this.events,a.disconnect);this._touchBase=null;b.query("img",this.container).forEach(function(a){a._index=null;a._item=null;d.destroy(a);a=null});this._items=null;d.destroy(this._slideDiv);d.destroy(this.container);this.container=this._slideDiv=null},getItems:function(){return this._items},select:function(a){this._markSelected(a._node,a)},onSelect:function(a){},onUnSelect:function(a){},
onCreate:function(a){},_onClickHandler:function(a){if("img"===a.target.tagName.toLowerCase()){var c=a.target,d=(c._index,c._item);b.query("img",this.container).forEach(function(a){a!==c&&a._item.toggleGroup===d.toggleGroup&&this._markUnSelected(a,a._item)},this);this._toggleNode(c,d)}},_toggleNode:function(a,c){"ON"===c.toggleState?(c.toggleState="OFF",c.src&&(a.src=c.src.toString()),this.onUnSelect(c)):(c.toggleState="ON",c.srcAlt&&(a.src=c.srcAlt),this.onSelect(c))},_markSelected:function(a,c){c.toggleState=
"ON";c.srcAlt&&(a.src=c.srcAlt);this.onSelect(c)},_markUnSelected:function(a,c){"ON"===c.toggleState&&(c.toggleState="OFF",c.src&&(a.src=c.src.toString()),this.onUnSelect(c))}});return e("extend-esri")&&k.setObject("dijit.NavigationBar",h,n),h})},"dojo/NodeList-dom":function(){define("./_base/kernel ./query ./_base/array ./_base/lang ./dom-class ./dom-construct ./dom-geometry ./dom-attr ./dom-style".split(" "),function(h,k,a,f,b,e,l,m,g){function d(a){return function(c,b,d){return 2==arguments.length?
a["string"==typeof b?"get":"set"](c,b):a.set(c,b,d)}}var c=function(a){return 1==a.length&&"string"==typeof a[0]},n=function(a){var c=a.parentNode;c&&c.removeChild(a)},q=k.NodeList,t=q._adaptWithCondition,r=q._adaptAsForEach,v=q._adaptAsMap;f.extend(q,{_normalize:function(a,c){var b=!0===a.parse;if("string"==typeof a.template){var d=a.templateFunc||h.string&&h.string.substitute;a=d?d(a.template,a):a}d=typeof a;"string"==d||"number"==d?(a=e.toDom(a,c&&c.ownerDocument),a=11==a.nodeType?f._toArray(a.childNodes):
[a]):f.isArrayLike(a)?f.isArray(a)||(a=f._toArray(a)):a=[a];b&&(a._runParse=!0);return a},_cloneNode:function(a){return a.cloneNode(!0)},_place:function(a,c,b,d){if(1==c.nodeType||"only"!=b)for(var g,f=a.length,n=f-1;0<=n;n--){var l=d?this._cloneNode(a[n]):a[n];if(a._runParse&&h.parser&&h.parser.parse)for(g||(g=c.ownerDocument.createElement("div")),g.appendChild(l),h.parser.parse(g),l=g.firstChild;g.firstChild;)g.removeChild(g.firstChild);n==f-1?e.place(l,c,b):c.parentNode.insertBefore(l,c);c=l}},
position:v(l.position),attr:t(d(m),c),style:t(d(g),c),addClass:r(b.add),removeClass:r(b.remove),toggleClass:r(b.toggle),replaceClass:r(b.replace),empty:r(e.empty),removeAttr:r(m.remove),marginBox:v(l.getMarginBox),place:function(a,c){var b=k(a)[0];return this.forEach(function(a){e.place(a,b,c)})},orphan:function(a){return(a?k._filterResult(this,a):this).forEach(n)},adopt:function(a,c){return k(a).place(this[0],c)._stash(this)},query:function(a){if(!a)return this;var c=new q;this.map(function(b){k(a,
b).forEach(function(a){void 0!==a&&c.push(a)})});return c._stash(this)},filter:function(c){var b=arguments,d=this,g=0;if("string"==typeof c){d=k._filterResult(this,b[0]);if(1==b.length)return d._stash(this);g=1}return this._wrap(a.filter(d,b[g],b[g+1]),this)},addContent:function(a,c){a=this._normalize(a,this[0]);for(var b=0,d;d=this[b];b++)a.length?this._place(a,d,c,0<b):e.empty(d);return this}});return q})},"cmv/viewer/js/viewer/_MapMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/dom dojo/_base/array dojo/Deferred esri/map esri/IdentityManager".split(" "),
function(h,k,a,f,b,e,l){return h(null,{postConfig:function(){this.mapDeferred=new e;return this.inherited(arguments)},startup:function(){this.inherited(arguments);this.layoutDeferred.then(k.hitch(this,"initMapAsync"))},initMapAsync:function(){var a=new e,b=[];this.createMap(b).then(k.hitch(this,"_createMapResult",a,b));a.then(k.hitch(this,"initMapComplete"));return a},createMap:function(a){var b=this.inherited(arguments);if(b)return b;var d=new e,b=f.byId(this.config.layout.map)||"mapCenter";this.map=
new l(b,this.config.mapOptions);(b=this.inherited(arguments))?b.then(function(c){c&&(a=a.concat(c));d.resolve(a)}):d.resolve(a);return d},_createMapResult:function(b,g){if(this.map){if(!this.config.webMapId&&this.config.mapOptions&&this.config.mapOptions.basemap)this.map.on("load",k.hitch(this,"_initLayers",g));else this._initLayers(g);if(this.config.operationalLayers&&0<this.config.operationalLayers.length)a.once(this.map,"layers-add-result",k.hitch(this,"_onLayersAddResult",b,g));else b.resolve(g)}else b.resolve(g);
return b},_onLayersAddResult:function(a,g,d){b.forEach(d.layers,function(a){!0!==a.success&&g.push(a.error)},this);a.resolve(g)},_initLayers:function(a){this.layers=[];var g={csv:"esri/layers/CSVLayer",dataadapter:"esri/layers/DataAdapterFeatureLayer",dynamic:"esri/layers/ArcGISDynamicMapServiceLayer",feature:"esri/layers/FeatureLayer",georss:"esri/layers/GeoRSSLayer",graphics:"esri/layers/GraphicsLayer",image:"esri/layers/ArcGISImageServiceLayer",imagevector:"esri/layers/ArcGISImageServiceVectorLayer",
kml:"esri/layers/KMLLayer",mapimage:"esri/layers/MapImageLayer",osm:"esri/layers/OpenStreetMapLayer",raster:"esri/layers/RasterLayer",stream:"esri/layers/StreamLayer",tiled:"esri/layers/ArcGISTiledMapServiceLayer",vectortile:"esri/layers/VectorTileLayer",webtiled:"esri/layers/WebTiledLayer",wfs:"esri/layers/WFSLayer",wms:"esri/layers/WMSLayer",wmts:"esri/layers/WMTSLayer"},g=k.mixin(g,this.config.layerTypes||{}),d=[];b.forEach(this.config.operationalLayers,function(c){var b=g[c.type];b?d.push(b):
a.push('Layer type "'+c.type+'" is not supported: ')},this);require(d,k.hitch(this,function(){b.forEach(this.config.operationalLayers,function(a){var c=g[a.type];c&&require([c],k.hitch(this,"_initLayer",a))},this);this.map.addLayers(this.layers)}))},_initLayer:function(a,b){var d;d=a.url?new b(a.url,a.options):new b(a.options);this.layers.unshift(d);var c=!1;"undefined"!==typeof a.legendLayerInfos&&"undefined"!==typeof a.legendLayerInfos.exclude&&(c=a.legendLayerInfos.exclude);c||(c={},"undefined"!==
typeof a.legendLayerInfos&&"undefined"!==typeof a.legendLayerInfos.layerInfo&&(c=a.legendLayerInfos.layerInfo),c=k.mixin({layer:d,title:a.title||null},c),this.legendLayerInfos.unshift(c));this.layerControlLayerInfos.unshift({layer:d,type:a.type,title:a.title,controlOptions:a.layerControlLayerInfos});"feature"===a.type&&(c={featureLayer:d},a.editorLayerInfos&&k.mixin(c,a.editorLayerInfos),!0!==c.exclude&&this.editorLayerInfos.push(c));if("dynamic"===a.type||"feature"===a.type)d={layer:d,title:a.title},
a.identifyLayerInfos&&k.mixin(d,a.identifyLayerInfos),!0!==d.exclude&&this.identifyLayerInfos.push(d)},initMapComplete:function(a){a&&0<a.length&&this.handleError({source:"Controller",error:a.join(", ")});this.map&&(this.map.on("resize",function(a){var b=a.target.extent.getCenter();setTimeout(function(){a.target.centerAt(b)},100)}),this.mapDeferred.resolve(this.map))},initMapError:function(a){this.handleError({source:"Controller",error:a})},resizeMap:function(){this.map&&this.map.resize()},getMapHeight:function(){return this.map?
this.map.height:0}})})},"esri/map":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/event dojo/on dojo/aspect dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/a11yclick dijit/registry ./kernel ./config ./sniff ./lang ./_coremap ./MapNavigationManager dojo/i18n!./nls/jsapi".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C){var D={up:"panUp",right:"panRight",
down:"panDown",left:"panLeft"},E={upperRight:"panUpperRight",lowerRight:"panLowerRight",lowerLeft:"panLowerLeft",upperLeft:"panUpperLeft"},F=f.connect,G=f.disconnect,I=q.create,J=r.set,L=b.hitch,M=t.getMarginBox,H=k.deprecated,K=b.mixin,P=0;k=a(z,{declaredClass:"esri.Map",constructor:function(a,c){K(this,{_slider:null,_navDiv:null,_mapParams:K({attributionWidth:.45,slider:!0,nav:!1,logo:!0,sliderStyle:"small",sliderPosition:"top-left",sliderOrientation:"vertical",autoResize:!0},c||{})});K(this,{isDoubleClickZoom:!1,
isShiftDoubleClickZoom:!1,isClickRecenter:!1,isScrollWheelZoom:!1,isPan:!1,isRubberBandZoom:!1,isKeyboardNavigation:!1,isPanArrows:!1,isZoomSlider:!1});b.isFunction(w._css)&&(w._css=w._css(this._mapParams.force3DTransforms),this.force3DTransforms=this._mapParams.force3DTransforms);var d=y("esri-transforms")&&y("esri-transitions");if(this.navigationMode=this._mapParams.navigationMode||d&&"css-transforms"||"classic","css-transforms"!==this.navigationMode||d||(this.navigationMode="classic"),this.fadeOnZoom=
A.isDefined(this._mapParams.fadeOnZoom)?this._mapParams.fadeOnZoom:"css-transforms"===this.navigationMode,"css-transforms"!==this.navigationMode&&(this.fadeOnZoom=!1),this.setMapCursor("default"),this.smartNavigation=c&&c.smartNavigation,!(A.isDefined(this.smartNavigation)||!y("mac")||y("esri-touch")||y("esri-pointer")||3.5>=y("ff"))){var f=navigator.userAgent.match(/Mac\s+OS\s+X\s+([\d]+)(\.|\_)([\d]+)\D/i);f&&A.isDefined(f[1])&&A.isDefined(f[3])&&(d=parseInt(f[1],10),f=parseInt(f[3],10),this.smartNavigation=
10<d||10===d&&6<=f)}this.showAttribution=A.isDefined(this._mapParams.showAttribution)?this._mapParams.showAttribution:!0;this._onLoadHandler_connect=F(this,"onLoad",this,"_onLoadInitNavsHandler");var n=I("div",{"class":"esriControlsBR"+(this._mapParams.nav?" withPanArrows":"")},this.root);if(this.showAttribution)if(d=b.getObject("esri.dijit.Attribution",!1))this._initAttribution(d,n);else{var l=P++,q=this;this._rids&&this._rids.push(l);h(["./dijit/Attribution"],function(a){var c=q._rids?e.indexOf(q._rids,
l):-1;-1!==c&&(q._rids.splice(c,1),q._initAttribution(a,n))})}this._mapParams.logo&&(d={},6===y("ie")&&(d.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+h.toUrl("./images/map/logo-med.png")+"')"),this._ogol=I("div",{style:d,tabIndex:"0",title:"Esri"},n),this._setLogoSize(),this._onMapResizeLogo_connect=F(this,"onResize",this,"_setLogoSize"),this._ogol_connect=F(this._ogol,v,this,"_openLogoLink"));if(this.navigationManager=new B(this),
c&&c.basemap&&(this._onLoadFix=!0,this.setBasemap(c.basemap),this._onLoadFix=!1),this.autoResize=this._mapParams.autoResize,this.autoResize)d=this._getEnclosingResizableWidget(this.container)||window,f=this.resize,this._rszSignal=m.pausable(d,"resize",f),this._oriSignal=m.pausable(window,"orientationchange",f),g.after(d,"resize",f,!0),this._startResizeTimer()},_startResizeTimer:function(){clearTimeout(this._persistentTimer);this._persistentTimer=setTimeout(this._timedResize,2*this.resizeDelay)},_getEnclosingResizableWidget:function(a){var c=
u.getEnclosingWidget(a);return c?c.resize?c:this._getEnclosingResizableWidget(a.parentNode):c},_setLogoSize:function(){this._ogol&&(25E4>this.root.clientWidth*this.root.clientHeight?(n.remove(this._ogol,"logo-med"),n.add(this._ogol,"logo-sm")):(n.remove(this._ogol,"logo-sm"),n.add(this._ogol,"logo-med")))},_initAttribution:function(a,c){var b=I("span",{"class":"esriAttribution"},c,"first");J(b,"maxWidth",Math.floor(this.width*this._mapParams.attributionWidth)+"px");this._connects.push(F(b,v,function(){n.contains(this,
"esriAttributionOpen")?n.remove(this,"esriAttributionOpen"):this.scrollWidth>this.clientWidth&&n.add(this,"esriAttributionOpen")}));this.attribution=new a({map:this},b)},_cleanUp:function(){this.disableMapNavigation();this.navigationManager.destroy();var a=this._slider;a&&a.destroy&&!a._destroyed&&a.destroy();var a=this._navDiv,c=this.attribution;a&&q.destroy(a);c&&c.destroy();this._connects.push(this._slider_connect,this._ogol_connect,this._rszSignal,this._oriSignal);e.forEach(this._connects,G);
clearInterval(this._persistentTimer);this.attribution=this.navigationManager=this._rids=this._connects=this._slider_connect=this._ogol_connect=this._rszSignal=this._oriSignal=this._persistentTimer=null;this.inherited("_cleanUp",arguments)},_isPanningOrZooming:function(){return this.__panning||this.__zooming},_canZoom:function(a){var c=this.getLevel();return!this.__tileInfo||!(c===this.getMinZoom()&&0>a||c===this.getMaxZoom()&&0<a)},_onLoadInitNavsHandler:function(){if(this.enableMapNavigation(),this._createNav(),
"small"!==this._mapParams.sliderStyle&&this._createSlider){if(this._mapParams.slider){var a=-1!==this._getSliderClass(!0).indexOf("Horizontal"),a=[a?"dijit.form.HorizontalSlider":"dijit.form.VerticalSlider",a?"dijit.form.HorizontalRule":"dijit.form.VerticalRule",a?"dijit.form.HorizontalRuleLabels":"dijit.form.VerticalRuleLabels"];if(e.some(a,function(a){return!b.getObject(a,!1)})){var a=e.map(a,function(a){return a.replace(/\./g,"/")}),c=P++,d=this;this._rids&&this._rids.push(c);h(a,function(){var a=
d._rids?e.indexOf(d._rids,c):-1;-1!==a&&(d._rids.splice(a,1),d._createSlider.apply(d,arguments))})}else a=e.map(a,function(a){return b.getObject(a,!1)}),this._createSlider.apply(this,a)}}else this._createSimpleSlider();G(this._onLoadHandler_connect)},_createNav:function(){if(this._mapParams.nav){var a,c,b,d=n.add,g=this.id;this._navDiv=I("div",{id:g+"_navdiv"},this.root);d(this._navDiv,"navDiv");var e,f=this.width/2,l=this.height/2;for(b in D)c=D[b],a=I("div",{id:g+"_pan_"+b},this._navDiv),d(a,"fixedPan "+
c),"up"===b||"down"===b?(e=parseInt(M(a).w,10)/2,J(a,{left:f-e+"px",zIndex:30})):(e=parseInt(M(a).h,10)/2,J(a,{top:l-e+"px",zIndex:30})),this._connects.push(F(a,"onclick",L(this,this[c])));this._onMapResizeNavHandler_connect=F(this,"onResize",this,"_onMapResizeNavHandler");for(b in E)c=E[b],a=I("div",{id:g+"_pan_"+b,style:{zIndex:30}},this._navDiv),d(a,"fixedPan "+c),this._connects.push(F(a,"onclick",L(this,this[c])));this.isPanArrows=!0}},_onMapResizeNavHandler:function(a,c,b){var g,e;a=this.id;
c/=2;var f=b/2,n=d.byId;for(g in D)b=n(a+"_pan_"+g),"up"===g||"down"===g?(e=parseInt(M(b).w,10)/2,J(b,"left",c-e+"px")):(e=parseInt(M(b).h,10)/2,J(b,"top",f-e+"px"))},_createSimpleSlider:function(){if(this._mapParams.slider){var a=this._slider=I("div",{id:this.id+"_zoom_slider","class":this._getSliderClass(),style:{zIndex:30}}),c=I("div",{"class":"esriSimpleSliderIncrementButton",tabIndex:"0",role:"button"},a),b=I("div",{"class":"esriSimpleSliderDecrementButton",tabIndex:"0",role:"button"},a);this._addZoomButtonTooltips(c,
b);this._incButton=c;this._decButton=b;this._simpleSliderZoomHandler(null,null,null,this.getLevel());var g=C.widgets.zoomSlider;this._addZoomButtonIcon(c,"+",g.zoomIn);this._addZoomButtonIcon(b,"\x26minus;",g.zoomOut);8>y("ie")&&n.add(b,"dj_ie67Fix");this._connects.push(F(c,v,this,this._simpleSliderChangeHandler));this._connects.push(F(b,v,this,this._simpleSliderChangeHandler));(-1<this.getMaxZoom()||-1<this.getMinZoom())&&this._connects.push(F(this,"onZoomEnd",this,this._simpleSliderZoomHandler));
10>y("ie")&&d.setSelectable(a,!1);this.root.appendChild(a);this.isZoomSlider=!0}},_simpleSliderChangeHandler:function(a){l.stop(a);a=-1!==a.currentTarget.className.indexOf("IncrementButton")?!0:!1;this._extentUtil({numLevels:a?1:-1})},_simpleSliderZoomHandler:function(a,c,b,d){var g;a=this._incButton;c=this._decButton;-1<d&&d===this.getMaxZoom()?g=a:-1<d&&d===this.getMinZoom()&&(g=c);g?(n.add(g,"esriSimpleSliderDisabledButton"),n.remove(g===a?c:a,"esriSimpleSliderDisabledButton")):(n.remove(a,"esriSimpleSliderDisabledButton"),
n.remove(c,"esriSimpleSliderDisabledButton"))},_getSliderClass:function(a){a=a?"Large":"Simple";var c=this._mapParams.sliderOrientation,b=this._mapParams.sliderPosition||"";if(c=c&&"horizontal"===c.toLowerCase()?"esri"+a+"SliderHorizontal":"esri"+a+"SliderVertical",b)switch(b.toLowerCase()){case "top-left":b="esri"+a+"SliderTL";break;case "top-right":b="esri"+a+"SliderTR";break;case "bottom-left":b="esri"+a+"SliderBL";break;case "bottom-right":b="esri"+a+"SliderBR"}return"esri"+a+"Slider "+c+" "+
b},_addZoomButtonIcon:function(a,c,b){q.create("span",{"aria-hidden":"true",role:"presentation",innerHTML:c},a);q.create("span",{"class":"esriIconFallbackText",innerHTML:b},a)},_addZoomButtonTooltips:function(a,b){var d=C.widgets.zoomSlider;c.set(a,"title",d.zoomIn);c.set(b,"title",d.zoomOut)},_createSlider:function(a,c,b){if(this._mapParams.slider){var d,g=I("div",{id:this.id+"_zoom_slider"},this.root);d=x.defaults.map;var f=this._getSliderClass(!0),n=-1!==f.indexOf("Horizontal"),l=this.getNumLevels();
if(0<l){var m,q,r=this._mapParams.sliderLabels,u=!!r,t=!1!==r;if(t){var h=n?"bottomDecoration":"rightDecoration";if(!r)for(r=[],d=0;l>d;d++)r[d]="";e.forEach([{"class":"esriLargeSliderTicks",container:h,count:l,dijitClass:c},{"class":u&&"esriLargeSliderLabels",container:h,count:l,labels:r,dijitClass:b}],function(a){var b=I("div"),d=a.dijitClass;delete a.dijitClass;g.appendChild(b);d===c?m=new d(a,b):q=new d(a,b)})}a=this._slider=new a({id:g.id,"class":f,minimum:this.getMinZoom(),maximum:this.getMaxZoom(),
discreteValues:l,value:this.getLevel(),clickSelect:!0,intermediateChanges:!0,style:"z-index:30;"},g);a.startup();t&&(m.startup(),q.startup());this._slider_connect=F(a,"onChange",this,"_onSliderChangeHandler");this._connects.push(F(this,"onExtentChange",this,"_onExtentChangeSliderHandler"));this._connects.push(F(a._movable,"onFirstMove",this,"_onSliderMoveStartHandler"))}else{a=this._slider=new a({id:g.id,"class":f,minimum:0,maximum:2,discreteValues:3,value:1,clickSelect:!0,intermediateChanges:d.sliderChangeImmediate,
style:"height:50px; z-index:30;"},g);b=a.domNode.firstChild.childNodes;for(d=1;3>=d;d++)J(b[d],"visibility","hidden");a.startup();this._slider_connect=F(a,"onChange",this,"_onDynSliderChangeHandler");this._connects.push(F(this,"onExtentChange",this,"_onExtentChangeDynSliderHandler"))}d=a.incrementButton;b=a.decrementButton;n?this._addZoomButtonTooltips(d,b):this._addZoomButtonTooltips(b,d);d.style.outline="none";b.style.outline="none";a.sliderHandle.style.outline="none";a._onKeyPress=function(){};
if(n=a._movable){var v=n.onMouseDown;n.onMouseDown=function(a){9>y("ie")&&1!==a.button||v.apply(this,arguments)}}this.isZoomSlider=!0}},_onSliderMoveStartHandler:function(){G(this._slider_connect);G(this._slidermovestop_connect);this._slider_connect=F(this._slider,"onChange",this,"_onSliderChangeDragHandler");this._slidermovestop_connect=F(this._slider._movable,"onMoveStop",this,"_onSliderMoveEndHandler")},_onSliderChangeDragHandler:function(a){this._extentUtil({targetLevel:a})},_onSliderMoveEndHandler:function(){G(this._slider_connect);
G(this._slidermovestop_connect)},_onSliderChangeHandler:function(a){this.setLevel(a)},_updateSliderValue:function(a,c){G(this._slider_connect);var b=this._slider,d=b._onChangeActive;b._onChangeActive=!1;b.set("value",a);b._onChangeActive=d;this._slider_connect=F(b,"onChange",this,c)},_onExtentChangeSliderHandler:function(a,c,b,d){G(this._slidermovestop_connect);this._updateSliderValue(d.level,"_onSliderChangeHandler")},_onDynSliderChangeHandler:function(a){this._extentUtil({numLevels:0<a?1:-1})},
_onExtentChangeDynSliderHandler:function(){this._updateSliderValue(1,"_onDynSliderChangeHandler")},_openLogoLink:function(a){window.open(x.defaults.map.logoLink,"_blank");l.stop(a)},enableMapNavigation:function(){this.navigationManager.enableNavigation()},disableMapNavigation:function(){this.navigationManager.disableNavigation()},enableDoubleClickZoom:function(){this.isDoubleClickZoom||(this.navigationManager.enableDoubleClickZoom(),this.isDoubleClickZoom=!0)},disableDoubleClickZoom:function(){this.isDoubleClickZoom&&
(this.navigationManager.disableDoubleClickZoom(),this.isDoubleClickZoom=!1)},enableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom||(H(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.enableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=!0)},disableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom&&(H(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",
null,"v2.0"),this.navigationManager.disableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=!1)},enableClickRecenter:function(){this.isClickRecenter||(this.navigationManager.enableClickRecenter(),this.isClickRecenter=!0)},disableClickRecenter:function(){this.isClickRecenter&&(this.navigationManager.disableClickRecenter(),this.isClickRecenter=!1)},enablePan:function(){this.isPan||(this.navigationManager.enablePan(),this.isPan=!0)},disablePan:function(){this.isPan&&(this.navigationManager.disablePan(),
this.isPan=!1)},enableRubberBandZoom:function(){this.isRubberBandZoom||(this.navigationManager.enableRubberBandZoom(),this.isRubberBandZoom=!0)},disableRubberBandZoom:function(){this.isRubberBandZoom&&(this.navigationManager.disableRubberBandZoom(),this.isRubberBandZoom=!1)},enableKeyboardNavigation:function(){this.isKeyboardNavigation||(this.navigationManager.enableKeyboardNavigation(),this.isKeyboardNavigation=!0)},disableKeyboardNavigation:function(){this.isKeyboardNavigation&&(this.navigationManager.disableKeyboardNavigation(),
this.isKeyboardNavigation=!1)},enableScrollWheelZoom:function(){this.isScrollWheelZoom||(this.navigationManager.enableScrollWheelZoom(),this.isScrollWheelZoom=!0)},disableScrollWheelZoom:function(){this.isScrollWheelZoom&&(this.navigationManager.disableScrollWheelZoom(),this.isScrollWheelZoom=!1)},enableScrollWheelPan:function(){this.isScrollWheelPan||this.navigationManager.enableScrollWheelPan()},disableScrollWheelPan:function(){this.isScrollWheelPan&&this.navigationManager.disableScrollWheelPan()},
showPanArrows:function(){this._navDiv&&(this._navDiv.style.display="block",this.isPanArrows=!0)},hidePanArrows:function(){this._navDiv&&(this._navDiv.style.display="none",this.isPanArrows=!1)},showZoomSlider:function(){this._slider&&(J(this._slider.domNode||this._slider,"visibility","inherit"),this.isZoomSlider=!0)},hideZoomSlider:function(){this._slider&&(J(this._slider.domNode||this._slider,"visibility","hidden"),this.isZoomSlider=!1)}});return y("extend-esri")&&(w.Map=k),k})},"esri/_coremap":function(){define("require module dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/_base/event dojo/_base/unload dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/sniff dijit/registry dojox/gfx/matrix ./kernel ./config ./basemaps ./lang ./Evented ./fx ./deferredUtils ./tileUtils ./urlUtils ./PluginTarget ./Color ./arcade/Dictionary ./geometry/Point ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./geometry/scaleUtils ./geometry/screenUtils ./geometry/webMercatorUtils ./layers/GraphicsLayer ./layers/TileInfo ./layers/LOD ./layers/ArcGISTiledMapServiceLayer ./layers/MapImageLayer ./layers/OpenStreetMapLayer ./layers/VectorTileLayer ./dijit/Popup ./plugins/popupManager dojo/uacss".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J,L,M,H,K,P,O,S,Q,R,aa,X,T,V,da,ga,la,Aa){function ta(a,c){var b=a.lods;b.sort(function(a,c){return a.scale>c.scale?-1:a.scale<c.scale?1:0});var d=[],b=m.filter(b,function(a){return-1===Ba(d,a.scale)?(d.push(a.scale),!0):void 0}),g,e=c.lods=[];m.forEach(b,function(a,c){g=e[c]=new T(a);g.level=c});c.tileInfo=new X(ra(a,{lods:e}))}var pa,wa=Q.toMapPoint,oa=Q.toScreenPoint,ma=b.connect,ia=b.disconnect,ja=l.hitch,za=v.set,Ba=m.indexOf,
ra=l.mixin,ua=0,xa=A.defaults.map,Ha=xa.layerNamePrefix,Ia=xa.graphicsLayerNamePrefix,Da=new RegExp("^"+Ha+"(\\d+)$"),Ja=new RegExp("^"+Ia+"(\\d+)$"),Ga=function(){};f=f([C,I],{declaredClass:"esri._CoreMap",resizeDelay:300,invalidExtent:"Map does not have a valid extent.",invalidGeometry:"Geometry (wkid: ${geometry}) cannot be converted to spatial reference of the map (wkid: ${map})",unknownBasemap:'Unable to find basemap definition for: "${basemapName}". Try one of these: ${list}',invalidBasemap:'Unable to add basemap: "${basemapName}".',
unknownLayerType:'Unknown basemap layer type: "${type}" found in basemap definition for: "${basemapName}".',visible:!0,_eventMap:{"basemap-change":!0,"extent-change":["extent","delta","levelChange","lod"],"layer-add":["layer"],"layer-add-result":["layer","error"],"layer-remove":["layer"],"layer-reorder":["layer","index"],"layer-resume":["layer"],"layer-suspend":["layer"],"layers-add-result":["layers"],"layers-removed":!0,"layers-reordered":["layerIds"],load:["map"],pan:["extent","delta"],"pan-end":["extent",
"delta"],"pan-start":["extent","screenPoint"],reposition:["x","y"],resize:["extent","width","height"],scale:["matrix","immediate"],"time-extent-change":["timeExtent"],"before-unload":["map"],unload:["map"],"update-end":["error"],"update-start":!0,zoom:["extent","zoomFactor","anchor"],"zoom-end":["extent","zoomFactor","anchor","level"],"zoom-start":["extent","zoomFactor","anchor","level"],click:!0,"dbl-click":!0,"key-down":!0,"key-up":!0,"mouse-down":!0,"mouse-drag":!0,"mouse-drag-end":!0,"mouse-drag-start":!0,
"mouse-move":!0,"mouse-out":!0,"mouse-over":!0,"mouse-up":!0,"mouse-wheel":!0,"basic-tap":!0,"double-tap":!0,"pinch-end":!0,"pinch-move":!0,"pinch-start":!0,"processed-double-tap":!0,"processed-tap":!0,"swipe-end":!0,"swipe-move":!0,"swipe-start":!0,tap:!0,"two-finger-tap":!0},constructor:function(a,b){var g=this;this.registerConnectEvents();ra(this,{_internalLayerIds:[],_layers:[],_layerDivs:[],_layerSize:0,_connects:[],_zoomAnimDiv:null,_zoomAnim:null,_layersDiv:null,_firstLayerId:null,_delta:null,
_cursor:null,_ratioW:1,_ratioH:1,_params:null,cursor:null,layerIds:[],graphicsLayerIds:[],graphics:null,_labels:null,loaded:!1,__panning:!1,__zooming:!1,__container:null,root:null,__LOD:null,__tileInfo:null,__visibleRect:null,__visibleDelta:null,_rids:[]});var e=this.container=c.byId(a),f=this.id=n.get(e,"id")||w.getUniqueId(this.declaredClass);q.add(e,"map");var l=r.getContentBox(e),m=q.add,u=t.create;this.position=new H(0,0);this._reposition();var v=this.width=0<l.w?l.w:xa.width,k=this.height=0<
l.h?l.h:xa.height,x=this.root=u("div",{id:f+"_root",style:{width:v+"px",height:k+"px",direction:"ltr"}});m(x,"esriMapContainer");l=this.__container=u("div",{id:f+"_container"},x);za(l,"position","absolute");m(l,"esriMapContainer");e.appendChild(x);e=this._params=ra({slider:!0,nav:!1,zoom:-1,minZoom:-1,maxZoom:-1,scale:-1,minScale:0,maxScale:0,showInfoWindowOnClick:!0,displayGraphicsOnPan:!0,wrapAround180:!0,fitExtent:!1,optimizePanAnimation:!0},b||{});this.wrapAround180=e.wrapAround180;this.optimizePanAnimation=
e.optimizePanAnimation;this.setBackgroundColor(e.backgroundColor);B.isDefined(e.resizeDelay)&&(this.resizeDelay=e.resizeDelay);e.lods&&(ta({rows:512,cols:512,dpi:96,format:"JPEG",compressionQuality:75,origin:{x:-180,y:90},spatialReference:{wkid:4326},lods:e.lods},e),this.__tileInfo=e.tileInfo);this.extent=e.extent;this._extentUtil({mapCenter:e.center,targetLevel:e.zoom,targetScale:e.scale});this.__visibleRect=new P(0,0,v,k);this.__visibleDelta=new P(0,0,v,k);f=this._layersDiv=u("div",{id:f+"_layers"});
(m(f,"esriMapLayers"),l.appendChild(f),this._zoomAnimDiv=u("div",{style:{position:"absolute"}}),e.infoWindow)?this.infoWindow=e.infoWindow:(m=this.infoWindow=new Aa(e.popupOptions,u("div")),m.startup(),m._ootb=!0,za(m.domNode,"zIndex",40));e.showLabels&&(h(["./layers/LabelLayer"],function(a){pa=a;g._createLabelLayer()}),this.on("load",function(){g._createLabelLayer()}));this.addPlugin(this._getAbsMid("./plugins/popupManager"),{enabled:e.showInfoWindowOnClick});this._zoomStartHandler=ja(this,this._zoomStartHandler);
this._zoomingHandler=ja(this,this._zoomingHandler);this._zoomEndHandler=ja(this,this._zoomEndHandler);this._panningHandler=ja(this,this._panningHandler);this._panEndHandler=ja(this,this._panEndHandler);this._endTranslate=ja(this,this._endTranslate);this._timedResize=ja(this,this._timedResize);this._execResize=ja(this,this._execResize);this._processLabelLayers=ja(this,this._processLabelLayers);this._updateLabelLayers=ja(this,this._updateLabelLayers);this.resize=ja(this,this.resize);d.addOnWindowUnload(this,
this.destroy)},_getAbsMid:function(a){return h.toAbsMid?h.toAbsMid(a):k.id.replace(/\/[^\/]*$/gi,"/")+a},_cleanUp:function(){var a=this.infoWindow;a&&(a._ootb&&a.destroy?a.destroy():a.unsetMap(this),delete this.infoWindow);ia(this._tsTimeExtentChange_connect);this.removePlugin("./plugins/popupManager");t.destroy(this.root);this.root=null},_addLayer:function(a,c,b){if(a.id){var d=a.id.match(a instanceof aa?Ja:Da);d&&d[1]&&(d=Number(d[1]),d>=ua&&(ua=d+1))}var g=a.id||(a instanceof aa?Ia:Ha)+ua++;a.id=
g;this._layers[g]=a;var e,f;if((c===this.layerIds||c===this.graphicsLayerIds)&&(e=this._layerSize,this._layerSize++),a._isRefLayer="top"===b,b=!B.isDefined(b)||0>b||b>c.length||"top"===b?c.length:b,0===e&&(this._firstLayerId=g),!a._isRefLayer)for(;(f=this.getLayer(c[b-1]))&&f._isRefLayer;)b--;c.splice(b,0,g);var n=ja(this,this._addLayerHandler),l=this;b=this._connects;d=function(){a.loaded?l._onLoadFix?(l._onLoadFix=!1,setTimeout(function(){n(a)},0)):n(a):(l["_"+g+"_addtoken_load"]=ma(a,"onLoad",
l,"_addLayerHandler"),l["_"+g+"_addtoken_err"]=ma(a,"onError",l,function(b){n(a,b,c)}))};return this.loaded||0===e||a.loaded&&-1===Ba(this.graphicsLayerIds,g)?d():b.push(ma(this,"onLoad",d)),a},_addLayerHandler:function(a,c,b){var d,g,e,f,n=this.id,l=a.id,m=Ba(a instanceof aa?this.graphicsLayerIds:this.layerIds,l),q=m,r=!1,u=this._params;if(ia(this["_"+l+"_addtoken_load"]),ia(this["_"+l+"_addtoken_err"]),c)return delete this._layers[l],void(-1!==m&&(b.splice(m,1),this.onLayerAddResult(a,c)));if(-1===
m&&(m=Ba(this._internalLayerIds,l),q=20+m,r=!0),l===this._firstLayerId){if(g=a.spatialReference,e=this.extent&&this.extent.spatialReference,!e||e.equals(g)||!a.tileInfo&&a.url||(e=null),d=this.spatialReference=e||g,this.wrapAround180=this.wrapAround180&&d&&d._isWrappable()?!0:!1,a.tileInfo&&(this.__tileInfo?(f=this.__tileInfo.lods,this.__tileInfo=ra({},a.tileInfo),this.__tileInfo.lods=f):(ta(ra({},a.tileInfo),u),this.__tileInfo=u.tileInfo)),this.wrapAround180)c=this.__tileInfo,d=d._getInfo(),(!c||
Math.abs(d.origin[0]-c.origin.x)>d.dx)&&(this.wrapAround180=!1),this.wrapAround180&&c&&F._addFrameInfo(c,d);if(u.units=a.units,f=this.__tileInfo&&this.__tileInfo.lods,f&&f.length){c=u.minScale;b=u.maxScale;e=g=-1;var t=m=!1;for(d=0;d<f.length;d++)0<c&&!m&&c>=f[d].scale&&(g=f[d].level,m=!0),0<b&&!t&&b>=f[d].scale&&(e=0<d?f[d-1].level:-1,t=!0);-1===u.minZoom&&(u.minZoom=0===c?f[0].level:g);-1===u.maxZoom&&(u.maxZoom=0===b?f[f.length-1].level:e);for(d=0;d<f.length;d++)u.minZoom===f[d].level&&(u.minScale=
f[d].scale),u.maxZoom===f[d].level&&(u.maxScale=f[d].scale)}else u.minZoom=u.maxZoom=u.zoom=-1}a instanceof aa?(this._gc||(this._gc=new aa._GraphicsContainer,this._gc._setMap(this,this._layersDiv).id=n+"_gc"),f=a._setMap(this,this._gc._surface),f.id=n+"_"+l,this._layerDivs[l]=f,this._reorderLayers(this.graphicsLayerIds)):(f=a._setMap(this,this._layersDiv,q,this.__LOD),f.id=n+"_"+l,this._layerDivs[l]=f,this._reorderLayers(this.layerIds),r||-1===a.declaredClass.indexOf("VETiledLayer")||this._onBingLayerAdd(a));
if(l===this._firstLayerId&&(this.graphics=new aa({id:n+"_graphics",displayOnPan:u.displayGraphicsOnPan}),this._addLayer(this.graphics,this._internalLayerIds,20)),a===this.graphics){var h;d=this._layers[this._firstLayerId];n=u.zoom;f=u.scale;q=u.center;d=d.initialExtent||d.fullExtent;if(this._firstLayerId=null,this.extent&&(this.extent=this._convertGeometry(this,this.extent)),!this.extent&&d&&(q&&(q=this._convertGeometry(d,q)),q&&(d=d.centerAt(q),q=null)),h=this.extent||d&&new K(d.toJson()),h&&(-1<
n?h=this.__getExtentForLevel(n,null,h).extent:0<f&&(h=S.getExtentForScale(this,f,h))),!h)return;u=this._fixExtent(h,u.fitExtent);this.extent=u.extent;this.__LOD=u.lod;this.__setExtent(this.extent);this.loaded=!0;this.attr("data-loaded","");this.infoWindow.setMap(this);this.onLoad(this)}r||(this.onLayerAdd(a),this.onLayerAddResult(a));ia(this[l+"_addLayerHandler_connect"])},_convertGeometry:function(a,c){var b=a&&a.spatialReference,d=c&&c.spatialReference;return b&&d&&!b.equals(d)&&(b._canProject(d)?
b.isWebMercator()?c=R.geographicToWebMercator(c):4326===b.wkid&&(c=R.webMercatorToGeographic(c,!0)):c=null),c},_reorderLayers:function(a){var c=this.onLayerReorder,b=t.place,d=this._layerDivs,g=this._layers,e=this._gc?this._gc._surface.getEventSource():null;if(a===this.graphicsLayerIds)m.forEach(a,function(a,f){var n=d[a];n&&(b(n.getEventSource(),e,f),c(g[a],f))});else{var f,n=this.graphics,l=n?n.id:null,q=this._layersDiv;m.forEach(a,function(a,e){f=d[a];a!==l&&f&&(b(f,q,e),c(g[a],e))});this._mapImageLyr&&
this._placeMapImageLyr();e&&(e=9>u("ie")?e.parentNode:e,b(e,e.parentNode,a.length))}this.onLayersReordered([].concat(a))},_zoomStartHandler:function(){this.__zoomStart(this._zoomAnimDiv.startingExtent,this._zoomAnimDiv.anchor)},_zoomingHandler:function(a){var c=parseFloat(a.left),b=parseFloat(a.top);a=new K(c,b-parseFloat(a.height),c+parseFloat(a.width),b,this.spatialReference);c=this.extent.getWidth()/a.getWidth();this.__zoom(a,c,this._zoomAnimDiv.anchor)},_zoomEndHandler:function(){var a=this._zoomAnimDiv,
c=a.extent,b=this.extent.getWidth()/c.getWidth(),d=a.anchor,g=a.newLod,e=a.levelChange;a.extent=a.anchor=a.levelChange=a.startingExtent=a.newLod=this._delta=this._zoomAnim=null;this.__zoomEnd(c,b,d,g,e)},_panningHandler:function(a){if(isNaN(parseFloat(a.left))||isNaN(parseFloat(a.top))){var c=Math.round,b=this._panAnim.node;a.left=-1*(this._delta.x-c(this.width/2))+"px";a.top=-1*(this._delta.y-c(this.height/2))+"px";v.set(b,"left",a.left);v.set(b,"top",a.top)}a=new H(parseFloat(a.left),parseFloat(a.top));
c=this.toMap(a);this.onPan(this.extent.offset(this.extent.xmin-c.x,this.extent.ymax-c.y),a)},_panEndHandler:function(a){this.__panning=!1;var c=Math.round;a=new H(-c(parseFloat(a.style.left)),-c(parseFloat(a.style.top)));var c=a.x,b=a.y,d=this.__visibleRect,g=this.__visibleDelta;d.x+=-c;d.y+=-b;g.x+=-c;g.y+=-b;za(this._zoomAnimDiv,{left:"0px",top:"0px"});var d=this.extent,g=this._ratioW,e=this._ratioH,d=new K(d.xmin+c/g,d.ymin-b/e,d.xmax+c/g,d.ymax-b/e,this.spatialReference);a.setX(-a.x);a.setY(-a.y);
this._delta=this._panAnim=null;this._updateExtent(d);this.onPanEnd(d,a);this._fireExtChg([d,a,!1,this.__LOD])},_fixExtent:function(a,c){for(var b=this._reshapeExtent(a),d=1.25;!0===c&&(b.extent.getWidth()<a.getWidth()||b.extent.getHeight()<a.getHeight())&&0<b.lod.level&&3>=d;)b=this._reshapeExtent(a.expand(d)),d+=.25;return b},_getFrameWidth:function(){var a=-1,c=this.spatialReference._getInfo();this.__LOD?(c=this.__LOD._frameInfo)&&(a=c[3]):c&&(a=Math.round(2*c.valid[1]/(this.extent.getWidth()/this.width)));
return a},_fixAspectRatio:function(a){var c=a.getWidth(),b=a.getHeight(),d=c/b,g=this.width/this.height,e=0,f=0;return this.width>this.height?c>b?g>d?e=b*g-c:f=c/g-b:e=b*g-c:this.width<this.height?b>c&&g>d?e=b*g-c:f=c/g-b:b>c?e=b-c:c>b&&(f=c/g-b),e&&(a.xmin-=e/2,a.xmax+=e/2),f&&(a.ymin-=f/2,a.ymax+=f/2),a},_reshapeExtent:function(a){return a=this._fixAspectRatio(a),this._getAdjustedExtent(a)},_getAdjustedExtent:function(a){if(this.__tileInfo)return F.getCandidateTileInfo(this,this.__tileInfo,a);var c=
S.getScale(this,a),b=this.getMinScale(),d=this.getMaxScale();return!b||b>=c?!d||c>=d||(a=S.getExtentForScale(this,d,a)):a=S.getExtentForScale(this,b,a),{extent:a}},_onBingLayerAdd:function(a){this["__"+a.id+"_vis_connect"]=b.connect(a,"onVisibilityChange",this,"_toggleBingLogo");this._toggleBingLogo(a.visible)},_onBingLayerRemove:function(a){b.disconnect(this["__"+a.id+"_vis_connect"]);delete this["__"+a.id+"_vis_connect"];var c=m.some(this.layerIds,function(c){return a=this._layers[c],a&&a.visible&&
-1!==a.declaredClass.indexOf("VETiledLayer")},this);this._toggleBingLogo(c)},_toggleBingLogo:function(a){a&&!this._bingLogo?(a={left:this._mapParams&&this._mapParams.nav?"25px":""},6===u("ie")&&(a.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+h.toUrl("./images/map/bing-logo-lg.png")+"')"),a=this._bingLogo=t.create("div",{style:a},this.root),q.add(a,"bingLogo-lg")):!a&&this._bingLogo&&(t.destroy(this._bingLogo),delete this._bingLogo)},
__panStart:function(a,c){var b=this._zoomAnim,d=this._panAnim;if(b&&b._active)b.stop(),b._fire("onEnd",[b.node]);else if(d&&d._active){d.stop();this._panAnim=null;var d=d.curve.getValue(d._getStep()),b=Math.round(parseFloat(d.left)),d=Math.round(parseFloat(d.top)),g=this.navigationManager._dragOrigin;return this.__pan(b,d),void(g&&(g.x-=b,g.y-=d))}this.__panning=!0;this.onPanStart(this.extent,new H(a,c))},__pan:function(a,c){var b=this.extent,d=this._ratioW,g=this._ratioH;this.onPan(new K(b.xmin-
a/d,b.ymin+c/g,b.xmax-a/d,b.ymax+c/g,this.spatialReference),new H(a,c))},__panEnd:function(a,c){var b=this.__visibleRect,d=this.__visibleDelta;b.x+=a;b.y+=c;d.x+=a;d.y+=c;var b=new H(a,c),d=this.extent,g=this._ratioW,e=this._ratioH,d=new K(d.xmin-a/g,d.ymin+c/e,d.xmax-a/g,d.ymax+c/e,this.spatialReference);this.__panning=!1;this._updateExtent(d);this.onPanEnd(d,b);this._fireExtChg([d,b,!1,this.__LOD])},__zoomStart:function(a,c){this.__zooming=!0;this.onZoomStart(a,1,c,this.__LOD?this.__LOD.level:null)},
__zoom:function(a,c,b){this.onZoom(a,c,b)},__zoomEnd:function(a,c,b,d,g){za(this._layersDiv,{left:"0px",top:"0px"});this._delta=new H(0,0);this.__visibleRect.x=this.__visibleRect.y=0;a=new K(a);this.__LOD=d;this._ratioW=this.width/a.getWidth();this._ratioH=this.height/a.getHeight();var e=this._delta;this._delta=null;this.__zooming=!1;this._updateExtent(a,g);this.onZoomEnd(a,c,b,d?d.level:null);this._fireExtChg([a,e,g,d])},_extentUtil:function(a,c,b,d,g){var f,n,m,q,u,r,t,h,v,k,w,x,y,z=new e,C=this.width,
A=this.height;a&&(f=a.numLevels,n=a.targetLevel,w=B.isDefined(n),m=a.factor,q=a.mapAnchor,u=a.screenAnchor,r=a.mapCenter,x=a.levelOrFactor,t=a.targetScale,h=B.isDefined(t)&&0<t);c&&(v=c.dx,k=c.dy,r=c.mapCenter);l.isArray(r)&&(r=new M(r));var L=this._panAnim;c=(a=this._stopAnim())?a.divExtent:this.extent;var D=this.__tileInfo,E=this._params;if(!this.loaded)return b?(c&&(b=this._convertGeometry(c,b)),b&&(this.extent=b,E.zoom=E.scale=-1,E.center=null)):(r||w||h)&&(r&&(c?(r=this._convertGeometry(c,r),
r&&(this.extent=c.centerAt(r),E.center=null)):E.center=r),w&&-1<n?(E.zoom=n,E.scale=-1):h&&(E.scale=t,E.zoom=-1)),z.resolve(),z;if(r&&(r=this._convertGeometry(this,r),!r)||q&&(q=this._convertGeometry(this,q),!q)||b&&(b=this._convertGeometry(this,b),!b))return z.reject(),z;if(L&&q&&u&&(q=wa(this.extent,C,A,u)),a&&q&&u&&(q=wa(a.divExtent,C,A,u)),w)D?(f=this.getMinZoom(),w=this.getMaxZoom(),f>n?n=f:n>w&&(n=w),f=n-(a?a.level:this.getLevel())):(f=0<n?-1:1,y=x?n:null);if(!b)if(B.isDefined(f))D?(C=a?a.level:
this.getLevel(),C=this.__getExtentForLevel(C+f,r,c).extent):(C=(a?a.end:this.extent).expand(y||(0<f?.5*f:2*-f)),y&&r&&(C=C.centerAt(r))),C&&(r?b=C:(v=q||c.getCenter(),A=C.getWidth(),k=C.getHeight(),C=v.x>=c.xmin&&v.x<=c.xmax?(v.x-c.xmin)/c.getWidth():.5,b=v.y>=c.ymin&&v.y<=c.ymax?(v.y-c.ymin)/c.getHeight():.5,C=v.x-C*A,v=v.y-b*k,b=new K(C,v,C+A,v+k,this.spatialReference)));else if(h)b=S.getExtentForScale(this,t,c);else if(B.isDefined(m))b=c.expand(m);else if(v||k)a?(b=a.end,q=b.getCenter(),y=oa(b,
C,A,q),y.x+=v,y.y+=k,y=wa(b,C,A,y),b=b.offset(y.x-q.x,y.y-q.y)):(v=new H(C/2+v,A/2+k),v=wa(c,C,A,v),A=c.getWidth(),k=c.getHeight(),C=v.x-A/2,v=v.y-k/2,b=new K(C,v,C+A,v+k,this.spatialReference));b||(r?(c=a?a.end:c,A=c.getWidth(),k=c.getHeight(),C=r.x-A/2,v=r.y-k/2,b=new K(C,v,C+A,v+k,this.spatialReference)):a&&(b=a.end));return b?(this._extentDfd&&-1===this._extentDfd.fired&&(this._extentDfd.then(null,Ga),this._extentDfd.reject()),this._extentDfd=z,this.__setExtent(b,null,u,d,a,g)):z.reject(),z},
__setExtent:function(a,c,b,d,g,e){try{if(this._firstLayerId)return void(this.extent=a);var f=!0,n=this.spatialReference,l=g?g.divExtent:this.extent,m=this._fixExtent(a,d||!1);a=m.extent;var q=a.getWidth(),r=a.getHeight(),u=Math.round;if(l)var t=u(1E6*l.getWidth()),h=u(1E6*q),v=u(1E6*l.getHeight()),k=u(1E6*r),f=t!==h||v!==k;var w,x,y=g&&g.rect,z=g&&g.divExtent;if(xa.zoomDuration&&f&&l){z=z||new K(l);y=y||{left:l.xmin,top:l.ymax,width:l.getWidth(),height:l.getHeight()};x={left:a.xmin,top:a.ymax,width:q,
height:r};var C=new M(a.xmin,a.ymax,n),A=new M(a.xmin,a.ymin,n),B=new M(this.extent.xmin,this.extent.ymax,n),L=new M(this.extent.xmin,this.extent.ymin,n);(w=O.getLineIntersection(B,C,L,A,n))||g||(f=!1)}this._ratioW=this.width/q;this._ratioH=this.height/r;var E=this._zoomAnimDiv;if(f)if(za(this._layersDiv,{left:"0px",top:"0px"}),c=new H(0,0),this.__visibleRect.x=this.__visibleRect.y=0,y&&x){this._delta=c;E.id="_zAD";E.startingExtent=z;E.extent=a;E.levelChange=f;E.newLod=m.lod;b?E.anchor=b:!w&&g?E.anchor=
g.anchor:E.anchor=oa(this.extent,this.width,this.height,w);var F=this.extent.getWidth()/a.getWidth();1024<(1>F?1/F:F)?(this.__zoomStart(z,E.anchor),this.__zoom(z,1,E.anchor),this._fireOnScale(1,E.anchor,!0),this.__zoomEnd(a,F,E.anchor,m.lod,f)):(this._zoomAnim=D.resize({node:E,start:y,end:x,duration:xa.zoomDuration,rate:xa.zoomRate,beforeBegin:g?null:this._zoomStartHandler,onAnimate:this._zoomingHandler,onEnd:this._zoomEndHandler}).play(),this._fireOnScale(F,E.anchor,e))}else this._updateExtent(a,
f,e),this._fireExtChg([this.extent,c,f,this.__LOD=m.lod]);else if(!this.__panning)if(!1===this.loaded||e)this._updateExtent(a,f,e),this._fireExtChg([this.extent,c,f,this.__LOD=m.lod]);else{this.__panning=!0;y=(new P(0,0,this.width,this.height,this.spatialReference)).getCenter();y.x=u(y.x);y.y=u(y.y);var G=this._delta=this.toScreen(a.getCenter()),V=Math.abs(y.x-G.x),da=Math.abs(y.y-G.y);this.optimizePanAnimation&&(V>2*this.width||da>2*this.height)?(this.__panStart(0,0),this.__pan(0,0),this.__visibleRect.x=
this.__visibleRect.y=this.__visibleDelta.x=this.__visibleDelta.y=0,this.__panning=!1,this._delta=null,this._updateExtent(a,!1,e),this.onPanEnd(this.extent,new H(0,0)),this._fireExtChg([this.extent,new H(0,0),!0,this.__LOD])):(this.onPanStart(this.extent,new H(0,0)),this._panAnim=D.slideTo({node:E,left:y.x-G.x,top:y.y-G.y,duration:xa.panDuration,rate:xa.panRate,onAnimate:this._panningHandler,onEnd:this._panEndHandler}),this._panAnim.play())}}catch(db){console.error(db)}},_fireOnScale:function(a,c,
b){if("css-transforms"===this.navigationMode){var d=this.__visibleDelta;this.onScale(x.scaleAt(a,{x:-1*(this.width/2-(c.x-d.x)),y:-1*(this.height/2-(c.y-d.y))}),b)}},_stopAnim:function(){var a=this._zoomAnim,c=this._panAnim;if(a&&a._active){a.stop();var c=a.curve.getValue(a._getStep()),b=parseFloat(c.left),d=parseFloat(c.top),a=a.node;return{anchor:a.anchor,start:a.startingExtent,end:a.extent,level:a.newLod&&a.newLod.level,rect:c,divExtent:new K(b,d-parseFloat(c.height),b+parseFloat(c.width),d,this.spatialReference)}}c&&
c._active&&(c.stop(),c._fire("onEnd",[c.node]))},__getExtentForLevel:function(a,c,b){var d=this.__tileInfo,d=d&&d.lods;if(a=B.isDefined(a)?a:0,b=b||this.extent,c=c||b&&b.getCenter(),d){if(!c)return;b=this.getMinZoom();var g=this.getMaxZoom();a>g&&(a=g);b>a&&(a=b);a=d[a];d=this.width*a.resolution/2;b=this.height*a.resolution/2;return{extent:new K(c.x-d,c.y-b,c.x+d,c.y+b,c.spatialReference),lod:a}}return b?(a=!a||1>a?1:a,{extent:b.expand(a).centerAt(c)}):void 0},_jobs:0,_incr:function(){1===++this._jobs&&
(this.updating=!0,this.attr("data-updating",""),this.onUpdateStart())},_decr:function(){var a=--this._jobs;a?0>a&&(this._jobs=0):(this.updating=!1,this.attr("data-updating"),this.onUpdateEnd())},_fireEvent:function(a,c){this[a]&&this[a].apply(this,c)},_updateExtent:function(a,c,b){this.extent=a;this._view=new L({viewingMode:"map",scale:this.getScale()});(c||b)&&this._setClipRect();(a=this.spatialReference)&&(a.isWebMercator()?this.geographicExtent=R.webMercatorToGeographic(this._getAvailExtent(),
!0):4326===a.wkid&&(this.geographicExtent=new K(this._getAvailExtent().toJson())))},_fireExtChg:function(a){this.attr("data-zoom",this.getZoom());this.attr("data-scale",this.getScale());this._fireEvent("onExtentChange",a);(a=this._extentDfd)&&(delete this._extentDfd,a.resolve())},attr:function(a,c){var b=this.container;return b&&(null==c?b.removeAttribute(a):b.setAttribute(a,c)),this},onUpdateStart:function(){},onUpdateEnd:function(){},onLoad:function(){this._setClipRect()},onBeforeUnload:function(){},
onUnload:function(){},onExtentChange:function(a,c,b){},onTimeExtentChange:function(){},onLayerAdd:function(){},onLayerAddResult:function(){},onLayersAddResult:function(){},onLayerRemove:function(){},onLayersRemoved:function(){},onLayerReorder:function(){},onLayersReordered:function(){},onLayerSuspend:function(){},onLayerResume:function(){},onPanStart:function(){},onPan:function(){},onPanEnd:function(){},onScale:function(){},onZoomStart:function(){},onZoom:function(){},onZoomEnd:function(){},onResize:function(){this._setClipRect()},
onReposition:function(){},destroy:function(){this._destroyed||(this.onBeforeUnload(this),this.removeAllLayers(),this._cleanUp(),clearTimeout(this._resizeT),this._gc&&this._gc._cleanUp(),this._destroyed=!0,this.onUnload(this))},setCursor:function(a){za(this.__container,"cursor",this.cursor=a)},setMapCursor:function(a){this.setCursor(this._cursor=a)},resetMapCursor:function(){this.setCursor(this._cursor)},setBackgroundColor:function(a){a&&!a.declaredClass&&(a=new J(a));this.backgroundColor=a||null;
var c="";a&&(c=9>u("ie")?a.toHex():"rgba("+a.toRgba().join(",")+")");v.set(this.root,{backgroundColor:c})},setInfoWindow:function(a){var c=this.infoWindow;c&&c.unsetMap(this);this.infoWindow=a;this.loaded&&a&&a.setMap(this)},setInfoWindowOnClick:function(a){this._params.showInfoWindowOnClick=a;this.popupManager&&this.popupManager.set("enabled",a)},getInfoWindowAnchor:function(a){return this.infoWindow&&this.infoWindow._getAnchor&&this.infoWindow._getAnchor(a)||"upperright"},toScreen:function(a,c){return oa(this.extent,
this.width,this.height,a,c)},toMap:function(a){return wa(this.extent,this.width,this.height,a)},addLayer:function(a,c){return a&&!this.getLayer(a.id)&&this._addLayer(a,a instanceof aa?this.graphicsLayerIds:this.layerIds,c),a},addLayers:function(a){var c,d,g=[],e=a.length,f=a.length;c=b.connect(this,"onLayerAddResult",function(d,f){-1!==m.indexOf(a,d)&&(e--,g.push({layer:d,success:!f,error:f}),e||(b.disconnect(c),this.onLayersAddResult(g)))});for(d=0;f>d;d++)this.addLayer(a[d]);return this},removeLayer:function(a,
c){var b=a.id,d=a instanceof aa?this.graphicsLayerIds:this.layerIds,g=Ba(d,b);0<=g&&(d.splice(g,1),a instanceof aa?(ia(this["_gl_"+a.id+"_click_connect"]),a.loaded&&a._unsetMap(this,this._gc._surface)):a.loaded&&(a._unsetMap(this,this._layersDiv),-1!==a.declaredClass.indexOf("VETiledLayer")&&this._onBingLayerRemove(a)),delete this._layers[b],delete this._layerDivs[b],c||this._reorderLayers(d),this.onLayerRemove(a))},removeAllLayers:function(){var a,c=this.layerIds;for(a=c.length-1;0<=a;a--)this.removeLayer(this._layers[c[a]],
1);c=this.graphicsLayerIds;for(a=c.length-1;0<=a;a--)this.removeLayer(this._layers[c[a]],1);this.onLayersRemoved()},reorderLayer:function(c,b){l.isString(c)&&(a.deprecated(this.declaredClass+": Map.reorderLayer(/*String*/ id, /*Number*/ index) deprecated. Use Map.reorderLayer(/*Layer*/ layer, /*Number*/ index).",null,"v2.0"),c=this.getLayer(c));var d,g=c.id,e=c instanceof aa?this.graphicsLayerIds:this.layerIds;0>b?b=0:b>=e.length&&(b=e.length-1);d=Ba(e,g);-1!==d&&d!==b&&(e.splice(d,1),e.splice(b,
0,g),this._reorderLayers(e))},getLayer:function(a){return this._layers[a]},setExtent:function(a,c){a=new K(a.toJson());var b=a.getWidth(),d=a.getHeight();return 0===b&&0===d?this.centerAt(new M({x:a.xmin,y:a.ymin,spatialReference:a.spatialReference&&a.spatialReference.toJson()})):this._extentUtil(null,null,a,c)},centerAt:function(a){return this._extentUtil(null,{mapCenter:a})},centerAndZoom:function(a,c){return this._extentUtil({targetLevel:c,mapCenter:a,levelOrFactor:!0})},getScale:function(){return this.__LOD?
this.__LOD.scale:S.getScale(this)},getResolution:function(){return this.__LOD?this.__LOD.resolution:this.extent?this.extent.getWidth()/this.width:0},getResolutionInMeters:function(){return this.getResolution()*S.getUnitValueForSR(this.spatialReference)},getMinScale:function(){return this._params.minScale},getMaxScale:function(){return this._params.maxScale},_getView:function(){return this._view},setScale:function(a){return this._extentUtil({targetScale:a})},getLayersVisibleAtScale:function(a){var c=
[];return a=a||this.getScale(),a&&m.forEach(this.layerIds.concat(this.graphicsLayerIds),function(b){b=this.getLayer(b);b.isVisibleAtScale(a)&&c.push(b)},this),c},getNumLevels:function(){var a=this.getMinZoom(),c=this.getMaxZoom();return a===c&&0>a?0:c-a+1},getLevel:function(){return this.__LOD?this.__LOD.level:-1},setLevel:function(a){return-1<a?this._extentUtil({targetLevel:a}):void 0},getZoom:function(){return this.getLevel()},setZoom:function(a){return this.setLevel(a)},getMinZoom:function(){return this._params.minZoom},
getMaxZoom:function(){return this._params.maxZoom},setBasemap:function(a){var c;if(l.isObject(a)?(c=a,a=c.title):c=z&&z[a],c){this._basemapDfd&&-1===this._basemapDfd.fired&&this._basemapDfd.cancel();var d=[],g=[],f=0;if(m.forEach(c.baseMapLayers||c.layers,function(a){var c,b={id:a.id,displayLevels:a.displayLevels,opacity:B.isDefined(a.opacity)?a.opacity:null,visible:B.isDefined(a.visibility)?a.visibility:null};if(a.type)switch(a.type){case "OpenStreetMap":c=new ga(b);break;case "VectorTile":c=G.normalize(a.url),
c=new la(c,b)}else c=G.normalize(a.url),c=new V(c,b);c&&(d.push(c),g.push(a),a.isReference||f++)},this),d.length&&f){var n={basemapName:a,infos:g,layers:d};if(!this.loaded)return void this._basemapLoaded(n);var q=this,r=new e(E._dfdCanceller),u=function(a){r._pendingLayers--;a=m.indexOf(n.layers,this);-1<a&&(a=r._layerEvents[a])&&(b.disconnect(a[0]),b.disconnect(a[1]));0>=r._pendingLayers&&(delete r._layerEvents,delete q._basemapDfd,0>r.fired&&r.callback(n))};this._basemapDfd=r;r._pendingLayers=0;
r._layerEvents={};m.forEach(d,function(a,c){a&&(r._pendingLayers++,a.loaded?u(a):r._layerEvents[c]=[b.connect(a,"onLoad",a,u),b.connect(a,"onError",a,u)])});r.addCallback(ja(this,this._basemapLoaded))}}else{var t;a=[];for(t in z)a.push(t)}},_basemapLoaded:function(a){var c,b=a.layers,d=a.infos,g=0,e=!0;this.loaded&&(m.forEach(b,function(a,c){a.loaded&&(d[c].isReference||g++)}),e=g);e&&(this.basemapLayerIds&&(c={basemapName:this._basemap,infos:z&&z[this._basemap]&&z[this._basemap].baseMapLayers},c.basemapName||
(m.forEach(this.basemapLayerIds,function(a){return this.getLayer(a)instanceof ga?(c.basemapName="osm",c.infos=z&&z.osm&&z.osm.baseMapLayers,!1):void 0},this),c.basemapName||(c=null))),this._removeBasemap(),this._basemap=a.basemapName,this.basemapLayerIds=this._addBasemap(b,d),this.attr("data-basemap",this.getBasemap()),this.emit("basemap-change",{current:a,previous:c}))},_addBasemap:function(a,c){var b=[],d=[],g=0;return m.forEach(a,function(a,e){c[e].isReference?b.push(a):(this.addLayer(a,g++),d.push(a.id))},
this),b.length&&m.forEach(b,function(a){a.attr("data-reference",!0);this.addLayer(a,"top");d.push(a.id)},this),d},_removeBasemap:function(){var a,c=this.basemapLayerIds;c&&c.length&&m.forEach(c,function(c){(a=this.getLayer(c))&&this.removeLayer(a)},this)},getBasemap:function(){return this._basemap||""},translate:function(a,c){if(a=a||0,c=c||0,!this._txTimer){this._tx=this._ty=0;var b=this.toScreen(this.extent.getCenter());this.__panStart(b.x,b.y)}this._tx+=a;this._ty+=c;this.__pan(this._tx,this._ty);
clearTimeout(this._txTimer);this._txTimer=setTimeout(this._endTranslate,150)},_endTranslate:function(){clearTimeout(this._txTimer);this._txTimer=null;var a=this._tx,c=this._ty;this._tx=this._ty=0;this.__panEnd(a,c)},setTimeExtent:function(a){a=(this.timeExtent=a)?new a.constructor(a.toJson()):null;this.onTimeExtentChange(a)},setTimeSlider:function(a){this.timeSlider&&(ia(this._tsTimeExtentChange_connect),this._tsTimeExtentChange_connect=null,this.timeSlider=null);a&&(this.timeSlider=a,this.setTimeExtent(a.getCurrentTimeExtent()),
this._tsTimeExtentChange_connect=ma(a,"onTimeExtentChange",this,"setTimeExtent"))},setVisibility:function(a){if(this.visible!==a){if(this.visible=a,a||(this._display=this.container.style.display),this.container.style.display=a?this._display:"none",this.autoResize){var c=a?"resume":"pause";this._rszSignal[c]();this._oriSignal[c]()}a&&this.resize()}return this},resize:function(a){clearTimeout(this._resizeT);this._destroyed||(!0===a?this._execResize():this._resizeT=setTimeout(this._execResize,this.resizeDelay))},
_timedResize:function(){this._resizeT||this._execResize()},_execResize:function(){clearTimeout(this._resizeT);this._resizeT=null;this.reposition();this._resize();this.autoResize&&this._startResizeTimer()},_resize:function(){var a=this.width,c=this.height,b=v.get(this.container,"display"),d=r.getContentBox(this.container);if(!("none"===b||0>=d.w||0>=d.h||a===d.w&&c===d.h)){(b=this._zoomAnim||this._panAnim)&&(b.stop(),b._fire("onEnd",[b.node]));za(this.root,{width:(this.width=d.w)+"px",height:(this.height=
d.h)+"px"});d=this.width;b=this.height;this.attribution&&this.attribution.domNode&&v.set(this.attribution.domNode,"maxWidth",Math.floor(d*this._mapParams.attributionWidth)+"px");this.__visibleRect.update(this.__visibleRect.x,this.__visibleRect.y,d,b);this.__visibleDelta.update(this.__visibleDelta.x,this.__visibleDelta.y,d,b);var g=new P(this.extent),a=(new P(g.x,g.y,d/a*g.width,b/c*g.height,this.spatialReference)).getExtent();this.onResize(a,d,b);this._extentUtil(null,null,a,null,!0)}},reposition:function(){var a=
this.position,c=a.x,b=a.y;this._reposition();a=this.position;c===a.x&&b===a.y||this.onReposition(a.x,a.y)},_reposition:function(){var a=r.position(this.container,!0),c=r.getPadBorderExtents(this.container);this.position.update(a.x+c.l,a.y+c.t)},_setClipRect:function(){delete this._clip;var a=7>=u("ie")||void 0===u("ie")&&7<=u("trident")?"rect(auto,auto,auto,auto)":"auto";if(this.wrapAround180){var c=this.width,b=this.height,d=this._getFrameWidth(),g=c-d;0<g&&(a=g/2,a="rect(0px,"+(a+d)+"px,"+b+"px,"+
a+"px)",b=this.extent.getWidth(),c=d/c*b,this._clip=[(b-c)/2,c])}za(this.__container,"clip",a)},_getAvailExtent:function(){var a=this.extent,c=this._clip;if(c){if(!a._clip){var b=new P(a);b.width=c[1];b.x+=c[0];a._clip=b.getExtent()}return a._clip}return a},_fixedPan:function(a,c){return this._extentUtil(null,{dx:a,dy:c})},panUp:function(){return this._fixedPan(0,-.75*this.height)},panUpperRight:function(){return this._fixedPan(.75*this.width,-.75*this.height)},panRight:function(){return this._fixedPan(.75*
this.width,0)},panLowerRight:function(){return this._fixedPan(.75*this.width,.75*this.height)},panDown:function(){return this._fixedPan(0,.75*this.height)},panLowerLeft:function(){return this._fixedPan(-.75*this.width,.75*this.height)},panLeft:function(){return this._fixedPan(-.75*this.width,0)},panUpperLeft:function(){return this._fixedPan(-.75*this.width,-.75*this.height)},enableSnapping:function(a){if(a=a||{},"esri.SnappingManager"===a.declaredClass)this.snappingManager=a;else{var c=ua++,b=this;
this._rids&&this._rids.push(c);h(["./SnappingManager"],function(d){var g=b._rids?m.indexOf(b._rids,c):-1;-1!==g&&(b._rids.splice(g,1),b.snappingManager=new d(l.mixin({map:b},a)))})}return this.snappingManager},disableSnapping:function(){this.snappingManager&&this.snappingManager.destroy();this.snappingManager=null},_createLabelLayer:function(){!this._labels&&pa&&this.loaded&&(this._labels=new pa({id:"_internal_LabelLayer"}),this._labels._setMap(this,this._gc._surface),this._processLabelLayers(),this.on("layers-reordered",
this._processLabelLayers))},_processLabelLayers:function(){null==this._labelProcessor&&(this._labelProcessor=setTimeout(this._updateLabelLayers,0))},_updateLabelLayers:function(){this._labelProcessor=null;this._labels&&(this._labels.removeAllFeatureLayers(),m.forEach(this.graphicsLayerIds,function(a){a=this.getLayer(a);"function"==typeof a.applyEdits?this._labels.addFeatureLayer(a):"esri.layers.WFSLayer"===a.declaredClass&&this._labels.addFeatureLayer(a)},this))},_getMapImageLyr:function(){return this.loaded&&
!this._mapImageLyr&&(this._mapImageLyr=new da,this._mapImageLyr._setMap(this,this._layersDiv),this._placeMapImageLyr()),this._mapImageLyr},_placeMapImageLyr:function(){for(var a,c,b=this.layerIds,d=this._layerDivs,g=!1,e=b.length-1;0<=e;e--){var f=b[e];if(c=this.getLayer(f),a=d[f],c&&a&&!c._isReference){t.place(this._mapImageLyr._div,a,"after");g=!0;break}}g||t.place(this._mapImageLyr._div,this._layersDiv,"first")}});return u("extend-esri")&&(y._CoreMap=f),f})},"dojo/_base/unload":function(){define(["./kernel",
"./lang","../on"],function(h,k,a){var f=window,b={addOnWindowUnload:function(b,l){h.windowUnloaded||a(f,"unload",h.windowUnloaded=function(){});a(f,"unload",k.hitch(b,l))},addOnUnload:function(b,l){a(f,"beforeunload",k.hitch(b,l))}};h.addOnWindowUnload=b.addOnWindowUnload;h.addOnUnload=b.addOnUnload;return b})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(h,k){var a=h.matrix={},f={};a._degToRad=function(a){return f[a]||(f[a]=Math.PI*a/180)};a._radToDeg=function(a){return a/
Math.PI*180};a.Matrix2D=function(b){if(b)if("number"==typeof b)this.xx=this.yy=b;else if(b instanceof Array){if(0<b.length){for(var e=a.normalize(b[0]),f=1;f<b.length;++f){var m=e,g=a.normalize(b[f]),e=new a.Matrix2D;e.xx=m.xx*g.xx+m.xy*g.yx;e.xy=m.xx*g.xy+m.xy*g.yy;e.yx=m.yx*g.xx+m.yy*g.yx;e.yy=m.yx*g.xy+m.yy*g.yy;e.dx=m.xx*g.dx+m.xy*g.dy+m.dx;e.dy=m.yx*g.dx+m.yy*g.dy+m.dy}k.mixin(this,e)}}else k.mixin(this,b)};k.extend(a.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});k.mixin(a,{identity:new a.Matrix2D,
flipX:new a.Matrix2D({xx:-1}),flipY:new a.Matrix2D({yy:-1}),flipXY:new a.Matrix2D({xx:-1,yy:-1}),translate:function(b,e){return 1<arguments.length?new a.Matrix2D({dx:b,dy:e}):new a.Matrix2D({dx:b.x,dy:b.y})},scale:function(b,e){return 1<arguments.length?new a.Matrix2D({xx:b,yy:e}):"number"==typeof b?new a.Matrix2D({xx:b,yy:b}):new a.Matrix2D({xx:b.x,yy:b.y})},rotate:function(b){var e=Math.cos(b);b=Math.sin(b);return new a.Matrix2D({xx:e,xy:-b,yx:b,yy:e})},rotateg:function(b){return a.rotate(a._degToRad(b))},
skewX:function(b){return new a.Matrix2D({xy:Math.tan(b)})},skewXg:function(b){return a.skewX(a._degToRad(b))},skewY:function(b){return new a.Matrix2D({yx:Math.tan(b)})},skewYg:function(b){return a.skewY(a._degToRad(b))},reflect:function(b,e){1==arguments.length&&(e=b.y,b=b.x);var f=b*b,m=e*e,g=f+m,d=2*b*e/g;return new a.Matrix2D({xx:2*f/g-1,xy:d,yx:d,yy:2*m/g-1})},project:function(b,e){1==arguments.length&&(e=b.y,b=b.x);var f=b*b,m=e*e,g=f+m,d=b*e/g;return new a.Matrix2D({xx:f/g,xy:d,yx:d,yy:m/g})},
normalize:function(b){return b instanceof a.Matrix2D?b:new a.Matrix2D(b)},isIdentity:function(a){return 1==a.xx&&0==a.xy&&0==a.yx&&1==a.yy&&0==a.dx&&0==a.dy},clone:function(b){var e=new a.Matrix2D,f;for(f in b)"number"==typeof b[f]&&"number"==typeof e[f]&&e[f]!=b[f]&&(e[f]=b[f]);return e},invert:function(b){b=a.normalize(b);var e=b.xx*b.yy-b.xy*b.yx;return b=new a.Matrix2D({xx:b.yy/e,xy:-b.xy/e,yx:-b.yx/e,yy:b.xx/e,dx:(b.xy*b.dy-b.yy*b.dx)/e,dy:(b.yx*b.dx-b.xx*b.dy)/e})},_multiplyPoint:function(a,
e,f){return{x:a.xx*e+a.xy*f+a.dx,y:a.yx*e+a.yy*f+a.dy}},multiplyPoint:function(b,e,f){b=a.normalize(b);return"number"==typeof e&&"number"==typeof f?a._multiplyPoint(b,e,f):a._multiplyPoint(b,e.x,e.y)},multiplyRectangle:function(b,e){var f=a.normalize(b);e=e||{x:0,y:0,width:0,height:0};if(a.isIdentity(f))return{x:e.x,y:e.y,width:e.width,height:e.height};var m=a.multiplyPoint(f,e.x,e.y),g=a.multiplyPoint(f,e.x,e.y+e.height),d=a.multiplyPoint(f,e.x+e.width,e.y),f=a.multiplyPoint(f,e.x+e.width,e.y+e.height),
c=Math.min(m.x,g.x,d.x,f.x),n=Math.min(m.y,g.y,d.y,f.y);return{x:c,y:n,width:Math.max(m.x,g.x,d.x,f.x)-c,height:Math.max(m.y,g.y,d.y,f.y)-n}},multiply:function(b){for(var e=a.normalize(b),f=1;f<arguments.length;++f){var m=e,g=a.normalize(arguments[f]),e=new a.Matrix2D;e.xx=m.xx*g.xx+m.xy*g.yx;e.xy=m.xx*g.xy+m.xy*g.yy;e.yx=m.yx*g.xx+m.yy*g.yx;e.yy=m.yx*g.xy+m.yy*g.yy;e.dx=m.xx*g.dx+m.xy*g.dy+m.dx;e.dy=m.yx*g.dx+m.yy*g.dy+m.dy}return e},_sandwich:function(b,e,f){return a.multiply(a.translate(e,f),b,
a.translate(-e,-f))},scaleAt:function(b,e,f,m){switch(arguments.length){case 4:return a._sandwich(a.scale(b,e),f,m);case 3:return"number"==typeof f?a._sandwich(a.scale(b),e,f):a._sandwich(a.scale(b,e),f.x,f.y)}return a._sandwich(a.scale(b),e.x,e.y)},rotateAt:function(b,e,f){return 2<arguments.length?a._sandwich(a.rotate(b),e,f):a._sandwich(a.rotate(b),e.x,e.y)},rotategAt:function(b,e,f){return 2<arguments.length?a._sandwich(a.rotateg(b),e,f):a._sandwich(a.rotateg(b),e.x,e.y)},skewXAt:function(b,e,
f){return 2<arguments.length?a._sandwich(a.skewX(b),e,f):a._sandwich(a.skewX(b),e.x,e.y)},skewXgAt:function(b,e,f){return 2<arguments.length?a._sandwich(a.skewXg(b),e,f):a._sandwich(a.skewXg(b),e.x,e.y)},skewYAt:function(b,e,f){return 2<arguments.length?a._sandwich(a.skewY(b),e,f):a._sandwich(a.skewY(b),e.x,e.y)},skewYgAt:function(b,e,f){return 2<arguments.length?a._sandwich(a.skewYg(b),e,f):a._sandwich(a.skewYg(b),e.x,e.y)}});h.Matrix2D=a.Matrix2D;return a})},"esri/basemaps":function(){define(["require",
"dojo/has","./kernel","dojo/i18n!./nls/jsapi"],function(h,k,a,f){h={streets:{title:f.basemaps.streets,thumbnailUrl:h.toUrl("./images/basemap/streets.jpg"),itemId:"d8855ee4d3d74413babfb0f41203b168",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]},satellite:{title:f.basemaps.satellite,thumbnailUrl:h.toUrl("./images/basemap/satellite.jpg"),itemId:"86de95d4e0244cba80f0fa2c9403a7b2",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]},
hybrid:{title:f.basemaps.hybrid,thumbnailUrl:h.toUrl("./images/basemap/hybrid.jpg"),itemId:"413fd05bbd7342f5991d5ec96f4f8b18",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",isReference:!0}]},terrain:{title:f.basemaps.terrain,thumbnailUrl:h.toUrl("./images/basemap/terrain.jpg"),itemId:"aab054ab883c4a4094c72e949566ad40",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer"},
{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",isReference:!0}]},topo:{title:f.basemaps.topo,thumbnailUrl:h.toUrl("./images/basemap/topo.jpg"),itemId:"6e03e8c26aad4b9c92a87c1063ddb0e3",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer"}]},gray:{title:f.basemaps.gray,thumbnailUrl:h.toUrl("./images/basemap/gray.jpg"),itemId:"8b3b470883a744aeb60e5fff0a319ce7",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer"},
{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",isReference:!0}]},"dark-gray":{title:f.basemaps["dark-gray"],thumbnailUrl:h.toUrl("./images/basemap/dark-gray.jpg"),itemId:"da65bacab5bd4defb576f839b6b28098",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer"},{url:"http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",isReference:!0}]},oceans:{title:f.basemaps.oceans,
thumbnailUrl:h.toUrl("./images/basemap/oceans.jpg"),itemId:"48b8cec7ebf04b5fbdcaf70d09daff21",baseMapLayers:[{url:"http://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{url:"http://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",isReference:!0}]},"national-geographic":{title:f.basemaps["national-geographic"],thumbnailUrl:h.toUrl("./images/basemap/national-geographic.jpg"),itemId:"509e2d6b034246d692a461724ae2d62c",baseMapLayers:[{url:"http://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer"}]},
osm:{title:f.basemaps.osm,thumbnailUrl:h.toUrl("./images/basemap/osm.jpg"),itemId:"5d2bfa736f8448b3a1708e1f6be23eed",baseMapLayers:[{type:"OpenStreetMap"}]},"dark-gray-vector":{title:f.basemaps["dark-gray"],thumbnailUrl:h.toUrl("./images/basemap/dark-gray.jpg"),itemId:"850db44b9eb845d3bd42b19e8aa7a024",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/850db44b9eb845d3bd42b19e8aa7a024/resources/styles/root.json",type:"VectorTile"}]},"gray-vector":{title:f.basemaps.gray,thumbnailUrl:h.toUrl("./images/basemap/gray.jpg"),
itemId:"0e02e6f86d02455091796eaae811d9b5",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/0e02e6f86d02455091796eaae811d9b5/resources/styles/root.json",type:"VectorTile"}]},"streets-vector":{title:f.basemaps.streets,thumbnailUrl:h.toUrl("./images/basemap/streets.jpg"),itemId:"4e1133c28ac04cca97693cf336cd49ad",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/4e1133c28ac04cca97693cf336cd49ad/resources/styles/root.json",type:"VectorTile"}]},"topo-vector":{title:f.basemaps.topo,
thumbnailUrl:h.toUrl("./images/basemap/topo.jpg"),itemId:"6f65bc1351b7411588a8cb43fe23dad7",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/6f65bc1351b7411588a8cb43fe23dad7/resources/styles/root.json",type:"VectorTile"}]},"streets-night-vector":{title:f.basemaps["streets-night-vector"],thumbnailUrl:h.toUrl("./images/basemap/streets-night.jpg"),itemId:"bf79e422e9454565ae0cbe9553cf6471",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/bf79e422e9454565ae0cbe9553cf6471/resources/styles/root.json",
type:"VectorTile"}]},"streets-relief-vector":{title:f.basemaps["streets-relief-vector"],thumbnailUrl:h.toUrl("./images/basemap/streets-relief.jpg"),itemId:"2e063e709e3446459f8538ed6743f879",baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/2e063e709e3446459f8538ed6743f879/resources/styles/root.json",type:"VectorTile"}]},"streets-navigation-vector":{title:f.basemaps["streets-navigation-vector"],thumbnailUrl:h.toUrl("./images/basemap/streets-navigation.jpg"),itemId:"dcbbba0edf094eaa81af19298b9c6247",
baseMapLayers:[{url:"http://www.arcgis.com/sharing/rest/content/items/dcbbba0edf094eaa81af19298b9c6247/resources/styles/root.json",type:"VectorTile"}]}};return k("extend-esri")&&(a.basemaps=h),h})},"esri/fx":function(){define("dojo/_base/connect dojo/_base/fx dojo/_base/lang dojo/dom dojo/dom-geometry dojo/dom-style dojo/fx dojo/has ./kernel".split(" "),function(h,k,a,f,b,e,l,m,g){var d={animateRange:function(c){var b=c.range;return new k.Animation(a.mixin({curve:new k._Line(b.start,b.end)},c))},
resize:function(c){var d=c.node=f.byId(c.node),g=c.start,e=c.end;g||(g=b.getMarginBox(d),d=b.getPadBorderExtents(d),g=c.start={left:g.l+d.l,top:g.t+d.t,width:g.w-d.w,height:g.h-d.h});e||(e=c.anchor?c.anchor:{x:g.left,y:g.top},d=c.size,e=c.end={left:g.left-(d.width-g.width)*(e.x-g.left)/g.width,top:g.top-(d.height-g.height)*(e.y-g.top)/g.height,width:d.width,height:d.height});return k.animateProperty(a.mixin({properties:{left:{start:g.left,end:e.left},top:{start:g.top,end:e.top},width:{start:g.width,
end:e.width},height:{start:g.height,end:e.height}}},c))},slideTo:function(c){var d=c.node=f.byId(c.node),g=e.getComputedStyle,l=null,m=null,v=function(){return function(){var a="absolute"==d.style.position?"absolute":"relative";if(l="absolute"==a?d.offsetTop:parseInt(g(d).top)||0,m="absolute"==a?d.offsetLeft:parseInt(g(d).left)||0,"absolute"!=a&&"relative"!=a)a=b.position(d,!0),l=a.y,m=a.x,d.style.position="absolute",d.style.top=l+"px",d.style.left=m+"px"}}();v();c=k.animateProperty(a.mixin({properties:{top:{start:l,
end:c.top||0},left:{start:m,end:c.left||0}}},c));return h.connect(c,"beforeBegin",c,v),c},flash:function(c){c=a.mixin({end:"#f00",duration:500,count:1},c);c.duration/=2*c.count;var b=f.byId(c.node),d=c.start;d||(d=e.getComputedStyle(b).backgroundColor);var g=c.end,m=[],h=c.count,b={node:b,duration:c.duration};for(c=0;h>c;c++)m.push(k.animateProperty(a.mixin({properties:{backgroundColor:{start:d,end:g}}},b))),m.push(k.animateProperty(a.mixin({properties:{backgroundColor:{start:g,end:d}}},b)));return l.chain(m)}};
return m("extend-esri")&&a.mixin(a.getObject("fx",!0,g),d),d})},"dojo/_base/fx":function(){define("./kernel ./config ./lang ../Evented ./Color ../aspect ../sniff ../dom ../dom-style".split(" "),function(h,k,a,f,b,e,l,m,g){var d=a.mixin,c={},n=c._Line=function(a,c){this.start=a;this.end=c};n.prototype.getValue=function(a){return(this.end-this.start)*a+this.start};var q=c.Animation=function(c){d(this,c);a.isArray(this.curve)&&(this.curve=new n(this.curve[0],this.curve[1]))};q.prototype=new f;a.extend(q,
{duration:350,repeat:0,rate:20,_percent:0,_startRepeatCount:0,_getStep:function(){var a=this._percent,c=this.easing;return c?c(a):a},_fire:function(a,c){var b=c||[];if(this[a])if(k.debugAtAllCosts)this[a].apply(this,b);else try{this[a].apply(this,b)}catch(z){console.error("exception in animation handler for:",a),console.error(z)}return this},play:function(c,b){this._delayTimer&&this._clearTimer();if(b)this._stopTimer(),this._active=this._paused=!1,this._percent=0;else if(this._active&&!this._paused)return this;
this._fire("beforeBegin",[this.node]);var d=c||this.delay,g=a.hitch(this,"_play",b);if(0<d)return this._delayTimer=setTimeout(g,d),this;g();return this},_play:function(a){this._delayTimer&&this._clearTimer();this._startTime=(new Date).valueOf();this._paused&&(this._startTime-=this.duration*this._percent);this._active=!0;this._paused=!1;a=this.curve.getValue(this._getStep());this._percent||(this._startRepeatCount||(this._startRepeatCount=this.repeat),this._fire("onBegin",[a]));this._fire("onPlay",
[a]);this._cycle();return this},pause:function(){this._delayTimer&&this._clearTimer();this._stopTimer();if(!this._active)return this;this._paused=!0;this._fire("onPause",[this.curve.getValue(this._getStep())]);return this},gotoPercent:function(a,c){this._stopTimer();this._active=this._paused=!0;this._percent=a;c&&this.play();return this},stop:function(a){this._delayTimer&&this._clearTimer();if(!this._timer)return this;this._stopTimer();a&&(this._percent=1);this._fire("onStop",[this.curve.getValue(this._getStep())]);
this._active=this._paused=!1;return this},destroy:function(){this.stop()},status:function(){return this._active?this._paused?"paused":"playing":"stopped"},_cycle:function(){if(this._active){var a=(new Date).valueOf(),a=0===this.duration?1:(a-this._startTime)/this.duration;1<=a&&(a=1);this._percent=a;this.easing&&(a=this.easing(a));this._fire("onAnimate",[this.curve.getValue(a)]);1>this._percent?this._startTimer():(this._active=!1,0<this.repeat?(this.repeat--,this.play(null,!0)):-1==this.repeat?this.play(null,
!0):this._startRepeatCount&&(this.repeat=this._startRepeatCount,this._startRepeatCount=0),this._percent=0,this._fire("onEnd",[this.node]),!this.repeat&&this._stopTimer())}return this},_clearTimer:function(){clearTimeout(this._delayTimer);delete this._delayTimer}});var t=0,r=null,v={run:function(){}};a.extend(q,{_startTimer:function(){this._timer||(this._timer=e.after(v,"run",a.hitch(this,"_cycle"),!0),t++);r||(r=setInterval(a.hitch(v,"run"),this.rate))},_stopTimer:function(){this._timer&&(this._timer.remove(),
this._timer=null,t--);0>=t&&(clearInterval(r),r=null,t=0)}});var u=l("ie")?function(a){var c=a.style;c.width.length||"auto"!=g.get(a,"width")||(c.width="auto")}:function(){};c._fade=function(b){b.node=m.byId(b.node);var f=d({properties:{}},b);b=f.properties.opacity={};b.start="start"in f?f.start:function(){return+g.get(f.node,"opacity")||0};b.end=f.end;b=c.animateProperty(f);e.after(b,"beforeBegin",a.partial(u,f.node),!0);return b};c.fadeIn=function(a){return c._fade(d({end:1},a))};c.fadeOut=function(a){return c._fade(d({end:0},
a))};c._defaultEasing=function(a){return.5+Math.sin((a+1.5)*Math.PI)/2};var w=function(a){this._properties=a;for(var c in a){var d=a[c];d.start instanceof b&&(d.tempColor=new b)}};w.prototype.getValue=function(c){var d={},g;for(g in this._properties){var e=this._properties[g],f=e.start;f instanceof b?d[g]=b.blendColors(f,e.end,c,e.tempColor).toCss():a.isArray(f)||(d[g]=(e.end-f)*c+f+("opacity"!=g?e.units||"px":0))}return d};c.animateProperty=function(c){var f=c.node=m.byId(c.node);c.easing||(c.easing=
h._defaultEasing);c=new q(c);e.after(c,"beforeBegin",a.hitch(c,function(){var c={},e;for(e in this.properties){var n=function(a,c){var b={height:a.offsetHeight,width:a.offsetWidth}[c];if(void 0!==b)return b;b=g.get(a,c);return"opacity"==c?+b:m?b:parseFloat(b)};if("width"==e||"height"==e)this.node.display="block";var l=this.properties[e];a.isFunction(l)&&(l=l(f));l=c[e]=d({},a.isObject(l)?l:{end:l});a.isFunction(l.start)&&(l.start=l.start(f));a.isFunction(l.end)&&(l.end=l.end(f));var m=0<=e.toLowerCase().indexOf("color");
"end"in l?"start"in l||(l.start=n(f,e)):l.end=n(f,e);m?(l.start=new b(l.start),l.end=new b(l.end)):l.start="opacity"==e?+l.start:parseFloat(l.start)}this.curve=new w(c)}),!0);e.after(c,"onAnimate",a.hitch(g,"set",c.node),!0);return c};c.anim=function(a,b,d,g,e,f){return c.animateProperty({node:a,duration:d||q.prototype.duration,properties:b,easing:g,onEnd:e}).play(f||0)};d(h,c);h._Animation=q;return c})},"dojo/fx":function(){define("./_base/lang ./Evented ./_base/kernel ./_base/array ./aspect ./_base/fx ./dom ./dom-style ./dom-geometry ./ready require".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c){a.isAsync||d(0,function(){c(["./fx/Toggler"])});a=a.fx={};d={_fire:function(a,c){this[a]&&this[a].apply(this,c||[]);return this}};var n=function(a){this._index=-1;this._animations=a||[];this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=0;f.forEach(this._animations,function(a){a&&("undefined"!=typeof a.duration&&(this.duration+=a.duration),a.delay&&(this.duration+=a.delay))},this)};n.prototype=new k;h.extend(n,{_onAnimate:function(){this._fire("onAnimate",
arguments)},_onEnd:function(){this._onAnimateCtx.remove();this._onEndCtx.remove();this._onAnimateCtx=this._onEndCtx=null;this._index+1==this._animations.length?this._fire("onEnd"):(this._current=this._animations[++this._index],this._onAnimateCtx=b.after(this._current,"onAnimate",h.hitch(this,"_onAnimate"),!0),this._onEndCtx=b.after(this._current,"onEnd",h.hitch(this,"_onEnd"),!0),this._current.play(0,!0))},play:function(a,c){this._current||(this._current=this._animations[this._index=0]);if(!c&&"playing"==
this._current.status())return this;var d=b.after(this._current,"beforeBegin",h.hitch(this,function(){this._fire("beforeBegin")}),!0),g=b.after(this._current,"onBegin",h.hitch(this,function(a){this._fire("onBegin",arguments)}),!0),e=b.after(this._current,"onPlay",h.hitch(this,function(a){this._fire("onPlay",arguments);d.remove();g.remove();e.remove()}));this._onAnimateCtx&&this._onAnimateCtx.remove();this._onAnimateCtx=b.after(this._current,"onAnimate",h.hitch(this,"_onAnimate"),!0);this._onEndCtx&&
this._onEndCtx.remove();this._onEndCtx=b.after(this._current,"onEnd",h.hitch(this,"_onEnd"),!0);this._current.play.apply(this._current,arguments);return this},pause:function(){if(this._current){var a=b.after(this._current,"onPause",h.hitch(this,function(c){this._fire("onPause",arguments);a.remove()}),!0);this._current.pause()}return this},gotoPercent:function(a,c){this.pause();var b=this.duration*a;this._current=null;f.some(this._animations,function(a,c){if(b<=a.duration)return this._current=a,this._index=
c,!0;b-=a.duration;return!1},this);this._current&&this._current.gotoPercent(b/this._current.duration);c&&this.play();return this},stop:function(a){if(this._current){if(a){for(;this._index+1<this._animations.length;++this._index)this._animations[this._index].stop(!0);this._current=this._animations[this._index]}var c=b.after(this._current,"onStop",h.hitch(this,function(a){this._fire("onStop",arguments);c.remove()}),!0);this._current.stop()}return this},status:function(){return this._current?this._current.status():
"stopped"},destroy:function(){this.stop();this._onAnimateCtx&&this._onAnimateCtx.remove();this._onEndCtx&&this._onEndCtx.remove()}});h.extend(n,d);a.chain=function(a){return new n(h.isArray(a)?a:Array.prototype.slice.call(a,0))};var q=function(a){this._animations=a||[];this._connects=[];this.duration=this._finished=0;f.forEach(a,function(a){var c=a.duration;a.delay&&(c+=a.delay);this.duration<c&&(this.duration=c);this._connects.push(b.after(a,"onEnd",h.hitch(this,"_onEnd"),!0))},this);this._pseudoAnimation=
new e.Animation({curve:[0,1],duration:this.duration});var c=this;f.forEach("beforeBegin onBegin onPlay onAnimate onPause onStop onEnd".split(" "),function(a){c._connects.push(b.after(c._pseudoAnimation,a,function(){c._fire(a,arguments)},!0))})};h.extend(q,{_doAction:function(a,c){f.forEach(this._animations,function(b){b[a].apply(b,c)});return this},_onEnd:function(){++this._finished>this._animations.length&&this._fire("onEnd")},_call:function(a,c){var b=this._pseudoAnimation;b[a].apply(b,c)},play:function(a,
c){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this},gotoPercent:function(a,c){var b=this.duration*a;f.forEach(this._animations,function(a){a.gotoPercent(a.duration<b?1:b/a.duration,c)});this._call("gotoPercent",arguments);return this},stop:function(a){this._doAction("stop",arguments);this._call("stop",arguments);return this},status:function(){return this._pseudoAnimation.status()},
destroy:function(){this.stop();f.forEach(this._connects,function(a){a.remove()})}});h.extend(q,d);a.combine=function(a){return new q(h.isArray(a)?a:Array.prototype.slice.call(a,0))};a.wipeIn=function(a){var c=a.node=l.byId(a.node),d=c.style,g;a=e.animateProperty(h.mixin({properties:{height:{start:function(){g=d.overflow;d.overflow="hidden";if("hidden"==d.visibility||"none"==d.display)return d.height="1px",d.display="",d.visibility="",1;var a=m.get(c,"height");return Math.max(a,1)},end:function(){return c.scrollHeight}}}},
a));var f=function(){d.height="auto";d.overflow=g};b.after(a,"onStop",f,!0);b.after(a,"onEnd",f,!0);return a};a.wipeOut=function(a){var c=(a.node=l.byId(a.node)).style,d;a=e.animateProperty(h.mixin({properties:{height:{end:1}}},a));b.after(a,"beforeBegin",function(){d=c.overflow;c.overflow="hidden";c.display=""},!0);var g=function(){c.overflow=d;c.height="auto";c.display="none"};b.after(a,"onStop",g,!0);b.after(a,"onEnd",g,!0);return a};a.slideTo=function(a){var c=null,d=null,f=function(a){return function(){var b=
m.getComputedStyle(a),e=b.position;c="absolute"==e?a.offsetTop:parseInt(b.top)||0;d="absolute"==e?a.offsetLeft:parseInt(b.left)||0;"absolute"!=e&&"relative"!=e&&(b=g.position(a,!0),c=b.y,d=b.x,a.style.position="absolute",a.style.top=c+"px",a.style.left=d+"px")}}(a.node=l.byId(a.node));f();a=e.animateProperty(h.mixin({properties:{top:a.top||0,left:a.left||0}},a));b.after(a,"beforeBegin",f,!0);return a};return a})},"esri/deferredUtils":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(h,
k,a){var f={_dfdCanceller:function(a){a.canceled=!0;var b=a._pendingDfd;-1===a.fired&&b&&-1===b.fired&&b.cancel();a._pendingDfd=null},_fixDfd:function(a){var b=a.then;return a.then=function(a,e,g){if(a){var d=a;a=function(a){return a&&a._argsArray?d.apply(null,a):d(a)}}return b.call(this,a,e,g)},a},_resDfd:function(a,e,f){var b=e.length;1===b?f?a.errback(e[0]):a.callback(e[0]):1<b?(e._argsArray=!0,a.callback(e)):a.callback()}};return k("extend-esri")&&h.mixin(a,f),f})},"esri/tileUtils":function(){define(["dojo/_base/array",
"dojo/has","./kernel","./geometry/Point","./geometry/Extent"],function(h,k,a,f,b){var e={_addFrameInfo:function(a,b){var g,d,c,e=2*b.origin[1],f=b.origin[0],l=a.origin.x,m=a.width;h.forEach(a.lods,function(a){g=Math.round(e/a.resolution);d=Math.ceil(g/m);c=Math.floor((f-l)/(m*a.resolution));a._frameInfo||(a._frameInfo=[d,c,c+d-1,g])})},getContainingTileCoords:function(a,b,g){var d=a.origin;g=g.resolution;return{row:Math.floor((d.y-b.y)/(a.height*g)),col:Math.floor((b.x-d.x)/(a.width*g))}},getCandidateTileInfo:function(a,
e,g){var d,c,n,l,m=a.width,r=a.height,h=g.xmax-g.xmin,u=g.ymax-g.ymin,k=a.__tileInfo===e;c=k?a.getMinZoom():-1;var k=k?a.getMaxZoom():-1,x=-1,y=e.lods,A=Math.abs,k=-1<k?k:y.length-1;for(c=-1<c?c:0;k>=c;c++)if(n=y[c]){if(l=A(h>u?u-r*n.resolution:h-m*n.resolution),!(0>x||x>=l))break;d=n;x=l}h=d.resolution;l=(g.xmin+g.xmax)/2;m=(g.ymin+g.ymax)/2;r=a.width/2*h;h*=a.height/2;l=new b(l-r,m-h,l+r,m+h,g.spatialReference);g=new f(l.xmin,l.ymax,g.spatialReference);u=d.resolution;r=e.width;m=e.height;e=e.origin;
a=a.__visibleDelta;h=Math.floor;x=r*u;y=m*u;u=h((e.y-g.y)/y);k=h((g.x-e.x)/x);A=e.y-u*y;e=h(Math.abs((g.x-(e.x+k*x))*r/x))+a.x;a=h(Math.abs((g.y-A)*m/y))+a.y;return{tile:{point:g,coords:{row:u,col:k},offsets:{x:e,y:a}},lod:d,extent:l}},getTileExtent:function(a,e,g,d){var c=a.origin;e=a.lods[e].resolution;var f=a.width,l=a.height;return new b(d*e*f+c.x,c.y-(g+1)*e*l,(d+1)*e*f+c.x,c.y-g*e*l,a.spatialReference)}};return k("extend-esri")&&(a.TileUtils=e),e})},"esri/PluginTarget":function(){define("require dojo/aspect dojo/_base/array dojo/_base/lang dojo/Deferred dojo/when".split(" "),
function(h,k,a,f,b,e){function l(){k.after(this.constructor._meta,"ctor",this._pluginsHandler,!0);this._plugins={}}return l.prototype={addPlugin:function(a,g){var d=this,c=this._plugins,f=new b;try{h([a],function(b){a in c?f.resolve({id:c[a].declaredId||a.replace(/\//g,".")}):(c[a]=b,e(b.add(d,g),function(){var c={id:b.declaredId||a.replace(/\//g,".")};d.emit("plugin-add",c);f.resolve(c)},function(a){f.reject(a)}))})}catch(q){f.reject(q)}return f.promise},removePlugin:function(a){if(a in this._plugins){var b=
this._plugins[a];b.remove(this);delete this._plugins[a];this.emit("plugin-remove",{id:b.declaredId||a.replace(/\//g,".")})}},_pluginsHandler:function(){var b=this;a.some(arguments,function(a){if(a&&a.plugins&&a.plugins instanceof Array){var d,c,g=a.plugins;for(c=0;c<g.length;c++)a=g[c],d=a instanceof Object?a.id:a,b.addPlugin(d,a.options);return!0}})}},l})},"esri/arcade/Dictionary":function(){define(["require","exports","./languageUtils","../geometry/Geometry","./ImmutableArray"],function(h,k,a,f,
b){return function(){function e(a){this.attributes=null;this.plain=!1;this.immutable=!0;a instanceof e?this.attributes=a.attributes:void 0===a?this.attributes={}:null===a?this.attributes={}:this.attributes=a}return e.prototype.field=function(a){var b=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var g in this.attributes)if(g.toLowerCase()===b)return this.attributes[g];throw Error("Field not Found");},e.prototype.setField=function(a,b){if(this.immutable)throw Error("Dictionary is Immutable");
var g=a.toLowerCase();if(void 0!==this.attributes[a])return void(this.attributes[a]=b);for(var d in this.attributes)if(d.toLowerCase()===g)return void(this.attributes[d]=b);this.attributes[a]=b},e.prototype.hasField=function(a){var b=a.toLowerCase();if(void 0!==this.attributes[a])return!0;for(var g in this.attributes)if(g.toLowerCase()===b)return!0;return!1},e.prototype.keys=function(){var a=[],b;for(b in this.attributes)a.push(b);return a=a.sort()},e.prototype.castToText=function(){var e="",m;for(m in this.attributes){""!==
e&&(e+=",");var g=this.attributes[m];null==g?g="null":a.isBoolean(g)||a.isNumber(g)||a.isString(g)?e+=JSON.stringify(m)+":"+JSON.stringify(g):g instanceof f?e+=JSON.stringify(m)+":"+a.toStringExplicit(g):g instanceof b?e+=JSON.stringify(m)+":"+a.toStringExplicit(g):g instanceof Array?e+=JSON.stringify(m)+":"+a.toStringExplicit(g):g instanceof Date?e+=JSON.stringify(m)+":"+JSON.stringify(g):null!==g&&"object"==typeof g&&void 0!==g.castToText&&(e+=JSON.stringify(m)+":"+g.castToText())}return"{"+e+"}"},
e}()})},"esri/arcade/languageUtils":function(){define("require exports ../geometry/Geometry ../moment dojo/number ./ImmutableArray ../kernel ./ImmutablePointArray ./ImmutablePathArray dojo/_base/array ../geometry/Point ./FunctionWrapper".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n){function q(a,c,b){if(""===c||null===c||void 0===c||c===b||c===b)return a;do a=a.replace(c,b);while(-1!==a.indexOf(c));return a}function t(a){return a instanceof L||a instanceof n||a instanceof M}function r(a){return"string"==
typeof a||a instanceof String}function v(a){return"boolean"==typeof a}function u(a){return"number"==typeof a}function w(a){return a instanceof Array}function x(a){return a instanceof Date}function y(a,c){return!1===isNaN(a)?void 0===c||null===c||""===c?a.toString():(c=q(c,"\u2030",""),c=q(c,"\u00a4",""),b.format(a,{pattern:c})):a.toString()}function A(a,c){var b=f(a);return void 0===c||null===c||""===c?b.format():b.format(z(c))}function z(a){return a.replace(/(LTS)|L|l/g,function(a){return"["+a+"]"})}
function B(a,c,b){switch(b){case "\x3e":return a>c;case "\x3c":return c>a;case "\x3e\x3d":return a>=c;case "\x3c\x3d":return c>=a}return!1}function C(a,b){if(a===b||null===a&&b===k.voidOperation||null===b&&a===k.voidOperation)return!0;if(x(a)&&x(b))return a.getTime()===b.getTime();if(a instanceof g||a instanceof m)return a.equalityTest(b);if(a instanceof c&&b instanceof c){var d=void 0,e=void 0;if(k.isVersion4?(d=a.cache._arcadeCacheId,e=b.cache._arcadeCacheId):(d=a.getCacheValue("_arcadeCacheId"),
e=b.getCacheValue("_arcadeCacheId")),void 0!==d&&null!==d)return d===e}return void 0!==a&&void 0!==b&&null!==a&&null!==b&&"object"==typeof a&&"object"==typeof b&&(a._arcadeCacheId===b._arcadeCacheId&&void 0!==a._arcadeCacheId&&null!==a._arcadeCacheId||a._underlyingGraphic===b._underlyingGraphic&&void 0!==a._underlyingGraphic&&null!==a._underlyingGraphic)?!0:!1}function D(c,b){if(r(c))return c;if(null===c)return"";if(u(c))return y(c,b);if(v(c))return c.toString();if(x(c))return A(c,b);if(c instanceof
a)return JSON.stringify(c.toJson());if(w(c)){for(var d=[],g=0;g<c.length;g++)d[g]=F(c[g]);return"["+d.join(",")+"]"}if(c instanceof e){d=[];for(g=0;g<c.length();g++)d[g]=F(c.get(g));return"["+d.join(",")+"]"}return null!==c&&"object"==typeof c&&void 0!==c.castToText?c.castToText():t(c)?"object, Function":(c===k.voidOperation,"")}function E(c,b){if(r(c))return c;if(null===c)return"";if(u(c))return y(c,b);if(v(c))return c.toString();if(x(c))return A(c,b);if(c instanceof a)return JSON.stringify(c.toJson());
if(w(c)){for(var d=[],g=0;g<c.length;g++)d[g]=F(c[g]);return"["+d.join(",")+"]"}if(c instanceof e){d=[];for(g=0;g<c.length();g++)d[g]=F(c.get(g));return"["+d.join(",")+"]"}return null!==c&&"object"==typeof c&&void 0!==c.castToText?c.castToText():t(c)?"object, Function":(c===k.voidOperation,"")}function F(c){return null===c?"null":v(c)||u(c)||r(c)?JSON.stringify(c):c instanceof a||c instanceof e||c instanceof Array?E(c):c instanceof Date?JSON.stringify(A(c,"")):null!==c&&"object"==typeof c&&void 0!==
c.castToText?c.castToText():"null"}function G(a,c){return u(a)?a:null===a?0:""===a?0:x(a)?NaN:v(a)?a?1:0:""===a?NaN:void 0===a?NaN:void 0!==c&&r(a)?(c=q(c,"\u2030",""),c=q(c,"\u00a4",""),b.parse(a,{pattern:c})):a===k.voidOperation?0:Number(a)}function I(a,c){var b;return d.some(c.fields,function(c){return c.name===a&&(b=c.domain),!!b}),b}h=function(){return function(a){this.value=a}}();var J=function(){return function(a){this.value=a}}(),L=function(){return function(a){this.fn=a}}(),M=function(){return function(a){this.fn=
a}}();k.NativeFunction=L;k.ImplicitResult=J;k.ReturnResult=h;k.SizzleFunction=M;k.isVersion4=0===l.version.indexOf("4.");k.voidOperation={type:"VOID"};k.breakResult={type:"BREAK"};k.continueResult={type:"CONTINUE"};k.multiReplace=q;k.isFunctionParameter=t;k.isSimpleType=function(a){return r(a)?!0:u(a)?!0:x(a)?!0:v(a)?!0:null===a?!0:a===k.voidOperation?!0:"number"==typeof a?!0:!1};k.defaultUndefined=function(a,c){return void 0===a?c:a};k.isString=r;k.isBoolean=v;k.isNumber=u;k.isArray=w;k.isFeatureCursor=
function(a){return a&&void 0!==a.isFeatureCursor};k.isImmutableArray=function(a){return a instanceof e};k.isDate=x;k.pcCheck=function(a,c,b){if(a.length<c||a.length>b)throw Error("Function called with wrong number of Parameters");};k.generateUUID=function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var b=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"===c?b:3&b|8).toString(16)})};k.formatNumber=y;k.formatDate=A;k.standardiseDateFormat=
z;k.greaterThanLessThan=function(a,c,b){if(null===a){if(null===c||c===k.voidOperation)return B(null,null,b);if(u(c))return B(0,c,b);if(r(c)||v(c))return B(0,G(c),b);if(x(c))return B(0,c.getTime(),b)}if(a===k.voidOperation){if(null===c||c===k.voidOperation)return B(null,null,b);if(u(c))return B(0,c,b);if(r(c)||v(c))return B(0,G(c),b);if(x(c))return B(0,c.getTime(),b)}else if(u(a)){if(u(c))return B(a,c,b);if(v(c))return B(a,G(c),b);if(null===c||c===k.voidOperation)return B(a,0,b);if(r(c))return B(a,
G(c),b);if(x(c))return B(a,c.getTime(),b)}else if(r(a)){if(r(c))return B(D(a),D(c),b);if(x(c))return B(G(a),c.getTime(),b);if(u(c))return B(G(a),c,b);if(null===c||c===k.voidOperation)return B(G(a),0,b);if(v(c))return B(G(a),G(c),b)}else if(x(a)){if(x(c))return B(a,c,b);if(null===c||c===k.voidOperation)return B(a.getTime(),0,b);if(u(c))return B(a.getTime(),c,b);if(v(c)||r(c))return B(a.getTime(),G(c),b)}else if(v(a)){if(v(c))return B(a,c,b);if(u(c))return B(G(a),G(c),b);if(x(c))return B(G(a),c.getTime(),
b);if(null===c||c===k.voidOperation)return B(G(a),0,b);if(r(c))return B(G(a),G(c),b)}return!C(a,c)||"\x3c\x3d"!==b&&"\x3e\x3d"!==b?!1:!0};k.equalityTest=C;k.toString=D;k.toNumberArray=function(a){var c=[];if(!1===w(a))return null;if(a instanceof e){for(var b=0;b<a.length();b++)c[b]=G(a.get(b));return c}for(b=0;b<a.length;b++)c[b]=G(a[b]);return c};k.toStringExplicit=E;k.toNumber=G;k.toDate=function(a,c){if(x(a))return a;if(r(a)){var b=f(a,[void 0===c||null===c||""===c?f.ISO_8601:c]);if(b.isValid())return b.toDate()}return null};
k.toDateM=function(a,c){if(x(a))return f(a);if(r(a)){var b=f(a,[void 0===c||null===c||""===c?f.ISO_8601:c]);if(b.isValid())return b}return null};k.toBoolean=function(a){return v(a)?a:r(a)?(a=a.toLowerCase(),"true"===a?!0:!1):u(a)?0===a?!1:isNaN(a)?!1:!0:!1};k.fixSpatialReference=function(a,c){return null===a?null:((null===a.spatialReference||void 0===a.spatialReference)&&(a.spatialReference=c),a)};k.getDomainValue=function(a,c){if(!a||!a.domain)return null;var b=null;c="string"===a.field.type||"esriFieldTypeString"===
a.field.type?D(c):G(c);for(var d=0;d<a.domain.codedValues.length;d++){var g=a.domain.codedValues[d];g.code===c&&(b=g)}return null===b?null:b.name};k.getDomainCode=function(a,c){if(!a||!a.domain)return null;var b=null;c=D(c);for(var d=0;d<a.domain.codedValues.length;d++){var g=a.domain.codedValues[d];g.name===c&&(b=g)}return null===b?null:b.code};k.getDomain=function(a,c,b,g){if((void 0===b&&(b=null),!c)||!c.fields)return null;for(var e=null,f=0;f<c.fields.length;f++){var n=c.fields[f];n.name.toLowerCase()===
a.toString().toLowerCase()&&(e=n)}if(null===e)return null;var l,m;return g||(g=b&&c.typeIdField&&b._field(c.typeIdField)),null!=g&&d.some(c.types,function(a){return a.id===g?(l=a.domains&&a.domains[e.name],l&&"inherited"===l.type&&(l=I(e.name,c),m=!0),!0):!1}),m||l||(l=I(a,c)),{field:e,domain:l}}})},"esri/moment":function(){define(["require","exports","./plugins/moment!"],function(h,k,a){return a})},"esri/plugins/moment":function(){define(["require","exports","dojo/_base/kernel","moment/moment"],
function(h,k,a,f){var b={ar:1,"ar-dz":1,"ar-ly":1,"ar-ma":1,"ar-sa":1,"ar-tn":1,bs:1,cs:1,da:1,de:1,"de-at":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,"en-ie":1,"en-nz":1,es:1,"es-do":1,et:1,fi:1,fr:1,"fr-ca":1,"fr-ch":1,he:1,hi:1,hr:1,id:1,it:1,ja:1,ko:1,lt:1,lv:1,nb:1,nl:1,"nl-be":1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,sr:1,"sr-cyrl":1,sv:1,th:1,tr:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1};k.load=function(e,l,m){e=a.locale;var g=e in b;if(!g){var d=e.split("-");1<d.length&&d[0]in b&&(e=d[0],g=!0)}g?l(["moment/locale/"+
e],function(){m(f)}):m(f)}})},"moment/moment":function(){(function(h,k){"object"===typeof exports&&"undefined"!==typeof module?module.exports=k():"function"===typeof define&&define.amd?define(k):h.moment=k()})(this,function(){function h(){return vb.apply(null,arguments)}function k(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}function a(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)}function f(a){return"number"===typeof a||"[object Number]"===
Object.prototype.toString.call(a)}function b(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function e(a,c){var b=[],d;for(d=0;d<a.length;++d)b.push(c(a[d],d));return b}function l(a,c){return Object.prototype.hasOwnProperty.call(a,c)}function m(a,c){for(var b in c)l(c,b)&&(a[b]=c[b]);l(c,"toString")&&(a.toString=c.toString);l(c,"valueOf")&&(a.valueOf=c.valueOf);return a}function g(a,c,b,d){return Ra(a,c,b,d,!0).utc()}function d(a){null==a._pf&&(a._pf={empty:!1,unusedTokens:[],
unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null});return a._pf}function c(a){if(null==a._isValid){var c=d(a),b=Kb.call(c.parsedDateParts,function(a){return null!=a}),b=!isNaN(a._d.getTime())&&0>c.overflow&&!c.empty&&!c.invalidMonth&&!c.invalidWeekday&&!c.nullInput&&!c.invalidFormat&&!c.userInvalidated&&(!c.meridiem||c.meridiem&&b);a._strict&&(b=b&&0===c.charsLeftOver&&0===c.unusedTokens.length&&void 0===
c.bigHour);if(null!=Object.isFrozen&&Object.isFrozen(a))return b;a._isValid=b}return a._isValid}function n(a){var c=g(NaN);null!=a?m(d(c),a):d(c).userInvalidated=!0;return c}function q(a){return void 0===a}function t(a,c){var b,g,e;q(c._isAMomentObject)||(a._isAMomentObject=c._isAMomentObject);q(c._i)||(a._i=c._i);q(c._f)||(a._f=c._f);q(c._l)||(a._l=c._l);q(c._strict)||(a._strict=c._strict);q(c._tzm)||(a._tzm=c._tzm);q(c._isUTC)||(a._isUTC=c._isUTC);q(c._offset)||(a._offset=c._offset);q(c._pf)||(a._pf=
d(c));q(c._locale)||(a._locale=c._locale);if(0<xb.length)for(b in xb)g=xb[b],e=c[g],q(e)||(a[g]=e);return a}function r(a){t(this,a);this._d=new Date(null!=a._d?a._d.getTime():NaN);this.isValid()||(this._d=new Date(NaN));!1===qb&&(qb=!0,h.updateOffset(this),qb=!1)}function v(a){return a instanceof r||null!=a&&null!=a._isAMomentObject}function u(a){return 0>a?Math.ceil(a)||0:Math.floor(a)}function w(a){a=+a;var c=0;0!==a&&isFinite(a)&&(c=u(a));return c}function x(a,c,b){var d=Math.min(a.length,c.length),
g=Math.abs(a.length-c.length),e=0,f;for(f=0;f<d;f++)(b&&a[f]!==c[f]||!b&&w(a[f])!==w(c[f]))&&e++;return e+g}function y(a){!1===h.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+a)}function A(a,c){var b=!0;return m(function(){null!=h.deprecationHandler&&h.deprecationHandler(null,a);if(b){for(var d=[],g,e=0;e<arguments.length;e++){g="";if("object"===typeof arguments[e]){g+="\n["+e+"] ";for(var f in arguments[0])g+=f+": "+arguments[0][f]+
", ";g=g.slice(0,-2)}else g=arguments[e];d.push(g)}y(a+"\nArguments: "+Array.prototype.slice.call(d).join("")+"\n"+Error().stack);b=!1}return c.apply(this,arguments)},c)}function z(a,c){null!=h.deprecationHandler&&h.deprecationHandler(a,c);Lb[a]||(y(c),Lb[a]=!0)}function B(a){return a instanceof Function||"[object Function]"===Object.prototype.toString.call(a)}function C(c,b){var d=m({},c),g;for(g in b)l(b,g)&&(a(c[g])&&a(b[g])?(d[g]={},m(d[g],c[g]),m(d[g],b[g])):null!=b[g]?d[g]=b[g]:delete d[g]);
for(g in c)l(c,g)&&!l(b,g)&&a(c[g])&&(d[g]=m({},d[g]));return d}function D(a){null!=a&&this.set(a)}function E(a,c){var b=a.toLowerCase();ib[b]=ib[b+"s"]=ib[c]=a}function F(a){return"string"===typeof a?ib[a]||ib[a.toLowerCase()]:void 0}function G(a){var c={},b,d;for(d in a)l(a,d)&&(b=F(d))&&(c[b]=a[d]);return c}function I(a){var c=[],b;for(b in a)c.push({unit:b,priority:Ka[b]});c.sort(function(a,c){return a.priority-c.priority});return c}function J(a,c){return function(b){if(null!=b){if(this.isValid())this._d["set"+
(this._isUTC?"UTC":"")+a](b);h.updateOffset(this,c);return this}return L(this,a)}}function L(a,c){return a.isValid()?a._d["get"+(a._isUTC?"UTC":"")+c]():NaN}function M(a,c,b){var d=""+Math.abs(a);return(0<=a?b?"+":"":"-")+Math.pow(10,Math.max(0,c-d.length)).toString().substr(1)+d}function H(a,c,b,d){var g=d;"string"===typeof d&&(g=function(){return this[d]()});a&&($a[a]=g);c&&($a[c[0]]=function(){return M(g.apply(this,arguments),c[1],c[2])});b&&($a[b]=function(){return this.localeData().ordinal(g.apply(this,
arguments),a)})}function K(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function P(a){var c=a.match(Bb),b,d;b=0;for(d=c.length;b<d;b++)c[b]=$a[c[b]]?$a[c[b]]:K(c[b]);return function(b){var g="",e;for(e=0;e<d;e++)g+=c[e]instanceof Function?c[e].call(b,a):c[e];return g}}function O(a,c){if(!a.isValid())return a.localeData().invalidDate();c=S(c,a.localeData());Cb[c]=Cb[c]||P(c);return Cb[c](a)}function S(a,c){function b(a){return c.longDateFormat(a)||a}var d=5;for(kb.lastIndex=
0;0<=d&&kb.test(a);)a=a.replace(kb,b),kb.lastIndex=0,--d;return a}function Q(a,c,b){Wb[a]=B(c)?c:function(a,d){return a&&b?b:c}}function R(a,c){return l(Wb,a)?Wb[a](c._strict,c._locale):new RegExp(aa(a))}function aa(a){return X(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,c,b,d,g){return c||b||d||g}))}function X(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26")}function T(a,c){var b,d=c;"string"===typeof a&&(a=[a]);f(c)&&(d=function(a,b){b[c]=w(a)});for(b=0;b<
a.length;b++)Xb[a[b]]=d}function V(a,c){T(a,function(a,b,d,g){d._w=d._w||{};c(a,d._w,d,g)})}function da(a,c){return(new Date(Date.UTC(a,c+1,0))).getUTCDate()}function ga(a,c){var b;if(!a.isValid())return a;if("string"===typeof c)if(/^\d+$/.test(c))c=w(c);else if(c=a.localeData().monthsParse(c),!f(c))return a;b=Math.min(a.date(),da(a.year(),c));a._d["set"+(a._isUTC?"UTC":"")+"Month"](c,b);return a}function la(a){return null!=a?(ga(this,a),h.updateOffset(this,!0),this):L(this,"Month")}function Aa(){function a(a,
c){return c.length-a.length}var c=[],b=[],d=[],e,f;for(e=0;12>e;e++)f=g([2E3,e]),c.push(this.monthsShort(f,"")),b.push(this.months(f,"")),d.push(this.months(f,"")),d.push(this.monthsShort(f,""));c.sort(a);b.sort(a);d.sort(a);for(e=0;12>e;e++)c[e]=X(c[e]),b[e]=X(b[e]);for(e=0;24>e;e++)d[e]=X(d[e]);this._monthsShortRegex=this._monthsRegex=new RegExp("^("+d.join("|")+")","i");this._monthsStrictRegex=new RegExp("^("+b.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+c.join("|")+")","i")}
function ta(a){return 0===a%4&&0!==a%100||0===a%400}function pa(a,c,b,d,g,e,f){c=new Date(a,c,b,d,g,e,f);100>a&&0<=a&&isFinite(c.getFullYear())&&c.setFullYear(a);return c}function wa(a){var c=new Date(Date.UTC.apply(null,arguments));100>a&&0<=a&&isFinite(c.getUTCFullYear())&&c.setUTCFullYear(a);return c}function oa(a,c,b){b=7+c-b;return-((7+wa(a,0,b).getUTCDay()-c)%7)+b-1}function ma(a,c,b,d,g){b=(7+b-d)%7;d=oa(a,d,g);d=1+7*(c-1)+b+d;0>=d?(c=a-1,a=(ta(c)?366:365)+d):d>(ta(a)?366:365)?(c=a+1,a=d-(ta(a)?
366:365)):(c=a,a=d);return{year:c,dayOfYear:a}}function ia(a,c,b){var d=oa(a.year(),c,b),d=Math.floor((a.dayOfYear()-d-1)/7)+1;1>d?(a=a.year()-1,c=d+ja(a,c,b)):d>ja(a.year(),c,b)?(c=d-ja(a.year(),c,b),a=a.year()+1):(a=a.year(),c=d);return{week:c,year:a}}function ja(a,c,b){var d=oa(a,c,b);c=oa(a+1,c,b);return((ta(a)?366:365)-d+c)/7}function za(a,c,b){var d,e;a=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],d=0;7>d;++d)e=
g([2E3,1]).day(d),this._minWeekdaysParse[d]=this.weekdaysMin(e,"").toLocaleLowerCase(),this._shortWeekdaysParse[d]=this.weekdaysShort(e,"").toLocaleLowerCase(),this._weekdaysParse[d]=this.weekdays(e,"").toLocaleLowerCase();if(b)c="dddd"===c?Pa.call(this._weekdaysParse,a):"ddd"===c?Pa.call(this._shortWeekdaysParse,a):Pa.call(this._minWeekdaysParse,a);else if("dddd"===c){c=Pa.call(this._weekdaysParse,a);if(-1!==c)return c;c=Pa.call(this._shortWeekdaysParse,a);if(-1!==c)return c;c=Pa.call(this._minWeekdaysParse,
a)}else if("ddd"===c){c=Pa.call(this._shortWeekdaysParse,a);if(-1!==c)return c;c=Pa.call(this._weekdaysParse,a);if(-1!==c)return c;c=Pa.call(this._minWeekdaysParse,a)}else{c=Pa.call(this._minWeekdaysParse,a);if(-1!==c)return c;c=Pa.call(this._weekdaysParse,a);if(-1!==c)return c;c=Pa.call(this._shortWeekdaysParse,a)}return-1!==c?c:null}function Ba(){function a(a,c){return c.length-a.length}var c=[],b=[],d=[],e=[],f,n,l,m;for(f=0;7>f;f++)n=g([2E3,1]).day(f),l=this.weekdaysMin(n,""),m=this.weekdaysShort(n,
""),n=this.weekdays(n,""),c.push(l),b.push(m),d.push(n),e.push(l),e.push(m),e.push(n);c.sort(a);b.sort(a);d.sort(a);e.sort(a);for(f=0;7>f;f++)b[f]=X(b[f]),d[f]=X(d[f]),e[f]=X(e[f]);this._weekdaysMinRegex=this._weekdaysShortRegex=this._weekdaysRegex=new RegExp("^("+e.join("|")+")","i");this._weekdaysStrictRegex=new RegExp("^("+d.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+b.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+c.join("|")+")","i")}function ra(){return this.hours()%
12||12}function ua(a,c){H(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),c)})}function xa(a,c){return c._meridiemParse}function Ha(a){return a?a.toLowerCase().replace("_","-"):a}function Ia(a){var c=null;if(!La[a]&&"undefined"!==typeof module&&module&&module.exports)try{c=Sb._abbr,require("./locale/"+a),Da(c)}catch(Mc){}return La[a]}function Da(a,c){var b;a&&(b=q(c)?Ga(a):Ja(a,c))&&(Sb=b);return Sb._abbr}function Ja(a,c){if(null!==c){var b=ac;c.abbr=a;if(null!=La[a])z("defineLocaleOverride",
"use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),b=La[a]._config;else if(null!=c.parentLocale)if(null!=La[c.parentLocale])b=La[c.parentLocale]._config;else return Pb[c.parentLocale]||(Pb[c.parentLocale]=[]),Pb[c.parentLocale].push({name:a,config:c}),null;La[a]=new D(C(b,c));Pb[a]&&Pb[a].forEach(function(a){Ja(a.name,
a.config)});Da(a);return La[a]}delete La[a];return null}function Ga(a){var c;a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr);if(!a)return Sb;if(!k(a)){if(c=Ia(a))return c;a=[a]}a:{c=0;for(var b,d,g,e;c<a.length;){e=Ha(a[c]).split("-");b=e.length;for(d=(d=Ha(a[c+1]))?d.split("-"):null;0<b;){if(g=Ia(e.slice(0,b).join("-"))){a=g;break a}if(d&&d.length>=b&&x(e,d,!0)>=b-1)break;b--}c++}a=null}return a}function Na(a){var c;(c=a._a)&&-2===d(a).overflow&&(c=0>c[lb]||11<c[lb]?lb:1>c[gb]||c[gb]>da(c[ab],
c[lb])?gb:0>c[Qa]||24<c[Qa]||24===c[Qa]&&(0!==c[bb]||0!==c[cb]||0!==c[Db])?Qa:0>c[bb]||59<c[bb]?bb:0>c[cb]||59<c[cb]?cb:0>c[Db]||999<c[Db]?Db:-1,d(a)._overflowDayOfYear&&(c<ab||c>gb)&&(c=gb),d(a)._overflowWeeks&&-1===c&&(c=fc),d(a)._overflowWeekday&&-1===c&&(c=gc),d(a).overflow=c);return a}function Ta(a){var c,b;c=a._i;var g=hc.exec(c)||ic.exec(c),e,f,n,l;if(g){d(a).iso=!0;c=0;for(b=Tb.length;c<b;c++)if(Tb[c][1].exec(g[1])){f=Tb[c][0];e=!1!==Tb[c][2];break}if(null==f)a._isValid=!1;else{if(g[3]){c=
0;for(b=Yb.length;c<b;c++)if(Yb[c][1].exec(g[3])){n=(g[2]||" ")+Yb[c][0];break}if(null==n){a._isValid=!1;return}}if(e||null==n){if(g[4])if(jc.exec(g[4]))l="Z";else{a._isValid=!1;return}a._f=f+(n||"")+(l||"");Y(a)}else a._isValid=!1}}else a._isValid=!1}function Xa(a){var c=kc.exec(a._i);null!==c?a._d=new Date(+c[1]):(Ta(a),!1===a._isValid&&(delete a._isValid,h.createFromInputFallback(a)))}function Ma(a,c,b){return null!=a?a:null!=c?c:b}function Oa(a){var c,b=[],g;if(!a._d){g=new Date(h.now());g=a._useUTC?
[g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate()]:[g.getFullYear(),g.getMonth(),g.getDate()];if(a._w&&null==a._a[gb]&&null==a._a[lb]){var e,f,n,l,m,q;e=a._w;if(null!=e.GG||null!=e.W||null!=e.E){if(m=1,q=4,f=Ma(e.GG,a._a[ab],ia(qa(),1,4).year),n=Ma(e.W,1),l=Ma(e.E,1),1>l||7<l)c=!0}else if(m=a._locale._week.dow,q=a._locale._week.doy,n=ia(qa(),m,q),f=Ma(e.gg,a._a[ab],n.year),n=Ma(e.w,n.week),null!=e.d){if(l=e.d,0>l||6<l)c=!0}else if(null!=e.e){if(l=e.e+m,0>e.e||6<e.e)c=!0}else l=m;1>n||n>ja(f,m,q)?
d(a)._overflowWeeks=!0:null!=c?d(a)._overflowWeekday=!0:(c=ma(f,n,l,m,q),a._a[ab]=c.year,a._dayOfYear=c.dayOfYear)}a._dayOfYear&&(c=Ma(a._a[ab],g[ab]),a._dayOfYear>(ta(c)?366:365)&&(d(a)._overflowDayOfYear=!0),c=wa(c,0,a._dayOfYear),a._a[lb]=c.getUTCMonth(),a._a[gb]=c.getUTCDate());for(c=0;3>c&&null==a._a[c];++c)a._a[c]=b[c]=g[c];for(;7>c;c++)a._a[c]=b[c]=null==a._a[c]?2===c?1:0:a._a[c];24===a._a[Qa]&&0===a._a[bb]&&0===a._a[cb]&&0===a._a[Db]&&(a._nextDay=!0,a._a[Qa]=0);a._d=(a._useUTC?wa:pa).apply(null,
b);null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm);a._nextDay&&(a._a[Qa]=24)}}function Y(a){if(a._f===h.ISO_8601)Ta(a);else{a._a=[];d(a).empty=!0;var c=""+a._i,b,g,e,f,n,m=c.length,q=0;e=S(a._f,a._locale).match(Bb)||[];for(b=0;b<e.length;b++){f=e[b];if(g=(c.match(R(f,a))||[])[0])n=c.substr(0,c.indexOf(g)),0<n.length&&d(a).unusedInput.push(n),c=c.slice(c.indexOf(g)+g.length),q+=g.length;if($a[f]){if(g?d(a).empty=!1:d(a).unusedTokens.push(f),n=a,null!=g&&l(Xb,f))Xb[f](g,n._a,n,f)}else a._strict&&
!g&&d(a).unusedTokens.push(f)}d(a).charsLeftOver=m-q;0<c.length&&d(a).unusedInput.push(c);12>=a._a[Qa]&&!0===d(a).bigHour&&0<a._a[Qa]&&(d(a).bigHour=void 0);d(a).parsedDateParts=a._a.slice(0);d(a).meridiem=a._meridiem;c=a._a;b=Qa;m=a._locale;e=a._a[Qa];q=a._meridiem;null!=q&&(null!=m.meridiemHour?e=m.meridiemHour(e,q):null!=m.isPM&&((m=m.isPM(q))&&12>e&&(e+=12),m||12!==e||(e=0)));c[b]=e;Oa(a);Na(a)}}function va(a){if(!a._d){var c=G(a._i);a._a=e([c.year,c.month,c.day||c.date,c.hour,c.minute,c.second,
c.millisecond],function(a){return a&&parseInt(a,10)});Oa(a)}}function Ca(a){var g=a._i,e=a._f;a._locale=a._locale||Ga(a._l);if(null===g||void 0===e&&""===g)return n({nullInput:!0});"string"===typeof g&&(a._i=g=a._locale.preparse(g));if(v(g))return new r(Na(g));if(b(g))a._d=g;else if(k(e)){var f,l,q;if(0===a._f.length)d(a).invalidFormat=!0,a._d=new Date(NaN);else{for(g=0;g<a._f.length;g++)if(e=0,f=t({},a),null!=a._useUTC&&(f._useUTC=a._useUTC),f._f=a._f[g],Y(f),c(f)&&(e+=d(f).charsLeftOver,e+=10*d(f).unusedTokens.length,
d(f).score=e,null==q||e<q))q=e,l=f;m(a,l||f)}}else e?Y(a):fa(a);c(a)||(a._d=null);return a}function fa(a){var c=a._i;void 0===c?a._d=new Date(h.now()):b(c)?a._d=new Date(c.valueOf()):"string"===typeof c?Xa(a):k(c)?(a._a=e(c.slice(0),function(a){return parseInt(a,10)}),Oa(a)):"object"===typeof c?va(a):f(c)?a._d=new Date(c):h.createFromInputFallback(a)}function Ra(c,b,d,g,e){var f={};if(!0===d||!1===d)g=d,d=void 0;var n;if(n=a(c))a:{n=c;for(var l in n){n=!1;break a}n=!0}if(n||k(c)&&0===c.length)c=void 0;
f._isAMomentObject=!0;f._useUTC=f._isUTC=e;f._l=d;f._i=c;f._f=b;f._strict=g;c=new r(Na(Ca(f)));c._nextDay&&(c.add(1,"d"),c._nextDay=void 0);return c}function qa(a,c,b,d){return Ra(a,c,b,d,!1)}function na(a,c){var b,d;1===c.length&&k(c[0])&&(c=c[0]);if(!c.length)return qa();b=c[0];for(d=1;d<c.length;++d)if(!c[d].isValid()||c[d][a](b))b=c[d];return b}function Va(a){a=G(a);var c=a.year||0,b=a.quarter||0,d=a.month||0,g=a.week||0,e=a.day||0;this._milliseconds=+(a.millisecond||0)+1E3*(a.second||0)+6E4*
(a.minute||0)+36E5*(a.hour||0);this._days=+e+7*g;this._months=+d+3*b+12*c;this._data={};this._locale=Ga();this._bubble()}function W(a){return a instanceof Va}function ha(a){return 0>a?-1*Math.round(-1*a):Math.round(a)}function N(a,c){H(a,0,0,function(){var a=this.utcOffset(),b="+";0>a&&(a=-a,b="-");return b+M(~~(a/60),2)+c+M(~~a%60,2)})}function ea(a,c){var b=(c||"").match(a);if(null===b)return null;var b=((b[b.length-1]||[])+"").match(lc)||["-",0,0],d=+(60*b[1])+w(b[2]);return 0===d?0:"+"===b[0]?
d:-d}function ka(a,c){var d,g;return c._isUTC?(d=c.clone(),g=(v(a)||b(a)?a.valueOf():qa(a).valueOf())-d.valueOf(),d._d.setTime(d._d.valueOf()+g),h.updateOffset(d,!1),d):qa(a).local()}function sa(){return this.isValid()?this._isUTC&&0===this._offset:!1}function ba(a,c){var b=a,d=null;W(a)?b={ms:a._milliseconds,d:a._days,M:a._months}:f(a)?(b={},c?b[c]=a:b.milliseconds=a):(d=mc.exec(a))?(b="-"===d[1]?-1:1,b={y:0,d:w(d[gb])*b,h:w(d[Qa])*b,m:w(d[bb])*b,s:w(d[cb])*b,ms:w(ha(1E3*d[Db]))*b}):(d=nc.exec(a))?
(b="-"===d[1]?-1:1,b={y:ca(d[2],b),M:ca(d[3],b),w:ca(d[4],b),d:ca(d[5],b),h:ca(d[6],b),m:ca(d[7],b),s:ca(d[8],b)}):null==b?b={}:"object"===typeof b&&("from"in b||"to"in b)&&(d=qa(b.from),b=qa(b.to),d.isValid()&&b.isValid()?(b=ka(b,d),d.isBefore(b)?b=U(d,b):(b=U(b,d),b.milliseconds=-b.milliseconds,b.months=-b.months),d=b):d={milliseconds:0,months:0},b={},b.ms=d.milliseconds,b.M=d.months);b=new Va(b);W(a)&&l(a,"_locale")&&(b._locale=a._locale);return b}function ca(a,c){var b=a&&parseFloat(a.replace(",",
"."));return(isNaN(b)?0:b)*c}function U(a,c){var b={milliseconds:0,months:0};b.months=c.month()-a.month()+12*(c.year()-a.year());a.clone().add(b.months,"M").isAfter(c)&&--b.months;b.milliseconds=+c-+a.clone().add(b.months,"M");return b}function yb(a,c){return function(b,d){var g;null===d||isNaN(+d)||(z(c,"moment()."+c+"(period, number) is deprecated. Please use moment()."+c+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),g=b,b=d,d=g);g=ba("string"===
typeof b?+b:b,d);pb(this,g,a);return this}}function pb(a,c,b,d){var g=c._milliseconds,e=ha(c._days);c=ha(c._months);if(a.isValid()){d=null==d?!0:d;g&&a._d.setTime(a._d.valueOf()+g*b);if(e&&(g=L(a,"Date")+e*b,a.isValid()))a._d["set"+(a._isUTC?"UTC":"")+"Date"](g);c&&ga(a,L(a,"Month")+c*b);d&&h.updateOffset(a,e||c)}}function jb(a){if(void 0===a)return this._locale._abbr;a=Ga(a);null!=a&&(this._locale=a);return this}function zb(){return this._locale}function Ua(a,c){H(0,[a,a.length],0,c)}function wb(a,
c,b,d,g){var e;if(null==a)return ia(this,d,g).year;e=ja(a,d,g);c>e&&(c=e);a=ma(a,c,b,d,g);a=wa(a.year,0,a.dayOfYear);this.year(a.getUTCFullYear());this.month(a.getUTCMonth());this.date(a.getUTCDate());return this}function rb(a,c){c[Db]=w(1E3*("0."+a))}function Ab(a){return a}function db(a,c,b,d){var e=Ga();c=g().set(d,c);return e[b](c,a)}function hb(a,c,b){f(a)&&(c=a,a=void 0);a=a||"";if(null!=c)return db(a,c,b,"month");var d=[];for(c=0;12>c;c++)d[c]=db(a,c,b,"month");return d}function Ya(a,c,b,d){"boolean"!==
typeof a&&(b=c=a,a=!1);f(c)&&(b=c,c=void 0);c=c||"";var g=Ga();a=a?g._week.dow:0;if(null!=b)return db(c,(b+a)%7,d,"day");g=[];for(b=0;7>b;b++)g[b]=db(c,(b+a)%7,d,"day");return g}function Wa(a,c,b,d){c=ba(c,b);a._milliseconds+=d*c._milliseconds;a._days+=d*c._days;a._months+=d*c._months;return a._bubble()}function Ob(a){return 0>a?Math.floor(a):Math.ceil(a)}function Za(a){return function(){return this.as(a)}}function eb(a){return function(){return this._data[a]}}function Rb(a,c,b,d,g){return g.relativeTime(c||
1,!!b,a,d)}function fb(){var a=Zb(this._milliseconds)/1E3,c=Zb(this._days),b=Zb(this._months),d,g;d=u(a/60);g=u(d/60);a%=60;d%=60;var e=u(b/12),b=b%12,f=this.asSeconds();return f?(0>f?"-":"")+"P"+(e?e+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(g||d||a?"T":"")+(g?g+"H":"")+(d?d+"M":"")+(a?a+"S":""):"P0D"}var vb,Kb=Array.prototype.some?Array.prototype.some:function(a){for(var c=Object(this),b=c.length>>>0,d=0;d<b;d++)if(d in c&&a.call(this,c[d],d,c))return!0;return!1},xb=h.momentProperties=[],qb=!1,Lb={};h.suppressDeprecationWarnings=
!1;h.deprecationHandler=null;var Mb=Object.keys?Object.keys:function(a){var c,b=[];for(c in a)l(a,c)&&b.push(c);return b},ib={},Ka={},Bb=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,kb=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Cb={},$a={},Eb=/\d/,Sa=/\d\d/,Fb=/\d{3}/,Gb=/\d{4}/,mb=/[+-]?\d{6}/,Ea=/\d\d?/,Hb=/\d\d\d\d?/,Ib=/\d\d\d\d\d\d?/,nb=/\d{1,3}/,Jb=/\d{1,4}/,
Nb=/[+-]?\d{1,6}/,$b=/\d+/,Ub=/[+-]?\d+/,oc=/Z|[+-]\d\d:?\d\d/gi,Vb=/Z|[+-]\d\d(?::?\d\d)?/gi,Qb=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Wb={},Xb={},ab=0,lb=1,gb=2,Qa=3,bb=4,cb=5,Db=6,fc=7,gc=8,Pa=Array.prototype.indexOf?Array.prototype.indexOf:function(a){var c;for(c=0;c<this.length;++c)if(this[c]===a)return c;return-1};H("M",["MM",2],"Mo",function(){return this.month()+1});H("MMM",0,0,function(a){return this.localeData().monthsShort(this,
a)});H("MMMM",0,0,function(a){return this.localeData().months(this,a)});E("month","M");Ka.month=8;Q("M",Ea);Q("MM",Ea,Sa);Q("MMM",function(a,c){return c.monthsShortRegex(a)});Q("MMMM",function(a,c){return c.monthsRegex(a)});T(["M","MM"],function(a,c){c[lb]=w(a)-1});T(["MMM","MMMM"],function(a,c,b,g){g=b._locale.monthsParse(a,g,b._strict);null!=g?c[lb]=g:d(b).invalidMonth=a});var bc=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;H("Y",0,0,function(){var a=this.year();return 9999>=a?""+a:"+"+a});H(0,["YY",2],0,function(){return this.year()%
100});H(0,["YYYY",4],0,"year");H(0,["YYYYY",5],0,"year");H(0,["YYYYYY",6,!0],0,"year");E("year","y");Ka.year=1;Q("Y",Ub);Q("YY",Ea,Sa);Q("YYYY",Jb,Gb);Q("YYYYY",Nb,mb);Q("YYYYYY",Nb,mb);T(["YYYYY","YYYYYY"],ab);T("YYYY",function(a,c){c[ab]=2===a.length?h.parseTwoDigitYear(a):w(a)});T("YY",function(a,c){c[ab]=h.parseTwoDigitYear(a)});T("Y",function(a,c){c[ab]=parseInt(a,10)});h.parseTwoDigitYear=function(a){return w(a)+(68<w(a)?1900:2E3)};var cc=J("FullYear",!0);H("w",["ww",2],"wo","week");H("W",["WW",
2],"Wo","isoWeek");E("week","w");E("isoWeek","W");Ka.week=5;Ka.isoWeek=5;Q("w",Ea);Q("ww",Ea,Sa);Q("W",Ea);Q("WW",Ea,Sa);V(["w","ww","W","WW"],function(a,c,b,d){c[d.substr(0,1)]=w(a)});H("d",0,"do","day");H("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)});H("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)});H("dddd",0,0,function(a){return this.localeData().weekdays(this,a)});H("e",0,0,"weekday");H("E",0,0,"isoWeekday");E("day","d");E("weekday","e");E("isoWeekday",
"E");Ka.day=11;Ka.weekday=11;Ka.isoWeekday=11;Q("d",Ea);Q("e",Ea);Q("E",Ea);Q("dd",function(a,c){return c.weekdaysMinRegex(a)});Q("ddd",function(a,c){return c.weekdaysShortRegex(a)});Q("dddd",function(a,c){return c.weekdaysRegex(a)});V(["dd","ddd","dddd"],function(a,c,b,g){g=b._locale.weekdaysParse(a,g,b._strict);null!=g?c.d=g:d(b).invalidWeekday=a});V(["d","e","E"],function(a,c,b,d){c[d]=w(a)});H("H",["HH",2],0,"hour");H("h",["hh",2],0,ra);H("k",["kk",2],0,function(){return this.hours()||24});H("hmm",
0,0,function(){return""+ra.apply(this)+M(this.minutes(),2)});H("hmmss",0,0,function(){return""+ra.apply(this)+M(this.minutes(),2)+M(this.seconds(),2)});H("Hmm",0,0,function(){return""+this.hours()+M(this.minutes(),2)});H("Hmmss",0,0,function(){return""+this.hours()+M(this.minutes(),2)+M(this.seconds(),2)});ua("a",!0);ua("A",!1);E("hour","h");Ka.hour=13;Q("a",xa);Q("A",xa);Q("H",Ea);Q("h",Ea);Q("HH",Ea,Sa);Q("hh",Ea,Sa);Q("hmm",Hb);Q("hmmss",Ib);Q("Hmm",Hb);Q("Hmmss",Ib);T(["H","HH"],Qa);T(["a","A"],
function(a,c,b){b._isPm=b._locale.isPM(a);b._meridiem=a});T(["h","hh"],function(a,c,b){c[Qa]=w(a);d(b).bigHour=!0});T("hmm",function(a,c,b){var g=a.length-2;c[Qa]=w(a.substr(0,g));c[bb]=w(a.substr(g));d(b).bigHour=!0});T("hmmss",function(a,c,b){var g=a.length-4,e=a.length-2;c[Qa]=w(a.substr(0,g));c[bb]=w(a.substr(g,2));c[cb]=w(a.substr(e));d(b).bigHour=!0});T("Hmm",function(a,c,b){b=a.length-2;c[Qa]=w(a.substr(0,b));c[bb]=w(a.substr(b))});T("Hmmss",function(a,c,b){b=a.length-4;var d=a.length-2;c[Qa]=
w(a.substr(0,b));c[bb]=w(a.substr(b,2));c[cb]=w(a.substr(d))});var pc=J("Hours",!0),ac={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",ordinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",
m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),week:{dow:0,doy:6},weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),
meridiemParse:/[ap]\.?m?\.?/i},La={},Pb={},Sb,hc=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ic=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,jc=/Z|[+-]\d\d(?::?\d\d)?/,Tb=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,
!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Yb=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],kc=/^\/?Date\((\-?\d+)/i;h.createFromInputFallback=
A("value provided is not in a recognized ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))});h.ISO_8601=function(){};var qc=A("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",
function(){var a=qa.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:n()}),rc=A("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=qa.apply(null,arguments);return this.isValid()&&a.isValid()?a>this?this:a:n()});N("Z",":");N("ZZ","");Q("Z",Vb);Q("ZZ",Vb);T(["Z","ZZ"],function(a,c,b){b._useUTC=!0;b._tzm=ea(Vb,a)});var lc=/([\+\-]|\d\d)/gi;h.updateOffset=function(){};var mc=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,
nc=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;ba.fn=Va.prototype;var sc=yb(1,"add"),tc=yb(-1,"subtract");h.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";h.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var dc=A("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});
H(0,["gg",2],0,function(){return this.weekYear()%100});H(0,["GG",2],0,function(){return this.isoWeekYear()%100});Ua("gggg","weekYear");Ua("ggggg","weekYear");Ua("GGGG","isoWeekYear");Ua("GGGGG","isoWeekYear");E("weekYear","gg");E("isoWeekYear","GG");Ka.weekYear=1;Ka.isoWeekYear=1;Q("G",Ub);Q("g",Ub);Q("GG",Ea,Sa);Q("gg",Ea,Sa);Q("GGGG",Jb,Gb);Q("gggg",Jb,Gb);Q("GGGGG",Nb,mb);Q("ggggg",Nb,mb);V(["gggg","ggggg","GGGG","GGGGG"],function(a,c,b,d){c[d.substr(0,2)]=w(a)});V(["gg","GG"],function(a,c,b,d){c[d]=
h.parseTwoDigitYear(a)});H("Q",0,"Qo","quarter");E("quarter","Q");Ka.quarter=7;Q("Q",Eb);T("Q",function(a,c){c[lb]=3*(w(a)-1)});H("D",["DD",2],"Do","date");E("date","D");Ka.date=9;Q("D",Ea);Q("DD",Ea,Sa);Q("Do",function(a,c){return a?c._ordinalParse:c._ordinalParseLenient});T(["D","DD"],gb);T("Do",function(a,c){c[gb]=w(a.match(Ea)[0],10)});var ec=J("Date",!0);H("DDD",["DDDD",3],"DDDo","dayOfYear");E("dayOfYear","DDD");Ka.dayOfYear=4;Q("DDD",nb);Q("DDDD",Fb);T(["DDD","DDDD"],function(a,c,b){b._dayOfYear=
w(a)});H("m",["mm",2],0,"minute");E("minute","m");Ka.minute=14;Q("m",Ea);Q("mm",Ea,Sa);T(["m","mm"],bb);var uc=J("Minutes",!1);H("s",["ss",2],0,"second");E("second","s");Ka.second=15;Q("s",Ea);Q("ss",Ea,Sa);T(["s","ss"],cb);var vc=J("Seconds",!1);H("S",0,0,function(){return~~(this.millisecond()/100)});H(0,["SS",2],0,function(){return~~(this.millisecond()/10)});H(0,["SSS",3],0,"millisecond");H(0,["SSSS",4],0,function(){return 10*this.millisecond()});H(0,["SSSSS",5],0,function(){return 100*this.millisecond()});
H(0,["SSSSSS",6],0,function(){return 1E3*this.millisecond()});H(0,["SSSSSSS",7],0,function(){return 1E4*this.millisecond()});H(0,["SSSSSSSS",8],0,function(){return 1E5*this.millisecond()});H(0,["SSSSSSSSS",9],0,function(){return 1E6*this.millisecond()});E("millisecond","ms");Ka.millisecond=16;Q("S",nb,Eb);Q("SS",nb,Sa);Q("SSS",nb,Fb);var sb;for(sb="SSSS";9>=sb.length;sb+="S")Q(sb,$b);for(sb="S";9>=sb.length;sb+="S")T(sb,rb);var wc=J("Milliseconds",!1);H("z",0,0,"zoneAbbr");H("zz",0,0,"zoneName");
var Z=r.prototype;Z.add=sc;Z.calendar=function(a,c){var b=a||qa(),d=ka(b,this).startOf("day"),d=h.calendarFormat(this,d)||"sameElse",g=c&&(B(c[d])?c[d].call(this,b):c[d]);return this.format(g||this.localeData().calendar(d,this,qa(b)))};Z.clone=function(){return new r(this)};Z.diff=function(a,c,b){var d;if(!this.isValid())return NaN;a=ka(a,this);if(!a.isValid())return NaN;d=6E4*(a.utcOffset()-this.utcOffset());c=F(c);if("year"===c||"month"===c||"quarter"===c){d=12*(a.year()-this.year())+(a.month()-
this.month());var g=this.clone().add(d,"months"),e;0>a-g?(e=this.clone().add(d-1,"months"),a=(a-g)/(g-e)):(e=this.clone().add(d+1,"months"),a=(a-g)/(e-g));a=-(d+a)||0;"quarter"===c?a/=3:"year"===c&&(a/=12)}else a=this-a,a="second"===c?a/1E3:"minute"===c?a/6E4:"hour"===c?a/36E5:"day"===c?(a-d)/864E5:"week"===c?(a-d)/6048E5:a;return b?a:u(a)};Z.endOf=function(a){a=F(a);if(void 0===a||"millisecond"===a)return this;"date"===a&&(a="day");return this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,
"ms")};Z.format=function(a){a||(a=this.isUtc()?h.defaultFormatUtc:h.defaultFormat);a=O(this,a);return this.localeData().postformat(a)};Z.from=function(a,c){return this.isValid()&&(v(a)&&a.isValid()||qa(a).isValid())?ba({to:this,from:a}).locale(this.locale()).humanize(!c):this.localeData().invalidDate()};Z.fromNow=function(a){return this.from(qa(),a)};Z.to=function(a,c){return this.isValid()&&(v(a)&&a.isValid()||qa(a).isValid())?ba({from:this,to:a}).locale(this.locale()).humanize(!c):this.localeData().invalidDate()};
Z.toNow=function(a){return this.to(qa(),a)};Z.get=function(a){a=F(a);return B(this[a])?this[a]():this};Z.invalidAt=function(){return d(this).overflow};Z.isAfter=function(a,c){var b=v(a)?a:qa(a);if(!this.isValid()||!b.isValid())return!1;c=F(q(c)?"millisecond":c);return"millisecond"===c?this.valueOf()>b.valueOf():b.valueOf()<this.clone().startOf(c).valueOf()};Z.isBefore=function(a,c){var b=v(a)?a:qa(a);if(!this.isValid()||!b.isValid())return!1;c=F(q(c)?"millisecond":c);return"millisecond"===c?this.valueOf()<
b.valueOf():this.clone().endOf(c).valueOf()<b.valueOf()};Z.isBetween=function(a,c,b,d){d=d||"()";return("("===d[0]?this.isAfter(a,b):!this.isBefore(a,b))&&(")"===d[1]?this.isBefore(c,b):!this.isAfter(c,b))};Z.isSame=function(a,c){var b=v(a)?a:qa(a);if(!this.isValid()||!b.isValid())return!1;c=F(c||"millisecond");if("millisecond"===c)return this.valueOf()===b.valueOf();b=b.valueOf();return this.clone().startOf(c).valueOf()<=b&&b<=this.clone().endOf(c).valueOf()};Z.isSameOrAfter=function(a,c){return this.isSame(a,
c)||this.isAfter(a,c)};Z.isSameOrBefore=function(a,c){return this.isSame(a,c)||this.isBefore(a,c)};Z.isValid=function(){return c(this)};Z.lang=dc;Z.locale=jb;Z.localeData=zb;Z.max=rc;Z.min=qc;Z.parsingFlags=function(){return m({},d(this))};Z.set=function(a,c){if("object"===typeof a){a=G(a);for(var b=I(a),d=0;d<b.length;d++)this[b[d].unit](a[b[d].unit])}else if(a=F(a),B(this[a]))return this[a](c);return this};Z.startOf=function(a){a=F(a);switch(a){case "year":this.month(0);case "quarter":case "month":this.date(1);
case "week":case "isoWeek":case "day":case "date":this.hours(0);case "hour":this.minutes(0);case "minute":this.seconds(0);case "second":this.milliseconds(0)}"week"===a&&this.weekday(0);"isoWeek"===a&&this.isoWeekday(1);"quarter"===a&&this.month(3*Math.floor(this.month()/3));return this};Z.subtract=tc;Z.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]};Z.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),
hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}};Z.toDate=function(){return new Date(this.valueOf())};Z.toISOString=function(){var a=this.clone().utc();return 0<a.year()&&9999>=a.year()?B(Date.prototype.toISOString)?this.toDate().toISOString():O(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):O(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")};Z.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",c="";this.isLocal()||(a=0===this.utcOffset()?
"moment.utc":"moment.parseZone",c="Z");var a="["+a+'("]',b=0<this.year()&&9999>=this.year()?"YYYY":"YYYYYY";return this.format(a+b+"-MM-DD[T]HH:mm:ss.SSS"+(c+'[")]'))};Z.toJSON=function(){return this.isValid()?this.toISOString():null};Z.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")};Z.unix=function(){return Math.floor(this.valueOf()/1E3)};Z.valueOf=function(){return this._d.valueOf()-6E4*(this._offset||0)};Z.creationData=function(){return{input:this._i,
format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}};Z.year=cc;Z.isLeapYear=function(){return ta(this.year())};Z.weekYear=function(a){return wb.call(this,a,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)};Z.isoWeekYear=function(a){return wb.call(this,a,this.isoWeek(),this.isoWeekday(),1,4)};Z.quarter=Z.quarters=function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)};Z.month=la;Z.daysInMonth=function(){return da(this.year(),
this.month())};Z.week=Z.weeks=function(a){var c=this.localeData().week(this);return null==a?c:this.add(7*(a-c),"d")};Z.isoWeek=Z.isoWeeks=function(a){var c=ia(this,1,4).week;return null==a?c:this.add(7*(a-c),"d")};Z.weeksInYear=function(){var a=this.localeData()._week;return ja(this.year(),a.dow,a.doy)};Z.isoWeeksInYear=function(){return ja(this.year(),1,4)};Z.date=ec;Z.day=Z.days=function(a){if(!this.isValid())return null!=a?this:NaN;var c=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=
a){var b=this.localeData();"string"===typeof a&&(isNaN(a)?(a=b.weekdaysParse(a),a="number"===typeof a?a:null):a=parseInt(a,10));return this.add(a-c,"d")}return c};Z.weekday=function(a){if(!this.isValid())return null!=a?this:NaN;var c=(this.day()+7-this.localeData()._week.dow)%7;return null==a?c:this.add(a-c,"d")};Z.isoWeekday=function(a){if(!this.isValid())return null!=a?this:NaN;if(null!=a){var c=this.localeData();a="string"===typeof a?c.weekdaysParse(a)%7||7:isNaN(a)?null:a;return this.day(this.day()%
7?a:a-7)}return this.day()||7};Z.dayOfYear=function(a){var c=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864E5)+1;return null==a?c:this.add(a-c,"d")};Z.hour=Z.hours=pc;Z.minute=Z.minutes=uc;Z.second=Z.seconds=vc;Z.millisecond=Z.milliseconds=wc;Z.utcOffset=function(a,c){var b=this._offset||0,d;if(!this.isValid())return null!=a?this:NaN;if(null!=a){if("string"===typeof a){if(a=ea(Vb,a),null===a)return this}else 16>Math.abs(a)&&(a*=60);!this._isUTC&&c&&(d=15*-Math.round(this._d.getTimezoneOffset()/
15));this._offset=a;this._isUTC=!0;null!=d&&this.add(d,"m");b!==a&&(!c||this._changeInProgress?pb(this,ba(a-b,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,h.updateOffset(this,!0),this._changeInProgress=null));return this}return this._isUTC?b:15*-Math.round(this._d.getTimezoneOffset()/15)};Z.utc=function(a){return this.utcOffset(0,a)};Z.local=function(a){this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(15*-Math.round(this._d.getTimezoneOffset()/15),"m"));return this};
Z.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm);else if("string"===typeof this._i){var a=ea(oc,this._i);null!=a?this.utcOffset(a):this.utcOffset(0,!0)}return this};Z.hasAlignedHourOffset=function(a){if(!this.isValid())return!1;a=a?qa(a).utcOffset():0;return 0===(this.utcOffset()-a)%60};Z.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()};Z.isLocal=function(){return this.isValid()?!this._isUTC:!1};Z.isUtcOffset=
function(){return this.isValid()?this._isUTC:!1};Z.isUtc=sa;Z.isUTC=sa;Z.zoneAbbr=function(){return this._isUTC?"UTC":""};Z.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""};Z.dates=A("dates accessor is deprecated. Use date instead.",ec);Z.months=A("months accessor is deprecated. Use month instead",la);Z.years=A("years accessor is deprecated. Use year instead",cc);Z.zone=A("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",
function(a,c){return null!=a?("string"!==typeof a&&(a=-a),this.utcOffset(a,c),this):-this.utcOffset()});Z.isDSTShifted=A("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!q(this._isDSTShifted))return this._isDSTShifted;var a={};t(a,this);a=Ca(a);if(a._a){var c=a._isUTC?g(a._a):qa(a._a);this._isDSTShifted=this.isValid()&&0<x(a._a,c.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var Fa=D.prototype;Fa.calendar=
function(a,c,b){a=this._calendar[a]||this._calendar.sameElse;return B(a)?a.call(c,b):a};Fa.longDateFormat=function(a){var c=this._longDateFormat[a],b=this._longDateFormat[a.toUpperCase()];if(c||!b)return c;this._longDateFormat[a]=b.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)});return this._longDateFormat[a]};Fa.invalidDate=function(){return this._invalidDate};Fa.ordinal=function(a){return this._ordinal.replace("%d",a)};Fa.preparse=Ab;Fa.postformat=Ab;Fa.relativeTime=function(a,c,b,d){var g=
this._relativeTime[b];return B(g)?g(a,c,b,d):g.replace(/%d/i,a)};Fa.pastFuture=function(a,c){var b=this._relativeTime[0<a?"future":"past"];return B(b)?b(c):b.replace(/%s/i,c)};Fa.set=function(a){var c,b;for(b in a)c=a[b],B(c)?this[b]=c:this["_"+b]=c;this._config=a;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)};Fa.months=function(a,c){return a?k(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||bc).test(c)?"format":"standalone"][a.month()]:
this._months};Fa.monthsShort=function(a,c){return a?k(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[bc.test(c)?"format":"standalone"][a.month()]:this._monthsShort};Fa.monthsParse=function(a,c,b){var d,e;if(this._monthsParseExact){a:{a=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],d=0;12>d;++d)e=g([2E3,d]),this._shortMonthsParse[d]=this.monthsShort(e,"").toLocaleLowerCase(),this._longMonthsParse[d]=this.months(e,
"").toLocaleLowerCase();if(b)c="MMM"===c?Pa.call(this._shortMonthsParse,a):Pa.call(this._longMonthsParse,a);else if("MMM"===c){c=Pa.call(this._shortMonthsParse,a);if(-1!==c)break a;c=Pa.call(this._longMonthsParse,a)}else{c=Pa.call(this._longMonthsParse,a);if(-1!==c)break a;c=Pa.call(this._shortMonthsParse,a)}c=-1!==c?c:null}return c}this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(d=0;12>d;d++)if(e=g([2E3,d]),b&&!this._longMonthsParse[d]&&(this._longMonthsParse[d]=
new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),b||this._monthsParse[d]||(e="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(e.replace(".",""),"i")),b&&"MMMM"===c&&this._longMonthsParse[d].test(a)||b&&"MMM"===c&&this._shortMonthsParse[d].test(a)||!b&&this._monthsParse[d].test(a))return d};Fa.monthsRegex=function(a){if(this._monthsParseExact)return l(this,"_monthsRegex")||
Aa.call(this),a?this._monthsStrictRegex:this._monthsRegex;l(this,"_monthsRegex")||(this._monthsRegex=Qb);return this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex};Fa.monthsShortRegex=function(a){if(this._monthsParseExact)return l(this,"_monthsRegex")||Aa.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex;l(this,"_monthsShortRegex")||(this._monthsShortRegex=Qb);return this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex};Fa.week=function(a){return ia(a,
this._week.dow,this._week.doy).week};Fa.firstDayOfYear=function(){return this._week.doy};Fa.firstDayOfWeek=function(){return this._week.dow};Fa.weekdays=function(a,c){return a?k(this._weekdays)?this._weekdays[a.day()]:this._weekdays[this._weekdays.isFormat.test(c)?"format":"standalone"][a.day()]:this._weekdays};Fa.weekdaysMin=function(a){return a?this._weekdaysMin[a.day()]:this._weekdaysMin};Fa.weekdaysShort=function(a){return a?this._weekdaysShort[a.day()]:this._weekdaysShort};Fa.weekdaysParse=function(a,
c,b){var d,e;if(this._weekdaysParseExact)return za.call(this,a,c,b);this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]);for(d=0;7>d;d++)if(e=g([2E3,1]).day(d),b&&!this._fullWeekdaysParse[d]&&(this._fullWeekdaysParse[d]=new RegExp("^"+this.weekdays(e,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[d]=new RegExp("^"+this.weekdaysShort(e,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[d]=new RegExp("^"+this.weekdaysMin(e,
"").replace(".",".?")+"$","i")),this._weekdaysParse[d]||(e="^"+this.weekdays(e,"")+"|^"+this.weekdaysShort(e,"")+"|^"+this.weekdaysMin(e,""),this._weekdaysParse[d]=new RegExp(e.replace(".",""),"i")),b&&"dddd"===c&&this._fullWeekdaysParse[d].test(a)||b&&"ddd"===c&&this._shortWeekdaysParse[d].test(a)||b&&"dd"===c&&this._minWeekdaysParse[d].test(a)||!b&&this._weekdaysParse[d].test(a))return d};Fa.weekdaysRegex=function(a){if(this._weekdaysParseExact)return l(this,"_weekdaysRegex")||Ba.call(this),a?this._weekdaysStrictRegex:
this._weekdaysRegex;l(this,"_weekdaysRegex")||(this._weekdaysRegex=Qb);return this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex};Fa.weekdaysShortRegex=function(a){if(this._weekdaysParseExact)return l(this,"_weekdaysRegex")||Ba.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;l(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Qb);return this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex};Fa.weekdaysMinRegex=function(a){if(this._weekdaysParseExact)return l(this,
"_weekdaysRegex")||Ba.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;l(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Qb);return this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex};Fa.isPM=function(a){return"p"===(a+"").toLowerCase().charAt(0)};Fa.meridiem=function(a,c,b){return 11<a?b?"pm":"PM":b?"am":"AM"};Da("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var c=a%10,c=1===w(a%100/10)?"th":1===c?"st":2===c?"nd":3===c?"rd":"th";
return a+c}});h.lang=A("moment.lang is deprecated. Use moment.locale instead.",Da);h.langData=A("moment.langData is deprecated. Use moment.localeData instead.",Ga);var ob=Math.abs,xc=Za("ms"),yc=Za("s"),zc=Za("m"),Ac=Za("h"),Bc=Za("d"),Cc=Za("w"),Dc=Za("M"),Ec=Za("y"),Fc=eb("milliseconds"),Gc=eb("seconds"),Hc=eb("minutes"),Ic=eb("hours"),Jc=eb("days"),Kc=eb("months"),Lc=eb("years"),tb=Math.round,ub={s:45,m:45,h:22,d:26,M:11},Zb=Math.abs,ya=Va.prototype;ya.abs=function(){var a=this._data;this._milliseconds=
ob(this._milliseconds);this._days=ob(this._days);this._months=ob(this._months);a.milliseconds=ob(a.milliseconds);a.seconds=ob(a.seconds);a.minutes=ob(a.minutes);a.hours=ob(a.hours);a.months=ob(a.months);a.years=ob(a.years);return this};ya.add=function(a,c){return Wa(this,a,c,1)};ya.subtract=function(a,c){return Wa(this,a,c,-1)};ya.as=function(a){var c,b=this._milliseconds;a=F(a);if("month"===a||"year"===a)return c=this._days+b/864E5,c=this._months+4800*c/146097,"month"===a?c:c/12;c=this._days+Math.round(146097*
this._months/4800);switch(a){case "week":return c/7+b/6048E5;case "day":return c+b/864E5;case "hour":return 24*c+b/36E5;case "minute":return 1440*c+b/6E4;case "second":return 86400*c+b/1E3;case "millisecond":return Math.floor(864E5*c)+b;default:throw Error("Unknown unit "+a);}};ya.asMilliseconds=xc;ya.asSeconds=yc;ya.asMinutes=zc;ya.asHours=Ac;ya.asDays=Bc;ya.asWeeks=Cc;ya.asMonths=Dc;ya.asYears=Ec;ya.valueOf=function(){return this._milliseconds+864E5*this._days+this._months%12*2592E6+31536E6*w(this._months/
12)};ya._bubble=function(){var a=this._milliseconds,c=this._days,b=this._months,d=this._data;0<=a&&0<=c&&0<=b||0>=a&&0>=c&&0>=b||(a+=864E5*Ob(146097*b/4800+c),b=c=0);d.milliseconds=a%1E3;a=u(a/1E3);d.seconds=a%60;a=u(a/60);d.minutes=a%60;a=u(a/60);d.hours=a%24;c+=u(a/24);a=u(4800*c/146097);b+=a;c-=Ob(146097*a/4800);a=u(b/12);d.days=c;d.months=b%12;d.years=a;return this};ya.get=function(a){a=F(a);return this[a+"s"]()};ya.milliseconds=Fc;ya.seconds=Gc;ya.minutes=Hc;ya.hours=Ic;ya.days=Jc;ya.weeks=function(){return u(this.days()/
7)};ya.months=Kc;ya.years=Lc;ya.humanize=function(a){var c=this.localeData(),b;b=!a;var d=ba(this).abs(),g=tb(d.as("s")),e=tb(d.as("m")),f=tb(d.as("h")),n=tb(d.as("d")),l=tb(d.as("M")),d=tb(d.as("y")),g=g<ub.s&&["s",g]||1>=e&&["m"]||e<ub.m&&["mm",e]||1>=f&&["h"]||f<ub.h&&["hh",f]||1>=n&&["d"]||n<ub.d&&["dd",n]||1>=l&&["M"]||l<ub.M&&["MM",l]||1>=d&&["y"]||["yy",d];g[2]=b;g[3]=0<+this;g[4]=c;b=Rb.apply(null,g);a&&(b=c.pastFuture(+this,b));return c.postformat(b)};ya.toISOString=fb;ya.toString=fb;ya.toJSON=
fb;ya.locale=jb;ya.localeData=zb;ya.toIsoString=A("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",fb);ya.lang=dc;H("X",0,0,"unix");H("x",0,0,"valueOf");Q("x",Ub);Q("X",/[+-]?\d+(\.\d{1,3})?/);T("X",function(a,c,b){b._d=new Date(1E3*parseFloat(a,10))});T("x",function(a,c,b){b._d=new Date(w(a))});h.version="2.17.1";vb=qa;h.fn=Z;h.min=function(){var a=[].slice.call(arguments,0);return na("isBefore",a)};h.max=function(){var a=[].slice.call(arguments,0);return na("isAfter",
a)};h.now=function(){return Date.now?Date.now():+new Date};h.utc=g;h.unix=function(a){return qa(1E3*a)};h.months=function(a,c){return hb(a,c,"months")};h.isDate=b;h.locale=Da;h.invalid=n;h.duration=ba;h.isMoment=v;h.weekdays=function(a,c,b){return Ya(a,c,b,"weekdays")};h.parseZone=function(){return qa.apply(null,arguments).parseZone()};h.localeData=Ga;h.isDuration=W;h.monthsShort=function(a,c){return hb(a,c,"monthsShort")};h.weekdaysMin=function(a,c,b){return Ya(a,c,b,"weekdaysMin")};h.defineLocale=
Ja;h.updateLocale=function(a,c){if(null!=c){var b;b=ac;null!=La[a]&&(b=La[a]._config);c=C(b,c);b=new D(c);b.parentLocale=La[a];La[a]=b;Da(a)}else null!=La[a]&&(null!=La[a].parentLocale?La[a]=La[a].parentLocale:null!=La[a]&&delete La[a]);return La[a]};h.locales=function(){return Mb(La)};h.weekdaysShort=function(a,c,b){return Ya(a,c,b,"weekdaysShort")};h.normalizeUnits=F;h.relativeTimeRounding=function(a){return void 0===a?tb:"function"===typeof a?(tb=a,!0):!1};h.relativeTimeThreshold=function(a,c){if(void 0===
ub[a])return!1;if(void 0===c)return ub[a];ub[a]=c;return!0};h.calendarFormat=function(a,c){var b=a.diff(c,"days",!0);return-6>b?"sameElse":-1>b?"lastWeek":0>b?"lastDay":1>b?"sameDay":2>b?"nextDay":7>b?"nextWeek":"sameElse"};h.prototype=Z;return h})},"esri/arcade/ImmutableArray":function(){define(["require","exports"],function(h,k){return function(){function a(a){void 0===a&&(a=[]);this._elements=a}return a.prototype.length=function(){return this._elements.length},a.prototype.get=function(a){return this._elements[a]},
a.prototype.toArray=function(){for(var a=[],b=0;b<this.length();b++)a.push(this.get(b));return a},a}()})},"esri/arcade/ImmutablePointArray":function(){define("require exports ../core/tsSupport/extendsHelper ./ImmutableArray ../geometry/Point ../kernel".split(" "),function(h,k,a,f,b,e){var l=0===e.version.indexOf("4.");return function(e){function g(a,c,b,g,f,l){a=e.call(this,a)||this;return a._lazyPt=[],a._hasZ=!1,a._hasM=!1,a._spRef=c,a._hasZ=b,a._hasM=g,a._cacheId=f,a._partId=l,a}return a(g,e),g.prototype.get=
function(a){if(void 0===this._lazyPt[a]){var c=this._elements[a];if(void 0===c)return;var d=this._hasZ,g=this._hasM,e=null,e=d&&!g?new b(c[0],c[1],c[2],void 0,this._spRef):g&&d?new b(c[0],c[1],void 0,c[2],this._spRef):d&&g?new b(c[0],c[1],c[2],c[3],this._spRef):new b(c[0],c[1],this._spRef);l?e.cache._arcadeCacheId=this._cacheId.toString()+"-"+this._partId.toString()+"-"+a.toString():e.setCacheValue("_arcadeCacheId",this._cacheId.toString()+"-"+this._partId.toString()+"-"+a.toString());this._lazyPt[a]=
e}return this._lazyPt[a]},g.prototype.equalityTest=function(a){return a===this?!0:null===a?!1:0==a instanceof g?!1:a.getUniqueHash()===this.getUniqueHash()},g.prototype.getUniqueHash=function(){return this._cacheId.toString()+"-"+this._partId.toString()},g}(f)})},"esri/core/tsSupport/extendsHelper":function(){define([],function(){return function(h,k){function a(){this.constructor=h}for(var f in k)k.hasOwnProperty(f)&&(h[f]=k[f]);h.prototype=null===k?Object.create(k):(a.prototype=k.prototype,new a)}})},
"esri/arcade/ImmutablePathArray":function(){define(["require","exports","../core/tsSupport/extendsHelper","./ImmutableArray","./ImmutablePointArray"],function(h,k,a,f,b){return function(e){function f(a,b,d,c,f){a=e.call(this,a)||this;return a._lazyPath=[],a._hasZ=!1,a._hasM=!1,a._hasZ=d,a._hasM=c,a._spRef=b,a._cacheId=f,a}return a(f,e),f.prototype.get=function(a){if(void 0===this._lazyPath[a]){var g=this._elements[a];if(void 0===g)return;this._lazyPath[a]=new b(g,this._spRef,this._hasZ,this._hasM,
this._cacheId,a)}return this._lazyPath[a]},f.prototype.equalityTest=function(a){return a===this?!0:null===a?!1:0==a instanceof f?!1:a.getUniqueHash()===this.getUniqueHash()},f.prototype.getUniqueHash=function(){return this._cacheId.toString()},f}(f)})},"esri/arcade/FunctionWrapper":function(){define(["require","exports"],function(h,k){return function(){return function(a,f){this.context=this.definition=null;this.definition=a;this.context=f}}()})},"esri/geometry/Rect":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),
function(h,k,a,f,b,e,l,m,g,d){function c(a){return new g(parseFloat(a.x),parseFloat(a.y)-parseFloat(a.height),parseFloat(a.x)+parseFloat(a.width),parseFloat(a.y),a.spatialReference)}var n=h(l,{declaredClass:"esri.geometry.Rect",constructor:function(a,c,b,g,e){k.mixin(this,f.defaultRect);k.isObject(a)&&"extent"===a.type&&(c=a.ymax,b=a.getWidth(),g=a.getHeight(),e=a.spatialReference,a=a.xmin);k.isObject(a)?(k.mixin(this,a),this.spatialReference&&(this.spatialReference=d.createSpatialReference(this.spatialReference))):
(this.x=a,this.y=c,this.width=b,this.height=g,this.spatialReference=e);this.verifySR()},getCenter:function(){return new m(this.x+this.width/2,this.y+this.height/2,this.spatialReference)},offset:function(a,c){return new n(this.x+a,this.y+c,this.width,this.height,this.spatialReference)},intersects:function(a){return a.x+a.width<=this.x?!1:a.y+a.height<=this.y?!1:a.y>=this.y+this.height?!1:a.x>=this.x+this.width?!1:!0},getExtent:function(){return c(this)},update:function(a,c,b,d,g){return this.x=a,this.y=
c,this.width=b,this.height=d,this.spatialReference=g,this.clearCache(),this}});return a("extend-esri")&&(k.setObject("geometry.Rect",n,b),b.geometry._rectToExtent=c,b.geometry._extentToRect=function(a){return new n(a)}),n})},"esri/geometry/scaleUtils":function(){define("dojo/_base/lang dojo/has ../kernel ../config ../lang ../WKIDUnitConversion".split(" "),function(h,k,a,f,b,e){function l(a,b,e){return a&&b?a.getWidth()/b*(e||d)*g*c.screenDPI:0}function m(a,b,e,f,l){var m;return m=l?e:n.values[n[e]],
a.expand(f*b/((m||d)*g*c.screenDPI)/a.getWidth())}var g=39.37,d=6370997*Math.PI/180,c=f.defaults,n=e,q={getUnitValueForSR:function(a){return this.getUnitValue(a)||d},getUnitValue:function(a){var c,b,d;(a&&("object"==typeof a?(c=a.wkid,b=a.wkt):"number"==typeof a?c=a:"string"==typeof a&&(b=a)),c)?d=n.values[n[c]]:b&&-1!==b.search(/^PROJCS/i)&&(a=/UNIT\[([^\]]+)\]\]$/i.exec(b))&&a[1]&&(d=parseFloat(a[1].split(",")[1]));return d},getScale:function(a,c,d){var g,e,f;return 1<arguments.length&&b.isDefined(c)&&
!c.declaredClass?(g=a,e=c,c=null,f=q.getUnitValue(d)):(g=c||a.extent,e=a.width,f=q.getUnitValue(g&&g.spatialReference)),l(g,e,f)},getExtentForScale:function(a,c,b){return m(b||a.extent,a.width,q.getUnitValue(a.spatialReference),c,!0)}};return k("extend-esri")&&(h.mixin(h.getObject("geometry",!0,a),q),a.geometry._getScale=l,a.geometry._getExtentForScale=m),q})},"esri/WKIDUnitConversion":function(){define(["dojo/has","./kernel"],function(h,k){var a,f={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,
.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5E4,15E4],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,
3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,
3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,
3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,
4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,
6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,
6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,
6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,
6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,
6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,
7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,
22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,
29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53034:0,53048:0,53049:0,54034:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,
102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,
103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,
103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,
103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103695:2};for(a=2E3;2045>=a;a++)f[a]=
0;for(a=2056;2065>=a;a++)f[a]=0;for(a=2067;2135>=a;a++)f[a]=0;for(a=2137;2154>=a;a++)f[a]=0;for(a=2161;2170>=a;a++)f[a]=0;for(a=2172;2193>=a;a++)f[a]=0;for(a=2195;2198>=a;a++)f[a]=0;for(a=2200;2203>=a;a++)f[a]=0;for(a=2205;2217>=a;a++)f[a]=0;for(a=2222;2224>=a;a++)f[a]=1;for(a=2225;2250>=a;a++)f[a]=2;for(a=2251;2253>=a;a++)f[a]=1;for(a=2257;2264>=a;a++)f[a]=2;for(a=2274;2279>=a;a++)f[a]=2;for(a=2280;2282>=a;a++)f[a]=1;for(a=2283;2289>=a;a++)f[a]=2;for(a=2290;2292>=a;a++)f[a]=0;for(a=2308;2313>=a;a++)f[a]=
0;for(a=2315;2491>=a;a++)f[a]=0;for(a=2494;2866>=a;a++)f[a]=0;for(a=2867;2869>=a;a++)f[a]=1;for(a=2870;2888>=a;a++)f[a]=2;for(a=2891;2895>=a;a++)f[a]=2;for(a=2896;2898>=a;a++)f[a]=1;for(a=2902;2908>=a;a++)f[a]=2;for(a=2915;2920>=a;a++)f[a]=2;for(a=2921;2923>=a;a++)f[a]=1;for(a=2924;2930>=a;a++)f[a]=2;for(a=2931;2962>=a;a++)f[a]=0;for(a=2964;2968>=a;a++)f[a]=2;for(a=2969;2973>=a;a++)f[a]=0;for(a=2975;2991>=a;a++)f[a]=0;for(a=2995;3051>=a;a++)f[a]=0;for(a=3054;3079>=a;a++)f[a]=0;for(a=3081;3088>=a;a++)f[a]=
0;for(a=3092;3101>=a;a++)f[a]=0;for(a=3106;3138>=a;a++)f[a]=0;for(a=3146;3151>=a;a++)f[a]=0;for(a=3153;3166>=a;a++)f[a]=0;for(a=3168;3172>=a;a++)f[a]=0;for(a=3174;3203>=a;a++)f[a]=0;for(a=3294;3358>=a;a++)f[a]=0;for(a=3367;3403>=a;a++)f[a]=0;for(a=3408;3416>=a;a++)f[a]=0;for(a=3417;3438>=a;a++)f[a]=2;for(a=3441;3446>=a;a++)f[a]=2;for(a=3447;3450>=a;a++)f[a]=0;for(a=3451;3459>=a;a++)f[a]=2;for(a=3460;3478>=a;a++)f[a]=0;for(a=3554;3559>=a;a++)f[a]=0;for(a=3560;3570>=a;a++)f[a]=2;for(a=3571;3581>=a;a++)f[a]=
0;for(a=3594;3597>=a;a++)f[a]=0;for(a=3601;3604>=a;a++)f[a]=0;for(a=3637;3639>=a;a++)f[a]=0;for(a=3665;3667>=a;a++)f[a]=0;for(a=3693;3695>=a;a++)f[a]=0;for(a=3701;3727>=a;a++)f[a]=0;for(a=3728;3739>=a;a++)f[a]=2;for(a=3740;3751>=a;a++)f[a]=0;for(a=3753;3760>=a;a++)f[a]=2;for(a=3761;3773>=a;a++)f[a]=0;for(a=3775;3777>=a;a++)f[a]=0;for(a=3779;3781>=a;a++)f[a]=0;for(a=3783;3785>=a;a++)f[a]=0;for(a=3788;3791>=a;a++)f[a]=0;for(a=3797;3802>=a;a++)f[a]=0;for(a=3814;3816>=a;a++)f[a]=0;for(a=3825;3829>=a;a++)f[a]=
0;for(a=3832;3841>=a;a++)f[a]=0;for(a=3844;3852>=a;a++)f[a]=0;for(a=3873;3885>=a;a++)f[a]=0;for(a=3890;3893>=a;a++)f[a]=0;for(a=3907;3912>=a;a++)f[a]=0;for(a=3942;3950>=a;a++)f[a]=0;for(a=3968;3970>=a;a++)f[a]=0;for(a=3973;3976>=a;a++)f[a]=0;for(a=3986;3989>=a;a++)f[a]=0;for(a=3994;3997>=a;a++)f[a]=0;for(a=4048;4051>=a;a++)f[a]=0;for(a=4056;4063>=a;a++)f[a]=0;for(a=4093;4096>=a;a++)f[a]=0;for(a=4390;4398>=a;a++)f[a]=0;for(a=4399;4413>=a;a++)f[a]=2;for(a=4418;4433>=a;a++)f[a]=2;for(a=4455;4457>=a;a++)f[a]=
2;for(a=4484;4489>=a;a++)f[a]=0;for(a=4491;4554>=a;a++)f[a]=0;for(a=4568;4589>=a;a++)f[a]=0;for(a=4652;4656>=a;a++)f[a]=0;for(a=4766;4800>=a;a++)f[a]=0;for(a=5014;5016>=a;a++)f[a]=0;for(a=5069;5072>=a;a++)f[a]=0;for(a=5105;5130>=a;a++)f[a]=0;for(a=5173;5188>=a;a++)f[a]=0;for(a=5253;5259>=a;a++)f[a]=0;for(a=5269;5275>=a;a++)f[a]=0;for(a=5292;5311>=a;a++)f[a]=0;for(a=5329;5331>=a;a++)f[a]=0;for(a=5343;5349>=a;a++)f[a]=0;for(a=5355;5357>=a;a++)f[a]=0;for(a=5387;5389>=a;a++)f[a]=0;for(a=5459;5463>=a;a++)f[a]=
0;for(a=5479;5482>=a;a++)f[a]=0;for(a=5518;5520>=a;a++)f[a]=0;for(a=5530;5539>=a;a++)f[a]=0;for(a=5550;5552>=a;a++)f[a]=0;for(a=5562;5583>=a;a++)f[a]=0;for(a=5623;5625>=a;a++)f[a]=2;for(a=5631;5639>=a;a++)f[a]=0;for(a=5649;5653>=a;a++)f[a]=0;for(a=5663;5680>=a;a++)f[a]=0;for(a=5682;5685>=a;a++)f[a]=0;for(a=5875;5877>=a;a++)f[a]=0;for(a=5921;5940>=a;a++)f[a]=0;for(a=6050;6125>=a;a++)f[a]=0;for(a=6244;6275>=a;a++)f[a]=0;for(a=6328;6348>=a;a++)f[a]=0;for(a=6350;6356>=a;a++)f[a]=0;for(a=6366;6372>=a;a++)f[a]=
0;for(a=6381;6387>=a;a++)f[a]=0;for(a=6393;6404>=a;a++)f[a]=0;for(a=6480;6483>=a;a++)f[a]=0;for(a=6511;6514>=a;a++)f[a]=0;for(a=6579;6581>=a;a++)f[a]=0;for(a=6619;6624>=a;a++)f[a]=0;for(a=6625;6627>=a;a++)f[a]=2;for(a=6628;6632>=a;a++)f[a]=0;for(a=6634;6637>=a;a++)f[a]=0;for(a=6669;6692>=a;a++)f[a]=0;for(a=6707;6709>=a;a++)f[a]=0;for(a=6720;6723>=a;a++)f[a]=0;for(a=6732;6738>=a;a++)f[a]=0;for(a=6931;6933>=a;a++)f[a]=0;for(a=6956;6959>=a;a++)f[a]=0;for(a=7005;7007>=a;a++)f[a]=0;for(a=7057;7070>=a;a++)f[a]=
2;for(a=7074;7082>=a;a++)f[a]=0;for(a=7109;7118>=a;a++)f[a]=0;for(a=7119;7127>=a;a++)f[a]=1;for(a=7374;7376>=a;a++)f[a]=0;for(a=7528;7586>=a;a++)f[a]=0;for(a=7587;7645>=a;a++)f[a]=2;for(a=7845;7859>=a;a++)f[a]=0;for(a=20002;20032>=a;a++)f[a]=0;for(a=20062;20092>=a;a++)f[a]=0;for(a=20135;20138>=a;a++)f[a]=0;for(a=20248;20258>=a;a++)f[a]=0;for(a=20348;20358>=a;a++)f[a]=0;for(a=20436;20440>=a;a++)f[a]=0;for(a=20822;20824>=a;a++)f[a]=0;for(a=20934;20936>=a;a++)f[a]=0;for(a=21035;21037>=a;a++)f[a]=0;for(a=
21095;21097>=a;a++)f[a]=0;for(a=21148;21150>=a;a++)f[a]=0;for(a=21413;21423>=a;a++)f[a]=0;for(a=21473;21483>=a;a++)f[a]=0;for(a=21780;21782>=a;a++)f[a]=0;for(a=21891;21894>=a;a++)f[a]=0;for(a=21896;21899>=a;a++)f[a]=0;for(a=22171;22177>=a;a++)f[a]=0;for(a=22181;22187>=a;a++)f[a]=0;for(a=22191;22197>=a;a++)f[a]=0;for(a=22234;22236>=a;a++)f[a]=0;for(a=22521;22525>=a;a++)f[a]=0;for(a=22991;22994>=a;a++)f[a]=0;for(a=23028;23038>=a;a++)f[a]=0;for(a=23830;23853>=a;a++)f[a]=0;for(a=23866;23872>=a;a++)f[a]=
0;for(a=23877;23884>=a;a++)f[a]=0;for(a=23886;23894>=a;a++)f[a]=0;for(a=23946;23948>=a;a++)f[a]=0;for(a=24311;24313>=a;a++)f[a]=0;for(a=24342;24347>=a;a++)f[a]=0;for(a=24370;24374>=a;a++)f[a]=10;for(a=24375;24381>=a;a++)f[a]=0;for(a=24718;24721>=a;a++)f[a]=0;for(a=24817;24821>=a;a++)f[a]=0;for(a=24877;24882>=a;a++)f[a]=0;for(a=24891;24893>=a;a++)f[a]=0;for(a=25391;25395>=a;a++)f[a]=0;for(a=25828;25838>=a;a++)f[a]=0;for(a=26191;26195>=a;a++)f[a]=0;for(a=26391;26393>=a;a++)f[a]=0;for(a=26701;26722>=
a;a++)f[a]=0;for(a=26729;26799>=a;a++)f[a]=2;for(a=26801;26803>=a;a++)f[a]=2;for(a=26811;26813>=a;a++)f[a]=2;for(a=26847;26870>=a;a++)f[a]=2;for(a=26891;26899>=a;a++)f[a]=0;for(a=26901;26923>=a;a++)f[a]=0;for(a=26929;26946>=a;a++)f[a]=0;for(a=26948;26998>=a;a++)f[a]=0;for(a=27037;27040>=a;a++)f[a]=0;for(a=27205;27232>=a;a++)f[a]=0;for(a=27258;27260>=a;a++)f[a]=0;for(a=27391;27398>=a;a++)f[a]=0;for(a=27561;27564>=a;a++)f[a]=0;for(a=27571;27574>=a;a++)f[a]=0;for(a=27581;27584>=a;a++)f[a]=0;for(a=27591;27594>=
a;a++)f[a]=0;for(a=28191;28193>=a;a++)f[a]=0;for(a=28348;28358>=a;a++)f[a]=0;for(a=28402;28432>=a;a++)f[a]=0;for(a=28462;28492>=a;a++)f[a]=0;for(a=29118;29122>=a;a++)f[a]=0;for(a=29168;29172>=a;a++)f[a]=0;for(a=29177;29185>=a;a++)f[a]=0;for(a=29187;29195>=a;a++)f[a]=0;for(a=29900;29903>=a;a++)f[a]=0;for(a=30161;30179>=a;a++)f[a]=0;for(a=30491;30494>=a;a++)f[a]=0;for(a=30729;30732>=a;a++)f[a]=0;for(a=31251;31259>=a;a++)f[a]=0;for(a=31265;31268>=a;a++)f[a]=0;for(a=31275;31279>=a;a++)f[a]=0;for(a=31281;31297>=
a;a++)f[a]=0;for(a=31461;31469>=a;a++)f[a]=0;for(a=31491;31495>=a;a++)f[a]=0;for(a=31917;31922>=a;a++)f[a]=0;for(a=31965;32E3>=a;a++)f[a]=0;for(a=32001;32003>=a;a++)f[a]=2;for(a=32005;32031>=a;a++)f[a]=2;for(a=32033;32060>=a;a++)f[a]=2;for(a=32064;32067>=a;a++)f[a]=2;for(a=32074;32077>=a;a++)f[a]=2;for(a=32081;32086>=a;a++)f[a]=0;for(a=32107;32130>=a;a++)f[a]=0;for(a=32133;32158>=a;a++)f[a]=0;for(a=32164;32167>=a;a++)f[a]=2;for(a=32180;32199>=a;a++)f[a]=0;for(a=32201;32260>=a;a++)f[a]=0;for(a=32301;32360>=
a;a++)f[a]=0;for(a=32601;32662>=a;a++)f[a]=0;for(a=32664;32667>=a;a++)f[a]=2;for(a=32701;32761>=a;a++)f[a]=0;for(a=53001;53004>=a;a++)f[a]=0;for(a=53008;53019>=a;a++)f[a]=0;for(a=53021;53032>=a;a++)f[a]=0;for(a=53042;53046>=a;a++)f[a]=0;for(a=53074;53080>=a;a++)f[a]=0;for(a=54001;54004>=a;a++)f[a]=0;for(a=54008;54019>=a;a++)f[a]=0;for(a=54021;54032>=a;a++)f[a]=0;for(a=54042;54046>=a;a++)f[a]=0;for(a=54048;54053>=a;a++)f[a]=0;for(a=54074;54080>=a;a++)f[a]=0;for(a=102001;102040>=a;a++)f[a]=0;for(a=
102042;102063>=a;a++)f[a]=0;for(a=102065;102067>=a;a++)f[a]=0;for(a=102070;102117>=a;a++)f[a]=0;for(a=102122;102216>=a;a++)f[a]=0;for(a=102221;102377>=a;a++)f[a]=0;for(a=102382;102388>=a;a++)f[a]=0;for(a=102389;102398>=a;a++)f[a]=2;for(a=102399;102444>=a;a++)f[a]=0;for(a=102445;102447>=a;a++)f[a]=2;for(a=102448;102458>=a;a++)f[a]=0;for(a=102459;102468>=a;a++)f[a]=2;for(a=102469;102496>=a;a++)f[a]=0;for(a=102500;102519>=a;a++)f[a]=1;for(a=102520;102524>=a;a++)f[a]=0;for(a=102525;102529>=a;a++)f[a]=
2;for(a=102530;102561>=a;a++)f[a]=0;for(a=102570;102588>=a;a++)f[a]=0;for(a=102590;102598>=a;a++)f[a]=0;for(a=102601;102603>=a;a++)f[a]=0;for(a=102605;102628>=a;a++)f[a]=0;for(a=102629;102646>=a;a++)f[a]=2;for(a=102648;102700>=a;a++)f[a]=2;for(a=102701;102703>=a;a++)f[a]=0;for(a=102707;102730>=a;a++)f[a]=2;for(a=102733;102758>=a;a++)f[a]=2;for(a=102767;102798>=a;a++)f[a]=0;for(a=102965;102969>=a;a++)f[a]=0;for(a=102971;102973>=a;a++)f[a]=0;for(a=102975;102989>=a;a++)f[a]=0;for(a=102990;102992>=a;a++)f[a]=
1;for(a=102997;103002>=a;a++)f[a]=0;for(a=103003;103008>=a;a++)f[a]=2;for(a=103009;103011>=a;a++)f[a]=0;for(a=103012;103014>=a;a++)f[a]=2;for(a=103019;103021>=a;a++)f[a]=0;for(a=103022;103024>=a;a++)f[a]=2;for(a=103029;103031>=a;a++)f[a]=0;for(a=103032;103034>=a;a++)f[a]=2;for(a=103065;103068>=a;a++)f[a]=0;for(a=103074;103076>=a;a++)f[a]=0;for(a=103077;103079>=a;a++)f[a]=1;for(a=103080;103082>=a;a++)f[a]=0;for(a=103083;103085>=a;a++)f[a]=2;for(a=103090;103093>=a;a++)f[a]=0;for(a=103097;103099>=a;a++)f[a]=
0;for(a=103100;103102>=a;a++)f[a]=2;for(a=103107;103109>=a;a++)f[a]=0;for(a=103110;103112>=a;a++)f[a]=2;for(a=103113;103116>=a;a++)f[a]=0;for(a=103117;103120>=a;a++)f[a]=2;for(a=103153;103157>=a;a++)f[a]=0;for(a=103158;103162>=a;a++)f[a]=2;for(a=103163;103165>=a;a++)f[a]=0;for(a=103166;103168>=a;a++)f[a]=1;for(a=103169;103171>=a;a++)f[a]=2;for(a=103186;103188>=a;a++)f[a]=0;for(a=103189;103191>=a;a++)f[a]=2;for(a=103192;103195>=a;a++)f[a]=0;for(a=103196;103199>=a;a++)f[a]=2;for(a=103200;103224>=a;a++)f[a]=
0;for(a=103225;103227>=a;a++)f[a]=1;for(a=103232;103237>=a;a++)f[a]=0;for(a=103238;103243>=a;a++)f[a]=2;for(a=103244;103246>=a;a++)f[a]=0;for(a=103247;103249>=a;a++)f[a]=2;for(a=103254;103256>=a;a++)f[a]=0;for(a=103257;103259>=a;a++)f[a]=2;for(a=103264;103266>=a;a++)f[a]=0;for(a=103267;103269>=a;a++)f[a]=2;for(a=103300;103375>=a;a++)f[a]=0;for(a=103381;103383>=a;a++)f[a]=0;for(a=103384;103386>=a;a++)f[a]=1;for(a=103387;103389>=a;a++)f[a]=0;for(a=103390;103392>=a;a++)f[a]=2;for(a=103397;103399>=a;a++)f[a]=
0;for(a=103400;103471>=a;a++)f[a]=2;for(a=103476;103478>=a;a++)f[a]=0;for(a=103479;103481>=a;a++)f[a]=2;for(a=103486;103488>=a;a++)f[a]=0;for(a=103489;103491>=a;a++)f[a]=2;for(a=103492;103495>=a;a++)f[a]=0;for(a=103496;103499>=a;a++)f[a]=2;for(a=103528;103543>=a;a++)f[a]=0;for(a=103544;103548>=a;a++)f[a]=2;for(a=103549;103551>=a;a++)f[a]=0;for(a=103552;103554>=a;a++)f[a]=1;for(a=103555;103557>=a;a++)f[a]=2;for(a=103558;103560>=a;a++)f[a]=0;for(a=103571;103573>=a;a++)f[a]=0;for(a=103574;103576>=a;a++)f[a]=
2;for(a=103577;103580>=a;a++)f[a]=0;for(a=103581;103583>=a;a++)f[a]=2;for(a=103600;103694>=a;a++)f[a]=0;for(a=103700;103793>=a;a++)f[a]=2;for(a=103794;103871>=a;a++)f[a]=0;for(a=103900;103971>=a;a++)f[a]=2;return h("extend-esri")&&(k.WKIDUnitConversion=f),f})},"esri/geometry/screenUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/sniff ../kernel ./Point ./ScreenPoint ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(h,k,a,f,b,e,l,m,g,d){var c=function(){return 9>a("ie")?
function(a,c,b,d,g,e,f,n,l){var m,q,u,r,h,t,v,k=[],w=Math.round,x=f.length;for(m=0;x>m;m++)if(q=f[m],h=n?n(q[0][0],q[0][1],l):q[0],1<(r=q.length))for(t=w((h[0]-a)*b+g),v=w((c-h[1])*d+e),h=n?n(q[1][0],q[1][1],l):q[1],u=w((h[0]-a)*b+g),h=w((c-h[1])*d+e),k.push("M",t+","+v,"L",u+","+h),u=2;r>u;u++)h=n?n(q[u][0],q[u][1],l):q[u],t=w((h[0]-a)*b+g),v=w((c-h[1])*d+e),k.push(t+","+v);else t=w((h[0]-a)*b+g),v=w((c-h[1])*d+e),k.push("M",t+","+v);return k}:function(a,c,b,d,g,e,f,n,l,m){var q,u,r,h,t,v,k=[],w=
Math.round;q=0;for(r=f?f.length:0;r>q;q++){t=f[q];k.push("M");u=0;for(h=t?t.length:0;h>u;u++)v=n?n(t[u][0],t[u][1],l):t[u],k.push(w((v[0]-a)*b+g)+","+w((c-v[1])*d+e));m||k.push("Z")}return k}}(),n={toScreenPoint:function(a,c,d,g,f){var n,l=a.spatialReference,m=g.spatialReference,q=g.x;g=g.y;return l&&m&&!l.equals(m)&&l._canProject(m)&&(n=l.isWebMercator()?b.lngLatToXY(q,g):b.xyToLngLat(q,g,!0),q=n[0],g=n[1]),q=(q-a.xmin)*(c/a.getWidth()),g=(a.ymax-g)*(d/a.getHeight()),f||(q=Math.round(q),g=Math.round(g)),
new e(q,g)},toScreenGeometry:function(a,c,e,f){var n=a.xmin,q=a.ymax,r=c/a.getWidth(),t=e/a.getHeight(),v=h.forEach,k=Math.round;if(f instanceof b)return new b(k((f.x-n)*r),k((q-f.y)*t));if(f instanceof g){a=new g;var B=a.points;return v(f.points,function(a,c){B[c]=[k((a[0]-n)*r),k((q-a[1])*t)]}),a}if(f instanceof d)return new d(k((f.xmin-n)*r),k((q-f.ymin)*t),k((f.xmax-n)*r),k((q-f.ymax)*r));if(f instanceof l){var C;a=new l;var D=a.paths;return v(f.paths,function(a,c){C=D[c]=[];v(a,function(a,c){C[c]=
[k((a[0]-n)*r),k((q-a[1])*t)]})}),a}if(f instanceof m){var E;a=new m;var F=a.rings;return v(f.rings,function(a,c){E=F[c]=[];v(a,function(a,c){E[c]=[k((a[0]-n)*r),k((q-a[1])*t)]})}),a}},_toScreenPath:function(a,d,g,e,f,n){var m,q,u=e instanceof l,r=a.spatialReference,h=e.spatialReference;return r&&h&&!r.equals(h)&&r._canProject(h)&&(r.isWebMercator()?m=b.lngLatToXY:(m=b.xyToLngLat,q=!0)),c(a.xmin,a.ymax,d/a.getWidth(),g/a.getHeight(),f,n,u?e.paths:e.rings,m,q,u)},toMapPoint:function(a,c,d,g){return new b(a.xmin+
g.x/(c/a.getWidth()),a.ymax-g.y/(d/a.getHeight()),a.spatialReference)},toMapGeometry:function(a,c,e,f){var n=a.xmin,q=a.ymax,r=a.spatialReference,t=c/a.getWidth(),v=e/a.getHeight(),k=h.forEach;if(f instanceof b)return new b(n+f.x/t,q-f.y/v,r);if(f instanceof g){a=new g(r);var B=a.points;return k(f.points,function(a,c){B[c]=[n+a[0]/t,q-a[1]/v]}),a}if(f instanceof d)return new d(n+f.xmin/t,q-f.ymin/v,n+f.xmax/t,q-f.ymax/v,r);if(f instanceof l){var C;a=new l(r);var D=a.paths;return k(f.paths,function(a,
c){C=D[c]=[];k(a,function(a,c){C[c]=[n+a[0]/t,q-a[1]/v]})}),a}if(f instanceof m){var E;a=new m(r);var F=a.rings;return k(f.rings,function(a,c){E=F[c]=[];k(a,function(a,c){E[c]=[n+a[0]/t,q-a[1]/v]})}),a}}};return a("extend-esri")&&k.mixin(k.getObject("geometry",!0,f),n),n})},"esri/layers/GraphicsLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom dojox/gfx dojox/gfx/matrix ./gfxSniff!esri-svg?dojox/gfx/filters ./layer ../kernel ../lang ../sniff ../Color ../domUtils ../symbols/MarkerSymbol ../symbols/SimpleMarkerSymbol ../geometry/Point ../geometry/ScreenPoint ../geometry/Extent ../geometry/mathUtils ../geometry/screenUtils ../PluginTarget ./gfxSniff!esri-svg?dojox/gfx/svgext".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D){var E,F=-1!==g.renderer.toLowerCase().indexOf("svg"),G=-1!==g.renderer.toLowerCase().indexOf("canvas"),I=9>r("ie"),J=r("esri-touch");w=h(null,{declaredClass:"esri.layers._GraphicsContainer",_setMap:function(a,c){var b,d=this._connects=[];(this._map=a,this._useWillChange="css-transforms"===a.navigationMode&&F&&r("esri-will-change"),G)?(b=e.create("div",{style:"overflow: visible; position: absolute;"},c),this._surface={getEventSource:function(){return b}},
d.push(k.connect(b,"onmousedown",this,this._canvasDownHandler)),d.push(k.connect(b,"onmouseup",this,this._canvasUpHandler)),d.push(k.connect(b,"onclick",this,this._canvasClickHandler)),E.prototype._canvas=!0):(b=(this._surface=g.createSurface(c,a.width,a.height)).getEventSource(),this._useWillChange&&l.set(b,"will-change","transform"),l.set(b=I?b.parentNode:b,{overflow:"visible",position:"absolute"}));return d.push(k.connect(a,"onResize",this,"_onResizeHandler")),this._useWillChange&&(d.push(k.connect(a,
"onPan",this,"_onPanHandler")),d.push(k.connect(a,"onPanEnd",this,"_onPanEndHandler")),d.push(k.connect(a,"onExtentChange",this,"_onExtentChangeHandler"))),b},_onPanHandler:function(a,c){var b=this._map.__visibleRect,d=b.x+c.x,b=b.y+c.y;this._panDx=d;this._panDy=b;l.set(this._surface.getEventSource(),q._css.names.transform,q._css.translate(d,b))},_onPanEndHandler:function(a,c){var b=this._map.__visibleRect,d=b.x,b=b.y;this._panDx=d;this._panDy=b;l.set(this._surface.getEventSource(),q._css.names.transform,
q._css.translate(d,b))},_onExtentChangeHandler:function(a,c,b,d){b&&(this._panDy=this._panDx=0,l.set(this._surface.getEventSource(),q._css.names.transform,q._css.translate(0,0)))},_getTransform:function(){return{dx:this._panDx||0,dy:this._panDy||0}},_onResizeHandler:function(a,c,d){var g;a=this._surface.getEventSource();var e=this._map;I&&l.set(a=a.parentNode,{width:c+"px",height:d+"px",clip:"rect(0px "+c+"px "+d+"px 0px)"});b.set(a,"width",c);b.set(a,"height",d);this._surface.declaredClass||f.forEach(a.childNodes,
function(a){b.set(a,"width",c);b.set(a,"height",d)});e.loaded&&(e.graphics.suspended||(e.graphics._resized=!0),f.forEach(e.graphicsLayerIds,function(a){g=e.getLayer(a);g.suspended||(g._resized=!0,g._childLayer&&(g._childLayer._resized=!0));g._updateSVGFilters(null,null,c,d)}))},_cleanUp:function(){f.forEach(this._connects,k.disconnect,k);this._map=this._surface=null},_processEvent:function(a){var c=this._map;a.screenPoint=new A(a.pageX-c.position.x,a.pageY-c.position.y);a.mapPoint=c.toMap(a.screenPoint)},
_canvasDownHandler:function(a){this._processEvent(a);this._downPt=a.screenPoint.x+","+a.screenPoint.y},_canvasUpHandler:function(a){this._processEvent(a);this._upPt=a.screenPoint.x+","+a.screenPoint.y},_tolerance:15,_isPrimaryMatch:function(a,c,b,d){if(!a.visible||!c)return!1;var g,e=c.getTransformedBoundingBox();return e?(g=new z(e[0].x,e[0].y,e[2].x,e[2].y),delete g.spatialReference,J?g.intersects(b):g.contains(d)):f.some(c.children||[],function(a){return e=a.getTransformedBoundingBox(),g=new z(e[0].x,
e[0].y,e[2].x,e[2].y),delete g.spatialReference,J?g.intersects(b):g.contains(d)})},_canvasClickHandler:function(a){if(this._downPt&&this._upPt&&this._downPt===this._upPt){this._processEvent(a);var c=this._map,b=f.map(c.graphicsLayerIds,function(a){return c.getLayer(a)});b.push(c.graphics);b.reverse();var b=f.filter(b,function(a){return a.loaded&&a._mouseEvents&&!a.suspended&&(!t.isDefined(a.opacity)||0<a.opacity)}),d,g=a.screenPoint,e=this._tolerance,n=g.x-e,l=g.y+e,m=g.x+e,e=g.y-e,q=new z(n,e,m,
l),n=c.toMap(new A(n,l)),m=c.toMap(new A(m,e)),l=n.spatialReference._getInfo(),u=new z(z.prototype._normalizeX(n.x,l).x,n.y,z.prototype._normalizeX(m.x,l).x,m.y,n.spatialReference);(delete q.spatialReference,f.some(b,function(a){a=f.filter(a.graphics,function(a){return this._isPrimaryMatch(a,a.getDojoShape(),q,g)||!(!a._bgShape||!this._isPrimaryMatch(a,a._bgShape,q,g))},this);if(a.reverse(),0<a.length){var c;if(f.some(a,function(a){return a.geometry&&u.intersects(a.geometry)?(c=a,!0):!1}),c)return d=
c,!0}return!1},this),d)&&(b=d.getLayer())&&(a.graphic=d,b.onClick(a))}}});E=h(n,{declaredClass:"esri.layers._GraphicsLayer",managedSuspension:!0,surfaceType:G?"canvas-2d":g.renderer,_eventMap:{"graphic-add":["graphic"],"graphic-remove":["graphic"],"renderer-change":["renderer"]},constructor:function(c,b){c&&(a.isString(c)||a.isObject(c)&&(c.layerDefinition||c.query))&&(c=b);this._params=a.mixin({displayOnPan:!0,drawMode:!0,styling:!0},c||{});var d=this._params.dataAttributes;"string"==typeof d&&(d=
[d]);this.styling=F?this._params.styling:!0;this.dataAttributes=d;this.infoTemplate=c&&c.infoTemplate;this.graphics=[];this._draw=a.hitch(this,this._draw);this._refresh=a.hitch(this,this._refresh);this.registerConnectEvents()},getNode:function(){return this._div&&this._div.getEventSource()},setDrawMode:function(a){this._params.drawMode=a},renderer:null,_setMap:function(c,b){return this.inherited(arguments),this._map=c,this._wrap=c.wrapAround180,this._srInfo=c.spatialReference._getInfo(),this._svgFilters=
{},this._canvas?(b=g.createSurface(b.getEventSource(),c.width,c.height),l.set(b.rawNode,"position","absolute"),this._div=b.createGroup(),this._renderProto=this._div.constructor.prototype._render,this._div._render=a.hitch(this,this._canvasRender)):this._div=b.createGroup(),this._bgGroup=this._div.createGroup(),this._div.getEventSource().id=this.id+"_layer",this._initOpacity(),this._div},_unsetMap:function(a,c){f.forEach(this.graphics,function(a){a._shape=null});this._canvas?(c=this._div.getParent(),
c._parent={},e.destroy(c.rawNode),c.destroy()):(this._div.clear(),c.remove(this._div),e.destroy(this._div.getEventSource()));this._map=this._div=this._svgFilters=null;clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();this.inherited(arguments)},_initOpacity:function(){var a=this.opacity;t.isDefined(a)&&1>a&&this.setOpacity(a,!0)},_onZoomStartHandler:function(){u.hide(this._div.getEventSource())},_onExtentChangeHandler:function(a,c,b,d){(clearTimeout(this._wakeTimer),
this._wakeTimer=null,b)?(a=this._map.__visibleRect,c=this._div,this._evalSDRenderer(),this._refresh(!0),this._updateTransform(c,a.x,a.y,!0),this._renderProto&&c.surface.pendingRender?this._dirty=!0:this.suspended||u.show(c.getEventSource())):this._resized&&(this._resized=!1,this._refresh(!1));0<this.graphics.length&&this.onUpdate()},_canvasRender:function(){var a=this._div;return this._dirty&&(delete this._dirty,this.suspended||u.show(a.getEventSource())),this._renderProto.apply(a,arguments)},_refresh:function(a){var c,
b=this.graphics,d=b.length,g=this._draw;for(c=0;d>c;c++)g(b[c],a)},refresh:function(){this._refresh(!0)},redraw:function(){this._refresh(!0)},_getTransform:function(){var a={dx:0,dy:0};return this._map&&(this._map._gc._useWillChange?a=this._map._gc._getTransform():this._div&&(a=this._div.getTransform())),a},_onPanHandler:function(a,c){this._panDx=c.x;this._panDy=c.y;var b=this._map.__visibleRect;this._updateTransform(this._div,b.x+c.x,b.y+c.y)},_onPanEndUpdateHandler:function(a,c){var b=this._map.__visibleRect;
this._params._child||c.x===this._panDx&&c.y===this._panDy?this._updateSVGFilters(-b.x,-b.y):this._updateTransform(this._div,b.x,b.y,!0);this._refresh(!1);this.graphics.length&&this.onUpdate()},_onPanStartHandler:function(){u.hide(this._div.getEventSource())},_onPanEndHandler:function(){var a=this._map.__visibleRect,c=this._div;this._updateTransform(c,a.x,a.y,!0);this._refresh(!1);this._renderProto&&c.surface.pendingRender?this._dirty=!0:u.show(c.getEventSource());this.graphics.length&&this.onUpdate()},
_updateTransform:function(a,c,b,g){this._map._gc._useWillChange||a.setTransform(d.translate({x:c,y:b}));g&&this._updateSVGFilters(-c,-b)},onSuspend:function(){this.inherited(arguments);u.hide(this._div.getEventSource());clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(c){this.inherited(arguments);c.firstOccurrence&&this._evalSDRenderer();this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(a.hitch(this,function(){this.suspended||
this._map.__zooming||this._onExtentChangeHandler(null,null,!0)}),0)},_enableDrawConnectors:function(){var a=this._map,c=k.connect;this._disableDrawConnectors();this._params.displayOnPan?(this._params._child||(this._onPanHandler_connect=c(a,"onPan",this,"_onPanHandler")),this._onPanEndHandler_connect=c(a,"onPanEnd",this,"_onPanEndUpdateHandler")):(this._onPanStartHandler_connect=c(a,"onPanStart",this,"_onPanStartHandler"),this._onPanEndHandler_connect=c(a,"onPanEnd",this,"_onPanEndHandler"));this._onZoomStartHandler_connect=
c(a,"onZoomStart",this,"_onZoomStartHandler");this._onExtentChangeHandler_connect=c(a,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=k.disconnect;a(this._onExtentChangeHandler_connect);a(this._onZoomStartHandler_connect);a(this._onPanHandler_connect);a(this._onPanStartHandler_connect);a(this._onPanEndHandler_connect);this._onExtentChangeHandler_connect=this._onZoomStartHandler_connect=this._onPanHandler_connect=this._onPanStartHandler_connect=this._onPanEndHandler_connect=
null},_updateExtent:function(a){var c=a.geometry;if(!c)return void(a._extent=null);if(!(a._extent=c.getExtent())){var b,d;if("esri.geometry.Point"===c.declaredClass)b=c.x,d=c.y;else{if("esri.geometry.Multipoint"!==c.declaredClass)return void(a._extent=null);b=c.points[0][0];d=c.points[0][1]}a._extent=new z(b,d,b,d,c.spatialReference)}},_intersects:function(a,c,b){var d=a.spatialReference,g=c.spatialReference,e=d&&g&&!d.equals(g)&&d._canProject(g)&&4326===g.wkid;if(this._wrap&&!b){var n,l,m,q,u,r;
b=[];d=a._getFrameWidth();n=this._srInfo;m=a._clip?a._getAvailExtent():a.extent;var h=[];l=c._partwise;if(e&&(m=a.geographicExtent,n=g._getInfo()),a=m._getParts(n),l&&l.length)for(c=[],g=0,e=l.length;e>g;g++)c=c.concat(l[g]._getParts(n));else c=c._getParts(n);g=0;for(e=c.length;e>g;g++)for(u=c[g],n=0,m=a.length;m>n;n++)if(r=a[n],r.extent.intersects(u.extent))for(l=0,q=u.frameIds.length;q>l;l++)b.push((r.frameIds[0]-u.frameIds[l])*d);g=0;for(e=b.length;e>g;g++)l=b[g],f.indexOf(b,l)===g&&h.push(l);
return h.length?h:null}return(e?a.geographicExtent:a.extent).intersects(c)?[0]:null},_defaultMarker:{type:"simplemarkersymbol",style:"square",size:1,xoffset:0,yoffset:0,angle:0},_draw:function(a,c){if(this._params.drawMode&&this._map&&!this.suspended&&!this._map.__zooming&&!this._resized)try{var b,d,g,e=a._extent,f=!F||this.styling,n=F&&this.dataAttributes,l=a.getDojoShape();if(a.visible&&e&&(b=this._intersects(this._map,e,a.geometry._originOnly))&&(d=f?this._getSymbol(a):this._defaultMarker)){if(a._offsets&&
a._offsets.join(",")===b.join(",")?g=!0:a._offsets=b,!l||c||!g){var m=a.geometry.type;g={graphic:a};var q=a._bgShape,u=f&&!a.symbol?this._getRenderer(a):null,r=u&&u.backgroundFillSymbol;if("point"===m)this._isInvalidShape(d,l)&&this._removeShape(a),a._shape=this._drawPoint(this._div,a.geometry,d,a.getDojoShape(),b,u,a),f&&this._symbolizePoint(a.getDojoShape(),d,u,a);else if("multipoint"===m)this._drawMarkers(a,d,b,u),f&&this._symbolizeMarkers(a,d,u);else{var h,t,v,k,m=d;if(f&&(h="simplemarkersymbol"===
d.type||"picturemarkersymbol"===d.type||"textsymbol"===d.type?d:null,m=h?r:d),f&&m&&-1<m.type.indexOf("fillsymbol")&&(t=this._bgGroup,k=!(!t||!h)),q&&!k&&this._removeBgShape(a),m&&(!k&&this._isInvalidShape(m,a._shape)&&this._removeShape(a,!1),v=this._drawShape(a,b,t||this._div,k?q:a.getDojoShape()),f&&this._symbolizeShape(v,m,u,m===r,a),a[k?"_bgShape":"_shape"]=v),h){this._isInvalidShape(h,a._shape)&&this._removeShape(a,!1);var w=a.geometry.getCentroid();(v=w&&this._drawPoint(this._div,w,h,a._shape,
b,u,a))&&this._symbolizePoint(v,h,u,a);a._shape=v}}G||(a._bgShape&&this._initNode(a,a._bgShape,a._bgShape!==q,g,n),a._shape&&this._initNode(a,a._shape,a._shape!==l,g,n));g.node=a.getNode();this.onGraphicDraw(g)}}else l&&this._removeShape(a)}catch(pa){this._errorHandler(pa,a)}},_initNode:function(a,c,b,d,g){(c=c&&c.getNode())&&(c.e_graphic=a,this._addDataAttrs(a,g,c),b&&(d.node=c,this.onGraphicNodeAdd(d)))},_removeShape:function(a,c,b){var d=a.getDojoShape(),g=d&&d.getNode();d&&!b&&(d.removeShape(),
d.destroy());a._shape=a._offsets=null;!1!==c&&this._removeBgShape(a,b);g&&(g.e_graphic=null,G||this.onGraphicNodeRemove({graphic:a,node:g}))},_removeBgShape:function(a,c){var b=a._bgShape,d=b&&b.getNode();b&&!c&&(b.removeShape(),b.destroy());a._bgShape=null;d&&(d.e_graphic=null,G||this.onGraphicNodeRemove({graphic:a,node:d}))},_addDataAttrs:function(a,c,b){var d,g,e=a.attributes,f=c?c.length:0,n=this._getRenderer(a);if(b&&e){for(d=0;f>d;d++)(b=c[d])&&a.attr("data-"+b,e[b]);!this.styling&&n&&(n.getBreakIndex?
(g=n.getBreakIndex(a),a.attr("data-class-break",-1!==g?g:null)):n.getUniqueValueInfo&&(g=n.getUniqueValueInfo(a),a.attr("data-unique-value",g?g.value:null)))}},_drawShape:function(a,c,b,d){var g,e,f,n;a=a.geometry;n=a.type;var l=this._map,m=l.extent,q=l.width,u=l.height,l=l.__visibleRect;f=[];g="extent"===n;if("rect"===n||g)f={x:0,y:0,spatialReference:a.spatialReference},f.x=g?a.xmin:a.x,f.y=g?a.ymax:a.y,n=C.toScreenPoint(m,q,u,f),f.x=g?a.xmax:a.x+a.width,f.y=g?a.ymin:a.y+a.height,a=C.toScreenPoint(m,
q,u,f),c={x:n.x-l.x+c[0],y:n.y-l.y,width:Math.abs(a.x-n.x),height:Math.abs(a.y-n.y)},0===c.width&&(c.width=1),0===c.height&&(c.height=1),d=this._drawRect(b,d,c);else if("polyline"===n||"polygon"===n){g=0;for(e=c.length;e>g;g++)f=f.concat(C._toScreenPath(m,q,u,a,-l.x+c[g],-l.y));d=this._drawPath(b,d,f);this._rendererLimits&&("polyline"===n?this._clipPolyline(d,a):this._clipPolygon(d,a))}return d},_drawRect:function(a,c,b){return c?c.setShape(b):a.createRect(b)},_drawImage:function(a,c,b){return c?
c.setShape(b):a.createImage(b)},_drawCircle:function(a,c,b){return c?c.setShape(b):a.createCircle(b)},_drawPath:function(){return I?function(a,c,b,d){if(b=d?b:b.join(" "),c)return c.setShape(b);c=a.createObject(d?g.Path:g.EsriPath,b);return a._overrideSize(c.getEventSource()),c}:function(a,c,b,d){return b=d?b:b.join(" "),c?c.setShape(b):a.createPath(b)}}(),_drawText:function(a,c,b){return c?c.setShape(b):a.createText(b)},_evalSDRenderer:function(a){var c,b=this._map,d=this.renderer,g=this._rndForScale;
b&&b.loaded&&d&&d.getRendererInfo&&(c="zoom"===d.rangeType?d.getRendererInfoByZoom(b.getZoom()):d.getRendererInfoByScale(b.getScale()));this._rndForScale=c&&c.renderer;(c=this._getRenderer())&&c.prepareForViewChange();a||this._rndForScale==g||this.emit("renderer-change",{renderer:this._rndForScale})},_getRenderer:function(a){var c=this._rndForScale||this.renderer;return a&&c&&c.getObservationRenderer&&(c=c.getObservationRenderer(a)),c},_getSymbol:function(a){var c=this._getRenderer();return a.symbol||
c&&c.getSymbol(a)},_getVariable:function(a,c,b){var d,g;return a&&(d=a.getVisualVariablesForType(c,b),g=d&&d[0]),g},_applyOpacity:function(a,c,b,d){c=c.getOpacity(d,{opacityInfo:b});return null!=c&&(a=new v(a),a.a=c),a},_symbolizeShape:function(c,b,d,g,e){var f,n,l=b.getStroke(),m=b.getFill(),q=b.type,u=-1!==q.indexOf("linesymbol"),r=-1!==q.indexOf("fillsymbol")?null:this._getVariable(d,"sizeInfo",!1),h=this._getVariable(d,"colorInfo",!1),t=this._getVariable(d,"opacityInfo",!1);b=u?"none"!==b.style:
b.outline&&"none"!==b.outline.style;var v=u?null:this._getVariable(d,"sizeInfo","outline"),r=(r=g?v:v||r)?d.getSize(e,{sizeInfo:r,resolution:this._map.getResolutionInMeters(),scale:this._map.getScale()}):null;g&&(h=t=null);(h||t)&&"picturefillsymbol"!==q&&(u?(f=l&&l.color,h&&(f=d.getColor(e,{colorInfo:h})||f),f&&t&&(f=this._applyOpacity(f,d,t,e))):m&&m.toCss&&(n=m,h&&(n=d.getColor(e,{colorInfo:h})||n),n&&t&&(n=this._applyOpacity(n,d,t,e))));c.setStroke(!b||null==r&&!f?l:a.mixin({},l,null!=r?{width:r}:
null,f&&{color:f})).setFill(n||m)},_smsToPath:function(){return I?function(a,c,b,d,g,e,f,n,l){switch(c){case a.STYLE_SQUARE:return["M",g+","+f,"L",e+","+f,e+","+n,g+","+n,"X","E"];case a.STYLE_CROSS:return["M",b+","+f,"L",b+","+n,"M",g+","+d,"L",e+","+d,"E"];case a.STYLE_X:return["M",g+","+f,"L",e+","+n,"M",g+","+n,"L",e+","+f,"E"];case a.STYLE_DIAMOND:return["M",b+","+f,"L",e+","+d,b+","+n,g+","+d,"X","E"];case a.STYLE_TARGET:return["M",g+","+f,"L",e+","+f,e+","+n,g+","+n,g+","+f,"M",g-l+","+d,"L",
g+","+d,"M",b+","+(f-l),"L",b+","+f,"M",e+l+","+d,"L",e+","+d,"M",b+","+(n+l),"L",b+","+n,"E"]}}:function(a,c,b,d,g,e,f,n,l){switch(c){case a.STYLE_SQUARE:return["M",g+","+f,e+","+f,e+","+n,g+","+n,"Z"];case a.STYLE_CROSS:return["M",b+","+f,b+","+n,"M",g+","+d,e+","+d];case a.STYLE_X:return["M",g+","+f,e+","+n,"M",g+","+n,e+","+f];case a.STYLE_DIAMOND:return["M",b+","+f,e+","+d,b+","+n,g+","+d,"Z"];case a.STYLE_TARGET:return["M",g+","+f,e+","+f,e+","+n,g+","+n,g+","+f,"M",g-l+","+d,g+","+d,"M",b+
","+(f-l),b+","+f,"M",e+l+","+d,e+","+d,"M",b+","+(n+l),b+","+n]}}}(),_pathStyles:{square:1,cross:1,x:1,diamond:1,target:1},_typeMaps:{picturemarkersymbol:"image",picturefillsymbol:"path",simplefillsymbol:"path",simplelinesymbol:"path",cartographiclinesymbol:"path",textsymbol:"text"},_isInvalidShape:function(a,c){var b=c&&c.shape&&c.shape.type,d=a&&a.type,g=a&&a.style;return"rect"===b&&(b="path"),d&&(g=this._typeMaps[d]||g),this._pathStyles[g]&&(g="path"),"shieldlabelsymbol"===d?!0:!(!b||!g||b===
g)},_drawPoint:function(a,c,b,g,e,f,n){var l,m,q,u,r=b.type,h=this._map,t=h.__visibleRect,v=C.toScreenPoint(h.extent,h.width,h.height,c).offset(-t.x+e[0],-t.y),t=v.x,k=v.y;c=[];var w=this._getVariable(f,"rotationInfo",!1),w=w?f.getRotationAngle(n,{rotationInfo:w}):null,y=this._getVariable(f,"sizeInfo",!1),h=y?f.getSize(n,{sizeInfo:y,shape:b.style,resolution:h.getResolutionInMeters(),scale:h.getScale()}):null;if(w&&c.push(d.rotategAt(w,v)),(0!==b.xoffset||0!==b.yoffset)&&(u=d.translate(b.xoffset,-b.yoffset),
c.push(u)),0!==b.angle&&c.push(d.rotategAt(b.angle,v)),"simplemarkersymbol"===r)switch(l=b.style,f=Math.round,h=null!=h?h:b.size,l){case x.STYLE_SQUARE:case x.STYLE_CROSS:case x.STYLE_X:case x.STYLE_DIAMOND:b=isNaN(h)?16:h/2;l=this._drawPath(a,g,this._smsToPath(x,l,t,k,f(t-b),f(t+b),f(k-b),f(k+b)));break;case x.STYLE_TARGET:n=b._targetWidth/2;v=b._targetHeight/2;l=this._drawPath(a,g,this._smsToPath(x,l,t,k,f(t-n),f(t+n),f(k-v),f(k+v),b._spikeSize));break;case x.STYLE_PATH:l=this._drawPath(a,g,b.path,
!0);b=l.getBoundingBox();a=this._getScaleMatrix(b,h);1===a.xx&&1===a.yy||c.push(d.scaleAt(a.xx,a.yy,v));c.push(d.translate(-(b.x+b.width/2)+t,-(b.y+b.height/2)+k));break;default:b=isNaN(h)?16:h/2,l=this._drawCircle(a,g,{cx:t,cy:k,r:b})}else if("shieldlabelsymbol"===r){if(m=b.width,q=b.height,l=a.createGroup(),g=a.createImage({x:t-m/2,y:k-q/2,width:m,height:q,src:b.url}),l.add(g),null!=b.font)k+=.2*b.getHeight(),a=a.createText({type:"text",text:b.text,x:t,y:k,align:"middle",decoration:b.decoration,
rotated:b.rotated,kerning:b.kerning}),a.setFont(b.font),a.setFill(b.color),l.add(a)}else if("picturemarkersymbol"===r){if(null==h?(m=b.width,q=b.height):(q=h,m=b.width/b.height*q,u&&(null!=u.dx&&(u.dx=u.dx/b.width*m),null!=u.dy&&(u.dy=u.dy/b.height*q))),l=this._drawImage(a,g,{x:t-m/2,y:k-q/2,width:m,height:q,src:b.url}),F)if(a=l.getNode())b=(b=this._getVariable(f,"opacityInfo",!1))?f.getOpacity(n,{opacityInfo:b}):null,null!=b?a.setAttribute("opacity",b):a.setAttribute("opacity",1)}else"textsymbol"===
r&&(f=b.font,null!=h&&f&&(f=new f.constructor(f.toJson()),f.setSize(h)),l=this._drawText(a,g,{type:"text",text:b.text,x:t,y:k,align:b.getSVGAlign(),decoration:b.decoration||f&&f.decoration,rotated:b.rotated,kerning:b.kerning}),f&&l.setFont(f),F)&&(a=l.getNode(),t=b.getSVGBaseline(),k=b.getSVGBaselineShift(),a&&(a.setAttribute("dominant-baseline",t),k&&a.setAttribute("baseline-shift",k),this._applyHalo(l,b.haloColor,b.haloSize)));return l.setTransform(d.multiply(c)),l._wrapOffsets=e,l},_applyHalo:function(a,
c,b){var d=c&&b?this._getHaloId(c,b):null;a.setFilter(c&&b?r("webkit")||r("ff")?this._getDilateFilter(c,b,d):this._getOffsetFilter(c,b,d):null)},_getDilateFilter:function(a,b,d){var g=this._getSVGFilter(d);return g||(g=this._createSVGFilter({id:d},[c.feMorphology({operator:"dilate",radius:b,result:"dilated"}),c.feFlood({"flood-color":a.toCss(!0)}),c.feComposite({in2:"dilated",operator:"in",result:"composite"}),c.feMerge("composite","SourceGraphic")])),g},_getOffsetFilter:function(a,b,d){var g=this._getSVGFilter(d);
if(!g){var g=a.toCss(!0),e=this._offsetPrimitives,f=e.length,n=[],l=[];for(a=0;f>a;a++){var m=e[a],q="offset"+m.dir,u="composite"+m.dir;l.push(u);n.push(c.feOffset({dx:m.dx*b,dy:m.dy*b,"in":"SourceAlpha",result:q}),c.feFlood({"flood-color":g}),c.feComposite({in2:q,operator:"in",result:u}))}l.push("SourceGraphic");n.push(c.feMerge.apply(c.feMerge,l));g=this._createSVGFilter({id:d},n)}return g},_offsetPrimitives:[{dir:"L",dx:-1,dy:0},{dir:"TL",dx:-1,dy:-1},{dir:"T",dx:0,dy:-1},{dir:"TR",dx:1,dy:-1},
{dir:"R",dx:1,dy:0},{dir:"BR",dx:1,dy:1},{dir:"B",dx:0,dy:1},{dir:"BL",dx:-1,dy:1}],_getHaloId:function(a,c){return"halo_"+this._map.id+"_"+this.id+"_"+a.r+"_"+a.g+"_"+a.b+"_"+a.a+"_"+c},_getSVGFilter:function(a){return this._svgFilters[a]},_createSVGFilter:function(a,b){var d=c.createFilter(a,b),g=this._map,e=g.__visibleRect;return d.x=-e.x,d.y=-e.y,d.width=g.width,d.height=g.height,this._svgFilters[a.id]=d,d},_updateSVGFilters:function(a,c,b,d){var g,e,f,n=this._svgFilters;for(e in n)(g=n[e])&&
(f=m.byId(e),f&&(null!=a&&f.setAttribute("x",a),null!=c&&f.setAttribute("y",c),null!=b&&f.setAttribute("width",b),null!=d&&f.setAttribute("height",d)),null!=a&&(g.x=a),null!=c&&(g.y=c),null!=b&&(g.width=b),null!=d&&(g.height=d))},_getScaleMatrix:function(a,c){var b=a.width/a.height,d=1,g=1;return isNaN(c)||(1<b?(d=c/a.width,g=c/b/a.height):(g=c/a.height,d=c*b/a.width)),{xx:d,yy:g}},_symbolizePoint:function(c,b,d,g){var e=b.type,f=b.style;if("shieldlabelsymbol"!==e&&"picturemarkersymbol"!==e){var n=
b.getStroke();b=b.getFill();var f=f===x.STYLE_X||f===x.STYLE_CROSS,l=n&&n.color,m=f?l:b;if(d){var q=this._getVariable(d,"colorInfo",!1),u=this._getVariable(d,"opacityInfo",!1);q&&(m=d.getColor(g,{colorInfo:q})||m);m&&u&&(m=this._applyOpacity(m,d,u,g));m&&(f?m!==l&&(n=n?a.mixin({},n):{},n.color=m):m!==b&&(b=m))}"textsymbol"===e?c.setFill(b):"simplemarkersymbol"===e&&c.setFill(b).setStroke(n)}},_drawMarkers:function(a,c,b,d){var g,e,f,n=a.geometry,l=n.points,m=a.getDojoShape()||this._div.createGroup(),
q=l.length,u=[],r=0,h=b?b.length:0;m.children[0]&&this._isInvalidShape(c,m.children[0])&&m.clear();for(e=0;q>e;e++)for(g=l[e],f=0;h>f;f++)u[0]=b[f],this._drawPoint(m,{x:g[0],y:g[1],spatialReference:n.spatialReference},c,m.children[r++],u,d,a);c=m.children.length;if(q*b.length<c)for(e=c-1;e>=q*b.length;e--)m.children[e].removeShape();a._shape=m},_symbolizeMarkers:function(a,c,b){var d,g=a.getDojoShape().children,e=g.length;for(d=0;e>d;d++)this._symbolizePoint(g[d],c,b,a)},_errorHandler:function(a,
c){c?a.message="Unable to draw graphic (geometry:"+(c.geometry?c.geometry.declaredClass:null)+", symbol:"+(c.symbol?c.symbol.declaredClass:null)+"): "+a.message:a.message="Unable to draw graphic (null): "+a.message;this.inherited(arguments)},_rendererLimits:function(){var a,c,b;if(r("ff")?(a=16125,c=-32250,b=32250):I?(a=1E5,c=-1E5,b=1E5):r("chrome")&&6>r("chrome")&&(a=8150,c=-1E4,b=1E4),a){var d,g;return d=[-a,-a,a,a],g=[[[-a,-a],[a,-a]],[[a,-a],[a,a]],[[a,a],[-a,a]],[[-a,a],[-a,-a]]],{clipLimit:a,
rangeMin:c,rangeMax:b,clipBBox:d,clipSegments:g}}}(),_clipPolyline:function(a,c){var b=this._getCorners(a,c),d=b.br,g=this._rendererLimits,e=g.rangeMin,n=g.rangeMax,l=g.clipBBox,m=g.clipSegments,g=this._isPointWithinRange,q=this._isPointWithinBBox,u=this._getClipperIntersection,r=this._getPlaneIndex;if(!g(b.tl,e,n)||!g(d,e,n)){I&&this._createSegments(a);var h=[];f.forEach(a.segments,function(a){var c=a.args,b=c.length,d=[];for(a=0;b>a;a+=2){var g=[c[a],c[a+1]],e=[c[a+2],c[a+3]],f=q(g,l),n=q(e,l);
f^n?(n=u([g,e],m))&&(f?(a?d.push(n[1]):d.push(g,n[1]),h.push(d),d=[]):d.push(n[1],e)):f?a?d.push(e):d.push(g,e):(n=r(g,l),f=r(e,l),-1!==n&&-1!==f&&n!==f&&(g=u([g,e],m,!0),0<g.length&&(g[n]||(n=g[n[0]]?n[0]:n[1]),g[f]||(f=g[f[0]]?f[0]:f[1]),e=g[n],g=g[f],e&&d.push(e),g&&(d.push(g),h.push(d),d=[]))))}h.push(d)});a.setShape(this._getPathStringFromPaths(h))}},_clipPolygon:function(c,b){var d=this._getCorners(c,b),g=d.br,e=this._rendererLimits,n=e.clipLimit,l=e.rangeMin,m=e.rangeMax,q=e.clipBBox,u=e.clipSegments,
e=this._isPointWithinRange,r=this._isPointWithinBBox,h=this._getClipperIntersection,t=this._getPlaneIndex,v=B._pointLineDistance;e(d.tl,l,m)&&e(g,l,m)||(I&&this._createSegments(c),d=f.filter(c.segments,function(a){return a.args&&a.args.length}),d=f.map(d,function(c){var b,d=c.args,g=d.length,e=[];c=[];for(b=0;g>b;b+=2){var l=[d[b],d[b+1]],m=[d[b+2],d[b+3]];if(b===g-2){e.push(l);break}var k,w=r(l,q),x=r(m,q);if(e.push(l),w^x){if(k=h([l,m],u))l=k[1],l[w?"inOut":"outIn"]=!0,e.push(l),c.push([w?"INOUT":
"OUTIN",e.length-1,k[0]])}else w||(w=t(l,q),x=t(m,q),-1===w||-1===x||w===x)||((k=h([l,m],u,!0),0<k.length)?(k[w]||(w=k[w[0]]?w[0]:w[1]),k[x]||(x=k[x[0]]?x[0]:x[1]),l=k[w],m=k[x],l&&(l.outIn=!0,e.push(l),c.push(["OUTIN",e.length-1,w])),m&&(m.inOut=!0,e.push(m),c.push(["INOUT",e.length-1,x]))):a.isArray(w)&&a.isArray(x)&&(x=w.concat(x),x.sort(),"0123"===x.join(""))&&(x=[],3===w[0]+w[1]?x.push([n,-n],[-n,n]):x.push([-n,-n],[n,n]),w=v(x[0],[l,m]),l=v(x[1],[l,m]),e.push(l>w?x[0]:x[1])))}var y=q[0],z=q[1],
C=q[2],A=q[3];f.forEach(e,function(a){a[0]<y&&(a[1]>=z&&a[1]<=A?a[0]=y:(a[0]=y,a[1]=a[1]<z?z:A))});f.forEach(e,function(a){a[1]<z&&(a[0]>=y&&a[0]<=C?a[1]=z:(a[1]=z,a[0]=a[0]<y?y:C))});f.forEach(e,function(a){a[0]>C&&(a[1]>=z&&a[1]<=A?a[0]=C:(a[0]=C,a[1]=a[1]<z?z:A))});f.forEach(e,function(a){a[1]>A&&(a[0]>=y&&a[0]<=C?a[1]=A:(a[1]=A,a[0]=a[0]<y?y:C))});var D,B;k=0;if(g=c.length,0<g){do{if(D=c[k],B=c[(k+1)%g],D[2]===B[2]&&"INOUT"===D[0]&&"OUTIN"===B[0])if(d=D[1],b=B[1],b>d)for(d+=1;b>d;d++)e[d][2]=
!0;else if(d>b){for(d+=1;d<e.length;d++)e[d][2]=!0;for(d=0;b>d;d++)e[d][2]=!0}k=(k+1)%g}while(0!==k)}g=e[0];b=e[e.length-1];g[2]&&(b[2]=!0,f.some(c,function(c){return 1===c[1]?(e.splice(e.length-1,0,a.clone(e[1])),!0):!1}));e=f.filter(e,function(a){return a[2]?!1:!0});for(k=0;k<e.length-1;k++)D=e[k],(B=e[k+1])&&D[0]===B[0]&&D[1]===B[1]&&(B.outIn?D.outIn=!0:B.inOut&&(D.inOut=!0),e.splice(k+1,1));d=Math.abs;c=[];for(k=0;k<e.length-1;k++){D=e[k];l=D[0];D=D[1];m=d(l)===n;w=d(D)===n;B=e[k+1];x=B[0];B=
B[1];var E=d(x)===n,F=d(B)===n;m&&F?c.push([k+1,[l,B]]):w&&E&&c.push([k+1,[x,D]])}for(k=c.length-1;0<=k;k--)B=c[k],d=e[B[0]-1],D=e[B[0]],d.outIn||d.inOut||D.outIn||D.inOut||e.splice(B[0],0,B[1]);return g=e[0],b=e[e.length-1],(g[0]!==b[0]||g[1]!==b[1])&&e.push(g),e}),c.setShape(this._getPathStringFromPaths(d)))},_getCorners:function(a,c){if(I){var b=this._map,d=c.getExtent(),g=d.spatialReference,e=b.toScreen(new y(d.xmin,d.ymax,g)),b=b.toScreen(new y(d.xmax,d.ymin,g));return{tl:e,br:b}}e=a.getTransformedBoundingBox();
return{tl:e[0],br:e[2]}},_createSegments:function(a){a.shape.path=a.vmlPath;a.segmented=!1;a._confirmSegmented();var c=a.segments;1<c.length&&(a.segments=f.filter(c,function(a,c,b){c=b[c+1];return"M"===a.action&&c&&"L"===c.action?(a.args=a.args.concat(c.args),!0):!1}))},_getPathStringFromPaths:function(a){return I?(a=f.map(a,function(a){return"m "+f.map(a,function(a,c){return(1===c?"l ":"")+a.join(",")}).join(" ")}),a.push("e")):a=f.map(a,function(a){return"M "+f.map(a,function(a){return a.join(",")}).join(" ")}),
a.join(" ")},_isPointWithinBBox:function(a,c){var b=c[1],d=c[2],g=c[3],e=a[0],f=a[1];return e>c[0]&&d>e&&f>b&&g>f?!0:!1},_isPointWithinRange:function(a,c,b){var d=a.x;a=a.y;return c>d||c>a||d>b||a>b?!1:!0},_getClipperIntersection:function(a,c,b){var d,g=B._getLineIntersection2,e=Math.round,f={length:0};for(d=0;4>d;d++){var n=g(a,c[d]);if(n){if(n[0]=e(n[0]),n[1]=e(n[1]),!b)return[d,n];f[d]=n;f.length++}}return b?f:null},_getPlaneIndex:function(a,c){var b=a[0],d=a[1],g=c[0],e=c[1],f=c[2],n=c[3];return g>=
b?d>=e&&n>=d?3:e>d?[0,3]:[2,3]:e>=d?b>=g&&f>=b?0:g>b?[3,0]:[1,0]:b>=f?d>=e&&n>=d?1:e>d?[0,1]:[2,1]:d>=n?b>=g&&f>=b?2:g>b?[3,2]:[1,2]:-1},onGraphicAdd:function(){},onGraphicRemove:function(){},onGraphicNodeAdd:function(){},onGraphicNodeRemove:function(){},onGraphicDraw:function(){},onGraphicsClear:function(){},onRendererChange:function(){},onOpacityChange:function(){},setInfoTemplate:function(a){this.infoTemplate=a},add:function(a,c){return a._graphicsLayer===this?a:(c||this.graphics.push(a),a._graphicsLayer=
this,a._layer=this,this._updateExtent(a),this._draw(a),c||this.onGraphicAdd(a),a)},remove:function(a,c,b){if(!c&&!b){c=this.graphics;if(-1===(a=f.indexOf(c,a)))return null;a=c.splice(a,1)[0]}return a.getDojoShape()&&this._removeShape(a,null,b),a._shape=a._graphicsLayer=null,this.onGraphicRemove(a),a},clear:function(a,c){var b,d=this.graphics,g=!I;for(b=d.length-1;0<=b;b--)this.remove(d[b],null,g);if(this.graphics=[],g&&this._div){var e;this._childLayer&&(e=this._childLayer.getNode(),e&&e.parentNode&&
e.parentNode.removeChild(e));this._bgGroup.clear();this._div.clear();this._bgGroup=this._div.createGroup();e&&this._div.getEventSource().appendChild(e);this._initOpacity()}c||this.onGraphicsClear()},_setIEOpacity:function(a,c){var b=a&&a.getNode();if(b){var d=a.strokeStyle,g=b.stroke;d&&g&&(g.opacity=d.color.a*c);d=a.fillStyle;g=b.fill;d&&g&&("tile"===g.type?l.set(b,"opacity",c):g.opacity=d.a*c)}},setOpacity:function(a,c){if(c||this.opacity!=a){var b=this._div;b&&(I?(f.forEach(this.graphics,function(c){this._setIEOpacity(c._shape,
a);this._setIEOpacity(c._bgShape,a)},this),b._esriIeOpacity=a,this._bgGroup._esriIeOpacity=a):this._canvas?l.set(b.getEventSource(),"opacity",a):b.getEventSource().setAttribute("opacity",a));this.opacity=a;c||this.onOpacityChange(a)}},setRenderer:function(a){this.renderer=a;this._evalSDRenderer(!0);this.emit("renderer-change",{renderer:this._rndForScale||a})}});h=h([E,D],{declaredClass:"esri.layers.GraphicsLayer",constructor:function(){this.enableMouseEvents=a.hitch(this,this.enableMouseEvents);this.disableMouseEvents=
a.hitch(this,this.disableMouseEvents);this._processEvent=a.hitch(this,this._processEvent);this._initLayer()},_initLayer:function(){this.loaded=!0;this.onLoad(this)},_setMap:function(){var a=this.inherited("_setMap",arguments);return this.enableMouseEvents(),a},_unsetMap:function(){this.disableMouseEvents();this.inherited("_unsetMap",arguments)},_processEvent:function(a){var c,b=this._map,d=a.target;a.screenPoint=new A(a.pageX-b.position.x,a.pageY-b.position.y);for(a.mapPoint=b.toMap(a.screenPoint);d&&
!(c=d.e_graphic);)d=d.parentNode;return c?(a.graphic=c,a):void 0},_onMouseOverHandler:function(a){this._processEvent(a)&&this.onMouseOver(a)},_onMouseMoveHandler:function(a){this._processEvent(a)&&this.onMouseMove(a)},_onMouseDragHandler:function(a){this._processEvent(a)&&this.onMouseDrag(a)},_onMouseOutHandler:function(a){this._processEvent(a)&&this.onMouseOut(a)},_onMouseDownHandler:function(a){this._downGr=this._downPt=null;this._processEvent(a)&&(k.disconnect(this._onmousemove_connect),k.disconnect(this._onmousedrag_connect),
this._onmousedrag_connect=k.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseDragHandler"),this._downGr=a.graphic,this._downPt=a.screenPoint.x+","+a.screenPoint.y,this.onMouseDown(a))},_onMouseUpHandler:function(a){this._upGr=this._upPt=null;this._processEvent(a)&&(k.disconnect(this._onmousedrag_connect),k.disconnect(this._onmousemove_connect),this._onmousemove_connect=k.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseMoveHandler"),this._upGr=a.graphic,this._upPt=a.screenPoint.x+
","+a.screenPoint.y,this.onMouseUp(a))},_onClickHandler:function(a){if(this._processEvent(a)){var c=this._downGr,b=this._upGr;c&&b&&c===b&&this._downPt===this._upPt&&(I&&(q._ieGraphic=a.graphic),this.onClick(a))}},_onDblClickHandler:function(a){this._processEvent(a)&&this.onDblClick(a)},onMouseOver:function(){},onMouseMove:function(){},onMouseDrag:function(){},onMouseOut:function(){},onMouseDown:function(){},onMouseUp:function(){},onClick:function(){},onDblClick:function(){},enableMouseEvents:function(){if(!this._mouseEvents){var a=
k.connect,c=this._div.getEventSource();G||(this._onmouseover_connect=a(c,"onmouseover",this,"_onMouseOverHandler"),this._onmousemove_connect=a(c,"onmousemove",this,"_onMouseMoveHandler"),this._onmouseout_connect=a(c,"onmouseout",this,"_onMouseOutHandler"),this._onmousedown_connect=a(c,"onmousedown",this,"_onMouseDownHandler"),this._onmouseup_connect=a(c,"onmouseup",this,"_onMouseUpHandler"),this._onclick_connect=a(c,"onclick",this,"_onClickHandler"),this._ondblclick_connect=a(c,"ondblclick",this,
"_onDblClickHandler"));this._mouseEvents=!0}},disableMouseEvents:function(){if(this._mouseEvents){var a=k.disconnect;a(this._onmouseover_connect);a(this._onmousemove_connect);a(this._onmousedrag_connect);a(this._onmouseout_connect);a(this._onmousedown_connect);a(this._onmouseup_connect);a(this._onclick_connect);a(this._ondblclick_connect);this._mouseEvents=!1}}});return h._GraphicsContainer=w,h._GraphicsLayer=E,r("extend-esri")&&(a.setObject("layers.GraphicsLayer",h,q),a.setObject("layers._GraphicsContainer",
w,q),a.setObject("layers._GraphicsLayer",E,q)),h})},"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(h,k,a){k.switchTo(a);return k})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(h,k,a,f,b){var e=null;a.add("vml",function(a,b,g){g.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';a="adj"in g.firstChild;g.innerHTML="";return a});return{load:function(l,m,g){function d(){m(["dojox/gfx/"+
c],function(a){h.renderer=c;e=a;g(a)})}if(e&&"force"!=l)g(e);else{var c=b.forceGfxRenderer;l=!c&&(k.isString(b.gfxRenderer)?b.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var n,q;!c&&l.length;)switch(l.shift()){case "svg":"SVGAngle"in f.global&&(c="svg");break;case "vml":a("vml")&&(c="vml");break;case "silverlight":try{a("ie")?(n=new ActiveXObject("AgControl.AgControl"),n.IsVersionSupported("1.0"))&&(q=!0):navigator.plugins["Silverlight Plug-In"]&&(q=!0)}catch(t){q=!1}finally{n=null}q&&
(c="silverlight");break;case "canvas":f.global.CanvasRenderingContext2D&&(c="canvas")}"canvas"===c&&!1!==b.canvasEvents&&(c="canvasWithEvents");"svg"==c&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(d):d()}}}})},"esri/layers/gfxSniff":function(){define(["dojo/has","dojox/gfx"],function(h,k){return h.add("esri-svg",function(){return-1!==k.renderer.toLowerCase().indexOf("svg")}),h})},"esri/layers/layer":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/Deferred dojo/_base/json dojo/has ../Evented ../kernel ../lang ../request ../deferredUtils ../urlUtils ../SpatialReference ../geometry/Extent".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r){var v=h([m],{declaredClass:"esri.layers.Layer",_eventMap:{error:["error"],load:["layer"],"opacity-change":["opacity"],"update-end":["error"],"visibility-change":["visible"]},constructor:function(c,b){if(this._attrs={},c&&f.isString(c)?this._url=q.urlToObject(this.url=c):(this.url=this._url=null,b=b||c,b&&(b.layerDefinition||b.query)&&(b=null)),this.spatialReference=new t(4326),this.initialExtent=new r(-180,-90,180,90,new t(4326)),this._map=this._div=null,this.normalization=
!0,b&&(b.id&&(this.id=b.id),!1===b.visible&&(this.visible=!1),d.isDefined(b.opacity)&&(this.opacity=b.opacity),d.isDefined(b.minScale)&&this.setMinScale(b.minScale),d.isDefined(b.maxScale)&&this.setMaxScale(b.maxScale),this.attributionDataUrl=b.attributionDataUrl||"",this.hasAttributionData=!!this.attributionDataUrl,d.isDefined(b.showAttribution)&&(this.showAttribution=b.showAttribution),this.className=b.className,this.refreshInterval=b.refreshInterval||0),this._errorHandler=f.hitch(this,this._errorHandler),
this.refresh=f.hitch(this,this.refresh),this.managedSuspension){var g=this._setMap;this._setMap=function(c){var b=g.apply(this,arguments);if(this.evaluateSuspension(),this.suspended&&!c.loaded)var d=a.connect(c,"onLoad",this,function(){a.disconnect(d);d=null;this.evaluateSuspension()});return b}}this.registerConnectEvents()},id:null,visible:!0,opacity:1,loaded:!1,loadError:null,minScale:0,maxScale:0,visibleAtMapScale:!1,suspended:!0,attributionDataUrl:"",hasAttributionData:!1,showAttribution:!0,refreshInterval:0,
_errorHandler:function(a){this.loaded||(this.loadError=a);this.onError(a)},_setMap:function(c,b,d,g){if(this._map=c,this._lyrZEHandle=a.connect(c,"onZoomEnd",this,this._processMapScale),c.loaded)this.visibleAtMapScale=this._isMapAtVisibleScale();else var e=a.connect(c,"onLoad",this,function(){a.disconnect(e);e=null;this._processMapScale()})},_unsetMap:function(c,b){a.disconnect(this._lyrZEHandle);this._toggleRT();this._map=this._lyrZEHandle=null;this._resumedOnce=void 0;this.suspended=!0},_cleanUp:function(){this._map=
this._div=null},_fireUpdateStart:function(){this.updating||(this.updating=!0,this.attr("data-updating",""),this._toggleRT(),this.onUpdateStart(),this._map&&this._map._incr())},_fireUpdateEnd:function(a,c){this.updating&&(this.updating=!1,this.attr("data-updating"),this._toggleRT(!0),this.onUpdateEnd(a,c),this._map&&this._map._decr())},_getToken:function(){var a=this._url,c=this.credential;return a&&a.query&&a.query.token||c&&c.token||void 0},_findCredential:function(){this.credential=g.id&&this._url&&
g.id.findCredential(this._url.path)},_useSSL:function(){var a=this._url,c=/^http:/i;this.url&&(this.url=this.url.replace(c,"https:"));a&&a.path&&(a.path=a.path.replace(c,"https:"))},refresh:function(){},show:function(){this.setVisibility(!0)},hide:function(){this.setVisibility(!1)},setMinScale:function(a){this.setScaleRange(a)},setMaxScale:function(a){this.setScaleRange(null,a)},setScaleRange:function(a,c){var b=d.isDefined(a),g=d.isDefined(c);this.loaded||(this._hasMin=this._hasMin||b,this._hasMax=
this._hasMax||g);var e=this.minScale,f=this.maxScale;this.minScale=(b?a:this.minScale)||0;this.maxScale=(g?c:this.maxScale)||0;e===this.minScale&&f===this.maxScale||(this.onScaleRangeChange(),this._processMapScale())},suspend:function(){this._suspended=!0;this.evaluateSuspension()},resume:function(){this._suspended=!1;this.evaluateSuspension()},canResume:function(){return this.loaded&&this._map&&this._map.loaded&&this.visible&&this.visibleAtMapScale&&!this._suspended},evaluateSuspension:function(){this.canResume()?
this.suspended&&this._resume():this.suspended||this._suspend()},_suspend:function(){this.suspended=!0;this.attr("data-suspended","");this._toggleRT();this.onSuspend();this._map&&this._map.onLayerSuspend(this)},_resume:function(){this.suspended=!1;this.attr("data-suspended");var a,c=void 0===this._resumedOnce,b=this.className,d=this._attrs,g=this.getNode();if(c){if(this._resumedOnce=!0,b&&g){var e=g.getAttribute("class")||"";(new RegExp("(^|\\s)"+b+"(\\s|$)","i")).test(e)||(e+=(e?" ":"")+b,g.setAttribute("class",
e))}if(d&&g)for(a in d)d.hasOwnProperty(a)&&g.setAttribute(a,d[a])}this._toggleRT(!0);this.onResume({firstOccurrence:c});this._map&&this._map.onLayerResume(this)},_processMapScale:function(){var a=this.visibleAtMapScale;this.visibleAtMapScale=this._isMapAtVisibleScale();a!==this.visibleAtMapScale&&(this.onScaleVisibilityChange(),this.evaluateSuspension())},isVisibleAtScale:function(a){return a?v.prototype._isMapAtVisibleScale.apply(this,arguments):!1},_isMapAtVisibleScale:function(a,c){if(!(a||this._map&&
this._map.loaded))return!1;var b=this._map;a=a||b.getScale();var d,g=this.minScale,e=this.maxScale,f=!g,n=!e;return c&&(d=b.width>b.height?b.width:b.height),f||(g>=a?f=!0:c&&(f=Math.abs(g-a)/g<1/d)),n||(a>=e?n=!0:c&&(n=Math.abs(e-a)/e<1/d)),f&&n},getAttributionData:function(){var a=this.attributionDataUrl,d=new b(n._dfdCanceller);this.hasAttributionData&&a?(d._pendingDfd=c({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),d._pendingDfd.then(function(a){d.callback(a)},function(a){d.errback(a)})):
(a=Error("Layer does not have attribution data"),a.log=k.isDebug,d.errback(a));return d},getResourceInfo:function(){var a=this.resourceInfo;return f.isString(a)?e.fromJson(a):f.clone(a)},getMap:function(){return this._map},getNode:function(){return this._div},attr:function(a,c){var b=this.getNode();return"data-reference"===a&&11>l("ie")?this:(b&&(null==c?b.removeAttribute(a):b.setAttribute(a,c)),this._attrs&&(null==c?delete this._attrs[a]:this._attrs[a]=c),this)},setRefreshInterval:function(a){var c=
this.refreshInterval;return this.refreshInterval=a,this._toggleRT(),a&&(this.updating||this.suspended||this._toggleRT(!0)),c!==a&&this.onRefreshIntervalChange(),this},_toggleRT:function(a){a&&this.refreshInterval?(clearTimeout(this._refreshT),this._refreshT=setTimeout(this.refresh,6E4*this.refreshInterval)):this._refreshT&&(clearTimeout(this._refreshT),this._refreshT=null)},setNormalization:function(a){this.normalization=a},setVisibility:function(a){this.visible!==a&&(this.visible=a,this.onVisibilityChange(this.visible),
this.evaluateSuspension());this.attr("data-hidden",a?null:"")},onLoad:function(){},onVisibilityChange:function(){},onScaleRangeChange:function(){},onScaleVisibilityChange:function(){},onSuspend:function(){},onResume:function(){},onUpdate:function(){},onUpdateStart:function(){},onUpdateEnd:function(){},onRefreshIntervalChange:function(){},onError:function(){}});return l("extend-esri")&&f.setObject("layers.Layer",v,g),v})},"esri/request":function(){define("require dojo/_base/array dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/_base/url dojo/_base/xhr dojo/io/script dojo/io/iframe dojo/dom-construct dojo/io-query ./kernel ./config ./sniff ./lang ./urlUtils ./deferredUtils".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u){function w(a){return a=new e(a),(a.host+(a.port?":"+a.port:"")).toLowerCase()}function x(a){return this._xhr?this._xhr.getResponseHeader(a):null}function y(e,q,h,u){var w,x=!1,y=!1;r.isDefined(q)&&(b.isObject(q)?(x=!!q.useProxy,y=!!q.usePost,w=q.crossOrigin):x=!!q);e=b.mixin({},e);e._ssl&&(e.url=e.url.replace(/^http:/i,"https:"));10>t("ie")&&!J.test(e.url)&&(e.url=encodeURI(e.url));q=e.content;var z=e.url,C=h&&e.form,A=F;w=r.isDefined(w)?w:A.useCors;e.load=
function(c){var d;return c&&(c.error?(d=b.mixin(Error(),c.error),d.log=a.isDebug):"error"===c.status&&(d=b.mixin(Error(),c),d.log=a.isDebug),d&&!r.isDefined(d.httpCode)&&(d.httpCode=d.code)),d||c};e.error=function(c,d){return d&&d.xhr&&d.xhr.abort(),c instanceof Error||(c=b.mixin(Error(),c)),c.log=a.isDebug,A.errorHandler(c,d),c};e._token&&(e.content=e.content||{},e.content.token=e._token);var B,E=0;q&&z&&(B=c.objectToQuery(q),E=B.length+z.length+1,t("esri-url-encodes-apostrophe")&&(E=B.replace(/'/g,
"%27").length+z.length+1));e.timeout=r.isDefined(e.timeout)?e.timeout:A.timeout;e.handleAs=e.handleAs||"json";try{var G,da,L=w&&v.canUseXhr(e.url)&&!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(e.url),M=v.hasSameOrigin(e.url,window.location.href)||L,H=y||h||E>A.postLength?!0:!1,K=M||-1===e.handleAs.indexOf("json")||!e.callbackParamName||h?!1:!0,pa=v.getProxyRule(e.url)||A.alwaysUseProxy||x||(!K||H)&&!M?!0:!1;if(h&&!t("esri-file-upload")&&!pa&&L&&(pa=!0),pa)if(G=v.getProxyUrl(z,w),da=G.path,
G._xo&&(L=!0),!H&&da.length+1+E>A.postLength&&(H=!0),e.url=da+"?"+z,H)e.content=b.mixin(G.query||{},q);else{var wa=c.objectToQuery(b.mixin(G.query||{},q));wa&&(e.url+="?"+wa);e.content=null}if(K&&!H)return!r.isDefined(e.isAsync)&&4>t("ff")&&(e.isAsync=!0),m.get(D?D(e):e);var oa=e.headers;if(!L||oa&&oa.hasOwnProperty("X-Requested-With")||(oa=e.headers=oa||{},oa["X-Requested-With"]=null),h){var ma,ia,ja,za,Ba,ra=e.callbackParamName||"callback.html",ua=e.callbackElementName||"textarea",xa=C.elements?
C.elements.length:0;if(q=e.content)for(ma in q)if(ja=q[ma],r.isDefined(ja)){ia=null;for(za=0;xa>za;za++)if(Ba=C.elements[za],Ba.name===ma){ia=Ba;break}ia?ia.value=ja:u?C.append(ma,ja):C.appendChild(d.create("input",{type:"hidden",name:ma,value:ja}))}t("esri-file-upload")?(k.forEach(C.elements,function(a){a.name===ra&&C.removeChild(a)}),e.contentType=!1,e.postData=u?C:new FormData(C),delete e.form):(C.enctype="multipart/form-data",9>t("ie")&&(C.encoding="multipart/form-data"),C.method="post",k.some(C.elements,
function(a){return a.name===ra})||C.appendChild(d.create("input",{type:"hidden",name:ra,value:ua})),(-1!==z.toLowerCase().indexOf("addattachment")||-1!==z.toLowerCase().indexOf("updateattachment"))&&(e.url=z+(-1===z.indexOf("?")?"?":"\x26")+ra+"\x3d"+ua,pa&&(e.url=da+"?"+e.url)),delete e.content)}if(L&&!e.hasOwnProperty("withCredentials")&&"with-credentials"===F.useCors){u=pa?da:z;var Ha=v.canUseXhr(u,!0),Ia=-1<Ha?F.corsEnabledServers[Ha]:null;if(Ia&&Ia.hasOwnProperty("withCredentials"))Ia.withCredentials&&
(e.withCredentials=!0);else if(n.id){var Da=n.id.findServerInfo(u);Da&&Da.webTierAuth&&(e.withCredentials=!0)}}return e=D?D(e):e,H?h&&!t("esri-file-upload")?g.send(e):(!pa&&t("safari")&&(e.url+=(-1===e.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+I++),l.post(e)):l.get(e)}catch(Ja){return h=new f,h.errback(e.error(Ja)),h}}function A(a){var c=F.corsStatus,b=v.canUseXhr(a,!0);return-1<b&&F.corsEnabledServers.splice(b,1),c[w(a)]=1,b}function z(a){var c=F.corsStatus;if(F.corsDetection&&
F.useCors)try{var b=w(a);!t("esri-cors")||!a||-1===a.toLowerCase().indexOf("/rest/services")||v.hasSameOrigin(a,window.location.href)||v.canUseXhr(a)||c[b]||(c[b]=-1,l.get({url:a.substring(0,a.toLowerCase().indexOf("/rest/")+6)+"info",content:{f:"json"},failOk:!0,handleAs:"json",headers:{"X-Requested-With":null}}).then(function(d){d?(c[b]=2,v.canUseXhr(a)||F.corsEnabledServers.push(b)):c[b]=1},function(a){c[b]=1}))}catch(K){}}function B(a){D=a}function C(c,b){function d(d){if(d._pendingDfd=y(c,b,
L,I),!d._pendingDfd){d.ioArgs=d._pendingDfd&&d._pendingDfd.ioArgs;var g=Error("Deferred object is missing");return g.log=a.isDebug,c._usrDfd=null,d.errback(g),d._pendingDfd=null,d}d._pendingDfd.addCallback(function(a){d.ioArgs=d._pendingDfd&&d._pendingDfd.ioArgs;c._usrDfd=null;b.returnFullResponse&&(a={data:a,_xhr:d.ioArgs&&d.ioArgs.xhr,getHeader:x});d.callback(a);d._pendingDfd=null}).addErrback(function(a){var g,e,f;if(a&&(g=a.code,e=a.subcode,f=a.messageCode,f=f&&f.toUpperCase()),a&&403==g&&(4==
e||a.message&&-1<a.message.toLowerCase().indexOf("ssl")&&-1===a.message.toLowerCase().indexOf("permission"))){if(!c._ssl)return c._ssl=c._sslFromServer=!0,c._usrDfd=d,void C(c,b)}else if(a&&415==a.status){if(A(c.url),!c._err415)return c._err415=1,c._usrDfd=d,void C(c,b)}else if(n.id&&-1!==k.indexOf(n.id._errorCodes,g)&&!n.id._isPublic(c.url)&&!m&&(403!=g||-1===k.indexOf(G,f)&&(!r.isDefined(e)||2==e&&c._token)))return d._pendingDfd=n.id.getCredential(c.url,{token:c._token,error:a}),void d._pendingDfd.addCallback(function(a){c._token=
a.token;c._usrDfd=d;c._credential=a;c._ssl=c._sslFromServer||a.ssl;C(c,b)}).addErrback(function(a){c._usrDfd=null;d.errback(a);d._pendingDfd=null});d.ioArgs=d._pendingDfd&&d._pendingDfd.ioArgs;c._usrDfd=null;d.errback(a);d._pendingDfd=null})}c.url=v.fixUrl(c.url);b=b||{};var g,e=c.form,m=b.disableIdentityLookup,q=b._preLookup,D=!1;if(t("esri-workers")&&!1!==F.useWorkers)if(!0===b.useWorkers||!0===F.useWorkers)D=!0;else if(b.workerOptions){var B=b.workerOptions;(B.callback||B.worker&&B.worker.worker instanceof
Worker)&&(D=!0)}var I=e&&t("esri-file-upload")&&e instanceof FormData,L=e&&(e.elements?k.some(e.elements,function(a){return"file"===a.type}):I),J=-1!==c.url.toLowerCase().indexOf("token\x3d")||c.content&&c.content.token||L&&k.some(e.elements,function(a){return"token"===a.name})?1:0;if(z(c.url),c._usrDfd)g=c._usrDfd;else{g=new f(u._dfdCanceller);g.addCallback(function(a){if((/\/sharing\/rest\/accounts\/self/i.test(c.url)||/\/sharing\/rest\/portals\/self/i.test(c.url))&&!J&&!c._token&&a.user&&a.user.username){F.webTierAuthServers.push(w(c.url));
a=F.corsEnabledServers;var b=v.canUseXhr(c.url,!0),d={host:w(c.url),withCredentials:!0};if(-1===b)a.push(d);else{var g=a[b];"object"==typeof g?g.withCredentials=!0:a.splice(b,1,d)}}if(a=c._credential){var e;(b=(b=n.id.findServerInfo(a.server))&&b.owningSystemUrl)&&(b=b.replace(/\/?$/,"/sharing"),e=n.id.findCredential(b,a.userId),e&&-1===n.id._getIdenticalSvcIdx(b,e)&&e.resources.splice(0,0,b))}});g.addBoth(function(a){delete c._credential;!a||t("ie")&&a.nodeType||(a._ssl=c._ssl)});var V=c.load,da=
c.error;V&&g.addCallback(function(a){var c=g._pendingDfd,c=c&&c.ioArgs;return V.call(c&&c.args,a,c)});da&&g.addErrback(function(a){var c=g._pendingDfd,c=c&&c.ioArgs;return da.call(c&&c.args,a,c)})}!n.id||J||c._token||n.id._isPublic(c.url)||m&&!q||(e=n.id.findCredential(c.url))&&(c._token=e.token,c._ssl=e.ssl);return D?b.workerOptions&&b.workerOptions.worker?(E||(E=l),l=b.workerOptions.worker,d(g)):h(["./workers/RequestClient"],function(a){if(E||(E=l),b.workerOptions){var c=b.workerOptions;l=a.getClient(c.callback,
c.cbFunction)}else l=a.getClient();d(g)}):(E&&(l=E,E=null),d(g)),g}var D,E=null,F=q.defaults.io,G=["COM_0056","COM_0057"],I=0,J=/%[0-9A-F]{2}/i;return C._request=y,C._disableCors=A,C._detectCors=z,C.setRequestPreCallback=B,t("extend-esri")&&(n.request=C,n._request=y,n._disableCors=A,n._detectCors=z,n.setRequestPreCallback=B),C})},"dojo/io/script":function(){define("../_base/connect ../_base/kernel ../_base/lang ../sniff ../_base/window ../_base/xhr ../dom ../dom-construct ../request/script ../aspect".split(" "),
function(h,k,a,f,b,e,l,m,g,d){k.deprecated("dojo/io/script","Use dojo/request/script.","2.0");var c={get:function(a){var b,f=this._makeScriptDeferred(a,function(a){b&&b.cancel()}),n=f.ioArgs;e._ioAddQueryToUrl(n);e._ioNotifyStart(f);b=g.get(n.url,{timeout:a.timeout,jsonp:n.jsonp,checkString:a.checkString,ioArgs:n,frameDoc:a.frameDoc,canAttach:function(a){n.requestId=a.id;n.scriptId=a.scriptId;n.canDelete=a.canDelete;return c._canAttach(n)}},!0);d.around(b,"isValid",function(a){return function(b){c._validCheck(f);
return a.call(this,b)}});b.then(function(){f.resolve(f)}).otherwise(function(a){f.ioArgs.error=a;f.reject(a)});return f},attach:g._attach,remove:g._remove,_makeScriptDeferred:function(a,b){var d=e._ioSetArgs(a,b||this._deferredCancel,this._deferredOk,this._deferredError),f=d.ioArgs;f.id=k._scopeName+"IoScript"+(a.callbackSuffix||this._counter++);f.canDelete=!1;f.jsonp=a.callbackParamName||a.jsonp;f.jsonp&&(f.query=f.query||"",0<f.query.length&&(f.query+="\x26"),f.query+=f.jsonp+"\x3d"+(a.frameDoc?
"parent.":"")+k._scopeName+".io.script.jsonp_"+f.id+"._jsonpCallback",f.frameDoc=a.frameDoc,f.canDelete=!0,d._jsonpCallback=this._jsonpCallback,this["jsonp_"+f.id]=d);d.addBoth(function(a){f.canDelete&&(a instanceof Error?c["jsonp_"+f.id]._jsonpCallback=function(){delete c["jsonp_"+f.id];if(f.requestId)k.global[g._callbacksProperty][f.requestId]()}:c._addDeadScript(f))});return d},_deferredCancel:function(a){a.canceled=!0},_deferredOk:function(a){a=a.ioArgs;return a.json||a.scriptLoaded||a},_deferredError:function(a,
c){return a},_deadScripts:[],_counter:1,_addDeadScript:function(a){c._deadScripts.push({id:a.id,frameDoc:a.frameDoc});a.frameDoc=null},_validCheck:function(a){if((a=c._deadScripts)&&0<a.length){for(var b=0;b<a.length;b++)c.remove(a[b].id,a[b].frameDoc),delete c["jsonp_"+a[b].id],a[b].frameDoc=null;c._deadScripts=[]}return!0},_ioCheck:function(a){a=a.ioArgs;return a.json||a.scriptLoaded&&!a.args.checkString?!0:(a=a.args.checkString)&&eval("typeof("+a+") !\x3d 'undefined'")},_resHandle:function(a){c._ioCheck(a)?
a.callback(a):a.errback(Error("inconceivable dojo.io.script._resHandle error"))},_canAttach:function(){return!0},_jsonpCallback:function(a){this.ioArgs.json=a;if(this.ioArgs.requestId)k.global[g._callbacksProperty][this.ioArgs.requestId](a)}};a.setObject("dojo.io.script",c);return c})},"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),function(h,k,a,f,b,e,l,m,g,d,c){function n(a,
c){a.canDelete&&u._remove(a.id,c.options.frameDoc,!0)}function q(a){B&&B.length&&(b.forEach(B,function(a){u._remove(a.id,a.frameDoc);a.frameDoc=null}),B=[]);return a.options.jsonp?!a.data:!0}function t(a){return!!this.scriptLoaded}function r(a){return(a=a.options.checkString)&&eval("typeof("+a+') !\x3d\x3d "undefined"')}function v(a,c){if(this.canDelete){var b=this.response.options;B.push({id:this.id,frameDoc:b.ioArgs?b.ioArgs.frameDoc:b.frameDoc});b.ioArgs&&(b.ioArgs.frameDoc=null);b.frameDoc=null}c?
this.reject(c):this.resolve(a)}function u(c,b,d){var g=a.parseArgs(c,a.deepCopy({},b));c=g.url;b=g.options;var f=a.deferred(g,n,q,b.jsonp?null:b.checkString?r:t,v);e.mixin(f,{id:w+x++,canDelete:!1});b.jsonp&&((new RegExp("[?\x26]"+b.jsonp+"\x3d")).test(c)||(c+=(~c.indexOf("?")?"\x26":"?")+b.jsonp+"\x3d"+(b.frameDoc?"parent.":"")+w+"_callbacks."+f.id),f.canDelete=!0,z[f.id]=function(a){g.data=a;f.handleResponse(g)});a.notify&&a.notify.emit("send",g,f.promise.cancel);if(!b.canAttach||b.canAttach(f)){var m=
u._attach(f.id,c,b.frameDoc);if(!b.jsonp&&!b.checkString)var h=l(m,y,function(a){if("load"===a.type||A.test(m.readyState))h.remove(),f.scriptLoaded=a})}l.once(m,"error",function(a){f.reject(a);u._remove(f.id,b.frameDoc,!0)});k(f);return d?f:f.promise}d.add("script-readystatechange",function(a,c){return"undefined"!==typeof c.createElement("script").onreadystatechange&&("undefined"===typeof a.opera||"[object Opera]"!==a.opera.toString())});var w=h.id.replace(/[\/\.\-]/g,"_"),x=0,y=d("script-readystatechange")?
"readystatechange":"load",A=/complete|loaded/,z=f.global[w+"_callbacks"]={},B=[];u.get=u;u._attach=function(a,b,d){d=d||c.doc;var g=d.createElement("script");g.type="text/javascript";g.src=b;g.id=a;g.async=!0;g.charset="utf-8";return d.getElementsByTagName("head")[0].appendChild(g)};u._remove=function(a,c,b){g.destroy(m.byId(a,c));z[a]&&(b?z[a]=function(){delete z[a]}:delete z[a])};u._callbacksProperty=w+"_callbacks";return u})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q){a.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");e=q._iframeName;e=e.substring(0,e.lastIndexOf("_"));var t=f.delegate(q,{create:function(){return t._frame=q.create.apply(q,arguments)},get:null,post:null,send:function(c){var d,g=b._ioSetArgs(c,function(a){d&&d.cancel()},function(c){var b=null;c=c.ioArgs;try{var g=c.handleAs;"xml"===g||"html"===g?b=d.response.data:(b=d.response.text,"json"===g?b=k.fromJson(b):"javascript"===g&&(b=a.eval(b)))}catch(D){b=
D}return b},function(a,c){c.ioArgs._hasError=!0;return a}),e=g.ioArgs,f="GET",l=m.byId(c.form);c.method&&"POST"===c.method.toUpperCase()&&l&&(f="POST");c={method:f,handleAs:"json"===c.handleAs||"javascript"===c.handleAs?"text":c.handleAs,form:c.form,query:l?null:c.content,data:l?c.content:null,timeout:c.timeout,ioArgs:e};c.method&&(c.method=c.method.toUpperCase());if(h.ioPublish&&a.publish&&!1!==e.args.ioPublish)var r=n.after(q,"_notifyStart",function(a){a.options.ioArgs===e&&(r.remove(),b._ioNotifyStart(g))},
!0);d=q(e.url,c,!0);e._callNext=d._callNext;d.then(function(){g.resolve(g)}).otherwise(function(a){g.ioArgs.error=a;g.reject(a)});return g},_iframeOnload:l.global[e+"_onload"]});f.setObject("dojo.io.iframe",t);return t})},"dojo/request/iframe":function(){define("module require ./watch ./util ./handlers ../_base/lang ../io-query ../query ../has ../dom ../dom-construct ../_base/window ../NodeList-dom".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n){function q(a){return!this.isFulfilled()}function t(a){return!!this._finished}
function r(a,c){if(!c)try{var d=a.options,g=u.doc(u._frame),f=d.handleAs;if("html"!==f){if("xml"===f)if("html"===g.documentElement.tagName.toLowerCase()){m("a",g.documentElement).orphan();var n=g.documentElement.innerText||g.documentElement.textContent,n=n.replace(/>\s+</g,"\x3e\x3c");a.text=e.trim(n)}else a.data=g;else a.text=g.getElementsByTagName("textarea")[0].value;b(a)}else a.data=g}catch(F){c=F}c?this.reject(c):this._finished?this.resolve(a):this.reject(Error("Invalid dojo/request/iframe request state"))}
function v(a){this._callNext()}function u(c,b,d){var g=f.parseArgs(c,f.deepCreate(y,b),!0);c=g.url;b=g.options;if("GET"!==b.method&&"POST"!==b.method)throw Error(b.method+" not supported by dojo/request/iframe");u._frame||(u._frame=u.create(u._iframeName,x+"();"));c=f.deferred(g,null,q,t,r,v);c._callNext=function(){this._calledNext||(this._calledNext=!0,u._currentDfd=null,u._fireNextRequest())};c._legacy=d;u._dfdQueue.push(c);u._fireNextRequest();a(c);return d?c:c.promise}var w=h.id.replace(/[\/\.\-]/g,
"_"),x=w+"_onload";n.global[x]||(n.global[x]=function(){var a=u._currentDfd;if(a){var b=d.byId(a.response.options.form)||a._tmpForm;if(b){for(var g=a._contentToClean,e=0;e<g.length;e++)for(var f=g[e],n=0;n<b.childNodes.length;n++){var l=b.childNodes[n];if(l.name===f){c.destroy(l);break}}a._originalAction&&b.setAttribute("action",a._originalAction);a._originalMethod&&(b.setAttribute("method",a._originalMethod),b.method=a._originalMethod);a._originalTarget&&(b.setAttribute("target",a._originalTarget),
b.target=a._originalTarget)}a._tmpForm&&(c.destroy(a._tmpForm),delete a._tmpForm);a._finished=!0}else u._fireNextRequest()});var y={method:"POST"};u.create=function(a,b,d){if(n.global[a])return n.global[a];if(n.global.frames[a])return n.global.frames[a];d||(g("config-useXDomain")&&!g("config-dojoBlankHtmlUrl")&&console.warn("dojo/request/iframe: When using cross-domain Dojo builds, please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl to the path on your domain to blank.html"),
d=g("config-dojoBlankHtmlUrl")||k.toUrl("dojo/resources/blank.html"));b=c.place('\x3ciframe id\x3d"'+a+'" name\x3d"'+a+'" src\x3d"'+d+'" onload\x3d"'+b+'" style\x3d"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden"\x3e',n.body());return n.global[a]=b};u.doc=function(a){if(a.contentDocument)return a.contentDocument;var c=a.name;if(c){var b=n.doc.getElementsByTagName("iframe");if(a.document&&b[c].contentWindow&&b[c].contentWindow.document)return b[c].contentWindow.document;
if(n.doc.frames[c]&&n.doc.frames[c].document)return n.doc.frames[c].document}return null};u.setSrc=function(a,c,b){a=n.global.frames[a.name];a.contentWindow&&(a=a.contentWindow);try{b?a.location.replace(c):a.location=c}catch(C){}};u._iframeName=w+"_IoIframe";u._notifyStart=function(){};u._dfdQueue=[];u._currentDfd=null;u._fireNextRequest=function(){var a;try{if(!u._currentDfd&&u._dfdQueue.length){do a=u._currentDfd=u._dfdQueue.shift();while(a&&(a.canceled||a.isCanceled&&a.isCanceled())&&u._dfdQueue.length);
if(!a||a.canceled||a.isCanceled&&a.isCanceled())u._currentDfd=null;else{var b=a.response,g=b.options,m=a._contentToClean=[],q=d.byId(g.form),h=f.notify,r=g.data||null,t;a._legacy||"POST"!==g.method||q?"GET"===g.method&&q&&-1<b.url.indexOf("?")&&(t=b.url.slice(b.url.indexOf("?")+1),r=e.mixin(l.queryToObject(t),r)):q=a._tmpForm=c.create("form",{name:w+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},n.body());if(q){if(!a._legacy){var v=q;do v=v.parentNode;while(v&&v!==n.doc.documentElement);
v||(q.style.position="absolute",q.style.left="-1000px",q.style.top="-1000px",n.body().appendChild(q));q.name||(q.name=w+"_form")}if(r){var v=function(a,b){c.create("input",{type:"hidden",name:a,value:b},q);m.push(a)},k;for(k in r){var x=r[k];if(e.isArray(x)&&1<x.length)for(t=0;t<x.length;t++)v(k,x[t]);else q[k]?q[k].value=x:v(k,x)}}var y=q.getAttributeNode("action"),H=q.getAttributeNode("method"),K=q.getAttributeNode("target");b.url&&(a._originalAction=y?y.value:null,y?y.value=b.url:q.setAttribute("action",
b.url));a._legacy?H&&H.value||(H?H.value=g.method:q.setAttribute("method",g.method)):(a._originalMethod=H?H.value:null,H?H.value=g.method:q.setAttribute("method",g.method));a._originalTarget=K?K.value:null;K?K.value=u._iframeName:q.setAttribute("target",u._iframeName);q.target=u._iframeName;h&&h.emit("send",b,a.promise.cancel);u._notifyStart(b);q.submit()}else g="",b.options.data&&(g=b.options.data,"string"!==typeof g&&(g=l.objectToQuery(g))),v=b.url+(-1<b.url.indexOf("?")?"\x26":"?")+g,h&&h.emit("send",
b,a.promise.cancel),u._notifyStart(b),u.setSrc(u._frame,v,!0)}}}catch(P){a.reject(P)}};f.addCommonMethods(u,["GET","POST"]);return u})},"esri/layers/TileInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../SpatialReference ../geometry/Point ./LOD".split(" "),function(h,k,a,f,b,e,l,m,g){h=h(null,{declaredClass:"esri.layers.TileInfo",constructor:function(b){k.mixin(this,b);this.width=this.cols;this.height=this.rows;b=this.spatialReference;var c=
this.origin;b&&(b=this.spatialReference=new l(b.toJson?b.toJson():b));c&&(this.origin=new m(c.toJson?c.toJson():c),!c.spatialReference&&b&&this.origin.setSpatialReference(new l(b.toJson())));this.lods=a.map(this.lods,function(a){return new g(a)})},toJson:function(){return e.fixJson({rows:this.rows,cols:this.cols,dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin&&this.origin.toJson(),spatialReference:this.spatialReference&&this.spatialReference.toJson(),
lods:this.lods&&a.map(this.lods,function(a){return a.toJson()})})}});return f("extend-esri")&&k.setObject("layers.TileInfo",h,b),h})},"esri/layers/LOD":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(h,k,a,f,b){h=h(null,{declaredClass:"esri.layers.LOD",constructor:function(a){k.mixin(this,a)},toJson:function(){return b.fixJson({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})}});return a("extend-esri")&&
k.setObject("layers.LOD",h,f),h})},"esri/layers/ArcGISTiledMapServiceLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has dojo/io-query ../kernel ../urlUtils ../SpatialReference ./TiledMapServiceLayer ./ArcGISMapServiceLayer ./TileInfo ./TimeInfo ./TileMap".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r){k=k([c,n],{declaredClass:"esri.layers.ArcGISTiledMapServiceLayer",_agolAttrs:"Canvas/World_Dark_Gray_Base Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Base Canvas/World_Light_Gray_Reference Elevation/World_Hillshade Ocean/World_Ocean_Base Ocean/World_Ocean_Reference Ocean_Basemap Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Transportation World_Imagery World_Street_Map World_Topo_Map".split(" "),
_isReference:!1,_referenceLayers:"Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Reference Ocean/World_Ocean_Reference Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Reference_Overlay Reference/World_Transportation".split(" "),constructor:function(c,b){b&&(b.roundrobin&&(h.deprecated(this.declaredClass+" : Constructor option 'roundrobin' deprecated. Use option 'tileServers'."),b.tileServers=b.roundrobin),this._setTileServers(b.tileServers),
this._loadCallback=b.loadCallback);this._params=a.mixin({},this._url.query);this._initLayer=a.hitch(this,this._initLayer);var d=b&&b.resourceInfo;d?this._initLayer(d):(this._load=a.hitch(this,this._load),this._load())},_TILE_FORMATS:{PNG:"png",PNG8:"png",PNG24:"png",PNG32:"png",JPG:"jpg",JPEG:"jpg",GIF:"gif"},_setTileServers:function(a){if(a&&0<a.length){this.tileServers=a;var c,b=a.length;for(c=0;b>c;c++)a[c]=g.urlToObject(a[c]).path}},_initLayer:function(a,c){if(this.inherited(arguments),this.resourceInfo=
b.toJson(a),this.tileInfo=new q(a.tileInfo),!1!==this.resampling)a.capabilities&&-1<a.capabilities.indexOf("Tilemap")?(this.resampling=!0,this.tileMap=new r(this)):this.resampling=!!a.resampling;!this.spatialReference&&this.tileInfo.spatialReference&&(this.spatialReference=new d(this.tileInfo.spatialReference.toJson()));this.isPNG32="PNG24"===this.tileInfo.format||"PNG32"===this.tileInfo.format;a.timeInfo&&(this.timeInfo=new t(a.timeInfo));a.mensurationCapabilities&&(this.mensurationCapabilities=
a.mensurationCapabilities);var e=this._url.path,f=this._loadCallback,n=g.getProtocolForWebResource(!0),l=e.match(/^https?\:\/\/(server|services)\.arcgisonline\.com\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i),l=l&&l[2];if(!this.tileServers)if(a.tileServers)this._setTileServers(a.tileServers);else{var m=-1!==e.search(/^https?\:\/\/server\.arcgisonline\.com/i),h=-1!==e.search(/^https?\:\/\/services\.arcgisonline\.com/i);(m||h)&&this._setTileServers([e,e.replace(m?/server\.arcgisonline/i:
/services\.arcgisonline/i,m?"services.arcgisonline":"server.arcgisonline")])}if(l){for(var l=l.toLowerCase(),u,e=0;e<this._agolAttrs.length;e++)if(u=this._agolAttrs[e],u.toLowerCase()===l){this.hasAttributionData=!0;this.attributionDataUrl=this.attributionDataUrl||n+"//static.arcgis.com/attribution/"+u;break}for(e=0;e<this._referenceLayers.length;e++)if(u=this._referenceLayers[e],u.toLowerCase()===l){this._isReference=!0;break}}this.loaded=!0;this.onLoad(this);f&&(delete this._loadCallback,f(this))},
getTileUrl:function(a,c,b){var d=this.tileServers,e=this._getToken(),f=this._url.query;a=(d?d[c%d.length]:this._url.path)+"/tile/"+a+"/"+c+"/"+b;return a=g.upgradeToHTTPS(a),this.resampling&&!this.tileMap&&(a+="?blankTile\x3dfalse"),f&&(a+=this.resampling&&!this.tileMap?"\x26"+l.objectToQuery(f):"?"+l.objectToQuery(f)),!e||f&&f.token||(a+=(-1===a.indexOf("?")?"?":"\x26")+"token\x3d"+e),a=this.addTimestampToURL(a),g.addProxy(a)}});return e("extend-esri")&&a.setObject("layers.ArcGISTiledMapServiceLayer",
k,m),k})},"esri/layers/TiledMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/url dojo/dom-construct dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/dom dojox/collections/ArrayList dojox/gfx/matrix ../kernel ../config ../sniff ../domUtils ../tileUtils ../geometry/Point ../geometry/Rect ../geometry/Extent ./layer".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A){h=h(A,{declaredClass:"esri.layers.TiledMapServiceLayer",
constructor:function(c,b){k.connect(this,"onLoad",this,"_initTiledLayer");this._lowestLevel=(this._displayLevels=b?b.displayLevels:null)?this._displayLevels[0]:0;this.resampling=b?b.resampling:void 0;this._resamplingTolerance=b?b.resamplingTolerance:null;this.exclusionAreas=b?b.exclusionAreas:null;var d=a.hitch;this._addImage=d(this,this._addImage);this._tileLoadHandler=d(this,this._tileLoadHandler);this._tileErrorHandler=d(this,this._tileErrorHandler);this._popTile=d(this,this._popTile);this._cleanUpRemovedImages=
d(this,this._cleanUpRemovedImages);this._fireOnUpdateEvent=d(this,this._fireOnUpdateEvent);this._transitionEnd=d(this,this._transitionEnd);this._tileMapCallback=d(this,this._tileMapCallback)},opacity:1,isPNG32:!1,_multiple:1,isResampling:!1,_initTiledLayer:function(){var a=this.tileInfo,c=a.lods;this.resampling=null!=this.resampling?this.resampling:!1;this._tileW=a.width;this._tileH=a.height;var b,d,g,e=this.scales=[],n=this._displayLevels,l=-(1/0),m=1/0;b=this.fullExtent;var q=new w(b.xmin,b.ymax),
h=new w(b.xmax,b.ymin),t=u.getContainingTileCoords,v=c.length;for(g=0;v>g;g++)d=c[g],b=t(a,q,d),d.startTileRow=0>b.row?0:b.row,d.startTileCol=0>b.col?0:b.col,b=t(a,h,d),d.endTileRow=b.row,d.endTileCol=b.col,n&&-1===f.indexOf(n,d.level)||(e[g]=d.scale,l=d.scale>l?d.scale:l,m=d.scale<m?d.scale:m);l===-(1/0)||this._hasMin||this.setMinScale(l);m===1/0||this._hasMax||this.setMaxScale(m);this.setExclusionAreas(this.exclusionAreas);this._patchIE=6<=r("ie")&&7>r("ie")&&(this.isPNG32||"Mixed"===a.format)},
isVisibleAtScale:function(a){return a?A.prototype._isMapAtVisibleScale.call(this,a,!0):!1},_isMapAtVisibleScale:function(a){var c=this.inherited(arguments,[a,!0]);if(c){var b;b=this._map;var c=this.scales,d=b.getScale(),g=!1,e=b.width>b.height?b.width:b.height;for(b=0;b<c.length;b++)if(Math.abs(c[b]-d)/c[b]<1/e){g=!0;break}c=g}return c},_setMap:function(a,c,b,d){this.inherited(arguments);this._map=a;var f=this._div=e.create("div",null,c),n=a.__visibleDelta,l=k.connect,m=q._css.names,h={position:"absolute",
width:a.width+"px",height:a.height+"px",overflow:"visible"},r=t.defaults.map.zoomDuration;"css-transforms"===a.navigationMode?(h[m.transform]=q._css.translate(-n.x,-n.y),g.set(f,h),delete h[m.transform],h[m.transition]=m.transformName+" "+r+"ms ease",g.set(this._active=e.create("div",null,f),h),this._active._remove=0,this._passives=[]):(h.left=-n.x+"px",h.top=-n.y+"px",g.set(f,h));this._onResizeHandler_connect=l(a,"onResize",this,"_onResizeHandler");this._opacityChangeHandler_connect=l(this,"onOpacityChange",
this,"_opacityChangeHandler");n=this.tileInfo;l=n.spatialReference;m=l._getInfo();if(this._wrap=a.wrapAround180&&l._isWrappable()&&Math.abs(m.origin[0]-n.origin.x)<=m.dx,this._wrap&&u._addFrameInfo(n,m),this.setExclusionAreas(this.exclusionAreas),this.evaluateSuspension(),this.suspended&&!a.loaded)var v=k.connect(a,"onLoad",this,function(){k.disconnect(v);v=null;this.setExclusionAreas(this.exclusionAreas);this.evaluateSuspension()});return f},_unsetMap:function(a,c){this.suspended||this._suspendImpl();
e.destroy(this._div);this._map=this._div=null;var b=k.disconnect;b(this._onResizeHandler_connect);b(this._opacityChangeHandler_connect);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._suspendImpl()},_suspendImpl:function(){v.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();var a,c,b,d=this._tiles,g=this._tileIds;c=this._loadingList;var f=k.disconnect,n=e.destroy;c&&0<c.count&&(c.forEach(function(c){(a=d[c])&&(f(a._onload_connect),
f(a._onerror_connect),f(a._onabort_connect),a._onload_connect=a._onerror_connect=a._onabort_connect=null)}),c.clear(),this._fireUpdateEnd());this._removeList.clear();for(c=g.length-1;0<=c;c--)(a=(b=g[c])&&d[b])&&n(a);if("css-transforms"===this._map.navigationMode){b=this._active;var l=this._passives;this._noDom=0;for(c=l.length-1;0<=c;c--)g=l[c],g._endHandle&&f(g._endHandle),g._matrix=g._multiply=g._endHandle=null,g._marked=g._remove=0,l.splice(c,1),n(g);b._matrix=b._multiply=null;b._marked=b._remove=
0}this._tileIds=this._tiles=this._tileBounds=this._ct=this._loadingList=this._removeList=this._standby=null},onResume:function(){this.inherited(arguments);this._tileIds=[];this._tiles=[];this._tileBounds=[];this._ct=null;this._removeList=new c;this._loadingList=new c;v.show(this._div);this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(a.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD)}),0)},_enableDrawConnectors:function(){var a=
this._map,c=k.connect;if("css-transforms"===a.navigationMode){if(this._onScaleHandler_connect=c(a,"onScale",this,this._onScaleHandler),r("esri-mobile")){this._standby=[];var b=this,d=function(){b._noDom=1};this._onPanStartHandler_connect=c(a,"onPanStart",d);this._onZoomStartHandler_connect=c(a,"onZoomStart",d)}}else this._onZoomHandler_connect=c(a,"onZoom",this,"_onZoomHandler");this._onPanHandler_connect=c(a,"onPan",this,"_onPanHandler");this._onExtentChangeHandler_connect=c(a,"onExtentChange",this,
"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=k.disconnect;a(this._onPanHandler_connect);a(this._onZoomHandler_connect);a(this._onScaleHandler_connect);a(this._onExtentChangeHandler_connect);a(this._onPanStartHandler_connect);a(this._onZoomStartHandler_connect);this._onPanHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=this._onExtentChangeHandler_connect=this._onPanStartHandler_connect=this._onZoomStartHandler_connect=null},_onResizeHandler:function(a,
c,b){c={width:c+"px",height:b+"px"};b=g.set;if(b(this._div,c),"css-transforms"===this._map.navigationMode)for(this._active&&b(this._active,c),a=this._passives.length-1;0<=a;a--)b(this._passives[a],c)},_onExtentChangeHandler:function(a,c,b,d){var f,l;c=this._map;var h=this._standby;if(clearTimeout(this._wakeTimer),this._wakeTimer=null,!c._isPanningOrZooming()){if("css-transforms"===c.navigationMode){if(b)for(d=this._passives.length-1;0<=d;d--)l=this._passives[d],g.set(l,q._css.names.transition,"none"),
l._marked?(this._passives.splice(d,1),l.parentNode&&l.parentNode.removeChild(l),e.destroy(l)):0<l.childNodes.length&&(l._multiply=l._multiply?n.multiply(l._matrix,l._multiply):l._matrix);if(this._noDom=0,h&&h.length)for(d=h.length-1;0<=d;d--)f=h[d],g.set(f,"visibility","inherit"),this._popTile(f),h.splice(d,1)}this._fireUpdateStart();this._rrIndex=0;d=u.getCandidateTileInfo(c,this.tileInfo,a);a=c.__visibleDelta;if(!this._ct||d.lod.level!==this._ct.lod.level||b){h=d&&this._ct&&d.lod.level!==this._ct.lod.level;
this._ct=d;var r,t=this._tiles,v=this._tileIds,k=this._tileBounds,w=this._removeList,y=v.length;this._cleanUpRemovedImages();for(d=0;y>d;d++)l=v[d],r=t[l],k[l]=v[d]=null,"css-transforms"===c.navigationMode&&h&&r.parentNode&&c.fadeOnZoom&&(r._fadeOut=h,r.parentNode._remove++),w.add(r);b&&(this._tileIds=[],this._tiles=[],this._tileBounds=[])}b=a.x;d=a.y;"css-transforms"===c.navigationMode?(l={},l[q._css.names.transform]=q._css.translate(b,d),g.set(this._div,l)):g.set(this._div,{left:b+"px",top:d+"px"});
this.__coords_dx=b;this.__coords_dy=d;this._updateImages(new x(0,0,a.width,a.height));0===this._loadingList.count?(this._cleanUpRemovedImages(),this.onUpdate(),this._fireUpdateEnd()):this._fireOnUpdate=!0;var z,C;b=this._tileW;h=this._tileH;a=new x(-a.x,-a.y,a.width,a.height);for(d=this._tileIds.length-1;0<=d;d--)(l=this._tileIds[d])?(f=this._tiles[l],z=m.getMarginBox(f),C=new x(z.l,z.t,b,h),"css-transforms"===c.navigationMode&&(C.x=f._left,C.y=f._top),a.intersects(C)?this._tileBounds[l]=C:(this._loadingList.contains(l)&&
this._popTile(f),e.destroy(f),this._tileIds.splice(d,1),delete this._tileBounds[l],delete this._tiles[l])):(this._tileIds.splice(d,1),delete this._tileBounds[l],delete this._tiles[l])}},_onPanHandler:function(a,c){var b=this._map,d=b.__visibleDelta.offset(c.x,c.y);(this.__coords_dx=this.__coords_dy=0,"css-transforms"===b.navigationMode)?(b={},b[q._css.names.transform]=q._css.translate(d.x,d.y),g.set(this._div,b),r("esri-mobile")||this._updateImages({x:-d.x,y:-d.y,width:d.width,height:d.height})):
(g.set(this._div,{left:d.x+"px",top:d.y+"px"}),this._updateImages({x:-d.x,y:-d.y,width:d.width,height:d.height}));0<this._loadingList.count&&(this._fireUpdateStart(),this._fireOnUpdate=!0)},_onScaleHandler:function(a,c){var b,d={},f=q._css.names,l=this._map,m=t.defaults.map.zoomDuration;for(b=this._passives.length-1;0<=b;b--){var h=this._passives[b];0===h.childNodes.length?(this._passives.splice(b,1),e.destroy(h)):("none"===h.style[f.transition]&&g.set(h,f.transition,f.transformName+" "+m+"ms ease"),
g.set(h,f.transition,c?"none":f.transformName+" "+m+"ms ease"),h._matrix=a,d[f.transform]=q._css.matrix(h._multiply?n.multiply(a,h._multiply):a),g.set(h,d))}this._active&&0===this._active.childNodes.length||(g.set(this._active,f.transition,c?"none":f.transformName+" "+m+"ms ease"),this._active._matrix=a,d[f.transform]=q._css.matrix(this._active._matrix),g.set(this._active,d),this._passives.push(this._active),d={position:"absolute",width:l.width+"px",height:l.height+"px",overflow:"visible"},d[f.transition]=
f.transformName+" "+m+"ms ease",g.set(this._active=e.create("div",null,this._div),d),this._active._remove=0,l.fadeOnZoom&&e.place(this._active,this._div,"first"))},_onZoomHandler:function(a,c,b){a=m.getMarginBox(this._div);b=b.offset(-a.l,-a.t);this._previousScale&&1!==c||(this._previousScale=1);var d,e,n,l=this._tileW*c,q=this._tileH*c,h=this._tileBounds,u=this._tiles,t=this._previousScale,v=this._multiple,k=g.set;if((a=r("ie"))&&8>a)f.forEach(this._tileIds,function(a){n="";d=h[a];e=u[a].style.margin.split(" ");
f.forEach(e,function(a){""!==n&&(n+=" ");a=parseFloat(a);n+=a/t*c+"px"});k(u[a],{left:d.x-(l-d.width)*(b.x-d.x)/d.width+"px",top:d.y-(q-d.height)*(b.y-d.y)/d.height+"px",margin:1!==v&&-1===n.indexOf("NaN")?n:"",zoom:c})});else{var w,x,y=l*v,z=q*v;f.forEach(this._tileIds,function(a){n="";d=h[a];w=d.x-(l-d.width)*(b.x-d.x)/d.width;x=d.y-(q-d.height)*(b.y-d.y)/d.height;e=u[a].style.margin.split(" ");f.forEach(e,function(a){""!==n&&(n+=" ");a=parseFloat(a);n+=a/t*c+"px"});k(u[a],{left:w+"px",top:x+"px",
margin:1!==v&&-1===n.indexOf("NaN")?n:"",width:y+"px",height:z+"px"})})}this._previousScale=c},_updateImages:function(a){if(this._ct){var c,b,d,g,e,n,l,m,q=this._tileW,h=this._tileH,r=this._ct;d=r.lod;var r=r.tile,u=r.offsets,t=r.coords,v=t.row,t=t.col,k=d.level,w=this.opacity,x=this._tileIds,y=this._loadingList,z=this._addImage,A=this._map.id,V=this.id,da=a.x,ga=a.y,la=d.startTileRow,Aa=d.endTileRow,ta=d.startTileCol,pa=d.endTileCol,wa=f.indexOf,oa=u.x-this.__coords_dx,ma=u.y-this.__coords_dy;m=
q-oa+-a.x;var ia=h-ma+-a.y;l=Math.ceil;m=0<m?m%q:q-Math.abs(m)%q;ia=0<ia?ia%h:h-Math.abs(ia)%h;da=0<da?Math.floor((da+oa)/q):l((da-(q-oa))/q);ga=0<ga?Math.floor((ga+ma)/h):l((ga-(h-ma))/h);ma=da+l((a.width-m)/q);a=ga+l((a.height-ia)/h);this._wrap&&(b=d._frameInfo,g=b[0],e=b[1],n=b[2]);for(l=da;ma>=l;l++)for(m=ga;a>=m;m++)b=v+m,d=t+l,this._wrap&&(e>d?(d%=g,d=e>d?d+g:d):d>n&&(d%=g)),!this._isExcluded(k,b,d)&&b>=la&&Aa>=b&&d>=ta&&pa>=d&&(c=A+"_"+V+"_tile_"+k+"_"+m+"_"+l,-1===wa(x,c)&&(y.add(c),x.push(c),
z(k,m,b,l,d,c,q,h,w,r,u)))}},_cleanUpRemovedImages:function(){var a,c=this._removeList,b=e.destroy,d=q._css.names;if(c.forEach(function(a){a._fadeOut||(a.style.filter="",a.style.zoom=1,b(a))}),"css-transforms"===this._map.navigationMode)for(a=this._passives.length-1;0<=a;a--){var f=this._passives[a];0===f.childNodes.length?(this._passives.splice(a,1),b(f)):this._map.fadeOnZoom&&!f._marked&&f._remove===f.childNodes.length&&(f._marked=1,2048>q._css.getScaleFromMatrix(g.get(f,d.transform))?(g.set(f,
d.transition,"opacity 0.65s"),g.set(f,"opacity",0),k.disconnect(f._endHandle),f._endHandle=k.connect(f,d.endEvent,this._transitionEnd)):this._transitionEnd({propertyName:"opacity",target:f}))}c.clear()},_transitionEnd:function(a){var c,b=a.target;"opacity"===a.propertyName&&(k.disconnect(b._endHandle),b._endHandle=null,c=f.indexOf(this._passives,b),-1<c&&this._passives.splice(c,1),b.parentNode&&b.parentNode.removeChild(b),e.destroy(b))},_addImage:function(c,b,d,f,n,m,h,r,u,t,v){if(this._patchIE)t=
this._tiles[m]=e.create("div"),t.id=m,l.add(t,"layerTile"),g.set(t,{left:h*f-v.x+"px",top:r*b-v.y+"px",width:h+"px",height:r+"px",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this.getTileUrl(c,d,n)+"', sizingMethod\x3d'scale')"}),1>u&&g.set(t,"opacity",u),c=t.appendChild(e.create("div")),g.set(c,{opacity:0,width:h+"px",height:r+"px"}),this._div.appendChild(t),t=null,this._loadingList.remove(m),this._fireOnUpdateEvent();else{t=this._tiles[m]=e.create("img");var w=k.connect;
t.id=m;t._uid=c+"_"+d+"_"+n;t.alt="";l.add(t,"layerTile");f=h*f-v.x;v=r*b-v.y;b=this._map;var x=q._css.names;h={width:h+"px",height:r+"px",visibility:"hidden"};("css-transforms"===b.navigationMode?(h[x.transform]=q._css.translate(f,v),g.set(t,h),t._left=f,t._top=v):(h.left=f+"px",h.top=v+"px",g.set(t,h)),1>u&&g.set(t,"opacity",u),t._onload_connect=w(t,"onload",this,"_tileLoadHandler"),t._onerror_connect=w(t,"onerror",a.hitch(this,"_tileErrorHandler",d,n)),t._onabort_connect=w(t,"onabort",this,"_tileAbortHandler"),
this.tileMap)?this.tileMap.getTile(c,d,n,m,this._tileMapCallback):(m=this.getTileUrl(c,d,n,t))&&(this._failedRequests&&this._failedRequests[m]?(g.set(t,this._failedRequests[m].css),t.src=this._failedRequests[m].src,this._multiple=parseInt(this._failedRequests[m].css.width)/this._tileW,this.isResampling=1!==this._multiple):(this._multiple=1,this.isResampling=!1,t.src=m));"css-transforms"===b.navigationMode?this._active.appendChild(t):this._div.appendChild(t);t=null}},_tileMapCallback:function(a,c){var b,
e;if(!this.suspended){e=this._tiles[c.id]||d.byId(c.id);var f=c.level+"_"+c.row+"_"+c.col;e&&e._uid===f?(this._multiple=2*(c.level-a.level)||1,this.isResampling=1!==this._multiple,b=this.tileMap.style(a,c),g.set(e,b),e.src=this.getTileUrl(a.level,a.row,a.col)):this._popTile(c)}},getTileUrl:function(a,c,b){},_reCheckTS:/[\?\&]_ts=/gi,_reReplaceTS:/([\?\&]_ts=)[0-9]+/gi,addTimestampToURL:function(a){var c=this._refreshTS;return c&&(this._reCheckTS.test(a)?a=a.replace(this._reReplaceTS,"$$$1"+c):a+=
(-1===a.indexOf("?")?"?":"\x26")+"_ts\x3d"+c),a},refresh:function(){this.suspended||(this._refreshTS=(new Date).getTime(),this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD))},_popTile:function(a){var c=k.disconnect;c(a._onload_connect);c(a._onerror_connect);c(a._onabort_connect);a._onload_connect=a._onerror_connect=a._onabort_connect=null;this._loadingList.remove(a.id);this._fireOnUpdateEvent()},_tileLoadHandler:function(a){a=a.currentTarget;return this._noDom?void this._standby.push(a):
(g.set(a,"visibility","inherit"),void this._popTile(a))},_tileAbortHandler:function(a){a=a.currentTarget;this.onError(Error("Unable to load tile: "+a.src));g.set(a,"visibility","hidden");this._popTile(a)},_tileErrorHandler:function(a,c,d){var e,f,n,l;d=d.currentTarget;var m=!0;this.tileMap||!this.resampling?m=!1:(e=new b(d.src),f=e.path.split("/"),n=parseInt(f[f.length-3]),l=this._ct.lod.level-n+1,this._multiple=Math.pow(2,l),(n===this._lowestLevel||0===this._resamplingTolerance||this._resamplingTolerance&&
Math.log(this._multiple)/Math.LN2>this._resamplingTolerance)&&(m=!1));m?(this.isResampling=!0,this._resample(d,a,c)):(this.onError(Error("Unable to load tile: "+d.src)),g.set(d,"visibility","hidden"),this._popTile(d))},_resample:function(a,c,d){var e=(new b(a.src)).path.split("/"),f=this._multiple,n=parseInt(e[e.length-3])-1,l=parseInt(c/f),m=parseInt(d/f),e=d%f,q=c%f,l=this.getTileUrl(n,l,m);c=this.getTileUrl(n+Math.log(f)/Math.LN2,c,d);f={width:this._tileW*f+"px",height:this._tileH*f+"px",margin:"-"+
this._tileW*q+"px 0 0 "+("-"+this._tileH*e+"px")};this._failedRequests||(this._failedRequests={});this._failedRequests[c]={src:l,css:f};g.set(a,f);r("chrome")&&a.setAttribute("src",null);a.src=l},_fireOnUpdateEvent:function(){0===this._loadingList.count&&(this._cleanUpRemovedImages(),this._fireOnUpdate&&(this._fireOnUpdate=!1,this.onUpdate(),this._fireUpdateEnd()))},setOpacity:function(a){this.opacity!=a&&this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_opacityChangeHandler:function(a){var c,
b,d,e=g.set;if("css-transforms"!==this._map.navigationMode)for(d=this._div.childNodes,c=d.length-1;0<=c;c--)e(d[c],"opacity",a);else{if(this._active)for(d=this._active.childNodes,c=d.length-1;0<=c;c--)e(d[c],"opacity",a);for(c=this._passives.length-1;0<=c;c--)for(d=this._passives[c].childNodes,b=d.length-1;0<=b;b--)e(d[b],"opacity",a)}},setExclusionAreas:function(a){if(this.exclusionAreas=a,this.loaded&&this._map&&this._map.loaded){var c,b,d,g,e,f,n,l,m,q,h,r,u,t=this._map.spatialReference,v=this.tileInfo,
k=v.origin,x=v.lods,z=x[0].level,A=x[x.length-1].level;if(this.exclusionAreas&&this.exclusionAreas.length)for(this._exclusionsPerZoom=[],b=0,d=a.length;d>b;b++){if(c=a[b],h=c.geometry,h&&"extent"===h.type&&h.xmin<=h.xmax&&h.ymin<=h.ymax){if(!t.equals(h.spatialReference)){if(!t._canProject(h.spatialReference))continue;t.isWebMercator()?(r=w.lngLatToXY(h.xmin,h.ymin),u=w.lngLatToXY(h.xmax,h.ymax)):(r=w.xyToLngLat(h.xmin,h.ymin,!0),u=w.xyToLngLat(h.xmax,h.ymax,!0));h=new y(r[0],r[1],u[0],u[1],t)}if(f=
-1,c.minZoom&&-1!==c.minZoom)f=c.minZoom;else if(c.minScale&&-1!==c.minScale)for(g=0,e=x.length;e>g;g++)if(x[g].scale<=c.minScale){f=x[g].level;break}if(f=Math.max(f,z),l=-1,c.maxZoom&&-1!==c.maxZoom)l=c.maxZoom;else if(c.maxScale&&-1!==c.maxScale)for(g=0,e=x.length;e>g;g++){if(x[g].scale<c.maxScale){l=x[g-1].level;break}if(x[g].scale===c.maxScale){l=x[g].level;break}}for(l=-1===l?A:Math.min(l,A);l>=f;f++){g=0;for(e=x.length;e>g;g++)if(x[g].level===f){n=x[g];break}n&&(this._exclusionsPerZoom[f]||
(this._exclusionsPerZoom[f]=[]),m=1/n.resolution/v.rows,q=1/n.resolution/v.cols,this._exclusionsPerZoom[f].push({rowFrom:Math.floor((k.y-h.ymax)*m),rowTo:Math.ceil((k.y-h.ymin)*m),colFrom:Math.floor((h.xmin-k.x)*q),colTo:Math.ceil((h.xmax-k.x)*q)}))}}}else this._exclusionsPerZoom=null;this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD)}},_isExcluded:function(a,c,b){var d,g,e;if(!this._exclusionsPerZoom||(g=this._exclusionsPerZoom[a],!g))return!1;a=0;for(e=g.length;e>
a;a++)if(d=g[a],c>=d.rowFrom&&c<d.rowTo&&b>=d.colFrom&&b<d.colTo)return!0;return!1}});return r("extend-esri")&&a.setObject("layers.TiledMapServiceLayer",h,q),h})},"dojox/collections/ArrayList":function(){define(["dojo/_base/kernel","dojo/_base/array","./_base"],function(h,k,a){a.ArrayList=function(f){var b=[];f&&(b=b.concat(f));this.count=b.length;this.add=function(a){b.push(a);this.count=b.length};this.addRange=function(a){if(a.getIterator)for(a=a.getIterator();!a.atEnd();)this.add(a.get());else for(var e=
0;e<a.length;e++)b.push(a[e]);this.count=b.length};this.clear=function(){b.splice(0,b.length);this.count=0};this.clone=function(){return new a.ArrayList(b)};this.contains=function(a){for(var e=0;e<b.length;e++)if(b[e]==a)return!0;return!1};this.forEach=function(a,f){h.forEach(b,a,f)};this.getIterator=function(){return new a.Iterator(b)};this.indexOf=function(a){for(var e=0;e<b.length;e++)if(b[e]==a)return e;return-1};this.insert=function(a,f){b.splice(a,0,f);this.count=b.length};this.item=function(a){return b[a]};
this.remove=function(a){a=this.indexOf(a);0<=a&&b.splice(a,1);this.count=b.length};this.removeAt=function(a){b.splice(a,1);this.count=b.length};this.reverse=function(){b.reverse()};this.sort=function(a){a?b.sort(a):b.sort()};this.setByIndex=function(a,f){b[a]=f;this.count=b.length};this.toArray=function(){return[].concat(b)};this.toString=function(a){return b.join(a||",")}};return a.ArrayList})},"dojox/collections/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array"],
function(h,k,a){h=k.getObject("dojox.collections",!0);h.DictionaryEntry=function(a,b){this.key=a;this.value=b;this.valueOf=function(){return this.value};this.toString=function(){return String(this.value)}};h.Iterator=function(f){var b=0;this.element=f[b]||null;this.atEnd=function(){return b>=f.length};this.get=function(){return this.atEnd()?null:this.element=f[b++]};this.map=function(b,l){return a.map(f,b,l)};this.reset=function(){b=0;this.element=f[b]}};h.DictionaryIterator=function(f){var b=[],
e={},l;for(l in f)e[l]||b.push(f[l]);var m=0;this.element=b[m]||null;this.atEnd=function(){return m>=b.length};this.get=function(){return this.atEnd()?null:this.element=b[m++]};this.map=function(g,d){return a.map(b,g,d)};this.reset=function(){m=0;this.element=b[m]}};return h})},"esri/layers/ArcGISMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../request ../SpatialReference ../geometry/Extent ./LayerInfo".split(" "),function(h,k,a,
f,b,e,l,m,g,d){h=h(null,{declaredClass:"esri.layers.ArcGISMapServiceLayer",infoTemplates:null,constructor:function(a,b){this.layerInfos=[];b&&(this.infoTemplates=b.infoTemplates||null);var c=this._params={},d=this._url.query?this._url.query.token:null;d&&(c.token=d)},setInfoTemplates:function(a){this.infoTemplates=a},_load:function(){l({url:this._url.path,content:k.mixin({f:"json"},this._params),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler})},spatialReference:null,initialExtent:null,
fullExtent:null,description:null,units:null,_initLayer:function(c,b){try{this._findCredential();(this.credential&&this.credential.ssl||c&&c._ssl)&&this._useSSL();this.description=c.description;this.copyright=c.copyrightText;this.spatialReference=c.spatialReference&&new m(c.spatialReference);this.initialExtent=c.initialExtent&&new g(c.initialExtent);this.fullExtent=c.fullExtent&&new g(c.fullExtent);this.units=c.units;this.maxRecordCount=c.maxRecordCount;this.maxImageHeight=c.maxImageHeight;this.maxImageWidth=
c.maxImageWidth;this.supportsDynamicLayers=c.supportsDynamicLayers;var f=this.layerInfos=[],n=c.layers,l=this._defaultVisibleLayers=[];(a.forEach(n,function(a,c){f[c]=new d(a);a.defaultVisibility&&l.push(a.id)}),this.visibleLayers||(this.visibleLayers=l),this.version=c.currentVersion,this.version)||(this.version="capabilities"in c||"tables"in c?10:"supportedImageFormatTypes"in c?9.31:9.3);this.capabilities=c.capabilities;e.isDefined(c.minScale)&&!this._hasMin&&this.setMinScale(c.minScale);e.isDefined(c.maxScale)&&
!this._hasMax&&this.setMaxScale(c.maxScale)}catch(v){this._errorHandler(v)}}});return f("extend-esri")&&k.setObject("layers.ArcGISMapServiceLayer",h,b),h})},"esri/layers/LayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(h,k,a,f,b){h=h(null,{declaredClass:"esri.layers.LayerInfo",constructor:function(a){k.mixin(this,a)},toJson:function(){return b.fixJson({defaultVisibility:this.defaultVisibility,id:this.id,maxScale:this.maxScale,minScale:this.minScale,
name:this.name,parentLayerId:this.parentLayerId,subLayerIds:this.subLayerIds})}});return a("extend-esri")&&k.setObject("layers.LayerInfo",h,f),h})},"esri/layers/TimeInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../TimeExtent ./TimeReference ./LayerTimeOptions".split(" "),function(h,k,a,f,b,e,l){h=h(null,{declaredClass:"esri.layers.TimeInfo",constructor:function(a){null!==a&&(k.mixin(this,a),a.exportOptions&&(this.exportOptions=new l(a.exportOptions)),this.timeExtent=
null,a.timeExtent&&2===a.timeExtent.length&&(this.timeExtent=new b(a.timeExtent)),this.timeReference=new e(a.timeReference))}});return k.mixin(h,{UNIT_CENTURIES:"esriTimeUnitsCenturies",UNIT_DAYS:"esriTimeUnitsDays",UNIT_DECADES:"esriTimeUnitsDecades",UNIT_HOURS:"esriTimeUnitsHours",UNIT_MILLISECONDS:"esriTimeUnitsMilliseconds",UNIT_MINUTES:"esriTimeUnitsMinutes",UNIT_MONTHS:"esriTimeUnitsMonths",UNIT_SECONDS:"esriTimeUnitsSeconds",UNIT_UNKNOWN:"esriTimeUnitsUnknown",UNIT_WEEKS:"esriTimeUnitsWeeks",
UNIT_YEARS:"esriTimeUnitsYears"}),a("extend-esri")&&k.setObject("layers.TimeInfo",h,f),h})},"esri/TimeExtent":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel"],function(h,k,a,f){var b=h(null,{declaredClass:"esri.TimeExtent",constructor:function(a){if(1<arguments.length)this._create(arguments[0],arguments[1]);else if(a)if(k.isArray(a)){var b=a[0],e=a[1];this.startTime=null===b||"null"===b?null:new Date(b);this.endTime=null===e||"null"===e?null:new Date(e)}else a instanceof
Date&&this._create(a,null)},offset:function(a,f){var e=new b,g=this.startTime,d=this.endTime;return g&&(e.startTime=this._getOffsettedDate(g,a,f)),d&&(e.endTime=this._getOffsettedDate(d,a,f)),e},intersection:function(a){return this._intersection(this,a)},toJson:function(){var a=[],b=this.startTime;a.push(b?b.getTime():"null");b=this.endTime;return a.push(b?b.getTime():"null"),a},_create:function(a,b){this.startTime=a?new Date(a.getTime()):null;this.endTime=b?new Date(b.getTime()):null},_refData:{esriTimeUnitsMilliseconds:{getter:"getUTCMilliseconds",
setter:"setUTCMilliseconds",multiplier:1},esriTimeUnitsSeconds:{getter:"getUTCSeconds",setter:"setUTCSeconds",multiplier:1},esriTimeUnitsMinutes:{getter:"getUTCMinutes",setter:"setUTCMinutes",multiplier:1},esriTimeUnitsHours:{getter:"getUTCHours",setter:"setUTCHours",multiplier:1},esriTimeUnitsDays:{getter:"getUTCDate",setter:"setUTCDate",multiplier:1},esriTimeUnitsWeeks:{getter:"getUTCDate",setter:"setUTCDate",multiplier:7},esriTimeUnitsMonths:{getter:"getUTCMonth",setter:"setUTCMonth",multiplier:1},
esriTimeUnitsYears:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:1},esriTimeUnitsDecades:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:10},esriTimeUnitsCenturies:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:100}},_intersection:function(a,f){if(a&&f){var e=a.startTime,g=a.endTime,d=f.startTime,c=f.endTime,e=e?e.getTime():-(1/0),d=d?d.getTime():-(1/0),g=g?g.getTime():1/0,c=c?c.getTime():1/0,n,l;if(d>=e&&g>=d?n=d:e>=d&&c>=e&&(n=e),g>=d&&c>=g?l=g:c>=e&&g>=c&&
(l=c),isNaN(n)||isNaN(l))return null;e=new b;return e.startTime=n===-(1/0)?null:new Date(n),e.endTime=l===1/0?null:new Date(l),e}return null},_getOffsettedDate:function(a,b,f){var g=this._refData;a=new Date(a.getTime());return b&&f&&(g=g[f],a[g.setter](a[g.getter]()+b*g.multiplier)),a}});return a("extend-esri")&&(f.TimeExtent=b),b})},"esri/layers/TimeReference":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.layers.TimeReference",
constructor:function(a){a&&k.mixin(this,a)}});return a("extend-esri")&&k.setObject("layers.TimeReference",h,f),h})},"esri/layers/LayerTimeOptions":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(h,k,a,f,b){h=h(null,{declaredClass:"esri.layers.LayerTimeOptions",constructor:function(a){a&&k.mixin(this,a)},toJson:function(){return b.fixJson({timeDataCumulative:this.timeDataCumulative,timeOffset:this.timeOffset,timeOffsetUnits:this.timeOffsetUnits,
useTime:this.useTime})}});return a("extend-esri")&&k.setObject("layers.LayerTimeOptions",h,f),h})},"esri/layers/TileMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/io-query ../request ../urlUtils ../sniff".split(" "),function(h,k,a,f,b,e,l,m){var g=m("esri-iphone");return h(null,{declaredClass:"esri.layers.TileMap",constructor:function(a){this.layer=a;this._tileMaps={}},getTile:function(a,c,b,g,e){a={id:g,level:a,row:c,col:b};c=this._getResamplingBudget();
0<c?this._process({tile:a,requestedTile:a,callback:e,resamplingBudget:c}):(e||this.callback).call(this,a,a)},statusOf:function(a,c,b){var d,g=this._getResamplingBudget();a={level:a,row:c,col:b};if(0===g)return 1;for(;0<=g;){if((d=this._tileToTileMap(a),!this._tileMaps[d.uid])||(d=this._tileMaps[d.uid],!d.promise.isFulfilled()))return-1;if(this._isTileAvailable(a,d))return 1;if(a=this._parentTile(a),!a)break;g--}return 0},style:function(a,c){if(a.level!==c.level||a.row!==c.row||a.col!==c.col){for(var b,
d,e=this.layer.tileInfo,f=e.lods,l=e.cols,e=e.rows,m=f.length-1;!b||!d;)b||f[m].level!==a.level||(b=f[m]),d||f[m].level!==c.level||(d=f[m]),m--;d=Math.round(b.resolution/d.resolution);f=c.col%d*-1*l;b=c.row%d*-1*e;d={width:l*d+"px",height:e*d+"px",margin:b+"px 0 0 "+f+"px","will-change":"transform"};g&&(f=0===f?0:-1*f,b=0===b?0:-1*b,d.clip="rect("+b+"px,"+(f+l)+"px,"+(b+e)+"px,"+f+"px)");return d}},_process:function(a){var c=a.tile,b=this._tileToTileMap(c),d=this._parentTile(c);this._getTileMap(b).then(k.hitch(this,
function(g){b=g;this._isTileAvailable(c,b)?(a.callback||this.callback).call(this,c,a.requestedTile):0<a.resamplingBudget&&d?(a.resamplingBudget--,a.tile=d,this._process(a)):(a.callback||this.callback).call(this,a.requestedTile,a.requestedTile)}),k.hitch(this,function(){(a.callback||this.callback).call(this,a.requestedTile,a.requestedTile)}))},_getTileMap:function(a){var c,b,d,g,l=null;return this._tileMaps[a.uid]?(a=this._tileMaps[a.uid],c=a.promise):(this._tileMaps[a.uid]=a,b=new f,e({url:this._getTileMapUrl(a.level,
a.row,a.col),handleAs:"json",callbackParamName:"callback",timeout:3E3,load:function(c){if(k.mixin(a,c),a.data&&0<a.data.length){if(g=a.data.length,1===g)l=a.data[0];else for(l=a.data[0],d=1;g>d;d++)if(a.data[d]!==l){l=null;break}null!==l&&(delete a.data,a.value=l)}b.resolve(a)},error:function(a){b.reject()}}),c=a.promise=b.promise),c},_parentTile:function(b){var c,d,g,e=this.layer.tileInfo.lods,f=null;return a.some(e,function(a,g){return b.level===a.level?(c=a,d=g,!0):!1}),0<d&&(g=e[d-1],f={id:b.id,
level:g.level,row:Math.floor(b.row*c.resolution/g.resolution+.01),col:Math.floor(b.col*c.resolution/g.resolution+.01)}),f},_tileToTileMap:function(a){var c=8*Math.floor(a.row/8),b=8*Math.floor(a.col/8);return{uid:a.level+"_"+c+"_"+b,level:a.level,row:c,col:b}},_isTileAvailable:function(a,c){var b,d,g;return c.valid?void 0!==c.value?g=c.value:(b=c.location.left,d=c.location.top,g=(a.row-d)*c.location.width+(a.col-b),g=g<c.data.length?c.data[g]:0):g=0,g},_getTileMapUrl:function(a,c,g){var d=this.layer,
e=d.tileServers,f=d._getToken(),n=d._url.query;a=(e?e[c%e.length]:d._url.path)+"/tilemap/"+a+"/"+c+"/"+g+"/8/8";return n&&(a+="?"+b.objectToQuery(n)),!f||n&&n.token||(a+=(-1===a.indexOf("?")?"?":"\x26")+"token\x3d"+f),a=d.addTimestampToURL(a)},_getResamplingBudget:function(){var a=this.layer,c=0;return a.resampling&&(c=a._resamplingTolerance,(null===c||void 0===c)&&(c=a.tileInfo.lods.length)),c}})})},"esri/layers/MapImageLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style ../kernel ../config ../sniff ../domUtils ../geometry/Point ../geometry/webMercatorUtils ./layer".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q){var t=h([q],{declaredClass:"esri.layers.MapImageLayer","-chains-":{constructor:"manual"},constructor:function(c){this.inherited(arguments,[null,c]);this._mapImages=[];var b=a.hitch;this._panStart=b(this,this._panStart);this._pan=b(this,this._pan);this._extentChange=b(this,this._extentChange);this._zoom=b(this,this._zoom);this._zoomStart=b(this,this._zoomStart);this._scale=b(this,this._scale);this._resize=b(this,this._resize);k.connect(this,"onSuspend",this,this._onSuspend);
k.connect(this,"onResume",this,this._onResume);this.loaded=!0;this.onLoad(this)},opacity:1,addImage:function(a){var c=this._mapImages.push(a),c=c-1;a._idx=c;a._layer=this;this._div&&this._createImage(a,c)},removeImage:function(a){if(a){var c=a._idx,d=this._mapImages;d[c]===a&&(delete d[c],(c=a._node)&&(this._clearEvents(c),c.e_idx=c.e_bl=c.e_tr=c.e_l=c.e_t=c.e_w=c.e_h=null,c.parentNode&&(c.parentNode.removeChild(c),b.destroy(c))),a._node=a._idx=a._layer=null)}},removeAllImages:function(){var a,c=
this._mapImages,b=c.length;for(a=0;b>a;a++){var d=c[a];d&&this.removeImage(d)}this._mapImages=[]},getImages:function(){var a,c=this._mapImages,b=[],d=c.length;for(a=0;d>a;a++)c[a]&&b.push(c[a]);return b},setOpacity:function(a){this.opacity!=a&&(this._opacityChanged(this.opacity=a),this.onOpacityChange())},onOpacityChange:function(){},_opacityChanged:function(a){var c,b,d;if(c=this._div)if(!g("ie")||8<g("ie"))e.set(c,"opacity",a);else for(d=c.childNodes,b=d.length,c=0;b>c;c++)e.set(d[c],"opacity",
a)},_createImage:function(a,c){var d=b.create("img");e.set(d,{position:"absolute"});1>a.opacity?e.set(d,"opacity",a.opacity):8>=g("ie")&&e.set(d,"opacity",this.opacity);a.rotation&&(9>g("ie")||e.set(d,l._css.names.transform,l._css.rotate(360-a.rotation)));a._node=d;d.e_idx=c;d.e_layer=this;d.e_load=k.connect(d,"onload",t.prototype._imageLoaded);d.e_error=k.connect(d,"onerror",t.prototype._imageError);d.e_abort=k.connect(d,"onabort",t.prototype._imageError);d.src=a.href},_imageLoaded:function(a,c){var b=
c||a.target||a.currentTarget,d=b.e_layer,g=d._mapImages[b.e_idx],e=d._map;return e&&(e.__zooming||e.__panning||!d._sr)?void d._standby.push(b):(d._clearEvents(b),void(g&&g._node===b&&e&&d._attach(g)))},_imageError:function(a){a=a.target||a.currentTarget;var c=a.e_layer,b=c._mapImages[a.e_idx];c._clearEvents(a);b&&(b._node=null)},_clearEvents:function(a){var c=k.disconnect;c(a.e_load);c(a.e_error);c(a.e_abort);a.e_load=a.e_error=a.e_abort=a.e_layer=null},_attach:function(a){var b=a.extent,d=b.spatialReference,
g=this._sr,e=this._div,f=a._node,l=new c({x:b.xmin,y:b.ymin,spatialReference:d}),b=new c({x:b.xmax,y:b.ymax,spatialReference:d});g.equals(d)||(g.isWebMercator()&&4326===d.wkid?(l=n.geographicToWebMercator(l),b=n.geographicToWebMercator(b)):d.isWebMercator()&&4326===g.wkid&&(l=n.webMercatorToGeographic(l),b=n.webMercatorToGeographic(b)));f.e_bl=l;f.e_tr=b;a.visible&&(this._setPos(f,e._left,e._top),(this._active||e).appendChild(f))},_setPos:function(a,c,b){var d=a.e_bl,g=a.e_tr,f=this._map,d=f.toScreen(d),
g=f.toScreen(g);c=d.x-c;b=g.y-b;var n=Math.abs(g.x-d.x),d=Math.abs(d.y-g.y),g={width:n+"px",height:d+"px"},m=this._mapImages[a.e_idx];"css-transforms"===f.navigationMode?g[l._css.names.transform]=l._css.translate(c,b)+(m.rotation?" "+l._css.rotate(360-m.rotation):""):(g.left=c+"px",g.top=b+"px");e.set(a,g);a.e_l=c;a.e_t=b;a.e_w=n;a.e_h=d},managedSuspension:!0,_setMap:function(a,c){this.inherited(arguments);var f=this._div=b.create("div",null,c),n=l._css.names,m={position:"absolute"},q=a.__visibleDelta;
(!g("ie")||8<g("ie"))&&(m.opacity=this.opacity);"css-transforms"===a.navigationMode?(m[n.transform]=l._css.translate(q.x,q.y),e.set(f,m),f._left=q.x,f._top=q.y,m={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible"},this._active=b.create("div",null,f),e.set(this._active,m),this._passive=b.create("div",null,f),e.set(this._passive,m)):(f._left=0,f._top=0,e.set(f,m));this._standby=[];m=this._mapImages;q=m.length;for(n=0;q>n;n++){var h=m[n];h._node||this._createImage(h,h._idx)}return d.hide(f),
f},_unsetMap:function(a,c){this._disconnect();var d=this._div;if(d){var g,e=this._mapImages,f=e.length;for(g=0;f>g;g++){var n=e[g];if(n){var l=n._node;l&&(this._clearEvents(l),l.e_idx=l.e_bl=l.e_tr=l.e_l=l.e_t=l.e_w=l.e_h=null);n._node=null}}c.removeChild(d);b.destroy(d)}this._map=this._div=this._sr=this._active=this._passive=this._standby=null;this.inherited(arguments)},_onSuspend:function(){this._disconnect();d.hide(this._div)},_onResume:function(a){a.firstOccurrence&&(this._sr=this._map.spatialReference,
this._processStandbyList());a=this._map;var c=this._div,b=a.__visibleDelta;"css-transforms"===a.navigationMode&&(c._left=b.x,c._top=b.y,e.set(c,l._css.names.transform,l._css.translate(c._left,c._top)));this._redraw("css-transforms"===a.navigationMode);this._connect(a);d.show(c)},_connect:function(a){if(!this._connections){var c=k.connect,b="css-transforms"===a.navigationMode;this._connections=[c(a,"onPanStart",this._panStart),c(a,"onPan",this._pan),c(a,"onExtentChange",this._extentChange),b&&c(a,
"onZoomStart",this._zoomStart),b?c(a,"onScale",this._scale):c(a,"onZoom",this._zoom),b&&c(a,"onResize",this._resize)]}},_disconnect:function(){this._connections&&(f.forEach(this._connections,k.disconnect),this._connections=null)},_panStart:function(){this._panL=this._div._left;this._panT=this._div._top},_pan:function(a,c){var b=this._div;b._left=this._panL+c.x;b._top=this._panT+c.y;"css-transforms"===this._map.navigationMode?e.set(b,l._css.names.transform,l._css.translate(b._left,b._top)):e.set(b,
{left:b._left+"px",top:b._top+"px"})},_extentChange:function(a,c,b){b?this._redraw("css-transforms"===this._map.navigationMode):c&&this._pan(a,c);this._processStandbyList()},_processStandbyList:function(){var a,c=this._standby;if(c&&c.length)for(a=c.length-1;0<=a;a--)this._imageLoaded(null,c[a]),c.splice(a,1)},_redraw:function(a){if(a){a=this._passive;var c=l._css.names;e.set(a,c.transition,"none");this._moveImages(a,this._active);e.set(a,c.transform,"none")}var b=this._active||this._div,d=this._div._left,
g=this._div._top,f=b.childNodes.length;for(a=0;f>a;a++)c=b.childNodes[a],this._setPos(c,d,g)},_zoom:function(a,c,b){var d,g=this._div,f=g._left,n=g._top,l=g.childNodes.length;for(a=0;l>a;a++){d=g.childNodes[a];var m=d.e_w*c,q=d.e_h*c,h=(b.x-f-d.e_l)*(m-d.e_w)/d.e_w,u=(b.y-n-d.e_t)*(q-d.e_h)/d.e_h,h=isNaN(h)?0:h,u=isNaN(u)?0:u;e.set(d,{left:d.e_l-h+"px",top:d.e_t-u+"px",width:m+"px",height:q+"px"})}},_zoomStart:function(){this._moveImages(this._active,this._passive)},_moveImages:function(a,c){var b,
d=a.childNodes;b=d.length;if(0<b)for(--b;0<=b;b--)c.appendChild(d[b])},_scale:function(a,c){var b=l._css.names,d=this._passive;e.set(d,b.transition,c?"none":b.transformName+" "+m.defaults.map.zoomDuration+"ms ease");({})[b.transform]=l._css.matrix(a);e.set(d,b.transform,l._css.matrix(a))},_resize:function(a,c,b){e.set(this._active,{width:c+"px",height:b+"px"});e.set(this._passive,{width:c+"px",height:b+"px"})}});return g("extend-esri")&&a.setObject("layers.MapImageLayer",t,l),t})},"esri/layers/OpenStreetMapLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),
function(h,k,a,f,b,e,l,m,g){h=h(m,{declaredClass:"esri.layers.OpenStreetMapLayer",constructor:function(a){this.spatialReference=new e({wkid:102100});this.tileInfo=new g({rows:256,cols:256,dpi:96,format:"PNG8",compressionQuality:0,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,scale:5.91657527591555E8,resolution:156543.033928},{level:1,scale:2.95828763795777E8,resolution:78271.5169639999},{level:2,scale:1.47914381897889E8,resolution:39135.7584820001},
{level:3,scale:7.3957190948944E7,resolution:19567.8792409999},{level:4,scale:3.6978595474472E7,resolution:9783.93962049996},{level:5,scale:1.8489297737236E7,resolution:4891.96981024998},{level:6,scale:9244648.868618,resolution:2445.98490512499},{level:7,scale:4622324.434309,resolution:1222.99245256249},{level:8,scale:2311162.217155,resolution:611.49622628138},{level:9,scale:1155581.108577,resolution:305.748113140558},{level:10,scale:577790.554289,resolution:152.874056570411},{level:11,scale:288895.277144,
resolution:76.4370282850732},{level:12,scale:144447.638572,resolution:38.2185141425366},{level:13,scale:72223.819286,resolution:19.1092570712683},{level:14,scale:36111.909643,resolution:9.55462853563415},{level:15,scale:18055.954822,resolution:4.77731426794937},{level:16,scale:9027.977411,resolution:2.38865713397468},{level:17,scale:4513.988705,resolution:1.19432856685505},{level:18,scale:2256.994353,resolution:.597164283559817},{level:19,scale:1128.497176,resolution:.298582141647617}]});this.fullExtent=
new l({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.initialExtent=new l({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.tileServers=a&&a.tileServers||["//a.tile.openstreetmap.org","//b.tile.openstreetmap.org","//c.tile.openstreetmap.org"];this.serversLength=this.tileServers.length;this._displayLevels=a?a.displayLevels:null;this.copyright=a&&a.copyright||"Map data \u00a9 OpenStreetMap contributors, CC-BY-SA";
this.loaded=!0;this.onLoad(this);(a=a&&a.loadCallback)&&a(this)},getTileUrl:function(a,c,g){a=this.tileServers[c%this.serversLength]+"/"+a+"/"+g+"/"+c+".png";return a=b.normalize(a),a=this.addTimestampToURL(a),b.addProxy(a)}});return a("extend-esri")&&k.setObject("layers.OpenStreetMapLayer",h,f),h})},"esri/layers/VectorTileLayer":function(){!function(){var h=function(){var a;try{a=window.WebGLRenderingContext}catch(g){a=!1}var f;try{for(var b=document.createElement("canvas"),e=["webgl","experimental-webgl",
"webkit-3d","moz-webgl"],l=null,m=0;m<e.length;++m){try{l=b.getContext(e[m])}catch(g){}if(l)break}f=l}catch(g){f=!1}return a&&f?!0:!1}(),k=["dojo/_base/lang","dojo/has","dojo/Deferred","../sniff","./layer"];h&&k.push("./VectorTileLayerImpl");define(k,function(a,f,b,e,l,m){var g;return g=m?m:l.createSubclass({declaredClass:"esri.layers.VectorTileLayer",constructor:function(){var d=new b;d.reject(Error("esri.layers.VectorTileLayer is not supported"));d.promise.otherwise(a.hitch(this,function(a){this._errorHandler(a)}))}}),
g.ACCESS_TOKEN=null,g.supported=function(){return h},f("extend-esri")&&a.setObject("layers.VectorTileLayer",g,e),g})}()},"esri/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/window dojo/Stateful dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/registry ../kernel ../lang ../domUtils ../geometry/Polyline ../geometry/Polygon ../geometry/normalizeUtils ../InfoWindowBase ../PopupBase dojo/i18n!../nls/jsapi dojo/NodeList-dom require require".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D){h=h([B,C,m],{declaredClass:"esri.dijit.Popup",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:25,marginTop:25,highlight:!0,pagingControls:!0,pagingInfo:!0,keepHighlightOnHide:!1,popupWindow:!0,titleInBody:!0,anchor:"auto",visibleWhenEmpty:!0,hideDelay:1E3,location:null,constructor:function(a,g){this.initialize();k.mixin(this,a);this.domNode=d.byId(g);var l=this._nls=k.mixin({},D.widgets.popup),m=this.domNode;n.add(m,"esriPopup");(this._isRTL=
!t.isBodyLtr())&&r.set(m,"direction","rtl");c.set(m,"innerHTML","\x3cdiv class\x3d'esriPopupWrapper' style\x3d'position: absolute;'\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden' title\x3d'"+l.NLS_searching+"...'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton prev hidden' title\x3d'"+l.NLS_prevFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden' title\x3d'"+l.NLS_nextFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton maximize' title\x3d'"+
l.NLS_maximize+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close' title\x3d'"+l.NLS_close+"'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer content'\x3e\x3cdiv class\x3d'contentPane'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'actionsPane'\x3e\x3cdiv class\x3d'actionList hidden'\x3e\x3ca title\x3d"+l.NLS_zoomTo+" class\x3d'action zoomTo' href\x3d'javascript:void(0);'\x3e\x3cspan\x3e"+l.NLS_zoomTo+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'outerPointer hidden'\x3e\x3c/div\x3e");
this._sizers=b.query(".sizer",m);l=b.query(".titlePane",m)[0];if(d.setSelectable(l,!1),this._title=b.query(".title",l)[0],this._prevFeatureButton=b.query(".prev",l)[0],this._nextFeatureButton=b.query(".next",l)[0],this._maxButton=b.query(".maximize",l)[0],this._spinner=b.query(".spinner",l)[0],this._contentPane=b.query(".contentPane",m)[0],this._positioner=b.query(".esriPopupWrapper",m)[0],this._pointer=b.query(".pointer",m)[0],this._outerPointer=b.query(".outerPointer",m)[0],this._actionList=b.query(".actionsPane .actionList",
m)[0],this._eventConnections=[f.connect(b.query(".close",l)[0],"onclick",this,this.hide),f.connect(this._prevFeatureButton,"onclick",this,this.selectPrevious),f.connect(this._nextFeatureButton,"onclick",this,this.selectNext),f.connect(this._maxButton,"onclick",this,this._toggleSize),f.connect(b.query(".zoomTo",this._actionList)[0],"onclick",this,this._zoomToFeature),f.connect(this,"onClearFeatures",this,this._featuresCleared),f.connect(this,"onSelectionChange",this,this._featureSelected),f.connect(this,
"onDfdComplete",this,this._updateUI)],e("esri-touch"))m=x.setScrollable(this._contentPane),this._eventConnections.push(m[0],m[1]);this._toggleVisibility(!1)},onMaximize:function(){},onRestore:function(){},setMap:function(a){this.inherited(arguments);q.place(this.domNode,a.root);this.highlight&&this.enableHighlight(a);this._maxHeight=r.get(this._contentPane,"maxHeight")},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(a){this.popupWindow&&(w.isDefined(a)&&
""!==a||(a="\x26nbsp;"),this.destroyDijits(this._title),this.place(a,this._title),this.isShowing&&(this.startupDijits(this._title),this.reposition()))},setContent:function(a){this.popupWindow&&(w.isDefined(a)&&""!==a||(a="\x26nbsp;"),this.destroyDijits(this._contentPane),this.place(a,this._contentPane),this.isShowing&&(this.startupDijits(this._contentPane),this.reposition()))},show:function(a,c){if(this.popupWindow){if(this._delayHide=!1,!a)return void this._toggleVisibility(!0);var b,d=this.map;
a.spatialReference?(this.location=a,b=d.toScreen(a)):(this.location=d.toMap(a),b=a);var g=d._getFrameWidth();if(-1!==g&&(b.x%=g,0>b.x&&(b.x+=g),d.width>g))for(d=(d.width-g)/2;b.x<d;)b.x+=g;this._maximized?this.restore():this._setPosition(b);c&&c.closestFirst&&this.showClosestFirst(this.location);this.isShowing||(this._toggleVisibility(!0),this._followMap(),this.startupDijits(this._title),this.startupDijits(this._contentPane),this.reposition(),this.showHighlight(),this.onShow())}},hide:function(){this.isShowing&&
(this._toggleVisibility(!1),this._unfollowMap(),this.keepHighlightOnHide||this.hideHighlight(),this.onHide())},resize:function(a,c){this.popupWindow&&(this._sizers.style({width:a+"px"}),r.set(this._contentPane,"maxHeight",c+"px"),this._maxHeight=c,this.isShowing&&this.reposition())},reposition:function(){this.popupWindow&&this.map&&this.location&&!this._maximized&&this.isShowing&&this._setPosition(this.map.toScreen(this.location))},maximize:function(){var a=this.map;if(a&&!this._maximized&&this.popupWindow){this._maximized=
!0;var b=this._maxButton;n.remove(b,"maximize");n.add(b,"restore");c.set(b,"title",this._nls.NLS_restore);var b=this.marginLeft,d=this.marginTop,g=a.width-2*b,a=a.height-2*d;r.set(this.domNode,{left:this._isRTL?null:b+"px",right:this._isRTL?b+"px":null,top:d+"px",bottom:null});r.set(this._positioner,{left:null,right:null,top:null,bottom:null});this._savedWidth=r.get(this._sizers[0],"width");this._savedHeight=r.get(this._contentPane,"maxHeight");this._sizers.style({width:g+"px"});r.set(this._contentPane,
{maxHeight:a-65+"px",height:a-65+"px"});this._showPointer("");this._unfollowMap();n.add(this.domNode,"esriPopupMaximized");this.onMaximize()}},restore:function(){if(this.map&&this._maximized&&this.popupWindow){this._maximized=!1;var a=this._maxButton;n.remove(a,"restore");n.add(a,"maximize");c.set(a,"title",this._nls.NLS_maximize);r.set(this._contentPane,"height",null);this.resize(this._savedWidth,this._savedHeight);this._savedWidth=this._savedHeight=null;this.show(this.location);this._followMap();
n.remove(this.domNode,"esriPopupMaximized");this.onRestore()}},startup:function(){},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);this.destroyDijits(this._content);a.forEach(this._eventConnections,f.disconnect);q.destroy(this.domNode);this._sizers=this._contentPane=this._actionList=this._positioner=this._pointer=this._outerPointer=this._title=this._prevFeatureButton=this._nextFeatureButton=this._spinner=this._eventConnections=
this._pagerScope=this._targetLocation=this._nls=this._maxButton=null},selectNext:function(){this.select(this.selectedIndex+1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(){this.inherited(arguments);this._updateUI()},postscript:null,_highlightSetter:function(a){var c=this.highlight,b=this.map;if(this.highlight=a,b&&a!==c)a?(this.enableHighlight(b),(a=this.features&&this.features[this.selectedIndex])&&(this.updateHighlight(b,a),this.showHighlight())):this.disableHighlight(b)},
_pagingControlsSetter:function(a){var c=this.pagingControls,b=this.map;this.pagingControls=a;b&&a!==c&&this._updatePagingControls()},_pagingInfoSetter:function(a){var c=this.pagingInfo,b=this.map;this.pagingInfo=a;b&&a!==c&&this.features&&this.features.length&&this._updatePagingInfo()},_popupWindowSetter:function(a){var c=this.popupWindow,b=this.map;this.popupWindow=a;b&&a!==c&&(a?(this._updateUI(),this._updateWindow()):(this.hide(),this.showHighlight()))},_anchorSetter:function(a){var c=this.anchor;
this.anchor=a;this.map&&a!==c&&this.reposition()},_featuresCleared:function(){this.setTitle("\x26nbsp;");this.setContent("\x26nbsp;");this._setPagerCallbacks(this);this._updateUI();this.hideHighlight()},_featureSelected:function(){this._updateUI();this._updateWindow()},_updateWindow:function(){var a=this.selectedIndex;if(0<=a){var c,b=this.features[a].getContent();!this.titleInBody&&b&&k.isString(b.id)&&(c=v.byId(b.id),c&&c.set&&/_PopupRenderer/.test(c.declaredClass)&&c.set("showTitle",!1));this.setContent(b);
this.updateHighlight(this.map,this.features[a]);this.showHighlight()}},_toggleVisibility:function(a){this._setVisibility(a);this.isShowing=a},_setVisibility:function(a){n.toggle(this.domNode,"esriPopupVisible",a);n.toggle(this.domNode,"esriPopupHidden",!a)},_waitAndHide:function(a){var c=this;this._delayHide=!0;setTimeout(function(){c._delayHide&&(c._delayHide=!1,c.hide())},a)},_followMap:function(){this._unfollowMap();var a=this.map;this._handles=[f.connect(a,"onPanStart",this,this._onPanStart),
f.connect(a,"onPan",this,this._onPan),f.connect(a,"onZoomStart",this,this._onZoomStart),f.connect(a,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var c=this._handles;c&&(a.forEach(c,f.disconnect),this._handles=null)},_onPanStart:function(){var a=this.domNode.style;this._panOrigin={left:a.left,top:a.top,right:a.right,bottom:a.bottom}},_onPan:function(a,c){var b=this._panOrigin,d=c.x,g=c.y,e=b.left,f=b.top,n=b.right,b=b.bottom;e&&(e=parseFloat(e)+d+"px");f&&(f=parseFloat(f)+
g+"px");n&&(n=parseFloat(n)-d+"px");b&&(b=parseFloat(b)-g+"px");r.set(this.domNode,{left:e,top:f,right:n,bottom:b})},_onZoomStart:function(){this._setVisibility(!1)},_onExtentChange:function(a,c,b){b&&(this._setVisibility(!0),this.show(this._targetLocation||this.location));this._targetLocation=null},_toggleSize:function(){this._maximized?this.restore():this.maximize()},_setPosition:function(a){var c=a.x,b=a.y;a=this.offsetX||0;var d=this.offsetY||0,g=0,e=0,f=t.position(this.map.container,!0),n=f.w,
m=f.h,q="Left",h="bottom",u=t.getContentBox(this._positioner),v=u.w/2,k=u.h/2,w=r.get(this._sizers[0],"height")+this._maxHeight+r.get(this._sizers[2],"height"),x=w/2,y=0,z=0,C=c,A=b,B=this.anchor.toLowerCase();"auto"===B?((B=l.getBox)&&(B=B(),y=Math.max(B.l,f.x),n=Math.min(B.l+B.w,f.x+f.w),z=Math.max(B.t,f.y),m=Math.min(B.t+B.h,f.y+f.h),C+=f.x,A+=f.y),f=A-z>=w,w=m-A>=w,B=n-C>=u.w,u=C-y>=u.w,A-z>x&&m-A>=x&&(B?(h="",q="Left"):u&&(h="",q="Right")),q&&h&&C-y>v&&n-C>=v&&(f?(q="",h="bottom"):w&&(q="",h=
"top")),q&&h&&(B&&f?(q="Left",h="bottom"):B&&w?(q="Left",h="top"):u&&w?(q="Right",h="top"):u&&f&&(q="Right",h="bottom"))):(h=q="",-1!==B.indexOf("top")?h="bottom":-1!==B.indexOf("bottom")&&(h="top"),-1!==B.indexOf("left")?q="Right":-1!==B.indexOf("right")&&(q="Left"));x=h+q;switch(x){case "top":case "bottom":e=14;break;case "Left":case "Right":g=13;break;case "topLeft":case "topRight":case "bottomLeft":case "bottomRight":e=14,g=-16}r.set(this.domNode,{left:c+"px",top:b+"px",right:null,bottom:null});
c={left:null,right:null,top:null,bottom:null};q?c[q.toLowerCase()]=g+a+"px":c.left=-v+"px";h?c[h]=e+d+"px":c.top=-k+"px";r.set(this._positioner,c);this._showPointer(x)},_showPointer:function(a){n.remove(this._pointer,"top bottom right left topLeft topRight bottomRight bottomLeft hidden".split(" "));n.remove(this._outerPointer,["right","left","hidden"]);"Right"===a||"Left"===a?(a=a.toLowerCase(),n.add(this._outerPointer,a)):n.add(this._pointer,a)},_setPagerCallbacks:function(a,c,b){if(this.pagingControls&&
(a!==this||this._pagerScope&&this._pagerScope!==this)&&a!==this._pagerScope){this._pagerScope=a;a===this&&(c=this.selectPrevious,b=this.selectNext);var d=this._eventConnections;f.disconnect(d[1]);f.disconnect(d[2]);c&&(d[1]=f.connect(this._prevFeatureButton,"onclick",a,c));b&&(d[2]=f.connect(this._nextFeatureButton,"onclick",a,b))}},_getLocation:function(a){var c,b;if(a=a&&a.geometry)switch(a.type){case "point":c=a;break;case "multipoint":c=a.getPoint(0);b=z.getDenormalizedExtent(a);break;case "polyline":case "polygon":c=
a.getPoint(0,0),b=z.getDenormalizedExtent(a)}return[c,b]},_zoomToFeature:function(a){a.preventDefault();var c=this.features,b=this.selectedIndex;a=this.map;if(c)if(b=this._getLocation(c[b]),c=b[0],b=b[1],c||(c=this.location),b&&b.intersects(this.location)||(this.location=c),b&&b.getWidth()&&b.getHeight())a.setExtent(b,!0);else{var d=a.getNumLevels(),b=a.getLevel(),g=a.getMaxZoom(),e=this.zoomFactor||1;0<d?b!==g&&(d=b+e,d>g&&(d=g),a.navigationManager._wheelZoom({value:d-b,mapPoint:c},!0)):a.navigationManager._wheelZoom({value:1/
Math.pow(2,e)*2,mapPoint:c},!0)}},_updatePagingControls:function(){var a=this._prevFeatureButton,c=this._nextFeatureButton,b=this.selectedIndex,d=this.features?this.features.length:0;this.pagingControls&&1<d?(0===b?n.add(a,"hidden"):n.remove(a,"hidden"),b===d-1?n.add(c,"hidden"):n.remove(c,"hidden")):(n.add(a,"hidden"),n.add(c,"hidden"))},_updatePagingInfo:function(){var a,c,b,d=this.features?this.features.length:0,g=this._nls,e="\x26nbsp;";this.pagingInfo&&1<d&&g.NLS_pagingInfo&&(e=w.substitute({index:this.selectedIndex+
1,total:d},g.NLS_pagingInfo));d&&(a=this.getSelectedFeature(),c=a.getInfoTemplate(),b=a.getTitle(),c&&!/esri\.InfoTemplate/.test(c.declaredClass)&&this.titleInBody||!b||(e=b+("\x26nbsp;"===e?"":" "+e)));this.setTitle(e)},_updateUI:function(){if(this.popupWindow){var a=this.features,c=this.deferreds,b=a?a.length:0,d=this._spinner,g=this._actionList,e=this._nls;this._updatePagingControls();this._updatePagingInfo();b?n.remove(g,"hidden"):n.add(g,"hidden");c&&c.length?a?n.remove(d,"hidden"):this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+
e.NLS_searching+"...\x3c/div\x3e"):(n.add(d,"hidden"),b||(this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+e.NLS_noInfo+".\x3c/div\x3e"),this.visibleWhenEmpty||this._waitAndHide(this.hideDelay)))}}});return e("extend-esri")&&k.setObject("dijit.Popup",h,u),h})},"esri/geometry/normalizeUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/has ../kernel ../config ../deferredUtils ./Extent ./Polyline ./Polygon ./webMercatorUtils ./jsonUtils".split(" "),function(h,
k,a,f,b,e,l,m,g,d,c,n){function q(a,c){return Math.ceil((a-c)/(2*c))}function t(a,c){var b,d,g,e=a.paths||a.rings,f=e.length;for(b=0;f>b;b++)for(g=e[b].length,d=0;g>d;d++){var n=a.getPoint(b,d);a.setPoint(b,d,n.offset(c,0))}return a}function r(a,c){if(!(a instanceof g||a instanceof d))throw console.error("_straightLineDensify: the input geometry is neither polyline nor polygon"),Error("_straightLineDensify: the input geometry is neither polyline nor polygon");var b,e=a instanceof g,f=[];return h.forEach(e?
a.paths:a.rings,function(a){f.push(b=[]);b.push([a[0][0],a[0][1]]);var d,g,e,n,l,m,q,h,u,t,r,v;for(l=0;l<a.length-1;l++){if(d=a[l][0],g=a[l][1],e=a[l+1][0],n=a[l+1][1],q=Math.sqrt((e-d)*(e-d)+(n-g)*(n-g)),h=(n-g)/q,u=(e-d)/q,t=q/c,1<t){for(m=1;t-1>=m;m++)v=m*c,r=u*v+d,v=h*v+g,b.push([r,v]);m=(q+Math.floor(t-1)*c)/2;r=u*m+d;v=h*m+g;b.push([r,v])}b.push([e,n])}}),e?new g({paths:f,spatialReference:a.spatialReference}):new d({rings:f,spatialReference:a.spatialReference})}function v(a,b,d){b&&(a=r(a,1E6),
a=c.webMercatorToGeographic(a,!0));return d&&(a=t(a,d)),a}function u(a,c,b){var d,g=a.x||a[0];return g>c?(d=q(g,c),a.x?a=a.offset(-2*d*c,0):a[0]=g+-2*d*c):b>g&&(d=q(g,b),a.x?a=a.offset(-2*d*b,0):a[0]=g+-2*d*b),a}function w(a,c){var b=-1;return h.forEach(c.cutIndexes,function(d,g){var e=c.geometries[g];h.forEach(e.rings||e.paths,function(a,c){h.some(a,function(b){if(180>b[0])return!0;var d,g=0,f=a.length;for(b=0;f>b;b++)d=a[b][0],g=d>g?d:g;g=Number(g.toFixed(9));d=-360*q(g,180);g=a.length;for(b=0;g>
b;b++)f=e.getPoint(c,b),e.setPoint(c,b,f.offset(d,0));return!0})});d===b?e.rings?h.forEach(e.rings,function(c){a[d]=a[d].addRing(c)}):h.forEach(e.paths,function(c){a[d]=a[d].addPath(c)}):(b=d,a[d]=e)}),a}function x(b,f,l,m){var r=new a;r.addCallbacks(l,m);f=f||e.defaults.geometryService;var k,x,y,z,C,A,B,D,F=[],E=[],G=0;h.forEach(b,function(a){if(!a||(k||(k=a.spatialReference,x=k._getInfo(),y=k._isWebMercator(),z=y?2.0037508342788905E7:180,C=y?-2.0037508342788905E7:-180,A=y?102100:4326,B=new g({paths:[[[z,
C],[z,z]]],spatialReference:{wkid:A}}),D=new g({paths:[[[C,C],[C,z]]],spatialReference:{wkid:A}})),!x))return void F.push(a);var c=n.fromJson(a.toJson()),b=a.getExtent();"point"===a.type?F.push(u(c,z,C)):"multipoint"===a.type?(c.points=h.map(c.points,function(a){return u(a,z,C)}),F.push(c)):"extent"===a.type?(c=b._normalize(null,null,x),F.push(c.rings?new d(c):c)):b?(a=2*q(b.xmin,C)*z,c=0===a?c:t(c,a),b=b.offset(a,0),b.intersects(B)&&b.xmax!==z?(G=b.xmax>G?b.xmax:G,c=v(c,y),E.push(c),F.push("cut")):
b.intersects(D)&&b.xmin!==C?(G=2*b.xmax*z>G?2*b.xmax*z:G,c=v(c,y,360),E.push(c),F.push("cut")):F.push(c)):F.push(c)});l=new g;m=q(G,z);for(var X=-90,T=m;0<m;){var V=-180+360*m;l.addPath([[V,X],[V,-1*X]]);X*=-1;m--}return 0<E.length&&0<T?f?f.cut(E,l,function(a){E=w(E,a);var d=[];h.forEach(F,function(a,g){if("cut"===a){var e=E.shift();b[g].rings&&1<b[g].rings.length&&e.rings.length>=b[g].rings.length?(F[g]="simplify",d.push(e)):F[g]=!0===y?c.geographicToWebMercator(e):e}});0<d.length?f.simplify(d,function(a){h.forEach(F,
function(b,d){"simplify"===b&&(F[d]=!0===y?c.geographicToWebMercator(a.shift()):a.shift())});r.callback(F)},function(a){r.errback(a)}):r.callback(F)},function(a){r.errback(a)}):r.errback(Error("esri.geometry.normalizeCentralMeridian: 'geometryService' argument is missing.")):(h.forEach(F,function(a,b){if("cut"===a){var d=E.shift();F[b]=!0===y?c.geographicToWebMercator(d):d}}),r.callback(F)),r}function y(a,c,b,d){var g,e=!1;k.isObject(a)&&a&&(k.isArray(a)?a.length&&(g=a[0]&&a[0].declaredClass,g&&-1!==
g.indexOf("Graphic")?(a=h.map(a,function(a){return a.geometry}),e=a.length?!0:!1):g&&-1!==g.indexOf("esri.geometry.")&&(e=!0)):(g=a.declaredClass,g&&-1!==g.indexOf("FeatureSet")?(a=h.map(a.features||[],function(a){return a.geometry}),e=a.length?!0:!1):g&&-1!==g.indexOf("esri.geometry.")&&(e=!0)));e&&c.push({index:b,property:d,value:a})}function A(a,c){var b=[];return h.forEach(c,function(c){var d,g=c.i,e=a[g];c=c.p;if(k.isObject(e)&&e)if(c)if("*"===c[0])for(d in e)e.hasOwnProperty(d)&&y(e[d],b,g,
d);else h.forEach(c,function(a){y(k.getObject(a,!1,e),b,g,a)});else y(e,b,g)}),b}function z(a,c){var b=0,d={};return h.forEach(c,function(c){var g=c.index,e=c.property,f=c.value,n=f.length||1,l=a.slice(b,b+n);k.isArray(f)||(l=l[0]);b+=n;delete c.value;e?(d[g]=d[g]||{},d[g][e]=l):d[g]=l}),d}function B(a){for(var c=[],b=0,d=0,g=Math.min,e=Math.max,f=0;f<a.length;f++){for(var n=a[f],l=null,m=0;m<n.length;m++)l=n[m],c.push(l),0===m?(b=l[0],d=b):(b=g(b,l[0]),d=e(d,l[0]));l&&c.push([(b+d)/2,0])}return c}
var C={normalizeCentralMeridian:x,_foldCutResults:w,_prepareGeometryForCut:v,_offsetMagnitude:q,_pointNormalization:u,_updatePolyGeometry:t,_straightLineDensify:r,_createWrappers:function(c){var b=k.isObject(c)?c.prototype:k.getObject(c+".prototype");h.forEach(b.__msigns,function(c){var d=b[c.n];b[c.n]=function(){var b,g=this,e=[],f=new a(l._dfdCanceller);c.f&&l._fixDfd(f);for(b=0;b<c.c;b++)e[b]=arguments[b];var n={dfd:f};e.push(n);var m,q,t=[];return g.normalization&&!g._isTable&&(m=A(e,c.a),h.forEach(m,
function(a){t=t.concat(a.value)}),t.length&&(q=x(t))),q?(f._pendingDfd=q,q.addCallbacks(function(a){f.canceled||(n.assembly=z(a,m),f._pendingDfd=d.apply(g,e))},function(a){var b=g.declaredClass;b&&-1!==b.indexOf("FeatureLayer")?g._resolve([a],null,e[c.e],f,!0):g._errorHandler(a,e[c.e],f)})):f._pendingDfd=d.apply(g,e),f}})},_disassemble:A,_addToBucket:y,_reassemble:z,getDenormalizedExtent:function(a){if(!a)return null;var c=a.getExtent();if(!c)return null;var b=a.spatialReference&&a.spatialReference._getInfo();
if(!b)return c;var d=b.valid[0],b=b.valid[1],g=2*b,e=c.getWidth(),f=c.xmax,n=c.xmin;if("extent"===a.type||0===e||b>=e||e>g||d>f||n>b)return c;var l;switch(a.type){case "polygon":if(!(1<a.rings.length))return c;l=B(a.rings);break;case "polyline":if(!(1<a.paths.length))return c;l=B(a.paths);break;case "multipoint":l=a.points}a=Math.min;for(var d=Math.max,g=new m(c.toJson()),q=0;q<l.length;q++){var h=l[q][0];0>h?(h+=b,n=d(h,n)):(h-=b,f=a(h,f))}return g.xmin=f,g.xmax=n,g.getWidth()<e?(g.xmin-=b,g.xmax-=
b,g):c}};return f("extend-esri")&&k.mixin(k.getObject("geometry",!0,b),C),C})},"esri/plugins/popupManager":function(){define(["../PopupManager"],function(h){return{add:function(k,a){k.popupManager||(k.popupManager=new h(a),k.popupManager.setMap(k))},remove:function(h){var a=h.popupManager;a&&(a.unsetMap(),h.popupManager=void 0)}}})},"esri/PopupManager":function(){define("./geometry/Extent ./geometry/ScreenPoint ./kernel ./layerUtils ./tasks/query dijit/registry dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/_base/lang dojo/has dojo/on dojo/promise/all dojo/Stateful require".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r){var v;m=m(t,{declaredClass:"esri.PopupManager",enabled:!1,map:null,_mapClickHandle:null,_featureLayersCache:{},constructor:function(a){this._mapClickHandler=d.hitch(this,this._mapClickHandler)},setMap:function(a){if(this.map){if(a===this.map)return;this.unsetMap()}this.map=a;this._setupClickHandler()},unsetMap:function(){this.map&&(this.map=null);this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null)},getMapLayer:function(a){var c;if(a&&
(c=a.getLayer())&&(a=c.id,this._featureLayersCache[a])){var b=a.lastIndexOf("_");-1<b&&(a=a.substring(0,b),c=this.map.getLayer(a))}return c},_enabledSetter:function(a){this.enabled=a;this._setupClickHandler()},_setupClickHandler:function(){this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null);this.enabled&&this.map&&(this._mapClickHandle=this.map.on("click",this._mapClickHandler))},_mapClickHandler:function(a){var c=this.map.infoWindow,b=a.graphic;c&&this.map.loaded&&(c.clearFeatures&&
c.setFeatures?this._showPopup(a):b&&b.getInfoTemplate()&&this._showInfoWindow(b,a.mapPoint))},_showPopup:function(a){var c=this.map,d=c.infoWindow,e=this,f=[],n=[c.graphics].concat(l.map(c.graphicsLayerIds,c.getLayer,c));l.forEach(n,function(a){a&&a.loaded&&a.infoTemplate&&!a.suspended&&f.push(a)});var m=[];l.forEach(c.layerIds,function(a){(a=c.getLayer(a))&&a.loaded&&!a.suspended&&(e._isImageServiceLayer(a)&&a.infoTemplate?f.push(a):"esri.layers.WMSLayer"===a.declaredClass&&a.getFeatureInfoURL?f.push(a):
"esri.layers.ArcGISDynamicMapServiceLayer"!==a.declaredClass&&"esri.layers.ArcGISTiledMapServiceLayer"!==a.declaredClass||!a.infoTemplates||m.push(a))});this._getSubLayerFeatureLayers(m).then(function(n){f=f.concat(n);n=null;if(a.graphic&&a.graphic.getInfoTemplate()&&!e._isImageServiceLayer(a.graphic._layer)&&(n=a.graphic),f.length||n){var m=e._calculateClickTolerance(f),q=a.screenPoint,t=c.toMap(new k(q.x-m,q.y+m)),m=c.toMap(new k(q.x+m,q.y-m)),r=new h(t.x,t.y,m.x,m.y,c.spatialReference);if(r=r.intersects(c.extent)){var u=
new b,v=!!n,w=!0,t=l.map(f,function(b){var d;if(u.timeExtent=b.useMapTime?c.timeExtent:null,e._isImageServiceLayer(b))u.geometry=a.mapPoint,w=!1,d=b.queryVisibleRasters(u,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),d.addCallback(function(){var a=b.getVisibleRasters();return v=v||0<a.length,a});else if("esri.layers.WMSLayer"===b.declaredClass){d=new g;var f=b._getPopupGraphic(c,a.screenPoint);f?(d.resolve([f]),v=!0):d.resolve([])}else e._featureLayersCache[b.id]||"function"==
typeof b.queryFeatures&&(0===b.currentMode||1===b.currentMode)?(u.geometry=r,d=b.queryFeatures(u),d.addCallback(function(a){a=a.features;return a=l.filter(a,function(a){return a.visible}),v=v||0<a.length,a})):(d=new g,f=l.filter(b.graphics,function(a){return a&&a.visible&&r.intersects(a.geometry)}),v=v||0<f.length,d.resolve(f));return d});n&&(m=new g,m.resolve([n]),t.unshift(m));if(!l.some(t,function(a){return!a.isFulfilled()})&&!v)return d.hide(),void d.clearFeatures();d.setFeatures(t);d.show(a.mapPoint,
{closestFirst:w})}}})},_getSubLayerFeatureLayers:function(a,c){var b=c||new g,d=[],e=a.length,m=Math.floor(this.map.extent.getWidth()/this.map.width),h=this.map.getScale(),t=!1,u=this,k=0;a:for(;e>k;k++){var w=a[k],G=w.dynamicLayerInfos||w.layerInfos;if(G){var I=null;w._params&&(w._params.layers||w._params.dynamicLayers)&&(I=w.visibleLayers);for(var I=f._getVisibleLayers(G,I),J=f._getLayersForScale(h,G),L=G.length,M=0;L>M;M++){var H=G[M],K=H.id,P=w.infoTemplates[K];if(!H.subLayerIds&&P&&P.infoTemplate&&
-1<l.indexOf(I,K)&&-1<l.indexOf(J,K)){if(!v){t=!0;break a}var O=w.id+"_"+K,S=this._featureLayersCache[O];S&&S.loadError||(S||((S=P.layerUrl)||(S=H.source?this._getLayerUrl(w.url,"/dynamicLayer"):this._getLayerUrl(w.url,K)),S=new v(S,{id:O,drawMode:!1,mode:v.MODE_SELECTION,outFields:this._getOutFields(P.infoTemplate),resourceInfo:P.resourceInfo,source:H.source}),this._featureLayersCache[O]=S),S.setDefinitionExpression(w.layerDefinitions&&w.layerDefinitions[K]),S.setGDBVersion(w.gdbVersion),S.setInfoTemplate(P.infoTemplate),
S.setMaxAllowableOffset(m),S.setUseMapTime(!!w.useMapTime),w.layerDrawingOptions&&w.layerDrawingOptions[K]&&w.layerDrawingOptions[K].renderer&&S.setRenderer(w.layerDrawingOptions[K].renderer),d.push(S))}}}}if(t){var Q=new g;r(["./layers/FeatureLayer"],function(a){v=a;Q.resolve()});Q.then(function(){u._getSubLayerFeatureLayers(a,b)})}else{var R=[];l.forEach(d,function(a){if(!a.loaded){var c=new g;n.once(a,"load, error",function(){c.resolve()});R.push(c.promise)}});R.length?q(R).then(function(){d=l.filter(d,
function(a){return!a.loadError&&a.isVisibleAtScale(h)});b.resolve(d)}):(d=l.filter(d,function(a){return a.isVisibleAtScale(h)}),b.resolve(d))}return b.promise},_getLayerUrl:function(a,c){var b=a.indexOf("?");return-1===b?a+"/"+c:a.substring(0,b)+"/"+c+a.substring(b)},_getOutFields:function(a){var c;return a.info&&"esri.dijit.PopupTemplate"===a.declaredClass?(c=[],l.forEach(a.info.fieldInfos,function(a){var b=a.fieldName&&a.fieldName.toLowerCase();b&&"shape"!==b&&0!==b.indexOf("relationships/")&&c.push(a.fieldName)})):
c=["*"],c},_calculateClickTolerance:function(a){var c,b,d=6;return l.forEach(a,function(a){(c=a.renderer)&&("esri.renderer.SimpleRenderer"===c.declaredClass?(b=c.symbol,b&&b.xoffset&&(d=Math.max(d,Math.abs(b.xoffset))),b&&b.yoffset&&(d=Math.max(d,Math.abs(b.yoffset)))):("esri.renderer.UniqueValueRenderer"===c.declaredClass||"esri.renderer.ClassBreaksRenderer"===c.declaredClass)&&l.forEach(c.infos,function(a){(b=a.symbol)&&b.xoffset&&(d=Math.max(d,Math.abs(b.xoffset)));b&&b.yoffset&&(d=Math.max(d,
Math.abs(b.yoffset)))}))}),d},_showInfoWindow:function(a,c){var b=this.map.infoWindow,g=a.geometry,g=g&&"point"===g.type?g:c,f=a.getContent();if(b.setTitle(a.getTitle()),f&&d.isString(f.id)){var n=e.byId(f.id);n&&n.set&&/_PopupRenderer/.test(n.declaredClass)&&n.set("showTitle",!1)}b.setContent(f);b.show(g)},_isImageServiceLayer:function(a){return"esri.layers.ArcGISImageServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass}});return c("extend-esri")&&(a.PopupManager=
m),m})},"esri/layerUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/has","./kernel"],function(h,k,a,f,b){var e={_serializeLayerDefinitions:function(b,e){var g=[],d=/[:;]/;if(b&&(k.forEach(b,function(a,c){a&&(g.push([c,a]),!e&&d.test(a)&&(e=!0))}),0<g.length)){var c;return e?(c={},k.forEach(g,function(a){c[a[0]]=a[1]}),c=a.toJson(c)):(c=[],k.forEach(g,function(a){c.push(a[0]+":"+a[1])}),c=c.join(";")),c}return null},_serializeTimeOptions:function(b,e){if(b){var g=
[];return k.forEach(b,function(b,c){if(b){var d=b.toJson();e&&-1!==k.indexOf(e,c)&&(d.useTime=!1);g.push('"'+c+'":'+a.toJson(d))}}),g.length?"{"+g.join(",")+"}":void 0}},_getVisibleLayers:function(a,b){var g,d,c,e=[];if(!a)return e;if(b)for(e=b.concat(),c=0;c<a.length;c++)g=a[c],d=k.indexOf(a,g.id),g.subLayerIds&&-1<d&&(e.splice(d,1),e=e.concat(g.subLayerIds));else e=this._getDefaultVisibleLayers(a);return e},_getDefaultVisibleLayers:function(a){var b,g=[];if(!a)return g;for(b=0;b<a.length;b++)0<=
a[b].parentLayerId&&-1===k.indexOf(g,a[b].parentLayerId)&&k.some(a,function(d){return d.id===a[b].parentLayerId})||a[b].defaultVisibility&&g.push(a[b].id);return g},_getLayersForScale:function(a,b){var g=[];if(0<a&&b){var d;for(d=0;d<b.length;d++)if(!(0<=b[d].parentLayerId&&-1===k.indexOf(g,b[d].parentLayerId)&&k.some(b,function(a){return a.id===b[d].parentLayerId}))&&0<=b[d].id){var c=!0,e=b[d].maxScale,f=b[d].minScale;(0<e||0<f)&&(0<e&&0<f?c=a>=e&&f>=a:0<e?c=a>=e:0<f&&(c=f>=a));c&&g.push(b[d].id)}}return g}};
return f("extend-esri")&&h.mixin(b,e),e})},"esri/MapNavigationManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/event dojo/mouse dojo/keys dijit/focus ./kernel ./MouseEvents ./TouchEvents ./PointerEvents ./config ./sniff ./lang ./fx ./graphic ./tileUtils ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./symbols/SimpleFillSymbol".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B){var C=f.connect,
D=f.disconnect,E=t("chrome"),F=t("safari"),G=[l.NUMPAD_PLUS,61,187,l.NUMPAD_MINUS,173,189,l.UP_ARROW,l.NUMPAD_8,l.RIGHT_ARROW,l.NUMPAD_6,l.DOWN_ARROW,l.NUMPAD_2,l.LEFT_ARROW,l.NUMPAD_4,l.PAGE_UP,l.NUMPAD_9,l.PAGE_DOWN,l.NUMPAD_3,l.END,l.NUMPAD_1,l.HOME,l.NUMPAD_7];h=h(null,{declaredClass:"esri.MapNavigationManager",eventModel:"",constructor:function(a,b){this.map=a;k.mixin(this,b);var g=a.__container;t("esri-pointer")?(this.pointerEvents=new n(g,{map:a}),this.eventModel="pointer"):t("esri-touch")?
(t("ios")||(this.mouseEvents=new d(g,{map:a})),this.touchEvents=new c(g,{map:a,mouseEvents:this.mouseEvents}),this.eventModel="touch"):(this.mouseEvents=new d(g,{map:a}),this.eventModel="mouse");this._zoomRect=new u(null,new B(q.defaults.map.zoomSymbol));this._keyDx=this._keyDy=0;this._adjustPinch=k.hitch(this,this._adjustPinch);this._adjustPinchEnd=k.hitch(this,this._adjustPinchEnd)},_panInit:function(a){var c=this.mouseEvents;e.isLeft(a)&&this.map.isPan&&!a.shiftKey&&(this._dragOrigin=new x(0,0),
k.mixin(this._dragOrigin,a.screenPoint),D(this._panStartHandle),D(this._panHandle),D(this._panEndHandle),this._panStartHandle=C(c,"onMouseDragStart",this,this._panStart),this._panHandle=C(c,"onMouseDrag",this,this._pan),this._panEndHandle=C(c,"onMouseUp",this,this._panEnd),(E||F)&&(a.preventDefault(),m.curNode&&m.curNode.blur()))},_panStart:function(a){this.map.setCursor("move");this.map.__panStart(a.screenPoint.x,a.screenPoint.y)},_pan:function(a){this.map.__pan(a.screenPoint.x-this._dragOrigin.x,
a.screenPoint.y-this._dragOrigin.y)},_panEnd:function(a){D(this._panStartHandle);D(this._panHandle);D(this._panEndHandle);this._panStartHandle=this._panHandle=this._panEndHandle=null;var c=this.map;c.__panning&&(c.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y),c.resetMapCursor())},_zoomInit:function(a){var c=this.map,b=this.pointerEvents||this.mouseEvents;(e.isLeft(a)||a.pointerType)&&c.isRubberBandZoom&&a.shiftKey&&(c.setCursor("crosshair"),this._dragOrigin=k.mixin({},
a.screenPoint),this._zoomDir=a.ctrlKey||a.metaKey?-1:1,this.pointerEvents?(this._zoomHandle=C(b,"onSwipeMove",this,this._zoom),this._zoomEndHandle=C(b,"onSwipeEnd",this,this._zoomEnd)):(this._zoomHandle=C(b,"onMouseDrag",this,this._zoom),this._zoomEndHandle=C(b,"onMouseUp",this,this._zoomEnd)),E&&a.preventDefault())},_zoom:function(a){var c=this.map,b=this._normalizeRect(a).offset(c.__visibleRect.x,c.__visibleRect.y);a=c.graphics;var d=this._zoomRect;d.geometry||c.setCursor("crosshair");d.geometry&&
a.remove(d,!0);var g=c.toMap(new x(b.x,b.y)),b=c.toMap(new x(b.x+b.width,b.y+b.height)),b=new A(g.x,g.y,b.x-g.x,g.y-b.y,c.spatialReference);b._originOnly=!0;d.setGeometry(b);a.add(d,!0)},_zoomEnd:function(a){var c=this._zoomRect,b=this.map,d=b.extent,g=b.spatialReference;if(D(this._zoomHandle),D(this._zoomEndHandle),this._zoomHandle=this._zoomEndHandle=null,b._canZoom(this._zoomDir)&&c.getDojoShape()){b.graphics.remove(c);c.geometry=null;a=this._normalizeRect(a);a.x+=b.__visibleRect.x;a.y+=b.__visibleRect.y;
if(-1===this._zoomDir){var e=d.getWidth();a=(e*b.width/a.width-e)/2;g=new y(d.xmin-a,d.ymin-a,d.xmax+a,d.ymax+a,g)}else d=b.toMap({x:a.x,y:a.y+a.height}),a=b.toMap({x:a.x+a.width,y:a.y}),g=new y(d.x,d.y,a.x,a.y,g);b._extentUtil(null,null,g)}c.getDojoShape()&&b.graphics.remove(c,!0);this._zoomDir=0;b.resetMapCursor()},_wheelZoom:function(a,c){var b=this.map;if(!c){if(b.smartNavigation&&!a.shiftKey&&!b._isPanningOrZooming())return b.disableScrollWheelZoom(),this._setScrollWheelPan(!0),void this._wheelPan(a);
var d=a.timeStamp;(!r.isDefined(d)||0>=d)&&(d=(new Date).getTime());if(100>(this._mwts?d-this._mwts:d))return;this._mwts=d}b._canZoom(a.value)&&b._extentUtil({numLevels:a.value,mapAnchor:a.mapPoint,screenAnchor:a.screenPoint})},_wheelPan:function(a){var c=this.map;if(a.shiftKey&&!c._isPanningOrZooming())return this._setScrollWheelPan(!1),c.enableScrollWheelZoom(),void this._wheelZoom(a);var b=0,d=0;t("ff")?a.axis===a.HORIZONTAL_AXIS?b=-a.detail:d=-a.detail:(b=a.wheelDeltaX,d=a.wheelDeltaY);c.translate(b,
d)},_setScrollWheelPan:function(a){this.map.isScrollWheelPan=a;this.mouseEvents.enableMouseWheel(a);D(this._mwMacHandle);this._mwMacHandle=null;a&&(this._mwMacHandle=C(this.mouseEvents,"onMouseWheel",this,this._wheelPan))},_recenter:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&this.map.centerAt(a.mapPoint)},_recenterZoom:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&(a.value=a.ctrlKey||a.metaKey?-1:1,this._wheelZoom(a,!0))},_dblClickZoom:function(a){this.map._isPanningOrZooming()||
(a.value=1,this._wheelZoom(a,!0))},_twoFingerTap:function(a){this.map._isPanningOrZooming()||(a.value=-1,this._wheelZoom(a,!0))},_keyDown:function(c){var d=c.keyCode,g=this.map;if(-1!==a.indexOf(G,d)){if(d===l.NUMPAD_PLUS||61===d||187===d)g._extentUtil({numLevels:1});else if(d===l.NUMPAD_MINUS||173===d||189===d)g._extentUtil({numLevels:-1});else{switch(g.__panning||g.__panStart(0,0),d){case l.UP_ARROW:case l.NUMPAD_8:this._keyDy+=10;break;case l.RIGHT_ARROW:case l.NUMPAD_6:this._keyDx-=10;break;case l.DOWN_ARROW:case l.NUMPAD_2:this._keyDy-=
10;break;case l.LEFT_ARROW:case l.NUMPAD_4:this._keyDx+=10;break;case l.PAGE_UP:case l.NUMPAD_9:this._keyDx-=10;this._keyDy+=10;break;case l.PAGE_DOWN:case l.NUMPAD_3:this._keyDx-=10;this._keyDy-=10;break;case l.END:case l.NUMPAD_1:this._keyDx+=10;this._keyDy-=10;break;case l.HOME:case l.NUMPAD_7:this._keyDx+=10;this._keyDy+=10;break;default:return}g.__pan(this._keyDx,this._keyDy)}b.stop(c)}},_keyEnd:function(a){var c=this.map;c.__panning&&a.keyCode!==l.SHIFT&&(c.__panEnd(this._keyDx,this._keyDy),
this._keyDx=this._keyDy=0)},_swipeInit:function(a){var c=this.map,c=c._zoomAnim||c._panAnim;return a.shiftKey?!1:(c&&c._active&&(c.stop(),c._fire("onEnd",[c.node])),this._dragOrigin=new x(0,0),k.mixin(this._dragOrigin,a.screenPoint),D(this._swipeHandle),D(this._swipeEndHandle),this._swipeHandle=C(this.touchEvents||this.pointerEvents,"onSwipeMove",this,this._swipe),void(this._swipeEndHandle=C(this.touchEvents||this.pointerEvents,"onSwipeEnd",this,this._swipeEnd)))},_swipe:function(a){var c=this.map;
c.__panning?(this._panX=a.screenPoint.x,this._panY=a.screenPoint.y,c.__pan(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y)):(c.setCursor("move"),c.__panStart(a.screenPoint.x,a.screenPoint.y))},_swipeEnd:function(a){D(this._swipeHandle);D(this._swipeEndHandle);this._swipeHandle=this._swipeEndHandle=null;var c=this.map;c.__panning&&(c.resetMapCursor(),c.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y))},_pinchInit:function(a){var c=this.map,b=c._zoomAnim||
c._panAnim;b&&b._active?(b.stop(),b._fire("onEnd",[b.node])):c.__panning&&(a.screenPoint=new x(this._panX,this._panY),a.mapPoint=c.toMap(a.screenPoint),this._swipeEnd(a));D(this._pinchHandle);D(this._pinchEndHandle);this._pinchHandle=C(this.touchEvents||this.pointerEvents,"onPinchMove",this,this._pinch);this._pinchEndHandle=C(this.touchEvents||this.pointerEvents,"onPinchEnd",this,this._pinchEnd)},_pinch:function(a){var c=this.map;if(a.screenPoints){this.currLength=z.getLength(a.screenPoints[0],a.screenPoints[1]);
var b;c.__zooming?(b=this.currLength/this._length,this._zoomStartExtent=this.__scaleExtent(c.extent,b,this._dragOrigin),c.__zoom(this._zoomStartExtent,b,this._dragOrigin)):(this._dragOrigin=new x((a.screenPoints[0].x+a.screenPoints[1].x)/2,(a.screenPoints[0].y+a.screenPoints[1].y)/2),this._length=this.currLength,c.__zoomStart(c.extent,this._dragOrigin));this._pinchScale=b;c._fireOnScale(this.currLength/this._length,this._dragOrigin,!0)}},_pinchEnd:function(a){a=this.map;if(D(this._pinchHandle),D(this._pinchEndHandle),
this._pinchHandle=this._pinchEndHandle=null,this._pinchScale=0,a.__zooming&&null===a._zoomAnim){var c=this.currLength/this._length,b=a.extent.getWidth();if(this._zoomAnimAnchor=a.toMap(this._dragOrigin),this._zoomStartExtent=this.__scaleExtent(a.extent,1/c,this._zoomAnimAnchor),a.__tileInfo){var d=w.getCandidateTileInfo(a,a.__tileInfo,this._zoomStartExtent),g=a.__getExtentForLevel(d.lod.level,this._zoomAnimAnchor),e=a.getMinZoom(),f=a.getMaxZoom(),n=g.extent,l=g.lod,m=b/n.getWidth(),h=d.lod.level;
1>c?m>c&&h--:c>m&&h++;e>h?h=e:h>f&&(h=f);h!==d.lod.level&&(g=a.__getExtentForLevel(h,this._zoomAnimAnchor),n=g.extent,l=g.lod);this._zoomEndExtent=n;this._zoomEndLod=l;a._zoomAnim=v.animateRange({range:{start:b/this._zoomStartExtent.getWidth(),end:m},duration:q.defaults.map.zoomDuration,rate:q.defaults.map.zoomRate,onAnimate:this._adjustPinch,onEnd:this._adjustPinchEnd});a._zoomAnim.play();a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin)}else this._zoomEndExtent=
this._zoomStartExtent,a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin),this._adjustPinchEnd()}},_adjustPinch:function(a){var c=this.__scaleExtent(this.map.extent,a,this._zoomAnimAnchor);this.map.__zoom(c,a,this._dragOrigin)},_adjustPinchEnd:function(){var a=this.map,c=a.extent.getWidth()/this._zoomEndExtent.getWidth(),b=this.__scaleExtent(a.extent,1/c,this._zoomAnimAnchor),d=this._dragOrigin,g=this._zoomEndLod;this._zoomStartExtent=this._zoomEndExtent=this._zoomEndLod=
this._dragOrigin=a._zoomAnim=this._zoomAnimAnchor=null;a.__zoomEnd(b,c,d,g,!0)},__scaleExtent:function(a,c,b){b=b||a.getCenter();c=a.expand(c);var d=a.xmin-(c.getWidth()-a.getWidth())*(b.x-a.xmin)/a.getWidth();b=a.ymax-(c.getHeight()-a.getHeight())*(b.y-a.ymax)/a.getHeight();return new y(d,b-c.getHeight(),d+c.getWidth(),b,a.spatialReference)},_normalizeRect:function(a){a=a.screenPoint;var c=this._dragOrigin.x,b=this._dragOrigin.y;a=new A((a.x<c?a.x:c)-this.map.__visibleRect.x,(a.y<b?a.y:b)-this.map.__visibleRect.y,
Math.abs(a.x-c),Math.abs(a.y-b));return delete a.spatialReference,0===a.width&&(a.width=1),0===a.height&&(a.height=1),a},setImmediateClick:function(a){switch(this.eventModel){case "mouse":this.mouseEvents.setImmediateClick(a);break;case "touch":this.touchEvents.setImmediateTap(a);this.mouseEvents&&this.mouseEvents.setImmediateClick(a);break;case "pointer":this.pointerEvents.setImmediateTap(a)}},enablePan:function(){switch(this.disablePan(),this.eventModel){case "mouse":this._panInitHandle=C(this.mouseEvents,
"onMouseDown",this,this._panInit);break;case "touch":this._panInitHandle=C(this.mouseEvents,"onMouseDown",this,this._panInit);this._swipeInitHandle=C(this.touchEvents,"onSwipeStart",this,this._swipeInit);break;case "pointer":this._swipeInitHandle=C(this.pointerEvents,"onSwipeStart",this,this._swipeInit)}},disablePan:function(){D(this._panInitHandle);this._panInitHandle=null;D(this._swipeInitHandle);this._swipeInitHandle=null},enableRubberBandZoom:function(){this.disableRubberBandZoom();this._zoomInitHandle=
this.pointerEvents?C(this.pointerEvents,"onSwipeStart",this,this._zoomInit):C(this.mouseEvents,"onMouseDown",this,this._zoomInit)},disableRubberBandZoom:function(){D(this._zoomInitHandle);this._zoomInitHandle=null},enablePinchZoom:function(){this.disablePinchZoom();"touch"!==this.eventModel&&"pointer"!==this.eventModel||(this._pinchInitHandle=C(this.touchEvents||this.pointerEvents,"onPinchStart",this,this._pinchInit))},disablePinchZoom:function(){D(this._pinchInitHandle);this._pinchInitHandle=null},
enableScrollWheelZoom:function(){this.disableScrollWheelZoom();this._wheelHandle=C(this.mouseEvents||this.pointerEvents,"onMouseWheel",this,this._wheelZoom)},disableScrollWheelZoom:function(){D(this._wheelHandle);this._wheelHandle=null},enableScrollWheelPan:function(){var a=this.map;a&&a.loaded&&a.smartNavigation&&(this.disableScrollWheelPan(),this._setScrollWheelPan(!0))},disableScrollWheelPan:function(){var a=this.map;a&&a.loaded&&a.smartNavigation&&this._setScrollWheelPan(!1)},enableDoubleClickZoom:function(){switch(this.disableDoubleClickZoom(),
this.eventModel){case "mouse":this._dblClickHandle=C(this.mouseEvents,"onDblClick",this,this._dblClickZoom);break;case "touch":this._dblClickHandle=C(this.mouseEvents,"onDblClick",this,this._dblClickZoom);this._dblTapHandle=C(this.touchEvents,"onDoubleTap",this,this._dblClickZoom);this._zoomOutHandle=C(this.touchEvents,"onTwoFingerTap",this,this._twoFingerTap);break;case "pointer":this._dblTapHandle=C(this.pointerEvents,"onDoubleTap",this,this._dblClickZoom),this._zoomOutHandle=C(this.pointerEvents,
"onTwoFingerTap",this,this._twoFingerTap)}},disableDoubleClickZoom:function(){D(this._dblClickHandle);D(this._zoomOutHandle);this._dblTapHandle&&D(this._dblTapHandle);this._dblClickHandle=this._zoomOutHandle=this._dblTapHandle=null},enableShiftDoubleClickZoom:function(){this.disableShiftDoubleClickZoom();this._sDblClickHandle=C(this.pointerEvents||this.mouseEvents,"onDblClick",this,this._recenterZoom)},disableShiftDoubleClickZoom:function(){D(this._sDblClickHandle);this._sDblClickHandle=null},enableClickRecenter:function(){this.disableClickRecenter();
this._recenterHandle=C(this.pointerEvents||this.mouseEvents,"onClick",this,this._recenter)},disableClickRecenter:function(){D(this._recenterHandle);this._recenterHandle=null},enableKeyboardNavigation:function(){this.disableKeyboardNavigation();this._keyHandle=C(this.pointerEvents||this.mouseEvents,"onKeyDown",this,this._keyDown);this._keyEndHandle=C(this.pointerEvents||this.mouseEvents,"onKeyUp",this,this._keyEnd)},disableKeyboardNavigation:function(){D(this._keyHandle);D(this._keyEndHandle);this._keyHandle=
this._keyEndHandle=null},enableNavigation:function(){var a=this.map;a&&a.loaded&&(a.enableDoubleClickZoom(),a.enableClickRecenter(),a.enablePan(),a.enableRubberBandZoom(),this.enablePinchZoom(),a.enableKeyboardNavigation(),a.smartNavigation?this.enableScrollWheelPan():a.enableScrollWheelZoom())},disableNavigation:function(){var a=this.map;a&&a.loaded&&(a.disableDoubleClickZoom(),a.disableClickRecenter(),a.disablePan(),a.disableRubberBandZoom(),this.disablePinchZoom(),a.disableKeyboardNavigation(),
a.disableScrollWheelZoom(),a.smartNavigation&&this.disableScrollWheelPan())},destroy:function(){this.touchEvents&&this.touchEvents.destroy();this.mouseEvents&&this.mouseEvents.destroy();this.pointerEvents&&this.pointerEvents.destroy();var a,c=[this._panInitHandle,this._panStartHandle,this._panHandle,this._panEndHandle,this._zoomInitHandle,this._zoomHandle,this._zoomEndHandle,this._wheelHandle,this._mwMacHandle,this._dblClickHandle,this._zoomOutHandle,this._recenterHandle,this._sDblClickHandle,this._dblTapHandle,
this._keyHandle,this._keyEndHandle,this._swipeInitHandle,this._swipeHandle,this._swipeEndHandle,this._pinchInitHandle,this._pinchHandle,this._pinchEndHandle];for(a=0;a<c.length;a++)D(c[a]);this.map=this.touchEvents=this.mouseEvents=this.eventModel=this.pointerEvents=this._zoomRect=this._dragOrigin=this._panInitHandle=this._panStartHandle=this._panHandle=this._panEndHandle=this._zoomInitHandle=this._zoomHandle=this._zoomEndHandle=this._wheelHandle=this._mwMacHandle=this._dblClickHandle=this._zoomOutHandle=
this._recenterHandle=this._sDblClickHandle=this._dblTapHandle=this._keyHandle=this._keyEndHandle=this._swipeInitHandle=this._swipeHandle=this._swipeEndHandle=this._pinchInitHandle=this._pinchHandle=this._pinchEndHandle=null}});return t("extend-esri")&&(g.MapNavigationManager=h),h})},"esri/MouseEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/_base/connect dojo/_base/event ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(h,
k,a,f,b,e,l,m,g,d){var c=b.connect,n=b.disconnect;h=h([m],{declaredClass:"esri.MouseEvents",doubleClickDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==f("mac")?1:3,wheelDivisor:2>f("chrome")?360:120,preventPageScroll:!0,map:null,constructor:function(b,d){this.node=b;a.mixin(this,d);var g=function(a){return e.stop(a),!1};f("mozilla")&&k.style(b,"MozUserSelect","none");this._handles=[c(b,"onselectstart",g),c(b,"ondragstart",g),c(b,"onmouseenter",this,this._onMouseEnterHandler),c(b,
"onmouseleave",this,this._onMouseLeaveHandler),c(b,"onmousedown",this,this._onMouseDownHandler),c(b,"onclick",this,this._onClickHandler),c(b,"ondblclick",this,this._onDblClickHandler)];this._onMouseMoveHandler_connect=c(b,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=c(b,"onmouseup",this,this._onMouseUpHandler);this._fireClickEvent=a.hitch(this,this._fireClickEvent);this._initialDuration=this.doubleClickDuration;this.preventPageScroll=(g=this.map)?g.isScrollWheelZoom||
g.isScrollWheelPan:this.preventPageScroll;this.enableMouseWheel(!1)},_fire:function(a,c){(!this._preventClick||"onClick"!==a&&"onDblClick"!==a)&&(this[a]&&this[a](c),this.map&&this.map[a]&&this.map[a](c))},_processEvent:function(a){a=e.fix(a,a.target);var c=this.map,b=c&&c.position;return b&&("DOMMouseScroll"===a.type&&3>f("ff")?a.screenPoint=new d(window.scrollX+a.screenX-b.x,window.scrollY+a.screenY-b.y):a.screenPoint=new d(a.pageX-b.x,a.pageY-b.y),a.mapPoint=c.extent?c.toMap(a.screenPoint):new g),
a.numPoints=0,a},_onMouseEnterHandler:function(a){n(this._onKeyDown_connect);n(this._onKeyUp_connect);this._onKeyDown_connect=c(document,"onkeydown",this,this._onKeyDownHandler);this._onKeyUp_connect=c(document,"onkeyup",this,this._onKeyUpHandler);this._fire("onMouseOver",this._processEvent(a))},_onMouseLeaveHandler:function(a){n(this._onKeyDown_connect);n(this._onKeyUp_connect);this._onKeyDown_connect=this._onKeyUp_connect=null;this._fire("onMouseOut",this._processEvent(a))},_onMouseMoveHandler:function(a){return this._dragEnd?
void(this._dragEnd=!1):void this._fire("onMouseMove",this._processEvent(a))},_onMouseDownHandler:function(a){n(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=null;this.node.setCapture&&this.node.setCapture(!1);n(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=c(document,"onmousemove",this,this._onMouseDragHandler);this._startX=a.pageX;this._startY=a.pageY;this._fire("onMouseDown",this._processEvent(a))},_onMouseUpHandler:function(a){var b=this.node;b.releaseCapture&&
b.releaseCapture();n(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=null;n(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=c(b,"onmousemove",this,this._onMouseMoveHandler);this._fire("onMouseUp",this._processEvent(a))},_onMouseDragHandler:function(a){n(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=c(document,"onmousemove",this,this._onMouseDraggingHandler);n(this._onMouseUpHandler_connect);this._onMouseUpHandler_connect=c(document,"onmouseup",
this,this._onDragMouseUpHandler);this._docLeaveConnect=c(document,"onmouseout",this,this._onDocMouseOut);this._fire("onMouseDragStart",this._processEvent(a))},_onMouseDraggingHandler:function(a){e.stop(a);this._fire("onMouseDrag",this._processEvent(a))},_onDragMouseUpHandler:function(a){var b=this.node;b.releaseCapture&&b.releaseCapture();this._dragEnd=!0;n(this._docLeaveConnect);n(this._onMouseDragHandler_connect);n(this._onMouseUpHandler_connect);this._docLeaveConnect=this._onMouseDragHandler_connect=
null;this._onMouseMoveHandler_connect=c(b,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=c(b,"onmouseup",this,this._onMouseUpHandler);a=this._processEvent(a);this._fire("onMouseDragEnd",a);this._fire("onMouseUp",a)},_onDocMouseOut:function(a){var c=9>f("ie")?a.toElement:a.relatedTarget,b=c&&c.nodeName.toLowerCase();(!c||f("chrome")&&"html"===b)&&this._onDragMouseUpHandler(a)},_onClickHandler:function(a){if(a=this._processEvent(a),a.pageX===this._startX&&a.pageY===this._startY){clearTimeout(this._clickTimer);
var c={},b="movementX"in a,d;for(d in a)(!b||"webkitMovementX"!==d&&"webkitMovementY"!==d)&&(c[d]=a[d]);this._clickEvent=c;this._clickTimer=setTimeout(this._fireClickEvent,this.doubleClickDuration)}},_fireClickEvent:function(){clearTimeout(this._clickTimer);9>f("ie")&&(this._clickEvent.graphic=l._ieGraphic,delete l._ieGraphic);this._fire("onClick",this._clickEvent)},_onDblClickHandler:function(a){clearTimeout(this._clickTimer);this._fire("onDblClick",this._processEvent(a))},_onMouseWheelHandler:function(a){var c=
this.map;(c?c.isScrollWheelZoom||c.isScrollWheelPan:this.preventPageScroll)&&e.stop(a);var c=f("ff")||f("mozilla")?-a.detail/this.mozWheelDivisor:a.wheelDelta/this.wheelDivisor,b=Math.abs(c),b=b<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;a.value=0>c?-b:b;this._fire("onMouseWheel",this._processEvent(a))},_onKeyDownHandler:function(a){this._fire("onKeyDown",a)},_onKeyUpHandler:function(a){this._fire("onKeyUp",a)},enableMouseWheel:function(a){n(this._scrollHandle);this._scrollHandle=c(this.node,
f("ff")||f("mozilla")?a?"MozMousePixelScroll":"DOMMouseScroll":"onmousewheel",this,this._onMouseWheelHandler)},setImmediateClick:function(a){this.doubleClickDuration=a?0:this._initialDuration},preventClickEvents:function(a){this._preventClick=a},destroy:function(){var a,c=this._handles.concat([this._onMouseMoveHandler_connect,this._onMouseUpHandler_connect,this._onMouseDragHandler_connect,this._scrollHandle,this._onKeyDown_connect,this._onKeyUp_connect,this._docLeaveConnect]);for(a=0;a<c.length;a++)n(c[a]);
clearTimeout(this._clickTimer);this.node=this.map=this._handles=this._clickEvent=this._onMouseMoveHandler_connect=this._onMouseUpHandler_connect=this._onMouseDragHandler_connect=this._scrollHandle=this._onKeyDown_connect=this._onKeyUp_connect=this._docLeaveConnect=null}});return f("extend-esri")&&(l.MouseEvents=h),h})},"dojo/_base/html":function(){define("./kernel ../dom ../dom-style ../dom-attr ../dom-prop ../dom-class ../dom-construct ../dom-geometry".split(" "),function(h,k,a,f,b,e,l,m){h.byId=
k.byId;h.isDescendant=k.isDescendant;h.setSelectable=k.setSelectable;h.getAttr=f.get;h.setAttr=f.set;h.hasAttr=f.has;h.removeAttr=f.remove;h.getNodeProp=f.getNodeProp;h.attr=function(a,b,c){return 2==arguments.length?f["string"==typeof b?"get":"set"](a,b):f.set(a,b,c)};h.hasClass=e.contains;h.addClass=e.add;h.removeClass=e.remove;h.toggleClass=e.toggle;h.replaceClass=e.replace;h._toDom=h.toDom=l.toDom;h.place=l.place;h.create=l.create;h.empty=function(a){l.empty(a)};h._destroyElement=h.destroy=function(a){l.destroy(a)};
h._getPadExtents=h.getPadExtents=m.getPadExtents;h._getBorderExtents=h.getBorderExtents=m.getBorderExtents;h._getPadBorderExtents=h.getPadBorderExtents=m.getPadBorderExtents;h._getMarginExtents=h.getMarginExtents=m.getMarginExtents;h._getMarginSize=h.getMarginSize=m.getMarginSize;h._getMarginBox=h.getMarginBox=m.getMarginBox;h.setMarginBox=m.setMarginBox;h._getContentBox=h.getContentBox=m.getContentBox;h.setContentSize=m.setContentSize;h._isBodyLtr=h.isBodyLtr=m.isBodyLtr;h._docScroll=h.docScroll=
m.docScroll;h._getIeDocumentElementOffset=h.getIeDocumentElementOffset=m.getIeDocumentElementOffset;h._fixIeBiDiScrollLeft=h.fixIeBiDiScrollLeft=m.fixIeBiDiScrollLeft;h.position=m.position;h.marginBox=function(a,b){return b?m.setMarginBox(a,b):m.getMarginBox(a)};h.contentBox=function(a,b){return b?m.setContentSize(a,b):m.getContentBox(a)};h.coords=function(b,d){h.deprecated("dojo.coords()","Use dojo.position() or dojo.marginBox().");b=k.byId(b);var c=a.getComputedStyle(b),c=m.getMarginBox(b,c),g=
m.position(b,d);c.x=g.x;c.y=g.y;return c};h.getProp=b.get;h.setProp=b.set;h.prop=function(a,d,c){return 2==arguments.length?b["string"==typeof d?"get":"set"](a,d):b.set(a,d,c)};h.getStyle=a.get;h.setStyle=a.set;h.getComputedStyle=a.getComputedStyle;h.__toPixelValue=h.toPixelValue=a.toPixelValue;h.style=function(b,d,c){switch(arguments.length){case 1:return a.get(b);case 2:return a["string"==typeof d?"get":"set"](b,d)}return a.set(b,d,c)};return h})},"esri/TouchEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/dom ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),
function(h,k,a,f,b,e,l,m,g){h=h([l],{declaredClass:"esri.TouchEvents",tapRadius:8,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,map:null,constructor:function(b,c){this.node=b;a.mixin(this,c);k.setSelectable(b,!1);this._touchStart=a.hitch(this,this._touchStart);this._touchMove=a.hitch(this,this._touchMove);this._touchEnd=a.hitch(this,this._touchEnd);this._touchCancel=a.hitch(this,this._touchCancel);b.addEventListener("touchstart",this._touchStart,!1);b.addEventListener("touchmove",
this._touchMove,!1);b.addEventListener("touchend",this._touchEnd,!1);b.addEventListener("touchcancel",this._touchCancel,!1);this.map&&f("ios")&&(this._mouseOver=a.hitch(this,this._mouseOver),this._mouseOut=a.hitch(this,this._mouseOut),this._mouseDown=a.hitch(this,this._mouseDown),this._mouseUp=a.hitch(this,this._mouseUp),this._mouseClick=a.hitch(this,this._mouseClick),b.addEventListener("mouseover",this._mouseOver,!1),b.addEventListener("mouseout",this._mouseOut,!1),b.addEventListener("mousedown",
this._mouseDown,!1),b.addEventListener("mouseup",this._mouseUp,!1),b.addEventListener("click",this._mouseClick,!1));this._numTouches=0;this._nodeTouches=[];this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_touchStart:function(a){var c,b,d,g,e,l=this._touches,m=a.changedTouches.length,h=(new Date).getTime();if(!(f("android")&&f("safari")&&1===a.targetTouches.length&&a.touches.length===a.targetTouches.length&&a.targetTouches.length===a.changedTouches.length&&0===a.changedTouches[0].identifier&&
l[a.changedTouches[0].identifier])){this._addTouch(a);for(c=0;m>c;c++)b=a.changedTouches[c],d=l[b.identifier]={},d.startX=b.pageX,d.startY=b.pageY,d.startTS=h,-1===this._touchIds.indexOf(b.identifier)&&this._touchIds.push(b.identifier);this._swipeActive&&(g=this._nodeTouches[0]);this._pinchActive&&(e=this._nodeTouches[1]);1===this._numTouches?this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(a,g))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",
this._processTouchEvent(a,[g,e]))):2===this._numTouches?this._swipeActive&&(g&&(d=l[this._touchIds[0]],d.startX=g.pageX,d.startY=g.pageY,d.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(a,g))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(a,g))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(a,[g,e])))}},_touchMove:function(a){a.preventDefault();this._updateTouch(a);var c,b,d,g,e,l,
m=this._touches,h=a.changedTouches.length;if(!(f("android")&&f("safari")&&1===a.targetTouches.length&&a.touches.length===a.targetTouches.length&&a.targetTouches.length===a.changedTouches.length&&0===a.changedTouches[0].identifier&&m[a.changedTouches[0].identifier]&&1<this._touchIds.length)){for(c=0;h>c;c++)b=a.changedTouches[c],(d=m[b.identifier])&&(g=Math.abs(b.pageX-d.startX),e=Math.abs(b.pageY-d.startY),!d.moved&&(g>=this.tapRadius||e>=this.tapRadius)&&(d.moved=d.absMoved=!0),l=l?l:d.moved);1===
this._numTouches?(m=a.changedTouches[0],this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(a,m)):l&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(a,m)))):2===this._numTouches&&(c=this._nodeTouches[0],b=this._nodeTouches[1],this._pinchActive?this._fire("onPinchMove",this._processTouchEvent(a,[c,b])):l&&(d=m[c.identifier],m=m[b.identifier],l=Math.abs(d.startX-m.startX),m=Math.abs(d.startY-m.startY),d=Math.abs(c.pageX-b.pageX),g=Math.abs(c.pageY-b.pageY),Math.abs(Math.sqrt(d*
d+g*g)-Math.sqrt(l*l+m*m))>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(a,[c,b])))))}},_touchEnd:function(a){this._removeTouch(a);var c,b,d,g=this._touches,e=a.changedTouches,f=e.length,l=(new Date).getTime(),m=this._touchIds;for(c=0;f>c;c++)(d=g[e[c].identifier])&&(d.absMoved&&(b=!0),d.pageX=e[c].pageX,d.pageY=e[c].pageY,d.endTS=l);if(0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",
this._processTouchEvent(a,e[0]));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(a,e));else{if(!b){b=1/0;var f=-(1/0),l=1/0,h=-(1/0),k=this.tapStartTolerance,A=[],z=!0;for(c=0;c<m.length;c++)d=g[m[c]],A.push(d),d.startTS<b&&(b=d.startTS),d.startTS>f&&(f=d.startTS),d.endTS<l&&(l=d.endTS),d.endTS>h&&(h=d.endTS),delete g[m[c]];1===A.length&&e[0]&&(d=Math.abs(e[0].pageY-A[0].startY),(Math.abs(e[0].pageX-A[0].startX)>=this.tapRadius||d>=this.tapRadius)&&(z=
!1));z&&Math.abs(f-b)<=k&&Math.abs(h-l)<=k&&this._basicTap(a,A)}}else 1===this._numTouches&&this._pinchActive&&(c=this._nodeTouches[0],d=g[c.identifier],d.startX=c.pageX,d.startY=c.pageY,this._pinchActive=d.moved=!1,this._fire("onPinchEnd",this._processTouchEvent(a,[e[0],c])))},_touchCancel:function(a){this._numTouches&&this._touchEnd(a)},_basicTap:function(a,c){var b=(new Date).getTime(),d=this;(a=this._processTouchEvent(a,c),this._taps.push({touchInfos:c,ts:b,event:a}),2<this._taps.length&&this._taps.shift(),
this._fire("onBasicTap",a),clearTimeout(this._tapTimer),this._immediate)?this._analyzeTap(!0):this._tapTimer=setTimeout(function(){var a=d;d=null;clearTimeout(a._tapTimer);a._analyzeTap()},2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration)},_analyzeTap:function(a){var c=this._taps,b=c[0],d=c[1],g=b.touchInfos,e=d&&d.touchInfos;if(c.length)if(a||(this._taps=[]),b&&d)if(g.length===e.length)if(d.ts-b.ts<=this.doubleTapDuration){var f,l,m;1===g.length?(l=Math.abs(g[0].startX-e[0].startX),
m=Math.abs(g[0].startY-e[0].startY),f=l<=this.doubleTapRadius&&m<=this.doubleTapRadius):f=!0;f?this._processedDoubleTap(c):this._processedTap(d)}else this._processedTap(d);else this._processedTap(d);else this._processedTap(b||d)},_processedTap:function(a){var c=a.event;this._fire("onProcessedTap",c);1===a.touchInfos.length?this._fire("onTap",this._fixEvent(c)):2===a.touchInfos.length&&this._fire("onTwoFingerTap",c)},_processedDoubleTap:function(a){var c,b=1===a[1].touchInfos.length;b&&(c=[this._fixEvent(a[0].event),
this._fixEvent(a[1].event)],c[1].relatedEvents=c);a=[a[0].event,a[1].event];a[1].relatedEvents=a;this._fire("onProcessedDoubleTap",a[1]);b&&(this._fire("onDoubleTap",c[1]),this._fire("onDblClick",c[1]))},_addTouch:function(a){var c,d,g,e=a.changedTouches,f=this._nodeTouches;this._numTouches+=e.length;for(a=0;a<e.length;a++){d=f.length;g=!1;for(c=0;d>c&&!(g=f[c].identifier===e[a].identifier);c++);g?this._numTouches--:f.push(e[a])}for(a=f.length-1;0<=a;a--)b.isDescendant(f[a].target,document.body)||
(f.splice(a,1),this._numTouches--);0>this._numTouches&&(this._numTouches=0)},_removeTouch:function(a){var c=[],b=[],d=a.changedTouches,g=this._nodeTouches;this._numTouches-=d.length;0>this._numTouches&&(this._numTouches=0);for(a=0;a<d.length;a++)c.push(d[a].identifier);for(a=g.length-1;0<=a;a--)-1!==c.indexOf(g[a].identifier)&&b.push(g.splice(a,1)[0]);return b},_updateTouch:function(a){var c,b=[],d=a.changedTouches,g=this._nodeTouches;for(a=0;a<d.length;a++)b.push(d[a].identifier);for(a=0;a<g.length;a++)c=
b.indexOf(g[a].identifier),-1!==c&&g.splice(a,1,d[c])},_mouseOver:function(a){this._fire("onMouseOver",this._processMouseEvent(a))},_mouseOut:function(a){this._fire("onMouseOut",this._processMouseEvent(a))},_mouseDown:function(a){this._fire("onMouseDown",this._processMouseEvent(a))},_mouseUp:function(a){this._fire("onMouseUp",this._processMouseEvent(a))},_mouseClick:function(a){this._fire("onClick",this._processMouseEvent(a))},_fire:function(a,c){if("onDblClick"===a&&this.mouseEvents){this.mouseEvents.preventClickEvents(!0);
var b=this;setTimeout(function(){b.mouseEvents.preventClickEvents(!1)},350)}this[a]&&this[a](c);this.map&&this.map[a]&&this.map[a](c)},_fixEvent:function(a){var c,b={};for(c in a)b[c]=a[c];return this.map&&(b.screenPoint=b.screenPoints[0],b.mapPoint=b.mapPoints[0]),b},_processTouchEvent:function(b,c){var d=this.map,e=d&&d.position,f=0;if(e&&c)if(a.isArray(c)){var l,h;b.screenPoints=[];b.mapPoints=[];for(l=0;l<c.length;l++)c[l]?(h=new g(c[l].pageX-e.x,c[l].pageY-e.y),b.screenPoints.push(h),b.mapPoints.push(d.extent?
d.toMap(h):new m)):f++}else b.screenPoint=new g(c.pageX-e.x,c.pageY-e.y),b.mapPoint=d.extent?d.toMap(b.screenPoint):new m;return b.numPoints=c?a.isArray(c)?c.length-f:1:0,b},_processMouseEvent:function(a){var c=this.map,b=c&&c.position;return b&&(a.screenPoint=new g(a.pageX-b.x,a.pageY-b.y),a.mapPoint=c.extent?c.toMap(a.screenPoint):new m),a},setImmediateTap:function(a){this._immediate=a},destroy:function(){var a=this.node;a.removeEventListener("touchstart",this._touchStart,!1);a.removeEventListener("touchmove",
this._touchMove,!1);a.removeEventListener("touchend",this._touchEnd,!1);a.removeEventListener("touchcancel",this._touchCancel,!1);this.map&&(a.removeEventListener("mouseover",this._mouseOver,!1),a.removeEventListener("mouseout",this._mouseOut,!1),a.removeEventListener("mousedown",this._mouseDown,!1),a.removeEventListener("mouseup",this._mouseUp,!1),a.removeEventListener("click",this._mouseClick,!1));k.setSelectable(a,!0);clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._nodeTouches=
this._touches=this._touchIds=this._taps=null}});return f("extend-esri")&&(e.TouchEvents=h),h})},"esri/PointerEvents":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(h,k,a,f,b,e,l,m){h=h([e],{declaredClass:"esri.PointerEvents",tapRadius:8,clickRadius:2,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==f("mac")?1:3,wheelDivisor:120,
preventPageScroll:!0,_dragging:!1,constructor:function(a,b){this.node=a;k.mixin(this,b);void 0!==a.style.msTouchAction?a.style.msTouchAction="none":void 0!==a.style.touchAction&&(a.style.touchAction="none");var c=navigator.msPointerEnabled,d=function(a){a.preventDefault()};a.addEventListener("selectstart",d,!1);a.addEventListener("dragstart",d,!1);this._pointerDown=k.hitch(this,this._pointerDown);this._pointerMove=k.hitch(this,this._pointerMove);this._pointerUp=k.hitch(this,this._pointerUp);this._pointerCancel=
k.hitch(this,this._pointerCancel);a.addEventListener(c?"MSPointerDown":"pointerdown",this._pointerDown,!1);a.addEventListener(c?"MSPointerMove":"pointermove",this._pointerMove,!1);a.addEventListener(c?"MSPointerUp":"pointerup",this._pointerUp,!1);a.addEventListener(c?"MSPointerCancel":"pointercancel",this._pointerCancel,!1);this.map&&(this._mouseOver=k.hitch(this,this._mouseOver),this._mouseOut=k.hitch(this,this._mouseOut),this._mouseLeave=k.hitch(this,this._mouseLeave),this._mouseDown=k.hitch(this,
this._mouseDown),this._mouseUp=k.hitch(this,this._mouseUp),this._mouseClick=k.hitch(this,this._mouseClick),this._mouseWheel=k.hitch(this,this._mouseWheel),this._mouseMove=k.hitch(this,this._mouseMove),this._mouseEnter=k.hitch(this,this._mouseEnter),this._onKeyDown=k.hitch(this,this._onKeyDown),this._onKeyUp=k.hitch(this,this._onKeyUp),a.addEventListener("mouseover",this._mouseOver,!1),a.addEventListener("mouseout",this._mouseOut,!1),a.addEventListener("mouseleave",this._mouseLeave,!1),a.addEventListener("mousedown",
this._mouseDown,!1),a.addEventListener("mouseup",this._mouseUp,!1),a.addEventListener("click",this._mouseClick,!1),a.addEventListener("mousewheel",this._mouseWheel,!1),a.addEventListener("mousemove",this._mouseMove,!1),a.addEventListener("mouseenter",this._mouseEnter,!1));this._numTouches=0;this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_pointerDown:function(b){if(-1<a.indexOf(this._touchIds,b.pointerId))return void this._pointerUp(b);var d,c;c=this._touches;var g=b.target,e=
b.pointerId,f=this._touchIds,l=(new Date).getTime();d=c[e]={};d.pointerId=e;d.startX=d.pageX=b.pageX;d.startY=d.pageY=b.pageY;d.startTS=l;f.push(e);this._numTouches++;g.setPointerCapture?g.setPointerCapture(e):g.msSetPointerCapture&&g.msSetPointerCapture(e);d=c[f[0]];c=c[f[1]];1===this._numTouches||(2===this._numTouches?this._swipeActive&&(d&&(d.startX=d.pageX,d.startY=d.pageY,d.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(b,d))):this._swipeActive?(this._swipeActive=
!1,this._fire("onSwipeEnd",this._processTouchEvent(b,d))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(b,[d,c]))))},_pointerMove:function(a){var b,c,g,e=this._touches,f=this._touchIds;if(b=e[a.pointerId],b&&(b.pageX!==a.pageX||b.pageY!==a.pageY))if(b.pageX=a.pageX,b.pageY=a.pageY,c=Math.abs(b.pageX-b.startX),g=Math.abs(b.pageY-b.startY),!b.moved&&(c>=this.tapRadius||g>=this.tapRadius)&&(b.moved=b.absMoved=!0),1===this._numTouches)this._swipeActive?this._fire("onSwipeMove",
this._processTouchEvent(a,a)):b.moved&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(a,a)));else if(2===this._numTouches)if(b=e[f[0]],e=e[f[1]],this._pinchActive)this._fire("onPinchMove",this._processTouchEvent(a,[b,e]));else if(b.moved||e.moved){f=Math.abs(b.startX-e.startX);c=Math.abs(b.startY-e.startY);g=Math.abs(b.pageX-e.pageX);var l=Math.abs(b.pageY-e.pageY);Math.abs(Math.sqrt(g*g+l*l)-Math.sqrt(f*f+c*c))>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",
this._processTouchEvent(a,[b,e])))}},_pointerUp:function(b){var d,c=this._touches,g=this.node,e=b.target,f=b.pointerId,l=this._touchIds,m=l.slice(0),h=a.map(m,function(a){return c[a]}),k=(new Date).getTime();if(d=c[f])if(d.pageX=b.pageX,d.pageY=b.pageY,d.endTS=k,this._numTouches--,e.releasePointerCapture?e.releasePointerCapture(f):e.msReleasePointerCapture&&e.msReleasePointerCapture(f),0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",
this._processTouchEvent(b,b));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(b,b));else{if(!d.absMoved){for(var f=1/0,l=-(1/0),k=1/0,x=-(1/0),y=this.tapStartTolerance,e=0;e<m.length;e++)d=h[e],d.startTS<f&&(f=d.startTS),d.startTS>l&&(l=d.startTS),d.endTS<k&&(k=d.endTS),d.endTS>x&&(x=d.endTS);Math.abs(l-f)<=y&&Math.abs(x-k)<=y&&this._basicTap(b,h)}}else if(1===this._numTouches&&this._pinchActive){l.splice(a.indexOf(l,b.pointerId),1);delete c[b.pointerId];
d=c[l[0]];if(d.startX=d.pageX,d.startY=d.pageY,d.moved=!1,document.msElementsFromPoint)m=document.msElementsFromPoint(d.pageX,d.pageY),a.some(m,function(a){return a===g})||(this._touches={},this._touchIds=[],this._numTouches=0);this._pinchActive=!1;this._fire("onPinchEnd",this._processTouchEvent(b,[b,d]))}},_pointerCancel:function(a){this._numTouches&&this._pointerUp(a)},_basicTap:function(a,b){var c=(new Date).getTime(),d=this,g=this._immediate;a=this._processTouchEvent(a,b);this._taps.push({touchInfos:b,
ts:c,event:a});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",a);clearTimeout(this._tapTimer);c=2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration;this._tapTimer=setTimeout(function(){var a=d;d=null;clearTimeout(a._tapTimer);a._analyzeTap(g)},g?0:c)},_analyzeTap:function(a){var b=this._taps,c=b[0],g=b[1],e=c.touchInfos,f=g&&g.touchInfos;if(b.length)if(a||(this._taps=[]),c&&g)if(e.length===f.length)if(g.ts-c.ts<=this.doubleTapDuration){var l,m,h;1===e.length?(m=
Math.abs(e[0].startX-f[0].startX),h=Math.abs(e[0].startY-f[0].startY),l=m<=this.doubleTapRadius&&h<=this.doubleTapRadius):l=!0;l?this._processedDoubleTap(b):this._processedTap(g)}else this._processedTap(g);else this._processedTap(g);else this._processedTap(c||g)},_processedTap:function(a){var b=a.event;this._fire("onProcessedTap",b);1===a.touchInfos.length?this._fire("onTap",this._fixEvent(b)):2===a.touchInfos.length&&this._fire("onTwoFingerTap",b)},_processedDoubleTap:function(a){var b,c=1===a[1].touchInfos.length;
c&&(b=[this._fixEvent(a[0].event),this._fixEvent(a[1].event)],b[1].relatedEvents=b);a=[a[0].event,a[1].event];a[1].relatedEvents=a;this._fire("onProcessedDoubleTap",a[1]);c&&(this._fire("onDoubleTap",b[1]),this._fire("onDblClick",b[1]))},_mouseOver:function(a){this._fire("onMouseOver",this._processMouseEvent(a))},_mouseMove:function(a){this._dragging?this._fire("onMouseDrag",this._processMouseEvent(a)):this._fire("onMouseMove",this._processMouseEvent(a))},_mouseOut:function(a){this._fire("onMouseOut",
this._processMouseEvent(a))},_mouseLeave:function(a){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseOut",this._processMouseEvent(event))},_mouseDown:function(a){this._downX=a.pageX;this._downY=a.pageY;this._fire("onMouseDown",this._processMouseEvent(a));0===a.button&&(this._dragging=!0,this._fire("onMouseDragStart",this._processMouseEvent(a)))},_mouseUp:function(a){this._dragging&&(this._dragging=!1,this._fire("onMouseDragEnd",
this._processMouseEvent(a)));this._fire("onMouseUp",this._processMouseEvent(a))},_mouseClick:function(a){Math.abs(a.pageX-this._downX)<=this.clickRadius&&Math.abs(a.pageY-this._downY)<=this.clickRadius&&this._fire("onClick",this._processMouseEvent(a))},_mouseWheel:function(a){var b=this.map;(b?b.isScrollWheelZoom||b.isScrollWheelPan:this.preventPageScroll)&&a.preventDefault();var b=a.wheelDelta?a.wheelDelta/this.wheelDivisor:-a.detail/this.mozWheelDivisor,c=Math.abs(b),c=c<=this.minWheelValue?this.minWheelValue:
this.maxWheelValue;a.value=0>b?-c:c;this._fire("onMouseWheel",this._processMouseEvent(a))},_mouseEnter:function(a){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);document.addEventListener("keydown",this._onKeyDown,!1);document.addEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseEnter",this._processMouseEvent(a))},_onKeyDown:function(a){this._fire("onKeyDown",a)},_onKeyUp:function(a){this._fire("onKeyUp",a)},_fire:function(a,
b){this[a]&&this[a](b);this.map&&this.map[a]&&this.map[a](b)},_fixEvent:function(a){var b,c={};for(b in a)c[b]=a[b];return c.preventDefault=function(){a.preventDefault()},c.stopPropagation=function(){a.stopPropagation()},this.map&&(c.screenPoint=c.screenPoints[0],c.mapPoint=c.mapPoints[0]),c},_processTouchEvent:function(a,b){var c=this.map,d=c&&c.position,g=0;if(d&&b)if(k.isArray(b)){var e,f;a.screenPoints=[];a.mapPoints=[];for(e=0;e<b.length;e++)b[e]?(f=new m(b[e].pageX-d.x,b[e].pageY-d.y),a.screenPoints.push(f),
a.mapPoints.push(c.extent?c.toMap(f):new l)):g++}else a.screenPoint=new m(b.pageX-d.x,b.pageY-d.y),a.mapPoint=c.extent?c.toMap(a.screenPoint):new l;return a.numPoints=b?k.isArray(b)?b.length-g:1:0,a},_processMouseEvent:function(a){var b=this.map,c=b&&b.position;return c&&(a.screenPoint=new m(a.pageX-c.x,a.pageY-c.y),a.mapPoint=b.extent?b.toMap(a.screenPoint):new l),a},setImmediateTap:function(a){this._immediate=a},destroy:function(){var a=this.node;a.removeEventListener("MSPointerDown",this._pointerDown,
!1);a.removeEventListener("MSPointerMove",this._pointerMove,!1);a.removeEventListener("MSPointerUp",this._pointerUp,!1);a.removeEventListener("MSPointerCancel",this._pointerCancel,!1);this.map&&(a.removeEventListener("mouseover",this._mouseOver,!1),a.removeEventListener("mousemove",this._mouseMove,!1),a.removeEventListener("mouseout",this._mouseOut,!1),a.removeEventListener("mouseleave",this._mouseLeave,!1),a.removeEventListener("mousedown",this._mouseDown,!1),a.removeEventListener("mouseup",this._mouseUp,
!1),a.removeEventListener("click",this._mouseClick,!1),a.removeEventListener("mouseenter",this._mouseEnter,!1));clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._touches=this._touchIds=this._taps=null}});return f("extend-esri")&&(b.PointerEvents=h),h})},"esri/IdentityManager":function(){define(["./IdentityManagerDialog","./kernel","./OAuthSignInHandler","dojo/_base/declare"],function(h,k,a,f){h=new h;return k.id=f.safeMixin(h,a),k.id})},"esri/IdentityManagerDialog":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/has dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ./kernel ./lang ./domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/jsapi dojo/query dijit/form/Button dijit/form/Form dijit/form/ValidationTextBox".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v){k=k([r],{declaredClass:"esri.IdentityManager",_eventMap:{"dialog-cancel":["info"]},constructor:function(a){b.mixin(this,a);this.registerConnectEvents()},_dialogContent:"\x3cdiv data-dojo-type\x3d'dijit.form.Form' data-dojo-props\x3d'\"class\":\"esriIdForm\"'\x3e\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblUser}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblPwd}\x3c/label\x3e\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
onDialogCreate:function(){},onDialogCancel:function(){},signIn:function(c,b,d){this._nls||(this._nls=v.identity);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.onDialogCreate());var g=this._loginDialog,e=d&&d.error,n=d&&d.token,m=new f(function(){g.onCancel()});return g.open?(c=Error("BUSY"),c.code="IdentityManager.1",c.log=a.isDebug,m.errback(c),m):(q.hide(g.errMsg_),e&&403==e.code&&n&&(l.set(g.errMsg_,"innerHTML",this._nls.forbidden),q.show(g.errMsg_)),g.dfd_=m,
g.serverInfo_=b,g.resUrl_=c,g.admin_=d&&d.isAdmin,l.set(g.resLink_,{title:c,innerHTML:"("+(this.getResourceName(c)||this._nls.lblItem)+")"}),l.set(g.serverLink_,{title:b.server,innerHTML:(-1!==b.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":b.server)+" "}),g.txtPwd_.set("value",""),g.show(),m)},_createLoginDialog:function(){var b=this._nls,e=n.substitute(b,this._dialogContent),e=n.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},
e),f=new d({title:b.title,content:e,"class":"esriSignInDialog",style:"width: 18em;",esriIdMgr_:this,keypressed_:function(a){a.charOrCode===m.ENTER&&this.execute_()},execute_:function(){var a=this.txtUser_.get("value"),g=this.txtPwd_.get("value"),e=this.dfd_,f=this;if(this.form_.validate()&&a&&g){this.btnSubmit_.set("label",b.lblSigning);var m=c.id.findCredential(f.resUrl_,a),h=function(c){f.btnSubmit_.set("label",b.lblOk);f.btnSubmit_.set("disabled",!1);q.hide(f.errMsg_);f.hide();d._DialogLevelManager.hide(f);
var g=f.serverInfo_;f.dfd_=f.serverInfo_=f.generateDfd_=f.resUrl_=null;var l,h,r,u=m;c&&(l=c.token,h=n.isDefined(c.expires)?Number(c.expires):null,r=!!c.ssl,u?(u.userId=a,u.token=l,u.expires=h,u.validity=c.validity,u.ssl=r,u.creationTime=(new Date).getTime()):u=new t({userId:a,server:g.server,token:l,expires:h,ssl:r,isAdmin:f.admin_,validity:c.validity}));e.callback(u)};if(m&&!m._enqueued)return void h();f.btnSubmit_.set("disabled",!0);f.generateDfd_=c.id.generateToken(this.serverInfo_,{username:a,
password:g},{isAdmin:this.admin_}).addCallback(h).addErrback(function(a){f.btnSubmit_.set("disabled",!1);f.generateDfd_=null;f.btnSubmit_.set("label",b.lblOk);l.set(f.errMsg_,"innerHTML",a&&a.code?b.invalidUser:b.noAuthService);q.show(f.errMsg_)})}},cancel_:function(){f.generateDfd_&&f.generateDfd_.cancel();var c=f.dfd_,b=f.resUrl_,g=f.serverInfo_;f.btnSubmit_.set("disabled",!1);f.dfd_=f.serverInfo_=f.generateDfd_=f.resUrl_=null;q.hide(f.errMsg_);d._DialogLevelManager.hide(f);f.esriIdMgr_.onDialogCancel({resourceUrl:b,
serverInfo:g});b=Error("ABORTED");b.code="IdentityManager.2";b.log=a.isDebug;c.errback(b)}}),e=f.domNode;return f.form_=g.byNode(h.query(".esriIdForm",e)[0]),f.txtUser_=g.byNode(h.query(".esriIdUser",e)[0]),f.txtPwd_=g.byNode(h.query(".esriIdPwd",e)[0]),f.btnSubmit_=g.byNode(h.query(".esriIdSubmit",e)[0]),f.btnCancel_=g.byNode(h.query(".esriIdCancel",e)[0]),f.resLink_=h.query(".resLink",e)[0],f.serverLink_=h.query(".serverLink",e)[0],f.errMsg_=h.query(".esriErrorMsg",e)[0],f.connect(f.txtUser_,"onKeyPress",
f.keypressed_),f.connect(f.txtPwd_,"onKeyPress",f.keypressed_),f.connect(f.btnSubmit_,"onClick",f.execute_),f.connect(f.btnCancel_,"onClick",f.onCancel),f.connect(f,"onCancel",f.cancel_),f}});return e("extend-esri")&&(c.IdentityManagerDialog=c.IdentityManager=k),k})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J){function L(){}var M=new b;M.resolve(!0);A=f("dijit._DialogBase"+(v("dojo-bidi")?"_NoBidi":""),[B,D,E,C],{templateString:J,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:A.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(a){this._set("draggable",a)},maxRatio:.9,
closable:!0,_setClosableAttr:function(a){this.closeButtonNode.style.display=a?"":"none";this._set("closable",a)},postMixInProperties:function(){var a=c.getLocalization("dijit","common");q.mixin(this,a);this.inherited(arguments)},postCreate:function(){g.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);a.after(this,"onExecute",q.hitch(this,"hide"),!0);a.after(this,"onCancel",q.hitch(this,"hide"),!0);this._modalconnects=
[]},onLoad:function(){this.resize();this._position();this.autofocus&&K.isTop(this)&&(this._getFocusItems(),y.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();y.focus(this._firstFocusItem)},_endDrag:function(){var a=m.position(this.domNode),c=u.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,0),c.h-a.h);a.x=Math.min(Math.max(a.x,0),c.w-a.w);this._relativePosition=a;this._position()},_setup:function(){var c=this.domNode;this.titleBar&&this.draggable?
(this._moveable=new (6==v("ie")?x:w)(c,{handle:this.titleBar}),a.after(this._moveable,"onMoveStop",q.hitch(this,"_endDrag"),!0)):l.add(c,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":k.map(this["class"].split(/\s/),function(a){return a+"_underlay"}).join(" "),_onKeyDown:q.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!l.contains(this.ownerDocumentBody,"dojoMove")){var a=this.domNode,c=u.getBox(this.ownerDocument),
b=this._relativePosition,d=m.position(a);g.set(a,{left:Math.floor(c.l+(b?Math.min(b.x,c.w-d.w):(c.w-d.w)/2))+"px",top:Math.floor(c.t+(b?Math.min(b.y,c.h-d.h):(c.h-d.h)/2))+"px"})}},_onKey:function(a){if(a.keyCode==n.TAB){this._getFocusItems();var c=a.target;this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):c==this._firstFocusItem&&a.shiftKey?(y.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):c!=this._lastFocusItem||a.shiftKey||(y.focus(this._firstFocusItem),
a.stopPropagation(),a.preventDefault())}else this.closable&&a.keyCode==n.ESCAPE&&(this.onCancel(),a.stopPropagation(),a.preventDefault())},show:function(){if(this.open)return M.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),K.hide(this));var a=u.get(this.ownerDocument);this._modalconnects.push(t(a,"scroll",q.hitch(this,"resize",null)));this._modalconnects.push(t(this.domNode,"keydown",
q.hitch(this,"_onKey")));g.set(this.domNode,{opacity:0,display:""});this._set("open",!0);this._onShow();this.resize();this._position();var c;this._fadeInDeferred=new b(q.hitch(this,function(){c.stop();delete this._fadeInDeferred}));this._fadeInDeferred.then(void 0,L);a=this._fadeInDeferred.promise;c=d.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:q.hitch(this,function(){K.show(this,this.underlayAttrs)}),onEnd:q.hitch(this,function(){this.autofocus&&K.isTop(this)&&(this._getFocusItems(),
y.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();return a},hide:function(){if(!this._alreadyInitialized||!this.open)return M.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();var a;this._fadeOutDeferred=new b(q.hitch(this,function(){a.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(void 0,L);this._fadeOutDeferred.then(q.hitch(this,"onHide"));var c=this._fadeOutDeferred.promise;a=d.fadeOut({node:this.domNode,duration:this.duration,
onEnd:q.hitch(this,function(){this.domNode.style.display="none";K.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();this._scrollConnected&&(this._scrollConnected=!1);for(var g;g=this._modalconnects.pop();)g.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return c},resize:function(a){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!a){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&
(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),k.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode],function(a){a&&g.set(a,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var c=u.getBox(this.ownerDocument);c.w*=this.maxRatio;c.h*=this.maxRatio;var b=m.position(this.domNode);b.w>=c.w||b.h>=c.h?(a={w:Math.min(b.w,c.w),h:Math.min(b.h,c.h)},this._shrunk=!0):this._shrunk=!1}if(a){m.setMarginBox(this.domNode,
a);c=[];this.titleBar&&c.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&c.push({domNode:this.actionBarNode,region:"bottom"});b={domNode:this.containerNode,region:"center"};c.push(b);var d=I.marginBox2contentBox(this.domNode,a);I.layoutChildren(this.domNode,d,c);this._singleChild?(c=I.marginBox2contentBox(this.containerNode,b),this._singleChild.resize({w:c.w,h:c.h})):(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();v("touch")||a||this._position()}},
_layoutChildren:function(){k.forEach(this.getChildren(),function(a){a.resize&&a.resize()})},destroy:function(){this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var a;a=this._modalconnects.pop();)a.remove();K.hide(this);this.inherited(arguments)}});v("dojo-bidi")&&(A=f("dijit._DialogBase",A,{_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},
_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title))}}));var H=f("dijit.Dialog",[G,A],{});H._DialogBase=A;var K=H._DialogLevelManager={_beginZIndex:950,show:function(a,c){P[P.length-1].focus=y.curNode;var b=P[P.length-1].dialog?P[P.length-1].zIndex+2:H._DialogLevelManager._beginZIndex;g.set(a.domNode,"zIndex",b);F.show(c,b-1);P.push({dialog:a,underlayAttrs:c,zIndex:b})},hide:function(a){if(P[P.length-1].dialog==a){P.pop();var c=P[P.length-
1];1==P.length?F.hide():F.show(c.underlayAttrs,c.zIndex-1);if(a.refocus&&(a=c.focus,!c.dialog||a&&e.isDescendant(a,c.dialog.domNode)||(c.dialog._getFocusItems(),a=c.dialog._firstFocusItem),a))try{a.focus()}catch(Q){}}else c=k.indexOf(k.map(P,function(a){return a.dialog}),a),-1!=c&&P.splice(c,1)},isTop:function(a){return P[P.length-1].dialog==a}},P=H._dialogStack=[{dialog:null,focus:null,underlayAttrs:null}];y.watch("curNode",function(a,c,b){a=P[P.length-1].dialog;if(b&&a&&!a._fadeOutDeferred&&b.ownerDocument==
a.ownerDocument){do if(b==a.domNode||l.contains(b,"dijitPopup"))return;while(b=b.parentNode);a.focus()}});v("dijit-legacy-requires")&&r(0,function(){h(["dijit/TooltipDialog"])});return H})},"dojo/dnd/Moveable":function(){define("../_base/array ../_base/declare ../_base/lang ../dom ../dom-class ../Evented ../has ../on ../topic ../touch ./common ./Mover ../_base/window".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q){function t(a,c){"touchAction"in document.body.style?r="touchAction":"msTouchAction"in
document.body.style&&(r="msTouchAction");v=function(a,c){a.style[r]=c};v(a,c)}var r,v=function(){};l("touch-action")&&(v=t);return k("dojo.dnd.Moveable",[e],{handle:"",delay:0,skip:!1,constructor:function(c,b){this.node=f.byId(c);v(this.node,"none");b||(b={});this.handle=b.handle?f.byId(b.handle):null;this.handle||(this.handle=this.node);this.delay=0<b.delay?b.delay:0;this.skip=b.skip;this.mover=b.mover?b.mover:n;this.events=[m(this.handle,d.press,a.hitch(this,"onMouseDown")),m(this.handle,"dragstart",
a.hitch(this,"onSelectStart")),m(this.handle,"selectstart",a.hitch(this,"onSelectStart"))]},markupFactory:function(a,c,b){return new b(c,a)},destroy:function(){h.forEach(this.events,function(a){a.remove()});v(this.node,"");this.events=this.node=this.handle=null},onMouseDown:function(b){if(!this.skip||!c.isFormElement(b)){if(this.delay)this.events.push(m(this.handle,d.move,a.hitch(this,"onMouseMove")),m(this.handle.ownerDocument,d.release,a.hitch(this,"onMouseUp"))),this._lastX=b.pageX,this._lastY=
b.pageY;else this.onDragDetected(b);b.stopPropagation();b.preventDefault()}},onMouseMove:function(a){if(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)this.onMouseUp(a),this.onDragDetected(a);a.stopPropagation();a.preventDefault()},onMouseUp:function(a){for(var c=0;2>c;++c)this.events.pop().remove();a.stopPropagation();a.preventDefault()},onSelectStart:function(a){this.skip&&c.isFormElement(a)||(a.stopPropagation(),a.preventDefault())},onDragDetected:function(a){new this.mover(this.node,
a,this)},onMoveStart:function(a){g.publish("/dnd/move/start",a);b.add(q.body(),"dojoMove");b.add(this.node,"dojoMoveItem")},onMoveStop:function(a){g.publish("/dnd/move/stop",a);b.remove(q.body(),"dojoMove");b.remove(this.node,"dojoMoveItem")},onFirstMove:function(){},onMove:function(a,c){this.onMoving(a,c);var b=a.node.style;b.left=c.l+"px";b.top=c.t+"px";this.onMoved(a,c)},onMoving:function(){},onMoved:function(){}})})},"dojo/dnd/common":function(){define(["../sniff","../_base/kernel","../_base/lang",
"../dom"],function(h,k,a,f){var b=a.getObject("dojo.dnd",!0);b.getCopyKeyState=function(a){return a[h("mac")?"metaKey":"ctrlKey"]};b._uniqueId=0;b.getUniqueId=function(){var a;do a=k._scopeName+"Unique"+ ++b._uniqueId;while(f.byId(a));return a};b._empty={};b.isFormElement=function(a){a=a.target;3==a.nodeType&&(a=a.parentNode);return 0<=" a button textarea input select option ".indexOf(" "+a.tagName.toLowerCase()+" ")};return b})},"dojo/dnd/Mover":function(){define("../_base/array ../_base/declare ../_base/lang ../sniff ../_base/window ../dom ../dom-geometry ../dom-style ../Evented ../on ../touch ./common ./autoscroll".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q){return k("dojo.dnd.Mover",[g],{constructor:function(b,g,f){function l(a){a.preventDefault();a.stopPropagation()}this.node=e.byId(b);this.marginBox={l:g.pageX,t:g.pageY};this.mouseButton=g.button;g=this.host=f;b=b.ownerDocument;this.events=[d(b,c.move,a.hitch(this,"onFirstMove")),d(b,c.move,a.hitch(this,"onMouseMove")),d(b,c.release,a.hitch(this,"onMouseUp")),d(b,"dragstart",l),d(b.body,"selectstart",l)];q.autoScrollStart(b);if(g&&g.onMoveStart)g.onMoveStart(this)},
onMouseMove:function(a){q.autoScroll(a);var c=this.marginBox;this.host.onMove(this,{l:c.l+a.pageX,t:c.t+a.pageY},a);a.preventDefault();a.stopPropagation()},onMouseUp:function(a){(f("webkit")&&f("mac")&&2==this.mouseButton?0==a.button:this.mouseButton==a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var c=this.node.style,d,g=this.host;switch(c.position){case "relative":case "absolute":d=Math.round(parseFloat(c.left))||0;c=Math.round(parseFloat(c.top))||0;break;
default:c.position="absolute";c=l.getMarginBox(this.node);d=b.doc.body;var e=m.getComputedStyle(d),f=l.getMarginBox(d,e),e=l.getContentBox(d,e);d=c.l-(e.l-f.l);c=c.t-(e.t-f.t)}this.marginBox.l=d-this.marginBox.l;this.marginBox.t=c-this.marginBox.t;if(g&&g.onFirstMove)g.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){h.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"dojo/dnd/autoscroll":function(){define("../_base/lang ../sniff ../_base/window ../dom-geometry ../dom-style ../window".split(" "),
function(h,k,a,f,b,e){var l={};h.setObject("dojo.dnd.autoscroll",l);l.getViewport=e.getBox;l.V_TRIGGER_AUTOSCROLL=32;l.H_TRIGGER_AUTOSCROLL=32;l.V_AUTOSCROLL_VALUE=16;l.H_AUTOSCROLL_VALUE=16;var m,g=a.doc,d=Infinity,c=Infinity;l.autoScrollStart=function(b){g=b;m=e.getBox(g);b=a.body(g).parentNode;d=Math.max(b.scrollHeight-m.h,0);c=Math.max(b.scrollWidth-m.w,0)};l.autoScroll=function(b){var f=m||e.getBox(g),n=a.body(g).parentNode,h=0,v=0;b.clientX<l.H_TRIGGER_AUTOSCROLL?h=-l.H_AUTOSCROLL_VALUE:b.clientX>
f.w-l.H_TRIGGER_AUTOSCROLL&&(h=Math.min(l.H_AUTOSCROLL_VALUE,c-n.scrollLeft));b.clientY<l.V_TRIGGER_AUTOSCROLL?v=-l.V_AUTOSCROLL_VALUE:b.clientY>f.h-l.V_TRIGGER_AUTOSCROLL&&(v=Math.min(l.V_AUTOSCROLL_VALUE,d-n.scrollTop));window.scrollBy(h,v)};l._validNodes={div:1,p:1,td:1};l._validOverflow={auto:1,scroll:1};l.autoScrollNodes=function(c){for(var d,g,e,n,m,h=0,x=0,y=c.target;y;){if(1==y.nodeType&&y.tagName.toLowerCase()in l._validNodes){e=b.getComputedStyle(y);m=e.overflowX.toLowerCase()in l._validOverflow;
n=e.overflowY.toLowerCase()in l._validOverflow;if(m||n)d=f.getContentBox(y,e),g=f.position(y,!0);if(m){e=Math.min(l.H_TRIGGER_AUTOSCROLL,d.w/2);m=c.pageX-g.x;if(k("webkit")||k("opera"))m+=a.body().scrollLeft;h=0;0<m&&m<d.w&&(m<e?h=-e:m>d.w-e&&(h=e),y.scrollLeft+=h)}if(n){n=Math.min(l.V_TRIGGER_AUTOSCROLL,d.h/2);e=c.pageY-g.y;if(k("webkit")||k("opera"))e+=a.body().scrollTop;x=0;0<e&&e<d.h&&(e<n?x=-n:e>d.h-n&&(x=n),y.scrollTop+=x)}if(h||x)return}try{y=y.parentNode}catch(A){y=null}}l.autoScroll(c)};
return l})},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(h,k){var a=k.prototype.onMove;return h("dojo.dnd.TimedMoveable",k,{timeout:40,constructor:function(a,b){b||(b={});b.timeout&&"number"==typeof b.timeout&&0<=b.timeout&&(this.timeout=b.timeout)},onMoveStop:function(f){f._timer&&(clearTimeout(f._timer),a.call(this,f,f._leftTop));k.prototype.onMoveStop.apply(this,arguments)},onMove:function(f,b){f._leftTop=b;if(!f._timer){var e=this;f._timer=setTimeout(function(){f._timer=
null;a.call(e,f,f._leftTop)},this.timeout)}}})})},"dijit/_base/manager":function(){define(["dojo/_base/array","dojo/_base/config","dojo/_base/lang","../registry","../main"],function(h,k,a,f,b){var e={};h.forEach("byId getUniqueId findWidgets _destroyAll byNode getEnclosingWidget".split(" "),function(a){e[a]=f[a]});a.mixin(e,{defaultDuration:k.defaultDuration||200});a.mixin(b,e);return b})},"dijit/_CssStateMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-class dojo/has dojo/_base/lang dojo/on dojo/domReady dojo/touch dojo/_base/window ./a11yclick ./registry".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n){k=k("dijit._CssStateMixin",[],{hovering:!1,active:!1,_applyAttributes:function(){this.inherited(arguments);h.forEach("disabled readOnly checked selected focused state hovering active _opened".split(" "),function(a){this.watch(a,e.hitch(this,"_setStateClass"))},this);for(var a in this.cssStateNodes||{})this._trackMouseState(this[a],this.cssStateNodes[a]);this._trackMouseState(this.domNode,this.baseClass);this._setStateClass()},_cssMouseEvent:function(a){if(!this.disabled)switch(a.type){case "mouseover":case "MSPointerOver":case "pointerover":this._set("hovering",
!0);this._set("active",this._mouseDown);break;case "mouseout":case "MSPointerOut":case "pointerout":this._set("hovering",!1);this._set("active",!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":this._set("active",!0);break;case "mouseup":case "dojotouchend":case "MSPointerUp":case "pointerup":case "keyup":this._set("active",!1)}},_setStateClass:function(){function a(a){c=c.concat(h.map(c,function(c){return c+a}),"dijit"+a)}var c=this.baseClass.split(" ");
this.isLeftToRight()||a("Rtl");var b="mixed"==this.checked?"Mixed":this.checked?"Checked":"";this.checked&&a(b);this.state&&a(this.state);this.selected&&a("Selected");this._opened&&a("Opened");this.disabled?a("Disabled"):this.readOnly?a("ReadOnly"):this.active?a("Active"):this.hovering&&a("Hover");this.focused&&a("Focused");var b=this.stateNode||this.domNode,d={};h.forEach(b.className.split(" "),function(a){d[a]=!0});"_stateClasses"in this&&h.forEach(this._stateClasses,function(a){delete d[a]});h.forEach(c,
function(a){d[a]=!0});var g=[],e;for(e in d)g.push(e);b.className=g.join(" ");this._stateClasses=c},_subnodeCssMouseEvent:function(a,c,b){function d(b){f.toggle(a,c+"Active",b)}if(!this.disabled&&!this.readOnly)switch(b.type){case "mouseover":case "MSPointerOver":case "pointerover":f.toggle(a,c+"Hover",!0);break;case "mouseout":case "MSPointerOut":case "pointerout":f.toggle(a,c+"Hover",!1);d(!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":d(!0);
break;case "mouseup":case "MSPointerUp":case "pointerup":case "dojotouchend":case "keyup":d(!1);break;case "focus":case "focusin":f.toggle(a,c+"Focused",!0);break;case "blur":case "focusout":f.toggle(a,c+"Focused",!1)}},_trackMouseState:function(a,c){a._cssState=c}});m(function(){function b(c,b,d){if(!d||!a.isDescendant(d,b))for(;b&&b!=d;b=b.parentNode)if(b._cssState){var g=n.getEnclosingWidget(b);g&&(b==g.domNode?g._cssMouseEvent(c):g._subnodeCssMouseEvent(b,b._cssState,c))}}var e=d.body(),f;l(e,
g.over,function(a){b(a,a.target,a.relatedTarget)});l(e,g.out,function(a){b(a,a.target,a.relatedTarget)});l(e,c.press,function(a){f=a.target;b(a,f)});l(e,c.release,function(a){b(a,f);f=null});l(e,"focusin, focusout",function(a){var c=a.target;if(c._cssState&&!c.getAttribute("widgetId")){var b=n.getEnclosingWidget(c);b&&b._subnodeCssMouseEvent(c,c._cssState,a)}})});return k})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),
function(h,k,a,f,b,e){return k("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(a){var b=[];h.forEach(a||this.getChildren(),function(a){"value"in a?b.push(a):b=b.concat(this._getDescendantFormWidgets(a.getChildren()))},this);return b},reset:function(){h.forEach(this._getDescendantFormWidgets(),function(a){a.reset&&a.reset()})},validate:function(){var a=!1;return h.every(h.map(this._getDescendantFormWidgets(),function(b){b._hasBeenBlurred=!0;var g=b.disabled||!b.validate||
b.validate();g||a||(e.scrollIntoView(b.containerNode||b.domNode),b.focus(),a=!0);return g}),function(a){return a})},setValues:function(b){a.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",b)},_setValueAttr:function(a){var b={};h.forEach(this._getDescendantFormWidgets(),function(a){a.name&&(b[a.name]||(b[a.name]=[])).push(a)});for(var g in b)if(b.hasOwnProperty(g)){var d=b[g],c=f.getObject(g,!1,a);void 0!==c&&(c=[].concat(c),
"boolean"==typeof d[0].checked?h.forEach(d,function(a){a.set("value",-1!=h.indexOf(c,a._get("value")))}):d[0].multiple?d[0].set("value",c):h.forEach(d,function(a,b){a.set("value",c[b])}))}},getValues:function(){a.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},_getValueAttr:function(){var a={};h.forEach(this._getDescendantFormWidgets(),function(b){var g=b.name;if(g&&!b.disabled){var d=b.get("value");"boolean"==typeof b.checked?
/Radio/.test(b.declaredClass)?!1!==d?f.setObject(g,d,a):(d=f.getObject(g,!1,a),void 0===d&&f.setObject(g,null,a)):(b=f.getObject(g,!1,a),b||(b=[],f.setObject(g,b,a)),!1!==d&&b.push(d)):(b=f.getObject(g,!1,a),"undefined"!=typeof b?f.isArray(b)?b.push(d):f.setObject(g,[b,d],a):f.setObject(g,d,a))}});return a},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var a=h.map(this._descendants,function(a){return a.get("state")||""});return 0<=h.indexOf(a,"Error")?
"Error":0<=h.indexOf(a,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(a){this._descendants=this._getDescendantFormWidgets();h.forEach(this._descendants,function(a){a._started||a.startup()});a||this._onChildChange()},_onChildChange:function(a){a&&"state"!=a&&"disabled"!=a||this._set("state",this._getState());a&&"value"!=a&&"disabled"!=a&&"checked"!=a||(this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;
this._set("value",this.get("value"))},10))},startup:function(){this.inherited(arguments);this._descendants=this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var a=this;this.own(b(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(b){b.target!=a.domNode&&a._onChildChange(b.type.replace("attrmodified-",""))}));this.watch("state",function(a,b,d){this.onValidStateChange(""==d)})},destroy:function(){this.inherited(arguments)}})})},
"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(h,k){return h("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var a=k._getTabNavigable(this.domNode);this._firstFocusItem=a.lowest||a.first||this.closeButtonNode||this.domNode;this._lastFocusItem=a.last||a.highest||this._firstFocusItem}})})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n){var q=h("dijit.DialogUnderlay",[m,g],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(a){f.set(this.node,"id",a+"_underlay");this._set("dialogId",a)},_setClassAttr:function(a){this.node.className="dijitDialogUnderlay "+a;this._set("class",a)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(e(this.domNode,"keydown",k.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var a=this.node.style,c=this.domNode.style;c.display="none";var b=l.getBox(this.ownerDocument);c.top=b.t+"px";c.left=b.l+"px";a.width=b.w+"px";a.height=b.h+"px";c.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new d(this.domNode);var a=l.get(this.ownerDocument);this._modalConnects=[c.on("resize",k.hitch(this,"layout")),e(a,"scroll",
k.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});q.show=function(a,c){var d=q._singleton;!d||d._destroyed?d=n._underlay=q._singleton=new q(a):a&&d.set(a);b.set(d.domNode,"zIndex",c);d.open||d.show()};q.hide=function(){var a=
q._singleton;a&&!a._destroyed&&a.hide()};return q})},"dijit/BackgroundIframe":function(){define("require ./main dojo/_base/config dojo/dom-construct dojo/dom-style dojo/_base/lang dojo/on dojo/sniff".split(" "),function(h,k,a,f,b,e,l,m){m.add("config-bgIframe",(m("ie")||m("trident"))&&!/IEMobile\/10\.0/.test(navigator.userAgent));var g=new function(){var d=[];this.pop=function(){var c;d.length?(c=d.pop(),c.style.display=""):(9>m("ie")?(c=a.dojoBlankHtmlUrl||h.toUrl("dojo/resources/blank.html")||'javascript:""',
c=document.createElement("\x3ciframe src\x3d'"+c+"' role\x3d'presentation' style\x3d'position: absolute; left: 0px; top: 0px;z-index: -1; filter:Alpha(Opacity\x3d\"0\");'\x3e")):(c=f.create("iframe"),c.src='javascript:""',c.className="dijitBackgroundIframe",c.setAttribute("role","presentation"),b.set(c,"opacity",.1)),c.tabIndex=-1);return c};this.push=function(a){a.style.display="none";d.push(a)}};k.BackgroundIframe=function(a){if(!a.id)throw Error("no id");if(m("config-bgIframe")){var c=this.iframe=
g.pop();a.appendChild(c);7>m("ie")||m("quirks")?(this.resize(a),this._conn=l(a,"resize",e.hitch(this,"resize",a))):b.set(c,{width:"100%",height:"100%"})}};e.extend(k.BackgroundIframe,{resize:function(a){this.iframe&&b.set(this.iframe,{width:a.offsetWidth+"px",height:a.offsetHeight+"px"})},destroy:function(){this._conn&&(this._conn.remove(),this._conn=null);this.iframe&&(this.iframe.parentNode.removeChild(this.iframe),g.push(this.iframe),delete this.iframe)}});return k.BackgroundIframe})},"dijit/nls/common":function(){define({root:{buttonOk:"OK",
buttonCancel:"Cancel",buttonSave:"Save",itemClose:"Close"},bs:!0,mk:!0,sr:!0,zh:!0,"zh-tw":!0,vi:!0,uk:!0,tr:!0,th:!0,sv:!0,sl:!0,sk:!0,ru:!0,ro:!0,pt:!0,"pt-pt":!0,pl:!0,nl:!0,nb:!0,lv:!0,lt:!0,ko:!0,kk:!0,ja:!0,it:!0,id:!0,hu:!0,hr:!0,hi:!0,he:!0,fr:!0,fi:!0,eu:!0,et:!0,es:!0,el:!0,de:!0,da:!0,cs:!0,ca:!0,bg:!0,az:!0,ar:!0})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],function(h,k,a,f){h=h(f.Credential,{});return k("extend-esri")&&(a.Credential=
h),h})},"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/regexp ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A){var z,B={},C=function(a){var c=(new l(a.owningSystemUrl)).host;a=(new l(a.server)).host;var b=
/.+\.arcgis\.com$/i;return b.test(c)&&b.test(a)},D=function(a,c){return!!(C(a)&&c&&f.some(c,function(c){return c.test(a.server)}))},E=h(x,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=a.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=[];this._getOAuthHash()},defaultOAuthInfo:null,defaultTokenValidity:60,tokenValidity:null,signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,
_busy:null,_oAuthHash:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/dev\.arcgis\.com/i,tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,
tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],_regexSDirUrl:/http.+\/rest\/services\/?/gi,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer|VectorTileServer)).*/gi,
_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],_createDefaultOAuthInfo:!0,_hasTestedIfAppIsOnPortal:!1,registerServers:function(a){var c=this.serverInfos;c?(a=f.filter(a,function(a){return!this.findServerInfo(a.server)},this),this.serverInfos=c.concat(a)):
this.serverInfos=a;f.forEach(a,function(a){if(a.owningSystemUrl&&this._portals.push(a.owningSystemUrl),a.hasPortal){this._portals.push(a.server);var c=q.defaults.io.corsEnabledServers,b=this._getOrigin(a.tokenServiceUrl);v.canUseXhr(a.server)||c.push(a.server.replace(/^https?:\/\//i,""));v.canUseXhr(b)||c.push(b.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(a){var c=this.oAuthInfos;c?(a=f.filter(a,function(a){return!this.findOAuthInfo(a.portalUrl)},this),this.oAuthInfos=c.concat(a)):
this.oAuthInfos=a},registerToken:function(c){var b,d=this._sanitizeUrl(c.server),g=this.findServerInfo(d),e=!0;g||(g=new r,g.server=this._getServerInstanceRoot(d),g.tokenServiceUrl=this._getTokenSvcUrl(d),g.hasPortal=!0,this.registerServers([g]));(b=this.findCredential(d,c.userId))?(a.mixin(b,c),e=!1):(b=new z({userId:c.userId,server:g.server,token:c.token,expires:c.expires,ssl:c.ssl,scope:this._isServerRsrc(d)?"server":"portal"}),b.resources=[d],this.credentials.push(b));b.onTokenChange(!1);e||b.refreshServerTokens()},
toJson:function(){return t.fixJson({serverInfos:f.map(this.serverInfos,function(a){return a.toJson()}),oAuthInfos:f.map(this.oAuthInfos,function(a){return a.toJson()}),credentials:f.map(this.credentials,function(a){return a.toJson()})})},initialize:function(c){if(c){a.isString(c)&&(c=e.fromJson(c));var b=c.serverInfos,d=c.oAuthInfos;c=c.credentials;if(b){var g=[];f.forEach(b,function(a){a.server&&a.tokenServiceUrl&&g.push(a.declaredClass?a:new r(a))});g.length&&this.registerServers(g)}if(d){var l=
[];f.forEach(d,function(a){a.appId&&l.push(a.declaredClass?a:new A(a))});l.length&&this.registerOAuthInfos(l)}c&&f.forEach(c,function(a){a.userId&&a.server&&a.token&&a.expires&&a.expires>(new Date).getTime()&&(a=a.declaredClass?a:new z(a),a.onTokenChange(),this.credentials.push(a))},this)}},findServerInfo:function(a){var c;return a=this._sanitizeUrl(a),f.some(this.serverInfos,function(b){return this._hasSameServerInstance(b.server,a)&&(c=b),!!c},this),c},findOAuthInfo:function(a){var c;return a=this._sanitizeUrl(a),
f.some(this.oAuthInfos,function(b){return this._hasSameServerInstance(b.portalUrl,a)&&(c=b),!!c},this),c},findCredential:function(a,c){var b,d;return a=this._sanitizeUrl(a),d=this._isServerRsrc(a)?"server":"portal",c?f.some(this.credentials,function(g){return this._hasSameServerInstance(g.server,a)&&c===g.userId&&g.scope===d&&(b=g),!!b},this):f.some(this.credentials,function(c){return this._hasSameServerInstance(c.server,a)&&-1!==this._getIdenticalSvcIdx(a,c)&&c.scope===d&&(b=c),!!b},this),b},getCredential:function(c,
d){var g,e,f=!0;t.isDefined(d)&&(a.isObject(d)?(g=!!d.token,e=d.error,f=!1!==d.prompt):g=d);c=this._sanitizeUrl(c);var l,n=new b(u._dfdCanceller),m=this._isAdminResource(c),h=g&&this._doPortalSignIn(c)?this._getEsriAuthCookie():null;g=g?this.findCredential(c):null;if(h||g)return l=Error("You are currently signed in as: '"+(h&&h.email||g&&g.userId)+"'. You do not have access to this resource: "+c),l.code="IdentityManagerBase.1",l.httpCode=e&&e.httpCode,l.messageCode=e?e.messageCode:null,l.subcode=
e?e.subcode:null,l.details=e?e.details:null,l.log=k.isDebug,n.errback(l),n;if(e=this._findCredential(c,d))return n.callback(e),n;if(e=this.findServerInfo(c))!e.hasServer&&this._isServerRsrc(c)&&(e._restInfoDfd=this._getTokenSvcUrl(c,!0),e.hasServer=!0);else{h=this._getTokenSvcUrl(c);if(!h)return l=Error("Unknown resource - could not find token service endpoint."),l.code="IdentityManagerBase.2",l.log=k.isDebug,n.errback(l),n;e=new r;e.server=this._getServerInstanceRoot(c);a.isString(h)?(e.tokenServiceUrl=
h,e.hasPortal=!0):(e._restInfoDfd=h,e.hasServer=!0);this.registerServers([e])}return f&&e.hasPortal&&void 0===e._selfReq&&!this._findOAuthInfo(c)&&(e._selfReq={owningTenant:d&&d.owningTenant,selfDfd:this._getPortalSelf(e.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),c)}),this._enqueue(c,e,d,n,m)},getResourceName:function(a){return this._isRESTService(a)?a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,
"$1")||this._gwItem.test(a)&&a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,"$1")||""},generateToken:function(c,b,d){var g,e,f,m,h,q,r,u,t=this._rePortalTokenSvc.test(c.tokenServiceUrl),x=new l(window.location.href.toLowerCase()),y=this._getEsriAuthCookie(),z=!b,C=c.shortLivedTokenValidity;b&&(u=n.id.tokenValidity||C||n.id.defaultTokenValidity,u>C&&(u=C));d&&(g=d.isAdmin,e=d.serverUrl,f=d.token,q=d.ssl,c.customParameters=d.customParameters);g?m=c.adminTokenServiceUrl:
(m=c.tokenServiceUrl,h=new l(m.toLowerCase()),y&&(r=y.auth_tier,r=r&&r.toLowerCase()),("web"===r||c.webTierAuth)&&d&&d.serverUrl&&!q&&"http"===x.scheme&&(v.hasSameOrigin(x.uri,m,!0)||"https"===h.scheme&&x.host===h.host&&"7080"===x.port&&"7443"===h.port)&&(m=m.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),z&&t&&(m=m.replace(/\/rest/i,"")));g=a.mixin({url:m,content:a.mixin({request:"getToken",username:b&&b.username,password:b&&b.password,serverUrl:e,token:f,expiration:u,referer:g||t?window.location.host:
null,client:g?"referer":null,f:"json"},c.customParameters),handleAs:"json",callbackParamName:z?"callback":void 0},d&&d.ioArgs);d={usePost:!z,disableIdentityLookup:!0,useProxy:this._useProxy(c,d)};t||(g.withCredentials=!1);t=w(g,d);return t.addCallback(function(a){if(!a||!a.token)return a=Error("Unable to generate token"),a.code="IdentityManagerBase.3",a.log=k.isDebug,a;var d=c.server;return B[d]||(B[d]={}),b&&(B[d][b.username]=b.password),a.validity=u,a}),t.addErrback(function(a){}),t},isBusy:function(){return!!this._busy},
checkSignInStatus:function(a){return this.getCredential(a,{prompt:!1})},setRedirectionHandler:function(a){this._redirectFunc=a},setProtocolErrorHandler:function(a){this._protocolFunc=a},signIn:function(){},oAuthSignIn:function(){},onCredentialCreate:function(){},onCredentialsDestroy:function(){},destroyCredentials:function(){if(this.credentials){var a=this.credentials.slice();f.forEach(a,function(a){a.destroy()})}this.onCredentialsDestroy()},_getOAuthHash:function(){var a=window.location.hash;if(a){"#"===
a.charAt(0)&&(a=a.substring(1));var a=d.queryToObject(a),c=!1;a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username")?(a.state=e.fromJson(a.state),this._oAuthHash=a,c=!0):a.error&&a.error_description&&"access_denied"===a.error&&(c=!0);c&&(!m("ie")||8<m("ie"))&&(window.location.hash="")}},_findCredential:function(a,c){var b,d,g,e,l=-1,n=c&&c.token,m=c&&c.resource,h=this._isServerRsrc(a)?"server":"portal",q=f.filter(this.credentials,function(c){return this._hasSameServerInstance(c.server,
a)&&c.scope===h},this);if(a=m||a,q.length)if(1===q.length){if(b=q[0],e=this.findServerInfo(b.server),d=e&&e.owningSystemUrl,g=d&&this.findCredential(d,b.userId),l=this._getIdenticalSvcIdx(a,b),!n)return-1===l&&b.resources.push(a),this._addResource(a,g),b;-1!==l&&(b.resources.splice(l,1),this._removeResource(a,g))}else{var r,u;if(f.some(q,function(c){return u=this._getIdenticalSvcIdx(a,c),-1!==u?(r=c,e=this.findServerInfo(r.server),d=e&&e.owningSystemUrl,g=d&&this.findCredential(d,r.userId),l=u,!0):
!1},this),n)r&&(r.resources.splice(l,1),this._removeResource(a,g));else if(r)return this._addResource(a,g),r}},_findOAuthInfo:function(a){var c=this.findOAuthInfo(a);return c||f.some(this.oAuthInfos,function(b){return this._isIdProvider(b.portalUrl,a)&&(c=b),!!c},this),c},_addResource:function(a,c){c&&-1===this._getIdenticalSvcIdx(a,c)&&c.resources.push(a)},_removeResource:function(a,c){var b=-1;c&&(b=this._getIdenticalSvcIdx(a,c),-1<b&&c.resources.splice(b,1))},_useProxy:function(a,c){return c&&
c.isAdmin&&!v.hasSameOrigin(a.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(a.tokenServiceUrl)&&10.1==a.currentVersion&&!v.hasSameOrigin(a.tokenServiceUrl,window.location.href)},_getOrigin:function(a){a=new l(a);return a.scheme+"://"+a.host+(t.isDefined(a.port)?":"+a.port:"")},_getServerInstanceRoot:function(a){var c=a.toLowerCase(),b=c.indexOf(this._agsRest);return-1===b&&this._isAdminResource(a)&&(b=c.indexOf("/admin")),-1===b&&(b=c.indexOf("/sharing")),-1===b&&"/"===c.substr(-1)&&
(b=c.length-1),-1<b?a.substring(0,b):a},_hasSameServerInstance:function(a,c){return a=a.toLowerCase(),c=this._getServerInstanceRoot(c).toLowerCase(),a=a.substr(a.indexOf(":")),c=c.substr(c.indexOf(":")),a===c},_sanitizeUrl:function(c){c=v.fixUrl(a.trim(c));var b=(q.defaults.io.proxyUrl||"").toLowerCase(),d=b?c.toLowerCase().indexOf(b+"?"):-1;return-1!==d&&(c=c.substring(d+b.length+1)),v.urlToObject(c).path},_isRESTService:function(a){return-1<a.indexOf(this._agsRest)},_isAdminResource:function(a){return this._agsAdmin.test(a)||
this._adminSvcs.test(a)},_isServerRsrc:function(a){return this._isRESTService(a)||this._isAdminResource(a)},_isIdenticalService:function(a,c){var b;if(this._isRESTService(a)&&this._isRESTService(c)){var d=this._getSuffix(a).toLowerCase(),g=this._getSuffix(c).toLowerCase();(b=d===g,b)||(b=/(.*)\/(MapServer|FeatureServer).*/gi,b=d.replace(b,"$1")===g.replace(b,"$1"))}else this._isAdminResource(a)&&this._isAdminResource(c)?b=!0:this._isServerRsrc(a)||this._isServerRsrc(c)||!this._isPortalDomain(a)||
(b=!0);return b},_isPortalDomain:function(c){c=c.toLowerCase();var b=(new l(c)).authority,d=this._portalConfig,g=-1!==b.indexOf(this._agolSuffix);(!g&&d&&(g=this._hasSameServerInstance(this._getServerInstanceRoot(d.restBaseUrl),c)),g)||(this._arcgisUrl||(d=a.getObject("esri.arcgis.utils.arcgisUrl"))&&(this._arcgisUrl=(new l(d)).authority),this._arcgisUrl&&(g=this._arcgisUrl.toLowerCase()===b));return g||(g=f.some(this._portals,function(a){return this._hasSameServerInstance(a,c)},this)),g=g||this._agsPortal.test(c)},
_isIdProvider:function(a,c){var b=-1,d=-1;f.forEach(this._gwDomains,function(g,e){-1===b&&g.regex.test(a)&&(b=e);-1===d&&g.regex.test(c)&&(d=e)});var g=!1;if(-1<b&&-1<d&&(0===b||4===b?(0===d||4===d)&&(g=!0):1===b?(1===d||2===d)&&(g=!0):2===b?2===d&&(g=!0):3===b&&3===d&&(g=!0)),!g){var e=this.findServerInfo(c),l=e&&e.owningSystemUrl;l&&C(e)&&this._isPortalDomain(l)&&this._isIdProvider(a,l)&&(g=!0)}return g},_isPublic:function(a){return a=this._sanitizeUrl(a),f.some(this._publicUrls,function(c){return c.test(a)})},
_getIdenticalSvcIdx:function(a,c){var b=-1;return f.some(c.resources,function(c,d){return this._isIdenticalService(a,c)?(b=d,!0):!1},this),b},_getSuffix:function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(a){var c,b,d,g=this._isRESTService(a);if(g||this._isAdminResource(a))return d=a.toLowerCase().indexOf(g?this._agsRest:"/admin/"),c=a.substring(0,d)+"/admin/generateToken",a=a.substring(0,d)+"/rest/info",b=w({url:a,content:{f:"json"},handleAs:"json",
callbackParamName:"callback"}),b.adminUrl_=c,b;if(this._isPortalDomain(a)){var e="";if(f.some(this._gwDomains,function(c){return c.regex.test(a)&&(e=c.tokenServiceUrl),!!e}),e||f.some(this._portals,function(c){return this._hasSameServerInstance(c,a)&&(e=c+this._gwTokenUrl),!!e},this),e||(d=a.toLowerCase().indexOf("/sharing"),-1!==d&&(e=a.substring(0,d)+this._gwTokenUrl)),e||(e=this._getOrigin(a)+this._gwTokenUrl),e)c=(new l(a)).port,/^http:\/\//i.test(a)&&"7080"===c&&(e=e.replace(/:7080/i,":7443")),
e=e.replace(/http:/i,"https:");return e}return-1!==a.toLowerCase().indexOf("premium.arcgisonline.com")?"https://premium.arcgisonline.com/server/tokens":void 0},_getPortalSelf:function(a,c){return"https:"===window.location.protocol?a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(c)&&(a=a.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),w({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{crossOrigin:!1,disableIdentityLookup:!0})},_hasPortalSession:function(){return!!this._getEsriAuthCookie()},
_getEsriAuthCookie:function(){var a;if(g.isSupported()){var c,b=this._getAllCookies("esri_auth");for(c=0;c<b.length;c++){var d=e.fromJson(b[c]);if(d.portalApp){a=d;break}}}return a},_getAllCookies:function(a){var b=[],d=document.cookie.match(new RegExp("(?:^|; )"+c.escapeString(a)+"\x3d([^;]*)","g"));if(d)for(a=0;a<d.length;a++){var g=d[a],e=g.indexOf("\x3d");-1<e&&(g=g.substring(e+1),b.push(decodeURIComponent(g)))}return b},_doPortalSignIn:function(a){if(g.isSupported()){var c=this._getEsriAuthCookie(),
b=this._portalConfig,d=window.location.href,e=this.findServerInfo(a);if(this.useSignInPage&&(b||this._isPortalDomain(d)||c)&&(e?e.hasPortal||e.owningSystemUrl&&this._isPortalDomain(e.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(d,a)||b&&(this._hasSameServerInstance(this._getServerInstanceRoot(b.restBaseUrl),a)||this._isIdProvider(b.restBaseUrl,a))||v.hasSameOrigin(d,a,!0)))return!0}return!1},_checkProtocol:function(c,b,d,g){var e=!0;g=g?b.adminTokenServiceUrl:b.tokenServiceUrl;0!==
a.trim(g).toLowerCase().indexOf("https:")||0===window.location.href.toLowerCase().indexOf("https:")||q.defaults.io.useCors&&(v.canUseXhr(g)||v.canUseXhr(v.getProxyUrl(!0).path))||(e=this._protocolFunc?!!this._protocolFunc({resourceUrl:c,serverInfo:b}):!1)||(c=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),c.code="IdentityManagerBase.4",c.log=k.isDebug,d(c));return e},_enqueue:function(a,c,d,g,e,f){return g||(g=new b(u._dfdCanceller)),g.resUrl_=a,g.sinfo_=
c,g.options_=d,g.admin_=e,g.refresh_=f,this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(a),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(g)):this._xoReqs.push(g):this._doSignIn(g),g},_doSignIn:function(c){this._busy=c;var b=this,d=function(a){var d=c.options_&&c.options_.resource,g=c.resUrl_,e=c.refresh_,l=!1;-1===f.indexOf(b.credentials,a)&&(e&&-1!==f.indexOf(b.credentials,e)?(e.userId=a.userId,e.token=a.token,
e.expires=a.expires,e.validity=a.validity,e.ssl=a.ssl,e.creationTime=a.creationTime,l=!0,a=e):b.credentials.push(a));a.resources||(a.resources=[]);a.resources.push(d||g);a.scope=b._isServerRsrc(g)?"server":"portal";a.onTokenChange();var d=b._soReqs,n={};b._soReqs=[];f.forEach(d,function(c){if(!this._isIdenticalService(g,c.resUrl_)){var b=this._getSuffix(c.resUrl_);n[b]||(n[b]=!0,a.resources.push(c.resUrl_))}},b);c.callback(a);f.forEach(d,function(c){c.callback(a)});b._busy=c.resUrl_=c.sinfo_=c.refresh_=
null;l||b.onCredentialCreate({credential:a});b._soReqs.length&&b._doSignIn(b._soReqs.shift());b._xoReqs.length&&b._doSignIn(b._xoReqs.shift())},g=function(a){c.errback(a);b._busy=c.resUrl_=c.sinfo_=c.refresh_=null;b._soReqs.length&&b._doSignIn(b._soReqs.shift());b._xoReqs.length&&b._doSignIn(b._xoReqs.shift())},e=function(a,e,f,l){var n,m;n=c.sinfo_;var h=!c.options_||!1!==c.options_.prompt,q=n.hasPortal&&b._findOAuthInfo(c.resUrl_);if(b._doPortalSignIn(c.resUrl_)){a=b._getEsriAuthCookie();q=b._portalConfig;
if(a)return void d(new z({userId:a.email,server:n.server,token:a.token,expires:null}));if(h)return h="",a=window.location.href,h=b.signInPage?b.signInPage:q?q.baseUrl+q.signin:b._isIdProvider(a,c.resUrl_)?b._getOrigin(a)+"/home/signin.html":n.tokenServiceUrl.replace(b._rePortalTokenSvc,"")+"/home/signin.html",h=h.replace(/http:/i,"https:"),q&&!1===q.useSSL&&(h=h.replace(/https:/i,"http:")),void(0===a.toLowerCase().replace("https","http").indexOf(h.toLowerCase().replace("https","http"))?(m=Error("Cannot redirect to Sign-In page from within Sign-In page. URL of the resource that triggered this workflow: "+
c.resUrl_),m.code="IdentityManagerBase.5",m.log=k.isDebug,g(m)):b._redirectFunc?b._redirectFunc({signInPage:h,returnUrlParamName:"returnUrl",returnUrl:a,resourceUrl:c.resUrl_,serverInfo:n}):window.location=h+"?returnUrl\x3d"+window.escape(a));m=Error("User is not signed in.");m.code="IdentityManagerBase.6";m.log=k.isDebug;g(m)}else a?d(new z({userId:a,server:n.server,token:f,expires:t.isDefined(l)?Number(l):null,ssl:!!e})):q?(a=q._oAuthCred,a||(e=new y(q,window.localStorage),f=new y(q,window.sessionStorage),
e.isValid()&&f.isValid()?e.expires>f.expires?(a=e,f.destroy()):(a=f,e.destroy()):a=e.isValid()?e:f,q._oAuthCred=a),a.isValid()?d(new z({userId:a.userId,server:n.server,token:a.token,expires:a.expires,ssl:a.ssl,_oAuthCred:a})):b._oAuthHash&&b._oAuthHash.state.portalUrl===q.portalUrl?(m=b._oAuthHash,n=new z({userId:m.username,server:n.server,token:m.access_token,expires:(new Date).getTime()+1E3*Number(m.expires_in),ssl:"true"===m.ssl,oAuthState:m.state,_oAuthCred:a}),a.storage=m.persist?window.localStorage:
window.sessionStorage,a.token=n.token,a.expires=n.expires,a.userId=n.userId,a.ssl=n.ssl,a.save(),b._oAuthHash=null,d(n)):h?c._pendingDfd=b.oAuthSignIn(c.resUrl_,n,q,c.options_).addCallbacks(d,g):(m=Error("User is not signed in."),m.code="IdentityManagerBase.6",m.log=k.isDebug,g(m))):h?b._checkProtocol(c.resUrl_,n,g,c.admin_)&&(m=c.options_,c.admin_&&(m=m||{},m.isAdmin=!0),c._pendingDfd=b.signIn(c.resUrl_,n,m).addCallbacks(d,g)):(m=Error("User is not signed in."),m.code="IdentityManagerBase.6",m.log=
k.isDebug,g(m))},l=function(){var a,e,l,n,m=c.sinfo_,h=m.owningSystemUrl,q=c.options_;(q&&(a=q.token,e=q.error,l=q.prompt),n=b._findCredential(h,{token:a,resource:c.resUrl_}),!n&&C(m)&&f.some(b.credentials,function(a){return this._isIdProvider(h,a.server)&&(n=a),!!n},b),n)?(a=b.findCredential(c.resUrl_,n.userId))?d(a):D(m,b._legacyFed)?(a=n.toJson(),a.server=m.server,a.resources=null,d(new z(a))):(c._pendingDfd=b.generateToken(b.findServerInfo(n.server),null,{serverUrl:c.resUrl_,token:n.token,ssl:n.ssl})).addCallbacks(function(a){d(new z({userId:n.userId,
server:m.server,token:a.token,expires:t.isDefined(a.expires)?Number(a.expires):null,ssl:!!a.ssl,isAdmin:c.admin_,validity:a.validity}))},g):(b._busy=null,a&&(c.options_.token=null),(c._pendingDfd=b.getCredential(h.replace(/\/?$/,"/sharing"),{resource:c.resUrl_,owningTenant:m.owningTenant,token:a,error:e,prompt:l})).addCallbacks(function(a){b._enqueue(c.resUrl_,c.sinfo_,c.options_,c,c.admin_)},function(a){g(a)}))},n=c.sinfo_.owningSystemUrl,m=this._isServerRsrc(c.resUrl_),h=c.sinfo_._restInfoDfd;h?
h.addCallbacks(function(d){var g=c.sinfo_;g.adminTokenServiceUrl=g._restInfoDfd.adminUrl_;g._restInfoDfd=null;g.tokenServiceUrl=a.getObject("authInfo.tokenServicesUrl",!1,d)||a.getObject("authInfo.tokenServiceUrl",!1,d)||a.getObject("tokenServiceUrl",!1,d);g.shortLivedTokenValidity=a.getObject("authInfo.shortLivedTokenValidity",!1,d);g.currentVersion=d.currentVersion;g.owningTenant=d.owningTenant;(d=g.owningSystemUrl=d.owningSystemUrl)&&b._portals.push(d);m&&d?l():e()},function(){c.sinfo_._restInfoDfd=
null;var a=Error("Unknown resource - could not find token service endpoint.");a.code="IdentityManagerBase.2";a.log=k.isDebug;g(a)}):m&&n?l():c.sinfo_._selfReq?c.sinfo_._selfReq.selfDfd.then(function(a){var d,g,e,f,l={};return a&&(d=a.user&&a.user.username,l.username=d,l.allSSL=a.allSSL,g=a.supportsOAuth,e=a.currentVersion,"multitenant"===a.portalMode&&(f=a.customBaseUrl)),c.sinfo_.webTierAuth=!!d,d&&b.normalizeWebTierAuth?b.generateToken(c.sinfo_,null,{ssl:l.allSSL}).always(function(a){return l.portalToken=
a&&a.token,l.tokenExpiration=a&&a.expires,l}):!d&&g&&4.4<=parseFloat(e)&&!b._doPortalSignIn(c.resUrl_)?b._generateOAuthInfo({portalUrl:c.sinfo_.server,customBaseUrl:f,owningTenant:c.sinfo_._selfReq.owningTenant}).always(function(){return l}):l}).always(function(a){c.sinfo_._selfReq=null;a?e(a.username,a.allSSL,a.portalToken,a.tokenExpiration):e()}):e()},_generateOAuthInfo:function(a){var c,d,g=this,e=a.portalUrl,f=a.customBaseUrl,l=a.owningTenant;if(a=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&
!this._hasTestedIfAppIsOnPortal){d=window.location.href;var n=d.indexOf("?");-1<n&&(d=d.slice(0,n));n=d.search(/\/(apps|home)\//);d=-1<n?d.slice(0,n):null}return a&&d?(this._hasTestedIfAppIsOnPortal=!0,c=w({url:d+"/sharing/rest",content:{f:"json"},handleAs:"json"}).then(function(){g.defaultOAuthInfo=new A({appId:"arcgisonline",popup:!0,popupCallbackUrl:d+"/home/oauth-callback.html"})})):(c=new b,c.resolve(),c=c.promise),c.then(function(){return g.defaultOAuthInfo?(e=e.replace(/^http:/i,"https:"),
w({url:e+"/sharing/rest/oauth2/validateRedirectUri",content:{accountId:l,client_id:g.defaultOAuthInfo.appId,redirect_uri:v.getAbsoluteUrl(g.defaultOAuthInfo.popupCallbackUrl),f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a){if(a.valid){var c=g.defaultOAuthInfo.clone();a.urlKey&&f?c.portalUrl="https://"+a.urlKey+"."+f:c.portalUrl=e;g.oAuthInfos.push(c)}})):void 0})}});return z=h(x,{declaredClass:"esri.Credential",tokenRefreshBuffer:2,constructor:function(c){a.mixin(this,c);
this.resources=this.resources||[];t.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},_oAuthCred:null,refreshToken:function(){var a,c,b=this,d=this.resources&&this.resources[0],g=n.id.findServerInfo(this.server),e=g&&g.owningSystemUrl,l=!!e&&"server"===this.scope,m=l&&D(g,n.id._legacyFed),h=l&&n.id.findServerInfo(e),q=g.webTierAuth,r=q&&n.id.normalizeWebTierAuth,u=B[this.server],u=u&&u[this.userId],v={username:this.userId,password:u};if((!q||r)&&(l&&!h&&f.some(n.id.serverInfos,
function(a){return n.id._isIdProvider(e,a.server)&&(h=a),!!h}),a=h&&n.id.findCredential(h.server,this.userId),!l||a)){if(m)return void a.refreshToken();if(l)c={serverUrl:d,token:a&&a.token,ssl:a&&a.ssl};else if(r)v=null,c={ssl:this.ssl};else{if(!u){var k;return d&&(d=n.id._sanitizeUrl(d),this._enqueued=1,k=n.id._enqueue(d,g,null,null,this.isAdmin,this),k.addCallback(function(){b._enqueued=0;b.refreshServerTokens()}).addErrback(function(){b._enqueued=0})),k}this.isAdmin&&(c={isAdmin:!0})}return n.id.generateToken(l?
h:g,l?null:v,c).addCallback(function(a){b.token=a.token;b.expires=t.isDefined(a.expires)?Number(a.expires):null;b.creationTime=(new Date).getTime();b.validity=a.validity;b.onTokenChange();b.refreshServerTokens()}).addErrback(function(){})}},refreshServerTokens:function(){"portal"===this.scope&&f.forEach(n.id.credentials,function(a){var c=n.id.findServerInfo(a.server),b=c&&c.owningSystemUrl;a!==this&&a.userId===this.userId&&b&&"server"===a.scope&&(n.id._hasSameServerInstance(this.server,b)||n.id._isIdProvider(b,
this.server))&&(D(c,n.id._legacyFed)?(a.token=this.token,a.expires=this.expires,a.creationTime=this.creationTime,a.validity=this.validity,a.onTokenChange()):a.refreshToken())},this)},onTokenChange:function(a){clearTimeout(this._refreshTimer);var c=this.server&&n.id.findServerInfo(this.server),b=(c=c&&c.owningSystemUrl)&&n.id.findServerInfo(c);!1!==a&&(!c||"portal"===this.scope||b&&b.webTierAuth&&!n.id.normalizeWebTierAuth)&&(t.isDefined(this.expires)||t.isDefined(this.validity))&&this._startRefreshTimer()},
onDestroy:function(){},destroy:function(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var a=f.indexOf(n.id.credentials,this);-1<a&&n.id.credentials.splice(a,1);this.onTokenChange();this.onDestroy()},toJson:function(){return this._toJson()},_toJson:function(){var a=t.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,
isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),c=this.resources;return c&&0<c.length&&(a.resources=c),a},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);var c=6E4*this.tokenRefreshBuffer,b=(this.validity?this.creationTime+6E4*this.validity:this.expires)-(new Date).getTime();0>b&&(b=0);this._refreshTimer=setTimeout(a.hitch(this,this.refreshToken),b>c?b-c:b)}}),E.Credential=z,m("extend-esri")&&(n.IdentityManagerBase=E),E})},"esri/ServerInfo":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","./kernel","./lang"],function(h,k,a,f,b){h=h(null,{declaredClass:"esri.ServerInfo",constructor:function(a){k.mixin(this,a)},toJson:function(){return b.fixJson({server:this.server,tokenServiceUrl:this.tokenServiceUrl,adminTokenServiceUrl:this.adminTokenServiceUrl,shortLivedTokenValidity:this.shortLivedTokenValidity,owningSystemUrl:this.owningSystemUrl,owningTenant:this.owningTenant,currentVersion:this.currentVersion,hasPortal:this.hasPortal,hasServer:this.hasServer,webTierAuth:this.webTierAuth})}});
return a("extend-esri")&&(f.ServerInfo=h),h})},"esri/OAuthCredential":function(){define(["./kernel","dojo/_base/declare","dojo/has","dojo/json"],function(h,k,a,f){k=k(null,{declaredClass:"esri.OAuthCredential",oAuthInfo:null,storage:null,expires:null,ssl:null,token:null,userId:null,constructor:function(a,e){this.oAuthInfo=a;this.storage=e;this._init()},isValid:function(){var a=!1;if(this.oAuthInfo&&this.token&&this.userId){var e=(new Date).getTime();this.expires>e&&(this.expires-e)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&
(a=!0)}return a},save:function(){if(this.storage){var a=this._load(),e=this.oAuthInfo;if(e&&e.authNamespace&&e.portalUrl){var l=a[e.authNamespace];l||(l=a[e.authNamespace]={});l[e.portalUrl]={expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",f.stringify(a))}catch(m){}}}},destroy:function(){var a=this._load(),e=this.oAuthInfo;if(e&&e.authNamespace&&e.portalUrl&&this.storage){var l=a[e.authNamespace];if(l){delete l[e.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",
f.stringify(a))}catch(m){}}}e&&(e._oAuthCred=null,this.oAuthInfo=null)},_init:function(){var a=this._load(),e=this.oAuthInfo;e&&e.authNamespace&&e.portalUrl&&(a=a[e.authNamespace])&&(a=a[e.portalUrl],a&&(this.expires=a.expires,this.ssl=a.ssl,this.token=a.token,this.userId=a.userId))},_load:function(){var a={};if(this.storage){var e=this.storage.getItem("esriJSAPIOAuth");if(e)try{a=f.parse(e)}catch(l){}}return a}});return a("extend-esri")&&(h.OAuthCredential=k),k})},"esri/arcgis/OAuthInfo":function(){define(["../kernel",
"../lang","dojo/_base/declare","dojo/_base/lang","dojo/has"],function(h,k,a,f,b){var e=a(null,{declaredClass:"esri.arcgis.OAuthInfo",constructor:function(a){f.mixin(this,{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",forceLogin:!1,showSocialLogins:!1,popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d480,width\x3d800,location,resizable,scrollbars,status"},a)},_oAuthCred:null,toJson:function(){return k.fixJson({appId:this.appId,
expiration:this.expiration,locale:this.locale,minTimeUntilExpiration:this.minTimeUntilExpiration,portalUrl:this.portalUrl,authNamespace:this.authNamespace,forceLogin:this.forceLogin,showSocialLogins:this.showSocialLogins,popup:this.popup,popupCallbackUrl:this.popupCallbackUrl,popupWindowFeatures:this.popupWindowFeatures})},clone:function(){return new e(this.toJson())}});return b("extend-esri")&&f.setObject("arcgis.OAuthInfo",e,h),e})},"dijit/form/Button":function(){define("require dojo/_base/declare dojo/dom-class dojo/has dojo/_base/kernel dojo/_base/lang dojo/ready ./_FormWidget ./_ButtonMixin dojo/text!./templates/Button.html ../a11yclick".split(" "),
function(h,k,a,f,b,e,l,m,g,d){f("dijit-legacy-requires")&&l(0,function(){h(["dijit/form/DropDownButton","dijit/form/ComboButton","dijit/form/ToggleButton"])});l=k("dijit.form.Button"+(f("dojo-bidi")?"_NoBidi":""),[m,g],{showLabel:!0,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:d,_setValueAttr:"valueNode",_setNameAttr:function(a){this.valueNode&&this.valueNode.setAttribute("name",a)},postCreate:function(){this.inherited(arguments);
this._setLabelFromContainer()},_setLabelFromContainer:function(){this.containerNode&&!this.label&&(this.label=e.trim(this.containerNode.innerHTML),this.onLabelSet())},_setShowLabelAttr:function(c){this.containerNode&&a.toggle(this.containerNode,"dijitDisplayNone",!c);this._set("showLabel",c)},setLabel:function(a){b.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},onLabelSet:function(){this.inherited(arguments);this.showLabel||
"title"in this.params||(this.titleNode.title=e.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});f("dojo-bidi")&&(l=k("dijit.form.Button",l,{onLabelSet:function(){this.inherited(arguments);this.titleNode.title&&this.applyTextDir(this.titleNode,this.titleNode.title)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this._setLabelAttr(this.label))}}));return l})},"dijit/form/_FormWidget":function(){define("dojo/_base/declare dojo/sniff dojo/_base/kernel dojo/ready ../_Widget ../_CssStateMixin ../_TemplatedMixin ./_FormWidgetMixin".split(" "),
function(h,k,a,f,b,e,l,m){k("dijit-legacy-requires")&&f(0,function(){require(["dijit/form/_FormValueWidget"])});return h("dijit.form._FormWidget",[b,l,e,m],{setDisabled:function(b){a.deprecated("setDisabled("+b+") is deprecated. Use set('disabled',"+b+") instead.","","2.0");this.set("disabled",b)},setValue:function(b){a.deprecated("dijit.form._FormWidget:setValue("+b+") is deprecated.  Use set('value',"+b+") instead.","","2.0");this.set("value",b)},getValue:function(){a.deprecated(this.declaredClass+
"::getValue() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},postMixInProperties:function(){this.nameAttrSetting=this.name&&!k("msapp")?'name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"";this.inherited(arguments)}})})},"dijit/form/_FormWidgetMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff dojo/window ../a11y".split(" "),function(h,k,a,f,b,e,l,m,g,d){return k("dijit.form._FormWidgetMixin",
null,{name:"",alt:"",value:"",type:"text","aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(c){this._set("disabled",c);/^(button|input|select|textarea|optgroup|option|fieldset)$/i.test(this.focusNode.tagName)?a.set(this.focusNode,"disabled",c):this.focusNode.setAttribute("aria-disabled",c?"true":"false");this.valueNode&&a.set(this.valueNode,"disabled",c);c?(this._set("hovering",!1),
this._set("active",!1),c="tabIndex"in this.attributeMap?this.attributeMap.tabIndex:"_setTabIndexAttr"in this?this._setTabIndexAttr:"focusNode",h.forEach(b.isArray(c)?c:[c],function(a){a=this[a];m("webkit")||d.hasDefaultTabStop(a)?a.setAttribute("tabIndex","-1"):a.removeAttribute("tabIndex")},this)):""!=this.tabIndex&&this.set("tabIndex",this.tabIndex)},_onFocus:function(a){if("mouse"==a&&this.isFocusable())var c=this.own(l(this.focusNode,"focus",function(){e.remove();c.remove()}))[0],d=m("pointer-events")?
"pointerup":m("MSPointer")?"MSPointerUp":m("touch-events")?"touchend, mouseup":"mouseup",e=this.own(l(this.ownerDocumentBody,d,b.hitch(this,function(a){e.remove();c.remove();this.focused&&("touchend"==a.type?this.defer("focus"):this.focus())})))[0];this.scrollOnFocus&&this.defer(function(){g.scrollIntoView(this.domNode)});this.inherited(arguments)},isFocusable:function(){return!this.disabled&&this.focusNode&&"none"!=f.get(this.domNode,"display")},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(c){}},
compare:function(a,b){return"number"==typeof a&&"number"==typeof b?isNaN(a)&&isNaN(b)?0:a-b:a>b?1:a<b?-1:0},onChange:function(){},_onChangeActive:!1,_handleOnChange:function(a,b){void 0!=this._lastValueReported||null!==b&&this._onChangeActive||(this._resetValue=this._lastValueReported=a);this._pendingOnChange=this._pendingOnChange||typeof a!=typeof this._lastValueReported||0!=this.compare(a,this._lastValueReported);(this.intermediateChanges||b||void 0===b)&&this._pendingOnChange&&(this._lastValueReported=
a,this._pendingOnChange=!1,this._onChangeActive&&(this._onChangeHandle&&this._onChangeHandle.remove(),this._onChangeHandle=this.defer(function(){this._onChangeHandle=null;this.onChange(a)})))},create:function(){this.inherited(arguments);this._onChangeActive=!0},destroy:function(){this._onChangeHandle&&(this._onChangeHandle.remove(),this.onChange(this._lastValueReported));this.inherited(arguments)}})})},"dijit/form/_ButtonMixin":function(){define(["dojo/_base/declare","dojo/dom","dojo/has","../registry"],
function(h,k,a,f){var b=h("dijit.form._ButtonMixin"+(a("dojo-bidi")?"_NoBidi":""),null,{label:"",type:"button",__onClick:function(a){a.stopPropagation();a.preventDefault();this.disabled||this.valueNode.click(a);return!1},_onClick:function(a){if(this.disabled)return a.stopPropagation(),a.preventDefault(),!1;!1===this.onClick(a)&&a.preventDefault();var b=a.defaultPrevented;if(!b&&"submit"==this.type&&!(this.valueNode||this.focusNode).form)for(var e=this.domNode;e.parentNode;e=e.parentNode){var g=f.byNode(e);
if(g&&"function"==typeof g._onSubmit){g._onSubmit(a);a.preventDefault();b=!0;break}}return!b},postCreate:function(){this.inherited(arguments);k.setSelectable(this.focusNode,!1)},onClick:function(){return!0},_setLabelAttr:function(a){this._set("label",a);(this.containerNode||this.focusNode).innerHTML=a;this.onLabelSet()},onLabelSet:function(){}});a("dojo-bidi")&&(b=h("dijit.form._ButtonMixin",b,{onLabelSet:function(){this.inherited(arguments);this.applyTextDir(this.containerNode||this.focusNode)}}));
return b})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),function(h,k,a,f,b,e,l,m){return h("dijit.form.Form",[b,e,l,m],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",
postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(a){k.set(this.domNode,"encType",a);f("ie")&&(this.domNode.encoding=a);this._set("encType",a)},reset:function(a){var b={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:a?a.target:this.domNode,target:a?a.target:this.domNode};!1!==this.onReset(b)&&b.returnValue&&
this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(a){this.reset(a);a.stopPropagation();a.preventDefault();return!1},_onSubmit:function(b){var d=this.constructor.prototype;if(this.execute!=d.execute||this.onExecute!=d.onExecute)a.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(b)&&(b.stopPropagation(),b.preventDefault())},onSubmit:function(){return this.isValid()},
submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"dijit/form/ValidationTextBox":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/i18n ./TextBox ../Tooltip dojo/text!./templates/ValidationTextBox.html dojo/i18n!./nls/validate".split(" "),function(h,k,a,f,b,e,l){var m=h("dijit.form.ValidationTextBox",b,{templateString:l,required:!1,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},pattern:".*",regExp:"",
regExpGen:function(){},state:"",tooltipPosition:[],_deprecateRegExp:function(a,b){b!=m.prototype[a]&&(k.deprecated("ValidationTextBox id\x3d"+this.id+", set('"+a+"', ...) is deprecated.  Use set('pattern', ...) instead.","","2.0"),this.set("pattern",b))},_setRegExpGenAttr:function(a){this._deprecateRegExp("regExpGen",a);this._set("regExpGen",this._computeRegexp)},_setRegExpAttr:function(a){this._deprecateRegExp("regExp",a)},_setValueAttr:function(){this.inherited(arguments);this._refreshState()},
validator:function(a,b){return(new RegExp("^(?:"+this._computeRegexp(b)+")"+(this.required?"":"?")+"$")).test(a)&&(!this.required||!this._isEmpty(a))&&(this._isEmpty(a)||void 0!==this.parse(a,b))},_isValidSubset:function(){return 0==this.textbox.value.search(this._partialre)},isValid:function(){return this.validator(this.textbox.value,this.get("constraints"))},_isEmpty:function(a){return(this.trim?/^\s*$/:/^$/).test(a)},getErrorMessage:function(){var a="$_unset_$"==this.invalidMessage?this.messages.invalidMessage:
this.invalidMessage?this.invalidMessage:this.promptMessage,b="$_unset_$"==this.missingMessage?this.messages.missingMessage:this.missingMessage?this.missingMessage:a;return this.required&&this._isEmpty(this.textbox.value)?b:a},getPromptMessage:function(){return this.promptMessage},_maskValidSubsetError:!0,validate:function(a){var b="",c=this.disabled||this.isValid(a);c&&(this._maskValidSubsetError=!0);var g=this._isEmpty(this.textbox.value),e=!c&&a&&this._isValidSubset();this._set("state",c?"":((!this._hasBeenBlurred||
a)&&g||e)&&(this._maskValidSubsetError||e&&!this._hasBeenBlurred&&a)?"Incomplete":"Error");this.focusNode.setAttribute("aria-invalid","Error"==this.state?"true":"false");"Error"==this.state?(this._maskValidSubsetError=a&&e,b=this.getErrorMessage(a)):"Incomplete"==this.state?(b=this.getPromptMessage(a),this._maskValidSubsetError=!this._hasBeenBlurred||a):g&&(b=this.getPromptMessage(a));this.set("message",b);return c},displayMessage:function(a){a&&this.focused?e.show(a,this.domNode,this.tooltipPosition,
!this.isLeftToRight()):e.hide(this.domNode)},_refreshState:function(){this._created&&this.validate(this.focused);this.inherited(arguments)},constructor:function(b){this.constraints=a.clone(this.constraints);this.baseClass+=" dijitValidationTextBox"},startup:function(){this.inherited(arguments);this._refreshState()},_setConstraintsAttr:function(a){!a.locale&&this.lang&&(a.locale=this.lang);this._set("constraints",a);this._refreshState()},_setPatternAttr:function(a){this._set("pattern",a);this._refreshState()},
_computeRegexp:function(a){var b=this.pattern;"function"==typeof b&&(b=b.call(this,a));if(b!=this._lastRegExp){var c="";this._lastRegExp=b;".*"!=b&&b.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(a){switch(a.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":c+=a;break;case ")":c+="|$)";break;default:c+="(?:"+a+"|$)"}});try{"".search(c)}catch(n){c=this.pattern,console.warn("RegExp error in "+this.declaredClass+": "+this.pattern)}this._partialre="^(?:"+
c+")$"}return b},postMixInProperties:function(){this.inherited(arguments);this.messages=f.getLocalization("dijit.form","validate",this.lang);this._setConstraintsAttr(this.constraints)},_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setMessageAttr:function(a){this._set("message",a);this.displayMessage(a)},reset:function(){this._maskValidSubsetError=
!0;this.inherited(arguments)},_onBlur:function(){this.displayMessage("");this.inherited(arguments)},destroy:function(){e.hide(this.domNode);this.inherited(arguments)}});return m})},"dijit/form/TextBox":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-style dojo/_base/kernel dojo/_base/lang dojo/on dojo/sniff ./_FormValueWidget ./_TextBoxMixin dojo/text!./templates/TextBox.html ../main".split(" "),function(h,k,a,f,b,e,l,m,g,d,c){m=h("dijit.form.TextBox"+(l("dojo-bidi")?"_NoBidi":""),
[m,g],{templateString:d,_singleNodeTemplate:'\x3cinput class\x3d"dijit dijitReset dijitLeft dijitInputField" data-dojo-attach-point\x3d"textbox,focusNode" autocomplete\x3d"off" type\x3d"${type}" ${!nameAttrSetting} /\x3e',_buttonInputDisabled:l("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var a=this.type.toLowerCase();if(this.templateString&&"input"==this.templateString.toLowerCase()||("hidden"==a||"file"==a)&&this.templateString==this.constructor.prototype.templateString)this.templateString=
this._singleNodeTemplate;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);9>l("ie")&&this.defer(function(){try{var c=a.getComputedStyle(this.domNode);if(c){var b=c.fontFamily;if(b){var d=this.domNode.getElementsByTagName("INPUT");if(d)for(c=0;c<d.length;c++)d[c].style.fontFamily=b}}}catch(r){}})},_setPlaceHolderAttr:function(a){this._set("placeHolder",a);this._phspan||(this._attachPoints.push("_phspan"),this._phspan=k.create("span",{className:"dijitPlaceHolder dijitInputField"},
this.textbox,"after"),this.own(e(this._phspan,"mousedown",function(a){a.preventDefault()}),e(this._phspan,"touchend, pointerup, MSPointerUp",b.hitch(this,function(){this.focus()}))));this._phspan.innerHTML="";this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(a));this._updatePlaceHolder()},_onInput:function(a){this.inherited(arguments);this._updatePlaceHolder()},_updatePlaceHolder:function(){this._phspan&&(this._phspan.style.display=this.placeHolder&&!this.textbox.value?"":"none")},
_setValueAttr:function(a,c,b){this.inherited(arguments);this._updatePlaceHolder()},getDisplayedValue:function(){f.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");return this.get("displayedValue")},setDisplayedValue:function(a){f.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",a)},_onBlur:function(a){this.disabled||(this.inherited(arguments),
this._updatePlaceHolder(),l("mozilla")&&this.selectOnClick&&(this.textbox.selectionStart=this.textbox.selectionEnd=void 0))},_onFocus:function(a){this.disabled||this.readOnly||(this.inherited(arguments),this._updatePlaceHolder())}});9>l("ie")&&(m.prototype._isTextSelected=function(){var a=this.ownerDocument.selection.createRange();return a.parentElement()==this.textbox&&0<a.text.length},c._setSelectionRange=g._setSelectionRange=function(a,c,b){a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),
a.moveStart("character",-99999),a.moveStart("character",c),a.moveEnd("character",b-c),a.select())});l("dojo-bidi")&&(m=h("dijit.form.TextBox",m,{_setPlaceHolderAttr:function(a){this.inherited(arguments);this.applyTextDir(this._phspan)}}));return m})},"dijit/form/_FormValueWidget":function(){define(["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(h,k,a,f){return h("dijit.form._FormValueWidget",[a,f],{_layoutHackIE7:function(){if(7==k("ie"))for(var a=this.domNode,e=a.parentNode,
f=a.firstChild||a,m=f.style.filter,g=this;e&&0==e.clientHeight;)(function(){var a=g.connect(e,"onscroll",function(){g.disconnect(a);f.style.filter=(new Date).getMilliseconds();g.defer(function(){f.style.filter=m})})})(),e=e.parentNode}})})},"dijit/form/_FormValueMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on ./_FormWidgetMixin".split(" "),function(h,k,a,f,b,e){return h("dijit.form._FormValueMixin",e,{readOnly:!1,_setReadOnlyAttr:function(a){k.set(this.focusNode,
"readOnly",a);this._set("readOnly",a)},postCreate:function(){this.inherited(arguments);void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.value)},_setValueAttr:function(a,b){this._handleOnChange(a,b)},_handleOnChange:function(a,b){this._set("value",a);this.inherited(arguments)},undo:function(){this._setValueAttr(this._lastValueReported,!1)},reset:function(){this._hasBeenBlurred=!1;this._setValueAttr(this._resetValue,!0)}})})},"dijit/form/_TextBoxMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/sniff dojo/keys dojo/_base/lang dojo/on ../main".split(" "),
function(h,k,a,f,b,e,l,m){var g=k("dijit.form._TextBoxMixin"+(f("dojo-bidi")?"_NoBidi":""),null,{trim:!1,uppercase:!1,lowercase:!1,propercase:!1,maxLength:"",selectOnClick:!1,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),this.constraints)},_setValueAttr:function(a,c,b){var d;void 0!==a&&(d=this.filter(a),"string"!=typeof b&&(b=null===d||"number"==typeof d&&isNaN(d)?"":this.filter(this.format(d,this.constraints)),0!=this.compare(d,this.filter(this.parse(b,this.constraints)))&&
(b=null)));null==b||"number"==typeof b&&isNaN(b)||this.textbox.value==b||(this.textbox.value=b,this._set("displayedValue",this.get("displayedValue")));this.inherited(arguments,[d,c])},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value)},_setDisplayedValueAttr:function(a){null==a?a="":"string"!=typeof a&&(a=String(a));this.textbox.value=a;this._setValueAttr(this.get("value"),void 0);this._set("displayedValue",this.get("displayedValue"))},format:function(a){return null==
a?"":a.toString?a.toString():a},parse:function(a){return a},_refreshState:function(){},onInput:function(){},_onInput:function(a){this._lastInputEventValue=this.textbox.value;this._processInput(this._lastInputProducingEvent||a);delete this._lastInputProducingEvent;this.intermediateChanges&&this._handleOnChange(this.get("value"),!1)},_processInput:function(){this._refreshState();this._set("displayedValue",this.get("displayedValue"))},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);
this.inherited(arguments);this.own(l(this.textbox,"keydown, keypress, paste, cut, compositionend",e.hitch(this,function(a){var c;if("keydown"==a.type&&229!=a.keyCode){c=a.keyCode;switch(c){case b.SHIFT:case b.ALT:case b.CTRL:case b.META:case b.CAPS_LOCK:case b.NUM_LOCK:case b.SCROLL_LOCK:return}if(!a.ctrlKey&&!a.metaKey&&!a.altKey){switch(c){case b.NUMPAD_0:case b.NUMPAD_1:case b.NUMPAD_2:case b.NUMPAD_3:case b.NUMPAD_4:case b.NUMPAD_5:case b.NUMPAD_6:case b.NUMPAD_7:case b.NUMPAD_8:case b.NUMPAD_9:case b.NUMPAD_MULTIPLY:case b.NUMPAD_PLUS:case b.NUMPAD_ENTER:case b.NUMPAD_MINUS:case b.NUMPAD_PERIOD:case b.NUMPAD_DIVIDE:return}if(65<=
c&&90>=c||48<=c&&57>=c||c==b.SPACE)return;c=!1;for(var d in b)if(b[d]===a.keyCode){c=!0;break}if(!c)return}}(c=32<=a.charCode?String.fromCharCode(a.charCode):a.charCode)||(c=65<=a.keyCode&&90>=a.keyCode||48<=a.keyCode&&57>=a.keyCode||a.keyCode==b.SPACE?String.fromCharCode(a.keyCode):a.keyCode);c||(c=229);if("keypress"==a.type){if("string"!=typeof c)return;if("a"<=c&&"z">=c||"A"<=c&&"Z">=c||"0"<=c&&"9">=c||" "===c)if(a.ctrlKey||a.metaKey||a.altKey)return}var g={faux:!0},m;for(m in a)/^(layer[XY]|returnValue|keyLocation)$/.test(m)||
(d=a[m],"function"!=typeof d&&"undefined"!=typeof d&&(g[m]=d));e.mixin(g,{charOrCode:c,_wasConsumed:!1,preventDefault:function(){g._wasConsumed=!0;a.preventDefault()},stopPropagation:function(){a.stopPropagation()}});this._lastInputProducingEvent=g;!1===this.onInput(g)&&(g.preventDefault(),g.stopPropagation());if(!g._wasConsumed&&9>=f("ie"))switch(a.keyCode){case b.TAB:case b.ESCAPE:case b.DOWN_ARROW:case b.UP_ARROW:case b.LEFT_ARROW:case b.RIGHT_ARROW:break;default:a.keyCode==b.ENTER&&"textarea"!=
this.textbox.tagName.toLowerCase()||this.defer(function(){this.textbox.value!==this._lastInputEventValue&&l.emit(this.textbox,"input",{bubbles:!0})})}})),l(this.textbox,"input",e.hitch(this,"_onInput")),l(this.domNode,"keypress",function(a){a.stopPropagation()}))},_blankValue:"",filter:function(a){if(null===a)return this._blankValue;if("string"!=typeof a)return a;this.trim&&(a=e.trim(a));this.uppercase&&(a=a.toUpperCase());this.lowercase&&(a=a.toLowerCase());this.propercase&&(a=a.replace(/[^\s]+/g,
function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}));return a},_setBlurValue:function(){this._setValueAttr(this.get("value"),!0)},_onBlur:function(a){this.disabled||(this._setBlurValue(),this.inherited(arguments))},_isTextSelected:function(){return this.textbox.selectionStart!=this.textbox.selectionEnd},_onFocus:function(a){this.disabled||this.readOnly||(this.selectOnClick&&"mouse"==a&&(this._selectOnClickHandle=l.once(this.domNode,"mouseup, touchend",e.hitch(this,function(a){this._isTextSelected()||
g.selectInputText(this.textbox)})),this.own(this._selectOnClickHandle),this.defer(function(){this._selectOnClickHandle&&(this._selectOnClickHandle.remove(),this._selectOnClickHandle=null)},500)),this.inherited(arguments),this._refreshState())},reset:function(){this.textbox.value="";this.inherited(arguments)}});f("dojo-bidi")&&(g=k("dijit.form._TextBoxMixin",g,{_setValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_setDisplayedValueAttr:function(){this.inherited(arguments);
this.applyTextDir(this.focusNode)},_onInput:function(){this.applyTextDir(this.focusNode);this.inherited(arguments)}}));g._setSelectionRange=m._setSelectionRange=function(a,c,b){a.setSelectionRange&&a.setSelectionRange(c,b)};g.selectInputText=m.selectInputText=function(b,c,e){b=a.byId(b);isNaN(c)&&(c=0);isNaN(e)&&(e=b.value?b.value.length:0);try{b.focus(),g._setSelectionRange(b,c,e)}catch(q){}};return g})},"dijit/Tooltip":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff ./_base/manager ./place ./_Widget ./_TemplatedMixin ./BackgroundIframe dojo/text!./templates/Tooltip.html ./main".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w){function x(){}var y=k("dijit._MasterTooltip",[t,r],{duration:n.defaultDuration,templateString:u,postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);this.bgIframe=new v(this.domNode);this.fadeIn=a.fadeIn({node:this.domNode,duration:this.duration,onEnd:m.hitch(this,"_onShow")});this.fadeOut=a.fadeOut({node:this.domNode,duration:this.duration,onEnd:m.hitch(this,"_onHide")})},show:function(a,c,b,d,g,e,f){if(!this.aroundNode||this.aroundNode!==
c||this.containerNode.innerHTML!=a)if("playing"==this.fadeOut.status())this._onDeck=arguments;else{this.containerNode.innerHTML=a;g&&this.set("textDir",g);this.containerNode.align=d?"right":"left";var n=q.around(this.domNode,c,b&&b.length?b:A.defaultPosition,!d,m.hitch(this,"orient")),h=n.aroundNodePos;"M"==n.corner.charAt(0)&&"M"==n.aroundCorner.charAt(0)?(this.connectorNode.style.top=h.y+(h.h-this.connectorNode.offsetHeight>>1)-n.y+"px",this.connectorNode.style.left=""):"M"==n.corner.charAt(1)&&
"M"==n.aroundCorner.charAt(1)?this.connectorNode.style.left=h.x+(h.w-this.connectorNode.offsetWidth>>1)-n.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");l.set(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=c;this.onMouseEnter=e||x;this.onMouseLeave=f||x}},orient:function(a,b,d,g,f){this.connectorNode.style.top="";var l=g.h;g=g.w;a.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove",
"BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[b+"-"+d];this.domNode.style.width="auto";var n=e.position(this.domNode);if(c("ie")||c("trident"))n.w+=2;e.setMarginBox(this.domNode,{w:Math.min(Math.max(g,1),n.w)});"B"==d.charAt(0)&&"B"==b.charAt(0)?(a=e.position(a),b=this.connectorNode.offsetHeight,
a.h>l?(this.connectorNode.style.top=l-(f.h+b>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(f.h/2-b/2,0),a.h-b)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");return Math.max(0,n.w-g)},_onShow:function(){c("ie")&&(this.domNode.style.filter="")},hide:function(a){this._onDeck&&this._onDeck[1]==a?this._onDeck=null:this.aroundNode===a&&(this.fadeIn.stop(),this.isShowingNow=!1,this.aroundNode=
null,this.fadeOut.play());this.onMouseEnter=this.onMouseLeave=x},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";this._onDeck&&(this.show.apply(this,this._onDeck),this._onDeck=null)}});c("dojo-bidi")&&y.extend({_setAutoTextDir:function(a){this.applyTextDir(a);h.forEach(a.children,function(a){this._setAutoTextDir(a)},this)},_setTextDirAttr:function(a){this._set("textDir",a);"auto"==a?this._setAutoTextDir(this.containerNode):this.containerNode.dir=this.textDir}});w.showTooltip=
function(a,c,b,d,g,e,f){b&&(b=h.map(b,function(a){return{after:"after-centered",before:"before-centered"}[a]||a}));A._masterTT||(w._masterTT=A._masterTT=new y);return A._masterTT.show(a,c,b,d,g,e,f)};w.hideTooltip=function(a){return A._masterTT&&A._masterTT.hide(a)};var A=k("dijit.Tooltip",t,{label:"",showDelay:400,hideDelay:400,connectId:[],position:[],selector:"",_setConnectIdAttr:function(a){h.forEach(this._connections||[],function(a){h.forEach(a,function(a){a.remove()})},this);this._connectIds=
h.filter(m.isArrayLike(a)?a:a?[a]:[],function(a){return f.byId(a,this.ownerDocument)},this);this._connections=h.map(this._connectIds,function(a){a=f.byId(a,this.ownerDocument);var c=this.selector,b=c?function(a){return d.selector(c,a)}:function(a){return a},e=this;return[d(a,b(g.enter),function(){e._onHover(this)}),d(a,b("focusin"),function(){e._onHover(this)}),d(a,b(g.leave),m.hitch(e,"_onUnHover")),d(a,b("focusout"),m.hitch(e,"set","state","DORMANT"))]},this);this._set("connectId",a)},addTarget:function(a){a=
a.id||a;-1==h.indexOf(this._connectIds,a)&&this.set("connectId",this._connectIds.concat(a))},removeTarget:function(a){a=h.indexOf(this._connectIds,a.id||a);0<=a&&(this._connectIds.splice(a,1),this.set("connectId",this._connectIds))},buildRendering:function(){this.inherited(arguments);b.add(this.domNode,"dijitTooltipData")},startup:function(){this.inherited(arguments);var a=this.connectId;h.forEach(m.isArrayLike(a)?a:[a],this.addTarget,this)},getContent:function(a){return this.label||this.domNode.innerHTML},
state:"DORMANT",_setStateAttr:function(a){if(!(this.state==a||"SHOW TIMER"==a&&"SHOWING"==this.state||"HIDE TIMER"==a&&"DORMANT"==this.state)){this._hideTimer&&(this._hideTimer.remove(),delete this._hideTimer);this._showTimer&&(this._showTimer.remove(),delete this._showTimer);switch(a){case "DORMANT":this._connectNode&&(A.hide(this._connectNode),delete this._connectNode,this.onHide());break;case "SHOW TIMER":"SHOWING"!=this.state&&(this._showTimer=this.defer(function(){this.set("state","SHOWING")},
this.showDelay));break;case "SHOWING":var c=this.getContent(this._connectNode);if(!c){this.set("state","DORMANT");return}A.show(c,this._connectNode,this.position,!this.isLeftToRight(),this.textDir,m.hitch(this,"set","state","SHOWING"),m.hitch(this,"set","state","HIDE TIMER"));this.onShow(this._connectNode,this.position);break;case "HIDE TIMER":this._hideTimer=this.defer(function(){this.set("state","DORMANT")},this.hideDelay)}this._set("state",a)}},_onHover:function(a){this._connectNode&&a!=this._connectNode&&
this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOW TIMER")},_onUnHover:function(a){this.set("state","HIDE TIMER")},open:function(a){this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOWING")},close:function(){this.set("state","DORMANT")},onShow:function(){},onHide:function(){},destroy:function(){this.set("state","DORMANT");h.forEach(this._connections||[],function(a){h.forEach(a,function(a){a.remove()})},this);this.inherited(arguments)}});A._MasterTooltip=y;A.show=
w.showTooltip;A.hide=w.hideTooltip;A.defaultPosition=["after-centered","before-centered"];return A})},"dijit/place":function(){define("dojo/_base/array dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/_base/window ./Viewport ./main".split(" "),function(h,k,a,f,b,e,l){function m(d,c,g,f){var l=e.getEffectiveBox(d.ownerDocument);d.parentNode&&"body"==String(d.parentNode.tagName).toLowerCase()||b.body(d.ownerDocument).appendChild(d);var n=null;h.some(c,function(a){var c=a.corner,b=a.pos,e=0,m=
{w:{L:l.l+l.w-b.x,R:b.x-l.l,M:l.w}[c.charAt(1)],h:{T:l.t+l.h-b.y,B:b.y-l.t,M:l.h}[c.charAt(0)]},h=d.style;h.left=h.right="auto";g&&(e=g(d,a.aroundCorner,c,m,f),e="undefined"==typeof e?0:e);var q=d.style,r=q.display,u=q.visibility;"none"==q.display&&(q.visibility="hidden",q.display="");h=k.position(d);q.display=r;q.visibility=u;r={L:b.x,R:b.x-h.w,M:Math.max(l.l,Math.min(l.l+l.w,b.x+(h.w>>1))-h.w)}[c.charAt(1)];u={T:b.y,B:b.y-h.h,M:Math.max(l.t,Math.min(l.t+l.h,b.y+(h.h>>1))-h.h)}[c.charAt(0)];b=Math.max(l.l,
r);q=Math.max(l.t,u);r=Math.min(l.l+l.w,r+h.w)-b;u=Math.min(l.t+l.h,u+h.h)-q;e+=h.w-r+(h.h-u);if(null==n||e<n.overflow)n={corner:c,aroundCorner:a.aroundCorner,x:b,y:q,w:r,h:u,overflow:e,spaceAvailable:m};return!e});n.overflow&&g&&g(d,n.aroundCorner,n.corner,n.spaceAvailable,f);c=n.y;var m=n.x,q=b.body(d.ownerDocument);/relative|absolute/.test(a.get(q,"position"))&&(c-=a.get(q,"marginTop"),m-=a.get(q,"marginLeft"));q=d.style;q.top=c+"px";q.left=m+"px";q.right="auto";return n}var g={TL:"BR",TR:"BL",
BL:"TR",BR:"TL"};return l.place={at:function(a,c,b,e,f){b=h.map(b,function(a){var b={corner:a,aroundCorner:g[a],pos:{x:c.x,y:c.y}};e&&(b.pos.x+="L"==a.charAt(1)?e.x:-e.x,b.pos.y+="T"==a.charAt(0)?e.y:-e.y);return b});return m(a,b,f)},around:function(b,c,g,e,l){function d(a,c){E.push({aroundCorner:a,corner:c,pos:{x:{L:z,R:z+C,M:z+(C>>1)}[a.charAt(1)],y:{T:B,B:B+D,M:B+(D>>1)}[a.charAt(0)]}})}var n;if("string"==typeof c||"offsetWidth"in c||"ownerSVGElement"in c){if(n=k.position(c,!0),/^(above|below)/.test(g[0])){var q=
k.getBorderExtents(c),t=c.firstChild?k.getBorderExtents(c.firstChild):{t:0,l:0,b:0,r:0},x=k.getBorderExtents(b),y=b.firstChild?k.getBorderExtents(b.firstChild):{t:0,l:0,b:0,r:0};n.y+=Math.min(q.t+t.t,x.t+y.t);n.h-=Math.min(q.t+t.t,x.t+y.t)+Math.min(q.b+t.b,x.b+y.b)}}else n=c;if(c.parentNode)for(q="absolute"==a.getComputedStyle(c).position,c=c.parentNode;c&&1==c.nodeType&&"BODY"!=c.nodeName;){t=k.position(c,!0);x=a.getComputedStyle(c);/relative|absolute/.test(x.position)&&(q=!1);if(!q&&/hidden|auto|scroll/.test(x.overflow)){var y=
Math.min(n.y+n.h,t.y+t.h),A=Math.min(n.x+n.w,t.x+t.w);n.x=Math.max(n.x,t.x);n.y=Math.max(n.y,t.y);n.h=y-n.y;n.w=A-n.x}"absolute"==x.position&&(q=!0);c=c.parentNode}var z=n.x,B=n.y,C="w"in n?n.w:n.w=n.width,D="h"in n?n.h:(f.deprecated("place.around: dijit/place.__Rectangle: { x:"+z+", y:"+B+", height:"+n.height+", width:"+C+" } has been deprecated.  Please use { x:"+z+", y:"+B+", h:"+n.height+", w:"+C+" }","","2.0"),n.h=n.height),E=[];h.forEach(g,function(a){var c=e;switch(a){case "above-centered":d("TM",
"BM");break;case "below-centered":d("BM","TM");break;case "after-centered":c=!c;case "before-centered":d(c?"ML":"MR",c?"MR":"ML");break;case "after":c=!c;case "before":d(c?"TL":"TR",c?"TR":"TL");d(c?"BL":"BR",c?"BR":"BL");break;case "below-alt":c=!c;case "below":d(c?"BL":"BR",c?"TL":"TR");d(c?"BR":"BL",c?"TR":"TL");break;case "above-alt":c=!c;case "above":d(c?"TL":"TR",c?"BL":"BR");d(c?"TR":"TL",c?"BR":"BL");break;default:d(a.aroundCorner,a.corner)}});b=m(b,E,l,{w:C,h:D});b.aroundNodePos=n;return b}}})},
"dijit/form/nls/validate":function(){define({root:{invalidMessage:"The value entered is not valid.",missingMessage:"This value is required.",rangeMessage:"This value is out of range."},bs:!0,mk:!0,sr:!0,zh:!0,"zh-tw":!0,vi:!0,uk:!0,tr:!0,th:!0,sv:!0,sl:!0,sk:!0,ru:!0,ro:!0,pt:!0,"pt-pt":!0,pl:!0,nl:!0,nb:!0,lv:!0,lt:!0,ko:!0,kk:!0,ja:!0,it:!0,id:!0,hu:!0,hr:!0,hi:!0,he:!0,fr:!0,fi:!0,eu:!0,et:!0,es:!0,el:!0,de:!0,da:!0,cs:!0,ca:!0,bg:!0,az:!0,ar:!0})},"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!./nls/jsapi dojo/io-query dojo/sniff dojo/json dijit/form/Button dojo/query".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(a){this._oAuthRedirectFunc=a},oAuthSignIn:function(a,b,g,e){var f=this._oAuthDfd=new m;f.resUrl_=a;f.sinfo_=b;f.oinfo_=g;var l=!e||!1!==e.oAuthPopupConfirmation;if(!g.popup||!l)return this._doOAuthSignIn(a,b,g),f;this._nls||(this._nls=c.identity);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());a=this.oAuthDialog;b=e&&e.error;e=e&&e.token;return k.hide(a.errMsg_),b&&403==b.code&&e&&(d.set(a.errMsg_,"innerHTML",this._nls.forbidden),k.show(a.errMsg_)),
a.show(),f},setOAuthResponseHash:function(a){var c=this._oAuthDfd;if(this._oAuthDfd=null,c&&a)if(clearInterval(this._oAuthIntervalId),"#"===a.charAt(0)&&(a=a.substring(1)),a=n.queryToObject(a),a.error)a=Error("access_denied"===a.error?"ABORTED":"OAuth: "+a.error+" - "+a.error_description),a.code="IdentityManagerBase.2",a.log=l.isDebug,c.errback(a);else{var b=c.oinfo_._oAuthCred,d=new h({userId:a.username,server:c.sinfo_.server,token:a.access_token,expires:(new Date).getTime()+1E3*Number(a.expires_in),
ssl:"true"===a.ssl,_oAuthCred:b});b.storage=a.persist?window.localStorage:window.sessionStorage;b.token=d.token;b.expires=d.expires;b.userId=d.userId;b.ssl=d.ssl;b.save();c.callback(d)}},_createOAuthDialog:function(){var c=this._nls,d=a.substitute(c,this._oAuthDialogContent),f=new b({title:c.title,content:d,"class":"esriOAuthSignInDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:function(){var a=f.esriIdMgr_._oAuthDfd;f.hide_();f.esriIdMgr_._doOAuthSignIn(a.resUrl_,a.sinfo_,a.oinfo_)},cancel_:function(){var a=
f.esriIdMgr_._oAuthDfd;f.esriIdMgr_._oAuthDfd=null;f.hide_();var c=Error("ABORTED");c.code="IdentityManager.2";c.log=l.isDebug;a.errback(c)},hide_:function(){k.hide(f.errMsg_);f.hide();b._DialogLevelManager.hide(f)}}),c=f.domNode;return f.btnSubmit_=e.byNode(g.query(".esriIdSubmit",c)[0]),f.btnCancel_=e.byNode(g.query(".esriIdCancel",c)[0]),f.errMsg_=g.query(".esriErrorMsg",c)[0],f.connect(f.btnSubmit_,"onClick",f.execute_),f.connect(f.btnCancel_,"onClick",f.onCancel),f.connect(f,"onCancel",f.cancel_),
f},_doOAuthSignIn:function(a,c,b){var d=this,g={client_id:b.appId,response_type:"token",state:t.stringify({portalUrl:b.portalUrl}),expiration:b.expiration,locale:b.locale,redirect_uri:b.popup?f.getAbsoluteUrl(b.popupCallbackUrl):window.location.href.replace(/#.*$/,"")};b.forceLogin&&(g.force_login=!0);b.showSocialLogins&&(g.showSocialLogins=!0);var e=b.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",m=e+"?"+n.objectToQuery(g);if(b.popup){var h;(7===q("ie")?(h=window.open(b.popupCallbackUrl,
"esriJSAPIOAuth",b.popupWindowFeatures),h.location=m):h=window.open(m,"esriJSAPIOAuth",b.popupWindowFeatures),h)?(h.focus(),this._oAuthDfd.oAuthWin_=h,this._oAuthIntervalId=setInterval(function(){if(h.closed){clearInterval(d._oAuthIntervalId);var a=d._oAuthDfd;if(a){var c=Error("ABORTED");c.code="IdentityManager.2";c.log=l.isDebug;a.errback(c)}}},500)):(a=Error("ABORTED"),a.code="IdentityManager.2",a.log=l.isDebug,this._oAuthDfd.errback(a))}else this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:g,
authorizeUrl:e,resourceUrl:a,serverInfo:c,oAuthInfo:b}):window.location=m}}})},"cmv/viewer/js/viewer/_WidgetsMixin":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/promise/all dojo/Deferred put-selector dijit/Menu dijit/layout/ContentPane gis/dijit/FloatingTitlePane gis/dijit/FloatingWidgetDialog".split(" "),function(h,k,a,f,b,e,l,m,g,d){return h(null,{legendLayerInfos:[],editorLayerInfos:[],identifyLayerInfos:[],layerControlLayerInfos:[],widgets:{},widgetTypes:"titlePane contentPane floating domNode invisible map layer layout loading".split(" "),
postConfig:function(c){var d;if(c)d=new b,c.then(a.hitch(this,function(){f(this.createWidgets(["loading"])).then(d.resolve)}));else{var g=this.createWidgets(["loading"]);g&&g.length&&(d=f(g))}return this.inherited(arguments)||d},startup:function(){this.inherited(arguments);this.mapDeferred&&this.mapDeferred.then(a.hitch(this,"createWidgets",["map","layer"]));this.layoutDeferred&&f([this.mapDeferred,this.layoutDeferred]).then(a.hitch(this,"createWidgets",null))},createWidgets:function(c){function b(a){return g=
k.filter(d,function(c){return c.placeAt&&c.placeAt===a})}var d=[],g;c=c||this.widgetTypes;for(var e in this.config.widgets)if(this.config.widgets.hasOwnProperty(e)){var f=a.clone(this.config.widgets[e]);f.widgetKey=f.widgetKey||f.id||e;f.include&&!this.widgets[f.widgetKey]&&0<=k.indexOf(c,f.type)&&(f.position="undefined"!==typeof f.position?f.position:1E4,"titlePane"!==f.type&&"contentPane"!==f.type||f.placeAt||(f.placeAt="left"),d.push(f),this.widgets[e]=!0)}for(var l in this.panes)this.panes.hasOwnProperty(l)&&
"outer"!==l&&"center"!==l&&(g=b(l),g.sort(function(a,c){return a.position-c.position}),0<g.length&&0!==g[0].position&&(g[0].position=0),k.forEach(g,function(a,c){this.widgetLoader(a,c)},this));g=k.filter(d,function(a){return!a.placeAt});g.sort(function(a,c){return a.position-c.position});var m=[];k.forEach(g,function(a,c){var b=this.widgetLoader(a,c);b&&m.push(b)},this);return m},widgetLoader:function(c,d){var g,e;g=this.widgetTypes;g=g.concat(this.config.widgetTypes||[]);if(0>k.indexOf(g,c.type))return this.handleError({source:"Controller",
error:'Widget type "'+c.type+'" ('+c.title+") at position "+d+" is not supported."}),null;d&&(c.position=d);if("titlePane"===c.type||"contentPane"===c.type||"floating"===c.type)g=c.widgetKey+"_parent","titlePane"===c.type?e=this._createTitlePaneWidget(g,c):"contentPane"===c.type?e=this._createContentPaneWidget(g,c):"floating"===c.type&&(e=this._createFloatingWidget(g,c)),c.parentWidget=e,this._showWidgetLoader(e);var f=new b;"string"===typeof c.options?require([c.options,c.path],a.hitch(this,function(a,
b){f.resolve();this.createWidget(c,a,b)})):require([c.path],a.hitch(this,function(a){f.resolve();this.createWidget(c,c.options,a)}));return f},createWidget:function(a,b,d){var c=a.widgetKey;if(c){b=this._setWidgetOptions(a,b);var g=b.parentWidget,f=this.widgets;f[c]="titlePane"===a.type||"contentPane"===a.type||"floating"===a.type?(new d(b,e("div"))).placeAt(g.containerNode):"domNode"===a.type?new d(b,a.srcNodeRef):new d(b);f[c]&&f[c].startup&&!f[c]._started&&f[c].startup();this._hideWidgetLoader(g)}},
_setWidgetOptions:function(a,b){a.id&&(b.id=a.id+"_widget");b.parentWidget=a.parentWidget;b.map&&(b.map=this.map);b.mapRightClickMenu&&(this.mapRightClickMenu||(this.mapRightClickMenu=new l({targetNodeIds:[this.map.root],selector:".esriMapLayers"}),this.mapRightClickMenu.startup()),b.mapRightClickMenu=this.mapRightClickMenu);b.mapClickMode&&(b.mapClickMode=this.mapClickMode.current);b.legendLayerInfos&&(b.layerInfos=this.legendLayerInfos);b.layerControlLayerInfos&&(b.layerInfos=this.layerControlLayerInfos);
b.editorLayerInfos&&(b.layerInfos=this.editorLayerInfos);b.identifyLayerInfos&&(b.layerInfos=this.identifyLayerInfos);return b},_showWidgetLoader:function(a){a&&a.containerNode&&(a.loadingNode=e(a.containerNode,"div.widgetLoader i.fa.fa-spinner.fa-pulse.fa-fw").parentNode)},_hideWidgetLoader:function(a){a&&a.loadingNode&&require(["dojo/domReady!"],function(){e(a.loadingNode,"!")})},_createTitlePaneWidget:function(c,b){var d,e=a.mixin({title:b.title||"Widget",iconClass:b.iconClass,open:b.open||!1,
canFloat:b.canFloat||!1,resizable:b.resizable||!1},b.paneOptions||{});c&&(e.id=c);var f=b.placeAt;"string"===typeof f&&(f=this.panes[f]);f||(f=this.panes.left);f&&(e.sidebar=f,d=(new g(e)).placeAt(f,b.position),d.startup());return d},_createFloatingWidget:function(c,b){var g=a.mixin({title:b.title},b.paneOptions||{});c&&(g.id=c);g=new d(g);g.startup();return g},_createContentPaneWidget:function(c,b){var d,g=a.mixin({title:b.title,region:b.region||"center"},b.paneOptions||{});b.className&&(g.className=
b.className);c&&(g.id=c);var e=b.placeAt;e?"string"===typeof e&&(e=this.panes[e]):e=this.panes.left;e&&(d=(new m(g)).placeAt(e),d.startup());return d}})})},"dijit/Menu":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v){c("dijit-legacy-requires")&&v(0,function(){h(["dijit/MenuItem",
"dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"])});return a("dijit.Menu",r,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):k.forEach(this.targetNodeIds,this.bindDomNode,this);this.inherited(arguments)},_iframeContentWindow:function(a){return q.get(this._iframeContentDocument(a))||this._iframeContentDocument(a).__parent__||
a.name&&document.frames[a.name]||null},_iframeContentDocument:function(a){return a.contentDocument||a.contentWindow&&a.contentWindow.document||a.name&&document.frames[a.name]&&document.frames[a.name].document||null},bindDomNode:function(a){a=f.byId(a,this.ownerDocument);var c;if("iframe"==a.tagName.toLowerCase()){var e=a;c=this._iframeContentWindow(e);c=n.body(c.document)}else c=a==n.body(this.ownerDocument)?this.ownerDocument.documentElement:a;var l={node:a,iframe:e};b.set(a,"_dijitMenu"+this.id,
this._bindings.push(l));var h=g.hitch(this,function(a){var c=this.selector,b=c?function(a){return d.selector(c,a)}:function(a){return a},g=this;return[d(a,b(this.leftClickToOpen?"click":"contextmenu"),function(a){a.stopPropagation();a.preventDefault();(new Date).getTime()<g._lastKeyDown+500||g._scheduleOpen(this,e,{x:a.pageX,y:a.pageY},a.target)}),d(a,b("keydown"),function(a){if(93==a.keyCode||a.shiftKey&&a.keyCode==m.F10||g.leftClickToOpen&&a.keyCode==m.SPACE)a.stopPropagation(),a.preventDefault(),
g._scheduleOpen(this,e,null,a.target),g._lastKeyDown=(new Date).getTime()})]});l.connects=c?h(c):[];e&&(l.onloadHandler=g.hitch(this,function(){var a=this._iframeContentWindow(e),a=n.body(a.document);l.connects=h(a)}),e.addEventListener?e.addEventListener("load",l.onloadHandler,!1):e.attachEvent("onload",l.onloadHandler))},unBindDomNode:function(a){var c;try{c=f.byId(a,this.ownerDocument)}catch(z){return}a="_dijitMenu"+this.id;if(c&&b.has(c,a)){for(var d=b.get(c,a)-1,g=this._bindings[d],e;e=g.connects.pop();)e.remove();
(e=g.iframe)&&(e.removeEventListener?e.removeEventListener("load",g.onloadHandler,!1):e.detachEvent("onload",g.onloadHandler));b.remove(c,a);delete this._bindings[d]}},_scheduleOpen:function(a,c,b,d){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:d,delegatedTarget:a,iframe:c,coords:b})},1))},_openMyself:function(a){function b(){u.refocus&&k&&k.focus();t.close(u)}var d=a.target,g=a.iframe,n=a.coords,m=!n;this.currentTarget=a.delegatedTarget;
if(n){if(g){a=e.position(g,!0);var d=this._iframeContentWindow(g),d=e.docScroll(d.document),h=l.getComputedStyle(g),q=l.toPixelValue,r=(c("ie")&&c("quirks")?0:q(g,h.paddingLeft))+(c("ie")&&c("quirks")?q(g,h.borderLeftWidth):0),g=(c("ie")&&c("quirks")?0:q(g,h.paddingTop))+(c("ie")&&c("quirks")?q(g,h.borderTopWidth):0);n.x+=a.x+r-d.x;n.y+=a.y+g-d.y}}else n=e.position(d,!0),n.x+=10,n.y+=10;var u=this,g=this._focusManager.get("prevNode");a=this._focusManager.get("curNode");var k=!a||f.isDescendant(a,
this.domNode)?g:a;t.open({popup:this,x:n.x,y:n.y,onExecute:b,onCancel:b,orient:this.isLeftToRight()?"L":"R"});this.focus();m||this.defer(function(){this._cleanUp(!0)});this._onBlur=function(){this.inherited("_onBlur",arguments);t.close(this)}},destroy:function(){k.forEach(this._bindings,function(a){a&&this.unBindDomNode(a.node)},this);this.inherited(arguments)}})})},"dijit/popup":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on ./place ./BackgroundIframe ./Viewport ./main dojo/touch".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v){function u(){this._popupWrapper&&(e.destroy(this._popupWrapper),delete this._popupWrapper)}a=a(null,{_stack:[],_beginZIndex:1E3,_idGen:1,_repositionAll:function(){if(this._firstAroundNode){var a=this._firstAroundPosition,b=l.position(this._firstAroundNode,!0),d=b.x-a.x,a=b.y-a.y;if(d||a)for(this._firstAroundPosition=b,b=0;b<this._stack.length;b++){var g=this._stack[b].wrapper.style;g.top=parseFloat(g.top)+a+"px";"auto"==g.right?g.left=parseFloat(g.left)+d+
"px":g.right=parseFloat(g.right)-d+"px"}this._aroundMoveListener=setTimeout(c.hitch(this,"_repositionAll"),d||a?10:50)}},_createWrapper:function(a){var c=a._popupWrapper,b=a.domNode;c||(c=e.create("div",{"class":"dijitPopup",style:{display:"none"},role:"region","aria-label":a["aria-label"]||a.label||a.name||a.id},a.ownerDocumentBody),c.appendChild(b),b=b.style,b.display="",b.visibility="",b.position="",b.top="0px",a._popupWrapper=c,k.after(a,"destroy",u,!0),"ontouchend"in document&&n(c,"touchend",
function(a){/^(input|button|textarea)$/i.test(a.target.tagName)||a.preventDefault()}),c.dojoClick=!0);return c},moveOffScreen:function(a){var c=this._createWrapper(a);a=l.isBodyLtr(a.ownerDocument);var b={visibility:"hidden",top:"-9999px",display:""};b[a?"left":"right"]="-9999px";b[a?"right":"left"]="auto";m.set(c,b);return c},hide:function(a){var c=this._createWrapper(a);m.set(c,{display:"none",height:"auto",overflowY:"visible",border:""});a=a.domNode;"_originalStyle"in a&&(a.style.cssText=a._originalStyle)},
getTopPopup:function(){for(var a=this._stack,c=a.length-1;0<c&&a[c].parent===a[c-1].widget;c--);return a[c]},open:function(a){for(var e=this._stack,h=a.popup,u=h.domNode,k=a.orient||["below","below-alt","above","above-alt"],v=a.parent?a.parent.isLeftToRight():l.isBodyLtr(h.ownerDocument),w=a.around,D=a.around&&a.around.id?a.around.id+"_dropdown":"popup_"+this._idGen++;e.length&&(!a.parent||!f.isDescendant(a.parent.domNode,e[e.length-1].widget.domNode));)this.close(e[e.length-1].widget);var E=this.moveOffScreen(h);
h.startup&&!h._started&&h.startup();var F,G=l.position(u);if("maxHeight"in a&&-1!=a.maxHeight)F=a.maxHeight||Infinity;else{F=r.getEffectiveBox(this.ownerDocument);var I=w?l.position(w,!1):{y:a.y-(a.padding||0),h:2*(a.padding||0)};F=Math.floor(Math.max(I.y,F.h-(I.y+I.h)))}G.h>F&&(G=m.getComputedStyle(u),m.set(E,{overflowY:"scroll",height:F+"px",border:G.borderLeftWidth+" "+G.borderLeftStyle+" "+G.borderLeftColor}),u._originalStyle=u.style.cssText,u.style.border="none");b.set(E,{id:D,style:{zIndex:this._beginZIndex+
e.length},"class":"dijitPopup "+(h.baseClass||h["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:a.parent?a.parent.id:""});0==e.length&&w&&(this._firstAroundNode=w,this._firstAroundPosition=l.position(w,!0),this._aroundMoveListener=setTimeout(c.hitch(this,"_repositionAll"),50));g("config-bgIframe")&&!h.bgIframe&&(h.bgIframe=new t(E));D=h.orient?c.hitch(h,"orient"):null;k=w?q.around(E,w,k,v,D):q.at(E,a,"R"==k?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],a.padding,D);E.style.visibility="visible";
u.style.visibility="visible";u=[];u.push(n(E,"keydown",c.hitch(this,function(c){if(c.keyCode==d.ESCAPE&&a.onCancel)c.stopPropagation(),c.preventDefault(),a.onCancel();else if(c.keyCode==d.TAB&&(c.stopPropagation(),c.preventDefault(),(c=this.getTopPopup())&&c.onCancel))c.onCancel()})));h.onCancel&&a.onCancel&&u.push(h.on("cancel",a.onCancel));u.push(h.on(h.onExecute?"execute":"change",c.hitch(this,function(){var a=this.getTopPopup();if(a&&a.onExecute)a.onExecute()})));e.push({widget:h,wrapper:E,parent:a.parent,
onExecute:a.onExecute,onCancel:a.onCancel,onClose:a.onClose,handlers:u});if(h.onOpen)h.onOpen(k);return k},close:function(a){for(var c=this._stack;a&&h.some(c,function(c){return c.widget==a})||!a&&c.length;){var b=c.pop(),d=b.widget,g=b.onClose;d.bgIframe&&(d.bgIframe.destroy(),delete d.bgIframe);if(d.onClose)d.onClose();for(var e;e=b.handlers.pop();)e.remove();d&&d.domNode&&this.hide(d);g&&g()}0==c.length&&this._aroundMoveListener&&(clearTimeout(this._aroundMoveListener),this._firstAroundNode=this._firstAroundPosition=
this._aroundMoveListener=null)}});return v.popup=new a})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(h,k,a,f){return h("dijit.DropDownMenu",f,{templateString:a,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(a){this._moveToPopup(a);a.stopPropagation();a.preventDefault()},_onLeftArrow:function(a){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();
else this.onCancel(!1);else a.stopPropagation(),a.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r){return k("dijit._MenuBase",[n,r,t,q],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),
this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){b.toggle(this.domNode,"dijitMenuActive",a);b.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,childSelector:function(a){var b=c.byNode(a);return a.parentNode==this.containerNode&&b&&b.focus},postCreate:function(){var a=this,b="string"==typeof this.childSelector?this.childSelector:
e.hitch(this,"childSelector");this.own(m(this.containerNode,m.selector(b,l.enter),function(){a.onItemHover(c.byNode(this))}),m(this.containerNode,m.selector(b,l.leave),function(){a.onItemUnhover(c.byNode(this))}),m(this.containerNode,m.selector(b,d),function(b){a.onItemClick(c.byNode(this),b);b.stopPropagation()}),m(this.containerNode,m.selector(b,"focusin"),function(){a._onItemFocus(c.byNode(this))}));this.inherited(arguments)},onKeyboardSearch:function(a,c,b,d){this.inherited(arguments);if(a&&(-1==
d||a.popup&&1==d))this.onItemClick(a,c)},_keyboardSearchCompare:function(a,c){return a.shortcutKey?c==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},
onItemHover:function(a){this.activated?(this.set("selected",a),!a.popup||a.disabled||this.hover_timer||(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,{type:"click"})},this.passivePopupDelay));this._hoveredChild=a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==
a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&
(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,c){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;if(a.popup){this.set("selected",a);this.set("activated",!0);var b=/^key/.test(c._origType||c.type)||0==c.clientX&&0==c.clientY;this._openItemPopup(a,b)}else this.onExecute(),a._onClick?a._onClick(c):a.onClick(c)},_openItemPopup:function(a,
c){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var b=a.popup;b.parentMenu=this;this.own(this._mouseoverHandle=m.once(b.domNode,"mouseover",e.hitch(this,"_onPopupHover")));var d=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){c&&d.focusChild(a);d._cleanUp()},onExecute:e.hitch(this,"_cleanUp",!0),onClose:function(){d._mouseoverHandle&&(d._mouseoverHandle.remove(),
delete d._mouseoverHandle)}},c);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(f.set(this.selected.focusNode,"tabIndex",this.tabIndex),this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&
this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),function(h,
k,a,f,b,e,l,m,g,d){return k("dijit._KeyNavContainer",[g,d,m],{connectKeyNavHandlers:function(a,d){var c=this._keyNavCodes={},g=e.hitch(this,"focusPrev"),f=e.hitch(this,"focusNext");h.forEach(a,function(a){c[a]=g});h.forEach(d,function(a){c[a]=f});c[b.HOME]=e.hitch(this,"focusFirstChild");c[b.END]=e.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){f.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);h.forEach(this.getChildren(),
e.hitch(this,"_startupChild"))},addChild:function(a,b){this.inherited(arguments);this._startupChild(a)},_startupChild:function(a){a.set("tabIndex","-1")},_getFirst:function(){var a=this.getChildren();return a.length?a[0]:null},_getLast:function(){var a=this.getChildren();return a.length?a[a.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(a){return(a=
l.byNode(a))&&a.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(h,k,a,f,b,e,l,m){return k("dijit._KeyNavMixin",m,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);a.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var g=this._keyNavCodes={};g[f.HOME]=b.hitch(this,"focusFirstChild");g[f.END]=b.hitch(this,
"focusLastChild");g[this.isLeftToRight()?f.LEFT_ARROW:f.RIGHT_ARROW]=b.hitch(this,"_onLeftArrow");g[this.isLeftToRight()?f.RIGHT_ARROW:f.LEFT_ARROW]=b.hitch(this,"_onRightArrow");g[f.UP_ARROW]=b.hitch(this,"_onUpArrow");g[f.DOWN_ARROW]=b.hitch(this,"_onDownArrow")}var d=this,g="string"==typeof this.childSelector?this.childSelector:b.hitch(this,"childSelector");this.own(e(this.domNode,"keypress",b.hitch(this,"_onContainerKeypress")),e(this.domNode,"keydown",b.hitch(this,"_onContainerKeydown")),e(this.domNode,
"focus",b.hitch(this,"_onContainerFocus")),e(this.containerNode,e.selector(g,"focusin"),function(a){d._onChildFocus(l.getEnclosingWidget(this),a)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},
focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(a,b){a&&(this.focusedChild&&a!==this.focusedChild&&this._onChildBlur(this.focusedChild),a.set("tabIndex",this.tabIndex),a.focus(b?"end":"start"))},_onContainerFocus:function(a){a.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){a.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(b){a.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex",
"-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(a){a&&a!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),a.set("tabIndex",this.tabIndex),this.lastFocused=a,this._set("focusedChild",a))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(a,b,c,e){a&&this.focusChild(a)},_keyboardSearchCompare:function(a,b){var c=a.domNode,c=(a.label||(c.focusNode?
c.focusNode.label:"")||c.innerText||c.textContent||"").replace(/^\s+/,"").substr(0,b.length).toLowerCase();return b.length&&c==b?-1:0},_isFormElement:function(a){return"INPUT"===a.tagName||"TEXTAREA"===a.tagName||"SELECT"===a.tagName||"BUTTON"===a.tagName},_onContainerKeydown:function(a){if(!this._isFormElement(document.activeElement)){var b=this._keyNavCodes[a.keyCode];b?(b(a,this.focusedChild),a.stopPropagation(),a.preventDefault(),this._searchString=""):a.keyCode!=f.SPACE||!this._searchTimer||
a.ctrlKey||a.altKey||a.metaKey||(a.stopImmediatePropagation(),a.preventDefault(),this._keyboardSearch(a," "))}},_onContainerKeypress:function(a){this._isFormElement(document.activeElement)||a.charCode<=f.SPACE||a.ctrlKey||a.altKey||a.metaKey||(a.preventDefault(),a.stopPropagation(),this._keyboardSearch(a,String.fromCharCode(a.charCode).toLowerCase()))},_keyboardSearch:function(a,d){var c=null,g,e=0;b.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=d;var a=/^(.)\1*$/.test(this._searchString)?
1:this._searchString.length;g=this._searchString.substr(0,a);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var b=this.focusedChild||null;if(1==a||!b)if(b=this._getNextFocusableChild(b,1),!b)return;a=b;do{var f=this._keyboardSearchCompare(b,g);f&&0==e++&&(c=b);if(-1==f){e=-1;break}b=this._getNextFocusableChild(b,1)}while(b&&b!=a)})();this.onKeyboardSearch(c,a,g,e)},_onChildBlur:function(){},_getNextFocusableChild:function(a,b){var c=
a;do{if(a)a=this._getNext(a,b);else if(a=this[0<b?"_getFirst":"_getLast"](),!a)break;if(null!=a&&a!=c&&a.isFocusable())return a}while(a!=c);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(a,b){if(a)for(a=a.domNode;a;)if((a=a[0>b?"previousSibling":"nextSibling"])&&"getAttribute"in a){var c=l.byNode(a);if(c)return c}return null}})})},"cmv/viewer/js/gis/dijit/FloatingTitlePane":function(){define("dojo/_base/declare dijit/TitlePane dojo/on dojo/_base/lang dojo/dnd/Moveable dojo/aspect dojo/topic dojo/sniff dojo/_base/window dojo/window dojo/dom-geometry dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/dom-class dojox/layout/ResizeHandle xstyle/css!dojox/layout/resources/ResizeHandle.css xstyle/css!./FloatingTitlePane/css/FloatingTitlePane.css".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v){return h([k],{sidebarPosition:null,canFloat:!1,isFloating:!1,isDragging:!1,dragDelay:3,resizable:!1,resizeOptions:{},isResizing:!1,postCreate:function(){this.canFloat&&(this.createDomNodes(),this.own(a(window,"resize",f.hitch(this,"_endDrag"))));this.iconClass&&(this.iconNode=q.create("span",{"class":"titlePaneIcon fa fa-fw "+this.iconClass},this.titleNode,"before"));this.own(l.subscribe("titlePane/event",f.hitch(this,"_updateWidgetSidebarPosition")));this.own(e.after(this,
"toggle",f.hitch(this,"_afterToggle")));this.inherited(arguments)},startup:function(){this.titleBarNode&&this.canFloat&&(this._moveable=new b(this.domNode,{handle:this.titleBarNode,delay:this.dragDelay}),0<this.dragDelay&&(this._moveable.mover.prototype.onMouseUp=function(a){this.destroy();a.preventDefault();a.stopPropagation()}),this._titleBarHeight=n.get(this.titleBarNode,"height"),e.after(this._moveable,"onMove",f.hitch(this,"_dragging"),!0),e.after(this._moveable,"onMoveStop",f.hitch(this,"_endDrag"),
!0),e.after(this._moveable,"onMoveStart",f.hitch(this,"_startDrag"),!0),a(document,"mouseup, touchend",f.hitch(this,"_endDrag")));this.inherited(arguments)},createDomNodes:function(){this.moveHandleNode=q.create("span",{title:"Move widget","class":"floatingWidgetPopout"},this.titleNode,"after");this.dockHandleNode=q.create("span",{title:"Dock widget",style:"display:none","class":"floatingWidgetDock"},this.titleNode,"after");this.own(a(this.dockHandleNode,"click",f.hitch(this,function(a){this._dockWidget();
a.stopImmediatePropagation()})));if(this.resizable){var c=f.mixin({targetId:this.id,activeResize:!0,intermediateChanges:!0,startTopic:this.id+"/resize/start",endTopic:this.id+"/resize/end"},this.resizeOptions);this._resizer=(new v(c)).placeAt(this.id);n.set(this._resizer.resizeHandle,"display","none");a(this._resizer,"resize",f.hitch(this,"_resizing"),!0);this.own(l.subscribe(this.id+"/resize/start",f.hitch(this,"_startResize")));this.own(l.subscribe(this.id+"/resize/end",f.hitch(this,"_endResize")))}},
toggle:function(){this.isFloating&&this.isDragging||this.resizing||this.inherited(arguments)},_afterToggle:function(){this._updateTopic(this.open?"open":"close")},_dragging:function(){this.isDragging=!0;this.titleCursor||(this.titleCursor=n.get(this.titleBarNode,"cursor"));n.set(this.titleBarNode,"cursor","move");if(!this.isFloating){this._checkSidebarPosition();n.set(this.dockHandleNode,"display","inline");n.set(this.moveHandleNode,"display","none");n.set(this.domNode,"z-index","40");var a=n.getComputedStyle(this.containerNode),
b=parseInt(n.getComputedStyle(this.sidebar.containerNode).width,10);c.setContentSize(this.domNode,{w:b-2},a);this.isFloating=!0;this.placeAt(g.body());n.set(this.domNode,{top:this._moverBox.t-this._titleBarHeight+"px"});this.resizable&&this._resizer&&this._resizer.resizeHandle&&n.set(this._resizer.resizeHandle,"display","block");this._updateTopic("undock")}},_startDrag:function(a){this._moverBox=a.marginBox},_endDrag:function(){var a=c.position(this.domNode),b=d.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,
0),b.h-a.h);a.x=Math.min(Math.max(a.x,0),b.w-a.w);this._relativePosition=a;this._position();n.set(this.titleBarNode,"cursor",this.titleCursor);window.setTimeout(f.hitch(this,function(){this.isDragging=!1}),50)},_position:function(){if(!r.contains(this.ownerDocumentBody,"dojoMove")){var a=this.domNode,b=d.getBox(this.ownerDocument),e=this._relativePosition,g=e?null:c.position(a);n.set(a,{left:Math.floor(b.l+(e?e.x:(b.w-g.w)/2))+"px",top:Math.floor(b.t+(e?e.y:(b.h-g.h)/2))+"px"})}},_dockWidget:function(){if(!this.isDragging){t.remove(this.domNode,
"style");n.set(this.dockHandleNode,"display","none");n.set(this.moveHandleNode,"display","inline");var a=this.sidebar.getChildren();if(this.sidebarPosition>a.length||0>this.sidebarPosition)this.sidebarPosition=a.length;this.placeAt(this.sidebar,this.sidebarPosition);this.isFloating=!1;this._updateTopic("dock")}this.resizable&&this._resizer&&this._resizer.resizeHandle&&(n.set(this._resizer.resizeHandle,"display","none"),this._initialDimensions&&l.publish(this.id+"/resize/resize",this._initialDimensions))},
_updateWidgetSidebarPosition:function(a){var c=a.sidebarPosition,b=a.action;a.widgetID===this.id||!this.canFloat||"dock"!==b&&"undock"!==b||(this._checkSidebarPosition(),"dock"===b?(a=this.sidebar.getChildren(),c<this.sidebarPosition&&this.sidebarPosition<a.length&&this.sidebarPosition++):"undock"===b&&c<this.sidebarPosition&&0<this.sidebarPosition&&this.sidebarPosition--)},_checkSidebarPosition:function(){var a=this.sidebar.getChildren();if(null===this.sidebarPosition)for(var c=0,b=a.length,c=0;c<
b;c++){var d=a[c];d.canFloat&&(d.sidebarPosition=c)}},_resizing:function(a){this.isResizing=!0;(a=this._resizer._getNewCoords(a,this,"margin"))&&l.publish(this.id+"/resize/resize",{h:this._resizeDimensions.h+(a.h-this._resizer.startSize.h),w:this._resizeDimensions.w+(a.w-this._resizer.startSize.w)})},_startResize:function(){this.isResizing=!0;this._resizeDimensions=c.getContentBox(this.containerNode);this._initialDimensions||(this._initialDimensions=this._resizeDimensions)},_endResize:function(){this.isResizing=
!1;n.set(this.domNode,"height","auto")},_updateTopic:function(a){l.publish("titlePane/event",{category:"Titlepane Event",action:a,label:this.title,widgetID:this.id,sidebarPosition:this.sidebarPosition,value:a})}})})},"dijit/TitlePane":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/fx dojo/has dojo/_base/kernel dojo/keys ./_CssStateMixin ./_TemplatedMixin ./layout/ContentPane dojo/text!./templates/TitlePane.html ./_base/manager ./a11yclick".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r){k=k("dijit.TitlePane",[q,n,c],{title:"",_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!0,toggleable:!0,tabIndex:"0",duration:r.defaultDuration,baseClass:"dijitTitlePane",templateString:t,doLayout:!1,_setTooltipAttr:{node:"focusNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);a.setSelectable(this.titleNode,!1)},postCreate:function(){this.inherited(arguments);this.toggleable&&this._trackMouseState(this.titleBarNode,
this.baseClass+"Title");var a=this.hideNode,c=this.wipeNode;this._wipeIn=l.wipeIn({node:c,duration:this.duration,beforeBegin:function(){a.style.display=""}});this._wipeOut=l.wipeOut({node:c,duration:this.duration,onEnd:function(){a.style.display="none"}})},_setOpenAttr:function(a,c){h.forEach([this._wipeIn,this._wipeOut],function(a){a&&"playing"==a.status()&&a.stop()});c?this[a?"_wipeIn":"_wipeOut"].play():this.hideNode.style.display=this.wipeNode.style.display=a?"":"none";if(this._started)if(a)this._onShow();
else this.onHide();this.containerNode.setAttribute("aria-hidden",a?"false":"true");this.focusNode.setAttribute("aria-pressed",a?"true":"false");this._set("open",a);this._setCss()},_setToggleableAttr:function(a){this.focusNode.setAttribute("role",a?"button":"heading");a?(this.focusNode.setAttribute("aria-controls",this.id+"_pane"),this.focusNode.setAttribute("tabIndex",this.tabIndex),this.focusNode.setAttribute("aria-pressed",this.open)):(f.remove(this.focusNode,"aria-controls"),f.remove(this.focusNode,
"tabIndex"),f.remove(this.focusNode,"aria-pressed"));this._set("toggleable",a);this._setCss()},_setContentAttr:function(a){this.open&&this._wipeOut&&"playing"!=this._wipeOut.status()?(this._wipeIn&&"playing"==this._wipeIn.status()&&this._wipeIn.stop(),e.setMarginBox(this.wipeNode,{h:e.getMarginBox(this.wipeNode).h}),this.inherited(arguments),this._wipeIn?this._wipeIn.play():this.hideNode.style.display=""):this.inherited(arguments)},toggle:function(){this._setOpenAttr(!this.open,!0)},_setCss:function(){var a=
this.titleBarNode||this.focusNode,c=this._titleBarClass;this._titleBarClass=this.baseClass+"Title"+(this.toggleable?"":"Fixed")+(this.open?"Open":"Closed");b.replace(a,this._titleBarClass,c||"");b.replace(a,this._titleBarClass.replace("TitlePaneTitle",""),(c||"").replace("TitlePaneTitle",""));this.arrowNodeInner.innerHTML=this.open?"-":"+"},_onTitleKey:function(a){a.keyCode==d.DOWN_ARROW&&this.open&&(this.containerNode.focus(),a.preventDefault())},_onTitleClick:function(){this.toggleable&&this.toggle()},
setTitle:function(a){g.deprecated("dijit.TitlePane.setTitle() is deprecated.  Use set('title', ...) instead.","","2.0");this.set("title",a)}});m("dojo-bidi")&&k.extend({_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},_setTooltipAttr:function(a){this._set("tooltip",a);this.textDir&&(a=this.enforceTextDirWithUcc(null,a));f.set(this.focusNode,"title",a)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",
this.title),this.set("tooltip",this.tooltip))}});return k})},"dojox/layout/ResizeHandle":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/event dojo/_base/fx dojo/_base/window dojo/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/declare dojo/touch dijit/_base/manager dijit/_Widget dijit/_TemplatedMixin".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u){h.experimental("dojox.layout.ResizeHandle");var w=q("dojox.layout._ResizeHelper",
v,{show:function(){n.set(this.domNode,"display","")},hide:function(){n.set(this.domNode,"display","none")},resize:function(a){c.setMarginBox(this.domNode,a)}});return q("dojox.layout.ResizeHandle",[v,u],{targetId:"",targetContainer:null,resizeAxis:"xy",activeResize:!1,activeResizeClass:"dojoxResizeHandleClone",animateSizing:!0,animateMethod:"chain",animateDuration:225,minHeight:100,minWidth:100,constrainMax:!1,maxHeight:0,maxWidth:0,fixedAspect:!1,intermediateChanges:!1,startTopic:"/dojo/resize/start",
endTopic:"/dojo/resize/stop",templateString:'\x3cdiv dojoAttachPoint\x3d"resizeHandle" class\x3d"dojoxResizeHandle"\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/div\x3e',postCreate:function(){this.connect(this.resizeHandle,t.press,"_beginSizing");this.activeResize?this.animateSizing=!1:(this._resizeHelper=r.byId("dojoxGlobalResizeHelper"),this._resizeHelper||(this._resizeHelper=(new w({id:"dojoxGlobalResizeHelper"})).placeAt(l.body()),d.add(this._resizeHelper.domNode,this.activeResizeClass)));this.minSize||(this.minSize=
{w:this.minWidth,h:this.minHeight});this.constrainMax&&(this.maxSize={w:this.maxWidth,h:this.maxHeight});this._resizeX=this._resizeY=!1;var a=k.partial(d.add,this.resizeHandle);switch(this.resizeAxis.toLowerCase()){case "xy":this._resizeX=this._resizeY=!0;a("dojoxResizeNW");break;case "x":this._resizeX=!0;a("dojoxResizeW");break;case "y":this._resizeY=!0,a("dojoxResizeN")}},_beginSizing:function(d){if(!this._isSizing&&(a.publish(this.startTopic,[this]),this.targetDomNode=(this.targetWidget=r.byId(this.targetId))?
this.targetWidget.domNode:g.byId(this.targetId),this.targetContainer&&(this.targetDomNode=this.targetContainer),this.targetDomNode)){if(!this.activeResize){var e=c.position(this.targetDomNode,!0);this._resizeHelper.resize({l:e.x,t:e.y,w:e.w,h:e.h});this._resizeHelper.show();this.isLeftToRight()||(this._resizeHelper.startPosition={l:e.x,t:e.y})}this._isSizing=!0;this.startPoint={x:d.clientX,y:d.clientY};var e=n.getComputedStyle(this.targetDomNode),f="border-model"===c.boxModel?{w:0,h:0}:c.getPadBorderExtents(this.targetDomNode,
e),m=c.getMarginExtents(this.targetDomNode,e);this.startSize={w:n.get(this.targetDomNode,"width",e),h:n.get(this.targetDomNode,"height",e),pbw:f.w,pbh:f.h,mw:m.w,mh:m.h};this.isLeftToRight()||"absolute"!=n.get(this.targetDomNode,"position")||(e=c.position(this.targetDomNode,!0),this.startPosition={l:e.x,t:e.y});this._pconnects=[a.connect(l.doc,t.move,this,"_updateSizing"),a.connect(l.doc,t.release,this,"_endSizing")];b.stop(d)}},_updateSizing:function(a){if(this.activeResize)this._changeSizing(a);
else{var c=this._getNewCoords(a,"border",this._resizeHelper.startPosition);if(!1===c)return;this._resizeHelper.resize(c)}a.preventDefault()},_getNewCoords:function(a,c,b){try{if(!a.clientX||!a.clientY)return!1}catch(C){return!1}this._activeResizeLastEvent=a;var d=(this.isLeftToRight()?1:-1)*(this.startPoint.x-a.clientX),e=this.startPoint.y-a.clientY;a=this.startSize.w-(this._resizeX?d:0);e=this._checkConstraints(a,this.startSize.h-(this._resizeY?e:0));(b=b||this.startPosition)&&this._resizeX&&(e.l=
b.l+d,e.w!=a&&(e.l+=a-e.w),e.t=b.t);switch(c){case "margin":e.w+=this.startSize.mw,e.h+=this.startSize.mh;case "border":e.w+=this.startSize.pbw,e.h+=this.startSize.pbh}return e},_checkConstraints:function(a,c){if(this.minSize){var b=this.minSize;a<b.w&&(a=b.w);c<b.h&&(c=b.h)}this.constrainMax&&this.maxSize&&(b=this.maxSize,a>b.w&&(a=b.w),c>b.h&&(c=b.h));if(this.fixedAspect){var b=this.startSize.w,d=this.startSize.h,e=b*c-d*a;0>e?a=c*b/d:0<e&&(c=a*d/b)}return{w:a,h:c}},_changeSizing:function(a){var c=
this.targetWidget&&k.isFunction(this.targetWidget.resize),b=this._getNewCoords(a,c&&"margin");if(!1!==b&&(c?this.targetWidget.resize(b):this.animateSizing?m[this.animateMethod]([e.animateProperty({node:this.targetDomNode,properties:{width:{start:this.startSize.w,end:b.w}},duration:this.animateDuration}),e.animateProperty({node:this.targetDomNode,properties:{height:{start:this.startSize.h,end:b.h}},duration:this.animateDuration})]).play():n.set(this.targetDomNode,{width:b.w+"px",height:b.h+"px"}),
this.intermediateChanges))this.onResize(a)},_endSizing:function(c){f.forEach(this._pconnects,a.disconnect);var b=k.partial(a.publish,this.endTopic,[this]);this.activeResize?b():(this._resizeHelper.hide(),this._changeSizing(c),setTimeout(b,this.animateDuration+15));this._isSizing=!1;this.onResize(c)},onResize:function(a){}})})},"xstyle/css":function(){define(["require"],function(h){function k(a,f,b){var e=document.documentElement;a=e.insertBefore(document.createElement(a),e.firstChild);a.id=f;f=(a.currentStyle||
getComputedStyle(a,null)||{})[b];e.removeChild(a);return f}return{load:function(a,f,b,e){function l(a){var c=k("x-parse",null,"content"),d=a&&(a.sheet||a.styleSheet);c&&"none"!=c&&"normal"!=c?f([eval(c)],function(c){a?c.process(a,b):(c.processAll(),b(d))}):b(d)}var m=f.toUrl(a),g;m.match(/!$/)&&(g={wait:!1},m=m.slice(0,-1));var d=f.cache&&f.cache["url:"+m];if(d)d.xCss&&(d=d.cssText),h(["./core/load-css"],function(a){l(a.insertCss(d))});else{if("none"==k("div",a.replace(/\//g,"-").replace(/\..*/,"")+
"-loaded","display"))return l();h(["./core/load-css"],function(a){a(m,l,g)})}}}})},"xstyle/core/load-css":function(){define([],function(){function h(a){if(f.createStyleSheet){var e=f.createStyleSheet();e.cssText=a;return e.owningElement}e=f.createElement("style");e.setAttribute("type","text/css");e.appendChild(f.createTextNode(a));b.insertBefore(e,b.firstChild);return e}function k(e,l,m){var g=a[e];if(g)return d=h(g),l(d);var d=f.createElement("link");d.type="text/css";d.rel="stylesheet";d.href=e;
var c=!m||!1!==m.wait;m=(m=navigator.userAgent.match(/AppleWebKit\/(\d+\.?\d*)/))&&+m[1];if(null===d.onload&&!(536>m))d.onload=function(){d.onload=null;d.onerror=null;c&&l(d)},d.onerror=function(){console.error("Error loading stylesheet "+e);c&&l(d)};else if(c)var n=setInterval(function(){d.style&&(clearInterval(n),l(d))},15);(b||f.getElementsByTagName("head")[0]).appendChild(d);c||l(d)}var a="undefined"==typeof _css_cache?{}:_css_cache,f=document,b=f.head;k.insertCss=h;return k})},"cmv/viewer/js/gis/dijit/FloatingWidgetDialog":function(){define(["dojo/_base/declare",
"dijit/Dialog"],function(h,k){return h([k],{declaredClass:"gis.dijit.FloatingWidget",title:"Floating Widget",draggable:!0,"class":"floatingWidget",close:function(){this.hide()},focus:function(){}})})},"app/config/viewer":function(){define("esri/units esri/geometry/Extent esri/config esri/tasks/GeometryService esri/layers/ImageParameters dojo/i18n!cmv/viewer/js/config/nls/main gis/plugins/Google dojo/topic app/config/bookmarks app/config/find app/config/identify app/config/basemaps esri/layers/FeatureLayer esri/layers/ArcGISDynamicMapServiceLayer gis/dijit/LayerControl gis/dijit/LayerControl/controls/Dynamic gis/dijit/LayerControl/controls/Feature esri/dijit/HomeButton esri/dijit/OverviewMap esri/dijit/Scalebar esri/SnappingManager esri/dijit/editing/Editor esri/layers/VectorTileLayer gis/dijit/Growler gis/dijit/Basemaps gis/dijit/Help gis/dijit/Bookmarks gis/dijit/Find gis/dijit/Identify gis/dijit/Draw gis/dijit/Measurement gis/dijit/Print gis/dijit/Directions gis/dijit/Editor gis/dijit/StreetView gis/dijit/LocateButton gis/dijit/Locale gis/dijit/Legend".split(" "),
function(h,k,a,f,b,e,l,m){function g(a){a=a||{};var c=new b;c.format="png32";for(var d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);return c}a.defaults.io.proxyUrl="proxy/proxy.ashx";a.defaults.io.alwaysUseProxy=!1;a.defaults.geometryService=new f("https://tasks.arcgisonline.com/ArcGIS/rest/services/Geometry/GeometryServer");l.KEY="NOT-A-REAL-API-KEY";m.subscribe("layerControl/hello",function(a){m.publish("growler/growl",{title:"Hello!",message:a.layer._titleForLegend+" "+(a.subLayer?a.subLayer.name:"")+
" says hello"})});m.subscribe("layerControl/goodbye",function(a){m.publish("growler/growl",{title:"Goodbye!",message:a.layer._titleForLegend+" "+(a.subLayer?a.subLayer.name:"")+" says goodbye"})});return{isDebug:!0,defaultMapClickMode:"identify",mapOptions:{basemap:"streets",center:[-96.59179687497497,39.09596293629694],zoom:5,sliderStyle:"small"},titles:{header:e.viewer.titles.header,subHeader:e.viewer.titles.subHeader,pageTitle:e.viewer.titles.pageTitle},operationalLayers:[{type:"feature",url:"https://services1.arcgis.com/6bXbLtkf4y11TosO/arcgis/rest/services/Restaurants/FeatureServer/0",
title:e.viewer.operationalLayers.restaurants,options:{id:"restaurants",opacity:1,visible:!0,outFields:["*"],mode:0},editorLayerInfos:{disableGeometryUpdate:!1},legendLayerInfos:{exclude:!1,layerInfo:{title:e.viewer.operationalLayers.restaurants}}},{type:"feature",url:"https://sampleserver3.arcgisonline.com/ArcGIS/rest/services/SanFrancisco/311Incidents/FeatureServer/0",title:e.viewer.operationalLayers.sf311Incidents,options:{id:"sf311Incidents",opacity:1,visible:!0,outFields:["req_type","req_date",
"req_time","address","district"],mode:0},layerControlLayerInfos:{menu:[{topic:"hello",label:"Say Hello Custom",iconClass:"fa fa-smile-o"}]}},{type:"dynamic",url:"https://sampleserver1.arcgisonline.com/ArcGIS/rest/services/PublicSafety/PublicSafetyOperationalLayers/MapServer",title:e.viewer.operationalLayers.louisvillePubSafety,options:{id:"louisvillePubSafety",opacity:1,visible:!0,imageParameters:g({layerIds:[0,2,4,5,8,10,12,21],layerOption:"show"})},identifyLayerInfos:{layerIds:[2,4,5,8,12,21]},
layerControlLayerInfos:{layerIds:[0,2,4,5,8,9,10,12,21]},legendLayerInfos:{layerInfo:{hideLayers:[21]}}},{type:"dynamic",url:"https://sampleserver6.arcgisonline.com/arcgis/rest/services/DamageAssessment/MapServer",title:e.viewer.operationalLayers.damageAssessment,options:{id:"damageAssessment",opacity:1,visible:!0,imageParameters:g()},legendLayerInfos:{exclude:!0},layerControlLayerInfos:{swipe:!0,metadataUrl:!0,expanded:!0,subLayerMenu:[{topic:"hello",label:"Say Hello",iconClass:"fa fa-smile-o"}]}}],
widgets:{growler:{include:!0,id:"growler",type:"domNode",path:"gis/dijit/Growler",srcNodeRef:"growlerDijit",options:{}},search:{include:!0,type:"domNode",path:"esri/dijit/Search",srcNodeRef:"geocoderButton",options:{map:!0,visible:!0,enableInfoWindow:!1,enableButtonMode:!0,expanded:!1}},basemaps:{include:!0,id:"basemaps",type:"domNode",path:"gis/dijit/Basemaps",srcNodeRef:"basemapsDijit",options:"app/config/basemaps"},identify:{include:!0,id:"identify",type:"titlePane",path:"gis/dijit/Identify",title:e.viewer.widgets.identify,
iconClass:"fa-info-circle",open:!1,position:3,options:"app/config/identify"},mapInfo:{include:!1,id:"mapInfo",type:"domNode",path:"gis/dijit/MapInfo",srcNodeRef:"mapInfoDijit",options:{map:!0,mode:"dms",firstCoord:"y",unitScale:3,showScale:!0,xLabel:"",yLabel:"",minWidth:286}},scalebar:{include:!0,id:"scalebar",type:"map",path:"esri/dijit/Scalebar",options:{map:!0,attachTo:"bottom-left",scalebarStyle:"line",scalebarUnit:"dual"}},locateButton:{include:!0,id:"locateButton",type:"domNode",path:"gis/dijit/LocateButton",
srcNodeRef:"locateButton",options:{map:!0,publishGPSPosition:!0,highlightLocation:!0,useTracking:!0,geolocationOptions:{maximumAge:0,timeout:15E3,enableHighAccuracy:!0}}},overviewMap:{include:!0,id:"overviewMap",type:"map",path:"esri/dijit/OverviewMap",options:{map:!0,attachTo:"bottom-right",color:"#0000CC",height:100,width:125,opacity:.3,visible:!1}},homeButton:{include:!0,id:"homeButton",type:"domNode",path:"esri/dijit/HomeButton",srcNodeRef:"homeButton",options:{map:!0,extent:new k({xmin:-180,
ymin:-85,xmax:180,ymax:85,spatialReference:{wkid:4326}})}},legend:{include:!0,id:"legend",type:"titlePane",path:"gis/dijit/Legend",title:e.viewer.widgets.legend,iconClass:"fa-picture-o",open:!1,position:1,options:{map:!0,legendLayerInfos:!0}},layerControl:{include:!0,id:"layerControl",type:"titlePane",path:"gis/dijit/LayerControl",title:e.viewer.widgets.layerControl,iconClass:"fa-th-list",open:!1,position:0,options:{map:!0,layerControlLayerInfos:!0,separated:!0,vectorReorder:!0,overlayReorder:!0,
menu:{feature:[{topic:"hello",iconClass:"fa fa-smile-o",label:"Say Hello"}]},subLayerMenu:{dynamic:[{topic:"goodbye",iconClass:"fa fa-frown-o",label:"Say goodbye"}]}}},bookmarks:{include:!0,id:"bookmarks",type:"titlePane",path:"gis/dijit/Bookmarks",title:e.viewer.widgets.bookmarks,iconClass:"fa-bookmark",open:!1,position:2,options:"app/config/bookmarks"},find:{include:!0,id:"find",type:"titlePane",canFloat:!0,path:"gis/dijit/Find",title:e.viewer.widgets.find,iconClass:"fa-search",open:!1,position:3,
options:"app/config/find"},draw:{include:!0,id:"draw",type:"titlePane",canFloat:!0,path:"gis/dijit/Draw",title:e.viewer.widgets.draw,iconClass:"fa-paint-brush",open:!1,position:4,options:{map:!0,mapClickMode:!0}},measure:{include:!0,id:"measurement",type:"titlePane",canFloat:!0,path:"gis/dijit/Measurement",title:e.viewer.widgets.measure,iconClass:"fa-expand",open:!1,position:5,options:{map:!0,mapClickMode:!0,defaultAreaUnit:h.SQUARE_MILES,defaultLengthUnit:h.MILES}},print:{include:!0,id:"print",type:"titlePane",
canFloat:!0,path:"gis/dijit/Print",title:e.viewer.widgets.print,iconClass:"fa-print",open:!1,position:6,options:{map:!0,printTaskURL:"https://utility.arcgisonline.com/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task",copyrightText:"Copyright 2014",authorText:"Me",defaultTitle:"Viewer Map",defaultFormat:"PDF",defaultLayout:"Letter ANSI A Landscape"}},directions:{include:!0,id:"directions",type:"titlePane",path:"gis/dijit/Directions",title:e.viewer.widgets.directions,
iconClass:"fa-map-signs",open:!1,position:7,options:{map:!0,mapRightClickMenu:!0,options:{routeTaskUrl:"https://sampleserver3.arcgisonline.com/ArcGIS/rest/services/Network/USA/NAServer/Route",routeParams:{directionsLanguage:"en-US",directionsLengthUnits:h.MILES},active:!1}}},editor:{include:!0,id:"editor",type:"titlePane",path:"gis/dijit/Editor",title:e.viewer.widgets.editor,iconClass:"fa-pencil",open:!1,position:8,options:{map:!0,mapClickMode:!0,editorLayerInfos:!0,settings:{toolbarVisible:!0,showAttributesOnClick:!0,
enableUndoRedo:!0,createOptions:{polygonDrawTools:["freehandpolygon","autocomplete"]},toolbarOptions:{reshapeVisible:!0,cutVisible:!0,mergeVisible:!0}}}},streetview:{include:!0,id:"streetview",type:"titlePane",canFloat:!0,position:9,path:"gis/dijit/StreetView",title:e.viewer.widgets.streetview,iconClass:"fa-street-view",paneOptions:{resizable:!0,resizeOptions:{minSize:{w:250,h:250}}},options:{map:!0,mapClickMode:!0,mapRightClickMenu:!0}},locale:{include:!0,id:"locale",type:"domNode",srcNodeRef:"geocodeDijit",
path:"gis/dijit/Locale",title:e.viewer.widgets.locale,options:{style:"margin-left: 30px;"}},help:{include:!0,id:"help",type:"floating",path:"gis/dijit/Help",title:e.viewer.widgets.help,options:{}}}}})},"esri/units":function(){define(["dojo/has","./kernel"],function(h,k){var a={CENTIMETERS:"esriCentimeters",DECIMAL_DEGREES:"esriDecimalDegrees",DEGREE_MINUTE_SECONDS:"esriDegreeMinuteSeconds",DECIMETERS:"esriDecimeters",FEET:"esriFeet",FEET_US:"esriFeetUS",INCHES:"esriInches",KILOMETERS:"esriKilometers",
METERS:"esriMeters",MILES:"esriMiles",MILES_US:"esriMilesUS",MILLIMETERS:"esriMillimeters",NAUTICAL_MILES:"esriNauticalMiles",POINTS:"esriPoints",UNKNOWN:"esriUnknownUnits",YARDS:"esriYards",YARDS_US:"esriYardsUS",ACRES:"esriAcres",ACRES_US:"esriAcresUS",ARES:"esriAres",SQUARE_KILOMETERS:"esriSquareKilometers",SQUARE_MILES:"esriSquareMiles",SQUARE_MILES_US:"esriSquareMilesUS",SQUARE_FEET:"esriSquareFeet",SQUARE_FEET_US:"esriSquareFeetUS",SQUARE_METERS:"esriSquareMeters",HECTARES:"esriHectares",SQUARE_YARDS:"esriSquareYards",
SQUARE_YARDS_US:"esriSquareYardsUS",SQUARE_INCHES:"esriSquareInches",SQUARE_MILLIMETERS:"esriSquareMillimeters",SQUARE_CENTIMETERS:"esriSquareCentimeters",SQUARE_DECIMETERS:"esriSquareDecimeters",SQUARE_NAUTICAL_MILES:"esriSquareNauticalMiles",METERS_PER_SECOND:"esriMetersPerSecond",KILOMETERS_PER_HOUR:"esriKilometersPerHour",KNOTS:"esriKnots",FEET_PER_SECOND:"esriFeetPerSecond",MILES_PER_HOUR:"esriMilesPerHour",RADIANS:"esriDURadians"};return h("extend-esri")&&(k.Units=a),a})},"esri/tasks/GeometryService":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ./Task ../geometry/Extent ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/jsonUtils".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r){h=h(d,{declaredClass:"esri.tasks.GeometryService",_eventMap:{"areas-and-lengths-complete":["result"],"auto-complete-complete":["geometries"],"buffer-complete":["geometries"],"convex-hull-complete":["geometry"],"cut-complete":["result"],"densify-complete":["geometries"],"difference-complete":["geometries"],"distance-complete":["distance"],"generalize-complete":["geometries"],"intersect-complete":["geometries"],"label-points-complete":["geometries"],"lengths-complete":["result"],
"offset-complete":["geometries"],"project-complete":["geometries"],"relation-complete":["relations"],"reshape-complete":["geometry"],"simplify-complete":["geometries"],"trim-extend-complete":["geometries"],"union-complete":["geometry"]},constructor:function(a){a=k.hitch;this._projectHandler=a(this,this._projectHandler);this._simplifyHandler=a(this,this._simplifyHandler);this._bufferHandler=a(this,this._bufferHandler);this._areasAndLengthsHandler=a(this,this._areasAndLengthsHandler);this._lengthsHandler=
a(this,this._lengthsHandler);this._labelPointsHandler=a(this,this._labelPointsHandler);this._relationHandler=a(this,this._relationHandler);this._convexHullHandler=a(this,this._convexHullHandler);this._unionHandler=a(this,this._unionHandler);this._autoCompleteHandler=a(this,this._autoCompleteHandler);this._reshapeHandler=a(this,this._reshapeHandler);this._cutHandler=a(this,this._cutHandler);this._intersectHandler=a(this,this._intersectHandler);this._differenceHandler=a(this,this._differenceHandler);
this._trimExtendHandler=a(this,this._trimExtendHandler);this._densifyHandler=a(this,this._densifyHandler);this._generalizeHandler=a(this,this._densifyHandler);this._offsetHandler=a(this,this._offsetHandler);this._distanceHandler=a(this,this._distanceHandler);this._toGeoCoordinateHandler=a(this,this._toGeoCoordinateHandler);this._fromGeoCoordinateHandler=a(this,this._fromGeoCoordinateHandler);this.registerConnectEvents()},_encodeGeometries:function(a){var c,b=[],d=a.length;for(c=0;d>c;c++)b.push(a[c].toJson());
return{geometryType:r.getJsonType(a[0]),geometries:b}},_decodeGeometries:function(c,b,d){var e=r.getGeometryType(b);c=c.geometries;var g=[],f={spatialReference:d.toJson()},l=k.mixin;return a.forEach(c,function(a,c){g[c]=new e(l(a,f))}),g},_toProjectGeometry:function(a){var b=a.spatialReference.toJson();return a instanceof c?new q({rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]],spatialReference:b}):new n({paths:[[].concat(a.points)],spatialReference:b})},
_fromProjectedGeometry:function(a,b,d){return"esriGeometryEnvelope"===b?(a=a.rings[0],new c(a[0][0],a[0][1],a[2][0],a[2][1],d)):new t({points:a.paths[0],spatialReference:d.toJson()})},project:function(a,c,d,e){var l,n=k.mixin({},this._url.query,{f:"json"});a.geometries?(e=d,d=c,c=a.outSR,l=a.geometries[0],n=k.mixin(n,a.toJson())):(l=a[0],n=k.mixin(n,{outSR:c.wkid||f.toJson(c.toJson()),inSR:l.spatialReference.wkid||f.toJson(l.spatialReference.toJson()),geometries:f.toJson(this._encodeGeometries(a))}));
var h=r.getJsonType(l),q=this._projectHandler,t=this._errorHandler,u=new b(g._dfdCanceller);return u._pendingDfd=m({url:this._url.path+"/project",content:n,callbackParamName:"callback",load:function(a,b){q(a,b,h,c,d,e,u)},error:function(a){t(a,e,u)}}),u},_projectHandler:function(a,c,b,d,e,g,f){try{var l=this._decodeGeometries(a,b,d);this._successHandler([l],"onProjectComplete",e,f)}catch(C){this._errorHandler(C,g,f)}},onProjectComplete:function(){},simplify:function(a,c,d){var e=a[0].spatialReference,
l=k.mixin({},this._url.query,{f:"json",sr:e.wkid?e.wkid:f.toJson(e.toJson()),geometries:f.toJson(this._encodeGeometries(a))}),n=r.getJsonType(a[0]),h=this._simplifyHandler,q=this._errorHandler,t=new b(g._dfdCanceller);return t._pendingDfd=m({url:this._url.path+"/simplify",content:l,callbackParamName:"callback",load:function(a,b){h(a,b,n,e,c,d,t)},error:function(a){q(a,d,t)}}),t},_simplifyHandler:function(a,c,b,d,e,g,f){try{var l=this._decodeGeometries(a,b,d);this._successHandler([l],"onSimplifyComplete",
e,f)}catch(C){this._errorHandler(C,g,f)}},onSimplifyComplete:function(){},convexHull:function(a,c,d){var e=a[0].spatialReference;a=k.mixin({},this._url.query,{f:"json",sr:f.toJson(e.toJson()),geometries:f.toJson(this._encodeGeometries(a))});var l=this._convexHullHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/convexHull",content:a,callbackParamName:"callback",load:function(a,b){l(a,b,e,c,d,h)},error:function(a){n(a,d,h)}}),h},_convexHullHandler:function(a,
c,b,d,e,g){try{var f=r.fromJson(a.geometry).setSpatialReference(b);this._successHandler([f],"onConvexHullComplete",d,g)}catch(B){this._errorHandler(B,e,g)}},onConvexHullComplete:function(){},union:function(a,c,d){var e=a[0].spatialReference;a=k.mixin({},this._url.query,{f:"json",sr:f.toJson(e.toJson()),geometries:f.toJson(this._encodeGeometries(a))});var l=this._unionHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/union",content:a,callbackParamName:"callback",
load:function(a,b){l(a,b,e,c,d,h)},error:function(a){n(a,d,h)}}),h},_unionHandler:function(a,c,b,d,e,g){try{var f=r.fromJson(a.geometry).setSpatialReference(b);this._successHandler([f],"onUnionComplete",d,g)}catch(B){this._errorHandler(B,e,g)}},onUnionComplete:function(){},autoComplete:function(a,c,d,e){var l=a[0].spatialReference;a=k.mixin({},this._url.query,{f:"json",sr:f.toJson(l.toJson()),polygons:f.toJson(this._encodeGeometries(a).geometries),polylines:f.toJson(this._encodeGeometries(c).geometries)});
var n=this._autoCompleteHandler,h=this._errorHandler,q=new b(g._dfdCanceller);return q._pendingDfd=m({url:this._url.path+"/autoComplete",content:a,callbackParamName:"callback",load:function(a,c){n(a,c,l,d,e,q)},error:function(a){h(a,e,q)}}),q},_autoCompleteHandler:function(a,c,b,d,e,g){try{var f,l=a.geometries;a=[];var n=l.length;for(f=0;n>f;f++)a[f]=new q({spatialReference:b,rings:l[f].rings});this._successHandler([a],"onAutoCompleteComplete",d,g)}catch(D){this._errorHandler(D,e,g)}},onAutoCompleteComplete:function(){},
reshape:function(a,c,d,e){var l=a.spatialReference;a=k.mixin({},this._url.query,{f:"json",sr:f.toJson(l.toJson()),target:f.toJson({geometryType:r.getJsonType(a),geometry:a.toJson()}),reshaper:f.toJson(c.toJson())});var n=this._reshapeHandler,h=this._errorHandler,q=new b(g._dfdCanceller);return q._pendingDfd=m({url:this._url.path+"/reshape",content:a,callbackParamName:"callback",load:function(a,c){n(a,c,l,d,e,q)},error:function(a){h(a,e,q)}}),q},_reshapeHandler:function(a,c,b,d,e,g){try{var f=r.fromJson(a.geometry).setSpatialReference(b);
this._successHandler([f],"onReshapeComplete",d,g)}catch(B){this._errorHandler(B,e,g)}},onReshapeComplete:function(){},cut:function(c,d,e,l){var n=c[0].spatialReference,h=a.map(c,function(a){return a.toJson()});c=k.mixin({},this._url.query,{f:"json",sr:f.toJson(n.toJson()),target:f.toJson({geometryType:r.getJsonType(c[0]),geometries:h}),cutter:f.toJson(d.toJson())});var q=this._cutHandler,t=this._errorHandler,u=new b(g._dfdCanceller);return u._pendingDfd=m({url:this._url.path+"/cut",content:c,callbackParamName:"callback",
load:function(a,c){q(a,c,n,e,l,u)},error:function(a){t(a,l,u)}}),u},_cutHandler:function(c,b,d,e,g,f){try{var l=c.geometries,n={};n.cutIndexes=c.cutIndexes;n.geometries=[];a.forEach(l,function(a){n.geometries.push(r.fromJson(a).setSpatialReference(d))});this._successHandler([n],"onCutComplete",e,f)}catch(C){this._errorHandler(C,g,f)}},onCutComplete:function(){},intersect:function(a,c,d,e){var l=a[0].spatialReference;a=k.mixin({},this._url.query,{f:"json",sr:f.toJson(l.toJson()),geometries:f.toJson(this._encodeGeometries(a)),
geometry:f.toJson({geometryType:r.getJsonType(c),geometry:c.toJson()})});var n=this._intersectHandler,h=this._errorHandler,q=new b(g._dfdCanceller);return q._pendingDfd=m({url:this._url.path+"/intersect",content:a,callbackParamName:"callback",load:function(a,c){n(a,c,l,d,e,q)},error:function(a){h(a,e,q)}}),q},_intersectHandler:function(c,b,d,e,g,f){try{var l=[];a.forEach(c.geometries,function(a){l.push(r.fromJson(a).setSpatialReference(d))});this._successHandler([l],"onIntersectComplete",e,f)}catch(B){this._errorHandler(B,
g,f)}},onIntersectComplete:function(){},difference:function(a,c,d,e){var l=a[0].spatialReference;a=k.mixin({},this._url.query,{f:"json",sr:f.toJson(l.toJson()),geometries:f.toJson(this._encodeGeometries(a)),geometry:f.toJson({geometryType:r.getJsonType(c),geometry:c.toJson()})});var n=this._differenceHandler,h=this._errorHandler,q=new b(g._dfdCanceller);return q._pendingDfd=m({url:this._url.path+"/difference",content:a,callbackParamName:"callback",load:function(a,c){n(a,c,l,d,e,q)},error:function(a){h(a,
e,q)}}),q},_differenceHandler:function(c,b,d,e,g,f){try{var l=[];a.forEach(c.geometries,function(a){l.push(r.fromJson(a).setSpatialReference(d))});this._successHandler([l],"onDifferenceComplete",e,f)}catch(B){this._errorHandler(B,g,f)}},onDifferenceComplete:function(){},buffer:function(a,c,d){var e=k.mixin({},this._url.query,{f:"json"},a.toJson()),f=a.outSpatialReference||a.geometries[0].spatialReference,l=this._bufferHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+
"/buffer",content:e,callbackParamName:"callback",load:function(a,b){l(a,b,f,c,d,h)},error:function(a){n(a,d,h)}}),h},_bufferHandler:function(a,c,b,d,e,g){try{var f,l=a.geometries;a=[];var n=l.length;for(f=0;n>f;f++)a[f]=new q({spatialReference:b,rings:l[f].rings});this._successHandler([a],"onBufferComplete",d,g)}catch(D){this._errorHandler(D,e,g)}},onBufferComplete:function(){},areasAndLengths:function(a,c,d){a=k.mixin({},this._url.query,{f:"json"},a.toJson());var e=this._areasAndLengthsHandler,f=
this._errorHandler,l=new b(g._dfdCanceller);return l._pendingDfd=m({url:this._url.path+"/areasAndLengths",content:a,callbackParamName:"callback",load:function(a,b){e(a,b,c,d,l)},error:function(a){f(a,d,l)}}),l},_areasAndLengthsHandler:function(a,c,b,d,e){try{this._successHandler([a],"onAreasAndLengthsComplete",b,e)}catch(A){this._errorHandler(A,d,e)}},onAreasAndLengthsComplete:function(){},lengths:function(a,c,d){a=k.mixin({},this._url.query,{f:"json"},a.toJson());var e=this._lengthsHandler,f=this._errorHandler,
l=new b(g._dfdCanceller);return l._pendingDfd=m({url:this._url.path+"/lengths",content:a,callbackParamName:"callback",load:function(a,b){e(a,b,c,d,l)},error:function(a){f(a,d,l)}}),l},_lengthsHandler:function(a,c,b,d,e){try{this._successHandler([a],"onLengthsComplete",b,e)}catch(A){this._errorHandler(A,d,e)}},onLengthsComplete:function(){},labelPoints:function(c,d,e){var l=a.map(c,function(a){return a.toJson()}),n=c[0].spatialReference,l=k.mixin({},this._url.query,{f:"json",sr:n.wkid?n.wkid:f.toJson(n.toJson()),
polygons:f.toJson(l)}),h=this._labelPointsHandler,q=this._errorHandler,r=new b(g._dfdCanceller);return r._pendingDfd=m({url:this._url.path+"/labelPoints",content:l,callbackParamName:"callback",load:function(a,b){h(a,b,c,n,d,e,r)},error:function(a){q(a,e,r)}}),r},_labelPointsHandler:function(c,b,d,e,g,f,l){try{var n=[];a.forEach(c.labelPoints,function(a){n.push(r.fromJson(a).setSpatialReference(e))});this._successHandler([n],"onLabelPointsComplete",g,l)}catch(C){this._errorHandler(C,f,l)}},onLabelPointsComplete:function(){},
relation:function(a,c,d){a=k.mixin({},this._url.query,{f:"json"},a.toJson());var e=this._relationHandler,f=this._errorHandler,l=new b(g._dfdCanceller);return l._pendingDfd=m({url:this._url.path+"/relation",content:a,callbackParamName:"callback",load:function(a,b){e(a,b,c,d,l)},error:function(a){f(a,d,l)}}),l},_relationHandler:function(a,c,b,d,e){try{this._successHandler([a.relations],"onRelationComplete",b,e)}catch(A){this._errorHandler(A,d,e)}},onRelationComplete:function(){},trimExtend:function(a,
c,d){var e=k.mixin({},this._url.query,{f:"json"},a.toJson()),f=a.sr,l=this._trimExtendHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/trimExtend",content:e,callbackParamName:"callback",load:function(a,b){l(a,b,f,c,d,h)},error:function(a){n(a,d,h)}}),h},_trimExtendHandler:function(a,c,b,d,e,g){try{var f,l=a.geometries;a=[];var m=l.length;for(f=0;m>f;f++)a[f]=new n({spatialReference:b,paths:l[f].paths});this._successHandler([a],"onTrimExtendComplete",
d,g)}catch(D){this._errorHandler(D,e,g)}},onTrimExtendComplete:function(){},densify:function(a,c,d){var e=k.mixin({},this._url.query,{f:"json"},a.toJson()),f=a.geometries[0].spatialReference,l=this._densifyHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/densify",content:e,callbackParamName:"callback",load:function(a,b){l(a,b,f,c,d,h)},error:function(a){n(a,d,h)}}),h},_densifyHandler:function(c,b,d,e,g,f){try{var l=[];a.forEach(c.geometries,function(a){l.push(r.fromJson(a).setSpatialReference(d))});
this._successHandler([l],"onDensifyComplete",e,f)}catch(B){this._errorHandler(B,g,f)}},onDensifyComplete:function(){},generalize:function(a,c,d){var e=k.mixin({},this._url.query,{f:"json"},a.toJson()),f=a.geometries[0].spatialReference,l=this._generalizeHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/generalize",content:e,callbackParamName:"callback",load:function(a,b){l(a,b,f,c,d,h)},error:function(a){n(a,d,h)}}),h},_generalizeHandler:function(c,
b,d,e,g,f){try{var l=[];a.forEach(c.geometries,function(a){l.push(r.fromJson(a).setSpatialReference(d))});this._successHandler([l],"onGeneralizeComplete",e,f)}catch(B){this._errorHandler(B,g,f)}},onGeneralizeComplete:function(){},offset:function(a,c,d){var e=k.mixin({},this._url.query,{f:"json"},a.toJson()),f=a.geometries[0].spatialReference,l=this._offsetHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/offset",content:e,callbackParamName:"callback",
load:function(a,b){l(a,b,f,c,d,h)},error:function(a){n(a,d,h)}}),h},_offsetHandler:function(c,b,d,e,g,f){try{var l=[];a.forEach(c.geometries,function(a){l.push(r.fromJson(a).setSpatialReference(d))});this._successHandler([l],"onOffsetComplete",e,f)}catch(B){this._errorHandler(B,g,f)}},onOffsetComplete:function(){},distance:function(a,c,d){var e=k.mixin({},this._url.query,{f:"json"},a.toJson()),f=a.geometry1.spatialReference,l=this._distanceHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=
m({url:this._url.path+"/distance",content:e,callbackParamName:"callback",load:function(a,b){l(a,b,f,c,d,h)},error:function(a){n(a,d,h)}}),h},_distanceHandler:function(a,c,b,d,e,g){try{a=a&&a.distance,this._successHandler([a],"onDistanceComplete",d,g)}catch(z){this._errorHandler(z,e,g)}},onDistanceComplete:function(){},toGeoCoordinateString:function(a,c,d){var e={};k.isObject(a.sr)?e.sr=a.sr.wkid||f.toJson(a.sr.toJson()):e.sr=a.sr;e.coordinates=f.toJson(a.coordinates);e.conversionType=a.conversionType||
"MGRS";e.conversionMode=a.conversionMode;e.numOfDigits=a.numOfDigits;e.rounding=a.rounding;e.addSpaces=a.addSpaces;a=k.mixin({},this._url.query,{f:"json"},e);var l=this._toGeoCoordinateHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/toGeoCoordinateString",content:a,callbackParamName:"callback",load:function(a,b){l(a,b,c,d,h)},error:function(a){n(a,d,h)}}),h},_toGeoCoordinateHandler:function(a,c,b,d,e){try{this._successHandler([a.strings],"onToGeoCoordinateStringComplete",
b,e)}catch(A){this._errorHandler(A,d,e)}},onToGeoCoordinateStringComplete:function(){},fromGeoCoordinateString:function(a,c,d){var e={};k.isObject(a.sr)?e.sr=a.sr.wkid||f.toJson(a.sr.toJson()):e.sr=a.sr;e.strings=f.toJson(a.strings);e.conversionType=a.conversionType||"MGRS";e.conversionMode=a.conversionMode;a=k.mixin({},this._url.query,{f:"json"},e);var l=this._fromGeoCoordinateHandler,n=this._errorHandler,h=new b(g._dfdCanceller);return h._pendingDfd=m({url:this._url.path+"/fromGeoCoordinateString",
content:a,callbackParamName:"callback",load:function(a,b){l(a,b,c,d,h)},error:function(a){n(a,d,h)}}),h},_fromGeoCoordinateHandler:function(a,c,b,d,e){try{this._successHandler([a.coordinates],"onToGeoCoordinateStringComplete",b,e)}catch(A){this._errorHandler(A,d,e)}},onFromGeoCoordinateStringComplete:function(){}});return k.mixin(h,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,
UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,
UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,
UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",
UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"}),e("extend-esri")&&k.setObject("tasks.GeometryService",h,l),h})},"esri/tasks/Task":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../deferredUtils ../urlUtils ../Evented".split(" "),function(h,k,a,f,b,e,l,m){h=h(m,{declaredClass:"esri.tasks._Task",
_eventMap:{error:["error"],complete:["result"]},constructor:function(a,b){a&&k.isString(a)&&(this._url=l.urlToObject(this.url=a));b&&b.requestOptions&&(this.requestOptions=b.requestOptions);this.normalization=!0;this._errorHandler=k.hitch(this,this._errorHandler);this.registerConnectEvents()},_useSSL:function(){var a=this._url,b=/^http:/i;this.url&&(this.url=this.url.replace(b,"https:"));a&&a.path&&(a.path=a.path.replace(b,"https:"))},_encode:function(b,d,c){var e,g,f,l,m,h={};for(f in b)if("declaredClass"!==
f&&(e=b[f],g=typeof e,null!==e&&void 0!==e&&"function"!==g))if(k.isArray(e))for(h[f]=[],m=e.length,l=0;m>l;l++)h[f][l]=this._encode(e[l]);else"object"===g?e.toJson&&(l=e.toJson(c&&c[f]),"esri.tasks.FeatureSet"===e.declaredClass&&l.spatialReference&&(l.sr=l.spatialReference,delete l.spatialReference),h[f]=d?l:a.toJson(l)):h[f]=e;return h},_successHandler:function(a,b,c,f){b&&this[b].apply(this,a);c&&c.apply(null,a);f&&e._resDfd(f,a)},_errorHandler:function(a,b,c){this.onError(a);b&&b(a);c&&c.errback(a)},
setNormalization:function(a){this.normalization=a},onError:function(){}});return f("extend-esri")&&(b.Task=h),h})},"esri/layers/ImageParameters":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang ../layerUtils".split(" "),function(h,k,a,f,b,e,l,m){k=k(null,{declaredClass:"esri.layers.ImageParameters",constructor:function(){this.layerDefinitions=[]},bbox:null,extent:null,width:null,height:null,dpi:null,format:null,imageSpatialReference:null,
layerOption:null,layerIds:null,transparent:null,timeExtent:null,layerTimeOptions:null,toJson:function(a){this.bbox&&h.deprecated(this.declaredClass+" : Property 'bbox' deprecated. Use property 'extent'.");var b=this.bbox||this.extent,b=b&&a&&b._normalize(!0);a=this.layerOption;var c=b?b.spatialReference.wkid||f.toJson(b.spatialReference.toJson()):null,e=this.imageSpatialReference,b={dpi:this.dpi,format:this.format,transparent:this.transparent,size:null!==this.width&&null!==this.height?this.width+
","+this.height:null,bbox:b?b.xmin+","+b.ymin+","+b.xmax+","+b.ymax:null,bboxSR:c,layers:a?a+":"+this.layerIds.join(","):null,imageSR:e?e.wkid||f.toJson(e.toJson()):c};b.layerDefs=m._serializeLayerDefinitions(this.layerDefinitions);a=this.timeExtent;return b.time=a?a.toJson().join(","):null,b.layerTimeOptions=m._serializeTimeOptions(this.layerTimeOptions),l.filter(b,function(a){return null!==a?!0:void 0})}});return a.mixin(k,{LAYER_OPTION_SHOW:"show",LAYER_OPTION_HIDE:"hide",LAYER_OPTION_INCLUDE:"include",
LAYER_OPTION_EXCLUDE:"exclude"}),b("extend-esri")&&a.setObject("layers.ImageParameters",k,e),k})},"cmv/viewer/js/config/nls/main":function(){define({root:{basemaps:{davidRumseyMap1812:"David Rumsey 1812",earthAtNight:"Earth at Night",landsatShaded:"Landsat Shaded"},bookmarks:{nullIsland:"Null Island",usa:"USA"},find:{louisvillePubSafety:"Find A Public Safety Location By Name",sf311Incidents:"Find Incident By Code/Description"},identify:{louisvillePubSafety:{policeStation:"Police Station",trafficCamera:"Traffic Camera"}},
viewer:{operationalLayers:{cities:"World Cities",damageAssessment:"Damage Assessment",louisvillePubSafety:"Louisville Public Safety",restaurants:"Restaurants",sf311Incidents:"San Francisco 311 Incidents"},titles:{header:"Configurable Map Viewer",pageTitle:"Configurable Map Viewer",subHeader:"make it your own"},widgets:{bookmarks:"Bookmarks",directions:"Directions",draw:"Draw",editor:"Editor",find:"Find",help:"Help",identify:"Identify",measure:"Measurement",layerControl:"Layers",legend:"Legend",locale:"Locale",
print:"Print",streetview:"Google Street View"}}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/plugins/Google":function(){(function(h,k){"function"===typeof define&&define.amd?define(k):"object"===typeof exports?module.exports=k():h.GoogleMapsLoader=k()})("undefined"!==typeof window?window:null,function(){var h=null,k=null,a=!1,f=[],b=[],e=null,l={URL:"https://maps.googleapis.com/maps/api/js",KEY:null,LIBRARIES:[],CLIENT:null,CHANNEL:null,LANGUAGE:null,REGION:null,VERSION:"3",WINDOW_CALLBACK_NAME:"__google_maps_api_provider_initializator__",
_googleMockApiObject:{},load:function(e){null===k?!0===a?e&&f.push(e):(a=!0,window[l.WINDOW_CALLBACK_NAME]=function(){var g;a=!1;null===k&&(k=window.google);for(g=0;g<b.length;g++)b[g](k);e&&e(k);for(g=0;g<f.length;g++)f[g](k);f=[]},l.createLoader()):e&&e(k)},createLoader:function(){h=document.createElement("script");h.type="text/javascript";h.src=l.createUrl();document.body.appendChild(h)},isLoaded:function(){return null!==k},createUrl:function(){var a=l.URL,a=a+("?callback\x3d"+l.WINDOW_CALLBACK_NAME);
l.KEY&&(a+="\x26key\x3d"+l.KEY);0<l.LIBRARIES.length&&(a+="\x26libraries\x3d"+l.LIBRARIES.join(","));l.VERSION&&(a+="\x26v\x3d"+l.VERSION);l.CLIENT&&(a+="\x26client\x3d"+l.CLIENT);l.CHANNEL&&(a+="\x26channel\x3d"+l.CHANNEL);l.LANGUAGE&&(a+="\x26language\x3d"+l.LANGUAGE);l.REGION&&(a+="\x26region\x3d"+l.REGION);return a},release:function(m){var g=function(){l.KEY=null;l.LIBRARIES=[];l.CLIENT=null;l.CHANNEL=null;l.LANGUAGE=null;l.REGION=null;l.VERSION=googleVersion;k=null;a=!1;f=[];b=[];"undefined"!==
typeof window.google&&delete window.google;"undefined"!==typeof window[l.WINDOW_CALLBACK_NAME]&&delete window[l.WINDOW_CALLBACK_NAME];null!==e&&(l.createLoader=e,e=null);null!==h&&(h.parentElement.removeChild(h),h=null);m&&m()};a?l.load(function(){g()}):g()},onLoad:function(a){b.push(a)},makeMock:function(){e=l.createLoader;l.createLoader=function(){window.google=l._googleMockApiObject;window[l.WINDOW_CALLBACK_NAME]()}}};return l})},"app/config/bookmarks":function(){define({map:!0,editable:!0,bookmarks:[{extent:{xmin:-1.548913048708616E7,
ymin:398794.4860580916,xmax:-5891085.7193757,ymax:8509680.431452557,spatialReference:{wkid:102100}},name:"USA"}]})},"app/config/find":function(){define({map:!0,zoomExtentFactor:2,queries:[{description:"Find A Public Safety Location By Name",url:"http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/PublicSafety/PublicSafetyOperationalLayers/MapServer",layerIds:[1,2,3,4,5,6,7],searchFields:["FDNAME, PDNAME","NAME","RESNAME"],minChars:2,gridColumns:[{field:"Name",label:"Name"},{field:"layerName",
label:"Layer",width:100,sortable:!1,resizable:!1}],sort:[{attribute:"Name",descending:!1}],prompt:"fdname, pdname, name or resname",selectionMode:"single"},{description:"Find Incident By Code/Description",url:"http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/PublicSafety/PublicSafetyOperationalLayers/MapServer",layerIds:[15,17,18],searchFields:["FCODE","DESCRIPTION"],minChars:4,gridColumns:[{field:"layerName",label:"Layer",width:100,sortable:!1,resizable:!1},{field:"Fcode",label:"Fcode",
width:100},{field:"Description",label:"Descr"},{field:"SORT_VALUE",visible:!1,get:function(h){return h.layerName+" "+h.feature.attributes.Fcode}}],sort:[{attribute:"SORT_VALUE",descending:!1}],prompt:"fdname, pdname, name or resname",customGridEventHandlers:[{event:".dgrid-row:click",handler:function(h){alert("You clicked a row!")}}]}],selectionSymbols:{polygon:{type:"esriSFS",style:"esriSFSSolid",color:[255,0,0,62],outline:{type:"esriSLS",style:"esriSLSSolid",color:[255,0,0,255],width:3}},point:{type:"esriSMS",
style:"esriSMSCircle",size:25,color:[255,0,0,62],angle:0,xoffset:0,yoffset:0,outline:{type:"esriSLS",style:"esriSLSSolid",color:[255,0,0,255],width:2}}},selectionMode:"extended"})},"app/config/identify":function(){define({map:!0,mapClickMode:!0,mapRightClickMenu:!0,identifyLayerInfos:!0,identifyTolerance:5,identifies:{meetupHometowns:{0:{title:"Hometowns",fieldInfos:[{fieldName:"Location",visible:!0}]}},louisvillePubSafety:{2:{title:"Police Station",fieldInfos:[{fieldName:"Name",visible:!0},{fieldName:"Address",
visible:!0},{fieldName:"Type",visible:!0},{fieldName:"Police Function",visible:!0},{fieldName:"Last Update Date",visible:!0}]},8:{title:"Traffic Camera",description:"{Description} lasted updated: {Last Update Date}",mediaInfos:[{title:"",caption:"",type:"image",value:{sourceURL:"{Location URL}",linkURL:"{Location URL}"}}]}}}})},"app/config/basemaps":function(){define([],function(){return{map:!0,mode:"agol",title:"Basemaps",basemaps:{streets:{title:"Streets"},"streets-night-vector":{title:"Streets (Night)"},
"streets-navigation-vector":{title:"Streets (Navigation)"},"streets-relief-vector":{title:"Street (Relief)"},satellite:{title:"Satellite"},hybrid:{title:"Hybrid"},topo:{title:"Topo"},terrain:{title:"Terrain"},"gray-vector":{title:"Gray"},"dark-gray-vector":{title:"Dark Gray"},oceans:{title:"Oceans"},"national-geographic":{title:"Nat Geo"},osm:{title:"Open Street Map"},LandsatShaded:{title:"Landsat Shaded",basemap:{baseMapLayers:[{url:"https://imagery.arcgisonline.com/arcgis/rest/services/LandsatGLS/LandsatShadedBasemap/ImageServer"}]}},
EarthAtNight:{title:"Earth at Night",basemap:{baseMapLayers:[{url:"https://tiles.arcgis.com/tiles/P3ePLMYs2RVChkJx/arcgis/rest/services/Earth_at_Night_WM/MapServer"}]}},DavidRumseyMap1812:{title:"David Rumsey 1812",basemap:{baseMapLayers:[{url:"http://tiles.arcgis.com/tiles/IEuSomXfi6iB7a25/arcgis/rest/services/World_Globe_1812/MapServer"}]}}}}})},"esri/layers/FeatureLayer":function(){define("require module dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/date/locale dojo/sniff dojo/io-query dojo/dom-construct dojo/i18n dojo/when dojo/promise/all ../kernel ../lang ../request ../config ../deferredUtils ../SpatialReference ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/jsonUtils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/jsonUtils ../renderers/arcadeUtils ../tasks/QueryTask ../tasks/query ../tasks/FeatureSet ../tasks/StatisticDefinition ../geometry/Extent ../geometry/jsonUtils ../geometry/normalizeUtils ../geometry/scaleUtils ./GraphicsLayer ./Field ./TimeInfo ./FeatureType ./FeatureTemplate ./FeatureEditResult ./LabelClass ./SnapshotMode ./OnDemandMode ./SelectionMode ./StreamMode ./TrackManager ./HeatmapManager dojo/i18n!../nls/jsapi require".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J,L,M,H,K,P,O,S,Q,R,aa,X,T,V,da,ga,la,Aa,ta,pa,wa,oa){var ma=x.defaults,ia=a(Q,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",reHostedFS:/(https?:)?\/\/services.*\.arcgis\.com/i,maxPointCountForAuto:4E3,maxRecordCountForAuto:2E3,maxVertexCountForAuto:25E4,generalizeForScale:4E3,_eventMap:{"add-attachment-complete":["result"],"before-apply-edits":["adds","updates","deletes"],
"delete-attachments-complete":["results"],"edits-complete":["adds","updates","deletes"],"query-attachment-infos-complete":["results"],"query-count-complete":["count"],"query-features-complete":["featureSet"],"query-ids-complete":["objectIds"],"query-related-features-complete":["featureSets"],"selection-complete":["features","method"],"update-end":["error","info"]},constructor:function(a,c){this._preventInit||this._initFeatureLayer(a,c)},_initFeatureLayer:function(a,c){this.i18n=oa;c=c||{};this.showLabels=
null!=c.showLabels?c.showLabels:!0;this._outFields=c.outFields;this._defnExpr=c.definitionExpression;this._loadCallback=c.loadCallback;var d=c._usePatch;this._usePatch=null===d||void 0===d?!0:d;this._trackIdField=c.trackIdField;this.objectIdField=c.objectIdField;this._maxOffset=null!=c.maxAllowableOffset?c.maxAllowableOffset:this.maxAllowableOffset;this.quantize=null!=c.quantize?c.quantize:!0;this._optEditable=c.editable;this._optAutoGen=c.autoGeneralize;this.editSummaryCallback=c.editSummaryCallback;
this.userId=c.userId;this.userIsAdmin=c.userIsAdmin;this.useMapTime=c.hasOwnProperty("useMapTime")?!!c.useMapTime:!0;this.source=c.source;this.gdbVersion=c.gdbVersion;this.orderByFields=c.orderByFields;this.maxPointCountForAuto=null!=c.maxPointCountForAuto?c.maxPointCountForAuto:this.maxPointCountForAuto;this.maxRecordCountForAuto=null!=c.maxRecordCountForAuto?c.maxRecordCountForAuto:this.maxRecordCountForAuto;this.maxVertexCountForAuto=null!=c.maxVertexCountForAuto?c.maxVertexCountForAuto:this.maxVertexCountForAuto;
this.generalizeForScale=null!=c.generalizeForScale?c.generalizeForScale:this.generalizeForScale;this.queryPagination=null!=c.queryPagination?c.queryPagination:this.url?this.reHostedFS.test(this.url):!1;this.multipatchOption=c.multipatchOption;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var e=ia,d=this.mode=u.isDefined(c.mode)?c.mode:e.MODE_ONDEMAND;switch(this._isStream&&(d=e.MODE_STREAM,this.mode=e.MODE_STREAM),
d){case e.MODE_SNAPSHOT:this.currentMode=e.MODE_SNAPSHOT;this._mode=new ga(this);this._isSnapshot=!0;break;case e.MODE_ONDEMAND:case e.MODE_AUTO:this.currentMode=e.MODE_ONDEMAND;this._tileWidth=c.tileWidth||512;this._tileHeight=c.tileHeight||512;this._mode=new la(this);this.latticeTiling=c.latticeTiling;break;case e.MODE_SELECTION:this.currentMode=e.MODE_SELECTION;this._mode=new Aa(this);this._isSelOnly=!0;break;case e.MODE_STREAM:this.currentMode=e.MODE_STREAM,this._mode=new ta(this),this._isStream=
!0}if(this._initLayer=b.hitch(this,this._initLayer),this._selectHandler=b.hitch(this,this._selectHandler),this._editable=!1,b.isObject(a)&&a.layerDefinition)return this._collection=!0,this.mode=this._isStream?e.MODE_STREAM:e.MODE_SNAPSHOT,this._isStream||this._outFields||(this._outFields=["*"]),this._initLayer(a),this;this._task=new J(this.url,{source:this.source,gdbVersion:this.gdbVersion});d=this._url.path;this._fserver=!1;-1!==d.search(/\/FeatureServer\//i)&&(this._fserver=!0);this.mode===e.MODE_AUTO&&
this.reHostedFS.test(this.url)&&this._queryLimit();(e=c.resourceInfo)?this._initLayer(e):(this.source&&(e={source:this.source.toJson()},this._url.query=b.mixin(this._url.query,{layer:l.toJson(e)})),this.gdbVersion&&(this._url.query=b.mixin(this._url.query,{gdbVersion:this.gdbVersion})),w({url:d,content:b.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler}));this.registerConnectEvents()},_initLayer:function(a,c){if(a||c){this._json=a;this._findCredential();
((this.credential&&this.credential.ssl||a&&a._ssl)&&(this._useSSL(),this._task._useSSL()),this.version=a.currentVersion,this.version)||(this.version="capabilities"in a||"drawingInfo"in a||"hasAttachments"in a||"htmlPopupType"in a||"relationships"in a||"timeInfo"in a||"typeIdField"in a||"types"in a?10:9.3);if(this._collection&&(this._isStream||(this.currentMode=ia.MODE_SNAPSHOT,this._mode=new ga(this)),this._isSnapshot=!0,this._featureSet=a.featureSet,this._nextId=a.nextObjectId,a=a.layerDefinition),
this.geometryType=a.geometryType,"string"!=typeof this.multipatchOption&&"esriGeometryMultiPatch"===this.geometryType&&(this.multipatchOption="xyFootprint"),a.hasOwnProperty("capabilities")){var g=this.capabilities=a.capabilities;g&&-1!==g.toLowerCase().indexOf("editing")?this._editable=!0:this._editable=!1}else this._collection||(this._editable=this._fserver);u.isDefined(this._optEditable)?(this._editable=this._optEditable,delete this._optEditable):"esriGeometryMultiPatch"===this.geometryType&&(this._editable=
!1);this._json=l.toJson(this._json);this.isEditable()?this._setMaxOffset(null):this.mode===ia.MODE_SNAPSHOT||"esriGeometryPolyline"!==this.geometryType&&"esriGeometryPolygon"!==this.geometryType&&!this.hasXYFootprint()||(this._autoGeneralize=u.isDefined(this._optAutoGen)?this._optAutoGen:this.mode===ia.MODE_ONDEMAND||this.mode===ia.MODE_AUTO,delete this._optAutoGen);var g=a.effectiveMinScale||a.minScale,f=a.effectiveMaxScale||a.maxScale;!this._hasMin&&g&&this.setMinScale(g);!this._hasMax&&f&&this.setMaxScale(f);
this.layerId=a.id;this.name=a.name;this.description=a.description;this.copyright=a.copyrightText;this.type=a.type;this.displayField=a.displayField;this.defaultDefinitionExpression=a.definitionExpression||(a.isView?a.viewDefinitionQuery:a.definitionQuery);this.fullExtent=new K(a.extent);this.initialExtent=new K(this.fullExtent.toJson());this.fullExtent.spatialReference&&(this.spatialReference=new A(this.fullExtent.spatialReference.toJson()));this.defaultVisibility=a.defaultVisibility;"esriGeometryPoint"!==
this.geometryType&&"esriGeometryMultipoint"!==this.geometryType||(this.latticeTiling=!1);this.hasM=a.hasM||!1;this.hasZ=a.hasZ||!1;this.indexedFields=a.indexedFields;this.maxRecordCount=a.maxRecordCount;this.canModifyLayer=a.canModifyLayer;this.supportsStatistics=a.supportsStatistics;this.supportsAdvancedQueries=this._collection?!1:a.supportsAdvancedQueries;this.supportsCalculate=a.supportsCalculate;this.supportsAttachmentsByUploadId=a.supportsAttachmentsByUploadId;this.supportsCoordinatesQuantization=
a.supportsCoordinatesQuantization;this.quantize=this.quantize&&this.supportsCoordinatesQuantization;this.hasLabels=a.hasLabels;this.canScaleSymbols=a.canScaleSymbols;this.supportsRollbackOnFailureParameter=this.supportsRollbackOnFailure=a.supportsRollbackOnFailure;this.syncCanReturnChanges=a.syncCanReturnChanges;this.isDataVersioned=a.isDataVersioned;this.editFieldsInfo=a.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=a.ownershipBasedAccessControlForFeatures;this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures&&
(this.creatorField=this.editFieldsInfo.creatorField);this.relationships=a.relationships;this.allowGeometryUpdates=u.isDefined(a.allowGeometryUpdates)?a.allowGeometryUpdates:!0;this.allowUpdateWithoutMValues=!!a.allowUpdateWithoutMValues;this.advancedQueryCapabilities=a.advancedQueryCapabilities||{supportsStatistics:this.supportsStatistics,supportsOrderBy:this.supportsAdvancedQueries,supportsDistinct:this.supportsAdvancedQueries};this.useStandardizedQueries=a.useStandardizedQueries;this.tileMaxRecordCount=
a.tileMaxRecordCount;this.standardMaxRecordCount=a.standardMaxRecordCount;this._setMaxOffset(this._maxOffset,!0);this._isTable="Table"===this.type;for(var n=this.fields=[],f=a.fields,g=0;g<f.length;g++)n.push(new R(f[g]));if(!this.objectIdField&&(this.objectIdField=a.objectIdField,!this.objectIdField))for(f=a.fields,g=0;g<f.length;g++)if(n=f[g],"esriFieldTypeOID"===n.type){this.objectIdField=n.name;break}if(!u.isDefined(this._nextId)){f=this.objectIdField;n=-1;if(this._collection&&f)for(var m,h=(g=
this._featureSet)&&g.features,q=h?h.length:0,g=0;q>g;g++)m=(m=h[g].attributes)&&m[f],m>n&&(n=m);this._nextId=n+1}this.globalIdField=a.globalIdField;var r;(g=this.typeIdField=a.typeIdField)&&(r=!this._getField(g)&&this._getField(g,!0),r&&(this.typeIdField=r.name));this.visibilityField=a.visibilityField;(r=a.defaultSymbol)&&(this.defaultSymbol=D.fromJson(r));var t,k,v=this.types=[];m=a.types;f=(g=this.editFieldsInfo)&&g.creatorField;n=g&&g.editorField;q=f||n;h=[];if(m)for(g=0;g<m.length;g++)t=new X(m[g]),
k=t.templates,q&&k&&k.length&&(h=h.concat(k)),v.push(t);v=a.templates;t=this.templates=[];if(v)for(g=0;g<v.length;g++)m=new T(v[g]),q&&h.push(m),t.push(m);for(g=0;g<h.length;g++)(q=b.getObject("prototype.attributes",!1,h[g]))&&(f&&delete q[f],n&&delete q[n]);(g=a.timeInfo)&&(this.timeInfo=new aa(g),this._startTimeField=g.startTimeField,this._endTimeField=g.endTimeField,this._startTimeField&&this._endTimeField&&(this._twoTimeFields=!0),this._trackIdField?g.trackIdField=this._trackIdField:this._trackIdField=
g.trackIdField);this.hasAttachments=!this._collection&&a.hasAttachments?!0:!1;this.htmlPopupType=a.htmlPopupType;var w,f=(g=a.drawingInfo)&&g.labelingInfo;if(f&&!this.labelingInfo&&(this.labelingInfo=e.map(f,function(a){return new da(a)}),this._fixLabelExpr()),!this.renderer)if(g&&g.renderer){if(w=g.renderer,this.setRenderer(G.fromJson(w)),"classBreaks"===w.type&&this.renderer.setMaxInclusive(!0),!this._collection){var x=w.type;r=[];switch(w=this.renderer,x){case "simple":r.push(w.symbol);break;case "uniqueValue":case "classBreaks":r.push(w.defaultSymbol),
r=r.concat(e.map(w.infos,function(a){return a.symbol}))}r=e.filter(r,u.isDefined);var y=this._url.path+"/images/",V=this._getToken();e.forEach(r,function(a){var c=a.url;c&&(-1===c.search(/https?\:/)&&-1===c.indexOf("data:")&&(a.url=y+c),V&&-1!==a.url.search(/https?\:/)&&(a.url+="?token\x3d"+V))})}}else if(r)m=this.types,0<m.length?(w=new F(this.defaultSymbol,this.typeIdField),e.forEach(m,function(a){w.addValue(a.id,a.symbol)})):w=new E(this.defaultSymbol),this.setRenderer(w);else if(!this._isTable){switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":x=
new z;break;case "esriGeometryPolyline":x=new B;break;case "esriGeometryPolygon":x=new C;break;default:this.hasXYFootprint()&&(x=new C)}this.setRenderer(x?new E(x):null)}x=g&&g.transparency||0;!this.hasOwnProperty("opacity")&&0<x&&(this.opacity=1-x/100);(d("ie")||7<=d("trident")||d("safari"))&&this.isEditable()&&10.02>this.version&&(this._ts=!0);this.statistics=a.statistics;this._fixRendererFields();this._updateRequiredFieldsFromLabelingInfo();this._checkFields();this._updateCaps();var L=function(){this.currentMode!==
ia.MODE_SNAPSHOT&&(this.queryPagination=!1);null==this._maxOffset||this._isFractionalOffsetAllowed()||this._setMaxOffset(this._maxOffset);this.loaded=!0;this.onLoad(this);var a=this._loadCallback;a&&(delete this._loadCallback,a(this))};this._collection?(x=this._featureSet,this._featureSet=null,this._mode._drawFeatures(new M(x)),this._fcAdded=!0,L.call(this)):this._forceIdentity(this._limitPromise?function(){var a=this;this._limitPromise.then(function(c){a._checkMode(c)});this._limitPromise.always(function(){a._limitPromise=
null;L.call(a)})}:L)}},setShowLabels:function(a){this.showLabels=a;this.onShowLabelsChange()},onShowLabelsChange:function(){},onRendererChange:function(a){this.inherited(arguments);var c=this._map;(this._ager=!!(a&&a.observationAger&&a.observationRenderer),a&&"colors"in a&&"blurRadius"in a&&"maxPixelIntensity"in a)?"esriGeometryPoint"==this.geometryType&&!this._heatmapManager&&c&&(this._heatmapManager=new wa(this),this._heatmapManager.initialize(c)):this.renderer&&this.renderer.getRendererInfo?e.some(this.renderer.rendererInfos,
function(a){return a.renderer&&"colors"in a.renderer&&"blurRadius"in a.renderer})||(this._heatmapManager=null):this._heatmapManager=null;if(this.timeInfo&&c&&(a&&(a.latestObservationRenderer||a.trackRenderer)?this._trackManager||(this._trackManager=new pa(this),this._trackManager.initialize(c),this._childLayer=this._trackManager.container,this._mode._applyTimeFilter()):this._trackManager&&!this._isStream&&(this._trackManager.destroy(),this._trackManager=null)),a){var b=[],c=e.filter([a,a.observationRenderer,
a.latestObservationRenderer,a.trackRenderer],u.isDefined),d=function(a){return null!=a&&"function"!=typeof a&&a};e.forEach(c,function(a){var c=d(a.attributeField),e=d(a.attributeField2);a=d(a.attributeField3);!1!==c&&b.push(c);!1!==e&&b.push(e);!1!==a&&b.push(a)});this._requiredFields=b}else this._requiredFields=[];this.loaded&&(this._fixRendererFields(),this._checkFields(this._requiredFields),this._collection&&(this._typesDirty=!0))},redraw:function(){this.inherited(arguments);this._trackManager&&
this._trackManager.container&&this._trackManager.container.redraw()},_evalSDRenderer:function(){this.inherited(arguments);var a=this._getRenderer();this._ager=!!(a&&a.observationAger&&a.observationRenderer);this._trackManager&&this._trackManager.container&&this._trackManager.container.setRenderer(a&&a.trackRenderer)},_setMap:function(a){var c=this.inherited(arguments),b=this._mode,d=this;return b&&b.initialize(a),this.geometryType&&this.attr("data-geometry-type",this.geometryType.replace(/esriGeometry/i,
"").toLowerCase()),this._addHandle=this.on("graphic-node-add",function(a){a=a.graphic.attributes;(a=d._selectedFeatures[a&&a[d.objectIdField]])&&a.attr("data-selected","")}),c},_unsetMap:function(a){var c=this._mode;c&&c.suspend();this._trackManager&&(this._trackManager.destroy(),this._trackManager=null);f.disconnect(this._zoomConnect);f.disconnect(this._addHandle);this._zoomConnect=this._addHandle=null;this._toggleTime(!1);this.inherited("_unsetMap",arguments)},refresh:function(){this._needsRefresh=
!1;var a=this._mode;a&&a.refresh()},hasXYFootprint:function(){return"esriGeometryMultiPatch"===this.geometryType&&"xyFootprint"===this.multipatchOption},getOutFields:function(){return e.filter(this._getOutFields(),function(a){return"*"===a||!!this._getField(a)},this)},getField:function(a){return this._getField(a,!0)},getFieldLabel:function(a){var c=this.infoTemplate,c=c&&c.getFieldInfo&&c.getFieldInfo(a);a=b.isFunction(a)?null:this.getField(a);var d=c||a,e="";return d&&(e=c&&c.label||a&&a.alias||
d.name||d.fieldName),e},getDomain:function(a,c){var b,d,g=c&&c.feature,f=g&&this.typeIdField&&g.attributes&&g.attributes[this.typeIdField];return null!=f&&e.some(this.types,function(c){return c.id==f?(b=c.domains&&c.domains[a],b&&"inherited"===b.type&&(b=this._getLayerDomain(a),d=!0),!0):!1},this),d||b||(b=this._getLayerDomain(a)),b},_getLayerDomain:function(a){var c;return e.some(this.fields,function(b){return b.name===a&&(c=b.domain),!!c}),c},getType:function(a){var c,b=a&&this.typeIdField&&a.attributes&&
a.attributes[this.typeIdField];return e.some(this.types,function(a){return a.id==b&&(c=a),!!c}),c},setEditable:function(a){if(!this._collection)return this;if(!this.loaded)return this._optEditable=a,this;var c=this._editable;return this._editable=a,this._updateCaps(),c!==a&&this.onCapabilitiesChange(),this},getEditCapabilities:function(a){var c={canCreate:!1,canUpdate:!1,canDelete:!1};if(!this.loaded||!this.isEditable())return c;var d,g=a&&a.feature;a=a&&a.userId||this.getUserId();var f=e.map(this.capabilities?
this.capabilities.toLowerCase().split(","):[],b.trim),l=(c=-1<e.indexOf(f,"editing"))&&-1<e.indexOf(f,"create"),n=c&&-1<e.indexOf(f,"update"),f=c&&-1<e.indexOf(f,"delete"),m=this.ownershipBasedAccessControlForFeatures,h=this.editFieldsInfo,q=h&&h.creatorField,h=h&&h.realm,g=(g=g&&g.attributes)&&q?g[q]:void 0,q=!!this.userIsAdmin,r=!m||q||!(!m.allowOthersToUpdate&&!m.allowUpdateToOthers),t=!m||q||!(!m.allowOthersToDelete&&!m.allowDeleteToOthers),u=!m||q||!m.hasOwnProperty("allowAnonymousToUpdate")||
m.allowAnonymousToUpdate,m=!m||q||!m.hasOwnProperty("allowAnonymousToDelete")||m.allowAnonymousToDelete;if(a&&h&&(a=a+"@"+h),(q||c&&!(l||n||f))&&(l=n=f=!0),d={canCreate:l,canUpdate:n,canDelete:f},a||(d.canUpdate=d.canUpdate&&u,d.canDelete=d.canDelete&&m),null===g)d.canUpdate=d.canUpdate&&r,d.canDelete=d.canDelete&&t;else{if(""===g)return d;if(g){if(a.toLowerCase()===g.toLowerCase())return d;d.canUpdate=d.canUpdate&&r;d.canDelete=d.canDelete&&t}}return d},getUserId:function(){var a;return this.loaded&&
(a=this.credential&&this.credential.userId||this.userId||""),a},setUserIsAdmin:function(a){this.userIsAdmin=a},setEditSummaryCallback:function(a){this.editSummaryCallback=a},getEditSummary:function(a,c,d){d=u.isDefined(d)?d:(new Date).getTime();var e="";d=this.getEditInfo(a,c,d);c=c&&c.callback||this.editSummaryCallback;if(c&&(d=c(a,d)||""),b.isString(d))e=d;else{if(d){a=d.action;c=d.userId;var g=d.timeValue,f=0;a&&f++;c&&f++;u.isDefined(g)&&f++;1<f&&(e=("edit"===a?"edit":"create")+(c?"User":"")+
(u.isDefined(g)?d.displayPattern:""))}e=e&&u.substitute(d,this.i18n.layers.FeatureLayer[e])}return e},getEditInfo:function(a,c,b){if(this.loaded){b=u.isDefined(b)?b:(new Date).getTime();var d;c=c&&c.action||"last";var e=this.editFieldsInfo,g=e&&e.creatorField,f=e&&e.creationDateField,l=e&&e.editorField,n=e&&e.editDateField,l=(a=(e&&e.realm,a&&a.attributes))&&l?a[l]:void 0,n=a&&n?a[n]:null,g=this._getEditData(a&&g?a[g]:void 0,a&&f?a[f]:null,b);b=this._getEditData(l,n,b);switch(c){case "creation":d=
g;break;case "edit":d=b;break;case "last":d=b||g}return d&&(d.action=d===b?"edit":"creation"),d}},_getEditData:function(a,c,b){var d,e,f;if(u.isDefined(c)&&(e=b-c,f=0>e?"Full":6E4>e?"Seconds":12E4>e?"Minute":36E5>e?"Minutes":72E5>e?"Hour":864E5>e?"Hours":6048E5>e?"WeekDay":"Full"),(void 0!==a||f)&&(d=d||{},d.userId=a,f))a=g.format,b=new Date(c),d.minutes=Math.floor(e/6E4),d.hours=Math.floor(e/36E5),d.weekDay=a(b,{datePattern:"EEEE",selector:"date"}),d.formattedDate=a(b,{selector:"date"}),d.formattedTime=
a(b,{selector:"time"}),d.displayPattern=f,d.timeValue=c;return d},isEditable:function(){return!(!this._editable&&!this.userIsAdmin)},isQueryable:function(){var a=e.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],b.trim);return this._isStream||this.userIsAdmin||this._collection||-1!==e.indexOf(a,"query")||-1!==e.indexOf(a,"catalog")},setMaxAllowableOffset:function(a){return this.isEditable()||this._setMaxOffset(a,!0),this},getMaxAllowableOffset:function(){var a=this._quantizationParameters?
this._quantizationParameters.tolerance:void 0;return null!=this._maxOffset?this._maxOffset:a},_setMaxOffset:function(a,c){return null==a?(delete this._maxOffset,delete this._quantizationParameters,this):(this.quantize&&this.supportsCoordinatesQuantization?("esriGeometryPolyline"===this.geometryType?this._maxOffset=a:delete this._maxOffset,this._quantizationParameters={mode:"view",originPosition:"upperLeft",tolerance:a,extent:this.fullExtent}):(this._isFractionalOffsetAllowed()&&c||(a=Math.floor(a)),
isNaN(a)||0===a?delete this._maxOffset:this._maxOffset=a,delete this._quantizationParameters),this)},_isFractionalOffsetAllowed:function(){return null==this.version||10.1<=this.version||navigator.languages&&this._isLangWithDot(navigator.languages[0])},_isLangWithDot:function(a){return a=a&&a.split("-"),a=a&&a[0]&&a[0].toLowerCase(),-1!==e.indexOf(this._langsWithDot,a)},_langsWithDot:"ar en et fr he ja ko th vi zh".split(" "),setAutoGeneralize:function(a){return this.loaded?this.isEditable()||this.mode===
ia.MODE_SNAPSHOT||"esriGeometryPolyline"!==this.geometryType&&"esriGeometryPolygon"!==this.geometryType&&!this.hasXYFootprint()||(this._autoGeneralize=a,a?(this._autoSnapshot&&(this._prevScale=null),this._updateMaxOffset()):this._setMaxOffset(null)):this._optAutoGen=a,this},setGDBVersion:function(a){return this._collection||a===this.gdbVersion||!a&&!this.gdbVersion||(this.gdbVersion=a,this._task.gdbVersion=a,this._url.query=b.mixin(this._url.query,{gdbVersion:a}),this.loaded&&(this.clearSelection(),
this._map&&this.refresh()),this.onGDBVersionChange()),this},hasAllFeatures:function(){return this._mode?this._mode.hasAllFeatures():!0},setDefinitionExpression:function(a){this._defnExpr=a;a=this._mode;return a&&a.propertyChangeHandler(1),this},getDefinitionExpression:function(){return this._defnExpr},setTimeDefinition:function(a){this._isSnapshot&&(this._timeDefn=a,(a=this._mode)&&a.propertyChangeHandler(2));return this},getTimeDefinition:function(){return this._timeDefn},setTimeOffset:function(a,
c){this._timeOffset=a;this._timeOffsetUnits=c;var b=this._mode;return b&&b.propertyChangeHandler(0),this},setUseMapTime:function(a){this.useMapTime=a;this._toggleTime(!this.suspended);(a=this._mode)&&a.propertyChangeHandler(0)},selectFeatures:function(a,c,b,d){c=c||ia.SELECTION_NEW;this._hasPartialSelectedFeatures=!1;var e;a=this._getShallowClone(a);var g=this._map,f=this,l=y._fixDfd(new m(y._dfdCanceller));if(a.outFields=this.getOutFields(),a.returnGeometry=!0,a.multipatchOption=this.multipatchOption,
g&&(a.outSpatialReference=new A(g.spatialReference.toJson())),!this._applyQueryFilters(a,!0))return e={features:[]},this._selectHandler(e,c,b,d,l),l;if(g=this._canDoClientSideQuery(a))return l._pendingDfd=t(this._doQuery(a,g)),l._pendingDfd.then(function(a){e={features:a};f._selectHandler(e,c,b,d,l)}),l;if(this._collection)return this._resolve([Error("FeatureLayer::selectFeatures - "+this.invalidParams)],null,d,l,!0),l;if(this.loaded&&!this.isQueryable())return this._resolve([Error("Layer does not support query capability.")],
null,d,l,!0),l;var n=this;this._ts&&(a._ts=(new Date).getTime());return(l._pendingDfd=this._task.execute(a)).addCallbacks(function(a){n._selectHandler(a,c,b,d,l)},function(a){n._hasPartialSelectedFeatures=!0;n._resolve([a],null,d,l,!0)}),l},getSelectedFeatures:function(){var a,c=this._selectedFeatures,b=[];for(a in c)c.hasOwnProperty(a)&&b.push(c[a]);return b},clearSelection:function(a){var c,b=this._selectedFeatures,d=this._mode;for(c in b)b.hasOwnProperty(c)&&(this._unSelectFeatureIIf(c,d),d._removeFeatureIIf(c));
return this._selectedFeatures={},this._isSelOnly&&d._applyTimeFilter(!0),a||this.onSelectionClear(),this},setSelectionSymbol:function(a){if(this._selectionSymbol=a,a){var c,b=this._selectedFeatures;for(c in b)b.hasOwnProperty(c)&&b[c].setSymbol(a)}return this},getSelectionSymbol:function(){return this._selectionSymbol},setLabelingInfo:function(a){a?(this.labelingInfo=a,this._fixLabelExpr()):delete this.labelingInfo;this._collection&&(this._typesDirty=!0);this.onLabelingInfoChange()},_fixLabelExpr:function(){var a,
c=/\[([^\[\]]+)\]/gi,b=this,d=function(a,c){var d=b._getField(c,!0);return"["+(d&&d.name||c)+"]"};e.forEach(this.labelingInfo,function(b){(a=b.labelExpression)&&(b.labelExpression=a.replace(c,d))})},_updateRequiredFieldsFromLabelingInfo:function(){var a=[];e.forEach(this.labelingInfo,function(c){var b=c.labelExpressionInfo;if(c.labelExpression){var d=/[\[\]]/gi;c=c.labelExpression.match(/\[[^\[\]]+\]/gi);(c=e.map(c,function(a){return a.replace(d,"")}))&&(a=a.concat(c))}if(b){if(b.value){var g=/[\{\}]/gi;
c=b.value.match(/\{[^\{\}]+\}/gi);(c=e.map(c,function(a){return a.replace(g,"")}))&&(a=a.concat(c))}b.expression&&(a=a.concat(I.extractFieldNames(b.expression)))}});a=e.map(a,function(a){var c=this.getField(a);return c?c.name:a},this);this._requiredFields&&(this._requiredFields=this._requiredFields.concat(a))},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(a,c,d,g,f,l){var n=l.assembly,m=l.dfd;this._applyNormalized(a,n&&n[0]);this._applyNormalized(c,n&&n[1]);this.onBeforeApplyEdits(a,
c,d);var h={},q=this.objectIdField,n={f:"json"},r=!1;if(this._collection)return l={},l.addResults=a?e.map(a,function(){return r=!0,{objectId:this._nextId++,success:!0}},this):null,l.updateResults=c?e.map(c,function(a){r=!0;var c=a.attributes[q];return h[c]=a,{objectId:c,success:!0}},this):null,l.deleteResults=d?e.map(d,function(a){return r=!0,{objectId:a.attributes[q],success:!0}},this):null,void(r?this._editHandler(l,a,h,g,f,m):this._resolve([l.addResults,l.updateResults,l.deleteResults],null,g,
m));if(a&&0<a.length&&(n.adds=this._convertFeaturesToJson(a,0,1),r=!0),c&&0<c.length){for(l=0;l<c.length;l++){var t=c[l];h[t.attributes[q]]=t}n.updates=this._convertFeaturesToJson(c,0,0,1);r=!0}if(d&&0<d.length){c=[];for(l=0;l<d.length;l++)c.push(d[l].attributes[q]);n.deletes=c.join(",");r=!0}if(r){var u=this;return w({url:this._url.path+"/applyEdits",content:b.mixin(n,this._url.query),callbackParamName:"callback",load:function(c){u._editHandler(c,a,h,g,f,m)},error:function(a){u._resolve([a],null,
f,m,!0)}},{usePost:!0})}this._resolve([],null,g,m)},queryFeatures:function(a,c,b){return this._query("execute","onQueryFeaturesComplete",a,c,b)},queryRelatedFeatures:function(a,c,b){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",a,c,b)},queryIds:function(a,c,b){return this._query("executeForIds","onQueryIdsComplete",a,c,b)},queryCount:function(a,c,b){return this._query("executeForCount","onQueryCountComplete",a,c,b)},queryExtent:function(a,c,b){return this._query("executeForExtent",
"onQueryExtentComplete",a,c,b)},queryAttachmentInfos:function(a,d,g){var f=this._url.path+"/"+a+"/attachments",l=new m(y._dfdCanceller),n=this;return l._pendingDfd=w({url:f,content:b.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(b){var g;b=b.attachmentInfos;e.forEach(b,function(b){g=c.objectToQuery({gdbVersion:n._url.query&&n._url.query.gdbVersion,layer:n._url.query&&n._url.query.layer,token:n._getToken()});b.url=f+"/"+b.id+(g?"?"+g:"");b.objectId=a});n._resolve([b],
"onQueryAttachmentInfosComplete",d,l)},error:function(a){n._resolve([a],null,g,l,!0)}}),l},addAttachment:function(a,c,b,d){return this._sendAttachment("add",a,c,b,d)},updateAttachment:function(a,c,b,d,e){return b.appendChild(n.create("input",{type:"hidden",name:"attachmentId",value:c})),this._sendAttachment("update",a,b,d,e)},deleteAttachments:function(a,c,d,g){var f=this._url.path+"/"+a+"/deleteAttachments",l=new m(y._dfdCanceller),n=this;c={f:"json",attachmentIds:c.join(",")};return l._pendingDfd=
w({url:f,content:b.mixin(c,this._url.query),callbackParamName:"callback",load:b.hitch(this,function(c){c=c.deleteAttachmentResults;c=e.map(c,function(c){c=new V(c);return c.attachmentId=c.objectId,c.objectId=a,c});n._resolve([c],"onDeleteAttachmentsComplete",d,l)}),error:function(a){n._resolve([a],null,g,l,!0)}},{usePost:!0}),l},addType:function(a){var c=this.types;if(c){if(e.some(c,function(c){return c.id==a.id?!0:!1}))return!1;c.push(a)}else this.types=[a];return this._typesDirty=!0,!0},deleteType:function(a){if(this._collection){var c=
this.types;if(c){var b=-1;if(e.some(c,function(c,d){return c.id==a?(b=d,!0):!1}),-1<b)return this._typesDirty=!0,c.splice(b,1)[0]}}},toJson:function(){var a=this._json;if(a=b.isString(a)?l.fromJson(a):b.clone(a)){var a=a.layerDefinition?a:{layerDefinition:a},c=a.layerDefinition,d=this._collection;if(d&&this._typesDirty){c.types=e.map(this.types||[],function(a){return a.toJson()});var g=this.renderer,f=this.labelingInfo,n=c.drawingInfo;!g&&!f||n||(n=c.drawingInfo={});n&&g&&-1===g.declaredClass.indexOf("TemporalRenderer")&&
(n.renderer=g.toJson());f&&(n.labelingInfo=e.map(f,function(a){return a.toJson()}))}g=null;if((!d||this._fcAdded)&&(g={geometryType:c.geometryType,features:this._convertFeaturesToJson(this.graphics,!0)}),a.featureSet=b.mixin({},a.featureSet||{},g),a.featureSet.transform)f=a.featureSet.transform,delete a.featureSet.transform,g=new M(a.featureSet),g.quantize(f),a.featureSet=g.toJson();return d&&(a.nextObjectId=this._nextId,c.capabilities=this.capabilities),a}},onSelectionComplete:function(){},onSelectionClear:function(){},
onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryExtentComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},
onLabelingInfoChange:function(){},_forceIdentity:function(a){var c,b=this,d=this._url&&this._url.path,e=d&&d.toLowerCase().indexOf("/rest/services"),g=this.editFieldsInfo,g=g&&(g.creatorField||g.editorField);(this.userIsAdmin||g)&&!this._getToken()&&-1<e&&v.id?(c=d.substring(0,e)+"/rest/info",w({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a){return a.owningSystemUrl?v.id.checkSignInStatus(a.owningSystemUrl+"/sharing"):void 0}).then(function(a){return a?v.id.getCredential(d):
void 0}).then(function(a){a&&b._findCredential()}).always(function(){a.call(b)})):a.call(this)},_checkMode:function(a){var c=this.geometryType,b=this.maxRecordCount;a=(a=a&&a.features&&a.features[0])&&a.attributes&&a.attributes.exceedslimit;this.mode===ia.MODE_AUTO&&!this.isEditable()&&0===a&&(this.queryPagination||("esriGeometryPolyline"===c||"esriGeometryPolygon"===c||"esriGeometryMultipoint"===c||this.hasXYFootprint())&&b>=this.maxRecordCountForAuto||"esriGeometryPoint"===c&&b>=this.maxPointCountForAuto)&&
(this.currentMode=ia.MODE_SNAPSHOT,this._mode=new ga(this),this._isSnapshot=this._autoSnapshot=!0)},_queryLimit:function(){var a=this,c=new m;this._limitPromise=c.promise;setTimeout(function(){var b=new L,d=new H;d.statisticType="exceedslimit";d.maxPointCount=a.maxPointCountForAuto;d.maxRecordCount=a.maxRecordCountForAuto;d.maxVertexCount=a.maxVertexCountForAuto;d.outStatisticFieldName="exceedslimit";b.outStatistics=[d];a.queryFeatures(b).promise.then(function(a){c.resolve(a)},function(a){c.reject(a)})},
0)},_updateCaps:function(){var a,c;c=this._editable;var d=b.trim(this.capabilities||""),g=e.map(d?d.split(","):[],b.trim),f=e.map(d?d.toLowerCase().split(","):[],b.trim),d=e.indexOf(f,"editing"),f={Create:e.indexOf(f,"create"),Update:e.indexOf(f,"update"),Delete:e.indexOf(f,"delete")};if(c&&-1===d)g.push("Editing");else if(!c&&-1<d){c=[d];for(a in f)-1<f[a]&&c.push(f[a]);c.sort();for(a=c.length-1;0<=a;a--)g.splice(c[a],1)}this.capabilities=g.join(",")},_counter:{value:0},_getUniqueId:function(){return this._counter.value++},
onSuspend:function(){this.inherited(arguments);this._toggleTime(!1);var a=this._mode;a&&a.suspend()},onResume:function(a){this.inherited(arguments);this._toggleTime(!0);var c=this._mode,b=this._map,d=this._getRenderer();if(a.firstOccurrence){if(this._fixRendererFields(),this._updateRequiredFieldsFromLabelingInfo(),this._checkFields(),this.clearSelection(),this.timeInfo&&!this._trackManager&&(this._trackIdField||d&&(d.latestObservationRenderer||d.trackRenderer))&&(this._trackManager=new pa(this),this._trackManager.initialize(b),
this._childLayer=this._trackManager.container),d&&"colors"in d&&"blurRadius"in d&&"maxPixelIntensity"in d&&("esriGeometryPoint"!=this.geometryType||this._heatmapManager||(this._heatmapManager=new wa(this),this._heatmapManager.initialize(b))),this._autoSnapshot&&this._autoGeneralize&&("esriGeometryPolyline"===this.geometryType||"esriGeometryPolygon"===this.geometryType||this.hasXYFootprint())&&!this.isEditable()&&null==this.getMaxAllowableOffset())d=this.generalizeForScale,this._calculatedScale=d=
this.maxScale?this.maxScale:this.minScale?Math.min(d,this.minScale):Math.min(d,S.getScale(b,this.initialExtent)),this._calcMaxOffset=b.extent.getWidth()/b.width/b.getScale()*d;this._zoomConnect=f.connect(b,"onZoomEnd",this,this._zoomEndHandler);this._updateMaxOffset();this._needsRefresh=!1;c&&c.startup()}else this._zoomEndHandler(),c&&c.resume()},_zoomEndHandler:function(){var a=this._map;this._updateMaxOffset();this._prevScale=a.getScale();!this.suspended&&this._needsRefresh&&this.refresh()},_updateMaxOffset:function(){var a=
this._map;a&&a.loaded&&this._autoGeneralize&&(this._autoSnapshot?(a=this.getMaxAllowableOffset(),this._setMaxOffset(this._getMaxOffsetForScale(),!0),this._needsRefresh||(this._needsRefresh=a!=this.getMaxAllowableOffset())):this._setMaxOffset(a.extent.getWidth()/a.width,!a.extent.spatialReference.isWebMercator()))},_getMaxOffsetForScale:function(){if(this._map){var a=this._map.getScale(),c=this._calculatedScale,b=this._calcMaxOffset,d=this._prevScale;return a>=c&&(null==d||c>d)?b:c>a&&(null==d||d>=
c)?null:this.getMaxAllowableOffset()}},_toggleTime:function(a){var c=this._map;a&&this.timeInfo&&this.useMapTime&&c?(this._mapTimeExtent=c.timeExtent,this._timeConnect||(this._timeConnect=f.connect(c,"onTimeExtentChange",this,this._timeChangeHandler))):(this._mapTimeExtent=null,f.disconnect(this._timeConnect),this._timeConnect=null)},_timeChangeHandler:function(a){this._mapTimeExtent=a;(a=this._mode)&&a.propertyChangeHandler(0)},_getOffsettedTE:function(a){var c=this._timeOffset,b=this._timeOffsetUnits;
return a&&c&&b?a.offset(-1*c,b):a},_getTimeOverlap:function(a,c){return a&&c?a.intersection(c):a||c},_getTimeFilter:function(a){var c,b=this.getTimeDefinition();if(b&&(c=this._getTimeOverlap(b,null),!c))return[!1];if(a){if(a=c?this._getTimeOverlap(a,c):a,!a)return[!1]}else a=c;return[!0,a]},_getAttributeFilter:function(a){var c=this.getDefinitionExpression();return a=a?c?"("+c+") AND ("+a+")":a:c},_applyQueryFilters:function(a,c){if(a.where=this._getAttributeFilter(a.where),a.maxAllowableOffset||
(a.maxAllowableOffset=this._maxOffset),a.quantizationParameters=this._quantizationParameters,c&&this.supportsAdvancedQueries&&(a.orderByFields=a.orderByFields||this.getOrderByFields()),this.timeInfo){var b=this._getTimeFilter(a.timeExtent);if(!b[0])return!1;a.timeExtent=b[1]}return!0},_add:function(a){var c=this._selectionSymbol,b=a.attributes,d=this.visibilityField;return c&&this._isSelOnly&&a.setSymbol(c),d&&b&&b.hasOwnProperty(d)&&a[b[d]?"show":"hide"](),this.add.apply(this,arguments)},_remove:function(){return this.remove.apply(this,
arguments)},_canDoClientSideQuery:function(a){var c,b=[],d=this._map;if((this._collection||!this._isTable&&d)&&!(a.text||a.where&&a.where!==this.getDefinitionExpression()||a.orderByFields&&a.orderByFields.length&&(c=this.getOrderByFields()||[])&&a.orderByFields.join()!==c.join()||a.outStatistics||a.returnDistinctValues)){c=this._isSnapshot;var g=this._isSelOnly,f=a.geometry;if(f){if(g||a.spatialRelationship!==L.SPATIAL_REL_INTERSECTS||"extent"!==f.type||!c&&!d.extent.contains(f))return;b.push(1)}if(d=
a.objectIds){if(!c){for(var l=d.length,n=this._mode,m=0,f=0;l>f;f++)n._getFeature(d[f])&&m++;if(m!==l)return}b.push(2)}if(this.timeInfo)if(a=a.timeExtent,d=this._mapTimeExtent,c)a&&b.push(3);else if(g){if(a)return}else if(d)if(-1!==e.indexOf(b,2))a&&b.push(3);else{if(-1===e.indexOf(b,1))return;a==d&&b.push(3)}else if(0<b.length)a&&b.push(3);else if(a)return;return 0<b.length?b:null}},_getAbsMid:function(a){return h.toAbsMid?h.toAbsMid(a):k.id.replace(/\/[^\/]*$/gi,"/")+a},_doQuery:function(a,c,d){var g=
[],f=this.objectIdField,l=this,n=new m,h=new m,q=this.graphics;if(-1!==e.indexOf(c,1)){var r,t=this.spatialIndex||this._map&&this._map.spatialIndex,u=a.geometry._normalize(null,!0);null==t&&ma.autoSpatialIndexing?r=(this._map||this).addPlugin(this._getAbsMid("../plugins/spatialIndex")).then(b.hitch(this,b.partial(this._getFromIndex,u,t)),function(a){h.resolve(b.hitch(this,b.partial(this._filterByExtent,q,u)))}):t&&(r=this._getFromIndex(u,t));r?r.then(function(a){for(var c=0;c<a.length;c++)a[c].results&&
(g=g.concat(a[c].results));h.resolve(g)}).otherwise(function(a){h.reject(a)}):h.resolve(this._filterByExtent(q,u))}else h.resolve(q);return h.then(function(b){if(g=b,-1!==e.indexOf(c,2)){var m=a.objectIds;g=e.filter(g,function(a){return-1<e.indexOf(m,a.attributes[f])})}-1!==e.indexOf(c,3)&&l.timeInfo&&(b=a.timeExtent,g=l._filterByTime(g,b.startTime,b.endTime).match);d&&(g=e.map(g,function(a){return a.attributes[f]},this));n.resolve(g)}),n},_getFromIndex:function(a,c){c=c||this.spatialIndex||this._map.spatialIndex;
a instanceof Array||(a=[a]);var b=this.id;return r(e.map(a,function(a){return c.intersects(a,b)}))},_filterByExtent:function(a,c){for(var b=[],d=0,e=a.length;e>d;d++){var g=a[d],f=g.geometry;f&&(this.normalization&&c.length?(c[0].intersects(f)||c[1].intersects(f))&&b.push(g):c.intersects(f)&&b.push(g))}return b},_filterByTime:function(a,c,b){var d,e=this._startTimeField,g=this._endTimeField;this._twoTimeFields||(d=e||g);var f,l,n,m=u.isDefined,h=[],q=[],r=a.length;if(c=c?c.getTime():-(1/0),b=b?b.getTime():
1/0,d)for(f=0;r>f;f++)l=a[f],n=l.attributes,e=n[d],e>=c&&b>=e?h.push(l):q.push(l);else for(f=0;r>f;f++)l=a[f],n=l.attributes,d=n[e],n=n[g],d=m(d)?d:-(1/0),n=m(n)?n:1/0,d>=c&&b>=d||n>=c&&b>=n||c>=d&&n>=b?h.push(l):q.push(l);return{match:h,noMatch:q}},_getSizeVariables:function(a){return a&&e.filter(a.getVisualVariablesForType("sizeInfo",!1),function(a){return!(!a.field&&!a.valueExpression)})},_needClientSideSorting:function(a){return this._collection?!(!a||!a.length):e.some(a,function(a){return!!a.valueExpression})},
_sortFeatures:function(a){var c=this.renderer,b=this._getSizeVariables(c);if(a&&1<a.length&&this._needClientSideSorting(b)){var d=b[0],e=this;a.sort(function(a,b){a._layer||(a._layer=e);b._layer||(b._layer=e);var g=c._getDataValue(a,d,"sizeInfo",null,e),f=c._getDataValue(b,d,"sizeInfo",null,e);return null==g?-1:null==f?1:f-g})}return a},_resolve:function(a,c,b,d,e){c&&this[c].apply(this,a);b&&b.apply(null,a);d&&y._resDfd(d,a,e)},_getShallowClone:function(a){var c,b=new L;for(c in a)a.hasOwnProperty(c)&&
(b[c]=a[c]);return b},_query:function(a,c,b,d,g){var f,l,n=this,h=this._map,q=new m(y._dfdCanceller),r=b;if("executeRelationshipQuery"!==a){var r=this._getShallowClone(b),u=this.getOutFields();r.outFields||(r.outFields=u);r.outFields&&r.outFields.length&&(l=-1<e.indexOf(u,"*")?!1:!e.every(r.outFields,function(a){return-1<e.indexOf(u,a)}));r.returnGeometry=b.hasOwnProperty("returnGeometry")?b.returnGeometry:!b.outStatistics;r.returnGeometry&&(r.multipatchOption=this.multipatchOption);var k;h&&(b=h&&
h.spatialReference,(h=r.outSpatialReference)?f=!h.equals(b):r.outSpatialReference=new A(b.toJson()));if(!this._applyQueryFilters(r,"execute"===a&&!r.outStatistics)){switch(a){case "execute":k=new M({features:[]});break;case "executeForIds":k=[];break;case "executeForCount":k=0;break;case "executeForExtent":k={}}return this._resolve([k],c,d,q),q}if(b="executeForExtent"!==a&&!f&&!l&&this._canDoClientSideQuery(r))return q._pendingDfd=t(this._doQuery(r,b,"executeForIds"===a||"executeForCount"===a)),q._pendingDfd.then(function(b){switch(a){case "execute":k=
new M;k.features=b;break;case "executeForIds":k=b;break;case "executeForCount":k=b.length}n._resolve([k],c,d,q)}),q}if(this._collection)return this._resolve([Error("FeatureLayer::_query - "+this.invalidParams)],null,g,q,!0),q;if(this.loaded&&!this.isQueryable())return this._resolve([Error("Layer does not support query capability.")],null,g,q,!0),q;this._ts&&(r._ts=(new Date).getTime());return(q._pendingDfd=this._task[a](r)).addCallbacks(function(b){var e=!!r.outStatistics||f||l;if("execute"===a||
"executeRelationshipQuery"===a){var g,m;if("execute"===a)for(g=b.features,m=g.length,--m;0<=m;m--){if(g[m]._layer=n,!e&&!n._isTable){var h=n._mode._getFeature(g[m].attributes[n.objectIdField]);h&&g.splice(m,1,h)}}else for(h in b)if(b.hasOwnProperty(h))for(g=b[h].features,m=g.length,--m;0<=m;m--)g[m]._layer=n}n._resolve([b],c,d,q)},function(a){n._resolve([a],null,g,q,!0)}),q},_convertFeaturesToJson:function(a,c,d,g){var f,n=[],m=this._selectionSymbol,h=this.visibilityField,q=this.objectIdField;this.loaded&&
(d||g)&&(f=e.filter(this.fields,function(a){return!1===a.editable&&(!g||a.name!==q)}));for(d=0;d<a.length;d++){var r=a[d],t={},u=r.geometry,k=r.attributes,v=r.symbol;!u||g&&this.loaded&&!this.allowGeometryUpdates||(t.geometry=u.toJson());h?(t.attributes=k=b.mixin({},k),k[h]=r.visible?1:0):k&&(t.attributes=b.mixin({},k));t.attributes&&f&&f.length&&e.forEach(f,function(a){delete t.attributes[a.name]});v&&v!==m&&(t.symbol=v.toJson());n.push(t)}return c?n:l.toJson(n)},_selectHandler:function(a,c,b,d,
e){var g;d=ia;switch(c){case d.SELECTION_NEW:this.clearSelection(!0);g=!0;break;case d.SELECTION_ADD:g=!0;break;case d.SELECTION_SUBTRACT:g=!1}var f,l;d=a.features;var n=this._mode,m=[],h=this.objectIdField;if(g)for(g=0;g<d.length;g++)f=d[g],l=f.attributes[h],f=n._addFeatureIIf(l,f),m.push(f),this._selectFeatureIIf(l,f,n);else for(g=0;g<d.length;g++)f=d[g],l=f.attributes[h],this._unSelectFeatureIIf(l,n),l=n._removeFeatureIIf(l),m.push(l||f);this._isSelOnly&&n._applyTimeFilter(!0);this._hasPartialSelectedFeatures=
!!a.exceededTransferLimit;this._resolve([m,c,a.exceededTransferLimit?{queryLimitExceeded:!0}:null],"onSelectionComplete",b,e);a.exceededTransferLimit&&this.onQueryLimitExceeded()},_selectFeatureIIf:function(a,c,b){var d=this._selectedFeatures,e=d[a];return e||(b._incRefCount(a),d[a]=c,this._isTable||(this._setSelectSymbol(c),c.attr("data-selected",""))),e||c},_unSelectFeatureIIf:function(a,c){var b=this._selectedFeatures[a];return b&&(c._decRefCount(a),delete this._selectedFeatures[a],this._isTable||
(this._setUnSelectSymbol(b),b.attr("data-selected"))),b},_isSelected:function(a){},_setSelectSymbol:function(a){var c=this._selectionSymbol;c&&!this._isSelOnly&&a.setSymbol(c)},_setUnSelectSymbol:function(a){var c=this._selectionSymbol;c&&!this._isSelOnly&&c===a.symbol&&a.setSymbol(null,!0)},_getOutFields:function(){var a=[this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._requiredFields).concat(this.dataAttributes),a=e.filter(a,
function(a,c,b){return!!a&&e.indexOf(b,a)===c}),c=b.clone(this._outFields);return c?-1!==e.indexOf(c,"*")?c:(e.forEach(a,function(a){-1===e.indexOf(c,a)&&c.push(a)}),c):a},_checkFields:function(a){var c=a||this._getOutFields();(e.forEach(c,function(a){"*"!==a&&this._getField(a)},this),a||this._isTable||this._fserver||this._collection||this._isStream)||e.some(this.fields,function(a){return a&&"esriFieldTypeGeometry"===a.type?!0:!1})},_fixFieldCase:function(a,c,d){var e,g=a&&a[c];return g&&!b.isFunction(g)&&
(e=!this._getField(g)&&this._getField(g,!0),e&&(g=a[c]=e.name),d&&d.push(g)),g},_fixRendererFields:function(){var a=this.renderer;if(this._orderBy=null,this._requiredFields=[],a&&0<this.fields.length){var c,d=[],a=e.filter([a,a.observationRenderer,a.latestObservationRenderer,a.trackRenderer],u.isDefined),g=[].concat(a);e.forEach(a,function(a){e.forEach(a.rendererInfos,function(a){a.renderer&&g.push(a.renderer)})});e.forEach(g,function(a){this._fixFieldCase(a,"attributeField",d);this._fixFieldCase(a,
"attributeField2",d);this._fixFieldCase(a,"attributeField3",d);this._fixFieldCase(a.rotationInfo,"field",d);(c=this._fixFieldCase(a.sizeInfo,"field",d))&&(this._orderBy||(this._orderBy=[c+" DESC"]));this._fixFieldCase(a.sizeInfo,"normalizationField",d);this._fixFieldCase(a.colorInfo,"field",d);this._fixFieldCase(a.colorInfo,"normalizationField",d);this._fixFieldCase(a.field,"field",d);this._fixFieldCase(a.opacityInfo,"field",d);this._fixFieldCase(a.opacityInfo,"normalizationField",d);e.forEach(a.visualVariables,
function(a){c=this._fixFieldCase(a,"field",d);"sizeInfo"===a.type&&c&&!this._orderBy&&(this._orderBy=[c+" DESC"]);this._fixFieldCase(a,"normalizationField",d)},this);var g=e.map(a.getFieldsUsedInExpressions(),function(a){var c=this.getField(a);return c?c.name:a},this);d=d.concat(g);this._orderBy||!a.addBreak||b.isFunction(a.attributeField)||!a.backgroundFillSymbol&&!this._hasSizeDiff(a)||(this._orderBy=[a.attributeField+" DESC"])},this);this._requiredFields=e.filter(d,u.isDefined)}},_hasSizeDiff:function(a){var c,
b,d=Number.MAX_VALUE,g=-Number.MAX_VALUE;return e.forEach(a.infos,function(a){if(b=a.symbol){switch(c=0,b.type){case "simplemarkersymbol":c=b.size;break;case "picturemarkersymbol":c=(b.width+b.height)/2;break;case "simplelinesymbol":case "cartographiclinesymbol":c=b.width;break;case "simplefillsymbol":case "picturefillsymbol":c=b.outline&&b.outline.width}c&&(d=Math.min(d,c),g=Math.max(g,c))}}),d!==Number.MAX_VALUE&&g!==-Number.MAX_VALUE&&1<Math.abs(g-d)},getOrderByFields:function(){var a=this.orderByFields||
this._orderBy;return this.supportsAdvancedQueries&&a?e.filter(a,function(a){return a=a.split(" ")[0],!!this._getField(a,!0)},this):null},_getField:function(a,c){var b=this.fields;if(!b||0===b.length)return null;var d;return c&&(a=a.toLowerCase()),e.some(b,function(b){var e=!1;return e=c?b&&b.name.toLowerCase()===a?!0:!1:b&&b.name===a?!0:!1,e&&(d=b),e}),d},_getDateOpts:function(){this._dtOpts||(this._dtOpts={properties:e.map(e.filter(this.fields,function(a){return!(!a||"esriFieldTypeDate"!==a.type)}),
function(a){return a.name})});return this._dtOpts},_applyNormalized:function(a,c){a&&c&&e.forEach(a,function(a,b){a&&c[b]&&a.setGeometry(c[b])})},_editHandler:function(a,c,d,g,f,l){var n,m,h,q,r;f=a.addResults;var t=a.updateResults;a=a.deleteResults;var u=this.objectIdField,k=this._mode,v=this._isTable;n=this.editFieldsInfo;var w=this.getOutFields()||[],x=n&&n.creatorField,y=n&&n.creationDateField,C=n&&n.editorField,z=n&&n.editDateField;n=n&&n.realm;-1===e.indexOf(w,"*")&&(x&&-1===e.indexOf(w,x)&&
(x=null),y&&-1===e.indexOf(w,y)&&(y=null),C&&-1===e.indexOf(w,C)&&(C=null),z&&-1===e.indexOf(w,z)&&(z=null));var w=y||z?(new Date).getTime():null,A=x||C?this.getUserId():void 0;if(A&&n&&(A=A+"@"+n),f){var D=this.globalIdField;for(n=0;n<f.length;n++)if(f[n]=new V(f[n]),!v&&(m=f[n],m.success)){h=m.objectId;q=c[n];(r=q._graphicsLayer)&&r!==this&&r.remove(q);r=q.attributes||{};r[u]=h;var B=m.globalId;D&&B&&(r[D]=B);x&&(r[x]=A);C&&(r[C]=A);y&&(r[y]=w);z&&(r[z]=w);q.setAttributes(r);k._init&&k.drawFeature(q)}}if(t)for(n=
0;n<t.length;n++)if(t[n]=new V(t[n]),!v&&(m=t[n],m.success))h=m.objectId,q=d[h],(c=k._getFeature(h))&&(c.geometry!==q.geometry&&q.geometry&&c.setGeometry(P.fromJson(q.geometry.toJson())),c.attributes!==q.attributes&&q.attributes&&c.setAttributes(b.mixin(c.attributes,q.attributes)),this._repaint(c,h)),q=c||q,r=q.attributes||{},C&&(r[C]=A),z&&(r[z]=w),q.setAttributes(r);if(a){d=[];for(n=0;n<a.length;n++)a[n]=new V(a[n]),v||(m=a[n],m.success&&(h=m.objectId,q=k._getFeature(h),q&&(this._unSelectFeatureIIf(h,
k)&&d.push(q),q._count=0,k._removeFeatureIIf(h))));0<d.length&&this.onSelectionComplete(d,ia.SELECTION_SUBTRACT)}this._resolve([f,t,a],"onEditsComplete",g,l)},_sendAttachment:function(a,c,d,e,g){var f=this;return w({url:this._url.path+"/"+c+"/"+("add"===a?"addAttachment":"updateAttachment"),form:d,content:b.mixin(this._url.query,{f:"json",token:this._getToken()||void 0}),callbackParamName:"callback.html",handleAs:"json"}).addCallback(function(b){var d="add"===a?"onAddAttachmentComplete":"onUpdateAttachmentComplete";
b=new V(b["add"===a?"addAttachmentResult":"updateAttachmentResult"]);return b.attachmentId=b.objectId,b.objectId=c,f._resolve([b],d,e),b}).addErrback(function(a){f._resolve([a],null,g,null,!0)})},_repaint:function(a,c,b){c=u.isDefined(c)?c:a.attributes[this.objectIdField];c in this._selectedFeatures&&this._selectionSymbol||a.setSymbol(a.symbol,b)},_getKind:function(a){var c=this._trackManager;return c&&c.isLatestObservation(a)?1:0}});return b.mixin(ia,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,
SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,MODE_AUTO:6,MODE_STREAM:7,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"}),O._createWrappers(ia),d("extend-esri")&&b.setObject("layers.FeatureLayer",ia,v),ia})},"esri/renderers/SimpleRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer".split(" "),function(h,k,a,f,b,e,l){h=h(l,{declaredClass:"esri.renderer.SimpleRenderer",
constructor:function(a){if(a&&!a.declaredClass){var b=a;this.symbol=(a=b.symbol)&&(a.declaredClass?a:e.fromJson(a));this.label=b.label;this.description=b.description}else this.symbol=a},getSymbol:function(a){return this.symbol},toJson:function(){var a=k.mixin(this.inherited(arguments),{type:"simple",label:this.label,description:this.description,symbol:this.symbol&&this.symbol.toJson()});return b.fixJson(a)}});return a("extend-esri")&&k.setObject("renderer.SimpleRenderer",h,f),h})},"esri/renderers/Renderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojox/gfx/_base ../kernel ../Color ./arcadeUtils".split(" "),
function(h,k,a,f,b,e,l,m){var g=Math.PI,d=1;h=h(null,{declaredClass:"esri.renderer.Renderer",constructor:function(a){if(this._cache={},a&&!a.declaredClass){if(this.rotationInfo=a.rotationInfo,!this.rotationInfo){var c=a.rotationType,b=a.rotationExpression;(c||b)&&(this.rotationInfo={type:c,expression:b})}this.setRotationInfo(this.rotationInfo);this.setSizeInfo(this._readSizeInfo(a.sizeInfo));this.setColorInfo(this._readColorInfo(a.colorInfo));this.setOpacityInfo(this._readOpacityInfo(a.transparencyInfo));
this.setVisualVariables(this._readVariables(a.visualVariables));this.setAuthoringInfo(a.authoringInfo)}this.getSymbol=k.hitch(this,this.getSymbol)},getSymbol:function(a){},_readSizeInfo:function(c){if(c){var d=c.minSize,e=c.maxSize;d&&(c.minSize="number"==typeof d?b.pt2px(d):this._readSizeInfo(d));e&&(c.maxSize="number"==typeof e?b.pt2px(e):this._readSizeInfo(e));c.stops&&a.forEach(c.stops,function(a){a.size&&"number"==typeof a.size&&(a.size=b.pt2px(a.size))})}return c},_readColorInfo:function(c){return c&&
(a.forEach(c.colors,function(a,b){k.isArray(a)&&(c.colors[b]=l.toDojoColor(a))}),a.forEach(c.stops,function(a,b){a.color&&k.isArray(a.color)&&(c.stops[b].color=l.toDojoColor(a.color))})),c},_readOpacityInfo:function(c){var b;return c&&(b=k.mixin({},c),b.transparencyValues&&(b.opacityValues=a.map(b.transparencyValues,function(a){return 1-a/100}),delete b.transparencyValues),b.stops&&(b.stops=a.map(b.stops,function(a){return a=k.mixin({},a),a.opacity=1-a.transparency/100,delete a.transparency,a}))),
b},_readVariables:function(c){return c&&(c=a.map(c,function(a){return"sizeInfo"===a.type?a=this._readSizeInfo(a):"colorInfo"===a.type?a=this._readColorInfo(a):"transparencyInfo"===a.type&&(a=this._readOpacityInfo(a),a.type="opacityInfo"),a},this)),c},setAuthoringInfo:function(a){this.authoringInfo=a},setRotationInfo:function(a){if(a=this.rotationInfo="string"==typeof a?{field:a}:a){if(a.expression&&!k.isFunction(a.expression)&&!a.field){var c=a.expression.match(this.rotationRE);c&&c[1]&&(a.field=
c[1])}a.rotationType=a.type}return this._cache.rotationInfo=this._processRotationInfo(a),this},rotationRE:/^\[([^\]]+)\]$/i,_processRotationInfo:function(a){return this._createCache(a)},getRotationAngle:function(a,b){var c=this._getVarInfo(b&&b.rotationInfo,"rotationInfo"),d=c.variable,c=this._cache[c.cacheKey],e="arithmetic"===this._getRotationType(d),g=c&&c.hasExpr,f=null;return(d.field||g)&&(f=this._getDataValue(a,d,null,c),null!=f&&(f=(f+(e?-90:0))*(e?-1:1))),f},_getRotationType:function(a){return a&&
("rotationInfo"===a.type?a.rotationType:a.type)},_getDataValue:function(a,b,d,e,g){e||(e=this._getVarInfo(b,d),b=e.variable,e=this._cache[e.cacheKey],"sizeInfo"===d&&(e=e.root));return a._getDataValue(b,e,m,g)},setVisualVariables:function(c){var b=this._cache;a.forEach(this.visualVariables,function(a,c){b.hasOwnProperty(c)&&(b[c]=null)},this);this.visualVariables=c;return a.some(c,function(a){return!!a.target})&&c.sort(function(a,c){return a.target===c.target?0:a.target?1:-1}),a.forEach(c,function(a,
c){"colorInfo"===a.type?b[c]=this._processColorInfo(a):"opacityInfo"===a.type?b[c]=this._processOpacityInfo(a):"sizeInfo"===a.type?b[c]=this._processSizeInfo(a):"rotationInfo"===a.type&&(b[c]=this._processRotationInfo(a))},this),this},getVisualVariableValues:function(c){var b,d=this.visualVariables;return d&&(b=a.map(d,function(a){var b;switch(a.type){case "sizeInfo":b=this.getSize(c,{sizeInfo:a});break;case "colorInfo":b=this.getColor(c,{colorInfo:a});break;case "opacityInfo":b=this.getOpacity(c,
{opacityInfo:a});break;case "rotationInfo":b=this.getRotationAngle(c,{rotationInfo:a})}return{variable:a,value:b}},this)),b},getFieldsUsedInExpressions:function(){var c=[];return a.forEach(this._getCacheObjects(),function(a){a.syntaxTree&&(c=c.concat(m.extractFieldNames(a.syntaxTree)))}),c.sort(),a.filter(c,function(a,b){return 0===b||c[b-1]!==a})},hasVisualVariables:function(a,b){return a?!!this.getVisualVariablesForType(a,b):!!(this.getVisualVariablesForType("sizeInfo",b)||this.getVisualVariablesForType("colorInfo",
b)||this.getVisualVariablesForType("opacityInfo",b)||this.getVisualVariablesForType("rotationInfo",b))},getVisualVariablesForType:function(c,b){var d,e=this.visualVariables;return!b&&this[c]?("rotationInfo"===c&&(this[c].rotationType=this[c].type),d=[this[c]]):e&&(d=a.filter(e,function(a){return a.type===c&&("string"==typeof b?a.target===b:!1===b?!a.target:!0)}),d&&0===d.length&&(d=void 0)),d},setSizeInfo:function(a){return this.sizeInfo=this.proportionalSymbolInfo=a,this._cache.sizeInfo=this._processSizeInfo(a),
this},_processSizeInfo:function(a){return a&&{root:this._createCache(a),minSize:this._createCache(a.minSize),maxSize:this._createCache(a.maxSize)}},_convertExpressionToArcade:function(a){a&&a.expression&&(a.valueExpression="$view.scale")},_getVarInfo:function(c,b){var d;return c&&c.type===b?(d=a.indexOf(this.visualVariables,c),c=this.visualVariables[d]):(d=b,c=this[b]),{variable:c,cacheKey:d}},setProportionalSymbolInfo:function(a){return this.setSizeInfo(a),this},getSize:function(a,b){var c=this._getVarInfo(b&&
b.sizeInfo,"sizeInfo"),d=c.variable,c=this._cache[c.cacheKey],e=null;if(d)var g=d.minSize,e=d.maxSize,g="object"==typeof g&&g?this._getSize(a,g,c&&c.minSize,b):g,e="object"==typeof e&&e?this._getSize(a,e,c&&c.maxSize,b):e,e=this._getSize(a,d,c&&c.root,b,[g,e]);return e},_getSize:function(a,b,d,e,f){var c=b.stops,l=0,n=d&&d.hasExpr,m=d&&d.ipData,h=d&&d.isScaleDriven,q="object"==typeof a&&!!a,r="number"==typeof a?a:null;if(b.field||h||n){var t,k=e&&e.scale,n=f?f[0]:b.minSize;f=f?f[1]:b.maxSize;var D=
b.minDataValue,E=b.maxDataValue,F=b.valueUnit||"unknown",G=b.valueRepresentation,I=b.scaleBy,J=e&&e.shape;if(h?r=k:"number"!=typeof r&&q&&(r=this._getDataValue(a,b,null,d)),!this._isValidNumber(r))return null;if(c){var L,M;t=this._lookupData(r,m);r=t[0];n=t[1];r===n?l=c[r].size:(L=c[r].size,M=c[n].size,l=L+(M-L)*t[2])}else null!=n&&null!=f&&null!=D&&null!=E?D>=r?l=n:r>=E?l=f:(t=(r-D)/(E-D),"area"===I&&J)?(c=(l="circle"===J)?g*Math.pow(n/2,2):n*n,c+=t*((l?g*Math.pow(f/2,2):f*f)-c),l=l?2*Math.sqrt(c/
g):Math.sqrt(c)):l=n+t*(f-n):"unknown"===F?null!=n&&null!=D&&(n&&D?(t=r/D,l="circle"===J?2*Math.sqrt(t*Math.pow(n/2,2)):"square"===J||"diamond"===J||"image"===J?Math.sqrt(t*Math.pow(n,2)):t*n):l=r+(n||D),l=n>l?n:l,null!=f&&l>f&&(l=f)):(c=(e&&e.resolution?e.resolution:1)*this._meterIn[F],"area"===G?(l=Math.sqrt(r/g)/c,l*=2):(l=r/c,("radius"===G||"distance"===G)&&(l*=2)),null!=n&&n>l&&(l=n),null!=f&&l>f&&(l=f))}else l=c&&c[0]&&c[0].size,null==l&&(l=b.minSize);return l=isNaN(l)?0:l},getSizeRangeAtScale:function(a,
b){var c,d=this._getVarInfo(a,"sizeInfo"),e=this._cache[d.cacheKey],g={scale:b};if(a=d.variable,a&&b){var f,l,d=a.minSize,n=a.maxSize,m=a.stops;if(m&&m.length?(f=m[0].size,l=m[m.length-1].size):(f="object"==typeof d&&d?this._getSize({},d,e&&e.minSize,g):d,l="object"==typeof n&&n?this._getSize({},n,e&&e.maxSize,g):n),null!=f||null!=l)f>l&&(f=l=f),c={minSize:f,maxSize:l}}return c},setColorInfo:function(a){return this.colorInfo=a,this._cache.colorInfo=this._processColorInfo(a),this},prepareForViewChange:function(){a.forEach(this._getCacheObjects(),
function(a){(a.dependsOnView||a.isJSFunc)&&(a.version=d++)})},_viewScaleRE:/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,_createCache:function(a){var c=a&&a.valueExpression,b=m.createSyntaxTree(c),e=m.createFunction(b),g=!(!a||!a.expression)||this._viewScaleRE.test(c);return{ipData:this._interpolateData(a),hasExpr:!!c,compiledFunc:e,syntaxTree:b,isScaleDriven:g,dependsOnView:b?m.dependsOnView(b):!1,isJSFunc:k.isFunction(a&&a.field),version:d++}},_getCacheObjects:function(a){var c;a=a||this._cache;var b=
[];for(c in a){var d=a[c];a.hasOwnProperty(c)&&d&&"object"==typeof d&&(d.hasOwnProperty("version")?b.push(d):b=b.concat(this._getCacheObjects(d)))}return b},_processColorInfo:function(c){return c&&(a.forEach(c.colors,function(a,b){k.isArray(a)&&(c.colors[b]=new l(a))}),a.forEach(c.stops,function(a,b){a.color&&k.isArray(a.color)&&(c.stops[b].color=new l(a.color))})),this._createCache(c)},getColor:function(a,b){var c=this._getVarInfo(b&&b.colorInfo,"colorInfo");return this._getColorComponent(a,c.variable,
this._cache[c.cacheKey])},setOpacityInfo:function(a){return this.opacityInfo=a,this._cache.opacityInfo=this._processOpacityInfo(a),this},_processOpacityInfo:function(a){return this._createCache(a)},getOpacity:function(a,b){var c=this._getVarInfo(b&&b.opacityInfo,"opacityInfo");return this._getColorComponent(a,c.variable,this._cache[c.cacheKey],!0)},_getColorComponent:function(a,b,d,e,g){var c,f="number"==typeof a?a:null,l=d&&d.hasExpr,n=d&&d.ipData;b&&b.field||l?("number"!=typeof f&&"object"==typeof a&&
a&&(f=this._getDataValue(a,b,null,d)),this._isValidNumber(f)||(f=null),null!=f&&(c=e?this._getOpacity(f,b,n):this._getColor(f,b,n))):b&&(a=b.stops,e?(c=a&&a[0]&&a[0].opacity,null==c&&(c=b.opacityValues&&b.opacityValues[0])):c=a&&a[0]&&a[0].color||b.colors&&b.colors[0]);return g&&(g.data=f,g.value=c),g||c},_isValidNumber:function(a){return"number"==typeof a&&!isNaN(a)&&a!==1/0&&a!==-(1/0)},_interpolateData:function(c){var b;if(c)if(c.colors||c.opacityValues){var d=(c.colors||c.opacityValues).length,
e=c.minDataValue,g=(c.maxDataValue-e)/(d-1);b=[];for(c=0;d>c;c++)b[c]=e+c*g}else c.stops&&(b=a.map(c.stops,function(a){return a.value}));return b},_getOpacity:function(a,b,d){var c;a=this._lookupData(a,d);if(b=b||this.opacityInfo,a){var e,g;d=a[0];var f=a[1];d===f?c=this._getOpacValue(b,d):(e=this._getOpacValue(b,d),g=this._getOpacValue(b,f),c=e+(g-e)*a[2])}return c},_getOpacValue:function(a,b){return a.opacityValues?a.opacityValues[b]:a.stops[b].opacity},_getColor:function(a,b,d){var c;a=this._lookupData(a,
d);if(b=b||this.colorInfo,a)c=a[0],d=a[1],c=c===d?this._getColorObj(b,c):l.blendColors(this._getColorObj(b,c),this._getColorObj(b,d),a[2]);return c},_getColorObj:function(a,b){return a.colors?a.colors[b]:a.stops[b].color},_lookupData:function(c,b){var d;if(b){var e=0,g=b.length-1;a.some(b,function(a,b){return a>c?(g=b,!0):(e=b,!1)});d=[e,g,(c-b[e])/(b[g]-b[e])]}return d},_meterIn:{inches:1/.0254,feet:1/.3048,yards:1/.9144,miles:1/1609.344,"nautical-miles":1/1852,millimeters:1E3,centimeters:100,decimeters:10,
meters:1,kilometers:.001,"decimal-degrees":180/20015077},_writeSizeInfo:function(c){if(c){c=k.mixin({},c);this._convertExpressionToArcade(c);var d=c.minSize,e=c.maxSize;d&&(c.minSize="number"==typeof d?b.px2pt(d):this._writeSizeInfo(d));e&&(c.maxSize="number"==typeof e?b.px2pt(e):this._writeSizeInfo(e));(d=c.legendOptions)&&(c.legendOptions=k.mixin({},d),d=d.customValues,d&&(c.legendOptions.customValues=d.slice(0)));c.stops&&(c.stops=a.map(c.stops,function(a){return a=k.mixin({},a),a.size&&"number"==
typeof a.size&&(a.size=b.px2pt(a.size)),a}))}return c},_writeColorInfo:function(c){return c&&(c=k.mixin({},c),c.colors&&(c.colors=a.map(c.colors,function(a){return l.toJsonColor(a)})),c.stops&&(c.stops=a.map(c.stops,function(a){return a=k.mixin({},a),a.color&&(a.color=l.toJsonColor(a.color)),a})),c.legendOptions&&(c.legendOptions=k.mixin({},c.legendOptions))),c},_writeOpacityInfo:function(c){var b;return c&&(b=k.mixin({},c),b.opacityValues&&(b.transparencyValues=a.map(b.opacityValues,function(a){return 100*
(1-a)}),delete b.opacityValues),b.stops&&(b.stops=a.map(b.stops,function(a){return a=k.mixin({},a),a.transparency=100*(1-a.opacity),delete a.opacity,a})),b.legendOptions&&(b.legendOptions=k.mixin({},b.legendOptions))),b},toJson:function(){var c,b=this.visualVariables,d=k.clone(this.authoringInfo),e=this.getVisualVariablesForType("rotationInfo",!1),g=(e=e&&e[0])&&e.field;return e&&e===this.rotationInfo&&(c=e.expression||g&&(k.isFunction(g)?g:"["+g+"]")),b&&(b=a.map(b,function(a){return"sizeInfo"===
a.type?a=this._writeSizeInfo(a):"colorInfo"===a.type?a=this._writeColorInfo(a):"opacityInfo"===a.type?(a=this._writeOpacityInfo(a),a.type="transparencyInfo"):"rotationInfo"===a.type&&(a=k.mixin({},a)),a},this)),d&&a.forEach(d.visualVariables,function(a){"opacityInfo"===a.type&&(a.type="transparencyInfo")}),{rotationType:c&&(this._getRotationType(e)||"geographic"),rotationExpression:c,colorInfo:this._writeColorInfo(this.colorInfo),transparencyInfo:this._writeOpacityInfo(this.opacityInfo),sizeInfo:this._writeSizeInfo(this.sizeInfo),
visualVariables:b,authoringInfo:d}}});return f("extend-esri")&&k.setObject("renderer.Renderer",h,e),h})},"esri/renderers/arcadeUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../kernel","../arcade/arcade"],function(h,k,a,f,b){var e={vars:{$feature:"any",$view:"any"}},l=/^\$feature\./i,m={createSyntaxTree:function(a,d){d=d||h.clone(e);var c;try{c=a?b.parseScript(a,d):null}catch(n){c=null}return c},createFunction:function(a,d){d=d||h.clone(e);var c,g="string"==typeof a?m.createSyntaxTree(a,
d):a;try{c=g?b.compileScript(g,d):null}catch(q){c=null}return c},createExecContext:function(a,d){return{vars:{$feature:b.constructFeature(a),$view:d}}},evalSyntaxTree:function(a,d){return b.executeScript(a,d,-1)},executeFunction:function(a,b){return a?a(b,-1):null},extractFieldNames:function(a,d){var c="string"==typeof a?m.createSyntaxTree(a,d):a,c=b.extractFieldLiterals(c),e=[];return k.forEach(c,function(a){l.test(a)&&(a=a.replace(l,""),e.push(a))}),e.sort(),k.filter(e,function(a,c){return 0===
c||e[c-1]!==a})},dependsOnView:function(a){return b.referencesMember(a,"$view")}};return a("extend-esri")&&h.setObject("renderer.arcadeUtils",m,f),m})},"esri/arcade/arcade":function(){define("require exports ./arcadeRuntime ./parser ./Feature ./arcadeCompiler dojo/has".split(" "),function(h,k,a,f,b,e,l){k.compileScript=function(b,g){return l("csp-restrictions")?function(d,c){return a.executeScript(b,d,c)}:e.compileScript(b,g)};k.constructFeature=function(a){return b.fromFeature(a)};k.parseScript=
function(a){return f.parseScript(a)};k.validateScript=function(a,b){return f.validateScript(a,b,"simple")};k.scriptCheck=function(a,b,d){return f.scriptCheck(a,b,d,"full")};k.parseAndExecuteScript=function(b,e,d){return a.executeScript(f.parseScript(b),e,d)};k.executeScript=function(b,e,d){return a.executeScript(b,e,d)};k.referencesMember=function(b,e){return a.referencesMember(b,e)};k.referencesFunction=function(b,e){return a.referencesFunction(b,e)};k.extractFieldLiterals=function(a,b){return void 0===
b&&(b=!1),f.extractFieldLiterals(a,b)}})},"esri/arcade/arcadeRuntime":function(){define("require exports ../geometry/Polygon ../graphic ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./FunctionWrapper ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),function(h,k,a,f,b,e,l,
m,g,d,c,n,q,t,r,v,u,w,x,y,A,z){function B(a,c){for(var b=[],d=0;d<c.arguments.length;d++)b.push(D(a,c.arguments[d]));return b}function C(a,c,b){try{return b(a,c,B(a,c))}catch(la){throw la;}}function D(a,b){try{switch(b.type){case "EmptyStatement":return d.voidOperation;case "VariableDeclarator":var e=null===b.init?null:D(a,b.init);e===d.voidOperation&&(e=null);var g=b.id.name.toLowerCase();return null!==a.localScope?a.localScope[g]={value:e,valueset:!0,node:b.init}:a.globalScope[g]={value:e,valueset:!0,
node:b.init},d.voidOperation;case "VariableDeclaration":for(var f=0;f<b.declarations.length;f++)D(a,b.declarations[f]);return d.voidOperation;case "BlockStatement":var l;a:{for(var m=d.voidOperation,f=0;f<b.body.length;f++)if(m=D(a,b.body[f]),m instanceof d.ReturnResult||m===d.breakResult||m===d.continueResult){l=m;break a}l=m}return l;case "FunctionDeclaration":var h=b.id.name.toLowerCase();return a.globalScope[h]={valueset:!0,node:null,value:new t(b,a)},d.voidOperation;case "ReturnStatement":var r;
if(null===b.argument)r=new d.ReturnResult(d.voidOperation);else{var k=D(a,b.argument);r=new d.ReturnResult(k)}return r;case "IfStatement":var u;if("AssignmentExpression"===b.test.type||"UpdateExpression"===b.test.type)throw Error(c.nodeErrorMessage(b.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var v=D(a,b.test);if(!0===v)u=D(a,b.consequent);else if(!1===v)u=null!==b.alternate?D(a,b.alternate):d.voidOperation;else throw Error(c.nodeErrorMessage(b,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));
return u;case "ExpressionStatement":var w;if("AssignmentExpression"===b.expression.type||"UpdateExpression"===b.expression.type)w=D(a,b.expression);else{var x=D(a,b.expression);w=x===d.voidOperation?d.voidOperation:new d.ImplicitResult(x)}return w;case "AssignmentExpression":var y;var C=D(a,b.right),f=null,z="";if("MemberExpression"===b.left.type){if(f=D(a,b.left.object),z=!0===b.left.computed?D(a,b.left.property):b.left.property.name,d.isArray(f)){if(!d.isNumber(z))throw Error("Invalid Parameter");
if(0>z&&(z=f.length+z),0>z||z>f.length)throw Error("Assignment outside of array bounds");if(z===f.length&&"\x3d"!==b.operator)throw Error("Invalid Parameter");f[z]=F(C,b.operator,f[z],b)}else{if(f instanceof n){if(!1===d.isString(z))throw Error("Dictionary accessor must be a string");}else{if(!(f instanceof q))throw d.isImmutableArray(f)?Error("Array is Immutable"):Error("Invalid Parameter");if(!1===d.isString(z))throw Error("Feature accessor must be a string");}if(!0===f.hasField(z))f.setField(z,
F(C,b.operator,f.field(z),b));else{if("\x3d"!==b.operator)throw Error("Invalid Parameter");f.setField(z,F(C,b.operator,null,b))}}y=d.voidOperation}else if(f=b.left.name.toLowerCase(),null!==a.localScope&&void 0!==a.localScope[f])y=(a.localScope[f]={value:F(C,b.operator,a.localScope[f].value,b),valueset:!0,node:b.right},d.voidOperation);else if(void 0!==a.globalScope[f])y=(a.globalScope[f]={value:F(C,b.operator,a.globalScope[f].value,b),valueset:!0,node:b.right},d.voidOperation);else throw Error("Variable not recognised");
return y;case "UpdateExpression":var A,f=null;y="";if("MemberExpression"===b.argument.type){if(f=D(a,b.argument.object),y=!0===b.argument.computed?D(a,b.argument.property):b.argument.property.name,d.isArray(f)){if(!d.isNumber(y))throw Error("Invalid Parameter");if(0>y&&(y=f.length+y),0>y||y>=f.length)throw Error("Assignment outside of array bounds");A=d.toNumber(f[y]);f[y]="++"===b.operator?A+1:A-1}else{if(f instanceof n){if(!1===d.isString(y))throw Error("Dictionary accessor must be a string");}else{if(!(f instanceof
q))throw d.isImmutableArray(f)?Error("Array is Immutable"):Error("Invalid Parameter");if(!1===d.isString(y))throw Error("Feature accessor must be a string");}if(!0!==f.hasField(y))throw Error("Invalid Parameter");A=d.toNumber(f.field(y));f.setField(y,"++"===b.operator?A+1:A-1)}z=!1===b.prefix?A:"++"===b.operator?A+1:A-1}else if(f=b.argument.name.toLowerCase(),null!==a.localScope&&void 0!==a.localScope[f])z=(A=d.toNumber(a.localScope[f].value),a.localScope[f]={value:"++"===b.operator?A+1:A-1,valueset:!0,
node:b},!1===b.prefix?A:"++"===b.operator?A+1:A-1);else if(void 0!==a.globalScope[f])z=(A=d.toNumber(a.globalScope[f].value),a.globalScope[f]={value:"++"===b.operator?A+1:A-1,valueset:!0,node:b},!1===b.prefix?A:"++"===b.operator?A+1:A-1);else throw Error("Variable not recognised");return z;case "BreakStatement":return d.breakResult;case "ContinueStatement":return d.continueResult;case "ForStatement":null!==b.init&&D(a,b.init);f={testResult:!0,lastAction:d.voidOperation};do a:{y=a;C=b;z=f;if(null!==
C.test){if(z.testResult=D(y,C.test),!1===z.testResult)break a;if(!0!==z.testResult)throw Error(c.nodeErrorMessage(C,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));}z.lastAction=D(y,C.body);z.lastAction===d.breakResult?z.testResult=!1:z.lastAction instanceof d.ReturnResult?z.testResult=!1:null!==C.update&&D(y,C.update)}while(!0===f.testResult);return f.lastAction instanceof d.ReturnResult?f.lastAction:d.voidOperation;case "ForInStatement":return E(a,b);case "Identifier":var B;var V;try{var da=b.name.toLowerCase();
if(null!==a.localScope&&void 0!==a.localScope[da])B=(V=a.localScope[da],!0===V.valueset?V.value:(V.value=D(a,V.node),V.valueset=!0,V.value));else if(void 0!==a.globalScope[da])B=(V=a.globalScope[da],!0===V.valueset?V.value:(V.value=D(a,V.node),V.valueset=!0,V.value));else throw Error(c.nodeErrorMessage(b,"RUNTIME","VARIABLENOTFOUND"));}catch(va){throw va;}return B;case "MemberExpression":return I(a,b);case "Literal":return b.value;case "ThisExpression":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));
case "CallExpression":return M(a,b);case "UnaryExpression":return J(a,b);case "BinaryExpression":return L(a,b);case "LogicalExpression":var G;a:try{if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)throw Error(c.nodeErrorMessage(b.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===b.right.type||"UpdateExpression"===b.right.type)throw Error(c.nodeErrorMessage(b.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var O=[D(a,b.left),D(a,b.right)],
K=O[0],H=O[1];if(!d.isBoolean(K)||!d.isBoolean(H))throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYBOOLEAN"));switch(b.operator){case "||":G=K||H;break a;case "\x26\x26":G=K&&H;break a;default:throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYORORAND"));}}catch(va){throw va;}return G;case "ConditionalExpression":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{for(f=[],y=0;y<b.elements.length;y++){var P=D(a,b.elements[y]);if(d.isFunctionParameter(P))throw Error(c.nodeErrorMessage(b,
"RUNTIME","FUNCTIONCONTEXTILLEGAL"));P===d.voidOperation?f.push(null):f.push(P)}}catch(va){throw va;}return f;case "ObjectExpression":f={};for(y=0;y<b.properties.length;y++){var S=D(a,b.properties[y]);if(d.isFunctionParameter(S.value))throw Error("Illegal Argument");if(!1===d.isString(S.key))throw Error("Illegal Argument");S.value===d.voidOperation?f[S.key.toString()]=null:f[S.key.toString()]=S.value}var Y=new n(f);return Y.immutable=!1,Y;case "Property":return{key:"Identifier"===b.key.type?b.key.name:
D(a,b.key),value:D(a,b.value)};case "Array":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));default:throw Error(c.nodeErrorMessage(b,"RUNTIME","UNREOGNISED"));}}catch(va){throw va;}}function E(a,b){var e=D(a,b.right);"VariableDeclaration"===b.left.type&&D(a,b.left);var g=null,f="VariableDeclaration"===b.left.type?b.left.declarations[0].id.name:b.left.name;if(null!==a.localScope&&void 0!==a.localScope[f]&&(g=a.localScope[f]),null===g&&void 0!==a.globalScope[f]&&(g=a.globalScope[f]),null===
g)throw Error(c.nodeErrorMessage(b,"RUNTIME","VARIABLENOTDECLARED"));if(d.isArray(e)||d.isString(e)){for(var e=e.length,l=0;e>l;l++){g.value=l;f=D(a,b.body);if(f===d.breakResult)break;if(f instanceof d.ReturnResult)return f}return d.voidOperation}if(d.isImmutableArray(e)){for(l=0;l<e.length();l++){g.value=l;f=D(a,b.body);if(f===d.breakResult)break;if(f instanceof d.ReturnResult)return f}return d.voidOperation}if(!(e instanceof n||e instanceof q))return d.voidOperation;e=e.keys();for(l=0;l<e.length;l++){g.value=
e[l];f=D(a,b.body);if(f===d.breakResult)break;if(f instanceof d.ReturnResult)return f}}function F(a,b,e,g){switch(b){case "\x3d":return a===d.voidOperation?null:a;case "/\x3d":return d.toNumber(e)/d.toNumber(a);case "*\x3d":return d.toNumber(e)*d.toNumber(a);case "-\x3d":return d.toNumber(e)-d.toNumber(a);case "+\x3d":return d.isString(e)||d.isString(a)?d.toString(e)+d.toString(a):d.toNumber(e)+d.toNumber(a);case "%\x3d":return d.toNumber(e)%d.toNumber(a);default:throw Error(c.nodeErrorMessage(g,
"RUNTIME","OPERATORNOTRECOGNISED"));}}function G(a,b,e,g){switch(b=b.toLowerCase()){case "hasz":return a=a.hasZ,void 0===a?!1:a;case "hasm":return a=a.hasM,void 0===a?!1:a;case "spatialreference":return b=a.spatialReference._arcadeCacheId,void 0===b&&(e=!0,Object.freeze&&Object.isFrozen(a.spatialReference)&&(e=!1),e&&(X++,a.spatialReference._arcadeCacheId=X,b=X)),a=new n({wkt:a.spatialReference.wkt,wkid:a.spatialReference.wkid}),void 0!==b&&(a._arcadeCacheId="SPREF"+b.toString()),a}switch(a.type){case "extent":switch(b){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return a=
a[b],void 0!==a?a:null;case "type":return"Extent"}break;case "polygon":switch(b){case "rings":return b=d.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(X++,b=X,d.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new y(a.rings,a.spatialReference,!0===a.hasZ,!0===a.hasM,b);case "type":return"Polygon"}break;case "point":switch(b){case "x":case "y":case "z":case "m":return void 0!==a[b]?a[b]:null;case "type":return"Point"}break;case "polyline":switch(b){case "paths":return b=
d.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(X++,b=X,d.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new y(a.paths,a.spatialReference,!0===a.hasZ,!0===a.hasM,b);case "type":return"Polyline"}break;case "multipoint":switch(b){case "points":return b=d.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(X++,b=X,d.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new A(a.points,a.spatialReference,
!0===a.hasZ,!0===a.hasM,b,1);case "type":return"Multipoint"}}throw Error(c.nodeErrorMessage(g,"RUNTIME","PROPERTYNOTFOUND"));}function I(a,b){try{var e=D(a,b.object);if(null===e)throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));if(!1===b.computed){if(e instanceof n||e instanceof q)return e.field(b.property.name);if(e instanceof z)return G(e,b.property.name,a,b);throw Error(c.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));}var g=D(a,b.property);if(e instanceof n||e instanceof q){if(d.isString(g))return e.field(g);
throw Error(c.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));}if(e instanceof z){if(d.isString(g))return G(e,g,a,b);throw Error(c.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));}if(d.isArray(e)){if(d.isNumber(g)&&isFinite(g)&&Math.floor(g)===g){if(0>g&&(g=e.length+g),g>=e.length||0>g)throw Error(c.nodeErrorMessage(b,"RUNTIME","OUTOFBOUNDS"));return e[g]}throw Error(c.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));}if(d.isString(e)){if(d.isNumber(g)&&isFinite(g)&&Math.floor(g)===g){if(0>g&&(g=e.length+g),
g>=e.length||0>g)throw Error(c.nodeErrorMessage(b,"RUNTIME","OUTOFBOUNDS"));return e[g]}throw Error(c.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));}if(d.isImmutableArray(e)&&d.isNumber(g)&&isFinite(g)&&Math.floor(g)===g){if(0>g&&(g=e.length()+g),g>=e.length()||0>g)throw Error(c.nodeErrorMessage(b,"RUNTIME","OUTOFBOUNDS"));return e.get(g)}throw Error(c.nodeErrorMessage(b,"RUNTIME","INVALIDTYPE"));}catch(Aa){throw Aa;}}function J(a,b){try{var e=D(a,b.argument);if(d.isBoolean(e)){if("!"===b.operator)return!e;
if("-"===b.operator)return-1*d.toNumber(e);if("+"===b.operator)return 1*d.toNumber(e);throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===b.operator)return-1*d.toNumber(e);if("+"===b.operator)return 1*d.toNumber(e);throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}catch(la){throw la;}}function L(a,b){try{var e=[D(a,b.left),D(a,b.right)],g=e[0],f=e[1];switch(b.operator){case "\x3d\x3d":return d.equalityTest(g,f);case "\x3d":return d.equalityTest(g,
f);case "!\x3d":return!d.equalityTest(g,f);case "\x3c":return d.greaterThanLessThan(g,f,b.operator);case "\x3e":return d.greaterThanLessThan(g,f,b.operator);case "\x3c\x3d":return d.greaterThanLessThan(g,f,b.operator);case "\x3e\x3d":return d.greaterThanLessThan(g,f,b.operator);case "+":return d.isString(g)||d.isString(f)?d.toString(g)+d.toString(f):d.toNumber(g)+d.toNumber(f);case "-":return d.toNumber(g)-d.toNumber(f);case "*":return d.toNumber(g)*d.toNumber(f);case "/":return d.toNumber(g)/d.toNumber(f);
case "%":return d.toNumber(g)%d.toNumber(f);default:throw Error(c.nodeErrorMessage(b,"RUNTIME","OPERATORNOTRECOGNISED"));}}catch(ta){throw ta;}}function M(a,b){try{if("Identifier"!==b.callee.type)throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYNODESSUPPORTED"));if(null!==a.localScope&&void 0!==a.localScope[b.callee.name.toLowerCase()]){var e=a.localScope[b.callee.name.toLowerCase()];if(e.value instanceof d.NativeFunction)return e.value.fn(a,b);if(e.value instanceof t)return Q(a,b,e.value.definition);
throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTAFUNCTION"));}if(void 0!==a.globalScope[b.callee.name.toLowerCase()]){e=a.globalScope[b.callee.name.toLowerCase()];if(e.value instanceof d.NativeFunction)return e.value.fn(a,b);if(e.value instanceof t)return Q(a,b,e.value.definition);throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTAFUNCTION"));}throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));}catch(la){throw la;}}function H(c){return null==c?"":d.isArray(c)?"Array":d.isImmutableArray(c)?"Array":
d.isDate(c)?"Date":d.isString(c)?"String":d.isBoolean(c)?"Boolean":d.isNumber(c)?"Number":c instanceof n?"Dictionary":c instanceof q?"Feature":c instanceof e?"Point":c instanceof a?"Polygon":c instanceof b?"Polyline":c instanceof m?"Multipoint":c instanceof l?"Extent":d.isFunctionParameter(c)?"Function":c===d.voidOperation?"":"number"==typeof c&&isNaN(c)?"Number":"Unrecognised Type"}function K(a,c,b,e){try{var g=D(a,c.arguments[b]);if(d.equalityTest(g,e))return D(a,c.arguments[b+1]);var f=c.arguments.length-
b;return 1===f?D(a,c.arguments[b]):2===f?null:K(a,c,b+2,e)}catch(pa){throw pa;}}function P(a,c,b,e){try{if(!0===e)return D(a,c.arguments[b+1]);if(3===c.arguments.length-b)return D(a,c.arguments[b+2]);var g=D(a,c.arguments[b+2]);if(!1===d.isBoolean(g))throw Error("WHEN needs boolean test conditions");return P(a,c,b+2,g)}catch(ta){throw ta;}}function O(a,c){var b=a.length,d=Math.floor(b/2),e;if(0===b)e=[];else if(1===b)e=[a[0]];else{e=O(a.slice(0,d),c);b=O(a.slice(d,b),c);for(d=[];0<e.length||0<b.length;)if(0<
e.length&&0<b.length){var g=c(e[0],b[0]);isNaN(g)&&(g=0);0>=g?(d.push(e[0]),e=e.slice(1)):(d.push(b[0]),b=b.slice(1))}else 0<e.length?(d.push(e[0]),e=e.slice(1)):0<b.length&&(d.push(b[0]),b=b.slice(1));e=d}return e}function S(a,c,b){try{var e=a.body;if(b.length!==a.params.length)throw Error("Invalid Parameter calls to function.");for(var g=0;g<b.length;g++)c.localScope[a.params[g].name.toLowerCase()]={d:null,value:b[g],valueset:!0,node:null};var f=D(c,e);if(f instanceof d.ReturnResult)return f.value;
if(f===d.breakResult)throw Error("Cannot Break from a Function");if(f===d.continueResult)throw Error("Cannot Continue from a Function");return f instanceof d.ImplicitResult?f.value:f}catch(pa){throw pa;}}function Q(a,c,b){return C(a,c,function(c,d,e){c={spatialReference:a.spatialReference,applicationCache:void 0===a.applicationCache?null:a.applicationCache,globalScope:a.globalScope,depthCounter:a.depthCounter+1,console:a.console,localScope:{}};if(64<c.depthCounter)throw Error("Exceeded maximum function depth");
return S(b,c,e)})}function R(a){return function(){var c={applicationCache:void 0===a.context.applicationCache?null:a.context.applicationCache,spatialReference:a.context.spatialReference,console:a.context.console,localScope:{},depthCounter:a.context.depthCounter+1,globalScope:a.context.globalScope};if(64<c.depthCounter)throw Error("Exceeded maximum function depth");return S(a.definition,c,arguments)}}function aa(a){}var X=0,T={};r.registerFunctions(T,C);v.registerFunctions(T,C);u.registerFunctions(T,
C);w.registerFunctions(T,C);x.registerFunctions(T,C);T["typeof"]=function(a,c){return C(a,c,function(a,c,b){d.pcCheck(b,1,1);a=H(b[0]);if("Unrecognised Type"===a)throw Error("Unrecognised Type");return a})};T.iif=function(a,c){try{d.pcCheck(null===c.arguments?[]:c.arguments,3,3);var b=D(a,c.arguments[0]);if(!1===d.isBoolean(b))throw Error("IF Function must have a boolean test condition");return!0===b?D(a,c.arguments[1]):D(a,c.arguments[2])}catch(la){throw la;}};T.decode=function(a,c){try{if(2>c.arguments.length)throw Error("Missing Parameters");
if(2===c.arguments.length)return D(a,c.arguments[1]);if(0===(c.arguments.length-1)%2)throw Error("Must have a default value result.");var b=D(a,c.arguments[0]);return K(a,c,1,b)}catch(la){throw la;}};T.when=function(a,c){try{if(3>c.arguments.length)throw Error("Missing Parameters");if(0===c.arguments.length%2)throw Error("Must have a default value result.");var b=D(a,c.arguments[0]);if(!1===d.isBoolean(b))throw Error("WHEN needs boolean test conditions");return P(a,c,0,b)}catch(la){throw la;}};T.top=
function(a,c){return C(a,c,function(a,c,b){if(d.pcCheck(b,2,2),d.isArray(b[0]))return d.toNumber(b[1])>=b[0].length?b[0].slice(0):b[0].slice(0,d.toNumber(b[1]));if(d.isImmutableArray(b[0]))return d.toNumber(b[1])>=b[0].length()?b[0].slice(0):b[0].slice(0,d.toNumber(b[1]));throw Error("Top cannot accept this parameter type");})};T.first=function(a,c){return C(a,c,function(a,c,b){return d.pcCheck(b,1,1),d.isArray(b[0])?0===b[0].length?null:b[0][0]:d.isImmutableArray(b[0])?0===b[0].length()?null:b[0].get(0):
null})};T.sort=function(a,c){return C(a,c,function(a,c,b){d.pcCheck(b,1,2);a=b[0];if(d.isImmutableArray(a)&&(a=a.toArray()),!1===d.isArray(a))throw Error("Illegal Argument");if(1<b.length){if(!1===d.isFunctionParameter(b[1]))throw Error("Illegal Argument");var e=R(b[1]);return a=O(a,function(a,c){return e(a,c)})}if(0===a.length)return[];b={};for(c=0;c<a.length;c++){var g=H(a[c]);""!==g&&(b[g]=!0)}if(!0===b.Array||!0===b.Dictionary||!0===b.Feature||!0===b.Point||!0===b.Polygon||!0===b.Polyline||!0===
b.Multipoint||!0===b.Extent||!0===b.Function)return a.slice(0);c=0;var g="",f;for(f in b)c++,g=f;return a=1<c||"String"===g?O(a,function(a,c){if(null===a||void 0===a||a===d.voidOperation)return null===c||void 0===c||c===d.voidOperation?0:1;if(null===c||void 0===c||c===d.voidOperation)return-1;var b=d.toString(a),e=d.toString(c);return e>b?-1:b===e?0:1}):"Number"===g?O(a,function(a,c){return a-c}):"Boolean"===g?O(a,function(a,c){return a===c?0:c?-1:1}):"Date"===g?O(a,function(a,c){return c-a}):a.slice(0)})};
k.functionHelper={fixSpatialReference:d.fixSpatialReference,parseArguments:B,standardFunction:C};k.executeScript=function(a,c,b){b||(b=new g(102100));var e=c.vars,l=c.customfunctions,m={};e||(e={});l||(l={});var h=new n({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});h.immutable=!1;m.textformatting={value:h,valueset:!0,node:null};m.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};m.pi={value:Math.PI,valueset:!0,node:null};for(var r in T)m[r]=
{value:new d.NativeFunction(T[r]),valueset:!0,node:null};for(r in l)m[r]={value:new d.NativeFunction(l[r]),"native":!0,valueset:!0,node:null};for(r in e)e[r]instanceof f?m[r]={value:new q(e[r]),valueset:!0,node:null}:m[r]={value:e[r],valueset:!0,node:null};a=D({spatialReference:b,globalScope:m,localScope:null,console:c.console?c.console:aa,depthCounter:1,applicationCache:void 0===c.applicationCache?null:c.applicationCache},a.body[0].body);if(a instanceof d.ReturnResult&&(a=a.value),a instanceof d.ImplicitResult&&
(a=a.value),a===d.voidOperation&&(a=null),a===d.breakResult)throw Error("Cannot return BREAK");if(a===d.continueResult)throw Error("Cannot return CONTINUE");if(a instanceof t)throw Error("Cannot return FUNCTION");if(a instanceof d.NativeFunction)throw Error("Cannot return FUNCTION");return a};k.extractFieldLiterals=function(a,b){return void 0===b&&(b=!1),c.findFieldLiterals(a,b)};k.validateScript=function(a,b){return c.validateScript(a,b,"simple")};k.referencesMember=function(a,b){return c.referencesMember(a,
b)};k.referencesFunction=function(a,b){return c.referencesFunction(a,b)}})},"esri/arcade/treeAnalysis":function(){define(["require","exports"],function(h,k){function a(a,c,b,d){return void 0!==a.fmin&&(a.min=a.fmin),void 0!==a.fmax&&(a.max=a.fmax),"0"!==a.min&&b.length<Number(a.min)?-2:"*"!==a.max&&b.length>Number(a.max)?-2:1}function f(c,b,d){if(null!==d.localScope&&void 0!==d.localScope[c.toLowerCase()]){var e=d.localScope[c.toLowerCase()];if("FormulaFunction"===e.type||"any"===e.type)return void 0===
e.signature&&(e.signature={min:"0",max:"*"}),a(e.signature,c,b,d)}return void 0!==d.globalScope[c.toLowerCase()]&&(e=d.globalScope[c.toLowerCase()],"FormulaFunction"===e.type||"any"===e.type)?(void 0===e.signature&&(e.signature={min:"0",max:"*"}),a(e.signature,c,b,d)):-1}function b(a,c){void 0===c&&(c=!0);var d=q(a,"SYNTAX","UNREOGNISED");try{switch(a.type){case "VariableDeclarator":return null!==a.init&&"FunctionExpression"===a.init.type?q(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR"):"Identifier"!==
a.id.type?q(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER"):null!==a.init?b(a.init,!1):"";case "VariableDeclaration":for(var e=0;e<a.declarations.length;e++)if(d=b(a.declarations[e],c),""!==d)return d;return"";case "ForInStatement":if(d=b(a.left,c),""!==d)break;if("VariableDeclaration"===a.left.type){if(1<a.left.declarations.length)return q(a,"SYNTAX","ONLY1VAR");if(null!==a.left.declarations[0].init)return q(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return q(a,"SYNTAX","LEFTNOTVAR");
return d=b(a.right,c),""!==d?d:(d=b(a.body,c),""!==d?d:"");case "ForStatement":return null!==a.test&&(d=b(a.test,c),""!==d)?d:null!==a.init&&(d=b(a.init,c),""!==d)?d:null!==a.update&&(d=b(a.update,c),""!==d)?d:null!==a.body&&(d=b(a.body,c),""!==d)?d:"";case "ContinueStatement":return"";case "EmptyStatement":return"";case "BreakStatement":return"";case "IfStatement":return d=b(a.test,c),""!==d?d:null!==a.consequent&&(d=b(a.consequent,!1),""!==d)?d:null!==a.alternate&&(d=b(a.alternate,!1),""!==d)?d:
"";case "BlockStatement":for(var g=[],e=0;e<a.body.length;e++)"EmptyStatement"!==a.body[e].type&&g.push(a.body[e]);a.body=g;for(e=0;e<a.body.length;e++)if(d=b(a.body[e],c),""!==d)return d;return"";case "FunctionDeclaration":return!1===c?q(a,"SYNTAX","GLOBALFUNCTIONSONLY"):"Identifier"!==a.id.type?q(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"):b(a.body,!1);case "ReturnStatement":return null!==a.argument?b(a.argument,c):"";case "UpdateExpression":return"Identifier"!==a.argument.type&&"MemberExpression"!==
a.argument.type?q(a,"SYNTAX","ASSIGNMENTTOVARSONLY"):b(a.argument,c);case "AssignmentExpression":if("Identifier"!==a.left.type&&"MemberExpression"!==a.left.type)return q(a,"SYNTAX","ASSIGNMENTTOVARSONLY");if(d=b(a.left,c),""!==d)break;switch(a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:return q(a,"SYNTAX","OPERATORNOTRECOGNISED")}return b(a.right,!1);case "ExpressionStatement":return b(a.expression,!1);case "Identifier":d="";break;case "MemberExpression":return d=
b(a.object,c),""!==d?d:!0===a.computed?b(a.property,c):"";case "Literal":return"";case "ThisExpression":return q(a,"SYNTAX","NOTSUPPORTED");case "CallExpression":if("Identifier"!==a.callee.type)return q(a,"SYNTAX","ONLYNODESSUPPORTED");d="";for(e=0;e<a.arguments.length;e++)if(d=b(a.arguments[e],c),""!==d)return d;return"";case "UnaryExpression":d=b(a.argument,c);break;case "BinaryExpression":if(d=b(a.left,c),""!==d)break;if(d=b(a.right,c),""!==d)break;switch(a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;
default:return q(a,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "LogicalExpression":if(d=b(a.left,c),""!==d)break;if(d=b(a.right),""!==d)break;switch(a.operator){case "\x26\x26":case "||":break;default:return q(a,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "ConditionalExpression":return q(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":d="";for(e=0;e<a.elements.length&&(d=b(a.elements[e],c),""===d);e++);break;case "Array":return q(a,"SYNTAX","NOTSUPPORTED");case "ObjectExpression":d="";for(e=
0;e<a.properties.length;e++){if(d="",null!==a.properties[e].key&&("Literal"!==a.properties[e].key.type&&"Identifier"!==a.properties[e].key.type&&(d=q(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[e].key.type))g=a.properties[e].key.value,"string"==typeof g||g instanceof String||(d=q(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"));if(""===d&&(d=b(a.properties[e],c)),""!==d)break}break;case "Property":return"Literal"!==a.key.type&&"Identifier"!==a.key.type?q(a,"SYNTAX","ONLYLITERAL"):
"Identifier"!==a.key.type&&(d=b(a.key,c),""!==d)?d:d=b(a.value,c)}return d}catch(z){throw z;}}function e(a,b){var g=q(a,"SYNTAX","UNREOGNISED"),l=null,n="";try{switch(a.type){case "VariableDeclarator":if(null!==a.init&&"FunctionExpression"===a.init.type)return q(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR");null!==b.localScope?void 0!==b.localScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase():void 0!==b.globalScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase();var m=null===a.init?"":e(a.init,
b);return""!==m?m:(null===b.localScope?b.globalScope[a.id.name.toLowerCase()]={type:"any"}:b.localScope[a.id.name.toLowerCase()]={type:"any"},"");case "FunctionDeclaration":return l=d(a.id.name.toLowerCase(),a,b),n=c(a,b),""!==n?n:null!==b.localScope?q(a,"SYNTAX","GLOBALFUNCTIONSONLY"):(l.isnative=!1,b.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",signature:[l]},"");case "VariableDeclaration":for(var g="",h=0;h<a.declarations.length&&(g=e(a.declarations[h],b),""===g);h++);break;case "IfStatement":return g=
e(a.test,b),""!==g?g:"AssignmentExpression"===a.test.type||"UpdateExpression"===a.test.type?q(a.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):null!==a.consequent&&(g=e(a.consequent,b),""!==g)?g:null!==a.alternate&&(g=e(a.alternate,b),""!==g)?g:"";case "EmptyStatement":return"";case "BlockStatement":for(h=0;h<a.body.length;h++)if(g=e(a.body[h],b),""!==g)return g;return"";case "ReturnStatement":return null!==a.argument?e(a.argument,b):"";case "ForInStatement":if("VariableDeclaration"===a.left.type){if(1<
a.left.declarations.length)return q(a,"SYNTAX","ONLY1VAR");if(null!==a.left.declarations[0].init)return q(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return q(a,"SYNTAX","LEFTNOTVAR");return g=e(a.left,b),""!==g?g:(g=e(a.right,b),""!==g?g:(g=e(a.body,b),""!==g?g:""));case "ForStatement":return null!==a.init&&(g=e(a.init,b),""!==g)?g:null!==a.test&&(g=e(a.test,b),""!==g)?g:null!==a.body&&(g=e(a.body,b),""!==g)?g:null!==a.update&&(g=e(a.update,b),""!==g)?g:"";case "BreakStatement":return"";
case "ContinueStatement":return"";case "UpdateExpression":if("Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type)return q(a,"SYNTAX","ASSIGNMENTTOVARSONLY");var r=!1;return"MemberExpression"===a.argument.type?e(a.argument,b):(null!==b.localScope&&void 0!==b.localScope[a.argument.name.toLowerCase()]&&(r=!0),void 0!==b.globalScope[a.argument.name.toLowerCase()]&&(r=!0),!1===r?"Identifier "+a.argument.name+" has not been declared.":"");case "AssignmentExpression":if("Identifier"!==a.left.type&&
"MemberExpression"!==a.left.type)return q(a,"SYNTAX","ASSIGNMENTTOVARSONLY");var t=e(a.right,b);return""!==t?t:(r=!1,"MemberExpression"===a.left.type?(t=e(a.left,b),""!==t?t:""):(null!==b.localScope&&void 0!==b.localScope[a.left.name.toLowerCase()]&&(r=!0),void 0!==b.globalScope[a.left.name.toLowerCase()]&&(r=!0),!1===r?"Identifier "+a.left.name+" has not been declared.":""));case "ExpressionStatement":return e(a.expression,b);case "Identifier":var k=a.name.toLowerCase();if(null!==b.localScope&&void 0!==
b.localScope[k])return"";g=void 0!==b.globalScope[k]?"":q(a,"SYNTAX","VARIABLENOTFOUND");break;case "MemberExpression":return g=e(a.object,b),""!==g?g:!0===a.computed?e(a.property,b):"";case "Literal":return"";case "ThisExpression":g=q(a,"SYNTAX","NOTSUPPORTED");break;case "CallExpression":if("Identifier"!==a.callee.type)return q(a,"SYNTAX","ONLYNODESSUPPORTED");g="";for(h=0;h<a.arguments.length;h++)if(g=e(a.arguments[h],b),""!==g)return g;var u=f(a.callee.name,a.arguments,b);-1===u&&(g=q(a,"SYNTAX",
"NOTFOUND"));-2===u&&(g=q(a,"SYNTAX","WRONGSIGNATURE"));break;case "UnaryExpression":g=e(a.argument,b);break;case "BinaryExpression":return g=e(a.left,b),""!==g?g:(g=e(a.right,b),""!==g?g:"");case "LogicalExpression":return g=e(a.left,b),""!==g?g:"AssignmentExpression"===a.left.type||"UpdateExpression"===a.left.type?q(a.left,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):(g=e(a.right,b),""!==g?g:"AssignmentExpression"===a.right.type||"UpdateExpression"===a.right.type?q(a.right,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):
"");case "ConditionalExpression":return q(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":g="";for(h=0;h<a.elements.length&&(g=e(a.elements[h],b),""===g);h++);break;case "ObjectExpression":g="";for(h=0;h<a.properties.length;h++){if(g="",null!==a.properties[h].key&&("Literal"!==a.properties[h].key.type&&"Identifier"!==a.properties[h].key.type&&(g=q(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[h].key.type)){var v=a.properties[h].key.value;"string"==typeof v||v instanceof String||
(g=q(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"))}if(""===g&&(g=e(a.properties[h],b)),""!==g)break}break;case "Property":return"Literal"!==a.key.type&&"Identifier"!==a.key.type?q(a,"SYNTAX","ONLYLITERAL"):"Identifier"!==a.key.type&&(g=e(a.key,b),""!==g)?g:g=e(a.value,b);case "Array":return q(a,"SYNTAX","NOTSUPPORTED")}return g}catch(I){throw I;}}function l(a,c){var b=!1;try{switch(a.type){case "VariableDeclarator":return null!==a.init?l(a.init,c):b;case "FunctionDeclaration":return l(a.body,c);case "VariableDeclaration":for(var d=
0;d<a.declarations.length;d++)if(l(a.declarations[d],c))return!0;return b;case "IfStatement":return l(a.test,c)?!0:null!==a.consequent&&l(a.consequent,c)?!0:null!==a.alternate&&l(a.alternate,c)?!0:b;case "EmptyStatement":return b;case "BlockStatement":for(d=0;d<a.body.length;d++)if(l(a.body[d],c))return!0;return b;case "ReturnStatement":return null!==a.argument?l(a.argument,c):b;case "UpdateExpression":return l(a.argument,c);case "AssignmentExpression":return b=l(a.right,c),b?b:l(a.left,c);case "ExpressionStatement":return l(a.expression,
c);case "ForInStatement":return(b=l(a.left,c))?b:(b=l(a.right,c))?b:(b=l(a.body,c),b);case "ForStatement":return null!==a.init&&(b=l(a.init,c))?b:null!==a.test&&(b=l(a.test,c))?b:null!==a.body&&(b=l(a.body,c))?b:(null!==a.update&&(b=l(a.update,c)),b);case "BreakStatement":return b;case "ContinueStatement":return b;case "Compound":return b;case "Identifier":return c.toLowerCase()===a.name.toLowerCase();case "MemberExpression":return(b=l(a.object,c))?b:(!0===a.computed&&(b=l(a.property,c)),b);case "Literal":return b;
case "ThisExpression":return b;case "CallExpression":for(d=0;d<a.arguments.length;d++)l(a.arguments[d],c)&&(b=!0);return b;case "ArrayExpression":for(d=0;d<a.elements.length;d++)l(a.elements[d],c)&&(b=!0);return b;case "UnaryExpression":return l(a.argument,c);case "BinaryExpression":return(b=l(a.left,c))?b:b=l(a.right,c);case "LogicalExpression":return(b=l(a.left,c))?b:b=l(a.right,c);case "ObjectExpression":for(d=0;d<a.properties.length;d++)l(a.properties[d],c)&&(b=!0);return b;case "Property":return b=
l(a.value,c);case "ConditionalExpression":return b;case "Array":return b;default:return b}}catch(A){throw A;}}function m(a,c){var b=!1;try{switch(a.type){case "VariableDeclarator":return null!==a.init?m(a.init,c):b;case "FunctionDeclaration":return m(a.body,c);case "VariableDeclaration":for(var d=0;d<a.declarations.length;d++)if(m(a.declarations[d],c))return!0;return b;case "IfStatement":return m(a.test,c)?!0:null!==a.consequent&&m(a.consequent,c)?!0:null!==a.alternate&&m(a.alternate,c)?!0:b;case "EmptyStatement":return b;
case "BlockStatement":for(d=0;d<a.body.length;d++)if(m(a.body[d],c))return!0;return b;case "ReturnStatement":return null!==a.argument?m(a.argument,c):b;case "UpdateExpression":return m(a.argument,c);case "AssignmentExpression":return m(a.left,c)?!0:m(a.right,c);case "ExpressionStatement":return m(a.expression,c);case "ForInStatement":return(b=m(a.left,c))?b:(b=m(a.right,c))?b:(b=m(a.body,c),b);case "ForStatement":return null!==a.init&&(b=m(a.init,c))?b:null!==a.test&&(b=m(a.test,c))?b:null!==a.body&&
(b=m(a.body,c))?b:(null!==a.update&&(b=m(a.update,c)),b);case "BreakStatement":return b;case "ContinueStatement":return b;case "Compound":return b;case "Identifier":return b;case "MemberExpression":return(b=m(a.object,c))?b:(!0===a.computed&&(b=m(a.property,c)),b);case "Literal":return b;case "ThisExpression":return b;case "CallExpression":if(a.callee.name.toLowerCase()===c.toLowerCase())return!0;for(d=0;d<a.arguments.length;d++)m(a.arguments[d],c)&&(b=!0);return b;case "ArrayExpression":for(d=0;d<
a.elements.length;d++)m(a.elements[d],c)&&(b=!0);return b;case "UnaryExpression":return m(a.argument,c);case "BinaryExpression":return(b=m(a.left,c))?b:b=m(a.right,c);case "LogicalExpression":return(b=m(a.left,c))?b:b=m(a.right,c);case "ConditionalExpression":return b;case "ObjectExpression":for(d=0;d<a.properties.length;d++)m(a.properties[d],c)&&(b=!0);return b;case "Property":return b=m(a.value,c);case "Array":return b;default:return b}}catch(A){throw A;}}function g(a,c){var b,d=[];try{switch(a.type){case "VariableDeclarator":return null!==
a.init?g(a.init,c):d;case "FunctionDeclaration":return g(a.body,c);case "VariableDeclaration":for(var e=0;e<a.declarations.length;e++)b=g(a.declarations[e],c),d=d.concat(b);return d;case "ForInStatement":return b=g(a.left,c),d=d.concat(b),b=g(a.right,c),d=d.concat(b),b=g(a.body,c),d=d.concat(b);case "ForStatement":return null!==a.init&&(b=g(a.init,c),d=d.concat(b)),null!==a.test&&(b=g(a.test,c),d=d.concat(b)),null!==a.body&&(b=g(a.body,c),d=d.concat(b)),null!==a.update&&(b=g(a.update,c),d=d.concat(b)),
d;case "IfStatement":return b=g(a.test,c),d=d.concat(b),null!==a.consequent&&(b=g(a.consequent,c),d=d.concat(b)),null!==a.alternate&&(b=g(a.alternate,c),d=d.concat(b)),d;case "EmptyStatement":return d;case "BlockStatement":for(e=0;e<a.body.length;e++)b=g(a.body[e],c),d=d.concat(b);return d;case "ReturnStatement":return null!==a.argument?g(a.argument,c):d;case "UpdateExpression":return g(a.argument,c);case "AssignmentExpression":return d=g(a.left,c),d=d.concat(g(a.right,c));case "ExpressionStatement":return g(a.expression,
c);case "BreakStatement":return d;case "ContinueStatement":return d;case "Compound":return d;case "Identifier":return d;case "MemberExpression":if("Identifier"!==a.object.type)return d;if(!1===a.computed)d.push(a.object.name.toLowerCase()+"."+a.property.name.toLowerCase());else try{"Literal"===a.property.type&&"string"==typeof a.property.value&&d.push(a.object.name.toLowerCase()+"."+a.property.value.toString().toLowerCase())}catch(z){}return d;case "Literal":return d;case "ThisExpression":return d;
case "CallExpression":for(e=0;e<a.arguments.length;e++)b=g(a.arguments[e],c),d=d.concat(b);return d;case "ArrayExpression":for(e=0;e<a.elements.length;e++)b=g(a.elements[e],c),d=d.concat(b);return d;case "UnaryExpression":return g(a.argument,c);case "ObjectExpression":for(e=0;e<a.properties.length;e++)b=g(a.properties[e],c),d=d.concat(b);return d;case "Property":return g(a.value,c);case "BinaryExpression":return b=g(a.left,c),d=d.concat(b),b=g(a.right,c),d=d.concat(b);case "LogicalExpression":return b=
g(a.left,c),d=d.concat(b),b=g(a.right,c),d=d.concat(b);case "ConditionalExpression":return d;case "Array":return d;default:return d}}catch(z){throw z;}}function d(a,c,b){b=[];if(void 0!==c.params&&null!==c.params)for(var d=0;d<c.params.length;d++)b.push("any");return{name:a,"return":"any",params:b}}function c(a,c){for(var b={globalScope:c.globalScope,localScope:{}},d=0;d<a.params.length;d++)b.localScope[a.params[d].name.toLowerCase()]={type:"any"};return e(a.body,b)}function n(a,c,b,d){var e={};void 0!==
a&&null!==a||(a={});void 0!==b&&null!==b||(b={});e.infinity={type:"any"};e.textformatting={type:"any"};e.pi={type:"any"};for(var g in c)("simple"!==d||"simple"===d&&"a"===c[g].av)&&(e[g]={type:"FormulaFunction",signature:c[g]});for(c=0;c<b.length;c++)g=b[c],e[g.name]={type:"FormulaFunction",signature:g};for(g in a)e[g]=a[g],e[g].type="any";return e}function q(a,c,b){var d="";switch(c){case "SYNTAX":d="Syntax Error: ";break;case "RUNTIME":d="Runtime Error: ";break;default:d="Syntax Error: "}try{switch(a.type){case "IfStatement":switch(b){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":d+=
" Assignments not be made in logical tests";break;case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":d+=" Non Boolean used as Condition"}break;case "UpdateExpression":case "AssignmentExpression":switch(b){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":d+=" Assignments not be made in logical tests";break;case "ASSIGNMENTTOVARSONLY":d+=" Assignments can only be made to identifiers"}break;case "ExpressionStatement":d+=" Assignments can only be made to identifiers";break;case "FunctionDeclaration":switch(b){case "GLOBALFUNCTIONSONLY":d+=
" Functions cannot be declared as variables";break;case "FUNCTIONMUSTHAVEIDENTIFIER":d+=" Function Definition must have an identifier"}break;case "VariableDeclaration":d+=" Only 1 variable can be declared at a time";break;case "VariableDeclarator":switch(b){case "FUNCTIONVARIABLEDECLARATOR":d+=" Functions cannot be declared as variables";break;case "VARIABLEMUSTHAVEIDENTIFIER":d+=" Variable Definition must have an identifier"}break;case "Identifier":d+=" Identifier Not Found. ";d+=a.name;break;case "ObjectExpression":switch(b){case "OBJECTPROPERTYMUSTBESTRING":d+=
" Property name must be a string"}break;case "ForStatement":switch(b){case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":d+=" Non Boolean used as Condition"}break;case "ForInStatement":switch(b){case "ONLY1VAR":d+=" Can only declare 1 var for use with IN";break;case "CANNOTDECLAREVAL":d+=" Can only declare value for use with IN";break;case "LEFTNOVAR":d+="Must provide a variable to iterate with.";break;case "VARIABLENOTDECLARED":d+="Variable must be declared before it is used..";break;case "CANNOTITERATETHISTYPE":d+=
"This type cannot be used in an IN loop"}break;case "MemberExpression":switch(b){case "PROPERTYNOTFOUND":d+="Cannot find member property. ";d+=!1===a.computed?a.property.name:"";break;case "OUTOFBOUNDS":d+="Out of Bounds. ";d+=!1===a.computed?a.property.name:"";break;case "NOTFOUND":d+="Cannot call member method on null. ";d+=!1===a.computed?a.property.name:"";break;case "INVALIDTYPE":d+="Cannot call member property on object of this type. ",d+=!1===a.computed?a.property.name:""}break;case "Property":switch(b){case "ONLYLITERAL":d+=
"Property names must be literals or identifiers"}break;case "Literal":break;case "ThisExpression":d+="THIS construct is not supported.";case "CallExpression":switch(b){case "WRONGSIGNATURE":d+="Function signature does not match: ";d+=a.callee.name;break;case "ONLYNODESUPPORTED":d+="Functions must be declared.";d+=a.callee.name;break;case "NOTAFUNCTION":d+="Not a Function: ";d+=a.callee.name;break;case "NOTFOUND":d+="Function Not Found: "+a.callee.name}break;case "UnaryExpression":switch(b){case "NOTSUPPORTEDUNARYOPERATOR":d+=
"Operator "+a.operator+" not allowed in this context. Only ! can be used with boolean, and - with a number";break;case "NOTSUPPORTEDTYPE":d+="Unary operator "+a.operator+" cannot be used with this argument."}case "BinaryExpression":switch(b){case "OPERATORNOTRECOGNISED":d+="Binary Operator not recognised "+a.operator}break;case "LogicalExpression":switch(b){case "ONLYBOOLEAN":d+="Operator "+a.operator+" cannot be used. Only || or \x26\x26 are allowed values";break;case "ONLYORORAND":d+="Logical Expression "+
a.operator+" being applied to parameters that are not boolean."}return"";case "ConditionalExpression":d+="Conditional statements not supported.";break;case "ArrayExpression":switch(b){case "FUNCTIONCONTEXTILLEGAL":d+=" Cannot Put Function inside Array."}break;case "Array":d+="Expression contains unrecognised array structure.";break;default:d+="Expression contains unrecognised code structures."}}catch(A){throw A;}return d}function t(a,c,b){return{line:a.loc.start.line,character:a.loc.start.column,
reason:q(a,c,b)}}function r(a,c,b,d,e){void 0===e&&(e=!0);c={globalScope:c.globalScope,localScope:{}};for(e=0;e<a.params.length;e++)c.localScope[a.params[e].name.toLowerCase()]={type:"any"};v(a.body,c,b,d,!1)}function v(a,c,b,e,g){if(void 0===g&&(g=!0),null===a)throw Error("Unnexpexted Expression Syntax");q(a,"SYNTAX","UNREOGNISED");var l=null;try{switch(a.type){case "VariableDeclarator":return null!==a.init&&"FunctionExpression"===a.init.type?void e.push(t(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR")):
("Identifier"!==a.id.type?e.push(t(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER")):(null!==c.localScope?void 0!==c.localScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase():void 0!==c.globalScope[a.id.name.toLowerCase()]&&a.id.name.toLowerCase(),null===c.localScope?c.globalScope[a.id.name.toLowerCase()]={type:"any"}:c.localScope[a.id.name.toLowerCase()]={type:"any"}),void(null===a.init?"":v(a.init,c,b,e,g)));case "FunctionDeclaration":return!1===g&&e.push(t(a,"SYNTAX","GLOBALFUNCTIONSONLY")),"Identifier"!==
a.id.type&&e.push(t(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER")),l=d("",a,c),r(a,c,b,e,g),null!==c.localScope&&e.push(t(a,"SYNTAX","GLOBALFUNCTIONSONLY")),l.isnative=!1,void("Identifier"===a.id.type&&(c.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",signature:[l]}));case "VariableDeclaration":for(var n=0;n<a.declarations.length;n++)v(a.declarations[n],c,b,e,g);break;case "IfStatement":return null!==a.test&&(v(a.test,c,b,e,g),("AssignmentExpression"===a.test.type||"UpdateExpression"===a.test.type)&&
e.push(t(a.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"))),null!==a.consequent&&v(a.consequent,c,b,e,g),void(null!==a.alternate&&v(a.alternate,c,b,e,g));case "EmptyStatement":break;case "BlockStatement":if(null!==a.body)for(n=0;n<a.body.length;n++)v(a.body[n],c,b,e,g);break;case "ReturnStatement":return void(null!==a.argument&&v(a.argument,c,b,e,g));case "ForInStatement":return"VariableDeclaration"===a.left.type?(1<a.left.declarations.length&&e.push(t(a,"SYNTAX","ONLY1VAR")),null!==a.left.declarations[0].init&&
e.push(t(a,"SYNTAX","CANNOTDECLAREVAL"))):"Identifier"!==a.left.type&&e.push(t(a,"SYNTAX","LEFTNOTVAR")),v(a.left,c,b,e,g),v(a.right,c,b,e,g),void v(a.body,c,b,e,g);case "ForStatement":return null!==a.init&&v(a.init,c,b,e,g),null!==a.test&&v(a.test,c,b,e,g),null!==a.body&&v(a.body,c,b,e,g),void(null!==a.update&&v(a.update,c,b,e,g));case "BreakStatement":break;case "ContinueStatement":break;case "UpdateExpression":"Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type?e.push(t(a,"SYNTAX",
"ASSIGNMENTTOVARSONLY")):("Identifier"===a.argument.type&&(l=!1,!1===b&&(null!==c.localScope&&void 0!==c.localScope[a.argument.name.toLowerCase()]&&(l=!0),void 0!==c.globalScope[a.argument.name.toLowerCase()]&&(l=!0),!1===l&&e.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+a.argument.name+" has not been declared."}))),"MemberExpression"===a.argument.type&&v(a.argument,c,b,e,g));break;case "AssignmentExpression":switch("Identifier"!==a.left.type&&
"MemberExpression"!==a.left.type&&e.push(t(a,"SYNTAX","ASSIGNMENTTOVARSONLY")),a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:e.push(t(a,"SYNTAX","OPERATORNOTRECOGNISED"))}v(a.right,c,b,e,g);l=!1;return"Identifier"===a.left.type&&(null!==c.localScope&&void 0!==c.localScope[a.left.name.toLowerCase()]&&(l=!0),void 0!==c.globalScope[a.left.name.toLowerCase()]&&(l=!0),!1===b&&!1===l&&e.push({line:null===a?0:a.loc.start.line,character:null===a?0:
a.loc.start.column,reason:"Identifier "+a.argument.name+" has not been declared."})),void("MemberExpression"===a.left.type&&v(a.left,c,b,e,g));case "ExpressionStatement":return void v(a.expression,c,b,e,g);case "Identifier":var m=a.name.toLowerCase();if(null!==c.localScope&&void 0!==c.localScope[m])break;if(void 0!==c.globalScope[m])break;!1===b&&e.push(t(a,"SYNTAX","VARIABLENOTFOUND"));break;case "MemberExpression":return v(a.object,c,b,e,g),void(!0===a.computed&&v(a.property,c,b,e,g));case "Literal":return"";
case "ThisExpression":e.push(t(a,"SYNTAX","NOTSUPPORTED"));break;case "CallExpression":"Identifier"!==a.callee.type&&e.push(t(a,"SYNTAX","ONLYNODESSUPPORTED"));for(n=0;n<a.arguments.length;n++)v(a.arguments[n],c,b,e,g);var h=f(a.callee.name,a.arguments,c);return!1===b&&-1===h&&e.push(t(a,"SYNTAX","NOTFOUND")),void(-2===h&&e.push(t(a,"SYNTAX","WRONGSIGNATURE")));case "UnaryExpression":return void v(a.argument,c,b,e,g);case "BinaryExpression":switch(v(a.left,c,b,e,g),v(a.right,c,b,e,g),a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;
default:e.push(t(a,"SYNTAX","OPERATORNOTRECOGNISED"))}break;case "LogicalExpression":switch(a.operator){case "\x26\x26":case "||":break;default:e.push(t(a,"SYNTAX","OPERATORNOTRECOGNISED"))}return v(a.left,c,b,e,g),("AssignmentExpression"===a.left.type||"UpdateExpression"===a.left.type)&&e.push(t(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION")),v(a.right,c,b,e,g),void(("AssignmentExpression"===a.right.type||"UpdateExpression"===a.right.type)&&e.push(t(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION")));
case "ConditionalExpression":e.push(t(a,"SYNTAX","NOTSUPPORTED"));break;case "ArrayExpression":for(n=0;n<a.elements.length;n++)v(a.elements[n],c,b,e,g);break;case "Array":e.push(t(a,"SYNTAX","NOTSUPPORTED"));case "ObjectExpression":for(n=0;n<a.properties.length;n++)v(a.properties[n],c,b,e,g);break;case "Property":return"Literal"!==a.key.type&&"Identifier"!==a.key.type&&e.push(t(a,"SYNTAX","ONLYLITERAL")),"Literal"===a.key.type&&v(a.key,c,b,e,g),void v(a.value,c,b,e,g);default:e.push(t(a,"SYNTAX",
"UNRECOGNISED"))}}catch(E){e.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Unnexpected Syntax"})}}k.functionDecls={concatenate:{min:"0",max:"*",av:"a"},split:{min:"2",max:"4",av:"a"},guid:{min:"0",max:"1",av:"a"},today:{min:"0",max:"0",av:"a"},now:{min:"0",max:"0",av:"a"},timestamp:{min:"0",max:"0",av:"a"},day:{min:"1",max:"1",av:"a"},month:{min:"1",max:"1",av:"a"},year:{min:"1",max:"1",av:"a"},hour:{min:"1",max:"1",av:"a"},second:{min:"1",max:"1",av:"a"},
millisecond:{min:"1",max:"1",av:"a"},minute:{min:"1",max:"1",av:"a"},weekday:{min:"1",max:"1",av:"a"},toutc:{min:"1",max:"1",av:"a"},tolocal:{min:"1",max:"1",av:"a"},date:{min:"0",max:"7",av:"a"},datediff:{min:"2",max:"3",av:"a"},dateadd:{min:"2",max:"3",av:"a"},trim:{min:"1",max:"1",av:"a"},text:{min:"1",max:"2",av:"a"},left:{min:"2",max:"2",av:"a"},right:{min:"2",max:"2",av:"a"},mid:{min:"2",max:"3",av:"a"},upper:{min:"1",max:"1",av:"a"},proper:{min:"1",max:"2",av:"a"},lower:{min:"1",max:"1",av:"a"},
find:{min:"2",max:"3",av:"a"},iif:{min:"3",max:"3",av:"a"},decode:{min:"2",max:"*",av:"a"},when:{min:"2",max:"*",av:"a"},defaultvalue:{min:"2",max:"2",av:"a"},isempty:{min:"1",max:"1",av:"a"},maplayer:{min:"2",max:"3",av:"f"},domaincode:{min:"3",max:"4",av:"a"},domainname:{min:"2",max:"4",av:"a"},polygon:{min:"1",max:"1",av:"a"},point:{min:"1",max:"1",av:"a"},polyline:{min:"1",max:"1",av:"a"},extent:{min:"1",max:"1",av:"a"},multipoint:{min:"1",max:"1",av:"a"},geometry:{min:"1",max:"1",av:"a"},featurelayer:{min:"1",
max:"3",av:"f"},featurecollection:{min:"1",max:"1",av:"f"},buffer:{min:"2",max:"4",av:"f"},area:{min:"1",max:"2",av:"f"},sumarea:{min:"1",max:"2",av:"f"},length:{min:"1",max:"2",av:"f"},sumlength:{min:"1",max:"2",av:"f"},count:{min:"0",max:"*",av:"a"},filter:{min:"2",max:"2",av:"f"},envelopeintersects:{min:"2",max:"2",av:"f"},intersects:{min:"2",max:"2",av:"f"},contains:{min:"2",max:"2",av:"f"},overlaps:{min:"2",max:"2",av:"f"},within:{min:"2",max:"2",av:"f"},touches:{min:"2",max:"2",av:"f"},crosses:{min:"2",
max:"2",av:"f"},union:{min:"1",max:"2",av:"f",fmin:1},difference:{min:"2",max:"2",av:"f",fmin:2,fmax:3},intersection:{min:"2",max:"2",av:"f",fmin:2,fmax:3},symmetricdifference:{min:"2",max:"2",av:"f",fmin:2,fmax:3},number:{min:"1",max:"2",av:"a"},acos:{min:"1",max:"1",av:"a"},asin:{min:"1",max:"1",av:"a"},atan:{min:"1",max:"1",av:"a"},atan2:{min:"2",max:"2",av:"a"},ceil:{min:"1",max:"2",av:"a"},floor:{min:"1",max:"2",av:"a"},round:{min:"1",max:"2",av:"a"},cos:{min:"1",max:"1",av:"a"},exp:{min:"1",
max:"1",av:"a"},log:{min:"1",max:"1",av:"a"},min:{min:"0",max:"*",av:"a"},console:{min:"0",max:"*",av:"a"},max:{min:"0",max:"*",av:"a"},pow:{min:"2",max:"2",av:"a"},random:{min:"0",max:"0",av:"a"},sqrt:{min:"1",max:"1",av:"a"},sin:{min:"1",max:"1",av:"a"},tan:{min:"1",max:"1",av:"a"},abs:{min:"1",max:"1",av:"a"},isnan:{min:"1",max:"1",av:"a"},stdev:{min:"0",max:"*",av:"a"},average:{min:"0",max:"*",av:"a"},mean:{min:"0",max:"*",av:"a"},sum:{min:"0",max:"*",av:"a"},variance:{min:"0",max:"*",av:"a"},
distinct:{min:"0",max:"*",av:"a"},addfield:{min:"3",max:"3",av:"f"},removefield:{min:"2",max:"2",av:"f"},aggregate:{min:"3",max:"3",av:"f"},dissolve:{min:"2",max:"3",av:"f"},changeshape:{min:"2",max:"4",av:"f"},first:{min:"1",max:"1",av:"a"},top:{min:"2",max:"2",av:"a"},orderby:{min:"2",max:"2",av:"f"},"boolean":{min:"1",max:"1",av:"a"},dictionary:{min:"0",max:"*",av:"a"},servicearea:{min:"2",max:"*",av:"f"},equals:{min:"2",max:"2",av:"a"},"typeof":{min:"1",max:"1",av:"a"},reverse:{min:"1",max:"1",
av:"a"},replace:{min:"3",max:"4",av:"a"},sort:{min:"1",max:"2",av:"a"},feature:{min:"1",max:"*",av:"a"},haskey:{min:"2",max:"2",av:"a"},indexof:{min:"2",max:"2",av:"a"},centroid:{min:"1",max:"1",av:"f"},multiparttosinglepart:{min:"1",max:"1",av:"f"}};k.checkFunctionSignature=a;k.findFunction=f;k.validateLanguageNode=b;k.testValidityOfExpression=e;k.referencesMemberImpl=l;k.referencesMember=function(a,c){return!0===l(a.body[0].body,c.toLowerCase())?!0:!1};k.referencesFunctionImpl=m;k.referencesFunction=
function(a,c){return!0===m(a.body[0].body,c)?!0:!1};k.findFieldLiteralsImpl=g;k.findFieldLiterals=function(a,c){return g(a.body[0].body,c)};k.extractFunctionDeclaration=d;k.validateFunction=c;k.constructGlobalScope=n;k.validateScript=function(a,c,b){void 0===b&&(b="full");c={globalScope:n(c.vars,k.functionDecls,c.customFunctions,b),localScope:null};return e(a.body[0].body,c)};k.validateLanguage=function(a){return"BlockStatement"!==a.body[0].body.type?"Invalid formula content.":b(a.body[0].body)};
k.nodeErrorMessage=q;k.makeError=t;k.extractAllIssuesInFunction=r;k.extractAllIssues=v;k.checkScript=function(a,c,b,d){void 0===d&&(d="full");var e=[];if("BlockStatement"!==a.body[0].body.type)return[{line:0,character:0,reason:"Invalid Body"}];null!==c&&void 0!==c||(c={vars:{},customFunctions:[]});c={globalScope:n(c.vars,k.functionDecls,c.customFunctions,d),localScope:null};try{v(a.body[0].body,c,b,e)}catch(z){}return e}})},"esri/arcade/Feature":function(){define("require exports dojo/_base/lang ../geometry/Geometry ../graphic ../geometry/jsonUtils ./Dictionary ./languageUtils ./ImmutableArray ../geometry/Point".split(" "),
function(h,k,a,f,b,e,l,m,g,d){return function(){function c(a,d,g){(this.geometry=null,this.attributes=null,this._layer=null,this._datesfixed=!0,this.immutable=!0,a instanceof c)?(this.attributes=a.attributes,this.geometry=a.geometry,a._layer&&(this._layer=a._layer)):a instanceof b?(this.geometry=a.geometry,void 0===a.attributes?this.attributes={}:null===a.attributes?this.attributes={}:this.attributes=a.attributes,a._layer?(this._layer=a._layer,this._datesfixed=!1):a.layer&&(this._layer=a.layer,this._datesfixed=
!1)):a instanceof l?(this.attributes=a.field("attributes"),null!==this.attributes&&(this.attributes instanceof l?this.attributes=this.attributes.attributes:this.attributes=null),this.geometry=a.field("geometry"),null!==this.geometry&&(this.geometry instanceof l?this.geometry=c.parseGeometryFromDictionary(this.geometry):this.geometry instanceof f||(this.geometry=null))):(d instanceof f||null===d?(this.geometry=d,void 0===a?this.attributes={}:null===a?this.attributes={}:this.attributes=a):"string"==
typeof a?(a=JSON.parse(a),null!==a.geometry&&void 0!==a.geometry&&(this.geometry=e.fromJson(a.geometry)),void 0===a.attributes?this.attributes={}:null===a.attributes?this.attributes={}:this.attributes=a.attributes):(void 0===a?this.attributes={}:null===a&&(this.attributes={}),this.geometry=null),void 0!==g&&(this._layer=g))}return c.prototype.castToText=function(){var a="",c;for(c in this.attributes){""!==a&&(a+=",");var b=this.attributes[c];null==b?b="null":m.isBoolean(b)||m.isNumber(b)||m.isString(b)?
a+=JSON.stringify(c)+":"+JSON.stringify(b):b instanceof f?a+=JSON.stringify(c)+":"+m.toStringExplicit(b):b instanceof g?a+=JSON.stringify(c)+":"+m.toStringExplicit(b):b instanceof Array?a+=JSON.stringify(c)+":"+m.toStringExplicit(b):b instanceof Date?a+=JSON.stringify(c)+":"+JSON.stringify(b):null!==b&&"object"==typeof b&&void 0!==b.castToText&&(a+=JSON.stringify(c)+":"+b.castToText())}return'{"geometry":'+(null===this.geometry?"null":m.toStringExplicit(this.geometry))+',"attributes":{'+a+"}}"},c.prototype._fixDates=
function(){for(var a=[],c=0;c<this._layer.fields.length;c++){var b=this._layer.fields[c];"date"!==b.type&&"esriFieldTypeDate"!==b.type||a.push(b.name)}0<a.length&&this._fixDateFields(a);this._datesfixed=!0},c.prototype._fixDateFields=function(c){this.attributes=a.mixin({},this.attributes);for(var b=0;b<c.length;b++){var d=this.attributes[c[b]];if(null!==d)if(void 0===d)for(var e in this.attributes){if(e.toLowerCase()===c[b]){d=this.attributes[e];null!==d&&(d instanceof Date||(this.attributes[e]=new Date(d)));
break}}else d instanceof Date||(this.attributes[c[b]]=new Date(d))}},c.prototype.field=function(a){!1===this._datesfixed&&this._fixDates();var c=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var b in this.attributes)if(b.toLowerCase()===c)return this.attributes[b];if(this._hasFieldDefinition(c))return null;throw Error("Field not Found");},c.prototype._hasFieldDefinition=function(a){if(null===this._layer)return!1;for(var c=0;c<this._layer.fields.length;c++)if(this._layer.fields[c].name.toLowerCase()===
a)return!0;return!1},c.prototype._field=function(a){!1===this._datesfixed&&this._fixDates();var c=a.toLowerCase();a=this.attributes[a];if(void 0!==a)return a;for(var b in this.attributes)if(b.toLowerCase()===c)return this.attributes[b];return null},c.prototype.setField=function(a,c){if(this.immutable)throw Error("Feature is Immutable");if(!1===m.isSimpleType(c))throw Error("Illegal Value Assignment to Feature");var b=a.toLowerCase();if(void 0!==this.attributes[a])return void(this.attributes[a]=c);
for(var d in this.attributes)if(d.toLowerCase()===b)return void(this.attributes[d]=c);this.attributes[a]=c},c.prototype.hasField=function(a){var c=a.toLowerCase();if(void 0!==this.attributes[a])return!0;for(var b in this.attributes)if(b.toLowerCase()===c)return!0;return this._hasFieldDefinition(c)?!0:!1},c.prototype.keys=function(){var a=[],c={},b;for(b in this.attributes)a.push(b),c[b.toLowerCase()]=1;if(null!==this._layer)for(b=0;b<this._layer.fields.length;b++){var d=this._layer.fields[b];1!==
c[d.name.toLowerCase()]&&a.push(d.name)}return a=a.sort()},c.fromFeature=function(a){return new c(a)},c.parseGeometryFromDictionary=function(a){a=c.convertDictionaryToJson(a,!0);return void 0!==a.spatialreference&&(a.spatialReference=a.spatialreference,delete a.spatialreference),void 0!==a.rings&&(a.rings=this.fixPathArrays(a.rings,!0===a.hasZ,!0===a.hasM)),void 0!==a.paths&&(a.paths=this.fixPathArrays(a.paths,!0===a.hasZ,!0===a.hasM)),void 0!==a.points&&(a.points=this.fixPointArrays(a.points,!0===
a.hasZ,!0===a.hasM)),e.fromJson(a)},c.fixPathArrays=function(a,c,b){var d=[];if(a instanceof Array)for(var e=0;e<a.length;e++)d.push(this.fixPointArrays(a[e],c,b));else if(a instanceof g)for(e=0;e<a.length();e++)d.push(this.fixPointArrays(a.get(e),c,b));return d},c.fixPointArrays=function(a,c,b){var e=[];if(a instanceof Array)for(var f=0;f<a.length;f++){var l=a[f];l instanceof d?c&&b?e.push([l.x,l.y,l.z,l.m]):c?e.push([l.x,l.y,l.z]):b?e.push([l.x,l.y,l.m]):e.push([l.x,l.y]):e.push(l)}else if(a instanceof
g)for(f=0;f<a.length();f++)l=a.get(f),l instanceof d?c&&b?e.push([l.x,l.y,l.z,l.m]):c?e.push([l.x,l.y,l.z]):b?e.push([l.x,l.y,l.m]):e.push([l.x,l.y]):e.push(l);return e},c.convertDictionaryToJson=function(a,b){void 0===b&&(b=!1);var d={},e;for(e in a.attributes){var g=a.attributes[e];g instanceof l&&(g=c.convertDictionaryToJson(g));b?d[e.toLowerCase()]=g:d[e]=g}return d},c.parseAttributesFromDictionary=function(a){var c={},b;for(b in a.attributes){var d=a.attributes[b];if(!m.isSimpleType(d))throw Error("Illegal Argument");
c[b]=d}return c},c.fromJson=function(a){var b=null;null!==a.geometry&&void 0!==a.geometry&&(b=e.fromJson(a.geometry));var d={};if(null!==a.attributes&&void 0!==a.attributes)for(var g in a.attributes){var f=a.attributes[g];if(!(m.isString(f)||m.isNumber(f)||m.isBoolean(f)||m.isDate(f)))throw Error("Illegal Argument");d[g]=f}return new c(d,b)},c.prototype.domainValueLookup=function(a,c,b){if(null===this._layer||!this._layer.fields)return null;b=m.getDomain(a,this._layer,this,b);if(void 0===c)try{c=
this.field(a)}catch(r){return null}return m.getDomainValue(b,c)},c.prototype.domainCodeLookup=function(a,c,b){if(null===this._layer||!this._layer.fields)return null;a=m.getDomain(a,this._layer,this,b);return m.getDomainCode(a,c)},c}()})},"esri/arcade/functions/date":function(){define(["require","exports","../../moment","../languageUtils"],function(h,k,a,f){function b(a){return null===a?a:isNaN(a.getTime())?null:a}k.registerFunctions=function(e,l){e.today=function(a,b){return l(a,b,function(a,c,b){f.pcCheck(b,
0,0);a=new Date;return a.setHours(0,0,0,0),a})};e.now=function(a,b){return l(a,b,function(a,c,b){f.pcCheck(b,0,0);return new Date})};e.timestamp=function(a,b){return l(a,b,function(a,c,b){f.pcCheck(b,0,0);a=new Date;return a=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())})};e.toutc=function(a,b){return l(a,b,function(a,c,b){f.pcCheck(b,1,1);a=f.toDate(b[0]);return null===a?null:new Date(a.getUTCFullYear(),a.getUTCMonth(),
a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())})};e.tolocal=function(b,e){return l(b,e,function(b,c,e){f.pcCheck(e,1,1);b=f.toDate(e[0]);return null===b?null:a.utc([b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds(),b.getMilliseconds()]).toDate()})};e.day=function(a,b){return l(a,b,function(a,c,b){f.pcCheck(b,1,1);a=f.toDate(b[0]);return null===a?NaN:a.getDate()})};e.month=function(a,b){return l(a,b,function(a,c,b){f.pcCheck(b,
1,1);a=f.toDate(b[0]);return null===a?NaN:a.getMonth()})};e.year=function(a,b){return l(a,b,function(a,c,b){f.pcCheck(b,1,1);a=f.toDate(b[0]);return null===a?NaN:a.getFullYear()})};e.hour=function(a,b){return l(a,b,function(a,c,b){f.pcCheck(b,1,1);a=f.toDate(b[0]);return null===a?NaN:a.getHours()})};e.second=function(a,b){return l(a,b,function(a,c,b){f.pcCheck(b,1,1);a=f.toDate(b[0]);return null===a?NaN:a.getSeconds()})};e.millisecond=function(a,b){return l(a,b,function(a,c,b){f.pcCheck(b,1,1);a=
f.toDate(b[0]);return null===a?NaN:a.getMilliseconds()})};e.minute=function(a,b){return l(a,b,function(a,c,b){f.pcCheck(b,1,1);a=f.toDate(b[0]);return null===a?NaN:a.getMinutes()})};e.weekday=function(a,b){return l(a,b,function(a,c,b){f.pcCheck(b,1,1);a=f.toDate(b[0]);return null===a?NaN:a.getDay()})};e.date=function(e,g){return l(e,g,function(d,c,e){if(f.pcCheck(e,0,7),3===e.length)return b(new Date(f.toNumber(e[0]),f.toNumber(e[1]),f.toNumber(e[2]),0,0,0,0));if(4===e.length)return b(new Date(f.toNumber(e[0]),
f.toNumber(e[1]),f.toNumber(e[2]),f.toNumber(e[3]),0,0,0));if(5===e.length)return b(new Date(f.toNumber(e[0]),f.toNumber(e[1]),f.toNumber(e[2]),f.toNumber(e[3]),f.toNumber(e[4]),0,0));if(6===e.length)return b(new Date(f.toNumber(e[0]),f.toNumber(e[1]),f.toNumber(e[2]),f.toNumber(e[3]),f.toNumber(e[4]),f.toNumber(e[5]),0));if(7===e.length)return b(new Date(f.toNumber(e[0]),f.toNumber(e[1]),f.toNumber(e[2]),f.toNumber(e[3]),f.toNumber(e[4]),f.toNumber(e[5]),f.toNumber(e[6])));if(2===e.length){d=f.toString(e[1]);
if(""===d)return null;d=f.standardiseDateFormat(d);e=a(f.toString(e[0]),d,!0);return!0===e.isValid()?e.toDate():null}if(1===e.length){if(f.isString(e[0])&&""===e[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))return null;d=f.toNumber(e[0]);return!1===isNaN(d)?b(new Date(d)):f.toDate(e[0])}return 0===e.length?new Date:void 0})};e.datediff=function(a,b){return l(a,b,function(a,c,b){f.pcCheck(b,2,3);a=f.toDateM(b[0]);c=f.toDateM(b[1]);if(null===a||null===c)return NaN;switch(f.toString(b[2]).toLowerCase()){case "days":case "day":case "d":return a.diff(c,
"days",!0);case "months":case "month":return a.diff(c,"months",!0);case "minutes":case "minute":case "m":return"M"===b[2]?a.diff(c,"months",!0):a.diff(c,"minutes",!0);case "seconds":case "second":case "s":return a.diff(c,"seconds",!0);case "milliseconds":case "millisecond":case "ms":return a.diff(c);case "hours":case "hour":case "h":return a.diff(c,"hours",!0);case "years":case "year":case "y":return a.diff(c,"years",!0);default:return a.diff(c)}})};e.dateadd=function(a,b){return l(a,b,function(a,
c,b){f.pcCheck(b,2,3);a=f.toDateM(b[0]);if(null===a)return null;c="milliseconds";switch(f.toString(b[2]).toLowerCase()){case "days":case "day":case "d":c="days";break;case "months":case "month":c="months";break;case "minutes":case "minute":case "m":c="M"===b[2]?"months":"minutes";break;case "seconds":case "second":case "s":c="seconds";break;case "milliseconds":case "millisecond":case "ms":c="milliseconds";break;case "hours":case "hour":case "h":c="hours";break;case "years":case "year":case "y":c=
"years"}return a.add(f.toNumber(b[1]),c),a.toDate()})}}})},"esri/arcade/functions/string":function(){define(["require","exports","../languageUtils","../Feature"],function(h,k,a,f){k.registerFunctions=function(b,e){b.trim=function(b,f){return e(b,f,function(b,d,c){return a.pcCheck(c,1,1),a.toString(c[0]).trim()})};b.upper=function(b,f){return e(b,f,function(b,d,c){return a.pcCheck(c,1,1),a.toString(c[0]).toUpperCase()})};b.proper=function(b,f){return e(b,f,function(b,d,c){a.pcCheck(c,1,2);b=1;2===
c.length&&"firstword"===a.toString(c[1]).toLowerCase()&&(b=2);d=/\s/;c=a.toString(c[0]);for(var e="",g=!0,f=0;f<c.length;f++){var l=c[f];d.test(l)?1===b&&(g=!0):l.toUpperCase()!==l.toLowerCase()&&(g?(l=l.toUpperCase(),g=!1):l=l.toLowerCase());e+=l}return e})};b.lower=function(b,f){return e(b,f,function(b,d,c){return a.pcCheck(c,1,1),a.toString(c[0]).toLowerCase()})};b.guid=function(b,f){return e(b,f,function(b,d,c){if(a.pcCheck(c,0,1),0<c.length)switch(a.toString(c[0]).toLowerCase()){case "digits":return a.generateUUID().replace("-",
"").replace("-","").replace("-","").replace("-","");case "digits-hyphen":return a.generateUUID();case "digits-hyphen-parentheses":return"("+a.generateUUID()+")"}return"{"+a.generateUUID()+"}"})};b.console=function(b,f){return e(b,f,function(e,d,c){return 0===c.length||(1===c.length?b.console(a.toString(c[0])):b.console(a.toString(c))),a.voidOperation})};b.mid=function(b,f){return e(b,f,function(b,d,c){a.pcCheck(c,2,3);b=a.toNumber(c[1]);if(isNaN(b))return"";if(0>b&&(b=0),2===c.length)return a.toString(c[0]).substr(b);
d=a.toNumber(c[2]);return isNaN(d)?"":(0>d&&(d=0),a.toString(c[0]).substr(b,d))})};b.find=function(b,f){return e(b,f,function(b,d,c){a.pcCheck(c,2,3);b=0;if(2<c.length){if(b=a.toNumber(a.defaultUndefined(c[2],0)),isNaN(b))return-1;0>b&&(b=0)}return a.toString(c[1]).indexOf(a.toString(c[0]),b)})};b.left=function(b,f){return e(b,f,function(b,d,c){a.pcCheck(c,2,2);b=a.toNumber(c[1]);return isNaN(b)?"":(0>b&&(b=0),a.toString(c[0]).substr(0,b))})};b.right=function(b,f){return e(b,f,function(b,d,c){a.pcCheck(c,
2,2);b=a.toNumber(c[1]);return isNaN(b)?"":(0>b&&(b=0),a.toString(c[0]).substr(-1*b,b))})};b.split=function(b,f){return e(b,f,function(b,d,c){a.pcCheck(c,2,4);var e;b=a.toNumber(a.defaultUndefined(c[2],-1));d=a.toBoolean(a.defaultUndefined(c[3],!1));if(-1===b||null===b||!0===d?e=a.toString(c[0]).split(a.toString(c[1])):(isNaN(b)&&(b=-1),-1>b&&(b=-1),e=a.toString(c[0]).split(a.toString(c[1]),b)),!1===d)return e;c=[];for(d=0;d<e.length&&!(-1!==b&&c.length>=b);d++)""!==e[d]&&void 0!==e[d]&&c.push(e[d]);
return c})};b.text=function(b,f){return e(b,f,function(b,d,c){return a.pcCheck(c,1,2),a.toStringExplicit(c[0],c[1])})};b.concatenate=function(b,f){return e(b,f,function(b,d,c){b=[];if(1>c.length)return"";if(a.isArray(c[0])){d=a.defaultUndefined(c[2],"");for(var e=0;e<c[0].length;e++)b[e]=a.toStringExplicit(c[0][e],d);return 1<c.length?b.join(c[1]):b.join("")}if(a.isImmutableArray(c[0])){d=a.defaultUndefined(c[2],"");for(e=0;e<c[0].length();e++)b[e]=a.toStringExplicit(c[0].get(e),d);return 1<c.length?
b.join(c[1]):b.join("")}for(e=0;e<c.length;e++)b[e]=a.toStringExplicit(c[e]);return b.join("")})};b.reverse=function(b,f){return e(b,f,function(b,d,c){if(a.pcCheck(c,1,1),a.isArray(c[0]))return b=c[0].slice(0),b.reverse(),b;if(a.isImmutableArray(c[0]))return b=c[0].toArray().slice(0),b.reverse(),b;throw Error("Invalid Parameter");})};b.replace=function(b,f){return e(b,f,function(b,d,c){a.pcCheck(c,3,4);b=a.toString(c[0]);d=a.toString(c[1]);var e=a.toString(c[2]);return(4===c.length?a.toBoolean(c[3]):
1)?a.multiReplace(b,d,e):b.replace(d,e)})};b.domainname=function(b,m){return e(b,m,function(b,d,c){if(a.pcCheck(c,2,4),c[0]instanceof f)return c[0].domainValueLookup(a.toString(c[1]),c[2],void 0===c[3]?void 0:a.toNumber(c[3]));throw Error("Invalid Parameter");})};b.domaincode=function(b,m){return e(b,m,function(b,d,c){if(a.pcCheck(c,3,4),c[0]instanceof f)return c[0].domainCodeLookup(a.toString(c[1]),c[2],void 0===c[3]?void 0:a.toNumber(c[3]));throw Error("Invalid Parameter");})}}})},"esri/arcade/functions/maths":function(){define(["require",
"exports","../languageUtils","dojo/number"],function(h,k,a,f){function b(a,b,f){return"undefined"==typeof f||0===+f?Math[a](b):(b=+b,f=+f,isNaN(b)||"number"!=typeof f||0!==f%1?NaN:(b=b.toString().split("e"),b=Math[a](+(b[0]+"e"+(b[1]?+b[1]-f:-f))),b=b.toString().split("e"),+(b[0]+"e"+(b[1]?+b[1]+f:f))))}k.registerFunctions=function(e,l){e.number=function(b,e){return l(b,e,function(b,c,e){a.pcCheck(e,1,2);b=e[0];return a.isNumber(b)?b:null===b?0:a.isDate(b)||a.isBoolean(b)||""===b||void 0===b?Number(b):
a.isString(b)?void 0!==e[1]?(e=a.multiReplace(e[1],"\u2030",""),e=a.multiReplace(e,"\u00a4",""),f.parse(b,{pattern:e})):Number(b.trim()):Number(b)})};e.abs=function(b,e){return l(b,e,function(b,c,e){return a.pcCheck(e,1,1),Math.abs(a.toNumber(e[0]))})};e.acos=function(b,e){return l(b,e,function(b,c,e){return a.pcCheck(e,1,1),Math.acos(a.toNumber(e[0]))})};e.asin=function(b,e){return l(b,e,function(b,c,e){return a.pcCheck(e,1,1),Math.asin(a.toNumber(e[0]))})};e.atan=function(b,e){return l(b,e,function(b,
c,e){return a.pcCheck(e,1,1),Math.atan(a.toNumber(e[0]))})};e.atan2=function(b,e){return l(b,e,function(b,c,e){return a.pcCheck(e,2,2),Math.atan2(a.toNumber(e[0]),a.toNumber(e[1]))})};e.ceil=function(e,g){return l(e,g,function(d,c,e){return(a.pcCheck(e,1,2),2===e.length)?(d=a.toNumber(e[1]),isNaN(d)&&(d=0),b("ceil",a.toNumber(e[0]),-1*d)):Math.ceil(a.toNumber(e[0]))})};e.round=function(e,g){return l(e,g,function(d,c,e){return(a.pcCheck(e,1,2),2===e.length)?(d=a.toNumber(e[1]),isNaN(d)&&(d=0),b("round",
a.toNumber(e[0]),-1*d)):Math.round(a.toNumber(e[0]))})};e.floor=function(e,g){return l(e,g,function(d,c,e){return(a.pcCheck(e,1,2),2===e.length)?(d=a.toNumber(e[1]),isNaN(d)&&(d=0),b("floor",a.toNumber(e[0]),-1*d)):Math.floor(a.toNumber(e[0]))})};e.cos=function(b,e){return l(b,e,function(b,c,e){return a.pcCheck(e,1,1),Math.cos(a.toNumber(e[0]))})};e.isnan=function(b,e){return l(b,e,function(b,c,e){return a.pcCheck(e,1,1),"number"==typeof e[0]&&isNaN(e[0])})};e.exp=function(b,e){return l(b,e,function(b,
c,e){return a.pcCheck(e,1,1),Math.exp(a.toNumber(e[0]))})};e.log=function(b,e){return l(b,e,function(b,c,e){return a.pcCheck(e,1,1),Math.log(a.toNumber(e[0]))})};e.pow=function(b,e){return l(b,e,function(b,c,e){return a.pcCheck(e,2,2),Math.pow(a.toNumber(e[0]),a.toNumber(e[1]))})};e.random=function(b,e){return l(b,e,function(b,c,e){return a.pcCheck(e,0,0),Math.random()})};e.sin=function(b,e){return l(b,e,function(b,c,e){return a.pcCheck(e,1,1),Math.sin(a.toNumber(e[0]))})};e.sqrt=function(b,e){return l(b,
e,function(b,c,e){return a.pcCheck(e,1,1),Math.sqrt(a.toNumber(e[0]))})};e.tan=function(b,e){return l(b,e,function(b,c,e){return a.pcCheck(e,1,1),Math.tan(a.toNumber(e[0]))})};e.defaultvalue=function(b,e){return l(b,e,function(b,c,e){return a.pcCheck(e,2,2),null===e[0]?e[1]:""===e[0]?e[1]:void 0===e[0]?e[1]:e[0]})};e.isempty=function(b,e){return l(b,e,function(b,c,e){return a.pcCheck(e,1,1),null===e[0]?!0:""===e[0]?!0:void 0===e[0]?!0:!1})};e["boolean"]=function(b,e){return l(b,e,function(b,c,e){a.pcCheck(e,
1,1);return a.toBoolean(e[0])})}}})},"esri/arcade/functions/geometry":function(){define("require exports ../../geometry/Geometry ../../geometry/Polygon ../../geometry/Polyline ../../geometry/Point ../../geometry/Extent ../../geometry/Multipoint ../../geometry/jsonUtils ../languageUtils ../Dictionary ../Feature".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n){k.registerFunctions=function(h,k){h.polygon=function(a,b){return k(a,b,function(b,e,l){d.pcCheck(l,1,1);b=null;if(l[0]instanceof c){if(b=d.fixSpatialReference(n.parseGeometryFromDictionary(l[0]),
a.spatialReference),0==b instanceof f)throw Error("Illegal Parameter");}else b=l[0]instanceof f?g.fromJson(l[0].toJson()):d.fixSpatialReference(new f(JSON.parse(l[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return b})};h.polyline=function(a,e){return k(a,e,function(e,f,l){d.pcCheck(l,1,1);e=null;if(l[0]instanceof c){if(e=d.fixSpatialReference(n.parseGeometryFromDictionary(l[0]),
a.spatialReference),0==e instanceof b)throw Error("Illegal Parameter");}else e=l[0]instanceof b?g.fromJson(l[0].toJson()):d.fixSpatialReference(new b(JSON.parse(l[0])),a.spatialReference);if(null!==e&&!1===e.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return e})};h.point=function(a,b){return k(a,b,function(b,f,l){d.pcCheck(l,1,1);b=null;if(l[0]instanceof c){if(b=d.fixSpatialReference(n.parseGeometryFromDictionary(l[0]),
a.spatialReference),0==b instanceof e)throw Error("Illegal Parameter");}else b=l[0]instanceof e?g.fromJson(l[0].toJson()):d.fixSpatialReference(new e(JSON.parse(l[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return b})};h.multipoint=function(a,b){return k(a,b,function(b,e,f){d.pcCheck(f,1,1);b=null;if(f[0]instanceof c){if(b=d.fixSpatialReference(n.parseGeometryFromDictionary(f[0]),
a.spatialReference),0==b instanceof m)throw Error("Illegal Parameter");}else b=f[0]instanceof m?g.fromJson(f[0].toJson()):d.fixSpatialReference(new m(JSON.parse(f[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return b})};h.extent=function(a,h){return k(a,h,function(h,q,r){d.pcCheck(r,1,1);h=null;r[0]instanceof c?h=d.fixSpatialReference(n.parseGeometryFromDictionary(r[0]),
a.spatialReference):r[0]instanceof e?(h={xmin:r[0].x,ymin:r[0].y,xmax:r[0].x,ymax:r[0].y,spatialReference:r[0].spatialReference.toJson()},r[0].hasZ?(h.zmin=r[0].z,h.zmax=r[0].z):r[0].hasM&&(h.mmin=r[0].m,h.mmax=r[0].m),h=g.fromJson(h)):h=r[0]instanceof f?g.fromJson(r[0].getExtent().toJson()):r[0]instanceof b?g.fromJson(r[0].getExtent().toJson()):r[0]instanceof m?g.fromJson(r[0].getExtent().toJson()):r[0]instanceof l?g.fromJson(r[0].toJson()):d.fixSpatialReference(new l(JSON.parse(r[0])),a.spatialReference);
if(null!==h&&!1===h.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return h})};h.geometry=function(a,b){return k(a,b,function(b,e,f){d.pcCheck(f,1,1);b=null;if(b=f[0]instanceof n?d.fixSpatialReference(f[0].geometry,a.spatialReference):f[0]instanceof c?d.fixSpatialReference(n.parseGeometryFromDictionary(f[0]),a.spatialReference):d.fixSpatialReference(g.fromJson(JSON.parse(f[0])),a.spatialReference),
null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return b})};h.feature=function(b,e){return k(b,e,function(e,g,f){if(0===f.length)throw Error("Missing Parameters");e=null;if(1===f.length)if(d.isString(f[0]))e=n.fromJson(JSON.parse(f[0]));else if(f[0]instanceof n)e=new n(f[0]);else if(f[0]instanceof a)e=new n(null,f[0]);else{if(!(f[0]instanceof c))throw Error("Illegal Argument");
e=f[0].hasField("geometry")?f[0].field("geometry"):null;g=f[0].hasField("attributes")?f[0].field("attributes"):null;null!==e&&e instanceof c&&(e=n.parseGeometryFromDictionary(e));null!==g&&(g=n.parseAttributesFromDictionary(g));e=new n(g,e)}else{if(2===f.length){g=e=null;if(null!==f[0])if(f[0]instanceof a)e=f[0];else{if(!(e instanceof c))throw Error("Illegal Argument");e=n.parseGeometryFromDictionary(f[0])}if(null!==f[1]){if(!(f[1]instanceof c))throw Error("Illegal Argument");g=n.parseAttributesFromDictionary(f[1])}}else{e=
null;g={};if(null!==f[0])if(f[0]instanceof a)e=f[0];else{if(!(e instanceof c))throw Error("Illegal Argument");e=n.parseGeometryFromDictionary(f[0])}for(var l=1;l<f.length;l+=2){var m=d.toString(f[l]),h=f[l+1];if(!(null===h||void 0===h||d.isString(h)||isNaN(h)||d.isDate(h)||d.isNumber(h)||d.isBoolean(h)))throw Error("Illegal Argument");if(d.isFunctionParameter(h)||!1===d.isSimpleType(h))throw Error("Illegal Argument");h===d.voidOperation?g[m]=null:g[m]=h}}e=new n(g,e)}return e.geometry=d.fixSpatialReference(e.geometry,
b.spatialReference),e.immutable=!1,e})};h.dictionary=function(a,b){return k(a,b,function(a,b,e){if(0===e.length)throw Error("Missing Parameters");if(0!==e.length%2)throw Error("Missing Parameters");a={};for(b=0;b<e.length;b+=2){var g=d.toString(e[b]),f=e[b+1];if(!(null===f||void 0===f||d.isString(f)||isNaN(f)||d.isDate(f)||d.isNumber(f)||d.isBoolean(f)))throw Error("Illegal Argument");if(d.isFunctionParameter(f))throw Error("Illegal Argument");f===d.voidOperation?a[g]=null:a[g]=f}e=new c(a);return e.immutable=
!1,e})};h.haskey=function(a,b){return k(a,b,function(a,b,e){d.pcCheck(e,2,2);a=d.toString(e[1]);if(e[0]instanceof n||e[0]instanceof c)return e[0].hasField(a);throw Error("Illegal Argument");})};h.indexof=function(a,c){return k(a,c,function(a,c,b){d.pcCheck(b,2,2);a=b[1];if(d.isArray(b[0])){for(c=0;c<b[0].length;c++)if(d.equalityTest(a,b[0][c]))return c;return-1}if(d.isImmutableArray(b[0])){var e=b[0].length();for(c=0;e>c;c++)if(d.equalityTest(a,b[0].get(c)))return c;return-1}throw Error("Illegal Argument");
})}}})},"esri/arcade/functions/stats":function(){define(["require","exports","../languageUtils","./fieldStats"],function(h,k,a,f){function b(b,l,m,g){if(1===g.length){if(a.isArray(g[0]))return f.calculateStat(b,g[0],-1);if(a.isImmutableArray(g[0]))return f.calculateStat(b,g[0].toArray(),-1)}return f.calculateStat(b,g,-1)}k.registerFunctions=function(e,f){e.stdev=function(a,e){return f(a,e,function(a,c,e){return b("stdev",a,c,e)})};e.variance=function(a,e){return f(a,e,function(a,c,e){return b("variance",
a,c,e)})};e.average=function(a,e){return f(a,e,function(a,c,e){return b("mean",a,c,e)})};e.mean=function(a,e){return f(a,e,function(a,c,e){return b("mean",a,c,e)})};e.sum=function(a,e){return f(a,e,function(a,c,e){return b("sum",a,c,e)})};e.min=function(a,e){return f(a,e,function(a,c,e){return b("min",a,c,e)})};e.max=function(a,e){return f(a,e,function(a,c,e){return b("max",a,c,e)})};e.distinct=function(a,e){return f(a,e,function(a,c,e){return b("distinct",a,c,e)})};e.count=function(b,e){return f(b,
e,function(b,c,e){if(a.pcCheck(e,1,1),a.isArray(e[0])||a.isString(e[0]))return e[0].length;if(a.isImmutableArray(e[0]))return e[0].length();throw Error("Invalid Parameters for Count");})}}})},"esri/arcade/functions/fieldStats":function(){define(["require","exports","../languageUtils"],function(h,k,a){function f(a){for(var b=0,e=0;e<a.length;e++)b+=a[e];return b/a.length}function b(a){for(var b=f(a),e=0,g=0;g<a.length;g++)e+=Math.pow(b-a[g],2);return e/a.length}k.decodeStatType=function(a){switch(a.toLowerCase()){case "distinct":return"distinct";
case "avg":case "mean":return"avg";case "min":return"min";case "sum":return"sum";case "max":return"max";case "stdev":case "stddev":return"stddev";case "var":case "variance":return"var";case "count":return"count"}return""};k.calculateStat=function(e,l,m){switch(void 0===m&&(m=1E3),e.toLowerCase()){case "distinct":a:{e=m;m=[];for(var g={},d=[],c=0;c<l.length;c++){if(void 0!==l[c]&&null!==l[c]&&l[c]!==a.voidOperation){var n=l[c];if(a.isNumber(n)||a.isString(n))void 0===g[n]&&(m.push(n),g[n]=1);else{for(var h=
!1,k=0;k<d.length;k++)!0===a.equalityTest(d[k],n)&&(h=!0);!1===h&&(d.push(n),m.push(n))}}if(m.length>=e&&-1!==e){l=m;break a}}l=m}return l;case "avg":case "mean":return f(a.toNumberArray(l));case "min":return Math.min.apply(Math,a.toNumberArray(l));case "sum":l=a.toNumberArray(l);for(m=e=0;m<l.length;m++)e+=l[m];return e;case "max":return Math.max.apply(Math,a.toNumberArray(l));case "stdev":case "stddev":return Math.sqrt(b(a.toNumberArray(l)));case "var":case "variance":return b(a.toNumberArray(l));
case "count":return l.length}return 0}})},"esri/arcade/parser":function(){define(["require","exports","./treeAnalysis","./lib/esprima"],function(h,k,a,f){k.parseScript=function(b){b=f.parse("function _() { "+b+"\n}");if(null===b.body||void 0===b.body)throw Error("No formula provided.");if(0===b.body.length)throw Error("No formula provided.");if(0===b.body.length)throw Error("No formula provided.");if("BlockStatement"!==b.body[0].body.type)throw Error("Invalid formula content.");var e=a.validateLanguage(b);
if(""!==e)throw Error(e);return b};k.scriptCheck=function(b,e,l,m){var g=[];try{var d=f.parse("function _() { "+b+"\n}",{tolerant:!0,loc:!0}),c=d.errors;if(0<c.length)for(var n=0;n<c.length;n++)g.push({line:c[n].lineNumber,character:c[n].column,reason:c[n].description});var h=a.checkScript(d,e,l,m);for(e=0;e<h.length;e++)g.push(h[e])}catch(t){try{"Unexpected token }"===t.description&&(t.index=("function _() { "+b+"\n}").length-1)?g.push({line:t.lineNumber,character:t.column,reason:"Unexpected end of script"}):
g.push({line:t.lineNumber,character:t.column,reason:t.description})}catch(r){}}return g};k.extractFieldLiterals=function(b,e){return void 0===e&&(e=!1),a.findFieldLiterals(b,e)};k.validateScript=function(b,e,f){return void 0===f&&(f="full"),a.validateScript(b,e,f)};k.referencesMember=function(b,e){return a.referencesMember(b,e)};k.referencesFunction=function(b,e){return a.referencesFunction(b,e)}})},"esri/arcade/lib/esprima":function(){!function(h,k){"function"==typeof define&&define.amd?define(["exports"],
k):k("undefined"!=typeof exports?exports:h.esprima={})}(this,function(h){function k(a,c){if(!a)throw Error("ASSERT: "+c);}function a(a){return 48<=a&&57>=a}function f(a){return 0<="0123456789abcdefABCDEF".indexOf(a)}function b(a){return 0<="01234567".indexOf(a)}function e(a){return 10===a||13===a||8232===a||8233===a}function l(a){return 36===a||95===a||65<=a&&90>=a||97<=a&&122>=a||92===a||128<=a&&Va.NonAsciiIdentifierStart.test(String.fromCharCode(a))}function m(a){return 36===a||95===a||65<=a&&90>=
a||97<=a&&122>=a||48<=a&&57>=a||92===a||128<=a&&Va.NonAsciiIdentifierPart.test(String.fromCharCode(a))}function g(a){switch(a=a.toLowerCase(),a.length){case 2:return"if"===a||"in"===a;case 3:return"var"===a||"for"===a;case 4:return"else"===a;case 5:return"break"===a;case 6:return"return"===a;case 8:return"function"===a.toLowerCase()||"continue"===a;default:return!1}}function d(a,c,b,d,e){var g;k("number"==typeof b,"Comment must have valid position");ca.lastCommentStart>=b||(ca.lastCommentStart=b,
g={type:a,value:c},U.range&&(g.range=[b,d]),U.loc&&(g.loc=e),U.comments.push(g),U.attachComment&&(U.leadingComments.push(g),U.trailingComments.push(g)))}function c(a){var c,b,g,f;c=N-a;for(b={start:{line:ea,column:N-ka-a}};sa>N;)if(g=W.charCodeAt(N),++N,e(g))return U.comments&&(f=W.slice(c+a,N-1),b.end={line:ea,column:N-ka-1},d("Line",f,c,N-1,b)),13===g&&10===W.charCodeAt(N)&&++N,++ea,void(ka=N);U.comments&&(f=W.slice(c+a,N),b.end={line:ea,column:N-ka},d("Line",f,c,N,b))}function n(){var a,b;for(b=
0===N;sa>N;)if(a=W.charCodeAt(N),32===a||9===a||11===a||12===a||160===a||5760<=a&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(a))++N;else if(e(a))++N,13===a&&10===W.charCodeAt(N)&&++N,++ea,ka=N,b=!0;else if(47===a)if(a=W.charCodeAt(N+1),47===a)++N,++N,c(2),b=!0;else{if(42!==a)break;++N;++N;a:{var g=void 0,f=void 0,l=void 0,m=void 0;for(U.comments&&(g=N-2,f={start:{line:ea,column:N-ka-2}});sa>N;)if(l=W.charCodeAt(N),e(l))13===l&&10===W.charCodeAt(N+
1)&&++N,++ea,++N,ka=N,N>=sa&&K();else{if(42===l&&47===W.charCodeAt(N+1)){++N;++N;U.comments&&(m=W.slice(g+2,N-2),f.end={line:ea,column:N-ka},d("Block",m,g,N,f));break a}++N}K()}}else if(b&&45===a){if(45!==W.charCodeAt(N+1)||62!==W.charCodeAt(N+2))break;N+=3;c(3)}else{if(60!==a)break;if("!--"!==W.slice(N+1,N+4))break;++N;++N;++N;++N;c(4)}}function q(a){var c,b,d=0;c="u"===a?4:2;for(a=0;c>a;++a){if(!(sa>N&&f(W[N])))return"";b=W[N++];d=16*d+"0123456789abcdef".indexOf(b.toLowerCase())}return String.fromCharCode(d)}
function t(){var a,c;a=W.charCodeAt(N++);c=String.fromCharCode(a);for(92===a&&(117!==W.charCodeAt(N)&&K(),++N,a=q("u"),a&&"\\"!==a&&l(a.charCodeAt(0))||K(),c=a);sa>N&&(a=W.charCodeAt(N),m(a));)++N,c+=String.fromCharCode(a),92===a&&(c=c.substr(0,c.length-1),117!==W.charCodeAt(N)&&K(),++N,a=q("u"),a&&"\\"!==a&&m(a.charCodeAt(0))||K(),c+=a);return c}function r(){var a,c,b,d,e=N,g=W.charCodeAt(N),f=W[N];switch(g){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++N,
U.tokenize&&(40===g?U.openParenToken=U.tokens.length:123===g&&(U.openCurlyToken=U.tokens.length)),{type:Y.Punctuator,value:String.fromCharCode(g),lineNumber:ea,lineStart:ka,start:e,end:N};default:if(a=W.charCodeAt(N+1),61===a)switch(g){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return N+=2,{type:Y.Punctuator,value:String.fromCharCode(g)+String.fromCharCode(a),lineNumber:ea,lineStart:ka,start:e,end:N};case 33:case 61:return N+=2,61===W.charCodeAt(N)&&++N,{type:Y.Punctuator,
value:W.slice(e,N),lineNumber:ea,lineStart:ka,start:e,end:N}}}return d=W.substr(N,4),"\x3e\x3e\x3e\x3d"===d?(N+=4,{type:Y.Punctuator,value:d,lineNumber:ea,lineStart:ka,start:e,end:N}):(b=d.substr(0,3),"\x3e\x3e\x3e"===b||"\x3c\x3c\x3d"===b||"\x3e\x3e\x3d"===b?(N+=3,{type:Y.Punctuator,value:b,lineNumber:ea,lineStart:ka,start:e,end:N}):(c=b.substr(0,2),f===c[1]&&0<="+-\x3c\x3e\x26|".indexOf(f)||"\x3d\x3e"===c?(N+=2,{type:Y.Punctuator,value:c,lineNumber:ea,lineStart:ka,start:e,end:N}):0<="\x3c\x3e\x3d!+-*%\x26|^/".indexOf(f)?
(++N,{type:Y.Punctuator,value:f,lineNumber:ea,lineStart:ka,start:e,end:N}):void K()))}function v(){var c,d,e;if(e=W[N],k(a(e.charCodeAt(0))||"."===e,"Numeric literal must start with a decimal digit or a decimal point"),d=N,c="","."!==e){if(c=W[N++],e=W[N],"0"===c){if("x"===e||"X"===e){++N;for(var g="";sa>N&&f(W[N]);)g+=W[N++];return 0===g.length&&K(),l(W.charCodeAt(N))&&K(),{type:Y.NumericLiteral,value:parseInt("0x"+g,16),lineNumber:ea,lineStart:ka,start:d,end:N}}if("b"===e||"B"===e){++N;for(c="";sa>
N&&(g=W[N],"0"===g||"1"===g);)c+=W[N++];return 0===c.length&&K(),sa>N&&(g=W.charCodeAt(N),(l(g)||a(g))&&K()),{type:Y.NumericLiteral,value:parseInt(c,2),lineNumber:ea,lineStart:ka,start:d,end:N}}if("o"===e||"O"===e||b(e)){var m,n;for(b(e)?(n=!0,m="0"+W[N++]):(n=!1,++N,m="");sa>N&&b(W[N]);)m+=W[N++];return n||0!==m.length||K(),(l(W.charCodeAt(N))||a(W.charCodeAt(N)))&&K(),{type:Y.NumericLiteral,value:parseInt(m,8),octal:n,lineNumber:ea,lineStart:ka,start:d,end:N}}e&&a(e.charCodeAt(0))&&K()}for(;a(W.charCodeAt(N));)c+=
W[N++];e=W[N]}if("."===e){for(c+=W[N++];a(W.charCodeAt(N));)c+=W[N++];e=W[N]}if("e"===e||"E"===e)if(c+=W[N++],e=W[N],("+"===e||"-"===e)&&(c+=W[N++]),a(W.charCodeAt(N)))for(;a(W.charCodeAt(N));)c+=W[N++];else K();return l(W.charCodeAt(N))&&K(),{type:Y.NumericLiteral,value:parseFloat(c),lineNumber:ea,lineStart:ka,start:d,end:N}}function u(){ba=null;n();L("Regular Expression language structures not supported")}function w(){n();u()}function x(){var a,c;if(a=U.tokens[U.tokens.length-1],!a)return w();if("Punctuator"===
a.type){if("]"===a.value)return r();if(")"===a.value)return c=U.tokens[U.openParenToken-1],!c||"Keyword"!==c.type||"if"!==c.value.toLowerCase()&&"while"!==c.value.toLowerCase()&&"for"!==c.value.toLowerCase()&&"with"!==c.value.toLowerCase()?r():w();if("}"===a.value){if(U.tokens[U.openCurlyToken-3]&&"Keyword"===U.tokens[U.openCurlyToken-3].type){if(c=U.tokens[U.openCurlyToken-4],!c)return r()}else{if(!U.tokens[U.openCurlyToken-4]||"Keyword"!==U.tokens[U.openCurlyToken-4].type)return r();if(c=U.tokens[U.openCurlyToken-
5],!c)return w()}return 0<=Ca.indexOf(c.value)?r():w()}return w()}return"Keyword"===a.type&&"this"!==a.value?w():r()}function y(){var c;n();var d;if(N>=sa)d={type:Y.EOF,lineNumber:ea,lineStart:ka,start:N,end:N};else if(c=W.charCodeAt(N),l(c)){var h,u;d=N;var w;if(92===W.charCodeAt(N))w=t();else a:{var y;for(w=N++;sa>N;){if(y=W.charCodeAt(N),92===y){w=(N=w,t());break a}if(!m(y))break;++N}w=W.slice(w,N)}d=(h=w,u=1===h.length?Y.Identifier:g(h)?Y.Keyword:"null"===h.toLowerCase()?Y.NullLiteral:"true"===
h.toLowerCase()||"false"===h.toLowerCase()?Y.BooleanLiteral:Y.Identifier,{type:u,value:h,lineNumber:ea,lineStart:ka,start:d,end:N})}else if(40===c||41===c||59===c)d=r();else if(39===c||34===c){var C,z,A="",D=!1;y=ea;c=ka;h=W[N];k("'"===h||'"'===h,"String literal must starts with a quote");u=N;for(++N;sa>N;){if(d=W[N++],d===h){h="";break}if("\\"===d)if(d=W[N++],d&&e(d.charCodeAt(0)))++ea,"\r"===d&&"\n"===W[N]&&++N,ka=N;else switch(d){case "u":case "x":if("{"===W[N]){++N;C=A;var B,E=B=void 0,A=z=void 0;
B=W[N];E=0;for("}"===B&&K();sa>N&&(B=W[N++],f(B));)E=16*E+"0123456789abcdef".indexOf(B.toLowerCase());B=((1114111<E||"}"!==B)&&K(),65535>=E?String.fromCharCode(E):(z=(E-65536>>10)+55296,A=(E-65536&1023)+56320,String.fromCharCode(z,A)));A=C+B}else z=N,(C=q(d))?A+=C:(N=z,A+=d);break;case "n":A+="\n";break;case "r":A+="\r";break;case "t":A+="\t";break;case "b":A+="\b";break;case "f":A+="\f";break;case "v":A+="\x0B";break;default:b(d)?(w="01234567".indexOf(d),0!==w&&(D=!0),sa>N&&b(W[N])&&(D=!0,w=8*w+
"01234567".indexOf(W[N++]),0<="0123".indexOf(d)&&sa>N&&b(W[N])&&(w=8*w+"01234567".indexOf(W[N++]))),A+=String.fromCharCode(w)):A+=d}else{if(e(d.charCodeAt(0)))break;A+=d}}d=(""!==h&&K(),{type:Y.StringLiteral,value:A,octal:D,startLineNumber:y,startLineStart:c,lineNumber:ea,lineStart:ka,start:u,end:N})}else d=46===c?a(W.charCodeAt(N+1))?v():r():a(c)?v():U.tokenize&&47===c?x():r();return d}function A(){var a,c,b,d;return n(),a={start:{line:ea,column:N-ka}},c=y(),a.end={line:ea,column:N-ka},c.type!==
Y.EOF&&(b=W.slice(c.start,c.end),d={type:va[c.type],value:b,range:[c.start,c.end],loc:a},c.regex&&(d.regex={pattern:c.regex.pattern,flags:c.regex.flags}),U.tokens.push(d)),c}function z(){var a;return a=ba,N=a.end,ea=a.lineNumber,ka=a.lineStart,ba="undefined"!=typeof U.tokens?A():y(),N=a.end,ea=a.lineNumber,ka=a.lineStart,a}function B(){var a,c,b;a=N;c=ea;b=ka;ba="undefined"!=typeof U.tokens?A():y();N=a;ea=c;ka=b}function C(){this.line=ea;this.column=N-ka}function D(){this.start=new C;this.end=null}
function E(a){a.type===Y.StringLiteral?this.start={line:a.startLineNumber,column:a.start-a.startLineStart}:this.start={line:a.lineNumber,column:a.start-a.lineStart};this.end=null}function F(){N=ba.start;ba.type===Y.StringLiteral?(ea=ba.startLineNumber,ka=ba.startLineStart):(ea=ba.lineNumber,ka=ba.lineStart);U.range&&(this.range=[N,0]);U.loc&&(this.loc=new D)}function G(a){U.range&&(this.range=[a.start,0]);U.loc&&(this.loc=new E(a))}function I(){var a,c,b,d;return a=N,c=ea,b=ka,n(),d=ea!==c,N=a,ea=
c,ka=b,d}function J(a,c,b){var d=Error("Line "+a+": "+b);return d.index=c,d.lineNumber=a,d.column=c-ka+1,d.description=b,d}function L(a){var c,b;throw c=Array.prototype.slice.call(arguments,1),b=a.replace(/%(\d)/g,function(a,b){return k(b<c.length,"Message reference must be in range"),c[b]}),J(ea,N,b);}function M(a){var c,b,d;if(c=Array.prototype.slice.call(arguments,1),b=a.replace(/%(\d)/g,function(a,b){return k(b<c.length,"Message reference must be in range"),c[b]}),d=J(ea,N,b),!U.errors)throw d;
U.errors.push(d)}function H(a,c){var b=na.UnexpectedToken;a&&(b=c?c:a.type===Y.EOF?na.UnexpectedEOS:a.type===Y.Identifier?na.UnexpectedIdentifier:a.type===Y.NumericLiteral?na.UnexpectedNumber:a.type===Y.StringLiteral?na.UnexpectedString:na.UnexpectedToken);return b=b.replace("%0",a?a.value:"ILLEGAL"),a&&"number"==typeof a.lineNumber?J(a.lineNumber,a.start,b):J(ea,N,b)}function K(a,c){throw H(a,c);}function P(a,c){var b=H(a,c);if(!U.errors)throw b;U.errors.push(b)}function O(a){var c=z();c.type===
Y.Punctuator&&c.value===a||K(c)}function S(){var a;U.errors?(a=ba,a.type===Y.Punctuator&&","===a.value?z():a.type===Y.Punctuator&&";"===a.value?(z(),P(a)):P(a,na.UnexpectedToken)):O(",")}function Q(a){var c=z();c.type===Y.Keyword&&c.value.toLowerCase()===a.toLowerCase()||K(c)}function R(a){return ba.type===Y.Punctuator&&ba.value===a}function aa(a){return ba.type===Y.Keyword&&ba.value.toLowerCase()===a.toLowerCase()}function X(){var a;return 59===W.charCodeAt(N)||R(";")?void z():(a=ea,n(),void(ea===
a&&(ba.type===Y.EOF||R("}")||K(ba))))}function T(a){return a.type===fa.Identifier||a.type===fa.MemberExpression}function V(a,c){var b,d,e=new F;return b=ha,d=Ja(),ha=b,e.finishFunctionExpression(null,a,[],d)}function da(){var a,c,b;return a=ha,ha=!0,c=Ta(),b=V(c.params),ha=a,b}function ga(){var a,c=new F;return a=z(),a.type===Y.StringLiteral||a.type===Y.NumericLiteral?(ha&&a.octal&&P(a,na.StrictOctalLiteral),c.finishLiteral(a)):c.finishIdentifier(a.value)}function la(){var a,c,b,d,e,g=new F;if(a=
ba,a.type===Y.Identifier)return b=ga(),"get"!==a.value||R(":")||R("(")?"set"!==a.value||R(":")||R("(")?R(":")?(z(),d=ra(),g.finishProperty("init",b,d,!1,!1)):R("(")?(d=da(),g.finishProperty("init",b,d,!0,!1)):(d=b,g.finishProperty("init",b,d,!1,!0)):(c=ga(),O("("),a=ba,a.type!==Y.Identifier?(O(")"),P(a),d=V([])):(e=[xa()],O(")"),d=V(e,a)),g.finishProperty("set",c,d,!1,!1)):(c=ga(),O("("),O(")"),d=V([]),g.finishProperty("get",c,d,!1,!1));if(a.type===Y.EOF||a.type===Y.Punctuator)K(a);else{if(c=ga(),
R(":"))return z(),d=ra(),g.finishProperty("init",c,d,!1,!1);if(R("("))return d=da(),g.finishProperty("init",c,d,!0,!1);K(z())}}function Aa(a){var c,b,d=[],e={},g=String,f=new F;for(!0!==a&&O("{");!R("}");)a=la(),c=a.key.type===fa.Identifier?a.key.name:g(a.key.value),b="init"===a.kind?qa.Data:"get"===a.kind?qa.Get:qa.Set,c="$"+c,Object.prototype.hasOwnProperty.call(e,c)?(e[c]===qa.Data?ha&&b===qa.Data?M(na.StrictDuplicateProperty):b!==qa.Data&&M(na.AccessorDataProperty):b===qa.Data?M(na.AccessorDataProperty):
e[c]&b&&M(na.AccessorGetSet),e[c]|=b):e[c]=b,d.push(a),R("}")||S();return O("}"),f.finishObjectExpression(d)}function ta(){var a,c,b,d;if(R("("))return O("("),R(")")?(z(),Ra.ArrowParameterPlaceHolder):(++ca.parenthesisCount,d=ua(),O(")"),d);if(R("[")){var e=[],g=new F;for(O("[");!R("]");)R(",")?(z(),e.push(null)):(e.push(ra()),R("]")||O(","));return z(),g.finishArrayExpression(e)}if(R("{"))return Aa();if(a=ba.type,d=new F,a===Y.Identifier)b=d.finishIdentifier(z().value);else if(a===Y.StringLiteral||
a===Y.NumericLiteral)ha&&ba.octal&&P(ba,na.StrictOctalLiteral),b=d.finishLiteral(z());else if(a===Y.Keyword){if(aa("function")){var f,l,m,n;a=null;c=[];b=[];d=new F;return Q("function"),R("(")||(a=xa()),l=Ta(g),c=l.params,b=l.defaults,e=l.stricted,g=l.firstRestricted,l.message&&(f=l.message),n=ha,m=Ja(),ha&&g&&K(g,f),ha&&e&&P(e,f),ha=n,d.finishFunctionExpression(a,c,b,m)}aa("this")?(z(),b=d.finishThisExpression()):K(z())}else a===Y.BooleanLiteral?(c=z(),c.value="true"===c.value.toLowerCase(),b=d.finishLiteral(c)):
a===Y.NullLiteral?(c=z(),c.value=null,b=d.finishLiteral(c)):R("/")||R("/\x3d")?(b="undefined"!=typeof U.tokens?d.finishLiteral(w()):d.finishLiteral(u()),B()):K(z());return b}function pa(){var a=[];if(O("("),!R(")"))for(;sa>N&&(a.push(ra()),!R(")"));)S();return O(")"),a}function wa(){var a,c=new F;return a=z(),a.type===Y.Identifier||a.type===Y.Keyword||a.type===Y.BooleanLiteral||a.type===Y.NullLiteral||K(a),c.finishIdentifier(a.value)}function oa(){var a;return O("["),a=ua(),O("]"),a}function ma(){var a,
c,b=new F;Q("new");var d,e,g;k(ca.allowIn,"callee of new expression always allow in keyword.");g=ba;for(d=aa("new")?ma():ta();;)if(R("["))e=oa(),d=(new G(g)).finishMemberExpression("[",d,e);else{if(!R("."))break;e=(O("."),wa());d=(new G(g)).finishMemberExpression(".",d,e)}return a=d,c=R("(")?pa():[],b.finishNewExpression(a,c)}function ia(){var a,c,b=ba,d,e,g,f=ca.allowIn;g=ba;ca.allowIn=!0;for(d=aa("new")?ma():ta();;)if(R("."))e=(O("."),wa()),d=(new G(g)).finishMemberExpression(".",d,e);else if(R("("))e=
pa(),d=(new G(g)).finishCallExpression(d,e);else{if(!R("["))break;e=oa();d=(new G(g)).finishMemberExpression("[",d,e)}return a=(ca.allowIn=f,d),ba.type===Y.Punctuator&&(!R("++")&&!R("--")||I()||(T(a)||M(na.InvalidLHSInAssignment),c=z(),a=(new G(b)).finishPostfixExpression(c.value,a))),a}function ja(){var a,c,b;return ba.type!==Y.Punctuator&&ba.type!==Y.Keyword?c=ia():R("++")||R("--")?(b=ba,a=z(),c=ja(),T(c)||M(na.InvalidLHSInAssignment),c=(new G(b)).finishUnaryExpression(a.value,c)):R("+")||R("-")||
R("~")||R("!")?(b=ba,a=z(),c=ja(),c=(new G(b)).finishUnaryExpression(a.value,c)):aa("delete")||aa("void")||aa("typeof")?(b=ba,a=z(),c=ja(),c=(new G(b)).finishUnaryExpression(a.value,c),ha&&"delete"===c.operator&&c.argument.type===fa.Identifier&&M(na.StrictDelete)):c=ia(),c}function za(a,c){var b=0;if(a.type!==Y.Punctuator&&a.type!==Y.Keyword)return 0;switch(a.value){case "||":b=1;break;case "\x26\x26":b=2;break;case "|":b=3;break;case "^":b=4;break;case "\x26":b=5;break;case "\x3d\x3d":case "!\x3d":case "\x3d\x3d\x3d":case "!\x3d\x3d":b=
6;break;case "\x3c":case "\x3e":case "\x3c\x3d":case "\x3e\x3d":case "instanceof":b=7;break;case "in":b=c?7:0;break;case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":b=8;break;case "+":case "-":b=9;break;case "*":case "/":case "%":b=11}return b}function Ba(a){var c,b,d,e,g,f,l,m;e=[];g=[];f=0;l={paramSet:{}};c=0;for(b=a.length;b>c;c+=1)if(d=a[c],d.type===fa.Identifier)e.push(d),g.push(null),Ga(l,d,d.name);else{if(d.type!==fa.AssignmentExpression)return null;e.push(d.left);g.push(d.right);++f;Ga(l,
d.left,d.left.name)}return l.message===na.StrictParamDupe&&(m=ha?l.stricted:l.firstRestricted,K(m,l.message)),0===f&&(g=[]),{params:e,defaults:g,rest:null,stricted:l.stricted,firstRestricted:l.firstRestricted,message:l.message}}function ra(){var a,c,b,d,e,g;a=ca.parenthesisCount;c=g=ba;var f,l,m,n;b=ba;var h;var q,r,k,t,v;if((h=ba,q=ja(),q!==Ra.ArrowParameterPlaceHolder)&&(r=ba,k=za(r,ca.allowIn),0!==k)){r.prec=k;z();h=[h,ba];v=ja();for(t=[q,r,v];0<(k=za(ba,ca.allowIn));){for(;2<t.length&&k<=t[t.length-
2].prec;)v=t.pop(),r=t.pop().value,q=t.pop(),h.pop(),q=(new G(h[h.length-1])).finishBinaryExpression(r,q,v),t.push(q);r=z();r.prec=k;t.push(r);h.push(ba);q=ja();t.push(q)}k=t.length-1;q=t[k];for(h.pop();1<k;)q=(new G(h.pop())).finishBinaryExpression(t[k-1].value,t[k-2],q),k-=2}h=q;b=(f=h,f===Ra.ArrowParameterPlaceHolder?f:(R("?")&&(z(),l=ca.allowIn,ca.allowIn=!0,m=ra(),ca.allowIn=l,O(":"),n=ra(),f=(new G(b)).finishConditionalExpression(f,m,n)),f));if(b!==Ra.ArrowParameterPlaceHolder&&!R("\x3d\x3e")||
ca.parenthesisCount!==a&&ca.parenthesisCount!==a+1||(b.type===fa.Identifier?e=Ba([b]):b.type===fa.AssignmentExpression?e=Ba([b]):b.type===fa.SequenceExpression?e=Ba(b.expressions):b===Ra.ArrowParameterPlaceHolder&&(e=Ba([])),!e)){var u;g=((ba.type!==Y.Punctuator?!1:(u=ba.value,"\x3d"===u||"*\x3d"===u||"/\x3d"===u||"%\x3d"===u||"+\x3d"===u||"-\x3d"===u||"\x3c\x3c\x3d"===u||"\x3e\x3e\x3d"===u||"\x3e\x3e\x3e\x3d"===u||"\x26\x3d"===u||"^\x3d"===u||"|\x3d"===u))&&(T(b)||M(na.InvalidLHSInAssignment),c=
z(),d=ra(),b=(new G(g)).finishAssignmentExpression(c.value,b,d)),b)}else{c=e;d=new G(g);var w,x;g=(O("\x3d\x3e"),w=ha,x=R("{")?Ja():ra(),ha&&c.firstRestricted&&K(c.firstRestricted,c.message),ha&&c.stricted&&P(c.stricted,c.message),ha=w,d.finishArrowFunctionExpression(c.params,c.defaults,x,x.type!==fa.BlockStatement))}return g}function ua(){var a,c=ba;if(a=ra(),R(",")){for(a=[a];sa>N&&R(",");)z(),a.push(ra());a=(new G(c)).finishSequenceExpression(a)}return a}function xa(){var a,c=new F;return a=z(),
a.type!==Y.Identifier&&K(a),c.finishIdentifier(a.value)}function Ha(a){var c,b=null,d=new F;return c=xa(),"const"===a?(O("\x3d"),b=ra()):R("\x3d")&&(z(),b=ra()),d.finishVariableDeclarator(c,b)}function Ia(a){var c=[];do{if(c.push(Ha(a)),!R(","))break;z()}while(sa>N);return c}function Da(a){var c,b,d,e,g=ba.type;if(g===Y.EOF&&K(ba),g===Y.Punctuator&&"{"===ba.value){if(a){O("{");var f,m,n,h,q;f=ba;f=(m=N,n=ea,h=ka,z(),q=R(":"),ba=f,N=m,ea=n,ka=h,q);if(ba.type!==Y.Identifier&&ba.type!==Y.StringLiteral||
!f){f=new F;for(var r=[];sa>N&&!R("}")&&(e=Ma(),"undefined"!=typeof e);)r.push(e);f=(O("}"),f.finishBlockStatement(r))}else f=Aa(!0);return f}return Aa()}if(e=new F,g===Y.Punctuator)switch(ba.value){case ";":return f=new F,O(";"),f.finishEmptyStatement();case "(":return f=ua(),X(),e.finishExpressionStatement(f)}else if(g===Y.Keyword)switch(ba.value.toLowerCase()){case "break":var k;f=null;return Q("break"),59===W.charCodeAt(N)?(z(),ca.inIteration||ca.inSwitch||L(na.IllegalBreak),e.finishBreakStatement(null)):
I()?(ca.inIteration||ca.inSwitch||L(na.IllegalBreak),e.finishBreakStatement(null)):(ba.type===Y.Identifier&&(f=xa(),k="$"+f.name,Object.prototype.hasOwnProperty.call(ca.labelSet,k)||L(na.UnknownLabel,f.name)),X(),null!==f||ca.inIteration||ca.inSwitch||L(na.IllegalBreak),e.finishBreakStatement(f));case "continue":var t;f=null;return Q("continue"),59===W.charCodeAt(N)?(z(),ca.inIteration||L(na.IllegalContinue),e.finishContinueStatement(null)):I()?(ca.inIteration||L(na.IllegalContinue),e.finishContinueStatement(null)):
(ba.type===Y.Identifier&&(f=xa(),t="$"+f.name,Object.prototype.hasOwnProperty.call(ca.labelSet,t)||L(na.UnknownLabel,f.name)),X(),null!==f||ca.inIteration||L(na.IllegalContinue),e.finishContinueStatement(f));case "for":var v,u;h=ca.allowIn;q=m=n=null;Q("for");O("(");if(R(";"))z();else{if(aa("var")){ca.allowIn=!1;var w,x;q=new F;q=(w=z(),x=Ia(),q.finishVariableDeclaration(x,w.value));ca.allowIn=h;1===q.declarations.length&&aa("in")&&(z(),f=q,r=ua(),q=null)}else ca.allowIn=!1,q=ua(),ca.allowIn=h,aa("in")&&
(T(q)||M(na.InvalidLHSInForIn),z(),f=q,r=ua(),q=null);"undefined"==typeof f&&O(";")}return"undefined"==typeof f&&(R(";")||(m=ua()),O(";"),R(")")||(n=ua())),O(")"),u=ca.inIteration,ca.inIteration=!0,v=Da(!0),ca.inIteration=u,"undefined"==typeof f?e.finishForStatement(q,m,n,v):e.finishForInStatement(f,r,v);case "function":return Xa(e);case "if":var y,C,A;return Q("if"),O("("),y=ua(),O(")"),C=Da(!0),aa("else")?(z(),A=Da(!0)):A=null,e.finishIfStatement(y,C,A);case "return":return f=null,Q("return"),ca.inFunctionBody||
M(na.IllegalReturn),32===W.charCodeAt(N)&&l(W.charCodeAt(N+1))?(f=ua(),X(),e.finishReturnStatement(f)):I()?e.finishReturnStatement(null):(R(";")||R("}")||ba.type===Y.EOF||(f=ua()),X(),e.finishReturnStatement(f));case "var":var D;return Q("var"),D=Ia(),X(),e.finishVariableDeclaration(D,"var")}return c=ua(),c.type===fa.Identifier&&R(":")?(z(),d="$"+c.name,Object.prototype.hasOwnProperty.call(ca.labelSet,d)&&L(na.Redeclaration,"Label",c.name),ca.labelSet[d]=!0,b=Da(!1),delete ca.labelSet[d],e.finishLabeledStatement(c,
b)):(X(),e.finishExpressionStatement(c))}function Ja(){var a,c,b,d,e,g,f=[],l=new F;for(O("{");sa>N&&ba.type===Y.StringLiteral&&(c=ba,a=Ma(),f.push(a),a.expression.type===fa.Literal);)b=W.slice(c.start+1,c.end-1),"use strict"===b?(ha=!0,d&&P(d,na.StrictOctalLiteral)):!d&&c.octal&&(d=c);c=ca.labelSet;b=ca.inIteration;d=ca.inSwitch;e=ca.inFunctionBody;g=ca.parenthesizedCount;ca.labelSet={};ca.inIteration=!1;ca.inSwitch=!1;ca.inFunctionBody=!0;for(ca.parenthesizedCount=0;sa>N&&!R("}")&&(a=Ma(),"undefined"!=
typeof a);)f.push(a);return O("}"),ca.labelSet=c,ca.inIteration=b,ca.inSwitch=d,ca.inFunctionBody=e,ca.parenthesizedCount=g,l.finishBlockStatement(f)}function Ga(a,c,b){b="$"+b;ha?Object.prototype.hasOwnProperty.call(a.paramSet,b)&&(a.stricted=c,a.message=na.StrictParamDupe):a.firstRestricted||Object.prototype.hasOwnProperty.call(a.paramSet,b)&&(a.firstRestricted=c,a.message=na.StrictParamDupe);a.paramSet[b]=!0}function Na(a){var c,b,d;return c=ba,b=xa(),Ga(a,c,c.value),R("\x3d")&&(z(),d=ra(),++a.defaultCount),
a.params.push(b),a.defaults.push(d),!R(")")}function Ta(a){if(a={params:[],defaultCount:0,defaults:[],firstRestricted:a},O("("),!R(")"))for(a.paramSet={};sa>N&&Na(a);)O(",");return O(")"),0===a.defaultCount&&(a.defaults=[]),{params:a.params,defaults:a.defaults,stricted:a.stricted,firstRestricted:a.firstRestricted,message:a.message}}function Xa(){var a,c,b,d,e,g,f,l=[],m=[],n=new F;return Q("function"),a=xa(),d=Ta(e),l=d.params,m=d.defaults,b=d.stricted,e=d.firstRestricted,d.message&&(g=d.message),
f=ha,c=Ja(),ha&&e&&K(e,g),ha&&b&&P(b,g),ha=f,n.finishFunctionDeclaration(a,l,m,c)}function Ma(){return ba.type===Y.Keyword?"function"===ba.value.toLowerCase()?Xa():Da(!1):ba.type!==Y.EOF?Da(!1):void 0}function Oa(){var a,c,b,d=[];for(a=0;a<U.tokens.length;++a)c=U.tokens[a],b={type:c.type,value:c.value},c.regex&&(b.regex={pattern:c.regex.pattern,flags:c.regex.flags}),U.range&&(b.range=c.range),U.loc&&(b.loc=c.loc),d.push(b);U.tokens=d}var Y,va,Ca,fa,Ra,qa,na,Va,W,ha,N,ea,ka,sa,ba,ca,U;Y={BooleanLiteral:1,
EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9};va={};va[Y.BooleanLiteral]="Boolean";va[Y.EOF]="\x3cend\x3e";va[Y.Identifier]="Identifier";va[Y.Keyword]="Keyword";va[Y.NullLiteral]="Null";va[Y.NumericLiteral]="Numeric";va[Y.Punctuator]="Punctuator";va[Y.StringLiteral]="String";va[Y.RegularExpression]="RegularExpression";Ca="( { [ in typeof instanceof new return case delete throw void \x3d +\x3d -\x3d *\x3d /\x3d %\x3d \x3c\x3c\x3d \x3e\x3e\x3d \x3e\x3e\x3e\x3d \x26\x3d |\x3d ^\x3d , + - * / % ++ -- \x3c\x3c \x3e\x3e \x3e\x3e\x3e \x26 | ^ ! ~ \x26\x26 || ? : \x3d\x3d\x3d \x3d\x3d \x3e\x3d \x3c\x3d \x3c \x3e !\x3d !\x3d\x3d".split(" ");
fa={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",
FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator"};Ra={ArrowParameterPlaceHolder:{type:"ArrowParameterPlaceHolder"}};
qa={Data:1,Get:2,Set:4};na={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",
MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",
StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",
AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"};Va={NonAsciiIdentifierStart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"),
NonAsciiIdentifierPart:RegExp("[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]")};
G.prototype=F.prototype={processComment:function(){var a,c,b,d,e,g=U.bottomRightStack,f=g[g.length-1];if(!(this.type===fa.Program&&0<this.body.length)){if(0<U.trailingComments.length){b=[];for(d=U.trailingComments.length-1;0<=d;--d)e=U.trailingComments[d],e.range[0]>=this.range[1]&&(b.unshift(e),U.trailingComments.splice(d,1));U.trailingComments=[]}else f&&f.trailingComments&&f.trailingComments[0].range[0]>=this.range[1]&&(b=f.trailingComments,delete f.trailingComments);if(f)for(;f&&f.range[0]>=this.range[0];)a=
f,f=g.pop();if(a)a.leadingComments&&a.leadingComments[a.leadingComments.length-1].range[1]<=this.range[0]&&(this.leadingComments=a.leadingComments,a.leadingComments=void 0);else if(0<U.leadingComments.length)for(c=[],d=U.leadingComments.length-1;0<=d;--d)e=U.leadingComments[d],e.range[1]<=this.range[0]&&(c.unshift(e),U.leadingComments.splice(d,1));c&&0<c.length&&(this.leadingComments=c);b&&0<b.length&&(this.trailingComments=b);g.push(this)}},finish:function(){U.range&&(this.range[1]=N);U.loc&&(this.loc.end=
new C,U.source&&(this.loc.source=U.source));U.attachComment&&this.processComment()},finishArrayExpression:function(a){return this.type=fa.ArrayExpression,this.elements=a,this.finish(),this},finishAssignmentExpression:function(a,c,b){return this.type=fa.AssignmentExpression,this.operator=a,this.left=c,this.right=b,this.finish(),this},finishBinaryExpression:function(a,c,b){return this.type="||"===a||"\x26\x26"===a?fa.LogicalExpression:fa.BinaryExpression,this.operator=a,this.left=c,this.right=b,this.finish(),
this},finishBlockStatement:function(a){return this.type=fa.BlockStatement,this.body=a,this.finish(),this},finishBreakStatement:function(a){return this.type=fa.BreakStatement,this.label=a,this.finish(),this},finishCallExpression:function(a,c){return this.type=fa.CallExpression,this.callee=a,this.arguments=c,this.finish(),this},finishConditionalExpression:function(a,c,b){return this.type=fa.ConditionalExpression,this.test=a,this.consequent=c,this.alternate=b,this.finish(),this},finishContinueStatement:function(a){return this.type=
fa.ContinueStatement,this.label=a,this.finish(),this},finishEmptyStatement:function(){return this.type=fa.EmptyStatement,this.finish(),this},finishExpressionStatement:function(a){return this.type=fa.ExpressionStatement,this.expression=a,this.finish(),this},finishForStatement:function(a,c,b,d){return this.type=fa.ForStatement,this.init=a,this.test=c,this.update=b,this.body=d,this.finish(),this},finishForInStatement:function(a,c,b){return this.type=fa.ForInStatement,this.left=a,this.right=c,this.body=
b,this.each=!1,this.finish(),this},finishFunctionDeclaration:function(a,c,b,d){return this.type=fa.FunctionDeclaration,this.id=a,this.params=c,this.defaults=b,this.body=d,this.rest=null,this.generator=!1,this.expression=!1,this.finish(),this},finishFunctionExpression:function(a,c,b,d){return this.type=fa.FunctionExpression,this.id=a,this.params=c,this.defaults=b,this.body=d,this.rest=null,this.generator=!1,this.expression=!1,this.finish(),this},finishIdentifier:function(a){return this.type=fa.Identifier,
this.name=a,this.finish(),this},finishIfStatement:function(a,c,b){return this.type=fa.IfStatement,this.test=a,this.consequent=c,this.alternate=b,this.finish(),this},finishLiteral:function(a){return this.type=fa.Literal,this.value=a.value,this.raw=W.slice(a.start,a.end),a.regex&&(this.regex=a.regex),this.finish(),this},finishMemberExpression:function(a,c,b){return this.type=fa.MemberExpression,this.computed="["===a,this.object=c,this.property=b,this.finish(),this},finishObjectExpression:function(a){return this.type=
fa.ObjectExpression,this.properties=a,this.finish(),this},finishPostfixExpression:function(a,c){return this.type=fa.UpdateExpression,this.operator=a,this.argument=c,this.prefix=!1,this.finish(),this},finishProgram:function(a){return this.type=fa.Program,this.body=a,this.finish(),this},finishProperty:function(a,c,b,d,e){return this.type=fa.Property,this.key=c,this.value=b,this.kind=a,this.method=d,this.shorthand=e,this.finish(),this},finishReturnStatement:function(a){return this.type=fa.ReturnStatement,
this.argument=a,this.finish(),this},finishUnaryExpression:function(a,c){return this.type="++"===a||"--"===a?fa.UpdateExpression:fa.UnaryExpression,this.operator=a,this.argument=c,this.prefix=!0,this.finish(),this},finishVariableDeclaration:function(a,c){return this.type=fa.VariableDeclaration,this.declarations=a,this.kind=c,this.finish(),this},finishVariableDeclarator:function(a,c){return this.type=fa.VariableDeclarator,this.id=a,this.init=c,this.finish(),this}};h.version="2.0.0-dev";h.tokenize=function(a,
c){var b,d;b=String;"string"==typeof a||a instanceof String||(a=b(a));W=a;N=0;ea=0<W.length?1:0;ka=0;sa=W.length;ba=null;ca={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};U={};c=c||{};c.tokens=!0;U.tokens=[];U.tokenize=!0;U.openParenToken=-1;U.openCurlyToken=-1;U.range="boolean"==typeof c.range&&c.range;U.loc="boolean"==typeof c.loc&&c.loc;"boolean"==typeof c.comment&&c.comment&&(U.comments=[]);"boolean"==typeof c.tolerant&&c.tolerant&&(U.errors=[]);try{if(B(),
ba.type===Y.EOF)return U.tokens;for(z();ba.type!==Y.EOF;)try{z()}catch(Ua){if(U.errors){U.errors.push(Ua);break}throw Ua;}Oa();d=U.tokens;"undefined"!=typeof U.comments&&(d.comments=U.comments);"undefined"!=typeof U.errors&&(d.errors=U.errors)}catch(Ua){throw Ua;}finally{U={}}return d};h.parse=function(a,c){var b,d;d=String;"string"==typeof a||a instanceof String||(a=d(a));W=a;N=0;ea=0<W.length?1:0;ka=0;sa=W.length;ba=null;ca={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,inIteration:!1,
inSwitch:!1,lastCommentStart:-1};U={};"undefined"!=typeof c&&(U.range="boolean"==typeof c.range&&c.range,U.loc="boolean"==typeof c.loc&&c.loc,U.attachComment="boolean"==typeof c.attachComment&&c.attachComment,U.loc&&null!==c.source&&void 0!==c.source&&(U.source=d(c.source)),"boolean"==typeof c.tokens&&c.tokens&&(U.tokens=[]),"boolean"==typeof c.comment&&c.comment&&(U.comments=[]),"boolean"==typeof c.tolerant&&c.tolerant&&(U.errors=[]),U.attachComment&&(U.range=!0,U.comments=[],U.bottomRightStack=
[],U.trailingComments=[],U.leadingComments=[]));try{var e;n();B();e=new F;ha=!1;var g,f,l,m;for(d=[];sa>N&&(f=ba,f.type===Y.StringLiteral)&&(g=Ma(),d.push(g),g.expression.type===fa.Literal);)l=W.slice(f.start+1,f.end-1),"use strict"===l?(ha=!0,m&&P(m,na.StrictOctalLiteral)):!m&&f.octal&&(m=f);for(;sa>N&&(g=Ma(),"undefined"!=typeof g);)d.push(g);b=e.finishProgram(d);"undefined"!=typeof U.comments&&(b.comments=U.comments);"undefined"!=typeof U.tokens&&(Oa(),b.tokens=U.tokens);"undefined"!=typeof U.errors&&
(b.errors=U.errors)}catch(hb){throw hb;}finally{U={}}return b};h.Syntax=function(){var a,c={};"function"==typeof Object.create&&(c=Object.create(null));for(a in fa)fa.hasOwnProperty(a)&&(c[a]=fa[a]);return"function"==typeof Object.freeze&&Object.freeze(c),c}()})},"esri/arcade/arcadeCompiler":function(){define("require exports ../geometry/Polygon ../graphic ../geometry/Polyline ../geometry/Point ../geometry/Extent ../geometry/Multipoint ../SpatialReference ./languageUtils ./treeAnalysis ./Dictionary ./Feature ./functions/date ./functions/string ./functions/maths ./functions/geometry ./functions/stats ./ImmutablePathArray ./ImmutablePointArray ../geometry/Geometry".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A){function z(a,c,b){try{return b(a,null,c)}catch(Aa){throw Aa;}}function B(a,b){try{switch(b.type){case "EmptyStatement":return"lc.voidOperation";case "VariableDeclarator":return G(a,b);case "VariableDeclaration":for(var d=[],e=0;e<b.declarations.length;e++)d.push(B(a,b.declarations[e]));return d.join("\n")+" \n lastStatement\x3d  lc.voidOperation; \n";case "BlockStatement":return F(a,b);case "FunctionDeclaration":var g=b.id.name.toLowerCase(),f={applicationCache:void 0===
a.applicationCache?null:a.applicationCache,spatialReference:a.spatialReference,console:a.console,symbols:a.symbols,localScope:{_SymbolsMap:{}},depthCounter:a.depthCounter+1,globalScope:a.globalScope};if(64<f.depthCounter)throw Error("Exceeded maximum function depth");for(var d="new lc.SizzleFunction( lang.functionDepthchecker(function() { var lastStatement \x3d lc.voidOperation; var lscope \x3d [];\n ",l=0;l<b.params.length;l++){var m=b.params[l].name.toLowerCase(),n=P(m,a);f.localScope._SymbolsMap[m]=
n;d+="lscope['"+n+"']\x3darguments["+l.toString()+"];\n"}(d+=F(f,b.body)+"\n return lastStatement; }, runtimeCtx))",d+="\n lastStatement \x3d lc.voidOperation; \n",void 0!==a.globalScope[g])?e="gscope['"+g+"']\x3d"+d:void 0!==a.globalScope._SymbolsMap[g]?e="gscope['"+a.globalScope._SymbolsMap[g]+"']\x3d"+d:(n=P(g,a),e=(a.globalScope._SymbolsMap[g]=n,"gscope['"+n+"']\x3d"+d));return e;case "ReturnStatement":var h;h=null===b.argument?"return lc.voidOperation;":"return "+B(a,b.argument)+";";return h;
case "IfStatement":if("AssignmentExpression"===b.test.type||"UpdateExpression"===b.test.type)throw Error(c.nodeErrorMessage(b.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var q=B(a,b.test),r=O(a),k="var "+r+" \x3d "+q+";\n if ("+r+" \x3d\x3d\x3d true) {\n"+E(a,b.consequent)+"\n }\n";return k+=null!==b.alternate?"else if ("+r+"\x3d\x3d\x3dfalse)   { \n"+E(a,b.alternate)+"}\n":"else if ("+r+"\x3d\x3d\x3dfalse) { \n lastStatement \x3d lc.voidOperation;\n }\n",k+="else { lang.error({type: '"+
b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION'); \n}\n";case "ExpressionStatement":return"AssignmentExpression"===b.expression.type?"lastStatement \x3d lc.voidOperation; "+B(a,b.expression)+" \n ":"lastStatement \x3d "+B(a,b.expression)+";";case "AssignmentExpression":return D(a,b);case "UpdateExpression":return C(a,b);case "BreakStatement":return"break;";case "ContinueStatement":return"continue;";case "ForStatement":d="lastStatement \x3d lc.voidOperation; \n";null!==b.init&&(d+=B(a,b.init));
var t=O(a),v=O(a);return d+="var "+t+" \x3d true;",d+="\n do { ",null!==b.update&&(d+=" if ("+t+"\x3d\x3d\x3dfalse) {\n "+B(a,b.update)+"  \n}\n "+t+"\x3dfalse; \n"),null!==b.test&&(d+="var "+v+" \x3d "+B(a,b.test)+";",d+="if ("+v+"\x3d\x3d\x3dfalse) { break; } else if ("+v+"!\x3d\x3dtrue) { lang.error({type: '"+b.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION');   }\n"),d+=B(a,b.body),null!==b.update&&(d+="\n "+B(a,b.update)),d+="\n"+t+" \x3d true; \n} while(true);  lastStatement \x3d lc.voidOperation;";
case "ForInStatement":var u=O(a),w=O(a),x=O(a),y="var "+u+" \x3d "+B(a,b.right)+";\n";"VariableDeclaration"===b.left.type&&(y+=B(a,b.left));var z="VariableDeclaration"===b.left.type?b.left.declarations[0].id.name:b.left.name,z=z.toLowerCase(),d="";return null!==a.localScope&&(void 0!==a.localScope[z]?d="lscope['"+z+"']":void 0!==a.localScope._SymbolsMap[z]&&(d="lscope['"+a.localScope._SymbolsMap[z]+"']")),""===d&&(void 0!==a.globalScope[z]?d="gscope['"+z+"']":void 0!==a.globalScope._SymbolsMap[z]&&
(d="gscope['"+a.globalScope._SymbolsMap[z]+"']")),y+="if ("+u+"\x3d\x3d\x3dnull) {  lastStatement \x3d lc.voidOperation; }\n ",y+="else if (lc.isArray("+u+") || lc.isString("+u+")) {",y+="var "+w+"\x3d"+u+".length; \n",y+="for(var "+x+"\x3d0; "+x+"\x3c"+w+"; "+x+"++) {\n",y+=d+"\x3d"+x+";\n",y+=B(a,b.body),y+="\n}\n",y+=" lastStatement \x3d lc.voidOperation; \n",y+=" \n}\n",y+="else if (lc.isImmutableArray("+u+")) {",y+="var "+w+"\x3d"+u+".length(); \n",y+="for(var "+x+"\x3d0; "+x+"\x3c"+w+"; "+x+
"++) {\n",y+=d+"\x3d"+x+";\n",y+=B(a,b.body),y+="\n}\n",y+=" lastStatement \x3d lc.voidOperation; \n",y+=" \n}\n",y+="else if (( "+u+" instanceof lang.Dictionary) || ( "+u+" instanceof lang.Feature)) {",y+="var "+w+"\x3d"+u+".keys(); \n",y+="for(var "+x+"\x3d0; "+x+"\x3c"+w+".length; "+x+"++) {\n",y+=d+"\x3d"+w+"["+x+"];\n",y+=B(a,b.body),y+="\n}\n",y+=" lastStatement \x3d lc.voidOperation; \n",y+=" \n}\n",y+="else { lastStatement \x3d lc.voidOperation; } \n";case "Identifier":return J(a,b);case "MemberExpression":var A;
try{d=void 0,A=(d=!0===b.computed?B(a,b.property):"'"+b.property.name+"'","lang.member("+B(a,b.object)+","+d+")")}catch(Ca){throw Ca;}return A;case "Literal":return null===b.value||void 0===b.value?"null":JSON.stringify(b.value);case "ThisExpression":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "CallExpression":try{if("Identifier"!==b.callee.type)throw Error(c.nodeErrorMessage(b,"RUNTIME","ONLYNODESSUPPORTED"));var V=b.callee.name.toLowerCase(),e="";if(null!==a.localScope&&(void 0!==
a.localScope[V]?e="lscope['"+V+"']":void 0!==a.localScope._SymbolsMap[V]&&(e="lscope['"+a.localScope._SymbolsMap[V]+"']")),""===e&&(void 0!==a.globalScope[V]?e="gscope['"+V+"']":void 0!==a.globalScope._SymbolsMap[V]&&(e="gscope['"+a.globalScope._SymbolsMap[V]+"']")),""!==e){g="[";for(f=0;f<b.arguments.length;f++)0<f&&(g+=", "),g+=B(a,b.arguments[f]);d=(g+="]","lang.callfunc("+e+","+g+",runtimeCtx)")}else throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTFOUND"));}catch(Ca){throw Ca;}return d;case "UnaryExpression":var da;
try{da="lang.unary("+B(a,b.argument)+",'"+b.operator+"')"}catch(Ca){throw Ca;}return da;case "BinaryExpression":var L;try{L="lang.binary("+B(a,b.left)+","+B(a,b.right)+",'"+b.operator+"')"}catch(Ca){throw Ca;}return L;case "LogicalExpression":var I;try{if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)throw Error(c.nodeErrorMessage(b.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===b.right.type||"UpdateExpression"===b.right.type)throw Error(c.nodeErrorMessage(b.right,
"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));I="lang.logical("+B(a,b.left)+","+B(a,b.right)+",'"+b.operator+"')"}catch(Ca){throw Ca;}return I;case "ConditionalExpression":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{d=[];for(e=0;e<b.elements.length;e++)"Literal"===b.elements[e].type?d.push(B(a,b.elements[e])):d.push("lang.aCheck("+B(a,b.elements[e])+",'ArrayExpression')");l="["+d.join(",")+"]"}catch(Ca){throw Ca;}return l;case "ObjectExpression":d="lang.dictionary([";
for(e=0;e<b.properties.length;e++){var ga=b.properties[e],K="Identifier"===ga.key.type?"'"+ga.key.name+"'":B(a,ga.key),H=B(a,ga.value);0<e&&(d+=",");d+="lang.strCheck("+K+",'ObjectExpression'),lang.aCheck("+H+", 'ObjectExpression')"}return d+="])";case "Property":throw Error("Should not get here");case "Array":throw Error(c.nodeErrorMessage(b,"RUNTIME","NOTSUPPORTED"));default:throw Error(c.nodeErrorMessage(b,"RUNTIME","UNREOGNISED"));}}catch(Ca){throw Ca;}}function C(a,c){var b=null,d="";if("MemberExpression"===
c.argument.type)return b=B(a,c.argument.object),d=!0===c.argument.computed?B(a,c.argument.property):"'"+c.argument.property.name+"'","lang.memberupdate("+b+","+d+",'"+c.operator+"',"+c.prefix+")";if(b=c.argument.name.toLowerCase(),null!==a.localScope){if(void 0!==a.localScope[b])return"lang.update(lscope, '"+b+"','"+c.operator+"',"+c.prefix+")";if(void 0!==a.localScope._SymbolsMap[b])return"lang.update(lscope, '"+a.localScope._SymbolsMap[b]+"','"+c.operator+"',"+c.prefix+")"}if(void 0!==a.globalScope[b])return"lang.update(gscope, '"+
b+"','"+c.operator+"',"+c.prefix+")";if(void 0!==a.globalScope._SymbolsMap[b])return"lang.update(gscope, '"+a.globalScope._SymbolsMap[b]+"','"+c.operator+"',"+c.prefix+")";throw Error("Variable not recognised");}function D(a,c){var b=B(a,c.right),d=null,e="";if("MemberExpression"===c.left.type)return d=B(a,c.left.object),e=!0===c.left.computed?B(a,c.left.property):"'"+c.left.property.name+"'","lang.assignmember("+d+","+e+",'"+c.operator+"',"+b+");";if(d=c.left.name.toLowerCase(),null!==a.localScope){if(void 0!==
a.localScope[d])return"lscope['"+d+"']\x3dlang.assign("+b+",'"+c.operator+"', lscope['"+d+"']); ";if(void 0!==a.localScope._SymbolsMap[d])return"lscope['"+a.localScope._SymbolsMap[d]+"']\x3dlang.assign("+b+",'"+c.operator+"', lscope['"+a.localScope._SymbolsMap[d]+"']); "}if(void 0!==a.globalScope[d])return"gscope['"+d+"']\x3dlang.assign("+b+",'"+c.operator+"', gscope['"+d+"']); ";if(void 0!==a.globalScope._SymbolsMap[d])return"gscope['"+a.globalScope._SymbolsMap[d]+"']\x3dlang.assign("+b+",'"+c.operator+
"', gscope['"+a.globalScope._SymbolsMap[d]+"']); ";throw Error("Variable not recognised");}function E(a,c){return"BlockStatement"===c.type?B(a,c):"ReturnStatement"===c.type?B(a,c):"BreakStatement"===c.type?B(a,c):"ContinueStatement"===c.type?B(a,c):"UpdateExpression"===c.type?"lastStatement \x3d "+B(a,c)+";":"ExpressionStatement"===c.type?B(a,c):"ObjectExpression"===c.type?"lastStatement \x3d "+B(a,c)+";":B(a,c)}function F(a,c){for(var b="",d=0;d<c.body.length;d++)b+="ReturnStatement"===c.body[d].type?
B(a,c.body[d])+" \n":"BreakStatement"===c.body[d].type?B(a,c.body[d])+" \n":"ContinueStatement"===c.body[d].type?B(a,c.body[d])+" \n":"UpdateExpression"===c.body[d].type?"lastStatement \x3d "+B(a,c.body[d])+"; \n":"ObjectExpression"===c.body[d].type?"lastStatement \x3d "+B(a,c.body[d])+"; \n":B(a,c.body[d])+" \n";return b}function G(a,c){var b=null===c.init?null:B(a,c.init);b===d.voidOperation&&(b=null);var e=c.id.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[e])return"lscope['"+
e+"']\x3d"+b+";";if(void 0!==a.localScope._SymbolsMap[e])return"lscope['"+a.localScope._SymbolsMap[e]+"']\x3d"+b+";";var g=P(e,a);return a.localScope._SymbolsMap[e]=g,"lscope['"+g+"']\x3d"+b+";"}if(void 0!==a.globalScope[e])return"gscope['"+e+"']\x3d"+b+";";if(void 0!==a.globalScope._SymbolsMap[e])return"gscope['"+a.globalScope._SymbolsMap[e]+"']\x3d"+b+";";g=P(e,a);return a.globalScope._SymbolsMap[e]=g,"gscope['"+g+"']\x3d"+b+";"}function I(a,b,e){switch(b=b.toLowerCase()){case "hasz":return a=a.hasZ,
void 0===a?!1:a;case "hasm":return a=a.hasM,void 0===a?!1:a;case "spatialreference":return b=a.spatialReference._arcadeCacheId,void 0===b&&(e=!0,Object.freeze&&Object.isFrozen(a.spatialReference)&&(e=!1),e&&(R++,a.spatialReference._arcadeCacheId=R,b=R)),a=new n({wkt:a.spatialReference.wkt,wkid:a.spatialReference.wkid}),void 0!==b&&(a._arcadeCacheId="SPREF"+b.toString()),a}switch(a.type){case "extent":switch(b){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return a=
a[b],void 0!==a?a:null;case "type":return"Extent"}break;case "polygon":switch(b){case "rings":return b=d.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(R++,b=R,d.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new x(a.rings,a.spatialReference,!0===a.hasZ,!0===a.hasM,b);case "type":return"Polygon"}break;case "point":switch(b){case "x":case "y":case "z":case "m":return void 0!==a[b]?a[b]:null;case "type":return"Point"}break;case "polyline":switch(b){case "paths":return b=
d.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(R++,b=R,d.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new x(a.paths,a.spatialReference,!0===a.hasZ,!0===a.hasM,b);case "type":return"Polyline"}break;case "multipoint":switch(b){case "points":return b=d.isVersion4?a.cache._arcadeCacheId:a.getCacheValue("_arcadeCacheId"),void 0===b&&(R++,b=R,d.isVersion4?a.cache._arcadeCacheId=b:a.setCacheValue("_arcadeCacheId",b)),a=new y(a.points,a.spatialReference,
!0===a.hasZ,!0===a.hasM,b,1);case "type":return"Multipoint"}}throw Error(c.nodeErrorMessage(e,"RUNTIME","PROPERTYNOTFOUND"));}function J(a,b){try{var d=b.name.toLowerCase();if(null!==a.localScope){if(void 0!==a.localScope[d])return"lscope['"+d+"']";if(void 0!==a.localScope._SymbolsMap[d])return"lscope['"+a.localScope._SymbolsMap[d]+"']"}if(void 0!==a.globalScope[d])return"gscope['"+d+"']";if(void 0!==a.globalScope._SymbolsMap[d])return"gscope['"+a.globalScope._SymbolsMap[d]+"']";throw Error(c.nodeErrorMessage(b,
"RUNTIME","VARIABLENOTFOUND"));}catch(Aa){throw Aa;}}function L(c){return null===c?"":d.isArray(c)?"Array":d.isImmutableArray(c)?"Array":d.isDate(c)?"Date":d.isString(c)?"String":d.isBoolean(c)?"Boolean":d.isNumber(c)?"Number":c instanceof n?"Dictionary":c instanceof q?"Feature":c instanceof e?"Point":c instanceof a?"Polygon":c instanceof b?"Polyline":c instanceof m?"Multipoint":c instanceof l?"Extent":d.isFunctionParameter(c)?"Function":c===d.voidOperation?"":"number"==typeof c&&isNaN(c)?"Number":
"Unrecognised Type"}function M(a,c,b,e){try{if(d.equalityTest(c[b],e))return c[b+1];var g=c.length-b;return 1===g?c[b]:2===g?null:M(a,c,b+2,e)}catch(pa){throw pa;}}function H(a,c,b,e){try{if(!0===e)return c[b+1];if(3===c.length-b)return c[b+2];var g=c[b+2];if(!1===d.isBoolean(g))throw Error("WHEN needs boolean test conditions");return H(a,c,b+2,g)}catch(pa){throw pa;}}function K(a,c){var b=a.length,d=Math.floor(b/2),e;if(0===b)e=[];else if(1===b)e=[a[0]];else{e=K(a.slice(0,d),c);b=K(a.slice(d,b),
c);for(d=[];0<e.length||0<b.length;)if(0<e.length&&0<b.length){var g=c(e[0],b[0]);isNaN(g)&&(g=0);0>=g?(d.push(e[0]),e=e.slice(1)):(d.push(b[0]),b=b.slice(1))}else 0<e.length?(d.push(e[0]),e=e.slice(1)):0<b.length&&(d.push(b[0]),b=b.slice(1));e=d}return e}function P(a,c){return c.symbols.symbolCounter++,"_T"+c.symbols.symbolCounter.toString()}function O(a){return a.symbols.symbolCounter++,"_Tvar"+a.symbols.symbolCounter.toString()}function S(a,c,b){var d={};a||(a={});b||(b={});d._SymbolsMap={};d.textformatting=
1;d.infinity=1;d.pi=1;for(var e in c)d[e]=1;for(e in b)d[e]=1;for(e in a)d[e]=1;return d}function Q(a){}var R=0,aa={};t.registerFunctions(aa,z);r.registerFunctions(aa,z);v.registerFunctions(aa,z);u.registerFunctions(aa,z);w.registerFunctions(aa,z);aa["typeof"]=function(a,c){return z(a,c,function(a,c,b){d.pcCheck(b,1,1);a=L(b[0]);if("Unrecognised Type"===a)throw Error("Unrecognised Type");return a})};aa.iif=function(a,c){try{return z(a,c,function(a,c,b){if(d.pcCheck(b,3,3),!1===d.isBoolean(b[0]))throw Error("IF Function must have a boolean test condition");
return b[0]?b[1]:b[2]})}catch(la){throw la;}};aa.decode=function(a,c){try{return z(a,c,function(c,b,d){if(2>d.length)throw Error("Missing Parameters");if(2===d.length)return d[1];if(0===(d.length-1)%2)throw Error("Must have a default value result.");return M(a,d,1,d[0])})}catch(la){throw la;}};aa.when=function(a,c){try{return z(a,c,function(c,b,e){if(3>e.length)throw Error("Missing Parameters");if(0===e.length%2)throw Error("Must have a default value result.");c=e[0];if(!1===d.isBoolean(c))throw Error("WHEN needs boolean test conditions");
return H(a,e,0,c)})}catch(la){throw la;}};aa.top=function(a,c){return z(a,c,function(a,c,b){if(d.pcCheck(b,2,2),d.isArray(b[0]))return d.toNumber(b[1])>=b[0].length?b[0].slice(0):b[0].slice(0,d.toNumber(b[1]));if(d.isImmutableArray(b[0]))return d.toNumber(b[1])>=b[0].length()?b[0].slice(0):b[0].slice(0,d.toNumber(b[1]));throw Error("Top cannot accept this parameter type");})};aa.first=function(a,c){return z(a,c,function(a,c,b){return d.pcCheck(b,1,1),d.isArray(b[0])?0===b[0].length?null:b[0][0]:d.isImmutableArray(b[0])?
0===b[0].length()?null:b[0].get(0):null})};aa.sort=function(a,c){return z(a,c,function(a,c,b){d.pcCheck(b,1,2);c=b[0];if(d.isImmutableArray(c)&&(c=c.toArray()),!1===d.isArray(c))throw Error("Illegal Argument");if(1<b.length){if(!1===d.isFunctionParameter(b[1]))throw Error("Illegal Argument");return c=K(c,function(c,d){return V.callfunc(b[1],[c,d],a)})}if(0===c.length)return[];for(var e={},g=0;g<c.length;g++){var f=L(c[g]);""!==f&&(e[f]=!0)}if(!0===e.Array||!0===e.Dictionary||!0===e.Feature||!0===
e.Point||!0===e.Polygon||!0===e.Polyline||!0===e.Multipoint||!0===e.Extent||!0===e.Function)return c.slice(0);var g=0,f="",l;for(l in e)g++,f=l;return c=1<g||"String"===f?K(c,function(a,c){if(null===a||void 0===a||a===d.voidOperation)return null===c||void 0===c||c===d.voidOperation?0:1;if(null===c||void 0===c||c===d.voidOperation)return-1;var b=d.toString(a),e=d.toString(c);return e>b?-1:b===e?0:1}):"Number"===f?K(c,function(a,c){return a-c}):"Boolean"===f?K(c,function(a,c){return a===c?0:c?-1:1}):
"Date"===f?K(c,function(a,c){return c-a}):c.slice(0)})};for(var X in aa)aa[X]=new d.NativeFunction(aa[X]);var T=function(){};T.prototype=aa;k.functionHelper={fixSpatialReference:d.fixSpatialReference,parseArguments:function(a,c){for(var b=[],d=0;d<c.arguments.length;d++)b.push(B(a,c.arguments[d]));return b},standardFunction:z};k.executeScript=function(a,c,b){return a(c,b)};k.extractFieldLiterals=function(a,b){return void 0===b&&(b=!1),c.findFieldLiterals(a,b)};k.validateScript=function(a,b){return c.validateScript(a,
b,"simple")};k.referencesMember=function(a,b){return c.referencesMember(a,b)};k.referencesFunction=function(a,b){return c.referencesFunction(a,b)};var V={error:function(a,b,d){throw Error(c.nodeErrorMessage(a,b,d));},functionDepthchecker:function(a,c){return function(){if(c.depthCounte++,64<c.depthCounter)throw Error("Exceeded maximum function depth");var b=a.apply(this,arguments);return c.depthCounte--,b}},aCheck:function(a,b){if(d.isFunctionParameter(a))throw Error(c.nodeErrorMessage({type:b},"RUNTIME",
"FUNCTIONCONTEXTILLEGAL"));return a===d.voidOperation?null:a},Dictionary:n,Feature:q,dictionary:function(a){for(var c={},b=0;b<a.length;b+=2){if(d.isFunctionParameter(a[b+1]))throw Error("Illegal Argument");if(!1===d.isString(a[b]))throw Error("Illegal Argument");a[b+1]===d.voidOperation?c[a[b].toString()]=null:c[a[b].toString()]=a[b+1]}a=new n(c);return a.immutable=!1,a},strCheck:function(a,c){if(!1===d.isString(a))throw Error("Illegal Argument");return a},unary:function(a,b){if(d.isBoolean(a)){if("!"===
b)return!a;if("-"===b)return-1*d.toNumber(a);if("+"===b)return 1*d.toNumber(a);throw Error(c.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===b)return-1*d.toNumber(a);if("+"===b)return 1*d.toNumber(a);throw Error(c.nodeErrorMessage({type:"UnaryExpression"},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));},logical:function(a,b,e){if(!d.isBoolean(a)||!d.isBoolean(b))throw Error(c.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));switch(e){case "||":return a||
b;case "\x26\x26":return a&&b;default:throw Error(c.nodeErrorMessage("LogicalExpression","RUNTIME","ONLYORORAND"));}},binary:function(a,b,e){switch(e){case "\x3d\x3d":return d.equalityTest(a,b);case "\x3d":return d.equalityTest(a,b);case "!\x3d":return!d.equalityTest(a,b);case "\x3c":return d.greaterThanLessThan(a,b,e);case "\x3e":return d.greaterThanLessThan(a,b,e);case "\x3c\x3d":return d.greaterThanLessThan(a,b,e);case "\x3e\x3d":return d.greaterThanLessThan(a,b,e);case "+":return d.isString(a)||
d.isString(b)?d.toString(a)+d.toString(b):d.toNumber(a)+d.toNumber(b);case "-":return d.toNumber(a)-d.toNumber(b);case "*":return d.toNumber(a)*d.toNumber(b);case "/":return d.toNumber(a)/d.toNumber(b);case "%":return d.toNumber(a)%d.toNumber(b);default:throw Error(c.nodeErrorMessage({type:"BinaryExpression"},"RUNTIME","OPERATORNOTRECOGNISED"));}},assign:function(a,b,e){switch(b){case "\x3d":return a===d.voidOperation?null:a;case "/\x3d":return d.toNumber(e)/d.toNumber(a);case "*\x3d":return d.toNumber(e)*
d.toNumber(a);case "-\x3d":return d.toNumber(e)-d.toNumber(a);case "+\x3d":return d.isString(e)||d.isString(a)?d.toString(e)+d.toString(a):d.toNumber(e)+d.toNumber(a);case "%\x3d":return d.toNumber(e)%d.toNumber(a);default:throw Error(c.nodeErrorMessage("AssignmentExpression","RUNTIME","OPERATORNOTRECOGNISED"));}},update:function(a,c,b,e){var g=d.toNumber(a[c]);return a[c]="++"===b?g+1:g-1,!1===e?g:"++"===b?g+1:g-1},memberupdate:function(a,c,b,e){var g;if(d.isArray(a)){if(!d.isNumber(c))throw Error("Invalid Parameter");
if(0>c&&(c=a.length+c),0>c||c>=a.length)throw Error("Assignment outside of array bounds");g=d.toNumber(a[c]);a[c]="++"===b?g+1:g-1}else{if(a instanceof n){if(!1===d.isString(c))throw Error("Dictionary accessor must be a string");}else{if(!(a instanceof q))throw d.isImmutableArray(a)?Error("Array is Immutable"):Error("Invalid Parameter");if(!1===d.isString(c))throw Error("Feature accessor must be a string");}if(!0!==a.hasField(c))throw Error("Invalid Parameter");g=d.toNumber(a.field(c));a.setField(c,
"++"===b?g+1:g-1)}return!1===e?g:"++"===b?g+1:g-1},assignmember:function(a,c,b,e){if(d.isArray(a)){if(!d.isNumber(c))throw Error("Invalid Parameter");if(0>c&&(c=a.length+c),0>c||c>a.length)throw Error("Assignment outside of array bounds");if(c===a.length&&"\x3d"!==b)throw Error("Invalid Parameter");a[c]=this.assign(e,b,a[c])}else{if(a instanceof n){if(!1===d.isString(c))throw Error("Dictionary accessor must be a string");}else{if(!(a instanceof q))throw d.isImmutableArray(a)?Error("Array is Immutable"):
Error("Invalid Parameter");if(!1===d.isString(c))throw Error("Feature accessor must be a string");}if(!0===a.hasField(c))a.setField(c,this.assign(e,b,a.field(c)));else{if("\x3d"!==b)throw Error("Invalid Parameter");a.setField(c,this.assign(e,b,null))}}},member:function(a,b){if(null===a)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","NOTFOUND"));if(a instanceof n||a instanceof q){if(d.isString(b))return a.field(b);throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));
}if(a instanceof A){if(d.isString(b))return I(a,b,"MemberExpression");throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));}if(d.isArray(a)){if(d.isNumber(b)&&isFinite(b)&&Math.floor(b)===b){if(0>b&&(b=a.length+b),b>=a.length||0>b)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return a[b]}throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));}if(d.isString(a)){if(d.isNumber(b)&&isFinite(b)&&Math.floor(b)===b){if(0>b&&(b=a.length+
b),b>=a.length||0>b)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return a[b]}throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));}if(d.isImmutableArray(a)&&d.isNumber(b)&&isFinite(b)&&Math.floor(b)===b){if(0>b&&(b=a.length()+b),b>=a.length()||0>b)throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","OUTOFBOUNDS"));return a.get(b)}throw Error(c.nodeErrorMessage("MemberExpression","RUNTIME","INVALIDTYPE"));},callfunc:function(a,c,b){return a instanceof
d.NativeFunction?a.fn(b,c):a instanceof d.SizzleFunction?a.fn.apply(this,c):a.apply(this,c)}};k.compileScript=function(a,c){void 0===c&&(c=null);null===c&&(c={vars:{},customfunctions:{}});var b={globalScope:S(c.vars,aa,c.customfunctions),localScope:null,console:Q,symbols:{symbolCounter:0}},b=B(b,a.body[0].body);""===b&&(b="lc.voidOperation;");var e={lc:d,lang:V,postProcess:function(a){if(a instanceof d.ReturnResult&&(a=a.value),a instanceof d.ImplicitResult&&(a=a.value),a===d.voidOperation&&(a=null),
a===d.breakResult)throw Error("Cannot return BREAK");if(a===d.continueResult)throw Error("Cannot return CONTINUE");if(d.isFunctionParameter(a))throw Error("Cannot return FUNCTION");return a},prepare:function(a,c){c||(c=new g(102100));var b=a.vars,d=a.customfunctions,e=new T;b||(b={});d||(d={});var l=new n({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});l.immutable=!1;e._SymbolsMap={textformatting:1,infinity:1,pi:1};e.textformatting=l;e.infinity=Number.POSITIVE_INFINITY;
e.pi=Math.PI;for(var m in d)e[m]=d[m],e._SymbolsMap[m]=1;for(m in b)e._SymbolsMap[m]=1,b[m]instanceof f?e[m]=new q(b[m]):e[m]=b[m];return{spatialReference:c,globalScope:e,localScope:null,console:a.console?a.console:Q,symbols:{symbolCounter:0},depthCounter:1,applicationCache:void 0===a.applicationCache?null:a.applicationCache}}};return(new Function("context","spatialReference","var runtimeCtx\x3dthis.prepare(context, spatialReference);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n "+
b+"\n return lastStatement; } \n return this.postProcess(mainBody());")).bind(e)}})},"esri/renderers/UniqueValueRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ./arcadeUtils".split(" "),function(h,k,a,f,b,e,l,m,g){h=h(m,{declaredClass:"esri.renderer.UniqueValueRenderer",constructor:function(a,c,b,e,g){(this.values=[],this._symbols={},this.infos=[],a&&!a.declaredClass)?(c=a,this.defaultSymbol=(a=c.defaultSymbol)&&
(a.declaredClass?a:l.fromJson(a)),this.attributeField=c.field1,this.attributeField2=c.field2,this.attributeField3=c.field3,this.fieldDelimiter=c.fieldDelimiter,this.defaultLabel=c.defaultLabel,this.setValueExpression(c.valueExpression),this.valueExpressionTitle=c.valueExpressionTitle,this.legendOptions=c.legendOptions,c.backgroundFillSymbol&&(this.backgroundFillSymbol=l.fromJson(c.backgroundFillSymbol)),k.forEach(c.uniqueValueInfos,this._addValueInfo,this)):(this.defaultSymbol=a,this.attributeField=
c,this.attributeField2=b,this.attributeField3=e,this.fieldDelimiter=g);this._multiple=!!this.attributeField2},addValue:function(b,c){var d=a.isObject(b)?b:{value:b,symbol:c};this._addValueInfo(d)},removeValue:function(a){var c=k.indexOf(this.values,a);-1!==c&&(this.values.splice(c,1),delete this._symbols[a],this.infos.splice(c,1))},getUniqueValueInfo:function(b){var c,d,e,f,l=this.attributeField,m=b.attributes;return this._compiledFunc?f=g.executeFunction(this._compiledFunc,g.createExecContext(b,
b._getView())):this._multiple?(c=this.attributeField2,d=this.attributeField3,e=[],l&&e.push(m[l]),c&&e.push(m[c]),d&&e.push(m[d]),f=e.join(this.fieldDelimiter||"")):f=a.isFunction(l)?l(b):m[l],this._symbols[f]},setValueExpression:function(a){this.valueExpression=a;this._compiledFunc=g.createFunction(a)},getFieldsUsedInExpressions:function(){var a=this.inherited(arguments);return this.valueExpression&&(a=a.concat(g.extractFieldNames(this.valueExpression))),a.sort(),k.filter(a,function(c,b){return 0===
b||a[b-1]!==c})},getSymbol:function(a){return(a=this.getUniqueValueInfo(a))&&a.symbol||this.defaultSymbol},_addValueInfo:function(a){var c=a.value;this.values.push(c);this.infos.push(a);var b=a.symbol;b&&(b.declaredClass||(a.symbol=l.fromJson(b)));this._symbols[c]=a},toJson:function(){var b,c=e.fixJson,g={type:"uniqueValue",field1:this.attributeField,field2:this.attributeField2,field3:this.attributeField3,fieldDelimiter:this.fieldDelimiter,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,
legendOptions:a.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),defaultLabel:this.defaultLabel,uniqueValueInfos:k.map(this.infos||[],function(b){return b=a.mixin({},b),b.symbol=b.symbol&&b.symbol.toJson(),b.value+="",c(b)})};return this.backgroundFillSymbol&&(g.backgroundFillSymbol=this.backgroundFillSymbol.toJson()),b=a.mixin(this.inherited(arguments),g),c(b)}});return f("extend-esri")&&a.setObject("renderer.UniqueValueRenderer",h,b),h})},"esri/renderers/jsonUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../Color ../symbols/jsonUtils ./SimpleRenderer ./UniqueValueRenderer ./ClassBreaksRenderer ./VectorFieldRenderer ./DotDensityRenderer ./ScaleDependentRenderer ./TimeClassBreaksAger ./TimeRampAger ./TemporalRenderer ./HeatmapRenderer".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u){var w={fromJson:function(a){var b;switch(a.type||""){case "simple":b=new m(a);break;case "uniqueValue":b=new g(a);break;case "classBreaks":b=new d(a);break;case "vectorField":b=new c(a);break;case "scaleDependent":b=this._scaleDependentFromJson(a);break;case "dotDensity":b=this._dotDensityFromJson(a);break;case "temporal":b=this._temporalFromJson(a);break;case "heatmap":b=this._heatmapFromJson(a)}return b},_scaleDependentFromJson:function(a){var c={},b=
a.minScale;return c.rendererInfos=h.map(a.rendererInfos,function(a){var c=a.maxScale;a={minScale:b,maxScale:c,renderer:a.renderer&&this.fromJson(a.renderer)};return b=c,a},this),new q(c)},_dotDensityFromJson:function(a){return a.backgroundColor&&k.isArray(a.backgroundColor)&&(a.backgroundColor=e.toDojoColor(a.backgroundColor)),0<a.dotSize&&(a.dotSize=f.pt2px(a.dotSize)),a.fields&&h.forEach(a.fields,function(a){a&&k.isArray(a.color)&&(a.color=e.toDojoColor(a.color))}),a.legendOptions&&(a.legendOptions.backgroundColor&&
k.isArray(a.legendOptions.backgroundColor)&&(a.legendOptions.backgroundColor=e.toDojoColor(a.legendOptions.backgroundColor)),a.legendOptions.outline&&(a.legendOptions.outline=l.fromJson(a.legendOptions.outline))),a.outline&&(a.outline=l.fromJson(a.outline)),new n(a)},_temporalFromJson:function(a){var c,b,d,e;return a=a||{},c=this.fromJson(a.observationRenderer),b=a.latestObservationRenderer?this.fromJson(a.latestObservationRenderer):null,d=a.trackRenderer?this.fromJson(a.trackRenderer):null,e=this._agerFromJson(a.observationAger),
new v(c,b,d,e)},_agerFromJson:function(a){var c;return a=a||{},a.colorRange||a.sizeRange||a.alphaRange?c=this._timeRampFromJson(a):a.agerClassBreakInfos&&(c=this._timeClassBreaksFromJson(a)),c},_timeRampFromJson:function(a){var c,b,d;return a.colorRange&&1<a.colorRange.length&&(c=[e.toDojoColor(a.colorRange[0]),e.toDojoColor(a.colorRange[1])]),a.sizeRange&&1<a.sizeRange.length&&(b=[a.sizeRange[0],a.sizeRange[1]]),a.alphaRange&&1<a.alphaRange.length&&(d=[a.alphaRange[0]/255,a.alphaRange[1]/255]),new r(c,
b,d)},_timeClassBreaksFromJson:function(a){var c,b,d,g=a.agerClassBreakInfos,f=[];c=t.UNIT_DAYS;switch(a.timeUnits){case "esriTimeUnitsSeconds":c=t.UNIT_SECONDS;break;case "esriTimeUnitsMilliseconds":c=t.UNIT_MILLISECONDS;break;case "esriTimeUnitsHours":c=t.UNIT_HOURS;break;case "esriTimeUnitsMinutes":c=t.UNIT_MINUTES;break;case "esriTimeUnitsMonths":c=t.UNIT_MONTHS;break;case "esriTimeUnitsWeeks":c=t.UNIT_WEEKS;break;case "esriTimeUnitsYears":c=t.UNIT_YEARS}for(d=0;d<g.length;d+=1)a=g[d],b={minAge:0,
maxAge:a.oldestAge||1/0},a.color&&(b.color=e.toDojoColor(a.color)),a.alpha&&(b.alpha=a.alpha/255),b.size=a.size,f[d]=b;return new t(f,c)},_heatmapFromJson:function(a){var c=a.colorStops;return c&&c instanceof Array&&h.forEach(c,function(a){a.color=e.toDojoColor(a.color)}),new u(a)}};return a("extend-esri")&&k.mixin(k.getObject("renderer",!0,b),w),w})},"esri/renderers/ClassBreaksRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ./arcadeUtils".split(" "),
function(h,k,a,f,b,e,l,m,g){h=h(m,{declaredClass:"esri.renderer.ClassBreaksRenderer",constructor:function(a,c){if(this.breaks=[],this._symbols={},this.infos=[],this.isMaxInclusive=!0,a&&!a.declaredClass){var b=a;this.attributeField=b.field;this.setValueExpression(b.valueExpression);this.valueExpressionTitle=b.valueExpressionTitle;this.legendOptions=b.legendOptions;this.defaultSymbol=(a=b.defaultSymbol)&&(a.declaredClass?a:l.fromJson(a));this.backgroundFillSymbol=(a=b.backgroundFillSymbol)&&(a.declaredClass?
a:l.fromJson(a));this._copy(["defaultLabel","classificationMethod:rest","normalizationType:rest","normalizationField","normalizationTotal"],b,this);var d=b.minValue;(b=b.classBreakInfos)&&b[0]&&e.isDefined(b[0].classMaxValue)&&k.forEach(b,function(a){var c=a.classMaxValue;a.minValue=d;d=a.maxValue=c},this);k.forEach(b,this._addBreakInfo,this)}else this.defaultSymbol=a,this.attributeField=c},addBreak:function(b,c,e){b=a.isObject(b)?b:{minValue:b,maxValue:c,symbol:e};this._addBreakInfo(b)},removeBreak:function(a,
c){var b,d,e=this.breaks,g=e.length,f=this._symbols;for(d=0;g>d;d++)if(b=e[d],b[0]==a&&b[1]==c){e.splice(d,1);delete f[a+"-"+c];this.infos.splice(d,1);break}},clearBreaks:function(){this.breaks=[];this._symbols={};this.infos=[]},getBreakIndex:function(b){var c,d,e=this.attributeField;c=b.attributes;var f=this.breaks,l=f.length,m=this.isMaxInclusive;if(this._compiledFunc)b=g.executeFunction(this._compiledFunc,g.createExecContext(b,b._getView()));else if(a.isFunction(e))b=e(b);else{b=parseFloat(c[e]);
var h=this.normalizationType;if(h)if(e=parseFloat(this.normalizationTotal),c=parseFloat(c[this.normalizationField]),"log"===h)b=Math.log(b)*Math.LOG10E;else if("percent-of-total"!==h||isNaN(e)){if("field"===h){if(isNaN(b)||isNaN(c))return-1;b/=c}}else b=b/e*100}if(null!=b&&!isNaN(b)&&"number"==typeof b)for(c=0;l>c;c++)if(d=f[c],d[0]<=b&&(m?b<=d[1]:b<d[1]))return c;return-1},getBreakInfo:function(a){a=this.getBreakIndex(a);return-1!==a?this.infos[a]:null},getSymbol:function(a){return(a=this.breaks[this.getBreakIndex(a)])?
this._symbols[a[0]+"-"+a[1]]:this.defaultSymbol},setMaxInclusive:function(a){this.isMaxInclusive=a},setValueExpression:function(a){this.valueExpression=a;this._compiledFunc=g.createFunction(a)},getFieldsUsedInExpressions:function(){var a=this.inherited(arguments);return this.valueExpression&&(a=a.concat(g.extractFieldNames(this.valueExpression))),a.sort(),k.filter(a,function(c,b){return 0===b||a[b-1]!==c})},_normalizationTypeEnums:[["field","esriNormalizeByField"],["log","esriNormalizeByLog"],["percent-of-total",
"esriNormalizeByPercentOfTotal"]],_classificationMethodEnums:[["natural-breaks","esriClassifyNaturalBreaks"],["equal-interval","esriClassifyEqualInterval"],["quantile","esriClassifyQuantile"],["standard-deviation","esriClassifyStandardDeviation"],["geometrical-interval","esriClassifyGeometricalInterval"]],_copy:function(a,c,b){k.forEach(a,function(a){var d,e,g,f,l=a.split(":");if(1<l.length&&(a=l[0],d=this["_"+a+"Enums"],"rest"===l[1]?(e="1",g="0"):"sdk"===l[1]&&(e="0",g="1")),f=c[a],void 0!==f&&
(b[a]=f,d&&e))for(var m=d.length,l=0;m>l;l++)if(d[l][e]===f){b[a]=d[l][g];break}},this)},_addBreakInfo:function(a){var c=a.minValue,b=a.maxValue;this.breaks.push([c,b]);this.infos.push(a);var d=a.symbol;d&&(d.declaredClass||(a.symbol=l.fromJson(d)));this._symbols[c+"-"+b]=a.symbol},toJson:function(){var b=this.infos||[],c=e.fixJson,g=b[0]&&b[0].minValue,f=this.backgroundFillSymbol,b=a.mixin(this.inherited(arguments),{type:"classBreaks",field:this.attributeField,valueExpression:this.valueExpression,
valueExpressionTitle:this.valueExpressionTitle,legendOptions:a.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),backgroundFillSymbol:f&&f.toJson(),minValue:g===-(1/0)?-Number.MAX_VALUE:g,classBreakInfos:k.map(b,function(b){return b=a.mixin({},b),b.symbol=b.symbol&&b.symbol.toJson(),b.classMaxValue=b.maxValue===1/0?Number.MAX_VALUE:b.maxValue,delete b.minValue,delete b.maxValue,c(b)})});return this._copy(["defaultLabel","classificationMethod:sdk","normalizationType:sdk",
"normalizationField","normalizationTotal"],this,b),b.hasOwnProperty("normalizationType")&&!b.normalizationType&&delete b.normalizationType,b.hasOwnProperty("classificationMethod")&&!b.classificationMethod&&delete b.classificationMethod,c(b)}});return f("extend-esri")&&a.setObject("renderer.ClassBreaksRenderer",h,b),h})},"esri/renderers/VectorFieldRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/_base/array ../kernel ../lang ../Color ./Renderer ./ClassBreaksRenderer ../symbols/SimpleMarkerSymbol ../symbols/PictureMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/jsonUtils require".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t){var r=h(m,{declaredClass:"esri.renderer.VectorFieldRenderer",iconFolderPath:"../images/symbol/sfs/",constructor:function(a){e.isDefined(a)||(a={});a.attributeField=a.attributeField||"Magnitude";a.rotationInfo=a.rotationInfo||this._getRotationInfo(a);h.safeMixin(this,a);this.style=this.style||r.STYLE_SINGLE_ARROW;this.singleArrowSymbol&&(this.singleArrowSymbol=this.singleArrowSymbol.declaredClass?this.singleArrowSymbol:q.fromJson(this.singleArrowSymbol));this.renderer=
new g(this._getDefaultSymbol(),a.attributeField);this._updateRenderer(this.style);this.flowRepresentation=this.flowRepresentation||this.FLOW_FROM},getSymbol:function(a){return this.renderer&&this.renderer.getSymbol(a)},setVisualVariables:function(a){return a=f.filter(a,function(a){return"sizeInfo"===a.type?e.isDefined(this._updateSizeInfo(a)):void 0},this),this.inherited(arguments),this},setSizeInfo:function(a){return this._updateSizeInfo(a),this.inherited(arguments),this},setProportionalSymbolInfo:function(a){return this.setSizeInfo(a),
this},setColorInfo:function(a){return this},_updateRenderer:function(a){return e.isDefined(this.renderer)?a===r.STYLE_SINGLE_ARROW?this._createSingleArrowRenderer():a===r.STYLE_BEAUFORT_KN?this._createBeaufortKnotsRenderer():a===r.STYLE_BEAUFORT_METER?this._createBeaufortMeterRenderer():a===r.STYLE_BEAUFORT_FEET?this._createBeaufortFeetRenderer():a===r.STYLE_BEAUFORT_MILE?this._createBeaufortMilesRenderer():a===r.STYLE_BEAUFORT_KM?this._createBeaufortKilometersRenderer():a===r.STYLE_OCEAN_CURRENT_M?
this._createCurrentMeterRenderer():a===r.STYLE_OCEAN_CURRENT_KN?this._createCurrentKnotsRenderer():a===r.STYLE_SCALAR?this._createSimpleScalarRenderer():a===r.STYLE_WIND_BARBS?this._createWindBarbsRenderer():this._createClassifiedArrowRenderer():Error("Invalid Renderer!")},_updateSizeInfo:function(a){return a&&e.isDefined(a.minSize)&&e.isDefined(a.maxSize)&&e.isDefined(a.minDataValue)&&e.isDefined(a.maxDataValue)?(this.style===r.STYLE_WIND_BARBS&&(a.minSize=a.maxSize),a.field=a.field||"Magnitude",
a.type="sizeInfo",a):null},_createClassifiedArrowRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new l([56,168,0]));var a=[0,1E-6,3.5,7,10.5,14];if(e.isDefined(this.minDataValue)&&e.isDefined(this.maxDataValue)){var c=(this.maxDataValue-this.minDataValue)/5,a=[],b,d;d=this.minDataValue;for(b=0;6>b;b++)a[b]=d,d+=c}this._addBreaks(a,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]])},_createSingleArrowRenderer:function(){this.renderer.defaultSymbol=this.singleArrowSymbol||
this._getDefaultSymbol()},_createBeaufortMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new l([214,47,39]));this._addBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new l([214,47,39]));this._addBreaks([0,
1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]])},_createBeaufortFeetRenderer:function(){var a=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];f.forEach(a,function(c,b){a[b]*=3.28084});this.renderer.defaultSymbol=this._getDefaultSymbol(new l([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],
[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortMilesRenderer:function(){var a=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];f.forEach(a,function(c,b){a[b]*=2.23694});this.renderer.defaultSymbol=this._getDefaultSymbol(new l([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKilometersRenderer:function(){var a=
[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];f.forEach(a,function(c,b){a[b]*=3.6});this.renderer.defaultSymbol=this._getDefaultSymbol(new l([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createCurrentMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new l([177,177,177]));this._addBreaks([0,.5,1,1.5,2],[[78,26,
153],[179,27,26],[202,128,26],[177,177,177]])},_createCurrentKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new l([177,177,177]));this._addBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]])},_createSimpleScalarRenderer:function(){this.renderer.defaultSymbol=new c({url:t.toUrl(this.iconFolderPath+"scalar.png"),height:20,width:20,type:"esriPMS",angle:0})},_createWindBarbsRenderer:function(){var a,
b,e=[];for(a=0;150>=a;a+=5)e.push(a);b="M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20;M25 0 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40;M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35;M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15 M25 10 M25 5 L17.5 7.5".split(";");
var g=new c({url:t.toUrl(this.iconFolderPath+"windbarb.png"),height:20,width:20,type:"esriPMS",angle:0});this.renderer.defaultSymbol=g;for(a=0;a<e.length-1;a++)0==a?this.renderer.addBreak({minValue:e[a],maxValue:e[a+1],symbol:g}):this.renderer.addBreak({minValue:e[a],maxValue:e[a+1],symbol:(new d).setPath(b[a]).setOutline((new n).setWidth(1.5)).setSize(20).setColor(new l([0,0,0,255]))})},_getDefaultSymbol:function(a){return(new d).setPath("M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z").setOutline((new n).setWidth(0)).setSize(20).setColor(a||
new l([0,92,230]))},_getRotationInfo:function(a){var c=a&&a.flowRepresentation||r.FLOW_FROM,b=a&&a.rotationField||"Direction",d=r.FLOW_FROM;return{field:function(a){a=a.attributes[b];return c===d?a:a+180},type:"geographic"}},_addBreaks:function(a,c){if(!e.isDefined(this.renderer))return Error("Invalid Renderer!");if(!(a&&c&&a.length&&c.length&&a.length>=c.length))return Error("AddBreaks: Input arguments break values and colors not valid");var b;for(b=0;b<c.length;b++)this.renderer.addBreak({minValue:a[b],
maxValue:a[b+1],symbol:this._getDefaultSymbol(new l(c[b]))})},toJson:function(){var a=k.mixin(this.inherited(arguments),{type:"vectorField",style:this.style,attributeField:this.attributeField,flowRepresentation:this.flowRepresentation});return this.renderer&&this.renderer.defaultSymbol&&this.style===r.STYLE_SINGLE_ARROW&&(a.singleArrowSymbol=this.renderer.defaultSymbol.toJson()),e.fixJson(a)}});return k.mixin(r,{STYLE_WIND_BARBS:"wind_speed",STYLE_SINGLE_ARROW:"single_arrow",STYLE_CLASSIFIED_ARROW:"classified_arrow",
STYLE_BEAUFORT_KN:"beaufort_kn",STYLE_BEAUFORT_METER:"beaufort_m",STYLE_BEAUFORT_MILE:"beaufort_mi",STYLE_BEAUFORT_FEET:"beaufort_ft",STYLE_BEAUFORT_KM:"beaufort_km",STYLE_OCEAN_CURRENT_M:"ocean_current_m",STYLE_OCEAN_CURRENT_KN:"ocean_current_kn",STYLE_SCALAR:"simple_scalar"},{FLOW_FROM:"flow_from",FLOW_TO:"flow_to"}),a("extend-esri")&&k.setObject("renderer.VectorFieldRenderer",r,b),r})},"esri/renderers/DotDensityRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Renderer ../symbols/PictureFillSymbol ../geometry/ScreenPoint ../geometry/Point".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q){h=h(d,{declaredClass:"esri.renderer.DotDensityRenderer",constructor:function(a){this.dotSize=a.dotSize||3;this.dotValue=a.dotValue;this.fields=a.fields;this.outline=a.outline;this.backgroundColor=a.backgroundColor;this.exactCount=a.exactCount||!0;this.dotShape=a.dotShape||"square";this.legendOptions=a.legendOptions;this._exactCountMinArea=1E4;this._currentMapScale=this._map=this._canvas=null;this._symbolMap={};this._currentGraphic=this._currentResolution=this._objectIdField=
null;this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1},getSymbol:function(a){var b,d,e;return this._currentGraphic=a,this._supportsCanvas?(this._map||(this._map=a.getLayer()._map,this._objectIdField=a.getLayer().objectIdField,this._currentMapScale=this._map.getScale(),this._currentResolution=this._map.extent.getWidth()/this._map.width,this._map.on("zoom-end",k.hitch(this,function(a){this._currentMapScale=this._map.getScale();this._currentResolution=a.extent.getWidth()/this._map.width;this._symbolMap[this._currentMapScale]=
{}}))),this._symbolMap[this._currentMapScale]&&this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]]?(d=this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]],e=this._getShapeProperties(a),d.setOffset(e.dx,e.dy),d):(b=this._generateFieldsCount(this.fields,a.attributes,this.dotValue),e=this._getShapeProperties(a),d=new c(this._generateImageSrc(e.width,e.height,b,e.minXY,e.maxXY),this.outline,e.width,e.height),d.setOffset(e.dx,e.dy),this._symbolMap[this._currentMapScale]?
this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]]=d:(this._symbolMap[this._currentMapScale]={},this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]]=d),d)):null},_generateFieldsCount:function(a,c,b){var d,e;for(e=a.length-1;0<=e;e--)d=c[a[e].name]/b,a[e].numPoints=Math.round(d);return a},_getShapeProperties:function(a){var c,b,d,e,g,f,l,m;return c=a.geometry.getExtent(),c.contains(this._map.extent)&&(c=this._map.extent),l=Math.ceil(c.getWidth()/this._currentResolution),
m=Math.ceil(c.getHeight()/this._currentResolution),b=this._map.toScreen(new q(c.xmin,c.ymin,c.spatialReference)),d=this._map.toScreen(new q(c.xmax,c.ymax,c.spatialReference)),f=a.getLayer().getNode().getCTM(),e=(b.x-f.e)%l,g=(d.y-f.f)%m,{minXY:b,maxXY:d,dx:e,dy:g,width:l,height:m}},_generateImageSrc:function(a,c,b,d,e,g){var f,l,m,n=this.dotSize;this._canvas?(this._canvas.width=a,this._canvas.height=c):this._canvas=this._initCanvas(a,c);f=this._canvas.getContext("2d");(g=g||this.backgroundColor)&&
(f.fillStyle=g.toCss(!0),f.fillRect(0,0,a,c),f.fill());for(g=b.length-1;0<=g;g--)for(f.fillStyle=b[g].color.toCss(!0),l=b[g].numPoints-1;0<=l;l--)m=this._getRandomPoint(a,c,d,e),"square"===this.dotShape?f.fillRect(m.x,m.y,n,n):"circle"===this.dotShape&&(f.beginPath(),f.arc(m.x,m.y,n/2,0,2*Math.PI,!0)),f.fill();return this._canvas.toDataURL()},_initCanvas:function(a,c){var b=f.create("canvas",{id:"canvas",width:a+"px",height:c+"px",style:"position: absolute; left: -10000px; top: 0px;"},null);return document.body.appendChild(b),
b},_getRandomInt:function(a,c){return Math.floor(Math.random()*(c-a+1)+a)},_getRandomPoint:function(a,c,b,d){var e={},g=this.outline&&this.outline.width?this.outline.width:0;if(!0===this.exactCount&&a*c>this._exactCountMinArea){a=!1;do e.x=this._getRandomInt(b.x,d.x),e.y=this._getRandomInt(d.y,b.y),a=new n(e.x,e.y),a=this._checkPointShapeBounds(a,this.dotSize+g,this._currentGraphic.geometry),!0===a&&(e.x-=b.x,e.y-=d.y);while(!1===a)}else e.x=this._getRandomInt(0,a),e.y=this._getRandomInt(0,c);return e},
_checkPointShapeBounds:function(a,c,b){var d=null,d=!1,e=!0,g=0;do{switch(g){case 1:a.x+=c;break;case 2:a.y+=c;break;case 3:a.x-=c}d=this._map.toMap(a);d=b.contains(d);!1===d&&(e=!1);g+=1}while(3>=g&&!0===e);return d},setDotSize:function(a){0<a&&(this.dotSize=a)},setDotValue:function(a){0<a&&(this.dotValue=a)},setOutline:function(a){this.outline=a},setBackgroundColor:function(a){this.backgroundColor=a},toJson:function(){var c=k.mixin(this.inherited(arguments),{type:"dotDensity",backgroundColor:g.toJsonColor(this.backgroundColor),
dotShape:this.dotShape,dotSize:0<this.dotSize?e.px2pt(this.dotSize):0,dotValue:this.dotValue,fields:a.map(this.fields,function(a){return m.fixJson({color:g.toJsonColor(a.color),name:a.name})}),legendOptions:this.legendOptions&&m.fixJson({backgroundColor:g.toJsonColor(this.legendOptions.backgroundColor),dotCoverage:this.legendOptions.dotCoverage,outline:this.legendOptions.outline&&this.legendOptions.outline.toJson(),valueUnit:this.legendOptions.valueUnit}),outline:this.outline&&this.outline.toJson()});
return m.fixJson(c)}});return b("extend-esri")&&k.setObject("renderer.DotDensityRenderer",h,l),h})},"esri/renderers/ScaleDependentRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ./Renderer".split(" "),function(h,k,a,f,b,e,l){h=h(l,{declaredClass:"esri.renderer.ScaleDependentRenderer",constructor:function(a){this.setRendererInfos(a&&a.rendererInfos||[])},setRendererInfos:function(a){return this.rendererInfos=a,this._setRangeType(),this},getSymbol:function(a){var b=
this.getRendererInfo(a);return b&&b.renderer&&b.renderer.getSymbol(a)},getRendererInfo:function(a){a=a.getLayer().getMap();return"zoom"===this.rangeType?this.getRendererInfoByZoom(a.getZoom()):this.getRendererInfoByScale(a.getScale())},getRendererInfoByZoom:function(a){var b,d,c=this.rendererInfos,e=0;do b=c[e],a>=b.minZoom&&a<=b.maxZoom&&(d=b),e++;while(!d&&e<c.length);return d},getRendererInfoByScale:function(a){var b,d,c,e,f,l,m=this.rendererInfos,h=0;do b=m[h],c=b.minScale,e=b.maxScale,f=!c,l=
!e,!f&&c>=a&&(f=!0),!l&&a>=e&&(l=!0),f&&l&&(d=b),h++;while(!d&&h<m.length);return d},addRendererInfo:function(a){var b,d,c=0,e=this.rendererInfos,f=a.hasOwnProperty("minZoom")?"minZoom":"minScale",l=e.length;do d=e[c],(l===c||a[f]<d[f])&&(e.splice(c,0,a),this._setRangeType(),b=!0),c++;while(!b&&l>c);return this},_setRangeType:function(){var a=this.rendererInfos;(a=a&&a[0])&&(this.rangeType=a.hasOwnProperty("minZoom")?"zoom":a.hasOwnProperty("minScale")?"scale":"")},toJson:function(){if("zoom"===this.rangeType)return null;
var b=this.rendererInfos||[],g=b[0]&&b[0].minScale,b=a.mixin(this.inherited(arguments),{type:"scaleDependent",minScale:0<g?g:0,rendererInfos:k.map(b,function(a){return e.fixJson({maxScale:0<a.maxScale?a.maxScale:0,renderer:a.renderer&&a.renderer.toJson()})})});return e.fixJson(b)}});return f("extend-esri")&&a.setObject("renderer.ScaleDependentRenderer",h,b),h})},"esri/renderers/TimeClassBreaksAger":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has dojo/date ../kernel ../lang ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),
function(h,k,a,f,b,e,l,m,g,d){var c=h(d,{declaredClass:"esri.renderer.TimeClassBreaksAger",constructor:function(a,b){this.infos=a;this.timeUnits=b||"day";a.sort(function(a,b){return a.minAge<b.minAge?-1:a.minAge>b.minAge?1:0})},getAgedSymbol:function(a,c){var d=c.getLayer(),e=c.attributes,g=l.isDefined;a=m.fromJson(a.toJson());var f=d._map.timeExtent.endTime;if(!f)return a;var n=b.difference(new Date(e[d._startTimeField]),f,this.timeUnits);return k.some(this.infos,function(b){if(n>=b.minAge&&n<=b.maxAge){var c=
b.color,d=b.size;b=b.alpha;return c&&a.setColor(c),g(d)&&this._setSymbolSize(a,d),g(b)&&a.color&&(a.color.a=b),!0}},this),a},toJson:function(){var a,b,c,d={agerClassBreakInfos:[]};d.timeUnits=this._getRestUnits(this.timeUnits);for(a=0;a<this.infos.length;a+=1)b=this.infos[a],c={},c.oldestAge=b.maxAge===1/0?null:b.maxAge,c.size=b.size,b.color&&(c.color=g.toJsonColor(b.color)),b.alpha&&(c.alpha=Math.round(255*b.alpha)),d.agerClassBreakInfos[a]=c;return d},_getRestUnits:function(a){var b="esriTimeUnitsDays";
switch(a){case c.UNIT_SECONDS:b="esriTimeUnitsSeconds";break;case c.UNIT_MILLISECONDS:b="esriTimeUnitsMilliseconds";break;case c.UNIT_HOURS:b="esriTimeUnitsHours";break;case c.UNIT_MINUTES:b="esriTimeUnitsMinutes";break;case c.UNIT_MONTHS:b="esriTimeUnitsMonths";break;case c.UNIT_WEEKS:b="esriTimeUnitsWeeks";break;case c.UNIT_YEARS:b="esriTimeUnitsYears"}return b}});return a.mixin(c,{UNIT_DAYS:"day",UNIT_HOURS:"hour",UNIT_MILLISECONDS:"millisecond",UNIT_MINUTES:"minute",UNIT_MONTHS:"month",UNIT_SECONDS:"second",
UNIT_WEEKS:"week",UNIT_YEARS:"year"}),f("extend-esri")&&a.setObject("renderer.TimeClassBreaksAger",c,e),c})},"esri/renderers/SymbolAger":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.renderer.SymbolAger",getAgedSymbol:function(a,e){},_setSymbolSize:function(a,e){switch(a.type){case "simplemarkersymbol":a.setSize(e);break;case "picturemarkersymbol":a.setWidth(e);a.setHeight(e);break;case "simplelinesymbol":case "cartographiclinesymbol":a.setWidth(e);
break;case "simplefillsymbol":case "picturefillsymbol":a.outline&&a.outline.setWidth(e)}}});return a("extend-esri")&&k.setObject("renderer.SymbolAger",h,f),h})},"esri/renderers/TimeRampAger":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has ../kernel ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(h,k,a,f,b,e,l,m){h=h(m,{declaredClass:"esri.renderer.TimeRampAger",constructor:function(a,b,c){this.colorRange=a;this.sizeRange=b;this.alphaRange=c},getAgedSymbol:function(b,
d){var c=d.getLayer(),g=d.attributes;b=e.fromJson(b.toJson());var f=c._map.timeExtent,l=f.startTime,f=f.endTime;if(!l||!f)return b;l=l.getTime();f=f.getTime();c=new Date(g[c._startTimeField]);c=c.getTime();l>c&&(c=l);var m,c=f===l?1:(c-l)/(f-l);if(g=this.sizeRange)f=g[0],g=g[1],l=Math.abs(g-f)*c,this._setSymbolSize(b,g>f?f+l:f-l);if(g=this.colorRange){var h=g[0],f=g[1],k=Math.round;m=new a;var w=h.r,x=f.r,l=Math.abs(x-w)*c;m.r=k(x>w?w+l:w-l);w=h.g;x=f.g;l=Math.abs(x-w)*c;m.g=k(x>w?w+l:w-l);w=h.b;
x=f.b;l=Math.abs(x-w)*c;m.b=k(x>w?w+l:w-l);h=h.a;f=f.a;l=Math.abs(f-h)*c;m.a=f>h?h+l:h-l;b.setColor(m)}if(m=b.color,g=this.alphaRange,g&&m)f=g[0],g=g[1],l=Math.abs(g-f)*c,m.a=g>f?f+l:f-l;return b},toJson:function(){var a={};return this.sizeRange&&(a.sizeRange=this.sizeRange),this.colorRange&&(a.colorRange=[l.toJsonColor(this.colorRange[0]),l.toJsonColor(this.colorRange[1])]),this.alphaRange&&(a.alphaRange=[Math.round(255*this.alphaRange[0]),Math.round(255*this.alphaRange[1])]),a}});return f("extend-esri")&&
k.setObject("renderer.TimeRampAger",h,b),h})},"esri/renderers/TemporalRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Renderer"],function(h,k,a,f,b){h=h(b,{declaredClass:"esri.renderer.TemporalRenderer",constructor:function(a,b,f,g){this.observationRenderer=a;this.latestObservationRenderer=b;this.trackRenderer=f;this.observationAger=g},getSymbol:function(a){var b=a.getLayer(),e=this.getObservationRenderer(a),g=e&&e.getSymbol(a),d=this.observationAger;
return b.timeInfo&&b._map.timeExtent&&e===this.observationRenderer&&d&&g&&(g=d.getAgedSymbol(g,a)),g},getObservationRenderer:function(a){return 0===a.getLayer()._getKind(a)?this.observationRenderer:this.latestObservationRenderer||this.observationRenderer},toJson:function(){var a={type:"temporal"};return a.observationRenderer=this.observationRenderer.toJson(),this.latestObservationRenderer&&(a.latestObservationRenderer=this.latestObservationRenderer.toJson()),this.trackRenderer&&(a.trackRenderer=this.trackRenderer.toJson()),
this.observationAger&&(a.observationAger=this.observationAger.toJson()),a}});return a("extend-esri")&&k.setObject("renderer.TemporalRenderer",h,f),h})},"esri/renderers/HeatmapRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct ../sniff ../kernel ../lang ../symbols/PictureMarkerSymbol ../Color ./Renderer".split(" "),function(h,k,a,f,b,e,l,m,g,d){h=h([d],{declaredClass:"esri.renderer.HeatmapRenderer",colors:null,blurRadius:10,maxPixelIntensity:100,minPixelIntensity:0,
field:null,fieldOffset:null,colorStops:null,constructor:function(a){return this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1,this._supportsCanvas?("string"==typeof a&&(a=JSON.parse(a)),k.mixin(this,a),this._canvas=null,this.colors||this.colorStops||(this.colorStops=[{ratio:0,color:"rgba(255, 140, 0, 0)"},{ratio:.75,color:"rgba(255, 140, 0, 1)"},{ratio:.9,color:"rgba(255, 0,   0, 1)"}]),void(this.gradient=this._generateGradient(this.colorStops||this.colors))):void 0},getSymbol:function(a){if(!this._supportsCanvas)return!1;
var b=a.attributes.imageData;a=a.attributes.size;if(!a)return null;var c=this._getContext(a[0],a[1]),d=c.getImageData(0,0,a[0],a[1]);if(window.ArrayBuffer&&b instanceof ArrayBuffer?b=window.Uint8ClampedArray?new Uint8ClampedArray(b):new Uint8Array(b):b.BYTES_PER_ELEMENT&&1!==b.BYTES_PER_ELEMENT&&(b=window.Uint8ClampedArray?new Uint8ClampedArray(b.buffer):new Uint8Array(b.buffer)),window.CanvasPixelArray&&d.data instanceof window.CanvasPixelArray)for(var e=d.data,g=e.length;g--;)e[g]=b[g];else d.data.set(b);
c.putImageData(d,0,0);return new m(c.canvas.toDataURL(),a[0],a[1])},setColors:function(a){return a&&(a instanceof Array||a.colors)&&(this.gradient=this._generateGradient(a.colors||a),this.colors=a),this},setColorStops:function(a){return a&&(a instanceof Array||a.colorStops)&&(this.gradient=this._generateGradient(a.colorStops||a),this.colorStops=a),this},setMaxPixelIntensity:function(a){return this.maxPixelIntensity=a,this},setMinPixelIntensity:function(a){return this.minPixelIntensity=a,this},setField:function(a){return this.field=
a,this},setFieldOffset:function(a){return this.fieldOffset=a,this},setBlurRadius:function(a){return this.blurRadius=a,this},getStats:function(){},getHistogramData:function(){},toJson:function(){var b=k.mixin(this.inherited(arguments),{type:"heatmap",blurRadius:this.blurRadius,colorStops:this._colorsToStops(this.colorStops||this.colors),maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity,field:this.field});return null!=this.fieldOffset&&(b.fieldOffset=this.fieldOffset),
a.forEach(b.colorStops,function(a){a.color=g.toJsonColor(a.color)}),l.fixJson(b)},_getContext:function(a,b){this._canvas?(this._canvas.width=a,this._canvas.height=b):this._canvas=this._initCanvas(a,b);return this._canvas.getContext("2d")},_initCanvas:function(a,b){var c=f.create("canvas",{id:"hm_canvas-"+Math.floor(1E3*Math.random()),style:"position: absolute; left: 0px; top: -10000px;"},null);return c.width=a,c.height=b,document.body.appendChild(c),c},_generateGradient:function(a,b){b||(b=512);for(var c,
d=this._colorsToStops(a),e=this._getContext(1,b||512),g=e.createLinearGradient(0,0,0,b),f=0;f<d.length;f++)c=d[f],g.addColorStop(c.ratio,c.color.toCss(!0));e.fillStyle=g;e.fillRect(0,0,1,b);return e.getImageData(0,0,1,b).data},_colorsToStops:function(b){var c=[];if(!b[0])return c;if(null!=b[0].ratio)c=a.map(b,function(a){return{ratio:a.ratio,color:this._toColor(a.color)}},this);else if(null!=b[0].value){for(var d=1/0,e=-(1/0),g=0,c=0;c<b.length;c++){var f=b[c].value;d>f&&(d=f);f>e&&(e=f)}g=e-d;this.maxPixelIntensity=
e;this.minPixelIntensity=d;c=a.map(b,function(a){var b=a.value;a=this._toColor(a.color);return{value:b,ratio:(b-d)/g,color:a}},this)}else var l=b.length-1,c=a.map(b,function(a,b){return{color:this._toColor(a),ratio:b/l}},this);return c},_toColor:function(a){return a.toRgba||a.declaredClass||(a=new g(a)),a}});return b("extend-esri")&&k.setObject("renderer.HeatmapRenderer",h,e),h})},"esri/tasks/QueryTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ../geometry/Extent ../geometry/normalizeUtils ./Task ./FeatureSet".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q){h=h(n,{declaredClass:"esri.tasks.QueryTask",_eventMap:{complete:["featureSet"],"execute-for-count-complete":["count"],"execute-for-ids-complete":["objectIds"],"execute-relationship-query-complete":["featureSets"]},constructor:function(a,b){this._handler=k.hitch(this,this._handler);this._relationshipQueryHandler=k.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=k.hitch(this,this._executeForIdsHandler);this._countHandler=k.hitch(this,this._countHandler);
this._extentHandler=k.hitch(this,this._extentHandler);this.source=b&&b.source;this.gdbVersion=b&&b.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:4,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForExtent",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},
onExecuteForExtentComplete:function(){},execute:function(a,c,d,e,g){var f=g.assembly;a=this._encode(k.mixin({},this._url.query,{f:"json"},a.toJson(f&&f[0])));var l=this._handler,n=this._errorHandler;this.source&&(f={source:this.source.toJson()},a.layer=b.toJson(f));return this.gdbVersion&&(a.gdbVersion=this.gdbVersion),m({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,b){l(a,b,c,d,g.dfd)},error:function(a){n(a,d,g.dfd)},callbackSuffix:e},this.requestOptions)},executeRelationshipQuery:function(a,
b,c){a=this._encode(k.mixin({},this._url.query,{f:"json"},a.toJson()));var d=this._relationshipQueryHandler,e=this._errorHandler;this.gdbVersion&&(a.gdbVersion=this.gdbVersion);var l=new f(g._dfdCanceller);return l._pendingDfd=m({url:this._url.path+"/queryRelatedRecords",content:a,callbackParamName:"callback",load:function(a,e){d(a,e,b,c,l)},error:function(a){e(a,c,l)}},this.requestOptions),l},executeForIds:function(a,c,d,e){var g=e.assembly;a=this._encode(k.mixin({},this._url.query,{f:"json",returnIdsOnly:!0},
a.toJson(g&&g[0])));var f=this._executeForIdsHandler,l=this._errorHandler;this.source&&(g={source:this.source.toJson()},a.layer=b.toJson(g));return this.gdbVersion&&(a.gdbVersion=this.gdbVersion),m({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,b){f(a,b,c,d,e.dfd)},error:function(a){l(a,d,e.dfd)}},this.requestOptions)},executeForCount:function(a,c,d,e){var g=e.assembly;a=this._encode(k.mixin({},this._url.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},a.toJson(g&&
g[0])));var f=this._countHandler,l=this._errorHandler;this.source&&(g={source:this.source.toJson()},a.layer=b.toJson(g));return this.gdbVersion&&(a.gdbVersion=this.gdbVersion),m({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,b){f(a,b,c,d,e.dfd)},error:function(a){l(a,d,e.dfd)}},this.requestOptions)},executeForExtent:function(a,c,d,e){var g=e.assembly;a=this._encode(k.mixin({},this._url.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},a.toJson(g&&g[0])));
var f=this._extentHandler,l=this._errorHandler;this.source&&(g={source:this.source.toJson()},a.layer=b.toJson(g));return this.gdbVersion&&(a.gdbVersion=this.gdbVersion),m({url:this._url.path+"/query",content:a,callbackParamName:"callback",load:function(a,b){f(a,b,c,d,e.dfd)},error:function(a){l(a,d,e.dfd)}},this.requestOptions)},_handler:function(a,b,c,d,e){try{var g=new q(a);this._successHandler([g],"onComplete",c,e)}catch(y){this._errorHandler(y,d,e)}},_relationshipQueryHandler:function(b,c,d,e,
g){try{var f=b.geometryType,l=b.spatialReference,m={};a.forEach(b.relatedRecordGroups,function(a){var b={};b.geometryType=f;b.spatialReference=l;b.features=a.relatedRecords;b=new q(b);if(null!=a.objectId)m[a.objectId]=b;else for(var c in a)a.hasOwnProperty(c)&&"relatedRecords"!==c&&(m[a[c]]=b)});this._successHandler([m],"onExecuteRelationshipQueryComplete",d,g)}catch(z){this._errorHandler(z,e,g)}},_executeForIdsHandler:function(a,b,c,d,e){try{this._successHandler([a.objectIds],"onExecuteForIdsComplete",
c,e)}catch(x){this._errorHandler(x,d,e)}},_countHandler:function(a,b,c,d,e){try{var g,f=a.features,l=a.objectIds;if(l)g=l.length;else{if(f)throw Error("Unable to perform query. Please check your parameters.");g=a.count}this._successHandler([g],"onExecuteForCountComplete",c,e)}catch(z){this._errorHandler(z,d,e)}},_extentHandler:function(a,b,c,e,g){try{a.extent&&(a.extent=new d(a.extent)),this._successHandler([a],"onExecuteForExtentComplete",c,g)}catch(x){this._errorHandler(x,e,g)}}});return c._createWrappers(h),
e("extend-esri")&&k.setObject("tasks.QueryTask",h,l),h})},"esri/tasks/FeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),function(h,k,a,f,b,e,l,m,g,d,c){h=h(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(b){if(b){k.mixin(this,b);var e=this.features,g=b.spatialReference,f=d.getGeometryType(b.geometryType),g=this.spatialReference=
new m(g);this.geometryType=b.geometryType;b.fields&&(this.fields=b.fields);a.forEach(e,function(a,b){var d=a.geometry&&a.geometry.spatialReference;e[b]=new l(f&&a.geometry?new f(a.geometry):null,a.symbol&&c.fromJson(a.symbol),a.attributes);e[b].geometry&&!d&&e[b].geometry.setSpatialReference(g)});this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,fieldAliases:null,toJson:function(a){var b={};return this.displayFieldName&&(b.displayFieldName=this.displayFieldName),
this.fields&&(b.fields=this.fields),this.spatialReference?b.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(b.spatialReference=this.features[0].geometry.spatialReference.toJson()),this.features[0]&&(this.features[0].geometry&&(b.geometryType=d.getJsonType(this.features[0].geometry)),b.features=g._encodeGraphics(this.features,a)),b.exceededTransferLimit=this.exceededTransferLimit,b.transform=this.transform,e.fixJson(b)},_hydrate:function(){var a=this.transform,
b=this.geometryType;if(!a||!b)return void(this.transform=null);for(var c=this.features,d=a.translate[0],e=a.translate[1],g=a.scale[0],f=a.scale[1],l=function(a,b,c){return"esriGeometryPoint"===a?function(a){a.x=b(a.x);a.y=c(a.y)}:"esriGeometryPolyline"===a||"esriGeometryPolygon"===a?function(a){var d,e,g,f,l,m,n,h=a.rings||a.paths;a=0;for(d=h.length;d>a;a++)for(f=h[a],e=0,g=f.length;g>e;e++)l=f[e],0<e?(m+=l[0],n+=l[1]):(m=l[0],n=l[1]),l[0]=b(m),l[1]=c(n)}:"esriGeometryEnvelope"===a?function(a){a.xmin=
b(a.xmin);a.ymin=c(a.ymin);a.xmax=b(a.xmax);a.ymax=c(a.ymax)}:"esriGeometryMultipoint"===a?function(a){var d,e,g,f,l=a.points;a=0;for(d=l.length;d>a;a++)e=l[a],0<a?(g+=e[0],f+=e[1]):(g=e[0],f=e[1]),e[0]=b(g),e[1]=c(f)}:void 0}(b,function(a){return a*g+d},function(a){return e-a*f}),a=0,b=c.length;b>a;a++)c[a].geometry&&l(c[a].geometry);this.transform=null},quantize:function(a){if(!this.geometryType)return this.transform=null,this;var b,c,d=a.translate[0],e=a.translate[1],g=a.scale[0],f=a.scale[1],
l=this.features,m=function(a,b,c){var d,e,g,f,l,m,n,h=[];d=0;for(e=a.length;e>d;d++)g=a[d],0<d?(m=b(g[0]),n=c(g[1]),(m!==f||n!==l)&&(h.push([m-f,n-l]),f=m,l=n)):(f=b(g[0]),l=c(g[1]),h.push([f,l]));return 0<h.length?h:null},n=function(a,b,c){return"esriGeometryPoint"===a?function(a){return a.x=b(a.x),a.y=c(a.y),a}:"esriGeometryPolyline"===a||"esriGeometryPolygon"===a?function(a){var d,e,g,f,l;g=a.rings||a.paths;l=[];d=0;for(e=g.length;e>d;d++)f=g[d],(f=m(f,b,c))&&l.push(f);return 0<l.length?(a.rings?
a.rings=l:a.paths=l,a):null}:"esriGeometryMultipoint"===a?function(a){var d;return d=m(a.points,b,c),0<d.length?(a.points=d,a):null}:"esriGeometryEnvelope"===a?function(a){return a}:void 0}(this.geometryType,function(a){return Math.round((a-d)/g)},function(a){return Math.round((e-a)/f)});b=0;for(c=l.length;c>b;b++)l[b].geometry&&(n(l[b].geometry)||l[b].setGeometry(null));return this.transform=a,this}});return f("extend-esri")&&k.setObject("tasks.FeatureSet",h,b),h})},"esri/graphicsUtils":function(){define(["dojo/_base/lang",
"dojo/_base/array","dojo/has","./kernel","./geometry/Extent"],function(h,k,a,f,b){var e={graphicsExtent:function(a){if(!a||!a.length)return null;var e,g,d=a[0].geometry,c=d.getExtent(),f=a.length;null===c&&(c=new b(d.x,d.y,d.x,d.y,d.spatialReference));for(g=1;f>g;g++)e=(d=a[g].geometry).getExtent(),null===e&&(e=new b(d.x,d.y,d.x,d.y,d.spatialReference)),c=c.union(e);return 0>c.getWidth()&&0>c.getHeight()?null:c},getGeometries:function(a){return k.map(a,function(a){return a.geometry})},_encodeGraphics:function(a,
b){var e,d,c,f=[];return k.forEach(a,function(a,g){e=a.toJson();d={};e.geometry&&(c=b&&b[g],d.geometry=c&&c.toJson()||e.geometry);e.attributes&&(d.attributes=e.attributes);f[g]=d}),f}};return a("extend-esri")&&h.mixin(f,e),e})},"esri/tasks/StatisticDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.tasks.StatisticDefinition",toJson:function(){return{statisticType:this.statisticType,onStatisticField:this.onStatisticField,
outStatisticFieldName:this.outStatisticFieldName,maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount}}});return a("extend-esri")&&k.setObject("tasks.StatisticDefinition",h,f),h})},"esri/layers/Field":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./RangeDomain ./CodedValueDomain".split(" "),function(h,k,a,f,b,e){h=h(null,{declaredClass:"esri.layers.Field",constructor:function(a){if(a&&k.isObject(a)&&(this.name=a.name,this.type=
a.type,this.alias=a.alias,this.length=a.length,this.editable=a.editable,this.nullable=a.nullable,(a=a.domain)&&k.isObject(a)))switch(a.type){case "range":this.domain=new b(a);break;case "codedValue":this.domain=new e(a)}}});return a("extend-esri")&&k.setObject("layers.Field",h,f),h})},"esri/layers/RangeDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./Domain".split(" "),function(h,k,a,f,b,e){h=h([e],{declaredClass:"esri.layers.RangeDomain",constructor:function(a){a&&
k.isObject(a)&&(this.minValue=a.range[0],this.maxValue=a.range[1])},toJson:function(){var a=this.inherited(arguments);return a.range=[this.minValue,this.maxValue],b.fixJson(a)}});return a("extend-esri")&&k.setObject("layers.RangeDomain",h,f),h})},"esri/layers/Domain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(h,k,a,f,b){h=h(null,{declaredClass:"esri.layers.Domain",constructor:function(a){a&&k.isObject(a)&&(this.name=a.name,this.type=a.type)},
toJson:function(){return b.fixJson({name:this.name,type:this.type})}});return a("extend-esri")&&k.setObject("layers.Domain",h,f),h})},"esri/layers/CodedValueDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ./Domain".split(" "),function(h,k,a,f,b,e,l){h=h([l],{declaredClass:"esri.layers.CodedValueDomain",constructor:function(a){a&&k.isObject(a)&&(this.codedValues=a.codedValues)},getName:function(b){var e;return a.some(this.codedValues,function(a){return a.code==
b&&(e=a.name),!!e}),e},toJson:function(){var a=this.inherited(arguments);return a.codedValues=k.clone(this.codedValues),e.fixJson(a)}});return f("extend-esri")&&k.setObject("layers.CodedValueDomain",h,b),h})},"esri/layers/FeatureType":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../symbols/jsonUtils ./RangeDomain ./CodedValueDomain ./InheritedDomain ./FeatureTemplate".split(" "),function(h,k,a,f,b,e,l,m,g,d,c){h=h(null,{declaredClass:"esri.layers.FeatureType",
constructor:function(a){if(a&&k.isObject(a)){this.id=a.id;this.name=a.name;var b=a.symbol;b&&(this.symbol=l.fromJson(b));var e,b=a.domains,f=this.domains={};for(e in b)if(b.hasOwnProperty(e)){var n=b[e];switch(n.type){case "range":f[e]=new m(n);break;case "codedValue":f[e]=new g(n);break;case "inherited":f[e]=new d(n)}}if(e=a.templates)for(b=this.templates=[],a=0;a<e.length;a++)b.push(new c(e[a]))}},toJson:function(){var b,c={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()},d=this.domains,
g=this.templates,f=e.fixJson;if(d){var l=c.domains={};for(b in d)d.hasOwnProperty(b)&&(l[b]=d[b]&&d[b].toJson());f(l)}return g&&(c.templates=a.map(g,function(a){return a.toJson()})),f(c)}});return f("extend-esri")&&k.setObject("layers.FeatureType",h,b),h})},"esri/layers/InheritedDomain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Domain"],function(h,k,a,f,b){h=h([b],{declaredClass:"esri.layers.InheritedDomain"});return a("extend-esri")&&k.setObject("layers.InheritedDomain",
h,f),h})},"esri/layers/FeatureTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../graphic".split(" "),function(h,k,a,f,b,e){h=h(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(a){a&&k.isObject(a)&&(this.name=a.name,this.description=a.description,this.drawingTool=a.drawingTool,this.thumbnail=a.thumbnail,a=a.prototype,this.prototype=new e(a.geometry,null,a.attributes))},toJson:function(){return b.fixJson({name:this.name,description:this.description,
drawingTool:this.drawingTool,thumbnail:b.fixJson(k.clone(this.thumbnail)),prototype:this.prototype&&this.prototype.toJson()})}});return k.mixin(h,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",
TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"}),a("extend-esri")&&k.setObject("layers.FeatureTemplate",h,f),h})},"esri/layers/FeatureEditResult":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.layers.FeatureEditResult",
constructor:function(a){a&&k.isObject(a)&&(this.objectId=a.objectId,this.globalId=a.globalId,this.success=a.success,!a.success)&&(a=a.error,this.error=Error(),this.error.code=a.code,this.error.message=a.description)}});return a("extend-esri")&&k.setObject("layers.FeatureEditResult",h,f),h})},"esri/layers/LabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../symbols/TextSymbol ../symbols/ShieldLabelSymbol".split(" "),function(h,k,a,f,b,e,l,
m){var g=RegExp("__begin__","ig"),d=RegExp("__end__","ig"),c=/^__begin__/i,n=/__end__$/i;h=h(null,{declaredClass:"esri.layers.LabelClass",labelPlacement:null,labelExpression:null,format:null,fieldInfos:null,useCodedValues:null,symbol:null,maxScale:0,minScale:0,where:null,sizeInfo:null,_labelPlacementLookup:{"above-center":"esriServerPointLabelPlacementAboveCenter","above-left":"esriServerPointLabelPlacementAboveLeft","above-right":"esriServerPointLabelPlacementAboveRight","below-center":"esriServerPointLabelPlacementBelowCenter",
"below-left":"esriServerPointLabelPlacementBelowLeft","below-right":"esriServerPointLabelPlacementBelowRight","center-center":"esriServerPointLabelPlacementCenterCenter","center-left":"esriServerPointLabelPlacementCenterLeft","center-right":"esriServerPointLabelPlacementCenterRight","above-after":"esriServerLinePlacementAboveAfter","above-along":"esriServerLinePlacementAboveAlong","above-before":"esriServerLinePlacementAboveBefore","above-start":"esriServerLinePlacementAboveStart","above-end":"esriServerLinePlacementAboveEnd",
"below-after":"esriServerLinePlacementBelowAfter","below-along":"esriServerLinePlacementBelowAlong","below-before":"esriServerLinePlacementBelowBefore","below-start":"esriServerLinePlacementBelowStart","below-end":"esriServerLinePlacementBelowEnd","center-after":"esriServerLinePlacementCenterAfter","center-along":"esriServerLinePlacementCenterAlong","center-before":"esriServerLinePlacementCenterBefore","center-start":"esriServerLinePlacementCenterStart","center-end":"esriServerLinePlacementCenterEnd",
"always-horizontal":"esriServerPolygonPlacementAlwaysHorizontal"},constructor:function(a){a&&(k.mixin(this,a),this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)||(this.labelPlacement=e.valueOf(this._labelPlacementLookup,a.labelPlacement)),a.format&&(this.format=a.format),a.fieldInfos&&(this.fieldInfos=a.fieldInfos),a.symbol&&("esriSHD"===a.symbol.type?this.symbol=new m(a.symbol):this.symbol=new l(a.symbol)),(a=this.sizeInfo)&&(a.minSize&&(a.minSize=f.pt2px(a.minSize)),a.maxSize&&(a.maxSize=
f.pt2px(a.maxSize))))},getSymbol:function(){return this.symbol},toJson:function(){var a=this.sizeInfo;a&&(a=k.mixin({},a),a.minSize&&(a.minSize=f.px2pt(a.minSize)),a.maxSize&&(a.maxSize=f.px2pt(a.maxSize)));var b=e.fixJson(this.labelExpressionInfo&&k.clone(this.labelExpressionInfo));this._processLabelExpressionInfo(b);a={name:this.name,labelExpression:this.labelExpression,labelExpressionInfo:b,format:this.format||void 0,fieldInfos:this.fieldInfos||void 0,useCodedValues:this.useCodedValues,maxScale:this.maxScale,
minScale:this.minScale,where:this.where,sizeInfo:a||void 0,labelPlacement:this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)?this._labelPlacementLookup[this.labelPlacement]:this.labelPlacement,symbol:this.symbol&&this.symbol.toJson()};return e.fixJson(a)},_processLabelExpressionInfo:function(a){a&&a.value&&(a.expression=this._convertTemplatedStringToArcade(a.value))},_convertTemplatedStringToArcade:function(a){var b;return a&&(b=k.replace(a,function(a,b){return'__begin__$feature["'+b+
'"]__end__'}),b=c.test(b)?b.replace(c,""):'"'+b,b=n.test(b)?b.replace(n,""):b+'"',b=b.replace(g,'" + ').replace(d,' + "')),b}});return a("extend-esri")&&k.setObject("layers.LabelClass",h,b),h})},"esri/symbols/ShieldLabelSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol ./Font".split(" "),function(h,k,a,f,b,e,l,m,g){var d={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};h=h(m,{declaredClass:"esri.symbol.ShieldLabelSymbol",
type:"shieldlabelsymbol",color:[255,255,255,1],width:32,height:32,font:f.defaultFont,constructor:function(b,e,g,l,m){b?k.isString(b)?(this.url=b,e&&(this.color=e),g&&(this.width=g),l&&(this.height=l),void 0!==m&&(this.font=m)):(this.width=f.pt2px(b.width),this.height=f.pt2px(b.height),e=b.imageData,9>a("ie")||!e||(g=this.url,this.url="data:"+(b.contentType||"image")+";base64,"+e,this.imageData=g)):k.mixin(this,d)},getStroke:function(){return null},getFill:function(){return this.color},setWidth:function(a){return this.width=
a,this},setHeight:function(a){return this.height=a,this},setUrl:function(a){return a!==this.url&&(delete this.imageData,delete this.contentType),this.url=a,this},setFont:function(a){return this.font=a,this},setText:function(a){return this.text=a,this},getWidth:function(){return this.width},getHeight:function(){return this.height},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||
""},fill:null,stroke:null}},toJson:function(){var a=this.url,b=this.imageData;if(0===a.indexOf("data:"))var d=a,a=b,b=d.indexOf(";base64,")+8,b=d.substr(b);var a=l.getAbsoluteUrl(a),d=f.px2pt(this.width),d=isNaN(d)?void 0:d,m=f.px2pt(this.height),m=isNaN(m)?void 0:m,a=e.fixJson(k.mixin(this.inherited("toJson",arguments),{type:"esriSHD",url:a,imageData:b,contentType:this.contentType,width:d,height:m}));this.font?(b=new g(this.font),a.font=b.toJson()):a.font=null;return delete a.size,a.imageData||delete a.imageData,
a}});return h.defaultProps=d,a("extend-esri")&&(k.setObject("symbol.ShieldLabelSymbol",h,b),b.symbol.defaultShieldLabelSymbol=d),h})},"esri/layers/SnapshotMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ../tasks/query ./RenderMode".split(" "),function(h,k,a,f,b,e,l){h=h([l],{declaredClass:"esri.layers._SnapshotMode",constructor:function(a){this.featureLayer=a;this.pagination=a.queryPagination;this._featureMap={};this._hasPartialFeatures=!1;this._drawFeatures=
k.hitch(this,this._drawFeatures);this._queryErrorHandler=k.hitch(this,this._queryErrorHandler)},startup:function(){this.pagination=this.pagination&&null!=this.featureLayer.maxRecordCount;this.featureLayer._collection?this._applyTimeFilter():this._fetchAll()},propertyChangeHandler:function(a){this._init&&(a?this.featureLayer._collection||this._fetchAll():this._applyTimeFilter())},drawFeature:function(a){var b=a.attributes[this.featureLayer.objectIdField];this._addFeatureIIf(b,a);this._incRefCount(b)},
resume:function(){this.propertyChangeHandler(0)},refresh:function(){var a=this.featureLayer;a._collection?(a._fireUpdateStart(),a._refresh(!0),a._fireUpdateEnd()):this._fetchAll()},hasAllFeatures:function(){return!this._hasPartialFeatures},_getRequestId:function(a){return("_"+a.name+a.layerId+a._ulid).replace(/[^a-zA-Z0-9\_]+/g,"_")},_fetchAll:function(){var a=this.featureLayer;a._collection||a.suspended||!a.isQueryable()||(a._fireUpdateStart(),this._clearIIf(),this._hasPartialFeatures=!1,this._sendRequest())},
_sendRequest:function(a){var g=this.map,d=this.featureLayer,c=d.getDefinitionExpression(),f=new e;f.outFields=d.getOutFields();f.where=c||"1\x3d1";f.returnGeometry=!0;f.outSpatialReference=new b(g.spatialReference.toJson());f.timeExtent=d.getTimeDefinition();f.maxAllowableOffset=d._maxOffset;f.quantizationParameters=d._quantizationParameters;d._ts&&(f._ts=(new Date).getTime());f.orderByFields=d.supportsAdvancedQueries?d.getOrderByFields():null;f.multipatchOption=d.multipatchOption;this.pagination&&
(this._start=f.start=null==a?0:a,f.num=d.maxRecordCount);var l;d._usePatch&&(l=this._getRequestId(d),this._cancelPendingRequest(null,l));d._task.execute(f,this._drawFeatures,this._queryErrorHandler,l)},_drawFeatures:function(a){this._purgeRequests();var b,d,c,e,f=a.features,l=this.featureLayer,m=l.objectIdField,h=f.length,k=a.exceededTransferLimit&&!l._collection,w=l._selectedFeatures,x=l.mode===l.constructor.MODE_AUTO;l._fireUpdateStart();l._sortFeatures(f);for(b=0;h>b;b++)c=f[b],e=c.attributes[m],
d=this._addFeatureIIf(e,c),this._incRefCount(e),x&&d!==c&&w[e]&&(d.setGeometry(c.geometry),d.setAttributes(c.attributes));this._applyTimeFilter(!0);this.pagination&&k||(this._hasPartialFeatures=!!a.exceededTransferLimit,l._fireUpdateEnd(null,a.exceededTransferLimit?{queryLimitExceeded:!0}:null));k&&(this.pagination&&this._sendRequest(this._start+l.maxRecordCount),l.onQueryLimitExceeded())},_queryErrorHandler:function(a){this._purgeRequests();this._hasPartialFeatures=!0;var b=this.featureLayer;b._errorHandler(a);
b._fireUpdateEnd(a)}});return a("extend-esri")&&k.setObject("layers._SnapshotMode",h,f),h})},"esri/layers/RenderMode":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/io/script ../kernel".split(" "),function(h,k,a,f,b,e,l){k=k(null,{declaredClass:"esri.layers._RenderMode",constructor:function(){this._prefix="jsonp_"+(h._scopeName||"dojo")+"IoScript"},initialize:function(a){this.map=a;this._init=!0},startup:function(){},propertyChangeHandler:function(a){},
destroy:function(){this._init=!1},drawFeature:function(a){},suspend:function(){},resume:function(){},refresh:function(){},hasAllFeatures:function(){return!0},_incRefCount:function(a){(a=this._featureMap[a])&&a._count++},_decRefCount:function(a){(a=this._featureMap[a])&&a._count--},_getFeature:function(a){return this._featureMap[a]},_addFeatureIIf:function(a,b){var d=this._featureMap,c=d[a],e=this.featureLayer;return c||(d[a]=b,e._add(b),b._count=0),c||b},_removeFeatureIIf:function(a){var b=this._featureMap[a],
d=this.featureLayer;if(b){if(b._count)return;delete this._featureMap[a];d._remove(b)}return b},_clearIIf:function(){var a;a=this.featureLayer;var b=a.graphics,d=a._selectedFeatures,c=a.getSelectedFeatures().length,e=a.objectIdField;if(c)for(a=b.length-1;0<=a;a--){var c=b[a],f=c.attributes[e];f in d?c._count=1:(c._count=0,this._removeFeatureIIf(f))}else a.clear(),this._featureMap={}},_isPending:function(a){return e[this._prefix+a]?!0:!1},_cancelPendingRequest:function(a,b){if(a=a||e[this._prefix+b])try{a.cancel(),
e._validCheck(a)}catch(d){}},_purgeRequests:function(){e._validCheck(null)},_toggleVisibility:function(a){var b,d=this.featureLayer,c=d.graphics,e=a?"show":"hide",f=c.length;a=a&&d._ager;for(b=0;f>b;b++){var l=c[b];l[e]();a&&d._repaint(l)}},_applyTimeFilter:function(a){var b=this.featureLayer;if(b.timeInfo&&!b.suspended){a||b._fireUpdateStart();var d=b._trackManager;d&&d.clearTracks();var c=b.getTimeDefinition(),e=b._getOffsettedTE(b._mapTimeExtent);e?(e=b._getTimeOverlap(c,e))?(c=b._filterByTime(b.graphics,
e.startTime,e.endTime),d&&d.addFeatures(c.match),f.forEach(c.match,function(a){var c=a._shape;a.visible||(a.show(),c=a._shape,c&&c._moveToFront());b._ager&&c&&b._repaint(a)}),f.forEach(c.noMatch,function(a){a.visible&&a.hide()})):this._toggleVisibility(!1):(d&&d.addFeatures(b.graphics),this._toggleVisibility(!0));d&&(d.moveLatestToFront(),d.drawTracks());a||b._fireUpdateEnd()}}});return b("extend-esri")&&a.setObject("layers._RenderMode",k,l),k})},"esri/layers/OnDemandMode":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/has ../kernel ../geometry/Point ../tasks/query ./RenderMode ./GridLayout".split(" "),
function(h,k,a,f,b,e,l,m,g,d){h=h([g],{declaredClass:"esri.layers._OnDemandMode",constructor:function(b){this.featureLayer=b;this._featureMap={};this._hasPartialFeatures=!1;this._queryErrorHandler=a.hitch(this,this._queryErrorHandler)},initialize:function(a){this.inherited(arguments);var b=this.featureLayer,c=b._srInfo;this._gridLayer=new d(new l(c?c.valid[0]:a.extent.xmin,c?c.valid[1]:a.extent.ymax,a.spatialReference),{width:b._tileWidth,height:b._tileHeight},{width:a.width,height:a.height},c);this._cellMap=
{};this._gridLayer.setResolution(a.extent)},startup:function(){this._ioQueue=[];this.featureLayer.suspended||(this._zoomHandler(),this._enableConnectors())},propertyChangeHandler:function(a){this._init&&2>a&&this._zoomHandler()},destroy:function(){this._disableConnectors();this.inherited(arguments)},drawFeature:function(a){var b=this._gridLayer,c=a.geometry,d=[];if(c)for(var d=b.getCellsInExtent("point"===c.type?{xmin:c.x,ymin:c.y,xmax:c.x,ymax:c.y}:c.getExtent(),!1).cells,e,f,g,l=this._cellMap,m=
a.attributes[this.featureLayer.objectIdField],b=0;b<d.length;b++)c=d[b],e=c.latticeID,f=c.row,g=c.col,e?c=l[e]=l[e]||c:(l[f]=l[f]||{},c=l[f][g]=l[f][g]||c),c.features=c.features||[],c.features.push(a),this._addFeatureIIf(m,a),this._incRefCount(m)},suspend:function(){this._init&&this._disableConnectors()},resume:function(){this._init&&(this._enableConnectors(),this._zoomHandler())},refresh:function(){this._zoomHandler()},hasAllFeatures:function(){if(this._hasPartialFeatures)return!0;var a,b=!1,d=this._getCurrentCells();
for(a=0;a<d.length;a++)if(d[a].hasPartialFeatures){b=!0;break}return!b},_enableConnectors:function(){var a=this.map;this._zoomConnect=k.connect(a,"onZoomEnd",this,this._zoomHandler);this._panConnect=k.connect(a,"onPanEnd",this,this._panHandler);this._resizeConnect=k.connect(a,"onResize",this,this._panHandler)},_disableConnectors:function(){k.disconnect(this._zoomConnect);k.disconnect(this._panConnect);k.disconnect(this._resizeConnect)},_zoomHandler:function(){this._processIOQueue(!0);var a=this.featureLayer,
b=this.map;!a.suspended&&a.isQueryable()&&(a._fireUpdateStart(),this._clearIIf(),this._hasPartialFeatures=!1,(a=a._trackManager)&&a.clearTracks(),this._cellMap={},this._gridLayer.setResolution(b.extent),this._sendRequest())},_panHandler:function(a){if(this.featureLayer.isQueryable()){this.featureLayer._fireUpdateStart();var b=this.featureLayer._resized;a=b?a:null;b&&this._gridLayer.setMapState(a,this.map.width,this.map.height);this._sendRequest(a)}},_getRequestId:function(a,b){return("_"+a.name+a.layerId+
a._ulid+"_"+b.resolution+"_"+(b.latticeID||b.row+"_"+b.col)).replace(/[^a-zA-Z0-9\_]+/g,"_")},_sendRequest:function(a){this._exceeds=!1;var b=this.featureLayer,c=this.map;a=a||c.extent;c=this._gridLayer.getCellsInExtent(a,b.latticeTiling).cells;if(!b.isEditable())var d=this._cellMap,c=f.filter(c,function(a){if(a.lattice){if(d[a.latticeID])return!1}else if(d[a.row]&&d[a.row][a.col])return!1;return!0});var e,g,l,h,k=b.getOutFields(),y=b.getDefinitionExpression(),A=b._getOffsettedTE(b._mapTimeExtent),
z=b.supportsAdvancedQueries?b.getOrderByFields():null,B=b._usePatch,C=this._ioQueue,D=this,E=this._drawFeatures;this._pending=this._pending||0;for(e=0;e<c.length;e++)g=c[e],l=new m,l.geometry=g.extent||g.lattice,l.outFields=k,l.where=y,b.latticeTiling&&g.extent&&(l.spatialRelationship=m.SPATIAL_REL_CONTAINS),l.returnGeometry=!0,l.timeExtent=A,b._ts&&(l._ts=(new Date).getTime()),l.orderByFields=z,l.multipatchOption=b.multipatchOption,l.maxAllowableOffset=b._maxOffset,l.quantizationParameters=b._quantizationParameters,
(h=b.advancedQueryCapabilities)&&h.supportsQueryWithResultType&&(l.resultType="tile"),h=null,B&&(h=this._getRequestId(b,g),this._isPending(h))||(this._pending++,C.push(b._task.execute(l,function(){var a=g;return function(b){E.apply(D,[b,a])}}.call(this),this._queryErrorHandler,h)));this._removeOldCells(a);this._endCheck()},_drawFeatures:function(a,b){b.hasPartialFeatures=!!a.exceededTransferLimit;this._exceeds=this._exceeds||a.exceededTransferLimit;this._finalizeIO();var c,d;c=this.featureLayer;d=
this.map.extent;var e=b.extent,f=b.row,g=b.col,l=c.objectIdField,m=a.features,h=this._gridLayer,n=this._cellMap,k=b.latticeID,B=k?n[k]:n[f]&&n[f][g];if(b.resolution==h._resolution&&(k?k===h.getLatticeID(d):h.intersects(e,d)))if(B)c._sortFeatures(m),this._updateCell(B,m);else for(c._sortFeatures(m),b.features=m,k?n[k]=b:(n[f]=n[f]||{},n[f][g]=b),d=m.length,c=0;d>c;c++)e=m[c],f=e.attributes[l],this._addFeatureIIf(f,e),this._incRefCount(f);else B&&this._removeCell(f,g,k);this._endCheck()},_queryErrorHandler:function(a){this._finalizeIO();
this._hasPartialFeatures=!0;this.featureLayer._errorHandler(a);this._endCheck(!0)},_finalizeIO:function(){this._purgeRequests();this._pending--},_endCheck:function(a){if(0===this._pending){this._processIOQueue();var b=this.featureLayer,c=b._trackManager;c&&(c.clearTracks(),c.addFeatures(b.graphics),b._ager&&f.forEach(b.graphics,function(a){a._shape&&b._repaint(a)}),c.moveLatestToFront(),c.drawTracks());this.featureLayer._fireUpdateEnd(a&&Error("FeatureLayer: an error occurred while updating the layer"),
this._exceeds?{queryLimitExceeded:!0}:null);this._exceeds&&b.onQueryLimitExceeded()}},_processIOQueue:function(a){this._ioQueue=f.filter(this._ioQueue,function(a){return-1<a.fired?!1:!0});a&&f.forEach(this._ioQueue,this._cancelPendingRequest)},_getCurrentCells:function(a){var b,c=[];a=a||this._cellMap;for(b in a)if(a.hasOwnProperty(b)){var d=a[b];d&&(d.hasOwnProperty("row")||d.hasOwnProperty("latticeID")?c.push(d):"object"==typeof d&&c.push.apply(c,this._getCurrentCells(d)))}return c},_removeOldCells:function(a){var b,
c,d=this._cellMap,e=this._gridLayer;for(b in d)if(d[b]){var f=d[b],g=f.latticeID,l=0,m=0;if(g)l++,g!==e.getLatticeID(a)&&(this._removeCell(null,null,g),m++);else for(c in f)f[c]&&(l++,e.intersects(f[c].extent,a)||(this._removeCell(b,c),m++));m===l&&delete d[b]}},_updateCell:function(a,b){var c;c=this.featureLayer;var d=c.objectIdField,e=c._selectedFeatures,f=b.length;a.features=a.features||[];for(c=0;f>c;c++){var g=b[c],l=g.attributes[d],m=this._addFeatureIIf(l,g);m===g?(this._incRefCount(l),a.features.push(m)):
l in e||(m.setGeometry(g.geometry),m.setAttributes(g.attributes))}},_removeCell:function(a,b,d){var c=this._cellMap,e=this.featureLayer,f=e.objectIdField,g=d?c[d]:c[a]&&c[a][b];if(g)for(d?delete c[d]:delete c[a][b],b=g.features,a=0;a<b.length;a++)d=b[a].attributes[f],this._decRefCount(d),d in e._selectedFeatures||this._removeFeatureIIf(d)}});return b("extend-esri")&&a.setObject("layers._OnDemandMode",h,e),h})},"esri/layers/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/Polyline".split(" "),
function(h,k,a,f,b,e,l,m){h=h(null,{declaredClass:"esri.layers._GridLayout",constructor:function(a,b,c,e){this.origin=a;this.cellWidth=b.width;this.cellHeight=b.height;this.mapWidth=c.width;this.mapHeight=c.height;this.srInfo=e},setResolution:function(a){if(this._resolution=(a.xmax-a.xmin)/this.mapWidth,this.srInfo)a=Math.round(Math.round(2*this.srInfo.valid[1]/this._resolution)/this.cellWidth),this._frameStats=[a,0,a-1]},setMapState:function(a,b,c){this.mapWidth=b;this.mapHeight=c;this.setResolution(a)},
getCellCoordinates:function(a){var b=this._resolution,c=this.origin;return{row:Math.floor((c.y-a.y)/(this.cellHeight*b)),col:Math.floor((a.x-c.x)/(this.cellWidth*b))}},normalize:function(a){var b=this._frameStats;if(b){var c=b[0],e=b[1],b=b[2];e>a?(a%=c,a=e>a?a+c:a):a>b&&(a%=c)}return a},intersects:function(b,d){var c=this.srInfo;return c?a.some(d._getParts(c),function(a){return b.intersects(a.extent)}):b.intersects(d)},getCellExtent:function(a,b){var c=this._resolution,d=this.origin,f=this.cellWidth,
g=this.cellHeight;return new l(b*f*c+d.x,d.y-(a+1)*g*c,(b+1)*f*c+d.x,d.y-a*g*c,new e(d.spatialReference.toJson()))},getLatticeID:function(a){var b=this.getCellCoordinates({x:a.xmin,y:a.ymax}),c=this.getCellCoordinates({x:a.xmax,y:a.ymin});a=b.row;var e=c.row,b=this.normalize(b.col),c=this.normalize(c.col);return a+"_"+e+"_"+b+"_"+c},sorter:function(a,b){return b>a?-1:1},getCellsInExtent:function(b,d){var c,e,f,g,l,h,k,w,x=this.getCellCoordinates({x:b.xmin,y:b.ymax}),y=this.getCellCoordinates({x:b.xmax,
y:b.ymin}),A=x.row,z=y.row,x=x.col,y=y.col,B=[];w=[];var C=[],D=[];for(c=A;z>=c;c++)for(e=x;y>=e;e++)f=this.normalize(e),b=this.getCellExtent(c,f),a.some(B,function(a){return a.row===c&&a.col===f})||B.push({row:c,col:f,extent:b,resolution:this._resolution}),d&&(w.push(b.xmin,b.xmax),C.push(b.ymin,b.ymax));x=this.normalize(x);y=this.normalize(y);w.sort(this.sorter);C.sort(this.sorter);e=w.length;for(c=e-1;0<=c;c--)e-1>c&&w[c]===w[c+1]&&w.splice(c,1);e=C.length;for(c=e-1;0<=c;c--)e-1>c&&C[c]===C[c+
1]&&C.splice(c,1);if(w.length&&C.length){g=w[0];l=w[w.length-1];h=C[0];k=C[C.length-1];e=w.length;for(c=0;e>c;c++)D.push([[w[c],k],[w[c],h]]);e=C.length;for(c=0;e>c;c++)D.push([[g,C[c]],[l,C[c]]]);w=new m({paths:D,spatialReference:this.origin.spatialReference.toJson()});B.push({latticeID:A+"_"+z+"_"+x+"_"+y,lattice:w,resolution:this._resolution})}return{minRow:A,maxRow:z,minCol:x,maxCol:y,cells:B}}});return f("extend-esri")&&k.setObject("layers._GridLayout",h,b),h})},"esri/layers/SelectionMode":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","./RenderMode"],function(h,k,a,f,b){h=h([b],{declaredClass:"esri.layers._SelectionMode",constructor:function(a){this.featureLayer=a;this._featureMap={}},propertyChangeHandler:function(a){this._init&&0===a&&this._applyTimeFilter()},resume:function(){this.propertyChangeHandler(0)},hasAllFeatures:function(){return!this.featureLayer._hasPartialSelectedFeatures}});return a("extend-esri")&&k.setObject("layers._SelectionMode",h,f),h})},"esri/layers/StreamMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../SpatialReference ../tasks/query ../tasks/QueryTask ../geometry/jsonUtils ./RenderMode".split(" "),
function(h,k,a,f,b,e,l,m,g,d){h=h([d],{declaredClass:"esri.layers._StreamMode",constructor:function(a,b){this.featureLayer=a;this._featureMap={};this._setRefreshRate();this._drawBuffer={adds:[],updates:[]};this._timeoutId=null;this._flushDrawBuffer=k.hitch(this,this._flushDrawBuffer);this._featuresByTime={};this._lastEndTimeCheck=null;this._maxFeatureAge=0;a.purgeOptions&&a.purgeOptions.age&&"number"==typeof a.purgeOptions.age&&(this._maxFeatureAge=1E3*Math.ceil(60*a.purgeOptions.age));this._drawFeatures=
k.hitch(this,this._drawFeatures);this._queryErrorHandler=k.hitch(this,this._queryErrorHandler)},startup:function(){this.featureLayer._collection},propertyChangeHandler:function(a){this._init&&(0===a?this._applyTimeFilter():3===a&&this._redrawAllTracks())},destroy:function(){this.inherited(arguments);clearTimeout(this._timeoutId);this._featuresByTime=this._drawBuffer=this._featureMap=null},drawFeature:function(a){var b=this.featureLayer,c=b.objectIdField;this._timeoutId||(this._timeoutId=setTimeout(this._flushDrawBuffer,
this._refreshRate));b._joinField&&this._getFeature(a.attributes[c])?this._drawBuffer.updates.push({oid:a.attributes[c],updates:a}):this._drawBuffer.adds.push(a)},resume:function(){this.propertyChangeHandler(0)},refresh:function(){var a=this.featureLayer;a&&(a._relatedUrl||a._keepLatestUrl?(a._fireUpdateStart(),a._refreshing=!0,a.disconnect(),a.clear(),a._relatedQueried=!1,a._keepLatestQueried=!1,a.connect()):(a._fireUpdateStart(),a.clear(),a._fireUpdateEnd()))},_drawFeatures:function(a,b){this._purgeRequests();
var c=this.featureLayer;c._create(a.features||[]);c._fireUpdateEnd(null,b)},_applyTimeFilter:function(a){this.inherited(arguments);this._redrawAllTracks()},_removeFeatures:function(b){var c=this.featureLayer,d=c.objectIdField;b&&a.forEach(b,function(a){a=a.attributes[d];c._unSelectFeatureIIf(a,this);this._decRefCount(a);this._removeFeatureIIf(a)},this)},_addFeatures:function(b){var c,d,e,f=this.featureLayer,g=f._endTimeField,l=f._startTimeField,m=[],h=[],k=[];if(c=f._trackManager,d=f.objectIdField,
c)for(e in b=c.addFeatures(b),b)b.hasOwnProperty(e)&&(m.push(e),b[e].adds&&(h=h.concat(b[e].adds)),b[e].deletes&&(k=k.concat(b[e].deletes)));else h=b;a.forEach(h,function(a){var b,c,e=a.attributes[d];b=g&&a.attributes[g];!b&&this._maxFeatureAge&&(b=l&&a.attributes[l]?a.attributes[l]+this._maxFeatureAge:Date.now()+this._maxFeatureAge);b&&(c=1E3*Math.ceil(b/1E3),this._featuresByTime[c]?this._featuresByTime[c].push(e):this._featuresByTime[c]=[e]);this._addFeatureIIf(e,a);this._incRefCount(e)},this);
k.length&&this._removeFeatures(k);c&&c.refreshTracks(m)},_updateFeatures:function(b){var c,d,e=this.featureLayer,f=[];c=e._trackManager;d=e._trackIdField;a.forEach(b,function(a){var b,g;b=a.updates;if(a=this._getFeature(a.oid)){b.geometry&&a.setGeometry(b.geometry);b=b.attributes||{};for(g in b)b.hasOwnProperty(g)&&(a.attributes[g]=b[g]);a.setAttributes(a.attributes);a.visible=this._checkFeatureTimeIntersects(a);c&&a.attributes[d]?f.push(a.attributes[d]):e._repaint(a,null,!0)}},this);f.length&&c.refreshTracks(f)},
_redrawAllTracks:function(){var a,b=this.featureLayer._trackManager;b&&(a=b.trimTracks(),a&&0<a.length&&(this._removeFeatures(a),b.refreshTracks()))},_flushDrawBuffer:function(){clearTimeout(this._timeoutId);var a,b=this._drawBuffer,d=b.adds.splice(0,b.adds.length),b=b.updates.splice(0,b.updates.length),e=this.featureLayer;return e?(e.updating||e._fireUpdateStart(),this._addFeatures(d),this._updateFeatures(b),a=this._getExpiredFeatures(),a&&a.length&&(this._removeFeatures(a),e._trackManager&&e._trackManager.removeFeatures(a)),
e._purge(),e._fireUpdateEnd(),void(this._timeoutId=null)):!1},_clearDrawBuffer:function(){var a=this._timeoutId,b=this._drawBuffer,d=b.adds,b=b.updates;a&&clearTimeout(a);d.splice(0,d.length);b.splice(0,b.length);this._timeoutId=null},_clearTimeBin:function(){this._featuresByTime={};this._lastEndTimeCheck=1E3*Math.ceil(Date.now()/1E3)},_clearFeatureMap:function(){this._featureMap={}},_setRefreshRate:function(a){a=a||0===a?a:200;0>a&&(a=200);this._refreshRate=a},_checkFeatureTimeIntersects:function(a){var b,
c=this.featureLayer,d=c.getMap();return(d=d?d.timeExtent:null)&&c.timeInfo&&(c.timeInfo.startTimeField||c.timeInfo.endTimeField)?(b=c._filterByTime([a],d.startTime,d.endTime),0<b.match.length):!0},_getRequestId:function(a){return("_"+a.name+a.layerId+a._ulid).replace(/[^a-zA-Z0-9\_]+/g,"_")},_fetchArchive:function(a){function b(a){A++;d.execute(f).then(function(b){a(null,b)},function(b){a(b)})}function c(a,d){if(a)return A>=z||!y._relatedUrl?void B._queryErrorHandler(Error("Could not get features from related feature service")):
(C={relatedFeatureWarning:"Querying related feature service using the current filter failed. All related features are displayed, and the filter is applied to the stream service only"},f.where="1\x3d1",void b(c));var e=B._fixFieldNameCasing(y,d);d.features=e;B._drawFeatures(d,C)}var d,f,h,k,w,x,y=this.featureLayer;if(y._fireUpdateStart(),!a||!this.map)return this._fireUpdateEnd({error:"Archive data cannot be fetched if no feature service url is provided or if the layer is not added to a map"}),!1;
d=new m(a);f=new l;a=this.map;h=y.getFilter()||{};k=h.where||"1\x3d1";w=h.geometry?g.fromJson(h.geometry):null;h=h.outFields?h.outFields.split(","):["*"];f.geometry=w;f.where=k;f.outFields=h;f.returnGeometry=!0;f.outSpatialReference=new e(a.spatialReference.toJson());y._usePatch&&(x=this._getRequestId(y),this._cancelPendingRequest(null,x));var A=0,z=2,B=this,C=null;b(c)},_queryErrorHandler:function(a){this._purgeRequests();var b=this.featureLayer;b._errorHandler(a);b._fireUpdateEnd(a)},_fixFieldNameCasing:function(a,
b){var c=b.features||[],d=b.fields;if(!d||!c.length)return c;for(var e,f=this._mapFieldNameDifferences(a.fields,d),g=[],l=0,m=b.features.length;m>l;l++)d=c[l],e=this._swizzleResponseAttributes(d.attributes,f),g.push({geometry:d.geometry,attributes:e});return g},_mapFieldNameDifferences:function(a,b){var c,d,e=[],f={};c=0;for(d=b.length;d>c;c++)e.push(b[c].name);c=0;for(d=a.length;d>c;c++){var g=a[c].name,l=this._checkForStreamFieldName(g,e);l&&(f[l]=g)}return f},_checkForStreamFieldName:function(a,
b){for(var c,d=a.toLowerCase(),e=0,f=b.length;f>e;e++)if(b[e].toLowerCase()===d){c=b[e];break}return c},_swizzleResponseAttributes:function(a,b){var c={},d;for(d in a)if(a.hasOwnProperty(d)){var e=a[d];b.hasOwnProperty(d)?c[b[d]]=e:c[d]=e}return c},_getExpiredFeatures:function(){var b,d,e,f=[],g=[];if(!this.featureLayer._endTimeField&&!this._maxFeatureAge)return g;if(b=1E3*Math.floor(this._lastEndTimeCheck/1E3),d=1E3*Math.ceil(Date.now()/1E3),this._lastEndTimeCheck=d,b&&b!==d)for(e=this._featuresByTime;d>=
b;b+=1E3)e[b]&&(f=f.concat(e[b]),delete e[b]);return a.forEach(f,function(a){(a=this._getFeature(a))&&g.push(a)},this),g}});return f("extend-esri")&&k.setObject("layers._StreamMode",h,b),h})},"esri/layers/TrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/dom-construct dojox/gfx ../kernel ../graphic ../geometry/Polyline ./GraphicsLayer".split(" "),function(h,k,a,f,b,e,l,m,g,d){var c=-1!==e.renderer.toLowerCase().indexOf("canvas");h=h(null,{declaredClass:"esri.layers._TrackManager",
constructor:function(a){this.layer=a;this.trackMap={};this.trackLineMap={}},initialize:function(a){this.map=a;var e=this.layer,f=e._getRenderer(),f=f&&f.trackRenderer;if("esriGeometryPoint"===e.geometryType){var g=this.container=new d._GraphicsLayer({id:e.id+"_tracks",_child:!0,visible:e.visible,minScale:e.minScale,maxScale:e.maxScale});if(g.loaded=!0,g.onLoad(g),g._setMap(a,e._div),!c){a=g._div.getNode();var l=e._div.getNode();a&&l&&b.place(a,l,"first")}g.setRenderer(f);e.on("visibility-change",
k.hitch(this,function(a){this.container.setVisibility(a.visible);this.container.evaluateSuspension()}));e.on("scale-range-change",k.hitch(this,function(){this.container.setScaleRange(this.layer.minScale,this.layer.maxScale)}))}},addFeatures:function(b){var c=this.trackMap,d=this.layer,e=d._trackIdField,f=[];a.forEach(b,function(b){var d=b.attributes[e];(c[d]=c[d]||[]).push(b);-1===a.indexOf(f,d)&&f.push(d)});var g=d._startTimeField,l=d.objectIdField,m=function(a,b){var c=a.attributes[g],d=b.attributes[g];
return c===d?a.attributes[l]<b.attributes[l]?-1:1:d>c?-1:1};a.forEach(f,function(a){c[a].sort(m)})},trimTracks:function(b){function c(a){for(a=e[a]||[];a.length>f;)g.push(a.shift())}var d,e=this.trackMap,f=this.layer.maximumTrackPoints||0,g=[];if(!f)return g;if(b)a.forEach(b,function(a){c(a)});else for(d in e)e.hasOwnProperty(d)&&c(d);return g},drawTracks:function(b){function c(a){var b,c,l,k,r=d[a];if(k=h.trackLineMap[a],n.remove(k),delete h.trackLineMap[a],k=null,!r||2>r.length)return!1;c=[];for(b=
r.length-1;0<=b;b--)(l=r[b].geometry)&&c.push([l.x,l.y]);b={};b[f]=a;1<c.length&&(k=new m(new g({paths:[c],spatialReference:e}),null,b),n.add(k),h.trackLineMap[a]=k)}var d,e,f,l,h=this,n=this.container;if(n)if(d=this.trackMap,e=this.map.spatialReference,f=this.layer._trackIdField,b)a.forEach(b,function(a){c(a)});else for(l in d)d.hasOwnProperty(l)&&c(l)},refreshTracks:function(b){function c(a){var b,c;if(e.drawTracks([a]),l&&l.latestObservationRenderer)for(a=f[a]||[],b=a.length,c=0;b>c;c++)g._repaint(a[c],
null,!0)}var d,e=this,f=this.trackMap,g=this.layer,l=g._getRenderer();if(b)a.forEach(b,function(a){c(a)});else for(d in f)f.hasOwnProperty(d)&&c(d);this.moveLatestToFront()},moveLatestToFront:function(b){a.forEach(this.getLatestObservations(b),function(a){var b=a._shape;b&&b._moveToFront();this._repaint(a,null,!0)},this.layer)},getLatestObservations:function(b){function c(a){a=g[a];return a[a.length-1]}var d,e=[],f=this.layer._getRenderer(),g=this.trackMap;if(!f.latestObservationRenderer)return e;
if(b)a.forEach(b,function(a){e.push(c(a))});else for(d in g)g.hasOwnProperty(d)&&e.push(c(d));return e},clearTracks:function(b){var c,d=this.getLatestObservations(b),e=this.container;b?a.forEach(b,function(a){delete this.trackMap[a];e&&(c=this.trackLineMap[a],e.remove(c),delete this.trackLineMap[a])},this):(this.trackMap={},this.trackLineMap={},e&&e.clear());a.forEach(d,function(a){this._repaint(a,null,!0)},this.layer)},isLatestObservation:function(a){var b=this.trackMap[a.attributes[this.layer._trackIdField]];
return b?b[b.length-1]===a:!1},destroy:function(){var a=this.container;a&&(a.clear(),a._unsetMap(this.map,this.layer._div));this.map=this.layer=this.trackMap=this.container=null}});return f("extend-esri")&&k.setObject("layers._TrackManager",h,l),h})},"esri/layers/HeatmapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/_base/array require ../kernel ../sniff ../geometry/Point ../geometry/webMercatorUtils ./MapImage ../renderers/HeatmapRenderer ../tasks/query dojo/_base/fx".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q){function t(){}function r(a){var b=a.layer;return{geometry:a.geometry,attributes:a.attributes,getLayer:function(){return b}}}h=h(null,{declaredClass:"esri.layers.HeatmapManager",heatmapRenderer:null,sourceLayer:null,imageLayer:null,useTiles:!0,useWorker:!1,map:null,constructor:function(a){this.sourceLayer=a;this._hndls=[]},initialize:function(a){this.map=a;var d=this.sourceLayer,e=d.renderer;d.setDrawMode(!1);this.imageLayer=a._getMapImageLyr();var f=this;e instanceof
c?this.heatmapRenderer=e:this.heatmapRenderer=(e.getRendererInfoByZoom(a.getZoom())||e.getRendererInfoByScale(a.getScale())).renderer;this._setupDraw=this._setupDraw.bind(this);this.recalculateHeatmap=this.recalculateHeatmap.bind(this);this._removeRenderer=this._removeRenderer.bind(this);this._handleRendererChange=this._handleRendererChange.bind(this);this._rendererChangeHandle=this.sourceLayer.on("renderer-change",this._handleRendererChange);this._handleOpacityChange=this._handleOpacityChange.bind(this);
this._reprojectFeature=this._reprojectFeature.bind(this);b(["../workers/heatmapCalculator"],function(a){f._calculator=new a(k.mixin({width:f.map.width,height:f.map.height},f._getOptions()));f._setupRenderer();f.heatmapRenderer.getStats=a.calculateStats;f.heatmapRenderer.getHistogramData=a.getHistogramData})},destroy:function(){this._removeHandlers();this._rendererChangeHandle&&this._rendererChangeHandle.remove();this._rendererChangeHandle=this.sourceLayer=this.imageLayer=this.map=this.heatmapRenderer=
this._hndls=null},_handleRendererChange:function(a){var b=a.renderer,d=b instanceof c;this.heatmapRenderer?d?this.heatmapRenderer=b:this._removeRenderer(a):d&&(this.heatmapRenderer=b,this.sourceLayer&&this.map&&this._setupRenderer())},_handleOpacityChange:function(a){a=a.opacity;var b=this._getImageBySourceId(this.sourceLayer.id);b&&b.setOpacity(a)},_setupRenderer:function(){var b=this._hndls,c=this.sourceLayer,d=this.map,e=this;c._originalDraw=c._draw;c._draw=t;c._div.clear();clearTimeout(this._resetTimer);
this._resetTimer=setTimeout(this._resetGraphics.bind(this),250);b.push(c.on("update-end",this._setupDraw));b.push(c.on("suspend",function(a){(a=e._getImageBySourceId(e.sourceLayer.id))&&a.hide()}));b.push(c.on("resume",function(a){(a=e._getImageBySourceId(e.sourceLayer.id))&&a.show()}));b.push(a.after(c,"redraw",this._setupDraw));b.push(d.on("layer-remove",function(a){a.layer==c&&((a=e._getImageBySourceId(e.sourceLayer.id))&&e.imageLayer.removeImage(a),e._removeRenderer({target:c}))}));c._collection&&
b.push(c.on("graphic-add",function(a){e._reprojectFeature(a.graphic);e._setupDraw()}));1!==c.mode&&(b.push(d.on("resize, pan-end",this._setupDraw)),b.push(d.on("zoom-end",this._setupDraw)));b.push(c.on("opacity-change",this._handleOpacityChange));this.imageLayer.suspended&&this.imageLayer.resume();c.graphics&&c.graphics.length&&(c.graphics[0].geometry&&!d.spatialReference.equals(c.graphics[0].geometry.spatialReference)&&f.forEach(c.graphics,function(a){this._reprojectFeature(a)}.bind(this)),this._setupDraw())},
_setupDraw:function(){if(!this._drawTimer){var a=this;this._drawTimer=setTimeout(function(){clearTimeout(a._drawTimer);a._drawTimer=null;a.sourceLayer._getRenderer().isInstanceOf(c)&&a.recalculateHeatmap()},16)}},_removeRenderer:function(a){var b=a.target;b._draw=b._originalDraw;delete b._originalDraw;b.setDrawMode(!0);this._removeHandlers();this._hndls=[];var c=this._getImageBySourceId(this.sourceLayer.id);c&&this.imageLayer.removeImage(c);clearTimeout(this._drawTimer);clearTimeout(this._resetTimer);
this._drawTimer=this._resetTimer=null;b.renderer!=a.renderer&&b.renderer.getRendererInfo?this.heatmapRenderer=null:(b.redraw(),this.destroy())},recalculateHeatmap:function(){this._calculator?this._doMainCalculation():this._calculatorClient&&this._doWorkerCalculation()},_reprojectFeature:function(a){if(a&&a.geometry){var b=a.geometry,c=this.map.spatialReference;c.equals(b.spatialReference)||(b=g.project(b,c),null==b||(a.geometry=b))}},_doWorkerCalculation:function(){},_doMainCalculation:function(){var a=
this.sourceLayer,b=this.map,c=this.heatmapRenderer,e=this.map.extent,f=this.map.width,g=this.map.height,l=this._calculator,m=this,h=function(h){h=m._getScreenPoints(h.features,b,a);h=l.calculateImageData(k.mixin({screenPoints:h,mapinfo:{extent:[e.xmin,e.ymin,e.xmax,e.ymax],resolution:b.getResolution()},width:f,height:g},m._getOptions()));h=c.getSymbol(r({geometry:b.extent,attributes:{size:[f,g],imageData:h},layer:a}));h=new d({extent:b.extent,href:h.url,opacity:0,sourceId:a.id});m._swapMapImages(h,
m._getImageBySourceId(a.id));a.suspended&&h.hide()},q={geometry:b.extent,timeExtent:a.useMapTime?b.timeExtent:void 0,spatialRelationship:n.SPATIAL_REL_INTERSECTS};null!=a._canDoClientSideQuery(q)?a.queryFeatures(q,h):h({features:a.graphics})},_getScreenPoints:function(a,b,c){var d,e,g,l=[],h=a.length,n=0,k=0,r=new m(b.extent.xmin,b.extent.ymax,b.spatialReference),q=b.toScreen(r),t=q.x,q=q.y,v=b.getResolution();for((d=b.extent.getCacheValue("_parts"))&&(g=f.map(d,function(a){return c._intersects(b,
a.extent)[0]}));h--;)d=a[h],d.geometry&&(e={x:Math.ceil((d.geometry.x-r.x)/v+t),y:Math.floor((r.y-d.geometry.y)/v-q),attributes:d.attributes},g&&(k=1<g.length&&e.x<-g[0]?g[1]:g[0],e.x+=k),l[n++]=e);return l},_getImageBySourceId:function(a){var b=this.imageLayer.getImages();return b=f.filter(b,function(b){return b.sourceId==a}),b.length?b[b.length-1]:void 0},_swapMapImages:function(a,b){function c(){d.removeImage(b)}var d=this.imageLayer,e=this.sourceLayer.opacity;d.addImage(a);q.anim(a._node,{opacity:e},
null,null,function(){a.opacity=e});null!=b&&q.anim(b._node,{opacity:0},null,null,c)},_removeHandlers:function(){if(null!=this._hndls)for(var a=this._hndls.length;a--;)this._hndls[a].remove()},_getOptions:function(){var a=this.heatmapRenderer;return{blurRadius:a.blurRadius,gradient:a.gradient,maxPixelIntensity:a.maxPixelIntensity,minPixelIntensity:a.minPixelIntensity,field:a.field,fieldOffset:a.fieldOffset}},_resetGraphics:function(){clearTimeout(this._resetTimer);this._resetTimer=null;for(var a,b=
this.sourceLayer.graphics,c=b.length;c--;)a=b[c],a._shape=a._offsets=void 0}});return l("extend-esri")&&k.setObject("layers.HeatmapManager",h,e),h})},"esri/layers/MapImage":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has ../kernel ../domUtils ../geometry/Extent".split(" "),function(h,k,a,f,b,e,l){h=h(null,{declaredClass:"esri.layers.MapImage",constructor:function(a){k.mixin(this,a);this.extent=new l(this.extent)},visible:!0,opacity:1,getLayer:function(){return this._layer},
getNode:function(){return this._node},show:function(){if(!this.visible){this.visible=!0;var a,b=this._node,d=this._layer;b&&(a=d&&d._div,a&&(d.suspended||d._setPos(b,a._left,a._top),(d._active||a).appendChild(b)),e.show(b))}},hide:function(){if(this.visible){this.visible=!1;var a=this._node;a&&(e.hide(a),a.parentNode&&a.parentNode.removeChild(a))}},setOpacity:function(b){var e=this._node;this.opacity=b;e&&a.set(e,"opacity",b)}});return f("extend-esri")&&k.setObject("layers.MapImage",h,b),h})},"esri/layers/ArcGISDynamicMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/sniff dojo/io-query ../kernel ../config ../request ../urlUtils ../layerUtils ../geometry/scaleUtils ./DynamicMapServiceLayer ./ArcGISMapServiceLayer ./TimeInfo ./LayerTimeOptions ./ImageParameters ./DynamicLayerInfo ./LayerMapSource".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x){h=h([q,t],{declaredClass:"esri.layers.ArcGISDynamicMapServiceLayer",_eventMap:{"visible-layers-change":["visibleLayers"]},constructor:function(a,b,c){a=b&&b.imageParameters;var d=k.hitch;if(a){var e=a.layerDefinitions;e&&this.setLayerDefinitions(e);a.layerOption===u.LAYER_OPTION_SHOW&&(this.visibleLayers=[].concat(a.layerIds),this.onVisibleLayersChange(this.visibleLayers))}this._setIsPNG32=d(this,this._setIsPNG32);this.dpi=a&&a.dpi||96;this.imageFormat=
a&&a.format||"png8";this.imageTransparency=a&&!1===a.transparent?!1:!0;this._setIsPNG32();this.gdbVersion=b&&b.gdbVersion;this._params.gdbVersion=this.gdbVersion;e=a&&a.layerDefinitions;k.mixin(this._params,this._url.query,{dpi:this.dpi,transparent:this.imageTransparency,format:this.imageFormat},a?a.toJson():{});e&&(this._params.layerDefs=e);this.getImageUrl=d(this,this.getImageUrl);this._initLayer=d(this,this._initLayer);this._load=d(this,this._load);this.useMapImage=b?b.useMapImage:!1;this._loadCallback=
b&&b.loadCallback;(b=b&&b.resourceInfo)?this._initLayer(b):(void 0===c||!1===c)&&this._load();this.registerConnectEvents()},disableClientCaching:!1,layerDefinitions:null,_initLayer:function(a,b){this.inherited(arguments);a.timeInfo&&(this.timeInfo=new r(a.timeInfo));this.loaded=!0;this.onLoad(this);var c=this._loadCallback;c&&(delete this._loadCallback,c(this))},getImageUrl:function(a,b,l,h){var n=this._url.path+"/export?",r=this._params,q=r.token=this._getToken(),t=a.spatialReference.wkid||f.toJson(a.spatialReference.toJson()),
v=this._errorHandler;if(delete r._ts,k.mixin(r,{bbox:a.xmin+","+a.ymin+","+a.xmax+","+a.ymax,bboxSR:t,imageSR:t,size:b+","+l},this.disableClientCaching?{_ts:(new Date).getTime()}:{}),r.layerDefs)a=c._serializeLayerDefinitions(r.layerDefs,10.5<=this.version),r=k.mixin({},r),delete r.layerDefs,r.layerDefs=a;a=d.addProxy(n+e.objectToQuery(k.mixin({},r,{f:"image"})));a.length>m.defaults.io.postLength||this.useMapImage?this._jsonRequest=g({url:n,content:k.mixin(r,{f:"json"}),callbackParamName:"callback",
load:function(a){a=a.href;q&&(a+=-1===a.indexOf("?")?"?token\x3d"+q:"\x26token\x3d"+q);h(d.addProxy(a))},error:v}):h(a)},_setIsPNG32:function(){var a=this.imageFormat.toLowerCase(),c=b("ie");this.isPNG32=c&&6===c&&("png32"===a||"png24"===a)&&this.imageTransparency},_setTime:function(b){var d=this.timeInfo;b=this._params.time=b?b.toJson().join(","):null;if(10.02>this.version&&d)if(b)this._params.layerTimeOptions=c._serializeTimeOptions(this.layerTimeOptions);else{var e=this.layerInfos;if(e){var f=
this.layerTimeOptions,g=f?f.slice(0):[],l=[];a.forEach(e,function(a){a.subLayerIds||l.push(a.id)});l.length&&(a.forEach(l,function(a){if(!g[a]){var b=new v;b.useTime=!1;g[a]=b}}),this._params.layerTimeOptions=c._serializeTimeOptions(g,l))}}10.02<=this.version&&d&&(b||d.hasLiveData||(this._params.time="null,null"))},setDPI:function(a,b){this.dpi=this._params.dpi=a;b||this.refresh(!0)},setImageFormat:function(a,b){this.imageFormat=this._params.format=a;this._setIsPNG32();b||this.refresh(!0)},setImageTransparency:function(a,
b){this.imageTransparency=this._params.transparent=a;this._setIsPNG32();b||this.refresh(!0)},setVisibleLayers:function(a,b){this.visibleLayers=a;this._params.layers=u.LAYER_OPTION_SHOW+":"+(a.length?a.join():"-1");this._updateDynamicLayers();b||this.refresh(!0);this.onVisibleLayersChange(this.visibleLayers)},onVisibleLayersChange:function(){},setDefaultVisibleLayers:function(a){this.visibleLayers=this._defaultVisibleLayers;this._params.layers=null;this._updateDynamicLayers();a||this.refresh(!0);this.onVisibleLayersChange(this.visibleLayers)},
setLayerDefinitions:function(a,b){this.layerDefinitions=a;this._params.layerDefs=a;this._updateDynamicLayers();b||this.refresh(!0)},setDefaultLayerDefinitions:function(a){this.layerDefinitions=this._params.layerDefs=null;this._updateDynamicLayers();a||this.refresh(!0)},setDisableClientCaching:function(a){this.disableClientCaching=a},setLayerTimeOptions:function(a,b){this.layerTimeOptions=a;this._params.layerTimeOptions=c._serializeTimeOptions(a);this._updateDynamicLayers();b||this.refresh(!0)},refresh:function(a){if(a)this.inherited(arguments);
else{var b=this.disableClientCaching;this.disableClientCaching=!0;this.inherited(arguments);this.disableClientCaching=b}},setLayerDrawingOptions:function(a,b){this.layerDrawingOptions=a;this._updateDynamicLayers();b||this.refresh(!0)},setDynamicLayerInfos:function(a,b){a&&0<a.length?(this.dynamicLayerInfos=a,this.visibleLayers=c._getDefaultVisibleLayers(a),this.onVisibleLayersChange(this.visibleLayers)):this.dynamicLayerInfos=this.layerDrawingOptions=null;this._updateDynamicLayers();b||this.refresh(!0)},
createDynamicLayerInfosFromLayerInfos:function(){var b,c=[];return a.forEach(this.layerInfos,function(a){b=new w(a.toJson());b.source=new x({mapLayerId:a.id});c.push(b)}),c},_onDynamicLayersChange:function(){},_updateDynamicLayers:function(){if(this.dynamicLayerInfos&&0<this.dynamicLayerInfos.length||this.layerDrawingOptions&&0<this.layerDrawingOptions.length){this.dynamicLayerInfos&&0!==this.dynamicLayerInfos.length||(this.dynamicLayerInfos=this.createDynamicLayerInfosFromLayerInfos());var b;b=this.dynamicLayerInfos;
var d=[],e=this._map&&n.getScale(this._map),g=this.visibleLayers,l=e?c._getLayersForScale(e,b):g;a.forEach(b,function(b){if(!b.subLayerIds){var c,e=b.id;if(-1!==a.indexOf(g,e)&&-1!==a.indexOf(l,e)){c={id:e,name:b.name};c.source=b.source&&b.source.toJson();var f;this.layerDefinitions&&this.layerDefinitions[e]&&(f=this.layerDefinitions[e]);f&&(c.definitionExpression=f);var m;this.layerDrawingOptions&&this.layerDrawingOptions[e]&&(m=this.layerDrawingOptions[e]);m&&(c.drawingInfo=m.toJson());var h;this.layerTimeOptions&&
this.layerTimeOptions[e]&&(h=this.layerTimeOptions[e]);h&&(c.layerTimeOptions=h.toJson());c.minScale=b.minScale||0;c.maxScale=b.maxScale||0;d.push(c)}}},this);b=f.toJson(d);this._params.dynamicLayers&&this._params.dynamicLayers.length===b.length&&this._params.dynamicLayers===b||(this._params.dynamicLayers=b,this._onDynamicLayersChange(this._params.dynamicLayers))}else this._params.dynamicLayers?(this._params.dynamicLayers=null,this._onDynamicLayersChange(null)):this._params.dynamicLayers=null},_onExtentChangeHandler:function(a,
b,c){c&&this._updateDynamicLayers();this.inherited(arguments)},_setMap:function(a,b,c){return this._map=a,this._updateDynamicLayers(),this.inherited(arguments)},onGDBVersionChange:function(){},setGDBVersion:function(a,b){this.gdbVersion=a;this._params.gdbVersion=a;this.onGDBVersionChange();b||this.refresh(!0)},exportMapImage:function(a,b){var d=k.hitch(this,function(){var d=m.defaults.map,e=a&&a.layerDefinitions;if(a=a?a.toJson(this.normalization):{},e&&(a.layerDefs=e),a=k.mixin({size:d.width+","+
d.height},this._params,a,{f:"json"}),delete a._ts,a.layerDefs)d=c._serializeLayerDefinitions(a.layerDefs,10.5<=this.version),delete a.layerDefs,a.layerDefs=d;this._exportMapImage(this._url.path+"/export",a,b)});this.loaded?d():this.on("load",d)}});return b("extend-esri")&&k.setObject("layers.ArcGISDynamicMapServiceLayer",h,l),h})},"esri/layers/DynamicMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/dom-construct dojo/dom-style dojox/gfx/matrix ../kernel ../config ../sniff ../request ../domUtils ./layer ./MapImage".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q){var t=m.defaults.map.zoomDuration;h=h(n,{declaredClass:"esri.layers.DynamicMapServiceLayer",_eventMap:{"map-image-export":["mapImage"]},constructor:function(b,c){this.useMapTime=c&&c.hasOwnProperty("useMapTime")?!!c.useMapTime:!0;this.extentProcessor=c&&c.extentProcessor;var d=a.hitch;this._exportMapImageHandler=d(this,this._exportMapImageHandler);this._imgSrcFunc=d(this,this._imgSrcFunc);this._divAlphaImageFunc=d(this,this._divAlphaImageFunc);this._tileLoadHandler=
d(this,this._tileLoadHandler);this._tileErrorHandler=d(this,this._tileErrorHandler);this.registerConnectEvents()},opacity:1,isPNG32:!1,_setMap:function(a,c,d){this.inherited(arguments);this._map=a;var e=this._div=f.create("div",null,c),m=l._css.names,h={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible",opacity:this.opacity},n=g("ie"),r=k.connect,q=a.__visibleDelta;if(8===n&&delete h.opacity,"css-transforms"===a.navigationMode?(this._isChildLayer||(h[m.transform]=l._css.translate(q.x,
q.y),b.set(e,h)),this._left=q.x,this._top=q.y):(h.left="0px",h.top="0px",b.set(e,h),this._left=this._top=0),b.set(e,h),this._onResizeHandler_connect=r(a,"onResize",this,"_onResizeHandler"),this._opacityChangeHandler_connect=r(this,"onOpacityChange",this,"_opacityChangeHandler"),this._img_loading=null,this._dragOrigin={x:0,y:0},this.evaluateSuspension(),this.suspended&&!a.loaded)var t=k.connect(a,"onLoad",this,function(){k.disconnect(t);t=null;this.evaluateSuspension()});return this.extentProcessor&&
(this._panEndEvalHandle=k.connect(a,"onPanEnd",this,this.evaluateSuspension),this._zoomEndEvalHandle=k.connect(a,"onZoomEnd",this,this.evaluateSuspension)),e},_unsetMap:function(a,b){this._img&&this._clearEventListeners(this._img);this._img_loading&&this._clearEventListeners(this._img_loading);f.destroy(this._div);this._map=this._div=this._img=this._img_loading=null;var c=k.disconnect;c(this._onResizeHandler_connect);c(this._opacityChangeHandler_connect);c(this._panEndEvalHandle);c(this._zoomEndEvalHandle);
this._panEndEvalHandle=this._zoomEndEvalHandle=this._onResizeHandler_connect=this._opacityChangeHandler_connect=null;this._fireUpdateEnd();this._toggleTime();clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();this.inherited(arguments)},_onResizeHandler:function(a,c,d){b.set(this._div,{width:c+"px",height:d+"px"});this._onExtentChangeHandler(a)},onSuspend:function(){this.inherited(arguments);this._fireUpdateEnd();this._toggleTime();c.hide(this._div);clearTimeout(this._wakeTimer);
this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(){this.inherited(arguments);var c=this._map;if(this._toggleTime(),"css-transforms"===c.navigationMode)c=c.__visibleDelta,this._left=c.x,this._top=c.y,this._isChildLayer||b.set(this._div,l._css.names.transform,l._css.translate(this._left,this._top));this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(a.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0)}),0)},canResume:function(){var a=
this.inherited(arguments);if(a){var b=this._map.extent;this.extentProcessor&&b&&(a=!!this.extentProcessor({layer:this,extent:b,width:this._map.width}).extent)}return a},_enableDrawConnectors:function(){var a=k.connect,b=this._map;b&&(this._onPanHandler_connect=a(b,"onPan",this,"_onPanHandler"),this._onExtentChangeHandler_connect=a(b,"onExtentChange",this,"_onExtentChangeHandler"),"css-transforms"===b.navigationMode?this._onScaleHandler_connect=a(b,"onScale",this,this._onScaleHandler):this._onZoomHandler_connect=
a(b,"onZoom",this,"_onZoomHandler"))},_disableDrawConnectors:function(){var a=k.disconnect;a(this._onPanHandler_connect);a(this._onExtentChangeHandler_connect);a(this._onZoomHandler_connect);a(this._onScaleHandler_connect);this._onPanHandler_connect=this._onExtentChangeHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=null},_toggleTime:function(){var a=this._map;this.timeInfo&&this.useMapTime&&a&&!this.suspended?(this._timeConnect||(this._timeConnect=k.connect(a,"onTimeExtentChange",
this,this._onTimeExtentChangeHandler)),this._setTime(a.timeExtent)):(k.disconnect(this._timeConnect),this._timeConnect=null,this._setTime(null))},_setTime:function(a){this._params&&(this._params.time=a?a.toJson().join(","):null)},_onPanHandler:function(a,c){this._panDx=c.x;this._panDy=c.y;var d=this._dragOrigin,e=this._map.__visibleDelta,f=this._img;f&&("css-transforms"===this._map.navigationMode?(this._left=e.x+c.x,this._top=e.y+c.y,this._isChildLayer||b.set(this._div,l._css.names.transform,l._css.translate(this._left,
this._top))):b.set(f,{left:d.x+c.x+"px",top:d.y+c.y+"px"}))},_onExtentChangeHandler:function(a,c,d){if(!this.suspended){clearTimeout(this._wakeTimer);this._wakeTimer=null;var m=this._map,h=this._img,n=h&&h.style,q=this._dragOrigin;!c||d||!h||c.x===this._panDx&&c.y===this._panDy||("css-transforms"===m.navigationMode?(c=m.__visibleDelta,this._left=c.x,this._top=c.y,this._isChildLayer||b.set(this._div,l._css.names.transform,l._css.translate(this._left,this._top))):b.set(h,{left:q.x+c.x+"px",top:q.y+
c.y+"px"}));h?(q.x=parseInt(n.left,10),q.y=parseInt(n.top,10)):q.x=q.y=0;"css-transforms"===m.navigationMode&&d&&h&&(b.set(h,l._css.names.transition,"none"),h._multiply=h._multiply?e.multiply(h._matrix,h._multiply):h._matrix);this._fireUpdateStart();if(d=this._img_loading)if(this._clearEventListeners(d),f.destroy(d),this._img_loading=null,d=this._jsonRequest){try{d.cancel()}catch(G){}this._jsonRequest=null}var r=m.width;d=m.height;c=r;var v=0;if(10<=this.version&&m.wrapAround180&&(a=a._normalize(!0)),
this.extentProcessor)v=this.extentProcessor({layer:this,extent:a,width:c}),a=v.extent,c=v.width,v=v.marginLeft||0;if(this.isPNG32)h=this._img_loading=f.create("div"),h.id=m.id+"_"+this.id+"_"+(new Date).getTime(),b.set(h,{position:"absolute",left:"0px",top:"0px",width:c+"px",height:d+"px"}),m=h.appendChild(f.create("div")),b.set(m,{opacity:0,width:c+"px",height:d+"px"}),this.getImageUrl(a,c,d,this._divAlphaImageFunc),h=null;else{var u=this._img_loading=f.create("img"),D=l._css.names,E=g("ie"),F={position:"absolute",
width:c+"px",height:d+"px"};8===E&&(F.opacity=this.opacity);null!=v&&0!==v&&(F.marginLeft=v+"px");"css-transforms"===m.navigationMode?(F[D.transform]=l._css.translate(-this._left,-this._top),u._tdx=-this._left,u._tdy=-this._top,F[D.transition]=D.transformName+" "+t+"ms ease",this.extentProcessor&&(F[D.origin]=r/2-v+"px "+d/2+"px")):(F.left="0px",F.top="0px");u.id=m.id+"_"+this.id+"_"+(new Date).getTime();b.set(u,F);u._onload_connect=k.connect(u,"onload",this,"_onLoadHandler");u._onerror_connect=k.connect(u,
"onerror",this,"_onErrorHandler");u._onabort_connect=k.connect(u,"onabort",this,"_onErrorHandler");this._startRect={left:q.x,top:q.y,width:h?parseInt(n.width,10):c,height:h?parseInt(n.height,10):d,marginLeft:h?parseInt(n.marginLeft||"0",10):v,zoom:n&&n.zoom?parseFloat(n.zoom):1};this.getImageUrl(a,c,d,this._imgSrcFunc);u=null}}},_onTimeExtentChangeHandler:function(a){this.suspended||(this._setTime(a),this.refresh(!0))},getImageUrl:function(a,b,c,d){},_imgSrcFunc:function(a){this._img_loading.src=
a},_divAlphaImageFunc:function(a){b.set(this._img_loading,"filter","progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+a+"', sizingMethod\x3d'scale')");this._onLoadHandler({currentTarget:this._img_loading})},_onLoadHandler:function(a){a=a.currentTarget;var b=this._map;if(this._clearEventListeners(a),!b||b.__panning||b.__zooming)return f.destroy(a),void this._fireUpdateEnd();this._img&&this._div.removeChild(this._img);this._img=a;b=a.style;this._startRect={left:0,top:0,width:parseInt(b.width,
10),height:parseInt(b.height,10),marginLeft:parseInt(b.marginLeft||"0",10),zoom:1};this._div.appendChild(a);this.suspended||c.show(this._div);this._img_loading=null;a=this._dragOrigin;a.x=a.y=0;this.onUpdate();this._fireUpdateEnd()},_onErrorHandler:function(a){a=a.currentTarget;b.set(a,"visibility","hidden");this._clearEventListeners(a);a=Error("Unable to load image: "+a.src);this.onError(a);this._fireUpdateEnd(a)},_clearEventListeners:function(a){k.disconnect(a._onload_connect);k.disconnect(a._onerror_connect);
k.disconnect(a._onabort_connect);a._onload_connect=a._onerror_connect=a._onabort_connect=null},setUseMapTime:function(a,b){this.useMapTime=a;this._toggleTime();b||this.refresh(!0)},refresh:function(){this._map&&this._onExtentChangeHandler(this._map.extent)},_onScaleHandler:function(a,c){var d={},f=l._css.names,g=this._img;g&&(b.set(g,f.transition,c?"none":f.transformName+" "+t+"ms ease"),g._matrix=a,a=g._multiply?e.multiply(a,g._multiply):a,(g._tdx||g._tdy)&&(a=e.multiply(a,{xx:1,xy:0,yx:0,yy:1,dx:g._tdx,
dy:g._tdy})),d[f.transform]=l._css.matrix(a),b.set(g,d))},_onZoomHandler:function(a,c,d){a=this._startRect;var e=a.width*c,f=a.height*c,l=a.marginLeft*c,m=this._img,h=g("ie");m&&(h&&8>h?b.set(m,{left:a.left-(e-a.width)*(d.x-a.left)/a.width+"px",top:a.top-(f-a.height)*(d.y-a.top)/a.height+"px",zoom:c*a.zoom}):b.set(m,{left:a.left-(e-a.width)*(d.x-a.left)/a.width+"px",top:a.top-(f-a.height)*(d.y-a.top)/a.height+"px",width:e+"px",height:f+"px"}),null!=l&&0!==l&&b.set(m,{marginLeft:l+"px"}))},_exportMapImage:function(a,
b,c){var e=this._exportMapImageHandler;b.token=this._getToken();d({url:a,content:b,callbackParamName:"callback",load:function(a,b){e(a,b,c)},error:m.defaults.io.errorHandler})},_exportMapImageHandler:function(a,b,c){a=new q(a);this.onMapImageExport(a);c&&c(a)},onMapImageExport:function(){},setOpacity:function(a){this.opacity!=a&&this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_opacityChangeHandler:function(a){var c=8===g("ie")?this._img:this._div;b.set(c,"opacity",a)}});return g("extend-esri")&&
a.setObject("layers.DynamicMapServiceLayer",h,l),h})},"esri/layers/DynamicLayerInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./LayerInfo ./LayerMapSource ./LayerDataSource".split(" "),function(h,k,a,f,b,e,l,m){h=h(e,{declaredClass:"esri.layers.DynamicLayerInfo",defaultVisibility:!0,parentLayerId:-1,maxScale:0,minScale:0,constructor:function(a){if(a){var b;a.source?b="mapLayer"===a.source.type?new l(a.source):new m(a.source):(b=new l,b.mapLayerId=this.id);this.source=
b}},toJson:function(){var a=this.inherited(arguments);return a.source=this.source&&this.source.toJson(),b.fixJson(a)}});return a("extend-esri")&&k.setObject("layers.DynamicLayerInfo",h,f),h})},"esri/layers/LayerMapSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./LayerSource".split(" "),function(h,k,a,f,b,e){h=h(e,{declaredClass:"esri.layers.LayerMapSource",type:"mapLayer",toJson:function(){return b.fixJson({type:"mapLayer",mapLayerId:this.mapLayerId,gdbVersion:this.gdbVersion})}});
return a("extend-esri")&&k.setObject("layers.LayerMapSource",h,f),h})},"esri/layers/LayerSource":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.layers.LayerSource",type:null,constructor:function(a){a&&k.mixin(this,a)},toJson:function(){}});return a("extend-esri")&&k.setObject("layers.LayerSource",h,f),h})},"esri/layers/LayerDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./LayerSource ./TableDataSource ./QueryDataSource ./JoinDataSource ./RasterDataSource".split(" "),
function(h,k,a,f,b,e,l,m,g,d){h=h(e,{declaredClass:"esri.layers.LayerDataSource",type:"dataLayer",constructor:function(a){if(a&&a.dataSource){switch(a.dataSource.type){case "table":a=new l(a.dataSource);break;case "queryTable":a=new m(a.dataSource);break;case "joinTable":a=new g(a.dataSource);break;case "raster":a=new d(a.dataSource);break;default:a=a.dataSource}this.dataSource=a}},toJson:function(){var a={type:"dataLayer",dataSource:this.dataSource&&this.dataSource.toJson()};return b.fixJson(a)}});
return a("extend-esri")&&k.setObject("layers.LayerDataSource",h,f),h})},"esri/layers/TableDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./DataSource".split(" "),function(h,k,a,f,b,e){h=h(e,{declaredClass:"esri.layers.TableDataSource",toJson:function(){return b.fixJson({type:"table",workspaceId:this.workspaceId,dataSourceName:this.dataSourceName,gdbVersion:this.gdbVersion})}});return a("extend-esri")&&k.setObject("layers.TableDataSource",h,f),h})},"esri/layers/DataSource":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.layers.DataSource",constructor:function(a){a&&k.mixin(this,a)},toJson:function(){}});return a("extend-esri")&&k.setObject("layers.DataSource",h,f),h})},"esri/layers/QueryDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./DataSource ../SpatialReference".split(" "),function(h,k,a,f,b,e,l){h=h(e,{declaredClass:"esri.layers.QueryDataSource",constructor:function(a){a&&(a.oidFields&&
k.isString(a.oidFields)&&(this.oidFields=a.oidFields.split(",")),a.spatialReference&&(this.spatialReference=new l(a.spatialReference)))},toJson:function(){var a={type:"queryTable",workspaceId:this.workspaceId,query:this.query,oidFields:this.oidFields&&this.oidFields.join(),spatialReference:this.spatialReference&&this.spatialReference.toJson()};if(this.geometryType){var e;e="point"===this.geometryType.toLowerCase()?"esriGeometryPoint":"multipoint"===this.geometryType.toLowerCase()?"esriGeometryMultipoint":
"polyline"===this.geometryType.toLowerCase()?"esriGeometryPolyline":"polygon"===this.geometryType.toLowerCase()?"esriGeometryPolygon":this.geometryType;a.geometryType=e}return b.fixJson(a)}});return a("extend-esri")&&k.setObject("layers.QueryDataSource",h,f),h})},"esri/layers/JoinDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./DataSource ./LayerMapSource ./TableDataSource ./QueryDataSource ./RasterDataSource".split(" "),function(h,k,a,f,b,e,l,m,g,d){var c=
h(e,{declaredClass:"esri.layers.JoinDataSource",constructor:function(a){a&&(a.leftTableSource&&(this.leftTableSource=this._createLayerSource(a.leftTableSource)),a.rightTableSource&&(this.rightTableSource=this._createLayerSource(a.rightTableSource)))},_createLayerSource:function(a){var e;if("mapLayer"===a.type)e=new l(a);else{e={type:"dataLayer"};var f;switch(a.dataSource.type){case "table":f=new m(a.dataSource);break;case "queryTable":f=new g(a.dataSource);break;case "joinTable":f=new c(a.dataSource);
break;case "raster":f=new d(a.dataSource);break;default:f=a.dataSource}e.dataSource=f;e.toJson=function(){var a={type:"dataLayer",dataSource:f.toJson()};return b.fixJson(a)}}return e},toJson:function(){var a,c={type:"joinTable",leftTableSource:this.leftTableSource&&this.leftTableSource.toJson(),rightTableSource:this.rightTableSource&&this.rightTableSource.toJson(),leftTableKey:this.leftTableKey,rightTableKey:this.rightTableKey};return a="left-outer-join"===this.joinType.toLowerCase()?"esriLeftOuterJoin":
"left-inner-join"===this.joinType.toLowerCase()?"esriLeftInnerJoin":this.joinType,c.joinType=a,b.fixJson(c)}});return a("extend-esri")&&k.setObject("layers.JoinDataSource",c,f),c})},"esri/layers/RasterDataSource":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./DataSource".split(" "),function(h,k,a,f,b,e){h=h(e,{declaredClass:"esri.layers.RasterDataSource",toJson:function(){return b.fixJson({type:"raster",workspaceId:this.workspaceId,dataSourceName:this.dataSourceName})}});
return a("extend-esri")&&k.setObject("layers.RasterDataSource",h,f),h})},"cmv/viewer/js/gis/dijit/LayerControl":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/topic dojo/dom-attr dojo/dom-construct dijit/_WidgetBase dijit/_Container dijit/layout/ContentPane dijit/form/Button esri/tasks/ProjectParameters esri/config require xstyle/css!./LayerControl/css/LayerControl.css".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q){return h([l,m],{map:null,layerInfos:[],icons:{expand:"fa-caret-right fa-fw layerControlIcon-Expand",
collapse:"fa-caret-down fa-fw layerControlIcon-Collapse",checked:"fa-check fa-fw fa-border layerControlIcon-Checked",unchecked:"fa-square fa-fw fa-border layerControlIcon-Unchecked",indeterminate:"fa-minus fa-fw fa-border layerControlIcon-Indeterminate",update:"fa-refresh layerControlIcon-Update",menu:"fa-bars layerControlIcon-Menu",folder:"fa-folder-o fa-fw layerControlIcon-Folder",folderOpen:"fa-folder-open-o fa-fw layerControlIcon-Folder layerControlIcon-FolderOpen"},separated:!1,overlayReorder:!1,
overlayLabel:!1,vectorReorder:!1,vectorLabel:!1,noMenu:null,noLegend:null,noZoom:null,noTransparency:null,menu:{},subLayerMenu:{},swipe:null,swiperButtonStyle:"position:absolute;top:20px;left:120px;z-index:50;",baseClass:"layerControlDijit",_vectorContainer:null,_overlayContainer:null,_swiper:null,_swipeLayerToggleHandle:null,_groupedLayerInfos:{},_controls:{dynamic:"./LayerControl/controls/Dynamic",feature:"./LayerControl/controls/Feature",image:"./LayerControl/controls/Image",tiled:"./LayerControl/controls/Tiled",
csv:"./LayerControl/controls/CSV",georss:"./LayerControl/controls/GeoRSS",wms:"./LayerControl/controls/WMS",wfs:"./LayerControl/controls/WFS",kml:"./LayerControl/controls/KML",vectortile:"./LayerControl/controls/VectorTile",webtiled:"./LayerControl/controls/WebTiled",imagevector:"./LayerControl/controls/ImageVector",raster:"./LayerControl/controls/Raster",stream:"./LayerControl/controls/Stream",grouped:"./LayerControl/controls/Grouped",graphics:"./LayerControl/controls/Graphics",osm:"./LayerControl/controls/OpenStreetMap"},
constructor:function(b){b=b||{};b.map?this._controls=a.mixin(this._controls,b.controls||{}):f.publish("viewer/handleError",{source:"LayerControl",error:"map option is required"})},postCreate:function(){this.inherited(arguments);if(this.separated){var a=h([l,m]);!1!==this.vectorLabel&&this.addChild(new g({className:"vectorLabelContainer",content:this.vectorLabel},e.create("div")),"first");this._vectorContainer=new a({className:"vectorLayerContainer"},e.create("div"));this.addChild(this._vectorContainer,
"last");!1!==this.overlayLabel&&this.addChild(new g({className:"overlayLabelContainer",content:this.overlayLabel},e.create("div")),"last");this._overlayContainer=new a({className:"overlayLayerContainer"},e.create("div"));this.addChild(this._overlayContainer,"last")}else this.vectorReorder=this.overlayReorder=!1;this._addLayerControls(this.layerInfos);this._subscribeToTopics()},_subscribeToTopics:function(){this._removeLayerControlsHandler=f.subscribe("layerControl/removeLayerControls",a.hitch(this,
function(a){this._removeLayerControls(a)}));this._addLayerControlsHandler=f.subscribe("layerControl/addLayerControls",a.hitch(this,function(a){this._addLayerControls(a)}))},_addLayerControls:function(b){var c=[];k.forEach(b,function(a){a.controlOptions=a.controlOptions||{};var b=a.controlOptions;!0!==b.exclude&&(b.layerGroup&&(this.vectorReorder=this.overlayReorder=!1),(b=this._controls[a.type])?c.push(b):f.publish("viewer/handleError",{source:"LayerControl",error:'the layer type "'+a.type+'" is not supported'}))},
this);q(c,a.hitch(this,function(){k.forEach(b,function(b){if(!0!==b.controlOptions.exclude){var c=this._controls[b.type];c&&q([c],a.hitch(this,"_addControl",b))}},this);for(var c in this._groupedLayerInfos)if(this._groupedLayerInfos.hasOwnProperty(c)){var d=this._groupedLayerInfos[c];if(d&&1<d.length){var e=this._controls.grouped,d={title:c,type:"grouped",controlOptions:{},layer:{id:c.replace(/\s/g,""),loaded:!0,getMap:a.hitch(this,function(){return this.map}),minScale:0,maxScale:0,_params:{}},layerDetails:d};
q([e],a.hitch(this,"_addControl",d))}}this._checkReorder()}))},_removeLayerControls:function(b){function c(a){return b.reduce(function(b,c){return c===a.layer||b},!1)}var d=this._overlayContainer.getChildren().filter(function(a){return c(a)}).concat(this._vectorContainer.getChildren().filter(function(a){return c(a)})).concat(this.getChildren().filter(function(a){return c(a)}));k.forEach(d,a.hitch(this,function(a){this.separated?"overlay"===a._layerType?this._overlayContainer.removeChild(a):this._vectorContainer.removeChild(a):
this.removeChild(a);a.destroy()}))},_addControl:function(b,c){var d="string"===typeof b.layer?this.map.getLayer(b.layer):b.layer;if("dynamic"===b.type||"feature"===b.type)if(d.loaded)this._applyLayerControlOptions(b.controlOptions,d);else d.on("load",a.hitch(this,"_applyLayerControlOptions",b.controlOptions));d=new c({controller:this,layer:d,layerTitle:b.title,layerDetails:b.layerDetails,controlOptions:a.mixin({noLegend:null,noZoom:null,noTransparency:null,swipe:null,expanded:!1,sublayers:!0,layerGroup:null,
menu:this.menu[b.type],subLayerMenu:this.subLayerMenu[b.type]},b.controlOptions)});d.startup();var e=b.position||0,f=d._layerType;"grouped"===f&&d.layerDetails&&0<d.layerDetails.length&&(d._layerType=d.layerDetails[0].layerControl._layerType);this.separated?"overlay"===f?this._overlayContainer.addChild(d,e):this._vectorContainer.addChild(d,e):this.addChild(d,e);this._storeGroupedLayerInfo(b,d)},_storeGroupedLayerInfo:function(a,b){if(a.controlOptions.layerGroup){var c=a.controlOptions.layerGroup;
this._groupedLayerInfos.hasOwnProperty(c)||(this._groupedLayerInfos[c]=[]);this._groupedLayerInfos[c].push({layerInfo:a,layerControl:b})}},_applyLayerControlOptions:function(a,b){if("undefined"!==typeof a.includeUnspecifiedLayers||"undefined"!==typeof a.subLayerInfos||"undefined"!==typeof a.excludedLayers){var c=[];if(!a.includeUnspecifiedLayers&&a.subLayerInfos&&0!==a.subLayerInfos.length){var d=k.map(a.subLayerInfos,function(a){return a.id});k.forEach(b.layerInfos,function(a){-1!==k.indexOf(d,a.id)&&
c.push(a)})}else if(a.excludedLayers)k.forEach(b.layerInfos,function(b){-1===k.indexOf(a.excludedLayers,b.id)&&c.push(b)});else if(a.subLayerInfos){this._mixinLayerInfos(b.layerInfos,a.subLayerInfos);this._setSublayerVisibilities(b);return}a.subLayerInfos&&this._mixinLayerInfos(c,a.subLayerInfos);b.layerInfos=c;this._setSublayerVisibilities(b)}},_setSublayerVisibilities:function(a){var b=k.map(k.filter(a.layerInfos,function(a){return a.defaultVisibility}),function(a){return a.id});a.setVisibleLayers(b)},
_mixinLayerInfos:function(b,c){c&&0!==c.length&&(k.forEach(c,function(a){"undefined"===typeof a.defaultVisibility&&(a.defaultVisibility=!0)}),k.forEach(b,function(b){var d=k.filter(c,function(a){return a.id===b.id}).shift();d&&a.mixin(b,d)}))},_moveUp:function(a){var b=a.layer.id,c=a.domNode;"overlay"===a._layerType?a.getPreviousSibling()&&(a=k.indexOf(this.map.layerIds,b),this.map.reorderLayer(b,a+1),this._overlayContainer.containerNode.insertBefore(c,c.previousSibling),this._checkReorder()):"vector"===
a._layerType&&a.getPreviousSibling()&&(a=k.indexOf(this.map.graphicsLayerIds,b),this.map.reorderLayer(b,a+1),this._vectorContainer.containerNode.insertBefore(c,c.previousSibling),this._checkReorder())},_moveDown:function(a){var b=a.layer.id,c=a.domNode;"overlay"===a._layerType?a.getNextSibling()&&(a=k.indexOf(this.map.layerIds,b),this.map.reorderLayer(b,a-1),this._overlayContainer.containerNode.insertBefore(c,c.nextSibling.nextSibling),this._checkReorder()):"vector"===a._layerType&&a.getNextSibling()&&
(a=k.indexOf(this.map.graphicsLayerIds,b),this.map.reorderLayer(b,a-1),this._vectorContainer.containerNode.insertBefore(c,c.nextSibling.nextSibling),this._checkReorder())},_checkReorder:function(){this.separated&&(this.vectorReorder&&k.forEach(this._vectorContainer.getChildren(),function(a){a._reorderUp&&(a.getPreviousSibling()?a._reorderUp.set("disabled",!1):a._reorderUp.set("disabled",!0));a._reorderDown&&(a.getNextSibling()?a._reorderDown.set("disabled",!1):a._reorderDown.set("disabled",!0))},
this),this.overlayReorder&&k.forEach(this._overlayContainer.getChildren(),function(a){a._reorderUp&&(a.getPreviousSibling()?a._reorderUp.set("disabled",!1):a._reorderUp.set("disabled",!0));a._reorderDown&&(a.getNextSibling()?a._reorderDown.set("disabled",!1):a._reorderDown.set("disabled",!0))},this))},_zoomToLayer:function(b){if("esri.layers.KMLLayer"!==b.declaredClass){var d=this.map;b.spatialReference===d.spatialReference?d.setExtent(b.fullExtent,!0):n.defaults.geometryService?n.defaults.geometryService.project(a.mixin(new c,
{geometries:[b.fullExtent],outSR:d.spatialReference}),function(a){d.setExtent(a[0],!0)},function(a){f.publish("viewer/handleError",{source:"LayerControl._zoomToLayer",error:a})}):f.publish("viewer/handleError",{source:"LayerControl._zoomToLayer",error:"esriConfig.defaults.geometryService is not set"})}},_swipeLayer:function(c,g){c&&c.visible&&(this._swiper?(this._swiper.disable(),this._swipeLayerToggleHandle&&this._swipeLayerToggleHandle.remove(),this._swiper.set("layers",[c]),this._swiper.set("type",
g),this._swiper.enable(),b.set(this._swiper.disableBtn.domNode,"style",this.swiperButtonStyle)):q(["esri/dijit/LayerSwipe"],a.hitch(this,function(f){this._swiper=new f({type:g||"vertical",map:this.map,layers:[c]},e.create("div",{},this.map.id,"first"));this._swiper.startup();this._swiper.disableBtn=new d({label:"Exit Layer Swipe",onClick:a.hitch(this,"_swipeDisable")},e.create("div",{},this.map.id));b.set(this._swiper.disableBtn.domNode,"style",this.swiperButtonStyle)})),this._swipeLayerToggleHandle=
f.subscribe("layerControl/layerToggle",a.hitch(this,function(a){a.id!==c.id||a.visible||this._swipeDisable()})))},_swipeDisable:function(){this._swiper.disable();this._swipeLayerToggleHandle&&this._swipeLayerToggleHandle.remove();b.set(this._swiper.disableBtn.domNode,"style","display:none;")},showAllLayers:function(){this.separated?(k.forEach(this._vectorContainer.getChildren(),function(a){a.layer.show()}),k.forEach(this._overlayContainer.getChildren(),function(a){a.layer.show()})):k.forEach(this.getChildren(),
function(a){a.layer.show()})},hideAllLayers:function(){this.separated?(k.forEach(this._vectorContainer.getChildren(),function(a){a.layer.hide()}),k.forEach(this._overlayContainer.getChildren(),function(a){a.layer.hide()})):k.forEach(this.getChildren(),function(a){a.layer.hide()})}})})},"esri/tasks/ProjectParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),function(h,k,a,f,b,e,l,m){h=h(null,
{declaredClass:"esri.tasks.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJson:function(){var b=a.map(this.geometries,function(a){return a.toJson()}),d={};return d.outSR=this.outSR.wkid||f.toJson(this.outSR.toJson()),d.inSR=this.geometries[0].spatialReference.wkid||f.toJson(this.geometries[0].spatialReference.toJson()),d.geometries=f.toJson({geometryType:m.getJsonType(this.geometries[0]),geometries:b}),this.transformation&&(d.transformation=this.transformation.wkid||
f.toJson(this.transformation)),l.isDefined(this.transformForward)&&(d.transformForward=this.transformForward),d}});return b("extend-esri")&&k.setObject("tasks.ProjectParameters",h,e),h})},"cmv/viewer/js/gis/dijit/LayerControl/controls/Dynamic":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/topic dojo/query dojo/dom-construct dojo/dom-attr dijit/registry dijit/_WidgetBase dijit/_TemplatedMixin dijit/_Contained dijit/MenuItem dijit/MenuSeparator ./_Control ./_DynamicSublayer ./_DynamicFolder ./../plugins/legendUtil dojo/i18n!./../nls/resource".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x){return h([d,c,n,r],{_layerType:"overlay",_esriLayerType:"dynamic",_hasSublayers:!1,_visLayersHandler:null,constructor:function(){this._sublayerControls=[]},_layerTypePreInit:function(){1<this.layer.layerInfos.length&&this.controlOptions.sublayers&&(this._hasSublayers=!0,this._visLayersHandler=f.after(this.layer,"setVisibleLayers",k.hitch(this,"_onSetVisibleLayers"),!0))},_layerTypeInit:function(){var a=w.isLegend(this.controlOptions.noLegend,this.controller.noLegend);
a&&!0===this.controlOptions.sublayers?(this._expandClick(),this._createSublayers(this.layer),f.after(this,"_createSublayers",k.hitch(this,w.dynamicSublayerLegend(this.layer,this.expandNode)))):!1===this.controlOptions.sublayers&&a?(this._expandClick(),w.layerLegend(this.layer,this.expandNode)):!0!==this.controlOptions.sublayers||a?this._expandRemove():(this._expandClick(),f.after(this,"_createSublayers",k.hitch(this,"_removeSublayerLegends")),this._createSublayers(this.layer))},_dynamicToggleMenuItems:function(a){this._hasSublayers&&
!1!==this.controlOptions.allSublayerToggles&&(a.addChild(new q({label:x.dynamicSublayersOn,onClick:k.hitch(this,"_toggleAllSublayers",!0)})),a.addChild(new q({label:x.dynamicSublayersOff,onClick:k.hitch(this,"_toggleAllSublayers",!1)})),a.addChild(new t))},_initCustomMenu:function(){this._hasSublayers||(a.forEach(this.controlOptions.subLayerMenu,k.hitch(this,"_addCustomMenuItem",this.layerMenu)),this.layerMenu.addChild(new t))},_toggleAllSublayers:function(b){a.forEach(this._sublayerControls,function(a){a._setSublayerCheckbox(b)});
this._setVisibleLayers()},_createSublayers:function(b){if(1<b.layerInfos.length){var c=a.map(b.layerInfos,function(a){return a.id});a.forEach(b.layerInfos,k.hitch(this,function(d){var e=a.filter(this.controlOptions.subLayerInfos,function(a){return a.id===d.id}).shift();k.mixin(d,e);var e=d.parentLayerId,f=d.subLayerIds,m=b.id+"-"+d.id+"-sublayer-control",h;-1===e||-1===c.indexOf(e)?null===f?(h=new v({id:m,control:this,sublayerInfo:d,icons:this.icons}),l.place(h.domNode,this.expandNode,"last")):null!==
f&&(h=new u({id:m,control:this,sublayerInfo:d,icons:this.icons}),l.place(h.domNode,this.expandNode,"last")):-1!==e&&null!==f?(h=new u({id:m,control:this,sublayerInfo:d,icons:this.icons}),l.place(h.domNode,g.byId(b.id+"-"+d.parentLayerId+"-sublayer-control").expandNode,"last")):-1!==e&&null===f&&(h=new v({id:m,control:this,sublayerInfo:d,icons:this.icons}),l.place(h.domNode,g.byId(b.id+"-"+d.parentLayerId+"-sublayer-control").expandNode,"last"));h.startup();this._sublayerControls.push(h)}))}},_removeSublayerLegends:function(){a.forEach(this._sublayerControls,
function(a){a.sublayerInfo.subLayerIds||l.destroy(a.expandClickNode)})},_setVisibleLayers:function(){this._visLayersHandler.remove();var c=this.layer,d=[];a.forEach(e("."+c.id+"-layerControlSublayerCheck"),function(a){"checked"===m.get(a,"data-checked")&&d.push(parseInt(m.get(a,"data-sublayer-id"),10))});a.forEach(c.layerInfos,function(b){null!==b.subLayerIds&&-1===a.indexOf(d,b.id)?a.forEach(b.subLayerIds,function(b){-1!==a.indexOf(d,b)&&d.splice(a.indexOf(d,b),1)}):null!==b.subLayerIds&&-1!==a.indexOf(d,
b.id)&&d.splice(a.indexOf(d,b.id),1)});d.length||d.push(-1);c.setVisibleLayers(d);c.refresh();b.publish("layerControl/setVisibleLayers",{id:c.id,visibleLayers:d});this._visLayersHandler=f.after(this.layer,"setVisibleLayers",k.hitch(this,"_onSetVisibleLayers"),!0)},_onSetVisibleLayers:function(b){var c=[];a.forEach(this.layer.layerInfos,function(d){-1!==a.indexOf(b,d.id)&&c.push(d.id);-1!==d.parentLayerId&&-1===a.indexOf(c,d.parentLayerId)&&c.push(d.parentLayerId)});a.forEach(this._sublayerControls,
function(b){-1!==a.indexOf(c,b.sublayerInfo.id)?b._setSublayerCheckbox(!0):b._setSublayerCheckbox(!1)})}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n){l=h("dijit.MenuItem"+(e("dojo-bidi")?"_NoBidi":""),[m,g,d,c],{templateString:n,baseClass:"dijitMenuItem",label:"",
_setLabelAttr:function(a){this._set("label",a);var b="",c;c=a.search(/{\S}/);if(0<=c){var b=a.charAt(c+1),d=a.substr(0,c);a=a.substr(c+3);c=d+b+a;a=d+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+b+"\x3c/span\x3e"+a}else c=a;this.domNode.setAttribute("aria-label",c+" "+this.accelKey);this.containerNode.innerHTML=a;this._set("shortcutKey",b)},iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(a){!a||"label"in this.params||this._set("label",
a.innerHTML)},buildRendering:function(){this.inherited(arguments);a.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&a.set(this.accelKeyNode,"id",this.id+"_accel");k.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==e("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(q){}},_setSelected:function(a){f.toggle(this.domNode,"dijitMenuItemSelected",a)},setLabel:function(a){b.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.",
"","2.0");this.set("label",a)},setDisabled:function(a){b.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",a)},_setDisabledAttr:function(a){this.focusNode.setAttribute("aria-disabled",a?"true":"false");this._set("disabled",a)},_setAccelKeyAttr:function(b){this.accelKeyNode&&(this.accelKeyNode.style.display=b?"":"none",this.accelKeyNode.innerHTML=b,a.set(this.containerNode,"colSpan",b?"1":"2"));this._set("accelKey",b)}});e("dojo-bidi")&&
(l=h("dijit.MenuItem",l,{_setLabelAttr:function(a){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return l})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(h,k,a,f,b,e){return h("dijit.MenuSeparator",[a,f,b],{templateString:e,buildRendering:function(){this.inherited(arguments);k.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},
"cmv/viewer/js/gis/dijit/LayerControl/controls/_Control":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/topic dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-attr dojo/fx dojo/html dijit/MenuItem ./../plugins/LayerMenu dojo/text!./templates/Control.html".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t){return h([],{templateString:t,controller:null,layer:null,layerTitle:"Layer Title",controlOptions:null,layerMenu:null,icons:null,_reorderUp:null,_reorderDown:null,
_scaleRangeHandler:null,_expandClickHandler:null,constructor:function(a){a.controller&&(this.icons=a.controller.icons);this._handlers=[]},postCreate:function(){this.inherited(arguments);this.controller?this.layer?this.layer.loaded?this._initialize():this._handlers.push(this.layer.on("load",k.hitch(this,"_initialize"))):(b.publish("viewer/handleError",{source:"LayerControl/_Control",error:"layer option is required"}),this.destroy()):(b.publish("viewer/handleError",{source:"LayerControl/_Control",error:"controller option is required"}),
this.destroy())},_initialize:function(){this._layerTypePreInit&&this._layerTypePreInit();var a=this.layer,b=this.controlOptions;this._setLayerCheckbox(a,this.checkNode);c.set(this.labelNode,this.layerTitle);!0!==b.noMenu&&!0!==this.controller.noMenu||!0===this.controller.noMenu&&!1===b.noMenu?(this.layerMenu=new q({control:this,contextMenuForWindow:!1,targetNodeIds:[this.menuNode],leftClickToOpen:!0}),this.layerMenu.startup(),this._initCustomMenu()):(m.remove(this.menuNode,"fa, layerControlMenuIcon, "+
this.icons.menu),l.set(this.menuClickNode,"cursor","default"));if(0!==a.minScale||0!==a.maxScale)this._checkboxScaleRange(),this._scaleRangeHandler=a.getMap().on("zoom-end",k.hitch(this,"_checkboxScaleRange"));this._layerTypeInit();b.expanded&&b.sublayers&&this.expandClickNode.click();this._handlers.push(f(this.checkNode,"click",k.hitch(this,"_setLayerVisibility",a,this.checkNode)),a.on("scale-range-change",k.hitch(this,"_scaleRangeChange")),a.on("update-start",k.hitch(this,"_updateStart")),a.on("update-end",
k.hitch(this,"_updateEnd")),a.on("visibility-change",k.hitch(this,"_visibilityChange")))},_initCustomMenu:function(){a.forEach(this.controlOptions.menu,k.hitch(this,"_addCustomMenuItem",this.layerMenu))},_addCustomMenuItem:function(a,c){var d=new n(c);d.set("onClick",k.hitch(this,function(){b.publish("layerControl/"+c.topic,{layer:this.layer,iconNode:this.iconNode,menuItem:d})}));a.addChild(d)},_expandClick:function(){this._expandClickHandler=f(this.expandClickNode,"click",k.hitch(this,"_expandClicked"));
this._handlers.push(this._expandClickHandler)},_expandClicked:function(){var a=this.icons,b=this.expandNode,c=this.expandIconNode;"none"===l.get(b,"display")?(d.wipeIn({node:b,duration:300}).play(),m.replace(c,a.collapse,a.expand)):(d.wipeOut({node:b,duration:300}).play(),m.replace(c,a.expand,a.collapse))},_expandRemove:function(){m.remove(this.expandIconNode,["fa",this.icons.expand,"layerControlToggleIcon"]);l.set(this.expandClickNode,"cursor","default");e.destroy(this.expandNode)},_setLayerVisibility:function(a,
c,d){d.stopPropagation&&d.stopPropagation();a.visible?(this._setLayerCheckbox(a,c),a.hide()):(this._setLayerCheckbox(a,c),a.show());b.publish("layerControl/layerToggle",{id:a.id,visible:a.visible,params:a._params});0===a.minScale&&0===a.maxScale||this._checkboxScaleRange()},_setLayerCheckbox:function(a,b){var c=this.icons;a.visible?(g.set(b,"data-checked","checked"),m.replace(b,c.checked,c.unchecked)):(g.set(b,"data-checked","unchecked"),m.replace(b,c.unchecked,c.checked))},_checkboxScaleRange:function(){var a=
this.checkNode,b=this.layer,c=b.getMap().getScale(),d=b.minScale,b=b.maxScale;m.remove(a,"layerControlCheckIconOutScale");(0!==d&&c>d||0!==b&&c<b)&&m.add(a,"layerControlCheckIconOutScale")},_scaleRangeChange:function(){if(0!==this.layer.minScale||0!==this.layer.maxScale){this._checkboxScaleRange();if(this._scaleRangeHandler){var b=a.indexOf(this._handlers,this._scaleRangeHandler);-1!==b&&(this._handlers[b].remove(),this._handlers.splice(b,1))}this._scaleRangeHandler=this.layer.getMap().on("zoom-end",
k.hitch(this,"_checkboxScaleRange"));this._handlers.push(this._scaleRangeHandler)}else this._checkboxScaleRange(),this._scaleRangeHandler&&(b=a.indexOf(this._handlers,this._scaleRangeHandler),-1!==b&&(this._handlers[b].remove(),this._handlers.splice(b,1)),this._scaleRangeHandler=null)},_updateStart:function(){l.set(this.layerUpdateNode,"display","inline-block");this._layerState=k.clone({visible:this.layer.visible,visibleLayers:this.layer.visibleLayers||null})},_updateEnd:function(){l.set(this.layerUpdateNode,
"display","none");this._layerState||(this._layerState=null)},_visibilityChange:function(a){(a.visible&&"unchecked"===g.get(this.checkNode,"data-checked")||!a.visible&&"checked"===g.get(this.checkNode,"data-checked"))&&this._setLayerCheckbox(this.layer,this.checkNode)},destroy:function(){this.inherited(arguments);this._handlers.forEach(function(a){a.remove()})}})})},"cmv/viewer/js/gis/dijit/LayerControl/plugins/LayerMenu":function(){define("dojo/_base/declare dijit/Menu dijit/MenuItem dijit/PopupMenuItem dijit/MenuSeparator ./Transparency dojo/i18n!./../nls/resource".split(" "),
function(h,k,a,f,b,e,l){return h(k,{control:null,_removed:!1,postCreate:function(){this.inherited(arguments);var m=this.control,g=m.layer,d=m.controlOptions,c=m.controller,h=m._layerType;if("vector"===h&&c.vectorReorder||"overlay"===h&&c.overlayReorder)m._reorderUp=new a({label:l.moveUp,onClick:function(){c._moveUp(m)}}),this.addChild(m._reorderUp),m._reorderDown=new a({label:l.moveDown,onClick:function(){c._moveDown(m)}}),this.addChild(m._reorderDown),this.addChild(new b);m._dynamicToggleMenuItems&&
m._dynamicToggleMenuItems(this);(!0!==d.noZoom&&!0!==c.noZoom||!0===c.noZoom&&!1===d.noZoom)&&this.addChild(new a({label:l.zoomTo,onClick:function(){c._zoomToLayer(g)}}));(!0!==d.noTransparency&&!0!==c.noTransparency||!0===c.noTransparency&&!1===d.noTransparency)&&this.addChild(new e({label:l.transparency,layer:g}));if(!0===d.swipe||!0===c.swipe&&!1!==d.swipe)h=new k,h.addChild(new a({label:l.layerSwipeVertical,onClick:function(){c._swipeLayer(g,"vertical")}})),h.addChild(new a({label:l.layerSwipeHorizontal,
onClick:function(){c._swipeLayer(g,"horizontal")}})),!0===d.swipeScope&&h.addChild(new a({label:l.layerSwipeScope,onClick:function(){c._swipeLayer(g,"scope")}})),this.addChild(new f({label:l.layerSwipe,popup:h}));!0===d.metadataUrl&&g.url&&(this.addChild(new b),this.addChild(new a({label:l.metadata,onClick:function(){window.open(g.url,"_blank")}})));d.metadataUrl&&"string"===typeof d.metadataUrl&&(this.addChild(new b),this.addChild(new a({label:l.metadata,onClick:function(){window.open(d.metadataUrl,
"_blank")}})));(h=this.getChildren()[this.getChildren().length-1])&&h.isInstanceOf(b)&&this.removeChild(h)}})})},"dijit/PopupMenuItem":function(){define("dojo/_base/declare dojo/dom-style dojo/_base/lang dojo/query ./popup ./registry ./MenuItem ./hccss".split(" "),function(h,k,a,f,b,e,l){return h("dijit.PopupMenuItem",l,{baseClass:"dijitMenuItem dijitPopupMenuItem",_fillContent:function(){if(this.srcNodeRef){var a=f("*",this.srcNodeRef);this.inherited(arguments,[a[0]]);this.dropDownContainer=this.srcNodeRef}},
_openPopup:function(e,f){var d=this.popup;b.open(a.delegate(e,{popup:this.popup,around:this.domNode}));f&&d.focus&&d.focus()},_closePopup:function(){b.close(this.popup);this.popup.parentMenu=null},startup:function(){if(!this._started){this.inherited(arguments);if(!this.popup){var a=f("[widgetId]",this.dropDownContainer)[0];this.popup=e.byNode(a)}this.ownerDocumentBody.appendChild(this.popup.domNode);this.popup.domNode.setAttribute("aria-labelledby",this.containerNode.id);this.popup.startup();this.popup.domNode.style.display=
"none";this.arrowWrapper&&k.set(this.arrowWrapper,"visibility","");this.focusNode.setAttribute("aria-haspopup","true")}},destroyDescendants:function(a){this.popup&&(this.popup._destroyed||this.popup.destroyRecursive(a),delete this.popup);this.inherited(arguments)}})})},"cmv/viewer/js/gis/dijit/LayerControl/plugins/Transparency":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/query dojo/dom-style dijit/PopupMenuItem dijit/TooltipDialog dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels".split(" "),
function(h,k,a,f,b,e,l,m,g){return h(e,{layer:null,constructor:function(a){a=a||{};k.mixin(this,a)},postCreate:function(){this.inherited(arguments);var d=new m({value:this.layer.opacity,minimum:0,maximum:1,discreteValues:21,intermediateChanges:!0,showButtons:!1,onChange:k.hitch(this,function(c){this.layer.setOpacity(c);a.forEach(f("."+this.layer.id+"-layerLegendImage"),function(a){b.set(a,"opacity",c)})})});(new g({labels:["100%","50%","0%"],style:"height:1em;font-size:75%;"},d.bottomDecoration)).startup();
d.startup();this.popup=new l({style:"width:200px;",content:d});b.set(this.popup.connectorNode,"display","none");this.popup.startup()}})})},"dijit/TooltipDialog":function(){define("dojo/_base/declare dojo/dom-class dojo/has dojo/keys dojo/_base/lang dojo/on ./focus ./layout/ContentPane ./_DialogMixin ./form/_FormMixin ./_TemplatedMixin dojo/text!./templates/TooltipDialog.html ./main".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q){h=h("dijit.TooltipDialog",[m,c,d,g],{title:"",doLayout:!1,autofocus:!0,
baseClass:"dijitTooltipDialog",_firstFocusItem:null,_lastFocusItem:null,templateString:n,_setTitleAttr:"containerNode",postCreate:function(){this.inherited(arguments);this.own(e(this.domNode,"keydown",b.hitch(this,"_onKey")))},orient:function(a,b,c){a={"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight",
"TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft","BR-TL":"dijitTooltipBelow dijitTooltipABLeft","BL-TR":"dijitTooltipBelow dijitTooltipABRight","TL-BR":"dijitTooltipAbove dijitTooltipABRight","TR-BL":"dijitTooltipAbove dijitTooltipABLeft"}[b+"-"+c];k.replace(this.domNode,a,this._currentOrientClass||"");this._currentOrientClass=a},focus:function(){this._getFocusItems();l.focus(this._firstFocusItem)},onOpen:function(a){this.orient(this.domNode,a.aroundCorner,
a.corner);var b=a.aroundNodePos;"M"==a.corner.charAt(0)&&"M"==a.aroundCorner.charAt(0)?(this.connectorNode.style.top=b.y+(b.h-this.connectorNode.offsetHeight>>1)-a.y+"px",this.connectorNode.style.left=""):"M"==a.corner.charAt(1)&&"M"==a.aroundCorner.charAt(1)&&(this.connectorNode.style.left=b.x+(b.w-this.connectorNode.offsetWidth>>1)-a.x+"px");this._onShow()},onClose:function(){this.onHide()},_onKey:function(a){if(a.keyCode==f.ESCAPE)this.defer("onCancel"),a.stopPropagation(),a.preventDefault();else if(a.keyCode==
f.TAB){var b=a.target;this._getFocusItems();this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):b==this._firstFocusItem&&a.shiftKey?(l.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):b!=this._lastFocusItem||a.shiftKey?a.stopPropagation():(l.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault())}}});a("dojo-bidi")&&h.extend({_setTitleAttr:function(a){this.containerNode.title=this.textDir&&this.enforceTextDirWithUcc?this.enforceTextDirWithUcc(null,
a):a;this._set("title",a)},_setTextDirAttr:function(a){this._created&&this.textDir==a||(this._set("textDir",a),this.textDir&&this.title&&(this.containerNode.title=this.enforceTextDirWithUcc(null,this.title)))}});return h})},"dijit/form/HorizontalSlider":function(){define("dojo/_base/array dojo/_base/declare dojo/dnd/move dojo/_base/fx dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/dnd/Moveable dojo/dnd/Mover dojo/query dojo/mouse dojo/on ../_base/manager ../focus ../typematic ./Button ./_FormValueWidget ../_Container dojo/text!./templates/HorizontalSlider.html".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A){var z=k("dijit.form._SliderMover",c,{onMouseMove:function(a){var c=this.widget,d=c._abspos;d||(d=c._abspos=b.position(c.sliderBarContainer,!0),c._setPixelValue_=m.hitch(c,"_setPixelValue"),c._isReversed_=c._isReversed());a=a[c._mousePixelCoord]-d[c._startingPixelCoord];c._setPixelValue_(c._isReversed_?d[c._pixelCount]-a:a,d[c._pixelCount],!1)},destroy:function(a){c.prototype.destroy.apply(this,arguments);var b=this.widget;b._abspos=null;b._setValueAttr(b.value,
!0)}});a=k("dijit.form.HorizontalSlider",[x,y],{templateString:A,value:0,showButtons:!0,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:!0,slideDuration:r.defaultDuration,_setIdAttr:"",_setNameAttr:"valueNode",baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_handleOffsetCoord:"left",_progressPixelSize:"width",
_onKeyUp:function(a){this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey||this._setValueAttr(this.value,!0)},_onKeyDown:function(a){if(!(this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey)){switch(a.keyCode){case l.HOME:this._setValueAttr(this.minimum,!1);break;case l.END:this._setValueAttr(this.maximum,!1);break;case this._descending||this.isLeftToRight()?l.RIGHT_ARROW:l.LEFT_ARROW:case !1===this._descending?l.DOWN_ARROW:l.UP_ARROW:case !1===this._descending?l.PAGE_DOWN:l.PAGE_UP:this.increment(a);
break;case this._descending||this.isLeftToRight()?l.LEFT_ARROW:l.RIGHT_ARROW:case !1===this._descending?l.UP_ARROW:l.DOWN_ARROW:case !1===this._descending?l.PAGE_UP:l.PAGE_DOWN:this.decrement(a);break;default:return}a.stopPropagation();a.preventDefault()}},_onHandleClick:function(a){this.disabled||this.readOnly||(g("ie")||v.focus(this.sliderHandle),a.stopPropagation(),a.preventDefault())},_isReversed:function(){return!this.isLeftToRight()},_onBarClick:function(a){if(!this.disabled&&!this.readOnly&&
this.clickSelect){v.focus(this.sliderHandle);a.stopPropagation();a.preventDefault();var c=b.position(this.sliderBarContainer,!0),d=a[this._mousePixelCoord]-c[this._startingPixelCoord];this._setPixelValue(this._isReversed()?c[this._pixelCount]-d:d,c[this._pixelCount],!0);this._movable.onMouseDown(a)}},_setPixelValue:function(a,b,c){if(!this.disabled&&!this.readOnly){var d=this.discreteValues;if(1>=d||Infinity==d)d=b;d--;this._setValueAttr(Math.max(Math.min((this.maximum-this.minimum)*Math.round(a/
(b/d))/d+this.minimum,this.maximum),this.minimum),c)}},_setValueAttr:function(a,b){this._set("value",a);this.valueNode.value=a;this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments);var c=this.maximum>this.minimum?(a-this.minimum)/(this.maximum-this.minimum):0,d=!1===this._descending?this.remainingBar:this.progressBar,e=!1===this._descending?this.progressBar:this.remainingBar;this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);if(b&&0<this.slideDuration&&
d.style[this._progressPixelSize]){var g=this,l={},m=parseFloat(d.style[this._progressPixelSize]),h=this.slideDuration*(c-m/100);0!=h&&(0>h&&(h=0-h),l[this._progressPixelSize]={start:m,end:100*c,units:"%"},this._inProgressAnim=f.animateProperty({node:d,duration:h,onAnimate:function(a){e.style[g._progressPixelSize]=100-parseFloat(a[g._progressPixelSize])+"%"},onEnd:function(){delete g._inProgressAnim},properties:l}),this._inProgressAnim.play())}else d.style[this._progressPixelSize]=100*c+"%",e.style[this._progressPixelSize]=
100*(1-c)+"%"},_bumpValue:function(a,c){if(!(this.disabled||this.readOnly||this.maximum<=this.minimum)){var d=e.getComputedStyle(this.sliderBarContainer),f=b.getContentBox(this.sliderBarContainer,d),d=this.discreteValues;if(1>=d||Infinity==d)d=f[this._pixelCount];d--;f=Math.round((this.value-this.minimum)*d/(this.maximum-this.minimum))+a;0>f&&(f=0);f>d&&(f=d);f=f*(this.maximum-this.minimum)/d+this.minimum;this._setValueAttr(f,c)}},_onClkBumper:function(a){this.disabled||this.readOnly||!this.clickSelect||
this._setValueAttr(a,!0)},_onClkIncBumper:function(){this._onClkBumper(!1===this._descending?this.minimum:this.maximum)},_onClkDecBumper:function(){this._onClkBumper(!1===this._descending?this.maximum:this.minimum)},decrement:function(a){this._bumpValue(a.keyCode==l.PAGE_DOWN?-this.pageIncrement:-1)},increment:function(a){this._bumpValue(a.keyCode==l.PAGE_UP?this.pageIncrement:1)},_mouseWheeled:function(a){this.focused&&(a.stopPropagation(),a.preventDefault(),this._bumpValue(0>a.wheelDelta?-1:1,!0))},
startup:function(){this._started||(h.forEach(this.getChildren(),function(a){this[a.container]!=this.containerNode&&this[a.container].appendChild(a.domNode)},this),this.inherited(arguments))},_typematicCallback:function(a,b,c){if(-1==a)this._setValueAttr(this.value,!0);else this[b==(this._descending?this.incrementButton:this.decrementButton)?"decrement":"increment"](c)},buildRendering:function(){this.inherited(arguments);this.showButtons&&(this.incrementButton.style.display="",this.decrementButton.style.display=
"");var a=n('label[for\x3d"'+this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.focusNode.setAttribute("aria-labelledby",a[0].id));this.focusNode.setAttribute("aria-valuemin",this.minimum);this.focusNode.setAttribute("aria-valuemax",this.maximum)},postCreate:function(){this.inherited(arguments);this.showButtons&&this.own(u.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500),u.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));this.own(t(this.domNode,
q.wheel,m.hitch(this,"_mouseWheeled")));var a=k(z,{widget:this});this._movable=new d(this.sliderHandle,{mover:a});this._layoutHackIE7()},destroy:function(){this._movable.destroy();this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);this.inherited(arguments)}});a._Mover=z;return a})},"dojo/dnd/move":function(){define("../_base/declare ../dom-geometry ../dom-style ./common ./Mover ./Moveable".split(" "),function(h,k,a,f,b,e){f=h("dojo.dnd.move.constrainedMoveable",
e,{constraints:function(){},within:!1,constructor:function(a,b){b||(b={});this.constraints=b.constraints;this.within=b.within},onFirstMove:function(a){var b=this.constraintBox=this.constraints.call(this,a);b.r=b.l+b.w;b.b=b.t+b.h;this.within&&(a=k.getMarginSize(a.node),b.r-=a.w,b.b-=a.h)},onMove:function(a,b){var e=this.constraintBox,d=a.node.style;this.onMoving(a,b);b.l=b.l<e.l?e.l:e.r<b.l?e.r:b.l;b.t=b.t<e.t?e.t:e.b<b.t?e.b:b.t;d.left=b.l+"px";d.top=b.t+"px";this.onMoved(a,b)}});b=h("dojo.dnd.move.boxConstrainedMoveable",
f,{box:{},constructor:function(a,b){var e=b&&b.box;this.constraints=function(){return e}}});h=h("dojo.dnd.move.parentConstrainedMoveable",f,{area:"content",constructor:function(b,e){var f=e&&e.area;this.constraints=function(){var b=this.node.parentNode,c=a.getComputedStyle(b),e=k.getMarginBox(b,c);if("margin"==f)return e;var g=k.getMarginExtents(b,c);e.l+=g.l;e.t+=g.t;e.w-=g.w;e.h-=g.h;if("border"==f)return e;g=k.getBorderExtents(b,c);e.l+=g.l;e.t+=g.t;e.w-=g.w;e.h-=g.h;if("padding"==f)return e;g=
k.getPadExtents(b,c);e.l+=g.l;e.t+=g.t;e.w-=g.w;e.h-=g.h;return e}}});return{constrainedMoveable:f,boxConstrainedMoveable:b,parentConstrainedMoveable:h}})},"dijit/typematic":function(){define("dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/on dojo/sniff ./main".split(" "),function(h,k,a,f,b,e){var l=e.typematic={_fireEventAndReload:function(){this._timer=null;this._callback(++this._count,this._node,this._evt);this._currentTimeout=Math.max(0>this._currentTimeout?this._initialDelay:1<this._subsequentDelay?
this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay),this._minDelay);this._timer=setTimeout(a.hitch(this,"_fireEventAndReload"),this._currentTimeout)},trigger:function(b,e,d,c,f,l,h,k){if(f!=this._obj){this.stop();this._initialDelay=h||500;this._subsequentDelay=l||.9;this._minDelay=k||10;this._obj=f;this._node=d;this._count=this._currentTimeout=-1;this._callback=a.hitch(e,c);this._evt={faux:!0};for(var g in b)"layerX"!=g&&"layerY"!=g&&(e=b[g],"function"!=typeof e&&"undefined"!=
typeof e&&(this._evt[g]=e));this._fireEventAndReload()}},stop:function(){this._timer&&(clearTimeout(this._timer),this._timer=null);this._obj&&(this._callback(-1,this._node,this._evt),this._obj=null)},addKeyListener:function(b,e,d,c,n,q,t){var g="keyCode"in e?"keyCode":"charCode"in e?"charCode":"charOrCode",m=[f(b,"keyCode"in e?"keydown":"charCode"in e?"keypress":k._keypress,a.hitch(this,function(a){a[g]!=e[g]||void 0!==e.ctrlKey&&e.ctrlKey!=a.ctrlKey||void 0!==e.altKey&&e.altKey!=a.altKey||void 0!==
e.metaKey&&e.metaKey!=(a.metaKey||!1)||void 0!==e.shiftKey&&e.shiftKey!=a.shiftKey?l._obj==e&&l.stop():(a.stopPropagation(),a.preventDefault(),l.trigger(a,d,b,c,e,n,q,t))})),f(b,"keyup",a.hitch(this,function(){l._obj==e&&l.stop()}))];return{remove:function(){h.forEach(m,function(a){a.remove()})}}},addMouseListener:function(e,g,d,c,n,k){var m=[f(e,"mousedown",a.hitch(this,function(a){a.preventDefault();l.trigger(a,g,e,d,e,c,n,k)})),f(e,"mouseup",a.hitch(this,function(a){this._obj&&a.preventDefault();
l.stop()})),f(e,"mouseout",a.hitch(this,function(a){this._obj&&a.preventDefault();l.stop()})),f(e,"dblclick",a.hitch(this,function(f){f.preventDefault();9>b("ie")&&(l.trigger(f,g,e,d,e,c,n,k),setTimeout(a.hitch(this,l.stop),50))}))];return{remove:function(){h.forEach(m,function(a){a.remove()})}}},addListener:function(a,b,d,c,e,f,l,k){var g=[this.addKeyListener(b,d,c,e,f,l,k),this.addMouseListener(a,c,e,f,l,k)];return{remove:function(){h.forEach(g,function(a){a.remove()})}}}};return l})},"dijit/form/HorizontalRuleLabels":function(){define("dojo/_base/declare dojo/has dojo/number dojo/query dojo/_base/lang ./HorizontalRule".split(" "),
function(h,k,a,f,b,e){h=h("dijit.form.HorizontalRuleLabels",e,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH"\x3e\x3c/div\x3e',labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:'\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerH" style\x3d"left:',_labelPrefix:'"\x3e\x3cdiv class\x3d"dijitRuleLabel dijitRuleLabelH"\x3e',_suffix:"\x3c/div\x3e\x3c/div\x3e",
_calcPosition:function(a){return a},_genHTML:function(a,b){var e=this.labels[b];return this._positionPrefix+this._calcPosition(a)+this._positionSuffix+this.labelStyle+this._genDirectionHTML(e)+this._labelPrefix+e+this._suffix},_genDirectionHTML:function(a){return""},getLabels:function(){var b=this.labels;!b.length&&this.srcNodeRef&&(b=f("\x3e li",this.srcNodeRef).map(function(a){return String(a.innerHTML)}));if(!b.length&&1<this.count)for(var b=[],e=this.minimum,g=(this.maximum-e)/(this.count-1),
d=0;d<this.count;d++)b.push(d<this.numericMargin||d>=this.count-this.numericMargin?"":a.format(e,this.constraints)),e+=g;return b},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();this.count=this.labels.length}});k("dojo-bidi")&&h.extend({_setTextDirAttr:function(a){this.textDir!=a&&(this._set("textDir",a),f(".dijitRuleLabelContainer",this.domNode).forEach(b.hitch(this,function(a){a.style.direction=this.getTextDir(a.innerText||a.textContent||"")})))},_genDirectionHTML:function(a){return this.textDir?
"direction:"+this.getTextDir(a)+";":""}});return h})},"dijit/form/HorizontalRule":function(){define(["dojo/_base/declare","../_Widget","../_TemplatedMixin"],function(h,k,a){return h("dijit.form.HorizontalRule",[k,a],{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH"\x3e\x3c/div\x3e',count:3,container:"containerNode",ruleStyle:"",_positionPrefix:'\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkH" style\x3d"left:',_positionSuffix:"%;",_suffix:'"\x3e\x3c/div\x3e',_genHTML:function(a){return this._positionPrefix+
a+this._positionSuffix+this.ruleStyle+this._suffix},_isHorizontal:!0,buildRendering:function(){this.inherited(arguments);var a;if(1==this.count)a=this._genHTML(50,0);else{var b,e=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){a=this._genHTML(0,0);for(b=1;b<this.count-1;b++)a+=this._genHTML(e*b,b);a+=this._genHTML(100,this.count-1)}else{a=this._genHTML(100,0);for(b=1;b<this.count-1;b++)a+=this._genHTML(100-e*b,b);a+=this._genHTML(0,this.count-1)}}this.domNode.innerHTML=a}})})},"cmv/viewer/js/gis/dijit/LayerControl/nls/resource":function(){define({root:{noLegend:"No Legend",
moveUp:"Move Up",moveDown:"Move Down",zoomTo:"Zoom to Layer",transparency:"Transparency",metadata:"Metadata",layerSwipe:"Layer Swipe",layerSwipeVertical:"Vertical",layerSwipeHorizontal:"Horizontal",layerSwipeScope:"Scope",dynamicSublayersOn:"Turn On All Sublayers",dynamicSublayersOff:"Turn Off All Sublayers"},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/LayerControl/controls/_DynamicSublayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dojo/dom-style dojo/dom-attr dojo/fx dojo/html dijit/Menu dijit/MenuItem dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Sublayer.html dojo/i18n!./../nls/resource".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v){return h([q,t],{control:null,sublayerInfo:null,menu:null,icons:null,templateString:r,i18n:v,_expandClickHandler:null,_handlers:[],postCreate:function(){this.inherited(arguments);if(this.control.controlOptions.subLayerInfos&&!this.control.controlOptions.includeUnspecifiedLayers){var c=a.map(this.control.controlOptions.subLayerInfos,function(a){return a.id});0>a.indexOf(c,this.sublayerInfo.id)&&b.add(this.domNode,"layerControlHidden")}this.control.controlOptions.layerIds&&
0>a.indexOf(this.control.controlOptions.layerIds,this.sublayerInfo.id)&&b.add(this.domNode,"layerControlHidden");var e=this.checkNode;l.set(e,"data-sublayer-id",this.sublayerInfo.id);b.add(e,this.control.layer.id+"-layerControlSublayerCheck");-1!==a.indexOf(this.control.layer.visibleLayers,this.sublayerInfo.id)?this._setSublayerCheckbox(!0,e):this._setSublayerCheckbox(!1,e);this._handlers.push(f(e,"click",k.hitch(this,function(a){a.stopPropagation&&a.stopPropagation();"checked"===l.get(e,"data-checked")?
this._setSublayerCheckbox(!1,e):this._setSublayerCheckbox(!0,e);this.control._setVisibleLayers();this._checkboxScaleRange()})));g.set(this.labelNode,this.sublayerInfo.name);this._expandClick();if(0!==this.sublayerInfo.minScale||0!==this.sublayerInfo.maxScale)this._checkboxScaleRange(),this._handlers.push(this.control.layer.getMap().on("zoom-end",k.hitch(this,"_checkboxScaleRange")));this.control.controlOptions.subLayerMenu&&this.control.controlOptions.subLayerMenu.length?(this.menu=new d({contextMenuForWindow:!1,
targetNodeIds:[this.menuClickNode],leftClickToOpen:!0}),a.forEach(this.control.controlOptions.subLayerMenu,k.hitch(this,"_addMenuItem")),this.menu.startup()):b.add(this.menuClickNode,"hidden")},_addMenuItem:function(a){var b=new c(a);b.set("onClick",k.hitch(this,function(){n.publish("layerControl/"+a.topic,{layer:this.control.layer,subLayer:this.sublayerInfo,iconNode:this.iconNode,menuItem:b})}));this.menu.addChild(b)},_expandClick:function(){var a=this.icons;this._expandClickHandler=f(this.expandClickNode,
"click",k.hitch(this,function(){var c=this.expandNode,d=this.expandIconNode;"none"===e.get(c,"display")?(m.wipeIn({node:c,duration:300}).play(),b.replace(d,a.collapse,a.expand)):(m.wipeOut({node:c,duration:300}).play(),b.replace(d,a.expand,a.collapse))}));this._handlers.push(this._expandClickHandler)},_setSublayerCheckbox:function(a,c){c=c||this.checkNode;var d=this.icons;a?(l.set(c,"data-checked","checked"),b.replace(c,d.checked,d.unchecked)):(l.set(c,"data-checked","unchecked"),b.replace(c,d.unchecked,
d.checked))},_checkboxScaleRange:function(){var a=this.checkNode,c=this.control.layer.getMap().getScale(),d=this.sublayerInfo.minScale,e=this.sublayerInfo.maxScale;b.remove(a,"layerControlCheckIconOutScale");(0!==d&&c>d||0!==e&&c<e)&&b.add(a,"layerControlCheckIconOutScale")},destroy:function(){this.inherited(arguments);this._handlers.forEach(function(a){a.remove()})}})})},"cmv/viewer/js/gis/dijit/LayerControl/controls/_DynamicFolder":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dojo/dom-style dojo/dom-attr dojo/fx dojo/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Folder.html".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n){return h([d,c],{control:null,sublayerInfo:null,icons:null,templateString:n,_expandClickHandler:null,_handlers:[],postCreate:function(){this.inherited(arguments);if(this.control.controlOptions.subLayerInfos&&!this.control.controlOptions.includeUnspecifiedLayers){var c=a.map(this.control.controlOptions.subLayerInfos,function(a){return a.id});0>a.indexOf(c,this.sublayerInfo.id)&&b.add(this.domNode,"layerControlHidden")}this.control.controlOptions.layerIds&&0>a.indexOf(this.control.controlOptions.layerIds,
this.sublayerInfo.id)&&b.add(this.domNode,"layerControlHidden");var d=this.checkNode;l.set(d,"data-sublayer-id",this.sublayerInfo.id);b.add(d,this.control.layer.id+"-layerControlSublayerCheck");-1!==a.indexOf(this.control.layer.visibleLayers,this.sublayerInfo.id)?this._setSublayerCheckbox(!0,d):this._setSublayerCheckbox(!1,d);this._handlers.push(f(d,"click",k.hitch(this,function(a){a.stopPropagation&&a.stopPropagation();"checked"===l.get(d,"data-checked")?this._setSublayerCheckbox(!1,d):this._setSublayerCheckbox(!0,
d);this.control._setVisibleLayers();this._checkboxScaleRange()})));g.set(this.labelNode,this.sublayerInfo.name);this._expandClick();if(0!==this.sublayerInfo.minScale||0!==this.sublayerInfo.maxScale)this._checkboxScaleRange(),this._handlers.push(this.control.layer.getMap().on("zoom-end",k.hitch(this,"_checkboxScaleRange")))},_expandClick:function(){var a=this.icons;this._handlers.push(this._expandClickHandler=f(this.expandClickNode,"click",k.hitch(this,function(){var c=this.expandNode,d=this.expandIconNode;
"none"===e.get(c,"display")?(m.wipeIn({node:c,duration:300}).play(),b.replace(d,a.folderOpen,a.folder)):(m.wipeOut({node:c,duration:300}).play(),b.replace(d,a.folder,a.folderOpen))})))},_setSublayerCheckbox:function(a,c){c=c||this.checkNode;var d=this.icons;a?(l.set(c,"data-checked","checked"),b.replace(c,d.checked,d.unchecked)):(l.set(c,"data-checked","unchecked"),b.replace(c,d.unchecked,d.checked))},_checkboxScaleRange:function(){var a=this.checkNode,c=this.control.layer.getMap().getScale(),d=this.sublayerInfo.minScale,
e=this.sublayerInfo.maxScale;b.remove(a,"layerControlCheckIconOutScale");(0!==d&&c>d||0!==e&&c<e)&&b.add(a,"layerControlCheckIconOutScale")},destroy:function(){this.inherited(arguments);this._handlers.forEach(function(a){a.remove()})}})})},"cmv/viewer/js/gis/dijit/LayerControl/plugins/legendUtil":function(){define("dojo/_base/array dojo/_base/lang dojo/has dojo/topic dojo/dom-construct dojo/dom-class dojo/dom-style dojo/html dijit/registry dojox/gfx esri/request esri/dijit/Legend dojo/i18n!esri/nls/jsapi dojo/i18n!./../nls/resource".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t){q.widgets.legend.NLS_noLegend=t.noLegend;return{isLegend:function(a,b){if(null===b||!1===b){if(!0!==a)return!0}else if(!0===b&&!1===a)return!0;return!1},_legendRequest:function(a,b,d,e){var f={f:"json",token:"function"===typeof a._getToken?a._getToken():null},g={disableIdentityLookup:!1,usePost:!1,useProxy:!1};a.layerDrawingOptions&&0<a.layerDrawingOptions.length&&(f.dynamicLayers=this._createDynamicLayerParameter(a),g.usePost=!0);c({url:a.url+"/legend",callbackParamName:"callback",
content:f},g).then(k.hitch(this,d,a,b),k.hitch(this,e,a,b))},_arcgisLegendRequest:function(b,d,e,f){var g=b.url.toLowerCase().indexOf("/rest/"),g=b.url.substring(0,g)+b.url.substring(g+5,b.url.length),g="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+window.escape(g);if(!a("ie")||8<a("ie"))g+="\x26returnbytes\x3dtrue";c({url:g,callbackParamName:"callback",content:{f:"json"}}).then(k.hitch(this,e,b,d),k.hitch(this,f,b,d))},_image:function(c,d,e){var f=c.url;(!a("ie")||9<=a("ie"))&&c.imageData&&
0<c.imageData.length?f="data:image/png;base64,"+c.imageData:0!==c.url.indexOf("http")&&(f=e.url+"/"+d+"/images/"+c.url,(d=e._getToken())&&(f+="?token\x3d"+d));f=b.create("img",{src:f,"class":e.id+"-layerLegendImage"});l.set(f,{width:c.width+"px",height:c.height+"px",opacity:e.opacity});return f},layerLegend:function(a,c){var d=new n({map:a.getMap(),layerInfos:[{layer:a}]},b.create("div",{},c));setTimeout(function(){d.startup()},1)},dynamicSublayerLegend:function(a,b){10.01<=a.version?this._legendRequest(a,
b,"_createDynamicSublayerLegend","_dynamicSublayerLegendError"):this._arcgisLegendRequest(a,b,"_createDynamicSublayerLegend","_dynamicSublayerLegendError")},_createDynamicSublayerLegend:function(a,c,d){h.forEach(d.layers,function(d){var f=d.layerId,l=b.create("table");e.add(l,"layerControlLegendTable");h.forEach(d.legend,function(c){var d=b.create("tr",{},l,"last"),e=b.create("td",{"class":"layerControlLegendImage"},d,"first");b.create("td",{innerHTML:c.label||"\x26nbsp;","class":"layerControlLegendLabel"},
d,"last");b.place(this._image(c,f,a),e)},this);if(a.layerInfos.reduce(function(a,b){return b.id===d.layerId||a},!1))if(1<a.layerInfos.length){var n=g.byId(a.id+"-"+d.layerId+"-sublayer-control").expandNode;m.set(n,"");b.place(l,n)}else b.place(l,c)},this)},_dynamicSublayerLegendError:function(a,b,c){1===a.layerInfos.length&&m.set(b,"No Legend");f.publish("viewer/handleError",{source:"LayerControl/legendUtil/_createDynamicSublayerLegend",error:c})},_surfaceDims:[20,20],vectorLegend:function(a,b){var c=
a.renderer.symbol,d=a.renderer.infos;c?this._createVectorLegend([{symbol:c,description:"",label:"",value:""}],a,b):d?this._createVectorLegend(d,a,b):m.set(b,"No Legend")},_createVectorLegend:function(a,c,g){var n=b.create("table");e.add(n,"layerControlLegendTable");h.forEach(a,function(a){var h=b.create("tr",{},n,"last"),k=b.create("td",{"class":"layerControlLegendImage"},h,"first");b.create("td",{innerHTML:a.label||"\x26nbsp;","class":"layerControlLegendLabel"},h,"last");var h=a.symbol,q=h.getShapeDescriptors(),
r=q.defaultShape;a=q.fill;q=q.stroke;if(r.src)k=b.create("img",{src:r.src},k),l.set(k,{width:h.width+"px",height:h.height+"px",opacity:c.opacity}),e.add(k,c.id+"-layerLegendImage");else if(h){var t=this._surfaceDims[0],v=this._surfaceDims[1];h.width&&h.height&&(t=h.width,v=h.height);h=b.create("span",{},k);l.set(h,{width:t+"px",height:v+"px",display:"inline-block"});h=d.createSurface(h,t,v).createShape(r);a&&h.setFill(a);q&&h.setStroke(q);h.applyTransform({dx:t/2,dy:v/2});l.set(k,{opacity:c.opacity});
e.add(k,c.id+"-layerLegendImage")}else m.set(g,"No Legend"),f.publish("viewer/handleError",{source:"LayerControl/legendUtil/_createVectorLegend",error:"renderer does not contain symbol(s)"});b.place(n,g)},this)},_createDynamicLayerParameter:function(a){if(a.dynamicLayerInfos&&0<a.dynamicLayerInfos.length||a.layerDrawingOptions&&0<a.layerDrawingOptions.length){a.dynamicLayerInfos=a.createDynamicLayerInfosFromLayerInfos();var b=[];a.dynamicLayerInfos.forEach(function(c){if(!c.subLayerIds){var d,e=c.id;
d={id:e,name:c.name};c.source&&(d.source=c.source.toJson());a.layerDrawingOptions&&a.layerDrawingOptions[e]&&(d.drawingInfo=a.layerDrawingOptions[e].toJson());b.push(d)}},this);return JSON.stringify(b)}return null}}})},"esri/dijit/Legend":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/_base/Color dojo/debounce dojo/has dojo/sniff dojo/Deferred dojo/DeferredList dojo/json dojo/dom dojo/dom-construct dojo/dom-style dojo/dom-class dijit/_Widget dojox/gfx dojox/gfx/matrix dojox/html/entities ../kernel ../config ../request ../lang ../numberUtils ../renderers/utils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/ClassBreaksRenderer ../renderers/ScaleDependentRenderer ../renderers/DotDensityRenderer ../renderers/TemporalRenderer ../renderers/VectorFieldRenderer ../renderers/HeatmapRenderer ../symbols/PictureFillSymbol ../symbols/SimpleLineSymbol ../symbols/jsonUtils ../renderers/jsonUtils ./_EventedWidget dojo/i18n!../nls/jsapi".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J,L,M,H,K,P,O,S,Q,R,aa,X){var T=k([aa,w],{declaredClass:"esri.dijit.Legend",widgetsInTemplate:!1,layers:null,alignRight:!1,hoverLabelShowing:!1,_preserveCacheOnDestroy:!1,dotDensitySwatchSize:26,dotCoverage:75,gradientHeight:30,transparencyRampColor:new l([64,64,64]),defaultText:"Aa",sizeRampLightColor:new l([255,255,255]),sizeRampDarkColor:new l([128,128,128]),layerConnects:[],gradientWidth:34,colorRampBorder:"1px solid",_specialChars:{lt:"\x3c",
gt:"\x3e"},_ieTimer:100,_isRightToLeft:!1,_align:null,_legendAlign:null,constructor:function(b,c){return a.mixin(this,X.widgets.legend),this._i18n=X.widgets.legend,b=b||{},b.map?c?(this.map=b.map,this.layerInfos=b.layerInfos,this._respectCurrentMapScale=!1===b.respectCurrentMapScale?!1:!0,this._respectVisibility=!1===b.respectVisibility?!1:!0,this._preserveCacheOnDestroy=b.preserveCacheOnDestroy?!0:!1,this.arrangement=b.arrangement===T.ALIGN_RIGHT?T.ALIGN_RIGHT:T.ALIGN_LEFT,this.arrangement===T.ALIGN_RIGHT&&
(this.alignRight=!0),this.autoUpdate=!1===b.autoUpdate?!1:!0,this._surfaceItems=[],this.hideLayersInLegend={},void(this.refresh=m(this.refresh,0))):void console.error("esri.dijit.Legend: must specify a container for the legend"):void console.error("esri.dijit.Legend: unable to find the 'map' property in parameters")},postMixInProperties:function(){this.inherited(arguments);var a,b,c=["ar","he"];for(a=0;a<c.length;a+=1)b=c[a],h.locale&&-1!==h.locale.indexOf(b)&&(-1!==h.locale.indexOf("-")?-1!==h.locale.indexOf(b+
"-")&&(this._isRightToLeft=!0):this._isRightToLeft=!0);this._isRightToLeft?(this._align=this.alignRight?"left":"right",this._legendAlign=this.alignRight?"esriLegendLeft":"esriLegendRight"):(this._align=this.alignRight?"right":"left",this._legendAlign=this.alignRight?"esriLegendRight":"esriLegendLeft")},startup:function(){this.inherited(arguments);this._initialize();9>g("ie")&&(this._repaintItems=a.hitch(this,this._repaintItems),setTimeout(this._repaintItems,this._ieTimer))},destroy:function(){this._deactivate();
this._removeCachedLegendResponses();this._removeHoverHandlers();this.inherited(arguments)},_removeCachedLegendResponses:function(){this._preserveCacheOnDestroy||f.forEach(this.layers,function(a){delete a.legendResponse})},refresh:function(a){if(this.domNode){a?(this.layerInfos=a,this.layers=[],f.forEach(this.layerInfos,function(a){this._isSupportedLayerType(a.layer)&&(a.title&&(a.layer._titleForLegend=a.title),a.layer._hideDefaultSymbol=!1===a.defaultSymbol?!0:!1,a.hideLayers?(this.hideLayersInLegend[a.layer.id]=
a.hideLayers,this._addSubLayersToHide(a)):this.hideLayersInLegend[a.layer.id]=[],a.hoverLabel&&(a.layer._hoverLabel=a.hoverLabel),a.hoverLabels&&(a.layer._hoverLabels=a.hoverLabels),this.layers.push(a.layer))},this)):this.useAllMapLayers&&(this.layerInfos=null,this.layers=null);for(a=this.domNode.children.length-1;0<=a;a--)r.destroy(this.domNode.children[a]);this._removeHoverHandlers();this.startup()}},_legendUrl:"http://utility.arcgis.com/sharing/tools/legend",_initialize:function(){if(this.layerInfos&&
(this.layers=[],f.forEach(this.layerInfos,function(a){this._isSupportedLayerType(a.layer)&&(a.title&&(a.layer._titleForLegend=a.title),a.layer._hideDefaultSymbol=!1===a.defaultSymbol?!0:!1,a.hideLayers?(this.hideLayersInLegend[a.layer.id]=a.hideLayers,this._addSubLayersToHide(a)):this.hideLayersInLegend[a.layer.id]=[],a.hoverLabel&&(a.layer._hoverLabel=a.hoverLabel),a.hoverLabels&&(a.layer._hoverLabels=a.hoverLabels),this.layers.push(a.layer))},this)),this.useAllMapLayers=!1,!this.layers){this.useAllMapLayers=
!0;this.layers=[];var a=[],b=[];f.forEach(this.map.layerIds,function(c){var d;c=this.map.getLayer(c);this._isSupportedLayerType(c)&&(c.arcgisProps&&c.arcgisProps.title&&(c._titleForLegend=c.arcgisProps.title),this.layers.push(c));"esri.layers.KMLLayer"==c.declaredClass&&(d=c.getLayers(),f.forEach(d,function(b){a.push(b.id)},this));"esri.layers.GeoRSSLayer"==c.declaredClass&&(d=c.getFeatureLayers(),f.forEach(d,function(a){b.push(a.id)},this))},this);f.forEach(this.map.graphicsLayerIds,function(c){var d=
this.map.getLayer(c);-1==f.indexOf(a,c)&&-1==f.indexOf(b,c)&&this._isSupportedLayerType(d)&&d._params&&d._params.drawMode&&(d.arcgisProps&&d.arcgisProps.title&&(d._titleForLegend=d.arcgisProps.title),this.layers.push(d))},this)}this._createLegend()},_activate:function(){this._deactivate();this.autoUpdate&&(this._respectCurrentMapScale&&(this._ozeConnect=b.connect(this.map,"onZoomEnd",this,"_refreshLayers")),this.useAllMapLayers&&(this._olaConnect=b.connect(this.map,"onLayerAdd",this,"_updateAllMapLayers"),
this._olrConnect=b.connect(this.map,"onLayerRemove",this,"_updateAllMapLayers"),this._olroConnect=b.connect(this.map,"onLayersReordered",this,"_updateAllMapLayers")),f.forEach(this.layers,function(c){var d={};d.ovcConnect=b.connect(c,"onVisibilityChange",this,"_refreshLayers");d.oocConnect=b.connect(c,"onOpacityChange",this,"_refreshLayers");d.oscConnect=b.connect(c,"onScaleRangeChange",this,"_refreshLayers");"esri.layers.ArcGISDynamicMapServiceLayer"===c.declaredClass&&c.supportsDynamicLayers&&(d.odcConnect=
b.connect(c,"_onDynamicLayersChange",a.hitch(this,"_updateDynamicLayers",c)));"esri.layers.ArcGISImageServiceLayer"===c.declaredClass&&(d.oirConnect=b.connect(c,"onRenderingChange",a.partial(this._updateImageServiceLayers,this,c)));"esri.layers.ArcGISImageServiceVectorLayer"===c.declaredClass&&(d.oivrConnect=b.connect(c,"onRendererChange",a.hitch(this,"_refreshLayers")));this.layerConnects[c.id]=d},this))},_deactivate:function(){this._ozeConnect&&b.disconnect(this._ozeConnect);this._olaConnect&&b.disconnect(this._olaConnect);
this._olroConnect&&b.disconnect(this._olroConnect);this._olrConnect&&b.disconnect(this._olrConnect);f.forEach(this.layers,function(a){a=this.layerConnects[a.id]||{};a.ovcConnect&&b.disconnect(a.ovcConnect);a.oocConnect&&b.disconnect(a.oocConnect);a.oscConnect&&b.disconnect(a.oscConnect);a.odcConnect&&b.disconnect(a.odcConnect);a.oirConnect&&b.disconnect(a.oirConnect);a.oivrConnect&&b.disconnect(a.oivrConnect)},this);this.layerConnects=[]},_updateDynamicLayers:function(a){delete a.legendResponse;this._refreshLayers()},
_updateImageServiceLayers:function(a,b){delete b.legendResponse;a._refreshLayers()},_refreshLayers:function(){this.refresh()},_updateAllMapLayers:function(){this.layers=[];f.forEach(this.map.layerIds,function(a){a=this.map.getLayer(a);this._isSupportedLayerType(a)&&this.layers.push(a)},this);f.forEach(this.map.graphicsLayerIds,function(a){a=this.map.getLayer(a);this._isSupportedLayerType(a)&&a._params&&a._params.drawMode&&this.layers.push(a)},this);this.refresh()},_createLegend:function(){var c=!1,
d=!1;v.set(this.domNode,"position","relative");r.create("div",{id:this.id+"_msg",className:"esriLegendMsg",innerHTML:this.NLS_creatingLegend+"..."},this.domNode);var e=[];f.forEach(this.layers,function(g){if("esri.layers.KMLLayer"==g.declaredClass||"esri.layers.GeoRSSLayer"==g.declaredClass){var l;g.loaded?("esri.layers.KMLLayer"==g.declaredClass?l=g.getLayers():"esri.layers.GeoRSSLayer"==g.declaredClass&&(l=g.getFeatureLayers(),this.hideLayersInLegend[g.id]&&(l=f.filter(l,function(a){return-1==f.indexOf(this.hideLayersInLegend[g.id],
a.id)},this))),f.forEach(l,function(a){"esri.layers.FeatureLayer"==a.declaredClass&&g._titleForLegend&&(a._titleForLegend=g._titleForLegend+" - ","esriGeometryPoint"==a.geometryType?a._titleForLegend+=this.NLS_points:"esriGeometryPolyline"==a.geometryType?a._titleForLegend+=this.NLS_lines:"esriGeometryPolygon"==a.geometryType&&(a._titleForLegend+=this.NLS_areas),e.push(a))},this)):b.connect(g,"onLoad",a.hitch(this,function(){this.refresh(this.layerInfos)}))}else if("esri.layers.WMSLayer"===g.declaredClass)if(g.loaded){if((!this._respectVisibility||
this._respectVisibility&&g.visible)&&0<g.layerInfos.length&&f.some(g.layerInfos,function(a){return a.legendURL})){var m=!1;f.forEach(g.layerInfos,function(b){if(b.legendURL&&-1<f.indexOf(g.visibleLayers,b.name)){m||(r.create("div",{innerHTML:"\x3cspan class\x3d'esriLegendServiceLabel'\x3e"+(g._titleForLegend||g.name||g.id)+"\x3c/span\x3e"},this.domNode),m=!0);var d;b=b.legendURL;if(g.customParameters||g.customLayerParameters){var e=a.clone(g.customParameters||{});a.mixin(e,g.customLayerParameters||
{});for(d in e)b+=(-1===b.indexOf("?")?"?":"\x26")+d+"\x3d"+e[d]}r.create("div",{innerHTML:"\x3cimg src\x3d'"+b+"'/\x3e"},this.domNode);c=!0}},this)}}else b.connect(g,"onLoad",a.hitch(this,function(){this.refresh(this.layerInfos)}));else"esri.layers.WFSLayer"!==g.declaredClass||g.renderer?e.push(g):(l=r.create("div",{id:this.id+"_"+g.id,"class":"esriLegendService"}),r.create("span",{innerHTML:this._getServiceTitle(g),"class":"esriLegendServiceLabel"},r.create("td",{align:this._align},r.create("tr",
{},r.create("tbody",{},r.create("table",{width:"95%"},l))))),r.place(l,this.id,"first"),tableNode=r.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},l),tableBody=r.create("tbody",{},tableNode),"esriGeometryComplex"===g.geometryType?(this._buildRow_Renderer(g,g._pointSymbol,null,this.NLS_points,null,tableBody),this._buildRow_Renderer(g,g._lineSymbol,null,this.NLS_lines,null,tableBody),this._buildRow_Renderer(g,g._polygonSymbol,null,this.NLS_areas,null,tableBody)):
"esriGeometryPoint"===g.geometryType?this._buildRow_Renderer(g,g._pointSymbol,null,"",null,tableBody):"esriGeometryPolyline"===g.geometryType?this._buildRow_Renderer(g,g._lineSymbol,null,"",null,tableBody):"esriGeometryPolygon"===g.geometryType&&this._buildRow_Renderer(g,g._polygonSymbol,null,"",null,tableBody),d=!0)},this);var g=[];(f.forEach(e,function(c){if(c.loaded){if((!this._respectVisibility||this._respectVisibility&&c.visible)&&(c.layerInfos||c.renderer||"esri.layers.ArcGISImageServiceLayer"==
c.declaredClass)){var d=r.create("div",{id:this.id+"_"+c.id,style:{display:"none"},"class":"esriLegendService"});if(r.create("span",{innerHTML:this._getServiceTitle(c),"class":"esriLegendServiceLabel"},r.create("td",{align:this._align},r.create("tr",{},r.create("tbody",{},r.create("table",{width:"95%"},d))))),r.place(d,this.id,"first"),c.legendResponse||c.renderer)this._createLegendForLayer(c);else{if(this.isHostedTileService(c))return void this._getLayerInfos(c).then(a.hitch(this,function(a){this._createLegendForLayer(a)}),
a.hitch(this,function(a){g.push(this._legendRequest(a))}));g.push(this._legendRequest(c))}}}else var e=b.connect(c,"onLoad",this,function(a){b.disconnect(e);e=null;this.refresh()})},this),0!==g.length||c||d)?(new n(g)).addCallback(a.hitch(this,function(a){c||d?t.byId(this.id+"_msg").innerHTML="":t.byId(this.id+"_msg").innerHTML=this.NLS_noLegend;this._activate()})):(t.byId(this.id+"_msg").innerHTML=this.NLS_noLegend,this._activate())},_createLegendForLayer:function(a){if(a.legendResponse||a.renderer||
this.isHostedTileService(a)){var b=!1;if(a.legendResponse||this.isHostedTileService(a)){var c=a.dynamicLayerInfos||a.layerInfos;c&&c.length?f.forEach(c,function(c,d){if(!this.hideLayersInLegend[a.id]||-1===f.indexOf(this.hideLayersInLegend[a.id],c.id)){var e=this._buildLegendItems(a,c,d);b=b||e}},this):"esri.layers.ArcGISImageServiceLayer"==a.declaredClass&&(b=this._buildLegendItems(a,{id:0,name:null,title:a.name,subLayerIds:null,parentLayerId:-1},0))}else a.renderer&&(c=a.url?a.url.substring(a.url.lastIndexOf("/")+
1,a.url.length):"fc_"+a.id,b=this._buildLegendItems(a,{id:c,name:null,subLayerIds:null,parentLayerId:-1},0));b&&(v.set(t.byId(this.id+"_"+a.id),"display","block"),v.set(t.byId(this.id+"_msg"),"display","none"))}},_legendRequest:function(c){return c.loaded?10.01<=c.version?this._legendRequestServer(c):this._legendRequestTools(c):void b.connect(c,"onLoad",a.hitch(this,"_legendRequest"))},_legendRequestServer:function(b){var c=b.url,d=c.indexOf("?");-1<d?c=c.substring(0,d)+"/legend"+c.substring(d):c+=
"/legend";(d=b._getToken())&&(c+="?token\x3d"+d);var e=a.hitch(this,"_processLegendResponse"),g={f:"json"};b._params.dynamicLayers&&(g.dynamicLayers=q.stringify(this._createDynamicLayers(b)),"[{}]"===g.dynamicLayers&&(g.dynamicLayers="[]"));b._params.bandIds&&(g.bandIds=b._params.bandIds);b._params.renderingRule?g.renderingRule=b._params.renderingRule:b.rasterFunctionInfos&&0<b.rasterFunctionInfos.length&&f.forEach(b.rasterFunctionInfos,function(a){a&&a.name&&"none"===a.name.toLowerCase()&&(g.renderingRule=
q.stringify({rasterFunction:a.name}))});return C({url:c,content:g,callbackParamName:"callback",load:function(a,c){e(b,a,c)},error:B.defaults.io.errorHandler})},_legendRequestTools:function(b){var c=b.url.toLowerCase().indexOf("/rest/"),c=b.url.substring(0,c)+b.url.substring(c+5,b.url.length),c=this._legendUrl+"?soapUrl\x3d"+window.escape(c);(!g("ie")||8<g("ie"))&&(c+="\x26returnbytes\x3dtrue");var d=a.hitch(this,"_processLegendResponse");return C({url:c,content:{f:"json"},callbackParamName:"callback",
load:function(a,c){d(b,a,c)},error:B.defaults.io.errorHandler})},_processLegendResponse:function(a,b){b&&b.layers&&(a.legendResponse=b,t.byId(this.id+"_"+a.id)&&r.empty(t.byId(this.id+"_"+a.id)),r.create("span",{innerHTML:this._getServiceTitle(a),"class":"esriLegendServiceLabel"},r.create("td",{align:this._align},r.create("tr",{},r.create("tbody",{},r.create("table",{width:"95%"},t.byId(this.id+"_"+a.id)))))),this._createLegendForLayer(a))},_buildLegendItems:function(a,b,c){var d=!1,e=t.byId(this.id+
"_"+a.id),g=b.parentLayerId;if(b.subLayerIds)a=r.create("div",{id:this.id+"_"+a.id+"_"+b.id+"_group",style:{display:"none"},"class":-1==g?0<c?"esriLegendGroupLayer":"":this._legendAlign},-1==g?e:t.byId(this.id+"_"+a.id+"_"+g+"_group")),r.create("td",{innerHTML:A.encode(b.name),align:this._align},r.create("tr",{},r.create("tbody",{},r.create("table",{width:"95%","class":"esriLegendLayerLabel"},a))));else{if(this._respectVisibility&&a.visibleLayers)if(c=a.dynamicLayerInfos||a.layerInfos)if(a._params&&
a._params.layers){if(-1===f.indexOf(a.visibleLayers,b.id))return d}else{if(c=this._getReallyVisibleLayers(c,a.visibleLayers),-1===f.indexOf(c,b.id))return d}else if(-1===f.indexOf(a.visibleLayers,b.id))return d;e=r.create("div",{id:this.id+"_"+a.id+"_"+b.id,style:{display:"none"},"class":-1<g?this._legendAlign:""},-1==g?e:t.byId(this.id+"_"+a.id+"_"+g+"_group"));r.create("td",{innerHTML:A.encode(b.name)||"",align:this._align},r.create("tr",{},r.create("tbody",{},r.create("table",{width:"95%","class":"esriLegendLayerLabel"},
e))));c=a.dynamicLayerInfos||a.layerInfos;g=!1;c&&c.length&&(g=f.some(c,function(a){return!!a.drawingInfo}));a.legendResponse?d=d||this._buildLegendItems_Tools(a,b,e):(a.renderer||g)&&(d=d||this._buildLegendItems_Renderer(a,b,e))}return d},_getReallyVisibleLayers:function(a,b){if(!a||!b||!b.length)return[];var c,d=[],e=[];for(c=0;c<a.length;c++)a[c].subLayerIds?(-1===f.indexOf(b,a[c].id)||-1<f.indexOf(e,a[c].id))&&(e=e.concat(a[c].subLayerIds)):-1<f.indexOf(b,a[c].id)&&-1===f.indexOf(e,a[c].id)&&
d.push(a[c].id);return d},_buildLegendItems_Tools:function(a,b,c){var d=b.parentLayerId,e=this.map.getScale(),g=!1,l=function(a,b){var c,d;for(c=0;c<a.length;c++)if(b.dynamicLayerInfos)for(d=0;d<b.dynamicLayerInfos[d].length;d++){if(b.dynamicLayerInfos[d].mapLayerId==a[c].layerId)return a[c]}else if(b.id==a[c].layerId)return a[c];return{}};if(!this._respectCurrentMapScale||this._respectCurrentMapScale&&this._isLayerInScale(a,b,e)){var m=!0;if(this._respectCurrentMapScale&&("esri.layers.ArcGISDynamicMapServiceLayer"===
a.declaredClass||"esri.layers.ArcGISMapServiceLayer"===a.declaredClass)){var h=this._getEffectiveScale(a,b);(h.minScale&&h.minScale<e||h.maxScale&&h.maxScale>e)&&(m=!1)}if(m){var e=l(a.legendResponse.layers,b),n=e.legendType,k=e.layerType,q=e.legend;if(q){"esri.layers.ArcGISImageServiceLayer"!==a.declaredClass&&this._sanitizeLegendResponse(a,e,b);c=r.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c);var u=r.create("tbody",{},c);(a._hoverLabel||a._hoverLabels)&&
this._createHoverAction(c,a,b);f.forEach(q,function(c){10.1<=a.version&&!c.values&&1<q.length&&(a._hideDefaultSymbol||"\x3call other values\x3e"===c.label||!(c.label||"esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&10.3<=a.version||"Raster Layer"===k))||(c.url&&0===c.url.indexOf("http")||c.imageData&&0<c.imageData.length)&&(g=!0,this._buildRow_Tools(c,u,a,b.id,n))},this)}}}return g&&(v.set(t.byId(this.id+"_"+a.id+"_"+b.id),"display","block"),-1<d&&(v.set(t.byId(this.id+"_"+a.id+"_"+d+"_group"),
"display","block"),this._findParentGroup(a.id,a,d))),g},_getLayerInfos:function(a){var b=new c,d=a.dynamicLayerInfos||a.layerInfos;if(d&&d.length)if(f.some(d,function(a){return!!a.drawingInfo}))b.resolve(a);else{var e=a.url,g=e.indexOf("?");-1==g?e+="/layers":e=e.substring(0,g)+"/layers"+e.substring(g,e.length);C({url:e,content:{f:"json"},callbackParamName:"callback",load:function(c,e){c.layers?(f.forEach(d,function(a){var b=f.filter(c.layers,function(b){return a.source?b.id===a.source.mapLayerId:
b.id===a.id});b&&b[0]&&b[0].drawingInfo&&(a.drawingInfo=b[0].drawingInfo,a.fields=b[0].fields)}),b.resolve(a)):b.reject(a)},error:function(c){b.reject(a)}})}return b},_sanitizeLegendResponse:function(b,c,d){var e=c.legend;if(10.1<=b.version&&1<e.length&&!c._sanitized){var g,l;(b=a.getObject("layerDefinition.drawingInfo.renderer",!1,d))||(b=a.getObject("drawingInfo.renderer",!1,d));f.some(e,function(a){return a.values?!0:void 0})&&f.some(e,function(a,b){return a.values||(l=b,g=a),!!g});b?"uniqueValue"===
b.type?g&&(e.splice(l,1),e.push(g)):"classBreaks"===b.type&&(g&&e.splice(l,1),e.reverse(),g&&e.push(g)):g&&(e.splice(l,1),e.push(g));c._sanitized=!0}},_buildRow_Tools:function(a,b,c,d,e){var f,l;b=r.create("tr",{},b);this.alignRight?(f=r.create("td",{align:this._isRightToLeft?"left":"right"},b),l=r.create("td",{align:this._isRightToLeft?"left":"right",width:35},b)):(l=r.create("td",{width:35,align:"center"},b),f=r.create("td",{},b));b=a.url;(!g("ie")||9<=g("ie")||9>g("ie")&&"esri.layers.ArcGISImageServiceLayer"===
c.declaredClass)&&a.imageData&&0<a.imageData.length?b="data:image/png;base64,"+a.imageData:0!==a.url.indexOf("http")&&(b=c.url+"/"+d+"/images/"+a.url,(d=c._getToken())&&(b+="?token\x3d"+d));l=r.create("img",{src:b,border:0,style:"opacity:"+c.opacity},l);a=r.create("td",{innerHTML:A.encode(a.label),align:this._align},r.create("tr",{},r.create("tbody",{},r.create("table",{width:"95%",dir:"ltr"},f))));e&&"Stretched"===e&&10.3<=c.version&&"esri.layers.ArcGISImageServiceLayer"===c.declaredClass&&(a.style.verticalAlign=
"top",a.style.lineHeight="1",l.style.marginBottom="-1px",l.style.display="block",f.style.verticalAlign="top");9>g("ie")&&(l.style.filter="alpha(opacity\x3d"+100*c.opacity+")")},_getVariable:function(a,b,c){var d,e;return a&&(d=a.getVisualVariablesForType(b,c),e=d&&d[0]),e},_getVariables:function(a,b,c){a=[this._getVariable(a,"colorInfo",!1),this._getVariable(a,"opacityInfo",!1),this._getVariable(a,"sizeInfo",!1)];return b?f.filter(a,function(a){return!(!a||a.field!==b||a.normalizationField!=c)}):
a},_getFieldAlias:function(b,c,d){var e=c.infoTemplate,e=e&&e.getFieldInfo&&e.getFieldInfo(b);b=a.isFunction(b)?null:this.getField(c,b,d);c=e||b;d="";return c&&(d=e&&e.label||b&&b.alias||c.name||c.fieldName),d},_getRampTitle:function(b,c,d){var e,f=b.field,g=b.normalizationField,l=!1,m=!1,h=!1;if(f=a.isFunction(f)?null:f,g=a.isFunction(g)?null:g,b.legendOptions&&b.legendOptions.title)e=b.legendOptions.title;else if(b.valueExpressionTitle)e=b.valueExpressionTitle;else{if(c.renderer&&c.renderer.authoringInfo&&
c.renderer.authoringInfo.visualVariables){var n=c.renderer.authoringInfo.visualVariables;for(b=0;b<n.length;b++){var k=n[b];if("colorInfo"===k.type&&"ratio"===k.style){l=!0;break}if("colorInfo"===k.type&&"percent"===k.style){m=!0;break}if("colorInfo"===k.type&&"percentTotal"===k.style){h=!0;break}}}(l=h&&"showRatioPercentTotal"||m&&"showRatioPercent"||l&&"showRatio"||g&&"showNormField"||f&&"showField"||null)&&(e=D.substitute({field:f&&this._getFieldAlias(f,c,d),normField:g&&this._getFieldAlias(g,
c,d)},this._i18n[l]))}return e},_getRendererTitle:function(b,c,d){var e;if(b){var f,g,l,m;b instanceof J&&(f=b.attributeField,g=b.normalizationField,l="percent-of-total"===b.normalizationType);f=a.isFunction(f)?null:f;g=a.isFunction(g)?null:g;b.legendOptions&&b.legendOptions.title?e=b.legendOptions.title:b.valueExpressionTitle?e=b.valueExpressionTitle:(m=g&&"showNormField"||(l?"showNormPct":null)||f&&"showField"||null,m&&(e=D.substitute({field:f&&this._getFieldAlias(f,c,d),normField:g&&this._getFieldAlias(g,
c,d)},this._i18n[m])))}return e},_buildLegendItems_Renderer:function(b,c,d){var e,g=c.parentLayerId,l=this.map,m=l.getScale(),h=!1;if(!this._respectCurrentMapScale||this._isLayerInScale(b,c,m)){var n,k,q,u,w,x,C,z,y;if(q="esri.layers.ArcGISImageServiceVectorLayer"===b.declaredClass?b.renderer.renderer:c&&c.drawingInfo?R.fromJson(a.clone(c.drawingInfo.renderer)):b.renderer,q instanceof L&&(u="zoom"===q.rangeType?q.getRendererInfoByZoom(l.getZoom()):q.getRendererInfoByScale(m),q=u&&u.renderer,!q))return!1;
var D,B,E,F,V;u=this._getVariables(q);var O=f.filter(u,function(a){return!!a}).length,m=u[0],l=u[1];u=u[2];if(m&&(w=this._getMedianColor(q,m),m.field&&(C=a.isFunction(m.field)?null:this.getField(b,m.field,c)),D=!(m.legendOptions&&!1===m.legendOptions.showLegend)),l&&(l.field&&(y=a.isFunction(l.field)?null:this.getField(b,l.field,c)),B=!(l.legendOptions&&!1===l.legendOptions.showLegend)),u&&(u.field&&(z=a.isFunction(u.field)?null:this.getField(b,u.field,c)),E=!(u.legendOptions&&!1===u.legendOptions.showLegend)),
q instanceof P)e=h=!0,this._showHeatRamp(b,c,q,d);else if(q instanceof M)e=h=!0,this._showDotDensityLegend(b,c,q,d);else if(q instanceof H)e=h=!0,k=r.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d),n=r.create("tbody",{},k),(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(k,b,c),q.latestObservationRenderer&&q.latestObservationRenderer instanceof G&&this._buildRow_Renderer(b,q.latestObservationRenderer.symbol,w,A.encode(q.latestObservationRenderer.label)||
this.NLS_currentObservations,null,n),q.observationRenderer&&q.observationRenderer instanceof G&&this._buildRow_Renderer(b,q.observationRenderer.symbol,w,A.encode(q.observationRenderer.label)||this.NLS_previousObservations,null,n);else if(q instanceof I){if(q.infos&&0<q.infos.length){if(e=h=!0,q.legendOptions&&q.legendOptions.title||q.valueExpressionTitle)k=r.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d),n=r.create("tbody",{},k),O=q.legendOptions&&q.legendOptions.title?
q.legendOptions.title:q.valueExpressionTitle,this._buildRow_Renderer(b,null,w,A.encode(O),null,n);k=r.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d);n=r.create("tbody",{},k);(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(k,b,c);q.attributeField&&u&&this._addSubHeader(n,this._getFieldAlias(q.attributeField,b,c));var da=[];f.forEach(q.infos,function(a){var c=null;b._editable&&b.types&&(c=this._getTemplateFromTypes(b.types,a.value));var d=a.label;null==
d&&(d=a.value);-1===f.indexOf(da,d)&&(da.push(d),this._buildRow_Renderer(b,a.symbol,w,A.encode(d),c,n))},this)}V=this._displayDefaultSymbol(b,q,d)}else if(q instanceof J){if(q.infos&&0<q.infos.length||"esri.layers.ArcGISImageServiceVectorLayer"===b.declaredClass)(e=h=!0,F=this._isUnclassedRenderer(q),m||1!==q.infos.length)||(x=(x=q.infos[0])&&x.symbol),F||(k=r.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d),n=r.create("tbody",{},k),O=this._getRendererTitle(q,
b,c),this._buildRow_Renderer(b,null,w,A.encode(O),null,n)),k=r.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d),n=r.create("tbody",{},k),(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(k,b,c),F&&u&&E||(O=q.infos.slice(0).reverse(),f.forEach(O,function(a){var c=a.label;null!=c||F||(c=a.minValue+" - "+a.maxValue);this._buildRow_Renderer(b,a.symbol,w,A.encode(c),null,n)},this)),"esri.layers.ArcGISImageServiceVectorLayer"!==b.declaredClass||b.renderer.style!==
K.STYLE_SCALAR&&b.renderer.style!==K.STYLE_SINGLE_ARROW||(this._buildRow_Renderer(b,q.defaultSymbol,null,"",null,n),b._hideDefaultSymbol=!0);F||(V=this._displayDefaultSymbol(b,q,d))}else q instanceof G&&(e=h=!0,k=r.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d),n=r.create("tbody",{},k),(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(k,b,c),x=null,b._editable&&b.templates&&0<b.templates.length&&(x=b.templates[0]),k=1<O?null:C&&D||y&&B||z&&E,this._buildRow_Renderer(b,
q.symbol,w,A.encode(k?this._getRampTitle(1<O?null:m||l||u,b,c):q.label),x,n),x=m?null:q.symbol,k&&(C=y=z=null));if(e){var S;if(m&&D&&(m.field||m.valueExpression)&&(S=u&&E?!0:!1,this._showGradientRamp(b,c,q,null,d,m,C,null,S)),u&&E&&(u.field||u.valueExpression)&&(S=m&&D||q instanceof I?!1:!0,this._showSizeLegend(b,c,q,u,w,d,z,null,S)),l&&B&&(l.field||l.valueExpression))e=x&&!x.url&&x.color?x.color:this.transparencyRampColor,this._showGradientRamp(b,c,q,e,d,l,y,null,!1)}V||F&&!D&&!E&&!B||(V=this._displayDefaultSymbol(b,
q,d));h=h||V}return h&&(v.set(t.byId(this.id+"_"+b.id+"_"+c.id),"display","block"),-1<g&&(v.set(t.byId(this.id+"_"+b.id+"_"+g+"_group"),"display","block"),this._findParentGroup(b.id,g))),h},_isUnclassedRenderer:function(a,b){var c;if(a instanceof J&&a.infos&&1===a.infos.length){c=a.attributeField;var d=a.normalizationField;c=b?c===b:!!this._getVariables(a,c,d).length}return c},_displayDefaultSymbol:function(a,b,c){var d;!a._hideDefaultSymbol&&b.defaultSymbol&&(d=!0,c=r.create("table",{cellpadding:0,
cellspacing:0,width:"95%","class":"esriLegendLayer"},c),c=r.create("tbody",{},c),this._buildRow_Renderer(a,b.defaultSymbol,null,A.encode(b.defaultLabel)||"others",null,c));return d},_showGradientRamp:function(b,c,d,e,f,g,l,m,h){h=r.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"+(h?"":" esriLegendSubFragment")},f);f=r.create("tbody",{},h);(b._hoverLabel||b._hoverLabels||m)&&this._createHoverAction(h,b,c,m);(l||g.valueExpression)&&this._addSubHeader(f,this._getRampTitle(g,
b,c));var n;(l=g.field)&&(n=a.isFunction(l)?null:this.getField(b,l,c));(c=this._getRampStops(d,g,e,n&&"esriFieldTypeDate"===n.type))&&c.length&&this._drawGradientRamp(f,c,!0,b,this._getRampBorderColor(d),!!e)},_getMedianColor:function(a,b){var c,d;b.colors?(c=b.minDataValue,d=b.maxDataValue):b.stops&&(c=b.stops[0].value,d=b.stops[b.stops.length-1].value);return a.getColor(c+(d-c)/2,{colorInfo:b})},_getRampStops:function(a,b,c,d){var e,g,m,h,n,k=!1;b.colors||b.opacityValues?(m=b.maxDataValue-b.minDataValue,
e=f.map([0,.25,.5,.75,1],function(a){return h=b.minDataValue+a*m,Number(h.toFixed(6))}),this._checkPrecision(0,4,e)):b.stops&&(e=f.map(b.stops,function(a){return a.value}),k=f.some(b.stops,function(a){return!!a.label}),k&&(n=f.map(b.stops,function(a){return a.label})));var q,r,t=e[0];return m=e[e.length-1]-t,g=f.map(e,function(f,g){c?(q=new l(c.toRgba()),r=a.getOpacity(f,{opacityInfo:b}),null!=r&&(q.a=r)):q=a.getColor(f,{colorInfo:b});var h="";if(k)h=n[g];else{var h=d?F.formatDate(f,F.timelineDateFormatOptions):
E.format(f),v="";0===g?v=this._specialChars.lt+" ":g===e.length-1&&(v=this._specialChars.gt+" ");h=v+h}return{value:f,color:q,offset:1-(f-t)/m,label:h}},this),g.reverse()},_checkPrecision:function(a,b,c){var d=a+(b-a)/2,e=c[a],f=c[d],g=c[b],l=Math.floor(e),m=Math.floor(f),h=Math.floor(g);l===e&&h===g&&m!==f&&l!==m&&h!==m&&(c[d]=m);a+1!==d&&this._checkPrecision(a,d,c);d+1!==b&&this._checkPrecision(d,b,c)},_getRampBorderColor:function(a){var b,c;return a instanceof G?b=a.symbol:(a instanceof I||a instanceof
J)&&(b=a.infos[0].symbol),c=b&&-1===b.type.indexOf("linesymbol")?b.getStroke():null,c&&c.color},_drawGradientRamp:function(a,b,c,d,e,m){var h,n,k,q,t,u,w,C,z=r.create("tr",{},a),y=b.length-1;a=0;this.alignRight?(h=r.create("td",{align:this._isRightToLeft?"left":"right"},z),n=r.create("td",{align:this._isRightToLeft?"left":"right",width:this.gradientWidth},z)):(n=r.create("td",{width:this.gradientWidth,align:"center"},z),h=r.create("td",{},z));z=e&&0<e.a&&!(240<=e.r&&240<=e.g&&240<=e.b);k=r.create("div",
{"class":z?"":"esriLegendBorderLessColorRamp",style:"position: relative; width:"+this.gradientWidth+"px;"},n);n=r.create("div",{"class":"esriLegendColorRamp"+(m?" esriLegendTransparencyRamp":"")},k);m=v.get(n,"width");z&&(e=9>g("ie")?e.toHex():"rgba("+e.toRgba().join(",")+")",v.set(n,"border",this.colorRampBorder+" "+e));c?(w=this.gradientHeight*y,v.set(n,"height",w+"px")):w=v.get(n,"height");v.set(k,"height",w+"px");e=x.createSurface(n,m,w);9>g("ie")&&(t=e.getEventSource(),v.set(t,"position","relative"),
v.set(t.parentNode,"position","relative"),a=1);try{c&&f.forEach(b,function(a,b){a.offset=b/y}),u=e.createRect({x:-a,y:-a,width:m+a,height:w+a}),u.setFill({type:"linear",x1:0,y1:0,x2:0,y2:w,colors:b}).setStroke(null),e.createRect({width:m,height:w}).setFill(new l([255,255,255,1-d.opacity])).setStroke(null),this._surfaceItems.push(e)}catch(xa){e.clear(),e.destroy()}f.forEach(b,function(a,c){if(a.label){C="top:"+100*a.offset+"%;";var d="";0===c&&(d+=" esriLegendColorRampTickFirst");c===b.length-1&&(d+=
" esriLegendColorRampTickLast");r.create("div",{"class":"esriLegendColorRampTick"+d,innerHTML:"\x26nbsp;",style:C},k)}});q=r.create("div",{"class":"esriLegendColorRampLabels",style:{height:w+this.gradientHeight+"px"}},h);c?f.forEach(b,function(a){r.create("div",{"class":"esriLegendColorRampLabel",innerHTML:A.encode(a.label)||"\x26nbsp;"},q)}):(r.create("div",{"class":"esriLegendColorRampLabel",innerHTML:this._i18n.high},q),r.create("div",{"class":"esriLegendColorRampLabel",innerHTML:this._i18n.low,
style:"top: "+(w+this.gradientHeight-2*this.gradientHeight)+"px;"},q))},_showHeatRamp:function(a,b,c,d,e){var f,g=c.field;f=r.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d);d=r.create("tbody",{},f);(a._hoverLabel||a._hoverLabels||e)&&this._createHoverAction(f,a,b,e);(g=g&&this.getField(a,g,b))&&this._addSubHeader(d,this._getFieldAlias(g.name,a,b));b=this._getHeatmapStops(c);b.length&&this._drawGradientRamp(d,b,!1,a)},_getHeatmapStops:function(a){var b,c,d,e,
g=a.colorStops;a=a.colors;g&&g[0]?(b=g.length-1,g[0]&&null!=g[0].ratio)?(a=g[b])&&1!==a.ratio&&(g=g.slice(0),g.push({ratio:1,color:a.color}),b++):(c=g[0].value,d=g[b].value-c,g=f.map(g,function(a){return{color:a.color,ratio:(a.value-c)/d}})):a&&a[0]&&(b=a.length-1,e=1/(a.length-1),g=f.map(a,function(a,b){return{color:a,ratio:b*e}}));return g=f.map(g,function(a,c){var d="";return 0===c?d="Low":c===b&&(d="High"),{color:a.color,label:d,offset:1-a.ratio}}),g.reverse()},_showDotDensityLegend:function(b,
c,d,e){var g,l,m,h,n,k,q,t=d.legendOptions,v=this.dotDensitySwatchSize,u=Math.round(v/2);t&&(l=t.backgroundColor,m=t.outline,h=t.valueUnit,n=t.dotCoverage);n=(n||this.dotCoverage)/100;q=Math.round(v*v/Math.pow(d.dotSize,2)*n);e=r.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},e);k=r.create("tbody",{},e);(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(e,b,c);this._addSubHeader(k,D.substitute({value:d.dotValue,unit:h||""},this.NLS_dotValue));f.forEach(d.fields,
function(e){e=a.mixin({},e);e.numPoints=q;g=new O(d._generateImageSrc(v,v,[e],{x:0,y:0},{x:v,y:v},l),m||d.outline,v,v);e=this.getField(b,e.name,c)||e;this._buildRow_Renderer(b,g,null,A.encode(this._getFieldAlias(e.name,b,c)),null,k,{type:"path",path:"M "+-u+","+-u+" L "+u+","+-u+" L "+u+","+u+" L "+-u+","+u+" L "+-u+","+-u+" E"})},this)},_showSizeLegend:function(b,c,d,e,f,g,l,m,h){var n;n=(n=e.legendOptions)&&n.customValues;f=this._getSizeSymbol(d,f);if((!e.valueUnit||"unknown"===e.valueUnit)&&f&&
(n||null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue||e.stops&&!(1>=e.stops.length))){h=r.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"+(h?"":" esriLegendSubFragment")},g);g=r.create("tbody",{},h);(b._hoverLabel||b._hoverLabels||m)&&this._createHoverAction(h,b,c,m);(l||e.valueExpression)&&this._addSubHeader(g,this._getRampTitle(e,b,c));var k;(l=e.field)&&(k=a.isFunction(l)?null:this.getField(b,l,c));c=k&&"esriFieldTypeDate"===k.type;
n=n||this._getDataValues(d,f,e,c);for(k=h=n.length-1;0<=k;k--)l=n[k],f=Q.fromJson(f.toJson()),this._applySize(f,d,e,l),l=c?F.formatDate(l,F.timelineDateFormatOptions):E.format(l),m="",k===h?m=this._specialChars.gt+" ":0===k&&(m=this._specialChars.lt+" "),m="\x3cspan class\x3d'esriLegendSizeRampLabel'\x3e"+A.encode(m+l)+"\x3c/span\x3e",this._buildRow_Renderer(b,f,null,m,null,g)}},_getSizeSymbol:function(a,b){var c,d;if(a instanceof G?c=a.symbol:a instanceof K?c=a.defaultSymbol:(a instanceof I||a instanceof
J)&&(c=a.infos[0].symbol,d=1<a.infos.length),c=c&&-1!==c.type.indexOf("fillsymbol")?null:c,c&&(c=Q.fromJson(c.toJson()),b||d))if(-1!==c.type.indexOf("linesymbol"))c.setColor(new l(this.sizeRampDarkColor));else if(c.setColor(new l(this.sizeRampLightColor)),c.setOutline)d=new S,d.setColor(new l(this.sizeRampDarkColor)),d.setWidth(1.5),c.setOutline(d);return c},_getDataValues:function(a,b,c,d,e,g){e=null==e?5:e;g=null==g?20:g;var l=a.getSizeRangeAtScale(c,this.map.getScale());e=this._interpolateSizeRange(l,
e);var m=this._getDataRange(c),h=f.map(e,function(a){return this._getDataValueFromSize(a,m,l)},this);if(!d){var n,h=E.round(h);for(d=1;d<h.length-1;d++)(n=this._roundDataValue(a,b,c,h[d],h[d-1],g))&&(h[d]=n[0],e[d]=n[1])}return h},_getDataRange:function(a){var b=a.stops;return b?{min:b[0].value,max:b[b.length-1].value}:{min:a.minDataValue,max:a.maxDataValue}},_interpolateSizeRange:function(a,b){var c,d=a.minSize,e=(a.maxSize-d)/(b-1),f=[];for(c=0;b>c;c++)f.push(d+e*c);return f},_getDataValueFromSize:function(a,
b,c){var d,e,f=c.minSize;c=c.maxSize;var g=b.min;b=b.max;return f>=a?e=g:a>=c?e=b:(d=(a-f)/(c-f),e=d*(b-g)+g),e},_roundDataValue:function(a,b,c,d,e,f){var g,l,m,h,n,k,q,r,t,v,u,w,x,C,z,y=this._getSize(b,a,c,d);e=this._getSize(b,a,c,e);var D=E.getDigits(d);l=D.integer;D=D.fractional;0<d&&1>d&&(g=Math.pow(10,D),d*=g,l=E.getDigits(d).integer);for(--l;0<=l&&(m=Math.pow(10,l),h=Math.floor(d/m)*m,n=Math.ceil(d/m)*m,null!=g&&(h/=g,n/=g),k=(h+n)/2,k=E.round([h,k,n],{indexes:[1]})[1],q=this._getSize(b,a,c,
h),r=this._getSize(b,a,c,n),t=this._getSize(b,a,c,k),v=E.getPctChange(y,q,e,null),u=E.getPctChange(y,r,e,null),w=E.getPctChange(y,t,e,null),x=v.prev<=f,C=u.prev<=f,x&&C&&(v.prev<=u.prev?(x=!0,C=!1):(C=!0,x=!1)),x?z=[h,q]:C?z=[n,r]:w.prev<=f&&(z=[k,t]),!z);l--);return z},_applySize:function(a,b,c,d){var e;e=a.type;b=this._getSize(a,b,c,d);switch(e){case "simplemarkersymbol":a.setSize(b);break;case "picturemarkersymbol":e=a.width;c=a.height;a.setHeight(b);a.setWidth(e/c*b);break;case "simplelinesymbol":case "cartographiclinesymbol":a.setWidth(b);
break;case "textsymbol":a.font&&a.font.setSize(b)}},_getSize:function(a,b,c,d){return b.getSize(d,{sizeInfo:c,scale:this.map.getScale(),shape:-1!==a.type.indexOf("markersymbol")?a.style:null})},_buildRow_Renderer:function(a,b,c,d,e,f,g){var l,m;f=r.create("tr",{},f);this.alignRight?(l=r.create("td",{align:this._isRightToLeft?"left":"right"},f),b&&(m=r.create("td",{align:this._isRightToLeft?"left":"right",width:35},f))):(b&&(m=r.create("td",{width:35,align:"center"},f)),l=r.create("td",{},f));var h,
n=f=30;if(b){if("simplemarkersymbol"==b.type)f=Math.min(Math.max(f,b.size+12),125),n=Math.min(Math.max(n,b.size+12),125);else if("picturemarkersymbol"==b.type)f=Math.min(Math.max(f,b.width),125),n=Math.min(b.height||n,125);else if("textsymbol"==b.type){var k,q;b.text||(k=b.text,q=!0,b.setText(this.defaultText));f=Math.min(Math.max(f,b.getWidth()+12),125);n=Math.min(Math.max(n,b.getHeight()+12),125);q&&b.setText(k)}h=r.create("div",{style:"width:"+f+"px;height:"+n+"px;"},m)}if(D.isDefined(d)&&"number"==
typeof d&&(d=""+d),r.create("td",{innerHTML:d||"",align:this._align},r.create("tr",{},r.create("tbody",{},r.create("table",{width:"95%"},l)))),b)a=this._drawSymbol(h,b,c,f,n,e,a,g),this._surfaceItems.push(a)},_addSubHeader:function(a,b){var c=r.create("tr",{},a),c=r.create("td",{align:this._align,colspan:2},c);r.create("td",{innerHTML:A.encode(b)||"",align:this._align},r.create("tr",{},r.create("tbody",{},r.create("table",{width:"95%"},c))))},_drawSymbol:function(b,c,d,e,f,m,h,n){var k;c=Q.fromJson(c.toJson());
var q=h.opacity;if(d&&c.setColor(new l(d.toRgba())),"simplelinesymbol"===c.type||"cartographiclinesymbol"===c.type||"textsymbol"===c.type){if(!c.color)return;k=c.color.toRgba();k[3]*=q;c.color.setColor(k)}else"simplemarkersymbol"===c.type||"simplefillsymbol"===c.type?(c.color&&(k=c.color.toRgba(),k[3]*=q,c.color.setColor(k)),c.outline&&c.outline.color&&(k=c.outline.color.toRgba(),k[3]*=q,c.outline.color.setColor(k))):"picturemarkersymbol"===c.type&&(b.style.opacity=q,b.style.filter="alpha(opacity\x3d("+
100*q+"))");var r;b=x.createSurface(b,e,f);9>g("ie")&&(r=b.getEventSource(),v.set(r,"position","relative"),v.set(r.parentNode,"position","relative"));var t;m=this._getDrawingToolShape(c,m)||Q.getShapeDescriptors(c);d=(r=m.defaultShape)&&"text"===r.type;try{d&&!r.text&&(r.text=this.defaultText),t=b.createShape(n||r).setFill(m.fill).setStroke(m.stroke),d&&t.setFont(m.font)}catch(za){return b.clear(),void b.destroy()}k=t.getBoundingBox();n=k.width;m=k.height;d=-(k.x+n/2);q=-(k.y+m/2);r=b.getDimensions();
d={dx:d+r.width/2,dy:q+r.height/2};if("simplemarkersymbol"===c.type&&"path"===c.style)e=h._getScaleMatrix(k,c.size),t.applyTransform(y.scaleAt(e.xx,e.yy,{x:r.width/2,y:r.height/2}));else if(n>e||m>f)h=n/e>m/f,e=((h?e:f)-5)/(h?n:m),a.mixin(d,{xx:e,yy:e});return t.applyTransform(d),b},_getDrawingToolShape:function(a,b){var c;switch(b?b.drawingTool||null:null){case "esriFeatureEditToolArrow":c={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 Z"};break;case "esriFeatureEditToolTriangle":c=
{type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 Z"};break;case "esriFeatureEditToolRectangle":c={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"};break;case "esriFeatureEditToolCircle":c={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":c={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;default:return null}return{defaultShape:c,fill:a.getFill(),stroke:a.getStroke()}},_repaintItems:function(){f.forEach(this._surfaceItems,function(a){this._repaint(a)},this)},
_repaint:function(b){if(b){b.getStroke&&b.setStroke&&b.setStroke(b.getStroke());try{b.getFill&&b.setFill&&b.setFill(b.getFill())}catch(da){}b.children&&a.isArray(b.children)&&f.forEach(b.children,this._repaint,this)}},_createHoverAction:function(c,d,e,f){(f=d._hoverLabel||d._hoverLabels&&d._hoverLabels[e.id]||f)&&(f=A.encode(f),d.mouseMoveHandler=d.mouseMoveHandler||{},d.mouseMoveHandler[e.id]=b.connect(c,"onmousemove",a.hitch(this,function(b,c){this.mouseX=c.clientX;this.mouseY=c.clientY;this.hoverLabelShowing&&
(this.hoverLabelShowing=!1,v.set(t.byId(this.id+"_hoverLabel"),"display","none"));setTimeout(a.hitch(this,function(a,b,c){if(a==this.mouseX&&b==this.mouseY&&!this.hoverLabelShowing)if(this.hoverLabelShowing=!0,t.byId(this.id+"_hoverLabel")){var d=t.byId(this.id+"_hoverLabel");d.innerHTML="\x3cspan\x3e"+c+"\x3c/span\x3e";v.set(d,"top",b+"px");v.set(d,"left",a+15+"px");v.set(d,"display","")}else r.create("div",{innerHTML:"\x3cspan\x3e"+c+"\x3c/span\x3e",id:this.id+"_hoverLabel","class":"esriLegendHoverLabel",
style:{top:b+"px",left:a+15+"px"}},document.body)},c.clientX,c.clientY,b),500)},f)),d.mouseOutHandler=d.mouseOutHandler||{},d.mouseOutHandler[e.id]=b.connect(c,"onmouseout",a.hitch(this,function(a){this.mouseY=this.mouseX=-1;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,v.set(t.byId(this.id+"_hoverLabel"),"display","none"))})))},_removeHoverHandlers:function(){var a;f.forEach(this.layers,function(c){if(c.mouseMoveHandler)for(a in c.mouseMoveHandler)b.disconnect(c.mouseMoveHandler[a]);if(c.mouseOutHandler)for(a in c.mouseOutHandler)b.disconnect(c.mouseOutHandler[a])})},
_createDynamicLayers:function(a){var b,c=[];return f.forEach(a.dynamicLayerInfos||a.layerInfos,function(d){b={id:d.id};b.source=d.source&&d.source.toJson();var e;a.layerDefinitions&&a.layerDefinitions[d.id]&&(e=a.layerDefinitions[d.id]);e&&(b.definitionExpression=e);var f;a.layerDrawingOptions&&a.layerDrawingOptions[d.id]&&(f=a.layerDrawingOptions[d.id]);f&&(b.drawingInfo=f.toJson());b.minScale=d.minScale||0;b.maxScale=d.maxScale||0;c.push(b)}),c},_getTemplateFromTypes:function(a,b){var c;for(c=0;c<
a.length;c++)if(a[c].id==b&&a[c].templates&&0<a[c].templates.length)return a[c].templates[0];return null},_findParentGroup:function(a,b,c){var d,e=b.dynamicLayerInfos||b.layerInfos;for(d=0;d<e.length;d++)if(c==e[d].id){-1<e[d].parentLayerId&&(v.set(t.byId(this.id+"_"+a+"_"+e[d].parentLayerId+"_group"),"display","block"),this._findParentGroup(a,b,e[d].parentLayerId));break}},_addSubLayersToHide:function(a){function b(c,d){var e,g,l=a.layer.dynamicLayerInfos||a.layer.layerInfos;for(e=0;e<l.length;e++)if(l[e].id===
c&&l[e].subLayerIds)for(g=0;g<l[e].subLayerIds.length;g++){var m=l[e].subLayerIds[g];-1===f.indexOf(d,m)&&(d.push(m),b(m,d))}}a.layer.layerInfos&&f.forEach(this.hideLayersInLegend[a.layer.id],function(c){b(c,this.hideLayersInLegend[a.layer.id])},this)},_isLayerInScale:function(a,b,c){var d,e=!0;if(a.legendResponse&&a.legendResponse.layers)for(d=0;d<a.legendResponse.layers.length;d++){var f=a.legendResponse.layers[d];if(b.id==f.layerId){var g,l;!a.minScale&&0!==a.minScale||!a.maxScale&&0!==a.maxScale?
(0==f.minScale&&a.tileInfo&&(g=a.tileInfo.lods[0].scale),0==f.maxScale&&a.tileInfo&&(l=a.tileInfo.lods[a.tileInfo.lods.length-1].scale)):(g=Math.min(a.minScale,f.minScale)||a.minScale||f.minScale,l=Math.max(a.maxScale,f.maxScale));(0<g&&c>g||l>c)&&(e=!1);break}}else(a.minScale||a.maxScale)&&(a.minScale&&a.minScale<c||a.maxScale&&a.maxScale>c)&&(e=!1);return e},_getServiceTitle:function(a){var b=a._titleForLegend;if(b||(b=a.url,a.url?-1<a.url.indexOf("/MapServer")?(b=a.url.substring(0,a.url.indexOf("/MapServer")),
b=b.substring(b.lastIndexOf("/")+1,b.length)):-1<a.url.indexOf("/ImageServer")?(b=a.url.substring(0,a.url.indexOf("/ImageServer")),b=b.substring(b.lastIndexOf("/")+1,b.length)):-1<a.url.indexOf("/FeatureServer")&&(b=a.url.substring(0,a.url.indexOf("/FeatureServer")),b=b.substring(b.lastIndexOf("/")+1,b.length)):b="",a.name&&(0<b.length?b+=" - "+a.name:b=a.name)),"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass&&a.vectorFieldPixelFilter)a=a.vectorFieldPixelFilter.outputUnit?this["NLS_"+
a.vectorFieldPixelFilter.outputUnit]:this["NLS_"+a.vectorFieldPixelFilter.inputUnit],D.isDefined(a)&&(b+=" ("+a+")");return A.encode(b)},_getEffectiveScale:function(a,b){var c=b.minScale,d=b.maxScale;if(D.isDefined(b.parentLayerId)){var e,f=a.layerInfos,g=b.parentLayerId;for(e=f.length-1;0<=e;e--)if(f[e].id==g){if(0==c&&0<f[e].minScale?c=f[e].minScale:0<c&&0==f[e].minScale||0<c&&0<f[e].minScale&&(c=Math.min(c,f[e].minScale)),d=Math.max(d||0,f[e].maxScale||0),!(-1<f[e].parentLayerId))break;g=f[e].parentLayerId}}return{minScale:c,
maxScale:d}},_isSupportedLayerType:function(a){return a&&("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&10.2<=a.version||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass||"esri.layers.FeatureLayer"===a.declaredClass||"esri.layers.StreamLayer"===a.declaredClass||"esri.layers.KMLLayer"===a.declaredClass||"esri.layers.GeoRSSLayer"===a.declaredClass||"esri.layers.WMSLayer"===
a.declaredClass||"esri.layers.WFSLayer"===a.declaredClass||"esri.layers.CSVLayer"===a.declaredClass)?!0:!1},isHostedTileService:function(a){var b=/(https?:)?\/\/services.*\.arcgis\.com/i;return"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass&&b.test(a.url)?!0:!1},getField:function(a,b,c){if(a.getField)return a.getField(b);if(c&&c.fields){var d;return f.forEach(c.fields,function(a){a.name===b&&(d=a)}),d}return null}});return a.mixin(T,{ALIGN_LEFT:0,ALIGN_RIGHT:1}),g("extend-esri")&&a.setObject("dijit.Legend",
T,z),T})},"dojo/debounce":function(){define([],function(){return function(h,k){var a;return function(){a&&clearTimeout(a);var f=this,b=arguments;a=setTimeout(function(){h.apply(f,b)},k)}}})},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],function(h,k,a){h.DeferredList=function(f,b,e,l,m){var g=[];k.call(this);var d=this;0!==f.length||b||this.resolve([0,[]]);var c=0;a.forEach(f,function(a,m){function h(a,b){g[m]=[a,b];c++;c===f.length&&d.resolve(g)}a.then(function(a){b?
d.resolve([m,a]):h(!0,a)},function(a){e?d.reject(a):h(!1,a);if(l)return null;throw a;})})};h.DeferredList.prototype=new k;h.DeferredList.prototype.gatherResults=function(f){f=new h.DeferredList(f,!1,!0,!1);f.addCallback(function(b){var e=[];a.forEach(b,function(a){e.push(a[1])});return e});return f};return h.DeferredList})},"dojox/html/entities":function(){define(["dojo/_base/lang"],function(h){var k=h.getObject("dojox.html.entities",!0),a=function(a,e){var b,f;if(e._encCache&&e._encCache.regexp&&
e._encCache.mapper&&e.length==e._encCache.length)b=e._encCache.mapper,f=e._encCache.regexp;else{b={};f=["["];var g;for(g=0;g<e.length;g++)b[e[g][0]]="\x26"+e[g][1]+";",f.push(e[g][0]);f.push("]");f=new RegExp(f.join(""),"g");e._encCache={mapper:b,regexp:f,length:e.length}}return a=a.replace(f,function(a){return b[a]})},f=function(a,e){var b,f;if(e._decCache&&e._decCache.regexp&&e._decCache.mapper&&e.length==e._decCache.length)b=e._decCache.mapper,f=e._decCache.regexp;else{b={};f=["("];var g;for(g=
0;g<e.length;g++){var d="\x26"+e[g][1]+";";g&&f.push("|");b[d]=e[g][0];f.push(d)}f.push(")");f=new RegExp(f.join(""),"g");e._decCache={mapper:b,regexp:f,length:e.length}}return a=a.replace(f,function(a){return b[a]})};k.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];k.latin=[["\u00a1","iexcl"],["\u00a2","cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa",
"ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5",
"Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df",
"szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1","ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9",
"ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],
["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],
["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],
["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282",
"sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002",
"ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];k.encode=function(b,e){b&&(e?b=a(b,e):(b=a(b,k.html),b=a(b,k.latin)));return b};k.decode=function(a,e){a&&(e?a=f(a,e):(a=f(a,k.html),
a=f(a,k.latin)));return a};return k})},"esri/numberUtils":function(){define(["dojo/has","dojo/number","dojo/i18n!dojo/cldr/nls/number","./kernel"],function(h,k,a,f){var b=function(a,b){return a-b},e={_reNumber:/^-?(\d+)(\.(\d+))?$/i,getDigits:function(a){var b=String(a),f=b.match(e._reNumber);a={integer:0,fractional:0};if(f&&f[1])a.integer=f[1].split("").length,a.fractional=f[3]?f[3].split("").length:0;else if(-1<b.toLowerCase().indexOf("e")){var d,c,f=b.split("e"),b=f[0],f=f[1];b&&f&&(b=Number(b),
f=Number(f),c=0<f,c||(f=Math.abs(f)),d=e.getDigits(b),c?(d.integer+=f,f>d.fractional?d.fractional=0:d.fractional-=f):(d.fractional+=f,f>d.integer?d.integer=1:d.integer-=f),a=d)}return a},getFixedNumbers:function(a,b){var e,d;return e=Number(a.toFixed(b)),a>e?d=e+1/Math.pow(10,b):(d=e,e-=1/Math.pow(10,b)),e=Number(e.toFixed(b)),d=Number(d.toFixed(b)),[e,d]},getPctChange:function(a,b,e,d){var c,f,g,l={prev:null,next:null};return null!=e&&(c=a-e,f=b-e,g=f-c,l.prev=Math.floor(Math.abs(100*g/c))),null!=
d&&(c=d-a,f=d-b,g=f-c,l.next=Math.floor(Math.abs(100*g/c))),l},round:function(a,f){var g,d,c,l,m,h,k,v,u,w,x=a.slice(0),y=f&&null!=f.tolerance?f.tolerance:2,A=f&&f.indexes,z=f&&null!=f.strictBounds?f.strictBounds:!1;if(A)A.sort(b);else for(A=[],k=0;k<x.length;k++)A.push(k);for(k=0;k<A.length;k++)if(w=A[k],g=x[w],d=0===w?null:x[w-1],c=w===x.length-1?null:x[w+1],l=e.getDigits(g),m=l.fractional){v=0;for(u=!1;m>=v&&!u;)h=e.getFixedNumbers(g,v),h=z&&0===k?h[1]:h[0],u=e.hasMinimalChange(g,h,d,c,y),v++;
u&&(x[w]=h)}return x},hasMinimalChange:function(a,b,f,d,c){var g,l;a=e.getPctChange(a,b,f,d);return g=null==a.prev||a.prev<=c,l=null==a.next||a.next<=c,g&&l||a.prev+a.next<=2*c},_reAllZeros:new RegExp("\\"+a.decimal+"0+$","g"),_reSomeZeros:RegExp("(\\d)0*$","g"),format:function(a,b){b=b||{places:20,round:-1};var f=k.format(a,b);return f&&(f=f.replace(e._reSomeZeros,"$1").replace(e._reAllZeros,"")),f}};return h("extend-esri")&&(f.numberUtils=e),e})},"esri/renderers/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/has dojo/date/locale ../kernel ../numberUtils ../Color dojo/i18n!../nls/jsapi dojo/i18n!dojo/cldr/nls/gregorian".split(" "),
function(h,k,a,f,b,e,l,m,g){function d(a){return a&&k.map(a,function(a){return new l(a)})}function c(a,b,c){var d="";return 0===b?d=q.lt+" ":b===c&&(d=q.gt+" "),d+a}var n={},q={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%"},t={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},r={millisecond:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},second:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},minute:{dateOptions:{formatLength:"long"},
timeOptions:{formatLength:"short"}},hour:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},day:{selector:"date",dateOptions:{formatLength:"long"}},month:{selector:"date",dateOptions:{formatLength:"long"}},year:{selector:"date",dateOptions:{selector:"year"}}},v={formatLength:"short",fullYear:!0},u={formatLength:"short"};return h.mixin(n,{timelineDateFormatOptions:{selector:"date",dateOptions:{formatLength:"short",fullYear:!0}},formatDate:function(a,b){var c,d=[];null==a||a instanceof
Date||(a=new Date(a));b=b||{};b=h.mixin({},b);var e=b.selector?b.selector.toLowerCase():null,l=!e||-1<e.indexOf("time"),e=!e||-1<e.indexOf("date");return l&&(b.timeOptions=b.timeOptions||u,b.timeOptions&&(b.timeOptions=h.mixin({},b.timeOptions),b.timeOptions.selector=b.timeOptions.selector||"time",d.push(b.timeOptions))),e&&(b.dateOptions=b.dateOptions||v,b.dateOptions&&(b.dateOptions=h.mixin({},b.dateOptions),b.dateOptions.selector=b.dateOptions.selector||"date",d.push(b.dateOptions))),d&&d.length?
(d=k.map(d,function(b){return f.format(a,b)}),c=1==d.length?d[0]:g["dateTimeFormat-medium"].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(a,b){return d[b]})):c=f.format(a),c},createColorStops:function(a){var b=a.values,d=a.colors,f=a.labelIndexes,g=a.isDate,l=a.dateFormatOptions;return k.map(b,function(a,m){var h=null;if(!f||-1<k.indexOf(f,m)){var q;(q=g?n.formatDate(a,l):e.format(a))&&(h=c(q,m,b.length-1))}return{value:a,color:d[m],label:h}})},updateColorStops:function(a){var b,d=a.stops,f=a.changes,
g=a.isDate,l=a.dateFormatOptions,m=[],h=k.map(d,function(a){return a.value});k.forEach(f,function(a){m.push(a.index);h[a.index]=a.value});b=e.round(h,{indexes:m});k.forEach(d,function(a,f){if(a.value=h[f],null!=a.label){var m,k=null;(m=g?n.formatDate(b[f],l):e.format(b[f]))&&(k=c(m,f,d.length-1));a.label=k}})},createClassBreakLabel:function(a){var b=a.minValue,c=a.maxValue,d=a.isFirstBreak?"":q.gt+" ";a="percent-of-total"===a.normalizationType?q.pct:"";return b=null==b?"":e.format(b),c=null==c?"":
e.format(c),d+b+a+" "+m.smartMapping.minToMax+" "+c+a},setLabelsForClassBreaks:function(a){var b=a.classBreaks,c=a.classificationMethod,d=a.normalizationType,f=[];b&&b.length&&("standard-deviation"===c||(a.round?(f.push(b[0].minValue),k.forEach(b,function(a){f.push(a.maxValue)}),f=e.round(f),k.forEach(b,function(a,b){a.label=n.createClassBreakLabel({minValue:0===b?f[0]:f[b],maxValue:f[b+1],isFirstBreak:0===b,normalizationType:d})})):k.forEach(b,function(a,b){a.label=n.createClassBreakLabel({minValue:a.minValue,
maxValue:a.maxValue,isFirstBreak:0===b,normalizationType:d})})))},updateClassBreak:function(a){var b,c=a.classBreaks,d=a.normalizationType,e=a.change,f=e.index,e=e.value,g=-1,l=-1,m=c.length;return"standard-deviation"===a.classificationMethod?void 0:(0===f?g=f:f===m?l=f-1:(l=f-1,g=f),-1<g&&m>g&&(b=c[g],b.minValue=e,b.label=n.createClassBreakLabel({minValue:b.minValue,maxValue:b.maxValue,isFirstBreak:0===g,normalizationType:d})),void(-1<l&&m>l&&(b=c[l],b.maxValue=e,b.label=n.createClassBreakLabel({minValue:b.minValue,
maxValue:b.maxValue,isFirstBreak:0===l,normalizationType:d}))))},calculateDateFormatInterval:function(a){var b,c,d,e,f,g,l,m,h,n=a.length,q=1/0;a=k.map(a,function(a){return new Date(a)});for(b=0;n-1>b;b++){d=a[b];f=[];l=1/0;m="";for(c=b+1;n>c;c++)e=a[c],e=d.getFullYear()!==e.getFullYear()&&"year"||d.getMonth()!==e.getMonth()&&"month"||d.getDate()!==e.getDate()&&"day"||d.getHours()!==e.getHours()&&"hour"||d.getMinutes()!==e.getMinutes()&&"minute"||d.getSeconds()!==e.getSeconds()&&"second"||"millisecond",
g=t[e],l>g&&(l=g,m=e),f.push(e);q>l&&(q=l,h=m)}return h},createUniqueValueLabel:function(a){var b=a.value,c=a.fieldInfo,d=a.domain;a=a.dateFormatInterval;var f=String(b),d=d&&d.codedValues?d.getName(b):null;return d?f=d:"number"==typeof b&&(f=c&&"esriFieldTypeDate"===c.type?n.formatDate(b,a&&r[a]):e.format(b)),f},cloneColorInfo:function(a){var b;return a&&(b=h.mixin({},a),b.colors=d(b.colors),b.stops=b.stops&&k.map(b.stops,function(a){return a=h.mixin({},a),a.color&&(a.color=new l(a.color)),a}),b.legendOptions&&
(b.legendOptions=h.mixin({},b.legendOptions))),b},cloneOpacityInfo:function(a){var b;a&&(b=h.mixin({},a),(a=b.opacityValues)&&(b.opacityValues=a.slice(0)),(a=b.stops)&&(b.stops=k.map(a,function(a){return h.mixin({},a)})),(a=b.legendOptions)&&(b.legendOptions=h.mixin({},a)));return b},cloneSizeInfo:function(a){var b;a&&(b=h.mixin({},a),b.stops&&(b.stops=k.map(b.stops,function(a){return h.mixin({},a)})),(a=b.minSize)&&"object"==typeof a&&(b.minSize=n.cloneSizeInfo(a)),(a=b.maxSize)&&"object"==typeof a&&
(b.maxSize=n.cloneSizeInfo(a)),(a=b.legendOptions)&&(b.legendOptions=h.mixin({},a),a=a.customValues,a&&(b.legendOptions.customValues=a.slice(0))));return b}}),a("extend-esri")&&h.setObject("renderer.utils",n,b),n})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),function(h,k,a,f,b,e){return h([e,b],{_onMap:function(a){var b,e,d=this.constructor._onMap;return d&&d.FINAL||(delete this.constructor._onMap,
d=this.registerConnectEvents(),d.FINAL=!0),a=a.toLowerCase(),d[a]?b=this[d[a].method]:(e=this._onCamelCase(a),this[e]&&(b=e)),b},on:function(a,b){var e=this._onMap(a),d=a.replace(/\-/g,""),c="on"+d in this.domNode;return e||!c?this.inherited(arguments):this.own(f(this.domNode,d,b))[0]},emit:function(a,b,e){var d,c,f,g=a.toLowerCase(),l=this.constructor._onMap||this.registerConnectEvents();return c=this[this._onMap(g)],b=b||{},b.target||(b.target=this),c&&l&&l[g]&&(this._onObj2Arr(function(){d=Array.prototype.slice.call(arguments)},
l[g].argKeys)(b),f=k.mixin({},arguments),f[2]=d,f[0]=l[g].name.replace(/^on/,"")),this.inherited(f||arguments)}})})},"cmv/viewer/js/gis/dijit/LayerControl/controls/Feature":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_Contained ./_Control ./../plugins/legendUtil".split(" "),function(h,k,a,f,b,e){return h([k,a,f,b],{_layerType:"vector",_esriLayerType:"feature",_layerTypeInit:function(){e.isLegend(this.controlOptions.noLegend,this.controller.noLegend)?(this._expandClick(),
e.vectorLegend(this.layer,this.expandNode)):this._expandRemove()}})})},"esri/dijit/HomeButton":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/has ../kernel dijit/_WidgetBase dijit/a11yclick dijit/_TemplatedMixin dojo/on dojo/Deferred dojo/text!./templates/HomeButton.html dojo/i18n!../nls/jsapi dojo/dom-class dojo/dom-style".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t){h=k("esri.dijit.HomeButton",[e,m,h],{templateString:c,options:{theme:"HomeButton",map:null,extent:null,
fit:!1,visible:!0},constructor:function(b,c){var d=a.mixin({},this.options,b);this.domNode=c;this._i18n=n;this.set("map",d.map);this.set("theme",d.theme);this.set("visible",d.visible);this.set("extent",d.extent);this.set("fit",d.fit);this.watch("theme",this._updateThemeWatch);this.watch("visible",this._visible);this._css={container:"homeContainer",home:"home",loading:"loading"}},postCreate:function(){this.inherited(arguments);this.own(g(this._homeNode,l,a.hitch(this,this.home)))},startup:function(){this.inherited(arguments);
this.map||this.destroy();this.map.loaded?this._init():g.once(this.map,"load",a.hitch(this,function(){this._init()}))},destroy:function(){this.inherited(arguments)},home:function(){var b=new d,c=this.get("extent");this._showLoading();var e={extent:c};c?this.map.extent!==c?this.map.setExtent(c,this.get("fit")).then(a.hitch(this,function(){this._hideLoading();this.emit("home",e);b.resolve(e)}),a.hitch(this,function(a){a||(a=Error("HomeButton::Error setting map extent"));e.error=a;this.emit("home",e);
b.reject(a)})):(this._hideLoading(),this.emit("home",e),b.resolve(e)):(this._hideLoading(),c=Error("HomeButton::home extent is undefined"),e.error=c,this.emit("home",e),b.reject(c));return b.promise},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},_init:function(){this._visible();this.get("extent")||this.set("extent",this.map.extent);this.set("loaded",!0);this.emit("load",{})},_showLoading:function(){q.add(this._homeNode,this._css.loading)},_hideLoading:function(){q.remove(this._homeNode,
this._css.loading)},_updateThemeWatch:function(a,b,c){q.remove(this.domNode,b);q.add(this.domNode,c)},_visible:function(){this.get("visible")?t.set(this.domNode,"display","block"):t.set(this.domNode,"display","none")}});return f("extend-esri")&&a.setObject("dijit.HomeButton",h,b),h})},"esri/dijit/OverviewMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/html dojo/has dojo/dom-class dojo/dom-style dojo/dnd/Moveable dijit/_Widget dijit/_Templated ../map ../geometry/Point ../geometry/ScreenPoint ../layers/TiledMapServiceLayer ../layers/DynamicMapServiceLayer ../layers/VectorTileLayer ../layers/ArcGISTiledMapServiceLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/ArcGISImageServiceLayer ../layers/OpenStreetMapLayer ../virtualearth/VETiledLayer ../kernel ../config ../domUtils dojo/text!./templates/OverviewMap.html dojo/i18n!../nls/jsapi".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E){h=h([g,d],{declaredClass:"esri.dijit.OverviewMap",widgetsInTemplate:!0,templateString:D,constructor:function(b,c){if(k.mixin(this,E.widgets.overviewMap),b=b||{},!b.map)return void console.error("esri.dijit.OverviewMap: "+this.NLS_noMap);var d={};if(c&&(this._detached=!0,d=f.coords(c,!0)),this.map=b.map,this.baseLayer=b.baseLayer,this.width=b.width||d.w||this.map.width/4,this.height=b.height||d.h||this.map.height/4,this.attachTo=b.attachTo||
"top-right",this.expandFactor=b.expandFactor||2,this.color=b.color||"#000000",this.opacity=b.opacity||.5,this.maximizeButton=!!b.maximizeButton,this.visible=!!b.visible,this.map.loaded)this._initialSetup();else var e=a.connect(this.map,"onLoad",this,function(){a.disconnect(e);e=null;this._initialSetup()});this._detached&&(this.visible=!0);this._maximized=!1},startup:function(){this.inherited(arguments);(!this.domNode.parentNode||9>b("ie")&&"DIV"!==this.domNode.parentNode.nodeName)&&this.map.container.appendChild(this.domNode);
this._detached?(l.set(this._body,"display","block"),l.set(this._controllerDiv,"display","none"),l.set(this._maximizerDiv,"display","none"),this.map.loaded?this._initialize():a.connect(this.map,"onLoad",this,this._initialize)):("bottom"===this.attachTo.split("-")[0]&&this.domNode.insertBefore(this._maximizerDiv,this._controllerDiv),this.maximizeButton||e.add(this._maximizerDiv,"ovwDisabledButton"),e.add(this.domNode,{"top-left":"ovwTL","top-right":"ovwTR","bottom-left":"ovwBL","bottom-right":"ovwBR"}[this.attachTo]),
e.add(this._controllerDiv,"ovwShow"),e.add(this._maximizerDiv,"ovwMaximize"),this.visible&&this.map.loaded&&(this.visible=!1,this.show()));l.set(this._focusDiv,"opacity",this.opacity)},destroy:function(){this._deactivate();this.overviewMap&&this.overviewMap.destroy();this.overviewMap=this.baseLayer=null;this.inherited(arguments)},resize:function(a){!a||0>=a.w||0>=a.h||this._resize(a.w,a.h)},show:function(){if(!this.visible){var a=this._controllerDiv;a.title=this.NLS_hide;e.remove(a,"ovwShow");e.add(a,
"ovwHide");C.show(this._body);C.show(this._maximizerDiv);this._initialize();this.visible=!0}},hide:function(){if(this.visible){var a=this._controllerDiv;a.title=this.NLS_show;e.remove(a,"ovwHide");e.add(a,"ovwShow");this._maximized&&this._maximizeHandler();C.hide(this._body);C.hide(this._maximizerDiv);this._deactivate();this.visible=!1}},_initialSetup:function(){if(this._mainMapLayer=this.map.getLayer(this.map.layerIds[0]),!this._mainMapLayer)return void console.error("esri.dijit.OverviewMap: "+this.NLS_noLayer);
var b=this.baseLayer||this._mainMapLayer,c=this.map.spatialReference,d=b.spatialReference;if(d.wkid!==c.wkid&&d.wkt!==c.wkt)return void console.error("esri.dijit.OverviewMap: "+this.NLS_invalidSR);c=b.declaredClass;if(b instanceof t)if(-1!==c.indexOf("VETiledLayer"))this.baseLayer=new A({resourceInfo:b.getResourceInfo(),culture:b.culture,mapStyle:b.mapStyle,bingMapsKey:b.bingMapsKey});else if(-1!==c.indexOf("OpenStreetMapLayer"))this.baseLayer=new y({tileServers:b.tileServers});else if(-1!==c.indexOf("WebTiledLayer")){var c=
b.initialExtent,d=b.fullExtent,e=b.tileInfo;this.baseLayer=new b.constructor(b.urlTemplate,{initialExtent:c&&new c.constructor(c.toJson()),fullExtent:d&&new d.constructor(d.toJson()),tileInfo:e&&new e.constructor(e.toJson()),tileServers:b.tileServers&&b.tileServers.slice(0)})}else this.baseLayer=new u(b.url,{resourceInfo:b.getResourceInfo()});else if(b instanceof r)-1!==c.indexOf("ArcGISImageServiceLayer")?this.baseLayer=new x(b.url):(this.baseLayer=new w(b.url),this.baseLayer.setImageFormat("png24"));
else{if(!(b instanceof v))return void console.error("esri.dijit.OverviewMap: "+this.NLS_invalidType);b="http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer";"https:"===location.protocol&&(b=b.replace("http:","https:"));this.baseLayer=new u(b,{})}!this._detached&&this.visible&&this._controllerDiv&&(b=function(){this.visible=!1;this.show()},this.baseLayer.loaded?b.call(this):a.connect(this.baseLayer,"onLoad",this,b))},_visibilityHandler:function(){this.visible?this.hide():
this.show()},_maximizeHandler:function(){var a=this._maximizerDiv;this._maximized?(a.title=this.NLS_maximize,e.remove(a,"ovwRestore"),e.add(a,"ovwMaximize"),this._resize(this.width,this.height)):(a.title=this.NLS_restore,e.remove(a,"ovwMaximize"),e.add(a,"ovwRestore"),this._resize(this.map.width,this.map.height));this._maximized=!this._maximized},_resize:function(a,b){l.set(this._body,{width:a+"px",height:b+"px"});var c=B.defaults.map.panDuration,d=this.overviewMap;B.defaults.map.panDuration=0;d&&
(d.resize(!0),d.centerAt(this._focusExtent.getCenter()));B.defaults.map.panDuration=c},_initialize:function(){if(this.overviewMap)this._activate();else{var d,e;9>b("ie")?e=this._body.firstChild:e=this._body.firstElementChild;this.overviewMap=d=new c(e,{slider:!1,showAttribution:!1,logo:!1,lods:this._overviewLods,wrapAround180:this.map.wrapAround180});a.connect(d,"onLoad",this,function(){this._map_resize_override=k.hitch(d,this._map_resize_override);d.disableMapNavigation();this._activate()});d.addLayer(this.baseLayer)}},
_activate:function(){var b=this.map,c=this.overviewMap;this._moveableHandle=new m(this._focusDiv);this._soeConnect=a.connect(b,"onExtentChange",this,this._syncOverviewMap);this._ufoConnect=a.connect(b,"onPan",this,this._updateFocus);this._oecConnect=a.connect(c,"onExtentChange",this,this._ovwExtentChangeHandler);this._opaConnect=a.connect(c,"onPan",this,this._ovwPanHandler);this._ozsConnect=a.connect(c,"onZoomStart",this,function(){C.hide(this._focusDiv)});this._ozeConnect=a.connect(c,"onZoomEnd",
this,function(){C.show(this._focusDiv)});this._omsConnect=a.connect(this._moveableHandle,"onMoveStop",this,this._moveStopHandler);this._syncOverviewMap(b.extent,null,null,null)},_deactivate:function(){a.disconnect(this._soeConnect);a.disconnect(this._ufoConnect);a.disconnect(this._oecConnect);a.disconnect(this._opaConnect);a.disconnect(this._ozsConnect);a.disconnect(this._ozeConnect);a.disconnect(this._omsConnect);this._moveableHandle&&this._moveableHandle.destroy()},_syncOverviewMap:function(a,b,
c,d){return this._suspendPanHandling?void(this._suspendPanHandling=!1):(this._focusExtent=a,void this.overviewMap.setExtent(a.expand(this.expandFactor),!0))},_updateFocus:function(a){this._suspendPanHandling||(this._focusExtent=a,this._drawFocusDiv(a))},_drawFocusDiv:function(a,b){var c=this.overviewMap,d=c.toScreen(new n(a.xmin,a.ymax,c.spatialReference)),e=c.toScreen(new n(a.xmax,a.ymin,c.spatialReference)),c=e.x-d.x,e=e.y-d.y,f=!0;c>this.overviewMap.width&&e>this.overviewMap.height&&(f=!1);l.set(this._focusDiv,
{left:d.x+(b?b.x:0)+"px",top:d.y+(b?b.y:0)+"px",width:c+"px",height:e+"px",display:f?"block":"none"})},_moveStopHandler:function(a){var b=this._moveableHandle.node.style;a=this._focusExtent;var c=this.overviewMap,b=c.toMap(new q(parseInt(b.left,10),parseInt(b.top,10))),d=new n(a.xmin,a.ymax,c.spatialReference);this._focusExtent=a.offset(b.x-d.x,b.y-d.y);this._maximized?this._maximizeHandler():c.centerAt(this._focusExtent.getCenter());this._suspendPanHandling=!0;this.map.setExtent(this._focusExtent)},
_ovwExtentChangeHandler:function(){this._drawFocusDiv(this._focusExtent)},_ovwPanHandler:function(a,b){this._drawFocusDiv(this._focusExtent,b)}});return b("extend-esri")&&k.setObject("dijit.OverviewMap",h,z),h})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(h,k,a,f,b,e,l){e.extend(h,{waiRole:"",waiState:""});return b("dijit._Templated",[k,a],{constructor:function(){l.deprecated(this.declaredClass+
": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin","","2.0")},_processNode:function(a,b){var d=this.inherited(arguments),c=b(a,"waiRole");c&&a.setAttribute("role",c);(c=b(a,"waiState"))&&f.forEach(c.split(/\s*,\s*/),function(b){-1!=b.indexOf("-")&&(b=b.split("-"),a.setAttribute("aria-"+b[0],b[1]))});return d}})})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],
function(h,k,a,f,b){return a("dijit._WidgetsInTemplateMixin",null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var a=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);b.parse(a,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(f.hitch(this,
function(a){this._startupWidgets=a;for(var b=0;b<a.length;b++)this._processTemplateNode(a[b],function(a,b){return a[b]},function(a,b,c){return b in a?a.connect(a,b,c):a.on(b,c,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");
}},_processTemplateNode:function(a,b,f){return b(a,"dojoType")||b(a,"data-dojo-type")?!0:this.inherited(arguments)},startup:function(){h.forEach(this._startupWidgets,function(a){a&&!a._started&&a.startup&&a.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"esri/layers/ArcGISImageServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../config ./DynamicMapServiceLayer ./ImageServiceLayerMixin".split(" "),function(h,k,a,f,b,e,l){h=h([e,l],{declaredClass:"esri.layers.ArcGISImageServiceLayer",
constructor:function(a,b){this._initialize(a,b);this.useMapImage=b&&b.useMapImage||!1},refresh:function(a){if(a)this.inherited(arguments);else{var b=this.disableClientCaching;this.disableClientCaching=!0;this.inherited(arguments);this.disableClientCaching=b}},exportMapImage:function(a,e){var d=b.defaults.map,d=k.mixin({size:d.width+","+d.height},this._params,a?a.toJson(this.normalization):{},{f:"json"});delete d._ts;this._exportMapImage(this._url.path+"/exportImage",d,e)}});return a("extend-esri")&&
k.setObject("layers.ArcGISImageServiceLayer",h,f),h})},"esri/layers/ImageServiceLayerMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/json dojo/_base/config dojo/_base/connect dojo/has dojo/io-query ../kernel ../config ../lang ../request ../deferredUtils ../urlUtils ../geometry/Extent ../geometry/Point ../geometry/Polygon ./MosaicRule ./RasterFunction ./DimensionalDefinition ./Raster ./PixelBlock ./pixelFilters/VectorFieldPixelFilter ./rasterFormats/ImageCanvasDecoder ./TimeInfo ./Field ../graphic ../tasks/ImageServiceIdentifyTask ../tasks/ImageServiceIdentifyParameters".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J){h=h(null,{declaredClass:"esri.layers.ImageServiceLayerMixin",_rasterFieldPrefix:"Raster.",_renderingRuleFieldSubPrefix:"ServicePixelValue.",_eventMap:{"rendering-change":!0,"mosaic-rule-change":!0,"spatial-reference-change":!0},constructor:function(a,b){this.useMapTime=b&&b.hasOwnProperty("useMapTime")?!!b.useMapTime:!0},_initialize:function(a,b){this._url=r.urlToObject(a);this.raster=new z(this._url.path);this.infoTemplate=b&&
b.infoTemplate;var c=b&&b.imageServiceParameters;this.format=c&&c.format;this.compressionTolerance=c&&c.compressionTolerance?c.compressionTolerance:.01;this.interpolation=c?c.interpolation:null;this.compressionQuality=c?c.compressionQuality:null;this.bandIds=c?c.bandIds:null;this.mosaicRule=c?c.mosaicRule:null;this.renderingRule=c?c.renderingRule:null;this.useMapDimensionValue=b&&b.hasOwnProperty("useMapDimensionValue")?!!b.useMapDimensionValue:!0;this.activeMapDimensions=b&&b.activeMapDimensions;
this._params=k.mixin({},this._url.query,{f:"image",interpolation:this.interpolation,format:this.format,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null},c?c.toJson():{});this.pixelFilter=b&&b.pixelFilter;this.originalPixelData=this.pixelData=null;this.hasDataChanged=!0;this._requestDataHandler=k.hitch(this,this._requestDataHandler);this._requestDataErrorHandler=k.hitch(this,this._requestDataErrorHandler);this._rasterReadPromise=null;this._initLayer=k.hitch(this,
this._initLayer);this._queryVisibleRastersHandler=k.hitch(this,this._queryVisibleRastersHandler);this._visibleRasters=[];this._rasterAttributeTableFields=[];this._rasterAttributeTableFeatures=[];this._renderingRuleAttributeTable={};this._useRenderingRuleAttributeTable=!1;this._loadCallback=b&&b.loadCallback;(c=b&&b.resourceInfo)?this._initLayer(c):q({url:this._url.path,content:k.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});this.registerConnectEvents()},
disableClientCaching:!1,_initLayer:function(a,b){if(null!==a&&void 0!==a){this._findCredential();(this.credential&&this.credential.ssl||a&&a._ssl)&&this._useSSL();var c=this.minScale,d=this.maxScale;k.mixin(this,a);this.minScale=c;this.maxScale=d;this.initialExtent=this.fullExtent=this.extent=new v(a.extent);this.spatialReference=this.initialExtent.spatialReference;this.pixelSizeX=parseFloat(this.pixelSizeX);this.pixelSizeY=parseFloat(this.pixelSizeY);for(var e=this.minValues,f=this.maxValues,g=this.meanValues,
l=this.stdvValues,m=this.bands=[],c=0,d=this.bandCount;d>c;c++)m[c]={min:e[c],max:f[c],mean:g[c],stddev:l[c]};this.timeInfo=(c=this.timeInfo)&&c.timeExtent?new E(c):null;d=this.fields=[];if(e=a.fields)for(c=0;c<e.length;c++)d.push(new F(e[c]));(this.version=a.currentVersion,this.version)||(this.version="fields"in a||"objectIdField"in a||"timeInfo"in a?10:9.3);n.isDefined(a.minScale)&&!this._hasMin&&this.setMinScale(a.minScale);n.isDefined(a.maxScale)&&!this._hasMax&&this.setMaxScale(a.maxScale);c=
{};(a.defaultMosaicMethod?(c.method=a.defaultMosaicMethod,c.operation=a.mosaicOperator,c.sortField=a.sortField,c.sortValue=a.sortValue):c.method=x.METHOD_NONE,this.defaultMosaicRule=new x(c),this.defaultMosaicRule.ascending=!0,this._useRenderingRuleAttributeTable=10<this.version&&"esriImageServiceDataTypeThematic"===this.serviceDataType&&!this.hasRasterAttributeTable,this._setDefaultRenderingRule(!0),this._isScientificData()&&(!this.mosaicRule||this.mosaicRule&&!this.mosaicRule.multidimensionalDefinition)&&
this._setDefaultMultidimensionalDefinition(!0),10<this.version&&this.hasRasterAttributeTable)&&this.getRasterAttributeTable().then(k.hitch(this,function(a){a&&a.features&&0<a.features.length&&(this._rasterAttributeTableFeatures=k.clone(a.features));a&&a.fields&&0<a.fields.length&&(this._rasterAttributeTableFields=k.clone(a.fields))}));this._isVectorData()&&!n.isDefined(this.pixelFilter)&&(this.vectorFieldPixelFilter=new C,this.vectorFieldPixelFilter.isDataUV="esriImageServiceDataTypeVector-UV"===
this.serviceDataType,this.pixelFilter=this.vectorFieldPixelFilter.computeMagnitudeAndDirection,this.getKeyProperties().then(k.hitch(this,this._setFlowRepresentation)));this.loaded=!0;this._setDefaultFilter();this.onLoad(this);(c=this._loadCallback)&&(delete this._loadCallback,c(this))}},getKeyProperties:function(){var b=this._url.path+"/keyProperties",c=new a(t._dfdCanceller);10<this.version?(c._pendingDfd=q({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),c._pendingDfd.then(function(a){c.callback(a)},
function(a){c.errback(a)})):(b=Error("Layer does not have key properties"),b.log=e.isDebug,c.errback(b));return c},getRasterAttributeTable:function(c){var d=this._url.path+"/rasterAttributeTable",f=new a(t._dfdCanceller),g={f:"json"},l=this.hasRasterAttributeTable;(c&&c.renderingRule&&(g.renderingRule=b.toJson(c.renderingRule.toJson()),l=!0),10<this.version&&l)?(f._pendingDfd=q({url:d,content:g,handleAs:"json",callbackParamName:"callback"}),f._pendingDfd.then(function(a){f.callback(a)},function(a){f.errback(a)})):
(c=Error("Layer does not support raster attribute table"),c.log=e.isDebug,f.errback(c));return f},_getRenderingRuleAttributeTable:function(b){var c=new a(t._dfdCanceller);if(!b||!b.renderingRule)return c.errback(Error("Rendering rule is not specified")),c;b=b.renderingRule;var d=b.functionName;return this._renderingRuleAttributeTable&&d&&this._renderingRuleAttributeTable.hasOwnProperty(d)?c.resolve(this._renderingRuleAttributeTable[d]):c=this.getRasterAttributeTable({renderingRule:b}).then(k.hitch(this,
function(a){var b;return a&&a.features&&a.features.length&&a.fields&&a.fields.length&&(b={features:k.clone(a.features),fields:k.clone(a.fields)},d&&(this._renderingRuleAttributeTable[d]=b)),b})),c},_getRasterAttributeTableFeatures:function(){var b=new a;return this._rasterAttributeTableFeatures&&0<this._rasterAttributeTableFeatures.length?(b.resolve(this._rasterAttributeTableFeatures),b):10<this.version&&this.hasRasterAttributeTable?(b=this.getRasterAttributeTable(),b.then(k.hitch(this,function(a){a&&
a.features&&0<a.features.length&&(this._rasterAttributeTableFeatures=k.clone(a.features))})),b):(b.resolve(this._rasterAttributeTableFeatures),b)},_getRenderingRuleAttributeTableFeatures:function(b){b=b&&b.renderingRule;return b?this._getRenderingRuleAttributeTable({renderingRule:b}).then(function(a){return a&&a.features}):(b=new a,b.errback(Error("Rendering rule is not specified")),b)},getCustomRasterFields:function(a){var b=a?a.rasterAttributeTableFieldPrefix:this._rasterFieldPrefix;a=10.3<=this.version?
"esriFieldTypeDouble":"esriFieldTypeString";var c={name:this._rasterFieldPrefix+"ItemPixelValue",alias:"Item Pixel Value",domain:null,editable:!1,length:50,type:a},d={name:this._rasterFieldPrefix+"ServicePixelValue",alias:"Service Pixel Value",domain:null,editable:!1,length:50,type:a},e={name:this._rasterFieldPrefix+"ServicePixelValue.Raw",alias:"Raw Service Pixel Value",domain:null,editable:!1,length:50,type:"esriFieldTypeDouble"},g=this.fields?k.clone(this.fields):[];a=g.length;(g[a]=d,10.4<=this.version&&
"esri.layers.ArcGISImageServiceLayer"===this.declaredClass&&(!this.rasterFunctionInfos||!this.rasterFunctionInfos.length||this._isRasterFunctionInfoAvailable("none"))&&(a++,g[a]=e),(this.capabilities&&-1<this.capabilities.toLowerCase().indexOf("catalog")||this.fields&&0<this.fields.length)&&(a++,g[a]=c),!n.isDefined(this.pixelFilter)||"esriImageServiceDataTypeVector-UV"!==this.serviceDataType&&"esriImageServiceDataTypeVector-MagDir"!==this.serviceDataType)||(c={name:this._rasterFieldPrefix+"Magnitude",
alias:"Magnitude",domain:null,editable:!1,type:"esriFieldTypeDouble"},d={name:this._rasterFieldPrefix+"Direction",alias:"Direction",domain:null,editable:!1,type:"esriFieldTypeDouble"},a++,g[a]=c,a++,g[a]=d);a=this._rasterAttributeTableFields;c=this.renderingRule&&this.renderingRule.functionName;if(c&&this._renderingRuleAttributeTable&&this._renderingRuleAttributeTable.hasOwnProperty(c)&&(a=this._renderingRuleAttributeTable[c].fields),a&&0<a.length)a=f.filter(a,function(a){return"esriFieldTypeOID"!==
a.type&&"value"!==a.name.toLowerCase()}),a=f.map(a,function(a){var c=k.clone(a);return c.name=b+a.name,c}),g=g.concat(a);var l=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;return 10.4<=this.version&&this.rasterFunctionInfos&&f.forEach(this.rasterFunctionInfos,function(a){a&&a.name&&"none"!==a.name.toLowerCase()&&(a={name:l+a.name.replace(/ /gi,"_"),alias:a.name,domain:null,editable:!1,type:"esriFieldTypeDouble"},g.push(a))}),g},_prepareGetImageParameters:function(a,c,d,e){e=n.isDefined(e)?
e:this._params;var f=a.spatialReference.wkid||b.toJson(a.spatialReference.toJson(!1));delete e._ts;k.mixin(e,{bbox:a.xmin+","+a.ymin+","+a.xmax+","+a.ymax,imageSR:f,bboxSR:f,size:c+","+d},this.disableClientCaching?{_ts:(new Date).getTime()}:{});delete e.compressionTolerance;e.format&&"LERC"===e.format.toUpperCase()&&(e.compressionTolerance=this.compressionTolerance);e.token=this._getToken()},getImageUrl:function(a,b,d,e,f){f=n.isDefined(f)?f:this._params;this._prepareGetImageParameters(a,b,d,f);a=
k.clone(f);this._cleanupRequestParams(a);b=this._url.path+"/exportImage?";d=r.addProxy(b+g.objectToQuery(k.mixin(a,{f:"image"})));var l=a.token;d.length>c.defaults.io.postLength||this.useMapImage?this._jsonRequest=q({url:b,content:k.mixin(a,{f:"json"}),callbackParamName:"callback",load:function(a,b){var c=a.href;l&&(c+=-1===c.indexOf("?")?"?token\x3d"+l:"\x26token\x3d"+l);e(r.addProxy(c))},error:this._errorHandler}):e(d)},onRenderingChange:function(){},onMosaicRuleChange:function(){},setInterpolation:function(a,
b){this.interpolation=this._params.interpolation=a;b||this.refresh(!0)},setCompressionQuality:function(a,b){this.compressionQuality=this._params.compressionQuality=a;b||this.refresh(!0)},setCompressionTolerance:function(a,b){this.compressionTolerance=a;b||this.refresh(!0)},setBandIds:function(a,b){var c=!1;this.bandIds!==a&&(c=!0);this.bandIds=a;this._params.bandIds=a.join(",");c&&!b&&this.onRenderingChange();b||this.refresh(!0)},setDefaultBandIds:function(a){this.bandIds=this._params.bandIds=null;
a||this.refresh(!0)},setDisableClientCaching:function(a){this.disableClientCaching=a},setMosaicRule:function(a,c){var d=!1;this.mosaicRule!==a&&(d=!0);this.mosaicRule=a;this._params.mosaicRule=b.toJson(a.toJson());d&&!c&&this.onMosaicRuleChange();c||this.refresh(!0)},setRenderingRule:function(a,c){var d=!1;this.renderingRule!==a&&(d=!0);this.renderingRule=a;this._params.renderingRule=a?b.toJson(a.toJson()):null;this._useRenderingRuleAttributeTable&&this._getRenderingRuleAttributeTable({renderingRule:a});
d&&this.onRenderingChange();this._setDefaultFilter();c||this.refresh(!0)},setImageFormat:function(a,b){this.format=this._params.format=a;this._setDefaultFilter();b||this.refresh(!0)},setInfoTemplate:function(a){this.infoTemplate=a},setDefinitionExpression:function(a,b){var c=this.mosaicRule?this.mosaicRule.toJson():{};this.mosaicRule||(this.defaultMosaicRule?c=this.defaultMosaicRule.toJson():c.method=x.METHOD_NONE);c.where=a;c=new x(c);return this.setMosaicRule(c,b),this},getDefinitionExpression:function(){return this.mosaicRule?
this.mosaicRule.where:null},setPixelFilter:function(a){this.pixelFilter=a;this._isDefaultPixelFilter=!1},getPixelData:function(a){return a?(this._useBrowserDecoding()&&(this.originalPixelData={pixelBlock:this._getPixelBlockFromCanvas(this._context,this._map.width,this._map.height),extent:this._map.extent}),this.originalPixelData):this.pixelData},redraw:function(){this.hasDataChanged=!1;this._setPixelData(this.originalPixelData)},queryVisibleRasters:function(b,c,d,e){var g=this._map,l=t._fixDfd(new a(t._dfdCanceller));
this._visibleRasters=[];var m,h,n=!0,q=this.infoTemplate?this.infoTemplate.info:null,r=q?k.clone(this.infoTemplate.info.fieldInfos):null;if(c=c||{},q&&this.infoTemplate.info.mediaInfos&&this.infoTemplate.info.mediaInfos.length){var v=[];f.forEach(this.infoTemplate.info.mediaInfos,function(a){v=v.concat(a&&a.value&&a.value.fields||[])});v.length&&f.forEach(r,function(a){a&&-1<v.indexOf(a.fieldName)&&(a.visible=!0)})}if(r&&0<r.length)for(n=!1,m=0;m<r.length;m++)if(h=r[m],h&&h.fieldName.toLowerCase()!==
this._rasterFieldPrefix.toLowerCase()+"servicepixelvalue"&&(h.visible||q.title&&-1<q.title.toLowerCase().indexOf(h.fieldName.toLowerCase()))){n=!0;break}var w=(h=this._removeVisualizationStretchFunction(this.renderingRule))&&h.functionName,x=[];if(10.4<=this.version){var C=!1;if(this.rasterFunctionInfos&&r){var z=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;f.forEach(this.rasterFunctionInfos,function(a){var b=z+a.name.replace(/ /gi,"_");f.some(r,function(a){return a.visible&&a.fieldName===
b})&&(C=C||w&&w===a.name,x.push(new y({rasterFunction:a.name})))})}h&&!C&&x.push(h)}m=new J;if(m.geometry=b.geometry,m.returnGeometry=this._map.spatialReference.equals(this.spatialReference),m.returnCatalogItems=n,m.timeExtent=b.timeExtent,m.mosaicRule=this.mosaicRule||null,m.renderingRule=10.4>this.version&&h||null,m.renderingRules=x||null,g)b=new u((g.extent.xmax-g.extent.xmin)/g.width,(g.extent.ymax-g.extent.ymin)/g.height,g.extent.spatialReference),m.pixelSize=b;c.requestParams=m;var D=this;b=
new I(this.url);return(l._pendingDfd=b.execute(m)).addCallbacks(function(a){D._queryVisibleRastersHandler(a,c,d,e,l)},function(a){D._resolve([a],null,e,l,!0)}),l},_queryVisibleRastersHandler:function(a,c,d,e,g){function l(){var a,b,e,l,q,r,t,w,C,z,y,D=this.getCustomRasterFields(c),E=this._getDomainFields(D),G=c?c.returnDomainValues:!1,F=c&&c.rasterAttributeTableFieldPrefix;this._useRenderingRuleAttributeTable&&this.renderingRule?(z=this._getRenderingRuleAttributeTableFeatures({renderingRule:this.renderingRule}),
y=u):z=this._getRasterAttributeTableFeatures();z.then(k.hitch(this,function(c){for(a=0;a<h.length;a++){if(H=h[a],H.setInfoTemplate(this.infoTemplate),H._layer=this,u){if(C=u.replace(/ /gi,"").split(","),b=u,e=C,m&&m.length>=a&&(b=m[a].replace(/ /gi,", "),e=m[a].split(" ")),H.attributes[this._rasterFieldPrefix+"ItemPixelValue"]=e,H.attributes[this._rasterFieldPrefix+"ServicePixelValue"]=C,x&&(H.attributes[this._rasterFieldPrefix+"ServicePixelValue.Raw"]=x.replace(/ /gi,"").split(",")),this.pixelFilter){var z=
new B({height:1,width:1,pixelType:"F32",pixels:[],statistics:[]});f.forEach(e,function(a){z.addData({pixels:[a],statistics:{minValue:a,maxValue:a,noDataValue:null}})});this.pixelFilter({pixelBlock:z,extent:new v(0,0,0,0,this._map.spatialReference)});("esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType)&&(H.attributes[this._rasterFieldPrefix+"Magnitude"]=z.pixels[0][0],H.attributes[this._rasterFieldPrefix+"Direction"]=z.pixels[1][0])}f.forEach(A,
function(a){H.attributes[a.name]=a.value});var D=y||b;if(c&&0<c.length&&(l=f.filter(c,function(a){return a&&a.attributes?a.attributes.hasOwnProperty("Value")?a.attributes.Value==D:a.attributes.VALUE==D:void 0}),0<l.length&&(q=k.clone(l[0]),F&&q))){w={};for(r in q.attributes)q.attributes.hasOwnProperty(r)&&(t=F+r,w[t]=q.attributes[r]);q.attributes=w;H.attributes=k.mixin(H.attributes,q.attributes)}}G&&E&&0<E.length&&f.forEach(E,function(a){if(a){var b=H.attributes[a.name];n.isDefined(b)&&(b=this._getDomainValue(a.domain,
b),n.isDefined(b)&&(H.attributes[a.name]=b))}},this);P.push(H);this._visibleRasters.push(H)}this._resolve([P,null,!0],null,d,g)}))}var m,h,r,t,u=a.value,x=a.value,C=0,z=0,y=this,D=this.objectIdField,A=[];e=c.requestParams.renderingRules;var E=a.processedValues,F=this.renderingRule&&b.toJson(this._removeVisualizationStretchFunction(this.renderingRule).toJson());if(e&&E&&e.length===E.length){var L=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;f.forEach(e,function(a,c){if(a.functionName){var d=
{name:L+a.functionName.replace(/ /gi,"_"),value:E[c].replace(/ /gi,"").split(",")};A.push(d);F&&F===b.toJson(a.toJson())&&(u=E[c])}})}if(e=this.infoTemplate&&this.infoTemplate.info&&this.infoTemplate.info.layerOptions&&this.infoTemplate.info.layerOptions.hasOwnProperty("showNoDataRecords")?this.infoTemplate.info.layerOptions.showNoDataRecords:!0,a.catalogItems){var I,J,K=0,M=a.catalogItems.features.length;t=0;h=Array(M);m=Array(M);r=Array(M);for(C=0;M>C;C++)-1<a.properties.Values[C].toLowerCase().indexOf("nodata")&&
t++;I=M-t;for(C=0;M>C;C++)t=!0,-1<a.properties.Values[C].toLowerCase().indexOf("nodata")?(J=I++,e||(t=!1,h.length--,m.length--,r.length--)):J=K++,t&&(h[J]=a.catalogItems.features[C],m[J]=a.properties.Values[C],r[J]=h[J].attributes[D])}this._visibleRasters=[];var H;a=-1<u.toLowerCase().indexOf("nodata");(a&&!e&&(h=[],m=[],r=[]),!u||h||a)||(D="ObjectId",h=[],H=new G(new v(this.fullExtent),null,{ObjectId:0}),h.push(H));var P=[];return h?void(!this._map.spatialReference.equals(this.spatialReference)&&
r&&0<r.length?q({url:this._url.path+"/query",content:{f:"json",objectIds:r.join(","),returnGeometry:!0,outSR:b.toJson(y._map.spatialReference.toJson()),outFields:D},handleAs:"json",callbackParamName:"callback",load:function(a){if(0===a.features.length)return void y._resolve([P,null,null],null,d,g);for(C=0;C<a.features.length;C++)for(z=0;z<h.length;z++)h[z].attributes[D]==a.features[C].attributes[D]&&(h[z].geometry=new w(a.features[C].geometry),h[z].geometry.setSpatialReference(y._map.spatialReference));
l.call(y)},error:function(a){y._resolve([P,null,null],null,d,g)}}):l.call(this)):void this._resolve([P,null,null],null,d,g)},getVisibleRasters:function(){var a,b=this._visibleRasters,c=[];for(a in b)b.hasOwnProperty(a)&&c.push(b[a]);return c},_getDomainFields:function(a){if(a){var b=[];return f.forEach(a,function(a){if(a.domain){var c={};c.name=a.name;c.domain=a.domain;b.push(c)}}),b}},_getDomainValue:function(a,b){if(a&&a.codedValues){var c;return f.some(a.codedValues,function(a){return a.code===
b?(c=a.name,!0):!1}),c}},_requestData:function(a,b,c){this._rasterReadPromise&&this._rasterReadPromise.cancel();a=k.clone(a);var d=a._normalize(!0);this._prepareGetImageParameters(d,b,c);b=k.clone(this._params);this._cleanupRequestParams(b);b.extent=a;b.format=b.format||(10.3<=this.version?"lerc":"jpgpng");"lerc"===b.format.toLowerCase()&&!b.lercVersion&&10.5<=this.version&&(b.lercVersion=2);c=null;this._useBrowserDecoding()&&(c=new D({ctx:this._context}));b={imageServiceParameters:b,nBands:Math.min(this.bandCount,
3),pixelType:this.pixelType,decodeFunc:c?k.hitch(c,"decode"):null};this._rasterReadPromise=this.raster.read(b,this._requestDataHandler,this._requestDataErrorHandler)},_requestDataHandler:function(a){this._rasterReadPromise&&this._rasterReadPromise.isCanceled()||(this.originalPixelData=a,this.hasDataChanged=!0,this._setPixelData(a))},_setPixelData:function(a){a=this._clonePixelData(a);this.pixelFilter&&this.pixelFilter(a);this.pixelData=a;this._rasterReadPromise&&this._rasterReadPromise.isCanceled()||
(this._drawPixelData(),this._rasterReadPromise=null)},_clonePixelData:function(a){if(null===a||void 0===a)return a;var b={};a.extent&&(b.extent=k.clone(a.extent));a=a.pixelBlock;return null===a||void 0===a?b:(b.pixelBlock=a.clone(),b)},_setDefaultFilter:function(){},_getPixelBlockFromCanvas:function(a,b,c){for(var d,e,f=a.getImageData(0,0,b,c).data,g=b*c,l=0,m=0,h=new Uint8Array(g),n=new Uint8Array(g),k=new Uint8Array(g),q=new Uint8Array(g),r=1/0,t=1/0,v=1/0,u=-(1/0),w=-(1/0),x=-(1/0),l=0;g>l;l++)a=
f[m++],d=f[m++],e=f[m++],r=a>r?r:a,u=u>a?u:a,t=d>t?t:d,w=w>d?w:d,v=e>v?v:e,x=x>e?x:e,h[l]=a,n[l]=d,k[l]=e,q[l]=1&f[m++];return new B({width:b,height:c,pixels:[h,n,k],pixelType:"U8",mask:q,statistics:[{minValue:r,maxValue:u},{minValue:t,maxValue:w},{minValue:v,maxValue:x}]})},_useBrowserDecoding:function(){return(void 0===this.pixelFilter||null===this.pixelFilter)&&("jpeg"===this.format.toLowerCase()||"jpg"===this.format.toLowerCase()||-1<this.format.toLowerCase().indexOf("png"))},getMultidimensionalInfo:function(){var b=
this._url.path+"/multiDimensionalInfo",c=new a(t._dfdCanceller);if(this._multidimensionalInfo)return c.resolve(this._multidimensionalInfo),c;10.3<=this.version&&this.hasMultidimensions?(c._pendingDfd=q({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),c._pendingDfd.then(k.hitch(this,function(a){this._multidimensionalInfo=a.multidimensionalInfo;c.callback(a.multidimensionalInfo)}),function(a){c.errback(a)})):(b=Error("Layer does not support multidimensional info"),b.log=e.isDebug,
c.errback(b));return c},getDefaultMultidimensionalDefinition:function(){var b,c,d,e=[],f=new a(t._dfdCanceller);return this._defaultMultidimensionalDefinition?(f.resolve(this._defaultMultidimensionalDefinition),f):(f._pendingDfd=this.getMultidimensionalInfo(),f._pendingDfd.then(k.hitch(this,function(a){b=a;c=b.variables[0].dimensions;for(d in c)c.hasOwnProperty(d)&&(c[d].hasRanges?e.push(new A({variableName:"",dimensionName:c[d].name,isSlice:!1,values:[c[d].values[0]]})):e.push(new A({variableName:"",
dimensionName:c[d].name,isSlice:!0,values:[c[d].extent[0]]})));this._defaultMultidimensionalDefinition=e;f.callback(e)}),function(a){f.errback(a)}),f)},_setDefaultMultidimensionalDefinition:function(a){var b,c={};this.getDefaultMultidimensionalDefinition().then(k.hitch(this,function(d){b=d;0<b.length&&(this.mosaicRule?(c=k.clone(this.mosaicRule),c.multidimensionalDefinition=b):this.defaultMosaicRule?(c=k.clone(this.defaultMosaicRule),c.multidimensionalDefinition=b):c=new x({multidimensionalDefinition:b}),
this.setMosaicRule(c,a))}))},_setDefaultRenderingRule:function(a){var b={};if(!this.renderingRule&&"esri.layers.ArcGISImageServiceVectorLayer"!==this.declaredClass&&this.rasterFunctionInfos&&this.rasterFunctionInfos.length&&"none"!==this.rasterFunctionInfos[0].name.toLowerCase())b.rasterFunction=this.rasterFunctionInfos[0].name;else if(!this.renderingRule&&"esri.layers.ArcGISImageServiceVectorLayer"===this.declaredClass&&10.3<this.version){var c="esriImageServiceDataTypeVector-UV"===this.serviceDataType?
7:10;b.rasterFunction="Resample";b.rasterFunctionArguments={ResamplingType:c,InputCellSize:{x:this.pixelSizeX,y:this.pixelSizeY}}}b.hasOwnProperty("rasterFunction")&&(this.defaultRenderingRule=new y(b),this.setRenderingRule(this.defaultRenderingRule,a))},_cleanupRequestParams:function(a){if(!a)return a;if(a.time&&a.mosaicRule){var c=new x(b.fromJson(a.mosaicRule));if(c&&c.multidimensionalDefinition&&0<c.multidimensionalDefinition.length){var d=f.filter(c.multidimensionalDefinition,function(a){return"StdTime"!==
a.dimensionName});c.multidimensionalDefinition=d;a.mosaicRule=b.toJson(c.toJson())}}var e,c="displayOnPan drawMode styling id opacity visible resourceInfo useMapDimensionValue extent".split(" ");for(e in c)a.hasOwnProperty(c[e])&&delete a[c[e]];return a},_removeVisualizationStretchFunction:function(a){var b=a&&a.functionName;if(!b||"stretch"!==b.toLowerCase())return a;var c=a.functionArguments.Raster;return c&&c.functionName&&f.some(this.rasterFunctionInfos,function(a){return c.functionName===a.name})?
c:a},_isScientificData:function(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType||"esriImageServiceDataTypeScientific"===this.serviceDataType},_isVectorData:function(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType},_isRasterFunctionInfoAvailable:function(a){return f.some(a&&(this.rasterFunctionInfos||[]),function(b){return b&&b.name&&
b.name.toLowerCase()===a.toLowerCase()})},_createPixelData:function(a){a=new B({width:2,height:2,pixels:a,pixelType:this.pixelType,statistics:a});var b=this.fullExtent.getCenter(),b=new v(b.x,b.y,b.x+this.pixelSizeX,b.y+this.pixelSizeY,this.spatialReference);return{pixelBlock:a,extent:b}},_resolve:function(a,b,c,d,e){b&&this[b].apply(this,a);c&&c.apply(null,a);d&&t._resDfd(d,a,e)},_toggleTime:function(){var a=this._map;this.timeInfo&&this.useMapTime&&a&&!this.suspended?(this._timeConnect||(this._timeConnect=
l.connect(a,"onTimeExtentChange",this,this._onTimeExtentChangeHandler)),this._setTime(a.timeExtent)):(l.disconnect(this._timeConnect),this._timeConnect=null,this._setTime(null))},setUseMapTime:function(a,b){this.useMapTime=a;this._toggleTime();!b&&this._map&&this.refresh(!0)},_setTime:function(a){this._params&&(this._params.time=a?a.toJson().join(","):null)},_onTimeExtentChangeHandler:function(a){this.suspended||(this._setTime(a),this.refresh(!0))},handleSpatialReferenceChange:function(){this.onSpatialReferenceChange()}});
return m("extend-esri")&&k.setObject("layers.ImageServiceLayerMixin",h,d),h})},"esri/layers/MosaicRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../geometry/Point".split(" "),function(h,k,a,f,b,e){var l=h(null,{declaredClass:"esri.layers.MosaicRule",method:null,where:null,sortField:null,sortValue:null,ascending:!1,lockRasterIds:null,viewpoint:null,objectIds:null,operation:null,multidimensionalDefinition:[],constructor:function(a){k.isObject(a)&&(k.mixin(this,
a),a.mosaicMethod&&(this.method=a.mosaicMethod),this.method&&"esri"!==this.method.toLowerCase().substring(0,4)&&(this.method=this._getMethodEnum(this.method)),a.mosaicOperation&&(this.operation=a.mosaicOperation),this.operation&&"MT_"!==this.operation.toUpperCase().substring(0,3)&&(this.operation=this._getOperatorEnum(this.operation)),a.fids&&(this.objectIds=a.fids),a.viewpoint&&(this.viewpoint=new e(a.viewpoint)),this.multidimensionalDefinition=a.multidimensionalDefinition||[])},toJson:function(){var a=
null,e=this.multidimensionalDefinition?this.multidimensionalDefinition.length:0;if(e)for(var a=[],d=0;e>d;d++)a.push("esri.layers.DimensionalDefinition"===this.multidimensionalDefinition[d].declaredClass?this.multidimensionalDefinition[d].toJson():this.multidimensionalDefinition[d]);a={mosaicMethod:this.method,where:this.where,sortField:this.sortField,sortValue:this.sortValue,ascending:this.ascending,lockRasterIds:this.lockRasterIds,viewpoint:this.viewpoint?this.viewpoint.toJson():null,fids:this.objectIds,
mosaicOperation:this.operation,multidimensionalDefinition:a};return b.filter(a,function(a){return null!==a?!0:void 0})},_getMethodEnum:function(a){if(a){var b=l.METHOD_NONE;switch(a.toLowerCase()){case "byattribute":b=l.METHOD_ATTRIBUTE;break;case "center":b=l.METHOD_CENTER;break;case "lockraster":b=l.METHOD_LOCKRASTER;break;case "nadir":b=l.METHOD_NADIR;break;case "northwest":b=l.METHOD_NORTHWEST;break;case "seamline":b=l.METHOD_SEAMLINE;break;case "viewpoint":b=l.METHOD_VIEWPOINT}return b}},_getOperatorEnum:function(a){if(a)switch(a.toLowerCase()){case "first":return l.OPERATION_FIRST;
case "last":return l.OPERATION_LAST;case "max":return l.OPERATION_MAX;case "min":return l.OPERATION_MIN;case "blend":return l.OPERATION_BLEND;case "mean":return l.OPERATION_MEAN;case "sum":return l.OPERATION_SUM}}});return k.mixin(l,{METHOD_NONE:"esriMosaicNone",METHOD_CENTER:"esriMosaicCenter",METHOD_NADIR:"esriMosaicNadir",METHOD_VIEWPOINT:"esriMosaicViewpoint",METHOD_ATTRIBUTE:"esriMosaicAttribute",METHOD_LOCKRASTER:"esriMosaicLockRaster",METHOD_NORTHWEST:"esriMosaicNorthwest",METHOD_SEAMLINE:"esriMosaicSeamline",
OPERATION_FIRST:"MT_FIRST",OPERATION_LAST:"MT_LAST",OPERATION_MIN:"MT_MIN",OPERATION_MAX:"MT_MAX",OPERATION_MEAN:"MT_MEAN",OPERATION_BLEND:"MT_BLEND",OPERATION_SUM:"MT_SUM"}),a("extend-esri")&&k.setObject("layers.MosaicRule",l,f),l})},"esri/layers/RasterFunction":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(h,k,a,f,b){var e=h(null,{declaredClass:"esri.layers.RasterFunction",functionName:null,arguments:null,functionArguments:null,variableName:null,
outputPixelType:null,constructor:function(a){if(k.isObject(a)){var b,e=0;if(this.functionName=a.rasterFunction,this.functionArguments=k.clone(a.rasterFunctionArguments||a.arguments),k.mixin(this,a),b=this.functionArguments,b&&(b.Raster=this._toRasterFunction(b.Raster),b.Raster2=this._toRasterFunction(b.Raster2),b.DEM=this._toRasterFunction(b.DEM),b.FillRaster=this._toRasterFunction(b.FillRaster),b.Rasters&&b.Rasters.length))for(e=0;e<b.Rasters.length;e++)b.Rasters[e]=this._toRasterFunction(b.Rasters[e])}},
_toRasterFunction:function(a){return a&&(a.rasterFunction||a.functionName)?new e(a):a},_rfToJson:function(a){return a&&"esri.layers.RasterFunction"===a.declaredClass&&(a=a.toJson()),a},toJson:function(){var a=k.clone(this.functionArguments||this.arguments);if(a&&(a.Raster=this._rfToJson(a.Raster),a.Raster2=this._rfToJson(a.Raster2),a.DEM=this._rfToJson(a.DEM),a.FillRaster=this._rfToJson(a.FillRaster),a.Rasters&&a.Rasters.length)){var e,f=[];for(e=0;e<a.Rasters.length;e++)f.push(this._rfToJson(a.Rasters[e]));
a.Rasters=f}return b.filter({rasterFunction:this.functionName,rasterFunctionArguments:a,variableName:this.variableName,outputPixelType:this.outputPixelType?this.outputPixelType:null},function(a){return null!==a&&void 0!==a?!0:void 0})}});return a("extend-esri")&&k.setObject("layers.RasterFunction",e,f),e})},"esri/layers/DimensionalDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(h,k,a,f,b){h=h(null,{declaredClass:"esri.layers.DimensionalDefinition",
variableName:null,dimensionName:null,values:[],isSlice:!1,constructor:function(a){k.isObject(a)&&k.mixin(this,a)},toJson:function(){return b.filter({variableName:this.variableName,dimensionName:this.dimensionName,values:this.values,isSlice:this.isSlice},function(a){return null!==a})}});return a("extend-esri")&&k.setObject("layers.DimensionalDefinition",h,f),h})},"esri/layers/Raster":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/config dojo/json dojo/sniff ../kernel ../Evented ../request ../geometry/Extent ../SpatialReference ../deferredUtils ./PixelBlock ./rasterFormats/LercCodec ./rasterFormats/Lerc2Codec".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u){var w,x,y,A,z,B;k=k(d,{declaredClass:"esri.layers.Raster",imageServiceUrl:null,validPixelTypes:"U1 U2 U4 U8 U16 U32 S8 S16 S32 F32".split(" "),validFormats:"lerc jpeg jpg jpgpng png png8 png24 png32 bip bsq tiff".split(" "),_eventMap:{"raster-read-complete":["pixelData","params"]},constructor:function(a){this.imageServiceUrl=a;this.registerConnectEvents();this._loadRasterFormatModules()},read:function(d,e,g){var l=this,h=new f(t._dfdCanceller);if(10>m("ie"))throw"This browser is not supported.";
if(!d.imageServiceParameters)throw"Insufficient parameters to read data";var n=a.clone(d.imageServiceParameters),k=d.pixelType;b.some(this.validPixelTypes,function(a){return a===k})||(n.pixelType="F32");b.some(this.validFormats,function(a){return a.toLowerCase()===n.format.toLowerCase()})||(n.format="lerc");var q,r=d.decodeFunc;this._prepareGetImageParameters(n);var v=n.width,u=n.height,w=n.extent;return delete n.width,delete n.height,delete n.extent,h._pendingDfd=c({url:this.imageServiceUrl+"/exportImage",
handleAs:"arraybuffer",content:a.mixin(n,{f:"image"}),load:function(a){l.decode(a,{width:v,height:u,planes:null,pixelType:k,noDataValue:n.noData,format:n.format,decodeFunc:r}).then(function(a){q={pixelBlock:a,extent:w};l._resolve([q,n],"onRasterReadComplete",e,h)},function(a){l._resolve([a],null,g,h,!0)})},error:function(a){l._resolve([a],null,g,h,!0)}}),h.promise},decode:function(a,b){if(void 0===b||null===b)throw"missing decode options";var c,d;return b.format&&(c=b.format.toUpperCase()),"BSQ"!==
c&&"BIP"!==c&&(c=this._getFormat(a)),d=b.decodeFunc,(void 0===d||null===d)&&(d=this._getFormatDecoderDfd(c)),d(a,b)},onRasterReadComplete:function(){},_prepareGetImageParameters:function(b){if(b.size&&b.bbox){var c=b.size.split(",");(b.width=parseFloat(c[0]),b.height=parseFloat(c[1]),b.extent)||(c=b.bbox.split(","),b.extent=new n(parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2]),parseFloat(c[3]),new q(b.bboxSR)))}else{if(!b.width||Math.floor(b.width)!==b.width||!b.height||Math.floor(b.height)!==
b.height)throw"Incorrect Image Dimensions";if(!b.extent||"esri.geometry.Extent"!==b.extent.declaredClass)throw"Incorrect extent";var c=b.extent,d=c.spatialReference.wkid||l.toJson(c.spatialReference.toJson());delete b._ts;a.mixin(b,{bbox:c.xmin+","+c.ymin+","+c.xmax+","+c.ymax,imageSR:d,bboxSR:d,size:b.width+","+b.height},b.disableClientCaching?{_ts:(new Date).getTime()}:{})}},_adjustExtent:function(a,b,c){var d=a.ymax-a.ymin,e=a.xmax-a.xmin;return c>=b?(d=e*b/c,a.ymax=a.ymin+d):(e=d*c/b,a.xmax=a.xmin+
e),a},_resolve:function(a,b,c,d,e){b&&this[b].apply(this,a);c&&c.apply(null,a);d&&t._resDfd(d,a,e)},_getFormatDecoderDfd:function(b){var c=null;switch(b){case "LERC":c=this._decodeLerc;break;case "LERC2":c=this._decodeLerc2;break;case "JPEG":c=this._decodeJpeg;break;case "PNG":c=this._decodePng;break;case "BSQ":c=this._decodeBsq;break;case "BIP":c=this._decodeBip;break;case "TIFF":c=this._decodeTiff;break;default:c=function(a,b){throw"The raster format is not supported";}}c=a.hitch(this,c);return function(a,
d){var e=new f;try{var g;"LERC"===b||!0===z?(g=c(a,d),e.resolve(g)):B.then(function(){g=c(a,d);e.resolve(g)})}catch(K){e.reject(K)}return e}},_getFormat:function(a){a=new Uint8Array(a,0,10);var b="";return 255===a[0]&&216===a[1]?b="JPEG":137===a[0]&&80===a[1]&&78===a[2]&&71===a[3]?b="PNG":67===a[0]&&110===a[1]&&116===a[2]&&90===a[3]&&73===a[4]&&109===a[5]&&97===a[6]&&103===a[7]&&101===a[8]&&32===a[9]?b="LERC":76===a[0]&&101===a[1]&&114===a[2]&&99===a[3]&&50===a[4]&&32===a[5]?b="LERC2":-1<String.fromCharCode.apply(null,
a).toLowerCase().indexOf("error")?b="ERROR":(73===a[0]&&73===a[1]&&42===a[2]&&0===a[3]||77===a[0]&&77===a[1]&&0===a[2]&&42===a[3])&&(b="TIFF"),b},_validateDecodeParams:function(a){if(!a.height||Math.floor(a.height)!==a.height)throw"Height not provided.";if(!a.width||Math.floor(a.width)!==a.width)throw"Width not provided.";},_decodeJpeg:function(a,b){if(!w)throw"The jpeg decoder module is not loaded.";this._validateDecodeParams(b);var c=(new w).decode(a);if(!F(c,b))throw"The decoded image dimensions are incorrect.";
var d,e,f=[];for(d=0;d<c.pixels.length;d++)e=c.pixels[d],f.push(this._calculateBandStatistics(e));return new r({width:c.width,height:c.height,pixels:c.pixels,pixelType:"U8",mask:c.mask,statistics:f})},_decodePng:function(a,b){if(!x)throw"The png decoder module is not loaded.";this._validateDecodeParams(b);var c=new Uint8Array(a),d=new x(c),c=new Uint8Array(b.width*b.height*4);d.copyToImageData(c,d.decodePixels());var e,f=d=0;e=new Uint8Array(b.width*b.height);for(d=0;d<b.width*b.height;d++)e[d]=c[4*
d+3];for(var g=new r({width:b.width,height:b.height,pixels:[],pixelType:"U8",mask:e,statistics:[]}),d=0;3>d;d++){e=new Uint8Array(b.width*b.height);for(f=0;f<b.width*b.height;f++)e[f]=c[4*f+d];g.addData({pixels:e,statistics:this._calculateBandStatistics(e)})}return g},_decodeBsq:function(a,b){if(!y)throw"The bsq decoder module is not loaded.";this._validateDecodeParams(b);D=b.noDataValue;b.pixelType=E(b.pixelType);var c,d=y.decodeBSQ(a,{bandCount:b.planes,width:b.width,height:b.height,pixelType:C,
noDataValue:D}),e=[],f=null;for(c=0;c<d.pixels.length;c++)f=d.pixels[c],e.push(this._calculateBandStatistics(f));return new r({width:b.width,height:b.height,pixels:d.pixels,pixelType:b.pixelType,mask:d.maskData,statistics:e})},_decodeBip:function(a,b){this._validateDecodeParams(b);D=b.noDataValue;b.pixelType=E(b.pixelType);var c,d=y.decodeBIP(a,{bandCount:b.planes,width:b.width,height:b.height,pixelType:C,noDataValue:D}),e=[],f=null;for(c=0;c<d.pixels.length;c++)f=d.pixels[c],e.push(this._calculateBandStatistics(f));
return new r({width:b.width,height:b.height,pixels:d.pixels,pixelType:b.pixelType,mask:d.maskData,statistics:e})},_decodeTiff:function(a,b){this._validateDecodeParams(b);D=b.noDataValue;b.pixelType=E(b.pixelType);var c,d=A.decode(a),e=[],f=null;for(c=0;c<d.pixels.length;c++)f=d.pixels[c],e.push(this._calculateBandStatistics(f,d.maskData));return new r({width:d.width,height:d.height,pixels:d.pixels,pixelType:d.pixelType,mask:d.maskData,statistics:e})},_decodeLerc:function(a,b){this._validateDecodeParams(b);
D=b.noDataValue;b.pixelType=E(b.pixelType);for(var c,d,e=0,f=0,g=a.byteLength-10;g>f;){var l=v.decode(a,{inputOffset:f,encodedMaskData:c,returnMask:0===e?!0:!1,returnEncodedMask:0===e?!0:!1,returnFileInfo:!0,pixelType:C,noDataValue:D});if(f=l.fileInfo.eofOffset,0===e&&(c=l.encodedMaskData,d=new r({width:b.width,height:b.height,pixels:[],pixelType:b.pixelType,mask:l.maskData,statistics:[]})),e++,!F(l,b))throw"The decoded image dimensions are incorrect";d.addData({pixels:l.pixelData,statistics:{minValue:l.minValue,
maxValue:l.maxValue,noDataValue:l.noDataValue}})}return d},_decodeLerc2:function(a,b){this._validateDecodeParams(b);D=b.noDataValue;b.pixelType=E(b.pixelType);for(var c,d,e,f=0,g=0,l=a.byteLength-10;l>g;){if(d=u.decode(a,{inputOffset:g,maskData:c,returnFileInfo:!0}),g=d.fileInfo.eofOffset,0===f&&(c=d.maskData,e=new r({width:b.width,height:b.height,pixels:[],pixelType:d.fileInfo.pixelType,mask:d.maskData,statistics:[]})),f++,!F(d,b))throw"The decoded image dimensions are incorrect";e.addData({pixels:d.pixelData,
statistics:{minValue:d.minValue,maxValue:d.maxValue,noDataValue:d.noDataValue}})}return e},_calculateBandStatistics:function(a,b){var c,d=1/0,e=-(1/0),f=a.length,g=0;if(b)for(c=0;f>c;c++)b[c]&&(g=a[c],d=d>g?g:d,e=g>e?g:e);else for(c=0;f>c;c++)g=a[c],d=d>g?g:d,e=g>e?g:e;return{minValue:d,maxValue:e}},_loadRasterFormatModules:function(){z||(B||(B=new f),10>m("ie")?B.isRejected()||B.reject("unsupported browser version"):h(["./rasterFormats/JpgPlus","./rasterFormats/Png","./rasterFormats/Raw","./rasterFormats/TiffDecoder",
"./rasterFormats/Zlib"],function(a,b,c,d){w=a;x=b;y=c;A=d;z=!0;B.isResolved()||B.resolve(!0)}))}});var C=null,D=null,E=function(a){return"U1"===a||"U2"===a||"U4"===a||"U8"===a?(a="U8",D=Math.pow(2,8)-1,C=Uint8Array,a):"U16"===a?(D=D||Math.pow(2,16)-1,C=Uint16Array,a):"U32"===a?(D=D||Math.pow(2,32)-1,C=Uint32Array,a):"S8"===a?(D=D||0-Math.pow(2,7),C=Int8Array,a):"S16"===a?(D=D||0-Math.pow(2,15),C=Int16Array,a):"S32"===a?(D=D||0-Math.pow(2,31),C=Int32Array,a):(C=Float32Array,a)},F=function(a,b){return a.height!==
b.height||a.width!==b.width?!1:!0};return m("extend-esri")&&a.setObject("layers.Raster",k,g),k})},"esri/layers/PixelBlock":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h([],{declaredClass:"esri.layers.PixelBlock",planes:null,width:null,height:null,pixelType:null,pixels:[],statistics:[],constructor:function(a){if(a){if(!a.width||Math.floor(a.width)!==a.width)throw"PixelBlock: incorrect width";if(!a.height||Math.floor(a.height)!==a.height)throw"PixelBlock: incorrect height";
if(!a.pixels||!a.statistics)throw"PixelBlock: pixel data or statistics not present";this.width=a.width;this.height=a.height;this.pixels=a.pixels;this.pixelType=a.pixelType||null;this.statistics=a.statistics;this.mask=a.mask||null}},getPlaneCount:function(){return this.pixels.length!==this.statistics.length?console.error("Inconsistent pixel data and statistics"):this.statistics.length},addData:function(a){if(!a.pixels||!a.statistics)throw"Pixel data or statistics are not present";if(a.pixels.length!==
this.width*this.height)throw"Inconsistent pixel data size";this.statistics.push(a.statistics);this.pixels.push(a.pixels)},getAsRGBA:function(){var a=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "S8":case "S16":case "U16":case "S32":case "U32":case "F32":case "F64":this._fillFromNon8Bit(a);break;default:this._fillFrom8Bit(a)}return new Uint8ClampedArray(a)},getAsRGBAFloat:function(){var a=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(a),a},clone:function(){var a=
new this.constructor;a.width=this.width;a.height=this.height;a.pixelType=this.pixelType;this.mask&&(a.mask=new Uint8Array(this.mask));var e,f;if(this.pixels)for(a.pixels=[],f=this.pixels.length,e=0;f>e;e++)a.pixels[e]=new Float32Array(this.pixels[e]);if(this.statistics)for(a.statistics=[],f=this.statistics.length,e=0;f>e;e++)a.statistics[e]=k.clone(this.statistics[e]);return a},_fillFrom8Bit:function(a){var b=this.pixels,f=this.mask;if(!a||!b||!b.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");
var h,g,d;h=g=d=b[0];3<=b.length&&(g=b[1],d=b[2]);var b=new Uint32Array(a),c=this.width*this.height;if(h.length!==c)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");if(f&&f.length===c)for(a=0;c>a;a++)f[a]&&(b[a]=-16777216|d[a]<<16|g[a]<<8|h[a]);else for(a=0;c>a;a++)b[a]=-16777216|d[a]<<16|g[a]<<8|h[a]},_fillFromNon8Bit:function(a){var b=this.pixels,f=this.mask,h=this.statistics;if(!a||!b||!b.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");
var g=1,d=0;h&&0<h.length?(d=h[0].minValue,g=255/(h[0].maxValue-h[0].minValue)):(g=255,"S8"===this.pixelType?(d=-128,g=127):"U16"===this.pixelType?g=65535:"S16"===this.pixelType?(d=-32768,g=32767):"U32"===this.pixelType?g=4294967295:"S32"===this.pixelType?(d=-2147483648,g=2147483647):"F32"===this.pixelType?(d=-3.4E39,g=3.4E39):"F64"===this.pixelType&&(d=-Number.MAX_VALUE,g=Number.MAX_VALUE),g=255/(g-d));var c,n,k;a=new Uint32Array(a);h=this.width*this.height;if(c=b[0],c.length!==h)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");
if(3<=b.length)if(n=b[1],k=b[2],f&&f.length===h)for(b=0;h>b;b++)f[b]&&(a[b]=-16777216|(k[b]-d)*g<<16|(n[b]-d)*g<<8|(c[b]-d)*g);else for(b=0;h>b;b++)a[b]=-16777216|(k[b]-d)*g<<16|(n[b]-d)*g<<8|(c[b]-d)*g;else if(f&&f.length===h)for(b=0;h>b;b++)n=(c[b]-d)*g,f[b]&&(a[b]=-16777216|n<<16|n<<8|n);else for(b=0;h>b;b++)n=(c[b]-d)*g,a[b]=-16777216|n<<16|n<<8|n},_fillFrom32Bit:function(a){var b=this.pixels,f=this.mask;if(!a||!b||!b.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");
var h,g,d;h=g=d=b[0];3<=b.length&&(g=b[1],d=b[2]);var c=this.width*this.height;if(h.length!==c)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");var n=0;if(f&&f.length===c)for(b=0;c>b;b++)a[n++]=h[b],a[n++]=g[b],a[n++]=d[b],a[n++]=f[b];else for(b=0;c>b;b++)a[n++]=h[b],a[n++]=g[b],a[n++]=d[b],a[n++]=255}});return a("extend-esri")&&k.setObject("layers.PixelBlock",h,f),h})},"esri/layers/rasterFormats/LercCodec":function(){define([],function(){var h={defaultNoDataValue:-3.4027999387901484E38,
decode:function(a,f){var b;f=f||{};var e;e=f.inputOffset||0;var l=f.encodedMaskData||null===f.encodedMaskData,m={},g=new Uint8Array(a,e,10);if(m.fileIdentifierString=String.fromCharCode.apply(null,g),"CntZImage"!=m.fileIdentifierString.trim())throw"Unexpected file identifier string: "+m.fileIdentifierString;e+=10;g=new DataView(a,e,24);m.fileVersion=g.getInt32(0,!0);m.imageType=g.getInt32(4,!0);m.height=g.getUint32(8,!0);m.width=g.getUint32(12,!0);m.maxZError=g.getFloat64(16,!0);e+=24;var d;if(!l)if(g=
new DataView(a,e,16),m.mask={},m.mask.numBlocksY=g.getUint32(0,!0),m.mask.numBlocksX=g.getUint32(4,!0),m.mask.numBytes=g.getUint32(8,!0),m.mask.maxValue=g.getFloat32(12,!0),e+=16,0<m.mask.numBytes){d=new Uint8Array(Math.ceil(m.width*m.height/8));var g=new DataView(a,e,m.mask.numBytes),l=g.getInt16(0,!0),c=2,n=0;do{if(0<l)for(;l--;)d[n++]=g.getUint8(c++);else for(var q=g.getUint8(c++),l=-l;l--;)d[n++]=q;l=g.getInt16(c,!0);c+=2}while(c<m.mask.numBytes);if(-32768!==l||n<d.length)throw"Unexpected end of mask RLE encoding";
m.mask.bitset=d;e+=m.mask.numBytes}else 0===(m.mask.numBytes|m.mask.numBlocksY|m.mask.maxValue)&&(d=new Uint8Array(Math.ceil(m.width*m.height/8)),m.mask.bitset=d);g=new DataView(a,e,16);m.pixels={};m.pixels.numBlocksY=g.getUint32(0,!0);m.pixels.numBlocksX=g.getUint32(4,!0);m.pixels.numBytes=g.getUint32(8,!0);m.pixels.maxValue=g.getFloat32(12,!0);e+=16;d=m.pixels.numBlocksX;g=m.pixels.numBlocksY;d+=0<m.width%d?1:0;l=g+(0<m.height%g?1:0);m.pixels.blocks=Array(d*l);for(n=c=0;l>n;n++)for(q=0;d>q;q++){var t=
0,g=new DataView(a,e,Math.min(10,a.byteLength-e)),r={};m.pixels.blocks[c++]=r;var v=g.getUint8(0);if(t++,r.encoding=63&v,3<r.encoding)throw"Invalid block encoding ("+r.encoding+")";if(2!==r.encoding){if(0!==v&&2!==v){if(v>>=6,r.offsetType=v,2===v)r.offset=g.getInt8(1),t++;else if(1===v)r.offset=g.getInt16(1,!0),t+=2;else{if(0!==v)throw"Invalid block offset type";r.offset=g.getFloat32(1,!0);t+=4}if(1===r.encoding)if(v=g.getUint8(t),t++,r.bitsPerPixel=63&v,v>>=6,r.numValidPixelsType=v,2===v)r.numValidPixels=
g.getUint8(t),t++;else if(1===v)r.numValidPixels=g.getUint16(t,!0),t+=2;else{if(0!==v)throw"Invalid valid pixel count type";r.numValidPixels=g.getUint32(t,!0);t+=4}}if(e+=t,3!=r.encoding)if(0===r.encoding){v=(m.pixels.numBytes-1)/4;if(v!==Math.floor(v))throw"uncompressed block has invalid length";g=new ArrayBuffer(4*v);t=new Uint8Array(g);t.set(new Uint8Array(a,e,4*v));g=new Float32Array(g);r.rawData=g;e+=4*v}else 1===r.encoding&&(v=Math.ceil(r.numValidPixels*r.bitsPerPixel/8),g=new ArrayBuffer(4*
Math.ceil(v/4)),t=new Uint8Array(g),t.set(new Uint8Array(a,e,v)),r.stuffedData=new Uint32Array(g),e+=v)}else e++}e=(m.eofOffset=e,m);var m=null!=f.noDataValue?f.noDataValue:h.defaultNoDataValue,l=f.encodedMaskData,u=f.returnMask,w,c=0,n=e.pixels.numBlocksX,q=e.pixels.numBlocksY,r=Math.floor(e.width/n),t=Math.floor(e.height/q),v=2*e.maxZError,g=Number.MAX_VALUE,l=l||(e.mask?e.mask.bitset:null);d=new (f.pixelType||Float32Array)(e.width*e.height);u&&l&&(b=new Uint8Array(e.width*e.height));for(var x,
y,u=new Float32Array(r*t),A=0;q>=A;A++){var z=A!==q?t:e.height%q;if(0!==z)for(var B=0;n>=B;B++){var C=B!==n?r:e.width%n;if(0!==C){var D,E,F,G=A*e.width*t+B*r,I=e.width-C,J=e.pixels.blocks[c];if(2>J.encoding){if(0===J.encoding)D=J.rawData;else{D=J.stuffedData;E=J.bitsPerPixel;x=J.numValidPixels;y=J.offset;var L=v,M=u,H=e.pixels.maxValue,K=void 0,P=void 0,O=void 0,S=(1<<E)-1,Q=0,R=0,aa=Math.ceil((H-y)/L);D[D.length-1]<<=8*(4*D.length-Math.ceil(E*x/8));for(K=0;x>K;K++)(0===R&&(O=D[Q++],R=32),R>=E)?(P=
O>>>R-E&S,R-=E):(R=E-R,P=(O&S)<<R&S,O=D[Q++],R=32-R,P+=O>>>R),M[K]=aa>P?y+P*L:H;D=u}E=0}else F=2===J.encoding?0:J.offset;var X;if(l)for(y=0;z>y;y++){7&G&&(X=l[G>>3],X<<=7&G);for(x=0;C>x;x++)7&G||(X=l[G>>3]),128&X?(b&&(b[G]=1),w=2>J.encoding?D[E++]:F,g=g>w?w:g,d[G++]=w):(b&&(b[G]=0),d[G++]=m),X<<=1;G+=I}else if(2>J.encoding)for(y=0;z>y;y++){for(x=0;C>x;x++)w=D[E++],g=g>w?w:g,d[G++]=w;G+=I}else for(g=g>F?F:g,y=0;z>y;y++){for(x=0;C>x;x++)d[G++]=F;G+=I}if(1===J.encoding&&E!==J.numValidPixels)throw"Block and Mask do not match";
c++}}}w={width:e.width,height:e.height,pixelData:d,minValue:g,maxValue:e.pixels.maxValue,noDataValue:m};b&&(w.maskData=b);f.returnEncodedMask&&e.mask&&(w.encodedMaskData=e.mask.bitset?e.mask.bitset:null);if(f.returnFileInfo&&(w.fileInfo=k(e),f.computeUsedBitDepths)){b=w.fileInfo;F=e.pixels.numBlocksX*e.pixels.numBlocksY;X={};for(D=0;F>D;D++)E=e.pixels.blocks[D],0===E.encoding?X.float32=!0:1===E.encoding?X[E.bitsPerPixel]=!0:X[0]=!0;F=Object.keys(X);b.bitDepths=F}return w}},k=function(a){return{fileIdentifierString:a.fileIdentifierString,
fileVersion:a.fileVersion,imageType:a.imageType,height:a.height,width:a.width,maxZError:a.maxZError,eofOffset:a.eofOffset,mask:a.mask?{numBlocksX:a.mask.numBlocksX,numBlocksY:a.mask.numBlocksY,numBytes:a.mask.numBytes,maxValue:a.mask.maxValue}:null,pixels:{numBlocksX:a.pixels.numBlocksX,numBlocksY:a.pixels.numBlocksY,numBytes:a.pixels.numBytes,maxValue:a.pixels.maxValue,noDataValue:this.noDataValue}}};return h})},"esri/layers/rasterFormats/Lerc2Codec":function(){define([],function(){var h={unstuff:function(a,
b,e,l,h,g,d,c){var f,m,k,r,v=(1<<e)-1,u=0,w=0;if(a[a.length-1]<<=8*(4*a.length-Math.ceil(e*l/8)),h)for(f=0;l>f;f++)0===w&&(k=a[u++],w=32),w>=e?(m=k>>>w-e&v,w-=e):(r=e-w,m=(k&v)<<r&v,k=a[u++],w=32-r,m+=k>>>w),b[f]=h[m];else for(h=Math.ceil((c-g)/d),f=0;l>f;f++)0===w&&(k=a[u++],w=32),w>=e?(m=k>>>w-e&v,w-=e):(r=e-w,m=(k&v)<<r&v,k=a[u++],w=32-r,m+=k>>>w),b[f]=h>m?g+m*d:c},unstuffLUT:function(a,b,e,l,h,g){var d,c=(1<<b)-1,f=0,m=0,k=0,r=0,v=0,u=[];a[a.length-1]<<=8*(4*a.length-Math.ceil(b*e/8));for(var w=
Math.ceil((g-l)/h),m=0;e>m;m++)0===r&&(d=a[f++],r=32),r>=b?(v=d>>>r-b&c,r-=b):(k=b-r,v=(d&c)<<k&c,d=a[f++],r=32-k,v+=d>>>r),u[m]=w>v?l+v*h:g;return u.unshift(l),u},unstuff2:function(a,b,e,l,h,g,d,c){var f,m,k,r,v=(1<<e)-1,u=0,w=0,x=0;if(h)for(f=0;l>f;f++)0===w&&(k=a[u++],w=32,x=0),w>=e?(m=k>>>x&v,w-=e,x+=e):(r=e-w,m=k>>>x&v,k=a[u++],w=32-r,m|=(k&(1<<r)-1)<<e-r,x=r),b[f]=h[m];else for(h=Math.ceil((c-g)/d),f=0;l>f;f++)0===w&&(k=a[u++],w=32,x=0),w>=e?(m=k>>>x&v,w-=e,x+=e):(r=e-w,m=k>>>x&v,k=a[u++],w=
32-r,m|=(k&(1<<r)-1)<<e-r,x=r),b[f]=h>m?g+m*d:c;return b},unstuffLUT2:function(a,b,e,l,h,g){for(var d,c=(1<<b)-1,f=0,m=0,k=0,r=0,v=0,u=0,w=[],x=Math.ceil((g-l)/h),m=0;e>m;m++)0===r&&(d=a[f++],r=32,u=0),r>=b?(v=d>>>u&c,r-=b,u+=b):(k=b-r,v=d>>>u&c,d=a[f++],r=32-k,v|=(d&(1<<k)-1)<<b-k,u=k),w[m]=x>v?l+v*h:g;return w.unshift(l),w},originalUnstuff:function(a,b,e,l){var f,g,d,c,h=(1<<e)-1,k=0,t=0;a[a.length-1]<<=8*(4*a.length-Math.ceil(e*l/8));for(f=0;l>f;f++)0===t&&(d=a[k++],t=32),t>=e?(g=d>>>t-e&h,t-=
e):(c=e-t,g=(d&h)<<c&h,d=a[k++],t=32-c,g+=d>>>t),b[f]=g;return b},originalUnstuff2:function(a,b,e,l){var f,g,d,c,h=(1<<e)-1,k=0,t=0,r=0;for(f=0;l>f;f++)0===t&&(d=a[k++],t=32,r=0),t>=e?(g=d>>>r&h,t-=e,r+=e):(c=e-t,g=d>>>r&h,d=a[k++],t=32-c,g|=(d&(1<<c)-1)<<e-c,r=c),b[f]=g;return b}},k={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(a){for(var b=65535,e=65535,f=a.length,h=Math.floor(f/2),g=0;h;){var d=359<=h?359:h,h=h-d;do b+=a[g++]<<8,e+=b+=a[g++];while(--d);b=(65535&b)+(b>>>16);e=(65535&
e)+(e>>>16)}return 1&f&&(e+=b+=a[g]<<8),b=(65535&b)+(b>>>16),e=(65535&e)+(e>>>16),(e<<16|b)>>>0},readHeaderInfo:function(a,b){var e=b.ptr,f=new Uint8Array(a,e,6),h={};if(h.fileIdentifierString=String.fromCharCode.apply(null,f),0!==h.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+h.fileIdentifierString;e+=6;f=new DataView(a,e,52);h.fileVersion=f.getInt32(0,!0);e+=4;3<=h.fileVersion&&(h.checksum=f.getUint32(4,!0),e+=4);f=new DataView(a,e,48);h.height=
f.getUint32(0,!0);h.width=f.getUint32(4,!0);h.numValidPixel=f.getUint32(8,!0);h.microBlockSize=f.getInt32(12,!0);h.blobSize=f.getInt32(16,!0);h.imageType=f.getInt32(20,!0);h.maxZError=f.getFloat64(24,!0);h.zMin=f.getFloat64(32,!0);h.zMax=f.getFloat64(40,!0);e+=48;b.headerInfo=h;b.ptr=e;var g;if(3<=h.fileVersion&&(g=this.computeChecksumFletcher32(new Uint8Array(a,e-48,h.blobSize-14)),g!==h.checksum))throw"Checksum failed.";return!0},readMask:function(a,b){var e=b.ptr,f=b.headerInfo,h=f.width*f.height,
g=f.numValidPixel,d=new DataView(a,e,4),f={};if(f.numBytes=d.getUint32(0,!0),e+=4,(0===g||h===g)&&0!==f.numBytes)throw"invalid mask";if(0===g)g=new Uint8Array(Math.ceil(h/8)),f.bitset=g,d=new Uint8Array(h),b.pixels.resultMask=d,e+=f.numBytes;else if(0<f.numBytes){var g=new Uint8Array(Math.ceil(h/8)),d=new DataView(a,e,f.numBytes),c=d.getInt16(0,!0),n=2,k=0,t=0;do{if(0<c)for(;c--;)g[k++]=d.getUint8(n++);else for(t=d.getUint8(n++),c=-c;c--;)g[k++]=t;c=d.getInt16(n,!0);n+=2}while(n<f.numBytes);if(-32768!==
c||k<g.length)throw"Unexpected end of mask RLE encoding";d=new Uint8Array(h);for(n=n=c=0;h>n;n++)7&n?(c=g[n>>3],c<<=7&n):c=g[n>>3],128&c&&(d[n]=1);b.pixels.resultMask=d;f.bitset=g;e+=f.numBytes}return b.ptr=e,b.mask=f,!0},readDataOneSweep:function(a,b,e){var f=b.ptr,h=b.headerInfo,g=h.width*h.height,h=h.numValidPixel*k.getDateTypeSize(h.imageType);if(e===Uint8Array)a=new Uint8Array(a,f,h);else{var d=new ArrayBuffer(h);(new Uint8Array(d)).set(new Uint8Array(a,f,h));a=new e(d)}if(a.length===g)b.pixels.resultPixels=
a;else for(b.pixels.resultPixels=new e(g),d=d=e=0;g>d;d++)b.pixels.resultMask[d]&&(b.pixels.resultPixels[d]=a[e++]);return f+=h,b.ptr=f,!0},readHuffman:function(f,b,e){var l=b.headerInfo,l=l.width*l.height,h=this.HUFFMAN_LUT_BITS_MAX,g=new DataView(f,b.ptr,16);b.ptr+=16;if(2>g.getInt32(0,!0))throw"unsupported Huffman version";var d=g.getInt32(4,!0),c=g.getInt32(8,!0),n=g.getInt32(12,!0);if(c>=n)return!1;var q=new Uint32Array(n-c);k.decodeBits(f,b,q);for(var t,r,v=[],g=c;n>g;g++)t=g-(d>g?0:d),v[t]=
{first:q[g-c],second:null};g=f.byteLength-b.ptr;q=new ArrayBuffer(4*Math.ceil(g/4));(new Uint8Array(q)).set(new Uint8Array(f,b.ptr,g));var u;f=new Uint32Array(q);var w=q=0;u=f[0];for(g=c;n>g;g++)t=g-(d>g?0:d),r=v[t].first,0<r&&(v[t].second=u<<q>>>32-r,32-q>=r?(q+=r,32===q&&(q=0,w++,u=f[w])):(q+=r-32,w++,u=f[w],v[t].second|=u>>>32-q));for(var x=0===b.headerInfo.imageType?128:0,y=b.headerInfo.height,A=b.headerInfo.width,z=0,B=0,C=new a,g=0;g<v.length;g++)void 0!==v[g]&&(z=Math.max(z,v[g].first));for(var B=
z>=h?h:z,D,E,F,h=[],g=c;n>g;g++)if(t=g-(d>g?0:d),r=v[t].first,0<r)if(u=[r,t],B>=r)for(D=v[t].second<<B-r,E=1<<B-r,c=0;E>c;c++)h[D|c]=u;else for(D=v[t].second,E=C,c=r-1;0<=c;c--)(F=D>>>c&1)?(E.right||(E.right=new a),E=E.right):(E.left||(E.left=new a),E=E.left),0!==c||E.val||(E.val=u[1]);var G,I;r=b.pixels.resultMask;n=d=0;0<q&&(w++,q=0);u=f[w];e=new e(l);if(b.headerInfo.numValidPixel===A*y)for(g=c=0;y>g;g++)for(t=0;A>t;t++,c++){if(l=0,G=u<<q>>>32-B,I=G,B>32-q&&(G|=f[w+1]>>>64-q-B,I=G),h[I])l=h[I][1],
q+=h[I][0];else for(I=G=u<<q>>>32-z,z>32-q&&(G|=f[w+1]>>>64-q-z,I=G),E=C,n=0;z>n;n++)if(F=G>>>z-n-1&1,E=F?E.right:E.left,!E.left&&!E.right){l=E.val;q=q+n+1;break}32<=q&&(q-=32,w++,u=f[w]);l-=x;l+=0<t?d:0<g?e[c-A]:d;l&=255;d=e[c]=l}else for(g=c=0;y>g;g++)for(t=0;A>t;t++,c++)if(r[c]){if(l=0,G=u<<q>>>32-B,I=G,B>32-q&&(G|=f[w+1]>>>64-q-B,I=G),h[I])l=h[I][1],q+=h[I][0];else for(I=G=u<<q>>>32-z,z>32-q&&(G|=f[w+1]>>>64-q-z,I=G),E=C,n=0;z>n;n++)if(F=G>>>z-n-1&1,E=F?E.right:E.left,!E.left&&!E.right){l=E.val;
q=q+n+1;break}32<=q&&(q-=32,w++,u=f[w]);l-=x;l+=0<t&&r[c-1]?d:0<g&&r[c-A]?e[c-A]:d;l&=255;d=e[c]=l}b.pixels.resultPixels=e;b.ptr=b.ptr+4*(w+1)+(0<q?4:0)},decodeBits:function(a,b,e,l){var f=b.headerInfo.fileVersion,g=0,d=new DataView(a,b.ptr,5),c=d.getUint8(0);g++;var n=c>>6,k=0===n?4:3-n,t=0<(32&c)?!0:!1,n=31&c,c=0;if(1===k)c=d.getUint8(g),g++;else if(2===k)c=d.getUint16(g,!0),g+=2;else{if(4!==k)throw"Invalid valid pixel count type";c=d.getUint32(g,!0);g+=4}var r,v,u,w,x,k=2*b.headerInfo.maxZError;
if(t){b.counter.lut++;t=d.getUint8(g);g++;w=Math.ceil((t-1)*n/8);x=Math.ceil(w/4);v=new ArrayBuffer(4*x);u=new Uint8Array(v);b.ptr+=g;u.set(new Uint8Array(a,b.ptr,w));g=new Uint32Array(v);b.ptr+=w;for(d=0;t-1>>>d;)d++;w=Math.ceil(c*d/8);x=Math.ceil(w/4);v=new ArrayBuffer(4*x);u=new Uint8Array(v);u.set(new Uint8Array(a,b.ptr,w));r=new Uint32Array(v);b.ptr+=w;a=3<=f?h.unstuffLUT2(g,n,t-1,l,k,b.headerInfo.zMax):h.unstuffLUT(g,n,t-1,l,k,b.headerInfo.zMax);3<=f?h.unstuff2(r,e,d,c,a):h.unstuff(r,e,d,c,
a)}else b.counter.bitstuffer++,d=n,b.ptr+=g,0<d&&(w=Math.ceil(c*d/8),x=Math.ceil(w/4),v=new ArrayBuffer(4*x),u=new Uint8Array(v),u.set(new Uint8Array(a,b.ptr,w)),r=new Uint32Array(v),b.ptr+=w,3<=f?null==l?h.originalUnstuff2(r,e,d,c):h.unstuff2(r,e,d,c,!1,l,k,b.headerInfo.zMax):null==l?h.originalUnstuff(r,e,d,c):h.unstuff(r,e,d,c,!1,l,k,b.headerInfo.zMax))},readTiles:function(a,b,e){var f=b.headerInfo,h=f.width,g=f.height,d=f.microBlockSize,f=f.imageType,c=Math.ceil(h/d),n=Math.ceil(g/d);b.pixels.numBlocksY=
n;b.pixels.numBlocksX=c;b.pixels.ptr=0;for(var q,t,r,v,u,w,x,y,A=0,z=t=0,B=0,C=0,D=0,E=0,F=0,G=A=0,I=0,J=0,L=0,M=0,H=y=0,K=new e(d*d),g=g%d||d,P=h%d||d,z=0;n>z;z++)for(C=z!==n-1?d:g,B=0;c>B;B++){if(D=B!==c-1?d:P,I=z*h*d+B*d,J=h-D,E=a.byteLength-b.ptr,q=new DataView(a,b.ptr,Math.min(10,E)),t={},H=0,F=q.getUint8(0),H++,A=F>>6&255,G=F>>2&15,G!==(B*d>>3&15))throw"integrity issue";if(w=3&F,3<w)throw b.ptr+=H,"Invalid block encoding ("+w+")";if(2!==w)if(0===w){if(b.counter.uncompressed++,b.ptr+=H,L=C*D*
k.getDateTypeSize(f),M=a.byteLength-b.ptr,L=M>L?L:M,r=new ArrayBuffer(L),v=new Uint8Array(r),v.set(new Uint8Array(a,b.ptr,L)),u=new e(r),y=0,b.pixels.resultMask)for(A=0;C>A;A++){for(t=0;D>t;t++)b.pixels.resultMask[I]&&(b.pixels.resultPixels[I]=u[y++]),I++;I+=J}else for(A=0;C>A;A++){for(t=0;D>t;t++)b.pixels.resultPixels[I++]=u[y++];I+=J}b.ptr+=y*k.getDateTypeSize(f)}else if(x=k.getDataTypeUsed(f,A),y=k.getOnePixel(t,H,x,q),H+=k.getDateTypeSize(x),3===w)if(b.ptr+=H,b.counter.constantoffset++,b.pixels.resultMask)for(A=
0;C>A;A++){for(t=0;D>t;t++)b.pixels.resultMask[I]&&(b.pixels.resultPixels[I]=y),I++;I+=J}else for(A=0;C>A;A++){for(t=0;D>t;t++)b.pixels.resultPixels[I++]=y;I+=J}else if(b.ptr+=H,k.decodeBits(a,b,K,y),H=0,b.pixels.resultMask)for(A=0;C>A;A++){for(t=0;D>t;t++)b.pixels.resultMask[I]&&(b.pixels.resultPixels[I]=K[H++]),I++;I+=J}else for(A=0;C>A;A++){for(t=0;D>t;t++)b.pixels.resultPixels[I++]=K[H++];I+=J}else b.counter.constant++,b.ptr+=H}},formatFileInfo:function(a){return{fileIdentifierString:a.headerInfo.fileIdentifierString,
fileVersion:a.headerInfo.fileVersion,imageType:a.headerInfo.imageType,height:a.headerInfo.height,width:a.headerInfo.width,numValidPixel:a.headerInfo.numValidPixel,microBlockSize:a.headerInfo.microBlockSize,blobSize:a.headerInfo.blobSize,maxZError:a.headerInfo.maxZError,pixelType:k.getPixelType(a.headerInfo.imageType),eofOffset:a.eofOffset,mask:a.mask?{numBytes:a.mask.numBytes}:null,pixels:{numBlocksX:a.pixels.numBlocksX,numBlocksY:a.pixels.numBlocksY,maxValue:a.headerInfo.zMax,minValue:a.headerInfo.zMin,
noDataValue:a.noDataValue}}},constructConstantSurface:function(a){var b=a.headerInfo.zMax,e=a.headerInfo.height*a.headerInfo.width,f=0;if(a.pixels.resultMask)for(f=0;e>f;f++)a.pixels.resultMask[f]&&(a.pixels.resultPixels[f]=b);else for(f=0;e>f;f++)a.pixels.resultPixels[f]=b},getDataTypeArray:function(a){switch(a){case 0:a=Int8Array;break;case 1:a=Uint8Array;break;case 2:a=Int16Array;break;case 3:a=Uint16Array;break;case 4:a=Int32Array;break;case 5:a=Uint32Array;break;case 6:a=Float32Array;break;case 7:a=
Float64Array;break;default:a=Float32Array}return a},getPixelType:function(a){switch(a){case 0:a="S8";break;case 1:a="U8";break;case 2:a="S16";break;case 3:a="U16";break;case 4:a="S32";break;case 5:a="U32";break;case 6:a="F32";break;case 7:a="F64";break;default:a="F32"}return a},isValidPixelValue:function(a,b){if(null===b||void 0===b)return!1;var e;switch(a){case 0:e=-128<=b&&127>=b;break;case 1:e=0<=b&&255>=b;break;case 2:e=-32768<=b&&32767>=b;break;case 3:e=0<=b&&65536>=b;break;case 4:e=-2147483648<=
b&&2147483647>=b;break;case 5:e=0<=b&&4294967296>=b;break;case 6:e=-3.4027999387901484E38<=b&&3.4027999387901484E38>=b;break;case 7:e=4.9E-324<=b&&1.7976931348623157E308>=b;break;default:e=!1}return e},getDateTypeSize:function(a){var b=0;switch(a){case 0:case 1:b=1;break;case 2:case 3:b=2;break;case 4:case 5:case 6:b=4;break;case 7:b=8;break;default:b=a}return b},getDataTypeUsed:function(a,b){var e=a;switch(a){case 2:case 4:e=a-b;break;case 3:case 5:e=a-2*b;break;case 6:e=0===b?a:1===b?2:1;break;
case 7:e=0===b?a:a-2*b+1;break;default:e=a}return e},getOnePixel:function(a,b,e,l){a=0;switch(e){case 0:a=l.getInt8(b);break;case 1:a=l.getUint8(b);break;case 2:a=l.getInt16(b,!0);break;case 3:a=l.getUint16(b,!0);break;case 4:a=l.getInt32(b,!0);break;case 5:a=l.getUInt32(b,!0);break;case 6:a=l.getFloat32(b,!0);break;case 7:a=l.getFloat64(b,!0);break;default:throw"the decoder does not understand this pixel type";}return a}},a=function(a,b,e){this.val=a;this.left=b;this.right=e};return{decode:function(a,
b){b=b||{};var e=b.maskData||null===b.maskData,f=b.noDataValue,h=0,g={};if(g.ptr=b.inputOffset||0,g.pixels={},k.readHeaderInfo(a,g)){var h=g.headerInfo,d=k.getDataTypeArray(h.imageType);if(e)g.pixels.resultMask=b.maskData,g.ptr+=4;else if(!k.readMask(a,g))return;e=h.width*h.height;if(g.pixels.resultPixels=new d(e),g.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0},0!==h.numValidPixel)if(h.zMax===h.zMin)k.constructConstantSurface(g);else{var c=new DataView(a,g.ptr,
2),n=c.getUint8(0,!0);(g.ptr++,n)?k.readDataOneSweep(a,g,d):1<h.fileVersion&&1>=h.imageType&&1E-5>Math.abs(h.maxZError-.5)?(c=c.getUint8(1,!0),g.ptr++,c?k.readHuffman(a,g,d):k.readTiles(a,g,d)):k.readTiles(a,g,d)}g.eofOffset=g.ptr;var q;b.inputOffset?(q=g.headerInfo.blobSize+b.inputOffset-g.ptr,1<=Math.abs(q)&&(g.eofOffset=b.inputOffset+g.headerInfo.blobSize)):(q=g.headerInfo.blobSize-g.ptr,1<=Math.abs(q)&&(g.eofOffset=g.headerInfo.blobSize));q={width:h.width,height:h.height,pixelData:g.pixels.resultPixels,
minValue:h.zMin,maxValue:h.zMax,maskData:g.pixels.resultMask};if(g.pixels.resultMask&&k.isValidPixelValue(h.imageType,f)){d=g.pixels.resultMask;for(h=0;e>h;h++)d[h]||(q.pixelData[h]=f);q.noDataValue=f}return g.noDataValue=f,b.returnFileInfo&&(q.fileInfo=k.formatFileInfo(g)),q}},getBandCount:function(a){for(var b=0,e=0,f={ptr:0,pixels:{}};e<a.byteLength-58;)k.readHeaderInfo(a,f),e+=f.headerInfo.blobSize,b++,f.ptr=e;return b}}})},"esri/layers/pixelFilters/VectorFieldPixelFilter":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../lang dojo/_base/array".split(" "),
function(h,k,a,f,b,e){h=h(null,{declaredClass:"esri.layers.pixelFilters.VectorFieldPixelFilter",speedUnits:["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"],constructor:function(a){k.mixin(this,a);this.isDataUV=a&&a.isDataUV?a.isDataUV:!1;this.computeMagnitudeAndDirection=k.hitch(this,this.computeMagnitudeAndDirection);this.unitConversionFactor=1;this._updateUnitConvFactor()},setUnits:function(a,b){this.inputUnit=a;this.outputUnit=b;this.unitConversionFactor=
1;this._updateUnitConvFactor()},_updateUnitConvFactor:function(){var a=e.indexOf(this.speedUnits,this.inputUnit),b=e.indexOf(this.speedUnits,this.outputUnit);if(this.inputUnit&&this.outputUnit&&0<=a&&0<=b){var f=[1,.277778,.514444,.3048,.44704,0];this.unitConversionFactor=f[a]/f[b]}},computeMagnitudeAndDirection:function(a){if(!b.isDefined(a))throw"Could not compute magnitude and direction. No pixel data is available.";var e=a.pixelBlock;if(!b.isDefined(e)||2!==e.getPlaneCount())throw"Could not compute magnitude and direction. Pixel data does not contain two bands.";
var f=a.extent,d=(f.xmax-f.xmin)/e.width,c=(f.ymax-f.ymin)/e.height,l=f.xmin+d/2,f=f.ymax-c/2;e.statistics[0].minValue=0;e.statistics[0].maxValue=0;var h,k,r,v,u,w,x,y,A=180/Math.PI,z=[],B=0,C=0,D=0,E=!b.isDefined(e.mask);u=x=+(1/0);w=y=-(1/0);for(B=0;B<e.height;B++)for(C=0;C<e.width;C++,D++)z.push([l+d*C,f-c*B]),(E||e.mask[D])&&(r=h=e.pixels[0][D]*this.unitConversionFactor,v=k=e.pixels[1][D],this.isDataUV&&(r=Math.sqrt(h*h+k*k),v=90-A*Math.atan2(k,h),e.pixels[0][D]=r*this.unitConversionFactor,e.pixels[1][D]=
v),r>w&&(w=r),u>r&&(u=r),v>y&&(y=v),x>v&&(x=v));return e.statistics[0].maxValue=w,e.statistics[0].minValue=u,e.statistics[1].maxValue=y,e.statistics[1].minValue=x,a.locations=z,a}});return a("extend-esri")&&k.setObject("layers.pixelFilters.VectorFieldPixelFilter",h,f),h})},"esri/layers/rasterFormats/ImageCanvasDecoder":function(){define(["require","dojo/_base/declare","dojo/Deferred","dojo/sniff"],function(h,k,a,f){var b;return k(null,{constructor:function(a){this.ctx=a.ctx;this._loadRasterFormatModule()},
decode:function(b,f){if(!f.width||!f.height)throw"Native decoding requires the image format, width and height";var e,g=new a,d=new Uint8Array(b),c=this._getFormat(b);if("error"===c)throw"invalid format";"jpeg"===c&&(e=this._getMask(d,f));var l,h,k="";for(l=0;l<d.length;l+=65535)h=d.subarray(l,l+65535>d.length-1?d.length-1:l+65535),k+=String.fromCharCode.apply(null,h);var r,d="data:image/"+c+";base64,"+window.btoa(k),v=new Image;v.src=d;var u=this;return v.onload=function(){u.ctx.clearRect(0,0,f.width,
f.height);u.ctx.drawImage(v,0,0);var a=u.ctx.getImageData(0,0,v.width,v.height);if(r=a.data,e)for(l=0;l<e.length;l++)e[l]?r[4*l+3]=255:r[4*l+3]=0;u.ctx.putImageData(a,0,0);g.resolve(null)},v.onerror=function(){g.reject("cannot load image")},g},_getFormat:function(a){a=new Uint8Array(a,0,10);var b="error";return 255===a[0]&&216===a[1]?b="jpeg":137===a[0]&&80===a[1]&&78===a[2]&&71===a[3]&&(b="png"),b},_getMask:function(a,f){var e;try{if(!b)throw"The zlib decoder module is not loaded.";var g=0,d=0,c=
Math.round(a.length/2);1===c%2&&(c+=1);for(var l=a.length-2,g=c;l>g&&(255!==a[g]||217!==a[g+1]);g++);c=g+=2;if(c<a.length-1){var h=(new b(a.subarray(c))).getBytes();e=new Uint8Array(f.width*f.height);for(g=c=0;g<h.length;g++)for(d=7;0<=d;d--)e[c++]=h[g]>>d&1}}catch(t){}return e},_loadRasterFormatModule:function(){10>f("ie")||h(["./Zlib"],function(a){b=a})}})})},"esri/tasks/ImageServiceIdentifyTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../request ../geometry/normalizeUtils ./Task ./ImageServiceIdentifyResult".split(" "),
function(h,k,a,f,b,e,l,m){h=h(l,{declaredClass:"esri.tasks.ImageServiceIdentifyTask",constructor:function(a){this._url.path+="/identify";this._handler=k.hitch(this,this._handler)},__msigns:[{n:"execute",c:3,a:[{i:0,p:["geometry"]}],e:2}],_handler:function(a,b,c,e,f){try{var d=new m(a);this._successHandler([d],"onComplete",c,f)}catch(r){this._errorHandler(r,e,f)}},execute:function(a,d,c,e){var f=e.assembly;a=this._encode(k.mixin({},this._url.query,{f:"json"},a.toJson(f&&f[0])));var g=this._handler,
l=this._errorHandler;return b({url:this._url.path,content:a,callbackParamName:"callback",load:function(a,b){g(a,b,d,c,e.dfd)},error:function(a){l(a,c,e.dfd)}})},onComplete:function(){}});return e._createWrappers(h),a("extend-esri")&&k.setObject("tasks.ImageServiceIdentifyTask",h,f),h})},"esri/tasks/ImageServiceIdentifyResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../geometry/jsonUtils ./FeatureSet".split(" "),function(h,k,a,f,b,e){h=h(null,{declaredClass:"esri.tasks.ImageServiceIdentifyResult",
constructor:function(a){a.catalogItems&&(this.catalogItems=new e(a.catalogItems));a.location&&(this.location=b.fromJson(a.location));this.catalogItemVisibilities=a.catalogItemVisibilities;this.name=a.name;this.objectId=a.objectId;this.value=a.value;this.processedValues=a.processedValues;this.properties=a.properties}});return a("extend-esri")&&k.setObject("tasks.ImageServiceIdentifyResult",h,f),h})},"esri/tasks/ImageServiceIdentifyParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/_base/array dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),
function(h,k,a,f,b,e,l,m){h=h(null,{declaredClass:"esri.tasks.ImageServiceIdentifyParameters",geometry:null,mosaicRule:null,renderingRule:null,renderingRules:null,pixelSizeX:null,pixelSizeY:null,pixelSize:null,returnGeometry:!1,returnCatalogItems:!0,timeExtent:null,toJson:function(b){var d=b&&b.geometry||this.geometry;b={geometry:d,returnGeometry:this.returnGeometry,returnCatalogItems:this.returnCatalogItems,mosaicRule:this.mosaicRule?a.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?
a.toJson(this.renderingRule.toJson()):null};d&&(b.geometryType=m.getJsonType(d));d=this.timeExtent;return b.time=d?d.toJson().join(","):null,l.isDefined(this.pixelSizeX)&&l.isDefined(this.pixelSizeY)?b.pixelSize=a.toJson({x:parseFloat(this.pixelSizeX),y:parseFloat(this.pixelSizeY)}):this.pixelSize&&(b.pixelSize=this.pixelSize?a.toJson(this.pixelSize.toJson()):null),this.renderingRules&&(b.renderingRules=a.toJson(f.map(this.renderingRules,function(a){return a.toJson()}))),b}});return b("extend-esri")&&
k.setObject("tasks.ImageServiceIdentifyParameters",h,e),h})},"esri/virtualearth/VETiledLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/_base/array dojo/_base/config dojo/has dojo/string dojo/_base/Deferred ../kernel ../urlUtils ../SpatialReference ../layers/TileInfo ../layers/TiledMapServiceLayer ../geometry/Extent ../request".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r){h=h(q,{declaredClass:"esri.virtualearth.VETiledLayer",constructor:function(a){try{if(a=
k.mixin({bingMapsKey:null,culture:"en-US"},a||{}),this.url=d.getProtocolForWebResource()+"//dev.virtualearth.net/REST/v1",this._url=d.urlToObject(this.url),this.spatialReference=new c({wkid:102100}),this.tileInfo=new n({rows:256,cols:256,dpi:96,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:1,resolution:78271.5169639999,scale:2.95828763795777E8},{level:2,resolution:39135.7584820001,scale:1.47914381897889E8},{level:3,resolution:19567.8792409999,scale:7.3957190948944E7},
{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,
scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,scale:1128.497176},{level:20,resolution:.1492910708238085,scale:564.248588}]}),this.initialExtent=
this.fullExtent=new t(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,new c({wkid:102100})),k.mixin(this,a),this.hasAttributionData=this.showAttribution,this._initLayer=k.hitch(this,this._initLayer),this._errorHandler=k.hitch(this,this._errorHandler),this._getTileInfo=k.hitch(this,this._getTileInfo),!this.bingMapsKey)throw Error("BingMapsKey must be provided.");this._getTileInfo()}catch(u){throw this.onError(u),u;}},_unsetMap:function(a,b){this.inherited("_unsetMap",arguments)},
_getTileInfo:function(){if(this.mapStyle){var a=this._url.path+"/Imagery/Metadata/"+this.mapStyle,b=window.location.protocol;if(this.bingMapsKey){var c=this.resourceInfo;!this.loaded&&c?this._initLayer(c):r({url:a,content:k.mixin({},{uriScheme:"https:"===b?"https":"http",key:this.bingMapsKey,ss:!0,c:this.culture,include:this.hasAttributionData?"imageryProviders":null}),callbackParamName:"jsonp",load:this._initLayer,error:this._errorHandler})}}},_initLayer:function(b,c){if(200!==b.statusCode){var e=
Error();return e.code=b.statusCode,e.message=b.statusDescription,e.details=b.errorDetails,e.authenticationResultCode=b.authenticationResultCode,void this.onError(e)}try{this.resourceInfo=a.toJson(b);var e=b.resourceSets[0].resources[0],g=e.imageUrl.replace("{","${");if(this.tileServers=f.map(e.imageUrlSubdomains,function(a){var b=d.getProtocolForWebResource();return l.substitute(g,{subdomain:a}).replace("http:",b)}),this._tsLength=this.tileServers.length,this.loaded)this.refresh(),this.onMapStyleChange();
else{this.copyright=this.copyright||"\x26copy; 2017 Microsoft Corporation and its data suppliers";this.loaded=!0;this.onLoad(this);var h=this.loadCallback;h&&(delete this.loadCallback,h(this))}}catch(A){this.onError(A)}},getAttributionData:function(){var c,d=new m,e=a.fromJson(this.resourceInfo);(this.hasAttributionData&&e&&(c=k.getObject("resourceSets.0.resources.0.imageryProviders",!1,e)),c)?d.callback({contributors:c}):(c=Error("Layer does not have attribution data"),c.log=b.isDebug,d.errback(c));
return d},getTileUrl:function(a,b,c){return l.substitute(this.tileServers[b%this._tsLength].replace(/\{/g,"${"),{quadkey:this._getQuadKey(a,b,c),culture:this.culture,token:this.bingMapsKey})},_getQuadKey:function(a,b,c){var d,e,f="";for(e=a;0<e;e--)a="0",d=1<<e-1,0!=(c&d)&&a++,0!=(b&d)&&(a++,a++),f+=a;return f},setMapStyle:function(a){this.mapStyle=a;this._getTileInfo()},setCulture:function(a){this.culture=a;this._getTileInfo()},setBingMapsKey:function(a){this.bingMapsKey=a},onMapStyleChange:function(){}});
return k.mixin(h,{MAP_STYLE_AERIAL:"aerial",MAP_STYLE_AERIAL_WITH_LABELS:"aerialWithLabels",MAP_STYLE_ROAD:"roadOnDemand"}),e("extend-esri")&&k.setObject("virtualearth.VETiledLayer",h,g),h})},"esri/dijit/Scalebar":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/query ../kernel ../lang ../domUtils ../units ../SpatialReference ../WKIDUnitConversion ../geometry/Point ../geometry/ScreenPoint ../geometry/Polyline ../geometry/geodesicUtils ../geometry/webMercatorUtils ../geometry/screenUtils ../geometry/normalizeUtils dojo/i18n!../nls/jsapi".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C){h=h(null,{declaredClass:"esri.dijit.Scalebar",map:null,mapUnit:null,scalebarUnit:null,unitsDictionary:[],domNode:null,screenPt1:null,screenPt2:null,localStrings:C.widgets.scalebar,constructor:function(c,d){if(this.metricScalebar=e.create("div",{innerHTML:"\x3cdiv class\x3d'esriScaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarLineLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLine esriScalebarMetricLine'\x3e\x3c/div\x3e"}),
this.englishScalebar=e.create("div",{innerHTML:"\x3cdiv class\x3d'esriScalebarLine esriScalebarEnglishLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarLineLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e"}),this.domNode=e.create("div"),c=c||{},!c.map)return void console.error("scalebar: unable to find the 'map' property in parameters");if(c.scalebarUnit){if("english"!==c.scalebarUnit&&"metric"!==c.scalebarUnit&&"dual"!==c.scalebarUnit)return void console.error("scalebar unit only accepts english or metric or dual");
this.scalebarUnit=c.scalebarUnit}else this.scalebarUnit="english";if(c.scalebarStyle){if("ruler"!==c.scalebarStyle&&"line"!==c.scalebarStyle)return void console.error("scalebar style must be ruler or line");this.scalebarStyle=c.scalebarStyle}else this.scalebarStyle="ruler";switch(this.background=c.background,this.scalebarUnit){case "english":"ruler"===this.scalebarStyle&&(this.englishScalebar.innerHTML="\x3cdiv class\x3d'esriScalebarRuler'\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_secondpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_secondpiece'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'scaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel' style\x3d'left: -3%'\x3e0\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarFirstNumber'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e");
this.domNode.appendChild(this.englishScalebar);break;case "metric":"ruler"===this.scalebarStyle&&(this.metricScalebar.innerHTML="\x3cdiv class\x3d'esriScalebarRuler'\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock upper_secondpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_firstpiece'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarRulerBlock lower_secondpiece'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'scaleLabelDiv'\x3e\x3cdiv class\x3d'esriScalebarLabel' style\x3d'left: -3%'\x3e0\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarFirstNumber'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriScalebarLabel esriScalebarSecondNumber'\x3e\x3c/div\x3e\x3c/div\x3e");
this.domNode.appendChild(this.metricScalebar);break;case "dual":this.domNode.appendChild(this.metricScalebar),this.domNode.appendChild(this.englishScalebar)}if(this.map=c.map,d?d.appendChild(this.domNode):(this.map.container.appendChild(this.domNode),c.attachTo?b.add(this.domNode,"scalebar_"+c.attachTo):b.add(this.domNode,"scalebar_bottom-left")),b.add(this.domNode,"esriScalebar"),this.map.loaded)this._getDistance(this.map.extent),this._checkBingMaps();else var g=f.connect(this.map,"onLoad",this,
function(){f.disconnect(g);g=null;this._getDistance(this.map.extent);this._checkBingMaps()});this._mapOnPan=f.connect(this.map,"onPan",this,this._getDistance);this._mapOnExtentChange=f.connect(this.map,"onExtentChange",this,this._getDistance);a.forEach(this.map.layerIds,function(a,b){"esri.virtualearth.VETiledLayer"===this.map.getLayer(a).declaredClass&&f.connect(this.map.getLayer(a),"onVisibilityChange",k.hitch(this,function(a){this._checkBingMaps()}))},this);this._mapOnLayerAdd=f.connect(this.map,
"onLayerAdd",k.hitch(this,function(a){"esri.virtualearth.VETiledLayer"===a.declaredClass&&f.connect(a,"onVisibilityChange",k.hitch(this,function(a){this._checkBingMaps()}));this._checkBingMaps()}));this._mapOnLayerRemove=f.connect(this.map,"onLayerRemove",k.hitch(this,this._checkBingMaps))},hide:function(){this._hidden=!0;q.hide(this.domNode)},show:function(){this._hidden=!1;q.show(this.domNode)},destroy:function(){f.disconnect(this._mapOnPan);f.disconnect(this._mapOnExtentChange);f.disconnect(this._mapOnLayerAdd);
f.disconnect(this._mapOnLayerRemove);this.hide();this.map=null;e.destroy(this.domNode)},_checkBingMaps:function(){b.contains(this.domNode,"scalebar_bottom-left")&&(m.set(this.domNode,"left","25px"),a.forEach(this.map.layerIds,function(a,b){if("esri.virtualearth.VETiledLayer"===this.map.getLayer(a).declaredClass&&this.map.getLayer(a).visible){var c="95px";this.map._mapParams.nav&&(c="115px");m.set(this.domNode,"left",c)}},this))},_getDistance:function(a){var b=l.position(this.domNode,!0).y-this.map.position.y,
b=b>this.map.height?this.map.height:b,b=0>b?0:b,c,d,e=new w(0,b),b=new w(this.map.width,b);this.mapUnit="esriDecimalDegrees";var f=z.toMapPoint(a,this.map.width,this.map.height,e),g=z.toMapPoint(a,this.map.width,this.map.height,b),e=new u(a.xmin,(a.ymin+a.ymax)/2,this.map.spatialReference),b=new u(a.xmax,(a.ymin+a.ymax)/2,this.map.spatialReference);if(3857===this.map.spatialReference.wkid||102100===this.map.spatialReference.wkid||102113===this.map.spatialReference.wkid||this.map.spatialReference.wkt&&
-1!=this.map.spatialReference.wkt.indexOf("WGS_1984_Web_Mercator"))f=A.webMercatorToGeographic(f,!0),g=A.webMercatorToGeographic(g,!0),e=A.webMercatorToGeographic(e,!0),b=A.webMercatorToGeographic(b,!0);else if(n.isDefined(v[this.map.spatialReference.wkid])||this.map.spatialReference.wkt&&0===this.map.spatialReference.wkt.indexOf("PROJCS")){this.mapUnit="linearUnit";a=Math.abs(a.xmax-a.xmin);if(n.isDefined(v[this.map.spatialReference.wkid]))c=v.values[v[this.map.spatialReference.wkid]];else{c=this.map.spatialReference.wkt;
d=c.lastIndexOf(",")+1;var h=c.lastIndexOf("]]");c=parseFloat(c.substring(d,h))}a*=c;d=a/1609;c=a/1E3;a/=1E3}"esriDecimalDegrees"===this.mapUnit&&(c=y.isSupported(this.map.spatialReference)?this.map.spatialReference.wkid:4326,a=new x(new r({wkid:c})),a.addPath([f,g]),f=B._straightLineDensify(a,10),a=y.geodesicLengths([f],t.KILOMETERS)[0],f=new x(new r({wkid:c})),f.addPath([e,b]),e=B._straightLineDensify(f,10),y.geodesicLengths([e],t.KILOMETERS),d=a/1.609,c=a);"english"===this.scalebarUnit?this._getScaleBarLength(d,
"mi"):"metric"===this.scalebarUnit?this._getScaleBarLength(c,"km"):"dual"===this.scalebarUnit&&(this._getScaleBarLength(d,"mi"),this._getScaleBarLength(c,"km"))},_getScaleBarLength:function(a,b){var c=50*a/this.map.width,d=0,e=b;for(.1>c&&("mi"===b?(c*=5280,e="ft"):"km"===b&&(c*=1E3,e="m"));1<=c;)c/=10,d++;var f,g;.5<c?(f=1,g=.5):.3<c?(f=.5,g=.3):.2<c?(f=.3,g=.2):.15<c?(f=.2,g=.15):.1<=c&&(f=.15,g=.1);f=f/c>=c/g?g:f;this._drawScaleBar(f/c*50,Math.pow(10,d)*f,e)},_drawScaleBar:function(b,c,e){var f,
g,l,h=2*Math.round(b);"mi"===e||"ft"===e?(this.englishScalebar.style.width=h+"px",f=d(".esriScalebarFirstNumber",this.englishScalebar),g=d(".esriScalebarSecondNumber",this.englishScalebar),l=d(".esriScalebarMetricLineBackground",this.englishScalebar)):(this.metricScalebar.style.width=h+"px",f=d(".esriScalebarFirstNumber",this.metricScalebar),g=d(".esriScalebarSecondNumber",this.metricScalebar),l=d(".esriScalebarMetricLineBackground",this.metricScalebar));a.forEach(l,function(a,b){a.style.width=h-
2+"px"},this);a.forEach(f,function(a,b){a.innerHTML=c},this);a.forEach(g,function(a,b){"esriUnknown"!==this.mapUnit?a.innerHTML=2*c+this.localStrings[e]:a.innerHTML=2*c+"Unknown Unit"},this)}});return g("extend-esri")&&k.setObject("dijit.Scalebar",h,c),h})},"esri/geometry/geodesicUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point ./Polyline ./Polygon".split(" "),function(h,k,a,f,b,e,l,m){function g(a){return!!(a&&a.wkid&&w[a.wkid])}function d(a){return g(a)?
w[a.wkid]:w[u]}function c(a){var b=a.spatialReference,c=d(b),f=c.a,c=c.eSq,g=Math.sqrt(c),l=Math.sin(a.y*v);return new e(f*a.x*v,0<c?f*(1-c)*(l/(1-c*l*l)-1/(2*g)*Math.log((1-g*l)/(1+g*l)))*.5:f*l,b)}function n(a,b,c,f,g){var l,h,m,n,k=d(g),q=k.a,r=k.b,k=k.f,t=Math.sin(c);c=Math.cos(c);var u=(1-k)*Math.tan(a);a=1/Math.sqrt(1+u*u);for(var w=u*a,x=Math.atan2(u,c),u=a*t,z=u*u,y=1-z,q=y*(q*q-r*r)/(r*r),A=1+q/16384*(4096+q*(-768+q*(320-175*q))),B=q/1024*(256+q*(-128+q*(74-47*q))),q=f/(r*A),R=2*Math.PI;1E-12<
Math.abs(q-R);)m=Math.cos(2*x+q),l=Math.sin(q),h=Math.cos(q),n=B*l*(m+B/4*(h*(-1+2*m*m)-B/6*m*(-3+4*l*l)*(-3+4*m*m))),R=q,q=f/(r*A)+n;f=w*l-a*h*c;r=k/16*y*(4+k*(4-3*y));return new e((b+(Math.atan2(l*t,a*h-w*l*c)-(1-r)*k*u*(q+r*l*(m+r*h*(-1+2*m*m)))))/v,Math.atan2(w*h+a*l*c,(1-k)*Math.sqrt(z+f*f))/v,g)}function q(a,b,c,e,f){var g,l,h,m,n,k,q,r,t,u,v=d(f),w=v.a;f=v.b;var x=v.f,z=e-b,y=Math.atan((1-x)*Math.tan(a));m=Math.atan((1-x)*Math.tan(c));var A=Math.sin(y),y=Math.cos(y),B=Math.sin(m),X=Math.cos(m),
T=z,V=1E3;do{if(q=Math.sin(T),r=Math.cos(T),h=Math.sqrt(X*q*X*q+(y*B-A*X*r)*(y*B-A*X*r)),0===h)return 0;n=A*B+y*X*r;k=Math.atan2(h,n);t=y*X*q/h;l=1-t*t;m=n-2*A*B/l;isNaN(m)&&(m=0);u=x/16*l*(4+x*(4-3*l));g=T;T=z+(1-u)*x*t*(k+u*h*(m+u*n*(-1+2*m*m)))}while(1E-12<Math.abs(T-g)&&0<--V);if(0===V)return h=e-b,{azimuth:Math.atan2(Math.sin(h)*Math.cos(c),Math.cos(a)*Math.sin(c)-Math.sin(a)*Math.cos(c)*Math.cos(h)),geodesicDistance:Math.acos(Math.sin(a)*Math.sin(c)+Math.cos(a)*Math.cos(c)*Math.cos(e-b))*v.radius};
a=l*(w*w-f*f)/(f*f);b=a/1024*(256+a*(-128+a*(74-47*a)));return{azimuth:Math.atan2(X*Math.sin(T),y*B-A*X*Math.cos(T)),geodesicDistance:f*(1+a/16384*(4096+a*(-768+a*(320-175*a))))*(k-b*h*(m+b/4*(n*(-1+2*m*m)-b/6*m*(-3+4*h*h)*(-3+4*m*m)))),reverseAzimuth:Math.atan2(y*Math.sin(T),y*B*Math.cos(T)-A*X)}}function t(a,b){if(!(a instanceof l||a instanceof m))throw console.error("_geodesicDensify: the input geometry is neither polyline nor polygon"),Error("_geodesicDensify: the input geometry is neither polyline nor polygon");
var c=a.spatialReference,e=d(c).radius/1E4;e>b&&(b=e);var f,e=a instanceof l,g=[];return h.forEach(e?a.paths:a.rings,function(a){g.push(f=[]);f.push([a[0][0],a[0][1]]);var d,e,l,h,m,k;d=a[0][0]*v;e=a[0][1]*v;for(m=0;m<a.length-1;m++)if(l=a[m+1][0]*v,h=a[m+1][1]*v,d!==l||e!==h){var r=q(e,d,h,l,c),t=r.azimuth,r=r.geodesicDistance,u=r/b;if(1<u){for(k=1;u-1>=k;k++){var w=n(e,d,t,k*b,c);f.push([w.x,w.y])}k=n(e,d,t,(r+Math.floor(u-1)*b)/2,c);f.push([k.x,k.y])}e=n(e,d,t,r,c);f.push([e.x,e.y]);d=e.x*v;e=
e.y*v}}),e?new l({paths:g,spatialReference:c}):new m({rings:g,spatialReference:c})}var r={esriMeters:1,esriKilometers:1E3,esriYards:.9144,esriFeet:.3048,esriMiles:1609.344,esriNauticalMiles:1852,esriInches:.0254,esriDecimeters:.1,esriCentimeters:.01,esriMillimeters:.001,esriSquareMeters:1,esriSquareKilometers:1E6,esriSquareYards:.83612736,esriSquareFeet:.09290304,esriSquareMiles:2589988.110336,esriAcres:4046.8564224,esriHectares:1E4,esriAres:100,esriSquareInches:6.4516E-4,esriSquareMillimeters:1E-6,
esriSquareCentimeters:1E-4,esriSquareDecimeters:.01},v=Math.PI/180,u=4326,w={4326:{a:6378137,b:6356752.31424518,f:1/298.257223563,eSq:.006694379990197414,radius:6371008.771415059},104900:{a:2439700,b:2439700,f:0,eSq:0,radius:2439700},104901:{a:6051E3,b:6051E3,f:0,eSq:0,radius:6051E3},104902:{a:6051800,b:6051800,f:0,eSq:0,radius:6051800},104903:{a:1737400,b:1737400,f:0,eSq:0,radius:1737400},104904:{a:3393400,b:3375730,f:1/192.04301075,eSq:.01038722,radius:3387510},104905:{a:3396190,b:3376200,f:1/169.89444722,
eSq:.01173737,radius:3389526.6666666665},104906:{a:6200,b:6200,f:0,eSq:0,radius:6200},104907:{a:11100,b:11100,f:0,eSq:0,radius:11100},104912:{a:2409300,b:2409300,f:0,eSq:0,radius:2409300},104915:{a:1562090,b:1562090,f:0,eSq:0,radius:1562090},104916:{a:2632345,b:2632345,f:0,eSq:0,radius:2632345},104918:{a:1821460,b:1821460,f:0,eSq:0,radius:1821460},104929:{a:249400,b:249400,f:0,eSq:0,radius:249400},104943:{a:2575E3,b:2575E3,f:0,eSq:0,radius:2575E3},104971:{a:3396190,b:3396190,f:0,eSq:0,radius:3396190},
104972:{a:47E4,b:47E4,f:0,eSq:0,radius:47E4},104973:{a:255E3,b:255E3,f:0,eSq:0,radius:255E3},104974:{a:2439400,b:2439400,f:0,eSq:0,radius:2439400}};b={isSupported:g,getSpheroidInfo:d,geodesicDensify:t,geodesicLengths:function(a,b){var c=[];return h.forEach(a,function(a,d){var e=0,f=a.spatialReference;h.forEach(a.paths,function(a,b){var c,d,g,l,h,m,n=0;for(c=1;c<a.length;c++)d=a[c-1][0]*v,g=a[c][0]*v,l=a[c-1][1]*v,h=a[c][1]*v,(l!==h||d!==g)&&(m=q(l,d,h,g,f),n+=m.geodesicDistance);e+=n});e/=r[b];c.push(e)}),
c},geodesicAreas:function(a,b){var f=[],g=[];return h.forEach(a,function(a,b){var c=.0015696101447650193*d(a.spatialReference).radius;f.push(t(a,c))}),h.forEach(f,function(a,d){var f=0,l=a.spatialReference;h.forEach(a.rings,function(a,b){var d,g=c(new e(a[0][0],a[0][1],l)),h=c(new e(a[a.length-1][0],a[a.length-1][1],l)),m=h.x*g.y-g.x*h.y;for(d=0;d<a.length-1;d++)g=c(new e(a[d+1][0],a[d+1][1],l)),h=c(new e(a[d][0],a[d][1],l)),m+=h.x*g.y-g.x*h.y;f+=m});f/=r[b];g.push(f/-2)}),g},_unitsDictionary:r,_toEqualAreaPoint:c,
_directGeodeticSolver:n,_inverseGeodeticSolver:q};return a("extend-esri")&&k.mixin(k.getObject("geometry",!0,f),b),b})},"esri/SnappingManager":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/Deferred dojo/has dojo/keys ./kernel ./graphic ./geometry/ScreenPoint ./geometry/Extent ./symbols/SimpleMarkerSymbol ./symbols/SimpleLineSymbol ./tasks/query".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r){h=h(null,{declaredClass:"esri.SnappingManager",
constructor:function(c){if(c=c||{},c.map||console.error("map is not specified for SnappingManager"),this.map=c.map,this.tolerance=c.tolerance||15,this.layerInfos=[],c.layerInfos)this.layerInfos=c.layerInfos;else{var e;for(e=0;e<this.map.graphicsLayerIds.length;e++){var f=this.map.getLayer(this.map.graphicsLayerIds[e]);this.layerInfos.push({layer:f})}if(this.map.loaded)this.layerInfos.push({layer:this.map.graphics});else var g=k.connect(this.map,"onLoad",this,function(a){k.disconnect(g);g=null;this.layerInfos.push({layer:this.map.graphics});
this.setLayerInfos(this.layerInfos)})}c.snapPointSymbol?this.snapPointSymbol=c.snapPointSymbol:this.snapPointSymbol=new q(q.STYLE_CROSS,15,new t(t.STYLE_SOLID,new b([0,255,255]),1),new b([0,255,0,0]));c.alwaysSnap?this.alwaysSnap=c.alwaysSnap:this.alwaysSnap=!1;c.snapKey?this.snapKey=c.snapKey:this.snapKey=l("mac")?m.META:m.CTRL;this._SelectionLyrQuery=new r;this._SelectionLyrQuery.spatialRelationship=r.SPATIAL_REL_INTERSECTS;this._snappingGraphic=new d;this.setLayerInfos(this.layerInfos);this._currentGraphicOption=
{snapToPoint:!0,snapToVertex:!0,snapToEdge:!0};this._snappingCallback=a.hitch(this,this._snappingCallback)},getSnappingPoint:function(b){var c=this.layers,d=this.tolerance,g=this.map,l=this.layerOptions,h=g.toMap(b.offset(-d,d)),d=g.toMap(b.offset(d,-d)),h=new n(h.x,h.y,d.x,d.y,g.spatialReference),m=new r;m.geometry=h;m.spatialRelationship=r.SPATIAL_REL_INTERSECTS;var k,q,t=[],v=[],F=this._extractPointsAndLines,G=new e,I=0,d=h.xmin,J=h.xmax;f.forEach(c,function(a,b){a.visible&&a.loaded&&"esri.layers.FeatureLayer"===
a.declaredClass&&a.mode!==a.constructor.MODE_SELECTION&&I++});g.spatialReference._isWrappable()&&(d=n.prototype._normalizeX(h.xmin,g.spatialReference._getInfo()).x,J=n.prototype._normalizeX(h.xmax,g.spatialReference._getInfo()).x);var L=new n(d,h.ymin,J,h.ymax,g.spatialReference);f.forEach(c,function(a,b){if("esri.layers.GraphicsLayer"===a.declaredClass&&a.visible){var c=[];f.forEach(a.graphics,function(a){a&&a.visible&&L.intersects(a.geometry)&&c.push(a)});var d=F(c,l[b]);t=t.concat(d[0]);v=v.concat(d[1])}});
var M=a.hitch(this,function(a){(I--,a instanceof Error)||(a=F(a.features,l[q]),t=t.concat(a[0]),v=v.concat(a[1]));I||(k=this._getSnappingPoint(t,v,b),G.callback(k))}),H=!1;return f.forEach(c,function(a,b){a.visible&&a.loaded&&(q=b,"esri.layers.FeatureLayer"===a.declaredClass&&a.mode!==a.constructor.MODE_SELECTION&&(H=!0,a.queryFeatures(m,M,M)))}),H||(k=this._getSnappingPoint(t,v,b),G.callback(k)),G},setLayerInfos:function(a){this.layers=[];this.layerOptions=[];var b;for(b=0;b<a.length;b++)this.layers.push(a[b].layer),
this.layerOptions.push({snapToPoint:!0,snapToVertex:!0,snapToEdge:!0}),!1===a[b].snapToPoint&&(this.layerOptions[b].snapToPoint=a[b].snapToPoint),!1===a[b].snapToVertex&&(this.layerOptions[b].snapToVertex=a[b].snapToVertex),!1===a[b].snapToEdge&&(this.layerOptions[b].snapToEdge=a[b].snapToEdge);this._featurePtsFromSelectionLayer=[];this._featureLinesFromSelectionLayer=[];this._selectionLayers=[];this._selectionLayerOptions=[];f.forEach(this.layers,function(a,b){"esri.layers.FeatureLayer"===a.declaredClass&&
a.mode===a.constructor.MODE_SELECTION&&(this._selectionLayers.push(a),this._selectionLayerOptions.push(this.layerOptions[b]))},this);this.layerInfos=a},destroy:function(){k.disconnect(this._onExtentChangeConnect);this._killOffSnapping();this._featurePtsFromSelectionLayer=this._featureLinesFromSelectionLayer=this._currentFeaturePts=this._currentFeatureLines=this.layers=this.map=null},_startSelectionLayerQuery:function(){k.disconnect(this._onExtentChangeConnect);this._mapExtentChangeHandler(this._selectionLayers,
this._selectionLayerOptions,this.map.extent);this._onExtentChangeConnect=k.connect(this.map,"onExtentChange",a.hitch(this,"_mapExtentChangeHandler",this._selectionLayers,this._selectionLayerOptions))},_stopSelectionLayerQuery:function(){k.disconnect(this._onExtentChangeConnect)},_mapExtentChangeHandler:function(b,c,d){this._featurePtsFromSelectionLayer=[];this._featureLinesFromSelectionLayer=[];var e;this._SelectionLyrQuery.geometry=d;var g=a.hitch(this,function(a){a instanceof Error||(a=this._extractPointsAndLines(a.features,
c[e]),this._featurePtsFromSelectionLayer=this._featurePtsFromSelectionLayer.concat(a[0]),this._featureLinesFromSelectionLayer=this._featureLinesFromSelectionLayer.concat(a[1]))});f.forEach(b,function(a,b){a.visible&&a.loaded&&(e=b,a.queryFeatures(this._SelectionLyrQuery,g,g))},this)},_extractPointsAndLines:function(a,b){var c,d,e=[],g=[];return f.forEach(a,function(a,f){if((!a._graphicsLayer||a.visible)&&a.geometry)if("point"===a.geometry.type&&b.snapToPoint)e.push(a.geometry);else if("polyline"===
a.geometry.type)for(c=0;c<a.geometry.paths.length;c++){g.push("lineStart");for(d=0;d<a.geometry.paths[c].length;d++){var l=a.geometry.getPoint(c,d);b.snapToVertex&&e.push(l);b.snapToEdge&&g.push(l)}g.push("lineEnd")}else if("polygon"===a.geometry.type)for(c=0;c<a.geometry.rings.length;c++){g.push("lineStart");for(d=0;d<a.geometry.rings[c].length;d++)l=a.geometry.getPoint(c,d),b.snapToVertex&&e.push(l),b.snapToEdge&&g.push(l);g.push("lineEnd")}}),[e,g]},_getSnappingPoint:function(a,b,d){var e,g,l=
this.tolerance,h=this.map,m=this.map._getFrameWidth();if(a=a.concat(this._featurePtsFromSelectionLayer),b=b.concat(this._featureLinesFromSelectionLayer),this._currentGraphic){var n=this._extractPointsAndLines([this._currentGraphic],this._currentGraphicOption);a=a.concat(n[0]);b=b.concat(n[1])}var k,q;if(f.forEach(a,function(a,b){var c=h.toScreen(a,!0);if(-1!==m&&(c.x%=m,0>c.x&&(c.x+=m),h.width>m))for(var f=(h.width-m)/2;c.x<f;)c.x+=m;e=Math.sqrt((c.x-d.x)*(c.x-d.x)+(c.y-d.y)*(c.y-d.y));l>=e&&(l=e,
k=c.x,q=c.y)}),k)b=new c(k,q),g=b=h.toMap(b);else{var r,t,l=this.tolerance;for(a=0;a<b.length;a++)if("lineStart"===b[a])for(n=a+1;n<b.length;n++){if("lineEnd"!==b[n+1]&&"lineStart"!==b[n+1]&&"lineEnd"!==b[n]&&"lineStart"!==b[n]){var u=h.toScreen(b[n],!0),v=h.toScreen(b[n+1],!0),w=u.x>=v.x?u:v,M=u.x>=v.x?v:u;-1!==m&&(w.x%=m,0>w.x&&(w.x+=m),M.x%=m,0>M.x&&(M.x+=m),M.x>w.x&&(M.x-=m));var H,K,P,O,S,u=w.x,v=w.y,Q=M.x,M=M.y;u===Q?(w=u,H=d.y,K=P=u,O=M>=v?v:M,S=M>=v?M:v):v===M?(w=d.x,H=v,K=Q>=u?u:Q,P=Q>=u?
Q:u,O=S=v):(H=(M-v)/(Q-u),K=(v*Q-u*M)/(Q-u),w=(K-(d.y*M-d.y*v-d.x*u+d.x*Q)/(M-v))/((u-Q)/(M-v)-H),H=H*w+K,K=Q>=u?u:Q,P=Q>=u?Q:u,O=M>=v?v:M,S=M>=v?M:v);if(w>=K&&P>=w&&H>=O&&S>=H)u=Math.sqrt((d.x-w)*(d.x-w)+(d.y-H)*(d.y-H)),l>=u&&(l=u,r=w,t=H);else{var R;K=Math.sqrt((u-d.x)*(u-d.x)+(v-d.y)*(v-d.y));P=Math.sqrt((Q-d.x)*(Q-d.x)+(M-d.y)*(M-d.y));P>=K?(R=K,w=u,H=v):(R=P,w=Q,H=M);l>=R&&(l=R,r=w,t=H)}}if("lineEnd"===b[n]){a=n;break}}r&&(b=new c(r,t),g=b=h.toMap(b))}return g},_setGraphic:function(a){this._currentGraphic=
a},_addSnappingPointGraphic:function(){var a=this.map;this._snappingGraphic.setSymbol(this.snapPointSymbol);a.graphics.add(this._snappingGraphic)},_setUpSnapping:function(){var a=this.map;this._onSnapKeyDown_connect=k.connect(a,"onKeyDown",this,"_onSnapKeyDownHandler");this._onSnapKeyUp_connect=k.connect(a,"onKeyUp",this,"_onSnapKeyUpHandler");this._onSnappingMouseMove_connect=k.connect(a,"onMouseMove",this,"_onSnappingMouseMoveHandler");this._onSnappingMouseDrag_connect=k.connect(a,"onMouseDrag",
this,"_onSnappingMouseMoveHandler");this.alwaysSnap&&this._activateSnapping()},_killOffSnapping:function(){k.disconnect(this._onSnapKeyDown_connect);k.disconnect(this._onSnapKeyUp_connect);k.disconnect(this._onSnappingMouseMove_connect);k.disconnect(this._onSnappingMouseDrag_connect);this._deactivateSnapping()},_onSnapKeyDownHandler:function(a){a.keyCode===this.snapKey&&(k.disconnect(this._onSnapKeyDown_connect),this.alwaysSnap?this._deactivateSnapping():this._activateSnapping())},_activateSnapping:function(){this._snappingActive=
!0;this._addSnappingPointGraphic();this._currentLocation&&this._onSnappingMouseMoveHandler(this._currentLocation)},_onSnapKeyUpHandler:function(a){a.keyCode===this.snapKey&&(this._onSnapKeyDown_connect=k.connect(this.map,"onKeyDown",this,"_onSnapKeyDownHandler"),this.alwaysSnap?this._activateSnapping():this._deactivateSnapping())},_deactivateSnapping:function(){this._snappingActive=!1;this._snappingPoint=null;this.map.graphics.remove(this._snappingGraphic);this._snappingGraphic.setGeometry(null)},
_onSnappingMouseMoveHandler:function(a){if(this._currentLocation=a,this._snappingPoint=null,this._snappingActive)this._snappingGraphic.hide(),this.getSnappingPoint(a.screenPoint).addCallback(this._snappingCallback)},_snappingCallback:function(a){(this._snappingPoint=a)&&(this._snappingGraphic.show(),this._snappingGraphic.setGeometry(a))}});return l("extend-esri")&&(g.SnappingManager=h),h})},"esri/dijit/editing/Editor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/DeferredList dojo/dom-class dojo/dom-construct dojo/string dijit/_Widget dijit/_Templated ../../domUtils ../../graphicsUtils ../../geometry/Polyline ../../geometry/Polygon ../../graphic ../../undoManager ../../tasks/query ../../layers/FeatureLayer ../../layers/FeatureTemplate ../../toolbars/draw ../../toolbars/edit ../AttributeInspector ./Util ./Add ./Update ./Delete ./Cut ./Union ./toolbars/Drawing ./SelectionHelper ./TemplatePicker ../../kernel ../../config dojo/i18n!../../nls/jsapi dojo/text!./templates/Editor.html dijit/ProgressBar dojo/NodeList-dom".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J,L,M,H,K,P,O,S,Q){var R=h([n,q],{declaredClass:"esri.dijit.editing.Editor",widgetsInTemplate:!0,templateString:Q,onLoad:function(){},constructor:function(a,b){a=a||{};a.settings||console.error("Editor: please provide 'settings' parameter in the constructor");a.settings.layerInfos||console.error("Editor: please provide 'layerInfos' parameter in the constructor");this._settings=a.settings;this._eConnects=[]},startup:function(){this.inherited(arguments);
this._setDefaultOptions();var b=this._settings.layerInfos;if(a.every(b,function(a){return a.featureLayer.loaded}))this._initLayers(),this._connectEvents(),this._createWidgets(),this.onLoad(),this.loaded=!0;else{var c=b.length;a.forEach(b,function(a){a=a.featureLayer;if(a.loaded)c--;else var b=f.connect(a,"onLoad",this,function(a){f.disconnect(b);b=null;c--;c||(this._initLayers(),this._connectEvents(),this._createWidgets(),this.onLoad(),this.loaded=!0)})},this)}this._reset();this._enableMapClickHandler()},
stopEditing:function(a){this._updateCurrentFeature(k.hitch(this,function(){this._clearSelection(!1);a&&a()}))},destroy:function(){this.drawingToolbar&&this.drawingToolbar.destroy();this.attributeInspector&&this.attributeInspector.destroy();this.templatePicker&&this.templatePicker.destroy();this._selectionHelper&&this._selectionHelper.destroy();this._drawToolbar&&this._drawToolbar.deactivate();this._reset();this._disableMapClickHandler();a.forEach(this._eConnects,f.disconnect);f.disconnect(this._dtConnect);
f.disconnect(this._templatePickerOnSelectionChangeEvent);this._layer=this._currentGraphic=this._activeType=this._activeTemplate=this._drawingTool=this._drawToolbar=this.editToolbar=this.drawingToolbar=this.attributeInspector=this.templatePicker=this.undoManager=null;this._settings.map.infoWindow&&this._settings.map.infoWindow.clearFeatures&&this._settings.map.infoWindow.clearFeatures();this.inherited(arguments)},_setDefaultOptions:function(){this._drawToolbar=this._settings.drawToolbar||new B(this._settings.map);
this._settings.drawToolbar=this._drawToolbar;this.editToolbar=this._settings.editToolbar||new C(this._settings.map,{textSymbolEditorHolder:this.domNode});this._settings.editToolbar=this.editToolbar;this._settings.toolbarVisible=this._settings.toolbarVisible||!1;this._settings.toolbarOptions=k.mixin({reshapeVisible:!1,cutVisible:!1,mergeVisible:!1},this._settings.toolbarOptions);this._settings.createOptions=k.mixin({polylineDrawTools:[R.CREATE_TOOL_POLYLINE],polygonDrawTools:[R.CREATE_TOOL_POLYGON],
editAttributesImmediately:!0},this._settings.createOptions);this._settings.singleSelectionTolerance=this._settings.singleSelectionTolerance||3;this._settings.maxUndoRedoOperations=this._settings.maxUndoRedoOperations||10;this._settings.editor=this;this._usePopup=this._settings.usePopup=this._settings.map.infoWindow._setPagerCallbacks?!0:!1;this._datePackage=this._settings.datePackage;var a=O.defaults;this._settings.geometryService=this._settings.geometryService||a.geometryService;a.geometryService=
a.geometryService||this._settings.geometryService},_initLayers:function(){this._settings.layers=[];this._settings.userIds={};this._settings.createOnlyLayer={};a.forEach(this._settings.layerInfos,function(a){if(a.featureLayer&&a.featureLayer.loaded){this._settings.layers.push(a.featureLayer);var b=a.featureLayer.id;a.featureLayer.credential&&(this._settings.userIds[b]=a.featureLayer.credential.userId);a.userId&&(this._settings.userIds[b]=a.userId);var c=a.featureLayer.getEditCapabilities();c.canCreate&&
!c.canUpdate?this._settings.createOnlyLayer[b]=!0:this._settings.createOnlyLayer[b]=!1;this._isTextSymbolPointLayer(a.featureLayer)&&(a.disableAttributeUpdate=!0)}},this)},_reset:function(){this._hideAttributeInspector();this.editToolbar.deactivate();this._editVertices=!0;this._drawingTool=this._activeTemplate=this._activeType=this._currentGraphic=this._layer=null;this._attributeChanged=!1},_saveFeatureOnClient:function(a){var b,c=this.templatePicker.getSelected();b=c.template?c.featureLayer.renderer.getSymbol(c.template.prototype):
c.symbolInfo.symbol;this._tempGraphic=new w(a,b,null,null);this._tempGraphic.setAttributes(k.mixin({},c.template.prototype.attributes));b=this._settings.map;b.graphics.add(this._tempGraphic);a=this._findCenterPoint(a);this._createAttributeInspector(!0);b.infoWindow.setTitle(c.featureLayer?c.featureLayer.name:S.widgets.attributeInspector.NLS_title);this.attributeInspector.showFeature(this._tempGraphic,c.featureLayer);this._showInfoWindow(a,b.getInfoWindowAnchor(a));this._settings.createOnlyLayer[c.featureLayer.id]&&
(this._infoWindowHideEvent=f.connect(b.infoWindow,"onHide",this,"_infoWindowHide"));f.disconnect(this._templatePickerOnSelectionChangeEvent);this.templatePicker.clearSelection();this._drawToolbar.deactivate();this._enableMapClickHandler();this.drawingToolbar&&this.drawingToolbar.deactivate();this._templatePickerOnSelectionChangeEvent=f.connect(this.templatePicker,"onSelectionChange",k.hitch(this,"_onCreateFeature"))},_saveAttributesOnClient:function(a,b,c){this._tempGraphic.attributes[b]="number"==
typeof c&&isNaN(c)?null:c},_infoWindowHide:function(){this._createFeature(this._tempGraphic.geometry,this._tempGraphic.attributes);f.disconnect(this._infoWindowHideEvent)},_createFeature:function(b,c){return this._editClickPoint=this._findCenterPoint(b),b.rings?void this._simplify(b,k.hitch(this,function(b){this._drawingTool!==z.TOOL_AUTO_COMPLETE_POLYGON?this._applyEdits([{layer:this._layer,adds:[this._createGraphic(b,c)]}],k.hitch(this,function(){this._chainAttachment(this._oEdits[0].adds[0].attributes[this._oEdits[0].layer.objectIdField],
this._oEdits[0].layer)})):this._autoComplete(b,k.hitch(this,function(b){b&&b.length&&this._applyEdits([{layer:this._layer,adds:a.map(b,k.hitch(this,function(a){return this._createGraphic(a,c)}))}],function(){this._chainAttachment(this._oEdits[0].adds[0].attributes[this._oEdits[0].layer.objectIdField],this._oEdits[0].layer)})}))})):void this._applyEdits([{layer:this._layer,adds:[this._createGraphic(b,c)]}],k.hitch(this,function(){this._chainAttachment(this._oEdits[0].adds[0].attributes[this._oEdits[0].layer.objectIdField],
this._oEdits[0].layer);this._layer&&this._layer.renderer&&"heatmap"===this._layer.renderer.type&&this._layer.refresh()}))},_chainAttachment:function(a,b){this.attributeInspector&&this.attributeInspector._attachmentEditor&&this.attributeInspector._attachmentEditor._tempUpload&&this.attributeInspector._attachmentEditor._chainAttachment(a,b)},_updateCurrentFeature:function(a){var b=this._isModified();b?this._updateFeature(b,a):a&&a(!1)},_updateFeature:function(a,b,c){var d,e=a.geometry,f=a.getLayer();
f.hasM&&!f.allowUpdateWithoutMValues||c&&!this._isModified()?(d=new w,d.setAttributes(a.attributes),this._applyEdits([{layer:a.getLayer(),updates:[d]}],b)):e.rings?this._simplify(e,k.hitch(this,function(c){this._applyEdits([{layer:a.getLayer(),updates:[k.mixin(a,{geometry:c})]}],b)})):this._applyEdits([{layer:a.getLayer(),updates:[a]}],b)},_deleteFeature:function(b,c){var d=[];b?d.push({layer:b.getLayer(),deletes:[b]}):(d=a.map(a.filter(this._settings.layers,function(a){return 0<a.getSelectedFeatures().length}),
function(a){return{layer:a,deletes:a.getSelectedFeatures()}}))&&d.length||!this._currentGraphic||d.push({layer:this._layer,deletes:[this._currentGraphic]});this._applyEdits(d,c)},_stopEditing:function(a,b,c,d){t.hide(this.progressBar.domNode);this._settings.createOnlyLayer[a.id]||this._undoRedoAdd();var e;if(!0===a._isSelOnly||1===a.mode||6===a.mode){if(b&&b.length){this.templatePicker.clearSelection();var f=new y;f.objectIds=[b[0].objectId];this._settings.createOnlyLayer[a.id]?this._settings.map.graphics.remove(this._tempGraphic):
this._selectFeatures([a],f,k.hitch(this,"_onEditFeature"))}}else(e=this._selectionHelper.findMapService(this._settings.map,a))&&e.refresh(),b&&b.length&&(this.templatePicker.clearSelection(),this._settings.createOnlyLayer[a.id]?this._settings.map.graphics.remove(this._tempGraphic):E.findFeatures(b,a,k.hitch(this,"_onEditFeature")));d&&d.length&&(this._clearSelection(!0),this._undoRedo&&(e=this._selectionHelper.findMapService(a,this._settings.map),e&&e.refresh()));this._undoRedo&&c&&c.length&&(e=this._selectionHelper.findMapService(a,
this._settings.map),e&&e.refresh(),this.attributeInspector.refresh(),this._undoRedo=!1);this.drawingToolbar&&this.drawingToolbar._updateUI();this._undoRedo=!1},_undoRedoAdd:function(){if(this._settings._isApplyEditsCall=!1,this._settings.undoManager){var a=this._edits&&this._edits.length?this._edits[0]:null;if(a){var b=a.adds||[],c=a.updates||[],d=a.deletes||[],e=a.preUpdates||[],a={featureLayer:a.layer};"CUT"===this._activeTool?b.length&&c.length&&e.length&&this.undoManager.add(new J(k.mixin(a,{preUpdatedGraphics:e,
addedGraphics:b,postUpdatedGraphics:c}))):"UNION"===this._activeTool?d.length&&c.length&&e.length&&this.undoManager.add(new L(k.mixin(a,{preUpdatedGraphics:e,deletedGraphics:d,postUpdatedGraphics:c}))):b.length?this.undoManager.add(new F(k.mixin(a,{addedGraphics:b}))):d.length?this.undoManager.add(new I(k.mixin(a,{deletedGraphics:d}))):c.length&&(this._rollbackGraphic||e.length)&&this.undoManager.add(new G(k.mixin(a,{preUpdatedGraphics:e.length?e:[this._rollbackGraphic],postUpdatedGraphics:c})));
this._rollbackGraphic=this._edits=null}}},_activateDrawToolbar:function(a){this._layer=a.featureLayer;this._activeType=a.type;this._drawingTool=(this._activeTemplate=a.template)?this._activeTemplate.drawingTool:null;this._drawTool=this._toDrawTool(this._drawingTool,a.featureLayer);f.disconnect(this._dtConnect);this._settings.createOnlyLayer[a.featureLayer.id]?this._dtConnect=f.connect(this._drawToolbar,"onDrawEnd",this,"_saveFeatureOnClient"):this._dtConnect=f.connect(this._drawToolbar,"onDrawEnd",
this,"_createFeature");this.editToolbar.deactivate();this._disableMapClickHandler();this.drawingToolbar?this.drawingToolbar.activateEditing(this._drawTool,this._layer):this._drawToolbar.activate(this._drawTool)},_activateEditToolbar:function(b,c){var d=b.getLayer(),e=d?d.geometryType:null,f=this._isTextSymbolPoint(b),g=C.MOVE;"esriGeometryPoint"!==e&&!0===this._isNotesFeature(b)?(g=g|C.ROTATE|C.SCALE,this._editVertices=!1):"esriGeometryPoint"!==e&&!0===this._editVertices?(g=g|C.ROTATE|C.SCALE,this._editVertices=
!1):f?(g=g|C.ROTATE|C.SCALE|C.EDIT_TEXT,this._editVertices=!1):(g|=C.EDIT_VERTICES,this._editVertices=!0);this._attributeChanged=this._isModified();this._rollbackGraphic=new w(b.toJson());var e=d.getEditCapabilities({feature:b,userId:this._settings.userIds[d.id]}),l=a.filter(this._settings.layerInfos,function(a){return a.featureLayer.layerId===d.layerId})[0];(e.canUpdate&&!l.disableGeometryUpdate&&d.allowGeometryUpdates&&(this.editToolbar.activate(g,b),f&&(this.editToolbar._textEditor._addTextBox(b),
this.editToolbar._textSymbolEditor&&this.editToolbar._textSymbolEditor.hide())),this._settings.map.infoWindow.isShowing||this._updateAttributeDisabled(b))||(f=c&&c.screenPoint||this._findCenterPoint(b),this._showInfoWindow(f,this._settings.map.getInfoWindowAnchor(f)))},_createGraphic:function(b,c){var d=new w(b,this._activeType&&this._activeType.symbol||this._layer.defaultSymbol,c);return this._activeTemplate||c?d.attributes=c||k.mixin({},this._activeTemplate.prototype.attributes):(d.attributes=d.attributes||
[],a.forEach(this._layer.fields,function(a){d.attributes[a.name]=null},this)),d},_connectEvents:function(){var b=this._settings.layers;a.forEach(b,function(a){this._connect(a,"onEditsComplete",k.hitch(this,"_stopEditing",a))},this);a.forEach(b,function(a){this._connect(a,"onBeforeApplyEdits",k.hitch(this,function(){t.show(this.progressBar.domNode);this._settings._isApplyEditsCall=!0}))},this);this._connect(this.editToolbar,"onGraphicClick",k.hitch(this,"_activateEditToolbar"));this._connect(this.editToolbar,
"onGraphicFirstMove",k.hitch(this,"_hideAttributeInspector"));this._connect(this.editToolbar,"onVertexFirstMove",k.hitch(this,"_hideAttributeInspector"));this._connect(this.editToolbar,"onScaleStart",k.hitch(this,"_hideAttributeInspector"));this._connect(this.editToolbar,"onRotateStart",k.hitch(this,"_hideAttributeInspector"))},_connect:function(a,b,c){this._eConnects.push(f.connect(a,b,c))},_createWidgets:function(){this._selectionHelper=new H(this._settings);this._createTemplatePicker();this._createAttributeInspector();
this._createDrawingToolbar();this._createUndoRedoManager()},_createTemplatePicker:function(){if(this._settings.templatePicker)this.templatePicker=this._settings.templatePicker,t.hide(this.templatePickerDiv);else{var b=a.filter(this._settings.layers,function(a){return a.getEditCapabilities().canCreate});this.templatePicker=new K({"class":"esriTemplatePicker",featureLayers:b,showTooltip:!0,maxLabelLength:this._settings.typesCharacterLimit,columns:"auto",rows:"auto"},this.templatePickerDiv);this.templatePicker.startup();
this._settings.templatePicker=this.templatePicker}this._templatePickerOnSelectionChangeEvent=f.connect(this.templatePicker,"onSelectionChange",k.hitch(this,"_onCreateFeature"))},_createAttributeInspector:function(c){if(this._settings.attributeInspector)this._customAttributeInspector=!0,this.attributeInspector=this._settings.attributeInspector;else{this._customAttributeInspector=!1;var e=this._settings.map;this.attributeInspector=new D({layerInfos:this._settings.layerInfos,hideNavButtons:this._usePopup,
datePackage:this._datePackage},d.create("div"));this.attributeInspector.startup();e.infoWindow.setContent(this.attributeInspector.domNode);e.infoWindow.setTitle(S.widgets.attributeInspector.NLS_title);e.infoWindow.resize(350,375);b.query(".esriAttributeInspector .atiLayerName").style({display:"none"})}this._connect(this.attributeInspector,"onDelete",k.hitch(this,"_deleteFeature"));this._connect(this.attributeInspector,"onNext",k.hitch(this,function(a){this._updateCurrentFeature(k.hitch(this,function(){this._attributeChanged=
!1;this._onEditFeature(a)}))}));this._usePopup&&this._settings.map.infoWindow._setPagerCallbacks(this.attributeInspector,k.hitch(this.attributeInspector,"next"),k.hitch(this.attributeInspector,"previous"));c?this._connect(this.attributeInspector,"onAttributeChange",k.hitch(this,"_saveAttributesOnClient")):this._connect(this.attributeInspector,"onAttributeChange",k.hitch(this,function(b,c,d){var e=b.getLayer();(e=a.filter(e.fields,function(a){return a.name===c})[0])&&""===d&&(d=null);this._rollbackGraphic=
new w(k.clone(b.toJson()));this.attributeInspector._rollbackInfo={field:e,graphic:this._rollbackGraphic};this._currentGraphic.attributes[c]="number"==typeof d&&isNaN(d)?null:d;this._currentGraphic.setAttributes(this._currentGraphic.attributes);this._updateFeature(this._currentGraphic,null,!0);this._attributeChanged=!1}))},_createDrawingToolbar:function(){!0===this._settings.toolbarVisible&&(this.drawingToolbar=new M({"class":"esriDrawingToolbar",drawToolbar:this._drawToolbar,editToolbar:this.editToolbar,
settings:this._settings,onDelete:k.hitch(this,"_deleteFeature"),onApplyEdits:k.hitch(this,"_applyEdits"),onShowAttributeInspector:k.hitch(this,"_onEditFeature")},this.drawingToolbarDiv))},_createUndoRedoManager:function(){(this._settings.enableUndoRedo||this._settings.undoManager)&&(this._settings.enableUndoRedo=!0,this.undoManager=this._settings.undoManager,this.undoManager||(this.undoManager=this._settings.undoManager=new x({maxOperations:this._settings.maxUndoRedoOperations})),this._connect(this.undoManager,
"onUndoComplete",k.hitch(this,this._updateUndoRedoOperations)),this._connect(this.undoManager,"onRedoComplete",k.hitch(this,this._updateUndoRedoOperations)),this._connect(document,"onkeypress",k.hitch(this,function(a){(a.metaKey||a.ctrlKey)&&("z"===a.charOrCode&&this._undo(),"y"===a.charOrCode&&this._redo())})))},_updateUndoRedoOperations:function(a){if(a&&a.addedIds){var b;for(b=0;b<this.undoManager.length;b++){var c=this.undoManager.get(b);c&&a.layer===c._featureLayer&&c.updateObjectIds(a.oldIds,
a.addedIds)}}a&&"Update Features"===a.operation.label&&this.attributeInspector.refresh()},_enableMapClickHandler:function(){this._mapClickHandler=f.connect(this._settings.map,"onClick",k.hitch(this,function(a){return this._drawToolbar._geometryType?void 0:"SELECT"===this._activeTool?void(this._activeTool=""):void this._updateCurrentFeature(k.hitch(this,function(){this._reset();this._updateSelection(a)}))}))},_disableMapClickHandler:function(){f.disconnect(this._mapClickHandler)},_onCreateFeature:function(){var a=
this.templatePicker.getSelected();a?this._updateCurrentFeature(k.hitch(this,function(){this._currentGraphic&&this._clearSelection(!1);this._reset();this._activateDrawToolbar(a)})):(this._reset(),f.disconnect(this._dtConnect),this._drawToolbar.deactivate(),this._enableMapClickHandler(),this.drawingToolbar&&this.drawingToolbar.deactivate())},_isTextSymbolPoint:function(a){if("point"===a.geometry.type||"multipoint"===a.geometry.type){var b=a.getLayer(),c=b.renderer;a=a.symbol||b._getSymbol(a);if(!a&&
(c.hasVisualVariables("sizeInfo",!1)||c.hasVisualVariables("colorInfo",!1)||c.hasVisualVariables("opacityInfo",!1))&&c.addBreak&&c.infos&&1===c.infos.length&&(a=c.infos[0].symbol||c.defaultSymbol),a&&"textsymbol"===a.type)return!0}return!1},_isTextSymbolPointLayer:function(a){return"esriGeometryPoint"===a.geometryType&&a.renderer&&a.renderer._symbols&&a.renderer._symbols[0]&&a.renderer._symbols[0].symbol&&"textsymbol"===a.renderer._symbols[0].symbol.type?!0:!1},_updateAttributeDisabled:function(a){a=
a.getLayer();if(!a)return!1;var b,c,d=!1;for(b=0;b<this._settings.layerInfos.length;b++)if(c=this._settings.layerInfos[b],c.featureLayer==a){d=c.disableAttributeUpdate;break}return d},_onEditFeature:function(a,b){var d,e,f;(a=(k.isArray(a)?a[0]:a)||null)&&(this._layer=a.getLayer(),this._customAttributeInspector||this._updateAttributeDisabled(a)||(b=b||this._editClickPoint||this._findCenterPoint(a),1<this._currentFeatureCount?(this._popupFeatures.indexOf(a),d=this._currentFeatureCount-this._popupFeatures.indexOf(a)+
1,d>this._currentFeatureCount&&(d=1),e=c.substitute(S.widgets.popup.NLS_pagingInfo,{index:d,total:this._currentFeatureCount}),this._settings.map.infoWindow.setTitle(e)):(e=this._layer?this._layer.name:S.widgets.attributeInspector.NLS_title,this._settings.map.infoWindow.setTitle(e)),(this.drawingToolbar||!this._settings.map.infoWindow.isShowing)&&(this.attributeInspector.refresh(),this._showInfoWindow(b,this._settings.map.getInfoWindowAnchor(b))),this._editClickPoint=null),a!==this._currentGraphic&&
(this._editVertices=!0,this._currentGraphic=a,a.getDojoShape()&&a.getDojoShape().moveToFront(),f=!!this._layer.hasM,(!f||this._layer.allowUpdateWithoutMValues)&&this._activateEditToolbar(a)))},_applyEdits:function(b,c){if(b=b||[],!(0>=b.length)){this._edits=this._oEdits=b;var d=[];a.forEach(b,function(a){a.layer&&d.push(a.layer.applyEdits(a.adds,a.updates,a.deletes))});0<d.length&&(this._deferredsList=(new m(d)).addCallback(k.hitch(this,function(){t.hide(this.progressBar.domNode);c&&c();var a=this._settings.map;
a&&a.infoWindow.reposition&&a.infoWindow.isShowing&&a.infoWindow.reposition()})))}},_undo:function(){this._settings.undoManager&&!this._settings._isApplyEditsCall&&(this.editToolbar.deactivate(),this._undoRedo=!0,this._settings.undoManager.undo())},_redo:function(){this._settings.undoManager&&!this._settings._isApplyEditsCall&&(this.editToolbar.deactivate(),this._undoRedo=!0,this._settings.undoManager.redo())},_simplify:function(a,b){u.prototype.isSelfIntersecting(a)?this._settings.geometryService.simplify([a],
function(a){var c=a&&a.length?a[0]:c;b&&b(c)}):b&&b(a)},_autoComplete:function(a,b){var c=this._getLayers("esriGeometryPolygon"),d=new y;d.geometry=a;d.returnGeometry=!0;this._selectFeatures(c,d,k.hitch(this,function(c){!c||0>=c.length?b&&b([a]):this._settings.geometryService.autoComplete(r.getGeometries(c),this._toPolylines([d.geometry]),function(a){b&&b(a)})}))},_getLayers:function(b){return a.filter(this._settings.layers,function(a){return a.geometryType===b})},_selectFeatures:function(a,b,c,d){this._selectionHelper.selectFeatures(a,
b,d||A.SELECTION_NEW,c)},_updateSelection:function(b){var c=b.mapPoint,d=b.graphic;if(d&&d.getLayer()&&!this._isValidLayer(d.getLayer()))return void this._clearSelection();if(this._selectionHelper.selectFeaturesByGeometry(this._settings.layers,c,A.SELECTION_NEW,k.hitch(this,function(b){var e=a.some(b,k.hitch(this,function(a){return a==d}));d&&!e?(b=d.getLayer(),this._isValidLayer(b)?(e=new y,e.objectIds=[d.attributes[b.objectIdField]],this._selectionHelper.selectFeatures([b],e,A.SELECTION_ADD,k.hitch(this,
function(a){this._updatePopupButtons(a);this._onEditFeature(a,c)}))):this._clearSelection()):b&&b.length?(this._updatePopupButtons(b),this._onEditFeature(b,c)):this._clearSelection()})),d&&this._isTextSymbolPoint(d))b=0|C.MOVE|C.ROTATE|C.SCALE|C.EDIT_TEXT,this.editToolbar.activate(b,d)},_updatePopupButtons:function(c){if(!this._usePopup||!c)return this._popupFeatures=null,void(this._currentFeatureCount=null);var d=c.length;a.forEach([this._settings.map.infoWindow._prevFeatureButton,this._settings.map.infoWindow._nextFeatureButton],
k.hitch(this,function(a){1<d?g.remove(a,"hidden"):g.add(a,"hidden")}));var e=1<d?"block":"none";b.query(".esriAttributeInspector .atiLayerName").style({display:e});this._currentFeatureCount=d;this._popupFeatures=c},_clearSelection:function(a){this._currentFeatureCount=0;this._popupFeatures=null;this._selectionHelper.clearSelection(a||!1);this._reset()},_findCenterPoint:function(a){var b;a=a.geometry||a;switch(a.type){case "point":b=a;break;case "polyline":b=a.getPoint(0,Math.ceil(a.paths[0].length/
2));break;case "polygon":b=a.rings.length-1,b=a.getPoint(b,a.rings[b].length-1)}return this._settings.map.toScreen(b)},_hideAttributeInspector:function(){!this._customAttributeInspector&&this._settings.map.infoWindow&&this._settings.map.infoWindow.hide()},_toPolylines:function(b){return a.map(b,function(b){var c=new v(b.spatialReference);return a.forEach(b.rings,function(a){c.addPath(a)}),c})},_isNotesFeature:function(b){var c=b.getLayer(),d=c?c.types||null:null;if(!d)return!1;var e,f=b.attributes[c.typeIdField];
return(a.some(d,function(a){return a.id===f?(e=a.templates,!0):!1}),e)?(b=e[0]||null)?this._isShapeTool(b.drawingTool)?!0:!1:!1:!1},_isValidLayer:function(a){var b,c=this._settings.layerInfos;for(b=0;b<c.length;b++){var d=c[b];if(a.id==(d.featureLayer?d.featureLayer.id:d.layerId))return!0}return!1},_isShapeTool:function(a){switch(a){case z.TOOL_ARROW:return B.ARROW;case z.TOOL_LEFT_ARROW:return B.LEFT_ARROW;case z.TOOL_RIGHT_ARROW:return B.RIGHT_ARROW;case z.TOOL_UP_ARROW:return B.UP_ARROW;case z.TOOL_DOWN_ARROW:return B.DOWN_ARROW;
case z.TOOL_CIRCLE:return B.CIRCLE;case z.TOOL_ELLIPSE:return B.ELLIPSE;case z.TOOL_TRIANGLE:return B.TRIANGLE;case z.TOOL_RECTANGLE:return B.RECTANGLE;default:return null}},_toDrawTool:function(a,b){var c=b.geometryType;switch(a){case z.TOOL_POINT:return B.POINT;case z.TOOL_ARROW:return B.ARROW;case z.TOOL_LEFT_ARROW:return B.LEFT_ARROW;case z.TOOL_RIGHT_ARROW:return B.RIGHT_ARROW;case z.TOOL_UP_ARROW:return B.UP_ARROW;case z.TOOL_DOWN_ARROW:return B.DOWN_ARROW;case z.TOOL_CIRCLE:return B.CIRCLE;
case z.TOOL_ELLIPSE:return B.ELLIPSE;case z.TOOL_TRIANGLE:return B.TRIANGLE;case z.TOOL_RECTANGLE:return B.RECTANGLE;case z.TOOL_LINE:return B.POLYLINE;case z.TOOL_POLYGON:return B.POLYGON;case z.TOOL_FREEHAND:return"esriGeometryPolyline"===c?B.FREEHAND_POLYLINE:B.FREEHAND_POLYGON;default:var d=B.POINT;return"esriGeometryPolyline"===c?(d=B.POLYLINE,this._settings.createOptions.polylineDrawTools[0]===R.CREATE_TOOL_FREEHAND_POLYLINE&&(d=B.FREEHAND_POLYLINE)):"esriGeometryPolygon"===c&&(d=B.POLYGON,
this._settings.createOptions.polygonDrawTools[0]===R.CREATE_TOOL_FREEHAND_POLYGON&&(d=B.FREEHAND_POLYGON)),d}},_isModified:function(){var a=this.editToolbar.getCurrentState();return(a.isModified||this._attributeChanged)&&a.graphic?a.graphic:null},_showInfoWindow:function(a,b){this._customAttributeInspector||this._settings.map.infoWindow.show(a,b)}});return k.mixin(R,{CREATE_TOOL_POLYLINE:"polyline",CREATE_TOOL_FREEHAND_POLYLINE:"freehandpolyline",CREATE_TOOL_POLYGON:"polygon",CREATE_TOOL_FREEHAND_POLYGON:"freehandpolygon",
CREATE_TOOL_AUTOCOMPLETE:"autocomplete",CREATE_TOOL_RECTANGLE:"rectangle",CREATE_TOOL_TRIANGLE:"triangle",CREATE_TOOL_CIRCLE:"circle",CREATE_TOOL_ELLIPSE:"ellipse",CREATE_TOOL_ARROW:"arrow",CREATE_TOOL_UP_ARROW:"uparrow",CREATE_TOOL_DOWN_ARROW:"downarrow",CREATE_TOOL_RIGHT_ARROW:"rightarrow",CREATE_TOOL_LEFT_ARROW:"leftarrow"}),e("extend-esri")&&k.setObject("dijit.editing.Editor",R,P),R})},"esri/undoManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/when ./kernel ./Evented require".split(" "),
function(h,k,a,f,b,e){h=h([e],{declaredClass:"esri.UndoManager",maxOperations:10,canUndo:!1,canRedo:!1,position:0,length:0,onUndo:function(){},onRedo:function(){},onUndoComplete:function(){},onRedoComplete:function(){},onAdd:function(){},onChange:function(){},constructor:function(a){a=a||{};a.maxOperations&&(this.maxOperations=a.maxOperations);this._historyStack=[]},add:function(a){if(0<this.maxOperations)for(;this._historyStack.length>=this.maxOperations;)this._historyStack.shift();this._historyStack.splice(this.position,
0,a);this.position++;this.clearRedo();this.onAdd();this._checkAvailability()},undo:function(){if(0===this.position)return null;var a=this.peekUndo();(this.position--,a)?(a=a.performUndo(),this.onUndo(),this._checkAvailability(),f(a).then(k.hitch(this,this.onUndoComplete))):(this.onUndo(),this._checkAvailability())},redo:function(){if(this.position===this._historyStack.length)return null;var a=this.peekRedo();(this.position++,a)?(a=a.performRedo(),this.onRedo(),this._checkAvailability(),f(a).then(k.hitch(this,
this.onRedoComplete))):(this.onRedo(),this._checkAvailability())},_checkAvailability:function(){this.length=this._historyStack.length;0===this.length?(this.canRedo=!1,this.canUndo=!1):0===this.position?(this.canRedo=!0,this.canUndo=!1):this.position===this.length?(this.canUndo=!0,this.canRedo=!1):(this.canUndo=!0,this.canRedo=!0);this.onChange()},clearUndo:function(){this._historyStack.splice(0,this.position);this.position=0;this._checkAvailability()},clearRedo:function(){this._historyStack.splice(this.position,
this._historyStack.length-this.position);this.position=this._historyStack.length;this._checkAvailability()},peekUndo:function(){return 0<this._historyStack.length&&0<this.position?this.get(this.position-1):void 0},peekRedo:function(){return 0<this._historyStack.length&&this.position<this._historyStack.length?this.get(this.position):void 0},get:function(a){return this._historyStack[a]},remove:function(a){0<this._historyStack.length&&(this._historyStack.splice(a,1),0<this.position&&a<this.position&&
this.position--,this._checkAvailability())},destroy:function(){this._historyStack=null}});return a("extend-esri")&&(b.UndoManager=h),h})},"esri/toolbars/draw":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/_base/window dojo/has dojo/sniff dojo/keys dojo/dom-construct dojo/dom-style dojo/dom-geometry ../kernel ../sniff ./_toolbar ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../graphic ../geometry/jsonUtils ../geometry/webMercatorUtils ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/Rect dojo/i18n!../nls/jsapi".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E){var F=h(r,{declaredClass:"esri.toolbars.Draw",_eventMap:{"draw-complete":!0,"draw-end":["geometry"]},constructor:function(a,c){this.markerSymbol=new v(v.STYLE_SOLID,10,new u(u.STYLE_SOLID,new b([255,0,0]),2),new b([0,0,0,.25]));this.lineSymbol=new u(u.STYLE_SOLID,new b([255,0,0]),2);this.fillSymbol=new w(w.STYLE_SOLID,new u(u.STYLE_SOLID,new b([255,0,0]),2),new b([0,0,0,.25]));this._points=[];this._mouse=!l("esri-touch")&&!l("esri-pointer");
this._defaultOptions={showTooltips:!0,drawTime:75,tolerance:8,tooltipOffset:15};this._options=k.mixin(k.mixin({},this._defaultOptions),c||{});(m("ios")||m("android"))&&(this._options.showTooltips=!1);this._onKeyDownHandler=k.hitch(this,this._onKeyDownHandler);this._onMouseDownHandler=k.hitch(this,this._onMouseDownHandler);this._onMouseUpHandler=k.hitch(this,this._onMouseUpHandler);this._onClickHandler=k.hitch(this,this._onClickHandler);this._onMouseMoveHandler=k.hitch(this,this._onMouseMoveHandler);
this._onMouseDragHandler=k.hitch(this,this._onMouseDragHandler);this._onDblClickHandler=k.hitch(this,this._onDblClickHandler);this._updateTooltip=k.hitch(this,this._updateTooltip);this._hideTooltip=k.hitch(this,this._hideTooltip);this._redrawGraphic=k.hitch(this,this._redrawGraphic)},_geometryType:null,respectDrawingVertexOrder:!1,setRespectDrawingVertexOrder:function(a){this.respectDrawingVertexOrder=a},setMarkerSymbol:function(a){this.markerSymbol=a},setLineSymbol:function(a){this.lineSymbol=a},
setFillSymbol:function(a){this.fillSymbol=a},activate:function(a,b){this._geometryType&&this.deactivate();var c=this.map,d=f.connect,e=F;switch(this._options=k.mixin(k.mixin({},this._options),b||{}),c.navigationManager.setImmediateClick(!1),a){case e.ARROW:case e.LEFT_ARROW:case e.RIGHT_ARROW:case e.UP_ARROW:case e.DOWN_ARROW:case e.TRIANGLE:case e.CIRCLE:case e.ELLIPSE:case e.RECTANGLE:this._deactivateMapTools(!0,!1,!1,!0);this._onClickHandler_connect=d(c,"onClick",this._onClickHandler);this._mouse?
(this._onMouseDownHandler_connect=d(c,"onMouseDown",this._onMouseDownHandler),this._onMouseDragHandler_connect=d(c,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler_connect=d(c,"onMouseUp",this._onMouseUpHandler)):(this._onMouseDownHandler2_connect=d(c,"onMouseDragStart",this._onMouseDownHandler),this._onMouseDragHandler2_connect=d(c,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler2_connect=d(c,"onMouseDragEnd",this._onMouseUpHandler));l("esri-touch")&&!l("esri-pointer")&&
(this._onMouseDownHandler2_connect=d(c,"onSwipeStart",this._onMouseDownHandler),this._onMouseDragHandler2_connect=d(c,"onSwipeMove",this._onMouseDragHandler),this._onMouseUpHandler2_connect=d(c,"onSwipeEnd",this._onMouseUpHandler));break;case e.POINT:this._onClickHandler_connect=d(c,"onClick",this._onClickHandler);break;case e.LINE:case e.EXTENT:case e.FREEHAND_POLYLINE:case e.FREEHAND_POLYGON:this._deactivateMapTools(!0,!1,!1,!0);this._mouse?(this._onMouseDownHandler_connect=d(c,"onMouseDown",this._onMouseDownHandler),
this._onMouseDragHandler_connect=d(c,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler_connect=d(c,"onMouseUp",this._onMouseUpHandler)):(this._onMouseDownHandler_connect=d(c,"onMouseDragStart",this._onMouseDownHandler),this._onMouseDragHandler_connect=d(c,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler_connect=d(c,"onMouseDragEnd",this._onMouseUpHandler));l("esri-touch")&&!l("esri-pointer")&&(this._onMouseDownHandler2_connect=d(c,"onSwipeStart",this._onMouseDownHandler),
this._onMouseDragHandler2_connect=d(c,"onSwipeMove",this._onMouseDragHandler),this._onMouseUpHandler2_connect=d(c,"onSwipeEnd",this._onMouseUpHandler));break;case e.POLYLINE:case e.POLYGON:case e.MULTI_POINT:c.navigationManager.setImmediateClick(!0);this._onClickHandler_connect=d(c,"onClick",this._onClickHandler);this._onDblClickHandler_connect=d(c,"onDblClick",this._onDblClickHandler);this._dblClickZoom=c.isDoubleClickZoom;c.disableDoubleClickZoom();break;default:return void console.error("Unsupported geometry type: "+
a)}this._onKeyDown_connect=d(c,"onKeyDown",this._onKeyDownHandler);this._redrawConnect=d(c,"onExtentChange",this._redrawGraphic);this._geometryType=a;this._toggleTooltip(!0);c.snappingManager&&"freehandpolyline"!==this._geometryType&&"freehandpolygon"!==this._geometryType&&(c.snappingManager._startSelectionLayerQuery(),c.snappingManager._setUpSnapping());this.onActivate(this._geometryType)},deactivate:function(){var a=this.map;this._clear();var b=f.disconnect;switch(b(this._onMouseMoveHandler_connect),
b(this._onMouseDownHandler_connect),b(this._onMouseDragHandler_connect),b(this._onMouseUpHandler_connect),b(this._onMouseDownHandler2_connect),b(this._onMouseDragHandler2_connect),b(this._onMouseUpHandler2_connect),b(this._onClickHandler_connect),b(this._onDblClickHandler_connect),b(this._onKeyDown_connect),b(this._redrawConnect),this._onMouseDownHandler_connect=this._onMouseMoveHandler_connect=this._onMouseDragHandler_connect=this._onMouseUpHandler_connect=this._onMouseDownHandler2_connect=this._onMouseDragHandler2_connect=
this._onMouseUpHandler2_connect=this._onClickHandler_connect=this._onDblClickHandler_connect=this._onKeyDown_connect=this._redrawConnect=null,a.snappingManager&&(a.snappingManager._stopSelectionLayerQuery(),a.snappingManager._killOffSnapping()),this._geometryType){case F.CIRCLE:case F.ELLIPSE:case F.TRIANGLE:case F.ARROW:case F.LEFT_ARROW:case F.RIGHT_ARROW:case F.UP_ARROW:case F.DOWN_ARROW:case F.RECTANGLE:case F.LINE:case F.EXTENT:case F.FREEHAND_POLYLINE:case F.FREEHAND_POLYGON:this._activateMapTools(!0,
!1,!1,!0);break;case F.POLYLINE:case F.POLYGON:case F.MULTI_POINT:this._dblClickZoom&&a.enableDoubleClickZoom()}b=this._geometryType;this._geometryType=null;a.navigationManager.setImmediateClick(!1);this._toggleTooltip(!1);this.onDeactivate(b)},_clear:function(){this._graphic&&this.map.graphics.remove(this._graphic,!0);this._tGraphic&&this.map.graphics.remove(this._tGraphic,!0);this._graphic=this._tGraphic=null;this.map.snappingManager&&this.map.snappingManager._setGraphic(null);this._points=[]},
finishDrawing:function(){var b,c=this._points,d=this.map.spatialReference,e=F;switch(c=c.slice(0,c.length),this._geometryType){case e.POLYLINE:if(!this._graphic||2>c.length)return;b=new z(d);b.addPath([].concat(c));break;case e.POLYGON:if(!this._graphic||3>c.length)return;b=new B(d);c=[].concat(c,[c[0].offset(0,0)]);B.prototype.isClockwise(c)||this.respectDrawingVertexOrder||c.reverse();b.addRing(c);break;case e.MULTI_POINT:b=new C(d),a.forEach(c,function(a){b.addPoint(a)})}f.disconnect(this._onMouseMoveHandler_connect);
this._clear();this._setTooltipMessage(0);this._drawEnd(b)},_drawEnd:function(a){if(a){var b,c=this.map.spatialReference;this.onDrawEnd(a);c&&(c.isWebMercator()?b=A.webMercatorToGeographic(a,!0):4326===c.wkid&&(b=y.fromJson(a.toJson())));this.onDrawComplete({geometry:a,geographicGeometry:b})}},_normalizeRect:function(a,b,c){var d=a.x;a=a.y;var e=b.x;b=b.y;return{x:Math.min(d,e),y:Math.max(a,b),width:Math.abs(d-e),height:Math.abs(a-b),spatialReference:c}},_onMouseDownHandler:function(a){this._dragged=
!1;var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var c=b||a.mapPoint,d=F;b=this.map;var e=b.spatialReference;switch(this._points.push(c.offset(0,0)),this._geometryType){case d.LINE:this._graphic=b.graphics.add(new x(new z({paths:[[[c.x,c.y],[c.x,c.y]]],spatialReference:e}),this.lineSymbol),!0);b.snappingManager&&b.snappingManager._setGraphic(this._graphic);break;case d.FREEHAND_POLYLINE:this._oldPoint=a.screenPoint;c=new z(e);c.addPath(this._points);this._graphic=b.graphics.add(new x(c,
this.lineSymbol),!0);b.snappingManager&&b.snappingManager._setGraphic(this._graphic);break;case d.CIRCLE:case d.ELLIPSE:case d.TRIANGLE:case d.ARROW:case d.LEFT_ARROW:case d.RIGHT_ARROW:case d.UP_ARROW:case d.DOWN_ARROW:case d.RECTANGLE:case d.FREEHAND_POLYGON:this._oldPoint=a.screenPoint,c=new B(e),c.addRing(this._points),this._graphic=b.graphics.add(new x(c,this.fillSymbol),!0),b.snappingManager&&b.snappingManager._setGraphic(this._graphic)}l("esri-touch")&&a.preventDefault()},_onMouseMoveHandler:function(a){var b;
this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var c=this._points[this._points.length-1];a=b||a.mapPoint;b=this._tGraphic;var d=b.geometry;switch(this._geometryType){case F.POLYLINE:case F.POLYGON:d.setPoint(0,0,{x:c.x,y:c.y}),d.setPoint(0,1,{x:a.x,y:a.y}),b.setGeometry(d)}},_onMouseDragHandler:function(a){if(this._graphic||this._points.length){if(l("esri-touch")&&!this._points.length)return void a.preventDefault();this._dragged=!0;var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);
var c=this._points[0],d=b||a.mapPoint,e=this.map,f=e.spatialReference;b=this._graphic;var g=F,h=e.toScreen(c),m=e.toScreen(d),n=[],n=m.x-h.x,m=m.y-h.y,q=Math.sqrt(n*n+m*m);switch(this._geometryType){case g.CIRCLE:this._hideTooltip();b.geometry=B.createCircle({center:h,r:q,numberOfPoints:60,map:e});b.setGeometry(b.geometry);break;case g.ELLIPSE:this._hideTooltip();b.geometry=B.createEllipse({center:h,longAxis:n,shortAxis:m,numberOfPoints:60,map:e});b.setGeometry(b.geometry);break;case g.TRIANGLE:this._hideTooltip();
n=[[0,-q],[.8660254037844386*q,.5*q],[-.8660254037844386*q,.5*q],[0,-q]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);break;case g.ARROW:this._hideTooltip();c=m/q;e=n/q;d=.25*e*q;f=.25*q/(m/n);q*=.25*c;n=[[n,m],[n-d*(1+24/f),m+24*e-q],[n-d*(1+12/f),m+12*e-q],[-12*c,12*e],[12*c,-12*e],[n-d*(1-12/f),m-12*e-q],[n-d*(1-24/f),m-24*e-q],[n,m]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);break;case g.LEFT_ARROW:this._hideTooltip();n=0>=n?[[n,0],[.75*n,m],[.75*n,.5*
m],[0,.5*m],[0,-.5*m],[.75*n,-.5*m],[.75*n,-m],[n,0]]:[[0,0],[.25*n,m],[.25*n,.5*m],[n,.5*m],[n,-.5*m],[.25*n,-.5*m],[.25*n,-m],[0,0]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);break;case g.RIGHT_ARROW:this._hideTooltip();n=0<=n?[[n,0],[.75*n,m],[.75*n,.5*m],[0,.5*m],[0,-.5*m],[.75*n,-.5*m],[.75*n,-m],[n,0]]:[[0,0],[.25*n,m],[.25*n,.5*m],[n,.5*m],[n,-.5*m],[.25*n,-.5*m],[.25*n,-m],[0,0]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);break;case g.UP_ARROW:this._hideTooltip();
n=0>=m?[[0,m],[-n,.75*m],[-.5*n,.75*m],[-.5*n,0],[.5*n,0],[.5*n,.75*m],[n,.75*m],[0,m]]:[[0,0],[-n,.25*m],[-.5*n,.25*m],[-.5*n,m],[.5*n,m],[.5*n,.25*m],[n,.25*m],[0,0]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);break;case g.DOWN_ARROW:this._hideTooltip();n=0<=m?[[0,m],[-n,.75*m],[-.5*n,.75*m],[-.5*n,0],[.5*n,0],[.5*n,.75*m],[n,.75*m],[0,m]]:[[0,0],[-n,.25*m],[-.5*n,.25*m],[-.5*n,m],[.5*n,m],[.5*n,.25*m],[n,.25*m],[0,0]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);
break;case g.RECTANGLE:this._hideTooltip();n=[[0,0],[n,0],[n,m],[0,m],[0,0]];b.geometry=this._toPolygon(n,h.x,h.y);b.setGeometry(b.geometry);break;case g.LINE:b.setGeometry(k.mixin(b.geometry,{paths:[[[c.x,c.y],[d.x,d.y]]]}));break;case g.EXTENT:b&&e.graphics.remove(b,!0);b=new D(this._normalizeRect(c,d,f));b._originOnly=!0;this._graphic=e.graphics.add(new x(b,this.fillSymbol),!0);e.snappingManager&&e.snappingManager._setGraphic(this._graphic);break;case g.FREEHAND_POLYLINE:if(this._hideTooltip(),
!1===this._canDrawFreehandPoint(a))return void(l("esri-touch")&&a.preventDefault());this._points.push(a.mapPoint.offset(0,0));b.geometry._insertPoints([d.offset(0,0)],0);b.setGeometry(b.geometry);break;case g.FREEHAND_POLYGON:if(this._hideTooltip(),!1===this._canDrawFreehandPoint(a))return void(l("esri-touch")&&a.preventDefault());this._points.push(a.mapPoint.offset(0,0));b.geometry._insertPoints([d.offset(0,0)],0);b.setGeometry(b.geometry)}l("esri-touch")&&a.preventDefault()}},_canDrawFreehandPoint:function(a){if(!this._oldPoint)return!1;
var b=this._oldPoint.x-a.screenPoint.x,c=this._oldPoint.y-a.screenPoint.y,d=this._options.tolerance;if(d>(0>b?-1*b:b)&&d>(0>c?-1*c:c))return!1;b=new Date;return b-this._startTime<this._options.drawTime?!1:(this._startTime=b,this._oldPoint=a.screenPoint,!0)},_onMouseUpHandler:function(a){if(!this._dragged||!this._graphic)return void this._clear();0===this._points.length&&this._points.push(a.mapPoint.offset(0,0));var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var c,d=this._points[0];
b=b||a.mapPoint;var e=this.map.spatialReference,f=F;switch(this._geometryType){case f.CIRCLE:case f.ELLIPSE:case f.TRIANGLE:case f.ARROW:case f.LEFT_ARROW:case f.RIGHT_ARROW:case f.UP_ARROW:case f.DOWN_ARROW:case f.RECTANGLE:c=this._graphic.geometry;break;case f.LINE:c=new z({paths:[[[d.x,d.y],[b.x,b.y]]],spatialReference:e});break;case f.EXTENT:c=(new D(this._normalizeRect(d,b,e))).getExtent();break;case f.FREEHAND_POLYLINE:c=new z(e);c.addPath([].concat(this._points,[b.offset(0,0)]));break;case f.FREEHAND_POLYGON:c=
new B(e),d=[].concat(this._points,[b.offset(0,0),this._points[0].offset(0,0)]),B.prototype.isClockwise(d)||this.respectDrawingVertexOrder||d.reverse(),c.addRing(d)}l("esri-touch")&&a.preventDefault();this._clear();this._drawEnd(c)},_onClickHandler:function(a){var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var c,d,e;b=b||a.mapPoint;a=this.map;var g=a.toScreen(b),l=F;switch(this._points.push(b.offset(0,0)),this._geometryType){case l.POINT:this._drawEnd(b.offset(0,0));this._setTooltipMessage(0);
break;case l.POLYLINE:1===this._points.length?(c=new z(a.spatialReference),c.addPath(this._points),this._graphic=a.graphics.add(new x(c,this.lineSymbol),!0),a.snappingManager&&a.snappingManager._setGraphic(this._graphic),this._onMouseMoveHandler_connect=f.connect(a,"onMouseMove",this._onMouseMoveHandler),this._tGraphic=a.graphics.add(new x(new z({paths:[[[b.x,b.y],[b.x,b.y]]],spatialReference:a.spatialReference}),this.lineSymbol),!0)):(this._graphic.geometry._insertPoints([b.offset(0,0)],0),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.lineSymbol),
c=this._tGraphic,d=c.geometry,d.setPoint(0,0,b.offset(0,0)),d.setPoint(0,1,b.offset(0,0)),c.setGeometry(d));break;case l.POLYGON:1===this._points.length?(e=new B(a.spatialReference),e.addRing(this._points),this._graphic=a.graphics.add(new x(e,this.fillSymbol),!0),a.snappingManager&&a.snappingManager._setGraphic(this._graphic),this._onMouseMoveHandler_connect=f.connect(a,"onMouseMove",this._onMouseMoveHandler),this._tGraphic=a.graphics.add(new x(new z({paths:[[[b.x,b.y],[b.x,b.y]]],spatialReference:a.spatialReference}),
this.fillSymbol),!0)):(this._graphic.geometry._insertPoints([b.offset(0,0)],0),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.fillSymbol),c=this._tGraphic,d=c.geometry,d.setPoint(0,0,b.offset(0,0)),d.setPoint(0,1,b.offset(0,0)),c.setGeometry(d));break;case l.MULTI_POINT:c=this._points;1===c.length?(d=new C(a.spatialReference),d.addPoint(c[c.length-1]),this._graphic=a.graphics.add(new x(d,this.markerSymbol),!0),a.snappingManager&&a.snappingManager._setGraphic(this._graphic)):(this._graphic.geometry.addPoint(c[c.length-
1]),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.markerSymbol));break;case l.ARROW:this._addShape([[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]],g.x,g.y);break;case l.LEFT_ARROW:this._addShape([[0,0],[24,24],[24,12],[96,12],[96,-12],[24,-12],[24,-24],[0,0]],g.x,g.y);break;case l.RIGHT_ARROW:this._addShape([[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]],g.x,g.y);break;case l.UP_ARROW:this._addShape([[0,0],[-24,24],[-12,24],[-12,96],
[12,96],[12,24],[24,24],[0,0]],g.x,g.y);break;case l.DOWN_ARROW:this._addShape([[0,0],[-24,-24],[-12,-24],[-12,-96],[12,-96],[12,-24],[24,-24],[0,0]],g.x,g.y);break;case l.TRIANGLE:this._addShape([[0,-48],[41.56921938165306,24],[-41.56921938165306,24],[0,-48]],g.x,g.y);break;case l.RECTANGLE:this._addShape([[0,-96],[96,-96],[96,0],[0,0],[0,-96]],g.x-48,g.y+48);break;case l.CIRCLE:this._clear();this._drawEnd(B.createCircle({center:g,r:48,numberOfPoints:60,map:a}));break;case l.ELLIPSE:this._clear(),
this._drawEnd(B.createEllipse({center:g,longAxis:48,shortAxis:24,numberOfPoints:60,map:a}))}this._setTooltipMessage(this._points.length)},_addShape:function(a,b,c){this._setTooltipMessage(0);this._clear();this._drawEnd(this._toPolygon(a,b,c))},_toPolygon:function(b,c,d){var e=this.map,f=new B(e.spatialReference);return f.addRing(a.map(b,function(a){return e.toMap({x:a[0]+c,y:a[1]+d})})),f},_onDblClickHandler:function(b){var c,d=this._points,e=this.map.spatialReference,g=F;l("esri-touch")&&d.push(b.mapPoint);
var h=d[d.length-1],m=d[d.length-2];switch(d=h&&m&&h.x===m.x&&h.y===m.y?d.slice(0,d.length-1):d.slice(0,d.length),this._geometryType){case g.POLYLINE:if(!this._graphic||2>d.length)return f.disconnect(this._onMouseMoveHandler_connect),this._clear(),void this._onClickHandler(b);c=new z(e);c.addPath([].concat(d));break;case g.POLYGON:if(!this._graphic||2>d.length)return f.disconnect(this._onMouseMoveHandler_connect),this._clear(),void this._onClickHandler(b);c=new B(e);b=[].concat(d,[d[0].offset(0,0)]);
B.prototype.isClockwise(b)||this.respectDrawingVertexOrder||b.reverse();c.addRing(b);break;case g.MULTI_POINT:c=new C(e),a.forEach(d,function(a){c.addPoint(a)})}f.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(c)},_onKeyDownHandler:function(a){a.keyCode===g.ESCAPE&&(f.disconnect(this._onMouseMoveHandler_connect),this._clear(),this._setTooltipMessage(0))},_toggleTooltip:function(a){this._options.showTooltips&&(a?this._tooltip||(this._tooltip=d.create("div",
{"class":"tooltip"},this.map.container),n.isBodyLtr()||c.set(this._tooltip,"direction","rtl"),this._tooltip.style.display="none",this._tooltip.style.position="fixed",this._setTooltipMessage(0),this._onTooltipMouseEnterHandler_connect=f.connect(this.map,"onMouseOver",this._updateTooltip),this._onTooltipMouseLeaveHandler_connect=f.connect(this.map,"onMouseOut",this._hideTooltip),this._onTooltipMouseMoveHandler_connect=f.connect(this.map,"onMouseMove",this._updateTooltip)):this._tooltip&&(f.disconnect(this._onTooltipMouseEnterHandler_connect),
f.disconnect(this._onTooltipMouseLeaveHandler_connect),f.disconnect(this._onTooltipMouseMoveHandler_connect),d.destroy(this._tooltip),this._tooltip=null))},_hideTooltip:function(){var a=this._tooltip;a&&(a.style.display="none")},_setTooltipMessage:function(a){var b=this._tooltip;if(b){var c="";switch(this._geometryType){case F.POINT:c=E.toolbars.draw.addPoint;break;case F.ARROW:case F.LEFT_ARROW:case F.RIGHT_ARROW:case F.UP_ARROW:case F.DOWN_ARROW:case F.TRIANGLE:case F.RECTANGLE:case F.CIRCLE:case F.ELLIPSE:c=
E.toolbars.draw.addShape;break;case F.LINE:case F.EXTENT:case F.FREEHAND_POLYLINE:case F.FREEHAND_POLYGON:c=E.toolbars.draw.freehand;break;case F.POLYLINE:case F.POLYGON:c=E.toolbars.draw.start;1===a?c=E.toolbars.draw.resume:2<=a&&(c=E.toolbars.draw.complete);break;case F.MULTI_POINT:c=E.toolbars.draw.addMultipoint,1<=a&&(c=E.toolbars.draw.finish)}b.innerHTML=c}},_updateTooltip:function(a){var b=this._tooltip;if(b){var d,f;a.clientX||a.pageY?(d=a.clientX,f=a.clientY):(d=a.clientX+e.body().scrollLeft-
e.body().clientLeft,f=a.clientY+e.body().scrollTop-e.body().clientTop);b.style.display="none";c.set(b,{left:d+this._options.tooltipOffset+"px",top:f+"px"});b.style.display=""}},_redrawGraphic:function(a,b,c,d){if(c||this.map.wrapAround180)(a=this._graphic)&&a.setGeometry(a.geometry),(a=this._tGraphic)&&a.setGeometry(a.geometry)},onActivate:function(){},onDeactivate:function(){},onDrawComplete:function(){},onDrawEnd:function(){}});return k.mixin(F,{POINT:"point",MULTI_POINT:"multipoint",LINE:"line",
EXTENT:"extent",POLYLINE:"polyline",POLYGON:"polygon",FREEHAND_POLYLINE:"freehandpolyline",FREEHAND_POLYGON:"freehandpolygon",ARROW:"arrow",LEFT_ARROW:"leftarrow",RIGHT_ARROW:"rightarrow",UP_ARROW:"uparrow",DOWN_ARROW:"downarrow",TRIANGLE:"triangle",CIRCLE:"circle",ELLIPSE:"ellipse",RECTANGLE:"rectangle"}),l("extend-esri")&&k.setObject("toolbars.Draw",F,q),F})},"esri/toolbars/_toolbar":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../Evented"],function(h,k,a,f,
b){h=h([b],{declaredClass:"esri.toolbars._Toolbar",constructor:function(a){this.map=a},_cursors:{move:"pointer","move-v":"pointer","move-gv":"pointer",box0:"nw-resize",box1:"n-resize",box2:"ne-resize",box3:"e-resize",box4:"se-resize",box5:"s-resize",box6:"sw-resize",box7:"w-resize",box8:"pointer"},_deactivateMapTools:function(a,b,f,g){var d=this.map;a&&(this._mapNavState={isDoubleClickZoom:d.isDoubleClickZoom,isClickRecenter:d.isClickRecenter,isPan:d.isPan,isRubberBandZoom:d.isRubberBandZoom,isKeyboardNavigation:d.isKeyboardNavigation,
isScrollWheelZoom:d.isScrollWheelZoom},d.disableDoubleClickZoom(),d.disableClickRecenter(),d.disablePan(),d.disableRubberBandZoom(),d.disableKeyboardNavigation());b&&d.hideZoomSlider();f&&d.hidePanArrows();g&&d.graphics.disableMouseEvents()},_activateMapTools:function(a,b,f,g){var d=this.map,c=this._mapNavState;a&&c&&(c.isDoubleClickZoom&&d.enableDoubleClickZoom(),c.isClickRecenter&&d.enableClickRecenter(),c.isPan&&d.enablePan(),c.isRubberBandZoom&&d.enableRubberBandZoom(),c.isKeyboardNavigation&&
d.enableKeyboardNavigation(),c.isScrollWheelZoom&&d.enableScrollWheelZoom());b&&d.showZoomSlider();f&&d.showPanArrows();g&&d.graphics.enableMouseEvents()},_deactivateScrollWheel:function(){var a=this.map;this._scrollWheelState={isScrollWheelZoom:a.isScrollWheelZoom,isScrollWheelPan:a.isScrollWheelPan};a.disableScrollWheelZoom();a.disableScrollWheelPan()},_activateScrollWheel:function(){var a=this.map,b=this._scrollWheelState;b&&(b.isScrollWheelZoom&&a.enableScrollWheelZoom(),b.isScrollWheelPan&&a.enableScrollWheelPan())}});
return a("extend-esri")&&k.setObject("toolbars._Toolbar",h,f),h})},"esri/toolbars/edit":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/has dojo/dom-construct dojo/dom-style ../kernel ../lang ../sniff ./_toolbar ./_Box ./_GraphicMover ./_VertexEditor ./TextEditor ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/TextSymbol ../graphic".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A){var z=k(q,
{declaredClass:"esri.toolbars.Edit",constructor:function(b,c){if(this._map=b,this._tool=0,this._map.loaded)this._scratchGL=b.graphics;else var d=f.connect(this._map,"onLoad",this,function(){f.disconnect(d);d=null;this._scratchGL=this._map.graphics});var g=l("esri-mobile");this._defaultOptions=a.mixin({vertexSymbol:new w(w.STYLE_CIRCLE,g?20:12,new x(x.STYLE_SOLID,new e([0,0,0,.5]),1),new e([128,128,128])),ghostVertexSymbol:new w(w.STYLE_CIRCLE,g?18:10,new x(x.STYLE_SOLID,new e([0,0,0,.5]),1),new e([255,
255,255,.75])),ghostLineSymbol:new x(x.STYLE_DOT,new e([128,128,128]),2),allowDeleteVertices:!0,allowAddVertices:!0,rotateHandleOffset:g?24:16,boxLineSymbol:new x(x.STYLE_DASH,new e([64,64,64]),1),boxHandleSymbol:new w(w.STYLE_SQUARE,g?16:9,new x(x.STYLE_SOLID,new e([0,0,0,.5]),1),new e([255,255,255,.75])),textAnchorSymbol:new w(w.STYLE_CIRCLE,10,null,new e([255,0,0]))},c||{})},activate:function(b,c,d){this.deactivate();this._graphic=c;this._options=a.mixin(a.mixin({},this._defaultOptions),d||{});
var e=z.MOVE;d=z.EDIT_VERTICES;var g=z.SCALE,l=z.ROTATE,h=z.EDIT_TEXT,m=!1,n=!1,k=!1,q=this._map,r=q.spatialReference,t=c.geometry.spatialReference;this._geo=!(!r||!t||r.equals(t)||!r.isWebMercator()||4326!==t.wkid);this._isTextPoint=this._prepareTextSymbolEditing(c,b);(b&e)===e&&(m=this._enableMove(c));e=(b&g)===g;l=(b&l)===l;if((e||l)&&(k=this._enableBoxEditing(c,e,l)),(b&d)===d&&(n=this._enableVertexEditing(c)),(b&h)===h&&this._enableTextEditing(c),!(m||n||k))throw Error("[esri.toolbars.Edit::activate] Unable to activate the tool. Check if the tool is valid for the given geometry type.");
(this._tool=b)&&(this._mapPanEndHandle=f.connect(q,"onPanEnd",this,this._mapPanEndHandler),this._mapExtChgHandle=f.connect(q,"onExtentChange",this,this._mapExtentChangeHandler),this.onActivate(this._tool,c));q.snappingManager&&(m||n)&&q.snappingManager._startSelectionLayerQuery()},deactivate:function(){this._isTextPoint=null;var a=this._tool,b=this._graphic;if(a){var c=!!this._modified;this._clear();f.disconnect(this._mapPanEndHandle);f.disconnect(this._mapExtChgHandle);this._graphic=this._geo=this._mapPanEndHandle=
this._mapExtChgHandle=null;this.onDeactivate(a,b,{isModified:c});this._map.snappingManager&&this._map.snappingManager._stopSelectionLayerQuery()}},refresh:function(){this._refreshMoveables(!0)},getCurrentState:function(){return{tool:this._tool,graphic:this._graphic,isModified:!!this._modified}},onActivate:function(a,b){},onDeactivate:function(a,b,c){},onGraphicMoveStart:function(a){},onGraphicFirstMove:function(a){this._modified=!0},onGraphicMove:function(a,b){},onGraphicMoveStop:function(a,b){},
onGraphicClick:function(a,b){},onVertexMoveStart:function(a,b){},onVertexFirstMove:function(a,b){this._modified=!0},onVertexMove:function(a,b,c){},onVertexMoveStop:function(a,b,c){},onVertexAdd:function(a,b){this._modified=!0},onVertexClick:function(a,b){},onVertexMouseOver:function(a,b){},onVertexMouseOut:function(a,b){},onVertexDelete:function(a,b){this._modified=!0},onTextEditStart:function(a,b){},onTextEditEnd:function(a){},onScaleStart:function(a){},onScaleFirstMove:function(a){this._modified=
!0},onScale:function(a,b){},onScaleStop:function(a,b){},onRotateStart:function(a){},onRotateFirstMove:function(a){this._modified=!0},onRotate:function(a,b){},onRotateStop:function(a,b){},_eventMap:{activate:["tool","graphic"],deactivate:["tool","graphic","info"],"graphic-move-start":["graphic"],"graphic-first-move":["graphic"],"graphic-move":["graphic","transform"],"graphic-move-stop":["graphic","transform"],"graphic-click":["graphic","info"],"vertex-move-start":["graphic","vertexinfo"],"vertex-first-move":["graphic",
"vertexinfo"],"vertex-move":["graphic","vertexinfo","transform"],"vertex-move-stop":["graphic","vertexinfo","transform"],"vertex-add":["graphic","vertexinfo"],"vertex-click":["graphic","vertexinfo"],"vertex-mouse-over":["graphic","vertexinfo"],"vertex-mouse-out":["graphic","vertexinfo"],"vertex-delete":["graphic","vertexinfo"],"scale-start":["graphic"],"scale-first-move":["graphic"],scale:["graphic","info"],"scale-stop":["graphic","info"],"rotate-start":["graphic"],"rotate-first-move":["graphic"],
rotate:["graphic","info"],"rotate-stop":["graphic","info"]},_prepareTextSymbolEditing:function(a,b){if("point"===a.geometry.type||"multipoint"===a.geometry.type){var c=a.getLayer(),d=c.renderer,c=a.symbol||c._getSymbol(a);if(!c&&(d.hasVisualVariables("sizeInfo",!1)||d.hasVisualVariables("colorInfo",!1)||d.hasVisualVariables("opacityInfo",!1))&&d.addBreak&&d.infos&&1===d.infos.length&&(c=d.infos[0].symbol||d.defaultSymbol),c&&"textsymbol"===c.type){if((b&z.SCALE)===z.SCALE||(b&z.ROTATE)===z.ROTATE||
(b&z.EDIT_TEXT)===z.EDIT_TEXT){a.setSymbol(new y(c.toJson()));var e=this;this._textSymbolEditor?(this._textSymbolEditor.createForm(a),this._textSymbolEditor.show()):this._options&&this._options.textSymbolEditor?(this._textSymbolEditor=this._options.textSymbolEditor,this._textSymbolEditor.on("symbol-change",function(){e._boxEditor&&e._boxEditor.refresh()})):h(["../dijit/SymbolEditor"],function(b){if(!e._textSymbolEditor){var c;c=e._options.textSymbolEditorHolder?m.create("div",null,e._options.textSymbolEditorHolder):
m.create("div",null,e._map.root);e._textSymbolEditor=new b({graphic:a},c);b=e._textSymbolEditor.domNode.parentNode.id;g.set(e._textSymbolEditor.domNode,{position:"map_root"===b?"absolute":"relative",left:"map_root"===b?e._map.width/2-100+"px":"5px",top:"20px","z-index":50});e._textSymbolEditor.startup();e._textSymbolEditor.createForm(a);e._textSymbolEditor.show();e._textSymbolEditor.on("symbol-change",function(){e._boxEditor&&e._boxEditor.refresh()})}})}return((b&z.MOVE)===z.MOVE||(b&z.ROTATE)===
z.ROTATE||(b&z.SCALE)===z.SCALE)&&(this._textAnchor=new A(a.geometry,this._options.textAnchorSymbol),this._scratchGL.add(this._textAnchor)),!0}}return!1},_enableMove:function(a){var b=this._map;switch(a.geometry.type){case "point":case "polyline":case "polygon":return this._graphicMover=new r(a,b,this,this._textAnchor),!0}return!1},_enableVertexEditing:function(a){var b=this._map;switch(a.geometry.type){case "multipoint":case "polyline":case "polygon":return this._vertexEditor=v.create(a,b,this),
!0}return!1},_enableBoxEditing:function(a,b,c){var d=this._map,e=a.geometry.type;return"polyline"===e||"polygon"===e||this._isTextPoint?(this._boxEditor=new t(a,d,this,b,c,this._options.uniformScaling,this._isTextPoint),!0):!1},_enableTextEditing:function(b){return this._isTextPoint?(this._textEditor=new u(b,this._map,this),f.connect(this._textEditor,"onEditStart",a.hitch(this,function(){this._textAnchor&&(this._textAnchor.getLayer().remove(this._textAnchor),this._textAnchor=null);this._map.disableKeyboardNavigation();
this._disableMove();this._disableBoxEditing()})),!0):!1},_disableMove:function(){var a=this._graphicMover;a&&(a.destroy(),this._graphicMover=null)},_disableVertexEditing:function(){var a=this._vertexEditor;a&&(a.destroy(),this._vertexEditor=null)},_disableBoxEditing:function(){var a=this._boxEditor;a&&(a.destroy(),this._boxEditor=null)},_disableTextEditing:function(){this._textEditor&&(this._textEditor.destroy(),this._textEditor=null);this._map.enableKeyboardNavigation()},_disableSymbolEditing:function(){this._textSymbolEditor&&
this._textSymbolEditor.hide()},_clear:function(){this._disableMove();this._disableVertexEditing();this._disableBoxEditing();this._disableTextEditing();this._disableSymbolEditing();this._textAnchor&&(this._textAnchor.getLayer().remove(this._textAnchor),this._textAnchor=null);this._tool=0;this._modified=!1},_mapPanEndHandler:function(){this._refreshMoveables()},_mapExtentChangeHandler:function(a,b,c){c&&this._refreshMoveables()},_refreshMoveables:function(a){var d=b.filter([this._graphicMover,this._vertexEditor,
this._boxEditor],c.isDefined);b.forEach(d,function(b){b.refresh(a)})},_beginOperation:function(a){b.forEach(this._getAffectedTools(a),function(a){a.suspend()})},_endOperation:function(a){b.forEach(this._getAffectedTools(a),function(a){a.resume()})},_getAffectedTools:function(a){var d=[];switch(a){case "MOVE":d=[this._vertexEditor,this._boxEditor];break;case "VERTICES":d=[this._boxEditor];break;case "BOX":d=[this._vertexEditor]}return d=b.filter(d,c.isDefined)}});return a.mixin(z,{MOVE:1,EDIT_VERTICES:2,
SCALE:4,ROTATE:8,EDIT_TEXT:16}),l("extend-esri")&&a.setObject("toolbars.Edit",z,d),z})},"esri/toolbars/_Box":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/has dojo/dom-style dojox/gfx/Moveable dojox/gfx/matrix ../kernel ../lang ../geometry/Point ../geometry/Polyline ../symbols/SimpleMarkerSymbol ../geometry/webMercatorUtils ../geometry/jsonUtils ../graphic".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u){h=h(null,{declaredClass:"esri.toolbars._Box",
constructor:function(a,b,c,d,e,f,g){this._graphic=a;this._map=b;this._toolbar=c;this._scale=d;this._rotate=e;this._defaultEventArgs={};this._scaleEvent="Scale";this._rotateEvent="Rotate";this._uniformScaling=f;a=c._options;this._markerSymbol=a.boxHandleSymbol;this._lineSymbol=a.boxLineSymbol;this._moveStartHandler=k.hitch(this,this._moveStartHandler);this._firstMoveHandler=k.hitch(this,this._firstMoveHandler);this._moveStopHandler=k.hitch(this,this._moveStopHandler);this._moveHandler=k.hitch(this,
this._moveHandler);this._isTextPoint=g;this._init()},destroy:function(){this._cleanUp();this._graphic=this._map=this._toolbar=this._markerSymbol=this._lineSymbol=null},refresh:function(){this._draw()},suspend:function(){a.forEach(this._getAllGraphics(),function(a){a.hide()})},resume:function(){a.forEach(this._getAllGraphics(),function(a){a.show()});this._draw()},_init:function(){this._draw()},_cleanUp:function(){this._connects&&a.forEach(this._connects,f.disconnect);var b=this._toolbar._scratchGL;
this._anchors&&a.forEach(this._anchors,function(a){b.remove(a.graphic);(a=a.moveable)&&a.destroy()});this._box&&b.remove(this._box);this._box=this._anchors=this._connects=null},_draw:function(){if(!this._graphic.getDojoShape())return void this._cleanUp();var b=this._map,c=this._toolbar._scratchGL,d=this._getBoxCoords(),e=new q(b.spatialReference),f=k.clone(a.filter(d,function(a,b){return 8!==b&&0===b%2}));f[0]&&f.push([f[0][0],f[0][1]]);e.addPath(f);this._rotate&&e.addPath([d[1],d[8]]);this._box?
this._box.setGeometry(e):(this._box=new u(e,this._lineSymbol),c.add(this._box));this._anchors?a.forEach(this._anchors,function(a,c){this._scale||(c=8);var e=new n(d[c],b.spatialReference);a.graphic.setGeometry(e);var e=a.moveable,f=a.graphic.getDojoShape();f&&(e?f!==e.shape&&(e.destroy(),a.moveable=this._getMoveable(a.graphic,c)):a.moveable=this._getMoveable(a.graphic,c))},this):(this._anchors=[],this._connects=[],a.forEach(d,function(a,d){if(this._scale||!(8>d)){a=new n(a,b.spatialReference);var e=
new u(a,this._markerSymbol);this._isTextPoint&&1===d%2&&e.hide();c.add(e);this._anchors.push({graphic:e,moveable:this._getMoveable(e,d)})}},this))},_getBoxCoords:function(b){var c,d,e,f,g=this._map,l=[];if(this._isTextPoint){c=this._graphic.getNode().getBoundingClientRect();var h=g.__container.getBoundingClientRect();c=[{x:c.left-h.left,y:c.top-h.top},{x:c.right-h.left,y:c.top-h.top},{x:c.right-h.left,y:c.bottom-h.top},{x:c.left-h.left,y:c.bottom-h.top}]}else c=this._getTransformedBoundingBox(this._graphic);
if(a.forEach(c,function(a,c,h){d=a;(e=h[c+1])||(e=h[0]);f={x:(d.x+e.x)/2,y:(d.y+e.y)/2};b||(d=g.toMap(d),f=g.toMap(f));l.push([d.x,d.y]);l.push([f.x,f.y])}),this._rotate)c=k.clone(l[1]),c=b?{x:c[0],y:c[1]}:g.toScreen({x:c[0],y:c[1],spatialReference:g.spatialReference}),c.y-=this._toolbar._options.rotateHandleOffset,b||(c=g.toMap(c)),l.push([c.x,c.y]);return l},_getTransformedBoundingBox:function(a){var b=this._map,c=a.geometry.getExtent(),d=a.geometry.spatialReference;a=new n(c.xmin,c.ymax,d);c=new n(c.xmax,
c.ymin,d);return a=b.toScreen(a),c=b.toScreen(c),[{x:a.x,y:a.y},{x:c.x,y:a.y},{x:c.x,y:c.y},{x:a.x,y:c.y}]},_getAllGraphics:function(){var b=[this._box];return this._anchors&&a.forEach(this._anchors,function(a){b.push(a.graphic)}),b=a.filter(b,c.isDefined)},_getMoveable:function(a,b){var c=a.getDojoShape();if(c){var d=new m(c);d._index=b;this._connects.push(f.connect(d,"onMoveStart",this._moveStartHandler));this._connects.push(f.connect(d,"onFirstMove",this._firstMoveHandler));this._connects.push(f.connect(d,
"onMoveStop",this._moveStopHandler));d.onMove=this._moveHandler;c=c.getEventSource();return c&&l.set(c,"cursor",this._toolbar._cursors["box"+b]),d}},_moveStartHandler:function(a){this._toolbar["on"+(8===a.host._index?this._rotateEvent:this._scaleEvent)+"Start"](this._graphic)},_firstMoveHandler:function(b){this._toolbar._deactivateScrollWheel();var c,d,e=b.host._index,f=this._wrapOffset=b.host.shape._wrapOffsets[0]||0,l=this._graphic.getLayer()._getTransform(),h=a.map(this._getBoxCoords(!0),function(a){return{x:a[0]+
f,y:a[1]}});b=this._isTextPoint?this._map.toScreen(this._graphic.geometry):{x:h[1].x,y:h[3].y};this._centerCoord=g.multiplyPoint(g.invert(l),b);8===e?(c=g.multiplyPoint(g.invert(l),h[1]),this._isTextPoint&&(this._centerCoord=this._deNormalizePoint(this._centerCoord,c)),this._startLine=[this._centerCoord,c],this._moveLine=k.clone(this._startLine)):(c=g.multiplyPoint(g.invert(l),h[e]),d=g.multiplyPoint(g.invert(l),h[(e+4)%8]),this._isTextPoint&&(this._centerCoord=this._deNormalizePoint(this._centerCoord,
c)),this._firstMoverToAnchor=Math.sqrt((c.x-this._centerCoord.x)*(c.x-this._centerCoord.x)+(c.y-this._centerCoord.y)*(c.y-this._centerCoord.y)),this._startBox=d,this._startBox.width=h[4].x-h[0].x,this._startBox.height=h[4].y-h[0].y,this._moveBox=k.clone(this._startBox),this._xfactor=c.x>d.x?1:-1,this._yfactor=c.y>d.y?1:-1,1===e||5===e?this._xfactor=0:(3===e||7===e)&&(this._yfactor=0));this._toolbar._beginOperation("BOX");this._toolbar["on"+(8===e?this._rotateEvent:this._scaleEvent)+"FirstMove"](this._graphic)},
_moveHandler:function(a,b){var c,d,e,f,l,h,m,n,k,q=a.host._index,r=this._defaultEventArgs;(r.angle=0,r.scaleX=1,r.scaleY=1,8===q)?(c=this._startLine,d=this._moveLine,e=d[1],e.x+=b.dx,e.y+=b.dy,d=this._getAngle(c,d),this._isTextPoint&&(d+=this._graphic.symbol.angle),e=g.rotategAt(d,c[0]),this._graphic.getDojoShape().setTransform(e),r.transform=e,r.angle=d,r.around=c[0]):((c=this._startBox,d=this._moveBox,d.width+=b.dx*this._xfactor,d.height+=b.dy*this._yfactor,this._uniformScaling||this._isTextPoint?
(m=d.x+this._xfactor*d.width,n=d.y+this._yfactor*d.height,k=Math.sqrt((m-this._centerCoord.x)*(m-this._centerCoord.x)+(n-this._centerCoord.y)*(n-this._centerCoord.y)),this._scaleRatio=f=l=k/this._firstMoverToAnchor,h=this._centerCoord):(f=d.width/c.width,l=d.height/c.height,h={x:c.x,y:c.y}),(isNaN(f)||f===1/0||f===-(1/0))&&(f=1),(isNaN(l)||l===1/0||l===-(1/0))&&(l=1),e=g.scaleAt(f,l,h),this._isTextPoint)?(c=g.rotategAt(this._graphic.symbol.angle,h),this._graphic.getDojoShape().setTransform([c,e])):
this._graphic.getDojoShape().setTransform(e),r.transform=e,r.scaleX=f,r.scaleY=l,r.around=h);this._toolbar["on"+(8===q?this._rotateEvent:this._scaleEvent)](this._graphic,r)},_moveStopHandler:function(a){this._toolbar._activateScrollWheel();var b,c=this._graphic,d=this._toolbar,e=d._geo?r.geographicToWebMercator(c.geometry):c.geometry,f=e.spatialReference,g=c.getDojoShape(),l=g.getTransform(),h=c.getLayer()._getTransform();this._isTextPoint?(b=this._graphic.symbol,8===a.host._index?b.angle+=this._getAngle(this._startLine,
this._moveLine):b.font.setSize(Math.round(b.font.size*this._scaleRatio*100)/100),this._graphic.setSymbol(b)):(e=e.toJson(),this._updateSegments(e.paths||e.rings,l,h,f),g.setTransform(null),e=v.fromJson(e),c.setGeometry(d._geo?r.webMercatorToGeographic(e,!0):e));this._draw();this._startLine=this._moveLine=this._startBox=this._moveBox=this._xfactor=this._yfactor=null;d._endOperation("BOX");this._defaultEventArgs.transform=l;d["on"+(8===a.host._index?this._rotateEvent:this._scaleEvent)+"Stop"](this._graphic,
this._defaultEventArgs)},_updateSegments:function(b,c,d,e){var f=this._map,l=this._wrapOffset||0;a.forEach(b,function(b){a.forEach(b,function(a){this._updatePoint(a,e,l,g,f,d,c)},this)},this)},_updatePoint:function(a,b,c,d,e,f,g){b=e.toScreen({x:a[0],y:a[1],spatialReference:b},!0);b.x+=c;b=d.multiplyPoint([f,g,d.invert(f)],b);b.x-=c;c=e.toMap(b);a[0]=c.x;a[1]=c.y},_getAngle:function(a,b){return 180*Math.atan2(b[0].y-b[1].y,b[0].x-b[1].x)/Math.PI-180*Math.atan2(a[0].y-a[1].y,a[0].x-a[1].x)/Math.PI},
_deNormalizePoint:function(a,b){var c=this._map._getFrameWidth();if(-1===c)return a;for(var d={x:a.x,y:a.y};Math.abs(d.x-b.x)>=c;)d.x<b.x?d.x+=c:d.x-=c;var e=Math.abs(d.x-b.x);return Math.abs(d.x-b.x+c)<e?d.x+=c:Math.abs(d.x-b.x-c)<e&&(d.x-=c),d}});return e("extend-esri")&&k.setObject("toolbars._Box",h,d),h})},"dojox/gfx/Moveable":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/_base/event dojo/topic dojo/touch dojo/dom-class dojo/_base/window ./Mover dojo/mouse".split(" "),
function(h,k,a,f,b,e,l,m,g,d){return k("dojox.gfx.Moveable",null,{constructor:function(a,b){this.shape=a;this.delay=b&&0<b.delay?b.delay:0;this.mover=b&&b.mover?b.mover:g;this.leftButtonOnly=b&&b.leftButtonOnly;this.events=[this.shape.on(e.press,h.hitch(this,"onMouseDown"))]},destroy:function(){a.forEach(this.events,function(a){a.remove()});this.events=this.shape=null},onMouseDown:function(a){this.delay?(this.events.push(this.shape.on(e.move,h.hitch(this,"onMouseMove")),this.shape.on(e.release,h.hitch(this,
"onMouseUp"))),this._lastX=a.clientX,this._lastY=a.clientY):this.leftButtonOnly&&!d.isLeft(a)||new this.mover(this.shape,a,this);f.stop(a)},onMouseMove:function(a){var b=a.clientY;if(Math.abs(a.clientX-this._lastX)>this.delay||Math.abs(b-this._lastY)>this.delay)this.onMouseUp(a),new this.mover(this.shape,a,this);f.stop(a)},onMouseUp:function(a){this.events.pop().remove()},onMoveStart:function(a){b.publish("/gfx/move/start",a);l.add(m.body(),"dojoMove")},onMoveStop:function(a){b.publish("/gfx/move/stop",
a);l.remove(m.body(),"dojoMove")},onFirstMove:function(a){},onMove:function(a,b,d){this.onMoving(a,b,d);this.shape.applyLeftTransform(b);this.onMoved(a,b)},onMoving:function(a,b){},onMoved:function(a,b){}})})},"dojox/gfx/Mover":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/on dojo/touch dojo/_base/event".split(" "),function(h,k,a,f,b,e){return a("dojox.gfx.Mover",null,{constructor:function(a,m,g){this.shape=a;this.lastX=m.clientX;this.lastY=m.clientY;a=this.host=g;m=
document;g=f(m,b.move,h.hitch(this,"onFirstMove"));this.events=[f(m,b.move,h.hitch(this,"onMouseMove")),f(m,b.release,h.hitch(this,"destroy")),f(m,"dragstart",h.hitch(e,"stop")),f(m,"selectstart",h.hitch(e,"stop")),g];if(a&&a.onMoveStart)a.onMoveStart(this)},onMouseMove:function(a){var b=a.clientX,f=a.clientY;this.host.onMove(this,{dx:b-this.lastX,dy:f-this.lastY},a);this.lastX=b;this.lastY=f;e.stop(a)},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove()},destroy:function(){k.forEach(this.events,
function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.shape=null}})})},"esri/toolbars/_GraphicMover":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/json dojo/dom-style dojox/gfx/Moveable dojox/gfx/Mover dojox/gfx/matrix ../kernel ../PointerEvents ../sniff ../geometry/webMercatorUtils ../geometry/ScreenPoint ../geometry/Point".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t){var r=h(null,{declaredClass:"esri.toolbars._GraphicMover",
constructor:function(a,b,c,d){this.graphic=a;this.map=b;this.toolbar=c;this.tempPt=d;this._enableGraphicMover();this._moved=!1},refresh:function(a){var b=this.graphic.getDojoShape();!b||!a&&b._hostGraphic||(this._disableGraphicMover(),this._enableGraphicMover())},destroy:function(){this._disableGraphicMover()},hasMoved:function(){return this._moved},_enableGraphicMover:function(){var c=this.graphic,d=c.getDojoShape();d&&(d._hostGraphic=c,this._moveable=new e(d,{mover:r.Mover}),this._moveStartHandle=
a.connect(this._moveable,"onMoveStart",this,this._moveStartHandler),this._firstMoveHandle=a.connect(this._moveable,"onFirstMove",this,this._firstMoveHandler),this._movingHandle=a.connect(this._moveable,"onMoving",this,this._movingHandler),this._moveStopHandle=a.connect(this._moveable,"onMoveStop",this,this._moveStopHandler),(c=d.getEventSource())&&b.set(c,"cursor",this.toolbar._cursors.move))},_disableGraphicMover:function(){var c=this._moveable;if(c){a.disconnect(this._moveStartHandle);a.disconnect(this._firstMoveHandle);
a.disconnect(this._movingHandle);a.disconnect(this._moveStopHandle);var d=c.shape;d&&(d._hostGraphic=null,(d=d.getEventSource())&&b.set(d,"cursor",null));c.destroy()}this._moveable=null},_moveStartHandler:function(){var a=this.graphic,b=this.map;this._startTx=a.getDojoShape().getTransform();"point"===this.graphic.geometry.type&&b.snappingManager&&b.snappingManager._setUpSnapping();this.toolbar.onGraphicMoveStart(a)},_firstMoveHandler:function(){this.toolbar._beginOperation("MOVE");this.toolbar.onGraphicFirstMove(this.graphic)},
_movingHandler:function(a,b,e){var f;a=a.shape.getTransform();b=this.map;c("esri-pointer")?f=b.navigationManager.pointerEvents._processTouchEvent(e,e):e&&"pointermove"===e.type&&(f=d.prototype._processTouchEvent.call({map:b},e,e));f&&b.snappingManager&&b.snappingManager._onSnappingMouseMoveHandler(f);this.tempPt&&this.tempPt.getDojoShape().setTransform(a);this.toolbar.onGraphicMove(this.graphic,a)},_moveStopHandler:function(a){var b=this.graphic,c=this.toolbar,d=this.map,e=c._geo?n.geographicToWebMercator(b.geometry):
b.geometry,g=e.type,l=b.getDojoShape(),h=l.getTransform();if(f.toJson(h)!==f.toJson(this._startTx)){switch(this._moved=!0,g){case "point":var k,g=[h,m.invert(this._startTx)];d.snappingManager&&(k=d.snappingManager._snappingPoint);e=k||d.toMap(m.multiplyPoint(g,d.toScreen(e,!0)));d.snappingManager&&d.snappingManager._killOffSnapping();break;case "polyline":e=this._updatePolyGeometry(e,e.paths,h);break;case "polygon":e=this._updatePolyGeometry(e,e.rings,h)}l.setTransform(null);b.setGeometry(c._geo?
n.webMercatorToGeographic(e,!0):e);this.tempPt&&this.tempPt.setGeometry(new t(b.geometry.toJson()))}else this._moved=!1;(c._endOperation("MOVE"),c.onGraphicMoveStop(b,h),this._moved)||(a=a.__e,d=this.map.position,a=new q(a.pageX-d.x,a.pageY-d.y),c.onGraphicClick(b,{screenPoint:a,mapPoint:this.map.toMap(a)}))},_updatePolyGeometry:function(a,b,c){var d,e,f,g;e=this.map;d=a.getPoint(0,0);e=e.toMap(e.toScreen(d).offset(c.dx,c.dy));c=e.x-d.x;var l=e.y-d.y;for(d=0;d<b.length;d++)for(f=b[d],e=0;e<f.length;e++)g=
a.getPoint(d,e),a.setPoint(d,e,g.offset(c,l));return a}});return r.Mover=h(l,{declaredClass:"esri.toolbars._Mover",constructor:function(a,b,c){this.__e=b}}),c("extend-esri")&&(k.setObject("toolbars._GraphicMover",r,g),k.setObject("toolbars._Mover",r.Mover,g)),r})},"esri/toolbars/_VertexEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/has dijit/Menu dijit/MenuItem ../kernel ./_VertexMover ../geometry/Point ../geometry/jsonUtils dojo/i18n!../nls/jsapi".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n){var q=h(null,{declaredClass:"esri.toolbars._GraphicVertexEditor",constructor:function(a,b,c){this.graphic=a;this.map=b;this.toolbar=c;a=c._options;this._symbol1=a.vertexSymbol;this._symbol2=a.ghostVertexSymbol;b=a.ghostLineSymbol;this._lineStroke={style:b.style,width:b.width,color:b.color};this._canDel=a.allowDeleteVertices;this._canAdd=a.allowAddVertices;this._addControllers()},destroy:function(){this._removeControllers()},refresh:function(a){a?(this._removeControllers(),
this._addControllers()):(this._refresh(this._vertexMovers),this._refresh(this._mpVertexMovers))},suspend:function(){this._suspended||this._removeControllers();this._suspended=!0},resume:function(){this._suspended&&this._addControllers();this._suspended=!1},_addControllers:function(){this._firstMoveHandle=a.connect(g,"onFirstMove",this,this._firstMoveHandler);this._moveStopHandle=a.connect(g,"onMoveStop",this,this._moveStopHandler);this._vertexMovers=this._add(this._getSegments(this.graphic.geometry),
this._symbol1);this._canAdd&&(this._mpVertexMovers=this._add(this._getMidpointSegments(this.graphic.geometry),this._symbol2,!0));var b=this._getGraphicsLayer();if(this._mouseOverHandle=a.connect(b,"onMouseOver",this,this._mouseOverHandler),this._mouseOutHandle=a.connect(b,"onMouseOut",this,this._mouseOutHandler),this._canDel)this._ctxMenu=new e({style:"font-size: 12px; margin-left: 5px; margin-top: 5px;"}),b=this._ctxDelete=new l({label:n.toolbars.edit.deleteLabel,iconClass:"vertexDeleteIcon",style:"outline: none;"}),
this._deleteHandle=a.connect(b,"onClick",this,this._deleteHandler),this._ctxMenu.addChild(b),this._ctxMenu.startup()},_removeControllers:function(){a.disconnect(this._firstMoveHandle);a.disconnect(this._moveStopHandle);a.disconnect(this._mouseOverHandle);a.disconnect(this._mouseOutHandle);a.disconnect(this._deleteHandle);this._ctxMenu&&(this._ctxDelete=null,this._unbindCtxNode(),this._ctxMenu.destroyRecursive());this._remove(this._vertexMovers);this._remove(this._mpVertexMovers);this._vertexMovers=
this._mpVertexMovers=null},_add:function(a,b,c){var d,e,f=this.graphic,l=[];for(d=0;d<a.length;d++){var h=a[d],m=[];for(e=0;e<h.length;e++)m.push(new g(h[e],b,f,d,e,h.length,this,c));l.push(m)}return l},_remove:function(a){a&&f.forEach(a,function(a){f.forEach(a,function(a){a.destroy()})})},_refresh:function(a){a&&f.forEach(a,function(a){f.forEach(a,function(a){a.refresh()})})},_isNew:function(a){return-1===f.indexOf(this._vertexMovers[a.segIndex],a)?!0:!1},_getGraphicsLayer:function(){return this.toolbar._scratchGL},
_deleteHandler:function(a){a=this._selectedMover;a.ptIndex;this._updateRelatedGraphic(a,a.relatedGraphic,a.graphic.geometry,a.segIndex,a.ptIndex,a.segLength,!1,!0);this._canAdd&&this._deleteMidpoints(a);this._deleteVertex(a);this.toolbar._endOperation("VERTICES")},_mouseOverHandler:function(a){a=a.graphic;var b=this._findMover(a);b&&(this.toolbar.onVertexMouseOver(this.graphic,b._getInfo()),b._placeholder||(this._selectedMover=b,this._canDel&&this._bindCtxNode(a.getDojoShape().getNode())))},_mouseOutHandler:function(a){(a=
this._findMover(a.graphic))&&this.toolbar.onVertexMouseOut(this.graphic,a._getInfo())},_bindCtxNode:function(a){this._unbindCtxNode();this._ctxDelete.set("disabled",this._selectedMover.segLength<=this.minLength?!0:!1);this._ctxMenu.bindDomNode(a);this._bindNode=a},_unbindCtxNode:function(){var a=this._bindNode;a&&this._ctxMenu.unBindDomNode(a)},_findMover:function(a){var b,c=[];b=this._mpVertexMovers;f.forEach(this._vertexMovers,function(a){c=c.concat(a)});b&&f.forEach(b,function(a){c=c.concat(a)});
for(b=0;b<c.length;b++){var d=c[b];if(d.graphic===a)return d}},_firstMoveHandler:function(a){!this._isNew(a)&&this._canAdd&&this._hideRelatedMidpoints(a);this.toolbar._beginOperation("VERTICES")},_moveStopHandler:function(a,b){var c=this._isNew(a);return b&&(b.dx||b.dy)?(this._updateRelatedGraphic(a,a.relatedGraphic,a.graphic.geometry,a.segIndex,a.ptIndex,a.segLength,c),this._canAdd&&(c?this._addMidpoints(a):(this._repositionRelatedMidpoints(a),this._showRelatedMidpoints(a))),void this.toolbar._endOperation("VERTICES")):
void(!c&&this._canAdd&&this._showRelatedMidpoints(a))},_showRelatedMidpoints:function(a){var b=this._getAdjacentMidpoints(a.ptIndex,a.segLength),c=this._mpVertexMovers[a.segIndex];for(a=0;a<b.length;a++){var d=c[b[a]];d.graphic.show();d.refresh()}},_hideRelatedMidpoints:function(a){var b=this._getAdjacentMidpoints(a.ptIndex,a.segLength),c=this._mpVertexMovers[a.segIndex];for(a=0;a<b.length;a++)c[b[a]].graphic.hide()},_repositionRelatedMidpoints:function(a){var b,c=this._getAdjacentMidpoints(a.ptIndex,
a.segLength),e=this._mpVertexMovers[a.segIndex];for(b=0;b<c.length;b++){var f=this._getAdjacentVertices(c[b],a.segLength),g=a.relatedGraphic.geometry.getPoint(a.segIndex,f[0]),f=a.relatedGraphic.geometry.getPoint(a.segIndex,f[1]),g=new d({x:(g.x+f.x)/2,y:(g.y+f.y)/2,spatialReference:g.spatialReference.toJson()});e[c[b]].graphic.setGeometry(g)}},_addMidpoints:function(a){var b,c=a.segIndex,e=a.ptIndex,f=a.segLength,l=e+1,h=f+1;this._mpVertexMovers[c].splice(e,1);var m=this._vertexMovers[c];for(b=0;l>
b;b++)m[b].segLength+=1;for(b=l;b<m.length;b++)m[b].ptIndex+=1,m[b].segLength+=1;a.ptIndex=l;a.segLength=m.length+1;m.splice(l,0,a);a.graphic.setSymbol(this._symbol1);m=this._mpVertexMovers[c];for(b=0;e>b;b++)m[b].segLength+=1;for(b=e;f-1>b;b++)m[b].ptIndex+=1,m[b].segLength+=1;f=this._getAdjacentVertices(e,h);c=this._getAdjacentVertices(e+1,h);b=a.relatedGraphic.geometry.getPoint(a.segIndex,f[0]);l=a.relatedGraphic.geometry.getPoint(a.segIndex,f[1]);f=new d({x:(b.x+l.x)/2,y:(b.y+l.y)/2,spatialReference:b.spatialReference.toJson()});
b=a.relatedGraphic.geometry.getPoint(a.segIndex,c[0]);l=a.relatedGraphic.geometry.getPoint(a.segIndex,c[1]);b=new d({x:(b.x+l.x)/2,y:(b.y+l.y)/2,spatialReference:b.spatialReference.toJson()});c=new g(f,this._symbol2,this.graphic,a.segIndex,e,h,this,!0);a=new g(b,this._symbol2,this.graphic,a.segIndex,e+1,h,this,!0);m.splice(e,0,c,a)},_deleteVertex:function(a){var b,c=a.ptIndex,d=this._vertexMovers[a.segIndex];for(b=0;c>b;b++)--d[b].segLength;for(b=c+1;b<d.length;b++){var e=d[b];--e.ptIndex;--e.segLength}d.splice(c,
1);b=a._getInfo();a.destroy();this.toolbar.onVertexDelete(this.graphic,b)}});return k.mixin(q,{create:function(a,b,c){switch(a.geometry.type){case "multipoint":return new q.MultipointVertexEditor(a,b,c);case "polyline":return new q.PolylineVertexEditor(a,b,c);case "polygon":return new q.PolygonVertexEditor(a,b,c)}}}),q.MultipointVertexEditor=h(q,{declaredClass:"esri.toolbars._MultipointVertexEditor",minLength:1,constructor:function(){this._moveStartHandle=a.connect(g,"onMoveStart",this,this._moveStartHandler);
a.disconnect(this._firstMoveHandle)},destroy:function(){this.inherited(arguments);a.disconnect(this._moveStartHandle)},_getSegments:function(a){var b=a.points,c=[],e=a.spatialReference;for(a=0;a<b.length;a++){var f=b[a];c.push(new d({x:f[0],y:f[1],spatialReference:e.toJson()}))}return[c]},_getMidpointSegments:function(a){return[]},_getControlPoints:function(a,b,c,d,e){return[]},_getGraphicsLayer:function(){return this.graphic._graphicsLayer},_mouseOverHandler:function(a){var b=a.graphic;(a=this._findMover(a))&&
(this.toolbar.onVertexMouseOver(b,a._getInfo()),this._selectedMover=a,this._canDel&&this._bindCtxNode(a.graphic.getDojoShape().getNode()))},_mouseOutHandler:function(a){var b=a.graphic;(a=this._findMover(a))&&this.toolbar.onVertexMouseOut(b,a._getInfo())},_findMover:function(a){var b=[].concat(this._vertexMovers[0]),c=a.target;for(a=0;a<b.length;a++){var d=b[a];if(d.graphic.getDojoShape().getNode()===c)return d}},_moveStartHandler:function(a){var b=a.ptIndex,c=a.segLength-1,d=a.relatedGraphic.geometry.points;
a=d.splice(b,1);d.push(a[0]);d=this._vertexMovers[0];for(a=c;a>b;a--)--d[a].ptIndex;a=d.splice(b,1);d.push(a[0]);a[0].ptIndex=c},_moveStopHandler:function(a){this._updateRelatedGraphic(a,a.relatedGraphic,a.graphic.geometry,a.segIndex,a.ptIndex,a.segLength);this.toolbar._endOperation("VERTICES")},_updateRelatedGraphic:function(a,b,c,d,e,f,g,l){a=b.geometry;l?a.removePoint(e):a.setPoint(e,c);b.setGeometry(a)},_deleteMidpoints:function(a){}}),q.PolylineVertexEditor=h(q,{declaredClass:"esri.toolbars._PolylineVertexEditor",
minLength:2,_getSegments:function(a){var b,c,d=a.paths,e=[];for(b=0;b<d.length;b++){var f=d[b],g=[];for(c=0;c<f.length;c++)g.push(a.getPoint(b,c));e.push(g)}return e},_getMidpointSegments:function(a){var b,c,e=a.paths,f=[],g=a.spatialReference;for(b=0;b<e.length;b++){var l=e[b],h=[];for(c=0;c<l.length-1;c++){var m=a.getPoint(b,c),n=a.getPoint(b,c+1),m=new d({x:(m.x+n.x)/2,y:(m.y+n.y)/2,spatialReference:g.toJson()});h.push(m)}f.push(h)}return f},_getControlPoints:function(a,b,c,d,e){var f,g,l,h,m=
this.map;return this._isNew(a)?(f=d,g=d+1,0<=f&&(l=m.toScreen(b.getPoint(c,f))),e>=g&&(h=m.toScreen(b.getPoint(c,g)))):(f=d-1,g=d+1,0<=f&&(l=m.toScreen(b.getPoint(c,f))),e>g&&(h=m.toScreen(b.getPoint(c,g)))),[l,h]},_getAdjacentMidpoints:function(a,b){var c=[],d=a-1;0<=d&&c.push(d);return b-1>a&&c.push(a),c},_getAdjacentVertices:function(a,b){return[a,a+1]},_deleteMidpoints:function(a){var b,c=this._mpVertexMovers[a.segIndex],e=c.length-1,f=this._getAdjacentMidpoints(a.ptIndex,a.segLength).sort(),
l=f[0];for(b=0;l>b;b++)--c[b].segLength;for(b=l+1;b<c.length;b++){var h=c[b];--h.ptIndex;--h.segLength}if(1===f.length)c.splice(l,1)[0].destroy();else for(h=this._getAdjacentVertices(l,e),b=a.relatedGraphic.geometry.getPoint(a.segIndex,h[0]),h=a.relatedGraphic.geometry.getPoint(a.segIndex,h[1]),b=new d({x:(b.x+h.x)/2,y:(b.y+h.y)/2,spatialReference:b.spatialReference.toJson()}),a=new g(b,this._symbol2,this.graphic,a.segIndex,l,e,this,!0),c=c.splice(l,f.length,a),b=0;b<c.length;b++)c[b].destroy()},
_updateRelatedGraphic:function(a,b,d,e,f,g,l,h){a=b.geometry;l?a.insertPoint(e,f+1,c.fromJson(d.toJson())):h?a.removePoint(e,f):a.setPoint(e,f,c.fromJson(d.toJson()));b.setGeometry(a)}}),q.PolygonVertexEditor=h(q,{declaredClass:"esri.toolbars._PolygonVertexEditor",minLength:3,_getSegments:function(a){var b,c,d=a.rings,e=[];for(b=0;b<d.length;b++){var f=d[b],g=[];for(c=0;c<f.length-1;c++)g.push(a.getPoint(b,c));e.push(g)}return e},_getMidpointSegments:function(a){var b,c,e=a.rings,f=[],g=a.spatialReference;
for(b=0;b<e.length;b++){var l=e[b],h=[];for(c=0;c<l.length-1;c++){var m=a.getPoint(b,c),n=a.getPoint(b,c+1),m=new d({x:(m.x+n.x)/2,y:(m.y+n.y)/2,spatialReference:g.toJson()});h.push(m)}f.push(h)}return f},_getControlPoints:function(a,b,c,d,e){var f,g,l,h,m=this.map;return this._isNew(a)?(f=d,g=(d+1)%e):(f=d-1,f=0>f?(e+f)%e:f,g=(d+1)%e),l=m.toScreen(b.getPoint(c,f)),h=m.toScreen(b.getPoint(c,g)),[l,h]},_getAdjacentMidpoints:function(a,b){var c=a-1;return[0>c?(b+c)%b:c,a]},_getAdjacentVertices:function(a,
b){return[a,(a+1)%b]},_deleteMidpoints:function(a){var b,c,e,f;c=a.ptIndex;var l=this._mpVertexMovers[a.segIndex],h=l.length-1;e=this._getAdjacentMidpoints(c,a.segLength).sort();f=e[0];var m=e[e.length-1];if(0===c)for(b=this._getAdjacentVertices(h-1,h),c=a.relatedGraphic.geometry.getPoint(a.segIndex,b[0]),b=a.relatedGraphic.geometry.getPoint(a.segIndex,b[1]),c=new d({x:(c.x+b.x)/2,y:(c.y+b.y)/2,spatialReference:c.spatialReference.toJson()}),a=new g(c,this._symbol2,this.graphic,a.segIndex,h-1,h,this,
!0),l.splice(m,1,a)[0].destroy(),l.splice(f,1)[0].destroy(),e=0;e<l.length-1;e++)f=l[e],--f.ptIndex,--f.segLength;else{b=this._getAdjacentVertices(f,h);c=a.relatedGraphic.geometry.getPoint(a.segIndex,b[0]);b=a.relatedGraphic.geometry.getPoint(a.segIndex,b[1]);c=new d({x:(c.x+b.x)/2,y:(c.y+b.y)/2,spatialReference:c.spatialReference.toJson()});a=new g(c,this._symbol2,this.graphic,a.segIndex,f,h,this,!0);m=l.splice(f,e.length,a);for(e=0;e<m.length;e++)m[e].destroy();for(e=0;f>e;e++)--l[e].segLength;
for(e=f+1;e<l.length;e++)f=l[e],--f.ptIndex,--f.segLength}},_updateRelatedGraphic:function(a,b,d,e,f,g,l,h){a=b.geometry;l?a.insertPoint(e,f+1,c.fromJson(d.toJson())):h?(a.removePoint(e,f),0===f&&a.setPoint(e,g-1,c.fromJson(a.getPoint(e,0).toJson()))):(a.setPoint(e,f,c.fromJson(d.toJson())),0===f&&a.setPoint(e,g,c.fromJson(d.toJson())));b.setGeometry(a)}}),b("extend-esri")&&(k.setObject("toolbars._GraphicVertexEditor",q,m),k.setObject("toolbars._MultipointVertexEditor",q.MultipointVertexEditor,m),
k.setObject("toolbars._PolylineVertexEditor",q.PolylineVertexEditor,m),k.setObject("toolbars._PolygonVertexEditor",q.PolygonVertexEditor,m)),q})},"esri/toolbars/_VertexMover":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/sniff dojo/dom-style dojox/gfx/Moveable ../kernel ../PointerEvents ../sniff ../geometry/Point ../graphic ../geometry/webMercatorUtils".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n){h=h(null,{declaredClass:"esri.toolbars.VertexMover",constructor:function(a,
b,c,d,e,f,g,l){this.point=a;this.symbol=b;this.relatedGraphic=c;this.segIndex=d;this.ptIndex=e;this.segLength=f;this.editor=g;this.map=g.map;this._scratchGL=g.toolbar._scratchGL;this._placeholder=l||!1;this._type=c.geometry.type;this._init();this._enable()},refresh:function(a){(a||this._needRefresh())&&(this._disable(),this._enable())},destroy:function(){this._disable();this.graphic&&this._scratchGL.remove(this.graphic);this.point=this.symbol=this.graphic=this.relatedGraphic=this.segIndex=this.ptIndex=
this.segLength=this.editor=this.map=this._scratchGL=null},_init:function(){var a=new d(this.point.toJson()),a=new c(a,this.symbol);switch(this._type){case "multipoint":a._shape=this.relatedGraphic.getDojoShape().children[this.ptIndex];break;case "polyline":case "polygon":this._scratchGL.add(a)}this.graphic=a},_enable:function(){var a=this.graphic.getDojoShape();a&&(a._hasMover=!0,this._moveable=this._getMoveable(a),(a=a.getEventSource())&&b.set(a,"cursor",this.editor.toolbar._cursors[this._placeholder?
"move-gv":"move-v"]))},_disable:function(){var c=this._moveable;if(c){a.disconnect(this._startHandle);a.disconnect(this._firstHandle);a.disconnect(this._movingHandle);a.disconnect(this._stopHandle);var d=c.shape;d&&(d=d.getEventSource())&&b.set(d,"cursor",null);c.destroy();this._moveable=null}},_needRefresh:function(){var a=this.graphic.getDojoShape(),b=!1;if(a)switch(this._type){case "multipoint":var c=this.relatedGraphic.getDojoShape();c&&(c=c.children[this.ptIndex],a!==c&&(a=c,this.graphic._shape=
a,b=!0));break;case "polyline":case "polygon":b=!a._hasMover}return b},_getMoveable:function(b){b=new e(b,f("mac")&&f("ff")&&!g("esri-touch")&&{leftButtonOnly:!0});return this._startHandle=a.connect(b,"onMoveStart",this,this._moveStartHandler),this._firstHandle=a.connect(b,"onFirstMove",this,this._firstMoveHandler),this._movingHandle=a.connect(b,"onMoving",this,this._movingHandler),this._stopHandle=a.connect(b,"onMoveStop",this,this._moveStopHandler),b},_getPtIndex:function(){return this.ptIndex+
(this._placeholder?1:0)},_getInfo:function(){return{graphic:this.graphic,isGhost:this._placeholder,segmentIndex:this.segIndex,pointIndex:this._getPtIndex()}},_moveStartHandler:function(a){var b=this.map;b.snappingManager&&b.snappingManager._setUpSnapping();this.editor.toolbar._deactivateScrollWheel();a.shape.moveToFront();this.constructor.onMoveStart(this);this.editor.toolbar.onVertexMoveStart(this.relatedGraphic,this._getInfo())},_firstMoveHandler:function(a){var b,c=a.shape,d=this._getControlEdges(),
e=this._scratchGL._div,f=[],g=a.host.shape._wrapOffsets[0]||0;for(b=0;b<d.length;b++){var l=d[b];l.x1+=g;l.x2+=g;f.push([e.createLine({x1:l.x1,y1:l.y1,x2:l.x2,y2:l.y2}).setStroke(this.editor._lineStroke),l.x1,l.y1,l.x2,l.y2])}c._lines=f;a.shape.moveToFront();this.constructor.onFirstMove(this);this.editor.toolbar.onVertexFirstMove(this.relatedGraphic,this._getInfo())},_movingHandler:function(a,b,c){var d;b=this.map;g("esri-pointer")?d=b.navigationManager.pointerEvents._processTouchEvent(c,c):c&&"pointermove"===
c.type&&(d=m.prototype._processTouchEvent.call({map:b},c,c));d&&b.snappingManager&&b.snappingManager._onSnappingMouseMoveHandler(d);c=a.shape;a=c.getTransform();d=c._lines;for(c=0;c<d.length;c++)b=d[c],b[0].setShape({x1:b[1]+a.dx,y1:b[2]+a.dy,x2:b[3],y2:b[4]});this.editor.toolbar.onVertexMove(this.relatedGraphic,this._getInfo(),a)},_moveStopHandler:function(a){a=a.shape;var b=this.editor.toolbar,c=a.getTransform(),d=this.map,e=this.graphic,f=b._geo?n.geographicToWebMercator(e.geometry):e.geometry;
b._activateScrollWheel();var g,l=a._lines;if(l){for(g=0;g<l.length;g++)l[g][0].removeShape();a._lines=null}g=!1;var l=!0,h=this._getInfo();c&&(c.dx||c.dy)?this._placeholder&&(this._placeholder=!1,g=!0):l=!1;var m;d.snappingManager&&(m=d.snappingManager._snappingPoint);m=m||d.toMap(d.toScreen(f).offset(c.dx,c.dy));d.snappingManager&&d.snappingManager._killOffSnapping();a.setTransform(null);e.setGeometry(b._geo?n.webMercatorToGeographic(m,!0):m);this.constructor.onMoveStop(this,c);b.onVertexMoveStop(this.relatedGraphic,
h,c);l||b.onVertexClick(this.relatedGraphic,h);g&&b.onVertexAdd(this.relatedGraphic,this._getInfo())},_getControlEdges:function(){var a=this.map,b=this.relatedGraphic.geometry,c=this.segIndex,d=this.ptIndex,e=this.segLength,f=this._scratchGL._getTransform(),g=f.dx,f=f.dy,l=a.toScreen(this.graphic.geometry),a=l.x-g,l=l.y-f,h=[],b=this.editor._getControlPoints(this,b,c,d,e);return b[0]&&h.push({x1:a,y1:l,x2:b[0].x-g,y2:b[0].y-f}),b[1]&&h.push({x1:a,y1:l,x2:b[1].x-g,y2:b[1].y-f}),h}});return g("extend-esri")&&
k.setObject("toolbars.VertexMover",h,l),k.mixin(h,{onMoveStart:function(){},onFirstMove:function(){},onMoveStop:function(){}}),h})},"esri/toolbars/TextEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/event dojo/has dojo/dom-construct dojo/dom-class dojo/dom-style dojo/keys ../kernel".split(" "),function(h,k,a,f,b,e,l,m,g,d){h=h(null,{declaredClass:"esri.toolbars.TextEditor",constructor:function(a,b,d){this._graphic=a;this._map=b;this._toolbar=d;this._enable(this._graphic)},
destroy:function(){this._disable()},onEditStart:function(){},onEditEnd:function(){},_enable:function(b){return this._editBox?(a.disconnect(this._addEditBoxHandler),void(this._addEditBoxHandler=null)):(this._map.navigationManager.setImmediateClick(!0),void(this._addEditBoxHandler=a.connect(b.getLayer(),"onDblClick",this,function(c){this._map.navigationManager.setImmediateClick(!1);c.graphic==b&&(f.stop(c),a.disconnect(this._addEditBoxHandler),this._addEditBoxHandler=null,this._addTextBox(b))})))},
_disable:function(){this._applyEdit();this._addEditBoxHandler&&(a.disconnect(this._addEditBoxHandler),this._addEditBoxHandler=null);this._removeTextBox();this.onEditEnd(this._graphic);this._toolbar.onTextEditEnd(this._graphic)},_addTextBox:function(b,d){if(!this._editBox){var c;b.symbol.text||(b.symbol.text="Tempt text",b.setSymbol(b.symbol),c="");var f=this._createInputTextStyle(b,this._map);""!==c&&(c=d||b.symbol.text);this._editBox=e.create("input",{type:"text",value:c});m.set(this._editBox,f);
l.add(this._editBox,"esriTextEditorInput");this._map.container.appendChild(this._editBox);this._editBox.focus();this._editBoxKeyHandler=a.connect(this._editBox,"onkeyup",k.hitch(this,function(a){a.keyCode!=g.ENTER&&a.keyCode!==g.TAB||this._disable()}));this._editBoxBlurHandler=a.connect(this._editBox,"onblur",k.hitch(this,function(a){this._disable()}));b.symbol.text="";b.setSymbol(b.symbol);b.hide();var h=this._editBox;this._disableBoxHandler||(this._disableBoxHandler=this._map.on("zoom-start",k.hitch(this,
function(){this._disable()})));this._moveBoxHandler=this._map.on("pan",function(a){m.set(h,{left:this._editBoxLeft+a.delta.x+"px",top:this._editBoxTop+a.delta.y+"px"})});this._moveBoxStartHandler=this._map.on("pan-start",function(){this._editBoxLeft=parseFloat(m.get(h,"left"));this._editBoxTop=parseFloat(m.get(h,"top"))});this.onEditStart(b,this._editBox);this._toolbar.onTextEditStart(b,this._editBox)}},_removeTextBox:function(){this._editBoxBlurHandler&&(a.disconnect(this._editBoxBlurHandler),this._editBoxBlurHandler=
null);this._editBox&&(this._editBox.parentNode.removeChild(this._editBox),this._editBox=null);this._disableBoxHandler&&(this._disableBoxHandler.remove(),this._disableBoxHandler=null);this._moveBoxHandler&&(this._moveBoxHandler.remove(),this._moveBoxHandler=null);this._moveBoxStartHandler&&(this._moveBoxStartHandler.remove(),this._moveBoxStartHandler=null);this._editBoxKeyHandler&&(a.disconnect(this._editBoxKeyHandler),this._editBoxKeyHandler=null)},_createInputTextStyle:function(a,b){var c=a.getDojoShape().getTransformedBoundingBox(),
d=a.symbol.font;return{"font-family":d.family,"font-size":d.size+"px","font-style":d.style,"font-variant":d.variant,"font-weight":d.weight,left:c[0].x+"px",top:c[0].y+"px",width:Math.abs(c[0].x-c[1].x)/Math.cos(a.symbol.angle/180*Math.PI)+"px"}},_applyEdit:function(){if(this._editBox)if(this._editBox.value){this._graphic.show();var a=this._graphic.symbol;a.text=this._editBox.value;this._graphic.setSymbol(a)}else this._graphic.getLayer().remove(this._graphic)}});return b("extend-esri")&&k.setObject("toolbars.TextEditor",
h,d),h})},"esri/dijit/AttributeInspector":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/sniff dojo/_base/kernel dojo/has dojo/dom-style dojo/dom-construct ../kernel ../lang ../domUtils ../layers/InheritedDomain ../layers/FeatureLayer dojo/i18n!../nls/jsapi dojo/fx dojox/gfx dijit/_Widget dijit/_Templated dijit/Editor dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/TextColor ./_EventedWidget ./editing/AttachmentEditor ./editing/Util ../tasks/query dijit/form/DateTextBox dijit/form/TextBox dijit/form/NumberTextBox dijit/form/FilteringSelect dijit/form/NumberSpinner dijit/form/Button dijit/form/SimpleTextarea dijit/form/ValidationTextBox dijit/form/TimeTextBox dijit/Tooltip dojo/data/ItemFileReadStore dojox/date/islamic dojox/date/islamic/Date dojox/date/islamic/locale dojo/text!./templates/AttributeInspector.html".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J,L,M,H,K,P,O,S,Q,R,aa,X){var T=h([B,w,x],{declaredClass:"esri.dijit.AttributeInspector",widgetsInTemplate:!0,templateString:X,onUpdate:function(){},onDelete:function(){},onAttributeChange:function(){},onNext:function(){},onReset:function(){},onCancel:function(){},_navMessage:"( ${idx} ${of} ${numFeatures} )",_currentAttributeFieldName:null,_aiConnects:[],_selection:[],_toolTips:[],_numFeatures:0,_featureIdx:0,_currentLInfo:null,_currentFeature:null,
_rollbackInfo:null,_eventMap:{update:!0,"delete":["feature"],"attribute-change":["feature","fieldName","fieldValue"],next:["feature"],reset:!0,cancel:!0},_defaultRichTextPlugins:"bold italic underline foreColor hiliteColor | justifyLeft justifyCenter justifyRight justifyFull | insertOrderedList insertUnorderedList indent outdent | createLink".split(" "),css:{label:"atiLabel",field:"atiField",textArea:"atiTextAreaField",richText:"atiRichTextField",attachmentEditor:"atiAttachmentEditor",red:"atiRequiredField"},
constructor:function(b,c){k.mixin(this,r.widgets.attributeInspector);b=b||{};b.featureLayer||b.layerInfos||console.error("esri.AttributeInspector: please provide correct parameter in the constructor");this._datePackage=this._getDatePackage(b);this._layerInfos=b.layerInfos||[{featureLayer:b.featureLayer,options:b.options||[]}];this._layerInfos=a.filter(this._layerInfos,function(a){return!a.disableAttributeUpdate});this._hideNavButtons=b.hideNavButtons||!1},postCreate:function(){if(a.every(this._layerInfos,
function(a){return a.featureLayer.loaded}))this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature();else{var b=this._layerInfos.length;a.forEach(this._layerInfos,function(a){a=a.featureLayer;if(a.loaded)b--;else var c=f.connect(a,"onLoad",this,function(a){f.disconnect(c);c=null;b--;b||(this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature())})},this)}},destroy:function(){this._destroyAttributeTable();a.forEach(this._aiConnects,f.disconnect);delete this._aiConnects;
this._attachmentEditor&&(this._attachmentEditor.destroy(),delete this._attachmentEditor);delete this._layerInfos;this._selection=this._currentFeature=this._currentLInfo=this._attributes=this._layerInfos=null;this.inherited(arguments)},refresh:function(){this._updateSelection()},first:function(){this.onFirstFeature()},last:function(){this.onLastFeature()},next:function(){this.onNextFeature()},previous:function(){this.onPreviousFeature()},showFeature:function(a,b){b&&(this._createOnlyFirstTime=!0);
this._updateSelection([a],b);this._updateUI()},onLayerSelectionChange:function(a,b,c){this._createOnlyFirstTime=!1;this._featureIdx=c===t.SELECTION_NEW?0:this._featureIdx;this._updateSelection();this._updateUI()},onLayerSelectionClear:function(){!this._selection||0>=this._selection.length||(this._numFeatures=0,this._featureIdx=0,this._selection=[],this._currentFeature=null,this._currentLInfo=null,this._updateUI())},onLayerUpdateEnd:function(a,b,c,d){},onLayerError:function(a,b,c,d){},onLayerEditsError:function(a,
b,c,d){},onLayerEditsComplete:function(b,c,d,e){if(e=e||[],e.length){var f=this._selection,g=b.featureLayer.objectIdField;a.forEach(e,k.hitch(this,function(b){a.some(f,k.hitch(this,function(a,c){return a.attributes[g]!==b.objectId?!1:(this._selection.splice(c,1),!0)}))}))}c=c||[];c.length&&(this._selection=D.findFeatures(c,b.featureLayer),this._featureIdx=0);e=this._numFeatures=this._selection?this._selection.length:0;if(c.length){if(c=e?this._selection[this._featureIdx]:null)e=c.getLayer().getEditCapabilities(),
e.canCreate&&!e.canUpdate||this._showFeature(c);this._updateUI()}if(d=d||[],d.length){var l=this._rollbackInfo;a.forEach(d,function(c){var e=D.findFeatures(d,b.featureLayer)[0];if(!c.success&&e.attributes[b.featureLayer.objectIdField]===c.objectId&&l){var f=l.field;c=l.graphic.attributes[f.name];var g=a.filter(this._currentLInfo.fieldInfos,function(a){return a.fieldName===f.name},this)[0].dijit;e.attributes[f.name]=c;"esriFieldTypeDate"===f.type&&(c=new Date(c));this._setValue(g,c)}},this)}this._rollbackInfo=
null},onFieldValueChange:function(b,c){var d,e=b.field,f=b.dijit,g=this._currentFeature,l=this._currentLInfo,h=e.name;if(""!==f.displayedValue&&"dijit.form.ValidationTextBox"===f.declaredClass&&!f.isValid()||""!==f.displayedValue&&f.displayedValue!==c&&f.isValid&&!f.isValid())return void this._setValue(f,g.attributes[e.name]);if(d=!("esriFieldTypeInteger"!==e.type&&"esriFieldTypeSmallInteger"!==e.type&&"esriFieldTypeSingle"!==e.type&&"esriFieldTypeDouble"!==e.type),c=""===c&&d||"undefined"==typeof c?
null:c,d&&null!==c&&(c=Number(c)),"esriFieldTypeDate"===e.type)f instanceof Array?(d=f[0].getValue(),f=f[1].getValue(),c=d&&f?new Date(d.getFullYear(),d.getMonth(),d.getDate(),f.getHours(),f.getMinutes(),f.getSeconds(),f.getMilliseconds()):d||f||null):c=f.getValue(),c=c&&c.getTime?c.getTime():c&&c.toGregorian?c.toGregorian().getTime():c;if(this._currentFeature.attributes[e.name]!==c){if(h===l.typeIdField){var m=this._findFirst(l.types,"id",c);a.forEach(l.fieldInfos,function(a){if(e=a.field,e&&e.name!==
l.typeIdField)a=a.dijit,this._setFieldDomain(a,m,e)&&a&&(this._setValue(a,g.attributes[e.name]+""),!1===a.isValid()&&this._setValue(a,null))},this)}this.onAttributeChange(g,h,c)}},onDeleteBtn:function(a){this._deleteFeature()},onNextFeature:function(a){this._onNextFeature(1)},onPreviousFeature:function(a){this._onNextFeature(-1)},onFirstFeature:function(a){this._onNextFeature(-1*this._featureIdx)},onLastFeature:function(a){this._onNextFeature(this._numFeatures-1-this._featureIdx)},_initLayerInfos:function(){var b=
this._layerInfos;this._editorTrackingInfos={};a.forEach(b,this._initLayerInfo,this)},_initLayerInfo:function(b){var d,e,f=b.featureLayer;this._userIds={};e=f.id;f.credential&&(this._userIds[e]=f.credential.userId);b.userId&&(this._userIds[e]=b.userId);this._connect(f,"onSelectionComplete",k.hitch(this,"onLayerSelectionChange",b));this._connect(f,"onSelectionClear",k.hitch(this,"onLayerSelectionClear",b));this._connect(f,"onEditsComplete",k.hitch(this,"onLayerEditsComplete",b));this._connect(f,"error",
k.hitch(this,"onLayerError",b));this._connect(f,"onUpdateEnd",k.hitch(this,"onLayerUpdateEnd",b));b.showAttachments=f.hasAttachments?c.isDefined(b.showAttachments)?b.showAttachments:!0:!1;b.hideFields=b.hideFields||[];b.htmlFields=b.htmlFields||[];b.isEditable=f.isEditable()?c.isDefined(b.isEditable)?b.isEditable:!0:!1;b.typeIdField=f.typeIdField;b.layerId=f.id;b.types=f.types;f.globalIdField&&(d=this._findFirst(b.fieldInfos,"fieldName",f.globalIdField),d||b.showGlobalID||b.hideFields.push(f.globalIdField));
(e=this._findFirst(b.fieldInfos,"fieldName",f.objectIdField))||b.showObjectID||b.hideFields.push(f.objectIdField);var g=this._getFields(b.featureLayer);if(g){var l=b.fieldInfos||[],l=a.map(l,function(a){return k.mixin({},a)});l.length?b.fieldInfos=a.filter(a.map(l,k.hitch(this,function(a){var c=a.stringFieldOption||(this._isInFields(a.fieldName,b.htmlFields)?T.STRING_FIELD_OPTION_RICHTEXT:T.STRING_FIELD_OPTION_TEXTBOX);return k.mixin(a,{field:this._findFirst(g,"name",a.fieldName),stringFieldOption:c})})),
"return item.field;"):(g=a.filter(g,k.hitch(this,function(a){return!this._isInFields(a.name,b.hideFields)})),b.fieldInfos=a.map(g,k.hitch(this,function(a){var c=this._isInFields(a.name,b.htmlFields)?T.STRING_FIELD_OPTION_RICHTEXT:T.STRING_FIELD_OPTION_TEXTBOX;return{fieldName:a.name,field:a,stringFieldOption:c}})));b.showGlobalID&&!d&&l.push(this._findFirst(g,"name",f.globalIdField));b.showObjectID&&!e&&l.push(this._findFirst(g,"name",f.objectIdField));d=[];f.editFieldsInfo&&(f.editFieldsInfo.creatorField&&
d.push(f.editFieldsInfo.creatorField),f.editFieldsInfo.creationDateField&&d.push(f.editFieldsInfo.creationDateField),f.editFieldsInfo.editorField&&d.push(f.editFieldsInfo.editorField),f.editFieldsInfo.editDateField&&d.push(f.editFieldsInfo.editDateField));this._editorTrackingInfos[f.id]=d}},_createAttachmentEditor:function(){this._attachmentEditor=null;var b=a.filter(this._layerInfos,function(a){return a.showAttachments});b&&b.length&&(this._attachmentEditor=new C({"class":this.css.attachmentEditor},
this.attachmentEditor),this._attachmentEditor.startup())},_setCurrentLInfo:function(a){var b=this._currentLInfo?this._currentLInfo.featureLayer:null,c=a.featureLayer;if(b&&b.id===c.id&&!b.ownershipBasedAccessControlForFeatures&&(b=c.getEditCapabilities(),!b.canCreate||b.canUpdate))return;this._currentLInfo=a;this._createTable()},_updateSelection:function(b,c){this._selection=b||[];a.forEach(this._layerInfos,this._getSelection,this);var d=this._selection.length;this._numFeatures=this._selection.length;
this._showFeature(d?this._selection[this._featureIdx]:null,c)},_getSelection:function(a){a=a.featureLayer.getSelectedFeatures();this._selection=this._selection.concat(a)},_updateUI:function(){var a=this._numFeatures,b=this._currentLInfo;this.layerName.innerHTML=b&&0!==a?b.featureLayer?b.featureLayer.name:"":this.NLS_noFeaturesSelected;m.set(this.attributeTable,"display",a?"":"none");m.set(this.editButtons,"display",a?"":"none");m.set(this.navButtons,"display",!this._hideNavButtons&&1<a?"":"none");
this.navMessage.innerHTML=c.substitute({idx:this._featureIdx+1,of:this.NLS_of,numFeatures:this._numFeatures},this._navMessage);this._attachmentEditor&&m.set(this._attachmentEditor.domNode,"display",b&&b.showAttachments&&a?"":"none");m.set(this.deleteBtn.domNode,"display",b&&!1===b.showDeleteButton||!this._canDelete?"none":"");this.domNode.parentNode&&0<this.domNode.parentNode.scrollTop&&(this.domNode.parentNode.scrollTop=0)},_onNextFeature:function(a){this._featureIdx+=a;0>this._featureIdx?this._featureIdx=
this._numFeatures-1:this._featureIdx>=this._numFeatures&&(this._featureIdx=0);a=this._selection.length?this._selection[this._featureIdx]:null;this._showFeature(a);this._updateUI();this.onNext(a)},_deleteFeature:function(){this.onDelete(this._currentFeature)},_showFeature:function(b,d){if(b){this._currentFeature=b;var e=d?d:b.getLayer(),f=e.getEditCapabilities({feature:b,userId:this._userIds[e.id]});this._canUpdate=f.canUpdate;this._canDelete=f.canDelete;if(f=this._getLInfoFromFeatureLayer(e)){this._setCurrentLInfo(f);
var g=b.attributes,l=this._findFirst(f.types,"id",g[f.typeIdField]),h=null;a.forEach(f.fieldInfos,function(b){h=b.field;var d=[];b.dijit&&1<b.dijit.length?a.forEach(b.dijit,function(a){d.push(a)}):d.push(b.dijit);a.forEach(d,k.hitch(this,function(a){if(a){var b=this._setFieldDomain(a,l,h),d=g[h.name],d=d&&b&&b.codedValues&&b.codedValues.length&&b.codedValues[d]?b.codedValues[d].name:d;c.isDefined(d)||(d="");"dijit.form.DateTextBox"===a.declaredClass||"dijit.form.TimeTextBox"===a.declaredClass?d=""===
d?null:new Date(d):"dijit.form.FilteringSelect"===a.declaredClass&&(a._lastValueReported=null,d=g[h.name]+"");try{this._setValue(a,d),"dijit.form.FilteringSelect"===a.declaredClass&&!1===a.isValid()&&this._setValue(a,null)}catch(za){a.set("displayedValue",this.NLS_errorInvalid,!1)}}}))},this);this._attachmentEditor&&f.showAttachments&&this._attachmentEditor.showAttachments(this._currentFeature,e);(e=e.getEditSummary(b))?(this.editorTrackingInfoDiv.innerHTML=e,n.show(this.editorTrackingInfoDiv)):n.hide(this.editorTrackingInfoDiv)}}},
_setFieldDomain:function(b,d,e){if(!b)return null;var f=e.domain;return d&&d.domains&&d.domains[e.name]&&0==d.domains[e.name]instanceof q&&(f=d.domains[e.name]),f?(f.codedValues&&0<f.codedValues.length?(b.set("store",this._toStore(a.map(f.codedValues,function(a){return{id:a.code+="",name:a.name}}))),this._setValue(b,f.codedValues[0].code)):(b.constraints={min:c.isDefined(f.minValue)?f.minValue:Number.MIN_VALUE,max:c.isDefined(f.maxValue)?f.maxValue:Number.MAX_VALUE},this._setValue(b,b.constraints.min)),
f):null},_setValue:function(a,b){a.set&&(a._onChangeActive=!1,a.set("value",b,!0),a._onChangeActive=!0)},_getFields:function(b){var d=b._getOutFields();if(!d)return null;b=b.fields;return"*"==d?b:a.filter(a.map(d,k.hitch(this,"_findFirst",b,"name")),c.isDefined)},_isInFields:function(b,c){return b&&(c||c.length)?a.some(c,function(a){return a.toLowerCase()===b.toLowerCase()}):!1},_isFieldNullable:function(a,b){return!(!1===a.nullable||b.field&&!1===b.field.nullable)},_isFieldRequired:function(a,b){return!1!==
a.editable&&!1!==b.isEditable&&!this._isFieldNullable(a,b)},_findFirst:function(b,c,d){return(b=a.filter(b,function(a){return a.hasOwnProperty(c)&&a[c]===d}))&&b.length?b[0]:null},_getLInfoFromFeatureLayer:function(a){return this._findFirst(this._layerInfos,"layerId",a?a.id:null)},_createTable:function(){this._destroyAttributeTable();this.attributeTable.innerHTML="";this._attributes=g.create("table",{cellspacing:"0",cellpadding:"0"},this.attributeTable);var b=g.create("tbody",null,this._attributes),
c=this._currentLInfo,d=this._findFirst(c.types,"id",this._currentFeature.attributes[c.typeIdField]);a.forEach(c.fieldInfos,k.hitch(this,"_createField",d,b),this);this._createOnlyFirstTime=!1},_createField:function(a,b,c){var d=this._currentLInfo,e=c.field;if(!this._isInFields(e.name,d.hideFields)&&!this._isInFields(e.name,this._editorTrackingInfos[d.featureLayer.id])){var f,l,h,m,n,q,r,t=!1;if(f=g.create("tr",null,b),l=g.create("td",{innerHTML:c.label||e.alias||e.name,"class":this.css.label,"data-fieldname":e.name},
f),this._isFieldRequired(e,c)&&g.create("span",{"class":this.css.red,innerHTML:" *"},l),h=g.create("td",null,f),c.customField?(g.place(c.customField.domNode||c.customField,g.create("div",null,h),"first"),m=c.customField):(!1===d.isEditable||!1===e.editable||!1===c.isEditable||"esriFieldTypeOID"===e.type||"esriFieldTypeGlobalID"===e.type||!this._canUpdate&&!this._createOnlyFirstTime)&&(t=!0),q=d.typeIdField&&e.name.toLowerCase()==d.typeIdField.toLowerCase(),r=!!this._getDomainForField(e,a),!m&&q?m=
this._createTypeField(e,c,h):!m&&r&&(m=this._createDomainField(e,c,a,h)),!m)switch(e.type){case "esriFieldTypeString":m=this._createStringField(e,c,h);break;case "esriFieldTypeDate":m=this._createDateField(e,c,h);c.format&&c.format.time&&(n=this._createTimeField(e,c,h));break;case "esriFieldTypeInteger":case "esriFieldTypeSmallInteger":m=this._createIntField(e,c,h);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":m=this._createFltField(e,c,h);break;default:m=this._createStringField(e,c,
h)}c.tooltip&&c.tooltip.length&&this._toolTips.push(new O({connectId:[m.id],label:c.tooltip}));m.onChange=k.hitch(this,"onFieldValueChange",c);m.set("disabled",t);n?(c.dijit=[m,n],n.onChange=k.hitch(this,"onFieldValueChange",c),n.set("disabled",t)):c.dijit=m}},_createTypeField:function(b,c,d){d=g.create("div",null,d);var e=b.domain;return e&&"range"===e.type&&e.minValue===e.maxValue?new K({"class":this.css.field,trim:!0,maxLength:b.length,name:b.alias||b.name,required:this._isFieldRequired(b,c)},
d):new J({"class":this.css.field,name:b.alias||b.name,required:this._isFieldRequired(b,c),store:this._toStore(a.map(this._currentLInfo.types,function(a){return{id:a.id,name:a.name}})),searchAttr:"name"},d)},_getDomainForField:function(a,b){var c=a.domain,d=a.name;return d&&b&&b.domains&&b.domains[d]&&0==b.domains[d]instanceof q&&(c=b.domains[d]),c||null},_createDomainField:function(a,b,c,d){c=this._getDomainForField(a,c);d=g.create("div",null,d);return c.codedValues?new J({"class":this.css.field,
name:a.alias||a.name,searchAttr:"name",required:this._isFieldRequired(a,b)},d):new L({"class":this.css.field},d)},_createStringField:function(a,b,c){c=g.create("div",null,c);var d={trim:!0,maxLength:a.length,required:this._isFieldRequired(a,b)};if(b.stringFieldOption===T.STRING_FIELD_OPTION_TEXTAREA)return d["class"]=this.css.field+" "+this.css.textArea,new H(d,c);if(b.stringFieldOption===T.STRING_FIELD_OPTION_RICHTEXT)return d["class"]=this.css.field+" "+this.css.richText,d.height="100%",d.width=
"100%",d.plugins=b.richTextPlugins||this._defaultRichTextPlugins,c=new y(d,c),c.startup(),c;var e=this;return d.validator=function(c,d){return this._maskValidSubsetError=!1,this._hasBeenBlurred=!0,e._isFieldNullable(a,b)||!(""===c||null===c)},new K(d,c)},_createTimeField:function(a,b,c){c=g.create("div",null,c);a={"class":this.css.field,trim:!0,required:this._isFieldRequired(a,b),constraints:{formatLength:"medium"}};return this._datePackage&&(a.datePackage=this._datePackage),new P(a,c)},_createDateField:function(a,
b,c){c=g.create("div",null,c);a={"class":this.css.field,trim:!0,required:this._isFieldRequired(a,b)};return this._datePackage&&(a.datePackage=this._datePackage),new F(a,c)},_createIntField:function(a,b,c){c=g.create("div",null,c);var d=/\de[-+]?\d/i,e=/^[-+]?\d+$/,f=this;return new K({"class":this.css.field,constraints:"esriFieldTypeSmallInteger"===a.type?{min:-32768,max:32767,places:0}:{places:0},trim:!0,invalidMessage:this.NLS_validationInt,required:this._isFieldRequired(a,b),validator:function(c,
g){return this._maskValidSubsetError=!1,this._hasBeenBlurred=!0,""!==c&&null!==c||!f._isFieldNullable(a,b)?d.test(c)?!0:e.test(c)&&("min"in g?0<=this.compare(c,g.min):1)&&("max"in g?0>=this.compare(c,g.max):1)?!0:!1:!0}},c)},_createFltField:function(a,b,c){c=g.create("div",null,c);var d=/\de[-+]?\d/i,e=/[0-9]\d{0,2}(\.\d{3})*(,\d+)?$/i,f=this;return new K({"class":this.css.field,constraints:{places:"0,40",min:-(1/0),max:1/0,exponent:!0},trim:!0,invalidMessage:this.NLS_validationFlt,required:this._isFieldRequired(a,
b),validator:function(c,g){return this._maskValidSubsetError=!1,this._hasBeenBlurred=!0,""!==c&&null!==c||!f._isFieldNullable(a,b)?d.test(c)?!0:e.test(c)&&("min"in g?0<=this.compare(c,g.min):1)&&("max"in g?0>=this.compare(c,g.max):1)?!0:!1:!0}},c)},_toStore:function(a){return new S({data:{identifier:"id",label:"name",items:a}})},_connect:function(a,b,c){this._aiConnects.push(f.connect(a,b,c))},_getDatePackage:function(a){return null===a.datePackage?null:a.datePackage?a.datePackage:"ar"===e.locale?
"dojox.date.islamic":null},_destroyAttributeTable:function(){a.forEach(this._layerInfos,function(b){a.forEach(b.fieldInfos,function(b){var c=b.dijit;if(c){if(c._onChangeHandle=null,b.customField)return;c instanceof Array?a.forEach(c,k.hitch(this,function(a){a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy();a._onChangeHandle=null})):c.destroyRecursive?c.destroyRecursive():c.destroy&&c.destroy()}b.dijit=null},this)},this);a.forEach(this._toolTips,function(a){a.destroy()});this._toolTips=
[];this._attributes&&g.destroy(this._attributes)}});return k.mixin(T,{STRING_FIELD_OPTION_RICHTEXT:"richtext",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_TEXTBOX:"textbox"}),l("extend-esri")&&k.setObject("dijit.AttributeInspector",T,d),T})},"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D){function E(a){return new y({command:a.name})}function F(a){return new y({buttonClass:x,command:a.name})}a=a("dijit.Editor",C,{plugins:null,extraPlugins:null,constructor:function(){c.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",A]);this._plugins=
[];this._editInterval=1E3*this.editActionInterval;if(n("ie")||n("trident")||n("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new f;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);c.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=b.getLocalization("dijit._editor",
"commands",this.lang);n("webkit")&&g.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new v({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));k.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);l.add(this.iframe.parentNode,"dijitEditorIFrameContainer");l.add(this.iframe,"dijitEditorIFrame");e.set(this.iframe,"allowTransparency",
!0);this.toolbar.startup();this.onNormalizedDisplayChanged()},destroy:function(){k.forEach(this._plugins,function(a){a&&a.destroy&&a.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(a,b){var d=c.isString(a)?{name:a}:c.isFunction(a)?{ctor:a}:a;if(!d.setEditor){var e={args:d,plugin:null,editor:this};d.name&&(y.registry[d.name]?e.plugin=y.registry[d.name](d):t.publish(D._scopeName+".Editor.getPlugin",e));if(!e.plugin)try{var f=
d.ctor||c.getObject(d.name)||h(d.name);f&&(e.plugin=new f(d))}catch(H){throw Error(this.id+": cannot find plugin ["+d.name+"]");}if(!e.plugin)throw Error(this.id+": cannot find plugin ["+d.name+"]");a=e.plugin}1<arguments.length?this._plugins[b]=a:this._plugins.push(a);a.setEditor(this);c.isFunction(a.setToolbar)&&a.setToolbar(this.toolbar)},resize:function(a){a&&w.prototype.resize.apply(this,arguments)},layout:function(){var a=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+m.getPadBorderExtents(this.iframe.parentNode).h+
m.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=a+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(a){var b,c=this.document.body,d=c.clientWidth,e=c.clientHeight,f=c.clientLeft,g=c.offsetWidth,l=c.offsetHeight,h=c.offsetLeft;/^rtl$/i.test(c.dir||"")?d<g&&a.x>d&&a.x<g&&(b=!0):a.x<f&&a.x>h&&(b=!0);b||e<l&&a.y>e&&a.y<l&&(b=!0);b||(delete this._cursorToStart,delete this._savedSelection,"BODY"==a.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(a){this.customUndo&&this.endEditing(!0);"BODY"!=a.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(a){this._inEditing||(this._inEditing=!0,this._beginEditing(a));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(a){if(!this.customUndo||
"undo"!=a&&"redo"!=a){this.customUndo&&(this.endEditing(),this._beginEditing());var b=this.inherited(arguments);this.customUndo&&this._endEditing();return b}return this[a]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(a){var b;try{if(b=this.document.execCommand(a,!1,null),n("webkit")&&!b)throw{};}catch(J){b=q.substitute,alert(b(this.commands.systemShortcut,
[this.commands[a],b(this.commands[n("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[a]])])),b=!1}return b},queryCommandEnabled:function(a){return!this.customUndo||"undo"!=a&&"redo"!=a?this.inherited(arguments):"undo"==a?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(a){var b=a.mark,d=a.mark;a=a.isCollapsed;var e,f,g;d&&(9>n("ie")||9===n("ie")&&n("quirks")?c.isArray(d)?(b=[],k.forEach(d,function(a){b.push(B.getNode(a,this.editNode))},this),this.selection.moveToBookmark({mark:b,
isCollapsed:a})):d.startContainer&&d.endContainer&&(g=B.getSelection(this.window))&&g.removeAllRanges&&(g.removeAllRanges(),a=B.create(this.window),e=B.getNode(d.startContainer,this.editNode),f=B.getNode(d.endContainer,this.editNode),e&&f&&(a.setStart(e,d.startOffset),a.setEnd(f,d.endOffset),g.addRange(a))):(g=B.getSelection(this.window))&&g.removeAllRanges&&(g.removeAllRanges(),a=B.create(this.window),e=B.getNode(d.startContainer,this.editNode),f=B.getNode(d.endContainer,this.editNode),e&&f&&(a.setStart(e,
d.startOffset),a.setEnd(f,d.endOffset),g.addRange(a))))},_changeToStep:function(a,b){this.setValue(b.text);var c=b.bookmark;c&&this._moveToBookmark(c)},undo:function(){var a=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._steps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(b,this._steps[this._steps.length-1]),this._undoedSteps.push(b),this.onDisplayChanged(),delete this._undoRedoActive,a=!0);delete this._undoRedoActive}return a},redo:function(){var a=
!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._undoedSteps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],b),this._steps.push(b),this.onDisplayChanged(),a=!0);delete this._undoRedoActive}return a},endEditing:function(a){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(a),this._inEditing=!1)},_getBookmark:function(){var a=this.selection.getBookmark(),b=[];if(a&&a.mark){var d=
a.mark;if(9>n("ie")||9===n("ie")&&n("quirks")){var e=B.getSelection(this.window);if(c.isArray(d))k.forEach(a.mark,function(a){b.push(B.getIndex(a,this.editNode).o)},this),a.mark=b;else if(e){var f;e.rangeCount&&(f=e.getRangeAt(0));a.mark=f?f.cloneRange():this.selection.getBookmark()}}try{a.mark&&a.mark.startContainer&&(b=B.getIndex(a.mark.startContainer,this.editNode).o,a.mark={startContainer:b,startOffset:a.mark.startOffset,endContainer:a.mark.endContainer===a.mark.startContainer?b:B.getIndex(a.mark.endContainer,
this.editNode).o,endOffset:a.mark.endOffset})}catch(H){a.mark=null}}return a},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:z.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var a=z.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:a,bookmark:this._getBookmark()})},onKeyDown:function(a){n("ie")||this.iframe||a.keyCode!=d.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var b=a.keyCode;if(a.ctrlKey&&
!a.shiftKey&&!a.altKey){if(90==b||122==b){a.stopPropagation();a.preventDefault();this.undo();return}if(89==b||121==b){a.stopPropagation();a.preventDefault();this.redo();return}}this.inherited(arguments);switch(b){case d.ENTER:case d.BACKSPACE:case d.DELETE:this.beginEditing();break;case 88:case 86:if(a.ctrlKey&&!a.altKey&&!a.metaKey){this.endEditing();88==a.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!a.ctrlKey&&!a.altKey&&!a.metaKey&&(a.keyCode<
d.F1||a.keyCode>d.F15)){this.beginEditing();break}case d.ALT:this.endEditing();break;case d.UP_ARROW:case d.DOWN_ARROW:case d.LEFT_ARROW:case d.RIGHT_ARROW:case d.HOME:case d.END:case d.PAGE_UP:case d.PAGE_DOWN:this.endEditing(!0);case d.CTRL:case d.SHIFT:case d.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(G){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(a){this.customUndo?this.isClosed?this.setValue(a):(this.beginEditing(),a||(a="\x26#160;"),this.setValue(a),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(a){this.setValueDeferred.then(c.hitch(this,function(){!this.disabled&&a||!this._buttonEnabledPlugins&&a?
k.forEach(this._plugins,function(a){a.set("disabled",!0)}):this.disabled&&!a&&k.forEach(this._plugins,function(a){a.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&g.set(this.document.body,"color",g.get(this.iframe,"color"))}catch(G){}}});c.mixin(y.registry,{undo:E,redo:E,cut:E,copy:E,paste:E,insertOrderedList:E,insertUnorderedList:E,indent:E,outdent:E,justifyCenter:E,justifyFull:E,justifyLeft:E,justifyRight:E,
"delete":E,selectAll:E,removeFormat:E,unlink:E,insertHorizontalRule:E,bold:F,italic:F,underline:F,strikethrough:F,subscript:F,superscript:F,"|":function(){return new y({setEditor:function(a){this.editor=a;this.button=new u({ownerDocument:a.ownerDocument})}})}});return a})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(h,k,a,f,b,e,l,m){a("dijit-legacy-requires")&&b(0,function(){h(["dijit/ToolbarSeparator"])});
return k("dijit.Toolbar",[e,m,l],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(h,k,a,f){return h("dijit.ToolbarSeparator",[a,f],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',
buildRendering:function(){this.inherited(arguments);k.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/form/ToggleButton":function(){define(["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(h,k,a,f){return h("dijit.form.ToggleButton",[a,f],{baseClass:"dijitToggleButton",setChecked:function(a){k.deprecated("setChecked("+a+") is deprecated. Use set('checked',"+a+") instead.","","2.0");this.set("checked",a)}})})},"dijit/form/_ToggleButtonMixin":function(){define(["dojo/_base/declare",
"dojo/dom-attr"],function(h,k){return h("dijit.form._ToggleButtonMixin",null,{checked:!1,_aria_attr:"aria-pressed",_onClick:function(a){var f=this.checked;this._set("checked",!f);var b=this.inherited(arguments);this.set("checked",b?this.checked:f);return b},_setCheckedAttr:function(a,f){this._set("checked",a);var b=this.focusNode||this.domNode;this._created&&k.get(b,"checked")!=!!a&&k.set(b,"checked",!!a);b.setAttribute(this._aria_attr,String(a));this._handleOnChange(a,f)},postCreate:function(){this.inherited(arguments);
var a=this.focusNode||this.domNode;this.checked&&a.setAttribute("checked","checked");void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.checked)},reset:function(){this._hasBeenBlurred=!1;this.set("checked",this.params.checked||!1)}})})},"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(h,k,a,f,b){k=k("dijit._editor._Plugin",f,{constructor:function(b){this.params=b||{};a.mixin(this,
this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:b,disabled:!1,getLabel:function(a){return this.editor.commands[a]},_initButton:function(){if(this.command.length){var b=this.getLabel(this.command),f=this.editor,h=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(b=a.mixin({label:b,ownerDocument:f.ownerDocument,dir:f.dir,lang:f.lang,showLabel:!1,
iconClass:h,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete b.name,this.button=new this.buttonClass(b))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();this.inherited(arguments)},connect:function(a,b,f){this.own(h.connect(a,b,this,f))},updateState:function(){var a=this.editor,b=this.command,f,g;if(a&&a.isLoaded&&b.length){var d=this.get("disabled");if(this.button)try{g=!d&&a.queryCommandEnabled(b),
this.enabled!==g&&(this.enabled=g,this.button.set("disabled",!g)),g&&"boolean"==typeof this.button.checked&&(f=a.queryCommandState(b),this.checked!==f&&(this.checked=f,this.button.set("checked",a.queryCommandState(b))))}catch(c){}}},setEditor:function(b){this.editor=b;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",a.hitch(this.editor,"execCommand",this.command,this.commandArg))):this.button.domNode.style.display=
"none");this.own(this.editor.on("NormalizedDisplayChanged",a.hitch(this,"updateState")))},setToolbar:function(a){this.button&&a.addChild(this.button)},set:function(a,b){if("object"===typeof a){for(var e in a)this.set(e,a[e]);return this}e=this._getAttrNames(a);if(this[e.s])var f=this[e.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(a,b);return f||this},get:function(a){var b=this._getAttrNames(a);return this[b.g]?this[b.g]():this[a]},_setDisabledAttr:function(a){this._set("disabled",
a);this.updateState()},_getAttrNames:function(a){var b=this._attrPairNames;if(b[a])return b[a];var e=a.charAt(0).toUpperCase()+a.substr(1);return b[a]={s:"_set"+e+"Attr",g:"_get"+e+"Attr"}},_set:function(a,b){this[a]=b}});k.registry={};return k})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),function(h,k,a,f,b,e,l,m,g,d,c){return h("dijit._editor.plugins.EnterKeyHandling",
g,{blockNodeForEnter:"BR",constructor:function(a){a&&("blockNodeForEnter"in a&&(a.blockNodeForEnter=a.blockNodeForEnter.toUpperCase()),f.mixin(this,a))},setEditor:function(c){if(this.editor!==c)if(this.editor=c,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,c.onLoadDeferred.then(f.hitch(this,function(d){this.own(b(c.document,"keydown",f.hitch(this,function(b){if(b.keyCode==a.ENTER){var c=f.mixin({},b);c.shiftKey=!0;this.handleEnterKey(c)||(b.stopPropagation(),b.preventDefault())}})));9<=e("ie")&&
10>=e("ie")&&this.own(b(c.document,"paste",f.hitch(this,function(a){setTimeout(f.hitch(this,function(){var a=this.editor.document.selection.createRange();a.move("character",-1);a.select();a.move("character",1);a.select()}),0)})));return d}));else if(this.blockNodeForEnter){var d=f.hitch(this,"handleEnterKey");c.addKeyHandler(13,0,0,d);c.addKeyHandler(13,0,1,d);this.own(this.editor.on("KeyPressed",f.hitch(this,"onKeyPressed")))}},onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var a=
this.editor.selection.getAncestorElement("LI");if(a){e("mozilla")&&"LI"==a.parentNode.parentNode.nodeName&&(a=a.parentNode.parentNode);var b=a.firstChild;!b||1!=b.nodeType||"UL"!=b.nodeName&&"OL"!=b.nodeName||(a.insertBefore(b.ownerDocument.createTextNode("\u00a0"),b),b=c.create(this.editor.window),b.setStart(a.firstChild,0),a=c.getSelection(this.editor.window,!0),a.removeAllRanges(),a.addRange(b))}else d.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter),(a=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?
(a.innerHTML=this.bogusHtmlContent,9>=e("ie")&&(a=this.editor.document.selection.createRange(),a.move("character",-1),a.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(a){var b,f,g,l,h=this.editor.document,
n,x,y;if(a.shiftKey){a=this.editor.selection.getParentElement();if(l=c.getAncestor(a,this.blockNodes)){if("LI"==l.tagName)return!0;a=c.getSelection(this.editor.window);b=a.getRangeAt(0);b.collapsed||(b.deleteContents(),a=c.getSelection(this.editor.window),b=a.getRangeAt(0));if(c.atBeginningOfContainer(l,b.startContainer,b.startOffset))n=h.createElement("br"),b=c.create(this.editor.window),l.insertBefore(n,l.firstChild),b.setStartAfter(n),a.removeAllRanges(),a.addRange(b);else if(c.atEndOfContainer(l,
b.startContainer,b.startOffset))b=c.create(this.editor.window),n=h.createElement("br"),l.appendChild(n),l.appendChild(h.createTextNode("\u00a0")),b.setStart(l.lastChild,0),a.removeAllRanges(),a.addRange(b);else return(x=b.startContainer)&&3==x.nodeType?(y=x.nodeValue,f=h.createTextNode(y.substring(0,b.startOffset)),g=h.createTextNode(y.substring(b.startOffset)),l=h.createElement("br"),""==g.nodeValue&&e("webkit")&&(g=h.createTextNode("\u00a0")),k.place(f,x,"after"),k.place(l,f,"after"),k.place(g,
l,"after"),k.destroy(x),b=c.create(this.editor.window),b.setStart(g,0),a.removeAllRanges(),a.addRange(b),!1):!0}else a=c.getSelection(this.editor.window),a.rangeCount?(b=a.getRangeAt(0))&&b.startContainer&&(b.collapsed||(b.deleteContents(),a=c.getSelection(this.editor.window),b=a.getRangeAt(0)),(x=b.startContainer)&&3==x.nodeType?(l=b.startOffset,x.length<l&&(g=this._adjustNodeAndOffset(x,l),x=g.node,l=g.offset),y=x.nodeValue,f=h.createTextNode(y.substring(0,l)),g=h.createTextNode(y.substring(l)),
l=h.createElement("br"),g.length||(g=h.createTextNode("\u00a0")),f.length?k.place(f,x,"after"):f=x,k.place(l,f,"after"),k.place(g,l,"after"),k.destroy(x)):(0<=b.startOffset&&(n=x.childNodes[b.startOffset]),l=h.createElement("br"),g=h.createTextNode("\u00a0"),n?(k.place(l,n,"before"),k.place(g,l,"after")):(x.appendChild(l),x.appendChild(g))),b=c.create(this.editor.window),b.setStart(g,0),b.setEnd(g,g.length),a.removeAllRanges(),a.addRange(b),this.editor.selection.collapse(!0)):d.prototype.execCommand.call(this.editor,
"inserthtml","\x3cbr\x3e");return!1}var A=!0;a=c.getSelection(this.editor.window);b=a.getRangeAt(0);b.collapsed||(b.deleteContents(),a=c.getSelection(this.editor.window),b=a.getRangeAt(0));n=c.getBlockAncestor(b.endContainer,null,this.editor.editNode);var z=n.blockNode;if(this._checkListLater=z&&("LI"==z.nodeName||"LI"==z.parentNode.nodeName))return e("mozilla")&&(this._pressedEnterInBlock=z),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(z.innerHTML)&&
(z.innerHTML="",e("webkit")&&(b=c.create(this.editor.window),b.setStart(z,0),a.removeAllRanges(),a.addRange(b)),this._checkListLater=!1),!0;if(!n.blockNode||n.blockNode===this.editor.editNode){try{d.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(B){}n={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),blockContainer:this.editor.editNode};if(n.blockNode){if(n.blockNode!=this.editor.editNode&&!(n.blockNode.textContent||n.blockNode.innerHTML).replace(/^\s+|\s+$/g,
"").length)return this.removeTrailingBr(n.blockNode),!1}else n.blockNode=this.editor.editNode;a=c.getSelection(this.editor.window);b=a.getRangeAt(0)}z=h.createElement(this.blockNodeForEnter);z.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(n.blockNode);g=b.endOffset;A=b.endContainer;A.length<g&&(g=this._adjustNodeAndOffset(A,g),A=g.node,g=g.offset);if(c.atEndOfContainer(n.blockNode,A,g))n.blockNode===n.blockContainer?n.blockNode.appendChild(z):k.place(z,n.blockNode,"after"),A=!1,b=c.create(this.editor.window),
b.setStart(z,0),a.removeAllRanges(),a.addRange(b),this.editor.height&&m.scrollIntoView(z);else if(c.atBeginningOfContainer(n.blockNode,b.startContainer,b.startOffset))k.place(z,n.blockNode,n.blockNode===n.blockContainer?"first":"before"),z.nextSibling&&this.editor.height&&(b=c.create(this.editor.window),b.setStart(z.nextSibling,0),a.removeAllRanges(),a.addRange(b),m.scrollIntoView(z.nextSibling)),A=!1;else{n.blockNode===n.blockContainer?n.blockNode.appendChild(z):k.place(z,n.blockNode,"after");A=
!1;n.blockNode.style&&z.style&&n.blockNode.style.cssText&&(z.style.cssText=n.blockNode.style.cssText);if((x=b.startContainer)&&3==x.nodeType){g=b.endOffset;x.length<g&&(g=this._adjustNodeAndOffset(x,g),x=g.node,g=g.offset);y=x.nodeValue;f=h.createTextNode(y.substring(0,g));g=h.createTextNode(y.substring(g,y.length));k.place(f,x,"before");k.place(g,x,"after");k.destroy(x);for(b=f.parentNode;b!==n.blockNode;){y=h.createElement(b.tagName);b.style&&y.style&&b.style.cssText&&(y.style.cssText=b.style.cssText);
"FONT"===b.tagName&&(b.color&&(y.color=b.color),b.face&&(y.face=b.face),b.size&&(y.size=b.size));for(;g;)x=g.nextSibling,y.appendChild(g),g=x;k.place(y,b,"after");f=b;g=y;b=b.parentNode}if(1==g.nodeType||3==g.nodeType&&g.nodeValue)z.innerHTML="";for(f=g;g;)x=g.nextSibling,z.appendChild(g),g=x}b=c.create(this.editor.window);h=f;if("BR"!==this.blockNodeForEnter){for(;h;)l=h,h=x=h.firstChild;l&&l.parentNode?(z=l.parentNode,b.setStart(z,0),a.removeAllRanges(),a.addRange(b),this.editor.height&&m.scrollIntoView(z),
e("mozilla")&&(this._pressedEnterInBlock=n.blockNode)):A=!0}else b.setStart(z,0),a.removeAllRanges(),a.addRange(b),this.editor.height&&m.scrollIntoView(z),e("mozilla")&&(this._pressedEnterInBlock=n.blockNode)}return A},_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3==a.nextSibling.nodeType;)b-=a.length,a=a.nextSibling;return{node:a,offset:b}},removeTrailingBr:function(a){if(a=/P|DIV|LI/i.test(a.tagName)?a:this.editor.selection.getParentOfType(a,["P","DIV","LI"]))a.lastChild&&
(1<a.childNodes.length&&3==a.lastChild.nodeType&&/^[\s\xAD]*$/.test(a.lastChild.nodeValue)||"BR"==a.lastChild.tagName)&&k.destroy(a.lastChild),a.childNodes.length||(a.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I){var J=a("dijit._editor.RichText",[B,C],{constructor:function(a){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};a&&q.isString(a.value)&&(this.value=a.value);this.onLoadDeferred=new f},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[q.trim,q.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);u("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));u("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(u("ie")||u("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[q.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[q.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);x.publish(I._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var a=q.hitch(this,function(a,b){return function(){return!this.execCommand(a,b)}}),b={b:a("bold"),i:a("italic"),u:a("underline"),a:a("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:a("formatblock",
"h1"),2:a("formatblock","h2"),3:a("formatblock","h3"),4:a("formatblock","h4"),"\\":a("insertunorderedlist")};u("ie")||(b.Z=a("redo"));for(var c in b)this.addKeyHandler(c,!0,!1,b[c])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(J._editorCommandsLocalized)this._local2NativeFormatNames=J._local2NativeFormatNames,this._native2LocalFormatNames=J._native2LocalFormatNames;else{J._editorCommandsLocalized=!0;J._local2NativeFormatNames={};
J._native2LocalFormatNames={};this._local2NativeFormatNames=J._local2NativeFormatNames;this._native2LocalFormatNames=J._native2LocalFormatNames;for(var a="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),b="",c,d=0;c=a[d++];)b="l"!==c.charAt(1)?b+("\x3c"+c+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+c+"\x3e\x3cbr/\x3e"):b+("\x3c"+c+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+c+"\x3e\x3cbr/\x3e");var e=m.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:b});this.ownerDocumentBody.appendChild(e);
a=q.hitch(this,function(){for(var a=e.firstChild;a;)try{this.selection.selectElement(a.firstChild);var b=a.tagName.toLowerCase();this._local2NativeFormatNames[b]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[b]]=b;a=a.nextSibling.nextSibling}catch(Q){}m.destroy(e)});this.defer(a)}},open:function(a){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new f;this.isClosed||this.close();x.publish(I._scopeName+"._editor.RichText::open",
this);1===arguments.length&&a.nodeName&&(this.domNode=a);var c=this.domNode,g;if(q.isString(this.value))g=this.value,c.innerHTML="";else if(c.nodeName&&"textarea"==c.nodeName.toLowerCase()){var h=this.textarea=c;this.name=h.name;g=h.value;c=this.domNode=this.ownerDocument.createElement("div");c.setAttribute("widgetId",this.id);h.removeAttribute("widgetId");c.cssText=h.cssText;c.className+=" "+h.className;m.place(c,h,"before");var n=q.hitch(this,function(){d.set(h,{display:"block",position:"absolute",
top:"-1000px"});if(u("ie")){var a=h.style;this.__overflow=a.overflow;a.overflow="hidden"}});u("ie")?this.defer(n,10):n();if(h.form){var r=h.value;this.reset=function(){this.getValue()!==r&&this.replaceValue(r)};t(h.form,"submit",q.hitch(this,function(){e.set(h,"disabled",this.disabled);h.value=this.getValue()}))}}else g=F.getChildrenHtml(c),c.innerHTML="";this.value=g;c.nodeName&&"LI"===c.nodeName&&(c.innerHTML=" \x3cbr\x3e");this.header=c.ownerDocument.createElement("div");c.appendChild(this.header);
this.editingArea=c.ownerDocument.createElement("div");c.appendChild(this.editingArea);this.footer=c.ownerDocument.createElement("div");c.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!k.useXDomain||k.allowXdRichTextSave)){if((g=b.byId(I._scopeName+"._editor.RichText.value"))&&""!==g.value)for(var n=g.value.split(this._SEPARATOR),v=0,w;w=n[v++];)if(w=w.split(this._NAME_CONTENT_SEP),w[0]===this.name){this.value=w[1];n=n.splice(v,1);g.value=n.join(this._SEPARATOR);
break}J._globalSaveHandler||(J._globalSaveHandler={},y.addOnUnload(function(){for(var a in J._globalSaveHandler){var b=J._globalSaveHandler[a];q.isFunction(b)&&b()}}));J._globalSaveHandler[this.id]=q.hitch(this,"_saveContent")}this.isClosed=!1;g=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");g.id=this.id+"_iframe";g.style.border="none";g.style.width="100%";this._layoutMode?g.style.height="100%":7<=u("ie")?(this.height&&(g.style.height=this.height),this.minHeight&&(g.style.minHeight=
this.minHeight)):g.style.height=this.height?this.height:this.minHeight;g.frameBorder=0;g._loadFunc=q.hitch(this,function(a){this.window=a;this.document=a.document;this.selection=new D.SelectionManager(a);u("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});n=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");n=11>u("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+n+"');document.close()":"javascript: '"+
n+"'";this.editingArea.appendChild(g);g.src=n;"LI"===c.nodeName&&(c.lastChild.style.marginTop="-1.2em");l.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var a=d.getComputedStyle(this.domNode),e;if(this["aria-label"])e=this["aria-label"];else{var f=r('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||b.byId(this["aria-labelledby"],this.ownerDocument);f&&(e=f.textContent||f.innerHTML||"")}var f="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(e?" aria-label\x3d'"+w.escape(e)+"'":"")+"\x3e\x3c/div\x3e",g=[a.fontWeight,a.fontSize,a.fontFamily].join(" "),l=a.lineHeight,l=0<=l.indexOf("px")?parseFloat(l)/parseFloat(a.fontSize):0<=l.indexOf("em")?parseFloat(l):"normal",h="",m=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(a){a=a.replace(/^;/ig,"")+";";var b=a.split(":")[0];if(b){var b=q.trim(b),b=b.toLowerCase(),c,e="";for(c=0;c<b.length;c++){var f=b.charAt(c);switch(f){case "-":c++,f=b.charAt(c).toUpperCase();default:e+=
f}}d.set(m.domNode,e,"")}h+=a+";"});this.iframe.setAttribute("title",e);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||c.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",e?"\x3ctitle\x3e"+w.escape(e)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",g,";\n",this.height||u("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",l,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",u("ie")||u("trident")||u("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",e?" aria-label\x3d'"+w.escape(e)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+h+"'\x3e",f,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var a=[];this.styleSheets&&(a=this.styleSheets.split(";"),this.styleSheets=
"");a=a.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var b="",c=0,d,e=z.get(this.ownerDocument);d=a[c++];)d=(new A(e.location,d)).toString(),this.editingAreaStyleSheets.push(d),b+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+d+'"/\x3e';return b},addStyleSheet:function(a){var b=a.toString(),c=z.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new A(c.location,b)).toString();-1<h.indexOf(this.editingAreaStyleSheets,b)||(this.editingAreaStyleSheets.push(b),
this.onLoadDeferred.then(q.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(b);else{var a=this.document.getElementsByTagName("head")[0],c=this.document.createElement("link");c.rel="stylesheet";c.type="text/css";c.href=b;a.appendChild(c)}})))},removeStyleSheet:function(a){var b=a.toString(),c=z.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new A(c.location,b)).toString();a=h.indexOf(this.editingAreaStyleSheets,b);-1!==a&&(delete this.editingAreaStyleSheets[a],
r('link[href\x3d"'+b+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(a){a=!!a;this._set("disabled",a);if(this.isLoaded){var b=u("ie")&&(this.isLoaded||!this.focusOnLoad);b&&(this.editNode.unselectable="on");this.editNode.contentEditable=!a;this.editNode.tabIndex=a?"-1":this.tabIndex;b&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(u("mozilla")&&!a&&this._mozSettingProps){a=this._mozSettingProps;for(var c in a)if(a.hasOwnProperty(c))try{this.document.execCommand(c,
!1,a[c])}catch(K){}}this._disabledOK=!0}},onLoad:function(a){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=G.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var b=this;this.beforeIframeNode=m.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=m.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){b.editNode.focus()};this.focusNode=
this.editNode;var c=this.events.concat(this.captureEvents),d=this.iframe?this.document:this.editNode;this.own.apply(this,h.map(c,function(a){var b=a.toLowerCase().replace(/^on/,"");return t(d,b,q.hitch(this,a))},this));this.own(t(d,"mouseup",q.hitch(this,"onClick")));u("ie")&&(this.own(t(this.document,"mousedown",q.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);u("webkit")&&(this._webkitListener=this.own(t(this.document,"mouseup",q.hitch(this,"onDisplayChanged")))[0],this.own(t(this.document,
"mousedown",q.hitch(this,function(a){a=a.target;!a||a!==this.document.body&&a!==this.document||this.defer("placeCursorAtEnd")}))));if(u("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(P){}this.isLoaded=!0;this.set("disabled",this.disabled);c=q.hitch(this,function(){this.setValue(a);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&v(q.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(c):c()},onKeyDown:function(a){if(a.keyCode===n.SHIFT||a.keyCode===n.ALT||a.keyCode===n.META||a.keyCode===n.CTRL)return!0;a.keyCode===n.TAB&&this.isTabIndent&&(a.stopPropagation(),a.preventDefault(),this.queryCommandEnabled(a.shiftKey?"outdent":"indent")&&this.execCommand(a.shiftKey?"outdent":"indent"));if(a.keyCode==n.TAB&&!this.isTabIndent&&!a.ctrlKey&&!a.altKey)return a.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>u("ie")&&a.keyCode===n.BACKSPACE&&"Control"===this.document.selection.type&&(a.stopPropagation(),a.preventDefault(),this.execCommand("delete"));u("ff")&&(a.keyCode===n.PAGE_UP||a.keyCode===n.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&a.preventDefault();var b=this._keyHandlers[a.keyCode],c=arguments;b&&!a.altKey&&h.some(b,function(b){if(!(b.shift^a.shiftKey||b.ctrl^(a.ctrlKey||a.metaKey)))return b.handler.apply(this,c)||a.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(a){c.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",a)},_setValueAttr:function(a){this.setValue(a)},_setDisableSpellCheckAttr:function(a){this.document?e.set(this.document.body,"spellcheck",!a):this.onLoadDeferred.then(q.hitch(this,function(){e.set(this.document.body,"spellcheck",!a)}));this._set("disableSpellCheck",a)},addKeyHandler:function(a,b,c,d){"string"==
typeof a&&(a=a.toUpperCase().charCodeAt(0));q.isArray(this._keyHandlers[a])||(this._keyHandlers[a]=[]);this._keyHandlers[a].push({shift:c||!1,ctrl:b||!1,handler:d})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(a){this.onDisplayChanged(a)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(a){(u("ie")||u("trident"))&&this.defer(function(){G.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var b=this.getValue(!0);if(b!==this.value)this.onChange(b);
this._set("value",b)},_onFocus:function(a){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!u("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>u("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(a,b){var c=a.toLowerCase();"formatblock"===c?u("safari")&&void 0===b&&(c="heading"):"hilitecolor"!==c||u("mozilla")||(c="backcolor");return c},_qcaCache:{},queryCommandAvailable:function(a){var b=this._qcaCache[a];return void 0!==
b?b:this._qcaCache[a]=this._queryCommandAvailable(a)},_queryCommandAvailable:function(a){switch(a.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return u("ie")||u("trident")||u("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!u("webkit");default:return!1}},execCommand:function(a,b){var c;this.focused&&this.focus();a=this._normalizeCommand(a,b);if(void 0!==b){if("heading"===a)throw Error("unimplemented");"formatblock"===
a&&(u("ie")||u("trident"))&&(b="\x3c"+b+"\x3e")}var d="_"+a+"Impl";if(this[d])c=this[d](b);else if((b=1<arguments.length?b:null)||"createlink"!==a)c=this.document.execCommand(a,!1,b);this.onDisplayChanged();return c},queryCommandEnabled:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);var b="_"+a+"EnabledImpl";return this[b]?this[b](a):this._browserQueryCommandEnabled(a)},queryCommandState:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);
try{return this.document.queryCommandState(a)}catch(M){return!1}},queryCommandValue:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);if(u("ie")&&"formatblock"===a)a=this._native2LocalFormatNames[this.document.queryCommandValue(a)];else if(u("mozilla")&&"hilitecolor"===a){var b;try{b=this.document.queryCommandValue("styleWithCSS")}catch(H){b=!1}this.document.execCommand("styleWithCSS",!1,!0);a=this.document.queryCommandValue(a);this.document.execCommand("styleWithCSS",
!1,b)}else a=this.document.queryCommandValue(a);return a},_sCall:function(a,b){return this.selection[a].apply(this.selection,b)},placeCursorAtStart:function(){this.focus();var a=!1;if(u("mozilla"))for(var b=this.editNode.firstChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){var a=!0,c=b.tagName?b.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(c)?this.selection.selectElement(b):
this.selection.selectElementChildren(b);break}b=b.nextSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var a=!1;if(u("mozilla"))for(var b=this.editNode.lastChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){a=!0;this.selection.selectElement(b.lastChild||b);break}b=b.previousSibling}else a=!0,this.selection.selectElementChildren(this.editNode);
a&&this.selection.collapse(!1)},getValue:function(a){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,a):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(a){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){a=this._preFilterContent(a);var b=this.isClosed?this.domNode:this.editNode;b.innerHTML=a;this._preDomFilterContent(b)}else this.textarea.value=a;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(q.hitch(this,function(){this.setValue(a)}))},replaceValue:function(a){this.isClosed?this.setValue(a):this.window&&this.window.getSelection&&!u("mozilla")?this.setValue(a):this.window&&this.window.getSelection?(a=this._preFilterContent(a),this.execCommand("selectall"),this.execCommand("inserthtml",a),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(a);this._set("value",this.getValue(!0))},_preFilterContent:function(a){var b=
a;h.forEach(this.contentPreFilters,function(a){a&&(b=a(b))});return b},_preDomFilterContent:function(a){a=a||this.editNode;h.forEach(this.contentDomPreFilters,function(b){b&&q.isFunction(b)&&b(a)},this)},_postFilterContent:function(a,b){var c;q.isString(a)?c=a:(a=a||this.editNode,this.contentDomPostFilters.length&&(b&&(a=q.clone(a)),h.forEach(this.contentDomPostFilters,function(b){a=b(a)})),c=F.getChildrenHtml(a));q.trim(c.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(c="");h.forEach(this.contentPostFilters,
function(a){c=a(c)});return c},_saveContent:function(){var a=b.byId(I._scopeName+"._editor.RichText.value");a&&(a.value&&(a.value+=this._SEPARATOR),a.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(a,b){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");b||(a=a.replace(/'/gm,"\x26#39;"));return a},getNodeHtml:function(a){c.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return F.getNodeHtml(a)},getNodeChildrenHtml:function(a){c.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return F.getChildrenHtml(a)},close:function(a){if(!this.isClosed){arguments.length||(a=!0);a&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);u("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var b=this.textarea.style;b.position="";b.left=b.top="";u("ie")&&(b.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;m.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;l.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);J._globalSaveHandler&&delete J._globalSaveHandler[this.id]},_removeMozBogus:function(a){return a.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(a){a=a.replace(/\sclass="webkit-block-placeholder"/gi,"");a=a.replace(/\sclass="apple-style-span"/gi,
"");return a=a.replace(/<meta charset=\"utf-8\" \/>/gi,"")},_normalizeFontStyle:function(a){return a.replace(/<(\/)?strong([ \>])/gi,"\x3c$1b$2").replace(/<(\/)?em([ \>])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(a){return a.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(a){if(!a)return!1;
if(u("ie")||u("trident")||u("edge"))return this.focused&&!this.disabled;var b=9>u("ie")?this.document.selection.createRange():this.document;try{return b.queryCommandEnabled(a)}catch(H){return!1}},_createlinkEnabledImpl:function(){var a=!0;return a=u("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var a=!0;return a=u("mozilla")||u("webkit")||u("ie")||u("trident")||u("edge")?
this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var a=!0;return a=u("mozilla")||u("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var a=!0;u("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("cut");return a},_copyEnabledImpl:function(){var a=!0;u("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("copy");
return a},_pasteEnabledImpl:function(){var a=!0;return u("webkit")?!0:a=this._browserQueryCommandEnabled("paste")},_inserthorizontalruleImpl:function(a){return u("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,a)},_unlinkImpl:function(a){return this.queryCommandEnabled("unlink")&&(u("mozilla")||u("webkit"))?(a=this.selection.getAncestorElement("a"),this.selection.selectElement(a),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",
!1,a)},_hilitecolorImpl:function(a){var b;this._handleTextColorOrProperties("hilitecolor",a)||(u("mozilla")?(this.document.execCommand("styleWithCSS",!1,!0),b=this.document.execCommand("hilitecolor",!1,a),this.document.execCommand("styleWithCSS",!1,!1)):b=this.document.execCommand("hilitecolor",!1,a));return b},_backcolorImpl:function(a){u("ie")&&(a=a?a:null);var b=this._handleTextColorOrProperties("backcolor",a);b||(b=this.document.execCommand("backcolor",!1,a));return b},_forecolorImpl:function(a){u("ie")&&
(a=a?a:null);var b=!1;(b=this._handleTextColorOrProperties("forecolor",a))||(b=this.document.execCommand("forecolor",!1,a));return b},_inserthtmlImpl:function(a){a=this._preFilterContent(a);var b=!0;if(9>u("ie")){var c=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var d=c.item(0);c.length;)c.remove(c.item(0));d.outerHTML=a}else c.pasteHTML(a);c.select()}else if(8>u("trident")){var e=E.getSelection(this.window);if(e&&e.rangeCount&&e.getRangeAt){c=
e.getRangeAt(0);c.deleteContents();var f=m.create("div");f.innerHTML=a;for(var g,d=this.document.createDocumentFragment();a=f.firstChild;)g=d.appendChild(a);c.insertNode(d);g&&(c=c.cloneRange(),c.setStartAfter(g),c.collapse(!1),e.removeAllRanges(),e.addRange(c))}}else u("mozilla")&&!a.length?this.selection.remove():b=this.document.execCommand("inserthtml",!1,a);return b},_boldImpl:function(a){var b=!1;if(u("ie")||u("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("bold");b||(b=
this.document.execCommand("bold",!1,a));return b},_italicImpl:function(a){var b=!1;if(u("ie")||u("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("italic");b||(b=this.document.execCommand("italic",!1,a));return b},_underlineImpl:function(a){var b=!1;if(u("ie")||u("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("underline");b||(b=this.document.execCommand("underline",!1,a));return b},_strikethroughImpl:function(a){var b=!1;if(u("ie")||u("trident"))this._adaptIESelection(),
b=this._adaptIEFormatAreaAndExec("strikethrough");b||(b=this.document.execCommand("strikethrough",!1,a));return b},_superscriptImpl:function(a){var b=!1;if(u("ie")||u("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("superscript");b||(b=this.document.execCommand("superscript",!1,a));return b},_subscriptImpl:function(a){var b=!1;if(u("ie")||u("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("subscript");b||(b=this.document.execCommand("subscript",!1,a));return b},
_fontnameImpl:function(a){var b;if(u("ie")||u("trident"))b=this._handleTextColorOrProperties("fontname",a);b||(b=this.document.execCommand("fontname",!1,a));return b},_fontsizeImpl:function(a){var b;if(u("ie")||u("trident"))b=this._handleTextColorOrProperties("fontsize",a);b||(b=this.document.execCommand("fontsize",!1,a));return b},_insertorderedlistImpl:function(a){var b=!1;if(u("ie")||u("trident")||u("edge"))b=this._adaptIEList("insertorderedlist",a);b||(b=this.document.execCommand("insertorderedlist",
!1,a));return b},_insertunorderedlistImpl:function(a){var b=!1;if(u("ie")||u("trident")||u("edge"))b=this._adaptIEList("insertunorderedlist",a);b||(b=this.document.execCommand("insertunorderedlist",!1,a));return b},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(a){var b=0;if(a&&a.childNodes){var c;for(c=0;c<a.childNodes.length;c++)var d=g.position(a.childNodes[c]),
b=b+d.h}return b},_isNodeEmpty:function(a,b){return 1===a.nodeType?0<a.childNodes.length?this._isNodeEmpty(a.childNodes[0],b):!0:3===a.nodeType?""===a.nodeValue.substring(b):!1},_removeStartingRangeFromRange:function(a,b){if(a.nextSibling)b.setStart(a.nextSibling,0);else{for(var c=a.parentNode;c&&null==c.nextSibling;)c=c.parentNode;c&&b.setStart(c.nextSibling,0)}return b},_adaptIESelection:function(){var a=E.getSelection(this.window);if(a&&a.rangeCount&&!a.isCollapsed){for(var b=a.getRangeAt(0),c=
b.startContainer,d=b.startOffset;3===c.nodeType&&d>=c.length&&c.nextSibling;)d-=c.length,c=c.nextSibling;for(var e=null;this._isNodeEmpty(c,d)&&c!==e;)e=c,b=this._removeStartingRangeFromRange(c,b),c=b.startContainer,d=0;a.removeAllRanges();a.addRange(b)}},_adaptIEFormatAreaAndExec:function(a){var b=E.getSelection(this.window),c=this.document,d,e,f,g,l,n,k;if(a&&b&&b.isCollapsed){if(this.queryCommandValue(a)){a=this._tagNamesForCommand(a);f=b.getRangeAt(0);g=f.startContainer;3===g.nodeType&&(e=f.endOffset,
g.length<e&&(e=this._adjustNodeAndOffset(d,e),g=e.node,e=e.offset));for(;g&&g!==this.editNode;){d=g.tagName?g.tagName.toLowerCase():"";if(-1<h.indexOf(a,d)){k=g;break}g=g.parentNode}if(k&&(d=f.startContainer,a=c.createElement(k.tagName),m.place(a,k,"after"),d&&3===d.nodeType)){e=f.endOffset;d.length<e&&(e=this._adjustNodeAndOffset(d,e),d=e.node,e=e.offset);g=d.nodeValue;f=c.createTextNode(g.substring(0,e));var q=g.substring(e,g.length);q&&(l=c.createTextNode(q));m.place(f,d,"before");l&&(n=c.createElement("span"),
n.className="ieFormatBreakerSpan",m.place(n,d,"after"),m.place(l,n,"after"),l=n);m.destroy(d);e=f.parentNode;for(d=[];e!==k;){g=e.tagName;f={tagName:g};d.push(f);g=c.createElement(g);e.style&&g.style&&e.style.cssText&&(g.style.cssText=e.style.cssText,f.cssText=e.style.cssText);"FONT"===e.tagName&&(e.color&&(g.color=e.color,f.color=e.color),e.face&&(g.face=e.face,f.face=e.face),e.size&&(g.size=e.size,f.size=e.size));e.className&&(g.className=e.className,f.className=e.className);if(l)for(;l;)f=l.nextSibling,
g.appendChild(l),l=f;g.tagName==e.tagName?(n=c.createElement("span"),n.className="ieFormatBreakerSpan",m.place(n,e,"after"),m.place(g,n,"after")):m.place(g,e,"after");f=e;l=g;e=e.parentNode}if(l){if(1===l.nodeType||3===l.nodeType&&l.nodeValue)a.innerHTML="";for(;l;)f=l.nextSibling,a.appendChild(l),l=f}if(d.length){f=d.pop();l=c.createElement(f.tagName);f.cssText&&l.style&&(l.style.cssText=f.cssText);f.className&&(l.className=f.className);"FONT"===f.tagName&&(f.color&&(l.color=f.color),f.face&&(l.face=
f.face),f.size&&(l.size=f.size));for(m.place(l,a,"before");d.length;)f=d.pop(),k=c.createElement(f.tagName),f.cssText&&k.style&&(k.style.cssText=f.cssText),f.className&&(k.className=f.className),"FONT"===f.tagName&&(f.color&&(k.color=f.color),f.face&&(k.face=f.face),f.size&&(k.size=f.size)),l.appendChild(k),l=k;k=c.createTextNode(".");n.appendChild(k);l.appendChild(k)}else n=c.createElement("span"),n.className="ieFormatBreakerSpan",k=c.createTextNode("."),n.appendChild(k),m.place(n,a,"before");l=
E.create(this.window);l.setStart(k,0);l.setEnd(k,k.length);b.removeAllRanges();b.addRange(l);this.selection.collapse(!1);k.parentNode.innerHTML="";a.firstChild||m.destroy(a);return!0}return!1}f=b.getRangeAt(0);if((d=f.startContainer)&&3===d.nodeType)return e=f.startOffset,d.length<e&&(e=this._adjustNodeAndOffset(d,e),d=e.node,e=e.offset),g=d.nodeValue,f=c.createTextNode(g.substring(0,e)),q=g.substring(e),""!==q&&(l=c.createTextNode(g.substring(e))),n=c.createElement("span"),k=c.createTextNode("."),
n.appendChild(k),f.length?m.place(f,d,"after"):f=d,m.place(n,f,"after"),l&&m.place(l,n,"after"),m.destroy(d),l=E.create(this.window),l.setStart(k,0),l.setEnd(k,k.length),b.removeAllRanges(),b.addRange(l),c.execCommand(a),m.place(n.firstChild,n,"before"),m.destroy(n),l.setStart(k,0),l.setEnd(k,k.length),b.removeAllRanges(),b.addRange(l),this.selection.collapse(!1),k.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(a){var b=E.getSelection(this.window);if(b.isCollapsed&&b.rangeCount&&
!this.queryCommandValue(a)){var c=b.getRangeAt(0),d=c.startContainer;if(d&&3==d.nodeType&&!c.startOffset)return c="ul","insertorderedlist"===a&&(c="ol"),a=this.document.createElement(c),c=m.create("li",null,a),m.place(a,d,"before"),c.appendChild(d),m.create("br",null,a,"after"),a=E.create(this.window),a.setStart(d,0),a.setEnd(d,d.length),b.removeAllRanges(),b.addRange(a),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(a,b){var c=E.getSelection(this.window),e=this.document,
f,g,l,h,n;b=b||null;if(a&&c&&c.isCollapsed&&c.rangeCount&&(g=c.getRangeAt(0),(f=g.startContainer)&&3===f.nodeType)){n=g.startOffset;f.length<n&&(g=this._adjustNodeAndOffset(f,n),f=g.node,n=g.offset);l=f.nodeValue;g=e.createTextNode(l.substring(0,n));""!==l.substring(n)&&(h=e.createTextNode(l.substring(n)));l=e.createElement("span");n=e.createTextNode(".");l.appendChild(n);e=e.createElement("span");l.appendChild(e);g.length?m.place(g,f,"after"):g=f;m.place(l,g,"after");h&&m.place(h,l,"after");m.destroy(f);
f=E.create(this.window);f.setStart(n,0);f.setEnd(n,n.length);c.removeAllRanges();c.addRange(f);if(u("webkit")){c="color";if("hilitecolor"===a||"backcolor"===a)c="backgroundColor";d.set(l,c,b);this.selection.remove();m.destroy(e);l.innerHTML="\x26#160;";this.selection.selectElement(l);this.focus()}else this.execCommand(a,b),m.place(l.firstChild,l,"before"),m.destroy(l),f.setStart(n,0),f.setEnd(n,n.length),c.removeAllRanges(),c.addRange(f),this.selection.collapse(!1),n.parentNode.removeChild(n);return!0}return!1},
_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3===a.nextSibling.nodeType;)b-=a.length,a=a.nextSibling;return{node:a,offset:b}},_tagNamesForCommand:function(a){return"bold"===a?["b","strong"]:"italic"===a?["i","em"]:"strikethrough"===a?["s","strike"]:"superscript"===a?["sup"]:"subscript"===a?["sub"]:"underline"===a?["u"]:[]},_stripBreakerNodes:function(a){if(this.isLoaded)return r(".ieFormatBreakerSpan",a).forEach(function(a){for(;a.firstChild;)m.place(a.firstChild,a,"before");
m.destroy(a)}),a},_stripTrailingEmptyNodes:function(a){function b(a){return/^(p|div|br)$/i.test(a.nodeName)&&0==a.children.length&&/^[\s\xA0]*$/.test(a.textContent||a.innerText||"")||3===a.nodeType&&/^[\s\xA0]*$/.test(a.nodeValue)}for(;a.lastChild&&b(a.lastChild);)m.destroy(a.lastChild);return a},_setTextDirAttr:function(a){this._set("textDir",a);this.onLoadDeferred.then(q.hitch(this,function(){this.editNode.dir=a}))}});return J})},"dijit/selection":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/sniff dojo/_base/window dijit/focus".split(" "),
function(h,k,a,f,b,e){var l=function(g){var d=g.document;this.getType=function(){if(d.getSelection){var a="text",b;try{b=g.getSelection()}catch(q){}b&&1==b.rangeCount&&(b=b.getRangeAt(0),b.startContainer==b.endContainer&&1==b.endOffset-b.startOffset&&3!=b.startContainer.nodeType&&(a="control"));return a}return d.selection.type.toLowerCase()};this.getSelectedText=function(){if(d.getSelection){var a=g.getSelection();return a?a.toString():""}return"control"==this.getType()?null:d.selection.createRange().text};
this.getSelectedHtml=function(){if(d.getSelection){var a=g.getSelection();if(a&&a.rangeCount){var b,e="";for(b=0;b<a.rangeCount;b++){var f=a.getRangeAt(b).cloneContents(),l=d.createElement("div");l.appendChild(f);e+=l.innerHTML}return e}return null}return"control"==this.getType()?null:d.selection.createRange().htmlText};this.getSelectedElement=function(){if("control"==this.getType()){if(d.getSelection){var a=g.getSelection();return a.anchorNode.childNodes[a.anchorOffset]}if((a=d.selection.createRange())&&
a.item)return d.selection.createRange().item(0)}return null};this.getParentElement=function(){if("control"==this.getType()){var a=this.getSelectedElement();if(a)return a.parentNode}else if(d.getSelection){if(a=d.getSelection()){for(a=a.anchorNode;a&&1!=a.nodeType;)a=a.parentNode;return a}}else return a=d.selection.createRange(),a.collapse(!0),a.parentElement();return null};this.hasAncestorElement=function(a){return null!=this.getAncestorElement.apply(this,arguments)};this.getAncestorElement=function(a){var b=
this.getSelectedElement()||this.getParentElement();return this.getParentOfType(b,arguments)};this.isTag=function(a,b){if(a&&a.tagName)for(var c=a.tagName.toLowerCase(),d=0;d<b.length;d++){var e=String(b[d]).toLowerCase();if(c==e)return e}return""};this.getParentOfType=function(a,b){for(;a;){if(this.isTag(a,b).length)return a;a=a.parentNode}return null};this.collapse=function(a){if(d.getSelection){var b=g.getSelection();b.removeAllRanges?a?b.collapseToStart():b.collapseToEnd():b.collapse(a)}else b=
d.selection.createRange(),b.collapse(a),b.select()};this.remove=function(){var a=d.selection;d.getSelection?(a=g.getSelection(),a.deleteFromDocument()):"none"!=a.type.toLowerCase()&&a.clear();return a};this.selectElementChildren=function(a,b){var c;a=k.byId(a);if(d.getSelection){var e=g.getSelection();f("opera")?(c=e.rangeCount?e.getRangeAt(0):d.createRange(),c.setStart(a,0),c.setEnd(a,3==a.nodeType?a.length:a.childNodes.length),e.addRange(c)):e.selectAllChildren(a)}else if(c=a.ownerDocument.body.createTextRange(),
c.moveToElementText(a),!b)try{c.select()}catch(r){}};this.selectElement=function(a,e){var c;a=k.byId(a);if(d.getSelection){var g=d.getSelection();c=d.createRange();g.removeAllRanges&&(f("opera")&&g.getRangeAt(0)&&(c=g.getRangeAt(0)),c.selectNode(a),g.removeAllRanges(),g.addRange(c))}else try{g=a.tagName?a.tagName.toLowerCase():"",c="img"===g||"table"===g?b.body(d).createControlRange():b.body(d).createRange(),c.addElement(a),e||c.select()}catch(r){this.selectElementChildren(a,e)}};this.inSelection=
function(a){if(a){var b,c;if(d.getSelection){var e=g.getSelection();e&&0<e.rangeCount&&(c=e.getRangeAt(0));if(c&&c.compareBoundaryPoints&&d.createRange)try{if(b=d.createRange(),b.setStart(a,0),1===c.compareBoundaryPoints(c.START_TO_END,b))return!0}catch(r){}}else{c=d.selection.createRange();try{b=a.ownerDocument.body.createTextRange(),b.moveToElementText(a)}catch(r){}if(c&&b&&1===c.compareEndPoints("EndToStart",b))return!0}}return!1};this.getBookmark=function(){var a,b,f=d.selection,l=e.curNode;if(d.getSelection){if(f=
g.getSelection())if(f.isCollapsed){if(a=l?l.tagName:"")if(a=a.toLowerCase(),"textarea"==a||"input"==a&&(!l.type||"text"==l.type.toLowerCase()))return f={start:l.selectionStart,end:l.selectionEnd,node:l,pRange:!0},{isCollapsed:f.end<=f.start,mark:f};a={isCollapsed:!0};f.rangeCount&&(a.mark=f.getRangeAt(0).cloneRange())}else b=f.getRangeAt(0),a={isCollapsed:!1,mark:b.cloneRange()}}else if(f){a=l?l.tagName:"";a=a.toLowerCase();if(l&&a&&("button"==a||"textarea"==a||"input"==a)){if(f.type&&"none"==f.type.toLowerCase())return{isCollapsed:!0,
mark:null};b=f.createRange();return{isCollapsed:b.text&&b.text.length?!1:!0,mark:{range:b,pRange:!0}}}a={};try{b=f.createRange(),a.isCollapsed=!("Text"==f.type?b.htmlText.length:b.length)}catch(r){return a.isCollapsed=!0,a}if("CONTROL"==f.type.toUpperCase())if(b.length)for(a.mark=[],f=0,l=b.length;f<l;)a.mark.push(b.item(f++));else a.isCollapsed=!0,a.mark=null;else a.mark=b.getBookmark()}else console.warn("No idea how to store the current selection for this browser!");return a};this.moveToBookmark=
function(b){if(b=b.mark)if(d.getSelection){var c=g.getSelection();c&&c.removeAllRanges?b.pRange?(c=b.node,c.selectionStart=b.start,c.selectionEnd=b.end):(c.removeAllRanges(),c.addRange(b)):console.warn("No idea how to restore selection for this browser!")}else if(d.selection&&b){var e;b.pRange?e=b.range:a.isArray(b)?(e=d.body.createControlRange(),h.forEach(b,function(a){e.addElement(a)})):(e=d.body.createTextRange(),e.moveToBookmark(b));e.select()}};this.isCollapsed=function(){return this.getBookmark().isCollapsed}},
m=new l(window);m.SelectionManager=l;return m})},"dijit/_editor/range":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang"],function(h,k,a){var f={getIndex:function(a,b){for(var e=[],d=[],c=a,f,l;a!=b;){var h=0;for(f=a.parentNode;l=f.childNodes[h++];)if(l===a){--h;break}e.unshift(h);d.unshift(h-f.childNodes.length);a=f}if(0<e.length&&3==c.nodeType){for(l=c.previousSibling;l&&3==l.nodeType;)e[e.length-1]--,l=l.previousSibling;for(l=c.nextSibling;l&&3==l.nodeType;)d[d.length-
1]++,l=l.nextSibling}return{o:e,r:d}},getNode:function(b,e){if(!a.isArray(b)||0==b.length)return e;var f=e;h.every(b,function(a){if(0<=a&&a<f.childNodes.length)f=f.childNodes[a];else return f=null,!1;return!0});return f},getCommonAncestor:function(a,b,e){e=e||a.ownerDocument.body;var d=function(a){for(var b=[];a;)if(b.unshift(a),a!==e)a=a.parentNode;else break;return b};a=d(a);b=d(b);for(var d=Math.min(a.length,b.length),c=a[0],f=1;f<d;f++)if(a[f]===b[f])c=a[f];else break;return c},getAncestor:function(a,
b,e){for(e=e||a.ownerDocument.body;a&&a!==e;){var d=a.nodeName.toUpperCase();if(b.test(d))return a;a=a.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(a,b,e){e=e||a.ownerDocument.body;b=b||f.BlockTagNames;for(var d=null,c;a&&a!==e;){var g=a.nodeName.toUpperCase();!d&&b.test(g)&&(d=a);!c&&/^(?:BODY|TD|TH|CAPTION)$/.test(g)&&(c=a);a=a.parentNode}return{blockNode:d,blockContainer:c||a.ownerDocument.body}},atBeginningOfContainer:function(a,
b,e){var d=!1,c=0==e;c||3!=b.nodeType||/^[\s\xA0]+$/.test(b.nodeValue.substr(0,e))&&(c=!0);if(c)for(d=!0;b&&b!==a;){if(b.previousSibling){d=!1;break}b=b.parentNode}return d},atEndOfContainer:function(a,b,e){var d=!1,c=e==(b.length||b.childNodes.length);c||3!=b.nodeType||/^[\s\xA0]+$/.test(b.nodeValue.substr(e))&&(c=!0);if(c)for(d=!0;b&&b!==a;){if(b.nextSibling){d=!1;break}b=b.parentNode}return d},adjacentNoneTextNode:function(a,b){for(var e=a,d=0-a.length||0,c=b?"nextSibling":"previousSibling";e&&
3==e.nodeType;)d+=e.length,e=e[c];return[e,d]},create:function(a){a=a||window;return a.getSelection?a.document.createRange():new e},getSelection:function(a,e){if(a.getSelection)return a.getSelection();var f=new b.selection(a);e||f._getCurrentSelection();return f}};if(!window.getSelection)var b=f.ie={cachedSelection:{},selection:function(a){this._ranges=[];this.addRange=function(a,b){this._ranges.push(a);b||a._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=
[];this.rangeCount=0};this.getRangeAt=function(a){return this._ranges[a]};this._getCurrentSelection=function(){this.removeAllRanges();var f;f=a.document.selection.createRange();f="CONTROL"==a.document.selection.type.toUpperCase()?new e(b.decomposeControlRange(f)):new e(b.decomposeTextRange(f));this.addRange(f,!0),this.isCollapsed=f.collapsed}},decomposeControlRange:function(a){var b=a.item(0),e=a.item(a.length-1);a=b.parentNode;var d=e.parentNode,b=f.getIndex(b,a).o[0],e=f.getIndex(e,d).o[0]+1;return[a,
b,d,e]},getEndPoint:function(a,b){var e=a.duplicate();e.collapse(!b);var d="EndTo"+(b?"End":"Start"),c=e.parentElement(),l,m,k;0<c.childNodes.length?h.every(c.childNodes,function(b,g){var h;if(3!=b.nodeType)if(e.moveToElementText(b),0<e.compareEndPoints(d,a))if(k&&3==k.nodeType)l=k,h=!0;else return l=c,m=g,!1;else{if(g==c.childNodes.length-1)return l=c,m=c.childNodes.length,!1}else g==c.childNodes.length-1&&(l=b,h=!0);if(h&&l){l=(h=f.adjacentNoneTextNode(l)[0])?h.nextSibling:c.firstChild;var n=f.adjacentNoneTextNode(l);
h=n[0];n=n[1];h?(e.moveToElementText(h),e.collapse(!1)):e.moveToElementText(c);e.setEndPoint(d,a);m=e.text.length-n;return!1}k=b;return!0}):(l=c,m=0);if(!b&&1==l.nodeType&&m==l.childNodes.length){var r=l.nextSibling;r&&3==r.nodeType&&(l=r,m=0)}return[l,m]},setEndPoint:function(a,b,e){a=a.duplicate();var d;if(3!=b.nodeType)if(0<e){if(d=b.childNodes[e-1])if(3==d.nodeType)b=d,e=d.length;else if(d.nextSibling&&3==d.nextSibling.nodeType)b=d.nextSibling,e=0;else{a.moveToElementText(d.nextSibling?d:b);var c=
d.parentNode;d=c.insertBefore(d.ownerDocument.createTextNode(" "),d.nextSibling);a.collapse(!1);c.removeChild(d)}}else a.moveToElementText(b),a.collapse(!0);3==b.nodeType&&(d=f.adjacentNoneTextNode(b),c=d[0],d=d[1],c?(a.moveToElementText(c),a.collapse(!1),"inherit"!=c.contentEditable&&d++):(a.moveToElementText(b.parentNode),a.collapse(!0),a.move("character",1),a.move("character",-1)),e+=d,0<e&&a.move("character",e)!=e&&console.error("Error when moving!"));return a},decomposeTextRange:function(a){var e=
b.getEndPoint(a),f=e[0],d=e[1],c=e[0],e=e[1];a.htmlText.length&&(a.htmlText==a.text?e=d+a.text.length:(e=b.getEndPoint(a,!0),c=e[0],e=e[1]));return[f,d,c,e]},setRange:function(a,e,f,d,c,h){e=b.setEndPoint(a,e,f);a.setEndPoint("StartToStart",e);if(!h)var g=b.setEndPoint(a,d,c);a.setEndPoint("EndToEnd",g||e);return a}},e=f.W3CRange=k(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=
null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=this.startContainer!==this.endContainer?f.getCommonAncestor(this.startContainer,this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(a,b){b=parseInt(b);if(this.startContainer!==a||this.startOffset!=b)delete this._cachedBookmark,this.startContainer=a,this.startOffset=
b,this.endContainer?this._updateInternal():this.setEnd(a,b)},setEnd:function(a,b){b=parseInt(b);if(this.endContainer!==a||this.endOffset!=b)delete this._cachedBookmark,this.endContainer=a,this.endOffset=b,this.startContainer?this._updateInternal():this.setStart(a,b)},setStartAfter:function(a,b){this._setPoint("setStart",a,b,1)},setStartBefore:function(a,b){this._setPoint("setStart",a,b,0)},setEndAfter:function(a,b){this._setPoint("setEnd",a,b,1)},setEndBefore:function(a,b){this._setPoint("setEnd",
a,b,0)},_setPoint:function(a,b,e,d){e=f.getIndex(b,b.parentNode).o;this[a](b.parentNode,e.pop()+d)},_getIERange:function(){var a=(this._body||this.endContainer.ownerDocument.body).createTextRange();b.setRange(a,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return a},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var a=this.startContainer,b=this._getIERange();3!==
a.nodeType||this.startOffset||this.setStartBefore(a);b.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var a=new e([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);a._body=this._body;return a},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});a.setObject("dijit.range",f);return f})},"dijit/_editor/html":function(){define(["dojo/_base/array",
"dojo/_base/lang","dojo/sniff"],function(h,k,a){var f={};k.setObject("dijit._editor.html",f);var b=f.escapeXml=function(a,b){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");b||(a=a.replace(/'/gm,"\x26#39;"));return a};f.getNodeHtml=function(a){var b=[];f.getNodeHtmlHelper(a,b);return b.join("")};f.getNodeHtmlHelper=function(e,l){switch(e.nodeType){case 1:var m=e.nodeName.toLowerCase();if(!m||"/"==m.charAt(0))return"";l.push("\x3c",m);var g=
[],d={},c;if(a("dom-attributes-explicit")||a("dom-attributes-specified-flag"))for(var n=0;c=e.attributes[n++];){var k=c.name;"_dj"===k.substr(0,3)||a("dom-attributes-specified-flag")&&!c.specified||k in d||(c=c.value,("src"==k||"href"==k)&&e.getAttribute("_djrealurl")&&(c=e.getAttribute("_djrealurl")),8===a("ie")&&"style"===k&&(c=c.replace("HEIGHT:","height:").replace("WIDTH:","width:")),g.push([k,c]),d[k]=c)}else{var t=(/^input$|^img$/i.test(e.nodeName)?e:e.cloneNode(!1)).outerHTML,d=t.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi),
t=t.substr(0,t.indexOf("\x3e"));h.forEach(d,function(a){if(a){var b=a.indexOf("\x3d");if(0<b&&(a=a.substring(0,b),"_dj"!=a.substr(0,3)))if("src"!=a&&"href"!=a||!e.getAttribute("_djrealurl")){var c;switch(a){case "style":c=e.style.cssText.toLowerCase();break;case "class":c=e.className;break;case "width":if("img"===m){(b=/width=(\S+)/i.exec(t))&&(c=b[1]);break}case "height":if("img"===m){(b=/height=(\S+)/i.exec(t))&&(c=b[1]);break}default:c=e.getAttribute(a)}null!=c&&g.push([a,c.toString()])}else g.push([a,
e.getAttribute("_djrealurl")])}},this)}g.sort(function(a,b){return a[0]<b[0]?-1:a[0]==b[0]?0:1});for(d=0;c=g[d++];)l.push(" ",c[0],'\x3d"',"string"===typeof c[1]?b(c[1],!0):c[1],'"');switch(m){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":l.push(" /\x3e");break;case "script":l.push("\x3e",e.innerHTML,"\x3c/",m,"\x3e");break;default:l.push("\x3e"),e.hasChildNodes()&&f.getChildrenHtmlHelper(e,l),l.push("\x3c/",m,"\x3e")}break;case 4:case 3:l.push(b(e.nodeValue,
!0));break;case 8:l.push("\x3c!--",b(e.nodeValue,!0),"--\x3e");break;default:l.push("\x3c!-- Element not recognized - Type: ",e.nodeType," Name: ",e.nodeName,"--\x3e")}};f.getChildrenHtml=function(a){var b=[];f.getChildrenHtmlHelper(a,b);return b.join("")};f.getChildrenHtmlHelper=function(b,l){if(b)for(var e=b.childNodes||b,g=!a("ie")||e!==b,d,c=0;d=e[c++];)g&&d.parentNode!=b||f.getNodeHtmlHelper(d,l)};return f})},"dijit/_editor/nls/commands":function(){define({root:{bold:"Bold",copy:"Copy",cut:"Cut",
"delete":"Delete",indent:"Indent",insertHorizontalRule:"Horizontal Rule",insertOrderedList:"Numbered List",insertUnorderedList:"Bullet List",italic:"Italic",justifyCenter:"Align Center",justifyFull:"Justify",justifyLeft:"Align Left",justifyRight:"Align Right",outdent:"Outdent",paste:"Paste",redo:"Redo",removeFormat:"Remove Format",selectAll:"Select All",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",underline:"Underline",undo:"Undo",unlink:"Remove Link",createLink:"Create Link",
toggleDir:"Toggle Direction",insertImage:"Insert Image",insertTable:"Insert/Edit Table",toggleTableBorder:"Toggle Table Border",deleteTable:"Delete Table",tableProp:"Table Property",htmlToggle:"HTML Source",foreColor:"Foreground Color",hiliteColor:"Background Color",plainFormatBlock:"Paragraph Style",formatBlock:"Paragraph Style",fontSize:"Font Size",fontName:"Font Name",tabIndent:"Tab Indent",fullScreen:"Toggle Full Screen",viewSource:"View HTML Source",print:"Print",newPage:"New Page",systemShortcut:'The "${0}" action is only available in your browser using a keyboard shortcut. Use ${1}.',
ctrlKey:"ctrl+${0}",appleKey:"\u2318${0}"},bs:!0,mk:!0,sr:!0,zh:!0,"zh-tw":!0,vi:!0,uk:!0,tr:!0,th:!0,sv:!0,sl:!0,sk:!0,ru:!0,ro:!0,pt:!0,"pt-pt":!0,pl:!0,nl:!0,nb:!0,lv:!0,lt:!0,ko:!0,kk:!0,ja:!0,it:!0,id:!0,hu:!0,hr:!0,hi:!0,he:!0,fr:!0,fi:!0,eu:!0,et:!0,es:!0,el:!0,de:!0,da:!0,cs:!0,ca:!0,bg:!0,az:!0,ar:!0})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n){var q=k("dijit._editor.plugins.LinkDialog",d,{buttonClass:c,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=b.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(a){h("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),b.hitch(this,function(c,d,l){var h=this;this.tag="insertImage"==this.command?"img":"a";c=b.delegate(c.getLocalization("dijit","common",this.lang),c.getLocalization("dijit._editor",
"LinkDialog",this.lang));var m=this.dropDown=this.button.dropDown=new d({title:c[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:b.hitch(this,"setValue"),onOpen:function(){h._onOpenDialog();d.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(b.hitch(h,"_onCloseDialog"),0)}});c.urlRegExp=this.urlRegExp;c.id=l.getUniqueId(this.editor.id);this._uniqueId=c.id;this._setContent(m.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
g.substitute(this.linkDialogTemplate,c));m.startup();this._urlInput=l.byId(this._uniqueId+"_urlInput");this._textInput=l.byId(this._uniqueId+"_textInput");this._setButton=l.byId(this._uniqueId+"_setButton");this.own(l.byId(this._uniqueId+"_cancelButton").on("click",b.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",b.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",b.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=b.hitch(this,function(){var a=this._urlInput.get("value");return this._urlRegExp.test(a)||this._emailRegExp.test(a)});this.own(e(m.domNode,"keydown",b.hitch(this,b.hitch(this,function(a){!a||a.keyCode!=f.ENTER||a.shiftKey||a.metaKey||a.ctrlKey||a.altKey||this._setButton.get("disabled")||(m.onExecute(),m.execute(m.get("value")))}))));a()}))},_checkAndFixInput:function(){var a=this,c=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var d=c,e=!1,f=!1;d&&1<d.length&&(d=b.trim(d),0!==d.indexOf("mailto:")&&(0<d.indexOf("/")?-1===d.indexOf("://")&&"/"!==d.charAt(0)&&d.indexOf("./")&&0!==d.indexOf("../")&&a._hostRxp.test(d)&&(e=!0):a._userAtRxp.test(d)&&(f=!0)));e&&a._urlInput.set("value","http://"+d);f&&a._urlInput.set("value","mailto:"+d);a._setButton.set("disabled",!a._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(b.hitch(this,
function(){this.own(e(this.editor.editNode,"dblclick",b.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(a){this.dropDown.set({parserScope:"dojo",content:a})},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));return a},setValue:function(b){this._onCloseDialog();if(9>l("ie")){var c=n.getSelection(this.editor.window).getRangeAt(0).endContainer;3===c.nodeType&&(c=c.parentNode);
c&&c.nodeName&&c.nodeName.toLowerCase()!==this.tag&&(c=this.editor.selection.getSelectedElement(this.tag));c&&c.nodeName&&c.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(c),this.editor.execCommand("unlink"))}b=this._checkValues(b);this.editor.execCommand("inserthtml",g.substitute(this.htmlTemplate,b));m("a",this.editor.document).forEach(function(b){b.innerHTML||a.has(b,"name")||b.parentNode.removeChild(b)},this)},_onCloseDialog:function(){this.editor.focused&&
this.editor.focus()},_getCurrentValues:function(a){var b,c,d;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("href"),d=a.getAttribute("target")||"_self",c=a.textContent||a.innerText,this.editor.selection.selectElement(a,!0)):c=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:c||"",targetSelect:d||""}},_onOpenDialog:function(){var a,b;if(l("ie")){if(b=n.getSelection(this.editor.window),b.rangeCount){var c=b.getRangeAt(0);a=c.endContainer;
3===a.nodeType&&(a=a.parentNode);a&&a.nodeName&&a.nodeName.toLowerCase()!==this.tag&&(a=this.editor.selection.getSelectedElement(this.tag));if(!a||a.nodeName&&a.nodeName.toLowerCase()!==this.tag)(b=this.editor.selection.getAncestorElement(this.tag))&&b.nodeName&&b.nodeName.toLowerCase()==this.tag?(a=b,this.editor.selection.selectElement(a)):c.startContainer===c.endContainer&&(b=c.startContainer.firstChild)&&b.nodeName&&b.nodeName.toLowerCase()==this.tag&&(a=b,this.editor.selection.selectElement(a))}}else a=
this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(a))},_onDblClick:function(b){if(b&&b.target&&(b=b.target,(b.tagName?b.tagName.toLowerCase():"")===this.tag&&a.get(b,"href"))){var c=this.editor;this.editor.selection.selectElement(b);c.onDisplayChanged();c._updateTimer&&(c._updateTimer.remove(),delete c._updateTimer);c.onNormalizedDisplayChanged();var d=this.button;setTimeout(function(){d.set("disabled",
!1);d.loadAndOpenDropDown().then(function(){d.dropDown.focus&&d.dropDown.focus()})},10)}}}),t=k("dijit._editor.plugins.ImgLinkDialog",[q],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(a){var b,c;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("src"),c=a.getAttribute("alt"),this.editor.selection.selectElement(a,!0)):c=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:c||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(b.hitch(this,
function(){this.own(e(this.editor.editNode,"mousedown",b.hitch(this,"_selectTag")))}))},_selectTag:function(a){a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(a))},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));a&&a.textInput&&(a.textInput=a.textInput.replace(/"/g,"\x26quot;"));return a},_onDblClick:function(b){if(b&&b.target&&(b=b.target,(b.tagName?b.tagName.toLowerCase():"")===this.tag&&a.get(b,
"src"))){var c=this.editor;this.editor.selection.selectElement(b);c.onDisplayChanged();c._updateTimer&&(c._updateTimer.remove(),delete c._updateTimer);c.onNormalizedDisplayChanged();var d=this.button;setTimeout(function(){d.set("disabled",!1);d.loadAndOpenDropDown().then(function(){d.dropDown.focus&&d.dropDown.focus()})},10)}}});d.registry.createLink=function(){return new q({command:"createLink"})};d.registry.insertImage=function(){return new t({command:"insertImage"})};q.ImgLinkDialog=t;return q})},
"dijit/form/DropDownButton":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/query ../registry ../popup ./Button ../_Container ../_HasDropDown dojo/text!./templates/DropDownButton.html ../a11yclick".split(" "),function(h,k,a,f,b,e,l,m,g,d){return h("dijit.form.DropDownButton",[l,m,g],{baseClass:"dijitDropDownButton",templateString:d,_fillContent:function(){var a=this.srcNodeRef,b=this.containerNode;if(a&&b)for(;a.hasChildNodes();){var d=a.firstChild;d.hasAttribute&&(d.hasAttribute("data-dojo-type")||
d.hasAttribute("dojoType")||d.hasAttribute("data-"+k._scopeName+"-type")||d.hasAttribute(k._scopeName+"Type"))?(this.dropDownContainer=this.ownerDocument.createElement("div"),this.dropDownContainer.appendChild(d)):b.appendChild(d)}},startup:function(){this._started||(!this.dropDown&&this.dropDownContainer&&(this.dropDown=b.byNode(this.dropDownContainer.firstChild),delete this.dropDownContainer),this.dropDown&&e.hide(this.dropDown),this.inherited(arguments))},isLoaded:function(){var a=this.dropDown;
return!!a&&(!a.href||a.isLoaded)},loadDropDown:function(b){var c=this.dropDown,d=c.on("load",a.hitch(this,function(){d.remove();b()}));c.refresh()},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown}})})},"dijit/_HasDropDown":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on dojo/touch ./registry ./focus ./popup ./_FocusMixin".split(" "),function(h,k,a,f,
b,e,l,m,g,d,c,n,q,t,r,v){return h("dijit._HasDropDown",v,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:!0,forceWidth:!1,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:!0,_onDropDownMouseDown:function(a){this.disabled||this.readOnly||("MSPointerDown"!=a.type&&"pointerdown"!=a.type&&a.preventDefault(),this.own(c.once(this.ownerDocument,n.release,d.hitch(this,"_onDropDownMouseUp"))),this.toggleDropDown())},_onDropDownMouseUp:function(a){var c=
this.dropDown,d=!1;if(a&&this._opened){var f=e.position(this._buttonNode,!0);if(!(a.pageX>=f.x&&a.pageX<=f.x+f.w&&a.pageY>=f.y&&a.pageY<=f.y+f.h)){for(f=a.target;f&&!d;)b.contains(f,"dijitPopup")?d=!0:f=f.parentNode;if(d){f=a.target;if(c.onItemClick){for(var g;f&&!(g=q.byNode(f));)f=f.parentNode;if(g&&g.onClick&&g.getParent)g.getParent().onItemClick(g,a)}return}}}this._opened?c.focus&&(!1!==c.autoFocus||"mouseup"==a.type&&!this.hovering)&&(this._focusDropDownTimer=this.defer(function(){c.focus();
delete this._focusDropDownTimer})):this.focus&&this.defer("focus")},_onDropDownClick:function(a){this._stopClickEvents&&(a.stopPropagation(),a.preventDefault())},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var a={after:this.isLeftToRight()?"Right":"Left",before:this.isLeftToRight()?"Left":"Right",above:"Up",below:"Down",left:"Left",right:"Right"}[this.dropDownPosition[0]]||
this.dropDownPosition[0]||"Down";b.add(this._arrowWrapperNode||this._buttonNode,"dijit"+a+"ArrowButton")},postCreate:function(){this.inherited(arguments);var a=this.focusNode||this.domNode;this.own(c(this._buttonNode,n.press,d.hitch(this,"_onDropDownMouseDown")),c(this._buttonNode,"click",d.hitch(this,"_onDropDownClick")),c(a,"keydown",d.hitch(this,"_onKey")),c(a,"keyup",d.hitch(this,"_onKeyUp")))},destroy:function(){this._opened&&this.closeDropDown(!0);this.dropDown&&(this.dropDown._destroyed||this.dropDown.destroyRecursive(),
delete this.dropDown);this.inherited(arguments)},_onKey:function(a){if(!this.disabled&&!this.readOnly){var b=this.dropDown,c=a.target;b&&this._opened&&b.handleKey&&!1===b.handleKey(a)?(a.stopPropagation(),a.preventDefault()):b&&this._opened&&a.keyCode==g.ESCAPE?(this.closeDropDown(),a.stopPropagation(),a.preventDefault()):!this._opened&&(a.keyCode==g.DOWN_ARROW||(a.keyCode==g.ENTER||a.keyCode==g.SPACE&&(!this._searchTimer||a.ctrlKey||a.altKey||a.metaKey))&&("input"!==(c.tagName||"").toLowerCase()||
c.type&&"text"!==c.type.toLowerCase()))&&(this._toggleOnKeyUp=!0,a.stopPropagation(),a.preventDefault())}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var a=this.dropDown;a&&a.focus&&this.defer(d.hitch(a,"focus"),1)}},_onBlur:function(){this.closeDropDown(!1);this.inherited(arguments)},isLoaded:function(){return!0},loadDropDown:function(a){a()},loadAndOpenDropDown:function(){var a=new k,b=d.hitch(this,function(){this.openDropDown();a.resolve(this.dropDown)});
this.isLoaded()?b():this.loadDropDown(b);return a},toggleDropDown:function(){this.disabled||this.readOnly||(this._opened?this.closeDropDown(!0):this.loadAndOpenDropDown())},openDropDown:function(){var a=this.dropDown,c=a.domNode,g=this._aroundNode||this.domNode,l=this,h=r.open({parent:this,popup:a,around:g,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){l.closeDropDown(!0)},onCancel:function(){l.closeDropDown(!0)},onClose:function(){f.set(l._popupStateNode,"popupActive",
!1);b.remove(l._popupStateNode,"dijitHasDropDownOpen");l._set("_opened",!1)}});if(this.forceWidth||this.autoWidth&&g.offsetWidth>a._popupWrapper.offsetWidth){var g=g.offsetWidth-a._popupWrapper.offsetWidth,m={w:a.domNode.offsetWidth+g};this._origStyle=c.style.cssText;d.isFunction(a.resize)?a.resize(m):e.setMarginBox(c,m);"R"==h.corner[1]&&(a._popupWrapper.style.left=a._popupWrapper.style.left.replace("px","")-g+"px")}f.set(this._popupStateNode,"popupActive","true");b.add(this._popupStateNode,"dijitHasDropDownOpen");
this._set("_opened",!0);this._popupStateNode.setAttribute("aria-expanded","true");this._popupStateNode.setAttribute("aria-owns",a.id);"presentation"===c.getAttribute("role")||c.getAttribute("aria-labelledby")||c.setAttribute("aria-labelledby",this.id);return h},closeDropDown:function(a){this._focusDropDownTimer&&(this._focusDropDownTimer.remove(),delete this._focusDropDownTimer);this._opened&&(this._popupStateNode.setAttribute("aria-expanded","false"),a&&this.focus&&this.focus(),r.close(this.dropDown),
this._opened=!1);this._origStyle&&(this.dropDown.domNode.style.cssText=this._origStyle,delete this._origStyle)}})})},"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),function(h,k,a,f,b,e){var l=a("dijit._editor.plugins.TextColor",b,{buttonClass:e,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var a=this;this.button.loadDropDown=
function(b){function d(c){a.button.dropDown=new c({dir:a.editor.dir,ownerDocument:a.editor.ownerDocument,value:a.value,onChange:function(b){a.editor.execCommand(a.command,b)},onExecute:function(){a.editor.execCommand(a.command,this.get("value"))}});b()}"string"==typeof a.colorPicker?h([a.colorPicker],d):d(a.colorPicker)}},updateState:function(){var a=this.editor,b=this.command;if(a&&a.isLoaded&&b.length){if(this.button){var d=this.get("disabled");this.button.set("disabled",d);if(d)return;var c;try{c=
a.queryCommandValue(b)||""}catch(n){c=""}}""==c&&(c="#000000");"transparent"==c&&(c="#ffffff");"string"==typeof c?-1<c.indexOf("rgb")&&(c=k.fromRgb(c).toHex()):(c=((c&255)<<16|c&65280|(c&16711680)>>>16).toString(16),c="#000000".slice(0,7-c.length)+c);this.value=c;(a=this.button.dropDown)&&a.get&&c!==a.get("value")&&a.set("value",c,!1)}}});b.registry.foreColor=function(a){return new l(a)};b.registry.hiliteColor=function(a){return new l(a)};return l})},"dojo/colors":function(){define(["./_base/kernel",
"./_base/lang","./_base/Color","./_base/array"],function(h,k,a,f){var b={};k.setObject("dojo.colors",b);var e=function(a,b,d){0>d&&++d;1<d&&--d;var c=6*d;return 1>c?a+(b-a)*c:1>2*d?b:2>3*d?a+(b-a)*(2/3-d)*6:a};h.colorFromRgb=a.fromRgb=function(b,g){var d=b.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(d){var c=d[2].split(/\s*,\s*/),l=c.length,d=d[1];if("rgb"==d&&3==l||"rgba"==d&&4==l)return d=c[0],"%"==d.charAt(d.length-1)?(d=f.map(c,function(a){return 2.56*parseFloat(a)}),4==l&&(d[3]=
c[3]),a.fromArray(d,g)):a.fromArray(c,g);if("hsl"==d&&3==l||"hsla"==d&&4==l){var d=(parseFloat(c[0])%360+360)%360/360,h=parseFloat(c[1])/100,m=parseFloat(c[2])/100,h=.5>=m?m*(h+1):m+h-m*h,m=2*m-h,d=[256*e(m,h,d+1/3),256*e(m,h,d),256*e(m,h,d-1/3),1];4==l&&(d[3]=c[3]);return a.fromArray(d,g)}}return null};var l=function(a,b,d){a=Number(a);return isNaN(a)?d:a<b?b:a>d?d:a};a.prototype.sanitize=function(){this.r=Math.round(l(this.r,0,255));this.g=Math.round(l(this.g,0,255));this.b=Math.round(l(this.b,
0,255));this.a=l(this.a,0,1);return this};b.makeGrey=a.makeGrey=function(b,e){return a.fromArray([b,b,b,e])};k.mixin(a.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,
20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,
191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,
205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,
0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,
238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],
tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return a})},"esri/dijit/editing/AttachmentEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/io-query dojo/dom-attr dijit/_Widget dijit/_Templated dijit/ProgressBar ../../kernel ../../lang ../../domUtils dojo/text!./templates/AttachmentEditor.html dojo/i18n!../../nls/jsapi dojo/NodeList-dom".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u){h=h([d,c],{declaredClass:"esri.dijit.editing.AttachmentEditor",widgetsInTemplate:!0,templateString:v,_listHtml:"\x3cspan id\x3d'node_${oid}_${attid}'\x3e\x3ca href\x3d'${href}' target\x3d'_blank'\x3e${name}\x3c/a\x3e",_deleteBtnHtml:"(\x3cspan style\x3d'cursor:pointer;color:red;font-weight:bold;' class\x3d'deleteAttachment' id\x3d'${attid}');'\x3eX\x3c/span\x3e)",_endHtml:"\x3cbr/\x3e\x3c/span\x3e",_aeConnects:[],_layerEditingCapChecked:{},_layerEditingCap:{},
constructor:function(a,b){k.mixin(this,u.widgets.attachmentEditor)},startup:function(){this.inherited(arguments);this._uploadField_connect=a.connect(this._uploadField,"onchange",this,function(){0<this._uploadField.value.length&&this._addAttachment()});this._uploadFieldFocus_connect=a.connect(this._uploadField,"onfocus",k.hitch(this,function(a){r.hide(this._attachmentError)}))},destroy:function(){f.forEach(this._aeConnects,a.disconnect);a.disconnect(this._uploadField_connect);a.disconnect(this._uploadFieldFocus_connect);
this.inherited(arguments)},showAttachments:function(a,b){if(this._attachmentList.innerHTML=this.NLS_none,this._uploadField.value="",f.forEach(this.domNode.children,function(a,b){r.show(a)}),r.hide(this._attachmentError),a&&(this._featureLayer=a.getLayer()||b,this._featureLayer)){if("esri.layers.FeatureLayer"!==this._featureLayer.declaredClass||!this._featureLayer.getEditCapabilities)return b&&b.getEditCapabilities()?void 0:(r.hide(this._uploadForm),void f.forEach(this.domNode.children,function(a,
b){r.hide(a)}));this._currentLayerId=this._featureLayer.id;this._layerEditingCapChecked[this._currentLayerId]||(this._layerEditingCap[this._currentLayerId]=this._featureLayer.getEditCapabilities(),this._layerEditingCapChecked[this._currentLayerId]=!0);this._featureCanUpdate=this._featureLayer.getEditCapabilities({feature:a}).canUpdate;this._oid=a.attributes[this._featureLayer.objectIdField];this._getAttachments(a)}},_getAttachments:function(a){this._featureLayer&&this._featureLayer.queryAttachmentInfos&&
this._featureLayer.queryAttachmentInfos(this._oid,k.hitch(this,"_onQueryAttachmentInfosComplete"))},_addAttachment:function(){r.hide(this._attachmentError);this._featureLayer&&this._featureLayer.addAttachment?(r.show(this._attachmentProgress),this._featureLayer.addAttachment(this._oid,this._uploadForm,k.hitch(this,"_onAddAttachmentComplete"),k.hitch(this,"_onAddAttachmentError"))):this._tempUpload=this._uploadForm},_chainAttachment:function(a,b){this._tempUpload&&(r.show(this._attachmentProgress),
b.addAttachment(a,this._tempUpload,k.hitch(this,"_onAddAttachmentComplete"),k.hitch(this,"_onAddAttachmentError")));this._tempUpload=null},_deleteAttachment:function(a,b){r.show(this._attachmentProgress);this._featureLayer.deleteAttachments(a,[b],k.hitch(this,"_onDeleteAttachmentComplete"))},_onQueryAttachmentInfosComplete:function(a){var b=this._listHtml+this._deleteBtnHtml+this._endHtml;this._uploadForm.style.display="block";!this._featureCanUpdate&&this._layerEditingCap[this._currentLayerId].canUpdate||
!this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate?(b=this._listHtml+this._endHtml,this._uploadForm.style.display="none"):this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(b=this._listHtml+this._endHtml);var c=this._attachmentList;a=f.map(a,k.hitch(this,function(a){return t.substitute({href:a.url,name:a.name,oid:a.objectId,attid:a.id},b)}));c.innerHTML=a.join("")||this.NLS_none;
this._updateConnects()},_onAddAttachmentComplete:function(a){r.hide(this._attachmentProgress.domNode);var b=this._attachmentList,c=this._uploadField,d=c.value,e=d.lastIndexOf("\\");-1<e&&(d=d.substring(e+1,d.length));var d=d.replace(/\ /g,"_"),e=m.objectToQuery({gdbVersion:this._featureLayer.gdbVersion,token:this._featureLayer._getToken()}),f=this._listHtml+this._deleteBtnHtml+this._endHtml;this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&
(f=this._listHtml+this._endHtml);a=t.substitute({href:this._featureLayer._url.path+"/"+a.objectId+"/attachments/"+a.attachmentId+(e?"?"+e:""),name:d,oid:a.objectId,attid:a.attachmentId},f);b.innerHTML=b.innerHTML==this.NLS_none?a:b.innerHTML+a;this._updateConnects();c.value=""},_onAddAttachmentError:function(a){if(r.hide(this._attachmentProgress.domNode),a&&t.isDefined(a.code)){var b=this._attachmentError;g.set(b,"innerHTML",(400===a.code?this.NLS_fileNotSupported:a.message||a.details&&a.details.length&&
a.details[0])||this.NLS_error);r.show(b)}},_onDeleteAttachmentComplete:function(a){r.hide(this._attachmentProgress.domNode);var c=this._attachmentList;f.every(a,function(a){return a.success})&&(b.query("#node_"+a[0].objectId+"_"+a[0].attachmentId).orphan(),c.children&&c.children.length||(c.innerHTML=this.NLS_none))},_updateConnects:function(){f.forEach(this._aeConnects,a.disconnect);b.query(".deleteAttachment").forEach(function(b){this._aeConnects.push(a.connect(b,"onclick",k.hitch(this,"_deleteAttachment",
this._oid,b.id)))},this)}});return e("extend-esri")&&k.setObject("dijit.editing.AttachmentEditor",h,q),h})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),function(h,k,a,f,b,e,l,m){return k("dijit.ProgressBar",[e,l],{progress:"0",value:"",maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:m,_indeterminateHighContrastImagePath:h.toUrl("./themes/a11y/indeterminate_progress.gif"),
postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update()},_setDirAttr:function(b){var d="rtl"==b.toLowerCase();a.toggle(this.domNode,"dijitProgressBarRtl",d);a.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&
d);this.inherited(arguments)},update:function(b){f.mixin(this,b||{});b=this.internalProgress;var d=this.domNode,c=1;this.indeterminate?d.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(c=Math.min(parseFloat(this.progress)/100,1),this.progress=c*this.maximum):(this.progress=Math.min(this.progress,this.maximum),c=this.maximum?this.progress/this.maximum:0),d.setAttribute("aria-valuenow",this.progress));d.setAttribute("aria-labelledby",this.labelNode.id);d.setAttribute("aria-valuemin",
0);d.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(c);a.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);a.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());b.style.width=100*c+"%";this.onChange()},_setValueAttr:function(a){this._set("value",a);Infinity==a?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:a})},_setLabelAttr:function(a){this._set("label",a);this.update()},_setIndeterminateAttr:function(a){this._set("indeterminate",
a);this.update()},report:function(a){return this.label?this.label:this.indeterminate?"\x26#160;":b.format(a,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"esri/dijit/editing/Util":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../../kernel"],function(h,k,a,f){var b={};return b={findFeatures:function(a,b,f){var e=b.objectIdField;b=k.filter(b.graphics,function(b){return k.some(a,function(a){return b.attributes[e]===a.objectId})});return f?void f(b):
b},getSelection:function(a){var b=[];return k.forEach(a,function(a){a=a.getSelectedFeatures();k.forEach(a,function(a){b.push(a)})}),b}},a("extend-esri")&&h.setObject("dijit.editing.Util.LayerHelper",b,f),b})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(h,k,a){return h("dijit.form.DateTextBox",a,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:k,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u){var w=f("dijit.Calendar",[q,t,r],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){m.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new w._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:d.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(c(this.domNode,"keydown",d.hitch(this,"_onKeyDown")),c(this.dateRowsNode,"mouseover",d.hitch(this,"_onDayMouseOver")),c(this.dateRowsNode,"mouseout",d.hitch(this,"_onDayMouseOut")),c(this.dateRowsNode,"mousedown",d.hitch(this,"_onDayMouseDown")),c(this.dateRowsNode,"mouseup",d.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=
new this.dateClassObj(this.currentFocus);b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var c=this.currentFocus.getDate();b.setDate(Math.min(c,a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){(a=e.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!e.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode)&&(e.add(a,"dijitCalendarHoveredDate"),this._currentNode=a)},_onDayMouseOut:function(a){!this._currentNode||
a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode||(a="dijitCalendarHoveredDate",e.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),e.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&!e.contains(a,"dijitCalendarDisabledDate")&&(e.add(a,"dijitCalendarActiveDate"),this._currentNode=a)},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&e.remove(a,"dijitCalendarActiveDate")},
handleKey:function(a){var b=-1,c,d=this.currentFocus;switch(a.keyCode){case g.RIGHT_ARROW:b=1;case g.LEFT_ARROW:c="day";this.isLeftToRight()||(b*=-1);break;case g.DOWN_ARROW:b=1;case g.UP_ARROW:c="week";break;case g.PAGE_DOWN:b=1;case g.PAGE_UP:c=a.ctrlKey||a.altKey?"year":"month";break;case g.END:d=this.dateModule.add(d,"month",1),c="day";case g.HOME:d=new this.dateClassObj(d);d.setDate(1);break;default:return!0}c&&(d=this.dateModule.add(d,c,b));this._setCurrentFocusAttr(d);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});w._MonthDropDownButton=f("dijit.Calendar._MonthDropDownButton",u,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new w._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.dropDown.set("months",
b);this.containerNode.innerHTML=(6==n("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});w._MonthDropDown=f("dijit.Calendar._MonthDropDown",[t,v,r],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";h.forEach(a,function(a,b){l.create("div",{className:"dijitCalendarMonthLabel",month:b,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(b.get(a.target,"month"))},onChange:function(){}});return w})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/dom-attr dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v){var u=k("dijit.CalendarLite",[t,r],{templateString:v,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",dayOffset:-1,currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=
new this.dateClassObj(a);b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=e.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){if(a||
0===a)a=new this.dateClassObj(a),a.setHours(1,0,0,0);return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var c=new this.dateClassObj(this.currentFocus);c.setDate(1);var c=this._patchDate(c),d=c.getDay(),e=this.dateModule.getDaysInMonth(c),f=this.dateModule.getDaysInMonth(this.dateModule.add(c,"month",-1)),l=new this.dateClassObj,m=0<=this.dayOffset?this.dayOffset:a.getFirstDayOfWeek(this.lang);m>
d&&(m-=7);if(!this.summary){var n=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,c);this.gridNode.setAttribute("summary",n[c.getMonth()])}this._date2cell={};h.forEach(this.dateCells,function(a,h){var n=h+m,k=new this.dateClassObj(c),q="dijitCalendar",r=0;n<d?(n=f-d+n+1,r=-1,q+="Previous"):n>=d+e?(n=n-d-e+1,r=1,q+="Next"):(n=n-d+1,q+="Current");r&&(k=this.dateModule.add(k,"month",r));k.setDate(n);this.dateModule.compare(k,l,"date")||(q="dijitCalendarCurrentDate "+q);this.isDisabledDate(k,
this.lang)?(q="dijitCalendarDisabledDate "+q,a.setAttribute("aria-disabled","true")):(q="dijitCalendarEnabledDate "+q,a.removeAttribute("aria-disabled"),a.setAttribute("aria-selected","false"));(r=this.getClassForDate(k,this.lang))&&(q=r+" "+q);a.className=q+"Month dijitCalendarDateTemplate";q=k.valueOf();this._date2cell[q]=a;a.dijitDateValue=q;q=k.getDateLocalized?k.getDateLocalized(this.lang):k.getDate();this._setText(this.dateLabels[h],q);g.set(a,"aria-label",b.format(k,{selector:"date",formatLength:"long"}))},
this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);this.monthWidget.set("month",a);var b=a.getFullYear()-1,c=new this.dateClassObj;h.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?d.getObject(a.datePackage,
!1):f;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?d.getObject(a.datePackage+".locale",!1):b},_createMonthWidget:function(){return u._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var b=this.dowTemplateString,c=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),d=0<=this.dayOffset?this.dayOffset:a.getFirstDayOfWeek(this.lang);this.dayCellsHtml=q.substitute([b,
b,b,b,b,b,b].join(""),{d:""},function(){return c[d++%7]});b=q.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[b,b,b,b,b,b].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);l.setSelectable(this.domNode,!1);b=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",b,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=d.hitch(this,function(a,
b,e){this[a].dojoClick=!0;return c(this[a],"click",d.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,b,e))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,b){var c=this.currentFocus,d=this._getNodeByDate(c);a=this._patchDate(a);this._set("currentFocus",a);this._date2cell&&0==this.dateModule.difference(c,a,"month")||(this._populateGrid(),
this._populateControls(),this._markSelectedDates([this.value]));c=this._getNodeByDate(a);c.setAttribute("tabIndex",this.tabIndex);(this.focused||b)&&c.focus();d&&d!=c&&(n("webkit")?d.setAttribute("tabIndex","-1"):d.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue&&0!==a.dijitDateValue;a=a.parentNode);a&&!m.contains(a,"dijitCalendarDisabledDate")&&this.set("value",
a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function b(a,b){m.toggle(b,"dijitCalendarSelectedDate",a);b.setAttribute("aria-selected",a?"true":"false")}h.forEach(this._selectedCells||[],d.partial(b,!1));this._selectedCells=h.filter(h.map(a,this._getNodeByDate,this),function(a){return a});h.forEach(this._selectedCells,d.partial(b,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});
u._MonthWidget=k("dijit.CalendarLite._MonthWidget",t,{_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a),c=6==n("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+h.map(b,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=c+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});return u})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(h,k,a,f,b,e,l,m){new Date("X");return f("dijit.form._DateTimeTextBox",[e,l],{templateString:m,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:k.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(a,b){var c=this._isInvalidDate(a),d=this._isInvalidDate(b);if(c||d)return c&&d?0:c?-1:1;var c=this.format(a,this._unboundedConstraints),d=this.format(b,this._unboundedConstraints),
e=this.parse(c,this._unboundedConstraints),f=this.parse(d,this._unboundedConstraints);return c==d?0:h.compare(e,f,this._selector)},autoWidth:!0,format:function(a,b){return a?this.dateLocaleModule.format(a,b):""},parse:function(a,b){return this.dateLocaleModule.parse(a,b)||(this._isEmpty(a)?null:void 0)},serialize:function(b,d){b.toGregorian&&(b=b.toGregorian());return a.toISOString(b,d)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(a){a=
a||{};this.dateModule=a.datePackage?b.getObject(a.datePackage,!1):h;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=a.datePackage?b.getObject(a.datePackage+".locale",!1):k;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||
(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(e){e.selector=this._selector;e.fullYear=!0;var d=a.fromISOString;"string"==typeof e.min&&(e.min=d(e.min),this.dateClassObj instanceof Date||(e.min=new this.dateClassObj(e.min)));"string"==typeof e.max&&(e.max=d(e.max),this.dateClassObj instanceof Date||(e.max=new this.dateClassObj(e.max)));this.inherited(arguments);this._unboundedConstraints=b.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(a){return!a||
isNaN(a)||"object"!=typeof a||a.toString()==this._invalidDate},_setValueAttr:function(b,d,c){void 0!==b&&("string"==typeof b&&(b=a.fromISOString(b)),this._isInvalidDate(b)&&(b=null),b instanceof Date&&!(this.dateClassObj instanceof Date)&&(b=new this.dateClassObj(b)));this.inherited(arguments,[b,d,c]);this.value instanceof Date&&(this.filterString="");!1!==d&&this.dropDown&&this.dropDown.set("value",b,!1)},_set:function(a,b){if("value"==a){b instanceof Date&&!(this.dateClassObj instanceof Date)&&
(b=new this.dateClassObj(b));var c=this._get("value");if(c instanceof this.dateClassObj&&0==this.compare(b,c))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(a){this._isInvalidDate(a)&&(a=new this.dateClassObj);this._set("dropDownDefaultValue",a)},openDropDown:function(a){this.dropDown&&this.dropDown.destroy();var d=b.isString(this.popupClass)?b.getObject(this.popupClass,!1):this.popupClass,c=this,e=this.get("value");this.dropDown=new d({onChange:function(a){c.set("value",
a,!0)},id:this.id+"_popup",dir:c.dir,lang:c.lang,value:e,textDir:c.textDir,currentFocus:this._isInvalidDate(e)?this.dropDownDefaultValue:e,constraints:c.constraints,filterString:c.filterString,datePackage:c.datePackage,isDisabledDate:function(a){return!c.rangeCheck(a,c.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(a,b){this._setValueAttr(this.parse(a,this.constraints),b,a)}})})},"dijit/form/RangeBoundTextBox":function(){define(["dojo/_base/declare",
"dojo/i18n","./MappedTextBox","dojo/i18n!./nls/validate"],function(h,k,a){return h("dijit.form.RangeBoundTextBox",a,{rangeMessage:"",rangeCheck:function(a,b){return("min"in b?0<=this.compare(a,b.min):!0)&&("max"in b?0>=this.compare(a,b.max):!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var a=this.get("value");if(null==a)return!1;var b=!1;"min"in this.constraints&&(b=this.constraints.min,b=0>this.compare(a,"number"==typeof b&&
0<=b&&0!=a?0:b));!b&&"max"in this.constraints&&(b=this.constraints.max,b=0<this.compare(a,"number"!=typeof b||0<b?b:0));return b},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(a){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(a))},getErrorMessage:function(a){var b=this.get("value");return null==b||""===b||"number"==typeof b&&isNaN(b)||this.isInRange(a)?this.inherited(arguments):this.rangeMessage},
postMixInProperties:function(){this.inherited(arguments);this.rangeMessage||(this.messages=k.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}})})},"dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(h,k,a,f){return h("dijit.form.MappedTextBox",f,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(a){return a.toString?
a.toString():""},toString:function(){var a=this.filter(this.get("value"));return null!=a?"string"==typeof a?a:this.serialize(a,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.valueNode=a.place("\x3cinput type\x3d'hidden'"+(this.name&&!k("msapp")?' name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"")+"/\x3e",this.textbox,"after")},reset:function(){this.valueNode.value="";this.inherited(arguments)}})})},
"dijit/form/NumberTextBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "),function(h,k,a,f,b,e){var l=function(b){b=b||{};var d=a.getLocalization("dojo.cldr","number",a.normalizeLocale(b.locale)),c=b.pattern?b.pattern:d[(b.type||"decimal")+"Format"];b="number"==typeof b.places?b.places:"string"===typeof b.places&&0<b.places.length?b.places.replace(/.*,/,""):-1!=c.indexOf(".")?c.split(".")[1].replace(/[^#0]/g,"").length:0;return{sep:d.decimal,
places:b}},m=h("dijit.form.NumberTextBoxMixin",null,{pattern:function(a){return"("+(this.focused&&this.editOptions?this._regExpGenerator(k.delegate(a,this.editOptions))+"|":"")+this._regExpGenerator(a)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:b.format,_regExpGenerator:b.regexp,_decimalInfo:l(),postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},_setConstraintsAttr:function(a){var b="number"==typeof a.places?a.places:0;b&&b++;"number"!=typeof a.max&&
(a.max=9*Math.pow(10,15-b));"number"!=typeof a.min&&(a.min=-9*Math.pow(10,15-b));this.inherited(arguments,[a]);this.focusNode&&this.focusNode.value&&!isNaN(this.value)&&this.set("value",this.value);this._decimalInfo=l(a)},_onFocus:function(){if(!this.disabled&&!this.readOnly){var a=this.get("value");"number"!=typeof a||isNaN(a)||(a=this.format(a,this.constraints),void 0!==a&&(this.textbox.value=a));this.inherited(arguments)}},format:function(a,b){var c=String(a);if("number"!=typeof a)return c;if(isNaN(a))return"";
if(!("rangeCheck"in this&&this.rangeCheck(a,b))&&!1!==b.exponent&&/\de[-+]?\d/i.test(c))return c;this.editOptions&&this.focused&&(b=k.mixin({},b,this.editOptions));return this._formatter(a,b)},_parser:b.parse,parse:function(a,b){var c=k.mixin({},b,this.editOptions&&this.focused?this.editOptions:{});if(this.focused&&null!=c.places){var d=c.places,d="number"===typeof d?d:Number(d.split(",").pop());c.places="0,"+d}c=this._parser(a,c);this.editOptions&&this.focused&&isNaN(c)&&(c=this._parser(a,b));return c},
_getDisplayedValueAttr:function(){var a=this.inherited(arguments);return isNaN(a)?this.textbox.value:a},filter:function(a){if(null==a||"string"==typeof a&&""==a)return NaN;"number"!=typeof a||isNaN(a)||0==a||(a=b.round(a,this._decimalInfo.places));return this.inherited(arguments,[a])},serialize:function(a,b){return"number"!=typeof a||isNaN(a)?"":this.inherited(arguments)},_setBlurValue:function(){var a=k.hitch(k.delegate(this,{focused:!0}),"get")("value");this._setValueAttr(a,!0)},_setValueAttr:function(a,
b,c){if(void 0!==a&&void 0===c)if(c=String(a),"number"==typeof a)if(isNaN(a))c="";else{if("rangeCheck"in this&&this.rangeCheck(a,this.constraints)||!1===this.constraints.exponent||!/\de[-+]?\d/i.test(c))c=void 0}else a?a=void 0:(c="",a=NaN);this.inherited(arguments,[a,b,c])},_getValueAttr:function(){var a=this.inherited(arguments);if(isNaN(a)&&""!==this.textbox.value){if(!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+b._realNumberRegexp(k.delegate(this.constraints))+
"$")).test(this.textbox.value))return a=Number(this.textbox.value),isNaN(a)?void 0:a}else return a},isValid:function(a){if(!this.focused||this._isEmpty(this.textbox.value))return this.inherited(arguments);var b=this.get("value");return!isNaN(b)&&this.rangeCheck(b,this.constraints)?!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1},_isValidSubset:function(){var a="number"==typeof this.constraints.min,b="number"==typeof this.constraints.max,c=this.get("value");
if(isNaN(c)||!a&&!b)return this.inherited(arguments);var e=c|0,l=0>c,h=-1!=this.textbox.value.indexOf(this._decimalInfo.sep),m=(this.maxLength||20)-this.textbox.value.length,k=h?this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g,""):"",e=h?e+"."+k:e+"",m=f.rep("9",m),h=c;l?h=Number(e+m):c=Number(e+m);return!(a&&c<this.constraints.min||b&&h>this.constraints.max)}});h=h("dijit.form.NumberTextBox",[e,m],{baseClass:"dijitTextBox dijitNumberTextBox"});h.Mixin=m;return h})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(h,k,a,f,b){return h("dijit.form.FilteringSelect",[f,b],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(a,b,f,g){b&&b[this.searchAttr]!==this._lastQuery||!b&&a.length&&this.store.getIdentity(a[0])!=this._lastQuery||
(a.length?this.set("item",a[0],g):this.set("value","",g||void 0===g&&!this.focused,this.textbox.value,null))},_openResultList:function(a,b,f){b[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(b,f,h,g){this._onChangeActive||(f=null);if(void 0===g){if(null===b||""===b)if(b="",!k.isString(h)){this._setDisplayedValueAttr(h||"",f);
return}var d=this;this._lastQuery=b;a(this.store.get(b),function(a){d._callbackSetLabel(a?[a]:[],void 0,void 0,f)})}else this.valueNode.value=b,this.inherited(arguments,[b,f,h,g])},_setItemAttr:function(a,b,f){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(a){return a.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(b,f){null==b&&(b="");if(!this._created){if(!("displayedValue"in this.params))return;f=!1}if(this.store){this.closeDropDown();
var e=k.clone(this.query),g=this._getDisplayQueryString(b),d;this.store._oldAPI?d=g:(d=this._patternToRegExp(g),d.toString=function(){return g});this._lastQuery=e[this.searchAttr]=d;this._lastDisplayedValue=this.textbox.value=b;this._set("displayedValue",b);var c=this,l={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};k.mixin(l,this.fetchProperties);this._fetchHandle=this.store.query(e,l);a(this._fetchHandle,function(a){c._fetchHandle=null;c._callbackSetLabel(a||[],e,l,f)},function(a){c._fetchHandle=
null;c._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/ComboBoxMixin":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/kernel dojo/_base/lang dojo/store/util/QueryResults ./_AutoCompleterMixin ./_ComboBoxMenu ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(h,k,a,f,b,e,l,m,g){return h("dijit.form.ComboBoxMixin",[m,e],{dropDownClass:l,hasDownArrow:!0,
templateString:g,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_setHasDownArrowAttr:function(a){this._set("hasDownArrow",a);this._buttonNode.style.display=a?"":"none"},_showResultList:function(){this.displayMessage("");this.inherited(arguments)},_setStoreAttr:function(a){a.get||f.mixin(a,{_oldAPI:!0,get:function(a){var b=new k;this.fetchItemByIdentity({identity:a,onItem:function(a){b.resolve(a)},onError:function(a){b.reject(a)}});return b.promise},query:function(a,
d){var c=new k(function(){e.abort&&e.abort()});c.total=new k;var e=this.fetch(f.mixin({query:a,onBegin:function(a){c.total.resolve(a)},onComplete:function(a){c.resolve(a)},onError:function(a){c.reject(a)}},d));return b(c)}});this._set("store",a)},postMixInProperties:function(){var b=this.params.store||this.store;b&&this._setStoreAttr(b);this.inherited(arguments);if(!this.params.store&&this.store&&!this.store._oldAPI){var c=this.declaredClass;f.mixin(this.store,{getValue:function(b,d){a.deprecated(c+
".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return b[d]},getLabel:function(b){a.deprecated(c+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return b.name},fetch:function(b){a.deprecated(c+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");require(["dojo/data/ObjectStore"],f.hitch(this,function(a){(new a({objectStore:this})).fetch(b)}))}})}},buildRendering:function(){this.inherited(arguments);
this.focusNode.setAttribute("aria-autocomplete",this.autoComplete?"both":"list")}})})},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../when"],function(h,k,a){var f=function(b){function e(e){b[e]=function(){var g=arguments,d=a(b,function(a){Array.prototype.unshift.call(g,a);return f(h[e].apply(h,g))});if("forEach"!==e||l)return d}}if(!b)return b;var l=!!b.then;l&&(b=k.delegate(b));e("forEach");e("filter");e("map");null==b.total&&(b.total=a(b,function(a){return a.length}));
return b};k.setObject("dojo.store.util.QueryResults",f);return f})},"dijit/form/_AutoCompleterMixin":function(){define("dojo/aspect dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/query dojo/regexp dojo/sniff ./DataList ./_TextBoxMixin ./_SearchMixin".split(" "),function(h,k,a,f,b,e,l,m,g,d,c){k=k("dijit.form._AutoCompleterMixin",c,{item:null,autoComplete:!0,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:!1,_getCaretPos:function(a){var b=0;if("number"==
typeof a.selectionStart)b=a.selectionStart;else if(m("ie")){var c=a.ownerDocument.selection.createRange().duplicate();a=a.createTextRange();c.move("character",0);a.move("character",0);try{a.setEndPoint("EndToEnd",c),b=String(a.text).replace(/\r/g,"").length}catch(r){}}return b},_setCaretPos:function(a,b){b=parseInt(b);d.selectInputText(a,b,b)},_setDisabledAttr:function(a){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",a?"true":"false")},_onKey:function(a){if(!(32<=a.charCode)){var b=
a.charCode||a.keyCode;if(b!=f.ALT&&b!=f.CTRL&&b!=f.META&&b!=f.SHIFT){var c=this.dropDown,d=null;this._abortQuery();this.inherited(arguments);if(!(a.altKey||a.ctrlKey||a.metaKey))switch(this._opened&&(d=c.getHighlightedOption()),b){case f.PAGE_DOWN:case f.DOWN_ARROW:case f.PAGE_UP:case f.UP_ARROW:this._opened&&this._announceOption(d);a.stopPropagation();a.preventDefault();break;case f.ENTER:if(d){if(d==c.nextButton){this._nextSearch(1);a.stopPropagation();a.preventDefault();break}else if(d==c.previousButton){this._nextSearch(-1);
a.stopPropagation();a.preventDefault();break}a.stopPropagation();a.preventDefault()}else this._setBlurValue(),this._setCaretPos(this.focusNode,this.focusNode.value.length);case f.TAB:b=this.get("displayedValue");if(c&&(b==c._messages.previousMessage||b==c._messages.nextMessage))break;d&&this._selectOption(d);case f.ESCAPE:this._opened&&(this._lastQuery=null,this.closeDropDown())}}}},_autoCompleteText:function(a){var b=this.focusNode;d.selectInputText(b,b.value.length);var c=this.ignoreCase?"toLowerCase":
"substr";0==a[c](0).indexOf(this.focusNode.value[c](0))?(c=this.autoComplete?this._getCaretPos(b):b.value.length,c+1>b.value.length&&(b.value=a,d.selectInputText(b,c))):(b.value=a,d.selectInputText(b))},_openResultList:function(a,c,d){var e=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();a.length||0!=d.start?(this._nextSearch=this.dropDown.onPage=b.hitch(this,function(b){a.nextPage(-1!==b);this.focus()}),this.dropDown.createOptions(a,d,b.hitch(this,"_getMenuLabelFromItem")),this._showResultList(),
"direction"in d?(d.direction?this.dropDown.highlightFirstOption():d.direction||this.dropDown.highlightLastOption(),e&&this._announceOption(this.dropDown.getHighlightedOption())):!this.autoComplete||this._prev_key_backspace||/^[*]+$/.test(c[this.searchAttr].toString())||this._announceOption(this.dropDown.containerNode.firstChild.nextSibling)):this.closeDropDown()},_showResultList:function(){this.closeDropDown(!0);this.openDropDown();this.domNode.setAttribute("aria-expanded","true")},loadDropDown:function(){this._startSearchAll()},
isLoaded:function(){return!1},closeDropDown:function(){this._abortQuery();this._opened&&(this.inherited(arguments),this.domNode.setAttribute("aria-expanded","false"))},_setBlurValue:function(){var a=this.get("displayedValue"),b=this.dropDown;!b||a!=b._messages.previousMessage&&a!=b._messages.nextMessage?"undefined"==typeof this.item?(this.item=null,this.set("displayedValue",a)):(this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0),this._refreshState()):this._setValueAttr(this._lastValueReported,
!0);this.focusNode.removeAttribute("aria-activedescendant")},_setItemAttr:function(a,b,c){var d="";a&&(c||(c=this.store._oldAPI?this.store.getValue(a,this.searchAttr):a[this.searchAttr]),d=this._getValueField()!=this.searchAttr?this.store.getIdentity(a):c);this.set("value",d,b,c,a)},_announceOption:function(b){if(b){var c;if(b==this.dropDown.nextButton||b==this.dropDown.previousButton)c=b.innerHTML,this.item=void 0,this.value="";else{var d=this.dropDown.items[b.getAttribute("item")];c=(this.store._oldAPI?
this.store.getValue(d,this.searchAttr):d[this.searchAttr]).toString();this.set("item",d,!1,c)}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",a.get(b,"id"));this._autoCompleteText(c)}},_selectOption:function(a){this.closeDropDown();a&&this._announceOption(a);this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,!0);this.focusNode.removeAttribute("aria-activedescendant")},_startSearchAll:function(){this._startSearch("")},
_startSearchFromInput:function(){this.item=void 0;this.inherited(arguments)},_startSearch:function(a){if(!this.dropDown){var c=this.id+"_popup";this.dropDown=new (b.isString(this.dropDownClass)?b.getObject(this.dropDownClass,!1):this.dropDownClass)({onChange:b.hitch(this,this._selectOption),id:c,dir:this.dir,textDir:this.textDir})}this._lastInput=a;this.inherited(arguments)},_getValueField:function(){return this.searchAttr},postMixInProperties:function(){this.inherited(arguments);if(!this.store&&
this.srcNodeRef&&(this.store=new g({},this.srcNodeRef),!("value"in this.params))){var a=this.item=this.store.fetchSelectedItem();if(a){var b=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(a,b):a[b]}}},postCreate:function(){var a=e('label[for\x3d"'+this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.domNode.setAttribute("aria-labelledby",a[0].id));this.inherited(arguments);h.after(this,"onSearch",b.hitch(this,"_openResultList"),!0)},_getMenuLabelFromItem:function(a){a=
this.labelFunc(a,this.store);var b=this.labelType;"none"!=this.highlightMatch&&"text"==this.labelType&&this._lastInput&&(a=this.doHighlight(a,this._lastInput),b="html");return{html:"html"==b,label:a}},doHighlight:function(a,b){var c=(this.ignoreCase?"i":"")+("all"==this.highlightMatch?"g":""),d=this.queryExpr.indexOf("${0}");b=l.escapeString(b);return this._escapeHtml(a.replace(new RegExp((0==d?"^":"")+"("+b+")"+(d==this.queryExpr.length-4?"$":""),c),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,
'\x3cspan class\x3d"dijitComboBoxHighlightMatch"\x3e$1\x3c/span\x3e')},_escapeHtml:function(a){return a=String(a).replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;")},reset:function(){this.item=null;this.inherited(arguments)},labelFunc:function(a,b){return(b._oldAPI?b.getValue(a,this.labelAttr||this.searchAttr):a[this.labelAttr||this.searchAttr]).toString()},_setValueAttr:function(a,b,c,d){this._set("item",d||null);null==a&&(a="");this.inherited(arguments)}});
m("dojo-bidi")&&k.extend({_setTextDirAttr:function(a){this.inherited(arguments);this.dropDown&&this.dropDown._set("textDir",a)}});return k})},"dijit/form/DataList":function(){define("dojo/_base/declare dojo/dom dojo/_base/lang dojo/query dojo/store/Memory ../registry".split(" "),function(h,k,a,f,b,e){function l(b){return{id:b.value,value:b.value,name:a.trim(b.innerText||b.textContent||"")}}return h("dijit.form.DataList",b,{constructor:function(b,g){this.domNode=k.byId(g);a.mixin(this,b);this.id&&
e.add(this);this.domNode.style.display="none";this.inherited(arguments,[{data:f("option",this.domNode).map(l)}])},destroy:function(){e.remove(this.id)},fetchSelectedItem:function(){var a=f("\x3e option[selected]",this.domNode)[0]||f("\x3e option",this.domNode)[0];return a&&l(a)}})})},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(h,k,a){return h("dojo.store.Memory",null,{constructor:function(a){for(var b in a)this[b]=a[b];this.setData(this.data||
[])},data:null,idProperty:"id",index:null,queryEngine:a,get:function(a){return this.data[this.index[a]]},getIdentity:function(a){return a[this.idProperty]},put:function(a,b){var e=this.data,f=this.index,h=this.idProperty,h=a[h]=b&&"id"in b?b.id:h in a?a[h]:Math.random();if(h in f){if(b&&!1===b.overwrite)throw Error("Object already exists");e[f[h]]=a}else f[h]=e.push(a)-1;return h},add:function(a,b){(b=b||{}).overwrite=!1;return this.put(a,b)},remove:function(a){var b=this.index,e=this.data;if(a in
b)return e.splice(b[a],1),this.setData(e),!0},query:function(a,b){return k(this.queryEngine(a,b)(this.data))},setData:function(a){a.items?(this.idProperty=a.identifier||this.idProperty,a=this.data=a.items):this.data=a;this.index={};for(var b=0,e=a.length;b<e;b++)this.index[a[b][this.idProperty]]=b}})})},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(h){return function(k,a){function f(b){b=h.filter(b,k);var e=a&&a.sort;e&&b.sort("function"==typeof e?e:function(a,
b){for(var c,d=0;c=e[d];d++){var f=a[c.attribute],g=b[c.attribute],f=null!=f?f.valueOf():f,g=null!=g?g.valueOf():g;if(f!=g)return!!c.descending==(null==f||f>g)?-1:1}return 0});if(a&&(a.start||a.count)){var f=b.length;b=b.slice(a.start||0,(a.start||0)+(a.count||Infinity));b.total=f}return b}switch(typeof k){default:throw Error("Can not query with a "+typeof k);case "object":case "undefined":var b=k;k=function(a){for(var e in b){var f=b[e];if(f&&f.test){if(!f.test(a[e],a))return!1}else if(f!=a[e])return!1}return!0};
break;case "string":if(!this[k])throw Error("No filter function "+k+" was found in store");k=this[k];case "function":}f.matches=k;return f}})},"dijit/form/_SearchMixin":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/query dojo/string dojo/when ../registry".split(" "),function(h,k,a,f,b,e,l){return h("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},list:"",_setListAttr:function(a){this._set("list",a)},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",
ignoreCase:!0,_patternToRegExp:function(a){return new RegExp("^"+a.replace(/(\\.)|(\*)|(\?)|\W/g,function(a,b,c,e){return c?".*":e?".":b?b:"\\"+a})+"$",this.ignoreCase?"mi":"m")},_abortQuery:function(){this.searchTimer&&(this.searchTimer=this.searchTimer.remove());this._queryDeferHandle&&(this._queryDeferHandle=this._queryDeferHandle.remove());this._fetchHandle&&(this._fetchHandle.abort&&(this._cancelingQuery=!0,this._fetchHandle.abort(),this._cancelingQuery=!1),this._fetchHandle.cancel&&(this._cancelingQuery=
!0,this._fetchHandle.cancel(),this._cancelingQuery=!1),this._fetchHandle=null)},_processInput:function(a){if(!this.disabled&&!this.readOnly){a=a.charOrCode;this._prev_key_backspace=!1;if(a==k.DELETE||a==k.BACKSPACE)this._maskValidSubsetError=this._prev_key_backspace=!0;if(this.store)this.searchTimer=this.defer("_startSearchFromInput",1);else this.onSearch()}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value)},_startSearch:function(f){this._abortQuery();
var g=this,d=a.clone(this.query),c={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:!0}},l=b.substitute(this.queryExpr,[f.replace(/([\\\*\?])/g,"\\$1")]),h,m=function(){var a=g._fetchHandle=g.store.query(d,c);g.disabled||g.readOnly||h!==g._lastQuery||e(a,function(b){g._fetchHandle=null;g.disabled||g.readOnly||h!==g._lastQuery||e(a.total,function(a){b.total=a;var e=g.pageSize;if(isNaN(e)||e>b.total)e=b.total;b.nextPage=function(a){c.direction=a=!1!==a;c.count=e;a?(c.start+=
b.length,c.start>=b.total&&(c.count=0)):(c.start-=e,0>c.start&&(c.count=Math.max(e+c.start,0),c.start=0));0>=c.count?(b.length=0,g.onSearch(b,d,c)):m()};g.onSearch(b,d,c)})},function(a){g._fetchHandle=null;g._cancelingQuery||console.error(g.declaredClass+" "+a.toString())})};a.mixin(c,this.fetchProperties);this.store._oldAPI?h=l:(h=this._patternToRegExp(l),h.toString=function(){return l});this._lastQuery=d[this.searchAttr]=h;this._queryDeferHandle=this.defer(m,this.searchDelay)},constructor:function(){this.query=
{};this.fetchProperties={}},postMixInProperties:function(){if(!this.store){var a=this.list;a&&(this.store=l.byId(a))}this.inherited(arguments)}})})},"dijit/form/_ComboBoxMenu":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-style dojo/keys ../_WidgetBase ../_TemplatedMixin ./_ComboBoxMenuMixin ./_ListMouseMixin".split(" "),function(h,k,a,f,b,e,l,m){return h("dijit.form._ComboBoxMenu",[b,e,m,l],{templateString:"\x3cdiv class\x3d'dijitReset dijitMenu' data-dojo-attach-point\x3d'containerNode' style\x3d'overflow: auto; overflow-x: hidden;' role\x3d'listbox'\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point\x3d'previousButton' role\x3d'option'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuNextButton' data-dojo-attach-point\x3d'nextButton' role\x3d'option'\x3e\x3c/div\x3e\x3c/div\x3e",
baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);this.isLeftToRight()||(k.add(this.previousButton,"dijitMenuItemRtl"),k.add(this.nextButton,"dijitMenuItemRtl"));this.containerNode.setAttribute("role","listbox")},_createMenuItem:function(){var a=this.ownerDocument.createElement("div");a.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");a.setAttribute("role","option");return a},onHover:function(a){k.add(a,"dijitMenuItemHover")},onUnhover:function(a){k.remove(a,
"dijitMenuItemHover")},onSelect:function(a){k.add(a,"dijitMenuItemSelected")},onDeselect:function(a){k.remove(a,"dijitMenuItemSelected")},_page:function(b){var d=0,c=this.domNode.scrollTop,e=a.get(this.domNode,"height");for(this.getHighlightedOption()||this.selectNextNode();d<e;){var f=this.getHighlightedOption();if(b){if(!f.previousSibling||"none"==f.previousSibling.style.display)break;this.selectPreviousNode()}else{if(!f.nextSibling||"none"==f.nextSibling.style.display)break;this.selectNextNode()}f=
this.domNode.scrollTop;d+=(f-c)*(b?-1:1);c=f}},handleKey:function(a){switch(a.keyCode){case f.DOWN_ARROW:return this.selectNextNode(),!1;case f.PAGE_DOWN:return this._page(!1),!1;case f.UP_ARROW:return this.selectPreviousNode(),!1;case f.PAGE_UP:return this._page(!0),!1;default:return!0}}})})},"dijit/form/_ComboBoxMenuMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/has dojo/i18n dojo/i18n!./nls/ComboBox".split(" "),function(h,k,a,f,b){var e=k("dijit.form._ComboBoxMenuMixin"+
(f("dojo-bidi")?"_NoBidi":""),null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=b.getLocalization("dijit.form","ComboBox",this.lang)},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages.previousMessage;this.nextButton.innerHTML=this._messages.nextMessage},_setValueAttr:function(a){this._set("value",a);this.onChange(a)},onClick:function(a){if(a==this.previousButton)this._setSelectedAttr(null),this.onPage(-1);else if(a==
this.nextButton)this._setSelectedAttr(null),this.onPage(1);else this.onChange(a)},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null)},_createOption:function(a,b){var e=this._createMenuItem(),d=b(a);d.html?e.innerHTML=d.label:e.appendChild(e.ownerDocument.createTextNode(d.label));""==e.innerHTML&&(e.innerHTML="\x26#160;");return e},createOptions:function(b,e,f){this.items=b;this.previousButton.style.display=0==e.start?"none":"";a.set(this.previousButton,"id",this.id+
"_prev");h.forEach(b,function(b,d){var c=this._createOption(b,f);c.setAttribute("item",d);a.set(c,"id",this.id+d);this.nextButton.parentNode.insertBefore(c,this.nextButton)},this);var d=!1;b.total&&!b.total.then&&-1!=b.total?e.start+e.count<b.total?d=!0:e.start+e.count>b.total&&e.count==b.length&&(d=!0):e.count==b.length&&(d=!0);this.nextButton.style.display=d?"":"none";a.set(this.nextButton,"id",this.id+"_next")},clearResultList:function(){for(var a=this.containerNode;2<a.childNodes.length;)a.removeChild(a.childNodes[a.childNodes.length-
2]);this._setSelectedAttr(null)},highlightFirstOption:function(){this.selectFirstNode()},highlightLastOption:function(){this.selectLastNode()},selectFirstNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.previousButton&&this.selectNextNode()},selectLastNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.nextButton&&this.selectPreviousNode()},getHighlightedOption:function(){return this.selected}});f("dojo-bidi")&&(e=k("dijit.form._ComboBoxMenuMixin",
e,{_createOption:function(){var a=this.inherited(arguments);this.applyTextDir(a);return a}}));return e})},"dijit/form/nls/ComboBox":function(){define({root:{previousMessage:"Previous choices",nextMessage:"More choices"},bs:!0,mk:!0,sr:!0,zh:!0,"zh-tw":!0,vi:!0,uk:!0,tr:!0,th:!0,sv:!0,sl:!0,sk:!0,ru:!0,ro:!0,pt:!0,"pt-pt":!0,pl:!0,nl:!0,nb:!0,lv:!0,lt:!0,ko:!0,kk:!0,ja:!0,it:!0,id:!0,hu:!0,hr:!0,hi:!0,he:!0,fr:!0,fi:!0,eu:!0,et:!0,es:!0,el:!0,de:!0,da:!0,cs:!0,ca:!0,bg:!0,az:!0,ar:!0})},"dijit/form/_ListMouseMixin":function(){define(["dojo/_base/declare",
"dojo/on","dojo/touch","./_ListBase"],function(h,k,a,f){return h("dijit.form._ListMouseMixin",f,{postCreate:function(){this.inherited(arguments);this.domNode.dojoClick=!0;this._listConnect("click","_onClick");this._listConnect("mousedown","_onMouseDown");this._listConnect("mouseup","_onMouseUp");this._listConnect("mouseover","_onMouseOver");this._listConnect("mouseout","_onMouseOut")},_onClick:function(a,e){this._setSelectedAttr(e,!1);this._deferredClick&&this._deferredClick.remove();this._deferredClick=
this.defer(function(){this._deferredClick=null;this.onClick(e)})},_onMouseDown:function(a,e){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging=!0;this._setSelectedAttr(e,!1)},_onMouseUp:function(a,e){this._isDragging=!1;var b=this.selected,f=this._hoveredNode;b&&e==b?this.defer(function(){this._onClick(a,b)}):f&&this.defer(function(){this._onClick(a,f)})},_onMouseOut:function(a,e){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=
null);this._isDragging&&(this._cancelDrag=(new Date).getTime()+1E3)},_onMouseOver:function(a,e){this._cancelDrag&&((new Date).getTime()>this._cancelDrag&&(this._isDragging=!1),this._cancelDrag=null);this._hoveredNode=e;this.onHover(e);this._isDragging&&this._setSelectedAttr(e,!1)}})})},"dijit/form/_ListBase":function(){define(["dojo/_base/declare","dojo/on","dojo/window"],function(h,k,a){return h("dijit.form._ListBase",null,{selected:null,_listConnect:function(a,b){var e=this;return e.own(k(e.containerNode,
k.selector(function(a,b,e){return a.parentNode==e},a),function(a){e[b](a,this)}))},selectFirstNode:function(){for(var a=this.containerNode.firstChild;a&&"none"==a.style.display;)a=a.nextSibling;this._setSelectedAttr(a,!0)},selectLastNode:function(){for(var a=this.containerNode.lastChild;a&&"none"==a.style.display;)a=a.previousSibling;this._setSelectedAttr(a,!0)},selectNextNode:function(){var a=this.selected;if(a){for(a=a.nextSibling;a&&"none"==a.style.display;)a=a.nextSibling;a?this._setSelectedAttr(a,
!0):this.selectFirstNode()}else this.selectFirstNode()},selectPreviousNode:function(){var a=this.selected;if(a){for(a=a.previousSibling;a&&"none"==a.style.display;)a=a.previousSibling;a?this._setSelectedAttr(a,!0):this.selectLastNode()}else this.selectLastNode()},_setSelectedAttr:function(f,b){if(this.selected!=f){var e=this.selected;if(e)this.onDeselect(e);f&&(b&&a.scrollIntoView(f),this.onSelect(f));this._set("selected",f)}else if(f)this.onSelect(f)}})})},"dijit/form/NumberSpinner":function(){define(["dojo/_base/declare",
"dojo/keys","./_Spinner","./NumberTextBox"],function(h,k,a,f){return h("dijit.form.NumberSpinner",[a,f.Mixin],{baseClass:"dijitTextBox dijitSpinner dijitNumberTextBox",adjust:function(a,e){var b=this.constraints,f=isNaN(a),g=!isNaN(b.max),d=!isNaN(b.min);f&&0!=e&&(a=0<e?d?b.min:g?b.max:0:g?this.constraints.max:d?b.min:0);var c=a+e;if(f||isNaN(c))return a;g&&c>b.max&&(c=b.max);d&&c<b.min&&(c=b.min);return c},_onKeyDown:function(a){if(!(this.disabled||this.readOnly||a.keyCode!=k.HOME&&a.keyCode!=k.END||
a.ctrlKey||a.altKey||a.metaKey||"undefined"==typeof this.get("value"))){var b=this.constraints[a.keyCode==k.HOME?"min":"max"];"number"==typeof b&&this._setValueAttr(b,!1);a.stopPropagation();a.preventDefault()}}})})},"dijit/form/_Spinner":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/sniff dojo/mouse dojo/on ../typematic ./RangeBoundTextBox dojo/text!./templates/Spinner.html ./_TextBoxMixin".split(" "),function(h,k,a,f,b,e,l,m,g,d){return h("dijit.form._Spinner",m,{defaultTimeout:500,
minimumTimeout:10,timeoutChangeRate:.9,smallDelta:1,largeDelta:10,templateString:g,baseClass:"dijitTextBox dijitSpinner",cssStateNodes:{upArrowNode:"dijitUpArrowButton",downArrowNode:"dijitDownArrowButton"},adjust:function(a){return a},_arrowPressed:function(a,b,e){this.disabled||this.readOnly||(this._setValueAttr(this.adjust(this.get("value"),b*e),!1),d.selectInputText(this.textbox,this.textbox.value.length))},_arrowReleased:function(){this._wheelTimer=null},_typematicCallback:function(a,b,d){var c=
this.smallDelta;b==this.textbox&&(b=d.keyCode,c=b==k.PAGE_UP||b==k.PAGE_DOWN?this.largeDelta:this.smallDelta,b=b==k.UP_ARROW||b==k.PAGE_UP?this.upArrowNode:this.downArrowNode);-1==a?this._arrowReleased(b):this._arrowPressed(b,b==this.upArrowNode?1:-1,c)},_wheelTimer:null,_mouseWheeled:function(a){if(this.focused){a.stopPropagation();a.preventDefault();var b=a.wheelDelta/120;Math.floor(b)!=b&&(b=0<a.wheelDelta?1:-1);a=a.detail?-1*a.detail:b;if(0!==a){var c=this[0<a?"upArrowNode":"downArrowNode"];this._arrowPressed(c,
a,this.smallDelta);this._wheelTimer&&this._wheelTimer.remove();this._wheelTimer=this.defer(function(){this._arrowReleased(c)},50)}}},_setConstraintsAttr:function(a){this.inherited(arguments);this.focusNode&&(void 0!==this.constraints.min?this.focusNode.setAttribute("aria-valuemin",this.constraints.min):this.focusNode.removeAttribute("aria-valuemin"),void 0!==this.constraints.max?this.focusNode.setAttribute("aria-valuemax",this.constraints.max):this.focusNode.removeAttribute("aria-valuemax"))},_setValueAttr:function(a,
b){this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(e(this.domNode,b.wheel,a.hitch(this,"_mouseWheeled")),l.addListener(this.upArrowNode,this.textbox,{keyCode:k.UP_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),l.addListener(this.downArrowNode,this.textbox,{keyCode:k.DOWN_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,
"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),l.addListener(this.upArrowNode,this.textbox,{keyCode:k.PAGE_UP,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),l.addListener(this.downArrowNode,this.textbox,{keyCode:k.PAGE_DOWN,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout))}})})},"dijit/form/SimpleTextarea":function(){define(["dojo/_base/declare",
"dojo/dom-class","dojo/sniff","./TextBox"],function(h,k,a,f){return h("dijit.form.SimpleTextarea",f,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"\x3ctextarea ${!nameAttrSetting} data-dojo-attach-point\x3d'focusNode,containerNode,textbox' autocomplete\x3d'off'\x3e\x3c/textarea\x3e",postMixInProperties:function(){!this.value&&this.srcNodeRef&&(this.value=this.srcNodeRef.value);this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);a("ie")&&this.cols&&
k.add(this.textbox,"dijitTextAreaCols")},filter:function(a){a&&(a=a.replace(/\r/g,""));return this.inherited(arguments)},_onInput:function(b){if(this.maxLength){var e=parseInt(this.maxLength),f=this.textbox.value.replace(/\r/g,""),e=f.length-e;if(0<e){var h=this.textbox;if(h.selectionStart){var g=h.selectionStart,d=0;a("opera")&&(d=(this.textbox.value.substring(0,g).match(/\r/g)||[]).length);this.textbox.value=f.substring(0,g-e-d)+f.substring(g-d);h.setSelectionRange(g-e,g-e)}else this.ownerDocument.selection&&
(h.focus(),f=this.ownerDocument.selection.createRange(),f.moveStart("character",-e),f.text="",f.select())}}this.inherited(arguments)}})})},"dijit/form/TimeTextBox":function(){define(["dojo/_base/declare","dojo/keys","dojo/_base/lang","../_TimePicker","./_DateTimeTextBox"],function(h,k,a,f,b){return h("dijit.form.TimeTextBox",b,{baseClass:"dijitTextBox dijitComboBox dijitTimeTextBox",popupClass:f,_selector:"time",value:new Date(""),maxHeight:-1,openDropDown:function(b){this.inherited(arguments);this.dropDown.on("input",
a.hitch(this,function(){this.set("value",this.dropDown.get("value"),!1)}))},_onInput:function(){this.inherited(arguments);var a=this.get("displayedValue");this.filterString=a&&!this.parse(a,this.constraints)?a.toLowerCase():"";this._opened&&this.closeDropDown();this.openDropDown()}})})},"dijit/_TimePicker":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/sniff dojo/query dojo/mouse dojo/on ./_WidgetBase ./form/_ListMouseMixin".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v){return b("dijit._TimePicker",[r,v],{baseClass:"dijitTimePicker",pickerMin:"T00:00:00",pickerMax:"T23:59:59",clickableIncrement:"T00:15:00",visibleIncrement:"T01:00:00",value:new Date,_visibleIncrement:2,_clickableIncrement:1,_totalIncrements:10,constraints:{},serialize:f.toISOString,buildRendering:function(){this.inherited(arguments);this.timeMenu=this.containerNode=this.domNode},setValue:function(a){m.deprecated("dijit._TimePicker:setValue() is deprecated.  Use set('value', ...) instead.",
"","2.0");this.set("value",a)},_setValueAttr:function(a){this._set("value",a);this._showText()},_setFilterStringAttr:function(a){this._set("filterString",a);this._showText()},isDisabledDate:function(){return!1},_getFilteredNodes:function(a,b,c,d){a=this.ownerDocument.createDocumentFragment();for(b=0;b<this._maxIncrement;b++)(c=this._createOption(b))&&a.appendChild(c);return a},_showText:function(){var a=f.fromISOString;this.domNode.innerHTML="";this._clickableIncrementDate=a(this.clickableIncrement);
this._visibleIncrementDate=a(this.visibleIncrement);var b=function(a){return 3600*a.getHours()+60*a.getMinutes()+a.getSeconds()},c=b(this._clickableIncrementDate),b=b(this._visibleIncrementDate);(this.value||this.currentFocus).getTime();this._refDate=a(this.pickerMin);this._refDate.setFullYear(1970,0,1);this._clickableIncrement=1;this._visibleIncrement=b/c;a=a(this.pickerMax);a.setFullYear(1970,0,1);a=.001*(a.getTime()-this._refDate.getTime());this._maxIncrement=Math.ceil((a+1)/c);c=this._getFilteredNodes();
!c.firstChild&&this.filterString?(this.filterString="",this._showText()):this.domNode.appendChild(c)},constructor:function(){this.constraints={}},postMixInProperties:function(){this.inherited(arguments);this._setConstraintsAttr(this.constraints)},_setConstraintsAttr:function(a){for(var b in{clickableIncrement:1,visibleIncrement:1,pickerMin:1,pickerMax:1})b in a&&(this[b]=a[b]);a.locale||(a.locale=this.lang)},_createOption:function(b){var c=new Date(this._refDate),d=this._clickableIncrementDate;c.setHours(c.getHours()+
d.getHours()*b,c.getMinutes()+d.getMinutes()*b,c.getSeconds()+d.getSeconds()*b);"time"==this.constraints.selector&&c.setFullYear(1970,0,1);var e=a.format(c,this.constraints);if(this.filterString&&0!==e.toLowerCase().indexOf(this.filterString))return null;d=this.ownerDocument.createElement("div");d.className=this.baseClass+"Item";d.date=c;d.idx=b;l.create("div",{"class":this.baseClass+"ItemInner",innerHTML:e},d);e=1>b%this._visibleIncrement&&-1<b%this._visibleIncrement;b=!e&&!(b%this._clickableIncrement);
e?d.className+=" "+this.baseClass+"Marker":b&&(d.className+=" "+this.baseClass+"Tick");this.isDisabledDate(c)&&(d.className+=" "+this.baseClass+"ItemDisabled");this.value&&!k.compare(this.value,c,this.constraints.selector)&&(d.selected=!0,d.className+=" "+this.baseClass+"ItemSelected",this._selectedDiv=d,e?d.className+=" "+this.baseClass+"MarkerSelected":b&&(d.className+=" "+this.baseClass+"TickSelected"),this._highlightOption(d,!0));return d},onOpen:function(){this.inherited(arguments);this.set("selected",
this._selectedDiv)},_onOptionSelected:function(a,b){var c=a.target.date||a.target.parentNode.date;c&&!this.isDisabledDate(c)&&(this._set("value",c),this.emit("input"),b&&(this._highlighted_option=null,this.set("value",c),this.onChange(c)))},onChange:function(){},_highlightOption:function(a,b){if(a){if(b)this._highlighted_option&&this._highlightOption(this._highlighted_option,!1),this._highlighted_option=a;else{if(this._highlighted_option!==a)return;this._highlighted_option=null}e.toggle(a,this.baseClass+
"ItemHover",b);e.contains(a,this.baseClass+"Marker")?e.toggle(a,this.baseClass+"MarkerHover",b):e.toggle(a,this.baseClass+"TickHover",b)}},handleKey:function(a){if(a.keyCode==g.DOWN_ARROW)return this.selectNextNode(),this._onOptionSelected({target:this._highlighted_option},!1),a.stopPropagation(),a.preventDefault(),!1;if(a.keyCode==g.UP_ARROW)return this.selectPreviousNode(),this._onOptionSelected({target:this._highlighted_option},!1),a.stopPropagation(),a.preventDefault(),!1;if(a.keyCode==g.ENTER||
a.keyCode===g.TAB){if(!this._keyboardSelected&&a.keyCode===g.TAB)return!0;this._highlighted_option&&this._onOptionSelected({target:this._highlighted_option},!0);return a.keyCode===g.TAB}},onHover:function(a){this._highlightOption(a,!0)},onUnhover:function(a){this._highlightOption(a,!1)},onSelect:function(a){this._highlightOption(a,!0)},onDeselect:function(a){this._highlightOption(a,!1)},onClick:function(a){this._onOptionSelected({target:a},!0)}})})},"dojo/data/ItemFileReadStore":function(){define("../_base/kernel ../_base/lang ../_base/declare ../_base/array ../_base/xhr ../Evented ./util/filter ./util/simpleFetch ../date/stamp".split(" "),
function(h,k,a,f,b,e,l,m,g){a=a("dojo.data.ItemFileReadStore",[e],{constructor:function(a){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=!1;this.url=this._ccUrl=this._jsonFileUrl=a.url;this._jsonData=a.data;this.data=null;this._datatypeMap=a.typeMap||{};this._datatypeMap.Date||(this._datatypeMap.Date={type:Date,deserialize:function(a){return g.fromISOString(a)}});this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._itemsByIdentity=null;this._storeRefPropName=
"_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=!1;this._queuedFetches=[];void 0!==a.urlPreventCache&&(this.urlPreventCache=a.urlPreventCache?!0:!1);void 0!==a.hierarchical&&(this.hierarchical=a.hierarchical?!0:!1);a.clearOnClose&&(this.clearOnClose=!0);"failOk"in a&&(this.failOk=a.failOk?!0:!1)},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:!1,urlPreventCache:!1,failOk:!1,hierarchical:!0,_assertIsItem:function(a){if(!this.isItem(a))throw Error(this.declaredClass+
": Invalid item argument.");},_assertIsAttribute:function(a){if("string"!==typeof a)throw Error(this.declaredClass+": Invalid attribute argument.");},getValue:function(a,b,e){a=this.getValues(a,b);return 0<a.length?a[0]:e},getValues:function(a,b){this._assertIsItem(a);this._assertIsAttribute(b);return(a[b]||[]).slice(0)},getAttributes:function(a){this._assertIsItem(a);var b=[],d;for(d in a)d!==this._storeRefPropName&&d!==this._itemNumPropName&&d!==this._rootItemPropName&&d!==this._reverseRefMap&&
b.push(d);return b},hasAttribute:function(a,b){this._assertIsItem(a);this._assertIsAttribute(b);return b in a},containsValue:function(a,b,e){var c=void 0;"string"===typeof e&&(c=l.patternToRegExp(e,!1));return this._containsValue(a,b,e,c)},_containsValue:function(a,b,e,g){return f.some(this.getValues(a,b),function(a){if(null!==a&&!k.isObject(a)&&g){if(a.toString().match(g))return!0}else if(e===a)return!0})},isItem:function(a){return a&&a[this._storeRefPropName]===this&&this._arrayOfAllItems[a[this._itemNumPropName]]===
a?!0:!1},isItemLoaded:function(a){return this.isItem(a)},loadItem:function(a){this._assertIsItem(a.item)},getFeatures:function(){return this._features},getLabel:function(a){if(this._labelAttr&&this.isItem(a))return this.getValue(a,this._labelAttr)},getLabelAttributes:function(a){return this._labelAttr?[this._labelAttr]:null},filter:function(a,b,e){var c=[],d,f;if(a.query){var g;d=a.queryOptions?a.queryOptions.ignoreCase:!1;var h={};for(f in a.query)g=a.query[f],"string"===typeof g?h[f]=l.patternToRegExp(g,
d):g instanceof RegExp&&(h[f]=g);for(d=0;d<b.length;++d){var m=!0,n=b[d];if(null===n)m=!1;else for(f in a.query)g=a.query[f],this._containsValue(n,f,g,h[f])||(m=!1);m&&c.push(n)}}else for(d=0;d<b.length;++d)f=b[d],null!==f&&c.push(f);e(c,a)},_fetchItems:function(a,c,e){var d=this;if(this._loadFinished)this.filter(a,this._getItemsArray(a.queryOptions),c);else if(this._jsonFileUrl!==this._ccUrl?(h.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),
this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url),null!=this.data&&(this._jsonData=this.data,this.data=null),this._jsonFileUrl)if(this._loadInProgress)this._queuedFetches.push({args:a,filter:k.hitch(d,"filter"),findCallback:k.hitch(d,c)});else{this._loadInProgress=!0;var f=b.get({url:d._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk});f.addCallback(function(b){try{d._getItemsFromLoadedData(b),
d._loadFinished=!0,d._loadInProgress=!1,d.filter(a,d._getItemsArray(a.queryOptions),c),d._handleQueuedFetches()}catch(u){d._loadFinished=!0,d._loadInProgress=!1,e(u,a)}});f.addErrback(function(b){d._loadInProgress=!1;e(b,a)});var g=null;a.abort&&(g=a.abort);a.abort=function(){var b=f;b&&-1===b.fired&&(b.cancel(),b=null);g&&g.call(a)}}else if(this._jsonData)try{this._loadFinished=!0,this._getItemsFromLoadedData(this._jsonData),this._jsonData=null,d.filter(a,this._getItemsArray(a.queryOptions),c)}catch(v){e(v,
a)}else e(Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),a)},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var a=0;a<this._queuedFetches.length;a++){var b=this._queuedFetches[a],e=b.args,f=b.filter,b=b.findCallback;f?f(e,this._getItemsArray(e.queryOptions),b):this.fetchItemByIdentity(e)}this._queuedFetches=[]}},_getItemsArray:function(a){return a&&a.deep?this._arrayOfAllItems:this._arrayOfTopLevelItems},close:function(a){this.clearOnClose&&
this._loadFinished&&!this._loadInProgress&&(this._arrayOfAllItems=[],this._arrayOfTopLevelItems=[],this._loadFinished=!1,this._itemsByIdentity=null,this._loadInProgress=!1,this._queuedFetches=[])},_getItemsFromLoadedData:function(a){function b(a){return null!==a&&"object"===typeof a&&(!k.isArray(a)||e)&&!k.isFunction(a)&&(a.constructor==Object||k.isArray(a))&&"undefined"===typeof a._reference&&"undefined"===typeof a._type&&"undefined"===typeof a._value&&f.hierarchical}function d(a){f._arrayOfAllItems.push(a);
for(var c in a){var e=a[c];if(e)if(k.isArray(e))for(var g=0;g<e.length;++g){var l=e[g];b(l)&&d(l)}else b(e)&&d(e)}}var e=!1,f=this;this._labelAttr=a.label;var g,l;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=a.items;for(g=0;g<this._arrayOfTopLevelItems.length;++g)l=this._arrayOfTopLevelItems[g],k.isArray(l)&&(e=!0),d(l),l[this._rootItemPropName]=!0;var h={},m;for(g=0;g<this._arrayOfAllItems.length;++g)for(m in l=this._arrayOfAllItems[g],l){if(m!==this._rootItemPropName){var x=l[m];null!==x?
k.isArray(x)||(l[m]=[x]):l[m]=[null]}h[m]=m}for(;h[this._storeRefPropName];)this._storeRefPropName+="_";for(;h[this._itemNumPropName];)this._itemNumPropName+="_";for(;h[this._reverseRefMap];)this._reverseRefMap+="_";if(h=a.identifier)for(this._itemsByIdentity={},this._features["dojo.data.api.Identity"]=h,g=0;g<this._arrayOfAllItems.length;++g)if(l=this._arrayOfAllItems[g],a=l[h],a=a[0],Object.hasOwnProperty.call(this._itemsByIdentity,a)){if(this._jsonFileUrl)throw Error(this.declaredClass+":  The json data as specified by: ["+
this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+h+"].  Value collided: ["+a+"]");if(this._jsonData)throw Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+h+"].  Value collided: ["+a+"]");}else this._itemsByIdentity[a]=l;else this._features["dojo.data.api.Identity"]=Number;for(g=0;g<this._arrayOfAllItems.length;++g)l=this._arrayOfAllItems[g],l[this._storeRefPropName]=this,l[this._itemNumPropName]=
g;for(g=0;g<this._arrayOfAllItems.length;++g)for(m in l=this._arrayOfAllItems[g],l)for(a=l[m],h=0;h<a.length;++h)if(x=a[h],null!==x&&"object"==typeof x){if("_type"in x&&"_value"in x){var y=x._type,A=this._datatypeMap[y];if(A)if(k.isFunction(A))a[h]=new A(x._value);else if(k.isFunction(A.deserialize))a[h]=A.deserialize(x._value);else throw Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");else throw Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+
y+"'");}if(x._reference){x=x._reference;if(k.isObject(x))for(y=0;y<this._arrayOfAllItems.length;++y){var A=this._arrayOfAllItems[y],z=!0,B;for(B in x)A[B]!=x[B]&&(z=!1);z&&(a[h]=A)}else a[h]=this._getItemByIdentity(x);this.referenceIntegrity&&(x=a[h],this.isItem(x)&&this._addReferenceToMap(x,l,m))}else this.isItem(x)&&this.referenceIntegrity&&this._addReferenceToMap(x,l,m)}},_addReferenceToMap:function(a,b,e){},getIdentity:function(a){var b=this._features["dojo.data.api.Identity"];return b===Number?
a[this._itemNumPropName]:(a=a[b])?a[0]:null},fetchItemByIdentity:function(a){var c,d;if(this._loadFinished)c=this._getItemByIdentity(a.identity),a.onItem&&(d=a.scope?a.scope:h.global,a.onItem.call(d,c));else{var e=this;this._jsonFileUrl!==this._ccUrl?(h.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=
this.url);null!=this.data&&null==this._jsonData&&(this._jsonData=this.data,this.data=null);this._jsonFileUrl?this._loadInProgress?this._queuedFetches.push({args:a}):(this._loadInProgress=!0,d=b.get({url:e._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk}),d.addCallback(function(b){var d=a.scope?a.scope:h.global;try{e._getItemsFromLoadedData(b),e._loadFinished=!0,e._loadInProgress=!1,c=e._getItemByIdentity(a.identity),a.onItem&&a.onItem.call(d,c),e._handleQueuedFetches()}catch(v){e._loadInProgress=
!1,a.onError&&a.onError.call(d,v)}}),d.addErrback(function(b){e._loadInProgress=!1;a.onError&&a.onError.call(a.scope?a.scope:h.global,b)})):this._jsonData&&(e._getItemsFromLoadedData(e._jsonData),e._jsonData=null,e._loadFinished=!0,c=e._getItemByIdentity(a.identity),a.onItem&&(d=a.scope?a.scope:h.global,a.onItem.call(d,c)))}},_getItemByIdentity:function(a){var b=null;this._itemsByIdentity?Object.hasOwnProperty.call(this._itemsByIdentity,a)&&(b=this._itemsByIdentity[a]):Object.hasOwnProperty.call(this._arrayOfAllItems,
a)&&(b=this._arrayOfAllItems[a]);void 0===b&&(b=null);return b},getIdentityAttributes:function(a){a=this._features["dojo.data.api.Identity"];return a===Number?null:[a]},_forceLoad:function(){var a=this;this._jsonFileUrl!==this._ccUrl?(h.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url);null!=
this.data&&(this._jsonData=this.data,this.data=null);if(this._jsonFileUrl){var c=b.get({url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:!0});c.addCallback(function(b){try{if(!0!==a._loadInProgress&&!a._loadFinished)a._getItemsFromLoadedData(b),a._loadFinished=!0;else if(a._loadInProgress)throw Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}catch(q){throw q;}});c.addErrback(function(a){throw a;
})}else this._jsonData&&(a._getItemsFromLoadedData(a._jsonData),a._jsonData=null,a._loadFinished=!0)}});k.extend(a,m);return a})},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(h){var k={};h.setObject("dojo.data.util.filter",k);k.patternToRegExp=function(a,f){for(var b="^",e=null,l=0;l<a.length;l++)switch(e=a.charAt(l),e){case "\\":b+=e;l++;b+=a.charAt(l);break;case "*":b+=".*";break;case "?":b+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":b+=
"\\";default:b+=e}b+="$";return f?new RegExp(b,"mi"):new RegExp(b,"m")};return k})},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(h,k,a){var f={};h.setObject("dojo.data.util.simpleFetch",f);f.errorHandler=function(a,e){e.onError&&e.onError.call(e.scope||k.global,a,e)};f.fetchHandler=function(b,e){var f=e.abort||null,h=!1,g=e.start?e.start:0,d=e.count&&Infinity!==e.count?g+e.count:b.length;e.abort=function(){h=!0;f&&f.call(e)};var c=e.scope||
k.global;e.store||(e.store=this);e.onBegin&&e.onBegin.call(c,b.length,e);e.sort&&b.sort(a.createSortFunction(e.sort,this));if(e.onItem)for(var n=g;n<b.length&&n<d;++n){var q=b[n];h||e.onItem.call(c,q,e)}e.onComplete&&!h&&(n=null,e.onItem||(n=b.slice(g,d)),e.onComplete.call(c,n,e))};f.fetch=function(a){a=a||{};a.store||(a.store=this);this._fetchItems(a,h.hitch(this,"fetchHandler"),h.hitch(this,"errorHandler"));return a};return f})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(h){var k=
{};h.setObject("dojo.data.util.sorter",k);k.basicComparator=function(a,f){var b=-1;null===a&&(a=void 0);null===f&&(f=void 0);if(a==f)b=0;else if(a>f||null==a)b=1;return b};k.createSortFunction=function(a,f){function b(a,b,c,d){return function(e,f){var g=d.getValue(e,a),l=d.getValue(f,a);return b*c(g,l)}}for(var e=[],l,h=f.comparatorMap,g=k.basicComparator,d=0;d<a.length;d++){l=a[d];var c=l.attribute;if(c){l=l.descending?-1:1;var n=g;h&&("string"!==typeof c&&"toString"in c&&(c=c.toString()),n=h[c]||
g);e.push(b(c,l,n,f))}}return function(a,b){for(var c=0;c<e.length;){var d=e[c++](a,b);if(0!==d)return d}return 0}};return k})},"dojox/date/islamic":function(){define(["dojox/main","dojo/_base/lang","dojo/date","./islamic/Date"],function(h,k,a,f){var b=k.getObject("date.islamic",!0,h);b.getDaysInMonth=function(a){return a.getDaysInIslamicMonth(a.getMonth(),a.getFullYear())};b.compare=function(b,l,h){b instanceof f&&(b=b.toGregorian());l instanceof f&&(l=l.toGregorian());return a.compare.apply(null,
arguments)};b.add=function(a,b,h){var e=new f(a);switch(b){case "day":e.setDate(a.getDate()+h);break;case "weekday":var d=a.getDay();if(5>d+h&&0<d+h)e.setDate(a.getDate()+h);else{var c=b=0;5==d?(d=4,c=0<h?-1:1):6==d&&(d=4,c=0<h?-2:2);var d=0<h?5-d-1:-d,l=h-d,m=parseInt(l/5);0!=l%5&&(b=0<h?2:-2);b=b+7*m+l%5+d;e.setDate(a.getDate()+b+c)}break;case "year":e.setFullYear(a.getFullYear()+h);break;case "week":h*=7;e.setDate(a.getDate()+h);break;case "month":a=a.getMonth();e.setMonth(a+h);break;case "hour":e.setHours(a.getHours()+
h);break;case "minute":e._addMinutes(h);break;case "second":e._addSeconds(h);break;case "millisecond":e._addMilliseconds(h)}return e};b.difference=function(a,l,h){l=l||new f;h=h||"day";var e=l.getFullYear()-a.getFullYear(),d=1;switch(h){case "weekday":e=Math.round(b.difference(a,l,"day"));d=parseInt(b.difference(a,l,"week"));if(0==e%7)e=5*d;else{h=0;var c=a.getDay(),m=l.getDay(),d=parseInt(e/7);l=e%7;a=new f(a);a.setDate(a.getDate()+7*d);a=a.getDay();if(0<e)switch(!0){case 5==c:h=-1;break;case 6==
c:h=0;break;case 5==m:h=-1;break;case 6==m:h=-2;break;case 5<a+l:h=-2}else if(0>e)switch(!0){case 5==c:h=0;break;case 6==c:h=1;break;case 5==m:h=2;break;case 6==m:h=1;break;case 0>a+l:h=2}e=e+h-2*d}d=e;break;case "year":d=e;break;case "month":h=l.toGregorian()>a.toGregorian()?l:a;c=l.toGregorian()>a.toGregorian()?a:l;d=h.getMonth();m=c.getMonth();if(0==e)d=h.getMonth()-c.getMonth();else for(d=12-m+d,e=c.getFullYear()+1,h=h.getFullYear(),e;e<h;e++)d+=12;l.toGregorian()<a.toGregorian()&&(d=-d);break;
case "week":d=parseInt(b.difference(a,l,"day")/7);break;case "day":d/=24;case "hour":d/=60;case "minute":d/=60;case "second":d/=1E3;case "millisecond":d*=l.toGregorian().getTime()-a.toGregorian().getTime()}return Math.round(d)};return b})},"dojox/main":function(){define(["dojo/_base/kernel"],function(h){return h.dojox})},"dojox/date/islamic/Date":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/date"],function(h,k,a){var f=k("dojox.date.islamic.Date",null,{_date:0,_month:0,_year:0,
_hours:0,_minutes:0,_seconds:0,_milliseconds:0,_day:0,_GREGORIAN_EPOCH:1721425.5,_ISLAMIC_EPOCH:1948439.5,constructor:function(){var a=arguments.length;a?1==a?(a=arguments[0],"number"==typeof a&&(a=new Date(a)),a instanceof Date?this.fromGregorian(a):""==a?this._date=new Date(""):(this._year=a._year,this._month=a._month,this._date=a._date,this._hours=a._hours,this._minutes=a._minutes,this._seconds=a._seconds,this._milliseconds=a._milliseconds)):3<=a&&(this._year+=arguments[0],this._month+=arguments[1],
this._date+=arguments[2],this._hours+=arguments[3]||0,this._minutes+=arguments[4]||0,this._seconds+=arguments[5]||0,this._milliseconds+=arguments[6]||0):this.fromGregorian(new Date)},getDate:function(){return this._date},getMonth:function(){return this._month},getFullYear:function(){return this._year},getDay:function(){return this.toGregorian().getDay()},getHours:function(){return this._hours},getMinutes:function(){return this._minutes},getSeconds:function(){return this._seconds},getMilliseconds:function(){return this._milliseconds},
setDate:function(a){a=parseInt(a);if(!(0<a&&a<=this.getDaysInIslamicMonth(this._month,this._year))){var b;if(0<a)for(b=this.getDaysInIslamicMonth(this._month,this._year);a>b;a-=b,b=this.getDaysInIslamicMonth(this._month,this._year))this._month++,12<=this._month&&(this._year++,this._month-=12);else for(b=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:this._year-1);0>=a;b=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:
this._year-1))this._month--,0>this._month&&(this._year--,this._month+=12),a+=b}this._date=a;return this},setFullYear:function(a){this._year=+a},setMonth:function(a){this._year+=Math.floor(a/12);this._month=0<a?Math.floor(a%12):Math.floor((a%12+12)%12)},setHours:function(){var a=arguments.length,e=0;1<=a&&(e=parseInt(arguments[0]));2<=a&&(this._minutes=parseInt(arguments[1]));3<=a&&(this._seconds=parseInt(arguments[2]));4==a&&(this._milliseconds=parseInt(arguments[3]));for(;24<=e;)this._date++,a=this.getDaysInIslamicMonth(this._month,
this._year),this._date>a&&(this._month++,12<=this._month&&(this._year++,this._month-=12),this._date-=a),e-=24;this._hours=e},_addMinutes:function(a){a+=this._minutes;this.setMinutes(a);this.setHours(this._hours+parseInt(a/60));return this},_addSeconds:function(a){a+=this._seconds;this.setSeconds(a);this._addMinutes(parseInt(a/60));return this},_addMilliseconds:function(a){a+=this._milliseconds;this.setMilliseconds(a);this._addSeconds(parseInt(a/1E3));return this},setMinutes:function(a){this._minutes=
a%60;return this},setSeconds:function(a){this._seconds=a%60;return this},setMilliseconds:function(a){this._milliseconds=a%1E3;return this},toString:function(){if(isNaN(this._date))return"Invalidate Date";var a=new Date;a.setHours(this._hours);a.setMinutes(this._minutes);a.setSeconds(this._seconds);a.setMilliseconds(this._milliseconds);return this._month+" "+this._date+" "+this._year+" "+a.toTimeString()},toGregorian:function(){var b=this._year,b=Math.floor(this._date+Math.ceil(29.5*this._month)+354*
(b-1)+Math.floor((3+11*b)/30)+this._ISLAMIC_EPOCH-1-.5)+.5,e=b-this._GREGORIAN_EPOCH,f=Math.floor(e/146097),h=this._mod(e,146097),e=Math.floor(h/36524),g=this._mod(h,36524),h=Math.floor(g/1461),g=this._mod(g,1461),g=Math.floor(g/365),f=400*f+100*e+4*h+g;4!=e&&4!=g&&f++;e=b-(this._GREGORIAN_EPOCH+365*(f-1)+Math.floor((f-1)/4)-Math.floor((f-1)/100)+Math.floor((f-1)/400));h=this._GREGORIAN_EPOCH-1+365*(f-1)+Math.floor((f-1)/4)-Math.floor((f-1)/100)+Math.floor((f-1)/400)+Math.floor(739/12+(a.isLeapYear(new Date(f,
3,1))?-1:-2)+1);h=b<h?0:a.isLeapYear(new Date(f,3,1))?1:2;e=Math.floor((12*(e+h)+373)/367);h=this._GREGORIAN_EPOCH-1+365*(f-1)+Math.floor((f-1)/4)-Math.floor((f-1)/100)+Math.floor((f-1)/400)+Math.floor((367*e-362)/12+(2>=e?0:a.isLeapYear(new Date(f,e-1,1))?-1:-2)+1);return new Date(f,e-1,b-h+1,this._hours,this._minutes,this._seconds,this._milliseconds)},fromGregorian:function(b){b=new Date(b);var e=b.getFullYear(),f=b.getMonth(),h=b.getDate(),e=this._GREGORIAN_EPOCH-1+365*(e-1)+Math.floor((e-1)/4)+
-Math.floor((e-1)/100)+Math.floor((e-1)/400)+Math.floor((367*(f+1)-362)/12+(2>=f+1?0:a.isLeapYear(b)?-1:-2)+h),e=Math.floor(e)+.5,e=e-this._ISLAMIC_EPOCH,f=Math.floor((30*e+10646)/10631),h=Math.ceil((e-29-this._yearStart(f))/29.5),h=Math.min(h,11);this._date=Math.ceil(e-this._monthStart(f,h))+1;this._month=h;this._year=f;this._hours=b.getHours();this._minutes=b.getMinutes();this._seconds=b.getSeconds();this._milliseconds=b.getMilliseconds();this._day=b.getDay();return this},valueOf:function(){return this.toGregorian().valueOf()},
_yearStart:function(a){return 354*(a-1)+Math.floor((3+11*a)/30)},_monthStart:function(a,e){return Math.ceil(29.5*e)+354*(a-1)+Math.floor((3+11*a)/30)},_civilLeapYear:function(a){return 11>(14+11*a)%30},getDaysInIslamicMonth:function(a,e){var b=0,b=29+(a+1)%2;11==a&&this._civilLeapYear(e)&&b++;return b},_mod:function(a,e){return a-e*Math.floor(a/e)}});f.getDaysInIslamicMonth=function(a){return(new f).getDaysInIslamicMonth(a.getMonth(),a.getFullYear())};return f})},"dojox/date/islamic/locale":function(){define("dojox/main dojo/_base/lang dojo/_base/array dojo/date dojo/i18n dojo/regexp dojo/string ./Date dojo/i18n!dojo/cldr/nls/islamic".split(" "),
function(h,k,a,f,b,e,l,m,g){function d(a,b,c,d,e){return e.replace(/([a-z])\1*/ig,function(c){var d,g,h=c.charAt(0);c=c.length;var m=["abbr","wide","narrow"];switch(h){case "G":d=b.eraAbbr[0];break;case "y":d=String(a.getFullYear());break;case "M":d=a.getMonth();3>c?(d+=1,g=!0):(h=["months-format",m[c-3]].join("-"),d=b[h][d]);break;case "d":d=a.getDate(!0);g=!0;break;case "E":d=a.getDay();3>c?(d+=1,g=!0):(h=["days-format",m[c-3]].join("-"),d=b[h][d]);break;case "a":d=12>a.getHours()?"am":"pm";d=b["dayPeriods-format-wide-"+
d];break;case "h":case "H":case "K":case "k":g=a.getHours();switch(h){case "h":d=g%12||12;break;case "H":d=g;break;case "K":d=g%12;break;case "k":d=g||24}g=!0;break;case "m":d=a.getMinutes();g=!0;break;case "s":d=a.getSeconds();g=!0;break;case "S":d=Math.round(a.getMilliseconds()*Math.pow(10,c-3));g=!0;break;case "z":if(d=f.getTimezoneName(a.toGregorian()))break;c=4;case "Z":d=a.toGregorian().getTimezoneOffset();d=[0>=d?"+":"-",l.pad(Math.floor(Math.abs(d)/60),2),l.pad(Math.abs(d)%60,2)];4==c&&(d.splice(0,
0,"GMT"),d.splice(3,0,":"));d=d.join("");break;default:throw Error("dojox.date.islamic.locale.formatPattern: invalid pattern char: "+e);}g&&(d=l.pad(d,c));return d})}function c(b,c,d,e){var f=function(a){return a};c=c||f;d=d||f;e=e||f;var g=b.match(/(''|[^'])+/g),l="'"==b.charAt(0);a.forEach(g,function(a,b){a?(g[b]=(l?d:c)(a),l=!l):g[b]=""});return e(g.join(""))}function n(a,c,d,f){f=e.escapeString(f);b.normalizeLocale(d.locale);return f.replace(/([a-z])\1*/ig,function(b){var e;e=b.charAt(0);var f=
b.length,g="";d.strict?1<f&&(g="0{"+(f-1)+"}"):g="0?";switch(e){case "y":e="\\d+";break;case "M":e=2<f?"\\S+ ?\\S+":g+"[1-9]|1[0-2]";break;case "d":e="[12]\\d|"+g+"[1-9]|3[01]";break;case "E":e="\\S+";break;case "h":e=g+"[1-9]|1[0-2]";break;case "k":e=g+"\\d|1[01]";break;case "H":e=g+"\\d|1\\d|2[0-3]";break;case "K":e=g+"[1-9]|1\\d|2[0-4]";break;case "m":case "s":e=g+"\\d|[0-5]\\d";break;case "S":e="\\d{"+f+"}";break;case "a":f=d.am||c["dayPeriods-format-wide-am"];g=d.pm||c["dayPeriods-format-wide-pm"];
d.strict?e=f+"|"+g:(e=f+"|"+g,f!=f.toLowerCase()&&(e+="|"+f.toLowerCase()),g!=g.toLowerCase()&&(e+="|"+g.toLowerCase()));break;default:e=".*"}a&&a.push(b);return"("+e+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var q=k.getObject("date.islamic.locale",!0,h);q.format=function(a,e){e=e||{};var f=b.normalizeLocale(e.locale),g=e.formatLength||"short",l=q._getIslamicBundle(f),h=[],f=k.hitch(this,d,a,l,f,e.fullYear);if("year"==e.selector)return a.getFullYear();if("time"!=e.selector){var m=e.datePattern||l["dateFormat-"+
g];m&&h.push(c(m,f))}"date"!=e.selector&&(g=e.timePattern||l["timeFormat-"+g])&&h.push(c(g,f));return h.join(" ")};q.regexp=function(a){return q._parseInfo(a).regexp};q._parseInfo=function(a){a=a||{};var d=b.normalizeLocale(a.locale),d=q._getIslamicBundle(d),e=a.formatLength||"short",f=a.datePattern||d["dateFormat-"+e],e=a.timePattern||d["timeFormat-"+e],g=[];return{regexp:c("date"==a.selector?f:"time"==a.selector?e:"undefined"==typeof e?f:f+" "+e,k.hitch(this,n,g,d,a)),tokens:g,bundle:d}};q.parse=
function(c,d){c=c.replace(/[\u200E\u200F\u202A\u202E]/g,"");d||(d={});var e=q._parseInfo(d),f=e.tokens,g=e.bundle,e=e.regexp.replace(/[\u200E\u200F\u202A\u202E]/g,""),e=(new RegExp("^"+e+"$")).exec(c);b.normalizeLocale(d.locale);if(!e)return null;var l=[1389,0,1,0,0,0,0],h="",n=["abbr","wide","narrow"];a.every(e,function(b,c){if(!c)return!0;var e=f[c-1],m=e.length;switch(e.charAt(0)){case "y":l[0]=Number(b);break;case "M":if(2<m){if(e=g["months-format-"+n[m-3]].concat(),d.strict||(b=b.replace(".",
"").toLowerCase(),e=a.map(e,function(a){return a?a.replace(".","").toLowerCase():a})),b=a.indexOf(e,b),-1==b)return!1}else b--;l[1]=Number(b);break;case "D":l[1]=0;case "d":l[2]=Number(b);break;case "a":e=d.am||g["dayPeriods-format-wide-am"];m=d.pm||g["dayPeriods-format-wide-pm"];if(!d.strict){var k=/\./g;b=b.replace(k,"").toLowerCase();e=e.replace(k,"").toLowerCase();m=m.replace(k,"").toLowerCase()}if(d.strict&&b!=e&&b!=m)return!1;h=b==m?"p":b==e?"a":"";break;case "K":24==b&&(b=0);case "h":case "H":case "k":l[3]=
Number(b);break;case "m":l[4]=Number(b);break;case "s":l[5]=Number(b);break;case "S":l[6]=Number(b)}return!0});e=+l[3];"p"===h&&12>e?l[3]=e+12:"a"===h&&12==e&&(l[3]=0);return new m(l[0],l[1],l[2],l[3],l[4],l[5],l[6])};var t=[];q.addCustomFormats=function(a,b){t.push({pkg:a,name:b})};q._getIslamicBundle=function(c){var d={};a.forEach(t,function(a){a=b.getLocalization(a.pkg,a.name,c);d=k.mixin(d,a)},this);return d};q.addCustomFormats("dojo.cldr","islamic");q.getNames=function(a,b,c,d,e){var f;d=q._getIslamicBundle(d);
a=[a,c,b];"standAlone"==c&&(c=a.join("-"),f=d[c],1==f[0]&&(f=void 0));a[1]="format";return(f||d[a.join("-")]).concat()};q.weekDays=q.getNames("days","wide","format");q.months=q.getNames("months","wide","format");return q})},"dojo/cldr/nls/islamic":function(){define({root:{"dateFormatItem-Ehm":"E h:mm a","days-standAlone-short":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"months-format-narrow":"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),"field-second-relative+0":"now","quarters-standAlone-narrow":["1","2",
"3","4"],"field-weekday":"Day of the Week","field-wed-relative+0":"this Wednesday","field-wed-relative+1":"next Wednesday","dateFormatItem-GyMMMEd":"G y MMM d, E","dateFormatItem-MMMEd":"MMM d, E",eraNarrow:["AH"],"field-tue-relative+-1":"last Tuesday","days-format-short":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dateTimeFormats-appendItem-Day-Of-Week":"{0} {1}","dateFormat-long":"G y MMMM d","field-fri-relative+-1":"last Friday","field-wed-relative+-1":"last Wednesday","months-format-wide":"Muharram;Safar;Rabi\u02bb I;Rabi\u02bb II;Jumada I;Jumada II;Rajab;Sha\u02bbban;Ramadan;Shawwal;Dhu\u02bbl-Qi\u02bbdah;Dhu\u02bbl-Hijjah".split(";"),
"dateFormatItem-yyyyQQQ":"G y QQQ","dateTimeFormat-medium":"{1} {0}","dayPeriods-format-wide-pm":"PM","dateFormat-full":"G y MMMM d, EEEE","dateFormatItem-yyyyMEd":"GGGGG y-MM-dd, E","field-thu-relative+-1":"last Thursday","dateFormatItem-Md":"MM-dd","dayPeriods-format-abbr-am":"AM","dateTimeFormats-appendItem-Second":"{0} ({2}: {1})","dayPeriods-format-wide-noon":"noon","field-era":"Era","months-standAlone-wide":"Muharram;Safar;Rabi\u02bb I;Rabi\u02bb II;Jumada I;Jumada II;Rajab;Sha\u02bbban;Ramadan;Shawwal;Dhu\u02bbl-Qi\u02bbdah;Dhu\u02bbl-Hijjah".split(";"),
"timeFormat-short":"HH:mm","quarters-format-wide":["Q1","Q2","Q3","Q4"],"timeFormat-long":"HH:mm:ss z","field-year":"Year","dateTimeFormats-appendItem-Era":"{1} {0}","field-hour":"Hour","months-format-abbr":"Muh.;Saf.;Rab. I;Rab. II;Jum. I;Jum. II;Raj.;Sha.;Ram.;Shaw.;Dhu\u02bbl-Q.;Dhu\u02bbl-H.".split(";"),"field-sat-relative+0":"this Saturday","field-sat-relative+1":"next Saturday","timeFormat-full":"HH:mm:ss zzzz","dateTimeFormats-appendItem-Week":"{0} ({2}: {1})","field-day-relative+0":"today",
"field-thu-relative+0":"this Thursday","field-day-relative+1":"tomorrow","field-thu-relative+1":"next Thursday","dateFormatItem-GyMMMd":"G y MMM d","dateFormatItem-H":"HH","months-standAlone-abbr":"Muh.;Saf.;Rab. I;Rab. II;Jum. I;Jum. II;Raj.;Sha.;Ram.;Shaw.;Dhu\u02bbl-Q.;Dhu\u02bbl-H.".split(";"),"quarters-format-abbr":["Q1","Q2","Q3","Q4"],"quarters-standAlone-wide":["Q1","Q2","Q3","Q4"],"dateFormatItem-Gy":"G y","dateFormatItem-yyyyMMMEd":"G y MMM d, E","dateFormatItem-M":"L","days-standAlone-wide":"Sun Mon Tue Wed Thu Fri Sat".split(" "),
"dateFormatItem-yyyyMMM":"G y MMM","dateFormatItem-yyyyMMMd":"G y MMM d","dayPeriods-format-abbr-noon":"noon","timeFormat-medium":"HH:mm:ss","field-sun-relative+0":"this Sunday","dateFormatItem-Hm":"HH:mm","field-sun-relative+1":"next Sunday","quarters-standAlone-abbr":["Q1","Q2","Q3","Q4"],eraAbbr:["AH"],"field-minute":"Minute","field-dayperiod":"Dayperiod","days-standAlone-abbr":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"dateFormatItem-d":"d","dateFormatItem-ms":"mm:ss","quarters-format-narrow":["1",
"2","3","4"],"field-day-relative+-1":"yesterday","dateTimeFormat-long":"{1} {0}","dayPeriods-format-narrow-am":"a","dateFormatItem-h":"h a","dateFormatItem-MMMd":"MMM d","dateFormatItem-MEd":"MM-dd, E","dateTimeFormat-full":"{1} {0}","field-fri-relative+0":"this Friday","field-fri-relative+1":"next Friday","field-day":"Day","days-format-wide":"Sun Mon Tue Wed Thu Fri Sat".split(" "),"field-zone":"Zone","months-standAlone-narrow":"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),"dateFormatItem-y":"G y","dateTimeFormats-appendItem-Day":"{0} ({2}: {1})",
"field-year-relative+-1":"last year","field-month-relative+-1":"last month","dateTimeFormats-appendItem-Year":"{1} {0}","dateFormatItem-hm":"h:mm a","dateTimeFormats-appendItem-Hour":"{0} ({2}: {1})","dayPeriods-format-abbr-pm":"PM","days-format-abbr":"Sun Mon Tue Wed Thu Fri Sat".split(" "),eraNames:["AH"],"days-format-narrow":"SMTWTFS".split(""),"dateFormatItem-yyyyMd":"GGGGG y-MM-dd","field-month":"Month","days-standAlone-narrow":"SMTWTFS".split(""),"dateFormatItem-MMM":"LLL","field-tue-relative+0":"this Tuesday",
"field-tue-relative+1":"next Tuesday","dateTimeFormats-appendItem-Quarter":"{0} ({2}: {1})","dayPeriods-format-wide-am":"AM","dateTimeFormats-appendItem-Month":"{0} ({2}: {1})","dateTimeFormats-appendItem-Minute":"{0} ({2}: {1})","dateFormatItem-EHm":"E HH:mm","field-mon-relative+0":"this Monday","field-mon-relative+1":"next Monday","dateFormat-short":"GGGGG y-MM-dd","dateFormatItem-EHms":"E HH:mm:ss","dateFormatItem-Ehms":"E h:mm:ss a","dayPeriods-format-narrow-noon":"n","field-second":"Second",
"field-sat-relative+-1":"last Saturday","field-sun-relative+-1":"last Sunday","field-month-relative+0":"this month","field-month-relative+1":"next month","dateTimeFormats-appendItem-Timezone":"{0} {1}","dateFormatItem-Ed":"d, E","field-week":"Week","dateFormat-medium":"G y MMM d","field-week-relative+-1":"last week","field-year-relative+0":"this year","dateFormatItem-yyyyM":"GGGGG y-MM","field-year-relative+1":"next year","dayPeriods-format-narrow-pm":"p","dateFormatItem-yyyyQQQQ":"G y QQQQ","dateTimeFormat-short":"{1} {0}",
"dateFormatItem-Hms":"HH:mm:ss","dateFormatItem-hms":"h:mm:ss a","dateFormatItem-GyMMM":"G y MMM","field-mon-relative+-1":"last Monday","dateFormatItem-yyyy":"G y","field-week-relative+0":"this week","field-week-relative+1":"next week"},ar:!0,bs:!0,cs:!0,da:!0,de:!0,en:!0,"en-au":!0,"en-gb":!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hi:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,pt:!0,"pt-pt":!0,ro:!0,ru:!0,sr:!0,sv:!0,th:!0,tr:!0,vi:!0,zh:!0,"zh-hant":!0})},"dojo/cldr/nls/en/islamic":function(){define({"field-second-relative+0":"now",
"field-weekday":"Day of the Week","field-wed-relative+0":"this Wednesday","field-wed-relative+1":"next Wednesday","dateFormatItem-GyMMMEd":"E, MMM d, y G","dateFormatItem-MMMEd":"E, MMM d","field-tue-relative+-1":"last Tuesday","days-format-short":"Su Mo Tu We Th Fr Sa".split(" "),"dateFormat-long":"MMMM d, y G","field-fri-relative+-1":"last Friday","field-wed-relative+-1":"last Wednesday","dateFormatItem-yyyyQQQ":"QQQ y G","dateTimeFormat-medium":"{1}, {0}","dateFormat-full":"EEEE, MMMM d, y G",
"dateFormatItem-yyyyMEd":"E, M/d/y GGGGG","field-thu-relative+-1":"last Thursday","dateFormatItem-Md":"M/d","field-era":"Era","timeFormat-short":"h:mm a","quarters-format-wide":["1st quarter","2nd quarter","3rd quarter","4th quarter"],"timeFormat-long":"h:mm:ss a z","field-year":"Year","dateTimeFormats-appendItem-Era":"{0} {1}","field-hour":"Hour","field-sat-relative+0":"this Saturday","field-sat-relative+1":"next Saturday","timeFormat-full":"h:mm:ss a zzzz","field-day-relative+0":"today","field-thu-relative+0":"this Thursday",
"field-day-relative+1":"tomorrow","field-thu-relative+1":"next Thursday","dateFormatItem-GyMMMd":"MMM d, y G","dateFormatItem-Gy":"y G","dateFormatItem-yyyyMMMEd":"E, MMM d, y G","dateFormatItem-yyyyMMM":"MMM y G","dateFormatItem-yyyyMMMd":"MMM d, y G","timeFormat-medium":"h:mm:ss a","field-sun-relative+0":"this Sunday","field-sun-relative+1":"next Sunday",eraAbbr:["AH"],"field-minute":"Minute","field-dayperiod":"AM/PM","field-day-relative+-1":"yesterday","dateTimeFormat-long":"{1} 'at' {0}","dateFormatItem-MEd":"E, M/d",
"dateTimeFormat-full":"{1} 'at' {0}","field-fri-relative+0":"this Friday","field-fri-relative+1":"next Friday","field-day":"Day","days-format-wide":"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),"field-zone":"Time Zone","dateFormatItem-y":"y G","field-year-relative+-1":"last year","field-month-relative+-1":"last month","dateTimeFormats-appendItem-Year":"{0} {1}","dateFormatItem-yyyyMd":"M/d/y GGGGG","field-month":"Month","field-tue-relative+0":"this Tuesday","field-tue-relative+1":"next Tuesday",
"field-mon-relative+0":"this Monday","field-mon-relative+1":"next Monday","dateFormat-short":"M/d/y GGGGG","field-second":"Second","field-sat-relative+-1":"last Saturday","field-sun-relative+-1":"last Sunday","field-month-relative+0":"this month","field-month-relative+1":"next month","dateFormatItem-Ed":"d E","field-week":"Week","dateFormat-medium":"MMM d, y G","field-year-relative+0":"this year","field-week-relative+-1":"last week","dateFormatItem-yyyyM":"M/y GGGGG","field-year-relative+1":"next year",
"dateFormatItem-yyyyQQQQ":"QQQQ y G","dateTimeFormat-short":"{1}, {0}","dateFormatItem-GyMMM":"MMM y G","field-mon-relative+-1":"last Monday","dateFormatItem-yyyy":"y G","field-week-relative+0":"this week","field-week-relative+1":"next week"})},"esri/dijit/editing/Add":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ./EditOperationBase".split(" "),function(h,k,a,f,b,e){k=k(e,{declaredClass:"esri.dijit.editing.Add",type:"edit",label:"Add Features",constructor:function(a){return a=
a||{},a.featureLayer?(this._featureLayer=a.featureLayer,a.addedGraphics?void(this._addedGraphics=a.addedGraphics):void console.error("In constructor of 'esri.dijit.editing.Add', no graphics provided")):void console.error("In constructor of 'esri.dijit.editing.Add', featureLayer is not provided")},updateObjectIds:function(a,b){this.updateIds(this._featureLayer,this._addedGraphics,a,b)},performUndo:function(){return this._featureLayer.applyEdits(null,null,this._addedGraphics).then(a.hitch(this,function(){return{layer:this._featureLayer,
operation:this}}))},performRedo:function(){var b=h.map(this._addedGraphics,function(a){return a.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._addedGraphics,null,null).then(a.hitch(this,function(a,e,d){a=h.map(a,function(a){return a.objectId});return{oldIds:b,addedIds:a,layer:this._featureLayer,operation:this}}))}});return f("extend-esri")&&a.setObject("dijit.editing.Add",k,b),k})},"esri/dijit/editing/EditOperationBase":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/has","../../kernel","../../OperationBase"],function(h,k,a,f,b){k=k(b,{declaredClass:"esri.EditOperationBase",updateIds:function(a,b,f,g){h.forEach(b,function(b,c){var d=b[a.objectIdField];h.forEach(f,function(c,e){d===c&&(b[a.objectIdField]=g[e])})})}});return a("extend-esri")&&(f.EditOperationBase=k),k})},"esri/OperationBase":function(){define(["dojo/_base/declare","dojo/has","./kernel"],function(h,k,a){h=h(null,{declaredClass:"esri.OperationBase",type:"not implemented",
label:"not implemented",constructor:function(a){a=a||{};a.label&&(this.label=a.label)},performUndo:function(){},performRedo:function(){}});return k("extend-esri")&&(a.OperationBase=h),h})},"esri/dijit/editing/Update":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/jsonUtils ./EditOperationBase".split(" "),function(h,k,a,f,b,e,l){h=k(l,{declaredClass:"esri.dijit.editing.Update",type:"edit",label:"Update Features",constructor:function(b){var e;
if(b=b||{},!b.featureLayer)return void console.error("In constructor of 'esri.dijit.editing.Update', featureLayer not provided");if(this._featureLayer=b.featureLayer,!b.preUpdatedGraphics)return void console.error("In constructor of 'esri.dijit.editing.Update', preUpdatedGraphics not provided");this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(e=0;e<b.preUpdatedGraphics.length;e++)this._preUpdatedGraphicsGeometries.push(b.preUpdatedGraphics[e].geometry.toJson()),this._preUpdatedGraphicsAttributes.push(b.preUpdatedGraphics[e].attributes);
if(!b.postUpdatedGraphics)return void console.error("In constructor of 'esri.dijit.editing.Update', postUpdatedGraphics not provided");this._postUpdatedGraphics=b.postUpdatedGraphics;this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];for(e=0;e<b.postUpdatedGraphics.length;e++)b.postUpdatedGraphics[e].geometry?this._postUpdatedGraphicsGeometries.push(b.postUpdatedGraphics[e].geometry.toJson()):this._postUpdatedGraphicsGeometries.push(b.postUpdatedGraphics[e].geometry),this._postUpdatedGraphicsAttributes.push(a.clone(b.postUpdatedGraphics[e].attributes))},
updateObjectIds:function(a,b){this.updateIds(this._featureLayer,this._preUpdatedGraphicsAttributes,a,b);this.updateIds(this._featureLayer,this._postUpdatedGraphicsAttributes,a,b)},performUndo:function(){var b;for(b=0;b<this._postUpdatedGraphics.length;b++)this._preUpdatedGraphicsGeometries[b]?this._postUpdatedGraphics[b].setGeometry(e.fromJson(this._preUpdatedGraphicsGeometries[b])):this._postUpdatedGraphics[b].setGeometry(this._preUpdatedGraphicsGeometries[b]),this._postUpdatedGraphics[b].setAttributes(this._preUpdatedGraphicsAttributes[b]);
return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null).then(a.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))},performRedo:function(){var b;for(b=0;b<this._postUpdatedGraphics.length;b++)this._postUpdatedGraphicsGeometries[b]?this._postUpdatedGraphics[b].setGeometry(e.fromJson(this._postUpdatedGraphicsGeometries[b])):this._postUpdatedGraphics[b].setGeometry(this._postUpdatedGraphicsGeometries[b]),this._postUpdatedGraphics[b].setAttributes(this._postUpdatedGraphicsAttributes[b]);
return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,null).then(a.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))}});return f("extend-esri")&&a.setObject("dijit.editing.Update",h,b),h})},"esri/dijit/editing/Delete":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ./EditOperationBase".split(" "),function(h,k,a,f,b,e){k=k(e,{declaredClass:"esri.dijit.editing.Delete",type:"edit",label:"Delete Features",constructor:function(a){return a=
a||{},a.featureLayer?(this._featureLayer=a.featureLayer,a.deletedGraphics?void(this._deletedGraphics=a.deletedGraphics):void console.error("In constructor of 'esri.dijit.editing.Delete', no graphics provided")):void console.error("In constructor of 'esri.dijit.editing.Delete', featureLayer is not provided")},updateObjectIds:function(a,b){this.updateIds(this._featureLayer,this._deletedGraphics,a,b)},performUndo:function(){var b=h.map(this._deletedGraphics,function(a){return a.attributes[this._featureLayer.objectIdField]},
this);return this._featureLayer.applyEdits(this._deletedGraphics,null,null).then(a.hitch(this,function(a,e,d){a=h.map(a,function(a){return a.objectId});return{oldIds:b,addedIds:a,layer:this._featureLayer,operation:this}}))},performRedo:function(){return this._featureLayer.applyEdits(null,null,this._deletedGraphics).then(a.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))}});return f("extend-esri")&&a.setObject("dijit.editing.Delete",k,b),k})},"esri/dijit/editing/Cut":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/jsonUtils ./EditOperationBase".split(" "),
function(h,k,a,f,b,e,l){k=k(l,{declaredClass:"esri.dijit.editing.Cut",type:"edit",label:"Cut Features",constructor:function(b){var e;if(b=b||{},!b.featureLayer)return void console.error("In constructor of 'esri.dijit.editing.Cut', featureLayer not provided");if(this._featureLayer=b.featureLayer,!b.addedGraphics)return void console.error("In constructor of 'esri.dijit.editing.Cut', addedGraphics for cut not provided");if(this._addedGraphics=b.addedGraphics,!b.preUpdatedGraphics)return void console.error("In constructor of 'esri.dijit.editing.Cut', preUpdatedGraphics not provided");
this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];for(e=0;e<b.preUpdatedGraphics.length;e++)this._preUpdatedGraphicsGeometries.push(b.preUpdatedGraphics[e].geometry.toJson()),this._preUpdatedGraphicsAttributes.push(b.preUpdatedGraphics[e].attributes);if(!b.postUpdatedGraphics)return void console.error("In constructor of 'esri.dijit.editing.Cut', postUpdatedGraphics not provided");this._postUpdatedGraphics=b.postUpdatedGraphics;this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=
[];for(e=0;e<b.postUpdatedGraphics.length;e++)this._postUpdatedGraphicsGeometries.push(b.postUpdatedGraphics[e].geometry.toJson()),this._postUpdatedGraphicsAttributes.push(a.clone(b.postUpdatedGraphics[e].attributes))},updateObjectIds:function(a,b){this.updateIds(this._featureLayer,this._preUpdatedGraphicsAttributes,a,b);this.updateIds(this._featureLayer,this._postUpdatedGraphicsAttributes,a,b);this.updateIds(this._featureLayer,this._addedGraphics,a,b)},performUndo:function(){var b;for(b=0;b<this._postUpdatedGraphics.length;b++)this._postUpdatedGraphics[b].setGeometry(e.fromJson(this._preUpdatedGraphicsGeometries[b])),
this._postUpdatedGraphics[b].setAttributes(this._preUpdatedGraphicsAttributes[b]);return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,this._addedGraphics).then(a.hitch(this,function(){return{layer:this._featureLayer,operation:this}}))},performRedo:function(){var b;for(b=0;b<this._postUpdatedGraphics.length;b++)this._postUpdatedGraphics[b].setGeometry(e.fromJson(this._postUpdatedGraphicsGeometries[b])),this._postUpdatedGraphics[b].setAttributes(this._postUpdatedGraphicsAttributes[b]);
var f=h.map(this._addedGraphics,function(a){return a.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._addedGraphics,this._postUpdatedGraphics,null).then(a.hitch(this,function(a,b,e){a=h.map(a,function(a){return a.objectId});return{oldIds:f,addedIds:a,layer:this._featureLayer,operation:this}}))}});return f("extend-esri")&&a.setObject("dijit.editing.Cut",k,b),k})},"esri/dijit/editing/Union":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/jsonUtils ./EditOperationBase".split(" "),
function(h,k,a,f,b,e,l){k=k(l,{declaredClass:"esri.dijit.editing.Union",type:"edit",label:"Union Features",constructor:function(b){b=b||{};this._featureLayer=b.featureLayer;this._deletedGraphics=b.deletedGraphics;this._preUpdatedGraphics=b.preUpdatedGraphics;this._postUpdatedGraphics=b.postUpdatedGraphics;this._preUpdatedGraphicsGeometries=[];this._preUpdatedGraphicsAttributes=[];this._postUpdatedGraphicsGeometries=[];this._postUpdatedGraphicsAttributes=[];var e;for(e=0;e<b.preUpdatedGraphics.length;e++)this._preUpdatedGraphicsGeometries.push(b.preUpdatedGraphics[e].geometry.toJson()),
this._preUpdatedGraphicsAttributes.push(b.preUpdatedGraphics[e].attributes);for(e=0;e<b.postUpdatedGraphics.length;e++)this._postUpdatedGraphicsGeometries.push(b.postUpdatedGraphics[e].geometry.toJson()),this._postUpdatedGraphicsAttributes.push(a.clone(b.postUpdatedGraphics[e].attributes))},updateObjectIds:function(a,b){this.updateIds(this._featureLayer,this._preUpdatedGraphicsAttributes,a,b);this.updateIds(this._featureLayer,this._postUpdatedGraphicsAttributes,a,b);this.updateIds(this._featureLayer,
this._deletedGraphics,a,b)},performUndo:function(){var b;for(b=0;b<this._postUpdatedGraphics.length;b++)this._postUpdatedGraphics[b].setGeometry(e.fromJson(this._preUpdatedGraphicsGeometries[b])),this._postUpdatedGraphics[b].setAttributes(this._preUpdatedGraphicsAttributes[b]);var f=h.map(this._deletedGraphics,function(a){return a.attributes[this._featureLayer.objectIdField]},this);return this._featureLayer.applyEdits(this._deletedGraphics,this._postUpdatedGraphics,null).then(a.hitch(this,function(a,
b,e){a=h.map(a,function(a){return a.objectId});return{oldIds:f,addedIds:a,layer:this._featureLayer,operation:this}}))},performRedo:function(){var b;for(b=0;b<this._postUpdatedGraphics.length;b++)this._postUpdatedGraphics[b].setGeometry(e.fromJson(this._postUpdatedGraphicsGeometries[b])),this._postUpdatedGraphics[b].setAttributes(this._postUpdatedGraphicsAttributes[b]);return this._featureLayer.applyEdits(null,this._postUpdatedGraphics,this._deletedGraphics).then(a.hitch(this,function(){return{layer:this._featureLayer,
operation:this}}))}});return f("extend-esri")&&a.setObject("dijit.editing.Union",k,b),k})},"esri/dijit/editing/toolbars/Drawing":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dijit/_CssStateMixin ../Util ./ToolbarBase ../tools/ButtonToolBase ../tools/Cut ../tools/Union ../tools/Reshape ../tools/Editing ../tools/EditingTools ../tools/Selection ../tools/SelectionTools ../../../kernel".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u){h=h([m,
e],{declaredClass:"esri.dijit.editing.toolbars.Drawing",onShowAttributeInspector:function(){},_activateTool:function(a,b){this._settings.editor._activeTool=a;"EDITING"!==a&&this._settings.templatePicker.clearSelection();"ATTRIBUTES"!==a&&this._settings.editor._hideAttributeInspector();"CLEAR"!==a&&this.inherited(arguments)},_initializeToolbar:function(){a.forEach(this._settings.layers,function(a){this._tbConnects.push(f.connect(a,"onSelectionComplete",this,"_updateUI"))},this)},activateEditing:function(a,
b){this._tools.EDITING._activateTool(a,b.geometryType);this._activeTool=this._tools.EDITING;this._activeTool.setChecked(!0)},_updateUI:function(){this._settings.undoManager&&(this._tools.UNDO.set("disabled",!1===this._settings.undoManager.canUndo),this._tools.REDO.set("disabled",!1===this._settings.undoManager.canRedo));this._selectedFeatures=l.getSelection(this._settings.layers);var a=this._selectedFeatures.length;this._tools.DELETE&&this._tools.DELETE.set("disabled",0>=a);this._tools.CLEAR&&this._tools.CLEAR.set("disabled",
0>=a);this._tools.ATTRIBUTES&&this._tools.ATTRIBUTES.set("disabled",0>=a);this._tools.UNION&&this._tools.UNION.set("disabled",2>a)},_toolFinished:function(a){"ATTRIBUTES"===a&&this._selectedFeatures&&this._selectedFeatures.length&&this.onShowAttributeInspector(this._selectedFeatures[0]);("SELECT"===a||"CUT"===a||"RESHAPING"===a||"EDITING"===a)&&(this._activeTool.deactivate(),this._activeTool.setChecked(!1),this._activeTool=null);"DELETE"===a&&this.onDelete();this._settings.editor._activeTool=null;
this._updateUI()},_createTools:function(){this._tools.SELECT=new r({settings:this._settings,onClick:k.hitch(this,"_activateTool","SELECT",!0),onFinished:k.hitch(this,"_toolFinished","SELECT")});this.addChild(this._tools.SELECT);this._tools.CLEAR=new g(k.mixin(v.selectClear,{settings:this._settings,onClick:k.hitch(this._settings.editor,"_clearSelection",!1)}));this.addChild(this._tools.CLEAR);this._createSeparator();this._tools.ATTRIBUTES=new g(k.mixin(t.attributes,{settings:this._settings,onClick:k.hitch(this,
"_toolFinished","ATTRIBUTES")}));this.addChild(this._tools.ATTRIBUTES);this._createSeparator();this._tools.EDITING=new q({settings:this._settings,onClick:k.hitch(this,"_activateTool","EDITING",!0),onApplyEdits:k.hitch(this,"onApplyEdits"),onFinished:k.hitch(this,"_toolFinished","EDITING")});this.addChild(this._tools.EDITING);this._tools.DELETE=new g(k.mixin(t.del,{settings:this._settings,onClick:k.hitch(this,"_toolFinished","DELETE")}));this.addChild(this._tools.DELETE);this._settings.toolbarOptions&&
((this._settings.toolbarOptions.cutVisible||this._settings.toolbarOptions.mergeVisible||this._settings.toolbarOptions.reshapeVisible)&&this._createSeparator(),this._settings.toolbarOptions.cutVisible&&(this._tools.CUT=new d({settings:this._settings,onFinished:k.hitch(this,"_toolFinished","CUT"),onClick:k.hitch(this,"_activateTool","CUT",!0),onApplyEdits:k.hitch(this,"onApplyEdits")}),this.addChild(this._tools.CUT)),this._settings.toolbarOptions.mergeVisible&&(this._tools.UNION=new c({settings:this._settings,
onFinished:k.hitch(this,"_toolFinished","UNION"),onApplyEdits:k.hitch(this,"onApplyEdits")}),this.addChild(this._tools.UNION)),this._settings.toolbarOptions.reshapeVisible&&(this._tools.RESHAPING=new n({settings:this._settings,onClick:k.hitch(this,"_activateTool","RESHAPING",!0),onFinished:k.hitch(this,"_toolFinished","RESHAPING"),onApplyEdits:k.hitch(this,"onApplyEdits")}),this.addChild(this._tools.RESHAPING)));this._settings.enableUndoRedo&&(this._createSeparator(),this._tools.UNDO=new g(k.mixin(t.undo,
{settings:this._settings,disabled:!0,onClick:k.hitch(this,function(){this._tools.UNDO.set("disabled",!0);this._tools.REDO.set("disabled",!0);this._settings.editor._undo()})})),this.addChild(this._tools.UNDO),this._tools.REDO=new g(k.mixin(t.redo,{settings:this._settings,disabled:!0,onClick:k.hitch(this,function(){this._tools.UNDO.set("disabled",!0);this._tools.REDO.set("disabled",!0);this._settings.editor._redo()})})),this.addChild(this._tools.REDO))}});return b("extend-esri")&&k.setObject("dijit.editing.toolbars.Drawing",
h,u),h})},"esri/dijit/editing/toolbars/ToolbarBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dijit/Toolbar dijit/ToolbarSeparator ../../../kernel ../../../lang".split(" "),function(h,k,a,f,b,e,l,m,g){h=h([e],{declaredClass:"esri.dijit.editing.toolbars.ToolbarBase",_enabled:!0,graphicsAdded:function(){},drawEnd:function(){},onApplyEdits:function(){},onDelete:function(){},constructor:function(a,b){a&&a.settings&&(this._tools=[],this._tbConnects=
[],this._initialize(a.settings))},postCreate:function(){this._createTools();this.deactivate()},destroy:function(){var b,c=this._tools;for(b in c)c.hasOwnProperty(b)&&g.isDefined(this._tools[b])&&this._tools[b].destroy();a.forEach(this._tbConnects,f.disconnect);this.inherited(arguments)},activate:function(a){this._enabled=!0},deactivate:function(){var a;this._enabled=!1;this._geometryType=this._layer=null;var b=this._tools;for(a in b)b.hasOwnProperty(a)&&(this._tools[a].deactivate(),this._tools[a].setChecked(!1))},
isEnabled:function(){return this._enabled},setActiveSymbol:function(a){this._activeSymbol=a},_getSymbol:function(){},_createTools:function(){},_initialize:function(a){this._settings=a;this._toolbar=a.drawToolbar;this._editToolbar=a.editToolbar;this._initializeToolbar()},_activateTool:function(a,b){this._activeTool&&this._activeTool.deactivate();!0===b&&this._activeTool==this._tools[a]?(this._activeTool.setChecked(!1),this._activeTool=null):(this._activeTool=this._tools[a],this._activeTool.setChecked(!0),
this._activeTool.activate(null))},_createSeparator:function(){this.addChild(new l)}});return b("extend-esri")&&k.setObject("dijit.editing.toolbars.ToolbarBase",h,m),h})},"esri/dijit/editing/tools/ButtonToolBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dijit/form/Button ./ToolBase ../../../kernel".split(" "),function(h,k,a,f,b,e){h=h([f,b],{declaredClass:"esri.dijit.editing.tools.ButtonToolBase",postCreate:function(){this.inherited(arguments);this._setShowLabelAttr&&this._setShowLabelAttr(!1)},
destroy:function(){f.prototype.destroy.apply(this,arguments);b.prototype.destroy.apply(this,arguments)}});return a("extend-esri")&&k.setObject("dijit.editing.tools.ButtonToolBase",h,e),h})},"esri/dijit/editing/tools/ToolBase":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../../../kernel","dojo/i18n!../../../nls/jsapi"],function(h,k,a,f,b){h=h(null,{declaredClass:"esri.dijit.editing.tools.ToolBase",_enabled:!0,showLabel:!1,constructor:function(a,f){a=a||{};k.mixin(this,a);this.label=
this._label?b.widgets.editor.tools[this._label]:"";this._settings=a.settings;this._toolbar=a.settings.drawToolbar;this._editToolbar=a.settings.editToolbar;this._initializeTool()},onFinished:function(){},onDrawEnd:function(){},onApplyEdits:function(){},postCreate:function(){this.deactivate();this.inherited(arguments)},destroy:function(){},activate:function(a){this._toolbar&&this._toolbar.deactivate();this._editToolbar&&this._editToolbar.deactivate();this._enabled&&(this._checked=!0,this._layer=a,this._toolbar&&
this._drawType&&this._toolbar.activate(this._drawType))},deactivate:function(){this._toolbar&&this._toolbar.deactivate();this._editToolbar&&this._editToolbar.deactivate();this.setChecked(!1);this._updateUI()},setEnabled:function(a){this._enabled=a;this._updateUI()},setChecked:function(a){this._checked=a},enable:function(a){this._updateUI()},isEnabled:function(){return this._enabled},getToolName:function(){return this._toolName},_initializeTool:function(){},_updateUI:function(){this.disabled=!this._enabled;
this.attr("iconClass",this._enabled?this._enabledIcon:this._disabledIcon)}});return a("extend-esri")&&k.setObject("dijit.editing.tools.ToolBase",h,f),h})},"esri/dijit/editing/tools/Cut":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dojo/DeferredList ../../../graphicsUtils ../../../graphic ../../../tasks/query ../../../layers/FeatureLayer ../../../toolbars/draw ../Cut ./ToggleToolBase ../../../kernel".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,
q,t){h=h([q],{declaredClass:"esri.dijit.editing.tools.Cut",id:"btnFeatureCut",_enabledIcon:"toolbarIcon cutIcon",_disabledIcon:"toolbarIcon cutIcon",_drawType:c.POLYLINE,_enabled:!0,_label:"NLS_cutLbl",_cutConnects:[],activate:function(){this._cutConnects.push(f.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd"));this.inherited(arguments)},deactivate:function(){this.inherited(arguments);a.forEach(this._cutConnects,f.disconnect);this._cutConnects=[];this._edits=[]},_onDrawEnd:function(b){var c=this._cutLayers=
a.filter(this._settings.layers,function(a){return"esriGeometryPolygon"===a.geometryType||"esriGeometryPolyline"===a.geometryType&&a.visible&&a._isMapAtVisibleScale()});this._cutConnects=this._cutConnects.concat(a.map(c,k.hitch(this,function(b){return f.connect(b,"onEditsComplete",k.hitch(this,function(b,c,d){if(this._settings.undoRedoManager){var e=this._settings.undoRedoManager;a.forEach(this._edits,k.hitch(this,function(a){e.add(new n({featureLayer:a.layer,addedGraphics:a.adds,preUpdatedGraphics:a.preUpdates,
postUpdatedGraphics:a.updates}))}),this)}this.onFinished()}))})));var e=new g;e.geometry=b;a.forEach(c,function(a,b){this._settings.editor._selectionHelper.selectFeatures([a],e,d.SELECTION_NEW,k.hitch(this,"_cutFeatures",a,e))},this)},_cutFeatures:function(a,b,c){if(c&&c.length){this._edits=[];var d=[];d.push(this._settings.geometryService.cut(l.getGeometries(c),b.geometry,k.hitch(this,"_cutHandler",a,c)));(new e(d)).addCallback(k.hitch(this,function(){this.onApplyEdits(this._edits)}))}},_cutHandler:function(b,
c,d){var e,f,g=[],l=[],h=a.map(c,function(a){return new m(k.clone(a.toJson()))});a.forEach(d.cutIndexes,function(a,b){e!=a?(e=a,l.push(c[a].setGeometry(d.geometries[b]))):(f=new m(d.geometries[b],null,k.mixin({},c[a].attributes),null),f.attributes[c[0].getLayer().objectIdField]=null,g.push(f))},this);this._edits.push({layer:b,adds:g,updates:l,preUpdates:h})}});return b("extend-esri")&&k.setObject("dijit.editing.tools.Cut",h,t),h})},"esri/dijit/editing/tools/ToggleToolBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dijit/form/ToggleButton ./ToolBase ../../../kernel".split(" "),
function(h,k,a,f,b,e){h=h([f,b],{declaredClass:"esri.dijit.editing.tools.ToggleToolBase",postCreate:function(){this.inherited(arguments);this._setShowLabelAttr&&this._setShowLabelAttr(!1)},destroy:function(){f.prototype.destroy.apply(this,arguments);b.prototype.destroy.apply(this,arguments)},setChecked:function(a){f.prototype.setChecked.apply(this,arguments)}});return a("extend-esri")&&k.setObject("dijit.editing.tools.ToggleToolBase",h,e),h})},"esri/dijit/editing/tools/Union":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../../../graphicsUtils ../../../graphic ../../../toolbars/draw ../Union ./ButtonToolBase ../../../kernel".split(" "),
function(h,k,a,f,b,e,l,m,g,d){h=h([g],{declaredClass:"esri.dijit.editing.tools.Union",id:"btnFeatureUnion",_enabledIcon:"toolbarIcon unionIcon",_disabledIcon:"toolbarIcon unionIcon",_drawType:l.POLYLINE,_enabled:!0,_label:"NLS_unionLbl",_onClick:function(c){this._settings.editor._activeTool="UNION";c=a.filter(this._settings.layers,function(a){return"esriGeometryPolygon"===a.geometryType&&a.visible&&a._isMapAtVisibleScale()});var d=[],f=0;a.forEach(c,function(c,g){var l=c.getSelectedFeatures();2<=
l.length&&(f++,this._settings.geometryService.union(b.getGeometries(l),k.hitch(this,function(b){var g=l.shift(),h=[],n=[];h.push(new e(g.toJson()));n.push(g.setGeometry(b));d.push({layer:c,updates:n,deletes:l,preUpdates:h});f--;0>=f&&this.onApplyEdits(d,k.hitch(this,function(){if(this._settings.undoRedoManager){var b=this._settings.undoRedoManager;a.forEach(this._edits,k.hitch(this,function(a){b.add(new m({featureLayer:a.layer,deletedGraphics:a.deletes,preUpdatedGraphics:a.preUpdates,postUpdatedGraphics:a.updates}))}),
this)}this._settings.editor._selectionHelper.clearSelection(!1);this.onFinished()}))})))},this)}});return f("extend-esri")&&k.setObject("dijit.editing.tools.Union",h,d),h})},"esri/dijit/editing/tools/Reshape":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has ../../../graphic ../../../layers/FeatureLayer ../../../tasks/query ../../../toolbars/draw ./ToggleToolBase ../../../kernel".split(" "),function(h,k,a,f,b,e,l,m,g,d,c){h=h([d],{declaredClass:"esri.dijit.editing.tools.Reshape",
id:"btnFeatureReshape",_enabledIcon:"toolbarIcon reshapeIcon",_disabledIcon:"toolbarIcon reshapeIcon",_drawType:g.POLYLINE,_enabled:!0,_label:"NLS_reshapeLbl",activate:function(){f.disconnect(this._rConnect);this._rConnect=f.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd");this.inherited(arguments)},deactivate:function(){this.inherited(arguments);f.disconnect(this._rConnect);delete this._rConnect},_onDrawEnd:function(b){var c=this._settings.layers,d=new m;d.geometry=b;b=this._reshapeLayers=a.filter(c,
function(a){return"esriGeometryPolygon"===a.geometryType||"esriGeometryPolyline"});this._settings.editor._selectionHelper.selectFeatures(b,d,l.SELECTION_NEW,k.hitch(this,"_reshape",d))},_reshape:function(a,b){if(1===b.length){var c=[],d=[],f=[],g=b[0],l=g.getLayer();this._settings.geometryService.reshape(g.geometry,a.geometry,k.hitch(this,function(a){return"polyline"===a.type&&a.paths&&0===a.paths.length?(this._settings.editor._selectionHelper.clearSelection(!1),void this.onFinished()):"polygon"===
a.type&&a.rings&&0===a.rings.length?(this._settings.editor._selectionHelper.clearSelection(!1),void this.onFinished()):(f.push(new e(g.toJson())),d.push(g.setGeometry(a)),c.push({layer:l,updates:d,preUpdates:f}),void this.onApplyEdits(c,k.hitch(this,function(){this._settings.editor._selectionHelper.clearSelection(!1);this.onFinished()})))}))}}});return b("extend-esri")&&k.setObject("dijit.editing.tools.Reshape",h,c),h})},"esri/dijit/editing/tools/Editing":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../../../layers/FeatureTemplate ./Edit ./EditingTools ./DropDownToolBase ../../../kernel ../../../lang".split(" "),
function(h,k,a,f,b,e,l,m,g,d){h=h([m],{declaredClass:"esri.dijit.editing.tools.Editing",_enabled:!1,deactivate:function(){this._enabled&&(this._enabled=!1,this.inherited(arguments),this._settings.templatePicker.clearSelection())},onItemClicked:function(a,d){this.inherited(arguments);this._activeTool===this._tools.AUTOCOMPLETE&&(this._settings.editor._drawingTool=b.TOOL_AUTO_COMPLETE_POLYGON)},_activateTool:function(a,b){var c;this.enable(b);for(c in this._tools)this._tools.hasOwnProperty(c)&&(this.dropDown.removeChild(this._tools[c]),
!0===this._tools[c]._enabled&&this.dropDown.addChild(this._tools[c]));this._geometryType===b&&!1!==this._activeTool._enabled||(this._activeTool=this._tools[a.toUpperCase()]);this._geometryType=b;this._activeTool.activate();this._activeTool.setChecked(!0);this._updateUI()},_initializeTool:function(a){this.inherited(arguments);this._initializeTools()},_initializeTools:function(){var b,d=this._settings.layers,e=this._settings.editor,f=!1,g=!1,l=!1,h=this._toolTypes=[];a.forEach(d,function(c){b=c.geometryType;
f=f||"esriGeometryPoint"===b;g=g||"esriGeometryPolyline"===b;l=l||"esriGeometryPolygon"===b;h=h.concat(a.map(this._getTemplatesFromLayer(c),k.hitch(this,function(a){return e._toDrawTool(a.drawingTool,c)})))},this);d=this._settings.createOptions;f&&this._toolTypes.push("point");g&&(this._toolTypes=this._toolTypes.concat(d.polylineDrawTools));l&&(this._toolTypes=this._toolTypes.concat(d.polygonDrawTools));this._toolTypes=this._toUnique(this._toolTypes.concat(h))},_toUnique:function(b){var c={};return a.filter(b,
function(a){return c[a]?!1:c[a]=!0})},_getTemplatesFromLayer:function(b){var c=b.templates||[];return a.forEach(b.types,function(a){c=c.concat(a.templates)}),a.filter(c,d.isDefined)},_createTools:function(){a.forEach(this._toolTypes,this._createTool,this);this.inherited(arguments)},_createTool:function(a){var b=k.mixin(l[a],{settings:this._settings,onClick:k.hitch(this,"onItemClicked",l[a].id)});this._tools[a.toUpperCase()]=new e(b)}});return f("extend-esri")&&k.setObject("dijit.editing.tools.Editing",
h,g),h})},"esri/dijit/editing/tools/Edit":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./MenuItemBase","../../../kernel"],function(h,k,a,f,b){h=h([f],{declaredClass:"esri.dijit.editing.tools.Edit",enable:function(a){this._enabled=a===this._geomType;this.inherited(arguments)}});return a("extend-esri")&&k.setObject("dijit.editing.tools.Edit",h,b),h})},"esri/dijit/editing/tools/MenuItemBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dijit/MenuItem ./ToolBase ../../../kernel".split(" "),
function(h,k,a,f,b,e){h=h([f,b],{declaredClass:"esri.dijit.editing.tools.MenuItemBase",destroy:function(){f.prototype.destroy.apply(this,arguments);b.prototype.destroy.apply(this,arguments)}});return a("extend-esri")&&k.setObject("dijit.editing.tools.MenuItemBase",h,e),h})},"esri/dijit/editing/tools/EditingTools":function(){define(["dojo/_base/lang","dojo/has","../../../toolbars/draw","../../../kernel"],function(h,k,a,f){a={point:{id:"esriPointTool",_enabledIcon:"toolbarIcon pointIcon",_disabledIcon:"toolbarIcon pointIconDisabled",
_drawType:a.POINT,_geomType:"esriGeometryPoint",_label:"NLS_pointLbl"},polyline:{id:"toolDrawFreehandPolyline",_enabledIcon:"toolbarIcon polylineIcon",_disabledIcon:"toolbarIcon polylineIconDisabled",_drawType:a.POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_polylineLbl"},freehandpolyline:{id:"toolDrawPolyline",_enabledIcon:"toolbarIcon freehandPolylineIcon",_disabledIcon:"toolbarIcon freehandPolylineIcon",_drawType:a.FREEHAND_POLYLINE,_geomType:"esriGeometryPolyline",_label:"NLS_freehandPolylineLbl"},
polygon:{id:"toolDrawPolygon",_enabledIcon:"toolbarIcon polygonIcon",_disabledIcon:"toolbarIcon polygonIconDisabled",_drawType:a.POLYGON,_geomType:"esriGeometryPolygon",_label:"NLS_polygonLbl"},freehandpolygon:{id:"toolDrawFreehandPolygon",_enabledIcon:"toolbarIcon freehandPolygonIcon",_disabledIcon:"toolbarIcon freehandPolygonIconDisabled",_drawType:a.FREEHAND_POLYGON,_label:"NLS_freehandPolygonLbl",_geomType:"esriGeometryPolygon"},autocomplete:{id:"btnFeatureAutoComplete",_enabledIcon:"toolbarIcon autoCompleteIcon",
_disabledIcon:"toolbarIcon autoCompleteIcon",_drawType:a.POLYGON,_label:"NLS_autoCompleteLbl",_geomType:"esriGeometryPolygon"},rectangle:{id:"toolDrawRect",_enabledIcon:"toolbarIcon rectangleIcon",_disabledIcon:"toolbarIcon rectangleIcon",_drawType:a.RECTANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_rectangleLbl"},arrow:{id:"toolDrawArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:a.ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowLbl"},uparrow:{id:"toolDrawArrowUp",
_enabledIcon:"toolbarIcon arrowUpIcon",_disabledIcon:"toolbarIcon arrowUpIcon",_drawType:a.UP_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowUpLbl"},downarrow:{id:"toolDrawDownArrow",_enabledIcon:"toolbarIcon arrowDownIcon",_disabledIcon:"toolbarIcon arrowDownIcon",_drawType:a.DOWN_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowDownLbl"},leftarrow:{id:"toolDrawLeftArrow",_enabledIcon:"toolbarIcon arrowLeftIcon",_disabledIcon:"toolbarIcon arrowLeftIcon",_drawType:a.LEFT_ARROW,_geomType:"esriGeometryPolygon",
_label:"NLS_arrowLeftLbl"},rightarrow:{id:"toolDrawRightArrow",_enabledIcon:"toolbarIcon arrowIcon",_disabledIcon:"toolbarIcon arrowIcon",_drawType:a.RIGHT_ARROW,_geomType:"esriGeometryPolygon",_label:"NLS_arrowRightLbl"},circle:{id:"toolDrawCircle",_enabledIcon:"toolbarIcon circleIcon",_disabledIcon:"toolbarIcon circleIcon",_drawType:a.CIRCLE,_geomType:"esriGeometryPolygon",_label:"NLS_circleLbl"},ellipse:{id:"toolDrawEllipse",_enabledIcon:"toolbarIcon ellipseIcon",_disabledIcon:"toolbarIcon ellipseIcon",
_drawType:a.ELLIPSE,_geomType:"esriGeometryPolygon",_label:"NLS_ellipseLbl"},triangle:{id:"toolDrawTriangle",_enabledIcon:"toolbarIcon triangleIcon",_disabledIcon:"toolbarIcon triangleIcon",_drawType:a.TRIANGLE,_geomType:"esriGeometryPolygon",_label:"NLS_triangleLbl"},attributes:{id:"btnAttributes",_enabledIcon:"toolbarIcon attributesIcon",_disabledIcon:"toolbarIcon attributesIcon",_enabled:!1,_label:"NLS_attributesLbl"},del:{id:"btnDelete2",_enabledIcon:"toolbarIcon deleteFeatureIcon",_disabledIcon:"toolbarIcon deleteFeatureIcon",
_enabled:!1,_label:"NLS_deleteLbl"},undo:{id:"btnUndo",_enabledIcon:"dijitEditorIcon dijitEditorIconUndo",_disabledIcon:"dijitEditorIcon dijitEditorIconUndo",_enabled:!1,_label:"NLS_undoLbl"},redo:{id:"btnRedo",_enabledIcon:"dijitEditorIcon dijitEditorIconRedo",_disabledIcon:"dijitEditorIcon dijitEditorIconRedo",_enabled:!1,_label:"NLS_redoLbl"}};return k("extend-esri")&&h.setObject("dijit.editing.tools.EditingTools",a,f),a})},"esri/dijit/editing/tools/DropDownToolBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-style dijit/registry dijit/Menu dijit/form/ComboButton ./ToolBase ../../../kernel ../../../lang".split(" "),
function(h,k,a,f,b,e,l,m,g,d){h=h([l,m],{declaredClass:"esri.dijit.editing.tools.DropDownToolBase",_enabled:!1,_checked:!1,postCreate:function(){this._tools=[];this._createTools();this.inherited(arguments);this._setShowLabelAttr&&this._setShowLabelAttr(!1)},destroy:function(){var a,b=this._tools;for(a in b)b.hasOwnProperty(a)&&d.isDefined(b[a])&&b[a].destroy();this.inherited(arguments)},_createTools:function(){var a,b=new e;this.dropDown=b;for(a in this._tools)this._tools.hasOwnProperty(a)&&b.addChild(this._tools[a]);
this._activeTool=b.getChildren()[0];this._updateUI()},activate:function(a){this.inherited(arguments);this._activeTool?this._activeTool.activate():this._activateDefaultTool()},deactivate:function(){this.inherited(arguments);this._activeTool&&this._activeTool.deactivate()},enable:function(a){for(var b in this._tools)this._tools.hasOwnProperty(b)&&this._tools[b].enable(a);this.setEnabled(!0);this.inherited(arguments)},setChecked:function(a){this._checked=a;this._updateUI()},_onDrawEnd:function(a){},
onLayerChange:function(a,b,d){this._activeTool=null;this._activeType=b;this._activeTemplate=d;this._activeLayer=a},onItemClicked:function(a,d){this._activeTool&&this._activeTool.deactivate();this._activeTool=b.byId(a);!1===this._checked?this._onClick():(this._updateUI(),this._activeTool&&(this._activeTool.activate(),this._activeTool.setChecked(!0)))},_onClick:function(a){!1!==this._enabled&&(this._checked=!this._checked,this.inherited(arguments))},_updateUI:function(){this.attr("disabled",!this._enabled);
f.set(this.focusNode,{outline:"none"});f.set(this.titleNode,{padding:"0px",border:"none"});this._checked?f.set(this.titleNode,{backgroundColor:"#D4DFF2",border:"1px solid #316AC5"}):f.set(this.titleNode,{backgroundColor:"",border:""});this._activeTool&&(this.attr("iconClass",this._checked?this._activeTool._enabledIcon:this._activeTool._disabledIcon),this.attr("label",this._activeTool.label))}});return a("extend-esri")&&k.setObject("dijit.editing.tools.DropDownToolBase",h,g),h})},"dijit/form/ComboButton":function(){define("dojo/_base/declare dojo/keys ../focus ./DropDownButton dojo/text!./templates/ComboButton.html ../a11yclick".split(" "),
function(h,k,a,f,b){return h("dijit.form.ComboButton",f,{templateString:b,_setIdAttr:"",_setTabIndexAttr:["focusNode","titleNode"],_setTitleAttr:"titleNode",optionsTitle:"",baseClass:"dijitComboButton",cssStateNodes:{buttonNode:"dijitButtonNode",titleNode:"dijitButtonContents",_popupStateNode:"dijitDownArrowButton"},_focusedNode:null,_onButtonKeyDown:function(b){b.keyCode==k[this.isLeftToRight()?"RIGHT_ARROW":"LEFT_ARROW"]&&(a.focus(this._popupStateNode),b.stopPropagation(),b.preventDefault())},_onArrowKeyDown:function(b){b.keyCode==
k[this.isLeftToRight()?"LEFT_ARROW":"RIGHT_ARROW"]&&(a.focus(this.titleNode),b.stopPropagation(),b.preventDefault())},focus:function(b){this.disabled||a.focus("start"==b?this.titleNode:this._popupStateNode)}})})},"esri/dijit/editing/tools/Selection":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/has ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol ../../../symbols/SimpleFillSymbol ./Edit ./SelectionTools ./DropDownToolBase ../../../kernel".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q){h=h([n],{declaredClass:"esri.dijit.editing.tools.Selection",_enabled:!0,activate:function(){this.inherited(arguments);this._sConnect=f.connect(this._toolbar,"onDrawEnd",this,"_onDrawEnd")},deactivate:function(){this.inherited(arguments);f.disconnect(this._sConnect);delete this._sConnect},_initializeTool:function(){this._createSymbols();this._initializeLayers();this._toolTypes=["select","selectadd","selectremove"]},_onDrawEnd:function(a){this.inherited(arguments);
this._settings.editor._hideAttributeInspector();var b=this._settings.layers;this._selectMethod=this._activeTool._selectMethod;this._settings.editor._selectionHelper.selectFeaturesByGeometry(b,a,this._selectMethod,k.hitch(this,"onFinished"))},_createSymbols:function(){this._pointSelectionSymbol=new l(l.STYLE_CIRCLE,10,new m(m.STYLE_SOLID,new b([0,0,0]),1),new b([255,0,0,.5]));this._polylineSelectionSymbol=new m(m.STYLE_SOLID,new b([0,200,255]),2);this._polygonSelectionSymbol=new g(g.STYLE_SOLID,new m(m.STYLE_SOLID,
new b([0,0,0]),1),new b([0,200,255,.5]))},_initializeLayers:function(){a.forEach(this._settings.layers,this._setSelectionSymbol,this)},_setSelectionSymbol:function(a){var b=null;switch(a.geometryType){case "esriGeometryPoint":b=this._pointSelectionSymbol;break;case "esriGeometryPolyline":b=this._polylineSelectionSymbol;break;case "esriGeometryPolygon":b=this._polygonSelectionSymbol}a.setSelectionSymbol(a._selectionSymbol||b)},_createTools:function(){a.forEach(this._toolTypes,this._createTool,this);
this.inherited(arguments)},_createTool:function(a){var b=k.mixin(c[a],{settings:this._settings,onClick:k.hitch(this,"onItemClicked",c[a].id)});this._tools[a.toUpperCase()]=new d(b)}});return e("extend-esri")&&k.setObject("dijit.editing.tools.Selection",h,q),h})},"esri/dijit/editing/tools/SelectionTools":function(){define(["dojo/_base/lang","dojo/has","../../../layers/FeatureLayer","../../../toolbars/draw","../../../kernel"],function(h,k,a,f,b){a={select:{id:"btnNewSelection",_enabledIcon:"toolbarIcon newSelectionIcon",
_disabledIcon:"toolbarIcon newSelectionIcon",_drawType:f.EXTENT,_selectMethod:a.SELECTION_NEW,_label:"NLS_selectionNewLbl"},selectadd:{id:"btnAddToSelection",_enabledIcon:"toolbarIcon addToSelectionIcon",_disabledIcon:"toolbarIcon addToSelectionIcon",_drawType:f.EXTENT,_selectMethod:a.SELECTION_ADD,_label:"NLS_selectionAddLbl"},selectremove:{id:"btnSubtractFromSelection",_enabledIcon:"toolbarIcon removeFromSelectionIcon",_disabledIcon:"toolbarIcon removeFromSelectionIcon",_drawType:f.EXTENT,_selectMethod:a.SELECTION_SUBTRACT,
_label:"NLS_selectionRemoveLbl"},selectClear:{id:"btnClearSelection",_enabledIcon:"toolbarIcon clearSelectionIcon",_disabledIcon:"toolbarIcon clearSelectionIcon",_enabled:!1,_label:"NLS_selectionClearLbl"}};return k("extend-esri")&&h.setObject("dijit.editing.tools.SelectionTools",a,b),a})},"esri/dijit/editing/SelectionHelper":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/has dojo/DeferredList ../../geometry/Extent ../../geometry/Point ../../geometry/ScreenPoint ../../layers/FeatureLayer ../../tasks/query ../../kernel".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n){h=h(null,{declaredClass:"esri.dijit.editing.SelectionHelper",constructor:function(a){this._settings=a||{};this._sConnects=[];this._mapServiceCount=0;this._map=this._settings.map;this._tolerance=this._settings.singleSelectionTolerance;this._initMapServiceInfos(this._settings.layers)},destroy:function(){for(var b in this._sConnects)this._sConnects.hasOwnProperty(b)&&a.disconnect(this._sConnects[b])},selectFeatures:function(a,b,c,g){c===d.SELECTION_NEW&&(this._resetMapServiceInfos(),
this.getSelection(a));var l=[];f.forEach(a,function(a){if(!0===a.visible&&!0===a._isMapAtVisibleScale()){var e=c;a._isSelOnly&&e===d.SELECTION_NEW&&(e=d.SELECTION_ADD);l.push(a.selectFeatures(b,e))}});(new e(l)).addCallback(k.hitch(this,function(b){var e=[];if(f.forEach(b,function(b,c){f.forEach(b[1],function(b){(b=a[c]._mode._getFeature(b.attributes[a[c].objectIdField])||null)&&e.push(b)},this)},this),!this._mapServiceCount)return void g(e);(b=c===d.SELECTION_SUBTRACT)?(this._resetMapServiceInfos(),
this._createLayerDefs(this._getLayerInfosFromSelection(a))):this._createLayerDefs(this._getLayerInfosFromFeatures(e));this._updateLayerDefs(this._mapServiceInfos,!1,!(e&&e.length||b),k.hitch(this,g,e))}))},selectFeaturesByGeometry:function(a,b,d,e){var f=b;-1!==b.declaredClass.indexOf("Extent")&&b.xmax===b.xmin&&b.ymax===b.ymin&&(f=new m(b.xmax,b.ymax,b.spatialReference));f=-1!==f.declaredClass.indexOf("Point")?this._extentFromPoint(f):f;b=new c;b.geometry=f;this.selectFeatures(a,b,d,e)},clearSelection:function(a){if(f.forEach(this._nonSelOnlyLayers,
function(a){a.clearSelection&&a.clearSelection()}),this._mapServiceCount){this._resetMapServiceInfos();var b=this._getLayerInfosFromSelection(this._settings.layers);f.some(b,function(a){return a.oids&&a.oids.length})&&(this._createLayerDefs(b),this._updateLayerDefs(this._mapServiceInfos,!0,a||!1))}},findMapService:function(a){var b,c,d,e=this._map,f=e.layerIds;a=a&&a._url&&a._url.path?a._url.path.toLowerCase():"";for(c in f)if(f.hasOwnProperty(c)&&(b=e.getLayer(f[c]),d=b._url?b._url.path?b._url.path.toLowerCase().replace("mapserver",
"featureserver"):b._url.toLowerCase().replace("mapserver","featureserver"):"",a.substr(0,d.length)===d&&"esri.layers.ArcGISDynamicMapServiceLayer"===b.declaredClass))return b},getSelection:function(a){var b=[];f.forEach(a,function(a){a._isSelOnly&&b.push(this._createLayerInfo(a))},this);f.forEach(b,function(a){var b=this._createMapServiceInfo(this.findMapService(a.layer));b&&(b.layerInfos[a.layer.layerId]=a)},this)},_initMapServiceInfos:function(a){this._nonSelOnlyLayers=[];this._mapServiceInfos=
[];f.forEach(a,function(a){var b=this.findMapService(a);b?(this._mapServiceCount++,this._createMapServiceInfo(b),b&&b.setDisableClientCaching(!0)):this._nonSelOnlyLayers.push(a)},this)},_createMapServiceInfo:function(a){if(!a)return null;var b=this._mapServiceInfos,c=b[a.id];return c||(c=b[a.id]={mapService:a,layerInfos:[],layerDefs:k.mixin([],a.layerDefinitions||[]),origLayerDefs:k.mixin([],a.layerDefinitions||[])}),c},_resetMapServiceInfo:function(a){f.forEach(a.layerInfos,this._resetLayerInfo);
a.layerDefs=k.mixin([],a.origLayerDefs||[])},_resetMapServiceInfos:function(){var a,b=this._mapServiceInfos;for(a in b)b.hasOwnProperty(a)&&this._resetMapServiceInfo(b[a])},_createLayerInfo:function(a,b){var c=a.objectIdField,d=b?[]:a.getSelectedFeatures();return{layer:a,selectedFeatures:d||[],oids:f.map(d,function(a){return a.attributes[c]})}},_resetLayerInfo:function(a){a&&(a.selectedFeatures=[],a.oids=[])},_updateLayerDefs:function(b,c,d,e){for(var f in b)if(b.hasOwnProperty(f)){var g=b[f],l=g.mapService,
h=g.layerDefs=c?k.mixin([],g.origLayerDefs||[]):g.layerDefs;h?(d?e&&e():this._sConnects[l.id]=a.connect(l,"onUpdateEnd",k.hitch(this,"_onMapServiceUpdate",g,c,e)),l.setLayerDefinitions(h,d||!1)):e&&e()}},_onMapServiceUpdate:function(b,e,g){a.disconnect(this._sConnects[b.mapService.id]);f.forEach(b.layerInfos,function(a){if(e)a&&a.layer.clearSelection();else{var b=new c;b.objectIds=a?a.oids:[];b.objectIds.length&&a.layer.selectFeatures(b,d.SELECTION_SUBTRACT)}},this);e&&this._resetMapServiceInfo(b);
g&&g()},_createLayerDefs:function(a){f.forEach(a,function(a){var b=a.layer,c=this._createMapServiceInfo(this.findMapService(a.layer));if(c){var c=(c.mapService,c.layerDefs),d=b.layerId,e='("'+b.objectIdField+'" NOT IN (',g=a.oids;g&&g.length&&(f.forEach(a.oids,function(a,b){g=!0;b&&(e+=",");e+="'"+a+"'"}),e+="))",c.length&&c[d]&&c[d].length?c[d]+=" AND"+e:c[d]=e)}},this)},_getLayerInfosFromFeatures:function(a){var b=[];f.forEach(a,function(a){var c=a.getLayer();c&&c._isSelOnly&&(b[c.id]||(b[c.id]=
this._createLayerInfo(c,!0)),b[c.id].selectedFeatures.push(a),b[c.id].oids.push(a.attributes[c.objectIdField]))},this);var c;a=[];for(c in b)b.hasOwnProperty(c)&&a.push(b[c]);return a},_getLayerInfosFromSelection:function(a){var b=[];return f.forEach(a,function(a){a._isSelOnly&&b.push(this._createLayerInfo(a,!1))},this),b},_extentFromPoint:function(a){var b=this._tolerance,c=this._map,d=c.toScreen(a);a=new g(d.x-b,d.y+b);b=new g(d.x+b,d.y-b);a=c.toMap(a);b=c.toMap(b);return new l(a.x,a.y,b.x,b.y,
c.spatialReference)}});return b("extend-esri")&&k.setObject("dijit.editing.SelectionHelper",h,n),h})},"esri/dijit/editing/TemplatePicker":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/html dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/has dojo/query dojo/sniff dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/_Widget dijit/_Templated dojo/data/ItemFileReadStore dojox/grid/DataGrid dojox/gfx ../../layers/FeatureLayer ../../symbols/SimpleMarkerSymbol ../../symbols/PictureMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ./TemplatePickerItem ../../kernel ../../lang ../../request ../_EventedWidget dojo/i18n!../../nls/jsapi dojo/text!./templates/TemplatePicker.html".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J,L){var M=h([I,r,v],{declaredClass:"esri.dijit.editing.TemplatePicker",widgetsInTemplate:!0,templateString:L,featureLayers:null,items:null,grouping:!0,showTooltip:!1,maxLabelLength:0,rows:4,_rows:0,columns:3,surfaceWidth:30,surfaceHeight:30,emptyMessage:"",useLegend:!0,legendCache:{},_uniqueId:{id:0},_assumedCellWidth:90,_initialAutoWidth:300,_initialAutoHeight:200,_ieTimer:150,constructor:function(a,b){a=a||{};a.items||a.featureLayers||
console.error("TemplatePicker: please provide 'featureLayers' or 'items' parameter in the constructor");this._dojo14x=4<=l.version.minor;this._itemWidgets={};a.featureLayers&&a.featureLayers.length&&(this._flChanged=1);this._nls=J.widgets.templatePicker;this.emptyMessage=a.emptyMessage||this._nls&&this._nls.creationDisabled||""},postMixInProperties:function(){this.inherited(arguments);this._preprocess()},startup:function(){if(this.inherited(arguments),"auto"===this.rows&&"auto"===this.columns){var b=
q.getContentBox(this.domNode);b.w||(this.domNode.style.width=this._initialAutoWidth+"px");(!b.h||1>=b.h)&&(this.domNode.style.height=this._initialAutoHeight+"px");b=q.getContentBox(this.domNode);this._columns=Math.floor(b.w/this._assumedCellWidth)||1}this._applyGridPatches();this._setGridLayout();a.connect(this.grid,"onRowClick",this,this._rowClicked);this._setGridData();this._toggleTooltip();9>m("ie")&&(this._repaintItems=k.hitch(this,this._repaintItems),setTimeout(this._repaintItems,this._ieTimer))},
destroy:function(){this.showTooltip=!1;this._toggleTooltip();this._clearLegendInfo();this.featureLayers=this.items=this.grid=this._flItems=this._itItems=this._groupRowIndices=this._selectedCell=this._selectedInfo=this._selectedItem=null;this.inherited(arguments)},getSelected:function(){return this._selectedCell?this._selectedItem:null},clearSelection:function(){var a=this._selectedCell,b=this._selectedInfo;a&&this._rowClicked({cellNode:a,rowIndex:b.selRow,cellIndex:b.selCol})},update:function(a){var b;
a="auto"===this.rows&&"auto"===this.columns&&a?!0:!1;var c=this.grid;if(a){var d;b=this.domNode;d=l.query("#"+b.id+".templatePicker div.item")[0];b=q.getContentBox(b);d=(d=d&&d.parentNode)?f.coords(d).w:this._assumedCellWidth;this._columns=(this._columns=Math.floor((b.w-c.views.views[0].getScrollbarWidth())/d))||1}d=this._rows;this._preprocess();var e=this._rows;this._setGridLayout();this._setGridData();e!==d&&c.set("autoHeight",this._rows,!1);a?(c._resize({w:b.w,h:b.h}),c.viewsHeaderNode.style.display=
"none"):c.update();this._toggleTooltip();var g=this,h=this.getSelected();h&&c.store.fetch({onComplete:function(a){var b=(a=g._locate(h,g._selectedInfo,a))&&c.views.views[0].getCellNode(a[0],a[1]);b&&g._rowClicked({cellNode:b,rowIndex:a[0],cellIndex:a[1]},!0)}});9>m("ie")&&setTimeout(this._repaintItems,this._ieTimer);b=this.featureLayers;a=this.items;b&&b.length||a&&a.length||!c||!this.emptyMessage||c.showMessage(this.emptyMessage)},_eventMap:{"selection-change":!0},onSelectionChange:function(){},
_setUseLegendAttr:function(a){var b=this.useLegend;this._started&&b===a||(a?this._flChanged=1:this._clearLegendInfo());this.useLegend=a},_setFeatureLayersAttr:function(a){var b=this.featureLayers;this._started&&b===a||(this._flChanged=1);this.featureLayers=a},_adjustRowsCols:function(a){if("auto"===this.rows&&"auto"===this.columns)return void(this._started||(this._rows=!1,this._columns=null,this._autoWidth=!1));var c=0;this._rows=this.rows;this._columns=this.columns;"auto"===this.rows?(this.featureLayers?
this.grouping?(c=a.length,b.forEach(a,function(a){c+=Math.ceil(a.length/this.columns)},this)):(b.forEach(a,function(a){c+=a.length},this),c=Math.ceil(c/this.columns)):c=Math.ceil(a.length/this.columns),this._rows=c):"auto"===this.columns&&(this.featureLayers?this.grouping?c=3:(b.forEach(a,function(a){c+=a.length},this),c=Math.ceil(c/this.rows)):c=Math.ceil(a.length/this.rows),this._columns=c)},_preprocess:function(){this.items&&(this.grouping=!1);this._autoWidth=!1;"auto"!==this.rows&&"auto"!==this.columns||
(this._autoWidth=!0);var c;if(this.featureLayers)if(this.useLegend&&this._flChanged&&(this._legendIndices=[],this._loadingIndices=[],this._legendSymbols={},this._ignoreLegends(),this._loadingLegends=[],clearTimeout(this._legendTimer),this._legendTimer=null,this._processSelectionLayers(),this._flChanged=0),b.every(this.featureLayers,function(a){return a.loaded}))c=this._flItems=this._getItemsFromLayers(this.featureLayers),this._adjustRowsCols(c);else{var d=this.featureLayers.length;b.forEach(this.featureLayers,
function(b){if(b.loaded)d--;else var c=a.connect(b,"onLoad",this,function(){a.disconnect(c);c=null;d--;d||this.update()})},this)}else c=this._itItems=this._getItemsFromItems(this.items),this._adjustRowsCols(c)},_processSelectionLayers:function(){var a,c,d,e,f,g,l,h={};b.forEach(this.featureLayers,function(b,f){b.mode===y.MODE_SELECTION&&b._map&&b.url&&b._params.drawMode&&!b.source&&(c=k.trim(b._url.path).replace(/\/(MapServer|FeatureServer).*/gi,"/MapServer").replace(/^https?:\/\//gi,"").toLowerCase(),
d=h[c]=h[c]||{},e=d.featureLayers=d.featureLayers||{},g=d.indices=d.indices||[],e[f]=b,g.push(f),a=b._map)});a&&b.forEach(a.layerIds,function(b){(b=a.getLayer(b))&&b.url&&(b.getImageUrl||b.getTileUrl)&&b.loaded&&10.1<=b.version&&(c=k.trim(b._url.path).replace(/(\/MapServer).*/gi,"$1"),f=c.replace(/^https?:\/\//gi,"").toLowerCase(),h[f]&&!h[f].mapServiceUrl&&(d=h[f],d.mapServiceUrl=c,d.mapServiceLayer=b,this._legendIndices=this._legendIndices.concat(d.indices),l=this._fetchLegend({pickerInstance:this,
info:d},f),l.then?(this._loadingIndices=this._loadingIndices.concat(d.indices),this._loadingLegends.push(l)):this._processLegendResponse(l,d)))},this)},_fetchLegend:function(a,c){var d=M.prototype,e=d.legendCache[c];return e?e.then&&e._contexts.push(a):(e=d.legendCache[c]=G({url:a.info.mapServiceUrl+"/legend",content:{f:"json"},callbackParamName:"callback"}),e._contexts=[a],e.addBoth(function(a){if(!e.canceled){d.legendCache[c]=a;var f=e._contexts;e._contexts=null;b.forEach(f,function(c){var d,f=
c.pickerInstance;c=c.info;f._destroyed||(b.forEach(c.indices,function(a){d=b.indexOf(f._loadingIndices,a);-1<d&&f._loadingIndices.splice(d,1)}),d=b.indexOf(f._loadingLegends,e),-1<d&&f._loadingLegends.splice(d,1),f._processLegendResponse(a,c))})}})),e},_clearLegendInfo:function(){clearTimeout(this._legendTimer);this._ignoreLegends();this._legendIndices=this._loadingIndices=this._legendSymbols=this._loadingLegends=this._legendTimer=null},_ignoreLegends:function(){this._loadingLegends&&b.forEach(this._loadingLegends,
function(a){var c=-1;b.some(a._contexts,function(a,b){return a.pickerInstance===this&&(c=b),-1<c},this);-1<c&&a._contexts.splice(c,1)},this)},_processLegendResponse:function(a,c){if(!a||a instanceof Error){var d;b.forEach(c.indices,function(a){d=b.indexOf(this._legendIndices,a);-1<d&&this._legendIndices.splice(d,1)},this)}else b.forEach(c.indices,function(d){var e,f,g,l,h,m=c.featureLayers[d].layerId,n=c.mapServiceUrl+"/"+m+"/images/",k=c.mapServiceLayer._getToken();this._legendSymbols[d]||(f=null,
b.some(a.layers,function(a){return a.layerId==m&&(f=a),!!f}),f&&(g=this._legendSymbols[d]={},b.forEach(f.legend,function(a){if(l=a.values,l&&l.length)for(e=0;e<l.length;e++)g[l[e]]=a;else g.defaultSymbol=a;(h=a.url)&&!a._fixed&&(a._fixed=1,-1===h.search(/https?\:/)&&(a.url=n+h),k&&-1!==a.url.search(/https?\:/)&&(a.url+=(-1<a.url.indexOf("?")?"\x26":"?")+"token\x3d"+k))})))},this);var e=this;e._started&&!e._legendTimer&&(e._legendTimer=setTimeout(function(){clearTimeout(e._legendTimer);e._legendTimer=
null;e._destroyed||e.update()},0))},_applyGridPatches:function(){var b,c,d,e=this.grid,f=e.adaptWidth;if(e.adaptWidth=function(){b=this.views.views;for(c=0;d=b[c];c++)t.set(d.headerNode,"display","block");f.apply(this,arguments);for(c=0;d=b[c];c++)t.set(d.headerNode,"display","none")},this._dojo14x){if("auto"!==this.rows&&"auto"!==this.columns)var g=a.connect(e,"_onFetchComplete",this,function(){a.disconnect(g);this.grid.set("autoHeight",this._rows)});a.connect(e,"_onDelete",this,this._destroyItems);
a.connect(e,"_clearData",this,this._destroyItems);a.connect(e,"destroy",this,this._destroyItems);(e=e.focus)&&e.findAndFocusGridCell&&(e.findAndFocusGridCell=function(){return!1})}},_setGridLayout:function(){var a,b=function(a){return function(b,c){return this._cellGet(a,b,c)}},c=k.hitch(this,this._cellFormatter),d=[],e=this._columns;for(a=0;e>a;a++)d.push({field:"cell"+a,get:k.hitch(this,b(a)),formatter:c});a={cells:[d]};this.grouping&&(e={field:"groupName",colSpan:e,get:k.hitch(this,this._cellGetGroup),
formatter:k.hitch(this,this._cellGroupFormatter)},a.cells.push([e]));e=this.grid;b=w.prototype.rowsPerPage;e.set("rowsPerPage",this._rows>b?this._rows:b);e.set("structure",a)},_setGridData:function(){var a=[];if(this.grouping){this._groupRowIndices=[];var c,d,e=this._columns;b.forEach(this._flItems,function(b,f){a.push({});var g=0===f?0:c+d+1;this._groupRowIndices.push(g);c=g;d=Math.ceil(b.length/e);a=a.concat(this._getStoreItems(b))},this)}else this.featureLayers?(b.forEach(this._flItems,function(b){a=
a.concat(b)}),a=this._getStoreItems(a)):a=this._getStoreItems(this._itItems);var f=new u({data:{items:a}});this.grid.setStore(f)},_toggleTooltip:function(){if(this.showTooltip){if(!this.tooltip){this.tooltip=n.create("div",{"class":"tooltip"},this.domNode);this.tooltip.style.display="none";this.tooltip.style.position="fixed";var b=this.grid;this._mouseOverConnect=a.connect(b,"onCellMouseOver",this,this._cellMouseOver);this._mouseOutConnect=a.connect(b,"onCellMouseOut",this,this._cellMouseOut)}}else this.tooltip&&
(a.disconnect(this._mouseOverConnect),a.disconnect(this._mouseOutConnect),n.destroy(this.tooltip),this.tooltip=null)},_rowClicked:function(a,b){var d=a.cellNode,e=a.rowIndex,f=a.cellIndex,g=this._getCellInfo(d,e,f);if(g){var l=this.grid.store;l.getValue(g,"loadingCell")||(this._selectedCell&&c.remove(this._selectedCell,"selectedItem"),d!==this._selectedCell?(c.add(d,"selectedItem"),this._selectedCell=d,this._selectedItem={featureLayer:l.getValue(g,"layer"),type:l.getValue(g,"type"),template:l.getValue(g,
"template"),symbolInfo:l.getValue(g,"symbolInfo"),item:this._getItem(g)},this._selectedInfo={selRow:e,selCol:f,index1:l.getValue(g,"index1"),index2:l.getValue(g,"index2"),index:l.getValue(g,"index")}):this._selectedCell=this._selectedInfo=this._selectedItem=null,b||this.onSelectionChange())}},_locate:function(a,c,d){var e,f=this.grid.store,g=Array(this._columns),l=c.index1,h=c.index2,m=c.index,n=a.item;return b.some(d,function(a,c){return b.some(g,function(b,d){var g=f.getValue(a,"cell"+d);return g&&
(n?m===f.getValue(g,"index"):l===f.getValue(g,"index1")&&h===f.getValue(g,"index2"))?(e=[c,d],!0):!1})}),e},_getCellInfo:function(a,b,c){if(a)return a=this.grid,b=a.getItem(b),a.store.getValue(b,"cell"+c)},_getItem:function(a){var b=this.items;return b?b[this.grid.store.getValue(a,"index")]:void 0},_cellMouseOver:function(a){var b=this.tooltip,c=a.cellNode,d=this._getCellInfo(c,a.rowIndex,a.cellIndex);if(b&&d){var e=this.grid.store;a=e.getValue(d,"template");var g=e.getValue(d,"type"),l=e.getValue(d,
"symbolInfo"),e=e.getValue(d,"layer");a=(d=this._getItem(d))&&d.label+(d.description?": "+d.description:"")||a&&a.name+(a.description?": "+a.description:"")||g&&g.name||l&&l.label+(l.description?": "+l.description:"")||(e&&e.name+": ")+"Default";b.style.display="none";b.innerHTML=a;c=f.coords(c.firstChild);t.set(b,{left:c.x+"px",top:c.y+c.h+5+"px"});b.style.display=""}},_cellMouseOut:function(){var a=this.tooltip;a&&(a.style.display="none")},_destroyItems:function(){var a,b=this._itemWidgets;for(a in b)b[a]&&
(b[a].destroy(),delete b[a])},_repaintItems:function(){var a,b=this._itemWidgets;for(a in b){var c=b[a];c&&c._repaint(c._surface)}},_getStoreItems:function(a){var c=this._uniqueId;a=b.map(a,function(a){return k.mixin({surfaceId:"tpick-surface-"+c.id++},a)});for(var d,e=a.length,f=0,g={},l=0,h=[],m=!0,n=this._columns;e>f;)m=!0,d="cell"+l,g[d]=a[f],f++,l++,0===l%n&&(m=!1,h.push(g),g={},l=0);return m&&e&&h.push(g),h},_getItemsFromLayers:function(a){var c=[];return b.forEach(a,function(a,b){c.push(this._getItemsFromLayer(a,
b))},this),c},_getItemsFromLayer:function(a,c){var f=[];if(this.useLegend&&-1<b.indexOf(this._loadingIndices,c))return[{label:this._nls&&this._nls.loading||"",symbol:null,layer:a,type:null,template:null,index1:c,index2:0,loadingCell:1}];var g=[],g=g.concat(a.templates);b.forEach(a.types,function(a){var c=a.templates;b.forEach(c,function(b){b._type_=a});g=g.concat(c)});var g=b.filter(g,F.isDefined),l=a.renderer;if(l){var h=l.declaredClass.replace("esri.renderer.","");if(0<g.length)b.forEach(g,function(g){var m=
g.prototype;if(m){var n;if(n=l.valueExpression?this._createSimpleSymbol(a):this._isUnclassedRenderer(l)?l.infos[0].symbol:l.getSymbol(m)){var k,q,r=null;if(9>d("ie")||!g.thumbnail||!g.thumbnail.imageData){if(this.useLegend&&-1<b.indexOf(this._legendIndices,c)){if(q=this._legendSymbols&&this._legendSymbols[c])switch(h){case "SimpleRenderer":r=q.defaultSymbol;break;case "UniqueValueRenderer":b.some(l.infos,function(a){return a.symbol===n&&(r=q[a.value]),!!r});break;case "ClassBreaksRenderer":b.some(l.infos,
function(a){return a.symbol===n&&(r=q[a.maxValue]),!!r})}r&&(k=e.fromJson(e.toJson(z.defaultProps)),k.url=r.url,k.imageData=r.imageData,k.contentType=r.contentType,k.width=r.width,k.height=r.height,F.isDefined(k.width)&&F.isDefined(k.height)||(k.width=15,k.height=15),r=new z(k))}}else r=new z(g.thumbnail);f.push({label:this._trimLabel(g.name),symbol:r||n,legendOverride:!!r,layer:a,type:g._type_,template:g,index1:c,index2:f.length})}else switch(h){case "HeatmapRenderer":f.push({label:this._trimLabel(g.name),
symbol:new A,legendOverride:!!r,layer:a,type:g._type_,template:g,index1:c,index2:f.length})}}delete g._type_},this);else{var m=[];switch("TemporalRenderer"===h&&(l=l.observationRenderer,l&&(h=l.declaredClass.replace("esri.renderer.",""))),h){case "SimpleRenderer":m=[{symbol:l.symbol,label:l.label,description:l.description}];break;case "UniqueValueRenderer":case "ClassBreaksRenderer":m=l.infos}f=b.map(m,function(b,d){return{label:this._trimLabel(b.label),description:b.description,symbolInfo:k.mixin({constructor:function(){}},
b),symbol:b.symbol,layer:a,index1:c,index2:d}},this)}}return f},_isUnclassedRenderer:function(a){return!!((a.hasVisualVariables("sizeInfo",!1)||a.hasVisualVariables("colorInfo",!1)||a.hasVisualVariables("opacityInfo",!1))&&a.addBreak&&a.infos&&1===a.infos.length)},_createSimpleSymbol:function(a){var b;switch(a.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":b=new A;break;case "esriGeometryPolyline":b=new C;break;case "esriGeometryPolygon":b=new B;break;default:a.hasXYFootprint&&
a.hasXYFootprint()&&(b=new B)}return b},_getItemsFromItems:function(a){return b.map(a,function(a,b){return a=k.mixin({index:b},a),a.label=this._trimLabel(a.label),a},this)},_trimLabel:function(a){var b=this.maxLabelLength;return b&&a&&a.length>b&&(a=a.substr(0,b)+"..."),a||""},_cellGet:function(a,b,c){return c?this.grid.store.getValue(c,"cell"+a):""},_cellFormatter:function(a){if(a){var b=this._itemWidgets,c=this.grid.store,d=c.getValue(a,"surfaceId"),e=b[d];return e||(e=b[d]=new D({id:d,label:c.getValue(a,
"label"),symbol:c.getValue(a,"symbol"),legendOverride:c.getValue(a,"legendOverride"),surfaceWidth:this.surfaceWidth,surfaceHeight:this.surfaceHeight,template:c.getValue(a,"template")})),e||""}return""},_cellGetGroup:function(a,c){if(!this._groupRowIndices)return"";var d,e=b.indexOf(this._groupRowIndices,a);return c&&-1!==e?(d=this.featureLayers[e],d&&(this.groupLabelFunction?this.groupLabelFunction(d):d.name)||""):""},_cellGroupFormatter:function(a){return a?"\x3cdiv class\x3d'groupLabel'\x3e"+a+
"\x3c/div\x3e":""}});return m("extend-esri")&&k.setObject("dijit.editing.TemplatePicker",M,E),M})},"dojox/grid/DataGrid":function(){define("../main dojo/_base/array dojo/_base/lang dojo/_base/json dojo/_base/sniff dojo/_base/declare ./_Grid ./DataSelection dojo/_base/html dojo/has dojo/has!dojo-bidi?./bidi/_BidiMixin".split(" "),function(h,k,a,f,b,e,l,m,g){var d=e("dojox.grid.DataGrid",l,{store:null,query:null,queryOptions:null,fetchText:"...",sortFields:null,updateDelay:1,items:null,_store_connects:null,
_by_idty:null,_by_idx:null,_cache:null,_pages:null,_pending_requests:null,_bop:-1,_eop:-1,_requests:0,rowCount:0,_isLoaded:!1,_isLoading:!1,keepSelection:!1,postCreate:function(){this._pages=[];this._store_connects=[];this._by_idty={};this._by_idx=[];this._cache=[];this._pending_requests={};this._setStore(this.store);this.inherited(arguments)},destroy:function(){this.selection.destroy();this.inherited(arguments)},createSelection:function(){this.selection=new m(this)},get:function(a,b){if(b&&"_item"==
this.field&&!this.fields)return b;if(b&&this.fields){var c=[],d=this.grid.store;k.forEach(this.fields,function(a){c=c.concat(d.getValues(b,a))});return c}return b||"string"!==typeof a?b?this.field?"_item"==this.field?b:this.grid.store.getValue(b,this.field):this.value:this.defaultValue:this.inherited(arguments)},_checkUpdateStatus:function(){if(0<this.updateDelay){var a=!1;this._endUpdateDelay&&(clearTimeout(this._endUpdateDelay),delete this._endUpdateDelay,a=!0);this.updating||(this.beginUpdate(),
a=!0);if(a){var b=this;this._endUpdateDelay=setTimeout(function(){delete b._endUpdateDelay;b.endUpdate()},this.updateDelay)}}},_onSet:function(a,b,d,e){this._checkUpdateStatus();a=this.getItemIndex(a);-1<a&&this.updateRow(a)},_createItem:function(a,b){var c=this._hasIdentity?this.store.getIdentity(a):f.toJson(this.query)+":idx:"+b+":sort:"+f.toJson(this.getSortProps());return this._by_idty[c]={idty:c,item:a}},_addItem:function(a,b,d){this._by_idx[b]=this._createItem(a,b);d||this.updateRow(b)},_onNew:function(a,
b){this._checkUpdateStatus();var c=this.get("rowCount");this._addingItem=!0;this.updateRowCount(c+1);this._addingItem=!1;this._addItem(a,c);this.showMessage()},_onDelete:function(a){this._checkUpdateStatus();a=this._getItemIndex(a,!0);if(0<=a){this._pages=[];this._eop=this._bop=-1;var b=this._by_idx[a];this._by_idx.splice(a,1);delete this._by_idty[b.idty];this.updateRowCount(this.get("rowCount")-1);0===this.get("rowCount")&&this.showMessage(this.noDataMessage)}this.selection.isSelected(a)&&(this.selection.deselect(a),
this.selection.selected.splice(a,1))},_onRevert:function(){this._refresh()},setStore:function(a,b,d){this._requestsPending(0)||(this._setQuery(b,d),this._setStore(a),this._refresh(!0))},setQuery:function(a,b){this._requestsPending(0)||(this._setQuery(a,b),this._refresh(!0))},setItems:function(a){this.items=a;this._setStore(this.store);this._refresh(!0)},_setQuery:function(a,b){this.query=a;this.queryOptions=b||this.queryOptions},_setStore:function(a){this.store&&this._store_connects&&k.forEach(this._store_connects,
this.disconnect,this);if(this.store=a){a=this.store.getFeatures();var b=[];this._canEdit=!!a["dojo.data.api.Write"]&&!!a["dojo.data.api.Identity"];this._hasIdentity=!!a["dojo.data.api.Identity"];a["dojo.data.api.Notification"]&&!this.items&&(b.push(this.connect(this.store,"onSet","_onSet")),b.push(this.connect(this.store,"onNew","_onNew")),b.push(this.connect(this.store,"onDelete","_onDelete")));this._canEdit&&b.push(this.connect(this.store,"revert","_onRevert"));this._store_connects=b}},_onFetchBegin:function(a,
b){this.scroller&&(this.rowCount!=a&&(b.isRender?(this.scroller.init(a,this.keepRows,this.rowsPerPage),this.rowCount=a,this._setAutoHeightAttr(this.autoHeight,!0),this._skipRowRenormalize=!0,this.prerender(),this._skipRowRenormalize=!1):this.updateRowCount(a)),a?this.showMessage():(this.views.render(),this._resize(),this.showMessage(this.noDataMessage),this.focus.initFocusView()))},_onFetchComplete:function(a,d){this.scroller&&(a&&0<a.length&&(k.forEach(a,function(a,b){this._addItem(a,d.start+b,!0)},
this),this.updateRows(d.start,a.length),d.isRender?(this.setScrollTop(0),this.postrender()):this._lastScrollTop&&this.setScrollTop(this._lastScrollTop),b("ie")&&g.setSelectable(this.domNode,this.selectable)),delete this._lastScrollTop,this._isLoaded||(this._isLoading=!1,this._isLoaded=!0),this._pending_requests[d.start]=!1)},_onFetchError:function(a,b){delete this._lastScrollTop;this._isLoaded||(this._isLoading=!1,this._isLoaded=!0,this.showMessage(this.errorMessage));this._pending_requests[b.start]=
!1;this.onFetchError(a,b)},onFetchError:function(a,b){},_fetch:function(b,d){b=b||0;if(this.store&&!this._pending_requests[b]){this._isLoaded||this._isLoading||(this._isLoading=!0,this.showMessage(this.loadingMessage));this._pending_requests[b]=!0;try{if(this.items){var c=this.items,e=this.store;this.rowsPerPage=c.length;var f={start:b,count:this.rowsPerPage,isRender:d};this._onFetchBegin(c.length,f);var g=0;k.forEach(c,function(a){e.isItemLoaded(a)||g++});if(0===g)this._onFetchComplete(c,f);else{var l=
function(a){g--;0===g&&this._onFetchComplete(c,f)};k.forEach(c,function(a){e.isItemLoaded(a)||e.loadItem({item:a,onItem:l,scope:this})},this)}}else this.store.fetch({start:b,count:this.rowsPerPage,query:this.query,sort:this.getSortProps(),queryOptions:this.queryOptions,isRender:d,onBegin:a.hitch(this,"_onFetchBegin"),onComplete:a.hitch(this,"_onFetchComplete"),onError:a.hitch(this,"_onFetchError")})}catch(w){this._onFetchError(w,{start:b,count:this.rowsPerPage})}}},_clearData:function(){this.updateRowCount(0);
this._by_idty={};this._by_idx=[];this._pages=[];this._bop=this._eop=-1;this._isLoading=this._isLoaded=!1},getItem:function(a){var b=this._by_idx[a];return!b||b&&!b.item?(this._preparePage(a),null):b.item},getItemIndex:function(a){return this._getItemIndex(a,!1)},_getItemIndex:function(a,b){if(!b&&!this.store.isItem(a))return-1;for(var c=this._hasIdentity?this.store.getIdentity(a):null,d=0,e=this._by_idx.length;d<e;d++){var f=this._by_idx[d];if(f&&(c&&f.idty==c||f.item===a))return d}return-1},filter:function(a,
b){this.query=a;b&&this._clearData();this._fetch()},_getItemAttr:function(a,b){var c=this.getItem(a);return c?this.store.getValue(c,b):this.fetchText},_render:function(){this.domNode.parentNode&&(this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage),this.prerender(),this._fetch(0,!0))},_requestsPending:function(a){return this._pending_requests[a]},_rowToPage:function(a){return this.rowsPerPage?Math.floor(a/this.rowsPerPage):a},_pageToRow:function(a){return this.rowsPerPage?this.rowsPerPage*
a:a},_preparePage:function(a){(a<this._bop||a>=this._eop)&&!this._addingItem&&(a=this._rowToPage(a),this._needPage(a),this._bop=a*this.rowsPerPage,this._eop=this._bop+(this.rowsPerPage||this.get("rowCount")))},_needPage:function(a){this._pages[a]||(this._pages[a]=!0,this._requestPage(a))},_requestPage:function(b){b=this._pageToRow(b);0<Math.min(this.rowsPerPage,this.get("rowCount")-b)&&(this._requests++,this._requestsPending(b)||setTimeout(a.hitch(this,"_fetch",b,!1),1))},getCellName:function(a){return a.field},
_refresh:function(a){this._clearData();this._fetch(0,a)},sort:function(){this.edit.apply();this._lastScrollTop=this.scrollTop;this._refresh()},canSort:function(){return!this._isLoading},getSortProps:function(){var a=this.getCell(this.getSortIndex());if(a){var b=a.sortDesc,d=!(0<this.sortInfo);return[{attribute:a.field,descending:"undefined"==typeof b?d:d?!b:b}]}return this.sortFields?this.sortFields:null},styleRowState:function(a){if(this.store&&this.store.getState){for(var b=this.store.getState(a.index),
c="",d=0,e=["inflight","error","inserting"],f;f=e[d];d++)if(b[f]){c=" dojoxGridRow-"+f;break}a.customClasses+=c}},onStyleRow:function(a){this.styleRowState(a);this.inherited(arguments)},canEdit:function(a,b){return this._canEdit},_copyAttr:function(a,b){var c=this.getItem(a);return this.store.getValue(c,b)},doStartEdit:function(a,b){this._cache[b]||(this._cache[b]=this._copyAttr(b,a.field));this.onStartEdit(a,b)},doApplyCellEdit:function(b,d,e){this.store.fetchItemByIdentity({identity:this._by_idx[d].idty,
onItem:a.hitch(this,function(a){var c=this.store.getValue(a,e);"number"==typeof c?b=isNaN(b)?b:parseFloat(b):"boolean"==typeof c?b="true"==b?!0:"false"==b?!1:b:c instanceof Date&&(c=new Date(b),b=isNaN(c.getTime())?b:c);this.store.setValue(a,e,b);this.onApplyCellEdit(b,d,e)})})},doCancelEdit:function(a){this._cache[a]&&(this.updateRow(a),delete this._cache[a]);this.onCancelEdit.apply(this,arguments)},doApplyEdit:function(a,b){this.onApplyEdit(a)},removeSelectedRows:function(){if(this._canEdit){this.edit.apply();
var b=a.hitch(this,function(a){a.length&&(k.forEach(a,this.store.deleteItem,this.store),this.selection.clear())});this.allItemsSelected?this.store.fetch({query:this.query,queryOptions:this.queryOptions,onComplete:b}):b(this.selection.getSelected())}}});d.cell_markupFactory=function(b,d,e){var c=a.trim(g.attr(d,"field")||"");c&&(e.field=c);e.field=e.field||e.name;if(c=a.trim(g.attr(d,"fields")||""))e.fields=c.split(",");b&&b(d,e)};d.markupFactory=function(b,e,f,g){return l.markupFactory(b,e,f,a.partial(d.cell_markupFactory,
g))};return d})},"dojox/grid/_Grid":function(){define("dojo/_base/kernel ../main dojo/_base/declare ./_Events ./_Scroller ./_Layout ./_View ./_ViewManager ./_RowManager ./_FocusManager ./_EditManager ./Selection ./_RowSelector ./util dijit/_Widget dijit/_TemplatedMixin dijit/CheckedMenuItem dojo/text!./resources/_Grid.html dojo/string dojo/_base/array dojo/_base/lang dojo/_base/sniff dojox/html/metrics dojo/_base/html dojo/query dojo/dnd/common dojo/i18n!dijit/nls/loading".split(" "),function(h,k,
a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D){h.isCopyKey||(h.isCopyKey=h.dnd.getCopyKeyState);a=a("dojox.grid._Grid",[r,v,f],{templateString:w,classTag:"dojoxGrid",rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:!1,initialWidth:"",autoHeight:"",rowHeight:0,autoRender:!0,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:!1,selectionMode:"extended",rowSelector:"",columnReordering:!1,headerMenu:null,placeholderLabel:"GridColumns",selectable:!1,_click:null,loadingMessage:"\x3cspan class\x3d'dojoxGridLoading'\x3e${loadingState}\x3c/span\x3e",
errorMessage:"\x3cspan class\x3d'dojoxGridError'\x3e${errorState}\x3c/span\x3e",noDataMessage:"",escapeHTMLInData:!0,formatterScope:null,editable:!1,summary:"",_setSummaryAttr:"domNode",sortInfo:0,_placeholders:null,_layoutClass:e,buildRendering:function(){this.inherited(arguments);this.domNode.getAttribute("tabIndex")||(this.domNode.tabIndex="0");this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");
this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");B.initOnFontResize();this.connect(B,"onFontResize","textSizeChanged");t.funnelEvents(this.domNode,this,"doKeyEvent",t.keyEvents);"none"!=this.selectionMode&&this.domNode.setAttribute("aria-multiselectable","single"==this.selectionMode?"false":"true");C.addClass(this.domNode,this.classTag);this.isLeftToRight()||C.addClass(this.domNode,this.classTag+"Rtl");0<this.rowHeight&&C.addClass(this.viewsNode,
this.classTag+"FixedRowHeight")},postMixInProperties:function(){this.inherited(arguments);var a=h.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=x.substitute(this.loadingMessage,a);this.errorMessage=x.substitute(this.errorMessage,a);this.srcNodeRef&&this.srcNodeRef.style.height&&(this.height=this.srcNodeRef.style.height);this._setAutoHeightAttr(this.autoHeight,!0);this.lastScrollTop=this.scrollTop=0},postCreate:function(){this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);
this._setStructureAttr(this.structure);this._click=[];this.inherited(arguments);this.domNode&&this.autoWidth&&this.initialWidth&&(this.domNode.style.width=this.initialWidth);this.domNode&&!this.editable&&C.attr(this.domNode,"aria-readonly","true")},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;this.scroller&&(this.scroller.destroy(),delete this.scroller);this.edit.destroy();delete this.edit;this.views.destroyViews();this.focus&&(this.focus.destroy(),
delete this.focus);this.headerMenu&&this._placeholders.length&&(y.forEach(this._placeholders,function(a){a.unReplace(!0)}),this.headerMenu.unBindDomNode(this.viewsHeaderNode));this.inherited(arguments)},_setAutoHeightAttr:function(a,b){"string"==typeof a&&(a=a&&"false"!=a?"true"==a?!0:window.parseInt(a,10):!1);"number"==typeof a&&(isNaN(a)&&(a=!1),0>a?a=!0:0===a&&(a=!1));this.autoHeight=a;this._autoHeight="boolean"==typeof a?a:"number"==typeof a?a>=this.get("rowCount"):!1;this._started&&!b&&this.render()},
_getRowCountAttr:function(){return this.updating&&this.invalidated&&void 0!=this.invalidated.rowCount?this.invalidated.rowCount:this.rowCount},textSizeChanged:function(){this.render()},sizeChange:function(){this.update()},createManagers:function(){this.rows=new g(this);this.focus=new d(this);this.edit=new c(this)},createSelection:function(){this.selection=new n(this)},createScroller:function(){this.scroller=new b;this.scroller.grid=this;this.scroller.renderRow=A.hitch(this,"renderRow");this.scroller.removeRow=
A.hitch(this,"rowRemoved")},createLayout:function(){this.layout=new this._layoutClass(this);this.connect(this.layout,"moveColumn","onMoveColumn")},onMoveColumn:function(){this.update()},onResizeColumn:function(a){},createViews:function(){this.views=new m(this);this.views.createView=A.hitch(this,"createView")},createView:function(a,b){var c=new (A.getObject(a))({grid:this,index:b});this.viewsNode.appendChild(c.domNode);this.viewsHeaderNode.appendChild(c.headerNode);this.views.addView(c);C.attr(this.domNode,
"align",this.isLeftToRight()?"left":"right");return c},buildViews:function(){for(var a=0,b;b=this.layout.structure[a];a++)this.createView(b.type||k._scopeName+".grid._View",a).setStructure(b);this.scroller.setContentNodes(this.views.getContentNodes())},_setStructureAttr:function(a){a&&A.isString(a)&&(h.deprecated("dojox.grid._Grid.set('structure', 'objVar')","use dojox.grid._Grid.set('structure', objVar) instead","2.0"),a=A.getObject(a));this.structure=a;if(!a)if(this.layout.structure)a=this.layout.structure;
else return;this.views.destroyViews();this.focus.focusView=null;a!==this.layout.structure&&this.layout.setStructure(a);this._structureChanged()},setStructure:function(a){h.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.set('structure', obj) instead.","2.0");this._setStructureAttr(a)},getColumnTogglingItems:function(){var a,b=[];a=y.map(this.layout.cells,function(a){a.menuItems||(a.menuItems=[]);var c=this,d=new u({label:a.name,checked:!a.hidden,_gridCell:a,onChange:function(a){if(c.layout.setColumnVisibility(this._gridCell.index,
a)){var b=this._gridCell.menuItems;1<b.length&&y.forEach(b,function(b){b!==this&&b.setAttribute("checked",a)},this);a=y.filter(c.layout.cells,function(a){1<a.menuItems.length?y.forEach(a.menuItems,"item.set('disabled', false);"):a.menuItems[0].set("disabled",!1);return!a.hidden});1==a.length&&y.forEach(a[0].menuItems,"item.set('disabled', true);")}},destroy:function(){var a=y.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(a,1);delete this._gridCell;u.prototype.destroy.apply(this,
arguments)}});a.menuItems.push(d);a.hidden||b.push(d);return d},this);1==b.length&&b[0].set("disabled",!0);return a},_setHeaderMenuAttr:function(a){this._placeholders&&this._placeholders.length&&(y.forEach(this._placeholders,function(a){a.unReplace(!0)}),this._placeholders=[]);this.headerMenu&&this.headerMenu.unBindDomNode(this.viewsHeaderNode);if(this.headerMenu=a)this.headerMenu.bindDomNode(this.viewsHeaderNode),this.headerMenu.getPlaceholders&&(this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel))},
setHeaderMenu:function(a){h.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.set('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(a)},setupHeaderMenu:function(){this._placeholders&&this._placeholders.length&&y.forEach(this._placeholders,function(a){a._replaced&&a.unReplace(!0);a.replace(this.getColumnTogglingItems())},this)},_fetch:function(a){this.setScrollTop(0)},getItem:function(a){return null},showMessage:function(a){a?(this.messagesNode.innerHTML=a,this.messagesNode.style.display=
""):(this.messagesNode.innerHTML="",this.messagesNode.style.display="none")},_structureChanged:function(){this.buildViews();this.autoRender&&this._started&&this.render()},hasLayout:function(){return this.layout.cells.length},resize:function(a,b){this._pendingChangeSize=a;this._pendingResultSize=b;this.sizeChange()},_getPadBorder:function(){return this._padBorder=this._padBorder||C._getPadBorderExtents(this.domNode)},_getHeaderHeight:function(){var a=this.viewsHeaderNode.style,b="none"==a.display?
0:this.views.measureHeader();a.height=b+"px";this.views.normalizeHeaderNodeHeight();return b},_resize:function(a,b){a=a||this._pendingChangeSize;b=b||this._pendingResultSize;delete this._pendingChangeSize;delete this._pendingResultSize;if(this.domNode){var c=this.domNode.parentNode;if(c&&1==c.nodeType&&this.hasLayout()&&"hidden"!=c.style.visibility&&"none"!=c.style.display){var d=this._getPadBorder(),e=void 0,f;this._autoHeight?this.domNode.style.height="auto":"number"==typeof this.autoHeight?(f=
e=this._getHeaderHeight(),f+=this.scroller.averageRowHeight*this.autoHeight,this.domNode.style.height=f+"px"):this.domNode.clientHeight<=d.h&&(c==document.body?this.domNode.style.height=this.defaultHeight:this.height?this.domNode.style.height=this.height:this.fitTo="parent");b&&(a=b);!this._autoHeight&&a?(C.marginBox(this.domNode,a),this.height=this.domNode.style.height,delete this.fitTo):"parent"==this.fitTo&&(f=this._parentContentBoxHeight=0<this._parentContentBoxHeight?this._parentContentBoxHeight:
C._getContentBox(c).h,this.domNode.style.height=Math.max(0,f)+"px");c=y.some(this.views.views,function(a){return a.flexCells});this._autoHeight||0!==(f||C._getContentBox(this.domNode).h)?(this.viewsHeaderNode.style.display="block",c||void 0!==e||(e=this._getHeaderHeight())):this.viewsHeaderNode.style.display="none";c&&(e=void 0);this.adaptWidth();this.adaptHeight(e);this.postresize()}}},adaptWidth:function(){var a=!this.initialWidth&&this.autoWidth,b=a?0:this.domNode.clientWidth||this.domNode.offsetWidth-
this._getPadBorder().w,b=this.views.arrange(1,b);this.views.onEach("adaptWidth");a&&(this.domNode.style.width=b+"px")},adaptHeight:function(a){a=void 0===a?this._getHeaderHeight():a;var b=this._autoHeight?-1:Math.max(this.domNode.clientHeight-a,0)||0;this.views.onEach("setSize",[0,b]);this.views.onEach("adaptHeight");if(!this._autoHeight){var c=0,d=0,e=y.filter(this.views.views,function(a){(a=a.hasHScrollbar())?c++:d++;return!a});0<c&&0<d&&y.forEach(e,function(a){a.adaptHeight(!0)})}!0===this.autoHeight||
-1!=b||"number"==typeof this.autoHeight&&this.autoHeight>=this.get("rowCount")?this.scroller.windowHeight=b:this.scroller.windowHeight=Math.max(this.domNode.clientHeight-a,0)},startup:function(){this._started||(this.inherited(arguments),this.autoRender&&this.render())},render:function(){this.domNode&&this._started&&(this.hasLayout()?(this.update=this.defaultUpdate,this._render()):this.scroller.init(0,this.keepRows,this.rowsPerPage))},_render:function(){this.scroller.init(this.get("rowCount"),this.keepRows,
this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender()},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize()},postrender:function(){this.postresize();this.focus.initFocusView();C.setSelectable(this.domNode,this.selectable)},postresize:function(){if(this._autoHeight){var a=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=a}},renderRow:function(a,b){this.views.renderRow(a,
b,this._skipRowRenormalize)},rowRemoved:function(a){this.views.rowRemoved(a)},invalidated:null,updating:!1,beginUpdate:function(){this.invalidated=[];this.updating=!0},endUpdate:function(){this.updating=!1;var a=this.invalidated,b;if(a.all)this.update();else if(void 0!=a.rowCount)this.updateRowCount(a.rowCount);else for(b in a)this.updateRow(Number(b));this.invalidated=[]},defaultUpdate:function(){this.domNode&&(this.updating?this.invalidated.all=!0:(this.lastScrollTop=this.scrollTop,this.prerender(),
this.scroller.invalidateNodes(),this.setScrollTop(this.lastScrollTop),this.postrender()))},update:function(){this.render()},updateRow:function(a){a=Number(a);this.updating?this.invalidated[a]=!0:(this.views.updateRow(a),this.scroller.rowHeightChanged(a))},updateRows:function(a,b){a=Number(a);b=Number(b);var c;if(this.updating)for(c=0;c<b;c++)this.invalidated[c+a]=!0;else{for(c=0;c<b;c++)this.views.updateRow(c+a,this._skipRowRenormalize);this.scroller.rowHeightChanged(a)}},updateRowCount:function(a){this.updating?
this.invalidated.rowCount=a:(this.rowCount=a,this._setAutoHeightAttr(this.autoHeight,!0),this.layout.cells.length&&this.scroller.updateRowCount(a),this._resize(),this.layout.cells.length&&this.setScrollTop(this.scrollTop))},updateRowStyles:function(a){this.views.updateRowStyles(a)},getRowNode:function(a){if(!this.focus.focusView||this.focus.focusView instanceof q)for(var b=0,c;c=this.views.views[b];b++){if(!(c instanceof q))return c.rowNodes[a]}else return this.focus.focusView.rowNodes[a];return null},
rowHeightChanged:function(a){this.views.renormalizeRow(a);this.scroller.rowHeightChanged(a)},fastScroll:!0,delayScroll:!1,scrollRedrawThreshold:z("ie")?100:50,scrollTo:function(a){if(this.fastScroll){var b=Math.abs(this.lastScrollTop-a);this.lastScrollTop=a;if(b>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=!0;this.scrollTop=a;this.views.setScrollTop(a);this._pendingScroll&&window.clearTimeout(this._pendingScroll);var c=this;this._pendingScroll=window.setTimeout(function(){delete c._pendingScroll;
c.finishScrollJob()},200)}else this.setScrollTop(a)}else this.setScrollTop(a)},finishScrollJob:function(){this.delayScroll=!1;this.setScrollTop(this.scrollTop)},setScrollTop:function(a){this.scroller.scroll(this.views.setScrollTop(a))},scrollToRow:function(a){this.setScrollTop(this.scroller.findScrollTop(a)+1)},styleRowNode:function(a,b){b&&this.rows.styleRowNode(a,b)},_mouseOut:function(a){this.rows.setOverRow(-2)},getCell:function(a){return this.layout.cells[a]},setCellWidth:function(a,b){this.getCell(a).unitWidth=
b},getCellName:function(a){return"Cell "+a.index},canSort:function(a){},sort:function(){},getSortAsc:function(a){a=void 0==a?this.sortInfo:a;return 0<a},getSortIndex:function(a){a=void 0==a?this.sortInfo:a;return Math.abs(a)-1},setSortIndex:function(a,b){var c=a+1;void 0!=b?c*=b?1:-1:this.getSortIndex()==a&&(c=-this.sortInfo);this.setSortInfo(c)},setSortInfo:function(a){this.canSort(a)&&(this.sortInfo=a,this.sort(),this.update())},doKeyEvent:function(a){a.dispatch="do"+a.type;this.onKeyEvent(a)},
_dispatch:function(a,b){return a in this?this[a](b):!1},dispatchKeyEvent:function(a){this._dispatch(a.dispatch,a)},dispatchContentEvent:function(a){this.edit.dispatchEvent(a)||a.sourceView.dispatchContentEvent(a)||this._dispatch(a.dispatch,a)},dispatchHeaderEvent:function(a){a.sourceView.dispatchHeaderEvent(a)||this._dispatch("doheader"+a.type,a)},dokeydown:function(a){this.onKeyDown(a)},doclick:function(a){if(a.cellNode)this.onCellClick(a);else this.onRowClick(a)},dodblclick:function(a){if(a.cellNode)this.onCellDblClick(a);
else this.onRowDblClick(a)},docontextmenu:function(a){if(a.cellNode)this.onCellContextMenu(a);else this.onRowContextMenu(a)},doheaderclick:function(a){if(a.cellNode)this.onHeaderCellClick(a);else this.onHeaderClick(a)},doheaderdblclick:function(a){if(a.cellNode)this.onHeaderCellDblClick(a);else this.onHeaderDblClick(a)},doheadercontextmenu:function(a){if(a.cellNode)this.onHeaderCellContextMenu(a);else this.onHeaderContextMenu(a)},doStartEdit:function(a,b){this.onStartEdit(a,b)},doApplyCellEdit:function(a,
b,c){this.onApplyCellEdit(a,b,c)},doCancelEdit:function(a){this.onCancelEdit(a)},doApplyEdit:function(a){this.onApplyEdit(a)},addRow:function(){this.updateRowCount(this.get("rowCount")+1)},removeSelectedRows:function(){this.allItemsSelected?this.updateRowCount(0):this.updateRowCount(Math.max(0,this.get("rowCount")-this.selection.getSelected().length));this.selection.clear()}});a.markupFactory=function(a,b,c,d){var e=function(a){a=C.attr(a,"width")||"auto";"auto"!=a&&"em"!=a.slice(-2)&&"%"!=a.slice(-1)&&
(a=parseInt(a,10)+"px");return a};a.structure||"table"!=b.nodeName.toLowerCase()||(a.structure=D("\x3e colgroup",b).map(function(a){var b=C.attr(a,"span"),b={noscroll:"true"==C.attr(a,"noscroll")?!0:!1,__span:b?parseInt(b,10):1,cells:[]};C.hasAttr(a,"width")&&(b.width=e(a));return b}),a.structure.length||a.structure.push({__span:Infinity,cells:[]}),D("thead \x3e tr",b).forEach(function(b,c){var f=0,g=0,l,h=null;D("\x3e th",b).map(function(b){h?f>=l+h.__span&&(g++,l+=h.__span,h=a.structure[g]):(l=
0,h=a.structure[0]);var m={name:A.trim(C.attr(b,"name")||b.innerHTML),colSpan:parseInt(C.attr(b,"colspan")||1,10),type:A.trim(C.attr(b,"cellType")||""),id:A.trim(C.attr(b,"id")||"")};f+=m.colSpan;var n=C.attr(b,"rowspan");n&&(m.rowSpan=n);C.hasAttr(b,"width")&&(m.width=e(b));C.hasAttr(b,"relWidth")&&(m.relWidth=window.parseInt(C.attr(b,"relWidth"),10));C.hasAttr(b,"hidden")&&(m.hidden="true"==C.attr(b,"hidden")||!0===C.attr(b,"hidden"));d&&d(b,m);m.type=m.type?A.getObject(m.type):k.grid.cells.Cell;
m.type&&m.type.markupFactory&&m.type.markupFactory(b,m);h.cells[c]||(h.cells[c]=[]);h.cells[c].push(m)})}));return new c(a,b)};return a})},"dojox/grid/_Events":function(){define(["dojo/keys","dojo/dom-class","dojo/_base/declare","dojo/_base/event","dojo/_base/sniff"],function(h,k,a,f,b){return a("dojox.grid._Events",null,{cellOverClass:"dojoxGridCellOver",onKeyEvent:function(a){this.dispatchKeyEvent(a)},onContentEvent:function(a){this.dispatchContentEvent(a)},onHeaderEvent:function(a){this.dispatchHeaderEvent(a)},
onStyleRow:function(a){a.customClasses+=(a.odd?" dojoxGridRowOdd":"")+(a.selected?" dojoxGridRowSelected":"")+(a.over?" dojoxGridRowOver":"");this.focus.styleRow(a);this.edit.styleRow(a)},onKeyDown:function(a){if(!a.altKey&&!a.metaKey){var b;switch(a.keyCode){case h.ESCAPE:this.edit.cancel();break;case h.ENTER:if(!this.edit.isEditing()){b=this.focus.getHeaderIndex();if(0<=b){this.setSortIndex(b);break}else this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(a),a.shiftKey);f.stop(a)}a.shiftKey||
(b=this.edit.isEditing(),this.edit.apply(),b||this.edit.setEditCell(this.focus.cell,this.focus.rowIndex));this.edit.isEditing()||((this.focus.focusView||this.views.views[0]).content.decorateEvent(a),this.onRowClick(a),f.stop(a));break;case h.SPACE:this.edit.isEditing()||(b=this.focus.getHeaderIndex(),0<=b?this.setSortIndex(b):(this.selection.clickSelect(this.focus.rowIndex,dojo.isCopyKey(a),a.shiftKey),this.focus._focusifyCellNode(!0),this.focus.setFocusCell(this.focus.cell,this.focus.rowIndex),f.stop(a)));
break;case h.TAB:this.focus[a.shiftKey?"previousKey":"nextKey"](a);break;case h.LEFT_ARROW:case h.RIGHT_ARROW:if(!this.edit.isEditing()){var e=a.keyCode;f.stop(a);b=this.focus.getHeaderIndex();0<=b&&a.shiftKey&&a.ctrlKey?this.focus.colSizeAdjust(a,b,5*(e==h.LEFT_ARROW?-1:1)):(a=e==h.LEFT_ARROW?1:-1,this.isLeftToRight()&&(a*=-1),this.focus.move(0,a))}break;case h.UP_ARROW:this.edit.isEditing()||0===this.focus.rowIndex||(f.stop(a),this.focus.move(-1,0));break;case h.DOWN_ARROW:this.edit.isEditing()||
this.focus.rowIndex+1==this.rowCount||(f.stop(a),this.focus.move(1,0));break;case h.PAGE_UP:this.edit.isEditing()||0===this.focus.rowIndex||(f.stop(a),this.focus.rowIndex!=this.scroller.firstVisibleRow+1?this.focus.move(this.scroller.firstVisibleRow-this.focus.rowIndex,0):(this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex-1)),this.focus.move(this.scroller.firstVisibleRow-this.scroller.lastVisibleRow+1,0)));break;case h.PAGE_DOWN:this.edit.isEditing()||this.focus.rowIndex+1==this.rowCount||
(f.stop(a),this.focus.rowIndex!=this.scroller.lastVisibleRow-1?this.focus.move(this.scroller.lastVisibleRow-this.focus.rowIndex-1,0):(this.setScrollTop(this.scroller.findScrollTop(this.focus.rowIndex+1)),this.focus.move(this.scroller.lastVisibleRow-this.scroller.firstVisibleRow-1,0)))}}},onMouseOver:function(a){-1==a.rowIndex?this.onHeaderCellMouseOver(a):this.onCellMouseOver(a)},onMouseOut:function(a){-1==a.rowIndex?this.onHeaderCellMouseOut(a):this.onCellMouseOut(a)},onMouseDown:function(a){-1==
a.rowIndex?this.onHeaderCellMouseDown(a):this.onCellMouseDown(a)},onMouseOverRow:function(a){this.rows.isOver(a.rowIndex)||(this.rows.setOverRow(a.rowIndex),-1==a.rowIndex?this.onHeaderMouseOver(a):this.onRowMouseOver(a))},onMouseOutRow:function(a){if(this.rows.isOver(-1))this.onHeaderMouseOut(a);else this.rows.isOver(-2)||(this.rows.setOverRow(-2),this.onRowMouseOut(a))},onMouseDownRow:function(a){if(-1!=a.rowIndex)this.onRowMouseDown(a)},onCellMouseOver:function(a){a.cellNode&&k.add(a.cellNode,
this.cellOverClass)},onCellMouseOut:function(a){a.cellNode&&k.remove(a.cellNode,this.cellOverClass)},onCellMouseDown:function(a){},onCellClick:function(a){this._click[0]=this._click[1];this._click[1]=a;this.edit.isEditCell(a.rowIndex,a.cellIndex)||this.focus.setFocusCell(a.cell,a.rowIndex);1<this._click.length&&null==this._click[0]&&this._click.shift();this.onRowClick(a)},onCellDblClick:function(a){var e;e=1<this._click.length&&b("ie")?this._click[1]:1<this._click.length&&this._click[0].rowIndex!=
this._click[1].rowIndex?this._click[0]:a;this.focus.setFocusCell(e.cell,e.rowIndex);this.edit.setEditCell(e.cell,e.rowIndex);this.onRowDblClick(a)},onCellContextMenu:function(a){this.onRowContextMenu(a)},onCellFocus:function(a,b){this.edit.cellFocus(a,b)},onRowClick:function(a){this.edit.rowClick(a);this.selection.clickSelectEvent(a)},onRowDblClick:function(a){},onRowMouseOver:function(a){},onRowMouseOut:function(a){},onRowMouseDown:function(a){},onRowContextMenu:function(a){f.stop(a)},onHeaderMouseOver:function(a){},
onHeaderMouseOut:function(a){},onHeaderCellMouseOver:function(a){a.cellNode&&k.add(a.cellNode,this.cellOverClass)},onHeaderCellMouseOut:function(a){a.cellNode&&k.remove(a.cellNode,this.cellOverClass)},onHeaderCellMouseDown:function(a){},onHeaderClick:function(a){},onHeaderCellClick:function(a){this.setSortIndex(a.cell.index);this.onHeaderClick(a)},onHeaderDblClick:function(a){},onHeaderCellDblClick:function(a){this.onHeaderDblClick(a)},onHeaderCellContextMenu:function(a){this.onHeaderContextMenu(a)},
onHeaderContextMenu:function(a){this.headerMenu||f.stop(a)},onStartEdit:function(a,b){},onApplyCellEdit:function(a,b,f){},onCancelEdit:function(a){},onApplyEdit:function(a){},onCanSelect:function(a){return!0},onCanDeselect:function(a){return!0},onSelected:function(a){this.updateRowStyles(a)},onDeselected:function(a){this.updateRowStyles(a)},onSelectionChanged:function(){}})})},"dojox/grid/_Scroller":function(){define(["dijit/registry","dojo/_base/declare","dojo/_base/lang","./util","dojo/_base/html"],
function(h,k,a,f,b){var e=function(a){a&&dojo.forEach(h.toArray(),function(e){e.domNode&&b.isDescendant(e.domNode,a,!0)&&e.destroy()})},l=function(a,e){for(var d=[],c=0,f;f=a.childNodes[c];){c++;var g=b.byId(f);(g&&g.tagName?g.tagName.toLowerCase():"")==e&&d.push(f)}return d};return k("dojox.grid._Scroller",null,{constructor:function(a){this.setContentNodes(a);this.pageHeights=[];this.pageNodes=[];this.stack=[]},rowCount:0,defaultRowHeight:32,keepRows:100,contentNode:null,scrollboxNode:null,defaultPageHeight:0,
keepPages:10,pageCount:0,windowHeight:0,firstVisibleRow:0,lastVisibleRow:0,averageRowHeight:0,page:0,pageTop:0,init:function(b,e,d){switch(arguments.length){case 3:this.rowsPerPage=d;case 2:this.keepRows=e;case 1:this.rowCount=b}this.defaultPageHeight=(0<this.grid.rowHeight?this.grid.rowHeight:this.defaultRowHeight)*this.rowsPerPage;this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);this.setKeepInfo(this.keepRows);this.invalidate();this.scrollboxNode&&(this.scrollboxNode.scrollTop=
0,this.scroll(0),this.scrollboxNode.onscroll=a.hitch(this,"onscroll"))},_getPageCount:function(a,b){return a?Math.ceil(a/b)||1:0},destroy:function(){this.invalidateNodes();delete this.contentNodes;delete this.contentNode;delete this.scrollboxNode},setKeepInfo:function(a){this.keepPages=(this.keepRows=a)?Math.max(Math.ceil(this.keepRows/this.rowsPerPage),2):this.keepPages},setContentNodes:function(a){this.colCount=(this.contentNodes=a)?this.contentNodes.length:0;this.pageNodes=[];for(a=0;a<this.colCount;a++)this.pageNodes[a]=
[]},getDefaultNodes:function(){return this.pageNodes[0]||[]},invalidate:function(){this._invalidating=!0;this.invalidateNodes();this.pageHeights=[];this.height=this.pageCount?(this.pageCount-1)*this.defaultPageHeight+this.calcLastPageHeight():0;this.resize();this._invalidating=!1},updateRowCount:function(a){this.invalidateNodes();this.rowCount=a;a=this.pageCount;0===a&&(this.height=1);this.pageCount=this._getPageCount(this.rowCount,this.rowsPerPage);if(this.pageCount<a)for(--a;a>=this.pageCount;a--)this.height-=
this.getPageHeight(a),delete this.pageHeights[a];else this.pageCount>a&&(this.height+=this.defaultPageHeight*(this.pageCount-a-1)+this.calcLastPageHeight());this.resize()},pageExists:function(a){return!!this.getDefaultPageNode(a)},measurePage:function(a){return this.grid.rowHeight?((a+1)*this.rowsPerPage>this.rowCount?this.rowCount-a*this.rowsPerPage:this.rowsPerPage)*this.grid.rowHeight:(a=this.getDefaultPageNode(a))&&a.innerHTML?a.offsetHeight:void 0},positionPage:function(a,b){for(var d=0;d<this.colCount;d++)this.pageNodes[d][a].style.top=
b+"px"},repositionPages:function(a){for(var b=this.getDefaultNodes(),d=0,c=0;c<this.stack.length;c++)d=Math.max(this.stack[c],d);var e=(c=b[a])?this.getPageNodePosition(c)+this.getPageHeight(a):0;for(a+=1;a<=d;a++){if(c=b[a]){if(this.getPageNodePosition(c)==e)break;this.positionPage(a,e)}e+=this.getPageHeight(a)}},installPage:function(a){for(var b=0;b<this.colCount;b++)this.contentNodes[b].appendChild(this.pageNodes[b][a])},preparePage:function(a,b){for(var d=b?this.popPage():null,c=0;c<this.colCount;c++){var e=
this.pageNodes[c],f=null===d?this.createPageNode():this.invalidatePageNode(d,e);f.pageIndex=a;e[a]=f}},renderPage:function(a){var b=[],d;for(d=0;d<this.colCount;d++)b[d]=this.pageNodes[d][a];d=0;for(a*=this.rowsPerPage;d<this.rowsPerPage&&a<this.rowCount;d++,a++)this.renderRow(a,b)},removePage:function(a){var b=0;for(a*=this.rowsPerPage;b<this.rowsPerPage;b++,a++)this.removeRow(a)},destroyPage:function(a){for(var e=0;e<this.colCount;e++){var d=this.invalidatePageNode(a,this.pageNodes[e]);d&&b.destroy(d)}},
pacify:function(a){},pacifying:!1,pacifyTicks:200,setPacifying:function(a){this.pacifying!=a&&(this.pacifying=a,this.pacify(this.pacifying))},startPacify:function(){this.startPacifyTicks=(new Date).getTime()},doPacify:function(){var a=(new Date).getTime()-this.startPacifyTicks>this.pacifyTicks;this.setPacifying(!0);this.startPacify();return a},endPacify:function(){this.setPacifying(!1)},resize:function(){this.scrollboxNode&&(this.windowHeight=this.scrollboxNode.clientHeight);for(var a=0;a<this.colCount;a++)f.setStyleHeightPx(this.contentNodes[a],
Math.max(1,this.height));a=!this._invalidating;if(!a){var b=this.grid.get("autoHeight");"number"==typeof b&&b<=Math.min(this.rowsPerPage,this.rowCount)&&(a=!0)}a&&this.needPage(this.page,this.pageTop);a=this.page<this.pageCount-1?this.rowsPerPage:this.rowCount%this.rowsPerPage||this.rowsPerPage;b=this.getPageHeight(this.page);this.averageRowHeight=0<b&&0<a?b/a:0},calcLastPageHeight:function(){if(!this.pageCount)return 0;var a=(this.rowCount%this.rowsPerPage||this.rowsPerPage)*this.defaultRowHeight;
return this.pageHeights[this.pageCount-1]=a},updateContentHeight:function(a){this.height+=a;this.resize()},updatePageHeight:function(a,b,d){if(this.pageExists(a)){var c=this.getPageHeight(a),e=this.measurePage(a);void 0===e&&(e=c);this.pageHeights[a]=e;if(c!=e){this.updateContentHeight(e-c);var f=this.grid.get("autoHeight");"number"==typeof f&&f>this.rowCount||!0===f&&!b?d?(b=this.grid.viewsNode.style,b.height=parseInt(b.height)+e-c+"px",this.repositionPages(a)):this.grid.sizeChange():this.repositionPages(a)}return e}return 0},
rowHeightChanged:function(a,b){this.updatePageHeight(Math.floor(a/this.rowsPerPage),!1,b)},invalidateNodes:function(){for(;this.stack.length;)this.destroyPage(this.popPage())},createPageNode:function(){var a=document.createElement("div");b.attr(a,"role","presentation");a.style.position="absolute";a.style[this.grid.isLeftToRight()?"left":"right"]="0";return a},getPageHeight:function(a){a=this.pageHeights[a];return void 0!==a?a:this.defaultPageHeight},pushPage:function(a){return this.stack.push(a)},
popPage:function(){return this.stack.shift()},findPage:function(a){for(var b=0,d=0,c=0;b<this.pageCount&&!(c=this.getPageHeight(b),d+c>=a);b++,d+=c);this.page=b;this.pageTop=d},buildPage:function(a,b,d){this.preparePage(a,b);this.positionPage(a,d);this.installPage(a);this.renderPage(a);this.pushPage(a)},needPage:function(a,b){var d=this.getPageHeight(a);this.pageExists(a)?this.positionPage(a,b):(this.buildPage(a,!this.grid._autoHeight&&this.keepPages&&this.stack.length>=this.keepPages,b),d=this.updatePageHeight(a,
!0));return d},onscroll:function(){this.scroll(this.scrollboxNode.scrollTop)},scroll:function(a){this.grid.scrollTop=a;if(this.colCount){this.startPacify();this.findPage(a);for(var b=this.height,d=this.getScrollBottom(a),c=this.page,e=this.pageTop;c<this.pageCount&&(0>d||e<d);c++)e+=this.needPage(c,e);this.firstVisibleRow=this.getFirstVisibleRow(this.page,this.pageTop,a);this.lastVisibleRow=this.getLastVisibleRow(c-1,e,d);b!=this.height&&this.repositionPages(c-1);this.endPacify()}},getScrollBottom:function(a){return 0<=
this.windowHeight?a+this.windowHeight:-1},processNodeEvent:function(a,b){for(var d=a.target;d&&d!=b&&d.parentNode&&d.parentNode.parentNode!=b;)d=d.parentNode;if(!d||!d.parentNode||d.parentNode.parentNode!=b)return!1;a.topRowIndex=d.parentNode.pageIndex*this.rowsPerPage;var c=a.topRowIndex,e;a:{e=0;for(var f,g=d.parentNode;f=g.childNodes[e++];)if(f==d){--e;break a}e=-1}a.rowIndex=c+e;a.rowTarget=d;return!0},processEvent:function(a){return this.processNodeEvent(a,this.contentNode)},renderRow:function(a,
b){},removeRow:function(a){},getDefaultPageNode:function(a){return this.getDefaultNodes()[a]},positionPageNode:function(a,b){},getPageNodePosition:function(a){return a.offsetTop},invalidatePageNode:function(a,b){var d=b[a];d&&(delete b[a],this.removePage(a,d),e(d),d.innerHTML="");return d},getPageRow:function(a){return a*this.rowsPerPage},getLastPageRow:function(a){return Math.min(this.rowCount,this.getPageRow(a+1))-1},getFirstVisibleRow:function(a,b,d){if(!this.pageExists(a))return 0;var c=this.getPageRow(a),
e=this.getDefaultNodes();a=l(e[a],"div");for(var e=0,f=a.length;e<f&&b<d;e++,c++)b+=a[e].offsetHeight;return c?c-1:c},getLastVisibleRow:function(a,b,d){if(!this.pageExists(a))return 0;var c=this.getDefaultNodes(),e=this.getLastPageRow(a);a=l(c[a],"div");for(c=a.length-1;0<=c&&b>d;c--,e--)b-=a[c].offsetHeight;return e+1},findTopRow:function(a){for(var b=this.getDefaultNodes(),b=l(b[this.page],"div"),d=0,c=b.length,e=this.pageTop,f;d<c;d++)if(f=b[d].offsetHeight,e+=f,e>=a)return this.offset=f-(e-a),
d+this.page*this.rowsPerPage;return-1},findScrollTop:function(a){var b=Math.floor(a/this.rowsPerPage),d=0,c;for(c=0;c<b;c++)d+=this.getPageHeight(c);this.pageTop=d;this.page=b;this.needPage(b,this.pageTop);c=this.getDefaultNodes();var e=l(c[b],"div"),b=a-this.rowsPerPage*b;c=0;for(a=e.length;c<a&&c<b;c++)d+=e[c].offsetHeight;return d},dummy:0})})},"dojox/grid/util":function(){define(["../main","dojo/_base/lang","dojo/dom"],function(h,k,a){var f=k.getObject("grid.util",!0,h);f.na="...";f.rowIndexTag=
"gridRowIndex";f.gridViewTag="gridView";f.fire=function(a,e,f){var b=a&&e&&a[e];return b&&(f?b.apply(a,f):a[e]())};f.setStyleHeightPx=function(a,e){if(0<=e){var b=a.style,f=e+"px";a&&b.height!=f&&(b.height=f)}};f.mouseEvents="mouseover mouseout mousedown mouseup click dblclick contextmenu".split(" ");f.keyEvents=["keyup","keydown","keypress"];f.funnelEvents=function(a,e,l,h){h=h?h:f.mouseEvents.concat(f.keyEvents);for(var b=0,d=h.length;b<d;b++)e.connect(a,"on"+h[b],l)};f.removeNode=function(b){(b=
a.byId(b))&&b.parentNode&&b.parentNode.removeChild(b);return b};f.arrayCompare=function(a,e){for(var b=0,f=a.length;b<f;b++)if(a[b]!=e[b])return!1;return a.length==e.length};f.arrayInsert=function(a,e,f){a.length<=e?a[e]=f:a.splice(e,0,f)};f.arrayRemove=function(a,e){a.splice(e,1)};f.arraySwap=function(a,e,f){var b=a[e];a[e]=a[f];a[f]=b};return f})},"dojox/grid/_Layout":function(){define("dojo/_base/kernel ../main dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom-geometry ./cells ./_RowSelector".split(" "),
function(h,k,a,f,b,e){return a("dojox.grid._Layout",null,{constructor:function(a){this.grid=a},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(a,b,e,d,c){var g=this.structure[a].cells[0],l=this.structure[b].cells[0],h=null,m=h=0;a=0;for(var k;k=g[a];a++)if(k.index==e){h=a;break}h=g.splice(h,1)[0];h.view=this.grid.views.views[b];a=0;for(k=null;k=l[a];a++)if(k.index==d){m=a;break}c||(m+=1);l.splice(m,0,h);if(e=this.grid.getCell(this.grid.getSortIndex()))e._currentlySorted=this.grid.getSortAsc();
this.cells=[];for(a=e=0;b=this.structure[a];a++)for(d=0;c=b.cells[d];d++)for(g=0;k=c[g];g++)k.index=e,this.cells.push(k),"_currentlySorted"in k&&(l=e+1,l*=k._currentlySorted?1:-1,this.grid.sortInfo=l,delete k._currentlySorted),e++;f.forEach(this.cells,function(a){var b=a.markup[2].split(" ");parseInt(b[1].substring(5))!=a.index&&(b[1]='idx\x3d"'+a.index+'"',a.markup[2]=b.join(" "))});this.grid.setupHeaderMenu()},setColumnVisibility:function(a,b){var f=this.cells[a];if(f.hidden==b){f.hidden=!b;var d=
f.view,c=d.viewWidth;c&&"auto"!=c&&(d._togglingColumn=e.getMarginBox(f.getHeaderNode()).w||0);d.update();return!0}return!1},addCellDef:function(a,e,f){var d=this,c=function(a){var b=0;1<a.colSpan?b=0:(b=a.width||d._defaultCellProps.width||d.defaultWidth,isNaN(b)||(b+="em"));return b};a={grid:this.grid,subrow:a,layoutIndex:e,index:this.cells.length};if(f&&f instanceof k.grid.cells._Base)return e=b.clone(f),a.unitWidth=c(e._props),e=b.mixin(e,this._defaultCellProps,f._props,a);e=f.type||f.cellType||
this._defaultCellProps.type||this._defaultCellProps.cellType||k.grid.cells.Cell;b.isString(e)&&(e=b.getObject(e));a.unitWidth=c(f);return new e(b.mixin({},this._defaultCellProps,f,a))},addRowDef:function(a,b){for(var e=[],d=0,c=0,l=!0,h=0,m;m=b[h];h++)m=this.addCellDef(a,h,m),e.push(m),this.cells.push(m),l&&m.relWidth?d+=m.relWidth:m.width&&(m=m.width,"string"==typeof m&&"%"==m.slice(-1)?c+=window.parseInt(m,10):"auto"==m&&(l=!1));d&&l&&f.forEach(e,function(a){a.relWidth&&(a.width=a.unitWidth=a.relWidth/
d*(100-c)+"%")});return e},addRowsDef:function(a){var e=[];if(b.isArray(a))if(b.isArrayLike(a[0]))for(var f=0,d;a&&(d=a[f]);f++)e.push(this.addRowDef(f,d));else e.push(this.addRowDef(0,a));return e},addViewDef:function(a){this._defaultCellProps=a.defaultCell||{};a.width&&"auto"==a.width&&delete a.width;return b.mixin({},a,{cells:this.addRowsDef(a.rows||a.cells)})},setStructure:function(a){this.fieldIndex=0;this.cells=[];var e=this.structure=[];if(this.grid.rowSelector){var f={type:k._scopeName+".grid._RowSelector"};
if(b.isString(this.grid.rowSelector)){var d=this.grid.rowSelector;"false"==d?f=null:"true"!=d&&(f.width=d)}else this.grid.rowSelector||(f=null);f&&e.push(this.addViewDef(f))}var c=function(a){return"name"in a||"field"in a||"get"in a},f=function(a){return b.isArray(a)&&(b.isArray(a[0])||c(a[0]))?!0:!1},d=function(a){return null!==a&&b.isObject(a)&&("cells"in a||"rows"in a||"type"in a&&!c(a))};if(b.isArrayLike(a)){for(var l=!1,h=0,t;t=a[h];h++)if(d(t)){l=!0;break}if(l)for(h=0;t=a[h];h++)f(t)?e.push(this.addViewDef({cells:t})):
d(t)&&e.push(this.addViewDef(t));else e.push(this.addViewDef({cells:a}))}else d(a)&&e.push(this.addViewDef(a));this.cellCount=this.cells.length;this.grid.setupHeaderMenu()}})})},"dojox/grid/cells":function(){define(["../main","./cells/_base"],function(h){return h.grid.cells})},"dojox/grid/cells/_base":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/event dojo/_base/connect dojo/_base/array dojo/_base/sniff dojo/dom dojo/dom-attr dojo/dom-construct dijit/_Widget ../util".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n){var q=k("dojox.grid._DeferredTextWidget",c,{deferred:null,_destroyOnRemove:!0,postCreate:function(){this.deferred&&this.deferred.addBoth(a.hitch(this,function(a){this.domNode&&(this.domNode.innerHTML=a)}))}}),t=function(){setTimeout(a.hitch.apply(h,arguments),0)},r=k("dojox.grid.cells._Base",null,{styles:"",classes:"",editable:!1,alwaysEditing:!1,formatter:null,defaultValue:"...",value:null,hidden:!1,noresize:!1,draggable:!0,_valueProp:"value",_formatPending:!1,constructor:function(b){this._props=
b||{};a.mixin(this,b);void 0===this.draggable&&(this.draggable=!0)},_defaultFormat:function(a,b){var c=this.grid.formatterScope||this,e=this.formatter;e&&c&&"string"==typeof e&&(e=this.formatter=c[e]);c=a!=this.defaultValue&&e?e.apply(c,b):a;if("undefined"==typeof c)return this.defaultValue;c&&c.addBoth&&(c=new q({deferred:c},d.create("span",{innerHTML:this.defaultValue})));return c&&c.declaredClass&&c.startup?"\x3cdiv class\x3d'dojoxGridStubNode' linkWidget\x3d'"+c.id+"' cellIdx\x3d'"+this.index+
"'\x3e"+this.defaultValue+"\x3c/div\x3e":c},format:function(a,b){var c=this.grid.edit.info,d=this.get?this.get(a,b):this.value||this.defaultValue,d=d&&d.replace&&this.grid.escapeHTMLInData?d.replace(/&(?![a-z0-9]{1,8}\;)/ig,"\x26amp;").replace(/</g,"\x26lt;"):d;return this.editable&&(this.alwaysEditing||c.rowIndex==a&&c.cell==this)?this.formatEditing(c.value?c.value:d,a):this._defaultFormat(d,[d,a,this])},formatEditing:function(a,b){},getNode:function(a){return this.view.getCellNode(a,this.index)},
getHeaderNode:function(){return this.view.getHeaderCellNode(this.index)},getEditNode:function(a){return(this.getNode(a)||0).firstChild||0},canResize:function(){var a=this.unitWidth;return a&&"auto"!==a},isFlex:function(){var b=this.unitWidth;return b&&a.isString(b)&&("auto"==b||"%"==b.slice(-1))},applyEdit:function(a,b){this.getNode(b)&&this.grid.edit.applyCellEdit(a,this,b)},cancelEdit:function(a){this.grid.doCancelEdit(a)},_onEditBlur:function(a){this.grid.edit.isEditCell(a,this.index)&&this.grid.edit.apply()},
registerOnBlur:function(c,d){this.commitOnBlur&&b.connect(c,"onblur",function(b){setTimeout(a.hitch(this,"_onEditBlur",d),250)})},needFormatNode:function(a,b){this._formatPending=!0;t(this,"_formatNode",a,b)},cancelFormatNode:function(){this._formatPending=!1},_formatNode:function(a,b){this._formatPending&&(this._formatPending=!1,l("ie")||m.setSelectable(this.grid.domNode,!0),this.formatNode(this.getEditNode(b),a,b))},formatNode:function(a,b,c){l("ie")?t(this,"focus",c,a):this.focus(c,a)},dispatchEvent:function(a,
b){if(a in this)return this[a](b)},getValue:function(a){return this.getEditNode(a)[this._valueProp]},setValue:function(a,b){var c=this.getEditNode(a);c&&(c[this._valueProp]=b)},focus:function(a,b){var c=b||this.getEditNode(a);try{n.fire(c,"focus"),n.fire(c,"select")}catch(A){}},save:function(a){this.value=this.value||this.getValue(a)},restore:function(a){this.setValue(a,this.value)},_finish:function(a){m.setSelectable(this.grid.domNode,!1);this.cancelFormatNode()},apply:function(a){this.applyEdit(this.getValue(a),
a);this._finish(a)},cancel:function(a){this.cancelEdit(a);this._finish(a)}});r.markupFactory=function(b,c){var d=a.trim(g.get(b,"formatter")||"");d&&(c.formatter=a.getObject(d)||d);if(d=a.trim(g.get(b,"get")||""))c.get=a.getObject(d);d=function(c,d,e){var f=a.trim(g.get(b,c)||"");f&&(d[e||c]="false"!=f.toLowerCase())};d("sortDesc",c);d("editable",c);d("alwaysEditing",c);d("noresize",c);d("draggable",c);if(d=a.trim(g.get(b,"loadingText")||g.get(b,"defaultValue")||""))c.defaultValue=d;d=function(c,
d,e){var f=a.trim(g.get(b,c)||"")||void 0;f&&(d[e||c]=f)};d("styles",c);d("headerStyles",c);d("cellStyles",c);d("classes",c);d("headerClasses",c);d("cellClasses",c)};var v=r.Cell=k("dojox.grid.cells.Cell",r,{constructor:function(){this.keyFilter=this.keyFilter},keyFilter:null,formatEditing:function(a,b){this.needFormatNode(a,b);return'\x3cinput class\x3d"dojoxGridInput" type\x3d"text" value\x3d"'+a+'"\x3e'},formatNode:function(a,b,c){this.inherited(arguments);this.registerOnBlur(a,c)},doKey:function(a){this.keyFilter&&
-1==String.fromCharCode(a.charCode).search(this.keyFilter)&&f.stop(a)},_finish:function(a){this.inherited(arguments);var b=this.getEditNode(a);try{n.fire(b,"blur")}catch(y){}}});v.markupFactory=function(b,c){r.markupFactory(b,c);var d=a.trim(g.get(b,"keyFilter")||"");d&&(c.keyFilter=new RegExp(d))};(r.RowIndex=k("dojox.grid.cells.RowIndex",v,{name:"Row",postscript:function(){this.editable=!1},get:function(a){return a+1}})).markupFactory=function(a,b){v.markupFactory(a,b)};(r.Select=k("dojox.grid.cells.Select",
v,{options:null,values:null,returnIndex:-1,constructor:function(a){this.values=this.values||this.options},formatEditing:function(a,b){this.needFormatNode(a,b);for(var c=['\x3cselect class\x3d"dojoxGridSelect"\x3e'],d=0,e,f;void 0!==(e=this.options[d])&&void 0!==(f=this.values[d]);d++)f=f.replace?f.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):f,e=e.replace?e.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):e,c.push("\x3coption",a==f?" selected":"",' value\x3d"'+f+'"',"\x3e",e,"\x3c/option\x3e");
c.push("\x3c/select\x3e");return c.join("")},_defaultFormat:function(a,b){var c=this.inherited(arguments);if(!this.formatter&&this.values&&this.options){var d=e.indexOf(this.values,c);0<=d&&(c=this.options[d])}return c},getValue:function(a){var b=this.getEditNode(a);if(b)return a=b.selectedIndex,b=b.options[a],-1<this.returnIndex?a:b.value||b.innerHTML}})).markupFactory=function(b,c){v.markupFactory(b,c);var d=a.trim(g.get(b,"options")||"");if(d){var e=d.split(",");e[0]!=d&&(c.options=e)}if(d=a.trim(g.get(b,
"values")||""))e=d.split(","),e[0]!=d&&(c.values=e)};var u=r.AlwaysEdit=k("dojox.grid.cells.AlwaysEdit",v,{alwaysEditing:!0,_formatNode:function(a,b){this.formatNode(this.getEditNode(b),a,b)},applyStaticValue:function(a){var b=this.grid.edit;b.applyCellEdit(this.getValue(a),this,a);b.start(this,a,!0)}});u.markupFactory=function(a,b){v.markupFactory(a,b)};(r.Bool=k("dojox.grid.cells.Bool",u,{_valueProp:"checked",formatEditing:function(a,b){return'\x3cinput class\x3d"dojoxGridInput" type\x3d"checkbox"'+
(a?' checked\x3d"checked"':"")+' style\x3d"width: auto" /\x3e'},doclick:function(a){"INPUT"==a.target.tagName&&this.applyStaticValue(a.rowIndex)}})).markupFactory=function(a,b){u.markupFactory(a,b)};return r})},"dojox/grid/_RowSelector":function(){define(["dojo/_base/declare","./_View"],function(h,k){return h("dojox.grid._RowSelector",k,{defaultWidth:"2em",noscroll:!0,padBorderWidth:2,buildRendering:function(){this.inherited("buildRendering",arguments);this.scrollboxNode.style.overflow="hidden";this.headerNode.style.visibility=
"hidden"},getWidth:function(){return this.viewWidth||this.defaultWidth},buildRowContent:function(a,f){f.innerHTML='\x3ctable class\x3d"dojoxGridRowbarTable" style\x3d"width:'+(this.contentWidth||0)+'px;height:1px;" border\x3d"0" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"\x3e\x3ctr\x3e\x3ctd class\x3d"dojoxGridRowbarInner"\x3e\x26nbsp;\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e'},renderHeader:function(){},updateRow:function(){},resize:function(){this.adaptHeight()},adaptWidth:function(){!("contentWidth"in
this)&&this.contentNode&&0<this.contentNode.offsetWidth&&(this.contentWidth=this.contentNode.offsetWidth-this.padBorderWidth)},doStyleRowNode:function(a,f){var b=["dojoxGridRowbar dojoxGridNonNormalizedCell"];this.grid.rows.isOver(a)&&b.push("dojoxGridRowbarOver");this.grid.selection.isSelected(a)&&b.push("dojoxGridRowbarSelected");f.className=b.join(" ")},domouseover:function(a){this.grid.onMouseOverRow(a)},domouseout:function(a){if(!this.isIntraRowEvent(a))this.grid.onMouseOutRow(a)}})})},"dojox/grid/_View":function(){define("dojo dijit/registry ../main dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/connect dojo/_base/sniff dojo/query dojo/_base/window dojo/text!./resources/View.html dojo/dnd/Source dijit/_Widget dijit/_TemplatedMixin dojox/html/metrics ./util dojo/_base/html ./_Builder dojo/dnd/Avatar dojo/dnd/Manager".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y){c=f("dojox.grid._View",[q,t],{defaultWidth:"18em",viewWidth:"",templateString:c,classTag:"dojoxGrid",marginBottom:0,rowPad:2,_togglingColumn:-1,_headerBuilderClass:w._HeaderBuilder,_contentBuilderClass:w._ContentBuilder,postMixInProperties:function(){this.rowNodes={}},postCreate:function(){this.connect(this.scrollboxNode,"onscroll","doscroll");v.funnelEvents(this.contentNode,this,"doContentEvent","mouseover mouseout click dblclick contextmenu mousedown".split(" "));
v.funnelEvents(this.headerNode,this,"doHeaderEvent","dblclick mouseover mouseout mousemove mousedown click contextmenu".split(" "));this.content=new this._contentBuilderClass(this);this.header=new this._headerBuilderClass(this);this.grid.isLeftToRight()||(this.headerNodeContainer.style.width="")},destroy:function(){u.destroy(this.headerNode);delete this.headerNode;for(var a in this.rowNodes)this._cleanupRowWidgets(this.rowNodes[a]),u.destroy(this.rowNodes[a]);this.rowNodes={};this.source&&this.source.destroy();
this.inherited(arguments)},focus:function(){m("ie")||m("webkit")||m("opera")?this.hiddenFocusNode.focus():this.scrollboxNode.focus()},setStructure:function(a){a=this.structure=a;a.width&&!isNaN(a.width)?this.viewWidth=a.width+"em":this.viewWidth=a.width||(a.noscroll?"auto":this.viewWidth);this._onBeforeRow=a.onBeforeRow||function(){};this._onAfterRow=a.onAfterRow||function(){};if(this.noscroll=a.noscroll)this.scrollboxNode.style.overflow="hidden";this.simpleStructure=1==a.cells.length;this.testFlexCells();
this.updateStructure()},_cleanupRowWidgets:function(a){a&&b.forEach(g("[widgetId]",a).map(k.byNode),function(a){a._destroyOnRemove?(a.destroy(),delete a):a.domNode&&a.domNode.parentNode&&a.domNode.parentNode.removeChild(a.domNode)})},onBeforeRow:function(a,b){this._onBeforeRow(a,b);0<=a&&this._cleanupRowWidgets(this.getRowNode(a))},onAfterRow:function(a,c,d){this._onAfterRow(a,c,d);var e=this.grid;b.forEach(g(".dojoxGridStubNode",d),function(a){if(a&&a.parentNode){var b=a.getAttribute("linkWidget"),
c=window.parseInt(u.attr(a,"cellIdx"),10);e.getCell(c);(b=k.byId(b))?(a.parentNode.replaceChild(b.domNode,a),b._started||b.startup(),h.destroy(a)):a.innerHTML=""}},this)},testFlexCells:function(){this.flexCells=!1;for(var a=0,b;b=this.structure.cells[a];a++)for(var c=0,d;d=b[c];c++)d.view=this,this.flexCells=this.flexCells||d.isFlex();return this.flexCells},updateStructure:function(){this.header.update();this.content.update()},getScrollbarWidth:function(){var a=this.hasVScrollbar(),b=u.style(this.scrollboxNode,
"overflow");this.noscroll||!b||"hidden"==b?a=!1:"scroll"==b&&(a=!0);return a?r.getScrollbar().w:0},getColumnsWidth:function(){var a=this.headerContentNode;return a&&a.firstChild?a.firstChild.offsetWidth||u.style(a.firstChild,"width"):0},setColumnsWidth:function(a){this.headerContentNode.firstChild.style.width=a+"px";this.viewWidth&&(this.viewWidth=a+"px")},getWidth:function(){return this.viewWidth||this.getColumnsWidth()+this.getScrollbarWidth()+"px"},getContentWidth:function(){return Math.max(0,
u._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px"},render:function(){this.scrollboxNode.style.height="";this.renderHeader();0<=this._togglingColumn&&(this.setColumnsWidth(this.getColumnsWidth()-this._togglingColumn),this._togglingColumn=-1);var a=this.grid.layout.cells,b=e.hitch(this,function(b,c){!this.grid.isLeftToRight()&&(c=!c);for(var d=c?-1:1,e=this.header.getCellNodeIndex(b)+d,f=a[e];f&&f.getHeaderNode()&&"none"==f.getHeaderNode().style.display;)e+=d,f=a[e];return f?f.getHeaderNode():
null});if(this.grid.columnReordering&&this.simpleStructure){this.source&&this.source.destroy();this.bottomMarker&&u.destroy(this.bottomMarker);this.bottomMarker=u.byId("dojoxGrid_bottomMarker");this.topMarker&&u.destroy(this.topMarker);this.topMarker=u.byId("dojoxGrid_topMarker");this.bottomMarker||(this.bottomMarker=u.create("div",{id:"dojoxGrid_bottomMarker","class":"dojoxGridColPlaceBottom"},d.body()),this._hide(this.bottomMarker),this.topMarker=u.create("div",{id:"dojoxGrid_topMarker","class":"dojoxGridColPlaceTop"},
d.body()),this._hide(this.topMarker));this.arrowDim=u.contentBox(this.bottomMarker);var c=u.contentBox(this.headerContentNode.firstChild.rows[0]).h;this.source=new n(this.headerContentNode.firstChild.rows[0],{horizontal:!0,accept:["gridColumn_"+this.grid.id],viewIndex:this.index,generateText:!1,onMouseDown:e.hitch(this,function(a){this.header.decorateEvent(a);if((this.header.overRightResizeArea(a)||this.header.overLeftResizeArea(a))&&this.header.canResize(a)&&!this.header.moveable)this.header.beginColumnResize(a);
else{if(this.grid.headerMenu)this.grid.headerMenu.onCancel(!0);a.button===(9>m("ie")?1:0)&&n.prototype.onMouseDown.call(this.source,a)}}),onMouseOver:e.hitch(this,function(a){var b=this.source;b._getChildByEvent(a)&&n.prototype.onMouseOver.apply(b,arguments)}),_markTargetAnchor:e.hitch(this,function(a){var d=this.source;if(d.current!=d.targetAnchor||d.before!=a){d.targetAnchor&&b(d.targetAnchor,d.before)&&d._removeItemClass(b(d.targetAnchor,d.before),d.before?"After":"Before");n.prototype._markTargetAnchor.call(d,
a);var e=a?d.targetAnchor:b(d.targetAnchor,d.before);a=0;e||(e=d.targetAnchor,a=u.contentBox(e).w+this.arrowDim.w/2+2);e=u.position(e,!0);a=Math.floor(e.x-this.arrowDim.w/2+a);u.style(this.bottomMarker,"visibility","visible");u.style(this.topMarker,"visibility","visible");u.style(this.bottomMarker,{left:a+"px",top:c+e.y+"px"});u.style(this.topMarker,{left:a+"px",top:e.y-this.arrowDim.h+"px"});d.targetAnchor&&b(d.targetAnchor,d.before)&&d._addItemClass(b(d.targetAnchor,d.before),d.before?"After":"Before")}}),
_unmarkTargetAnchor:e.hitch(this,function(){var a=this.source;a.targetAnchor&&(a.targetAnchor&&b(a.targetAnchor,a.before)&&a._removeItemClass(b(a.targetAnchor,a.before),a.before?"After":"Before"),this._hide(this.bottomMarker),this._hide(this.topMarker),n.prototype._unmarkTargetAnchor.call(a))}),destroy:e.hitch(this,function(){l.disconnect(this._source_conn);l.unsubscribe(this._source_sub);n.prototype.destroy.call(this.source);this.bottomMarker&&(u.destroy(this.bottomMarker),delete this.bottomMarker);
this.topMarker&&(u.destroy(this.topMarker),delete this.topMarker)}),onDndCancel:e.hitch(this,function(){n.prototype.onDndCancel.call(this.source);this._hide(this.bottomMarker);this._hide(this.topMarker)})});this._source_conn=l.connect(this.source,"onDndDrop",this,"_onDndDrop");this._source_sub=l.subscribe("/dnd/drop/before",this,"_onDndDropBefore");this.source.startup()}},_hide:function(a){u.style(a,{top:"-10000px",visibility:"hidden"})},_onDndDropBefore:function(a,b,c){y.manager().target===this.source&&
(this.source._targetNode=this.source.targetAnchor,this.source._beforeTarget=this.source.before,b=this.grid.views.views,a=b[a.viewIndex],b=b[this.index],b!=a&&(a.convertColPctToFixed(),b.convertColPctToFixed()))},_onDndDrop:function(a,b,c){if(y.manager().target!==this.source)y.manager().source===this.source&&(this._removingColumn=!0);else{this._hide(this.bottomMarker);this._hide(this.topMarker);c=function(a){return a?u.attr(a,"idx"):null};var d=u.marginBox(b[0]).w;if(a.viewIndex!==this.index){var e=
this.grid.views.views,f=e[a.viewIndex],e=e[this.index];f.viewWidth&&"auto"!=f.viewWidth&&f.setColumnsWidth(f.getColumnsWidth()-d);e.viewWidth&&"auto"!=e.viewWidth&&e.setColumnsWidth(e.getColumnsWidth())}d=this.source._targetNode;f=this.source._beforeTarget;!this.grid.isLeftToRight()&&(f=!f);var e=this.grid.layout,g=this.index;delete this.source._targetNode;delete this.source._beforeTarget;e.moveColumn(a.viewIndex,g,c(b[0]),c(d),f)}},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent);
this.flexCells&&(this.contentWidth=this.getContentWidth(),this.headerContentNode.firstChild.style.width=this.contentWidth);v.fire(this,"onAfterRow",[-1,this.structure.cells,this.headerContentNode])},_getHeaderContent:function(a){var b=a.name||a.grid.getCellName(a);/^\s+$/.test(b)&&(b="\x26nbsp;");var c=['\x3cdiv class\x3d"dojoxGridSortNode'];a.index!=a.grid.getSortIndex()?c.push('"\x3e'):c=c.concat([" ",0<a.grid.sortInfo?"dojoxGridSortUp":"dojoxGridSortDown",'"\x3e\x3cdiv class\x3d"dojoxGridArrowButtonChar"\x3e',
0<a.grid.sortInfo?"\x26#9650;":"\x26#9660;",'\x3c/div\x3e\x3cdiv class\x3d"dojoxGridArrowButtonNode" role\x3d"presentation"\x3e\x3c/div\x3e','\x3cdiv class\x3d"dojoxGridColCaption"\x3e']);c=c.concat([b,"\x3c/div\x3e\x3c/div\x3e"]);return c.join("")},resize:function(){this.adaptHeight();this.adaptWidth()},hasHScrollbar:function(a){var b=this._hasHScroll||!1;if(void 0==this._hasHScroll||a)this.noscroll?this._hasHScroll=!1:(a=u.style(this.scrollboxNode,"overflow"),this._hasHScroll="hidden"==a?!1:"scroll"==
a?!0:this.scrollboxNode.offsetWidth-this.getScrollbarWidth()<this.contentNode.offsetWidth);b!==this._hasHScroll&&this.grid.update();return this._hasHScroll},hasVScrollbar:function(a){var b=this._hasVScroll||!1;if(void 0==this._hasVScroll||a)this.noscroll?this._hasVScroll=!1:(a=u.style(this.scrollboxNode,"overflow"),this._hasVScroll="hidden"==a?!1:"scroll"==a?!0:this.scrollboxNode.scrollHeight>this.scrollboxNode.clientHeight);b!==this._hasVScroll&&this.grid.update();return this._hasVScroll},convertColPctToFixed:function(){var a=
!1;this.grid.initialWidth="";var c=g("th",this.headerContentNode),d=b.map(c,function(b,c){var d=b.style.width;u.attr(b,"vIdx",c);if(d&&"%"==d.slice(-1))a=!0;else if(d&&"px"==d.slice(-2))return window.parseInt(d,10);return u.contentBox(b).w});return a?(b.forEach(this.grid.layout.cells,function(a,b){if(a.view==this){var c=a.view.getHeaderCellNode(a.index);if(c&&u.hasAttr(c,"vIdx")){var e=window.parseInt(u.attr(c,"vIdx"));this.setColWidth(b,d[e]);u.removeAttr(c,"vIdx")}}},this),!0):!1},adaptHeight:function(a){if(!this.grid._autoHeight){var b=
this.domNode.style.height&&parseInt(this.domNode.style.height.replace(/px/,""),10)||this.domNode.clientHeight;if(!a&&(a=this.noscroll))a:{for(var c=0;c<this.grid.views.views.length;++c)if(a=this.grid.views.views[c],a!==this&&a.hasHScrollbar()){a=!0;break a}a=!1}a&&(b-=r.getScrollbar().h);v.setStyleHeightPx(this.scrollboxNode,b)}this.hasVScrollbar(!0)},adaptWidth:function(){this.flexCells&&(this.contentWidth=this.getContentWidth(),this.headerContentNode.firstChild.style.width=this.contentWidth);var a=
this.scrollboxNode.offsetWidth-this.getScrollbarWidth();this._removingColumn?(a=Math.min(a,this.getColumnsWidth())+"px",this._removingColumn=!1):a=Math.max(a,this.getColumnsWidth())+"px";this.contentNode.style.width=a;this.hasHScrollbar(!0)},setSize:function(a,b){var c=this.domNode.style,d=this.headerNode.style;a&&(c.width=a,d.width=a);c.height=0<=b?b+"px":""},renderRow:function(a){var b=this.createRowNode(a);this.buildRow(a,b);return b},createRowNode:function(b){var c=document.createElement("div");
c.className=this.classTag+"Row";this instanceof a.grid._RowSelector?u.attr(c,"role","presentation"):(u.attr(c,"role","row"),"none"!=this.grid.selectionMode&&c.setAttribute("aria-selected","false"));c[v.gridViewTag]=this.id;c[v.rowIndexTag]=b;return this.rowNodes[b]=c},buildRow:function(a,b){this.buildRowContent(a,b);this.styleRow(a,b)},buildRowContent:function(a,b){b.innerHTML=this.content.generateHtml(a,a);this.flexCells&&this.contentWidth&&(b.firstChild.style.width=this.contentWidth);v.fire(this,
"onAfterRow",[a,this.structure.cells,b])},rowRemoved:function(a){0<=a&&this._cleanupRowWidgets(this.getRowNode(a));this.grid.edit.save(this,a);delete this.rowNodes[a]},getRowNode:function(a){return this.rowNodes[a]},getCellNode:function(a,b){var c=this.getRowNode(a);if(c)return this.content.getCellNode(c,b)},getHeaderCellNode:function(a){if(this.headerContentNode)return this.header.getCellNode(this.headerContentNode,a)},styleRow:function(a,b){var c;c=void 0==b.style.cssText?b.getAttribute("style"):
b.style.cssText;b._style=c;this.styleRowNode(a,b)},styleRowNode:function(a,b){b&&this.doStyleRowNode(a,b)},doStyleRowNode:function(a,b){this.grid.styleRowNode(a,b)},updateRow:function(a){var b=this.getRowNode(a);b&&(b.style.height="",this.buildRow(a,b));return b},updateRowStyles:function(a){this.styleRowNode(a,this.getRowNode(a))},lastTop:0,firstScroll:0,_nativeScroll:!1,doscroll:function(a){if(13<=m("ff")||m("chrome"))this._nativeScroll=!0;a=this.grid.isLeftToRight();if(2>this.firstScroll){if(!a&&
1==this.firstScroll||a&&0===this.firstScroll){var b=u.marginBox(this.headerNodeContainer);m("ie")?this.headerNodeContainer.style.width=b.w+this.getScrollbarWidth()+"px":m("mozilla")&&(this.headerNodeContainer.style.width=b.w-this.getScrollbarWidth()+"px",this.scrollboxNode.scrollLeft=a?this.scrollboxNode.clientWidth-this.scrollboxNode.scrollWidth:this.scrollboxNode.scrollWidth-this.scrollboxNode.clientWidth)}this.firstScroll++}this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;a=this.scrollboxNode.scrollTop;
a!==this.lastTop&&this.grid.scrollTo(a);this._nativeScroll=!1},setScrollTop:function(a){this.lastTop=a;this._nativeScroll||(this.scrollboxNode.scrollTop=a);return this.scrollboxNode.scrollTop},doContentEvent:function(a){if(this.content.decorateEvent(a))this.grid.onContentEvent(a)},doHeaderEvent:function(a){if(this.header.decorateEvent(a))this.grid.onHeaderEvent(a)},dispatchContentEvent:function(a){return this.content.dispatchEvent(a)},dispatchHeaderEvent:function(a){return this.header.dispatchEvent(a)},
setColWidth:function(a,b){this.grid.setCellWidth(a,b+"px")},update:function(){if(this.domNode){this.content.update();this.grid.update();var a=this.scrollboxNode.scrollLeft;this.scrollboxNode.scrollLeft=a;this.headerNode.scrollLeft=a}}});var A=f("dojox.grid._GridAvatar",x,{construct:function(){var a=d.doc,b=a.createElement("table");b.cellPadding=b.cellSpacing="0";b.className="dojoxGridDndAvatar";b.style.position="absolute";b.style.zIndex=1999;b.style.margin="0px";var c=a.createElement("tbody"),e=a.createElement("tr"),
f=a.createElement("td"),g=a.createElement("td");e.className="dojoxGridDndAvatarItem";g.className="dojoxGridDndAvatarItemImage";g.style.width="16px";var l=this.manager.source;if(l.creator)l=l._normalizedCreator(l.getItem(this.manager.nodes[0].id).data,"avatar").node;else{var l=this.manager.nodes[0].cloneNode(!0),h,m;"tr"==l.tagName.toLowerCase()?(h=a.createElement("table"),m=a.createElement("tbody"),m.appendChild(l),h.appendChild(m),l=h):"th"==l.tagName.toLowerCase()&&(h=a.createElement("table"),m=
a.createElement("tbody"),a=a.createElement("tr"),h.cellPadding=h.cellSpacing="0",a.appendChild(l),m.appendChild(a),h.appendChild(m),l=h)}l.id="";f.appendChild(l);e.appendChild(g);e.appendChild(f);u.style(e,"opacity",.9);c.appendChild(e);b.appendChild(c);this.node=b;b=y.manager();this.oldOffsetY=b.OFFSET_Y;b.OFFSET_Y=1},destroy:function(){y.manager().OFFSET_Y=this.oldOffsetY;this.inherited(arguments)}}),z=y.manager().makeAvatar;y.manager().makeAvatar=function(){return void 0===this.source.viewIndex||
u.hasClass(d.body(),"dijit_a11y")?z.call(y.manager()):new A(this)};return c})},"dojo/main":function(){define("./_base/kernel ./has require ./sniff ./_base/lang ./_base/array ./_base/config ./ready ./_base/declare ./_base/connect ./_base/Deferred ./_base/json ./_base/Color require ./_base/browser require".split(" "),function(h,k,a,f,b,e,l,m){l.isDebug&&a(["./_firebug/firebug"]);return h})},"dojo/_base/browser":function(){require.has&&require.has.add("config-selectorEngine","acme");define("../ready ./kernel ./connect ./unload ./window ./event ./html ./NodeList ../query ./xhr ./fx".split(" "),
function(h){return h})},"dojo/_base/NodeList":function(){define(["./kernel","../query","./array","./html","../NodeList-dom"],function(h,k,a){k=k.NodeList;var f=k.prototype;f.connect=k._adaptAsForEach(function(){return h.connect.apply(this,arguments)});f.coords=k._adaptAsMap(h.coords);k.events="blur focus change click error keydown keypress keyup load mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup submit".split(" ");a.forEach(k.events,function(a){var b="on"+a;f[b]=function(a,
e){return this.connect(b,a,e)}});return h.NodeList=k})},"dojo/dnd/Source":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom-class ../dom-geometry ../mouse ../ready ../topic ./common ./Selector ./Manager".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n){a.isAsync||m(0,function(){require(["dojo/dnd/AutoSource","dojo/dnd/Target"])});var q=k("dojo.dnd.Source",c,{isSource:!0,horizontal:!1,copyOnly:!1,selfCopy:!1,selfAccept:!0,skipForm:!1,withHandles:!1,autoSync:!1,delay:0,
accept:["text"],generateText:!0,constructor:function(a,c){f.mixin(this,f.mixin({},c));var d=this.accept;if(d.length){this.accept={};for(var e=0;e<d.length;++e)this.accept[d[e]]=1}this.mouseDown=this.isDragging=!1;this.targetBox=this.targetAnchor=null;this.before=!0;this._lastY=this._lastX=0;this.sourceState="";this.isSource&&b.add(this.node,"dojoDndSource");this.targetState="";this.accept&&b.add(this.node,"dojoDndTarget");this.horizontal&&b.add(this.node,"dojoDndHorizontal");this.topics=[g.subscribe("/dnd/source/over",
f.hitch(this,"onDndSourceOver")),g.subscribe("/dnd/start",f.hitch(this,"onDndStart")),g.subscribe("/dnd/drop",f.hitch(this,"onDndDrop")),g.subscribe("/dnd/cancel",f.hitch(this,"onDndCancel"))]},checkAcceptance:function(a,b){if(this==a)return!this.copyOnly||this.selfAccept;for(var c=0;c<b.length;++c){for(var d=a.getItem(b[c].id).type,e=!1,f=0;f<d.length;++f)if(d[f]in this.accept){e=!0;break}if(!e)return!1}return!0},copyState:function(a,b){if(a)return!0;2>arguments.length&&(b=this==n.manager().target);
if(b){if(this.copyOnly)return this.selfCopy}else return this.copyOnly;return!1},destroy:function(){q.superclass.destroy.call(this);h.forEach(this.topics,function(a){a.remove()});this.targetAnchor=null},onMouseMove:function(a){if(!this.isDragging||"Disabled"!=this.targetState){q.superclass.onMouseMove.call(this,a);var b=n.manager();if(!this.isDragging&&this.mouseDown&&this.isSource&&(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)){var c=this.getSelectedNodes();
c.length&&b.startDrag(this,c,this.copyState(d.getCopyKeyState(a),!0))}this.isDragging&&(c=!1,this.current&&(this.targetBox&&this.targetAnchor==this.current||(this.targetBox=e.position(this.current,!0)),c=this.horizontal?a.pageX-this.targetBox.x<this.targetBox.w/2==e.isBodyLtr(this.current.ownerDocument):a.pageY-this.targetBox.y<this.targetBox.h/2),this.current!=this.targetAnchor||c!=this.before)&&(this._markTargetAnchor(c),b.canDrop(!this.current||b.source!=this||!(this.current.id in this.selection)))}},
onMouseDown:function(a){this.mouseDown||!this._legalMouseDown(a)||this.skipForm&&d.isFormElement(a)||(this.mouseDown=!0,this._lastX=a.pageX,this._lastY=a.pageY,q.superclass.onMouseDown.call(this,a))},onMouseUp:function(a){this.mouseDown&&(this.mouseDown=!1,q.superclass.onMouseUp.call(this,a))},onDndSourceOver:function(a){this!==a?(this.mouseDown=!1,this.targetAnchor&&this._unmarkTargetAnchor()):this.isDragging&&(a=n.manager(),a.canDrop("Disabled"!=this.targetState&&(!this.current||a.source!=this||
!(this.current.id in this.selection))))},onDndStart:function(a,b,c){this.autoSync&&this.sync();this.isSource&&this._changeState("Source",this==a?c?"Copied":"Moved":"");b=this.accept&&this.checkAcceptance(a,b);this._changeState("Target",b?"":"Disabled");this==a&&n.manager().overSource(this);this.isDragging=!0},onDndDrop:function(a,b,c,d){if(this==d)this.onDrop(a,b,c);this.onDndCancel()},onDndCancel:function(){this.targetAnchor&&(this._unmarkTargetAnchor(),this.targetAnchor=null);this.before=!0;this.mouseDown=
this.isDragging=!1;this._changeState("Source","");this._changeState("Target","")},onDrop:function(a,b,c){if(this!=a)this.onDropExternal(a,b,c);else this.onDropInternal(b,c)},onDropExternal:function(a,b,c){var e=this._normalizedCreator;this._normalizedCreator=this.creator?function(b,c){return e.call(this,a.getItem(b.id).data,c)}:c?function(b){var c=a.getItem(b.id);b=b.cloneNode(!0);b.id=d.getUniqueId();return{node:b,data:c.data,type:c.type}}:function(b){var c=a.getItem(b.id);a.delItem(b.id);return{node:b,
data:c.data,type:c.type}};this.selectNone();c||this.creator||a.selectNone();this.insertNodes(!0,b,this.before,this.current);!c&&this.creator&&a.deleteSelectedNodes();this._normalizedCreator=e},onDropInternal:function(a,b){var c=this._normalizedCreator;if(!(this.current&&this.current.id in this.selection)){if(b)this._normalizedCreator=this.creator?function(a,b){return c.call(this,this.getItem(a.id).data,b)}:function(a){var b=this.getItem(a.id);a=a.cloneNode(!0);a.id=d.getUniqueId();return{node:a,data:b.data,
type:b.type}};else{if(!this.current)return;this._normalizedCreator=function(a){var b=this.getItem(a.id);return{node:a,data:b.data,type:b.type}}}this._removeSelection();this.insertNodes(!0,a,this.before,this.current);this._normalizedCreator=c}},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){q.superclass.onOverEvent.call(this);n.manager().overSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOver()},onOutEvent:function(){q.superclass.onOutEvent.call(this);
n.manager().outSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOut()},_markTargetAnchor:function(a){if(this.current!=this.targetAnchor||this.before!=a)this.targetAnchor&&this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetAnchor=this.current,this.targetBox=null,this.before=a,this.targetAnchor&&this._addItemClass(this.targetAnchor,this.before?"Before":"After")},_unmarkTargetAnchor:function(){this.targetAnchor&&(this._removeItemClass(this.targetAnchor,
this.before?"Before":"After"),this.targetBox=this.targetAnchor=null,this.before=!0)},_markDndStatus:function(a){this._changeState("Source",a?"Copied":"Moved")},_legalMouseDown:function(a){if("touchstart"!=a.type&&!l.isLeft(a))return!1;if(!this.withHandles)return!0;for(a=a.target;a&&a!==this.node;a=a.parentNode){if(b.contains(a,"dojoDndHandle"))return!0;if(b.contains(a,"dojoDndItem")||b.contains(a,"dojoDndIgnore"))break}return!1}});return q})},"dojo/dnd/Selector":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom ../dom-construct ../mouse ../_base/NodeList ../on ../touch ./common ./Container".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n){var q=k("dojo.dnd.Selector",n,{constructor:function(a,b){b||(b={});this.singular=b.singular;this.autoSync=b.autoSync;this.selection={};this.anchor=null;this.simpleSelection=!1;this.events.push(g(this.node,d.press,f.hitch(this,"onMouseDown")),g(this.node,d.release,f.hitch(this,"onMouseUp")))},singular:!1,getSelectedNodes:function(){var a=new m,d=c._empty,e;for(e in this.selection)e in d||a.push(b.byId(e));return a},selectNone:function(){return this._removeSelection()._removeAnchor()},
selectAll:function(){this.forInItems(function(a,c){this._addItemClass(b.byId(c),"Selected");this.selection[c]=1},this);return this._removeAnchor()},deleteSelectedNodes:function(){var a=c._empty,d;for(d in this.selection)if(!(d in a)){var f=b.byId(d);this.delItem(d);e.destroy(f)}this.anchor=null;this.selection={};return this},forInSelectedItems:function(b,d){d=d||a.global;var e=this.selection,f=c._empty,g;for(g in e)g in f||b.call(d,this.getItem(g),g,this)},sync:function(){q.superclass.sync.call(this);
this.anchor&&!this.getItem(this.anchor.id)&&(this.anchor=null);var a=[],b=c._empty,d;for(d in this.selection)d in b||this.getItem(d)||a.push(d);h.forEach(a,function(a){delete this.selection[a]},this);return this},insertNodes:function(a,b,c,d){var e=this._normalizedCreator;this._normalizedCreator=function(b,c){var d=e.call(this,b,c);a?(this.anchor?this.anchor!=d.node&&(this._removeItemClass(d.node,"Anchor"),this._addItemClass(d.node,"Selected")):(this.anchor=d.node,this._removeItemClass(d.node,"Selected"),
this._addItemClass(this.anchor,"Anchor")),this.selection[d.node.id]=1):(this._removeItemClass(d.node,"Selected"),this._removeItemClass(d.node,"Anchor"));return d};q.superclass.insertNodes.call(this,b,c,d);this._normalizedCreator=e;return this},destroy:function(){q.superclass.destroy.call(this);this.selection=this.anchor=null},onMouseDown:function(a){this.autoSync&&this.sync();if(this.current)if(!this.singular&&!c.getCopyKeyState(a)&&!a.shiftKey&&this.current.id in this.selection)this.simpleSelection=
!0,l.isLeft(a)&&(a.stopPropagation(),a.preventDefault());else{if(!this.singular&&a.shiftKey){c.getCopyKeyState(a)||this._removeSelection();var b=this.getAllNodes();if(b.length&&(this.anchor||(this.anchor=b[0],this._addItemClass(this.anchor,"Anchor")),this.selection[this.anchor.id]=1,this.anchor!=this.current)){for(var d=0,e;d<b.length&&(e=b[d],e!=this.anchor&&e!=this.current);++d);for(++d;d<b.length;++d){e=b[d];if(e==this.anchor||e==this.current)break;this._addItemClass(e,"Selected");this.selection[e.id]=
1}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1}}else this.singular?this.anchor==this.current?c.getCopyKeyState(a)&&this.selectNone():(this.selectNone(),this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1):c.getCopyKeyState(a)?this.anchor==this.current?(delete this.selection[this.anchor.id],this._removeAnchor()):this.current.id in this.selection?(this._removeItemClass(this.current,"Selected"),delete this.selection[this.current.id]):
(this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this._addItemClass(this.anchor,"Selected")),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1):this.current.id in this.selection||(this.selectNone(),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1);a.stopPropagation();a.preventDefault()}},onMouseUp:function(){this.simpleSelection&&(this.simpleSelection=!1,this.selectNone(),this.current&&
(this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1))},onMouseMove:function(){this.simpleSelection=!1},onOverEvent:function(){this.onmousemoveEvent=g(this.node,d.move,f.hitch(this,"onMouseMove"))},onOutEvent:function(){this.onmousemoveEvent&&(this.onmousemoveEvent.remove(),delete this.onmousemoveEvent)},_removeSelection:function(){var a=c._empty,d;for(d in this.selection)if(!(d in a)){var e=b.byId(d);e&&this._removeItemClass(e,"Selected")}this.selection=
{};return this},_removeAnchor:function(){this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this.anchor=null);return this}});return q})},"dojo/dnd/Container":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../_base/window ../dom ../dom-class ../dom-construct ../Evented ../has ../on ../query ../touch ./common".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t){k=k("dojo.dnd.Container",g,{skipForm:!1,allowNested:!1,constructor:function(a,b){this.node=e.byId(a);
b||(b={});this.creator=b.creator||null;this.skipForm=b.skipForm;this.parent=b.dropParent&&e.byId(b.dropParent);this.map={};this.current=null;this.containerState="";l.add(this.node,"dojoDndContainer");b&&b._skipStartup||this.startup();this.events=[c(this.node,q.over,f.hitch(this,"onMouseOver")),c(this.node,q.out,f.hitch(this,"onMouseOut")),c(this.node,"dragstart",f.hitch(this,"onSelectStart")),c(this.node,"selectstart",f.hitch(this,"onSelectStart"))]},creator:function(){},getItem:function(a){return this.map[a]},
setItem:function(a,b){this.map[a]=b},delItem:function(a){delete this.map[a]},forInItems:function(b,c){c=c||a.global;var d=this.map,e=t._empty,f;for(f in d)f in e||b.call(c,d[f],f,this);return c},clearItems:function(){this.map={}},getAllNodes:function(){return n((this.allowNested?"":"\x3e ")+".dojoDndItem",this.parent)},sync:function(){var a={};this.getAllNodes().forEach(function(b){if(b.id){var c=this.getItem(b.id);if(c){a[b.id]=c;return}}else b.id=t.getUniqueId();var c=b.getAttribute("dndType"),
d=b.getAttribute("dndData");a[b.id]={data:d||b.innerHTML,type:c?c.split(/\s*,\s*/):["text"]}},this);this.map=a;return this},insertNodes:function(a,b,c){this.parent.firstChild?b?c||(c=this.parent.firstChild):c&&(c=c.nextSibling):c=null;var d;if(c)for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),c.parentNode.insertBefore(d.node,c);else for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),this.parent.appendChild(d.node);
return this},destroy:function(){h.forEach(this.events,function(a){a.remove()});this.clearItems();this.node=this.parent=this.current=null},markupFactory:function(a,b,c){a._skipStartup=!0;return new c(b,a)},startup:function(){if(!this.parent&&(this.parent=this.node,"table"==this.parent.tagName.toLowerCase())){var a=this.parent.getElementsByTagName("tbody");a&&a.length&&(this.parent=a[0])}this.defaultCreator=t._defaultCreator(this.parent);this.sync()},onMouseOver:function(a){for(var b=a.relatedTarget;b&&
b!=this.node;)try{b=b.parentNode}catch(u){b=null}b||(this._changeState("Container","Over"),this.onOverEvent());b=this._getChildByEvent(a);this.current!=b&&(this.current&&this._removeItemClass(this.current,"Over"),b&&this._addItemClass(b,"Over"),this.current=b)},onMouseOut:function(a){for(a=a.relatedTarget;a;){if(a==this.node)return;try{a=a.parentNode}catch(v){a=null}}this.current&&(this._removeItemClass(this.current,"Over"),this.current=null);this._changeState("Container","");this.onOutEvent()},onSelectStart:function(a){this.skipForm&&
t.isFormElement(a)||(a.stopPropagation(),a.preventDefault())},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(a,b){var c="dojoDnd"+a,d=a.toLowerCase()+"State";l.replace(this.node,c+b,c+this[d]);this[d]=b},_addItemClass:function(a,b){l.add(a,"dojoDndItem"+b)},_removeItemClass:function(a,b){l.remove(a,"dojoDndItem"+b)},_getChildByEvent:function(a){if(a=a.target)for(var b=a.parentNode;b;a=b,b=a.parentNode)if((b==this.parent||this.allowNested)&&l.contains(a,"dojoDndItem"))return a;
return null},_normalizedCreator:function(a,b){var c=(this.creator||this.defaultCreator).call(this,a,b);f.isArray(c.type)||(c.type=["text"]);c.node.id||(c.node.id=t.getUniqueId());l.add(c.node,"dojoDndItem");return c}});t._createNode=function(a){return a?function(b){return m.create(a,{innerHTML:b})}:t._createSpan};t._createTrTd=function(a){var b=m.create("tr");m.create("td",{innerHTML:a},b);return b};t._createSpan=function(a){return m.create("span",{innerHTML:a})};t._defaultCreatorNodes={ul:"li",ol:"li",
div:"div",p:"div"};t._defaultCreator=function(a){a=a.tagName.toLowerCase();var b="tbody"==a||"thead"==a?t._createTrTd:t._createNode(t._defaultCreatorNodes[a]);return function(a,c){var d=a&&f.isObject(a),e,g;d&&a.tagName&&a.nodeType&&a.getAttribute?(e=a.getAttribute("dndData")||a.innerHTML,d=(d=a.getAttribute("dndType"))?d.split(/\s*,\s*/):["text"],g=a):(e=d&&a.data?a.data:a,d=d&&a.type?a.type:["text"],g=("avatar"==c?t._createSpan:b)(String(e)));g.id||(g.id=t.getUniqueId());return{node:g,data:e,type:d}}};
return k})},"dojo/dnd/Manager":function(){define("../_base/array ../_base/declare ../_base/lang ../_base/window ../dom-class ../Evented ../has ../keys ../on ../topic ../touch ./common ./autoscroll ./Avatar".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t){var r=k("dojo.dnd.Manager",[e],{constructor:function(){this.source=this.avatar=null;this.nodes=[];this.copy=!0;this.target=null;this.canDropFlag=!1;this.events=[]},OFFSET_X:l("touch")?4:16,OFFSET_Y:l("touch")?4:16,overSource:function(a){this.avatar&&
(this.target=a&&"Disabled"!=a.targetState?a:null,this.canDropFlag=!!this.target,this.avatar.update());d.publish("/dnd/source/over",a)},outSource:function(a){this.avatar?this.target==a&&(this.target=null,this.canDropFlag=!1,this.avatar.update(),d.publish("/dnd/source/over",null)):d.publish("/dnd/source/over",null)},startDrag:function(e,l,h){function m(a){a.preventDefault();a.stopPropagation()}q.autoScrollStart(f.doc);this.source=e;this.nodes=l;this.copy=!!h;this.avatar=this.makeAvatar();f.body().appendChild(this.avatar.node);
d.publish("/dnd/start",e,l,this.copy);this.events=[g(f.doc,c.move,a.hitch(this,"onMouseMove")),g(f.doc,c.release,a.hitch(this,"onMouseUp")),g(f.doc,"keydown",a.hitch(this,"onKeyDown")),g(f.doc,"keyup",a.hitch(this,"onKeyUp")),g(f.doc,"dragstart",m),g(f.body(),"selectstart",m)];e="dojoDnd"+(h?"Copy":"Move");b.add(f.body(),e)},canDrop:function(a){a=!(!this.target||!a);this.canDropFlag!=a&&(this.canDropFlag=a,this.avatar.update())},stopDrag:function(){b.remove(f.body(),["dojoDndCopy","dojoDndMove"]);
h.forEach(this.events,function(a){a.remove()});this.events=[];this.avatar.destroy();this.source=this.target=this.avatar=null;this.nodes=[]},makeAvatar:function(){return new t(this)},updateAvatar:function(){this.avatar.update()},onMouseMove:function(a){var b=this.avatar;b&&(q.autoScrollNodes(a),b=b.node.style,b.left=a.pageX+this.OFFSET_X+"px",b.top=a.pageY+this.OFFSET_Y+"px",b=!!this.source.copyState(n.getCopyKeyState(a)),this.copy!=b&&this._setCopyStatus(b));l("touch")&&a.preventDefault()},onMouseUp:function(a){if(this.avatar){if(this.target&&
this.canDropFlag){var b=!!this.source.copyState(n.getCopyKeyState(a));d.publish("/dnd/drop/before",this.source,this.nodes,b,this.target,a);d.publish("/dnd/drop",this.source,this.nodes,b,this.target,a)}else d.publish("/dnd/cancel");this.stopDrag()}},onKeyDown:function(a){if(this.avatar)switch(a.keyCode){case m.CTRL:a=!!this.source.copyState(!0);this.copy!=a&&this._setCopyStatus(a);break;case m.ESCAPE:d.publish("/dnd/cancel"),this.stopDrag()}},onKeyUp:function(a){this.avatar&&a.keyCode==m.CTRL&&(a=
!!this.source.copyState(!1),this.copy!=a&&this._setCopyStatus(a))},_setCopyStatus:function(a){this.copy=a;this.source._markDndStatus(this.copy);this.updateAvatar();b.replace(f.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"))}});n._manager=null;r.manager=n.manager=function(){n._manager||(n._manager=new r);return n._manager};return r})},"dojo/dnd/Avatar":function(){define("../_base/declare ../_base/window ../dom ../dom-attr ../dom-class ../dom-construct ../hccss ../query".split(" "),
function(h,k,a,f,b,e,l,m){return h("dojo.dnd.Avatar",null,{constructor:function(a){this.manager=a;this.construct()},construct:function(){var a=e.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),b=this.manager.source,c,h=e.create("tbody",null,a),m=e.create("tr",null,h),k=e.create("td",null,m),r=Math.min(5,this.manager.nodes.length),v=0;l("highcontrast")&&e.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"\x3c"},k);e.create("span",{innerHTML:b.generateText?
this._generateText():""},k);for(f.set(m,{"class":"dojoDndAvatarHeader",style:{opacity:.9}});v<r;++v)b.creator?c=b._normalizedCreator(b.getItem(this.manager.nodes[v].id).data,"avatar").node:(c=this.manager.nodes[v].cloneNode(!0),"tr"==c.tagName.toLowerCase()&&(m=e.create("table"),e.create("tbody",null,m).appendChild(c),c=m)),c.id="",m=e.create("tr",null,h),k=e.create("td",null,m),k.appendChild(c),f.set(m,{"class":"dojoDndAvatarItem",style:{opacity:(9-v)/10}});this.node=a},destroy:function(){e.destroy(this.node);
this.node=!1},update:function(){b.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(l("highcontrast")){var e=a.byId("a11yIcon"),d="+";this.manager.canDropFlag&&!this.manager.copy?d="\x3c ":this.manager.canDropFlag||this.manager.copy?this.manager.canDropFlag||(d="x"):d="o";e.innerHTML=d}m("tr.dojoDndAvatarHeader td span"+(l("highcontrast")?" span":""),this.node).forEach(function(a){a.innerHTML=this.manager.source.generateText?this._generateText():""},this)},_generateText:function(){return this.manager.nodes.length.toString()}})})},
"dojox/html/metrics":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/sniff dojo/ready dojo/_base/unload dojo/_base/window dojo/dom-geometry".split(" "),function(h,k,a,f,b,e,l){var m=k.getObject("dojox.html.metrics",!0),g=k.getObject("dojox");m.getFontMeasurements=function(){var b={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},c;a("ie")&&(c=e.doc.documentElement.style.fontSize||"",c||(e.doc.documentElement.style.fontSize=
"100%"));var d=e.doc.createElement("div"),f=d.style;f.position="absolute";f.left="-100px";f.top="0";f.width="30px";f.height="1000em";f.borderWidth="0";f.margin="0";f.padding="0";f.outline="0";f.lineHeight="1";f.overflow="hidden";e.body().appendChild(d);for(var g in b)f.fontSize=g,b[g]=16*Math.round(12*d.offsetHeight/16)/12/1E3;a("ie")&&(e.doc.documentElement.style.fontSize=c);e.body().removeChild(d);d=null;return b};var d=null;m.getCachedFontMeasurements=function(a){if(a||!d)d=m.getFontMeasurements();
return d};var c=null,n={};m.getTextBox=function(a,b,d){var f,g;if(c)f=c;else{f=c=e.doc.createElement("div");var h=e.doc.createElement("div");h.appendChild(f);g=h.style;g.overflow="scroll";g.position="absolute";g.left="0px";g.top="-10000px";g.width="1px";g.height="1px";g.visibility="hidden";g.borderWidth="0";g.margin="0";g.padding="0";g.outline="0";e.body().appendChild(h)}f.className="";g=f.style;g.borderWidth="0";g.margin="0";g.padding="0";g.outline="0";if(1<arguments.length&&b)for(var m in b)m in
n||(g[m]=b[m]);2<arguments.length&&d&&(f.className=d);f.innerHTML=a;g=l.position(f);g.w=f.parentNode.scrollWidth;return g};var q=16,t=16;m.getScrollbar=function(){return{w:q,h:t}};m._fontResizeNode=null;m.initOnFontResize=function(b){var c=m._fontResizeNode=e.doc.createElement("iframe");b=c.style;b.position="absolute";b.width="5em";b.height="10em";b.top="-10000px";b.display="none";a("ie")?c.onreadystatechange=function(){"complete"==c.contentWindow.document.readyState&&(c.onresize=c.contentWindow.parent[g._scopeName].html.metrics._fontresize)}:
c.onload=function(){c.contentWindow.onresize=c.contentWindow.parent[g._scopeName].html.metrics._fontresize};c.setAttribute("src","javascript:'\x3chtml\x3e\x3chead\x3e\x3cscript\x3eif(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}\x3c/script\x3e\x3c/head\x3e\x3cbody\x3e\x3c/body\x3e\x3c/html\x3e'");e.body().appendChild(c);m.initOnFontResize=function(){}};m.onFontResize=function(){};m._fontresize=function(){m.onFontResize()};b.addOnUnload(function(){var b=m._fontResizeNode;b&&(a("ie")&&
b.onresize?b.onresize=null:b.contentWindow&&b.contentWindow.onresize&&(b.contentWindow.onresize=null),m._fontResizeNode=null)});f(function(){try{var a=e.doc.createElement("div");a.style.cssText="top:0;left:0;width:100px;height:100px;overflow:scroll;position:absolute;visibility:hidden;";e.body().appendChild(a);q=a.offsetWidth-a.clientWidth;t=a.offsetHeight-a.clientHeight;e.body().removeChild(a);delete a}catch(v){}"fontSizeWatch"in h.config&&h.config.fontSizeWatch&&m.initOnFontResize()});return m})},
"dojox/grid/_Builder":function(){define("../main dojo/_base/array dojo/_base/lang dojo/_base/window dojo/_base/event dojo/_base/sniff dojo/_base/connect dojo/dnd/Moveable dojox/html/metrics ./util dojo/_base/html dojo/dom-geometry".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n){var q=h.grid,t=function(a){return 0<=a.rowIndex?a.rowIndex:k.indexOf(a.parentNode.childNodes,a)},r=function(a,b){return a&&((a.rows||0)[b]||a.childNodes[b])},v=function(a){for(;a&&"TABLE"!=a.tagName;a=a.parentNode);return a},
u=function(a){var b=a.toUpperCase();return function(a){return a.tagName!=b}},w=d.rowIndexTag,x=d.gridViewTag,y=q._Builder=a.extend(function(a){a&&(this.view=a,this.grid=a.grid)},{view:null,_table:'\x3ctable class\x3d"dojoxGridRowTable" border\x3d"0" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"',getTableArray:function(){var a=[this._table];this.view.viewWidth&&a.push([' style\x3d"width:',this.view.viewWidth,';"'].join(""));a.push("\x3e");return a},generateCellMarkup:function(a,b,c,
d){var e=[],f;d?(f=a.index!=a.grid.getSortIndex()?"":0<a.grid.sortInfo?'aria-sort\x3d"ascending"':'aria-sort\x3d"descending"',a.id||(a.id=this.grid.id+"Hdr"+a.index),f=['\x3cth tabIndex\x3d"-1" aria-readonly\x3d"true" role\x3d"columnheader"',f,' id\x3d"',a.id,'"']):f=['\x3ctd tabIndex\x3d"-1" role\x3d"gridcell"',this.grid.editable&&!a.editable?'aria-readonly\x3d"true"':""];a.colSpan&&f.push(' colspan\x3d"',a.colSpan,'"');a.rowSpan&&f.push(' rowspan\x3d"',a.rowSpan,'"');f.push(' class\x3d"dojoxGridCell ');
a.classes&&f.push(a.classes," ");c&&f.push(c," ");e.push(f.join(""));e.push("");f=['" idx\x3d"',a.index,'" style\x3d"'];b&&";"!=b[b.length-1]&&(b+=";");f.push(a.styles,b||"",a.hidden?"display:none;":"");a.unitWidth&&f.push("width:",a.unitWidth,";");e.push(f.join(""));e.push("");f=['"'];a.attrs&&f.push(" ",a.attrs);f.push("\x3e");e.push(f.join(""));e.push("");e.push(d?"\x3c/th\x3e":"\x3c/td\x3e");return e},isCellNode:function(a){return!(!a||a==f.doc||!c.attr(a,"idx"))},getCellNodeIndex:function(a){return a?
Number(c.attr(a,"idx")):-1},getCellNode:function(a,b){for(var c=0,d;(d=r(a.firstChild,c))&&d.cells;c++)for(var e=0,f;f=d.cells[e];e++)if(this.getCellNodeIndex(f)==b)return f;return null},findCellTarget:function(a,b){for(var c=a;c&&(!this.isCellNode(c)||c.offsetParent&&x in c.offsetParent.parentNode&&c.offsetParent.parentNode[x]!=this.view.id)&&c!=b;)c=c.parentNode;return c!=b?c:null},baseDecorateEvent:function(a){a.dispatch="do"+a.type;a.grid=this.grid;a.sourceView=this.view;a.cellNode=this.findCellTarget(a.target,
a.rowNode);a.cellIndex=this.getCellNodeIndex(a.cellNode);a.cell=0<=a.cellIndex?this.grid.getCell(a.cellIndex):null},findTarget:function(a,b){for(var c=a;c&&c!=this.domNode&&(!(b in c)||x in c&&c[x]!=this.view.id);)c=c.parentNode;return c!=this.domNode?c:null},findRowTarget:function(a){return this.findTarget(a,w)},isIntraNodeEvent:function(a){try{return a.cellNode&&a.relatedTarget&&c.isDescendant(a.relatedTarget,a.cellNode)}catch(B){return!1}},isIntraRowEvent:function(a){try{var b=a.relatedTarget&&
this.findRowTarget(a.relatedTarget);return!b&&-1==a.rowIndex||b&&a.rowIndex==b.gridRowIndex}catch(C){return!1}},dispatchEvent:function(a){return a.dispatch in this?this[a.dispatch](a):!1},domouseover:function(a){a.cellNode&&a.cellNode!=this.lastOverCellNode&&(this.lastOverCellNode=a.cellNode,this.grid.onMouseOver(a));this.grid.onMouseOverRow(a)},domouseout:function(a){if(a.cellNode&&a.cellNode==this.lastOverCellNode&&!this.isIntraNodeEvent(a,this.lastOverCellNode)&&(this.lastOverCellNode=null,this.grid.onMouseOut(a),
!this.isIntraRowEvent(a)))this.grid.onMouseOutRow(a)},domousedown:function(a){if(a.cellNode)this.grid.onMouseDown(a);this.grid.onMouseDownRow(a)},_getTextDirStyle:function(a,b,c){return""}});h=q._ContentBuilder=a.extend(function(a){y.call(this,a)},y.prototype,{update:function(){this.prepareHtml()},prepareHtml:function(){for(var a=this.grid.get,b=this.view.structure.cells,c=0,d;d=b[c];c++)for(var e=0,f;f=d[e];e++)f.get=f.get||void 0==f.value&&a,f.markup=this.generateCellMarkup(f,f.cellStyles,f.cellClasses,
!1),!this.grid.editable&&f.editable&&(this.grid.editable=!0)},generateHtml:function(a,b){var c=this.getTableArray(),e,f=this.view.structure.cells,g=this.grid.getItem(b);d.fire(this.view,"onBeforeRow",[b,f]);for(var l=0,h;h=f[l];l++)if(!h.hidden&&!h.header){c.push(h.invisible?'\x3ctr class\x3d"dojoxGridInvisible"\x3e':"\x3ctr\x3e");for(var m=0,n,k,q;n=h[m];m++)k=n.markup,e=n.customClasses=[],q=n.customStyles=[],k[5]=n.format(b,g),k[1]=e.join(" "),k[3]=q.join(";"),(e=n.textDir||this.grid.textDir)&&
(k[3]+=this._getTextDirStyle(e,n,b)),c.push.apply(c,k);c.push("\x3c/tr\x3e")}c.push("\x3c/table\x3e");return c.join("")},decorateEvent:function(a){a.rowNode=this.findRowTarget(a.target);if(!a.rowNode)return!1;a.rowIndex=a.rowNode[w];this.baseDecorateEvent(a);a.cell=this.grid.getCell(a.cellIndex);return!0}});var A=q._HeaderBuilder=a.extend(function(a){this.moveable=null;y.call(this,a)},y.prototype,{_skipBogusClicks:!1,overResizeWidth:4,minColWidth:1,update:function(){this.tableMap?this.tableMap.mapRows(this.view.structure.cells):
this.tableMap=new q._TableMap(this.view.structure.cells)},generateHtml:function(a,b){var c,e=this.getTableArray(),f=this.view.structure.cells;d.fire(this.view,"onBeforeRow",[-1,f]);for(var g=0,l;l=f[g];g++)if(!l.hidden){e.push(l.invisible?'\x3ctr class\x3d"dojoxGridInvisible"\x3e':"\x3ctr\x3e");for(var h=0,m,n;m=l[h];h++)m.customClasses=[],m.customStyles=[],this.view.simpleStructure&&(m.draggable&&(m.headerClasses?-1==m.headerClasses.indexOf("dojoDndItem")&&(m.headerClasses+=" dojoDndItem"):m.headerClasses=
"dojoDndItem"),m.attrs?-1==m.attrs.indexOf("dndType\x3d'gridColumn_")&&(m.attrs+=" dndType\x3d'gridColumn_"+this.grid.id+"'"):m.attrs="dndType\x3d'gridColumn_"+this.grid.id+"'"),n=this.generateCellMarkup(m,m.headerStyles,m.headerClasses,!0),n[5]=void 0!=b?b:a(m),n[3]=m.customStyles.join(";"),(c=m.textDir||this.grid.textDir)&&(n[3]+=this._getTextDirStyle(c,m,b)),n[1]=m.customClasses.join(" "),e.push(n.join(""));e.push("\x3c/tr\x3e")}e.push("\x3c/table\x3e");return e.join("")},getCellX:function(a){var b;
b=u("th");for(var c=a.target;c&&b(c);c=c.parentNode);(b=c)?(b=n.position(b),a=a.clientX-b.x):a=a.layerX;return a},decorateEvent:function(a){this.baseDecorateEvent(a);a.rowIndex=-1;a.cellX=this.getCellX(a);return!0},prepareResize:function(a,b){do{var c=a.cellIndex;a.cellNode=c?a.cellNode.parentNode.cells[c+b]:null;a.cellIndex=a.cellNode?this.getCellNodeIndex(a.cellNode):-1}while(a.cellNode&&"none"==a.cellNode.style.display);return!!a.cellNode},canResize:function(a){if(!a.cellNode||1<a.cellNode.colSpan)return!1;
a=this.grid.getCell(a.cellIndex);return!a.noresize&&a.canResize()},overLeftResizeArea:function(a){if(c.hasClass(f.body(),"dojoDndMove"))return!1;if(e("ie")){var b=a.target;if(c.hasClass(b,"dojoxGridArrowButtonNode")||c.hasClass(b,"dojoxGridArrowButtonChar")||c.hasClass(b,"dojoxGridColCaption"))return!1}return this.grid.isLeftToRight()?0<a.cellIndex&&0<a.cellX&&a.cellX<this.overResizeWidth&&this.prepareResize(a,-1):a.cellNode&&0<a.cellX&&a.cellX<this.overResizeWidth},overRightResizeArea:function(a){if(c.hasClass(f.body(),
"dojoDndMove"))return!1;if(e("ie")){var b=a.target;if(c.hasClass(b,"dojoxGridArrowButtonNode")||c.hasClass(b,"dojoxGridArrowButtonChar")||c.hasClass(b,"dojoxGridColCaption"))return!1}return this.grid.isLeftToRight()?a.cellNode&&a.cellX>=a.cellNode.offsetWidth-this.overResizeWidth:0<a.cellIndex&&a.cellX>=a.cellNode.offsetWidth-this.overResizeWidth&&this.prepareResize(a,-1)},domousemove:function(a){if(!this.moveable){var d=this.overRightResizeArea(a)?"dojoxGridColResize":this.overLeftResizeArea(a)?
"dojoxGridColResize":"";d&&!this.canResize(a)&&(d="dojoxGridColNoResize");c.toggleClass(a.sourceView.headerNode,"dojoxGridColNoResize","dojoxGridColNoResize"==d);c.toggleClass(a.sourceView.headerNode,"dojoxGridColResize","dojoxGridColResize"==d);d&&b.stop(a)}},domousedown:function(a){this.moveable||((this.overRightResizeArea(a)||this.overLeftResizeArea(a))&&this.canResize(a)?this.beginColumnResize(a):(this.grid.onMouseDown(a),this.grid.onMouseOverRow(a)))},doclick:function(a){return this._skipBogusClicks?
(b.stop(a),!0):!1},colResizeSetup:function(a,b){var d=c.contentBox(a.sourceView.headerNode);if(b){this.lineDiv=document.createElement("div");var l=c.position(a.sourceView.headerNode,!0),h=c.contentBox(a.sourceView.domNode),m=a.pageX;!this.grid.isLeftToRight()&&8>e("ie")&&(m-=g.getScrollbar().w);c.style(this.lineDiv,{top:l.y+"px",left:m+"px",height:h.h+d.h+"px"});c.addClass(this.lineDiv,"dojoxGridResizeColLine");this.lineDiv._origLeft=m;f.body().appendChild(this.lineDiv)}for(var l=[],h=this.tableMap.findOverlappingNodes(a.cellNode),
m=0,n;n=h[m];m++)l.push({node:n,index:this.getCellNodeIndex(n),width:n.offsetWidth});h=a.sourceView;n=this.grid.isLeftToRight()?1:-1;for(var k=a.grid.views.views,m=[],q=h.idx+n,r;r=k[q];q+=n)m.push({node:r.headerNode,left:window.parseInt(r.headerNode.style.left)});n=h.headerContentNode.firstChild;return{scrollLeft:a.sourceView.headerNode.scrollLeft,view:h,node:a.cellNode,index:a.cellIndex,w:c.contentBox(a.cellNode).w,vw:d.w,table:n,tw:c.contentBox(n).w,spanners:l,followers:m}},beginColumnResize:function(b){this.moverDiv=
document.createElement("div");c.style(this.moverDiv,{position:"absolute",left:0});f.body().appendChild(this.moverDiv);c.addClass(this.grid.domNode,"dojoxGridColumnResizing");var d=this.moveable=new m(this.moverDiv),e=this.colResizeSetup(b,!0);d.onMove=a.hitch(this,"doResizeColumn",e);l.connect(d,"onMoveStop",a.hitch(this,function(){this.endResizeColumn(e);e.node.releaseCapture&&e.node.releaseCapture();this.moveable.destroy();delete this.moveable;this.moveable=null;c.removeClass(this.grid.domNode,
"dojoxGridColumnResizing")}));b.cellNode.setCapture&&b.cellNode.setCapture();d.onMouseDown(b)},doResizeColumn:function(a,b,d){var e=d.l,e={deltaX:e,w:a.w+(this.grid.isLeftToRight()?e:-e),vw:a.vw+e,tw:a.tw+e};this.dragRecord={inDrag:a,mover:b,leftTop:d};e.w>=this.minColWidth&&(b?c.style(this.lineDiv,"left",this.lineDiv._origLeft+e.deltaX+"px"):this.doResizeNow(a,e))},endResizeColumn:function(a){if(this.dragRecord){var b=this.dragRecord.leftTop,b=this.grid.isLeftToRight()?b.l:-b.l,b=b+(Math.max(a.w+
b,this.minColWidth)-(a.w+b));e("webkit")&&a.spanners.length&&(b+=c._getPadBorderExtents(a.spanners[0].node).w);this.doResizeNow(a,{deltaX:b,w:a.w+b,vw:a.vw+b,tw:a.tw+b});delete this.dragRecord}c.destroy(this.lineDiv);c.destroy(this.moverDiv);c.destroy(this.moverDiv);delete this.moverDiv;this._skipBogusClicks=!0;a.view.update();this._skipBogusClicks=!1;this.grid.onResizeColumn(a.index)},doResizeNow:function(a,b){a.view.convertColPctToFixed();if(a.view.flexCells&&!a.view.testFlexCells()){var c=v(a.node);
c&&(c.style.width="")}for(var d,f,c=0;d=a.spanners[c];c++)f=d.width+b.deltaX,0<f&&(d.node.style.width=f+"px",a.view.setColWidth(d.index,f));if(this.grid.isLeftToRight()||!e("ie"))for(c=0;d=a.followers[c];c++)f=d.left+b.deltaX,d.node.style.left=f+"px";a.node.style.width=b.w+"px";a.view.setColWidth(a.index,b.w);a.view.headerNode.style.width=b.vw+"px";a.view.setColumnsWidth(b.tw);this.grid.isLeftToRight()||(a.view.headerNode.scrollLeft=a.scrollLeft+b.deltaX)}});q._TableMap=a.extend(function(a){this.mapRows(a)},
{map:null,mapRows:function(a){if(a.length){this.map=[];for(var b,c=0;b=a[c];c++)this.map[c]=[];for(c=0;b=a[c];c++)for(var d=0,e=0,f,g;f=b[d];d++){for(;this.map[c][e];)e++;this.map[c][e]={c:d,r:c};g=f.rowSpan||1;f=f.colSpan||1;for(var l=0;l<g;l++)for(var h=0;h<f;h++)this.map[c+l][e+h]=this.map[c][e];e+=f}}},dumpMap:function(){for(var a=0,b;b=this.map[a];a++)for(var c=0;b[c];c++);},getMapCoords:function(a,b){for(var c=0,d;d=this.map[c];c++)for(var e=0,f;f=d[e];e++)if(f.c==b&&f.r==a)return{j:c,i:e};
return{j:-1,i:-1}},getNode:function(a,b,c){return(a=a&&a.rows[b])&&a.cells[c]},_findOverlappingNodes:function(a,b,c){var d=[];b=this.getMapCoords(b,c);c=0;for(var e;e=this.map[c];c++)c!=b.j&&(e=(e=e[b.i])?this.getNode(a,e.r,e.c):null)&&d.push(e);return d},findOverlappingNodes:function(a){return this._findOverlappingNodes(v(a),t(a.parentNode),0<=a.cellIndex?a.cellIndex:k.indexOf(a.parentNode.cells,a))}});return{_Builder:y,_HeaderBuilder:A,_ContentBuilder:h}})},"dojox/grid/_ViewManager":function(){define(["dojo/_base/declare",
"dojo/_base/sniff","dojo/dom-class"],function(h,k,a){return h("dojox.grid._ViewManager",null,{constructor:function(a){this.grid=a},defaultWidth:200,views:[],resize:function(){this.onEach("resize")},render:function(){this.onEach("render")},addView:function(a){a.idx=this.views.length;this.views.push(a)},destroyViews:function(){for(var a=0,b;b=this.views[a];a++)b.destroy();this.views=[]},getContentNodes:function(){for(var a=[],b=0,e;e=this.views[b];b++)a.push(e.contentNode);return a},forEach:function(a){for(var b=
0,e;e=this.views[b];b++)a(e,b)},onEach:function(a,b){b=b||[];for(var e=0,f;f=this.views[e];e++)a in f&&f[a].apply(f,b)},normalizeHeaderNodeHeight:function(){for(var a=[],b=0,e;e=this.views[b];b++)e.headerContentNode.firstChild&&a.push(e.headerContentNode);this.normalizeRowNodeHeights(a)},normalizeRowNodeHeights:function(f){var b=0,e=[];if(this.grid.rowHeight)b=this.grid.rowHeight;else{if(1>=f.length)return;for(var l=0,h;h=f[l];l++)a.contains(h,"dojoxGridNonNormalizedCell")||(e[l]=h.firstChild.offsetHeight,
b=Math.max(b,e[l]));b=0<=b?b:0;(k("mozilla")||8<k("ie"))&&b&&b++}for(l=0;h=f[l];l++)e[l]!=b&&(h.firstChild.style.height=b+"px")},resetHeaderNodeHeight:function(){for(var a=0,b;b=this.views[a];a++)if(b=b.headerContentNode.firstChild)b.style.height=""},renormalizeRow:function(a){for(var b=[],e=0,f,h;(f=this.views[e])&&(h=f.getRowNode(a));e++)h.firstChild.style.height="",b.push(h);this.normalizeRowNodeHeights(b)},getViewWidth:function(a){return this.views[a].getWidth()||this.defaultWidth},measureHeader:function(){this.resetHeaderNodeHeight();
this.forEach(function(a){a.headerContentNode.style.height=""});var a=0;this.forEach(function(b){a=Math.max(b.headerNode.offsetHeight,a)});return a},measureContent:function(){var a=0;this.forEach(function(b){a=Math.max(b.domNode.offsetHeight,a)});return a},findClient:function(a){a=this.grid.elasticView||-1;if(0>a)for(var b=1,e;e=this.views[b];b++)if(e.viewWidth){for(b=1;e=this.views[b];b++)if(!e.viewWidth){a=b;break}break}0>a&&(a=Math.floor(this.views.length/2));return a},arrange:function(a,b){var e,
f,h,g=this.views.length,d=this,c=0>=b?g:this.findClient(),n=function(a,b){var c=a.domNode.style,e=a.headerNode.style;d.grid.isLeftToRight()?(c.left=b+"px",e.left=b+"px"):(c.right=b+"px",4>k("ff")?e.right=b+a.getScrollbarWidth()+"px":e.right=b+"px",k("webkit")||"auto"==e.width||(e.width=parseInt(e.width,10)-a.getScrollbarWidth()+"px"));c.top="0px";e.top=0};for(e=0;(f=this.views[e])&&e<c;e++)h=this.getViewWidth(e),f.setSize(h,0),n(f,a),h=f.headerContentNode&&f.headerContentNode.firstChild?f.getColumnsWidth()+
f.getScrollbarWidth():f.domNode.offsetWidth,a+=h;e++;for(var q=b,t=g-1;(f=this.views[t])&&e<=t;t--)h=this.getViewWidth(t),f.setSize(h,0),h=f.domNode.offsetWidth,q-=h,n(f,q);c<g&&(f=this.views[c],h=Math.max(1,q-a),f.setSize(h+"px",0),n(f,a));return a},renderRow:function(a,b,e){for(var f=[],h=0,g,d;(g=this.views[h])&&(d=b[h]);h++)g=g.renderRow(a),d.appendChild(g),f.push(g);e||this.normalizeRowNodeHeights(f)},rowRemoved:function(a){this.onEach("rowRemoved",[a])},updateRow:function(a,b){for(var e=0,f;f=
this.views[e];e++)f.updateRow(a);b||this.renormalizeRow(a)},updateRowStyles:function(a){this.onEach("updateRowStyles",[a])},setScrollTop:function(a){for(var b=a,e=0,f;f=this.views[e];e++)b=f.setScrollTop(a),k("ie")&&f.headerNode&&f.scrollboxNode&&(f.headerNode.scrollLeft=f.scrollboxNode.scrollLeft);return b},getFirstScrollingView:function(){for(var a=0,b;b=this.views[a];a++)if(b.hasHScrollbar()||b.hasVScrollbar())return b;return null}})})},"dojox/grid/_RowManager":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/dom-class"],function(h,k,a){return h("dojox.grid._RowManager",null,{constructor:function(a){this.grid=a},linesToEms:2,overRow:-2,prepareStylingRow:function(a,b){return{index:a,node:b,odd:!!(a&1),selected:!!this.grid.selection.isSelected(a),over:this.isOver(a),customStyles:"",customClasses:"dojoxGridRow"}},styleRowNode:function(a,b){var e=this.prepareStylingRow(a,b);this.grid.onStyleRow(e);this.applyStyles(e)},applyStyles:function(a){a.node.className=a.customClasses;var b=a.node.style.height,
e=a.node,f=a.customStyles+";"+(a.node._style||"");void 0==e.style.cssText?e.setAttribute("style",f):e.style.cssText=f;a.node.style.height=b},updateStyles:function(a){this.grid.updateRowStyles(a)},setOverRow:function(a){var b=this.overRow;this.overRow=a;b!=this.overRow&&(k.isString(b)||0<=b)&&this.updateStyles(b);this.updateStyles(this.overRow)},isOver:function(f){return this.overRow==f&&!a.contains(this.grid.domNode,"dojoxGridColumnResizing")}})})},"dojox/grid/_FocusManager":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/_base/connect dojo/_base/event dojo/_base/sniff dojo/query ./util dojo/_base/html".split(" "),
function(h,k,a,f,b,e,l,m,g){return a("dojox.grid._FocusManager",null,{constructor:function(a){this.grid=a;this.cell=null;this.rowIndex=-1;this._connects=[];this._headerConnects=[];this.headerMenu=this.grid.headerMenu;this._connects.push(f.connect(this.grid.domNode,"onfocus",this,"doFocus"));this._connects.push(f.connect(this.grid.domNode,"onblur",this,"doBlur"));this._connects.push(f.connect(this.grid.domNode,"mousedown",this,"_mouseDown"));this._connects.push(f.connect(this.grid.domNode,"mouseup",
this,"_mouseUp"));this._connects.push(f.connect(this.grid.domNode,"oncontextmenu",this,"doContextMenu"));this._connects.push(f.connect(this.grid.lastFocusNode,"onfocus",this,"doLastNodeFocus"));this._connects.push(f.connect(this.grid.lastFocusNode,"onblur",this,"doLastNodeBlur"));this._connects.push(f.connect(this.grid,"_onFetchComplete",this,"_delayedCellFocus"));this._connects.push(f.connect(this.grid,"postrender",this,"_delayedHeaderFocus"))},destroy:function(){h.forEach(this._connects,f.disconnect);
h.forEach(this._headerConnects,f.disconnect);delete this.grid;delete this.cell},_colHeadNode:null,_colHeadFocusIdx:null,_contextMenuBindNode:null,tabbingOut:!1,focusClass:"dojoxGridCellFocus",focusView:null,initFocusView:function(){this.focusView=this.grid.views.getFirstScrollingView()||this.focusView||this.grid.views.views[0];this._initColumnHeaders()},isFocusCell:function(a,b){return this.cell==a&&this.rowIndex==b},isLastFocusCell:function(){return this.cell?this.rowIndex==this.grid.rowCount-1&&
this.cell.index==this.grid.layout.cellCount-1:!1},isFirstFocusCell:function(){return this.cell?0===this.rowIndex&&0===this.cell.index:!1},isNoFocusCell:function(){return 0>this.rowIndex||!this.cell},isNavHeader:function(){return!!this._colHeadNode},getHeaderIndex:function(){return this._colHeadNode?h.indexOf(this._findHeaderCells(),this._colHeadNode):-1},_focusifyCellNode:function(a){var b=this.cell&&this.cell.getNode(this.rowIndex);if(b&&(g.toggleClass(b,this.focusClass,a),a)){a=this.scrollIntoView();
try{if(e("webkit")||!this.grid.edit.isEditing())m.fire(b,"focus"),a&&(this.cell.view.scrollboxNode.scrollLeft=a)}catch(n){}}},_delayedCellFocus:function(){if(!this.isNavHeader()&&this.grid.focused){var a=this.cell&&this.cell.getNode(this.rowIndex);if(a)try{this.grid.edit.isEditing()||(g.toggleClass(a,this.focusClass,!0),this._colHeadNode&&this.blurHeader(),m.fire(a,"focus"))}catch(c){}}},_delayedHeaderFocus:function(){this.isNavHeader()&&this.focusHeader()},_initColumnHeaders:function(){h.forEach(this._headerConnects,
f.disconnect);this._headerConnects=[];for(var a=this._findHeaderCells(),b=0;b<a.length;b++)this._headerConnects.push(f.connect(a[b],"onfocus",this,"doColHeaderFocus")),this._headerConnects.push(f.connect(a[b],"onblur",this,"doColHeaderBlur"))},_findHeaderCells:function(){for(var a=l("th",this.grid.viewsHeaderNode),b=[],e=0;e<a.length;e++){var f=a[e],h=g.hasAttr(f,"tabIndex"),m=g.attr(f,"tabIndex");h&&0>m&&b.push(f)}return b},_setActiveColHeader:function(a,b,e){this.grid.domNode.setAttribute("aria-activedescendant",
a.id);null!=e&&0<=e&&e!=b&&g.toggleClass(this._findHeaderCells()[e],this.focusClass,!1);g.toggleClass(a,this.focusClass,!0);this._colHeadNode=a;this._colHeadFocusIdx=b;this._scrollHeader(this._colHeadFocusIdx)},scrollIntoView:function(){var a=this.cell?this._scrollInfo(this.cell):null;if(!a||!a.s)return null;var b=this.grid.scroller.findScrollTop(this.rowIndex);a.n&&a.sr&&(a.n.offsetLeft+a.n.offsetWidth>a.sr.l+a.sr.w?a.s.scrollLeft=a.n.offsetLeft+a.n.offsetWidth-a.sr.w:a.n.offsetLeft<a.sr.l&&(a.s.scrollLeft=
a.n.offsetLeft));a.r&&a.sr&&(b+a.r.offsetHeight>a.sr.t+a.sr.h?this.grid.setScrollTop(b+a.r.offsetHeight-a.sr.h):b<a.sr.t&&this.grid.setScrollTop(b));return a.s.scrollLeft},_scrollInfo:function(a,b){if(a){var c=a.view.scrollboxNode,d={w:c.clientWidth,l:c.scrollLeft,t:c.scrollTop,h:c.clientHeight},e=a.view.getRowNode(this.rowIndex);return{c:a,s:c,sr:d,n:b?b:a.getNode(this.rowIndex),r:e}}return null},_scrollHeader:function(a){var b=null;if(this._colHeadNode){var d=this.grid.getCell(a);if(!d)return;b=
this._scrollInfo(d,d.getNode(0))}b&&b.s&&b.sr&&b.n&&(b.n.offsetLeft+b.n.offsetWidth>b.sr.l+b.sr.w?b.s.scrollLeft=b.n.offsetLeft+b.n.offsetWidth-b.sr.w:b.n.offsetLeft<b.sr.l?b.s.scrollLeft=b.n.offsetLeft:7>=e("ie")&&d&&d.view.headerNode&&(d.view.headerNode.scrollLeft=b.s.scrollLeft))},_isHeaderHidden:function(){var a=this.focusView;if(!a)for(var b=0,e;e=this.grid.views.views[b];b++)if(e.headerNode){a=e;break}return a&&"none"==g.getComputedStyle(a.headerNode).display},colSizeAdjust:function(a,b,e){var c=
this._findHeaderCells(),d=this.focusView;if(!d||!d.header.tableMap.map)for(var f=0,g;g=this.grid.views.views[f];f++)if(g.header.tableMap.map){d=g;break}f=c[b];!d||b==c.length-1&&0===b||(d.content.baseDecorateEvent(a),a.cellNode=f,a.cellIndex=d.content.getCellNodeIndex(a.cellNode),a.cell=0<=a.cellIndex?this.grid.getCell(a.cellIndex):null,d.header.canResize(a)&&(b={l:e},a=d.header.colResizeSetup(a,!1),d.header.doResizeColumn(a,null,b),d.update()))},styleRow:function(a){},setFocusIndex:function(a,b){this.setFocusCell(this.grid.getCell(b),
a)},setFocusCell:function(a,b){a&&!this.isFocusCell(a,b)&&(this.tabbingOut=!1,this._colHeadNode&&this.blurHeader(),this._colHeadNode=this._colHeadFocusIdx=null,this.focusGridView(),this._focusifyCellNode(!1),this.cell=a,this.rowIndex=b,this._focusifyCellNode(!0));if(e("opera"))setTimeout(k.hitch(this.grid,"onCellFocus",this.cell,this.rowIndex),1);else this.grid.onCellFocus(this.cell,this.rowIndex)},next:function(){if(this.cell){var a=this.rowIndex,b=this.cell.index+1,e=this.grid.layout.cellCount-
1,f=this.grid.rowCount-1;b>e&&(b=0,a++);a>f&&(b=e,a=f);if(this.grid.edit.isEditing()&&(e=this.grid.getCell(b),!this.isLastFocusCell()&&(!e.editable||this.grid.canEdit&&!this.grid.canEdit(e,a)))){this.cell=e;this.rowIndex=a;this.next();return}this.setFocusIndex(a,b)}},previous:function(){if(this.cell){var a=this.rowIndex||0,b=(this.cell.index||0)-1;0>b&&(b=this.grid.layout.cellCount-1,a--);0>a&&(b=a=0);if(this.grid.edit.isEditing()){var e=this.grid.getCell(b);if(!this.isFirstFocusCell()&&!e.editable){this.cell=
e;this.rowIndex=a;this.previous();return}}this.setFocusIndex(a,b)}},move:function(a,b){var c=0>b?-1:1;if(this.isNavHeader()){var d=this._findHeaderCells(),e=currentIdx=h.indexOf(d,this._colHeadNode);for(currentIdx+=b;0<=currentIdx&&currentIdx<d.length&&"none"==d[currentIdx].style.display;)currentIdx+=c;0<=currentIdx&&currentIdx<d.length&&this._setActiveColHeader(d[currentIdx],currentIdx,e)}else if(this.cell){var f=this.grid.scroller,d=this.rowIndex,e=this.grid.rowCount-1,l=Math.min(e,Math.max(0,d+
a));a&&(0<a?l>f.getLastPageRow(f.page)&&this.grid.setScrollTop(this.grid.scrollTop+f.findScrollTop(l)-f.findScrollTop(d)):0>a&&l<=f.getPageRow(f.page)&&this.grid.setScrollTop(this.grid.scrollTop-f.findScrollTop(d)-f.findScrollTop(l)));for(var f=this.grid.layout.cellCount-1,m=this.cell.index,k=Math.min(f,Math.max(0,m+b)),x=this.grid.getCell(k);0<=k&&k<f&&x&&!0===x.hidden;)k+=c,x=this.grid.getCell(k);x&&!0!==x.hidden||(k=m);c=x.getNode(l);!c&&a?0<=l+a&&l+a<=e&&this.move(0<a?++a:--a,b):c&&"none"!==g.style(c,
"display")||!b?(this.setFocusIndex(l,k),a&&this.grid.updateRow(d)):0<=k+b&&k+b<=f&&this.move(a,0<b?++b:--b)}},previousKey:function(a){this.grid.edit.isEditing()?(b.stop(a),this.previous()):this.isNavHeader()||this._isHeaderHidden()?(this.tabOut(this.grid.domNode),null!=this._colHeadFocusIdx&&(g.toggleClass(this._findHeaderCells()[this._colHeadFocusIdx],this.focusClass,!1),this._colHeadFocusIdx=null),this._focusifyCellNode(!1)):(this.grid.domNode.focus(),b.stop(a))},nextKey:function(a){a.target===
this.grid.domNode&&null==this._colHeadFocusIdx?(this.focusHeader(),b.stop(a)):this.isNavHeader()?(this.blurHeader(),this.findAndFocusGridCell()||this.tabOut(this.grid.lastFocusNode),this._colHeadNode=this._colHeadFocusIdx=null):this.grid.edit.isEditing()?(b.stop(a),this.next()):this.tabOut(this.grid.lastFocusNode)},tabOut:function(a){this.tabbingOut=!0;a.focus()},focusGridView:function(){m.fire(this.focusView,"focus")},focusGrid:function(a){this.focusGridView();this._focusifyCellNode(!0)},findAndFocusGridCell:function(){var a=
!0,b=0===this.grid.rowCount;this.isNoFocusCell()&&!b?(b=0,this.grid.getCell(b).hidden&&(b=this.isNavHeader()?this._colHeadFocusIdx:0),this.setFocusIndex(0,b)):this.cell&&!b?(this.focusView&&!this.focusView.rowNodes[this.rowIndex]&&this.grid.scrollToRow(this.rowIndex),this.focusGrid()):a=!1;this._colHeadNode=this._colHeadFocusIdx=null;return a},focusHeader:function(){var a=this._findHeaderCells(),b=this._colHeadFocusIdx;this._isHeaderHidden()?this.findAndFocusGridCell():this._colHeadFocusIdx||(this.isNoFocusCell()?
this._colHeadFocusIdx=0:this._colHeadFocusIdx=this.cell.index);for(this._colHeadNode=a[this._colHeadFocusIdx];this._colHeadNode&&0<=this._colHeadFocusIdx&&this._colHeadFocusIdx<a.length&&"none"==this._colHeadNode.style.display;)this._colHeadFocusIdx++,this._colHeadNode=a[this._colHeadFocusIdx];this._colHeadNode&&"none"!=this._colHeadNode.style.display?(this.headerMenu&&this._contextMenuBindNode!=this.grid.domNode&&(this.headerMenu.unBindDomNode(this.grid.viewsHeaderNode),this.headerMenu.bindDomNode(this.grid.domNode),
this._contextMenuBindNode=this.grid.domNode),this._setActiveColHeader(this._colHeadNode,this._colHeadFocusIdx,b),this._scrollHeader(this._colHeadFocusIdx),this._focusifyCellNode(!1)):this.findAndFocusGridCell()},blurHeader:function(){g.removeClass(this._colHeadNode,this.focusClass);g.removeAttr(this.grid.domNode,"aria-activedescendant");if(this.headerMenu&&this._contextMenuBindNode==this.grid.domNode){var a=this.grid.viewsHeaderNode;this.headerMenu.unBindDomNode(this.grid.domNode);this.headerMenu.bindDomNode(a);
this._contextMenuBindNode=a}},doFocus:function(a){a&&a.target!=a.currentTarget?b.stop(a):this._clickFocus||(this.tabbingOut||this.focusHeader(),this.tabbingOut=!1,b.stop(a))},doBlur:function(a){b.stop(a)},doContextMenu:function(a){this.headerMenu||b.stop(a)},doLastNodeFocus:function(a){this.tabbingOut?this._focusifyCellNode(!1):0<this.grid.rowCount?(this.isNoFocusCell()&&this.setFocusIndex(0,0),this._focusifyCellNode(!0)):this.focusHeader();this.tabbingOut=!1;b.stop(a)},doLastNodeBlur:function(a){b.stop(a)},
doColHeaderFocus:function(a){this._setActiveColHeader(a.target,g.attr(a.target,"idx"),this._colHeadFocusIdx);this._scrollHeader(this.getHeaderIndex());b.stop(a)},doColHeaderBlur:function(a){g.toggleClass(a.target,this.focusClass,!1)},_mouseDown:function(a){this._clickFocus=dojo.some(this.grid.views.views,function(b){return b.scrollboxNode===a.target})},_mouseUp:function(a){this._clickFocus=!1}})})},"dojox/grid/_EditManager":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/connect dojo/_base/sniff ./util".split(" "),
function(h,k,a,f,b,e){return a("dojox.grid._EditManager",null,{constructor:function(a){this.grid=a;this.connections=b("ie")?[f.connect(document.body,"onfocus",h.hitch(this,"_boomerangFocus"))]:[];this.connections.push(f.connect(this.grid,"onBlur",this,"apply"));this.connections.push(f.connect(this.grid,"prerender",this,"_onPreRender"))},info:{},destroy:function(){k.forEach(this.connections,f.disconnect)},cellFocus:function(a,b){this.grid.singleClickEdit||this.isEditRow(b)?this.setEditCell(a,b):this.apply();
(this.isEditing()||a&&a.editable&&a.alwaysEditing)&&this._focusEditor(a,b)},rowClick:function(a){this.isEditing()&&!this.isEditRow(a.rowIndex)&&this.apply()},styleRow:function(a){a.index==this.info.rowIndex&&(a.customClasses+=" dojoxGridRowEditing")},dispatchEvent:function(a){var b=a.cell;return(b=b&&b.editable?b:0)&&b.dispatchEvent(a.dispatch,a)},isEditing:function(){return void 0!==this.info.rowIndex},isEditCell:function(a,b){return this.info.rowIndex===a&&this.info.cell.index==b},isEditRow:function(a){return this.info.rowIndex===
a},setEditCell:function(a,b){!this.isEditCell(b,a.index)&&this.grid.canEdit&&this.grid.canEdit(a,b)&&this.start(a,b,this.isEditRow(b)||a.editable)},_focusEditor:function(a,b){e.fire(a,"focus",[b])},focusEditor:function(){this.isEditing()&&this._focusEditor(this.info.cell,this.info.rowIndex)},_boomerangWindow:500,_shouldCatchBoomerang:function(){return this._catchBoomerang>(new Date).getTime()},_boomerangFocus:function(){this._shouldCatchBoomerang()&&(this.grid.focus.focusGrid(),this.focusEditor(),
this._catchBoomerang=0)},_doCatchBoomerang:function(){b("ie")&&(this._catchBoomerang=(new Date).getTime()+this._boomerangWindow)},start:function(a,b,e){this._isValidInput()&&(this.grid.beginUpdate(),this.editorApply(),this.isEditing()&&!this.isEditRow(b)&&(this.applyRowEdit(),this.grid.updateRow(b)),e?(this.info={cell:a,rowIndex:b},this.grid.doStartEdit(a,b),this.grid.updateRow(b)):this.info={},this.grid.endUpdate(),this.grid.focus.focusGrid(),this._focusEditor(a,b),this._doCatchBoomerang())},_editorDo:function(a){var b=
this.info.cell;if(b&&b.editable)b[a](this.info.rowIndex)},editorApply:function(){this._editorDo("apply")},editorCancel:function(){this._editorDo("cancel")},applyCellEdit:function(a,b,e){this.grid.canEdit(b,e)&&this.grid.doApplyCellEdit(a,e,b.field)},applyRowEdit:function(){this.grid.doApplyEdit(this.info.rowIndex,this.info.cell.field)},apply:function(){this.isEditing()&&this._isValidInput()&&(this.grid.beginUpdate(),this.editorApply(),this.applyRowEdit(),this.info={},this.grid.endUpdate(),this.grid.focus.focusGrid(),
this._doCatchBoomerang())},cancel:function(){this.isEditing()&&(this.grid.beginUpdate(),this.editorCancel(),this.info={},this.grid.endUpdate(),this.grid.focus.focusGrid(),this._doCatchBoomerang())},save:function(a,b){var e=this.info.cell;!this.isEditRow(a)||b&&e.view!=b||!e.editable||e.save(e,this.info.rowIndex)},restore:function(a,b){var e=this.info.cell;this.isEditRow(b)&&e.view==a&&e.editable&&e.restore(this.info.rowIndex)},_isValidInput:function(){var a=(this.info.cell||{}).widget;if(!a||!a.isValid)return!0;
a.focused=!0;return a.isValid(!0)},_onPreRender:function(){this.isEditing()&&(this.info.value=this.info.cell.getValue())}})})},"dojox/grid/Selection":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/dom-attr"],function(h,k,a,f){return h("dojox.grid.Selection",null,{constructor:function(a){this.grid=a;this.selected=[];this.setMode(a.selectionMode)},mode:"extended",selected:null,updating:0,selectedIndex:-1,rangeStartIndex:-1,setMode:function(a){this.selected.length&&
this.deselectAll();this.mode="extended"!=a&&"multiple"!=a&&"single"!=a&&"none"!=a?"extended":a},onCanSelect:function(a){return this.grid.onCanSelect(a)},onCanDeselect:function(a){return this.grid.onCanDeselect(a)},onSelected:function(a){},onDeselected:function(a){},onChanging:function(){},onChanged:function(){},isSelected:function(a){return"none"==this.mode?!1:this.selected[a]},getFirstSelected:function(){if(!this.selected.length||"none"==this.mode)return-1;for(var a=0,e=this.selected.length;a<e;a++)if(this.selected[a])return a;
return-1},getNextSelected:function(a){if("none"==this.mode)return-1;a+=1;for(var b=this.selected.length;a<b;a++)if(this.selected[a])return a;return-1},getSelected:function(){for(var a=[],e=0,f=this.selected.length;e<f;e++)this.selected[e]&&a.push(e);return a},getSelectedCount:function(){for(var a=0,e=0;e<this.selected.length;e++)this.selected[e]&&a++;return a},_beginUpdate:function(){if(0===this.updating)this.onChanging();this.updating++},_endUpdate:function(){this.updating--;if(0===this.updating)this.onChanged()},
select:function(a){"none"!=this.mode&&("multiple"!=this.mode?(this.deselectAll(a),this.addToSelection(a)):this.toggleSelect(a))},addToSelection:function(b){if("none"!=this.mode)if(a.isArray(b))k.forEach(b,this.addToSelection,this);else if(b=Number(b),this.selected[b])this.selectedIndex=b;else if(!1!==this.onCanSelect(b)){this.selectedIndex=b;var e=this.grid.getRowNode(b);e&&f.set(e,"aria-selected","true");this._beginUpdate();this.selected[b]=!0;this.onSelected(b);this._endUpdate()}},deselect:function(b){if("none"!=
this.mode)if(a.isArray(b))k.forEach(b,this.deselect,this);else if(b=Number(b),this.selectedIndex==b&&(this.selectedIndex=-1),this.selected[b]&&!1!==this.onCanDeselect(b)){var e=this.grid.getRowNode(b);e&&f.set(e,"aria-selected","false");this._beginUpdate();delete this.selected[b];this.onDeselected(b);this._endUpdate()}},setSelected:function(a,e){this[e?"addToSelection":"deselect"](a)},toggleSelect:function(b){a.isArray(b)?k.forEach(b,this.toggleSelect,this):this.setSelected(b,!this.selected[b])},
_range:function(a,e,f){var b=0<=a?a:e;a=e;b>a&&(a=b,b=e);for(e=b;e<=a;e++)f(e)},selectRange:function(b,e){this._range(b,e,a.hitch(this,"addToSelection"))},deselectRange:function(b,e){this._range(b,e,a.hitch(this,"deselect"))},insert:function(a){this.selected.splice(a,0,!1);this.selectedIndex>=a&&this.selectedIndex++},remove:function(a){this.selected.splice(a,1);this.selectedIndex>=a&&this.selectedIndex--},deselectAll:function(a){for(var b in this.selected)b!=a&&!0===this.selected[b]&&this.deselect(b)},
clickSelect:function(a,e,f){if("none"!=this.mode){this._beginUpdate();if("extended"!=this.mode)this.select(a);else{if(!f||0>this.rangeStartIndex)this.rangeStartIndex=a;e||this.deselectAll(a);f?this.selectRange(this.rangeStartIndex,a):e?this.toggleSelect(a):this.addToSelection(a)}this._endUpdate()}},clickSelectEvent:function(a){this.clickSelect(a.rowIndex,dojo.isCopyKey(a),a.shiftKey)},clear:function(){this._beginUpdate();this.deselectAll();this._endUpdate()}})})},"dijit/CheckedMenuItem":function(){define(["dojo/_base/declare",
"dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(h,k,a,f){return h("dijit.CheckedMenuItem",a,{baseClass:"dijitMenuItem dijitCheckedMenuItem",templateString:f,checked:!1,_setCheckedAttr:function(a){this.domNode.setAttribute("aria-checked",a?"true":"false");this._set("checked",a)},iconClass:"",role:"menuitemcheckbox",checkedChar:"\x26#10003;",onChange:function(){},_onClick:function(a){this.disabled||(this.set("checked",!this.checked),this.onChange(this.checked));
this.onClick(a)}})})},"dojox/grid/DataSelection":function(){define(["dojo/_base/declare","./_SelectionPreserver","./Selection"],function(h,k,a){return h("dojox.grid.DataSelection",a,{constructor:function(a){a.keepSelection&&(this.preserver=new k(this))},destroy:function(){this.preserver&&this.preserver.destroy()},getFirstSelected:function(){var f=a.prototype.getFirstSelected.call(this);return-1==f?null:this.grid.getItem(f)},getNextSelected:function(f){f=this.grid.getItemIndex(f);f=a.prototype.getNextSelected.call(this,
f);return-1==f?null:this.grid.getItem(f)},getSelected:function(){for(var a=[],b=0,e=this.selected.length;b<e;b++)this.selected[b]&&a.push(this.grid.getItem(b));return a},addToSelection:function(f){if("none"!=this.mode){var b=null,b="number"==typeof f||"string"==typeof f?f:this.grid.getItemIndex(f);a.prototype.addToSelection.call(this,b)}},deselect:function(f){if("none"!=this.mode){var b=null,b="number"==typeof f||"string"==typeof f?f:this.grid.getItemIndex(f);a.prototype.deselect.call(this,b)}},deselectAll:function(f){var b=
null;f||"number"==typeof f?(b="number"==typeof f||"string"==typeof f?f:this.grid.getItemIndex(f),a.prototype.deselectAll.call(this,b)):this.inherited(arguments)}})})},"dojox/grid/_SelectionPreserver":function(){define(["dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/array"],function(h,k,a,f){return h("dojox.grid._SelectionPreserver",null,{constructor:function(b){this.selection=b;var e=this.grid=b.grid;this.reset();this._connects=[k.connect(e,"_setStore",this,"reset"),k.connect(e,
"_addItem",this,"_reSelectById"),k.connect(b,"onSelected",a.hitch(this,"_selectById",!0)),k.connect(b,"onDeselected",a.hitch(this,"_selectById",!1)),k.connect(b,"deselectAll",this,"reset")]},destroy:function(){this.reset();f.forEach(this._connects,k.disconnect);delete this._connects},reset:function(){this._selectedById={}},_reSelectById:function(a,e){a&&this.grid._hasIdentity&&(this.selection.selected[e]=this._selectedById[this.grid.store.getIdentity(a)])},_selectById:function(a,e){if("none"!=this.selection.mode&&
this.grid._hasIdentity){var b=e,f=this.grid;if("number"==typeof e||"string"==typeof e)b=(b=f._by_idx[e])&&b.item;b&&(this._selectedById[f.store.getIdentity(b)]=!!a);return b}}})})},"esri/dijit/editing/TemplatePickerItem":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/sniff dojo/dom-style dijit/_Widget dijit/_Templated dojox/gfx ../../symbols/jsonUtils ../../kernel".split(" "),function(h,k,a,f,b,e,l,m,g,d,c){h=h([l,m],{declaredClass:"esri.dijit.editing.TemplatePickerItem",
templateString:"\x3cdiv class\x3d'item' style\x3d'text-align: center;'\x3e\x3cdiv class\x3d'itemSymbol' dojoAttachPoint\x3d'_surfaceNode'\x3e\x3c/div\x3e\x3cdiv class\x3d'itemLabel'\x3e${label}\x3c/div\x3e\x3c/div\x3e",startup:function(){this._started||(this.inherited(arguments),this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template))},_draw:function(a,b,c,l,h){if(b&&"textsymbol"!==b.type){a=g.createSurface(a,c,l);if(9>f("ie")){var m=a.getEventSource();
e.set(m,"position","relative");e.set(m.parentNode,"position","relative")}var n;b=!this.legendOverride&&this._getDrawingToolShape(b,h)||d.getShapeDescriptors(b);try{n=a.createShape(b.defaultShape).setFill(b.fill).setStroke(b.stroke)}catch(A){return a.clear(),void a.destroy()}var q=n.getBoundingBox();b=q.width;h=q.height;var m=-(q.x+b/2),q=-(q.y+h/2),r=a.getDimensions(),m={dx:m+r.width/2,dy:q+r.height/2};if(b>c||h>l)q=b/c>h/l,c=((q?c:l)-5)/(q?b:h),k.mixin(m,{xx:c,yy:c});return n.applyTransform(m),a}},
_getDrawingToolShape:function(a,b){var c;switch(b?b.drawingTool||null:null){case "esriFeatureEditToolArrow":c={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolLeftArrow":c={type:"path",path:"M -15,1 L -8,8 L -8,5 L 10,5 L 10,-2 L -8,-2 L -8,-5 L -15,1 E"};break;case "esriFeatureEditToolRightArrow":c={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolUpArrow":c={type:"path",path:"M 1,-10 L 8,-3 L 5,-3 L 5,15 L -2,15 L -2,-3 L -5,-3 L 1,-10 E"};
break;case "esriFeatureEditToolDownArrow":c={type:"path",path:"M 1,15 L 8,8 L 5,8 L 5,-10 L -2,-10 L -2,8 L -5,8 L 1,15 E"};break;case "esriFeatureEditToolTriangle":c={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":c={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":c={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":c={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;case "esriFeatureEditToolFreehand":c=
"simplelinesymbol"===a.type||"cartographiclinesymbol"===a.type?{type:"path",path:"m -11, -7c-1.5,-3.75 7.25,-9.25 12.5,-7c5.25,2.25 6.75,9.75 3.75,12.75c-3,3 -3.25,2.5 -9.75,5.25c-6.5,2.75 -7.25,14.25 2,15.25c9.25,1 11.75,-4 13.25,-6.75c1.5,-2.75 3.5,-11.75 12,-6.5"}:{type:"path",path:"M 10,-13 c3.1,0.16667 4.42564,2.09743 2.76923,3.69231c-2.61025,2.87179 -5.61025,5.6718 -6.14358,6.20513c-0.66667,0.93333 -0.46667,1.2 -0.53333,1.93333c-0.00001,0.86666 0.6,1.66667 1.13334,2c1.03077,0.38462 2.8,0.93333 3.38974,1.70769c0.47693,0.42564 0.87693,0.75897 1.41026,1.75897c0.13333,1.06667 -0.46667,2.86667 -1.8,3.8c-0.73333,0.73333 -3.86667,2.66666 -4.86667,3.13333c-0.93333,0.8 -7.4,3.2 -7.6,3.06667c-1.06667,0.46667 -4.73333,1.13334 -5.2,1.26667c-1.6,0.33334 -4.6,0.4 -6.25128,0.05128c-1.41539,-0.18462 -2.34872,-2.31796 -1.41539,-4.45129c0.93333,-1.73333 1.86667,-3.13333 2.64615,-3.85641c1.28718,-1.47692 2.57437,-2.68204 3.88718,-3.54359c0.88718,-1.13845 1.8,-1.33333 2.26666,-2.45641c0.33334,-0.74359 0.37949,-1.7641 0.06667,-2.87692c-0.66666,-1.46666 -1.66666,-1.86666 -2.98975,-2.2c-1.27692,-0.26666 -2.12307,-0.64102 -3.27692,-1.46666c-0.66667,-1.00001 -1.01538,-3.01539 0.73333,-4.06667c1.73333,-1.2 3.6,-1.93333 4.93333,-2.2c1.33333,-0.46667 4.84104,-1.09743 5.84103,-1.23076c1.60001,-0.46667 6.02564,-0.50257 7.29231,-0.56924z"};
break;default:return null}return{defaultShape:c,fill:a.getFill(),stroke:a.getStroke()}},_repaint:function(b){return b?(b.getStroke&&b.setStroke&&b.setStroke(b.getStroke()),b.getFill&&b.setFill&&b.setFill(b.getFill()),void(b.children&&k.isArray(b.children)&&a.forEach(b.children,this._repaint,this))):void(this._surface=this._draw(this._surfaceNode,this.symbol,this.surfaceWidth,this.surfaceHeight,this.template))},destroy:function(){this._surface&&(this._surface.destroy(),delete this._surface);this.inherited(arguments)}});
return f("extend-esri")&&k.setObject("dijit.editing.TemplatePickerItem",h,c),h})},"cmv/viewer/js/gis/dijit/Growler":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/dom-style dojo/dom-construct dojo/_base/fx dojo/dom-class dojo/topic xstyle/css!./Growler/css/Growler.css".split(" "),function(h,k,a,f,b,e,l,m,g){var d=h([k,a],{templateString:'\x3cdiv class\x3d"growl ${level}" data-dojo-attach-event\x3d"onmouseover:hoverOver,onmouseout:hoverOut,onclick:close"\x3e\x3ch3\x3e${title}\x3c/h3\x3e\x3cspan data-dojo-attach-point\x3d"growlMessageNode"\x3e\x3c/span\x3e\x3c/div\x3e',
title:"Title",message:"Message",level:"default",timeout:1E4,opacity:1,_container:null,_timer:null,postCreate:function(){this.inherited(arguments);this._container?(b.set(this.domNode,"opacity",0),e.place(this.domNode,this._container),this.growlMessageNode.innerHTML=this.message,l.anim(this.domNode,{opacity:this.opacity},250),this.setTimeout()):g.publish("viewer/handleError",{source:"Growler",error:"Growl container not found/specified."})},setTimeout:function(){0<this.timeout&&(this._timer=setTimeout(f.hitch(this,
"close"),this.timeout))},hoverOver:function(){clearInterval(this._timer);m.add(this.domNode,"hover")},hoverOut:function(){0<this.timeout&&this.setTimeout();m.remove(this.domNode,"hover")},close:function(){l.anim(this.domNode,{opacity:0},500,null,f.hitch(this,"remove"))},remove:function(){l.anim(this.domNode,{height:0,margin:0},250,null,f.partial(e.destroy,this.domNode))}});return h([k,a],{templateString:'\x3cdiv class\x3d"gis-dijit-Growl" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',
postCreate:function(){this.inherited(arguments);this.own(g.subscribe("growler/growl",f.hitch(this,"growl")))},growl:function(a){a=a||{};f.mixin(a,{_container:this.containerNode});(new d(a)).startup()}})})},"cmv/viewer/js/gis/dijit/Basemaps":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/array dojo/topic dijit/DropDownMenu dijit/MenuItem esri/basemaps esri/dijit/BasemapGallery dojo/text!./Basemaps/templates/Basemaps.html dojo/i18n!./Basemaps/nls/resource dijit/form/DropDownButton xstyle/css!./Basemaps/css/Basemaps.css".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q){return h([k,a,f],{templateString:n,widgetsInTemplate:!0,i18n:q,title:q.title,basemaps:{},currentBasemap:null,mapStartBasemap:null,basemapsToShow:null,galleryOptions:{basemapIds:null,basemaps:null,basemapsGroup:null,bingMapsKey:null,portalUrl:null,referenceIds:null,showArcGISBasemaps:!1},postCreate:function(){this.inherited(arguments);this.initializeBasemaps();this.createBasemapGallery();l.subscribe("basemaps/updateBasemap",b.hitch(this,"updateBasemap"))},initializeBasemaps:function(){if(this.galleryOptions.basemaps)this.basemapsToShow=
this.basemapsToShow||e.map(this.galleryOptions.basemaps,function(a){return a.id});else{if(!this.basemaps||1>Object.keys(this.basemaps).length)this.basemaps=b.clone(d),this.galleryOptions.showArcGISBasemaps=!1;this.basemapsToShow=this.basemapsToShow||Object.keys(this.basemaps);var a=[];e.forEach(this.basemapsToShow,b.hitch(this,function(b){var c=this.basemaps[b];if(c.basemap&&"esri.dijit.Basemap"===c.basemap.declaredClass){var e=c.basemap;e.title=c.title||e.title;e.id=b;a.push(e)}else d[b]||(c.basemap.title=
c.title||c.basemap.title,d[b]=c.basemap),c.title=c.title||d[b].title,this.galleryOptions.showArcGISBasemaps=!1}));this.galleryOptions.basemaps=a}this.mapStartBasemap=this.mapStartBasemap||this.map.getBasemap();0>e.indexOf(this.basemapsToShow,this.mapStartBasemap)&&(this.mapStartBasemap=this.basemapsToShow[0])},createBasemapGallery:function(){var a=b.mixin({map:this.map},this.galleryOptions);this.gallery=new c(a);this.gallery.startup();if(this.galleryOptions.showArcGISBasemaps)this.gallery.on("load",
b.hitch(this,"buildMenu"));else this.buildMenu()},buildMenu:function(){this.menu=new m({style:"display: none;"});e.forEach(this.basemapsToShow,function(a){this.basemaps.hasOwnProperty(a)&&(a=new g({id:a,label:this.basemaps[a].title,iconClass:a===this.mapStartBasemap?"selectedIcon":"emptyIcon",onClick:b.hitch(this,"updateBasemap",a)}),this.menu.addChild(a))},this);this.dropDownButton.set("dropDown",this.menu);this.setStartingBasemap()},setStartingBasemap:function(){this.mapStartBasemap&&(this.gallery.get(this.mapStartBasemap)||
d[this.mapStartBasemap])&&this.updateBasemap(this.mapStartBasemap)},updateBasemap:function(a){if(a!==this.currentBasemap&&-1!==e.indexOf(this.basemapsToShow,a)){if(this.gallery.get(a))this.gallery.select(a);else if(d[a])this.gallery._removeBasemapLayers(),this.gallery._removeReferenceLayer(),this.map.setBasemap(a);else{l.publish("viewer/error","Invalid basemap selected.");return}this.currentBasemap=a;var b=this.menu.getChildren();e.forEach(b,function(b){b.id===a?b.set("iconClass","selectedIcon"):
b.set("iconClass","emptyIcon")})}}})})},"esri/dijit/BasemapGallery":function(){define("require dojo/_base/declare dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/_base/kernel dojo/_base/sniff dojo/has dojo/query dojo/Deferred dojo/DeferredList dojo/dom dojo/dom-construct dojo/dom-class dijit/_Widget dijit/_Templated ../kernel ../lang ../urlUtils ../request ../geometry/Extent ../SpatialReference ../virtualearth/VETiledLayer ../layers/OpenStreetMapLayer ../layers/ArcGISTiledMapServiceLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/WebTiledLayer ../layers/VectorTileLayer ../layers/TileInfo ../layers/ArcGISImageServiceLayer ../layers/ImageServiceParameters ../layers/ImageParameters ./Basemap ./_EventedWidget dojo/text!./templates/BasemapGallery.html".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J,L,M,H,K,P){k=k([K,r,v],{declaredClass:"esri.dijit.BasemapGallery",widgetsInTemplate:!0,templateString:P,loaded:!1,basemaps:[],bingMapsKey:null,flowContainer:null,_hasUI:!1,_supportsVTL:null,_selectedBasemap:null,_selectBasemapInProgress:!1,_eventMap:{load:!0,"selection-change":!0,add:["basemap"],remove:["basemap"],error:["message"]},constructor:function(a,b){a=a||{};a.map||console.error("esri.dijit.BasemapGallery: Unable to find the 'map' property in parameters");
this.map=a.map;this._hasUI=b?!0:!1;this.bingMapsKey=a.bingMapsKey&&0<a.bingMapsKey.length?a.bingMapsKey:null;this.showArcGISBasemaps=!1!==a.showArcGISBasemaps;this.basemaps=a.basemaps||[];this.basemapIds=a.basemapIds;this.referenceIds=a.referenceIds;this.basemapsGroup=a.basemapsGroup;this.arcgisUrl=u.dijit._arcgisUrl;a.portalUrl&&(this.arcgisUrl=a.portalUrl+"/sharing/rest");0>this.arcgisUrl.indexOf("://")?this.arcgisUrl=x.getProtocolForWebResource()+"//"+this.arcgisUrl:"https:"===window.location.protocol&&
(this.arcgisUrl=this.arcgisUrl.replace("http:","https:"));this.init()},init:function(){this.inherited(arguments);a.forEach(this.basemaps,function(b){b.id&&0!==b.id.length||(b.id=this._getUniqueId());a.forEach(b.layers,function(a){a.opacity=0<=a.opacity?a.opacity:1;a.visibility=!0},this)},this);this.basemapIds&&0<this.basemapIds.length&&a.forEach(this.basemapIds,function(a){this.map.getLayer(a)._basemapGalleryLayerType="basemap"},this);this.referenceIds&&0<this.referenceIds.length&&a.forEach(this.referenceIds,
function(a){a=this.map.getLayer(a);a._basemapGalleryLayerType="reference";a.attr("data-reference",!0)},this);this.basemapsGroup&&(this.basemapsGroup.owner&&this.basemapsGroup.title||this.basemapsGroup.id)?this._findCustomBasemapsGroup(b.hitch(this,"_handleArcGISBasemapsResponse")):this.showArcGISBasemaps?this._findArcGISBasemapsGroup(b.hitch(this,"_handleArcGISBasemapsResponse")):this._finishStartup();this._checkVTLSupport().then(b.hitch(this,function(a){this._supportsVTL=a}))},startup:function(){this.loaded?
this._refreshUI():f.connect(this,"onLoad",b.hitch(this,function(){this._refreshUI()}))},select:function(a){this._select(a)},getSelected:function(){return this._selectedBasemap},get:function(a){var b;for(b=0;b<this.basemaps.length;b++)if(this.basemaps[b].id===a)return this.basemaps[b];return null},add:function(a){return a&&!a.id?(a.id=this._getUniqueId(),this.basemaps.push(a),this._refreshUI(),this.onAdd(a),!0):a&&this._isUniqueId(a.id)?(this.basemaps.push(a),this._refreshUI(),this.onAdd(a),!0):!1},
remove:function(a){var b;for(b=0;b<this.basemaps.length;b++){var c=this.basemaps[b];if(c.id===a)return this._selectedBasemap&&this._selectedBasemap.id===c.id&&(this._selectedBasemap=null),this.basemaps.splice(b,1),this._refreshUI(),this.onRemove(c),c}return null},onLoad:function(){},onSelectionChange:function(){},onAdd:function(a){},onRemove:function(a){},onError:function(a){},_defaultBasemapGalleryGroupQuery:'title:"ArcGIS Online Basemaps" AND owner:esri',_basemapGalleryGroupQuery:null,_finishStartup:function(){this.loaded=
!0;this.onLoad();0===this.map.layerIds.length&&0<this.basemaps.length&&!this._selectBasemapInProgress&&this._select(this.basemaps[0].id)},_findCustomBasemapsGroup:function(a){this.basemapsGroup&&this.basemapsGroup.id?this._findArcGISBasemaps(this.basemapsGroup.id,a):(this._basemapGalleryGroupQuery='title:"'+this.basemapsGroup.title+'" AND owner:'+this.basemapsGroup.owner,this._findArcGISBasemapsGroup(a))},_findArcGISBasemapsGroup:function(a){if(this._basemapGalleryGroupQuery)this._findArcGISBasemapsGroupContent(a);
else{var c=this.arcgisUrl+"/portals/self",d={f:"json"};d.culture=e.locale;y({url:c,content:d,callbackParamName:"callback",load:b.hitch(this,function(b,c){b&&b.basemapGalleryGroupQuery?this._basemapGalleryGroupQuery=b.basemapGalleryGroupQuery:this._basemapGalleryGroupQuery=this._defaultBasemapGalleryGroupQuery;this._findArcGISBasemapsGroupContent(a)}),error:b.hitch(this,function(a,b){this._basemapGalleryGroupQuery=this._defaultBasemapGalleryGroupQuery})})}},_findArcGISBasemapsGroupContent:function(a){var c=
b.hitch(this,"_findArcGISBasemaps"),d=this.arcgisUrl+"/community/groups",e={};e.q=this._basemapGalleryGroupQuery;e.f="json";y({url:d,content:e,callbackParamName:"callback",load:b.hitch(this,function(b,d){if(0<b.results.length)c(b.results[0].id,a,b.results[0].sortField,b.results[0].sortOrder);else this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")}),error:b.hitch(this,function(a){this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")})})},_findArcGISBasemaps:function(a,
c,d,e){var f=b.hitch(this,function(a,c,d,e){var f=this.arcgisUrl+"/search",g={};g.q="group:"+a+' AND type:"web map" NOT type:"web mapping application"';g.sortField=d;g.sortOrder="asc"===e?"desc":"asc";g.num=50;g.f="json";y({url:f,content:g,callbackParamName:"callback",load:b.hitch(this,function(a,b){if(0<a.results.length)c(a.results);else this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")}),error:b.hitch(this,function(a,b){this.onError("esri.dijit.BasemapGallery: could not find group for basemaps.")})})});
d&&e?f(a,c,d,e):y({url:this.arcgisUrl+"/community/groups/"+a,content:{f:"json"},callbackParamName:"callback",load:b.hitch(this,function(b,d){b.sortField?f(a,c,b.sortField,b.sortOrder):f(a,c,"name","desc")}),error:b.hitch(this,function(b,d){f(a,c,"name","desc")})})},_handleArcGISBasemapsResponse:function(b){0<b.length&&(a.forEach(b,function(a,b){if(this.bingMapsKey||!this.bingMapsKey&&a.title&&-1===a.title.indexOf("Bing Maps")){var c={};if(c.id=this._getUniqueId(),c.title=a.title,c.thumbnailUrl="",
a.thumbnail&&a.thumbnail.length&&(c.thumbnailUrl=this.arcgisUrl+"/content/items/"+a.id+"/info/"+a.thumbnail,u.id)){var d=u.id.findCredential(x.urlToObject(this.arcgisUrl).path);d&&(c.thumbnailUrl+="?token\x3d"+d.token)}c.itemId=a.id;c=new H(c,this);this.basemaps.splice(0,0,c)}},this),this._finishStartup())},_refreshUI:function(){this._hasUI&&(q.empty(this.flowContainer),a.forEach(this.basemaps,function(a,b){a.id||(a.id="basemap_"+b);this.flowContainer.appendChild(this._buildNodeLayout(a))},this),
q.create("br",{style:{clear:"both"}},this.flowContainer),this._markSelected(this._selectedBasemap))},_buildNodeLayout:function(a){var c=q.create("div",{id:"galleryNode_"+a.id,"class":"esriBasemapGalleryNode"}),d=q.create("a",{href:"javascript:void(0);"},c);f.connect(d,"onclick",b.hitch(this,"_onNodeClick",a));var e=a.title||"";a.thumbnailUrl?q.create("img",{"class":"esriBasemapGalleryThumbnail",src:a.thumbnailUrl,title:e,alt:e},d):q.create("img",{"class":"esriBasemapGalleryThumbnail",src:h.toUrl("./images/transparent.gif"),
title:e,alt:e},d);a=q.create("div",{"class":"esriBasemapGalleryLabelContainer"},c);return q.create("span",{innerHTML:e,alt:e,title:e},a),c},_onNodeClick:function(a,b){b.preventDefault();this._markSelected(a);this.select(a.id)},_markSelected:function(b){b&&(a.forEach(e.query(".esriBasemapGallerySelectedNode",this.domNode),function(a){t.remove(a,"esriBasemapGallerySelectedNode")}),(b=n.byId("galleryNode_"+b.id))&&t.add(b,"esriBasemapGallerySelectedNode"))},_select:function(a){this._selectBasemapInProgress=
!0;var c=this.get(a);c?(c.layers?this._getServiceInfos(c):(a=c.getLayers(this.arcgisUrl),b.isArray(a)?this._getServiceInfos(c):a.addCallback(b.hitch(this,function(a){this._getServiceInfos(c)}))),this._markSelected(c)):this._selectBasemapInProgress=!1},_getServiceInfos:function(d){"https:"===location.protocol&&a.forEach(d.layers,function(a){(this._isAgolService(a.url)||this._isHostedService(a.url))&&(a.url=a.url.replace("http:","https:"))},this);this._selectedBasemap=d;var e=[];(a.forEach(d.layers,
function(a){a.url&&0<a.url.length&&!a.isReference&&!a.type&&(a.deferredsPos=e.length,e.push(this._getServiceInfo(a.url)))},this),0<e.length)?(new c(e)).addCallback(b.hitch(this,function(b){var c=null;(a.forEach(d.layers,function(a){if(0===a.deferredsPos||a.deferredsPos){a.serviceInfoResponse=b[a.deferredsPos][1];var d=a.serviceInfoResponse.fullExtent;d||(d=a.serviceInfoResponse.extent);c=c?c.union(new A(d)):new A(d)}},this),this.map.extent)&&5>this._getIntersectionPercent(c,this.map.extent)&&this.map.setExtent(c,
!0);this._switchBasemapLayers(d);this._updateReferenceLayer(d)})):(this._switchBasemapLayers(d),this._updateReferenceLayer(d))},_checkVTLSupport:function(){var a=new d;return l("ie")?a.resolve(!1):a.resolve(G.supported()),a},_switchBasemapLayers:function(c){var d,e,g,l,h=c.layers,m=!1;if(a.forEach(h,function(a){"VectorTileLayer"===a.type&&(m=!0)}),m&&!0!==this._supportsVTL)return d="esri.dijit.BasemapGallery: Unable to switch basemap because layer type is not supported by your current browser version.",
void this.onError(d);if(0<this.map.layerIds.length&&0===this.map.getNumLevels()&&("OpenStreetMap"===h[0].type||h[0].type&&-1<h[0].type.indexOf("BingMaps")||"WebTiledLayer"===h[0].type||"VectorTileLayer"===h[0].type))return d="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.",void this.onError(d);a.forEach(h,function(a){if(!a.isReference&&a.type&&-1<a.type.indexOf("BingMaps")&&!this.bingMapsKey)return void this.onError("esri.dijit.BasemapGallery: Invalid Bing Maps key.")},
this);var n=0;a.forEach(h,function(a,c){if(!a.isReference){var d,m;if("OpenStreetMap"===a.type){if(0<this.map.layerIds.length&&0===this.map.getNumLevels())return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.",void this.onError(m);d=new C({id:"layer_osm",opacity:a.opacity})}else if(a.type&&-1<a.type.indexOf("BingMaps")){if(0<this.map.layerIds.length&&0===this.map.getNumLevels())return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.",
void this.onError(m);d=B.MAP_STYLE_AERIAL_WITH_LABELS;"BingMapsAerial"===a.type?d=B.MAP_STYLE_AERIAL:"BingMapsRoad"===a.type&&(d=B.MAP_STYLE_ROAD);d=new B({id:"layer_bing",bingMapsKey:this.bingMapsKey,mapStyle:d,opacity:a.opacity})}else if("WebTiledLayer"===a.type){if(0<this.map.layerIds.length&&0===this.map.getNumLevels())return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.",void this.onError(m);d=a.initialExtent||
a.fullExtent;d=new F(a.templateUrl||a.url,{visible:a.visibility,opacity:a.opacity,copyright:a.copyright,fullExtent:a.fullExtent&&new A(a.fullExtent),initialExtent:d&&new A(d),subDomains:a.subDomains,tileInfo:a.tileInfo?new I(a.tileInfo):null,tileServers:a.tileServers})}else if("VectorTileLayer"===a.type){d=new G(a.styleUrl,{visible:a.visibility,opacity:a.opacity});0===c&&1<h.length&&this._removeBasemapLayers();var k=this;f.connect(d,"onLoad",b.hitch(this,function(a,b,c){var d;return k._sameSpatialReference(c.spatialReference,
k.map.spatialReference)?0<k.map.getNumLevels()?k._sameTilingScheme(c.tileInfo,k.map.__tileInfo)?(0===b&&1===h.length&&k._removeBasemapLayers(),c._basemapGalleryLayerType="basemap",void k.map.addLayer(c,a)):(d="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.",void k.onError(d)):(d="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.",void k.onError(d)):(d="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.",
void k.onError(d))},n,c))}else if(a.serviceInfoResponse&&a.serviceInfoResponse.mapName){if(e=new z(a.serviceInfoResponse.spatialReference),g=this._sameSpatialReference(e,this.map.spatialReference),this.map.spatialReference&&!g)return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.",void this.onError(m);if(!0===a.serviceInfoResponse.singleFusedMapCache&&0<this.map.getNumLevels()){if(l=this._sameTilingScheme(a.serviceInfoResponse.tileInfo,
this.map.__tileInfo),!l)return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.",void this.onError(m)}else if(!0===a.serviceInfoResponse.singleFusedMapCache&&-1<a.serviceInfoResponse.capabilities.toLowerCase().indexOf("tilesonly")&&0===this.map.getNumLevels())return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap is a tiled service and cannot be loaded as a dynamic layer.",void this.onError(m);d=(0===this.map.layerIds.length||
0<this.map.getNumLevels())&&!0===a.serviceInfoResponse.singleFusedMapCache?this._loadAsCached(a):this._loadAsDynamic(a)}else if(a.serviceInfoResponse&&a.serviceInfoResponse.pixelSizeX){if(e=new z(a.serviceInfoResponse.spatialReference),g=this._sameSpatialReference(e,this.map.spatialReference),!g)return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different spatial reference.",void this.onError(m);if(!0===a.serviceInfoResponse.singleFusedMapCache&&0<this.map.getNumLevels()&&
(l=this._sameTilingScheme(a.serviceInfoResponse.tileInfo,this.map.__tileInfo),!l))return m="esri.dijit.BasemapGallery: Unable to switch basemap because new basemap has a different tiling scheme.",void this.onError(m);a.serviceInfoResponse.singleFusedMapCache?d=new D(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility}):a.serviceInfoResponse.pixelSizeX?(d=new L,d.bandIds=a.bandIds,!a.bandIds&&a.serviceInfoResponse.bandCount&&3<parseInt(a.serviceInfoResponse.bandCount,10)&&
(d.bandIds=[0,1,2]),d=new J(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility,imageServiceParameters:d})):(d=new M,d.format="png24",a.serviceInfoResponse.supportedImageFormatTypes&&-1<a.serviceInfoResponse.supportedImageFormatTypes.indexOf("PNG32")&&(d.format="png32"),d=new E(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility,imageParameters:d}))}"VectorTileLayer"===a.type?n++:d&&(0===c&&this._removeBasemapLayers(),d._basemapGalleryLayerType=
"basemap",this.map.addLayer(d,n),n++)}},this);this._selectBasemapInProgress=!1;this.onSelectionChange()},_removeBasemapLayers:function(){var b=this.map.layerIds,c=[];a.forEach(b,function(a){a=this.map.getLayer(a);"basemap"===a._basemapGalleryLayerType&&c.push(a)},this);0===c.length&&0<b.length&&c.push(this.map.getLayer(b[0]));0<c.length&&a.forEach(c,function(a){this.map.removeLayer(a)},this)},_updateReferenceLayer:function(a){var b;this._removeReferenceLayer();for(b=0;b<a.layers.length;b++)!0===a.layers[b].isReference&&
this._addReferenceLayer(a.layers[b])},_removeReferenceLayer:function(){var a;for(a=this.map.layerIds.length-1;0<=a;a--){var b=this.map.getLayer(this.map.layerIds[a]);"reference"===b._basemapGalleryLayerType&&this.map.removeLayer(b)}},_addReferenceLayer:function(a){"VectorTileLayer"===a.type?this._handleReferenceServiceInfoResponse(a):this._getServiceInfo(a.url,b.hitch(this,"_handleReferenceServiceInfoResponse",a))},_handleReferenceServiceInfoResponse:function(a,b,c){var d;(a.serviceInfoResponse=b,
"VectorTileLayer"===a.type)?d=new G(a.styleUrl,{visible:a.visibility,opacity:a.opacity}):b&&b.mapName?d=!0===b.singleFusedMapCache?this._loadAsCached(a):this._loadAsDynamic(a):b&&b.pixelSizeX&&(a.serviceInfoResponse.singleFusedMapCache?d=new D(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility}):a.serviceInfoResponse.pixelSizeX?(c=new L,c.bandIds=a.bandIds,!a.bandIds&&b.bandCount&&3<parseInt(b.bandCount,10)&&(c.bandIds=[0,1,2]),d=new J(a.url,{resourceInfo:b,opacity:a.opacity,
visible:a.visibility,imageServiceParameters:c})):(b=new M,b.format="png24",a.serviceInfoResponse.supportedImageFormatTypes&&-1<a.serviceInfoResponse.supportedImageFormatTypes.indexOf("PNG32")&&(b.format="png32"),b.transparent=!0,d=new E(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility,imageParameters:b})));d&&(d._basemapGalleryLayerType="reference",d.attr("data-reference",!0),this.map.addLayer(d))},_getServiceInfo:function(a,c){return y({url:a,content:{f:"json"},callbackParamName:"callback",
load:function(a,b){c&&c(a,b)},error:b.hitch(this,function(a,b){this.onError("esri.dijit.BasemapGallery: service not accessible.")})})},_loadAsCached:function(b){var c=[];b.displayLevels||(c=a.map(b.serviceInfoResponse.tileInfo.lods,function(a){return a.level}));var d=null;b.exclusionAreas&&b.exclusionAreas.length&&(d=[],a.forEach(b.exclusionAreas,function(a){d.push({minZoom:a.minZoom,maxZoom:a.maxZoom,minScale:a.minScale,maxScale:a.maxScale,geometry:new A(a.geometry)})}));return new D(b.url,{resourceInfo:b.serviceInfoResponse,
opacity:b.opacity,visible:b.visibility,exclusionAreas:d,displayLevels:b.displayLevels||c})},_loadAsDynamic:function(a){var b=new E(a.url,{resourceInfo:a.serviceInfoResponse,opacity:a.opacity,visible:a.visibility});return a.visibleLayers&&b.setVisibleLayers(a.visibleLayers),b},_getIntersectionPercent:function(a,b){var c=b.intersects(a);if(c){var c=c.getWidth()*c.getHeight(),d=b.getWidth()*b.getHeight();return c/d*100}return 0},_getIds:function(){var b=[];return a.forEach(this.basemaps,function(a){b.push(a.id)},
this),b},_getUniqueId:function(){for(var a=","+this._getIds().toString()+",",b=0;;){if(!(-1<a.indexOf(",basemap_"+b+",")))return"basemap_"+b;b++}},_isUniqueId:function(a){return-1===(","+this._getIds().toString()+",").indexOf(","+a+",")?!0:!1},_isAgolService:function(a){return a?-1!==a.indexOf("/services.arcgisonline.com/")||-1!==a.indexOf("/server.arcgisonline.com/"):!1},_isHostedService:function(a){return a?-1!==a.indexOf(".arcgis.com/"):!1},_sameSpatialReference:function(a,b){return a&&b&&a.wkt==
b.wkt&&(a.wkid===b.wkid||w.isDefined(a.latestWkid)&&a.latestWkid===b.wkid||w.isDefined(b.latestWkid)&&a.wkid===b.latestWkid||w.isDefined(a.latestWkid)&&a.latestWkid===b.latestWkid)?!0:a&&b&&a.isWebMercator()&&b.isWebMercator()?!0:!1},_sameTilingScheme:function(a,b){var c,d;c=this.map;var e=c.width>c.height?c.width:c.height,f=!1,g=!1;for(c=0;c<a.lods.length;c++){var l=a.lods[c].scale;a.dpi!==b.dpi&&(l=a.lods[c].scale/a.dpi);for(d=0;d<b.lods.length;d++){var h=b.lods[d].scale;if(a.dpi!==b.dpi&&(h=b.lods[d].scale/
b.dpi),Math.abs(h-l)/h<1/e){if(f){g=!0;break}f=!0}if(l>h)break}if(g)break}return g?!0:!f||1!==a.lods.length&&1!==b.lods.length?!1:!0}});return m("extend-esri")&&b.setObject("dijit.BasemapGallery",k,u),k})},"esri/layers/WebTiledLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/url dojo/sniff dojo/string ../config ../kernel ../request ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,
n,q,t){function r(a,b){var c,e,f=[];if(a&&b&&(b.customLayerParameters||b.customParameters)){c=k.clone(b.customParameters||{});k.mixin(c,b.customLayerParameters||{});e=d.urlToObject(a);for(var g in e.query)c.hasOwnProperty(g)||f.push(g+"\x3d"+e.query[g]);a=e.path+(f.length?"?"+f.join("\x26"):"")}return a}h=h(q,{declaredClass:"esri.layers.WebTiledLayer",constructor:function(h,m){m||(m={});this.urlTemplate=h=r(h,m.wmtsInfo);var q=new n(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,
new c({wkid:102100})),u=new n(-2.0037508342787E7,-2.003750834278E7,2.003750834278E7,2.0037508342787E7,new c({wkid:102100}));(this.initialExtent=m.initialExtent||q,this.fullExtent=m.fullExtent||u,m.tileInfo)?this.tileInfo=m.tileInfo:this.tileInfo=new t({dpi:96,rows:256,cols:256,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,resolution:156543.033928,scale:5.91657527591555E8},{level:1,resolution:78271.5169639999,scale:2.95828763795777E8},{level:2,resolution:39135.7584820001,
scale:1.47914381897889E8},{level:3,resolution:19567.8792409999,scale:7.3957190948944E7},{level:4,resolution:9783.93962049996,scale:3.6978595474472E7},{level:5,resolution:4891.96981024998,scale:1.8489297737236E7},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,scale:577790.554289},
{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,
scale:1128.497176},{level:20,resolution:.14929107082380833,scale:564.248588},{level:21,resolution:.07464553541190416,scale:282.124294},{level:22,resolution:.03732276770595208,scale:141.062147},{level:23,resolution:.01866138385297604,scale:70.5310735}]});this.spatialReference=new c(this.tileInfo.spatialReference.toJson());this.copyright=m.copyright||"";var v=new f(h),q=v.scheme+"://"+v.authority+"/";if(this.urlPath=h.substring(q.length),this.tileServers=m.tileServers||[],-1===v.authority.indexOf("{subDomain}")&&
this.tileServers.push(q),m.subDomains&&0<m.subDomains.length&&1<v.authority.split(".").length){this.subDomains=m.subDomains;var A;a.forEach(m.subDomains,function(a){-1<v.authority.indexOf("${subDomain}")?A=v.scheme+"://"+e.substitute(v.authority,{subDomain:a})+"/":-1<v.authority.indexOf("{subDomain}")&&(A=v.scheme+"://"+v.authority.replace(/\{subDomain\}/gi,a)+"/");this.tileServers.push(A)},this)}this.tileServers=a.map(this.tileServers,function(a){return"/"!==a.charAt(a.length-1)&&(a+="/"),a});this._levelToLevelValue=
[];a.forEach(this.tileInfo.lods,function(a){this._levelToLevelValue[a.level]=a.levelValue||a.level},this);this._wmtsInfo=m.wmtsInfo;var z=k.hitch(this,function(){this.loaded=!0;this.onLoad(this)});if(b("chrome")){var q=this.getTileUrl(0,0,0),u=l.defaults.io,B="with-credentials"===u.useCors?d.canUseXhr(q,!0):-1;(u=-1<B?u.corsEnabledServers[B]:null)&&u.withCredentials?g({url:q,handleAs:"arraybuffer"}).addBoth(function(a){z()}):z()}else z()},getTileUrl:function(a,b,c){a=this._levelToLevelValue[a];var f=
this.tileServers[b%this.tileServers.length]+e.substitute(this.urlPath,{level:a,col:c,row:b});return f=f.replace(/\{level\}/gi,a).replace(/\{row\}/gi,b).replace(/\{col\}/gi,c),f=this._appendCustomLayerParameters(f),f=this.addTimestampToURL(f),d.addProxy(f)},_appendCustomLayerParameters:function(a){var b,c;if(this._wmtsInfo&&(this._wmtsInfo.customLayerParameters||this._wmtsInfo.customParameters))for(b in c=k.clone(this._wmtsInfo.customParameters||{}),k.mixin(c,this._wmtsInfo.customLayerParameters||
{}),c)a+=(-1===a.indexOf("?")?"?":"\x26")+b+"\x3d"+encodeURIComponent(c[b]);return a}});return b("extend-esri")&&k.setObject("layers.WebTiledLayer",h,m),h})},"esri/layers/ImageServiceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang".split(" "),function(h,k,a,f,b,e){h=h(null,{declaredClass:"esri.layers.ImageServiceParameters",extent:null,width:null,height:null,imageSpatialReference:null,format:null,interpolation:null,compressionQuality:null,
bandIds:null,timeExtent:null,mosaicRule:null,renderingRule:null,noData:null,compressionTolerance:null,adjustAspectRatio:null,lercVersion:null,toJson:function(b){var f=this.bbox||this.extent;b=(f=f&&b&&f._normalize(!0))?f.spatialReference.wkid||a.toJson(f.spatialReference.toJson()):null;var g=this.imageSpatialReference,f={bbox:f?f.xmin+","+f.ymin+","+f.xmax+","+f.ymax:null,bboxSR:b,size:null!==this.width&&null!==this.height?this.width+","+this.height:null,imageSR:g?g.wkid||a.toJson(g.toJson()):b,format:this.format,
interpolation:this.interpolation,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null,mosaicRule:this.mosaicRule?a.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?a.toJson(this.renderingRule.toJson()):null,noData:this.noData,noDataInterpretation:this.noDataInterpretation,compressionTolerance:this.compressionTolerance,adjustAspectRatio:this.adjustAspectRatio,lercVersion:this.lercVersion};b=this.timeExtent;return f.time=b?b.toJson().join(","):
null,e.filter(f,function(a){return null!==a&&void 0!==a?!0:void 0})}});return k.mixin(h,{INTERPOLATION_BILINEAR:"RSP_BilinearInterpolation",INTERPOLATION_CUBICCONVOLUTION:"RSP_CubicConvolution",INTERPOLATION_MAJORITY:"RSP_Majority",INTERPOLATION_NEARESTNEIGHBOR:"RSP_NearestNeighbor",NODATA_MATCH_ALL:"esriNoDataMatchAll",NODATA_MATCH_ANY:"esriNoDataMatchAny"}),f("extend-esri")&&k.setObject("layers.ImageServiceParameters",h,b),h})},"esri/dijit/Basemap":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../request ./BasemapLayer".split(" "),
function(h,k,a,f,b,e,l){h=h(null,{declaredClass:"esri.dijit.Basemap",id:null,title:"",thumbnailUrl:null,layers:null,itemId:null,basemapGallery:null,constructor:function(a,b){a=a||{};a.layers||a.itemId||console.error("esri.dijit.Basemap: unable to find the 'layers' property in parameters");this.id=a.id;this.itemId=a.itemId;this.layers=a.layers;this.title=a.title||"";this.thumbnailUrl=a.thumbnailUrl;this.basemapGallery=b},getLayers:function(f){if(this.layers)return this.layers;if(this.itemId)return f=
e({url:(f||b.dijit._arcgisUrl)+"/content/items/"+this.itemId+"/data",content:{f:"json"},callbackParamName:"callback",error:a.hitch(this,function(a,b){this.basemapGallery?this.basemapGallery.onError("esri.dijit.Basemap: could not access basemap item."):console.error("esri.dijit.Basemap: could not access basemap item.")})}),f.addCallback(a.hitch(this,function(a,b){return a.baseMap?(this.layers=[],k.forEach(a.baseMap.baseMapLayers,function(a){this.layers.push(new l(a))},this),this.layers):(this.basemapGallery?
this.basemapGallery.onError("esri.dijit.Basemap: could not access basemap item."):console.error("esri.dijit.Basemap: could not access basemap item."),[])})),f}});return f("extend-esri")&&a.setObject("dijit.Basemap",h,b),h})},"esri/dijit/BasemapLayer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.dijit.BasemapLayer",constructor:function(a){a=a||{};a.url||a.type||console.error("esri.dijit.BasemapLayer: unable to find the 'url' or 'type' property in parameters");
this.url=a.url;this.type=a.type;this.isReference=!0===a.isReference?!0:!1;this.opacity=a.opacity;this.visibleLayers=a.visibleLayers;this.displayLevels=a.displayLevels;this.exclusionAreas=a.exclusionAreas;this.bandIds=a.bandIds;this.templateUrl=a.templateUrl;this.copyright=a.copyright;this.subDomains=a.subDomains;this.fullExtent=a.fullExtent;this.initialExtent=a.initialExtent;this.tileInfo=a.tileInfo;this.tileServers=a.tileServers;this.styleUrl=a.styleUrl}});return a("extend-esri")&&k.setObject("dijit.BasemapLayer",
h,f),h})},"cmv/viewer/js/gis/dijit/Basemaps/nls/resource":function(){define({root:{title:"Basemaps"},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/Help":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin gis/dijit/_FloatingWidgetMixin dojo/dom-construct dojo/on dojo/_base/lang dojo/aspect dojo/text!./Help/templates/HelpDialog.html dojo/i18n!./Help/nls/resource dijit/form/Button dijit/layout/TabContainer dijit/layout/ContentPane xstyle/css!./Help/css/Help.css".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c){return h([k,a,f,b],{widgetsInTemplate:!0,templateString:d,i18n:c,html:'\x3ca href\x3d"#"\x3elink\x3c/a\x3e'.replace("link",c.link),domTarget:"helpDijit",draggable:!1,baseClass:"helpDijit",postCreate:function(){this.inherited(arguments);this.parentWidget.draggable=this.draggable;if(this.parentWidget.toggleable)this.own(g.after(this.parentWidget,"toggle",m.hitch(this,function(){this.containerNode.resize()})));else{var a=e.place(this.html,this.domTarget);l(a,"click",m.hitch(this.parentWidget,
"show"))}},onOpen:function(){this.openOnStartup||this.containerNode.resize()},close:function(){this.parentWidget.hide&&this.parentWidget.hide()}})})},"cmv/viewer/js/gis/dijit/_FloatingWidgetMixin":function(){define(["dojo/_base/declare","dojo/on","dojo/_base/lang"],function(h,k,a){return h(null,{startup:function(){this.parentWidget&&"gis.dijit.FloatingWidget"===this.parentWidget.declaredClass&&this.onOpen&&k(this.parentWidget,"show",a.hitch(this,"onOpen"));this.parentWidget&&"gis.dijit.FloatingWidget"===
this.parentWidget.declaredClass&&this.onClose&&k(this.parentWidget,"hide",a.hitch(this,"onClose"));this.parentWidget&&"gis.dijit.FloatingWidget"===this.parentWidget.declaredClass&&this.openOnStartup&&this.parentWidget.show();this.inherited(arguments)}})})},"cmv/viewer/js/gis/dijit/Help/nls/resource":function(){define({root:{link:"Help",navigation:{title:"Navigation",description:"Map navigation using mouse and keyboard:",pan1:"Drag to pan",recenter:"SHIFT + Click to recenter",zoomIn1:"SHIFT + Drag to zoom in",
zoomOut1:"SHIFT + CTRL + Drag to zoom out",zoomIn2:"Mouse Scroll Forward to zoom in",zoomOut2:"Mouse Scroll Backward to zoom out",pan2:"Use Arrow keys to pan",zoomInLevel:"+ key to zoom in a level",zoomOutLevel:"- key to zoom out a level",zoomCenter:"Double Click to Center and Zoom in"},search:{title:"Search",description:"A variety of searches can be performed in the search box:",address:"Search by Address",place:"Search by Place Name",etc:"Search By Zip Code, County, etc."},tools:{title:"Tools",
description:"In addition to Search capabilities, the following tools are provided:",measure:{title:"Measure",description:"The measure tool provides the capabilities to draw a point, line, or polygon on the map and specify the unit of measurement."},print:{title:"Print",description:"This map can be exported to various formats and layouts."}}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"dijit/layout/TabContainer":function(){define(["dojo/_base/lang","dojo/_base/declare","./_TabContainerBase","./TabController",
"./ScrollingTabController"],function(h,k,a,f,b){return k("dijit.layout.TabContainer",a,{useMenu:!0,useSlider:!0,controllerWidget:"",_makeController:function(a){var b=this.baseClass+"-tabs"+(this.doLayout?"":" dijitTabNoLayout");return new ("string"==typeof this.controllerWidget?h.getObject(this.controllerWidget):this.controllerWidget)({id:this.id+"_tablist",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,tabPosition:this.tabPosition,doLayout:this.doLayout,containerId:this.id,
"class":b,nested:this.nested,useMenu:this.useMenu,useSlider:this.useSlider,tabStripClass:this.tabStrip?this.baseClass+(this.tabStrip?"":"No")+"Strip":null},a)},postMixInProperties:function(){this.inherited(arguments);this.controllerWidget||(this.controllerWidget="top"!=this.tabPosition&&"bottom"!=this.tabPosition||this.nested?f:b)}})})},"dijit/layout/_TabContainerBase":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style ./StackContainer ./utils ../_TemplatedMixin dojo/text!./templates/TabContainer.html".split(" "),
function(h,k,a,f,b,e,l,m){return h("dijit.layout._TabContainerBase",[b,l],{tabPosition:"top",baseClass:"dijitTabContainer",tabStrip:!1,nested:!1,templateString:m,postMixInProperties:function(){this.baseClass+=this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"");this.srcNodeRef&&f.set(this.srcNodeRef,"visibility","hidden");this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.tablist=this._makeController(this.tablistNode);this.doLayout||
k.add(this.domNode,"dijitTabContainerNoLayout");this.nested?(k.add(this.domNode,"dijitTabContainerNested"),k.add(this.tablist.containerNode,"dijitTabContainerTabListNested"),k.add(this.tablistSpacer,"dijitTabContainerSpacerNested"),k.add(this.containerNode,"dijitTabPaneWrapperNested")):k.add(this.domNode,"tabStrip-"+(this.tabStrip?"enabled":"disabled"))},_setupChild:function(a){k.add(a.domNode,"dijitTabPane");this.inherited(arguments)},removeChild:function(a){k.remove(a.domNode,"dijitTabPane");this.inherited(arguments)},
startup:function(){this._started||(this.tablist.startup(),this.inherited(arguments))},layout:function(){if(this._contentBox&&"undefined"!=typeof this._contentBox.l){var b=this.selectedChildWidget;if(this.doLayout){var d=this.tabPosition.replace(/-h/,"");this.tablist.region=d;d=[this.tablist,{domNode:this.tablistSpacer,region:d},{domNode:this.containerNode,region:"center"}];e.layoutChildren(this.domNode,this._contentBox,d);this._containerContentBox=e.marginBox2contentBox(this.containerNode,d[2]);b&&
b.resize&&b.resize(this._containerContentBox)}else{if(this.tablist.resize){d=this.tablist.domNode.style;d.width="0";var c=a.getContentBox(this.domNode).w;d.width="";this.tablist.resize({w:c})}b&&b.resize&&b.resize()}}},destroy:function(a){this.tablist&&this.tablist.destroy(a);this.inherited(arguments)}})})},"dijit/layout/StackContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/ready dojo/topic dojo/when ../registry ../_WidgetBase ./_LayoutWidget".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t){e("dijit-legacy-requires")&&g(0,function(){require(["dijit/layout/StackController"])});a=a("dijit.layout.StackContainer",t,{doLayout:!0,persist:!1,baseClass:"dijitStackContainer",buildRendering:function(){this.inherited(arguments);f.add(this.domNode,"dijitLayoutContainer")},postCreate:function(){this.inherited(arguments);this.own(m(this.domNode,"keydown",l.hitch(this,"_onKeyDown")))},startup:function(){if(!this._started){var a=this.getChildren();h.forEach(a,this._setupChild,
this);this.persist?this.selectedChildWidget=n.byId(k(this.id+"_selectedChild")):h.some(a,function(a){a.selected&&(this.selectedChildWidget=a);return a.selected},this);var b=this.selectedChildWidget;!b&&a[0]&&(b=this.selectedChildWidget=a[0],b.selected=!0);d.publish(this.id+"-startup",{children:a,selected:b,textDir:this.textDir});this.inherited(arguments)}},resize:function(){if(!this._hasBeenShown){this._hasBeenShown=!0;var a=this.selectedChildWidget;a&&this._showChild(a)}this.inherited(arguments)},
_setupChild:function(a){var c=a.domNode,d=b.place("\x3cdiv role\x3d'tabpanel' class\x3d'"+this.baseClass+"ChildWrapper dijitHidden'\x3e",a.domNode,"replace"),e=a["aria-label"]||a.title||a.label;e&&d.setAttribute("aria-label",e);b.place(c,d);a._wrapper=d;this.inherited(arguments);"none"==c.style.display&&(c.style.display="block");a.domNode.removeAttribute("title")},addChild:function(a,b){this.inherited(arguments);this._started&&(d.publish(this.id+"-addChild",a,b),this.layout(),this.selectedChildWidget||
this.selectChild(a))},removeChild:function(a){var c=h.indexOf(this.getChildren(),a);this.inherited(arguments);b.destroy(a._wrapper);delete a._wrapper;this._started&&d.publish(this.id+"-removeChild",a);if(!this._descendantsBeingDestroyed){if(this.selectedChildWidget===a&&(this.selectedChildWidget=void 0,this._started)){var e=this.getChildren();e.length&&this.selectChild(e[Math.max(c-1,0)])}this._started&&this.layout()}},selectChild:function(a,b){var e;a=n.byId(a);this.selectedChildWidget!=a&&(e=this._transition(a,
this.selectedChildWidget,b),this._set("selectedChildWidget",a),d.publish(this.id+"-selectChild",a,this._focused),this.persist&&k(this.id+"_selectedChild",this.selectedChildWidget.id));return c(e||!0)},_transition:function(a,b){b&&this._hideChild(b);var c=this._showChild(a);a.resize&&(this.doLayout?a.resize(this._containerContentBox||this._contentBox):a.resize());return c},_adjacent:function(a){var b=this.getChildren(),c=h.indexOf(b,this.selectedChildWidget),c=c+(a?1:b.length-1);return b[c%b.length]},
forward:function(){return this.selectChild(this._adjacent(!0),!0)},back:function(){return this.selectChild(this._adjacent(!1),!0)},_onKeyDown:function(a){d.publish(this.id+"-containerKeyDown",{e:a,page:this})},layout:function(){var a=this.selectedChildWidget;a&&a.resize&&(this.doLayout?a.resize(this._containerContentBox||this._contentBox):a.resize())},_showChild:function(a){var b=this.getChildren();a.isFirstChild=a==b[0];a.isLastChild=a==b[b.length-1];a._set("selected",!0);a._wrapper&&f.replace(a._wrapper,
"dijitVisible","dijitHidden");return a._onShow&&a._onShow()||!0},_hideChild:function(a){a._set("selected",!1);a._wrapper&&f.replace(a._wrapper,"dijitHidden","dijitVisible");a.onHide&&a.onHide()},closeChild:function(a){if(!a.onClose||a.onClose(this,a))this.removeChild(a),a.destroyRecursive()},destroyDescendants:function(a){this._descendantsBeingDestroyed=!0;this.selectedChildWidget=void 0;h.forEach(this.getChildren(),function(b){a||this.removeChild(b);b.destroyRecursive(a)},this);this._descendantsBeingDestroyed=
!1}});a.ChildWidgetProperties={selected:!1,disabled:!1,closable:!1,iconClass:"dijitNoIcon",showTitle:!0};l.extend(q,a.ChildWidgetProperties);return a})},"dijit/layout/TabController":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/has dojo/i18n dojo/_base/lang ./StackController ../registry ../Menu ../MenuItem dojo/text!./templates/_TabButton.html dojo/i18n!../nls/common".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n){n=h("dijit.layout._TabButton"+(b("dojo-bidi")?"_NoBidi":
""),m.StackButton,{baseClass:"dijitTab",cssStateNodes:{closeNode:"dijitTabCloseButton"},templateString:n,_setNameAttr:"focusNode",scrollOnFocus:!1,buildRendering:function(){this.inherited(arguments);k.setSelectable(this.containerNode,!1)},startup:function(){this.inherited(arguments);var a=this.domNode;this.defer(function(){a.className=a.className},1)},_setCloseButtonAttr:function(b){this._set("closeButton",b);f.toggle(this.domNode,"dijitClosable",b);this.closeNode.style.display=b?"":"none";b&&(b=
e.getLocalization("dijit","common"),this.closeNode&&a.set(this.closeNode,"title",b.itemClose))},_setDisabledAttr:function(b){this.inherited(arguments);if(this.closeNode)if(b)a.remove(this.closeNode,"title");else{var c=e.getLocalization("dijit","common");a.set(this.closeNode,"title",c.itemClose)}},_setLabelAttr:function(a){this.inherited(arguments);this.showLabel||this.params.title||(this.iconNode.alt=l.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});b("dojo-bidi")&&(n=h("dijit.layout._TabButton",
n,{_setLabelAttr:function(a){this.inherited(arguments);this.applyTextDir(this.iconNode,this.iconNode.alt)}}));h=h("dijit.layout.TabController",m,{baseClass:"dijitTabController",templateString:"\x3cdiv role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown:onkeydown'\x3e\x3c/div\x3e",tabPosition:"top",buttonWidget:n,buttonWidgetCloseClass:"dijitTabCloseButton",postCreate:function(){this.inherited(arguments);var a=new d({id:this.id+"_Menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,
textDir:this.textDir,targetNodeIds:[this.domNode],selector:function(a){return f.contains(a,"dijitClosable")&&!f.contains(a,"dijitTabDisabled")}});this.own(a);var b=e.getLocalization("dijit","common"),l=this;a.addChild(new c({label:b.itemClose,ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,onClick:function(a){a=g.byNode(this.getParent().currentTarget);l.onCloseButtonClick(a.page)}}))}});h.TabButton=n;return h})},"dijit/layout/StackController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/topic ../focus ../registry ../_Widget ../_TemplatedMixin ../_Container ../form/ToggleButton dojo/touch".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t){f=k("dijit.layout._StackButton",t,{tabIndex:"-1",closeButton:!1,_aria_attr:"aria-selected",buildRendering:function(a){this.inherited(arguments);(this.focusNode||this.domNode).setAttribute("role","tab")}});k=k("dijit.layout.StackController",[c,n,q],{baseClass:"dijitStackController",templateString:"\x3cspan role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown'\x3e\x3c/span\x3e",containerId:"",buttonWidget:f,buttonWidgetCloseClass:"dijitStackCloseButton",pane2button:function(a){return d.byId(this.id+
"_"+a)},postCreate:function(){this.inherited(arguments);this.own(m.subscribe(this.containerId+"-startup",e.hitch(this,"onStartup")),m.subscribe(this.containerId+"-addChild",e.hitch(this,"onAddChild")),m.subscribe(this.containerId+"-removeChild",e.hitch(this,"onRemoveChild")),m.subscribe(this.containerId+"-selectChild",e.hitch(this,"onSelectChild")),m.subscribe(this.containerId+"-containerKeyDown",e.hitch(this,"onContainerKeyDown")));this.containerNode.dojoClick=!0;this.own(l(this.containerNode,"click",
e.hitch(this,function(b){var c=d.getEnclosingWidget(b.target);if(c!=this.containerNode&&!c.disabled&&c.page)for(b=b.target;b!==this.containerNode;b=b.parentNode)if(a.contains(b,this.buttonWidgetCloseClass)){this.onCloseButtonClick(c.page);break}else if(b==c.domNode){this.onButtonClick(c.page);break}})))},onStartup:function(a){this.textDir=a.textDir;h.forEach(a.children,this.onAddChild,this);if(a.selected)this.onSelectChild(a.selected);var b=d.byId(this.containerId).containerNode,c=e.hitch(this,"pane2button");
a={title:"label",showtitle:"showLabel",iconclass:"iconClass",closable:"closeButton",tooltip:"title",disabled:"disabled",textdir:"textdir"};var f=function(a,d){return l(b,"attrmodified-"+a,function(a){var b=c(a.detail&&a.detail.widget&&a.detail.widget.id);b&&b.set(d,a.detail.newValue)})},g;for(g in a)this.own(f(g,a[g]))},destroy:function(a){this.destroyDescendants(a);this.inherited(arguments)},onAddChild:function(a,b){var c=new (e.isString(this.buttonWidget)?e.getObject(this.buttonWidget):this.buttonWidget)({id:this.id+
"_"+a.id,name:this.id+"_"+a.id,label:a.title,disabled:a.disabled,ownerDocument:this.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir||this.textDir,showLabel:a.showTitle,iconClass:a.iconClass,closeButton:a.closable,title:a.tooltip,page:a});this.addChild(c,b);a.controlButton=c;if(!this._currentChild)this.onSelectChild(a);c=a._wrapper.getAttribute("aria-labelledby")?a._wrapper.getAttribute("aria-labelledby")+" "+c.id:c.id;a._wrapper.removeAttribute("aria-label");a._wrapper.setAttribute("aria-labelledby",
c)},onRemoveChild:function(a){this._currentChild===a&&(this._currentChild=null);var b=this.pane2button(a.id);b&&(this.removeChild(b),b.destroy());delete a.controlButton},onSelectChild:function(a){if(a){if(this._currentChild){var b=this.pane2button(this._currentChild.id);b.set("checked",!1);b.focusNode.setAttribute("tabIndex","-1")}b=this.pane2button(a.id);b.set("checked",!0);this._currentChild=a;b.focusNode.setAttribute("tabIndex","0");d.byId(this.containerId)}},onButtonClick:function(a){var b=this.pane2button(a.id);
g.focus(b.focusNode);this._currentChild&&this._currentChild.id===a.id&&b.set("checked",!0);d.byId(this.containerId).selectChild(a)},onCloseButtonClick:function(a){d.byId(this.containerId).closeChild(a);this._currentChild&&(a=this.pane2button(this._currentChild.id))&&g.focus(a.focusNode||a.domNode)},adjacent:function(a){this.isLeftToRight()||this.tabPosition&&!/top|bottom/.test(this.tabPosition)||(a=!a);var b=this.getChildren(),c=h.indexOf(b,this.pane2button(this._currentChild.id)),d=b[c],e;do c=(c+
(a?1:b.length-1))%b.length,e=b[c];while(e.disabled&&e!=d);return e},onkeydown:function(a,c){if(!this.disabled&&!a.altKey){var d=null;if(a.ctrlKey||!a._djpage){switch(a.keyCode){case b.LEFT_ARROW:case b.UP_ARROW:a._djpage||(d=!1);break;case b.PAGE_UP:a.ctrlKey&&(d=!1);break;case b.RIGHT_ARROW:case b.DOWN_ARROW:a._djpage||(d=!0);break;case b.PAGE_DOWN:a.ctrlKey&&(d=!0);break;case b.HOME:for(var e=this.getChildren(),f=0;f<e.length;f++){var g=e[f];if(!g.disabled){this.onButtonClick(g.page);break}}a.stopPropagation();
a.preventDefault();break;case b.END:e=this.getChildren();for(f=e.length-1;0<=f;f--)if(g=e[f],!g.disabled){this.onButtonClick(g.page);break}a.stopPropagation();a.preventDefault();break;case b.DELETE:case 87:this._currentChild.closable&&(a.keyCode==b.DELETE||a.ctrlKey)&&(this.onCloseButtonClick(this._currentChild),a.stopPropagation(),a.preventDefault());break;case b.TAB:a.ctrlKey&&(this.onButtonClick(this.adjacent(!a.shiftKey).page),a.stopPropagation(),a.preventDefault())}null!==d&&(this.onButtonClick(this.adjacent(d).page),
a.stopPropagation(),a.preventDefault())}}},onContainerKeyDown:function(a){a.e._djpage=a.page;this.onkeydown(a.e)}});k.StackButton=f;return k})},"dijit/layout/ScrollingTabController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/_base/lang dojo/on dojo/query dojo/sniff ../registry dojo/text!./templates/ScrollingTabController.html dojo/text!./templates/_ScrollingTabControllerButton.html ./TabController ./utils ../_WidgetsInTemplateMixin ../Menu ../MenuItem ../form/Button ../_HasDropDown dojo/NodeList-dom ../a11yclick".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y){n=k("dijit.layout.ScrollingTabController",[t,v],{baseClass:"dijitTabController dijitScrollingTabController",templateString:n,useMenu:!0,useSlider:!0,tabStripClass:"",_minScroll:5,_setClassAttr:{node:"containerNode",type:"class"},buildRendering:function(){this.inherited(arguments);var b=this.domNode;this.scrollNode=this.tablistWrapper;this._initButtons();this.tabStripClass||(this.tabStripClass="dijitTabContainer"+this.tabPosition.charAt(0).toUpperCase()+
this.tabPosition.substr(1).replace(/-.*/,"")+"None",a.add(b,"tabStrip-disabled"));a.add(this.tablistWrapper,this.tabStripClass)},onStartup:function(){this.inherited(arguments);b.set(this.domNode,"visibility","");this._postStartup=!0;this.own(m(this.containerNode,"attrmodified-label, attrmodified-iconclass",l.hitch(this,function(a){this._dim&&this.resize(this._dim)})))},onAddChild:function(a,c){this.inherited(arguments);b.set(this.containerNode,"width",b.get(this.containerNode,"width")+200+"px")},
onRemoveChild:function(a,b){var c=this.pane2button(a.id);this._selectedTab===c.domNode&&(this._selectedTab=null);this.inherited(arguments)},_initButtons:function(){this._btnWidth=0;this._buttons=g("\x3e .tabStripButton",this.domNode).filter(function(a){if(this.useMenu&&a==this._menuBtn.domNode||this.useSlider&&(a==this._rightBtn.domNode||a==this._leftBtn.domNode))return this._btnWidth+=f.getMarginSize(a).w,!0;b.set(a,"display","none");return!1},this)},_getTabsWidth:function(){var a=this.getChildren();
if(a.length){var b=a[this.isLeftToRight()?0:a.length-1].domNode,a=a[this.isLeftToRight()?a.length-1:0].domNode;return a.offsetLeft+a.offsetWidth-b.offsetLeft}return 0},_enableBtn:function(a){var c=this._getTabsWidth();a=a||b.get(this.scrollNode,"width");return 0<c&&a<c},resize:function(a){this._dim=a;this.scrollNode.style.height="auto";var b=this._contentBox=r.marginBox2contentBox(this.domNode,{h:0,w:a.w});b.h=this.scrollNode.offsetHeight;f.setContentSize(this.domNode,b);b=this._enableBtn(this._contentBox.w);
this._buttons.style("display",b?"":"none");this._leftBtn.region="left";this._rightBtn.region="right";this._menuBtn.region=this.isLeftToRight()?"right":"left";r.layoutChildren(this.domNode,this._contentBox,[this._menuBtn,this._leftBtn,this._rightBtn,{domNode:this.scrollNode,region:"center"}]);this._selectedTab&&(this._anim&&"playing"==this._anim.status()&&this._anim.stop(),this.scrollNode.scrollLeft=this._convertToScrollLeft(this._getScrollForSelectedTab()));this._setButtonClass(this._getScroll());
this._postResize=!0;return{h:this._contentBox.h,w:a.w}},_getScroll:function(){return this.isLeftToRight()||8>d("ie")||d("trident")&&d("quirks")||d("webkit")?this.scrollNode.scrollLeft:b.get(this.containerNode,"width")-b.get(this.scrollNode,"width")+(d("trident")||d("edge")?-1:1)*this.scrollNode.scrollLeft},_convertToScrollLeft:function(a){if(this.isLeftToRight()||8>d("ie")||d("trident")&&d("quirks")||d("webkit"))return a;var c=b.get(this.containerNode,"width")-b.get(this.scrollNode,"width");return(d("trident")||
d("edge")?-1:1)*(a-c)},onSelectChild:function(a,c){var d=this.pane2button(a.id);if(d){var e=d.domNode;if(e!=this._selectedTab&&(this._selectedTab=e,this._postResize)){var f=this._getScroll();f>e.offsetLeft||f+b.get(this.scrollNode,"width")<e.offsetLeft+b.get(e,"width")?(e=this.createSmoothScroll(),c&&(e.onEnd=function(){d.focus()}),e.play()):c&&d.focus()}this.inherited(arguments)}},_getScrollBounds:function(){var a=this.getChildren(),c=b.get(this.scrollNode,"width"),d=b.get(this.containerNode,"width")-
c,e=this._getTabsWidth();if(a.length&&e>c)return{min:this.isLeftToRight()?0:a[a.length-1].domNode.offsetLeft,max:this.isLeftToRight()?a[a.length-1].domNode.offsetLeft+a[a.length-1].domNode.offsetWidth-c:d};a=this.isLeftToRight()?0:d;return{min:a,max:a}},_getScrollForSelectedTab:function(){var a=this._selectedTab,c=b.get(this.scrollNode,"width"),d=this._getScrollBounds(),a=a.offsetLeft+b.get(a,"width")/2-c/2;return a=Math.min(Math.max(a,d.min),d.max)},createSmoothScroll:function(a){if(0<arguments.length){var b=
this._getScrollBounds();a=Math.min(Math.max(a,b.min),b.max)}else a=this._getScrollForSelectedTab();this._anim&&"playing"==this._anim.status()&&this._anim.stop();var c=this,d=this.scrollNode,f=new e.Animation({beforeBegin:function(){this.curve&&delete this.curve;var b=d.scrollLeft,g=c._convertToScrollLeft(a);f.curve=new e._Line(b,g)},onAnimate:function(a){d.scrollLeft=a}});this._anim=f;this._setButtonClass(a);return f},_getBtnNode:function(b){for(b=b.target;b&&!a.contains(b,"tabStripButton");)b=b.parentNode;
return b},doSlideRight:function(a){this.doSlide(1,this._getBtnNode(a))},doSlideLeft:function(a){this.doSlide(-1,this._getBtnNode(a))},doSlide:function(c,d){if(!d||!a.contains(d,"dijitTabDisabled")){var e=.75*b.get(this.scrollNode,"width")*c,e=this._getScroll()+e;this._setButtonClass(e);this.createSmoothScroll(e).play()}},_setButtonClass:function(a){var b=this._getScrollBounds();this._leftBtn.set("disabled",a<=b.min);this._rightBtn.set("disabled",a>=b.max)}});q=k("dijit.layout._ScrollingTabControllerButtonMixin",
null,{baseClass:"dijitTab tabStripButton",templateString:q,tabIndex:"",isFocusable:function(){return!1}});k("dijit.layout._ScrollingTabControllerButton",[x,q]);k("dijit.layout._ScrollingTabControllerMenuButton",[x,y,q],{containerId:"",tabIndex:"-1",isLoaded:function(){return!1},loadDropDown:function(a){this.dropDown=new u({id:this.containerId+"_menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir});var b=c.byId(this.containerId);h.forEach(b.getChildren(),function(a){var c=
new w({id:a.id+"_stcMi",label:a.title,iconClass:a.iconClass,disabled:a.disabled,ownerDocument:this.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir||b.textDir,onClick:function(){b.selectChild(a)}});this.dropDown.addChild(c)},this);a()},closeDropDown:function(a){this.inherited(arguments);this.dropDown&&(this._popupStateNode.removeAttribute("aria-owns"),this.dropDown.destroyRecursive(),delete this.dropDown)}});return n})},"cmv/viewer/js/gis/dijit/Bookmarks":function(){define("dojo/_base/declare dijit/_WidgetBase esri/dijit/Bookmarks dojo/json dojo/cookie dojo/_base/lang xstyle/css!./Bookmarks/css/Bookmarks.css".split(" "),
function(h,k,a,f,b,e){return h([k],{declaredClass:"gis.digit.Bookmarks",postCreate:function(){this.inherited(arguments);var l=this.bookmarks;this.bookmarkItems=b("bookmarkItems");this.bookmarkItems=void 0===this.bookmarkItems?[]:f.parse(this.bookmarkItems);this.bookmarks=new a({map:this.map,id:this.id+"_esri",editable:this.editable,bookmarks:e.mixin(this.bookmarkItems,l)},this.domNode);this.connect(this.bookmarks,"onEdit","setBookmarks");this.connect(this.bookmarks,"onRemove","setBookmarks")},setBookmarks:function(){b("bookmarkItems",
f.stringify(this.bookmarks.toJson()),{expires:365})},_export:function(){return f.stringify(this.bookmarks.toJson())}})})},"esri/dijit/Bookmarks":function(){define("dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/has dojo/keys dojo/on dojo/query dojo/window dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dnd/Avatar dojo/dnd/Source dojo/i18n!../nls/jsapi dijit/a11yclick dijit/_WidgetBase ../kernel ../domUtils ../Evented ../geometry/Extent ./BookmarkItem".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B){a=a([w,A],{declaredClass:"esri.dijit.Bookmarks",bookmarks:[],bookmarkDomNode:null,bookmarkTable:null,initBookmarks:null,editable:null,map:null,_oldGenerateText:null,_customGenerateText:!1,_LTR:!0,_dndSource:null,_inputBox:null,_label:null,_css:{esriBookmarks:"esriBookmarks",esriBookmarksRTL:"esriBookmarksRTL",esriBookmarkList:"esriBookmarkList",esriBookmarkTable:"esriBookmarkTable",esriBookmarkEditImage:"esriBookmarkEditImage",esriBookmarkRemoveImage:"esriBookmarkRemoveImage",
esriBookmarkLabel:"esriBookmarkLabel",esriBookmarkItem:"esriBookmarkItem",esriBookmarkHighlight:"esriBookmarkHighlight",esriAddBookmark:"esriAddBookmark",esriBookmarkEditBox:"esriBookmarkEditBox"},_clickHandlers:[],_mouseOverHandlers:[],_mouseOutHandlers:[],_removeHandlers:[],_editHandlers:[],_dndHandlers:[],_eventMap:{click:!0,edit:!0,remove:!0},onClick:function(){},onEdit:function(){},onRemove:function(){},constructor:function(a,b){this.map=a.map;this.editable=a.editable;this.initBookmarks=a.bookmarks;
delete a.bookmarks;this.bookmarkDomNode=n.create("div");c.add(this.bookmarkDomNode,this._css.esriBookmarkList);this.bookmarkTable=n.create("div");c.add(this.bookmarkTable,this._css.esriBookmarkTable);this.bookmarkDomNode.appendChild(this.bookmarkTable);b=d.byId(b);b.appendChild(this.bookmarkDomNode);this.srcNodeRef=b;c.add(this.srcNodeRef,this._css.esriBookmarks);(this._LTR=this.isLeftToRight())||c.add(this.srcNodeRef,this._css.esriBookmarksRTL);this._dndSource=new r(this.bookmarkTable,{creator:this._avatarCreator,
singular:!0,checkAcceptance:function(a,b){return this===a?!0:!1}});this._dndSourceNodes=this._dndSource.getAllNodes();this._dndHandlers.push(l(this._dndSource,"DndStart",f.hitch(this,function(a){a===this._dndSource&&(this._oldGenerateText=t.prototype._generateText,t.prototype._generateText=f.hitch(this,this._generateText),this._customGenerateText=!0,this._inputBox&&this._inputBox.blur())})));this._dndHandlers.push(l(this._dndSource,"DndDrop",f.hitch(this,function(a){a===this._dndSource&&(this._syncBookmarksAfterReorder(),
this.emit("reorder",this.bookmarks))})));this._dndHandlers.push(l(this._dndSource,"DndCancel",f.hitch(this,function(){this._customGenerateText&&(t.prototype._generateText=this._oldGenerateText,this._customGenerateText=!1)})));this._addInitialBookmarks()},destroy:function(){this.map=null;h.forEach(this._clickHandlers,function(a){k.disconnect(a)});h.forEach(this._mouseOverHandlers,function(a){k.disconnect(a)});h.forEach(this._mouseOutHandlers,function(a){k.disconnect(a)});h.forEach(this._removeHandlers,
function(a){k.disconnect(a)});h.forEach(this._editHandlers,function(a){k.disconnect(a)});n.destroy(this.bookmarkDomNode)},addBookmark:function(a){var b,d,e,l,h,q,r,t;"esri.dijit.BookmarkItem"===a.declaredClass?b=a:(d=new z(a.extent),b=new B({name:a.name,extent:d}));this.editable?(l=v.widgets.bookmarks,h=l.NLS_bookmark_edit,q=l.NLS_bookmark_remove,e=n.create("div",{innerHTML:'\x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d\'esriBookmarkLabel\'\x3e'+a.name+'\x3c/div\x3e\x3cdiv tabindex\x3d"0" role\x3d"button" title\x3d\''+
q+"' class\x3d'esriBookmarkRemoveImage'\x3e\x3cbr/\x3e\x3c/div\x3e\x3cdiv tabindex\x3d\"0\" role\x3d\"button\" title\x3d'"+h+"' class\x3d'esriBookmarkEditImage'\x3e\x3cbr/\x3e\x3c/div\x3e"}),r=m(".esriBookmarkEditImage",e)[0],t=m(".esriBookmarkRemoveImage",e)[0],this._removeHandlers.push(k.connect(t,u,this,"_removeBookmark")),this._editHandlers.push(k.connect(r,u,this,"_editBookmarkLabel"))):e=n.create("div",{innerHTML:"\x3cdiv tabindex\x3d\"0\" class\x3d'esriBookmarkLabel'\x3e"+a.name+"\x3c/div\x3e"});
c.add(e,this._css.esriBookmarkItem);"esri.geometry.Extent"===a.extent.declaredClass||new z(a.extent);d=m(".esriBookmarkLabel",e)[0];this._clickHandlers.push(k.connect(d,u,f.hitch(this,"_onClickHandler",a)));this._mouseOverHandlers.push(k.connect(e,"onmouseover",f.hitch(this,function(){c.add(e,this._css.esriBookmarkHighlight)})));this._mouseOutHandlers.push(k.connect(e,"onmouseout",f.hitch(this,function(){c.remove(e,this._css.esriBookmarkHighlight)})));this.bookmarks.push(b);this._dndSource.insertNodes(!1,
[e]);this._dndSourceNodes=this._dndSource.getAllNodes();g.scrollIntoView(e);this._syncBookmarksAfterReorder()},removeBookmark:function(a){this._inputBox&&this._inputBox.blur();var b;b=m(".esriBookmarkLabel",this.bookmarkDomNode);b=h.filter(b,function(b){return b.innerHTML===a});h.forEach(b,function(a){a.parentNode.parentNode.parentNode.removeChild(a.parentNode.parentNode)});for(b=this.bookmarks.length-1;0<=b;b--)this.bookmarks[b].name===a&&this.bookmarks.splice(b,1);this.onRemove()},hide:function(){y.hide(this.bookmarkDomNode)},
show:function(){y.show(this.bookmarkDomNode)},_addInitialBookmarks:function(){if(this.editable){var a=n.create("div",{tabIndex:0,role:"button",innerHTML:"\x3cdiv\x3e"+v.widgets.bookmarks.NLS_add_bookmark+"\x3c/div\x3e"});c.add(a,this._css.esriBookmarkItem);c.add(a,this._css.esriAddBookmark);this._clickHandlers.push(k.connect(a,u,this,this._newBookmark));this._mouseOverHandlers.push(k.connect(a,"onmouseover",f.hitch(this,function(){c.add(a,this._css.esriBookmarkHighlight)})));this._mouseOutHandlers.push(k.connect(a,
"onmouseout",f.hitch(this,function(){c.remove(a,this._css.esriBookmarkHighlight)})));this.srcNodeRef.appendChild(a)}this.bookmarks=[];h.forEach(this.initBookmarks,function(a){this.addBookmark(a)},this)},_newBookmark:function(){var a,b,c,d,e,f,g,l,h=this.map,n=v.widgets.bookmarks.NLS_new_bookmark,k=h.extent;h.spatialReference._isWrappable()?(a=z.prototype._normalizeX(k.xmin,h.spatialReference._getInfo()).x,b=z.prototype._normalizeX(k.xmax,h.spatialReference._getInfo()).x,a>b?(g=h.spatialReference.isWebMercator(),
c=g?2.0037508342788905E7:180,d=g?-2.0037508342788905E7:-180,Math.abs(a-c)>Math.abs(b-d)?(e=a,f=c):(e=d,f=b),l=new z(e,k.ymin,f,k.ymax,h.spatialReference)):l=new z(a,k.ymin,b,k.ymax,h.spatialReference)):l=k;a=new B({name:n,extent:l});this.addBookmark(a);a=m(".esriBookmarkItem",this.bookmarkDomNode);b=a[a.length-1];a={target:{parentNode:null}};a.target.parentNode=b;this._editBookmarkLabel(a)},_removeBookmark:function(a){a.target.parentNode.parentNode.parentNode.removeChild(a.target.parentNode.parentNode);
this.removeBookmark(a.target.parentNode.textContent)},_syncBookmarksAfterReorder:function(){var a=[],b=this._dndSource.getAllNodes();h.forEach(b,f.hitch(this,function(b){var c=this._dndSourceNodes.map(function(a,c){return a===b?c:void 0}).filter(isFinite)[0];a.push(this.bookmarks[c])}));this.bookmarks=a;this._dndSourceNodes=b},_generateText:function(){return this._dndSource&&this._dndSource.getSelectedNodes()[0]&&this._dndSource.getSelectedNodes()[0].firstChild.firstChild.innerHTML?this._dndSource.getSelectedNodes()[0].firstChild.firstChild.innerHTML:
""},_editBookmarkLabel:function(a){this._inputBox&&this._inputBox.blur();var b;b=v.widgets.bookmarks.NLS_new_bookmark;a=a.target.parentNode;var c=a.firstChild||m(".esriBookmarkLabel",a)[0],d=q.position(a,!0),g=d.y;this._label=c;this._inputBox=n.create("input",{className:"esriBookmarkEditBox",value:c.innerHTML!==b?c.textContent:"",style:{top:g+"px",left:this._LTR?d.x+"px":"0px"}},this.srcNodeRef);l(this._inputBox,"keyup",f.hitch(this,function(a){switch(a.keyCode){case e.ENTER:this._inputBox.blur()}}));
l(this._inputBox,"focus",f.hitch(this,function(){this.map&&"function"==typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation()}));l(this._inputBox,"blur",f.hitch(this,function(){this.map&&"function"==typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();this._finishEdit()}));this._inputBox.focus();this._inputBox.select();b=q.position(a,!0);this._inputBox.style.left=this._LTR?b.x+"px":"0px";this._inputBox.style.top=b.y+"px"},_finishEdit:function(){if(this._inputBox){var a=
v.widgets.bookmarks.NLS_new_bookmark,b=m(".esriBookmarkLabel",this.bookmarkDomNode),c=this._inputBox.value;if(c===this._label.innerHTML)return this._inputBox.parentNode.removeChild(this._inputBox),void(this._inputBox=null);this._label.textContent=""!==c?c:a;h.forEach(this.bookmarks,function(a,c){a&&b[c]&&(a.name=b[c].innerHTML)});this._inputBox.parentNode.removeChild(this._inputBox);this._inputBox=null;this.onEdit()}},_avatarCreator:function(a,b){var d=n.create("div");return d.id=dojo.dnd.getUniqueId(),
c.add(d,"dojoDndItem"),"avatar"!==b&&n.place(a,d),{node:d,data:a,type:"something"}},_onClickHandler:function(a){var b=a.extent;a.extent.declaredClass||(b=new z(a.extent));this.map.setExtent(b);this.onClick()},toJson:function(){var a=[];return h.forEach(this.bookmarks,function(b){b&&a.push(b.toJson())}),a}});return b("extend-esri")&&f.setObject("dijit.Bookmarks",a,x),a})},"esri/dijit/BookmarkItem":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=
h(null,{declaredClass:"esri.dijit.BookmarkItem",constructor:function(a){this.name=a.name;this.extent=a.extent},toJson:function(){var a={},e=this.extent.toJson();return a.extent={spatialReference:e.spatialReference,xmax:e.xmax,xmin:e.xmin,ymax:e.ymax,ymin:e.ymin},a.name=this.name,a}});return a("extend-esri")&&k.setObject("dijit.BookmarkItem",h,f),h})},"cmv/viewer/js/gis/dijit/Find":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/dom-construct dojo/_base/lang dojo/_base/array dojo/on dojo/keys dojo/dom-style dojo/store/Memory dgrid/OnDemandGrid dgrid/Selection dgrid/Keyboard dgrid/extensions/ColumnResizer esri/layers/GraphicsLayer esri/symbols/jsonUtils esri/graphicsUtils esri/tasks/FindTask esri/tasks/FindParameters esri/geometry/Extent dojo/text!./Find/templates/Find.html dojo/i18n!./Find/nls/resource dijit/form/Form dijit/form/DropDownButton dijit/TooltipDialog dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/form/CheckBox dijit/form/Button xstyle/css!./Find/css/Find.css".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B){return h([k,a,f],{widgetsInTemplate:!0,templateString:z,baseClass:"gis_AdvancedFindDijit",i18n:B,spatialReference:null,showOptionsButton:!1,zoomOptions:{select:!0,deselect:!1},defaultResultsSymbols:{point:{type:"esriSMS",style:"esriSMSCircle",size:25,color:[0,255,255,32],angle:0,xoffset:0,yoffset:0,outline:{type:"esriSLS",style:"esriSLSSolid",color:[0,255,255,255],width:2}},polyline:{type:"esriSLS",style:"esriSLSSolid",color:[0,255,255,255],
width:3},polygon:{type:"esriSFS",style:"esriSFSSolid",color:[0,255,255,32],outline:{type:"esriSLS",style:"esriSLSSolid",color:[0,255,255,255],width:3}}},defaultSelectionSymbols:{point:{type:"esriSMS",style:"esriSMSCircle",size:25,color:[4,156,219,32],angle:0,xoffset:0,yoffset:0,outline:{type:"esriSLS",style:"esriSLSSolid",color:[4,156,219,255],width:2}},polyline:{type:"esriSLS",style:"esriSLSSolid",color:[4,156,219,255],width:3},polygon:{type:"esriSFS",style:"esriSFSSolid",color:[4,156,219,32],outline:{type:"esriSLS",
style:"esriSLSSolid",color:[4,156,219,255],width:3}}},postCreate:function(){this.inherited(arguments);this.showOptionsButton&&d.set(this.optionsDropDownDijit.domNode,"display","inline-block");this.initializeGlobalVariables();this.addKeyUpHandlerToSearchInput();this.initializeQueries();this.updateSearchPrompt()},initializeGlobalVariables:function(){this.queryIdx=0;this.currentQueryEventHandlers=[];this.gridColumns=null;this.selectionMode||(this.selectionMode="single");this.zoomExtentFactor||(this.zoomExtentFactor=
1.5);this.spatialReference||(this.spatialReference=this.map.spatialReference.wkid);this.pointExtentSize||(this.pointExtentSize=4326===this.spatialReference?1E-4:25)},addKeyUpHandlerToSearchInput:function(){this.own(m(this.searchTextDijit,"keyup",e.hitch(this,function(a){a.keyCode===g.ENTER&&this.search()})))},initializeQueries:function(){for(var a=0,b=this.queries.length,a=0;a<b;a++)this.queries[a].id=a;this.querySelectDom.style.display="none";1<b&&(a=new c({data:this.queries}),this.querySelectDijit.set("store",
a),this.querySelectDijit.set("value",this.queryIdx),this.querySelectDom.style.display="block")},search:function(){this.userInputIsInvalid()?this.displayInvalidUserInputMessage():this.queryConfigurationIsInvalid()?this.displayInvalidQueryConfigurationMessage():(this.createOrResetResultsGrid(),this.displayFindMessage(this.i18n.searching),this.executeFindTask())},executeFindTask:function(){var a=this.getQueryInput().query.url,b=this.getFindParams();(new x(a)).execute(b,e.hitch(this,this.showResults))},
getQueryInput:function(){return{query:this.queries[this.queryIdx]||{},searchText:this.searchTextDijit.get("value")}},queryConfigurationIsInvalid:function(){var a=this.getQueryInput().query;return a.url&&a.searchFields&&a.layerIds?!1:!0},userInputIsInvalid:function(){return 0===this.getQueryInput().searchText.length||this.userInputLessThanMinLength()?!0:!1},userInputLessThanMinLength:function(){var a=this.getQueryInput();return a.query.minChars&&a.searchText.length<a.query.minChars?!0:!1},displayInvalidQueryConfigurationMessage:function(){this.displayFindMessage("There is a problem with the query configuration.")},
displayInvalidUserInputMessage:function(){var a=this.getQueryInput().query.minChars;this.displayFindMessage("You must enter at least "+a+" characters.")},displayFindMessage:function(a){b.empty(this.findResultsNode);this.findResultsNode.innerHTML=a;this.findResultsNode.style.display="block"},getFindParams:function(){var a=this.getQueryInput(),b=new y;b.returnGeometry=!0;b.layerIds=a.query.layerIds;b.searchFields=a.query.searchFields;b.layerDefinitions=a.query.layerDefs;b.searchText=a.searchText;b.contains=
!this.containsSearchText.checked;b.outSpatialReference={wkid:this.spatialReference};return b},createOrResetResultsGrid:function(){this.resultsGrid||(this.createResultsStore(),this.createResultsGrid(),this.attachStandardEventHandlersToResultsGrid());this.clearResultsGrid();this.clearFeatures();this.resetResultsGridColumns();this.resetResultsGridSort();this.resetGridSelectionMode();this.attachCustomEventHandlersToResultsGrid()},createResultsStore:function(){this.resultsStore||(this.resultsStore=new c({idProperty:"id",
data:[]}))},createResultsGrid:function(){this.resultsGrid=new (h([n,t,q,r]))({selectionMode:this.selectionMode,cellNavigation:!1,showHeader:!0,store:this.resultsStore},this.findResultsGrid);this.resultsGrid.startup()},resetResultsGridColumns:function(){if(this.resultsGrid){var a=this.queries[this.queryIdx].gridColumns||{layerName:"Layer",foundFieldName:"Field",value:"Result"};a instanceof Array&&(a=l.filter(a,function(a){"undefined"===typeof a.visible&&(a.visible=!0);return a.visible}));this.resultsGrid.setColumns(a)}},
resetResultsGridSort:function(){this.resultsGrid&&this.resultsGrid.set("sort",this.queries[this.queryIdx].sort||[{attribute:"value",descending:!1}])},resetGridSelectionMode:function(){this.resultsGrid&&this.resultsGrid.set("selectionMode",this.queries[this.queryIdx].selectionMode||this.selectionMode)},attachStandardEventHandlersToResultsGrid:function(){this.resultsGrid&&(this.own(this.resultsGrid.on("dgrid-select",e.hitch(this,"onResultsGridSelect"))),this.own(this.resultsGrid.on("dgrid-deselect",
e.hitch(this,"onResultsGridDeselect"))),this.own(this.resultsGrid.on(".dgrid-row:dblclick",e.hitch(this,"onResultsGridRowClick"))))},attachCustomEventHandlersToResultsGrid:function(){if(this.resultsGrid){l.forEach(this.currentQueryEventHandlers,function(a){a.handle.remove()});var a=this.queries[this.queryIdx].customGridEventHandlers||[];l.forEach(a,e.hitch(this,function(a){a.handle=this.resultsGrid.on(a.event,e.hitch(this,a.handler))}));this.currentQueryEventHandlers=a}},showResults:function(a){var b=
this.i18n.noResultsLabel;this.results=a;0<this.results.length&&(b=this.results.length+" "+this.i18n.resultsLabel.labelPrefix+(1===this.results.length?"":this.i18n.resultsLabel.multipleResultsSuffix)+" "+this.i18n.resultsLabel.labelSuffix,this.createGraphicsLayerAndSymbols(),this.parseGridColumnProperties(),this.addResultsToGraphicsLayer(),this.zoomToGraphics(this.graphicsLayer.graphics),this.showResultsGrid());this.displayFindMessage(b)},createGraphicsLayerAndSymbols:function(){this.graphicsLayer||
(this.graphicsLayer=this.createGraphicsLayer());this.graphicsSymbols||(this.graphicsSymbols=this.createGraphicsSymbols())},createGraphicsLayer:function(){var a=new v({id:this.id+"_findGraphics",title:"Find"});a.on("click",e.hitch(this,"onGraphicsLayerClick"));this.map.addLayer(a);return a},onGraphicsLayerClick:function(a){var b=this.zoomOptions.select;this.zoomOptions.select=!1;a=this.resultsGrid.row(a.graphic.storeid);this.resultsGrid.select(a);this.resultsGrid.focus(a.element);a.element.focus();
this.zoomOptions.select=b},createGraphicsSymbols:function(){var a={},b;b=e.mixin(this.defaultResultsSymbols,this.resultsSymbols||{});a.resultsSymbols={};a.resultsSymbols.point=u.fromJson(b.point);a.resultsSymbols.polyline=u.fromJson(b.polyline);a.resultsSymbols.polygon=u.fromJson(b.polygon);b=e.mixin(this.defaultSelectionSymbols,this.selectionSymbols||{});a.selectionSymbols={};a.selectionSymbols.point=u.fromJson(b.point);a.selectionSymbols.polyline=u.fromJson(b.polyline);a.selectionSymbols.polygon=
u.fromJson(b.polygon);return a},parseGridColumnProperties:function(){this.queries[this.queryIdx].gridColumns&&l.forEach(this.results,function(a){l.forEach(this.queries[this.queryIdx].gridColumns,function(b){function c(a,b){return a.field&&!b.hasOwnProperty(a.field)&&a.get?!0:!1}(function(b,c){return b.field&&!a.hasOwnProperty(b.field)&&c.feature.attributes.hasOwnProperty(b.field)?!0:!1})(b,this)?this[b.field]=this.feature.attributes[b.field]:c(b,this)&&(this[b.field]=b.get(this))},a)},this)},addResultsToGraphicsLayer:function(){var a=
0;l.forEach(this.results,function(b){b.id=a;b.feature.storeid=b.id;a++;this.setGraphicSymbol(b.feature,!1);this.graphicsLayer.add(b.feature)},this)},showResultsGrid:function(){var a=this.getQueryInput();this.resultsGrid.store.setData(this.results);this.resultsGrid.refresh();var b="block";1===a.query.layerIds.length&&(b="none");this.resultsGrid.styleColumn("layerName","display:"+b);a.query&&!0!==a.query.hideGrid&&(this.findResultsGrid.style.display="block")},onResultsGridSelect:function(a){l.forEach(a.rows,
e.hitch(this,function(a){a=a.data.feature;this.setGraphicSymbol(a,!0);a&&a.getDojoShape()&&a.getDojoShape().moveToFront()}));this.graphicsLayer.redraw();this.zoomOptions.select&&this.zoomToSelectedGraphics()},onResultsGridDeselect:function(a){l.forEach(a.rows,e.hitch(this,function(a){this.setGraphicSymbol(a.data.feature,!1)}));this.graphicsLayer.redraw();this.zoomOptions.deselect&&this.zoomToSelectedGraphics()},onResultsGridRowClick:function(a){var b=this.resultsGrid.row(a),c=b.data.feature;setTimeout(e.hitch(this,
function(){this.resultsGrid.selection.hasOwnProperty(b.id)&&this.zoomToGraphics([c])}),100)},setGraphicSymbol:function(a,b){a.setSymbol(b?this.graphicsSymbols.selectionSymbols[a.geometry.type]:this.graphicsSymbols.resultsSymbols[a.geometry.type])},zoomToSelectedGraphics:function(){var a=[],b=this.resultsGrid.selection,c;for(c in b)b.hasOwnProperty(c)&&a.push(this.resultsGrid.row(c).data.feature);0!==a.length&&this.zoomToGraphics(a)},zoomToGraphics:function(a){var b=null;1<a.length?b=w.graphicsExtent(a):
1===a.length&&(b=this.getExtentFromGraphic(a[0]));b&&this.setMapExtent(b)},getExtentFromGraphic:function(a){var b=null;switch(a.geometry.type){case "point":b=this.getExtentFromPoint(a);break;default:b=w.graphicsExtent([a])}return b},getExtentFromPoint:function(a){var b=this.pointExtentSize;a=a.geometry;return new A({xmin:a.x-b,ymin:a.y-b,xmax:a.x+b,ymax:a.y+b,spatialReference:{wkid:this.spatialReference}})},setMapExtent:function(a){this.map.setExtent(a.expand(this.zoomExtentFactor))},clearResults:function(){this.results=
null;this.clearResultsGrid();this.clearFeatures();this.searchFormDijit.reset();this.querySelectDijit.setValue(this.queryIdx);b.empty(this.findResultsNode)},clearResultsGrid:function(){this.resultStore&&this.resultsStore.setData([]);this.resultsGrid&&this.resultsGrid.refresh();this.findResultsNode.style.display="none";this.findResultsGrid.style.display="none"},clearFeatures:function(){this.graphicsLayer&&this.graphicsLayer.clear()},_onQueryChange:function(a){0<=a&&a<this.queries.length&&(this.queryIdx=
a,this.updateSearchPrompt())},updateSearchPrompt:function(){this.searchTextDijit.set("placeholder",this.queries[this.queryIdx].prompt||B.searchText.placeholder);this.searchTextDijit.set("value",null)},onZoomOptionsSelectChange:function(a){this.zoomOptions.select=a},onZoomOptionsDeselectChange:function(a){this.zoomOptions.deselect=a}})})},"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(h,k,a){return h("dgrid.OnDemandGrid",[k,a],{})})},"dgrid/Grid":function(){define("dojo/_base/kernel dojo/_base/declare dojo/on dojo/has put-selector/put ./List ./util/misc dojo/_base/sniff".split(" "),
function(h,k,a,f,b,e,l){function m(a,b){b&&b.nodeType&&a.appendChild(b)}function g(a,b,d,e){if(this.formatter){e=this.formatter;var c=this.grid.formatterScope;d.innerHTML="string"===typeof e&&c?c[e](b,a):this.formatter(b,a)}else null!=b&&d.appendChild(document.createTextNode(b))}var d=8>f("ie")&&!f("quirks");k=k("dgrid.Grid",e,{columns:null,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(a){return"object"!=typeof a?this.columns[a]:this.cell(a).column},listType:"grid",cell:function(a,
b){if(a.column&&a.element)return a;a.target&&a.target.nodeType&&(a=a.target);var c;if(a.nodeType){do{if(this._rowIdToObject[a.id])break;var d=a.columnId;if(d){b=d;c=a;break}a=a.parentNode}while(a&&a!=this.domNode)}if(!c&&"undefined"!=typeof b){var e=this.row(a);if(d=e&&e.element)for(var d=d.getElementsByTagName("td"),f=0;f<d.length;f++)if(d[f].columnId==b){c=d[f];break}}if(null!=a)return{row:e||this.row(a),column:b&&this.column(b),element:c}},createRowCells:function(a,e,g,h){var c=b("table.dgrid-row-table[role\x3dpresentation]"),
m=9>f("ie")||f("quirks")?b(c,"tbody"):c,k,n,q,t,A,z,B,C,D,E;g=g||this.subRows;n=0;for(q=g.length;n<q;n++)for(z=g[n],k=b(m,"tr"),z.className&&b(k,"."+z.className),t=0,A=z.length;t<A;t++){B=z[t];C=B.id;D=B.field?".field-"+l.escapeCssIdentifier(B.field,"-"):"";(E="function"===typeof B.className?B.className(h):B.className)&&(D+="."+E);D=b(a+(".dgrid-cell.dgrid-cell-padding"+(C?".dgrid-column-"+l.escapeCssIdentifier(C,"-"):"")+D.replace(/ +/g,"."))+"[role\x3d"+("th"===a?"columnheader":"gridcell")+"]");
D.columnId=C;d?(C=b(D,"!dgrid-cell-padding div.dgrid-cell-padding"),D.contents=C):C=D;if(E=B.colSpan)D.colSpan=E;if(E=B.rowSpan)D.rowSpan=E;e(C,B);k.appendChild(D)}return c},left:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,-(b||1),"dgrid-cell"))},right:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,b||1,"dgrid-cell"))},renderRow:function(a,d){var c=this.createRowCells("td",function(b,c){var e=a;c.get?e=c.get(a):"field"in c&&"_item"!=c.field&&(e=
e[c.field]);c.renderCell?m(b,c.renderCell(a,e,b,d)):g.call(c,a,e,b,d)},d&&d.subRows,a);return b("div[role\x3drow]\x3e",c)},renderHeader:function(){var c=this,e=this.headerNode,g=e.childNodes.length;for(e.setAttribute("role","row");g--;)b(e.childNodes[g],"!");g=this.createRowCells("th",function(a,b){var c=b.headerNode=a;d&&(a=a.parentNode);var e=b.field;e&&(a.field=e);b.renderHeaderCell?m(c,b.renderHeaderCell(c)):("label"in b||b.field)&&c.appendChild(document.createTextNode("label"in b?b.label:b.field));
!1!==b.sortable&&e&&"_item"!=e&&(a.sortable=!0,a.className+=" dgrid-sortable")},this.subRows&&this.subRows.headerRows);this._rowIdToObject[g.id=this.id+"-header"]=this.columns;e.appendChild(g);this._sortListener&&this._sortListener.remove();this._sortListener=a(g,"click,keydown",function(b){if("click"==b.type||32==b.keyCode||!f("opera")&&13==b.keyCode){var d=b.target,g,l,h;do if(d.sortable){h=[{attribute:g=d.field||d.columnId,descending:(l=c._sort[0])&&l.attribute==g&&!l.descending}];g={bubbles:!0,
cancelable:!0,grid:c,parentType:b.type,sort:h};a.emit(b.target,"dgrid-sort",g)&&(c._sortNode=d,c.set("sort",h));break}while((d=d.parentNode)&&d!=e)}})},resize:function(){var a=this.headerNode.firstChild,b=this.contentNode,d;this.inherited(arguments);if(!f("ie")||7<f("ie")&&!f("quirks"))b.style.width="",b&&a&&(d=a.offsetWidth)!=b.offsetWidth&&(b.style.width=d+"px")},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();this.inherited(arguments)},_setSort:function(a,
b){this.inherited(arguments);this.updateSortArrow(this._sort)},_findSortArrowParent:function(a){var b=this.columns,c;for(c in b){var d=b[c];if(d.field==a)return d.headerNode}},updateSortArrow:function(a,d){this._lastSortedArrow&&(b(this._lastSortedArrow,"\x3c!dgrid-sort-up!dgrid-sort-down"),b(this._lastSortedArrow,"!"),delete this._lastSortedArrow);d&&(this._sort=a);if(a[0]){var c=a[0].attribute,e=a[0].descending,c=this._sortNode||this._findSortArrowParent(c),f;delete this._sortNode;c&&(c=c.contents||
c,f=this._lastSortedArrow=b("div.dgrid-sort-arrow.ui-icon[role\x3dpresentation]"),f.innerHTML="\x26nbsp;",c.insertBefore(f,c.firstChild),b(c,e?".dgrid-sort-down":".dgrid-sort-up"),this.resize())}},styleColumn:function(a,b){return this.addCssRule("#"+l.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+l.escapeCssIdentifier(a,"-"),b)},_configColumns:function(a,b){var c=[],d=b instanceof Array;l.each(b,function(e,f){"string"==typeof e&&(b[f]=e={label:e});d||e.field||(e.field=f);f=e.id=e.id||(isNaN(f)?
f:a+f);this._configColumn&&(this._configColumn(e,f,b,a),f=e.id);d&&(this.columns[f]=e);e.grid=this;"function"===typeof e.init&&e.init();c.push(e)},this);return d?b:c},_destroyColumns:function(){var a=this.subRows,b=a&&a.length,d,e,f,g;this.cleanup();for(d=0;d<b;d++)for(e=0,g=a[d].length;e<g;e++)f=a[d][e],"function"===typeof f.destroy&&f.destroy()},configStructure:function(){var a=this.subRows,b=this._columns=this.columns;this.columns=!b||b instanceof Array?{}:b;if(a)for(b=0;b<a.length;b++)a[b]=this._configColumns(b+
"-",a[b]);else this.subRows=[this._configColumns("",b)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(a){this._destroyColumns();this.subRows=null;this.columns=a;this._updateColumns()},_setSubRows:function(a){this._destroyColumns();this.subRows=a;this._updateColumns()},setColumns:function(a){h.deprecated("setColumns(...)",'use set("columns", ...) instead',"dgrid 0.4");this.set("columns",a)},setSubRows:function(a){h.deprecated("setSubRows(...)",'use set("subRows", ...) instead',
"dgrid 0.4");this.set("subRows",a)},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this._sort&&this._sort.length?this.updateSortArrow(this._sort):this.resize())}});k.appendIfNode=m;k.defaultRenderCell=g;return k})},"dgrid/List":function(){define("dojo/_base/kernel dojo/_base/declare dojo/dom dojo/on dojo/has ./util/misc dojo/has!touch?./TouchScroll xstyle/has-class put-selector/put dojo/_base/sniff xstyle/css!./css/dgrid.css".split(" "),
function(h,k,a,f,b,e,l,m,g){function d(a,b){g(document.body,a,".dgrid-scrollbar-measure");var c=a["offset"+b]-a["client"+b];a.className="";document.body.removeChild(a);return c}function c(a){var b=a?"."+a.replace(w,"."):"";this._class&&(b="!"+this._class.replace(w,"!")+b);g(this.domNode,b);this._class=a}function n(){return this._class}function q(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}}function t(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&
(this.bodyNode.scrollTop=a.y)}m("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var r,v;b.add("dom-scrollbar-width",function(a,b,c){return d(c,"Width")});b.add("dom-scrollbar-height",function(a,b,c){return d(c,"Height")});b.add("dom-rtl-scrollbar-left",function(a,c,d){a=g("div");g(document.body,d,".dgrid-scrollbar-measure[dir\x3drtl]");g(d,a);c=!!b("ie")||!!b("trident")||a.offsetLeft>=b("dom-scrollbar-width");d.className="";document.body.removeChild(d);g(a,"!");d.removeAttribute("dir");
return c});var u=0,w=/ +/g,x=7>b("ie")&&!b("quirks")?function(){var a,b,c;this._started&&(a=document.documentElement,b=a.clientWidth,a=a.clientHeight,c=this._prevWinDims||[],c[0]!==b||c[1]!==a)&&(this.resize(),this._prevWinDims=[b,a])}:function(){this._started&&this.resize()};return k("dgrid.List",b("touch")?l:null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,useTouchScroll:null,addUiClasses:!0,shouldObserveStore:!0,cleanEmptyObservers:!0,highlightDuration:250,
postscript:function(a,b){var c=this;(this._Row=function(a,b,c){this.id=a;this.data=b;this.element=c}).prototype.remove=function(){c.removeRow(this.element)};b&&(this.srcNodeRef=b=b.nodeType?b:document.getElementById(b));this.create(a,b)},listType:"list",create:function(a,d){var e=this.domNode=d||g("div"),f;a?(this.params=a,k.safeMixin(this,a),f=a["class"]||a.className||e.className,this._sort=a.sort||[],delete this.sort):this._sort=[];this.observers=[];this._numObservers=0;this._listeners=[];this._rowIdToObject=
{};this.postMixInProperties&&this.postMixInProperties();this.id=e.id=e.id||this.id||"dgrid_"+u++;null===this.useTouchScroll&&(this.useTouchScroll=!b("dom-scrollbar-width"));this.buildRendering();f&&c.call(this,f);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&this.startup()},buildRendering:function(){var a=this.domNode,c=this.addUiClasses,d=this,l,h,m,k;k=this.isRTL="rtl"==(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();a.className=
"";g(a,"[role\x3dgrid].dgrid.dgrid-"+this.listType+(c?".ui-widget":""));l=this.headerNode=g(a,"div.dgrid-header.dgrid-header-row"+(c?".ui-widget-header":"")+(this.showHeader?"":".dgrid-header-hidden"));(b("quirks")||8>b("ie"))&&g(a,"div.dgrid-spacer");h=this.bodyNode=g(a,"div.dgrid-scroller");b("ff")&&(h.tabIndex=-1);this.headerScrollNode=g(a,"div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width"+(c?".ui-widget-header":""));m=this.footerNode=g("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));
g(a,m);k&&(a.className+=" dgrid-rtl"+(b("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));f(h,"scroll",function(b){d.showHeader&&(l.scrollLeft=b.scrollLeft||h.scrollLeft);b.stopPropagation();f.emit(a,"scroll",{scrollTarget:h})});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=g(this.bodyNode,"div.dgrid-content"+(c?".ui-widget-content":""));this._listeners.push(this._resizeHandle=f(window,"resize",e.throttleDelayed(x,this)))},postCreate:b("touch")?function(){this.useTouchScroll&&
this.inherited(arguments)}:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this._sort))},configStructure:function(){},resize:function(){var a=this.bodyNode,c=this.headerNode,d=this.footerNode,f=c.offsetHeight,g=this.showFooter?d.offsetHeight:0,l=b("quirks")||7>b("ie");this.headerScrollNode.style.height=a.style.marginTop=f+"px";a.style.marginBottom=g+"px";l&&(a.style.height="",a.style.height=Math.max(this.domNode.offsetHeight-
f-g,0)+"px",g&&(d.style.bottom="1px",setTimeout(function(){d.style.bottom=""},0)));r||(r=b("dom-scrollbar-width"),v=b("dom-scrollbar-height"),b("ie")&&(r++,v++),e.addCssRule(".dgrid-scrollbar-width","width: "+r+"px"),e.addCssRule(".dgrid-scrollbar-height","height: "+v+"px"),17==r||l||(e.addCssRule(".dgrid-header-row","right: "+r+"px"),e.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+r+"px")));l&&(c.style.width=a.clientWidth+"px",setTimeout(function(){c.scrollLeft=a.scrollLeft},0))},addCssRule:function(a,
b){var c=e.addCssRule(a,b);this.cleanAddedRules&&this._listeners.push(c);return c},on:function(a,c){var d=f(this.domNode,a,c);b("dom-addeventlistener")||this._listeners.push(d);return d},cleanup:function(){var a=this.observers,b;for(b in this._rowIdToObject)if(this._rowIdToObject[b]!=this.columns){var c=document.getElementById(b);c&&this.removeRow(c,!0)}for(b=0;b<a.length;b++)(c=a[b])&&c.cancel();this.observers=[];this._numObservers=0;this.preload=null},destroy:function(){if(this._listeners){for(var a=
this._listeners.length;a--;)this._listeners[a].remove();delete this._listeners}this._started=!1;this.cleanup();g(this.domNode,"!");this.useTouchScroll&&this.inherited(arguments)},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";this.scrollTo({x:0,y:0})},newRow:function(a,b,c,d,e){if(b){var f=this.insertRow(a,b,c,d,e);g(f,".dgrid-highlight"+(this.addUiClasses?".ui-state-highlight":""));setTimeout(function(){g(f,"!dgrid-highlight!ui-state-highlight")},
this.highlightDuration);return f}},adjustRowIndices:function(a){var b=a.rowIndex;if(-1<b){do-1<a.rowIndex&&(this.maintainOddEven&&-1<(a.className+" ").indexOf("dgrid-row ")&&g(a,"."+(1==b%2?"dgrid-row-odd":"dgrid-row-even")+"!"+(0==b%2?"dgrid-row-odd":"dgrid-row-even")),a.rowIndex=b++);while((a=a.nextSibling)&&a.rowIndex!=b)}},renderArray:function(b,c,d){function e(){var a=arguments;if(-1<r)for(var c=0;c<a.length;c++){var e=a[c],g=n[e?0:n.length-1];if(g=g&&f(g)){var l=g[e?"previousSibling":"nextSibling"];
l&&(l=h.row(l));l&&l.element!=g&&(e=e?"unshift":"push",b[e](l.data),n[e](l.element),d.count++)}}}function f(b){return!a.isDescendant(b,h.domNode)&&document.getElementById(b.id)?h.row(b.id.slice(h.id.length+5)).element:b}function g(a){v=h.insertRow(a,u,null,m++,d);v.observerIndex=r;return v}function l(a){w=a.slice(0);(q=c?c.parentNode:h.contentNode)&&q.parentNode&&(q!==h.contentNode||a.length)?(q.insertBefore(u,c||null),(v=a[a.length-1])&&h.adjustRowIndices(v)):k[r]&&h.cleanEmptyObservers&&"undefined"!==
typeof r&&(k[r].cancel(),k[r]=0,h._numObservers--);n=a;t&&(t.rows=n)}d=d||{};var h=this,m=d.start||0,k=this.observers,n,q,r;c||(this._lastCollection=b);if(b.observe&&this.shouldObserveStore){h._numObservers++;var t=b.observe(function(a,g,l){var m,k,t;-1<g&&n[g]&&(m=n.splice(g,1)[0],m.parentNode==q&&((k=m.nextSibling)&&g!=l&&k.rowIndex--,h.removeRow(m)),d.count--,h._processScroll&&h._processScroll());if(-1<l){if(n.length)if(0===l)t=(t=n[l])&&f(t);else{if(t=n[l-1])t=f(t),t=(t.connected||t).nextSibling}else t=
h._getFirstRowSibling&&h._getFirstRowSibling(q);m&&t&&m.id===t.id&&(t=(t.connected||t).nextSibling);t&&!t.parentNode&&(t=document.getElementById(t.id));m=c&&c.parentNode||t&&t.parentNode||h.contentNode;if(m=h.newRow(a,m,t,d.start+l,d))if(m.observerIndex=r,n.splice(l,0,m),!k||l<g)k=(k=m.previousSibling)&&k.rowIndex+1!=m.rowIndex&&0!=m.rowIndex?k:m;d.count++}0===g?e(1,1):g===b.length-(-1===l?0:1)&&e(0,0);g!=l&&k&&h.adjustRowIndices(k);h._onNotification(n,a,g,l)},!0);r=k.push(t)-1}var u=document.createDocumentFragment(),
v,w;if(b.map){if(n=b.map(g,console.error),n.then)return b.then(function(a){b=a;return n.then(function(a){l(a);e(1,1,0,0);return w})})}else{n=[];for(var z=0,x=b.length;z<x;z++)n[z]=g(b[z])}l(n);e(1,1,0,0);return w},_onNotification:function(a,b,c,d){},renderHeader:function(){},_autoId:0,insertRow:function(a,b,c,d,e){var f=e.parentId,f=this.id+"-row-"+(f?f+"-":"")+(this.store&&this.store.getIdentity?this.store.getIdentity(a):this._autoId++),g=document.getElementById(f),l=g&&g.previousSibling;g&&(g===
c&&(c=(c.connected||c).nextSibling),this.removeRow(g));g=this.renderRow(a,e);g.className=(g.className||"")+" dgrid-row "+(1==d%2?"dgrid-row-odd":"dgrid-row-even")+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[g.id=f]=a;b.insertBefore(g,c||null);l&&this.adjustRowIndices(l);g.rowIndex=d;return g},renderRow:function(a,b){return g("div",""+a)},removeRow:function(a,b){a=a.element||a;delete this._rowIdToObject[a.id];b||g(a,"!")},row:function(a){var b;if(a instanceof this._Row)return a;
a.target&&a.target.nodeType&&(a=a.target);if(a.nodeType){do{var c=a.id;if(b=this._rowIdToObject[c])return new this._Row(c.substring(this.id.length+5),b,a);a=a.parentNode}while(a&&a!=this.domNode)}else return"object"==typeof a?b=this.store.getIdentity(a):(b=a,a=this._rowIdToObject[this.id+"-row-"+b]),new this._Row(b,a,document.getElementById(this.id+"-row-"+b))},cell:function(a){return{row:this.row(a)}},_move:function(a,b,c,d){var e,f;f=e=a.element;b=b||1;do if(a=e[0>b?"previousSibling":"nextSibling"]){do if((e=
a)&&-1<(e.className+" ").indexOf(c+" ")){f=e;b+=0>b?1:-1;break}while(a=(!d||!e.hidden)&&e[0>b?"lastChild":"firstChild"])}else if(e=e.parentNode,!e||e===this.bodyNode||e===this.headerNode)break;while(b);return f},up:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,-(b||1),"dgrid-row",c))},down:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,b||1,"dgrid-row",c))},scrollTo:b("touch")?function(a){return this.useTouchScroll?this.inherited(arguments):t.call(this,
a)}:t,getScrollPosition:b("touch")?function(){return this.useTouchScroll?this.inherited(arguments):q.call(this)}:q,get:function(a){var b="_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,1)):this[a]},set:function(a,b){if("object"===typeof a)for(var c in a)this.set(c,a[c]);else c="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[c]?this[c].apply(this,[].slice.call(arguments,1)):this[a]=b;return this},_getClass:n,
_setClass:c,_getClassName:n,_setClassName:c,_setSort:function(a,b){this._sort="string"!=typeof a?a:[{attribute:a,descending:b}];this.refresh();this._lastCollection&&(a.length&&("string"!=typeof a&&(b=a[0].descending,a=a[0].attribute),this._lastCollection.sort(function(c,d){var e=c[a],f=d[a];void 0===e&&(e="");void 0===f&&(f="");return e==f?0:e>f==!b?1:-1})),this.renderArray(this._lastCollection))},sort:function(a,b){h.deprecated("sort(...)",'use set("sort", ...) instead',"dgrid 0.4");this.set("sort",
a,b)},_getSort:function(){return this._sort},_setShowHeader:function(a){var b=this.headerNode;this.showHeader=a;g(b,(a?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();a&&(b.scrollLeft=this.getScrollPosition().x)},setShowHeader:function(a){h.deprecated("setShowHeader(...)",'use set("showHeader", ...) instead',"dgrid 0.4");this.set("showHeader",a)},_setShowFooter:function(a){this.showFooter=a;g(this.footerNode,(a?"!":".")+"dgrid-footer-hidden");this.resize()}})})},"dgrid/util/misc":function(){define(["dojo/has",
"put-selector/put"],function(h,k){h.add("dom-contains",function(a,b,c){return!!c.contains});var a=[],f,b,e,l=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,m={defaultDelay:15,throttle:function(a,b,c){var d=!1;c=c||m.defaultDelay;return function(){d||(d=!0,a.apply(b,arguments),setTimeout(function(){d=!1},c))}},throttleDelayed:function(a,b,c){var d=!1;c=c||m.defaultDelay;return function(){if(!d){d=!0;var e=arguments;setTimeout(function(){d=!1;a.apply(b,e)},c)}}},debounce:function(a,b,c){var d;c=c||m.defaultDelay;
return function(){d&&(clearTimeout(d),d=null);var e=arguments;d=setTimeout(function(){a.apply(b,e)},c)}},each:function(a,b,c){var d,e;if(a)if("number"===typeof a.length)for(d=0,e=a.length;d<e;d++)b.call(c,a[d],d,a);else for(d in a)b.call(c,a[d],d,a)},contains:function(a,b){return h("dom-contains")?a.contains(b):a.compareDocumentPosition(b)&8},addCssRule:function(g,d){f||(f=k(document.getElementsByTagName("head")[0],"style"),f=f.sheet||f.styleSheet,b=f.deleteRule?"deleteRule":"removeRule",e=f.cssRules?
"cssRules":"rules");var c=a.length;a[c]=(f.cssRules||f.rules).length;f.addRule?f.addRule(g,d):f.insertRule(g+"{"+d+"}",a[c]);return{get:function(b){return f[e][a[c]].style[b]},set:function(b,d){"undefined"!==typeof a[c]&&(f[e][a[c]].style[b]=d)},remove:function(){var d=a[c],e,g;if(void 0!==d)for(f[b](d),a[c]=void 0,e=c+1,g=a.length;e<g;e++)a[e]>d&&a[e]--}}},escapeCssIdentifier:function(a,b){return"string"===typeof a?a.replace(l,b||"\\$1"):a}};return m})},"xstyle/has-class":function(){define(["dojo/has"],
function(h){var k={};return function(){for(var a,f=arguments,b=0;b<f.length;b++)if(a=f[b],!k[a]){k[a]=!0;var e=a.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/),l=h(e[2]),m=-e[4];(0<m?m<=l&&(-e[5]||m)>=l:!!l)==!e[1]&&(document.documentElement.className+=" has-"+a)}}})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/dom dojo/on ./util/misc put-selector/put".split(" "),function(h,k,a,f,b,e,l,m,g){return a("dgrid.OnDemandList",
[h,k],{minRowsPerPage:25,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:m.defaultDelay,keepScrollPosition:!1,rowHeight:22,postCreate:function(){this.inherited(arguments);var a=this;l(this.bodyNode,"scroll",m[this.pagingMethod](function(b){a._processScroll(b)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(a,c){function d(a){g(y,
"!");if(a)throw e._refreshDeferred&&(e._refreshDeferred.reject(a),delete e._refreshDeferred),a;}var e=this,l=c&&c.container||this.contentNode,h={query:a,count:0,options:c},m,k=this.preload,w,x={node:g(l,"div.dgrid-preload",{rowIndex:0}),count:0,query:a,next:h,options:c};x.node.style.height="0";h.node=m=g(l,"div.dgrid-preload");h.previous=x;m.rowIndex=this.minRowsPerPage;k?((h.next=k.next)&&m.offsetTop>=k.node.offsetTop?h.previous=k:(h.next=k,h.previous=k.previous),h.previous.next=h,h.next.previous=
h):this.preload=h;var y=g(m,"-div.dgrid-loading");g(y,"div.dgrid-below").innerHTML=this.loadingMessage;c=f.mixin(this.get("queryOptions"),c,{start:0,count:this.minRowsPerPage},"level"in a?{queryLevel:a.level}:null);this._trackError(function(){return w=a(c)});if("undefined"===typeof w)d();else return b.when(e.renderArray(w,m,c),function(a){return b.when("undefined"===typeof w.total?w.length:w.total,function(b){var d=a.length,f=m.parentNode,l=e.noDataNode;g(y,"!");"queryLevel"in c||(e._total=b);0===
b&&f&&(l&&(g(l,"!"),delete e.noDataNode),e.noDataNode=l=g("div.dgrid-no-data"),f.insertBefore(l,e._getFirstRowSibling(f)),l.innerHTML=e.noDataMessage);for(l=f=0;l<d;l++)f+=e._calcRowHeight(a[l]);d&&f&&(e.rowHeight=f/d);f=e.rowHeight*e.bufferRows;f>e.farOffRemoval&&(e.farOffRemoval=f);b-=d;h.count=b;m.rowIndex=d;b?m.style.height=Math.min(b*e.rowHeight,e.maxEmptySpace)+"px":(m.style.display="none",c.count++);e._previousScrollPosition&&(e.scrollTo(e._previousScrollPosition),delete e._previousScrollPosition);
e._processScroll();e._refreshDeferred&&(e._refreshDeferred.resolve(w),delete e._refreshDeferred);return a},d)},d),w},refresh:function(a){var c=this,d=a&&a.keepScrollPosition,e;"undefined"===typeof d&&(d=this.keepScrollPosition);d&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this.store)return d=this._refreshDeferred=new b,e=c.renderQuery(function(a){return c.store.query(c.query,a)}),"undefined"===typeof e&&d.reject(),d.then(function(a){c._refreshTimeout=setTimeout(function(){l.emit(c.domNode,
"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:c,results:a});c._refreshTimeout=null},0);delete c._refreshDeferred;return a},function(a){delete c._refreshDeferred;throw a;})},resize:function(){this.inherited(arguments);this._processScroll()},_getFirstRowSibling:function(a){return a.lastChild},_calcRowHeight:function(a){var b=a.nextSibling;return b&&!/\bdgrid-preload\b/.test(b.className)?b.offsetTop-a.offsetTop:a.offsetHeight},lastScrollTop:0,_processScroll:function(a){function c(a,b,c,e){var f=
l.farOffRemoval,h=a.node;if(b>2*f){for(var m,k=h[c],n=0,q=0,r=[];m=k;){var t=l._calcRowHeight(m);if(n+t+f>b||0>k.className.indexOf("dgrid-row")&&0>k.className.indexOf("dgrid-loading"))break;k=m[c];n+=t;q+=m.count||1;l.removeRow(m,!0);r.push(m)}a.count+=q;e?(h.rowIndex-=q,d(a)):h.style.height=h.offsetHeight+n+"px";var u=g("div",r);setTimeout(function(){g(u,"!")},1)}}function d(a,b){a.node.style.height=Math.min(a.count*l.rowHeight,b?Infinity:l.maxEmptySpace)+"px"}function e(a,b){do a=b?a.next:a.previous;
while(a&&!a.node.offsetWidth);return a}var l=this,h=l.bodyNode;a=a&&a.scrollTop||this.getScrollPosition().y;var h=h.offsetHeight+a,m,k,w=l.preload,x=l.lastScrollTop,y=l.bufferRows*l.rowHeight,A=y-l.rowHeight,z,B,C,D=!0;for(l.lastScrollTop=a;w&&!w.node.offsetWidth;)w=w.previous;for(;w&&w!=m;){m=l.preload;l.preload=w;k=w.node;var E=k.offsetTop;if(h+1+A<E)w=e(w,D=!1);else if(a-1-A>E+k.offsetHeight)w=e(w,D=!0);else{var F=((k.rowIndex?a-y:h)-E)/l.rowHeight,E=(h-a+2*y)/l.rowHeight,E=E+Math.min(Math.abs(Math.max(Math.min((a-
x)*l.rowHeight,l.maxRowsPerPage/2),l.maxRowsPerPage/-2)),10);0==k.rowIndex&&(F-=E);F=Math.max(F,0);10>F&&0<F&&E+F<l.maxRowsPerPage&&(E+=Math.max(0,F),F=0);E=Math.min(Math.max(E,l.minRowsPerPage),l.maxRowsPerPage,w.count);if(0==E)w=e(w,D);else{var E=Math.ceil(E),F=Math.min(Math.floor(F),w.count-E),G=f.mixin(l.get("queryOptions"),w.options);w.count-=E;var I=k,J,L=l.queryRowsOverlap,M=(0<k.rowIndex||k.offsetTop>a)&&w;if(M){var H=w.previous;H&&(c(H,a-(H.node.offsetTop+H.node.offsetHeight),"nextSibling"),
0<F&&H.node==k.previousSibling?(F=Math.min(w.count,F),w.previous.count+=F,d(w.previous,!0),k.rowIndex+=F,L=0):E+=F,w.count-=F);G.start=k.rowIndex-L;G.count=Math.min(E+L,l.maxRowsPerPage);k.rowIndex=G.start+G.count}else w.next&&(c(w.next,w.next.node.offsetTop-h,"previousSibling",!0),I=k.nextSibling,I==w.next.node?(w.next.count+=w.count-F,w.next.node.rowIndex=F+E,d(w.next),w.count=F,L=0):J=!0),G.start=w.count,G.count=Math.min(E+L,l.maxRowsPerPage);J&&I&&I.offsetWidth&&(J=I.offsetTop);d(w);"level"in
w.query&&(G.queryLevel=w.query.level);if("queryLevel"in G||!(G.start>l._total||0>G.count)){k=g(I,"-div.dgrid-loading[style\x3dheight:"+E*l.rowHeight+"px]");g(k,"div.dgrid-"+(M?"below":"above")).innerHTML=l.loadingMessage;k.count=E;var K=w.query(G);if(void 0===l._trackError(function(){return K})){g(k,"!");return}(function(a,c,e,f){C=b.when(l.renderArray(f,a,G),function(h){B=f;I=a.nextSibling;g(a,"!");if(e&&I&&I.offsetWidth){var m=l.getScrollPosition();l.scrollTo({x:m.x,y:m.y+I.offsetTop-e,preserveMomentum:!0})}b.when(f.total||
f.length,function(a){"queryLevel"in G||(l._total=a);c&&(c.count=a-c.node.rowIndex,0===c.count&&G.count++,d(c))});l._processScroll();return h},function(b){g(a,"!");throw b;})}).call(this,k,M,J,K);w=w.previous}}}}C&&(z=this._refreshDeferred)&&(delete this._refreshDeferred,b.when(C,function(){z.resolve(B)}))},removeRow:function(a,b){if(a){var c=a.previousSibling,d=a.nextSibling,f;if(f=c)f=c.observerIndex,f=null!=f?f:c.previousObserverIndex;c=f;if(f=d)f=d.observerIndex,f=null!=f?f:d.nextObserverIndex;
d=a.observerIndex;a.observerIndex=void 0;b&&(a.nextObserverIndex=f,a.previousObserverIndex=c);if(this.cleanEmptyObservers&&-1<d&&d!==c&&d!==f&&(c=this.observers,f=c[d])){if(!b)for(var g=f.rows,l=0;l<g.length;l++)if(g[l]!=a&&e.isDescendant(g[l],this.domNode))return this.inherited(arguments);f.cancel();this._numObservers--;c[d]=0}}this.inherited(arguments)}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/aspect put-selector/put".split(" "),
function(h,k,a,f,b,e,l){function m(a){return a}function g(a){if("object"!==typeof a)a=Error(a);else if("cancel"===a.dojoType)return;a.grid=this;b.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,bubbles:!0})&&console.error(a)}return k("dgrid._StoreMixin",null,{store:null,query:null,queryOptions:null,getBeforePut:!0,noDataMessage:"",loadingMessage:"",constructor:function(){this.query={};this.queryOptions={};this.dirty={};this._updating={};this._columnsWithSet={};e.before(this,"configStructure",
a.hitch(this,function(){this._columnsWithSet={}}))},postCreate:function(){this.inherited(arguments);this.store&&this._updateNotifyHandle(this.store)},destroy:function(){this.inherited(arguments);this._notifyHandle&&this._notifyHandle.remove()},_configColumn:function(a){a.set&&(this._columnsWithSet[a.field]=a);this.inherited(arguments)},_updateNotifyHandle:function(b){this._notifyHandle&&(this._notifyHandle.remove(),delete this._notifyHandle);b&&"function"===typeof b.notify&&this.shouldObserveStore&&
(this._notifyHandle=e.after(b,"notify",a.hitch(this,"_onNotify"),!0),(b=this.get("sort"))&&b.length||console.warn("Observable store detected, but no sort order specified. You may experience quirks when adding/updating items.  These can be resolved by setting a sort order on the list or grid."))},_setStore:function(a,b,e){this._updateNotifyHandle(a);this.store=a;this.dirty={};this.set("query",b,e)},_setQuery:function(a,b){var c=b&&b.sort;this.query=void 0!==a?a:this.query;this.queryOptions=b||this.queryOptions;
this._started&&(c?this.set("sort",c):this.refresh())},setStore:function(a,b,e){h.deprecated("setStore(...)",'use set("store", ...) instead',"dgrid 0.4");this.set("store",a,b,e)},setQuery:function(a,b){h.deprecated("setQuery(...)",'use set("query", ...) instead',"dgrid 0.4");this.set("query",a,b)},_getQueryOptions:function(){var b=a.delegate(this.queryOptions,{});if("function"===typeof this._sort||this._sort.length)b.sort=this._sort;return b},_getQuery:function(){var b=this.query;return"object"==typeof b&&
null!=b?a.delegate(b,{}):b},_setSort:function(a,b){this.store&&(this._lastCollection=null);this.inherited(arguments)},_onNotify:function(a,b){this.inherited(arguments);a&&1>this._numObservers&&this.refresh({keepScrollPosition:!0})},refresh:function(){var a=this.inherited(arguments);this.store||(this.noDataNode=l(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return a},renderArray:function(){var a=this,b=this.inherited(arguments);this.store||f.when(b,function(b){b.length&&
a.noDataNode&&l(a.noDataNode,"!")});return b},insertRow:function(b,c,e,f,g){var d=this.store,l=this.dirty,d=d&&d.getIdentity(b),h;d in l&&!(d in this._updating)&&(h=l[d]);h&&(b=a.delegate(b,h));return this.inherited(arguments)},updateDirty:function(a,b,e){var c=this.dirty,d=c[a];d||(d=c[a]={});d[b]=e},setDirty:function(a,b,e){h.deprecated("setDirty(...)","use updateDirty() instead","dgrid 0.4");this.updateDirty(a,b,e)},save:function(){function a(a,c){return function(d){var l=b._columnsWithSet,h=b._updating,
m,k;if("function"===typeof d.set)d.set(c);else for(m in c)d[m]=c[m];for(m in l)k=l[m].set(d),void 0!==k&&(d[m]=k);h[a]=!0;return f.when(e.put(d),function(){delete g[a];delete h[a]})}}var b=this,e=this.store,g=this.dirty,l=new f,h=l.promise,m=function(a){var c;return b.getBeforePut||!(c=b.row(a).data)?function(){return e.get(a)}:function(){return c}},k;for(k in g)var w=a(k,g[k]),h=h.then(m(k)).then(w);l.resolve();return h},revert:function(){this.dirty={};this.refresh()},_trackError:function(b){var c;
"string"==typeof b&&(b=a.hitch(this,b));try{c=b()}catch(n){g.call(this,n)}return f.when(c,m,a.hitch(this,g))},newRow:function(){var a=this.inherited(arguments);this.noDataNode&&(l(this.noDataNode,"!"),delete this.noDataNode);return a},removeRow:function(a,b){var c={element:a};!b&&this.noDataMessage&&this.up(c).element===a&&this.down(c).element===a&&(this.noDataNode=l(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return this.inherited(arguments)}})})},"dgrid/Selection":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/Deferred dojo/on dojo/has dojo/aspect ./List dojo/has!touch?./util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),
function(h,k,a,f,b,e,l,m,g){function d(a,b){for(var c=a.unselectable=b?"on":"",d=a.getElementsByTagName("*"),e=d.length;--e;)"INPUT"!==d[e].tagName&&"TEXTAREA"!==d[e].tagName&&(d[e].unselectable=c)}function c(a,c){var g=a.bodyNode,l=c?"text":21>b("ff")?"-moz-none":"none";q&&"msUserSelect"!==q?g.style[q]=l:b("dom-selectstart")?c||a._selectstartHandle?c&&a._selectstartHandle&&(a._selectstartHandle.remove(),delete a._selectstartHandle):a._selectstartHandle=f(g,"selectstart",function(a){var b=a.target&&
a.target.tagName;"INPUT"!==b&&"TEXTAREA"!==b&&a.preventDefault()}):(d(g,!c),c||a._unselectableHandle)?c&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle):a._unselectableHandle=e.after(a,"renderRow",function(a){d(a,!0);return a})}b.add("dom-comparedocumentposition",function(a,b,c){return!!c.compareDocumentPosition});b.add("pointer",function(a){return"PointerEvent"in a?"pointer":"MSPointerEvent"in a?"MSPointer":!1});b.add("css-user-select",function(a,b,c){a=c.style;
b=["Khtml","O","ms","Moz","Webkit"];c=b.length;var d="userSelect";do if("undefined"!==typeof a[d])return d;while(c--&&(d=b[c]+"UserSelect"));return!1});b.add("dom-selectstart","undefined"!==typeof document.onselectstart);var n=b("mac")?"metaKey":"ctrlKey",q=b("css-user-select"),t=(l=b("pointer"))&&"MS"===l.slice(0,2),r=l?l+(t?"Down":"down"):"mousedown",v=l?l+(t?"Up":"up"):"mouseup";"WebkitUserSelect"===q&&"undefined"!==typeof document.documentElement.style.msUserSelect&&(q=!1);return k("dgrid.Selection",
null,{selectionDelegate:".dgrid-row",selectionEvents:r+","+v+",dgrid-cellfocusin",selectionTouchEvents:b("touch")?m.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);
this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(a){a!=this.selectionMode&&(this.clearSelection(),this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},setSelectionMode:function(a){h.deprecated("setSelectionMode(...)",'use set("selectionMode", ...) instead',"dgrid 0.4");
this.set("selectionMode",a)},_setAllowTextSelection:function(a){"undefined"!==typeof a?c(this,a):c(this,"none"===this.selectionMode);this.allowTextSelection=a},_handleSelect:function(a,b){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(b))&&("dgrid-cellfocusin"!==a.type||"mousedown"!==a.parentType)&&(a.type!==v||b==this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32==a.keyCode)if(!a.shiftKey&&a.type===r&&this.isSelected(b))this._waitForMouseUp=
b;else this[this._selectionHandlerName](a,b);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(a,b){var c=a.keyCode?a.ctrlKey:a[n];this._lastSelected===b?this.select(b,null,!c||!this.isSelected(b)):(this.clearSelection(),this.select(b),this._lastSelected=b)},_multipleSelectionHandler:function(a,b){var c=this._lastSelected,d=a.keyCode?a.ctrlKey:a[n],e;a.shiftKey||(e=d?null:!0,c=null);this.select(b,c,e);c||(this._lastSelected=b)},_extendedSelectionHandler:function(a,b){(2===a.button?
this.isSelected(b):a.keyCode?a.ctrlKey:a[n])||this.clearSelection(null,!0);this._multipleSelectionHandler(a,b)},_toggleSelectionHandler:function(a,b){this.select(b,null,null)},_initSelectionEvents:function(){var a=this,c=this.contentNode,d=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};b("touch")&&!b("pointer")&&this.selectionTouchEvents?(f(c,m.selector(d,this.selectionTouchEvents),function(b){a._handleSelect(b,this);a._ignoreMouseSelect=this}),f(c,f.selector(d,this.selectionEvents),
function(b){a._ignoreMouseSelect!==this?a._handleSelect(b,this):b.type===v&&(a._ignoreMouseSelect=null)})):f(c,f.selector(d,this.selectionEvents),function(b){a._handleSelect(b,this)});this.addKeyHandler&&this.addKeyHandler(32,function(b){a._handleSelect(b,b.target)});if(this.allowSelectAll)this.on("keydown",function(b){b[n]&&65==b.keyCode&&!/\bdgrid-input\b/.test(b.target.className)&&(b.preventDefault(),a[a.allSelected?"clearSelection":"selectAll"]())});this._setStore&&e.after(this,"_setStore",function(){a._updateDeselectionAspect()});
this._updateDeselectionAspect()},_updateDeselectionAspect:function(){function a(a,c,d){a=c||a&&a[b.idProperty||"id"];if(null!=a&&(c=(a=b.row(a))&&b.selection[a.id]))b[d](a,null,c)}var b=this,c=this.store,d,f;this._removeDeselectSignals&&this._removeDeselectSignals();c&&c.notify?(d=e.before(c,"notify",function(b,c){b||a(b,c,"deselect")}),f=e.after(c,"notify",function(b,c){a(b,c,"select")},!0),this._removeDeselectSignals=function(){d.remove();f.remove()}):(d=e.before(this,"removeRow",function(a,b){var c;
b||(c=this.row(a))&&c.id in this.selection&&this.deselect(c)}),this._removeDeselectSignals=function(){d.remove()})},allowSelect:function(a){return!0},_fireSelectionEvent:function(a){var b=this._selectionEventQueues[a],c=this._selectionTriggerEvent,d;d={bubbles:!0,grid:this};c&&(d.parentType=c.type);d[this._selectionTargetType]=b;this._selectionEventQueues[a]=[];f.emit(this.contentNode,"dgrid-"+a,d)},_fireSelectionEvents:function(){var a=this._selectionEventQueues,b;for(b in a)a[b].length&&this._fireSelectionEvent(b)},
_select:function(a,b,c){var d,e,f;"undefined"===typeof c&&(c=!0);a.element||(a=this.row(a));if(!1===c||this.allowSelect(a))if(d=this.selection,e=!!d[a.id],null===c&&(c=!e),f=a.element,c||this.allSelected?d[a.id]=c:delete this.selection[a.id],f&&(c?g(f,".dgrid-selected"+(this.addUiClasses?".ui-state-active":"")):g(f,"!dgrid-selected!ui-state-active")),c!==e&&f&&this._selectionEventQueues[(c?"":"de")+"select"].push(a),b)if(b.element||(b=this.row(b)),b){if(b=b.element)for(d=this._determineSelectionDirection(f,
b),d||(b=document.getElementById(b.id),d=this._determineSelectionDirection(f,b));a.element!=b&&(a=this[d](a));)this._select(a,null,c)}else this._lastSelected=f,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")},_determineSelectionDirection:b("dom-comparedocumentposition")?function(a,
b){var c=b.compareDocumentPosition(a);return c&1?!1:2===c?"down":"up"}:function(a,b){return 1>b.sourceIndex?!1:b.sourceIndex>a.sourceIndex?"down":"up"},select:function(a,b,c){this._select(a,b,c);this._fireSelectionEvents()},deselect:function(a,b){this.select(a,b,!1)},clearSelection:function(a,b){this.allSelected=!1;for(var c in this.selection)a!==c&&this._select(c,null,!1);b||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var b=
this.row(this._rowIdToObject[a]);this._select(b.id,null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===typeof a||null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var b=this,c=this.inherited(arguments);a.when(c,function(a){var c=b.selection,
d,e,f;for(d=0;d<a.length;d++)e=b.row(a[d]),(f=e.id in c?c[e.id]:b.allSelected)&&b._select(e,null,f);b._fireSelectionEvents()});return c}})})},"dgrid/Keyboard":function(){define("dojo/_base/declare dojo/aspect dojo/on dojo/_base/lang dojo/has put-selector/put ./util/misc dojo/_base/Deferred dojo/_base/sniff".split(" "),function(h,k,a,f,b,e,l,m){function g(a){a.preventDefault()}var d={checkbox:1,radio:1,button:1},c=/\bdgrid-cell\b/,n=/\bdgrid-row\b/,q=h("dgrid.Keyboard",null,{pageSkip:10,tabIndex:0,
keyMap:null,headerKeyMap:null,postMixInProperties:function(){this.inherited(arguments);this.keyMap||(this.keyMap=f.mixin({},q.defaultKeyMap));this.headerKeyMap||(this.headerKeyMap=f.mixin({},q.defaultHeaderKeyMap))},postCreate:function(){function b(a){var b=a.target;return b.type&&(!d[b.type]||32==a.keyCode)}function e(d){function e(){f._focusedHeaderNode&&(f._focusedHeaderNode.tabIndex=-1);if(f.showHeader){if(g)for(var a=0,b,c=f.headerNode.getElementsByTagName("th");b=c[a];++a){if(h.test(b.className)){f._focusedHeaderNode=
r=b;break}}else f._focusedHeaderNode=r=f.headerNode;r&&(r.tabIndex=f.tabIndex)}}var g=f.cellNavigation,h=g?c:n,q=d===f.headerNode,r=d;q?(e(),k.after(f,"renderHeader",e,!0)):k.after(f,"renderArray",function(a){return m.when(a,function(a){var b=f._focusedNode||r;if(h.test(b.className)&&l.contains(d,b))return a;for(var c=0,e=d.getElementsByTagName("*"),g;g=e[c];++c)if(h.test(g.className)){b=f._focusedNode=g;break}b.tabIndex=f.tabIndex;return a})});f._listeners.push(a(d,"mousedown",function(a){b(a)||
f._focusOnNode(a.target,q,a)}));f._listeners.push(a(d,"keydown",function(a){if(!a.metaKey&&!a.altKey){var c=f[q?"headerKeyMap":"keyMap"][a.keyCode];c&&!b(a)&&c.call(f,a)}}))}this.inherited(arguments);var f=this;this.tabableHeader&&(e(this.headerNode),a(this.headerNode,"dgrid-cellfocusin",function(){f.scrollTo({x:this.scrollLeft})}));e(this.contentNode);this._debouncedEnsureRowScroll=l.debounce(this._ensureRowScroll,this)},removeRow:function(a){if(!this._focusedNode)return this.inherited(arguments);
var b=this,c=document.activeElement===this._focusedNode,d=this[this.cellNavigation?"cell":"row"](this._focusedNode),e=d.row||d,f;a=a.element||a;a===e.element&&((f=this.down(e,!0))&&f.element!==a||(f=this.up(e,!0)),this._removedFocus={active:c,rowId:e.id,columnId:d.column&&d.column.id,siblingId:f&&f.element!==a?f.id:void 0},setTimeout(function(){b._removedFocus&&b._restoreFocus(e.id)},0),this._focusedNode=null);this.inherited(arguments)},insertRow:function(a){var b=this.inherited(arguments);this._removedFocus&&
!this._removedFocus.wait&&this._restoreFocus(b);return b},_restoreFocus:function(a){var b=this._removedFocus,c;if((a=(a=a&&this.row(a))&&a.element&&a.id===b.rowId?a:"undefined"!==typeof b.siblingId&&this.row(b.siblingId))&&a.element){if(!a.element.parentNode.parentNode){b.wait=!0;return}"undefined"!==typeof b.columnId&&(c=this.cell(a,b.columnId))&&c.element&&(a=c);b.active&&0!==a.element.offsetHeight?this._focusOnNode(a,!1,null):(e(a.element,".dgrid-focus"),a.element.tabIndex=this.tabIndex,this._focusedNode=
a.element)}delete this._removedFocus},addKeyHandler:function(a,b,c){return k.after(this[c?"headerKeyMap":"keyMap"],a,b,!0)},_ensureRowScroll:function(a){var b=this.getScrollPosition().y;b>a.offsetTop?this.scrollTo({y:a.offsetTop}):b+this.contentNode.offsetHeight<a.offsetTop+a.offsetHeight&&this.scrollTo({y:a.offsetTop-this.contentNode.offsetHeight+a.offsetHeight})},_focusOnNode:function(d,g,l){var h="_focused"+(g?"Header":"")+"Node",m=this[h],k=this.cellNavigation?"cell":"row",q=this[k](d),r,t,u,
v,w;if(d=q&&q.element){if(this.cellNavigation)for(r=d.getElementsByTagName("input"),w=0,u=r.length;w<u;w++)if(t=r[w],(-1!=t.tabIndex||"_dgridLastValue"in t)&&!t.disabled){8>b("ie")&&(t.style.position="relative");t.focus();8>b("ie")&&(t.style.position="");v=!0;break}null!==l&&(l=f.mixin({grid:this},l),l.type&&(l.parentType=l.type),l.bubbles||(l.bubbles=!0));m&&(e(m,"!dgrid-focus[!tabIndex]"),8>b("ie")&&(m.style.position=""),l&&(l[k]=this[k](m),a.emit(m,"dgrid-cellfocusout",l)));m=this[h]=d;l&&(l[k]=
q);h=this.cellNavigation?c:n;!v&&h.test(d.className)&&(8>b("ie")&&(d.style.position="relative"),d.tabIndex=this.tabIndex,d.focus());e(d,".dgrid-focus");l&&a.emit(m,"dgrid-cellfocusin",l);this.cellNavigation&&(this.columnSets||1<this.subRows.length)&&!g&&this._debouncedEnsureRowScroll(q.row.element)}},focusHeader:function(a){this._focusOnNode(a||this._focusedHeaderNode,!0)},focus:function(a){(a=a||this._focusedNode)?this._focusOnNode(a,!1):this.contentNode.focus()}}),t=q.moveFocusVertical=function(a,
b){var c=this.cellNavigation,d=this[c?"cell":"row"](a),d=c&&d.column.id,e=this.down(this._focusedNode,b,!0);c&&(e=this.cell(e,d));this._focusOnNode(e,!1,a);a.preventDefault()};h=q.moveFocusUp=function(a){t.call(this,a,-1)};var r=q.moveFocusDown=function(a){t.call(this,a,1)},v=q.moveFocusPageUp=function(a){t.call(this,a,-this.pageSkip)},u=q.moveFocusPageDown=function(a){t.call(this,a,this.pageSkip)},w=q.moveFocusHorizontal=function(a,b){if(this.cellNavigation){var c=!this.row(a);this._focusOnNode(this.right(this["_focused"+
(c?"Header":"")+"Node"],b),c,a);a.preventDefault()}},x=q.moveFocusLeft=function(a){w.call(this,a,-1)},y=q.moveFocusRight=function(a){w.call(this,a,1)},A=q.moveHeaderFocusEnd=function(a,b){var c;this.cellNavigation&&(c=this.headerNode.getElementsByTagName("th"),this._focusOnNode(c[b?0:c.length-1],!0,a));a.preventDefault()},z=q.moveHeaderFocusHome=function(a){A.call(this,a,!0)},B=q.moveFocusEnd=function(a,c){var d=this,e=this.cellNavigation,g=this.contentNode,l=g.scrollTop+(c?0:g.scrollHeight),g=g[c?
"firstChild":"lastChild"],h=-1<g.className.indexOf("dgrid-preload"),n=h?g[(c?"next":"previous")+"Sibling"]:g,q=n.offsetTop+(c?0:n.offsetHeight),r;if(h){for(;n&&0>n.className.indexOf("dgrid-row");)n=n[(c?"next":"previous")+"Sibling"];if(!n)return}!h||1>g.offsetHeight?(e&&(n=this.cell(n,this.cell(a).column.id)),this._focusOnNode(n,!1,a)):(b("dom-addeventlistener")||(a=f.mixin({},a)),r=k.after(this,"renderArray",function(b){r.remove();return m.when(b,function(b){b=b[c?0:b.length-1];e&&(b=d.cell(b,d.cell(a).column.id));
d._focusOnNode(b,!1,a)})}));l===q&&a.preventDefault()},C=q.moveFocusHome=function(a){B.call(this,a,!0)};q.defaultKeyMap={32:g,33:v,34:u,35:B,36:C,37:x,38:h,39:y,40:r};q.defaultHeaderKeyMap={32:g,35:A,36:z,37:x,39:y};return q})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-geometry dojo/has ../util/misc put-selector/put dojo/_base/html xstyle/css!../css/extensions/ColumnResizer.css".split(" "),function(h,k,a,f,b,e,l,m,g){function d(a){for(var b=
a.length,c=b,d=a[0].length,e=Array(b);b--;)e[b]=Array(d);for(var f={},b=0;b<c;b++)for(var g=e[b],l=a[b],h=0,m=0;h<d;h++){var k=l[m],n;if("undefined"==typeof g[h]){g[h]=k.id;if(k.rowSpan&&1<k.rowSpan){n=e;for(var q=k.rowSpan,r=b,t=h,J=k.id,L=1;L<q;L++)n[r+L][t]=J}if(0<b&&k.colSpan&&1<k.colSpan)for(n=1;n<k.colSpan;n++)if(g[++h]=k.id,k.rowSpan&&1<k.rowSpan)for(var q=e,r=k.rowSpan,t=b,J=h,L=k.id,M=1;M<r;M++)q[t+M][J]=L;f[k.id]=a[0][h].id;m++}}return f}function c(a,b,c,d,e){if(!(0>=c)){var f=a.columns[b],
g;if(f&&(g={grid:a,columnId:b,width:c,bubbles:!0,cancelable:!0},d&&(g.parentType=d),!a._resizedColumns||k.emit(a.headerNode,"dgrid-columnresize",g)))return"auto"===c?delete f.width:(f.width=c,c+="px"),(d=a._columnSizes[b])?d.set("width",c):d=m.addCssRule("#"+m.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+m.escapeCssIdentifier(b,"-"),"width: "+c+";"),a._columnSizes[b]=d,!1!==e&&a.resize(),!0}}var n,q=0,t={create:function(){n=g("div.dgrid-column-resizer")},destroy:function(){g(n,"!");n=null},
show:function(a){a=e.position(a.domNode,!0);n.style.top=a.y+"px";n.style.height=a.h+"px";g(document.body,n)},move:function(a){n.style.left=a+"px"},hide:function(){n.parentNode.removeChild(n)}};return h("dgrid.extensions.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);q++||t.create()},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();--q||t.destroy()},
resizeColumnWidth:function(a,b){return c(this,a,b)},configStructure:function(){var a=this._oldColumnSizes=f.mixin({},this._columnSizes),b;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);for(b in a)b in this._columnSizes||a[b].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var b=a.id,c;"width"in a&&((c=this._oldColumnSizes[b])?c.set("width",a.width+"px"):c=m.addCssRule("#"+m.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+m.escapeCssIdentifier(b,
"-"),"width: "+a.width+"px;"),this._columnSizes[b]=c)},renderHeader:function(){this.inherited(arguments);var b=this,c;if(this.columnSets&&this.columnSets.length)for(var e=this.columnSets.length;e--;)c=f.mixin(c||{},d(this.columnSets[e]));else this.subRows&&1<this.subRows.length&&(c=d(this.subRows));for(var e=a(".dgrid-cell",b.headerNode),h=e.length;h--;){var n=e[h],q=n.columnId,t=b.columns[q],z=n.childNodes;if(t&&!1!==t.resizable){t=g("div.dgrid-resize-header-container");for(n.contents=t;0<z.length;)g(t,
z[0]);g(n,t,"div.dgrid-resize-handle.resizeNode-"+m.escapeCssIdentifier(q,"-")).columnId=c&&c[q]||q}}b.mouseMoveListen||(k(b.headerNode,".dgrid-resize-handle:mousedown"+(l("touch")?",.dgrid-resize-handle:touchstart":""),function(a){b._resizeMouseDown(a,this);b.mouseMoveListen.resume();b.mouseUpListen.resume()}),b._listeners.push(b.mouseMoveListen=k.pausable(document,"mousemove"+(l("touch")?",touchmove":""),m.throttleDelayed(function(a){b._updateResizerPosition(a)}))),b._listeners.push(b.mouseUpListen=
k.pausable(document,"mouseup"+(l("touch")?",touchend":""),function(a){b._resizeMouseUp(a);b.mouseMoveListen.pause();b.mouseUpListen.pause()})),b.mouseMoveListen.pause(),b.mouseUpListen.pause())},_resizeMouseDown:function(c,d){c.preventDefault();b.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(c);this._targetCell=a(".dgrid-column-"+m.escapeCssIdentifier(d.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(c);t.show(this)},_resizeMouseUp:function(d){var e=this._columnSizes,
f,g,l;this.adjustLastColumn&&(l=this.headerNode.clientWidth-1);this._resizedColumns||(f=a(".dgrid-cell",this.headerNode),this.columnSets&&this.columnSets.length?f=f.filter(function(a){return"0"==a.columnId.split("-")[0]&&!(a.columnId in e)}):this.subRows&&1<this.subRows.length&&(f=f.filter(function(a){return"0"==a.columnId.charAt(0)&&!(a.columnId in e)})),g=f.map(function(a){return a.offsetWidth}),f.forEach(function(a,b){c(this,a.columnId,g[b],null,!1)},this),this._resizedColumns=!0);b.setSelectable(this.domNode,
!0);f=this._targetCell;var h=this._getResizeMouseLocation(d)-this._startX,k=f.offsetWidth+h,n=this._getResizedColumnWidths(),q=n.totalWidth,n=n.lastColId,r=a(".dgrid-column-"+m.escapeCssIdentifier(n,"-"),this.headerNode)[0].offsetWidth;k<this.minWidth&&(k=this.minWidth);c(this,f.columnId,k,d.type)&&f.columnId!=n&&this.adjustLastColumn&&(q+h<l?c(this,n,"auto",d.type):r-h<=this.minWidth&&c(this,n,this.minWidth,d.type));t.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(a){if(this._targetCell){a=
this._getResizeMouseLocation(a);var b=this._targetCell.offsetWidth,c=a;b+(a-this._startX)<this.minWidth&&(c=this._startX-(b-this.minWidth));t.move(c)}},_getResizeMouseLocation:function(a){var b=0;a.pageX?b=a.pageX:a.clientX&&(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return b},_getResizedColumnWidths:function(){var b=0,c=a((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),d=c.length;if(!d)return{};for(var e=c[d-1].columnId;d--;)b+=
c[d].offsetWidth;return{totalWidth:b,lastColId:e}}})})},"esri/tasks/FindTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ./Task ./FindResult".split(" "),function(h,k,a,f,b,e,l,m,g,d){h=h(g,{declaredClass:"esri.tasks.FindTask",constructor:function(a,b){this._url.path+="/find";this._handler=k.hitch(this,this._handler);this.gdbVersion=b&&b.gdbVersion},_handler:function(b,e,f,g,l){try{var c=[];a.forEach(b.results,
function(a,b){c[b]=new d(a)});this._successHandler([c],"onComplete",f,l)}catch(u){this._errorHandler(u,g,l)}},execute:function(a,b,d){a=this._encode(k.mixin({},this._url.query,{f:"json"},a.toJson()));var c=this._handler,e=this._errorHandler;this.gdbVersion&&(a.gdbVersion=this.gdbVersion);var g=new f(m._dfdCanceller);return g._pendingDfd=l({url:this._url.path,content:a,callbackParamName:"callback",load:function(a,e){c(a,e,b,d,g)},error:function(a){e(a,d,g)}}),g},onComplete:function(){}});return b("extend-esri")&&
k.setObject("tasks.FindTask",h,e),h})},"esri/tasks/FindResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../graphic ../geometry/jsonUtils".split(" "),function(h,k,a,f,b,e){h=h(null,{declaredClass:"esri.tasks.FindResult",constructor:function(a){k.mixin(this,a);this.feature=new b(a.geometry?e.fromJson(a.geometry):null,null,a.attributes);delete this.geometry;delete this.attributes}});return a("extend-esri")&&k.setObject("tasks.FindResult",h,f),h})},"esri/tasks/FindParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../layerUtils".split(" "),
function(h,k,a,f,b,e,l){h=h(null,{declaredClass:"esri.tasks.FindParameters",searchText:null,contains:!0,searchFields:null,outSpatialReference:null,layerIds:null,returnGeometry:!1,layerDefinitions:null,dynamicLayerInfos:null,toJson:function(){var b={searchText:this.searchText,contains:this.contains,returnGeometry:this.returnGeometry,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},e=this.layerIds,d=this.searchFields,c=this.outSpatialReference;if(e&&(b.layers=e.join(",")),
d&&(b.searchFields=d.join(",")),c&&(b.sr=c.wkid||f.toJson(c.toJson())),b.layerDefs=l._serializeLayerDefinitions(this.layerDefinitions,!0),this.dynamicLayerInfos&&0<this.dynamicLayerInfos.length){var h=[];a.forEach(this.dynamicLayerInfos,function(b){if(!b.subLayerIds){var c=b.id;if(this.layerIds&&-1!==a.indexOf(this.layerIds,c)){var d={id:c};d.source=b.source&&b.source.toJson();var e;this.layerDefinitions&&this.layerDefinitions[c]&&(e=this.layerDefinitions[c]);e&&(d.definitionExpression=e);h.push(d)}}},
this);e=f.toJson(h);"[]"===e&&(e="[{}]");b.dynamicLayers=e}return b}});return b("extend-esri")&&k.setObject("tasks.FindParameters",h,e),h})},"cmv/viewer/js/gis/dijit/Find/nls/resource":function(){define({root:{selectQuery:"Select query",searchText:{label:"Search for",placeholder:"Enter the text you want to search for."},exactMatches:"Find exact matches only",searchButton:{label:"Search",busyLabel:"searching"},clearButton:{label:"Clear"},searching:"Searching...",resultsLabel:{multipleResultsSuffix:"s",
labelPrefix:"Result",labelSuffix:"found"},noResultsLabel:"No results found.",optionsLabel:"Options",zoomOnSelect:"Zoom on select",zoomOnDeselect:"Zoom on deselect"},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),function(h,k,a,f,b,e,l,m,g){f("dijit-legacy-requires")&&e(0,function(){h(["dijit/form/RadioButton"])});
return k("dijit.form.CheckBox",[l,m],{templateString:g,baseClass:"dijitCheckBox",_setValueAttr:function(a,b){"string"==typeof a&&(this.inherited(arguments),a=!0);this._created&&this.set("checked",a,b)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},_fillContent:function(){},_onFocus:function(){this.id&&b("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");
this.inherited(arguments)},_onBlur:function(){this.id&&b("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(h,k){return h("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(a){this._set("readOnly",a);k.set(this.focusNode,"readOnly",a)},_setLabelAttr:void 0,_getSubmitValue:function(a){return null==
a||""===a?"on":a},_setValueAttr:function(a){a=this._getSubmitValue(a);this._set("value",a);k.set(this.focusNode,"value",a)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));k.set(this.focusNode,"value",this.value)},_onClick:function(a){return this.readOnly?(a.stopPropagation(),a.preventDefault(),!1):this.inherited(arguments)}})})},"cmv/viewer/js/gis/dijit/Identify":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/MenuItem dojo/_base/lang dojo/_base/array dojo/promise/all dojo/topic dojo/query dojo/dom-style dojo/dom-class dojo/dnd/Moveable dojo/store/Memory esri/tasks/IdentifyTask esri/tasks/IdentifyParameters esri/dijit/PopupTemplate esri/layers/FeatureLayer esri/TimeExtent dojo/Deferred dojo/text!./Identify/templates/Identify.html dojo/i18n!./Identify/nls/resource ./Identify/Formatters dijit/form/Form dijit/form/FilteringSelect xstyle/css!./Identify/css/Identify.css".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B){return h([k,a,f],{widgetsInTemplate:!0,templateString:A,baseClass:"gis_IdentifyDijit",i18n:z,mapClickMode:null,identifies:{},infoTemplates:{},featureLayers:{},ignoreOtherGraphics:!0,createDefaultInfoTemplates:!0,draggable:!1,layerSeparator:"||",allLayersId:"***",excludedFields:"objectid esri_oid shape shape.len shape_length shape_len shape.stlength() shape.area shape_area shape.starea()".split(" "),defaultFormatters:{esriFieldTypeSmallInteger:B.formatInt,
esriFieldTypeInteger:B.formatInt,esriFieldTypeSingle:B.formatFloat,esriFieldTypeDouble:B.formatFloat,esriFieldTypeDate:B.formatDate},postCreate:function(){this.inherited(arguments);this.identifies||(this.identifies={});this.layers=[];this.addLayerInfos(this.layerInfos);this.own(g.subscribe("mapClickMode/currentSet",e.hitch(this,"setMapClickMode")));this.own(g.subscribe("identify/addLayerInfos",e.hitch(this,"addLayerInfos")));this.map.on("click",e.hitch(this,function(a){"identify"===this.mapClickMode&&
this.executeIdentifyTask(a)}));this.mapRightClickMenu&&this.addRightClickMenu();this.parentWidget&&(this.createIdentifyLayerList(),this.map.on("update-end",e.hitch(this,function(){this.createIdentifyLayerList()})));this.draggable&&this.setupDraggable()},addLayerInfos:function(a){l.forEach(a,e.hitch(this,"addLayerInfo"))},addLayerInfo:function(a){var b=this.map.getLayer(a.layer.id),c;if(b){var d=b.url;if("esri.layers.FeatureLayer"===b.declaredClass){if(b.capabilities&&0>l.indexOf(b.capabilities.toLowerCase(),
"data")&&!b.infoTemplate&&(c=this.getInfoTemplate(b,b.layerId))&&(b.setInfoTemplate(c),0<l.filter(c.info.fieldInfos,function(a){return a.formatter}).length))b.on("graphic-draw",e.hitch(this,"getFormattedFeature",b.infoTemplate));c=d.lastIndexOf("/"+b.layerId);0<c&&(d=d.substring(0,c))}else b.layerInfos&&l.forEach(b.layerInfos,e.hitch(this,function(c){c=c.id;(null===a.layerIds||0<=l.indexOf(a.layerIds,c))&&this.getFeatureLayerForDynamicSublayer(b,c)}));this.layers.push({ref:b,layerInfo:a,identifyTask:new r(d)});
if(this.parentWidget)b.on("visibility-change",e.hitch(this,function(a){!1===a.visible&&this.createIdentifyLayerList()}))}},addRightClickMenu:function(){this.map.on("MouseDown",e.hitch(this,function(a){this.mapRightClick=a}));this.mapRightClickMenu.addChild(new b({label:this.i18n.rightClickMenuItem.label,onClick:e.hitch(this,"handleRightClick")}))},setupDraggable:function(){var a,b,e;a=d("div.esriPopup");b=d("div.esriPopup div.titlePane div.title");e=d("div.esriPopup div.outerPointer, div.esriPopup div.pointer");
0<a.length&&0<b.length&&(c.set(b[0],"cursor","move"),a=new q(a[0],{handle:b[0]}),0<e.length&&(a.onMoveStart=function(){l.forEach(e,function(a){n.remove(a,"left right top bottom topLeft topRight bottomLeft bottomRight")})}))},executeIdentifyTask:function(a){var b=a.mapPoint,c=this.createIdentifyParams(b),d=[],f=[],g=this.getSelectedLayer();if(!this.checkForGraphicInfoTemplate(a)){var h=l.filter(this.layers,function(b){return b.ref.id===a.graphic._layer.id})[0];if(!h)return;f.push(h);h=new y;d.push(h.promise);
h.resolve([{feature:a.graphic}])}this.map.infoWindow.hide();this.map.infoWindow.clearFeatures();a.shiftKey||a.ctrlKey||a.altKey||(l.forEach(this.layers,e.hitch(this,function(a){var b=this.getLayerIds(a,g);if(0<b.length){var l=e.clone(c);l.layerDefinitions=a.ref.layerDefinitions;l.layerIds=b;a.ref.timeInfo&&a.ref.timeInfo.timeExtent&&this.map.timeExtent&&(l.timeExtent=new x(this.map.timeExtent.startTime,this.map.timeExtent.endTime));d.push(a.identifyTask.execute(l));f.push(a)}})),0<d.length&&(this.map.infoWindow.setTitle(this.i18n.mapInfoWindow.identifyingTitle),
this.map.infoWindow.setContent('\x3cdiv class\x3d"loading"\x3e\x3c/div\x3e'),this.map.infoWindow.show(b),m(d).then(e.hitch(this,"identifyCallback",f),e.hitch(this,"identifyError"))))},checkForGraphicInfoTemplate:function(a){return a.graphic&&(a=a.graphic._layer,a.infoTemplate||a.capabilities&&0>l.indexOf(a.capabilities.toLowerCase(),"data")||!(this.ignoreOtherGraphics||this.identifies.hasOwnProperty(a.id)&&!isNaN(a.layerId)&&this.identifies[a.id].hasOwnProperty(a.layerId)))?!1:!0},createIdentifyParams:function(a){var b=
new v;b.tolerance=this.identifyTolerance;b.returnGeometry=!0;b.layerOption=v.LAYER_OPTION_VISIBLE;b.geometry=a;b.mapExtent=this.map.extent;b.width=this.map.width;b.height=this.map.height;b.spatialReference=this.map.spatialReference;return b},getSelectedLayer:function(){var a=this.allLayersId;if(this.parentWidget){var b=this.identifyFormDijit.get("value");b.identifyLayer&&""!==b.identifyLayer?a=b.identifyLayer:this.identifyLayerDijit.set("value",a)}return a},getLayerIds:function(a,b){var c=b.split(this.layerSeparator),
d=this.allLayersId,e=a.ref,f=a.layerInfo.layerIds,g=[];!e.visible||c[0]!==d&&e.id!==c[0]||(1<c.length&&c[1]?g=[c[1]]:"esri.layers.FeatureLayer"!==e.declaredClass||isNaN(e.layerId)?e.layerInfos&&(g=this.getLayerInfos(e,f)):e.capabilities&&0<=l.indexOf(e.capabilities.toLowerCase(),"data")&&(g=[e.layerId]));return g},getLayerInfos:function(a,b){var c=[];l.forEach(a.layerInfos,e.hitch(this,function(d){this.includeSubLayer(d,a,b)&&c.push(d.id)}));return c},identifyCallback:function(a,b){var c=[];l.forEach(b,
function(b,d){var e=a[d].ref;l.forEach(b,function(a){a.feature.geometry.spatialReference=this.map.spatialReference;if(void 0===a.feature.infoTemplate){var b=this.getInfoTemplate(e,null,a);if(b)a.layerId&&e.layerInfos&&b.info.showAttachments&&(a.feature._layer=this.getFeatureLayerForDynamicSublayer(e,a.layerId)),a.feature.setInfoTemplate(b);else return}a=this.getFormattedFeature(a.feature.infoTemplate,a.feature);c.push(a)},this)},this);this.map.infoWindow.setFeatures(c)},getFormattedFeature:function(a,
b){b.graphic&&(b=b.graphic);b&&a&&a.info&&l.forEach(a.info.fieldInfos,function(a){"function"===typeof a.formatter&&(b.attributes[a.fieldName]=a.formatter(b.attributes[a.fieldName],b.attributes,e.clone(b.geometry)))});return b},identifyError:function(a){this.map.infoWindow.hide();g.publish("viewer/handleError",{source:"Identify",error:a})},handleRightClick:function(){this.executeIdentifyTask(this.mapRightClick)},getInfoTemplate:function(a,b,c){var d;c?b="number"===typeof c.layerId?c.layerId:a.layerId:
null===b&&(b=a.layerId);var f=this.identifies;if(f.hasOwnProperty(a.id)){if(f[a.id].hasOwnProperty(b)&&(d=f[a.id][b],d instanceof u))return d}else f[a.id]={};c=e.mixin(this.createDefaultInfoTemplate(a,b,c),f[a.id][b]||{});d=f[a.id][b]=new u(c);c.content&&d.setContent(c.content);return f[a.id][b]},createDefaultInfoTemplate:function(a,b,c){b=null;var d=[],f=this.getLayerName(a);c&&(f=c.layerName);if(c&&c.feature){if(c=c.feature.attributes)for(var g in c)c.hasOwnProperty(g)&&this.addDefaultFieldInfo(d,
{fieldName:g,label:this.makeSentenceCase(g),visible:!0})}else if(a._outFields&&a._outFields.length&&"*"!==a._outFields[0]){var h=a.fields;l.forEach(a._outFields,e.hitch(this,function(a){var b=l.filter(h,function(b){return b.name===a});0<b.length&&this.addDefaultFieldInfo(d,{fieldName:b[0].name,label:b[0].alias,visible:!0})}))}else a.fields&&l.forEach(a.fields,e.hitch(this,function(a){this.addDefaultFieldInfo(d,{fieldName:a.name,label:a.alias===a.name?this.makeSentenceCase(a.name):a.alias,visible:!0})}));
0<d.length&&(b={title:f,fieldInfos:d,showAttachments:a.hasAttachments});return b},makeSentenceCase:function(a){if(!a.length)return"";a=a.toLowerCase().replace(/_/g," ").split(" ");for(var b=0;b<a.length;b++)a[b]=a[b].charAt(0).toUpperCase()+(a[b].substr(1).length?a[b].substr(1):"");return a.length?a.join(" "):a},addDefaultFieldInfo:function(a,b){var c=b.fieldName.toLowerCase();0>l.indexOf(this.excludedFields,c)&&a.push(b)},createIdentifyLayerList:function(){var a=null,b=[],c=this.identifyLayerDijit.get("value"),
d=this.layerSeparator;l.forEach(this.layers,e.hitch(this,function(f){var g=f.ref,h=f.layerInfo.layerIds;if(g.visible){var m=this.getLayerName(f);"esri.layers.FeatureLayer"!==g.declaredClass||isNaN(g.layerId)?l.forEach(g.layerInfos,e.hitch(this,function(e){this.includeSubLayer(e,g,h)&&(b.push({name:m+" \\ "+e.name,id:g.id+d+e.id}),g.id+d+e.id===c&&(a=c))})):(b.push({name:m,id:g.id+d+g.layerId}),g.id+d+g.layerId===c&&(a=c))}}));b.sort(function(a,b){return a.name>b.name?1:b.name>a.name?-1:0});this.identifyLayerDijit.set("disabled",
1>b.length);0<b.length&&(b.unshift({name:this.i18n.labels.allVisibleLayers,id:"***"}),a||(a=b[0].id));var f=new t({data:b});this.identifyLayerDijit.set("store",f);this.identifyLayerDijit.set("value",a)},includeSubLayer:function(a,b,c){return null!==a.subLayerIds||this.isDefaultLayerVisibility(b)&&!this.checkVisibilityRecursive(b,a.id)||0>l.indexOf(b.visibleLayers,a.id)?!1:!this.layerVisibleAtCurrentScale(a)||c&&0>l.indexOf(c,a.id)||!this.createDefaultInfoTemplates&&!this.getInfoTemplate(b,a.id)?!1:
!0},checkVisibilityRecursive:function(a,b){var c=l.filter(a.layerInfos,function(a){return a.id===b});return 0<c.length&&(c=c[0],-1!==a.visibleLayers.indexOf(b)&&(-1===c.parentLayerId||this.checkVisibilityRecursive(a,c.parentLayerId)))?!0:!1},isDefaultLayerVisibility:function(a){for(var b=0;b<a.layerInfos.length;b++){var c=a.layerInfos[b];if(c.defaultVisibility&&-1===a.visibleLayers.indexOf(c.id))return!1}return!0},getLayerName:function(a){var b=null;a.layerInfo&&(b=a.layerInfo.title);b||l.forEach(this.layers,
function(c){c.ref.id===a.id&&(b=c.layerInfo.title)});b||(b=a.name,!b&&a.ref&&(b=a.ref._titleForLegend));return b},getFeatureLayerForDynamicSublayer:function(a,b){if(!a.layerInfos)return!1;var c=a.url+"/"+b;this.featureLayers.hasOwnProperty(c)||(this.featureLayers[c]=new w(c));return this.featureLayers[c]},layerVisibleAtCurrentScale:function(a){var b=this.map.getScale();return!(0!==a.maxScale&&b<a.maxScale||0!==a.minScale&&b>a.minScale)},setMapClickMode:function(a){this.mapClickMode=a;var b=this.map;
l.forEach(b.graphicsLayerIds,function(c){if(c=b.getLayer(c))"identify"===a?this.infoTemplates[c.id]&&(c.infoTemplate=e.clone(this.infoTemplates[c.id])):c.infoTemplate&&(this.infoTemplates[c.id]=e.clone(c.infoTemplate),c.infoTemplate=null)},this)}})})},"esri/tasks/IdentifyTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../request ../geometry/normalizeUtils ./Task ./IdentifyResult".split(" "),function(h,k,a,f,b,e,l,m,g){h=h(m,{declaredClass:"esri.tasks.IdentifyTask",
_eventMap:{complete:["results"]},constructor:function(a,b){this._url.path+="/identify";this._handler=k.hitch(this,this._handler);this.gdbVersion=b&&b.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",c:3,a:[{i:0,p:["geometry"]}],e:2}],_handler:function(b,c,e,f,l){try{var d=[];a.forEach(b.results,function(a,b){d[b]=new g(a)});this._successHandler([d],"onComplete",e,l)}catch(v){this._errorHandler(v,f,l)}},execute:function(a,b,f,g){var c=g.assembly;a=this._encode(k.mixin({},this._url.query,
{f:"json"},a.toJson(c&&c[0])));var d=this._handler,l=this._errorHandler;return this.gdbVersion&&(a.gdbVersion=this.gdbVersion),e({url:this._url.path,content:a,callbackParamName:"callback",load:function(a,c){d(a,c,b,f,g.dfd)},error:function(a){l(a,f,g.dfd)}})},onComplete:function(){}});return l._createWrappers(h),f("extend-esri")&&k.setObject("tasks.IdentifyTask",h,b),h})},"esri/tasks/IdentifyResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../graphic ../geometry/jsonUtils".split(" "),
function(h,k,a,f,b,e){h=h(null,{declaredClass:"esri.tasks.IdentifyResult",constructor:function(a){k.mixin(this,a);this.feature=new b(a.geometry?e.fromJson(a.geometry):null,null,a.attributes);delete this.geometry;delete this.attributes}});return a("extend-esri")&&k.setObject("tasks.IdentifyResult",h,f),h})},"esri/tasks/IdentifyParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../layerUtils ../geometry/jsonUtils ../geometry/scaleUtils".split(" "),
function(h,k,a,f,b,e,l,m,g){var d=h(null,{declaredClass:"esri.tasks.IdentifyParameters",constructor:function(){this.layerOption=d.LAYER_OPTION_TOP},geometry:null,spatialReference:null,layerIds:null,tolerance:null,returnGeometry:!1,mapExtent:null,width:400,height:400,dpi:96,layerDefinitions:null,timeExtent:null,layerTimeOptions:null,dynamicLayerInfos:null,toJson:function(b){var c=b&&b.geometry||this.geometry,d=this.mapExtent,e=this.spatialReference,h=this.layerIds;b={tolerance:this.tolerance,returnGeometry:this.returnGeometry,
imageDisplay:this.width+","+this.height+","+this.dpi,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision};if(c){var k=c.toJson();delete k.spatialReference;b.geometry=f.toJson(k);b.geometryType=m.getJsonType(c)}e?b.sr=e.wkid||f.toJson(e.toJson()):c&&c.spatialReference?b.sr=c.spatialReference.wkid||f.toJson(c.spatialReference.toJson()):d&&d.spatialReference&&(b.sr=d.spatialReference.wkid||f.toJson(d.spatialReference.toJson()));d&&(b.mapExtent=d.xmin+","+d.ymin+","+d.xmax+
","+d.ymax);b.layers=this.layerOption;h&&(b.layers+=":"+h.join(","));b.layerDefs=l._serializeLayerDefinitions(this.layerDefinitions,!0);c=this.timeExtent;if(b.time=c?c.toJson().join(","):null,b.layerTimeOptions=l._serializeTimeOptions(this.layerTimeOptions),this.dynamicLayerInfos&&0<this.dynamicLayerInfos.length){var d=g.getScale({extent:d,width:this.width,spatialReference:d.spatialReference}),u=l._getLayersForScale(d,this.dynamicLayerInfos),w=[];a.forEach(this.dynamicLayerInfos,function(b){if(!b.subLayerIds){var c=
b.id;if((!this.layerIds||this.layerIds&&-1!==a.indexOf(this.layerIds,c))&&-1!==a.indexOf(u,c)){var d={id:c};d.source=b.source&&b.source.toJson();var e;this.layerDefinitions&&this.layerDefinitions[c]&&(e=this.layerDefinitions[c]);e&&(d.definitionExpression=e);var f;this.layerTimeOptions&&this.layerTimeOptions[c]&&(f=this.layerTimeOptions[c]);f&&(d.layerTimeOptions=f.toJson());w.push(d)}}},this);d=f.toJson(w);"[]"===d&&(d="[{}]");b.dynamicLayers=d}return b}});return k.mixin(d,{LAYER_OPTION_TOP:"top",
LAYER_OPTION_VISIBLE:"visible",LAYER_OPTION_ALL:"all"}),b("extend-esri")&&k.setObject("tasks.IdentifyParameters",d,e),d})},"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),function(h,k,a,f,b,e,l,m){h=h([e,l],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(a,b){k.mixin(this,b);this.initialize(a,b)},getTitle:function(a){var b;
return this.info&&(b=this.titleHasRelatedFields?"":this._getPopupValues(a,!0).title),b||""},getContent:function(a){return this.info?(new m({template:this,graphic:a,chartTheme:this.chartTheme},f.create("div"))).domNode:""}});return a("extend-esri")&&k.setObject("dijit.PopupTemplate",h,b),h})},"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all ./lang ./kernel ./request ./tasks/query ./tasks/QueryTask ./tasks/RelationshipQuery ./tasks/StatisticDefinition dojo/i18n!dojo/cldr/nls/number".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u){h=h(null,{declaredClass:"esri.PopupInfo",initialize:function(b,c){if(b){k.mixin(this,c);this.info=b;this.title=this.getTitle;this.content=this.getContent;var d=this._fieldLabels={},e=this._fieldsMap={};b.fieldInfos&&a.forEach(b.fieldInfos,function(a){var b=a.fieldName.toLowerCase();d[b]=a.label;e[b]=a});this._relatedFieldPrefix="relationships/";this.titleHasRelatedFields=!(!b.title||-1===b.title.indexOf("{"+this._relatedFieldPrefix))}},toJson:function(){return f.fromJson(f.toJson(this.info))},
getTitle:function(){},getContent:function(){},getFieldInfo:function(b){var c;return a.some(this.info&&this.info.fieldInfos,function(a){return a.fieldName===b&&(c=a),!!c}),c},getComponents:function(b){var c,d,e=this.info,f=new l;return e.fieldInfos&&(d=a.filter(e.fieldInfos,function(a){return-1!==a.fieldName.indexOf(this._relatedFieldPrefix)},this)),d&&0<d.length&&(c=this._getRelatedRecords({graphic:b,fieldsInfo:d})),c?c.always(k.hitch(this,function(){f.resolve(this._getPopupValues(b))})):f.resolve(this._getPopupValues(b)),
f.promise},getAttachments:function(a){var b=a.getLayer();a=a.attributes;if(this.info.showAttachments&&b&&b.hasAttachments&&b.objectIdField&&(a=a&&a[b.objectIdField]))return b.queryAttachmentInfos(a)},_getPopupValues:function(b,c){var e,f,g,l,h,m=this.info,n=b.getLayer(),q=k.clone(b.attributes)||{},r=k.clone(q),t=m.fieldInfos,u="",v="",w=n&&n._getDateOpts&&n._getDateOpts().properties,w=w&&w.slice(0),x={dateFormat:{properties:w,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)}};
if(this._relatedInfo)for(l in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(l)){var K=this._relatedInfo[l],P=this._relatedLayersInfo[l];K&&(a.forEach(K.relatedFeatures,function(a){for(h in a.attributes)if(a.attributes.hasOwnProperty(h)&&"esriRelCardinalityOneToOne"===P.relation.cardinality){var b=this._toRelatedFieldName([P.relation.id,h]);q[b]=r[b]=a.attributes[h]}},this),a.forEach(K.relatedStatsFeatures,function(a){for(h in a.attributes)if(a.attributes.hasOwnProperty(h)){var b=this._toRelatedFieldName([P.relation.id,
h]);q[b]=r[b]=a.attributes[h]}},this))}if(t&&a.forEach(t,function(b){f=b.fieldName;var c=this._getLayerFieldInfo(n,f);c&&(f=b.fieldName=c.name);if(r[f]=this._formatValue(r[f],f,x),w&&b.format&&b.format.dateFormat)b=a.indexOf(w,f),-1<b&&w.splice(b,1)},this),n){l=n.types;var O=(K=n.typeIdField)&&q[K];for(f in q)if(q.hasOwnProperty(f)&&-1===f.indexOf(this._relatedFieldPrefix)&&(g=q[f],d.isDefined(g))){var S=this._getDomainName(n,b,l,O,f,g);d.isDefined(S)?r[f]=S:f===K&&(S=this._getTypeName(n,b,g),d.isDefined(S)&&
(r[f]=S))}}if(m.title&&(u=this._processFieldsInLinks(this._fixTokens(m.title,n),q),u=k.trim(d.substitute(r,u,x)||"")),c)return{title:u};m.description&&(v=this._processFieldsInLinks(this._fixTokens(m.description,n),q),v=k.trim(d.substitute(r,v,x)||""));t&&(e=[],a.forEach(t,function(a){(f=a.fieldName)&&a.visible&&e.push([a.label||f,d.substitute(r,"${"+f+"}",x)||""])}));var Q,R;return m.mediaInfos&&(Q=[],a.forEach(m.mediaInfos,function(b){switch(R=0,g=b.value,b.type){case "image":var c=g.sourceURL,c=
c&&k.trim(d.substitute(q,this._fixTokens(c,n)));R=!!c;break;case "piechart":case "linechart":case "columnchart":case "barchart":var e,c=g.normalizeField;g.fields=a.map(g.fields,function(a){return e=this._getLayerFieldInfo(n,a),e?e.name:a},this);c&&(e=this._getLayerFieldInfo(n,c),g.normalizeField=e?e.name:c);R=a.some(g.fields,function(a){return d.isDefined(q[a])||-1!==a.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(R){b=k.clone(b);g=b.value;var c=b.title?this._processFieldsInLinks(this._fixTokens(b.title,
n),q):"",f=b.caption?this._processFieldsInLinks(this._fixTokens(b.caption,n),q):"";if(b.title=c?k.trim(d.substitute(r,c,x)||""):"",b.caption=f?k.trim(d.substitute(r,f,x)||""):"","image"===b.type)g.sourceURL=d.substitute(q,this._fixTokens(g.sourceURL,n)),g.linkURL&&(g.linkURL=k.trim(d.substitute(q,this._fixTokens(g.linkURL,n))||""));else{var l,h;a.forEach(g.fields,function(a,b){if(-1!==a.indexOf(this._relatedFieldPrefix))h=this._getRelatedChartInfos(a,g,q,x),h instanceof Array?g.fields=h:g.fields[b]=
h;else{var c=q[a],c=void 0===c?null:c;l=q[g.normalizeField]||0;c&&l&&(c/=l);g.fields[b]={y:c,tooltip:(this._fieldLabels[a.toLowerCase()]||a)+":\x3cbr/\x3e"+this._formatValue(c,a,x,!!l)}}},this)}Q.push(b)}},this)),{title:u,description:v,hasDescription:!!m.description,fields:e&&e.length?e:null,mediaInfos:Q&&Q.length?Q:null,formatted:r,editSummary:n&&n.getEditSummary?n.getEditSummary(b):""}},_getRelatedChartInfos:function(b,c,e,f){var g,l,h,m,k,n,q;return g=[],q=this._fromRelatedFieldName(b),k=q[0],
l=this._relatedInfo[k],n=this._relatedLayersInfo[k],l&&a.forEach(l.relatedFeatures,function(a){var l,k=a.attributes;for(l in k)if(k.hasOwnProperty(l)&&l===q[1]){if(a={},m=k[l],c.normalizeField&&(h=-1!==c.normalizeField.indexOf(this._relatedFieldPrefix)?k[this._fromRelatedFieldName(c.normalizeField)[1]]:e[c.normalizeField]),m&&h&&(m/=h),c.tooltipField)if(-1!==c.tooltipField.indexOf(this._relatedFieldPrefix)){var n=this._fromRelatedFieldName(c.tooltipField)[1],r=d.isDefined(k[n])?k[n]:n;a.tooltip=r+
":\x3cbr/\x3e"+this._formatValue(m,n,f,!!h)}else a.tooltip=(this._fieldLabels[b.toLowerCase()]||b)+":\x3cbr/\x3e"+this._formatValue(m,c.tooltipField,f,!!h);else a.tooltip=m;a.y=m;g.push(a)}},this),"esriRelCardinalityOneToMany"===n.relation.cardinality||"esriRelCardinalityManyToMany"===n.relation.cardinality?g:g[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",
dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",
shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",
year:"(datePattern: 'y', selector: 'date')"},_reHref:/href\s*=\s*\"([^\"]+)\"/gi,_reHrefApos:/href\s*=\s*\'([^\']+)\'/gi,_fixTokens:function(a,b){var c=this;return a.replace(/(\{([^\{\r\n]+)\})/g,function(a,d,e){a=c._getLayerFieldInfo(b,e);return"$"+(a?"{"+a.name+"}":d)})},_encodeAttributes:function(a){var b,c,d=k.clone(a)||{};for(b in d)(a=d[b])&&"string"==typeof a&&(c=encodeURIComponent(a).replace(/\'/g,"\x26apos;"),d[b]=c);return d},_processFieldsInLinks:function(a,b){var c=this._encodeAttributes(b),
d=this;return a&&(a=a.replace(this._reHref,function(a,e){return d._addValuesToHref(a,e,b,c)}).replace(this._reHrefApos,function(a,e){return d._addValuesToHref(a,e,b,c)})),a},_addValuesToHref:function(a,b,c,e){return b=b&&k.trim(b),d.substitute((b?0!==b.indexOf("${"):1)?e:c,a)},_getLayerFieldInfo:function(a,b){return a&&a.getField?a.getField(b):null},_formatValue:function(b,c,e,f){var g=this._fieldsMap[c.toLowerCase()],l=g&&g.format;c=-1!==a.indexOf(e.dateFormat.properties,c);var h=!("number"!=typeof b||
c||l&&l.dateFormat);if(!d.isDefined(b)||!g||!d.isDefined(l))return h?this._forceLTR(b):b;var m="",g=[],n=l.hasOwnProperty("places")||l.hasOwnProperty("digitSeparator"),q=l.hasOwnProperty("digitSeparator")?l.digitSeparator:!0;if(n&&!c)m="NumberFormat",g.push("places: "+(d.isDefined(l.places)&&(!f||0<l.places)?Number(l.places):"Infinity")),g.length&&(m+="("+g.join(",")+")");else{if(!l.dateFormat)return h?this._forceLTR(b):b;m="DateFormat"+this._insertOffset(this._dateFormats[l.dateFormat]||this._dateFormats.shortDateShortTime)}var r=
this._applyFormatting(b,m,e);return n&&-1<b.constructor.toString().indexOf("Array")&&(r="",a.forEach(b,k.hitch(this,function(a,b){b&&(r+=" ");r+=this._applyFormatting(a,m,e)}))),n&&!q&&u.group&&(r=r.replace(new RegExp("\\"+u.group,"g"),"")),c&&(r='\x3cspan class\x3d"esriDateValue"\x3e'+r+"\x3c/span\x3e"),h?this._forceLTR(r):r},_applyFormatting:function(a,b,c){return d.substitute({myKey:a},"${myKey:"+b+"}",c)||""},_forceLTR:function(a){var b=m("ie");return b&&10>=b?a:"\x3cspan class\x3d'esriNumericValue'\x3e"+
a+"\x3c/span\x3e"},_insertOffset:function(a){return a&&(a=d.isDefined(this.utcOffset)?a.replace(/\)\s*$/,", utcOffset:"+this.utcOffset+")"):a),a},_getDomainName:function(a,b,c,d,e,f){return(a=a.getDomain&&a.getDomain(e,{feature:b}))&&a.codedValues?a.getName(f):null},_getTypeName:function(a,b,c){return(a=a.getType&&a.getType(b))&&a.name},_getRelatedRecords:function(a){var b,c=a.graphic,d=new l;return this._relatedLayersInfo?this._queryRelatedLayers(c).then(k.hitch(this,function(a){this._setRelatedRecords(c,
a);d.resolve(a)}),k.hitch(this,this._handlerErrorResponse,d)):this._getRelatedLayersInfo(a).then(k.hitch(this,function(a){for(b in a)a.hasOwnProperty(b)&&a[b]&&(this._relatedLayersInfo[b].relatedLayerInfo=a[b]);this._queryRelatedLayers(c).then(k.hitch(this,function(a){this._setRelatedRecords(c,a);d.resolve(a)}),k.hitch(this,this._handlerErrorResponse,d))}),k.hitch(this,this._handlerErrorResponse,d)),d.promise},_getRelatedLayersInfo:function(b){var c,d,e=b.fieldsInfo,f={};c=b.graphic.getLayer();this._relatedLayersInfo||
(this._relatedLayersInfo={});a.forEach(e,function(b){var d,e,f,g;d=this._fromRelatedFieldName(b.fieldName);e=d[0];d=d[1];e&&(this._relatedLayersInfo[e]||(a.some(c.relationships,function(a){return a.id==e?(g=a,!0):void 0}),g&&(this._relatedLayersInfo[e]={relation:g,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[e]&&(this._relatedLayersInfo[e].relatedFields.push(d),b.statisticType&&(f=new v,f.statisticType=b.statisticType,f.onStatisticField=d,f.outStatisticFieldName=d,this._relatedLayersInfo[e].outStatistics.push(f))))},
this);for(d in this._relatedLayersInfo)if(this._relatedLayersInfo.hasOwnProperty(d)){var l,h;this._relatedLayersInfo[d]&&(l=this._relatedLayersInfo[d].relation,h=c.url.replace(/[0-9]+$/,l.relatedTableId),this._relatedLayersInfo[d].relatedLayerUrl=h,f[d]=n({url:h,content:{f:"json"},callbackParamName:"callback"}))}return g(f)},_queryRelatedLayers:function(a){var b,c={};for(b in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(b)&&(c[b]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[b]}));
return g(c)},_queryRelatedLayer:function(b){var c,d,e,f,h,m,n,r,u,v,w,J,L,M,H;return c=b.graphic,d=c.getLayer(),e=d.url.match(/[0-9]+$/g)[0],J=b.relatedInfo,v=J.relatedLayerInfo,L=J.relatedLayerUrl,M=J.relation,a.some(v.relationships,function(a){return a.relatedTableId===parseInt(e,10)?(f=a,!0):void 0},this),f&&(h=new q,a.some(v.fields,function(b){return b.name===f.keyField?(r=-1!==a.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],b.type)?"number":
"string",!0):void 0}),f.relationshipTableId&&f.keyFieldInRelationshipTable?(H=new l,this._queryRelatedRecords(c,f).then(k.hitch(this,function(b){var e;e=b[c.attributes[d.objectIdField]];b=a.map(e.features,function(a){return a.attributes[v.objectIdField]},this);J.outStatistics&&0<J.outStatistics.length&&v.supportsStatistics&&(u=new q,u.objectIds=b,u.outFields=h.outFields,u.outStatistics=J.outStatistics);u&&(m=new t(L),m.execute(u).then(k.hitch(this,function(a){var b=[];b.push(e);b.push(a);H.resolve(b)})))}))):
(n="string"===r?f.keyField+"\x3d'"+c.attributes[M.keyField]+"'":f.keyField+"\x3d"+c.attributes[M.keyField],h.where=n,h.outFields=J.relatedFields,J.outStatistics&&0<J.outStatistics.length&&v.supportsStatistics&&(u=new q,u.where=h.where,u.outFields=h.outFields,u.outStatistics=J.outStatistics),m=new t(L),w=[],w.push(m.execute(h)),u&&w.push(m.execute(u)))),w?g(w):H?H.promise:void 0},_setRelatedRecords:function(a,b){this._relatedInfo=[];for(var c in b)if(b.hasOwnProperty(c)&&b[c]){var e=b[c];this._relatedInfo[c]=
{};this._relatedInfo[c].relatedFeatures=e[0].features;d.isDefined(e[1])&&(this._relatedInfo[c].relatedStatsFeatures=e[1].features)}},_handlerErrorResponse:function(a,b){a.reject(b)},_fromRelatedFieldName:function(a){var b,c=[];return-1!==a.indexOf(this._relatedFieldPrefix)&&(b=a.split("/"),c=b.slice(1)),c},_toRelatedFieldName:function(a){var b="";return a&&0<a.length&&(b=this._relatedFieldPrefix+a[0]+"/"+a[1]),b},_queryRelatedRecords:function(a,b){var c=a.getLayer(),d=new r;return d.outFields=["*"],
d.relationshipId=b.id,d.objectIds=[a.attributes[c.objectIdField]],c.queryRelatedFeatures(d)}});return e("extend-esri")&&(c.PopupInfo=c.PopupInfoTemplate=h),h})},"esri/tasks/RelationshipQuery":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","dojo/has","../kernel"],function(h,k,a,f,b){h=h(null,{declaredClass:"esri.tasks.RelationshipQuery",definitionExpression:"",relationshipId:null,returnGeometry:!1,objectIds:null,outSpatialReference:null,outFields:null,toJson:function(){var b=
{definitionExpression:this.definitionExpression,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},f=this.objectIds,h=this.outFields,g=this.outSpatialReference;return f&&(b.objectIds=f.join(",")),h&&(b.outFields=h.join(",")),g&&(b.outSR=g.wkid||a.toJson(g.toJson())),b._ts=this._ts,b}});return f("extend-esri")&&k.setObject("tasks.RelationshipQuery",h,b),h})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y){var A=0;k=k([x,r,v],{declaredClass:"esri.dijit._PopupRenderer",constructor:function(){this._nls=f.mixin({},y.widgets.popup)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this.template.getComponents(this.graphic).then(f.hitch(this,this._handleComponentsSuccess),f.hitch(this,this._handleComponentsError))},destroy:function(){this._dfd&&this._dfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._dfd=null;this.inherited(arguments)},_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+
1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var a=this._mediaInfos,f=a.length,g=this.domNode,l=this._prevMedia,h=this._nextMedia;if(1<f){var m=0,k=0;b.forEach(a,function(a){"image"===a.type?m++:-1!==a.type.indexOf("chart")&&k++});m&&(d.set(this._imageCount,"innerHTML",m),e.query(".summary .image",g).removeClass("hidden"));k&&(d.set(this._chartCount,"innerHTML",k),e.query(".summary .chart",g).removeClass("hidden"))}else e.query(".summary",
g).addClass("hidden"),c.add(l,"hidden"),c.add(h,"hidden");a=this._mediaPtr;0===a?c.add(l,"hidden"):c.remove(l,"hidden");a===f-1?c.add(h,"hidden"):c.remove(h,"hidden");this._destroyFrame()},_displayMedia:function(){var a=this._mediaInfos[this._mediaPtr],b=a.title,g=a.caption,l=e.query(".mediaSection .hzLine",this.domNode)[0];if(d.set(this._mediaTitle,"innerHTML",b),c[b?"remove":"add"](this._mediaTitle,"hidden"),d.set(this._mediaCaption,"innerHTML",g),c[g?"remove":"add"](this._mediaCaption,"hidden"),
c[b&&g?"remove":"add"](l,"hidden"),this._rid=null,"image"===a.type)this._showImage(a.value);else{var m=this,b=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],g=a.value.theme||this.chartTheme;f.isString(g)&&(g=g.replace(/\./gi,"/"),-1===g.indexOf("/")&&(g="dojox/charting/themes/"+g));g||(g="./Rainbow");b.push(g);try{var k=this._rid=A++;h(b,function(b,c,d){k===m._rid&&(m._rid=null,m._showChart(a.type,a.value,b,c,d))})}catch(G){}}},_preventNewTab:function(a){return a=a&&f.trim(a).toLowerCase(),
a&&(0===a.indexOf("mailto:")||0===a.indexOf("tel:"))},_showImage:function(b){c.add(this._mediaFrame,"image");var d,f=q.get(this._gallery,"height");b.linkURL&&(d=n.create("a",{href:b.linkURL,target:this._preventNewTab(b.linkURL)?"":"_blank"},this._mediaFrame));n.create("img",{className:"esriPopupMediaImage",src:b.sourceURL},d||this._mediaFrame);var g,l=e.query(".esriPopupMediaImage",this._mediaFrame)[0],h=this;g=a.connect(l,"onload",function(){a.disconnect(g);g=null;h._imageLoaded(l,f)})},_showChart:function(a,
d,e,f,g){c.remove(this._mediaFrame,"image");e=this._chart=new e(n.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});switch(g&&e.setTheme(g),a){case "piechart":e.addPlot("default",{type:"Pie",labels:!1});e.addSeries("Series A",d.fields);break;case "linechart":e.addPlot("default",{type:"Markers"});e.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});e.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});b.forEach(d.fields,function(a,b){a.x=
b+1});e.addSeries("Series A",d.fields);break;case "columnchart":e.addPlot("default",{type:"Columns",gap:3});e.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});e.addSeries("Series A",d.fields);break;case "barchart":e.addPlot("default",{type:"Bars",gap:3}),e.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),e.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),e.addSeries("Series A",d.fields)}this._action=new f(e);e.render()},_destroyFrame:function(){this._rid=
null;this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);d.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(a,b){var c=a.height;b>c&&q.set(a,"marginTop",Math.round((b-c)/2)+"px")},_attListHandler:function(a,c){if(a===this._dfd){this._dfd=null;var e="";c instanceof Error||!c||!c.length||b.forEach(c,function(a){e+="\x3cli\x3e";e+="\x3ca href\x3d'"+w.addProxy(a.url)+"' target\x3d'_blank'\x3e"+(a.name||"[No name]")+"\x3c/a\x3e";e+=
"\x3c/li\x3e"});d.set(this._attachmentsList,"innerHTML",e||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_handleComponentsSuccess:function(a){if(a){var l=this.showTitle?a.title:"",h=a.description,m=a.fields,k=a.mediaInfos,n=this.domNode,q=this._nls,r=this,u=this.template,v=this.graphic;this._prevMedia.title=q.NLS_prevMedia;this._nextMedia.title=q.NLS_nextMedia;d.set(this._title,"innerHTML",l);l||c.add(this._title,"hidden");!a.hasDescription&&m&&(h="",b.forEach(m,function(a){h+="\x3ctr valign\x3d'top'\x3e";
h+="\x3ctd class\x3d'attrName'\x3e"+t.encode(a[0])+"\x3c/td\x3e";h+="\x3ctd class\x3d'attrValue'\x3e"+a[1].replace(/^\s*(https?:\/\/[^\s]+)\s*$/i,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+q.NLS_moreInfo+"\x3c/a\x3e")+"\x3c/td\x3e";h+="\x3c/tr\x3e"}),h&&(h="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+h+"\x3c/table\x3e"));d.set(this._description,"innerHTML",h);h||c.add(this._description,"hidden");e.query("a",this._description).forEach(function(a){r._preventNewTab(a.href)?
"_blank"===a.target&&d.remove(a,"target"):d.set(a,"target","_blank")});l&&h?e.query(".mainSection .hzLine",n).removeClass("hidden"):l||h?e.query(".mainSection .hzLine",n).addClass("hidden"):e.query(".mainSection",n).addClass("hidden");(l=this._dfd=u.getAttachments(v))&&(l.addBoth(f.hitch(this,this._attListHandler,l)),d.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+q.NLS_searching+"...\x3c/li\x3e"),e.query(".attachmentsSection",n).removeClass("hidden"));k&&k.length&&(e.query(".mediaSection",n).removeClass("hidden"),
g.setSelectable(this._mediaFrame,!1),this._mediaInfos=k,this._mediaPtr=0,this._updateUI(),this._displayMedia());a.editSummary&&(d.set(this._editSummary,"innerHTML",a.editSummary),k&&k.length&&c.remove(this._mediaBreak,"hidden"),c.remove(this._editSummarySection,"hidden"))}},_handleComponentsError:function(a){}});return l("extend-esri")&&f.setObject("dijit._PopupRenderer",k,u),k})},"cmv/viewer/js/gis/dijit/Identify/nls/resource":function(){define({root:{labels:{selectLayer:'Choose "All Visible Layers" or a single layer for identify:',
allVisibleLayers:"*** All Visible Layers ***"},rightClickMenuItem:{label:"Identify here"},mapInfoWindow:{identifyingTitle:"Identifying..."}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/Identify/Formatters":function(){define(["dojo/number","dojo/date/locale"],function(h,k){return{formatInt:function(a){return h.format(a)},formatFloat:function(a){return h.format(a,{places:3})},formatDate:function(a){return k.format(new Date(a),{formatLength:"short"})}}})},"cmv/viewer/js/gis/dijit/Draw":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/Color esri/toolbars/draw esri/layers/GraphicsLayer esri/graphic esri/renderers/SimpleRenderer dojo/text!./Draw/templates/Draw.html esri/renderers/UniqueValueRenderer esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/layers/FeatureLayer dojo/topic dojo/aspect dojo/i18n!./Draw/nls/resource dijit/form/Button xstyle/css!./Draw/css/Draw.css xstyle/css!./Draw/css/adw-icons.css".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x){return h([k,a,f],{widgetsInTemplate:!0,templateString:c,i18n:x,drawToolbar:null,mapClickMode:null,postCreate:function(){this.inherited(arguments);this.drawToolbar=new l(this.map);this.drawToolbar.on("draw-end",b.hitch(this,"onDrawToolbarDrawEnd"));this.createGraphicLayers();this.own(u.subscribe("mapClickMode/currentSet",b.hitch(this,"setMapClickMode")));this.parentWidget&&this.parentWidget.toggleable&&this.own(w.after(this.parentWidget,"toggle",b.hitch(this,
function(){this.onLayoutChange(this.parentWidget.open)})))},createGraphicLayers:function(){this.pointSymbol=new q(q.STYLE_CIRCLE,10,new t(t.STYLE_SOLID,new e([255,0,0]),1),new e([255,0,0,1]));this.polylineSymbol=new t(t.STYLE_DASH,new e([255,0,0]),1);this.polygonSymbol=new r(r.STYLE_SOLID,new t(t.STYLE_DASHDOT,new e([255,0,0]),2),new e([255,255,0,0]));this.pointGraphics=new m({id:"drawGraphics_point",title:"Draw Graphics"});this.pointRenderer=new d(this.pointSymbol);this.pointRenderer.label="User drawn points";
this.pointRenderer.description="User drawn points";this.pointGraphics.setRenderer(this.pointRenderer);this.map.addLayer(this.pointGraphics);this.polylineGraphics=new m({id:"drawGraphics_line",title:"Draw Graphics"});this.polylineRenderer=new d(this.polylineSymbol);this.polylineRenderer.label="User drawn lines";this.polylineRenderer.description="User drawn lines";this.polylineGraphics.setRenderer(this.polylineRenderer);this.map.addLayer(this.polylineGraphics);this.polygonGraphics=new v({layerDefinition:{geometryType:"esriGeometryPolygon",
fields:[{name:"OBJECTID",type:"esriFieldTypeOID",alias:"OBJECTID",domain:null,editable:!1,nullable:!1},{name:"ren",type:"esriFieldTypeInteger",alias:"ren",domain:null,editable:!0,nullable:!1}]},featureSet:null},{id:"drawGraphics_poly",title:"Draw Graphics",mode:v.MODE_SNAPSHOT});this.polygonRenderer=new n(new r,"ren",null,null,", ");this.polygonRenderer.addValue({value:1,symbol:new r({color:[255,170,0,255],outline:{color:[255,170,0,255],width:1,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",
style:"esriSFSForwardDiagonal"}),label:"User drawn polygons",description:"User drawn polygons"});this.polygonGraphics.setRenderer(this.polygonRenderer);this.map.addLayer(this.polygonGraphics)},drawPoint:function(){this.disconnectMapClick();this.drawToolbar.activate(l.POINT);this.drawModeTextNode.innerText=this.i18n.labels.point},drawCircle:function(){this.disconnectMapClick();this.drawToolbar.activate(l.CIRCLE);this.drawModeTextNode.innerText=this.i18n.labels.circle},drawLine:function(){this.disconnectMapClick();
this.drawToolbar.activate(l.POLYLINE);this.drawModeTextNode.innerText=this.i18n.labels.polyline},drawFreehandLine:function(){this.disconnectMapClick();this.drawToolbar.activate(l.FREEHAND_POLYLINE);this.drawModeTextNode.innerText=this.i18n.labels.freehandPolyline},drawPolygon:function(){this.disconnectMapClick();this.drawToolbar.activate(l.POLYGON);this.drawModeTextNode.innerText=this.i18n.labels.polygon},drawFreehandPolygon:function(){this.disconnectMapClick();this.drawToolbar.activate(l.FREEHAND_POLYGON);
this.drawModeTextNode.innerText=this.i18n.labels.freehandPolygon},disconnectMapClick:function(){u.publish("mapClickMode/setCurrent","draw");this.enableStopButtons()},connectMapClick:function(){u.publish("mapClickMode/setDefault");this.disableStopButtons()},onDrawToolbarDrawEnd:function(a){this.drawToolbar.deactivate();this.drawModeTextNode.innerText=this.i18n.labels.currentDrawModeNone;switch(a.geometry.type){case "point":a=new g(a.geometry);this.pointGraphics.add(a);break;case "polyline":a=new g(a.geometry);
this.polylineGraphics.add(a);break;case "polygon":a=new g(a.geometry,null,{ren:1}),this.polygonGraphics.add(a)}this.connectMapClick()},clearGraphics:function(){this.endDrawing();this.connectMapClick();this.drawModeTextNode.innerText="None"},stopDrawing:function(){this.drawToolbar.deactivate();this.drawModeTextNode.innerText="None";this.connectMapClick()},endDrawing:function(){this.pointGraphics.clear();this.polylineGraphics.clear();this.polygonGraphics.clear();this.drawToolbar.deactivate();this.disableStopButtons()},
disableStopButtons:function(){this.stopDrawingButton.set("disabled",!0);this.eraseDrawingButton.set("disabled",!this.noGraphics())},enableStopButtons:function(){this.stopDrawingButton.set("disabled",!1);this.eraseDrawingButton.set("disabled",!this.noGraphics())},noGraphics:function(){return 0<this.pointGraphics.graphics.length?!0:0<this.polylineGraphics.graphics.length?!0:0<this.polygonGraphics.graphics.length?!0:!1},onLayoutChange:function(a){a||"draw"===this.mapClickMode&&u.publish("mapClickMode/setDefault")},
setMapClickMode:function(a){this.mapClickMode=a}})})},"cmv/viewer/js/gis/dijit/Draw/nls/resource":function(){define({root:{labels:{point:"Point",circle:"Circle",polyline:"Polyline",freehandPolyline:"Freehand polyline",polygon:"Polygon",freehandPolygon:"Freehand polygon",stopDrawing:"Stop drawing",clearDrawing:"Clear drawing",currentDrawMode:"Current draw mode:",currentDrawModeNone:"None"}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/Measurement":function(){define("dojo/_base/declare dijit/_WidgetBase esri/dijit/Measurement dojo/aspect dojo/_base/lang dojo/dom-construct dojo/topic".split(" "),
function(h,k,a,f,b,e,l){return h([k],{declaredClass:"gis.dijit.Measurement",mapClickMode:null,postCreate:function(){this.inherited(arguments);this.measure=(new a({map:this.map,defaultAreaUnit:this.defaultAreaUnit,defaultLengthUnit:this.defaultLengthUnit},e.create("div"))).placeAt(this.domNode);this.measure.startup();f.after(this.measure,"setTool",b.hitch(this,"checkMeasureTool"));f.after(this.measure,"closeTool",b.hitch(this,"checkMeasureTool"));this.own(l.subscribe("mapClickMode/currentSet",b.hitch(this,
"setMapClickMode")));this.parentWidget&&this.parentWidget.toggleable&&this.own(f.after(this.parentWidget,"toggle",b.hitch(this,function(){this.onLayoutChange(this.parentWidget.open)})))},checkMeasureTool:function(){this.measure.activeTool&&""!==this.measure.activeTool?"measure"!==this.mapClickMode&&this.disconnectMapClick():"measure"===this.mapClickMode&&this.connectMapClick()},disconnectMapClick:function(){l.publish("mapClickMode/setCurrent","measure")},connectMapClick:function(){l.publish("mapClickMode/setDefault")},
onLayoutChange:function(a){a||"measure"!==this.mapClickMode||this.connectMapClick()},setMapClickMode:function(a){this.mapClickMode=a;"measure"!==a&&(this.measure.setTool("area",!1),this.measure.setTool("distance",!1),this.measure.setTool("location",!1),this.measure.clearResult())}})})},"esri/dijit/Measurement":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/debounce dojo/sniff dojo/dom-style dojo/dom-construct dojox/gfx dijit/_Widget dijit/registry dijit/Menu dijit/MenuItem ../symbols/PictureMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/jsonUtils ../geometry/geodesicUtils ../geometry/webMercatorUtils ../geometry/Point ../geometry/Polyline ../geometry/Polygon ../graphic ../tasks/AreasAndLengthsParameters ../tasks/LengthsParameters ../tasks/GeometryService ../kernel ../config ../domUtils ../numberUtils ../lang ../units ../WKIDUnitConversion ../SpatialReference dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ./_EventedWidget dojo/text!./templates/Measurement.html dojo/i18n!../nls/jsapi dijit/form/ToggleButton dijit/form/DropDownButton dijit/layout/ContentPane".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J,L,M,H,K,P,O,S,Q,R,aa,X){k=k([R,n,S,Q],{declaredClass:"esri.dijit.Measurement",widgetsInTemplate:!0,templateString:aa,_map:null,_geometryService:null,_interpolatedMap:null,_mouseImgURL:null,_defaultPinURL:null,_measureGraphics:[],_measureGraphic:null,_locationGraphic:null,_tempGraphic:null,_polylineGraphics:null,_polygonGraphic:null,_pointSymbol:null,_useDefaultPointSymbol:!0,_defaultLineSymbol:null,_lineSymbol:null,_areaLineSymbol:null,
_defaultFillSymbol:null,_fillSymbol:null,_borderlessFillSymbol:null,_userGeometry:null,_currentGeometry:null,_inputPoints:[],_unitDictionary:[],_densificationRatio:.07848050723825097,numberPattern:"#,###,###,##0.0",result:null,_defaultDistanceUnit:null,_defaultAreaUnit:null,_defaultLocationUnit:null,currentDistanceUnit:null,currentAreaUnit:null,currentLocationUnit:null,_unitStrings:{},_locationUnitStrings:[],_locationUnitStringsLong:[],_distanceUnitStrings:[],_distanceUnitStringsLong:[],_areaUnitStrings:[],
_areaUnitStringsLong:[],_calculatingMsg:null,_gsErrorMsg:null,_NLS_Lat:null,_NLS_Lon:null,_mouseMoveMapHandler:null,_mouseClickMapHandler:null,_doubleClickMapHandler:null,_mouseDragMapHandler:null,_clickMapHandler:null,_mapExtentChangeHandler:null,_geometryAreaHandler:null,_snappingCallback:null,_calcTimer:null,_buttonDijits:{},previousTool:null,activeTool:null,markerLongitude:null,markerLatitude:null,mouseLongitude:null,mouseLatitude:null,_eventMap:{"measure-start":["toolName","unitName"],measure:["toolName",
"geometry","values","unitName","segmentLength"],"measure-end":["toolName","geometry","values","unitName"],"tool-change":["toolName","unitName","previousToolName"],"unit-change":["unitName","toolName"]},constructor:function(c,d){if(c&&c.map){if(this._map=c.map,this._map.loaded)this._map.cs=this._checkCS(this._map.spatialReference),this._interpolatedMap=!("Web Mercator"===this._map.cs||"PCS"===this._map.cs);else var f=b.connect(this._map,"onLoad",this,function(){b.disconnect(f);f=null;this._map.cs=
this._checkCS(this._map.spatialReference);this._interpolatedMap=!("Web Mercator"===this._map.cs||"PCS"===this._map.cs)});this._geometryService=J.defaults.geometryService;this._mouseImgURL=h.toUrl("./images/cursor16x24.png");this._defaultPinURL=h.toUrl("./images/esriGreenPin16x26.png");this._defaultLineSymbol=new u(u.STYLE_SOLID,new e([0,128,255]),3);this._defaultFillSymbol=new w(u.STYLE_SOLID,this._defaultLineSymbol,new e([0,0,0,.5]));c.pointSymbol?(this._pointSymbol=c.pointSymbol,this._useDefaultPointSymbol=
!1):(this._pointSymbol=new v(this._defaultPinURL,16,26),this._pointSymbol.setOffset(0,12));var g=c.fillSymbol||this._defaultFillSymbol;this._fillSymbol=g;this._areaLineSymbol=g.outline||this._defaultLineSymbol;this._borderlessFillSymbol=x.fromJson(g.toJson());this._borderlessFillSymbol.setOutline(null);c.lineSymbol?this._lineSymbol=c.lineSymbol:this._lineSymbol=this._defaultLineSymbol;c.defaultLengthUnit?this._defaultDistanceUnit=c.defaultLengthUnit:this._defaultDistanceUnit=K.MILES;c.defaultAreaUnit?
this._defaultAreaUnit=c.defaultAreaUnit:this._defaultAreaUnit=K.ACRES;c.defaultLocationUnit?this._defaultLocationUnit=c.defaultLocationUnit:this._defaultLocationUnit=K.DECIMAL_DEGREES;this._snappingCallback=a.hitch(this,this._snappingCallback);c.geometry&&(this._userGeometry=c.geometry);this._calcTimer=null;this.advancedLocationUnits=c.advancedLocationUnits||!1;this._NLS_Lon=X.widgets.measurement.NLS_longitude;this._NLS_Lat=X.widgets.measurement.NLS_latitude;this._gsErrorMsg=X.widgets.measurement.NLS_geometry_service_error;
this._calculatingMsg=X.widgets.measurement.NLS_calculating;this._geometryServiceLength=l(this._geometryServiceLength,250)}},startup:function(){if(this._setupDictionaries(),d.create("img",{src:this._mouseImgURL,style:"vertical-align: middle"},this.mouseCell),this._useDefaultPointSymbol?d.create("img",{src:this._defaultPinURL,style:"vertical-align: middle"},this.pinCell):this._drawPointGraphics(this.pinCell),this._userGeometry)if(this._map.loaded)this._measureCustomGeometry(this._userGeometry),this._userGeometry=
null;else var a=b.connect(this._map,"onLoad",this,function(){b.disconnect(a);a=null;this._measureCustomGeometry(this._userGeometry);this._userGeometry=null})},destroy:function(){this._resetToolState();this.clearResult();this.inherited(arguments);this._map=this._geometryService=this._measureGraphics=this._measureGraphic=this._tempGraphic=null},setTool:function(a,b){this.previousTool=this.activeTool||null;this._polylineGraphics=[];this._resetToolState();this._polygonGraphic&&(this._map.graphics.remove(this._polygonGraphic),
this._polygonGraphic=null);var c=q.byNode(this._buttonDijits[a].domNode).checked;g.set(this._unitDropDown.domNode,"visibility","visible");q.byNode(this._buttonDijits.area.domNode).set("checked",!1);q.byNode(this._buttonDijits.distance.domNode).set("checked",!1);q.byNode(this._buttonDijits.location.domNode).set("checked",!1);!0!==b&&!1!==b||(c=b);q.byNode(this._buttonDijits[a].domNode).set("checked",c);this._toggleLocationResultsTable(!1,!0);c?(this.activeTool=a,this._dblClickZoom=this._map.isDoubleClickZoom,
this._dblClickZoom&&this._map.disableDoubleClickZoom(),"area"===a?this._setupAreaTool():"distance"===a?this._setupDistanceTool():"location"===a&&this._setupLocationTool(),this._map.snappingManager&&(this._map.snappingManager._startSelectionLayerQuery(),this._map.snappingManager._setUpSnapping())):(this.activeTool=null,g.set(this._unitDropDown.domNode,"visibility","hidden"));this.activeTool!==this.previousTool&&this.onToolChange(this.activeTool,this.getUnit(),this.previousTool)},measure:function(a){a&&
this._measureCustomGeometry(a)},clearResult:function(){var a,c=this._map;this.result=0;this.resultValue.setContent("\x26nbsp");for(a=0;a<this._measureGraphics.length;a++)c.graphics.remove(this._measureGraphics[a]);this._measureGraphic=this._currentGeometry=null;this._measureGraphics=[];c.graphics.remove(this._tempGraphic);b.disconnect(this._mouseMoveMapHandler);this._mouseMoveMapHandler=null},show:function(){L.show(this.domNode)},hide:function(){L.hide(this.domNode)},showTool:function(a){g.set(this._buttonDijits[a].domNode,
"display","inline-block")},hideTool:function(a){g.set(this._buttonDijits[a].domNode,"display","none")},getTool:function(){return this.activeTool?{toolName:this.activeTool,unitName:this.getUnit()}:void 0},getUnit:function(){return"unit"!==this._unitDropDown.label?this._unitDropDown.label:void 0},_setupLocationTool:function(){this._map.navigationManager.setImmediateClick(!0);this._measureGraphics=[];this._map.graphics.remove(this._locationGraphic);this._createLocationUnitList();"PCS"===this._map.cs&&
(this._projectMapExtent(this._map.extent),this._mapExtentChangeHandler=b.connect(this._map,"onExtentChange",a.hitch(this,this._projectMapExtent)));this._clickMapHandler=b.connect(this._map,"onClick",this,"_locationClickHandler");"esriDegreeMinuteSeconds"!==this.currentLocationUnit&&"esriDecimalDegrees"!==this.currentLocationUnit||(this._mouseMoveMapHandler=b.connect(this._map,"onMouseMove",this,"_locationMoveHandler"))},_locationButtonToggle:function(){this.clearResult();this.setTool("location")},
_measureCustomPoint:function(a){this.setTool("location",!0);"Web Mercator"===this._map.cs&&a.spatialReference!==this._map.spatialReference&&(a=A.geographicToWebMercator(a));this._measureGraphic=new D;this._measureGraphic.setSymbol(this._pointSymbol);this._measureGraphic.setGeometry(a);this._measureGraphics.push(this._measureGraphic);this._map.graphics.add(this._measureGraphic);this._currentGeometry=a;this._calculateLocation(a,!0)},_calculateLocation:function(c,d){var e=!("esriDegreeMinuteSeconds"===
this.currentLocationUnit||"esriDecimalDegrees"===this.currentLocationUnit);e&&this._mouseMoveMapHandler&&(b.disconnect(this._mouseMoveMapHandler),this._mouseMoveMapHandler=null);var f=a.clone(c);if(d){if("Web Mercator"!==this.map.cs&&this.map.spatialReference&&4326!==this.map.spatialReference.wkid)return void this._projectLocation(f,e);this._updateMarkerLocation(f.x,f.y)}f=this._getGCSLocation(f);this._advancedLocationDisplayHandler(f,e,d)},_projectLocation:function(b,c){this._geometryService.project([b],
new O({wkid:4326}),a.hitch(this,function(a){this._advancedLocationDisplayHandler(a[0],c,!0)}),a.hitch(this,function(a){}))},_advancedLocationDisplayHandler:function(a,b,c){var d;b?this._updateGeocoordinateStringLocation({coordinates:[[a.x,a.y]],sr:{wkid:4326},conversionType:this._unitStrings[this.currentLocationUnit]},a):(d=this._calculateXY(a.x,a.y),c?(this._updateClickLocation(d[0],d[1]),this.onMeasureEnd(this.activeTool,a,[d[0],d[1]],this.getUnit())):this._updateMouseLocation(d[0],d[1]))},_updateMarkerLocation:function(a,
b){this.markerLocationX=a;this.markerLocationY=b},_updateMouseLocation:function(a,b){this.mouseLongitude.innerHTML=a;this.mouseLatitude.innerHTML=b},_updateClickLocation:function(a,b){this._updateMouseLocation(a,b);this.markerLongitude.innerHTML=a;this.markerLatitude.innerHTML=b},_updateGeocoordinateStringLocation:function(b,c){this.resultValue.setContent("\x26nbsp");this._geometryService.toGeoCoordinateString(b,a.hitch(this,function(a){clearTimeout(this._calcTimer);a?(this.resultValue.setContent(a[0]),
this.onMeasureEnd(this.activeTool,c,a,this.getUnit())):(this.resultValue.setContent(this._gsErrorMsg),this.onMeasureEnd(this.activeTool,null,null,this.getUnit()))}));clearTimeout(this._calcTimer);this._calcTimer=setTimeout(a.hitch(this,function(){this.resultValue.setContent(this._calculatingMsg)},1E3))},_switchLocationUnit:function(a){if(q.byNode(this._unitDropDown.domNode).set("label",this._unitStrings[a]),this.currentLocationUnit=a,b.disconnect(this._mouseMoveMapHandler),this._mouseMoveMapHandler=
null,this.onUnitChange(this._unitStrings[a],this.activeTool),"esriDegreeMinuteSeconds"===a||"esriDecimalDegrees"===a)this._mouseMoveMapHandler=b.connect(this._map,"onMouseMove",this,"_locationMoveHandler"),this._toggleLocationResultsTable(!0,!1),this._locationGraphic&&this._calculateLocation(this._locationGraphic.geometry,!0);else if((this._toggleLocationResultsTable(!1,!1),null!==this.resultValue&&(null!==this.markerLocationX||null!==this.markerLocationY))&&this._locationGraphic){var c=this._getGCSLocation(this._locationGraphic.geometry);
this._updateGeocoordinateStringLocation({coordinates:[[c.x,c.y]],sr:{wkid:4326},conversionType:this._unitStrings[a]},this._locationGraphic.geometry)}},_toggleLocationResultsTable:function(a,c){c&&(this.resultValue.setContent("\x26nbsp"),this.markerLongitude.innerHTML="---",this.markerLatitude.innerHTML="---",this.mouseLongitude.innerHTML="---",this.mouseLatitude.innerHTML="---");a?(L.show(this.resultTable.domNode),L.hide(this.resultValueContainer.domNode)):(L.hide(this.resultTable.domNode),L.show(this.resultValueContainer.domNode),
b.disconnect(this._mouseMoveMapHandler));"PCS"===this._map.cs&&L.hide(this._mouseRow)},_setupDistanceTool:function(){this._map.navigationManager.setImmediateClick(!0);"PCS"===this._map.cs&&(this._projectMapExtent(this._map.extent),this._mapExtentChangeHandler=b.connect(this._map,"onExtentChange",this,"_projectMapExtent"));this._inputPoints=[];this._createDistanceUnitList();this._mouseClickMapHandler=b.connect(this._map,"onClick",this,"_measureDistanceMouseClickHandler");this._doubleClickMapHandler=
b.connect(this._map,"onDblClick",this,"_measureDistanceDblClickHandler")},_distanceButtonToggle:function(){this.clearResult();this.setTool("distance")},_measureCustomDistance:function(b){if(1<b.paths[0].length){this.setTool("distance",!0);this._inputPoints=[];f.forEach(b.paths[0],a.hitch(this,function(a,c){this._inputPoints.push(a);var d=new D(new z(a[0],a[1],b.spatialReference),this._pointSymbol);this._measureGraphics.push(d);this._map.graphics.add(d);0!==c&&(this.result+=this._geodesicDistance(a,
b.paths[0][c-1]))}));this._measureGraphic=new D;this._measureGraphic.setSymbol(this._lineSymbol);this._measureGraphics.push(this._measureGraphic);var c=this._densifyGeometry(b);this._measureGraphic.setGeometry(c);this._map.graphics.add(this._measureGraphic);this._inputPoints=[];c=this._outputResult(this.result,this.getUnit());this._currentGeometry=b;this.onMeasureEnd(this.activeTool,b,c,this.getUnit())}},_showDistance:function(a){a&&this._outputResult(a,q.byNode(this._unitDropDown.domNode).label)},
_setupAreaTool:function(){this._map.navigationManager.setImmediateClick(!0);this._inputPoints=[];this._createAreaUnitList();this._tempGraphic=new D;this._tempGraphic.setSymbol(this._areaLineSymbol);this._tempGraphic.setGeometry(new B(this._map.spatialReference));this._map.graphics.add(this._tempGraphic);"PCS"===this._map.cs&&(this._geometryAreaHandler=b.connect(this._geometryService,"onAreasAndLengthsComplete",this,"_outputArea"));this._mouseClickMapHandler=b.connect(this._map,"onClick",this,"_measureAreaMouseClickHandler");
this._doubleClickMapHandler=b.connect(this._map,"onDblClick",this,"_measureAreaDblClickHandler")},_areaButtonToggle:function(){this.clearResult();this.setTool("area")},_generatePolygonFromPaths:function(){var b=[];f.forEach(this._polylineGraphics,a.hitch(this,function(c){f.forEach(c.geometry.paths,a.hitch(this,function(c){f.forEach(c,a.hitch(this,function(a){b.push(a)}))}))}));b.push(b[0]);var c=new C(this._map.spatialReference);c.addRing(b);var c=this._densifyGeometry(c),d=new D;return d.setGeometry(c),
d.setSymbol(this._borderlessFillSymbol),this._measureGraphic=d,this._measureGraphics.push(d),d},_getArea:function(b){var c=[],d=new E;if(d.areaUnit=G.UNIT_SQUARE_METERS,d.calculationType="geodesic",C.prototype.isSelfIntersecting(b))this._geometryService.simplify([b],a.hitch(this,function(b){f.forEach(b,a.hitch(this,function(a){return"PCS"===this._map.cs?(d.polygons=b,void this._geometryService.areasAndLengths(d)):("Web Mercator"===this._map.cs&&(a=A.webMercatorToGeographic(a)),void c.push(a))}));
var e=y.geodesicAreas(c,K.SQUARE_METERS);this._showArea(e[0])}));else{if("Web Mercator"===this._map.cs&&(b=A.webMercatorToGeographic(b)),c.push(b),"PCS"===this._map.cs)return d.polygons=c,void this._geometryService.areasAndLengths(d);b=y.geodesicAreas(c,K.SQUARE_METERS);this._showArea(Math.abs(b[0]))}},_outputArea:function(a){this._showArea(Math.abs(a.areas[0]))},_showArea:function(a){a&&(this.result=a,a=q.byNode(this._unitDropDown.domNode).label,a=this._outputResult(this.result,a),this._mouseMoveMapHandler?
this.onMeasure(this.activeTool,this._currentGeometry,a,this.getUnit(),null):this.onMeasureEnd(this.activeTool,this._currentGeometry,a,this.getUnit()))},_measureCustomArea:function(a){this.setTool("area",!0);this._inputPoints=[];var b=this._densifyGeometry(a);this._currentGeometry=a;this._measureGraphic=new D;this._measureGraphic.setGeometry(b);this._measureGraphic.setSymbol(this._fillSymbol);this._measureGraphics.push(this._measureGraphic);this._map.graphics.add(this._measureGraphic);this._getArea(a);
this._inputPoints=[]},_resetToolState:function(){var a=this._map;a.navigationManager.setImmediateClick(!1);this._dblClickZoom&&a.enableDoubleClickZoom();this._inputPoints=[];b.disconnect(this._mouseClickMapHandler);b.disconnect(this._mouseMoveMapHandler);b.disconnect(this._doubleClickMapHandler);b.disconnect(this._mouseDragMapHandler);b.disconnect(this._clickMapHandler);b.disconnect(this._mapExtentChangeHandler);b.disconnect(this._geometryAreaHandler);this._mouseClickMapHandler=this._mouseMoveMapHandler=
this._doubleClickMapHandler=this._mouseDragMapHandler=this._clickMapHandler=this._mapExtentChangeHandler=this._geometryAreaHandler=null;a.snappingManager&&a.snappingManager._snappingGraphic&&a.graphics.remove(a.snappingManager._snappingGraphic);this._map.snappingManager&&(this._map.snappingManager._stopSelectionLayerQuery(),this._map.snappingManager._killOffSnapping());this._unitDropDown._opened&&this._unitDropDown.closeDropDown()},_measureCustomGeometry:function(a){switch(this.clearResult(),a.type){case "point":this._measureCustomPoint(a);
break;case "polyline":this._measureCustomDistance(a);break;case "polygon":this._measureCustomArea(a)}},_densifyGeometry:function(a){var b,c=this._map.cs;b=y.getSpheroidInfo(a.spatialReference).radius*this._densificationRatio;"Web Mercator"===c?(a=A.webMercatorToGeographic(a),b=y.geodesicDensify(a,b),b=A.geographicToWebMercator(b)):b="PCS"===c?a:y.geodesicDensify(a,b);return b},_geodesicDistance:function(a,b){var c=new B(this._map.spatialReference);return"PCS"===this._map.cs&&(a=this._getGCSLocation(a),
b=this._getGCSLocation(b)),c.addPath([a,b]),"Web Mercator"===this._map.cs&&(c=A.webMercatorToGeographic(c)),y.geodesicLengths([c],K.METERS)[0]},_calculateXY:function(a,b){var c,d,e=X.widgets.measurement,f=this._map.getScale();if(this.getUnit()===e.NLS_decimal_degrees)d=500<=f?6:500>f&&50<=f?7:50>f&&5<=f?8:9,c=a.toFixed(d),this._map.spatialReference._isWrappable()||(c=this._roundX(c)),c=M.format(c),d=M.format(this._roundY(b.toFixed(d)));else if(this.getUnit()===e.NLS_deg_min_sec){var g,l,h,m,k=e=!1;
d=9E4<=f?0:9E4>f&&9E3<=f?1:9E3>f&&900<=f?2:900>f&&90<f?3:4;0>a&&(e=!0,a=Math.abs(a));0>b&&(k=!0,b=Math.abs(b));b=this._roundY(b);this._map.spatialReference._isWrappable()||(a=this._roundX(a));g=Math.floor(b)+"\u00b0";c=Math.floor(a)+"\u00b0";l=Math.floor(this._getDegreeMinutes(b))+"'";f=Math.floor(this._getDegreeMinutes(a))+"'";h=M.format(this._getDegreeSeconds(b).toFixed(d))+'"';m=M.format(this._getDegreeSeconds(a).toFixed(d))+'"';d=g+l+h;c=c+f+m;e&&(c="-"+c);k&&(d="-"+d)}return[c,d]},_getDegreeMinutes:function(a){return 60*
(a-Math.floor(a))},_getDegreeSeconds:function(a){return 60*(60*(a-Math.floor(a))-Math.floor(60*(a-Math.floor(a))))},_roundY:function(a){return 90<a?a=90:-90>a&&(a=-90),a},_roundX:function(a){return 180<a?a=180:-180>a&&(a=-180),a},_getGCSLocation:function(b){b=a.clone(b);var c=this._map,d=c.extent,e=c._newExtent;"Web Mercator"===c.cs?b=A.webMercatorToGeographic(b):"PCS"===c.cs?e&&(b=new z((b.x-d.xmin)*Math.abs((e.xmax-e.xmin)/(d.xmax-d.xmin))+e.xmin,(b.y-d.ymin)*Math.abs((e.ymax-e.ymin)/(d.ymax-d.ymin))+
e.ymin,c.spatialReference)):b=b.normalize();return b},_projectMapExtent:function(c){c=new D(c);var d=new O({wkid:4326});this._geometryService.project([c.geometry],d,a.hitch(this,function(c){this._mouseMoveMapHandler||"location"!==this.activeTool||(("esriDegreeMinuteSeconds"===this.currentLocationUnit||"esriDecimalDegrees"===this.currentLocationUnit)&&(this._mouseMoveMapHandler=b.connect(this._map,"onMouseMove",a.hitch(this,this._locationMoveHandler))),this._mouseMoveMapHandler=b.connect(this._map,
"onMouseMove",a.hitch(this,this._locationMoveHandler)));this._map._newExtent=c[0]}))},_checkCS:function(a){return a.wkid?3857===a.wkid||102100===a.wkid||102113===a.wkid?"Web Mercator":H.isDefined(P[a.wkid])?"PCS":"GCS":a.wkt?-1!==a.wkt.indexOf("WGS_1984_Web_Mercator")?"Web Mercator":0===a.wkt.indexOf("PROJCS")?"PCS":"GCS":void 0},_switchUnit:function(a){if("distance"===this.activeTool?this.currentDistanceUnit=a:"area"===this.activeTool?this.currentAreaUnit=a:"location"===this.activeTool&&(this.currentLocationUnit=
a),q.byNode(this._unitDropDown.domNode).set("label",this._unitStrings[a]),null!==this.result){var b=this._outputResult(this.result,this._unitStrings[a]);if(this.onUnitChange(this._unitStrings[a],this.activeTool),null!==this._currentGeometry||null!==this._measureGraphic)a=this._currentGeometry||this._measureGraphic.geometry,this._mouseMoveMapHandler?this.onMeasure(this.activeTool,a,b,this.getUnit(),null):this.onMeasureEnd(this.activeTool,a,b,this.getUnit())}},_setupDictionaries:function(){var a=X.widgets.measurement;
this._unitDictionary[a.NLS_length_meters]=1;this._unitDictionary[a.NLS_length_kilometers]=1E3;this._unitDictionary[a.NLS_length_feet]=.3048;this._unitDictionary[a.NLS_length_miles]=1609.344;this._unitDictionary[a.NLS_length_yards]=.9144;this._unitDictionary[a.NLS_length_nautical_miles]=1852;this._unitDictionary[a.NLS_length_miles_us]=1609.347218694438;this._unitDictionary[a.NLS_length_feet_us]=.3048006096012192;this._unitDictionary[a.NLS_length_yards_us]=.9144018288036576;this._unitDictionary[a.NLS_area_sq_meters]=
1;this._unitDictionary[a.NLS_area_sq_kilometers]=1E6;this._unitDictionary[a.NLS_area_sq_feet]=.09290304;this._unitDictionary[a.NLS_area_acres]=4046.8564224;this._unitDictionary[a.NLS_area_sq_miles]=2589988.110336;this._unitDictionary[a.NLS_area_hectares]=1E4;this._unitDictionary[a.NLS_area_sq_yards]=.83612736;this._unitDictionary[a.NLS_area_sq_nautical_miles]=3429904;this._unitDictionary[a.NLS_area_acres_us]=4046.872609874252;this._unitDictionary[a.NLS_area_sq_miles_us]=2589998.470319522;this._unitDictionary[a.NLS_area_sq_feet_us]=
.09290341161327487;this._unitDictionary[a.NLS_area_sq_yards_us]=.8361307045194736;this._unitStrings={esriMiles:a.NLS_length_miles,esriKilometers:a.NLS_length_kilometers,esriFeet:a.NLS_length_feet,esriFeetUS:a.NLS_length_feet_us,esriMeters:a.NLS_length_meters,esriYards:a.NLS_length_yards,esriNauticalMiles:a.NLS_length_nautical_miles,esriMilesUS:a.NLS_length_miles_us,esriYardsUS:a.NLS_length_yards_us,esriAcres:a.NLS_area_acres,esriSquareMiles:a.NLS_area_sq_miles,esriSquareKilometers:a.NLS_area_sq_kilometers,
esriHectares:a.NLS_area_hectares,esriSquareYards:a.NLS_area_sq_yards,esriSquareFeet:a.NLS_area_sq_feet,esriSquareFeetUS:a.NLS_area_sq_feet_us,esriSquareMeters:a.NLS_area_sq_meters,esriAcresUS:a.NLS_area_acres_us,esriSquareMilesUS:a.NLS_area_sq_miles_us,esriSquareYardsUS:a.NLS_area_sq_yards_us,esriSquareNauticalMiles:a.NLS_area_sq_nautical_miles,esriDecimalDegrees:a.NLS_decimal_degrees,esriDegreeMinuteSeconds:a.NLS_deg_min_sec,esriMGRS:a.NLS_MGRS,esriUSNG:a.NLS_USNG,esriUTM:a.NLS_UTM,esriGARS:a.NLS_GARS,
esriGeoRef:a.NLS_GeoRef,esriDDM:a.NLS_DDM,esriDD:a.NLS_DD};this._locationUnitStrings=[a.NLS_decimal_degrees,a.NLS_deg_min_sec,a.NLS_MGRS,a.NLS_USNG,a.NLS_UTM,a.NLS_GeoRef,a.NLS_GARS];this._locationUnitStringsLong="esriDecimalDegrees esriDegreeMinuteSeconds esriMGRS esriUSNG esriUTM esriGeoRef esriGARS".split(" ");this._distanceUnitStrings=[a.NLS_length_miles,a.NLS_length_kilometers,a.NLS_length_feet,a.NLS_length_feet_us,a.NLS_length_meters,a.NLS_length_yards,a.NLS_length_nautical_miles];this._distanceUnitStringsLong=
"esriMiles esriKilometers esriFeet esriFeetUS esriMeters esriYards esriNauticalMiles".split(" ");this._areaUnitStrings=[a.NLS_area_acres,a.NLS_area_sq_miles,a.NLS_area_sq_kilometers,a.NLS_area_hectares,a.NLS_area_sq_yards,a.NLS_area_sq_feet,a.NLS_area_sq_feet_us,a.NLS_area_sq_meters];this._areaUnitStringsLong="esriAcres esriSquareMiles esriSquareKilometers esriHectares esriSquareYards esriSquareFeet esriSquareFeetUS esriSquareMeters".split(" ");this._buttonDijits={area:this._areaButton,distance:this._distanceButton,
location:this._locationButton};q.byNode(this._distanceButton.domNode).setLabel(a.NLS_distance);q.byNode(this._areaButton.domNode).setLabel(a.NLS_area);q.byNode(this._locationButton.domNode).setLabel(a.NLS_location);q.byNode(this.resultLabel.domNode).setContent(a.NLS_resultLabel)},onToolChange:function(){},onUnitChange:function(){},onMeasureStart:function(){},onMeasure:function(){},onMeasureEnd:function(){},_measureAreaMouseClickHandler:function(a){var c;this._map.snappingManager&&(c=this._map.snappingManager._snappingPoint);
c=c||a.mapPoint;if(this._inputPoints.push(c),this._currentStartPt=c,1===this._inputPoints.length){this._tempGraphic.setGeometry(new B(this._map.spatialReference));for(a=0;a<this._measureGraphics.length;a++)this._map.graphics.remove(this._measureGraphics[a]);this._measureGraphics=[];this.result=0;this._outputResult(this.result,X.widgets.measurement.NLS_area_sq_meters);this._mouseMoveMapHandler=b.connect(this._map,"onMouseMove",this,"_measureAreaMouseMoveHandler");this.onMeasureStart(this.activeTool,
this.getUnit())}if(this._measureGraphic=new D,this._measureGraphic.setSymbol(this._areaLineSymbol),this._measureGraphics.push(this._measureGraphic),1<this._inputPoints.length){a=new B(this._map.spatialReference);a.addPath([this._inputPoints[this._inputPoints.length-2],c]);var d=new B(this._map.spatialReference);d.addPath([this._inputPoints[0],c]);c=this._densifyGeometry(a);d=this._densifyGeometry(d);this._tempGraphic.setGeometry(d);this._measureGraphic.setGeometry(c);this._map.graphics.add(this._measureGraphic);
c=new D;if(c.setGeometry(a),this._polylineGraphics.push(c),2<this._inputPoints.length){c=new C(this._map.spatialReference);d=[];for(a=0;a<this._inputPoints.length;a++)d.push([this._inputPoints[a].x,this._inputPoints[a].y]);d.push([this._inputPoints[0].x,this._inputPoints[0].y]);c.addRing(d);this._currentGeometry=c;this._polygonGraphic?(this._map.graphics.remove(this._polygonGraphic),this._polylineGraphics.push(this._tempGraphic),this._polygonGraphic=this._generatePolygonFromPaths(),this._map.graphics.add(this._polygonGraphic),
this._measureGraphic=this._polygonGraphic,this._polylineGraphics.pop()):(this._polygonGraphic=this._generatePolygonFromPaths(),this._map.graphics.add(this._polygonGraphic));this._getArea(c)}}else this._polygonGraphic&&(this._map.graphics.remove(this._polygonGraphic),this._polygonGraphic=null)},_measureAreaMouseMoveHandler:function(a){var b;if(0<this._inputPoints.length){var c,d=new B(this._map.spatialReference);this._map.snappingManager&&(c=this._map.snappingManager._snappingPoint);b=c||a.mapPoint;
d.addPath([this._currentStartPt,b]);a=this._densifyGeometry(d);this._tempGraphic.setGeometry(a)}1<this._inputPoints.length&&(a=new B(this._map.spatialReference),a.addPath([b,this._inputPoints[0]]),b=this._densifyGeometry(a),this._tempGraphic.setGeometry(this._tempGraphic.geometry.addPath(b.paths[0])))},_measureAreaDblClickHandler:function(a){b.disconnect(this._mouseMoveMapHandler);this._mouseMoveMapHandler=null;"touch"===this._map.navigationManager.eventModel&&m("ios")&&this._measureAreaMouseClickHandler(a);
var c=new C(this._map.spatialReference),d=[];for(a=0;a<this._inputPoints.length;a++)d.push([this._inputPoints[a].x,this._inputPoints[a].y]);d.push([this._inputPoints[0].x,this._inputPoints[0].y]);c.addRing(d);this._inputPoints=[];this._currentGeometry=c;this._polygonGraphic&&(this._map.graphics.remove(this._polygonGraphic),this._polylineGraphics.push(this._tempGraphic),this._polygonGraphic=this._generatePolygonFromPaths(),this._map.graphics.add(this._polygonGraphic));this._getArea(c);this._polylineGraphics=
[]},_measureDistanceMouseClickHandler:function(a){var c;this._map.snappingManager&&(c=this._map.snappingManager._snappingPoint);a=c||a.mapPoint;if(this._inputPoints.push(a),this._currentStartPt=a,1===this._inputPoints.length){for(c=0;c<this._measureGraphics.length;c++)this._map.graphics.remove(this._measureGraphics[c]);this._map.graphics.remove(this._tempGraphic);this._measureGraphics=[];this.result=0;this._outputResult(this.result,X.widgets.measurement.NLS_length_meters);this._tempGraphic=new D;
this._tempGraphic.setSymbol(this._lineSymbol);this._map.graphics.add(this._tempGraphic);this._mouseMoveMapHandler=b.connect(this._map,"onMouseMove",this,"_measureDistanceMouseMoveHandler");this.onMeasureStart(this.activeTool,this.getUnit())}this._tempGraphic.setGeometry(new B(this._map.spatialReference));c=new D;if(c.setSymbol(this._pointSymbol),c.setGeometry(a),this._measureGraphics.push(c),this._map.graphics.add(c),1<this._inputPoints.length){this._measureGraphic=new D;this._measureGraphic.setSymbol(this._lineSymbol);
this._measureGraphics.push(this._measureGraphic);c=new B(this._map.spatialReference);c.addPath([this._inputPoints[this._inputPoints.length-2],a]);var d=this._densifyGeometry(c);(this._measureGraphic.setGeometry(d),this._map.graphics.add(this._measureGraphic),"PCS"===this._map.cs)?this._geometryServiceLength(c,!1):(d=this._geodesicDistance(this._inputPoints[this._inputPoints.length-2],a),c=this._outputResult(d,this.getUnit()),this.result+=d,this._showDistance(this.result),d=this._outputResult(this.result,
this.getUnit()),this.onMeasure(this.activeTool,a,d,this.getUnit(),c))}else c.setSymbol(this._pointSymbol)},_measureDistanceMouseMoveHandler:function(a){if(0<this._inputPoints.length){var b,c=new B(this._map.spatialReference);this._map.snappingManager&&(b=this._map.snappingManager._snappingPoint);a=b||a.mapPoint;c.addPath([this._currentStartPt,a]);c=this._densifyGeometry(c);if(this._tempGraphic.setGeometry(c),"PCS"!==this._map.cs)b=this._geodesicDistance(this._currentStartPt,a),c=this._outputResult(b,
this.getUnit()),b+=this.result,this._showDistance(b),b=this._outputResult(b,this.getUnit()),this.onMeasure(this.activeTool,a,b,this.getUnit(),c)}},_measureDistanceDblClickHandler:function(a){var c;b.disconnect(this._mouseMoveMapHandler);this._mouseMoveMapHandler=null;"touch"===this._map.navigationManager.eventModel&&m("ios")&&this._measureDistanceMouseClickHandler(a);a=new B(this._map.spatialReference);a.addPath(this._inputPoints);this._currentGeometry=a;c=this._densifyGeometry(a);this._measureGraphic.geometry=
c;"PCS"===this._map.cs?this._geometryServiceLength(a,!0):(this._inputPoints=[],this.onMeasureEnd(this.activeTool,a,this._outputResult(this.result,this.getUnit()),this.getUnit()))},_geometryServiceLength:function(b,c){var d=new F;d.polylines=[b];d.lengthUnit=9001;d.calculationType="geodesic";this._geometryService.lengths(d,a.hitch(this,function(a){a=a.lengths[0];if(c)this.result=a,this._showDistance(this.result),this._inputPoints=[],this.onMeasureEnd(this.activeTool,b,this._outputResult(this.result,
this.getUnit()),this.getUnit());else{var d=this._outputResult(a,this.getUnit());this.result+=a;this._showDistance(this.result);this.onMeasure(this.activeTool,b,this._outputResult(this.result,this.getUnit()),this.getUnit(),d)}}))},_locationClickHandler:function(a){var b;this._map.snappingManager&&(b=this._map.snappingManager._snappingPoint);a=b||a.mapPoint;this._locationButtonToggle();this._locationGraphic=new D;this._locationGraphic.setGeometry(a);this._locationGraphic.setSymbol(this._pointSymbol);
this._map.graphics.add(this._locationGraphic);this._measureGraphics.push(this._locationGraphic);this._calculateLocation(a,!0)},_locationMoveHandler:function(a){var b;this._map.snappingManager&&(b=this._map.snappingManager._snappingPoint);this._calculateLocation(b||a.mapPoint,!1)},_outputResult:function(a,b){var c=a/this._unitDictionary[b];return 0===c?this.resultValue.setContent("\x26nbsp"):1E6<c?this.resultValue.setContent(M.format(c.toPrecision(9),{pattern:this.numberPattern})+" "+b):10>c?this.resultValue.setContent(M.format(c.toFixed(2),
{pattern:this.numberPattern+"0"})+" "+b):this.resultValue.setContent(M.format(c.toFixed(2),{pattern:this.numberPattern})+" "+b),c},_createDistanceUnitList:function(){var b,c=new t({style:"display: none;"});f.forEach(this._distanceUnitStrings,a.hitch(this,function(b,d){var e=new r({label:b,onClick:a.hitch(this,function(){this._switchUnit(this._distanceUnitStringsLong[d])})});e.set("class","unitDropDown");c.addChild(e)}));q.byNode(this._unitDropDown.domNode).set("dropDown",c);this.currentDistanceUnit?
(b=this._unitStrings[this.currentDistanceUnit],q.byNode(this._unitDropDown.domNode).set("label",b)):(b=this._unitStrings[this._defaultDistanceUnit],q.byNode(this._unitDropDown.domNode).set("label",b),this.currentDistanceUnit=this._defaultDistanceUnit)},_createAreaUnitList:function(){var b,c=new t({style:"display: none;"});f.forEach(this._areaUnitStrings,a.hitch(this,function(b,d){var e=new r({label:b,onClick:a.hitch(this,function(){this._switchUnit(this._areaUnitStringsLong[d])})});e.set("class",
"unitDropDown");c.addChild(e)}));q.byNode(this._unitDropDown.domNode).set("dropDown",c);this.currentAreaUnit?(b=this._unitStrings[this.currentAreaUnit],q.byNode(this._unitDropDown.domNode).set("label",b)):(b=this._unitStrings[this._defaultAreaUnit],q.byNode(this._unitDropDown.domNode).set("label",b),this.currentAreaUnit=this._defaultAreaUnit)},_createLocationUnitList:function(){var b;b=this._locationUnitStrings;var c=new t({style:"display: none;"});null!==this._geometryService&&!1!==this.advancedLocationUnits||
(b=b.slice(0,2));f.forEach(b,a.hitch(this,function(b,d){var e=new r({label:b,onClick:a.hitch(this,function(){this._switchLocationUnit(this._locationUnitStringsLong[d])})});e.set("class","unitDropDown");c.addChild(e)}));q.byNode(this._unitDropDown.domNode).set("dropDown",c);this.currentLocationUnit||(this.currentLocationUnit=this._defaultLocationUnit);b=this._unitStrings[this.currentLocationUnit];q.byNode(this._unitDropDown.domNode).set("label",b);"esriDegreeMinuteSeconds"!==this.currentLocationUnit&&
"esriDecimalDegrees"!==this.currentLocationUnit||this._toggleLocationResultsTable(!0,!1)},_drawPointGraphics:function(b){var e,f,l=this._pointSymbol;b=d.create("div",{"class":"esriLocationResultSymbol"},b);b=c.createSurface(b,10,10);9>m("ie")&&(e=b.getEventSource(),g.set(e,"position","relative"),g.set(e.parentNode,"position","relative"));e=l.getShapeDescriptors();try{f=b.createShape(e.defaultShape).setFill(e.fill).setStroke(e.stroke)}catch(ta){return b.clear(),void b.destroy()}var h=f.getBoundingBox();
e=h.width;var l=h.height,k=-(h.x+e/2),h=-(h.y+l/2);b=b.getDimensions();b={dx:k+b.width/2,dy:h+b.height/2};if(10<e||10<l)e=5/(e/10>l/10?e:l),a.mixin(b,{xx:e,yy:e});f.applyTransform(b)}});return m("extend-esri")&&a.setObject("dijit.Measurement",k,I),k})},"esri/tasks/AreasAndLengthsParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel".split(" "),function(h,k,a,f,b,e){h=h(null,{declaredClass:"esri.tasks.AreasAndLengthsParameters",polygons:null,
lengthUnit:null,areaUnit:null,calculationType:null,toJson:function(){var b=a.map(this.polygons,function(a){return a.toJson()}),e={};e.polygons=f.toJson(b);b=this.polygons[0].spatialReference;return e.sr=b.wkid?b.wkid:f.toJson(b.toJson()),this.lengthUnit&&(e.lengthUnit=this.lengthUnit),this.areaUnit&&(k.isString(this.areaUnit)?e.areaUnit=f.toJson({areaUnit:this.areaUnit}):e.areaUnit=this.areaUnit),this.calculationType&&(e.calculationType=this.calculationType),e}});return b("extend-esri")&&k.setObject("tasks.AreasAndLengthsParameters",
h,e),h})},"esri/tasks/LengthsParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel".split(" "),function(h,k,a,f,b,e){h=h(null,{declaredClass:"esri.tasks.LengthsParameters",polylines:null,lengthUnit:null,geodesic:null,calculationType:null,toJson:function(){var b=a.map(this.polylines,function(a){return a.toJson()}),e={};e.polylines=f.toJson(b);b=this.polylines[0].spatialReference;return e.sr=b.wkid?b.wkid:f.toJson(b.toJson()),this.lengthUnit&&
(e.lengthUnit=this.lengthUnit),this.geodesic&&(e.geodesic=this.geodesic),this.calculationType&&(e.calculationType=this.calculationType),e}});return b("extend-esri")&&k.setObject("tasks.LengthsParameters",h,e),h})},"cmv/viewer/js/gis/dijit/Print":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/tasks/PrintTask dojo/store/Memory dojo/_base/lang dojo/_base/array dojo/topic dojo/dom-style dojo/dom-construct dojo/dom-class dojo/date/locale dojo/text!./Print/templates/Print.html dojo/text!./Print/templates/PrintResult.html esri/tasks/PrintTemplate esri/tasks/PrintParameters esri/request esri/urlUtils dojo/i18n!./Print/nls/resource dijit/form/Form dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/form/NumberTextBox dijit/form/Button dijit/form/CheckBox dijit/ProgressBar dijit/form/DropDownButton dijit/TooltipDialog dijit/form/RadioButton xstyle/css!./Print/css/Print.css".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y){var A=h([k,a,f],{widgetsInTemplate:!0,templateString:r,i18n:y,url:null,fileHandle:null,resultOrder:"last",postCreate:function(){this.inherited(arguments);this.fileHandle.then(l.hitch(this,"_onPrintComplete"),l.hitch(this,"_onPrintError"))},_onPrintComplete:function(a){if(a.url){var b=x.getProxyRule(a.url);this.url=b&&b.proxyUrl?b.proxyUrl+"?"+a.url:a.url;this.nameNode.innerHTML='\x3cspan class\x3d"bold"\x3e'+this.docName+"\x3c/span\x3e";n.add(this.resultNode,
"printResultHover")}else this._onPrintError(this.i18n.printResults.errorMessage)},_onPrintError:function(a){g.publish("viewer/handleError",{source:"Print",error:a});this.nameNode.innerHTML='\x3cspan class\x3d"bold"\x3e'+y.printResults.errorMessage+"\x3c/span\x3e";n.add(this.resultNode,"printResultError")},_openPrint:function(){null!==this.url&&window.open(this.url)},_handleStatusUpdate:function(a){"esriJobFailed"===a.jobInfo.jobStatus&&this._onPrintError(this.i18n.printResults.errorMessage)}});return h([k,
a,f],{widgetsInTemplate:!0,templateString:t,i18n:y,map:null,count:1,results:[],authorText:null,copyrightText:null,defaultTitle:null,defaultFormat:null,defaultLayout:null,baseClass:"gis_PrintDijit",pdfIcon:require.toUrl("gis/dijit/Print/images/pdf.png"),imageIcon:require.toUrl("gis/dijit/Print/images/image.png"),printTaskURL:null,printTask:null,postCreate:function(){this.inherited(arguments);this.printparams=new u;this.printparams.map=this.map;this.printparams.outSpatialReference=this.map.spatialReference;
w({url:this.printTaskURL,content:{f:"json"},handleAs:"json",callbackParamName:"callback",load:l.hitch(this,"_handlePrintInfo"),error:l.hitch(this,"_handleError")})},operationalLayersInspector:function(a){m.forEach(a,function(a){"Measurement_graphicslayer"===a.id&&m.forEach(a.featureCollection.layers,function(a){m.forEach(a.featureSet.features,function(a){delete a.attributes;a.symbol.font.family="Courier"})})});return a},_handleError:function(a){g.publish("viewer/handleError",{source:"Print",error:a})},
_handlePrintInfo:function(a){this.printTask=new b(this.printTaskURL,{async:"esriExecutionTypeAsynchronous"===a.executionType});var c=m.filter(a.parameters,function(a){return"Layout_Template"===a.name});if(0===c.length)g.publish("viewer/handleError",{source:"Print",error:"Print service parameters name for templates must be 'Layout_Template'"});else{var d=m.map(c[0].choiceList,function(a){return{name:a,id:a}});d.sort(function(a,b){return a.name>b.name?1:b.name>a.name?-1:0});d=new e({data:d});this.layoutDijit.set("store",
d);this.defaultLayout?this.layoutDijit.set("value",this.defaultLayout):this.layoutDijit.set("value",c[0].defaultValue);a=m.filter(a.parameters,function(a){return"Format"===a.name});0===a.length?g.publish("viewer/handleError",{source:"Print",error:"Print service parameters name for format must be 'Format'"}):(c=m.map(a[0].choiceList,function(a){return{name:a,id:a}}),c.sort(function(a,b){return a.name>b.name?1:b.name>a.name?-1:0}),c=new e({data:c}),this.formatDijit.set("store",c),this.defaultFormat?
this.formatDijit.set("value",this.defaultFormat):this.formatDijit.set("value",a[0].defaultValue))}},print:function(){if(this.printSettingsFormDijit.isValid()){var a=this.printSettingsFormDijit.get("value"),b=this.preserveFormDijit.get("value");l.mixin(a,b);var b=this.layoutFormDijit.get("value"),c=this.mapQualityFormDijit.get("value"),e=this.mapOnlyFormDijit.get("value");l.mixin(e,c);c=new v;c.format=a.format;c.layout=a.layout;c.preserveScale=eval(a.preserveScale);c.outScale=a.outScale;c.label=a.title;
c.exportOptions=e;c.layoutOptions={authorText:this.authorText,copyrightText:this.copyrightText,legendLayers:0<b.legend.length&&b.legend[0]?null:[],titleText:a.title,scalebarUnit:b.scalebarUnit};this.printparams.template=c;b=this.printTask.execute(this.printparams);a=(new A({count:this.count.toString(),icon:"PDF"===a.format?this.pdfIcon:this.imageIcon,docName:a.title,title:a.format+", "+a.layout+", "+q.format(new Date,{formatLength:"short"}),fileHandle:b})).placeAt(this.printResultsNode,this.resultOrder);
this.printTask.async&&a.own(this.printTask.printGp.on("status-update",l.hitch(a,"_handleStatusUpdate")));d.set(this.clearActionBarNode,"display","block");this.count++}else this.printSettingsFormDijit.validate()},clearResults:function(){c.empty(this.printResultsNode);d.set(this.clearActionBarNode,"display","none");this.count=1}})})},"esri/tasks/PrintTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../lang ../layerUtils ../deferredUtils ../Color ../urlUtils ./Task ../geometry/Polygon ../renderers/SimpleRenderer ../geometry/scaleUtils ../symbols/FillSymbol ./Geoprocessor ./PrintTemplate dojo/dom-attr dojo/dom-construct dojox/gfx/_base dojox/gfx/canvas dojox/json/query require require".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C){h=h(q,{declaredClass:"esri.tasks.PrintTask",constructor:function(a,b){this.url=a;this.printGp=new w(this.url);this._handler=k.hitch(this,this._handler);b&&b.async&&(this.async=b.async);this._colorEvaluator=C("$..color")},_handler:function(a,b,c,d,e){try{var f;this.async?"esriJobSucceeded"===a.jobStatus&&this.printGp.getResultData(a.jobId,"Output_File",k.hitch(this,function(a){f=a.value;this._successHandler([f],"onComplete",c,e)})):(f=a[0].value,
this._successHandler([f],"onComplete",c,e))}catch(L){this._errorHandler(L,d,e)}},execute:function(c,e,g){var l=this._handler,h=this._errorHandler,n=c.template||new x;n.hasOwnProperty("showLabels")||(n.showLabels=!0);var q,r=n.exportOptions;r&&(q={outputSize:[r.width,r.height],dpi:r.dpi});var t,r=n.layoutOptions,u=[];if(r){this.legendAll=!1;r.legendLayers?a.forEach(r.legendLayers,function(a){var b={};b.id=a.layerId;a.subLayerIds&&(b.subLayerIds=a.subLayerIds);u.push(b)}):this.legendAll=!0;var v,w;
"Miles"===r.scalebarUnit||"Kilometers"===r.scalebarUnit?(v="esriKilometers",w="esriMiles"):("Meters"===r.scalebarUnit||"Feet"===r.scalebarUnit)&&(v="esriMeters",w="esriFeet");t={esriMiles:"mi",esriKilometers:"km",esriFeet:"ft",esriMeters:"m"};t={titleText:r.titleText,authorText:r.authorText,copyrightText:r.copyrightText,customTextElements:r.customTextElements,scaleBarOptions:{metricUnit:v,metricLabel:t[v],nonMetricUnit:w,nonMetricLabel:t[w]},legendOptions:{operationalLayers:u}}}v=this._getPrintDefinition(c.map,
n);if(c.outSpatialReference&&(v.mapOptions.spatialReference=c.outSpatialReference.toJson()),c.template&&m.isDefined(c.template.showAttribution)&&(v.mapOptions.showAttribution=c.template.showAttribution),k.mixin(v,{exportOptions:q,layoutOptions:t}),this.allLayerslegend&&k.mixin(v.layoutOptions,{legendOptions:{operationalLayers:this.allLayerslegend}}),v.operationalLayers){var z,r=v.operationalLayers,C=function(a){return m.fixJson(k.mixin(a,{type:"esriSLS",cap:void 0,join:void 0,meterLimit:void 0}))};
for(q=0;q<r.length;q++)if(r[q].featureCollection&&r[q].featureCollection.layers)for(t=0;t<r[q].featureCollection.layers.length;t++){var y=r[q].featureCollection.layers[t];if(y.layerDefinition&&y.layerDefinition.drawingInfo&&y.layerDefinition.drawingInfo.renderer&&y.layerDefinition.drawingInfo.renderer.symbol&&(z=y.layerDefinition.drawingInfo.renderer,"esriCLS"===z.symbol.type?z.symbol=C(z.symbol):z.symbol.outline&&"esriCLS"===z.symbol.outline.type&&(z.symbol.outline=C(z.symbol.outline))),y.featureSet&&
y.featureSet.features)for(w=0;w<y.featureSet.features.length;w++)z=y.featureSet.features[w],z.symbol&&("esriCLS"===z.symbol.type?z.symbol=C(z.symbol):z.symbol.outline&&"esriCLS"===z.symbol.outline.type&&(z.symbol.outline=C(z.symbol.outline)))}}n={Web_Map_as_JSON:f.toJson(m.fixJson(v)),Format:n.format,Layout_Template:n.layout};c.extraParameters&&(n=k.mixin(n,c.extraParameters));var D=new b(d._dfdCanceller);c=function(a,b){l(a,b,e,g,D)};z=function(a){h(a,g,D)};return this.async?D._pendingDfd=this.printGp.submitJob(n,
c,null,z):D._pendingDfd=this.printGp.execute(n,c,z),D},onComplete:function(){},_createMultipointLayer:function(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}},_createPolygonLayer:function(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}},_createPointLayer:function(){return{layerDefinition:{name:"pointLayer",
geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}},_createPolylineLayer:function(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}},_convertSvgSymbol:function(a){if(!(8>=e("ie")||!a.path&&"image/svg+xml"!==a.contentType)){var b,c=B.createSurface(A.create("div"),1024,1024);b="image/svg+xml"===a.contentType?
c.createObject(B.Image,{src:"data:image/svg+xml;base64,"+a.imageData,width:z.pt2px(a.width),height:z.pt2px(a.height),x:0,y:0}):c.createObject(B.Path,a.path).setFill(a.color).setStroke(a.outline);"pendingRender"in c&&c._render(!0);var d=c.rawNode.getContext("2d"),f=Math.ceil(b.getBoundingBox().width),g=Math.ceil(b.getBoundingBox().height);b=d.getImageData(b.getBoundingBox().x,b.getBoundingBox().y,f,g);d.canvas.width=f;d.canvas.height=g;d.putImageData(b,0,0);d=d.canvas.toDataURL("image/png");a={type:"esriPMS",
imageData:d.substr(22,d.length),angle:a.angle,contentType:"image/png",height:a.size?a.size:z.px2pt(g),width:a.size?f/g*a.size:z.px2pt(f),xoffset:a.xoffset,yoffset:a.yoffset};return c.destroy(),a}},_convertSvgRenderer:function(b){"simple"===b.type&&b.symbol&&(b.symbol.path||"image/svg+xml"===b.symbol.contentType)?b.symbol=this._convertSvgSymbol(b.symbol):"uniqueValue"===b.type?(b.defaultSymbol&&(b.defaultSymbol.path||"image/svg+xml"===b.defaultSymbol.contentType)&&(b.defaultSymbol=this._convertSvgSymbol(b.defaultSymbol)),
b.uniqueValueInfos&&a.forEach(b.uniqueValueInfos,function(a){(a.symbol.path||"image/svg+xml"===a.symbol.contentType)&&(a.symbol=this._convertSvgSymbol(a.symbol))},this)):"classBreaks"===b.type&&(b.defaultSymbol&&(b.defaultSymbol.path||"image/svg+xml"===b.defaultSymbol.contentType)&&(b.defaultSymbol=this._convertSvgSymbol(b.defaultSymbol)),b.classBreakInfos&&a.forEach(b.classBreakInfos,function(a){(a.symbol.path||"image/svg+xml"===a.symbol.contentType)&&(a.symbol=this._convertSvgSymbol(a.symbol))},
this))},_createFeatureCollection:function(b,c,d){var e=this._createPolygonLayer(),f=this._createPolylineLayer(),g=this._createPointLayer(),l=this._createMultipointLayer(),h=this._createPointLayer();if(h.layerDefinition.name="textLayer",delete h.layerDefinition.drawingInfo,("esri.layers.FeatureLayer"===b.declaredClass||"esri.layers.StreamLayer"===b.declaredClass)&&(e.layerDefinition.name=f.layerDefinition.name=g.layerDefinition.name=l.layerDefinition.name=k.getObject("arcgisProps.title",!1,b)||b.name||
b.id),b.renderer&&!k.isFunction(b.renderer.attributeField)){var m=b.renderer.toJson();if("temporal"===m.type){var m={latestObservationRenderer:m.latestObservationRenderer,trackLinesRenderer:m.trackRenderer,observationAger:m.observationAger,renderer:m.observationRenderer},n={};b._trackIdField&&(n.trackIdField=b._trackIdField);b._startTimeField&&(n.startTimeField=b._startTimeField);b._endTimeField&&(n.endTimeField=b._endTimeField);e.layerDefinition.drawingInfo=m;e.layerDefinition.timeInfo=n;f.layerDefinition.drawingInfo=
m;f.layerDefinition.timeInfo=n;g.layerDefinition.drawingInfo=m;g.layerDefinition.timeInfo=n;l.layerDefinition.drawingInfo=m;l.layerDefinition.timeInfo=n}else e.layerDefinition.drawingInfo.renderer=m,f.layerDefinition.drawingInfo.renderer=m,g.layerDefinition.drawingInfo.renderer=m,l.layerDefinition.drawingInfo.renderer=m}else delete e.layerDefinition.drawingInfo,delete f.layerDefinition.drawingInfo,delete g.layerDefinition.drawingInfo,delete l.layerDefinition.drawingInfo;(m=b.fields)||!b.renderer||
k.isFunction(b.renderer.attributeField)||("esri.renderer.ClassBreaksRenderer"===b.renderer.declaredClass?(m=[{name:b.renderer.attributeField,type:"esriFieldTypeDouble"}],b.renderer.normalizationField&&m.push({name:b.renderer.normalizationField,type:"esriFieldTypeDouble"})):"esri.renderer.UniqueValueRenderer"===b.renderer.declaredClass&&(m=[{name:b.renderer.attributeField,type:"esriFieldTypeString"}],b.renderer.attributeField2&&m.push({name:b.renderer.attributeField2,type:"esriFieldTypeString"}),b.renderer.attributeField3&&
m.push({name:b.renderer.attributeField3,type:"esriFieldTypeString"})));m&&(e.layerDefinition.fields=m,f.layerDefinition.fields=m,g.layerDefinition.fields=m,l.layerDefinition.fields=m);for(var q,n=b.graphics.length,m=0;n>m;m++){var r=b.graphics[m];if(!1!==r.visible&&r.geometry){if(q=r.toJson(),q.symbol&&q.symbol.outline&&q.symbol.outline.color&&q.symbol.outline.color[3]&&(q.symbol.outline.color[3]=255),b.renderer&&!q.symbol&&(k.isFunction(b.renderer.attributeField)||this._isFeatureCollectionRequired(b.renderer)||
"esri.renderer.DotDensityRenderer"===b.renderer.declaredClass||d)){d=d||b.renderer;var u=null;try{u=d.getSymbol(r)}catch(Q){}if(!u)continue;q.symbol=u.toJson();this._isFeatureCollectionRequired(d)&&this._applyVisualVariables(q.symbol,{renderer:d,graphic:r,symbol:u,mapResolution:c&&c.getResolutionInMeters(),mapScale:c&&c.getScale()})}switch(q.symbol&&(q.symbol.path||"image/svg+xml"===q.symbol.contentType?q.symbol=this._convertSvgSymbol(q.symbol):q.symbol.text&&delete q.attributes),r.geometry.type){case "polygon":e.featureSet.features.push(q);
break;case "polyline":f.featureSet.features.push(q);break;case "point":q.symbol&&q.symbol.text?h.featureSet.features.push(q):g.featureSet.features.push(q);break;case "multipoint":l.featureSet.features.push(q);break;case "extent":q.geometry=t.fromExtent(r.geometry).toJson(),e.featureSet.features.push(q)}}}c=[];if(0<e.featureSet.features.length&&c.push(e),0<f.featureSet.features.length&&c.push(f),0<l.featureSet.features.length&&c.push(l),0<g.featureSet.features.length&&c.push(g),0<h.featureSet.features.length&&
c.push(h),!c.length)return null;a.forEach(c,function(b){b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.renderer&&a.every(b.featureSet.features,function(a){return a.symbol})&&delete b.layerDefinition.drawingInfo});a.forEach(c,function(a){a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&this._convertSvgRenderer(a.layerDefinition.drawingInfo.renderer)},this);return{id:b.id,opacity:b.opacity,minScale:b.minScale||0,maxScale:b.maxScale||0,featureCollection:{layers:c}}},
_getPrintDefinition:function(a,b){var c={operationalLayers:this._createOperationalLayers(a,b)},d=a.extent,e=a.spatialReference;a.spatialReference._isWrappable()&&(d=d._normalize(!0),e=d.spatialReference);d={mapOptions:{showAttribution:a.showAttribution,extent:d.toJson(),spatialReference:e.toJson()}};b.preserveScale&&k.mixin(d.mapOptions,{scale:b.outScale||v.getScale(a)});a.timeExtent&&k.mixin(d.mapOptions,{time:[a.timeExtent.startTime.getTime(),a.timeExtent.endTime.getTime()]});e={};return k.mixin(e,
d,c),e},_createOperationalLayers:function(b,c){var d,e,l,h,m=[];this.legendAll?this.allLayerslegend=[]:this.allLayerslegend=null;var q=a.map(b.layerIds,b.getLayer,b);b._mapImageLyr&&q.push(b._mapImageLyr);for(d=0;d<q.length;d++)if(e=q[d],e.loaded&&e.visible)switch(l=e.declaredClass,h={id:e.id,title:k.getObject("arcgisProps.title",!1,e)||e.id,opacity:e.opacity,minScale:e.minScale||0,maxScale:e.maxScale||0},h=k.mixin(h,this._getUrlAndToken(e)),e.getNode()&&y.get(e.getNode(),"data-reference")&&(h._isRefLayer=
!0),l){case "esri.layers.ArcGISDynamicMapServiceLayer":var t=[],u=!!e._params.layers;if(e._params.dynamicLayers)u=f.fromJson(e._params.dynamicLayers),a.forEach(u,function(a){t.push({id:a.id,name:a.name,layerDefinition:a});delete a.id;delete a.name;delete a.maxScale;delete a.minScale}),0===t.length&&(h.visibleLayers=[-1]);else if(e.supportsDynamicLayers){if(u||e.layerDefinitions||e.layerTimeOptions){var v=e.createDynamicLayerInfosFromLayerInfos(),w=null;u&&(w=e.visibleLayers);var w=g._getVisibleLayers(v,
w),x=g._getLayersForScale(c.outScale||b.getScale(),v);a.forEach(v,function(b){if(!b.subLayerIds){var c=b.id;-1<a.indexOf(w,c)&&-1<a.indexOf(x,c)&&(b={source:b.source.toJson()},e.layerDefinitions&&e.layerDefinitions[c]&&(b.definitionExpression=e.layerDefinitions[c]),e.layerTimeOptions&&e.layerTimeOptions[c]&&(b.layerTimeOptions=e.layerTimeOptions[c].toJson()),t.push({id:c,layerDefinition:b}))}});0===t.length&&(h.visibleLayers=[-1])}}else a.forEach(e.layerInfos,function(a){var b={id:a.id,layerDefinition:{}};
e.layerDefinitions&&e.layerDefinitions[a.id]&&(b.layerDefinition.definitionExpression=e.layerDefinitions[a.id]);e.layerTimeOptions&&e.layerTimeOptions[a.id]&&(b.layerDefinition.layerTimeOptions=e.layerTimeOptions[a.id].toJson());(b.layerDefinition.definitionExpression||b.layerDefinition.layerTimeOptions)&&t.push(b)}),u&&(h.visibleLayers=e.visibleLayers);t.length&&(h.layers=t);m.push(h);this.allLayerslegend&&this.allLayerslegend.push({id:e.id,subLayerIds:e.visibleLayers});break;case "esri.layers.ArcGISImageServiceLayer":h=
k.mixin(h,{url:e.url,bandIds:e.bandIds,compressionQuality:e.compressionQuality,format:e.format,interpolation:e.interpolation});e.mosaicRule&&k.mixin(h,{mosaicRule:e.mosaicRule.toJson()});e.renderingRule&&k.mixin(h,{renderingRule:e.renderingRule.toJson()});m.push(h);this.allLayerslegend&&this.allLayerslegend.push({id:e.id});break;case "esri.layers.WMSLayer":h=k.mixin(h,{url:e.url,title:e.title,type:"wms",version:e.version,transparentBackground:e.imageTransparency,visibleLayers:e.visibleLayers});m.push(h);
this.allLayerslegend&&this.allLayerslegend.push({id:e.id,subLayerIds:e.visibleLayers});break;case "esri.virtualearth.VETiledLayer":u=e.mapStyle;"aerialWithLabels"===u&&(u="Hybrid");h=k.mixin(h,{visibility:e.visible,type:"BingMaps"+u,culture:e.culture,key:e.bingMapsKey});m.push(h);break;case "esri.layers.OpenStreetMapLayer":h=k.mixin(h,{credits:e.copyright,type:"OpenStreetMap",url:n.getAbsoluteUrl(e.tileServers[0])});m.push(h);break;case "esri.layers.WMTSLayer":h=k.mixin(h,{url:e.url,type:"wmts",layer:e._identifier,
style:e._style,format:e.format,tileMatrixSet:e._tileMatrixSetId});m.push(h);break;case "esri.layers.MapImageLayer":u=e.getImages();a.forEach(u,function(a,b){a.href&&(h={id:e.id+"_image"+b,type:"image",title:e.id,minScale:e.minScale||0,maxScale:e.maxScale||0,opacity:e.opacity*a.opacity,extent:a.extent.toJson()},"data:image/png;base64,"===a.href.substr(0,22)?h.imageData=a.href.substr(22):h.url=a.href,m.push(h))});break;case "esri.layers.VectorTileLayer":u=/^https?:\/\/basemaps(dev)?\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/World_Basemap\/VectorTileServer/i;
!h._isRefLayer&&e.currentStyleInfo&&u.test(e.currentStyleInfo.serviceUrl)&&(h.url="http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer",m.push(h));break;case "esri.layers.WebTiledLayer":u=e.url.replace(/\$\{/g,"{");h=k.mixin(h,{type:"WebTiledLayer",urlTemplate:u,credits:e.copyright});e.subDomains&&0<e.subDomains.length&&(h.subDomains=e.subDomains);e._wmtsInfo&&(h.wmtsInfo=e._wmtsInfo);delete h.url;m.push(h);break;default:(e.getTileUrl||e.getImageUrl)&&(h=k.mixin(h,{url:e.url}),
m.push(h))}for(d=0;d<b.graphicsLayerIds.length;d++)if(e=b.getLayer(b.graphicsLayerIds[d]),e.loaded&&e.visible){l=e.declaredClass;var z;switch(l){case "esri.layers.FeatureLayer":case "esri.layers.LabelLayer":case "esri.layers.CSVLayer":case "esri.layers.StreamLayer":if("esri.layers.LabelLayer"===l&&!c.showLabels||e.renderer&&"esri.renderer.HeatmapRenderer"===e.renderer.declaredClass)continue;if(z=null,e.url&&e.renderer&&("esri.renderer.ScaleDependentRenderer"===e.renderer.declaredClass?"scale"===e.renderer.rangeType?
z=e.renderer.getRendererInfoByScale(b.getScale())&&e.renderer.getRendererInfoByScale(b.getScale()).renderer:"zoom"===e.renderer.rangeType&&(z=e.renderer.getRendererInfoByZoom(b.getZoom())&&e.renderer.getRendererInfoByZoom(b.getZoom()).renderer):z=e.renderer),z&&("esri.renderer.SimpleRenderer"===z.declaredClass||"esri.renderer.TemporalRenderer"===z.declaredClass||k.isString(z.attributeField)&&e._getField(z.attributeField,!0))&&!this._isFeatureCollectionRequired(z)&&"esri.renderer.DotDensityRenderer"!==
z.declaredClass&&"esri.layers.CSVLayer"!==e.declaredClass&&"esri.layers.StreamLayer"!==e.declaredClass){if(h={id:e.id,title:k.getObject("arcgisProps.title",!1,e)||e.id,opacity:e.opacity,minScale:e.minScale||0,maxScale:e.maxScale||0,layerDefinition:{drawingInfo:{renderer:z.toJson()}}},h=k.mixin(h,this._getUrlAndToken(e)),"esri.renderer.TemporalRenderer"===z.declaredClass)l=h.layerDefinition.drawingInfo,l.latestObservationRenderer=l.renderer.latestObservationRenderer,l.trackLinesRenderer=l.renderer.trackRenderer,
l.observationAger=l.renderer.observationAger,l.renderer=l.renderer.observationRenderer,e._trackIdField&&(h.layerDefinition.timeInfo={trackIdField:e._trackIdField});if(this._convertSvgRenderer(h.layerDefinition.drawingInfo.renderer),1>e.opacity||"esri.renderer.TemporalRenderer"===z.declaredClass||this._updateLayerOpacity(h))if(e._params.source&&(l=e._params.source.toJson(),k.mixin(h.layerDefinition,{source:l})),e.getDefinitionExpression()&&k.mixin(h.layerDefinition,{definitionExpression:e.getDefinitionExpression()}),
2!==e.mode)0<e.getSelectedFeatures().length&&(l=a.map(e.getSelectedFeatures(),function(a){return a.attributes[e.objectIdField]}),0<l.length&&e.getSelectionSymbol()&&k.mixin(h,{selectionObjectIds:l,selectionSymbol:e.getSelectionSymbol().toJson()}));else{l=a.map(e.getSelectedFeatures(),function(a){return a.attributes[e.objectIdField]});if(0===l.length||!e._params.drawMode)break;k.mixin(h.layerDefinition,{objectIds:l});l=null;e.getSelectionSymbol()&&(l=new r(e.getSelectionSymbol()));k.mixin(h.layerDefinition.drawingInfo,
{renderer:l&&l.toJson()})}else h=this._createFeatureCollection(e,b)}else h=z&&(this._isFeatureCollectionRequired(z)||"esri.renderer.DotDensityRenderer"===z.declaredClass)?this._createFeatureCollection(e,b,z):this._createFeatureCollection(e,b);if(!h)continue;m.push(h);this.allLayerslegend&&this.allLayerslegend.push({id:e.id});break;case "esri.layers.GraphicsLayer":case "esri.layers.WFSLayer":if(h=this._createFeatureCollection(e,b),h)m.push(h),this.allLayerslegend&&this.allLayerslegend.push({id:e.id})}}return b.graphics&&
0<b.graphics.graphics.length&&(h=this._createFeatureCollection(b.graphics,b),h&&m.push(h)),b._labels&&c.showLabels&&(h=this._createFeatureCollection(b._labels,b),h&&m.push(h)),a.forEach(m,function(a,b,c){a._isRefLayer&&(delete a._isRefLayer,c.splice(b,1),c.push(a))}),m},_getUrlAndToken:function(a){return{token:a._getToken(),url:a._url?a._url.path:null}},_updateLayerOpacity:function(b){var c=this._colorEvaluator(b),c=a.filter(c,function(a){return k.isArray(a)&&4===a.length}),d=!0;if(c.length){var e,
f=c[0][3];for(e=1;e<c.length;e++)if(f!==c[e][3]){d=!1;break}if(d)for(b.opacity=f/255,e=0;e<c.length;e++)c[e][3]=255}return d},_isFeatureCollectionRequired:function(a){return a.hasVisualVariables("sizeInfo")||a.hasVisualVariables("colorInfo")||a.hasVisualVariables("opacityInfo")},_getVariable:function(a,b,c){var d,e;return a&&(d=a.getVisualVariablesForType(b,c),e=d&&d[0]),e},_applyVisualVariables:function(a,b){var d=b.renderer,e=b.graphic,f=b.symbol,g=b.mapResolution,l=b.mapScale,h=f.type;if("textsymbol"!==
h&&"shieldlabelsymbol"!==h){var m=this._getVariable(d,"sizeInfo",!1),k=this._getVariable(d,"colorInfo",!1),n=this._getVariable(d,"opacityInfo",!1);if(f instanceof u&&(m=this._getVariable(d,"sizeInfo","outline")||m),m)f=d.getSize(e,{sizeInfo:m,shape:"simplemarkersymbol"===h?f.style:null,resolution:g,scale:l}),null!=f&&("simplemarkersymbol"===h?a.size=z.px2pt(f):"picturemarkersymbol"===h?(a.width=z.px2pt(f),a.height=z.px2pt(f)):"simplelinesymbol"===h?a.width=z.px2pt(f):a.outline&&(a.outline.width=z.px2pt(f)));
k&&(k=d.getColor(e,{colorInfo:k}))&&("simplemarkersymbol"===h||"simplelinesymbol"===h||"simplefillsymbol"===h)&&(a.color=c.toJsonColor(k));n&&(d=d.getOpacity(e,{opacityInfo:n}),null!=d&&a.color&&(a.color[3]=Math.round(255*d)))}}});return e("extend-esri")&&k.setObject("tasks.PrintTask",h,l),h})},"esri/tasks/Geoprocessor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has dojo/io-query ../kernel ../request ../deferredUtils ../geometry/normalizeUtils ./Task ./FeatureSet ./JobInfo ./GPMessage ./LinearUnit ./DataFile ./RasterData ./Date ./ParameterValue ./GPResultImageLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/MapImage".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B){h=h(n,{declaredClass:"esri.tasks.Geoprocessor",_eventMap:{"execute-complete":["results","messages"],"get-result-data-complete":["result"],"get-result-image-complete":["mapImage"],"get-result-image-layer-complete":["layer"],"job-cancel":["jobInfo"],"job-complete":["jobInfo"],"status-update":["jobInfo"]},constructor:function(a){this._jobUpdateHandler=k.hitch(this,this._jobUpdateHandler);this._getJobStatus=k.hitch(this,this._getJobStatus);this._getResultDataHandler=
k.hitch(this,this._getResultDataHandler);this._getResultImageHandler=k.hitch(this,this._getResultImageHandler);this._executeHandler=k.hitch(this,this._executeHandler);this._updateTimers=[];this.registerConnectEvents()},updateDelay:1E3,processSpatialReference:null,outputSpatialReference:null,outSpatialReference:null,setUpdateDelay:function(a){this.updateDelay=a},setProcessSpatialReference:function(a){this.processSpatialReference=a},setOutputSpatialReference:function(a){this._setOutSR(a)},setOutSpatialReference:function(a){this._setOutSR(a)},
__msigns:[{n:"execute",c:3,a:[{i:0,p:["*"]}],e:2,f:1},{n:"submitJob",c:4,a:[{i:0,p:["*"]}],e:3}],_setOutSR:function(a){this.outSpatialReference=this.outputSpatialReference=a},_getOutSR:function(){return this.outSpatialReference||this.outputSpatialReference},_gpEncode:function(c,d,e){for(var f in c){var g=c[f];k.isArray(g)?c[f]=b.toJson(a.map(g,function(a){return this._gpEncode({item:a},!0).item},this)):g instanceof Date&&(c[f]=g.getTime())}return this._encode(c,d,e)},_decode:function(b){var c=b.dataType,
d=new y(b);if(-1!==a.indexOf(["GPBoolean","GPDouble","GPLong","GPString"],c))return d;if("GPLinearUnit"===c)d.value=new v(d.value);else if("GPFeatureRecordSetLayer"===c||"GPRecordSet"===c)d.value=new q(d.value);else if("GPDataFile"===c)d.value=new u(d.value);else if("GPDate"===c)b=d.value,k.isString(b)?d.value=new x({date:b}):d.value=new Date(b);else if("GPRasterData"===c||"GPRasterDataLayer"===c)(b=b.value.mapImage)?d.value=new B(b):d.value=new w(d.value);else if(-1!==c.indexOf("GPMultiValue:")){var e=
c.split(":")[1];b=d.value;d.value=a.map(b,function(a){return this._decode({paramName:"_name",dataType:e,value:a}).value},this)}else d=null;return d},submitJob:function(a,c,d,e,f){var l=this._getOutSR(),h=f.assembly;a=this._gpEncode(k.mixin({},this._url.query,{f:"json","env:outSR":l?l.wkid||b.toJson(l.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||b.toJson(this.processSpatialReference.toJson()):null},a),null,h&&h[0]);var m=this._jobUpdateHandler,n=this._errorHandler;
return g({url:this._url.path+"/submitJob",content:a,callbackParamName:"callback",load:function(a,b){m(a,b,!1,c,d,f.dfd)},error:function(a){n(a,e,f.dfd)}})},_jobUpdateHandler:function(a,b,c,d,e,f){var g=a.jobId;b=new t(a);if(this._successHandler([b],"onStatusUpdate",e,c&&f),!c)switch(clearTimeout(this._updateTimers[g]),this._updateTimers[g]=null,f&&f.progress(b),a.jobStatus){case t.STATUS_SUBMITTED:case t.STATUS_EXECUTING:case t.STATUS_WAITING:case t.STATUS_NEW:var l=this._getJobStatus;this._updateTimers[g]=
setTimeout(function(){l(g,c,d,e,f)},this.updateDelay);break;default:this._successHandler([b],"onJobComplete",d,f)}},_getJobStatus:function(a,b,c,d,e){var f=this._jobUpdateHandler;g({url:this._url.path+"/jobs/"+a,content:k.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,g){f(a,g,b,c,d,e)},error:this._errorHandler})},_getResultDataHandler:function(a,b,c,d,e){try{var f=this._decode(a);this._successHandler([f],"onGetResultDataComplete",c,e)}catch(J){this._errorHandler(J,
d,e)}},getResultData:function(a,b,c,e){var l=this._getResultDataHandler,h=this._errorHandler,m=new f(d._dfdCanceller);return m._pendingDfd=g({url:this._url.path+"/jobs/"+a+"/results/"+b,content:k.mixin({},this._url.query,{f:"json",returnType:"data"}),callbackParamName:"callback",load:function(a,b){l(a,b,c,e,m)},error:function(a){h(a,e,m)}}),m},checkJobStatus:function(a,b,c){var e=this._jobUpdateHandler,l=this._errorHandler,h=new f(d._dfdCanceller);return h._pendingDfd=g({url:this._url.path+"/jobs/"+
a,content:k.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,c){e(a,c,!0,null,b,h)},error:function(a){l(a,c,h)}}),h},cancelJob:function(a,b,c){var e=this._errorHandler,l=new f(d._dfdCanceller);return l._pendingDfd=g({url:this._url.path+"/jobs/"+a+"/cancel",content:k.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:k.hitch(this,function(a,c){this._successHandler([a],"onJobCancel",b,l)}),error:function(a){e(a,c,l)}}),l},execute:function(a,c,d,e){var f=
this._getOutSR(),l=e.assembly;a=this._gpEncode(k.mixin({},this._url.query,{f:"json","env:outSR":f?f.wkid||b.toJson(f.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||b.toJson(this.processSpatialReference.toJson()):null},a),null,l&&l[0]);var h=this._executeHandler,m=this._errorHandler;return g({url:this._url.path+"/execute",content:a,callbackParamName:"callback",load:function(a,b){h(a,b,c,d,e.dfd)},error:function(a){m(a,d,e.dfd)}})},_executeHandler:function(a,
b,c,d,e){try{var f,g,l=a.results,h=a.messages;f=0;for(g=l.length;g>f;f++)l[f]=this._decode(l[f]);f=0;for(g=h.length;g>f;f++)h[f]=new r(h[f]);this._successHandler([l,h],"onExecuteComplete",c,e)}catch(H){this._errorHandler(H,d,e)}},_getResultImageHandler:function(a,b,c,d,e){try{var f=this._decode(a);this._successHandler([f],"onGetResultImageComplete",c,e)}catch(J){this._errorHandler(J,d,e)}},getResultImage:function(a,b,c,e,l){var h=this._getResultImageHandler,m=this._errorHandler;c=this._gpEncode(k.mixin({},
this._url.query,{f:"json"},c.toJson()));var n=new f(d._dfdCanceller);return n._pendingDfd=g({url:this._url.path+"/jobs/"+a+"/results/"+b,content:c,callbackParamName:"callback",load:function(a,b){h(a,b,e,l,n)},error:function(a){m(a,l,n)}}),n},cancelJobStatusUpdates:function(a){clearTimeout(this._updateTimers[a]);this._updateTimers[a]=null},getResultImageLayer:function(a,b,c,d){var e;if(null==b){var f=this._url.path.indexOf("/GPServer/");a=this._url.path.substring(0,f)+"/MapServer/jobs/"+a}else a=this._url.path+
"/jobs/"+a+"/results/"+b;return this._url.query&&(a+="?"+l.objectToQuery(this._url.query)),e=null==b?new z(a,{imageParameters:c}):new A(a,{imageParameters:c},!0),this.onGetResultImageLayerComplete(e),d&&d(e),e},onStatusUpdate:function(){},onJobComplete:function(){},onExecuteComplete:function(){},onGetResultDataComplete:function(){},onGetResultImageComplete:function(){},onGetResultImageLayerComplete:function(){},onJobCancel:function(){}});return c._createWrappers(h),e("extend-esri")&&k.setObject("tasks.Geoprocessor",
h,m),h})},"esri/tasks/JobInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./GPMessage"],function(h,k,a,f,b){h=h(null,{declaredClass:"esri.tasks.JobInfo",constructor:function(a){this.messages=[];k.mixin(this,a);var e=this.messages,f=e.length;for(a=0;f>a;a++)e[a]=new b(e[a])},jobId:"",jobStatus:""});return k.mixin(h,{STATUS_CANCELLED:"esriJobCancelled",STATUS_CANCELLING:"esriJobCancelling",STATUS_DELETED:"esriJobDeleted",STATUS_DELETING:"esriJobDeleting",STATUS_EXECUTING:"esriJobExecuting",
STATUS_FAILED:"esriJobFailed",STATUS_NEW:"esriJobNew",STATUS_SUBMITTED:"esriJobSubmitted",STATUS_SUCCEEDED:"esriJobSucceeded",STATUS_TIMED_OUT:"esriJobTimedOut",STATUS_WAITING:"esriJobWaiting"}),a("extend-esri")&&k.setObject("tasks.JobInfo",h,f),h})},"esri/tasks/GPMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.tasks.GPMessage",constructor:function(a){k.mixin(this,a)}});return k.mixin(h,{TYPE_INFORMATIVE:"esriJobMessageTypeInformative",
TYPE_PROCESS_DEFINITION:"esriJobMessageTypeProcessDefinition",TYPE_PROCESS_START:"esriJobMessageTypeProcessStart",TYPE_PROCESS_STOP:"esriJobMessageTypeProcessStop",TYPE_WARNING:"esriJobMessageTypeWarning",TYPE_ERROR:"esriJobMessageTypeError",TYPE_EMPTY:"esriJobMessageTypeEmpty",TYPE_ABORT:"esriJobMessageTypeAbort"}),a("extend-esri")&&k.setObject("tasks.GPMessage",h,f),h})},"esri/tasks/LinearUnit":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=
h(null,{declaredClass:"esri.tasks.LinearUnit",constructor:function(a){a&&k.mixin(this,a)},distance:0,units:null,toJson:function(){var a={};return this.distance&&(a.distance=this.distance),this.units&&(a.units=this.units),a}});return a("extend-esri")&&k.setObject("tasks.LinearUnit",h,f),h})},"esri/tasks/DataFile":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.tasks.DataFile",constructor:function(a){a&&k.mixin(this,a)},
url:null,itemID:null,toJson:function(){var a={};return this.url&&(a.url=this.url),this.itemID&&(a.itemID=this.itemID),a}});return a("extend-esri")&&k.setObject("tasks.DataFile",h,f),h})},"esri/tasks/RasterData":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.tasks.RasterData",constructor:function(a){a&&k.mixin(this,a)},url:null,format:null,itemID:null,toJson:function(){var a={};return this.url&&(a.url=this.url),this.format&&
(a.format=this.format),this.itemID&&(a.itemID=this.itemID),a}});return a("extend-esri")&&k.setObject("tasks.RasterData",h,f),h})},"esri/tasks/Date":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/date/locale","dojo/has","../kernel"],function(h,k,a,f,b){h=h(null,{declaredClass:"esri.tasks.Date",constructor:function(b){b&&(b.format&&(this.format=b.format),this.date=a.parse(b.date,{selector:"date",datePattern:this.format}))},date:new Date,format:"EEE MMM dd HH:mm:ss zzz yyyy",toJson:function(){return{date:a.format(this.date,
{selector:"date",datePattern:this.format}),format:this.format}}});return f("extend-esri")&&k.setObject("tasks.Date",h,b),h})},"esri/tasks/ParameterValue":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.tasks.ParameterValue",constructor:function(a){k.mixin(this,a)}});return a("extend-esri")&&k.setObject("tasks.ParameterValue",h,f),h})},"esri/tasks/GPResultImageLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has dojo/io-query ../kernel ../layers/ArcGISDynamicMapServiceLayer".split(" "),
function(h,k,a,f,b,e,l){h=h(l,{declaredClass:"esri.tasks._GPResultImageLayer",constructor:function(a,b){b&&b.imageParameters&&b.imageParameters.extent&&(this.initialExtent=this.fullExtent=b.imageParameters.extent,this.spatialReference=this.initialExtent.spatialReference);this.getImageUrl=k.hitch(this,this.getImageUrl);this.loaded=!0;this.onLoad(this)},getImageUrl:function(e,f,d,c){var g=e.spatialReference.wkid;c(this._url.path+"?"+b.objectToQuery(k.mixin(this._params,{f:"image",bbox:a.toJson(e.toJson()),
bboxSR:g,imageSR:g,size:f+","+d})))}});return f("extend-esri")&&k.setObject("tasks._GPResultImageLayer",h,e),h})},"esri/tasks/PrintTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.tasks.PrintTemplate",label:null,exportOptions:{width:800,height:1100,dpi:96},layoutOptions:null,format:"PNG32",layout:"MAP_ONLY",outScale:0,preserveScale:!0,showAttribution:null,showLabels:!0});return a("extend-esri")&&k.setObject("tasks.PrintTemplate",
h,f),h})},"dojox/gfx/canvas":function(){define("./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q){function t(a,b,c,d,e,f,g,l,h,m){var k,n,q=b.length,r=0;m?(n=m.l/e,r=m.i):n=b[0]/e;for(;f<g;)f+n>g&&(k={l:(f+n-g)*e,i:r},n=g-f),r%2||(a.beginPath(),a.arc(c,d,e,f,f+n,l),h&&a.stroke()),f+=n,++r,n=b[r%q]/e;return k}function r(a,b,c,d){var e=0,f=0,
g,l=0;d?(g=d.l,l=d.i):g=b[0];for(;1>f;)f=q.tAtLength(a,g),1==f&&(e=q.computeLength(a),e={l:g-e,i:l}),a=q.splitBezierAtT(a,f),l%2||c.push(a[0]),a=a[1],++l,g=b[l%b.length];return e}function v(a,b,c,d){var e=[b.last.x,b.last.y].concat(c),f=!(a instanceof Array);c=4===c.length?"quadraticCurveTo":"bezierCurveTo";var g=[];b=r(e,b.canvasDash,g,d);for(d=0;d<g.length;++d)e=g[d],f?(a.moveTo(e[0],e[1]),a[c].apply(a,e.slice(2))):(a.push("moveTo",[e[0],e[1]]),a.push(c,e.slice(2)));return b}function u(a,b,c,d,
e,f,g){var l=0,h=0,m=0,k=q.distance(c,d,e,f),n=0;b=b.canvasDash;var r=c,t=d,u,v=!(a instanceof Array);g?(m=g.l,n=g.i):m+=b[0];for(;.01<Math.abs(1-h);)m>k&&(l={l:m-k,i:n},m=k),h=m/k,g=c+(e-c)*h,u=d+(f-d)*h,n++%2||(v?(a.moveTo(r,t),a.lineTo(g,u)):(a.push("moveTo",[r,t]),a.push("lineTo",[g,u]))),r=g,t=u,m+=b[n%b.length];return l}var w=h.canvas={},x=null,y=c.multiplyPoint,A=Math.PI,z=2*A,B=A/2;n=k.extend;if(b.global.CanvasRenderingContext2D){b=b.doc.createElement("canvas").getContext("2d");var C="function"==
typeof b.setLineDash,D="function"==typeof b.fillText}var E={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};w.Shape=f("dojox.gfx.canvas.Shape",m.Shape,{_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);this._renderShape(a);this._renderFill(a,!0);this._renderStroke(a,!0);a.restore()},_renderClip:function(a){this.canvasClip&&
(this.canvasClip.render(a),a.clip())},_renderTransform:function(a){if("canvasTransform"in this){var b=this.canvasTransform;a.translate(b.dx,b.dy);a.rotate(b.angle2);a.scale(b.sx,b.sy);a.rotate(b.angle1)}},_renderShape:function(a){},_renderFill:function(a,b){if("canvasFill"in this){var c=this.fillStyle;if("canvasFillImage"in this){var d=c.width,e=c.height,f=this.canvasFillImage.width,g=this.canvasFillImage.height,l=Math.min(d==f?1:d/f,e==g?1:e/g),h=(d-l*f)/2,m=(e-l*g)/2;x.width=d;x.height=e;var k=
x.getContext("2d");k.clearRect(0,0,d,e);k.drawImage(this.canvasFillImage,0,0,f,g,h,m,l*f,l*g);this.canvasFill=a.createPattern(x,"repeat");delete this.canvasFillImage}a.fillStyle=this.canvasFill;b&&("pattern"!==c.type||0===c.x&&0===c.y||a.translate(c.x,c.y),a.fill())}else a.fillStyle="rgba(0,0,0,0.0)"},_renderStroke:function(a,b){var c=this.strokeStyle;c?(a.strokeStyle=c.color.toString(),a.lineWidth=c.width,a.lineCap=c.cap,"number"==typeof c.join?(a.lineJoin="miter",a.miterLimit=c.join):a.lineJoin=
c.join,this.canvasDash?C?(a.setLineDash(this.canvasDash),b&&a.stroke()):this._renderDashedStroke(a,b):b&&a.stroke()):b||(a.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(a,b){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,setClip:function(a){this.inherited(arguments);var b=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&!b)return this;this.canvasClip=a?F(b,a):null;this.parent&&
this.parent._makeDirty();return this}});var F=function(a,b){switch(a){case "ellipse":return{canvasEllipse:L({shape:b}),render:function(a){return w.Ellipse.prototype._renderShape.call(this,a)}};case "rect":return{shape:k.delegate(b,{r:0}),render:function(a){return w.Rect.prototype._renderShape.call(this,a)}};case "path":return{canvasPath:G(b),render:function(a){this.canvasPath._renderShape(a)}};case "polyline":return{canvasPolyline:b.points,render:function(a){return w.Polyline.prototype._renderShape.call(this,
a)}}}return null},G=function(a){var b=new dojox.gfx.canvas.Path;b.canvasPath=[];b._setPath(a.d);return b},I=function(a,b,c){var d=a.prototype[b];a.prototype[b]=c?function(){this.parent&&this.parent._makeDirty();d.apply(this,arguments);c.call(this);return this}:function(){this.parent&&this.parent._makeDirty();return d.apply(this,arguments)}};I(w.Shape,"setTransform",function(){this.matrix?this.canvasTransform=h.decompose(this.matrix):delete this.canvasTransform});I(w.Shape,"setFill",function(){var b=
this.fillStyle,c;if(b){if("object"==typeof b&&"type"in b){var d=this.surface.rawNode.getContext("2d");switch(b.type){case "linear":case "radial":c="linear"==b.type?d.createLinearGradient(b.x1,b.y1,b.x2,b.y2):d.createRadialGradient(b.cx,b.cy,0,b.cx,b.cy,b.r);a.forEach(b.colors,function(a){c.addColorStop(a.offset,h.normalizeColor(a.color).toString())});break;case "pattern":x||(x=document.createElement("canvas")),d=new Image,this.surface.downloadImage(d,b.src),this.canvasFillImage=d}}else c=b.toString();
this.canvasFill=c}else delete this.canvasFill});I(w.Shape,"setStroke",function(){var a=this.strokeStyle;if(a){var b=this.strokeStyle.style.toLowerCase();b in E&&(b=E[b]);if(b instanceof Array){this.canvasDash=b=b.slice();var c;for(c=0;c<b.length;++c)b[c]*=a.width;if("butt"!=a.cap){for(c=0;c<b.length;c+=2)b[c]-=a.width,1>b[c]&&(b[c]=1);for(c=1;c<b.length;c+=2)b[c]+=a.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!C&&!!this.canvasDash});I(w.Shape,"setShape");w.Group=
f("dojox.gfx.canvas.Group",w.Shape,{constructor:function(){m.Container._init.call(this)},_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},destroy:function(){m.Container.clear.call(this,!0);w.Shape.prototype.destroy.apply(this,arguments)}});w.Rect=f("dojox.gfx.canvas.Rect",[w.Shape,m.Rect],{_renderShape:function(a){var b=this.shape,c=Math.min(b.r,b.height/2,b.width/2),d=b.x,e=d+b.width,f=b.y,b=
f+b.height,g=d+c,l=e-c,h=f+c,m=b-c;a.beginPath();a.moveTo(g,f);c?(a.arc(l,h,c,-B,0,!1),a.arc(l,m,c,0,B,!1),a.arc(g,m,c,B,A,!1),a.arc(g,h,c,A,A+B,!1)):(a.lineTo(l,f),a.lineTo(e,m),a.lineTo(g,b),a.lineTo(d,h));a.closePath()},_renderDashedStroke:function(a,b){var c=this.shape,d=Math.min(c.r,c.height/2,c.width/2),e=c.x,f=e+c.width,g=c.y,l=g+c.height,h=e+d,m=f-d,k=g+d,n=l-d;d?(a.beginPath(),c=u(a,this,h,g,m,g),b&&a.stroke(),c=t(a,this.canvasDash,m,k,d,-B,0,!1,b,c),a.beginPath(),c=u(a,this,f,k,f,n,c),b&&
a.stroke(),c=t(a,this.canvasDash,m,n,d,0,B,!1,b,c),a.beginPath(),c=u(a,this,m,l,h,l,c),b&&a.stroke(),c=t(a,this.canvasDash,h,n,d,B,A,!1,b,c),a.beginPath(),c=u(a,this,e,n,e,k,c),b&&a.stroke(),t(a,this.canvasDash,h,k,d,A,A+B,!1,b,c)):(a.beginPath(),c=u(a,this,h,g,m,g),c=u(a,this,m,g,f,n,c),c=u(a,this,f,n,h,l,c),u(a,this,h,l,e,k,c),b&&a.stroke())}});var J=[];(function(){var a=d.curvePI4;J.push(a.s,a.c1,a.c2,a.e);for(var b=45;360>b;b+=45){var e=c.rotateg(b);J.push(y(e,a.c1),y(e,a.c2),y(e,a.e))}})();var L=
function(a){var b,d,e,f=[],g=a.shape,l=c.normalize([c.translate(g.cx,g.cy),c.scale(g.rx,g.ry)]);b=y(l,J[0]);f.push([b.x,b.y]);for(g=1;g<J.length;g+=3)d=y(l,J[g]),e=y(l,J[g+1]),b=y(l,J[g+2]),f.push([d.x,d.y,e.x,e.y,b.x,b.y]);if(a._needsDash){b=[];d=f[0];for(g=1;g<f.length;++g)e=[],r(d.concat(f[g]),a.canvasDash,e),d=[f[g][4],f[g][5]],b.push(e);a._dashedPoints=b}return f};w.Ellipse=f("dojox.gfx.canvas.Ellipse",[w.Shape,m.Ellipse],{setShape:function(){this.inherited(arguments);this.canvasEllipse=L(this);
return this},setStroke:function(){this.inherited(arguments);C||(this.canvasEllipse=L(this));return this},_renderShape:function(a){var b=this.canvasEllipse,c;a.beginPath();a.moveTo.apply(a,b[0]);for(c=1;c<b.length;++c)a.bezierCurveTo.apply(a,b[c]);a.closePath()},_renderDashedStroke:function(a,b){var c=this._dashedPoints;a.beginPath();for(var d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.length;++f){var g=e[f];a.moveTo(g[0],g[1]);a.bezierCurveTo(g[2],g[3],g[4],g[5],g[6],g[7])}b&&a.stroke()}});w.Circle=
f("dojox.gfx.canvas.Circle",[w.Shape,m.Circle],{_renderShape:function(a){var b=this.shape;a.beginPath();a.arc(b.cx,b.cy,b.r,0,z,1)},_renderDashedStroke:function(a,b){var c=this.shape,d=0,e,f=this.canvasDash.length;for(i=0;d<z;)e=this.canvasDash[i%f]/c.r,i%2||(a.beginPath(),a.arc(c.cx,c.cy,c.r,d,d+e,0),b&&a.stroke()),d+=e,++i}});w.Line=f("dojox.gfx.canvas.Line",[w.Shape,m.Line],{_renderShape:function(a){var b=this.shape;a.beginPath();a.moveTo(b.x1,b.y1);a.lineTo(b.x2,b.y2)},_renderDashedStroke:function(a,
b){var c=this.shape;a.beginPath();u(a,this,c.x1,c.y1,c.x2,c.y2);b&&a.stroke()}});w.Polyline=f("dojox.gfx.canvas.Polyline",[w.Shape,m.Polyline],{setShape:function(){this.inherited(arguments);var a=this.shape.points,b=a[0],c,d;this.bbox=null;this._normalizePoints();if(a.length)if("number"==typeof b)b=a;else for(b=[],d=0;d<a.length;++d)c=a[d],b.push(c.x,c.y);else b=[];this.canvasPolyline=b;return this},_renderShape:function(a){var b=this.canvasPolyline;if(b.length){a.beginPath();a.moveTo(b[0],b[1]);
for(var c=2;c<b.length;c+=2)a.lineTo(b[c],b[c+1])}},_renderDashedStroke:function(a,b){var c=this.canvasPolyline,d=0;a.beginPath();for(var e=0;e<c.length;e+=2)d=u(a,this,c[e],c[e+1],c[e+2],c[e+3],d);b&&a.stroke()}});w.Image=f("dojox.gfx.canvas.Image",[w.Shape,m.Image],{setShape:function(){this.inherited(arguments);var a=new Image;this.surface.downloadImage(a,this.shape.src);this.canvasImage=a;return this},_renderShape:function(a){var b=this.shape;a.drawImage(this.canvasImage,b.x,b.y,b.width,b.height)}});
w.Text=f("dojox.gfx.canvas.Text",[w.Shape,m.Text],{_setFont:function(){this.fontStyle?this.canvasFont=h.makeFontString(this.fontStyle):delete this.canvasFont},getTextWidth:function(){var a=this.shape,b=0,c;a.text&&(c=this.surface.rawNode.getContext("2d"),c.save(),this._renderTransform(c),this._renderFill(c,!1),this._renderStroke(c,!1),this.canvasFont&&(c.font=this.canvasFont),b=c.measureText(a.text).width,c.restore());return b},_render:function(a){a.save();this._renderTransform(a);this._renderFill(a,
!1);this._renderStroke(a,!1);this._renderShape(a);a.restore()},_renderShape:function(a){var b=this.shape;b.text&&(a.textAlign="middle"===b.align?"center":b.align,this.canvasFont&&(a.font=this.canvasFont),this.canvasFill&&a.fillText(b.text,b.x,b.y),this.strokeStyle&&(a.beginPath(),a.strokeText(b.text,b.x,b.y),a.closePath()))}});I(w.Text,"setFont");D||w.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var M={M:"_moveToA",m:"_moveToR",
L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};w.Path=f("dojox.gfx.canvas.Path",[w.Shape,g.Path],{constructor:function(){this.lastControl={}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);
C||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(a){var b=k.clone(this.last);this[M[a.action]](this.canvasPath,a.action,a.args,this._needsDash?this._dashedPath:null);this.last=b;this.inherited(arguments)},_renderShape:function(a){var b=this.canvasPath;a.beginPath();for(var c=0;c<b.length;c+=2)a[b[c]].apply(a,b[c+1])},_renderDashedStroke:C?function(){}:function(a,b){var c=this._dashedPath;
a.beginPath();for(var d=0;d<c.length;d+=2)a[c[d]].apply(a,c[d+1]);b&&a.stroke()},_moveToA:function(a,b,c,d){a.push("moveTo",[c[0],c[1]]);d&&d.push("moveTo",[c[0],c[1]]);for(b=2;b<c.length;b+=2)a.push("lineTo",[c[b],c[b+1]]),d&&(this._dashResidue=u(d,this,c[b-2],c[b-1],c[b],c[b+1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl={}},_moveToR:function(a,b,c,d){b="x"in this.last?[this.last.x+=c[0],this.last.y+=c[1]]:[this.last.x=c[0],this.last.y=c[1]];a.push("moveTo",
b);d&&d.push("moveTo",b);for(b=2;b<c.length;b+=2)a.push("lineTo",[this.last.x+=c[b],this.last.y+=c[b+1]]),d&&(this._dashResidue=u(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(a,b,c,d){for(b=0;b<c.length;b+=2)d&&(this._dashResidue=u(d,this,this.last.x,this.last.y,c[b],c[b+1],this._dashResidue)),a.push("lineTo",[c[b],c[b+1]]);this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl={}},_lineToR:function(a,b,c,
d){for(b=0;b<c.length;b+=2)a.push("lineTo",[this.last.x+=c[b],this.last.y+=c[b+1]]),d&&(this._dashResidue=u(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_hLineToA:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[c[b],this.last.y]),d&&(this._dashResidue=u(d,this,d[d.length-1][0],d[d.length-1][1],c[b],this.last.y,this._dashResidue));this.last.x=c[c.length-1];this.lastControl={}},_hLineToR:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",
[this.last.x+=c[b],this.last.y]),d&&(this._dashResidue=u(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_vLineToA:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x,c[b]]),d&&(this._dashResidue=u(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,c[b],this._dashResidue));this.last.y=c[c.length-1];this.lastControl={}},_vLineToR:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x,this.last.y+=c[b]]),d&&
(this._dashResidue=u(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(a,b,c,d){for(b=0;b<c.length;b+=6)a.push("bezierCurveTo",c.slice(b,b+6)),d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type="C"},_curveToR:function(a,b,c,d){for(b=0;b<c.length;b+=6)a.push("bezierCurveTo",
[this.last.x+c[b],this.last.y+c[b+1],this.lastControl.x=this.last.x+c[b+2],this.lastControl.y=this.last.y+c[b+3],this.last.x+c[b+4],this.last.y+c[b+5]]),d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+4],this.last.y+=c[b+5];this.lastControl.type="C"},_smoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4){var e="C"==this.lastControl.type;a.push("bezierCurveTo",[e?2*this.last.x-this.lastControl.x:this.last.x,e?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+
1],c[b+2],c[b+3]]);d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=c[b];this.lastControl.y=c[b+1];this.lastControl.type="C"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_smoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4){var e="C"==this.lastControl.type;a.push("bezierCurveTo",[e?2*this.last.x-this.lastControl.x:this.last.x,e?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]);d&&
(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=this.last.x+c[b];this.lastControl.y=this.last.y+c[b+1];this.lastControl.type="C";this.last.x+=c[b+2];this.last.y+=c[b+3]}},_qCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",c.slice(b,b+4));d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type=
"Q"},_qCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",[this.lastControl.x=this.last.x+c[b],this.lastControl.y=this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]),d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+2],this.last.y+=c[b+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=2){var e="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=e?2*this.last.x-this.lastControl.x:
this.last.x,this.lastControl.y=e?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+1]]);d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_qSmoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=2){var e="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=e?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=e?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],
this.last.y+c[b+1]]);d&&(this._dashResidue=v(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=c[b];this.last.y+=c[b+1]}},_arcTo:function(b,c,e,f){c="a"==c;for(var g=0;g<e.length;g+=7){var l=e[g+5],h=e[g+6];c&&(l+=this.last.x,h+=this.last.y);var m=d.arcAsBezier(this.last,e[g],e[g+1],e[g+2],e[g+3]?1:0,e[g+4]?1:0,l,h);a.forEach(m,function(a){b.push("bezierCurveTo",a)});f&&(this._dashResidue=v(f,this,p,this._dashResidue));this.last.x=l;this.last.y=h}this.lastControl={}},
_closePath:function(a,b,c,d){a.push("closePath",[]);d&&(this._dashResidue=u(d,this,this.last.x,this.last.y,d[1][0],d[1][1],this._dashResidue));this.lastControl={}}});a.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),function(a){I(w.Path,a)});w.TextPath=f("dojox.gfx.canvas.TextPath",[w.Shape,g.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});w.Surface=f("dojox.gfx.canvas.Surface",m.Surface,{constructor:function(){m.Container._init.call(this);
this.pendingImageCount=0;this.makeDirty()},destroy:function(){m.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(a,b){this.width=h.normalizedLength(a);this.height=h.normalizedLength(b);if(!this.rawNode)return this;var c=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,c=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,c=!0);c&&this.makeDirty();return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:
null},_render:function(a){!this.rawNode||!a&&this.pendingImageCount||(a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender))},render:function(a){a.save();for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},makeDirty:function(){this.pendingImagesCount||"pendingRender"in this||this._batch||(this.pendingRender=setTimeout(k.hitch(this,this._render),
0))},downloadImage:function(a,b){var c=k.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=c;a.onerror=c;a.onabort=c;a.src=b},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},on:function(){}});w.createSurface=function(a,b,c){if(!b&&!c){var d=e.position(a);
b=b||d.w;c=c||d.h}"number"==typeof b&&(b+="px");"number"==typeof c&&(c+="px");d=new w.Surface;a=l.byId(a);var f=a.ownerDocument.createElement("canvas");f.width=h.normalizedLength(b);f.height=h.normalizedLength(c);a.appendChild(f);d.rawNode=f;d._parent=a;return d.surface=d};var H=m.Container;f={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},add:function(a){this._makeDirty();
return H.add.apply(this,arguments)},remove:function(a,b){this._makeDirty();return H.remove.apply(this,arguments)},clear:function(){this._makeDirty();return H.clear.apply(this,arguments)},getBoundingBox:H.getBoundingBox,_moveChildToFront:function(a){this._makeDirty();return H._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return H._moveChildToBack.apply(this,arguments)}};g={createObject:function(a,b){var c=new a;c.surface=this.surface;c.setShape(b);this.add(c);
return c}};n(w.Group,f);n(w.Group,m.Creator);n(w.Group,g);n(w.Surface,f);n(w.Surface,m.Creator);n(w.Surface,g);w.fixTarget=function(a,b){return!0};return w})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(h,k,a,f,b,e,l,m,g,d){function c(a,b){if(!n)return a.splice(b,1);var c=a.length;if(c){for(;b<c;)a[b]=a[b+1],b++;a.length--}}var n=!!b("chrome"),
q=h.shape={};q.Shape=a("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(b("gfxRegistry")){var a=q.register(this);this.getUID=function(){return a}}},destroy:function(){b("gfxRegistry")&&q.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},
getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var b=this._getRealMatrix();return[d.multiplyPoint(b,a.x,a.y),d.multiplyPoint(b,a.x+a.width,a.y),d.multiplyPoint(b,a.x+a.width,a.y+a.height),d.multiplyPoint(b,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},setClip:function(a){this.clip=
a},getClip:function(){return this.clip},setShape:function(a){this.shape=h.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=h.makeParameters(h.defaultLinearGradient,a);break;case "radial":b=h.makeParameters(h.defaultRadialGradient,a);break;case "pattern":b=h.makeParameters(h.defaultPattern,a)}else b=h.normalizeColor(a);this.fillStyle=b;return this},setStroke:function(a){if(!a)return this.strokeStyle=
null,this;if("string"==typeof a||k.isArray(a)||a instanceof g)a={color:a};a=this.strokeStyle=h.makeParameters(h.defaultStroke,a);a.color=h.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=d.clone(a?d.normalize(a):d.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=this.getParent();a&&(a._moveChildToBack(this),
this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&this.parent.remove(this,a);return this},_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},_updateParentMatrix:function(a){this.parentMatrix=
a?d.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,b=this.parent;b;)b.matrix&&(a=d.multiply(b.matrix,a)),b=b.parent;return a}});q._eventsProcessing={on:function(a,b){return e(this.getEventSource(),a,q.fixCallback(this,h.fixTarget,b))},connect:function(a,b,c){"on"==a.substring(0,2)&&(a=a.substring(2));return this.on(a,c?k.hitch(b,c):b)},disconnect:function(a){return a.remove()}};q.fixCallback=function(a,b,c,d){d||(d=c,c=null);if(k.isString(d)){c=c||f.global;
if(!c[d])throw['dojox.gfx.shape.fixCallback: scope["',d,'"] is null (scope\x3d"',c,'")'].join("");return function(e){return b(e,a)?c[d].apply(c,arguments||[]):void 0}}return c?function(e){return b(e,a)?d.apply(c,arguments||[]):void 0}:function(e){return b(e,a)?d.apply(c,arguments):void 0}};k.extend(q.Shape,q._eventsProcessing);q.Container={_init:function(){this.children=[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(a){var b=a.getParent();b&&b.remove(a,
!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,b){for(var d=0;d<this.children.length;++d)if(this.children[d]==a){b||(a.parent=null,a.parentMatrix=null);c(this.children,d);break}return this},clear:function(a){for(var b,c=0;c<this.children.length;++c)b=this.children[c],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=[];return this},getBoundingBox:function(){if(this.children){var a=null;l.forEach(this.children,function(b){var c=b.getBoundingBox();
c&&((b=b.getTransform())&&(c=d.multiplyRectangle(b,c)),a?(a.x=Math.min(a.x,c.x),a.y=Math.min(a.y,c.y),a.endX=Math.max(a.endX,c.x+c.width),a.endY=Math.max(a.endY,c.y+c.height)):a={x:c.x,y:c.y,endX:c.x+c.width,endY:c.y+c.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){c(this.children,b);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==
a){c(this.children,b);this.children.unshift(a);break}return this}};q.Surface=a("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){l.forEach(this._nodes,m.destroy);this._nodes=[];l.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;if(b("ie"))for(;this._parent.lastChild;)m.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},
_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(a,b){var c=k.hitch(a,b);if(this.isLoaded)c(this);else e.once(this,"load",function(a){c(a)})}});k.extend(q.Surface,q._eventsProcessing);q.Rect=a("dojox.gfx.shape.Rect",q.Shape,{constructor:function(a){this.shape=h.getDefault("Rect");this.rawNode=a},getBoundingBox:function(){return this.shape}});q.Ellipse=a("dojox.gfx.shape.Ellipse",q.Shape,{constructor:function(a){this.shape=h.getDefault("Ellipse");this.rawNode=
a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});q.Circle=a("dojox.gfx.shape.Circle",q.Shape,{constructor:function(a){this.shape=h.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});q.Line=a("dojox.gfx.shape.Line",q.Shape,{constructor:function(a){this.shape=h.getDefault("Line");this.rawNode=
a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});q.Polyline=a("dojox.gfx.shape.Polyline",q.Shape,{constructor:function(a){this.shape=h.getDefault("Polyline");this.rawNode=a},setShape:function(a,b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);
return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var c=[],d=0;d<b;d+=2)c.push({x:a[d],y:a[d+1]});this.shape.points=c}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,c=a[0],d=c.x,e=c.y,f=c.x,g=c.y,l=1;l<b;++l)c=a[l],d>c.x&&(d=c.x),f<c.x&&(f=c.x),e>c.y&&(e=c.y),g<c.y&&(g=c.y);this.bbox={x:d,y:e,width:f-d,height:g-e}}return this.bbox}});q.Image=a("dojox.gfx.shape.Image",q.Shape,
{constructor:function(a){this.shape=h.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});q.Text=a(q.Shape,{constructor:function(a){this.fontStyle=null;this.shape=h.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?h.splitFontString(a):h.makeParameters(h.defaultFont,a);this._setFont();return this},getBoundingBox:function(){var a=
null;this.getShape().text&&(a=h._base._computeTextBoundingBox(this));return a}});q.Creator={createShape:function(a){switch(a.type){case h.defaultPath.type:return this.createPath(a);case h.defaultRect.type:return this.createRect(a);case h.defaultCircle.type:return this.createCircle(a);case h.defaultEllipse.type:return this.createEllipse(a);case h.defaultLine.type:return this.createLine(a);case h.defaultPolyline.type:return this.createPolyline(a);case h.defaultImage.type:return this.createImage(a);
case h.defaultText.type:return this.createText(a);case h.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(h.Group)},createRect:function(a){return this.createObject(h.Rect,a)},createEllipse:function(a){return this.createObject(h.Ellipse,a)},createCircle:function(a){return this.createObject(h.Circle,a)},createLine:function(a){return this.createObject(h.Line,a)},createPolyline:function(a){return this.createObject(h.Polyline,a)},createImage:function(a){return this.createObject(h.Image,
a)},createText:function(a){return this.createObject(h.Text,a)},createPath:function(a){return this.createObject(h.Path,a)},createTextPath:function(a){return this.createObject(h.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return q})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(h,k,a,f,b){b=a("dojox.gfx.path.Path",b.Shape,{constructor:function(a){this.shape=k.clone(h.defaultPath);this.segments=[];this.tbbox=
null;this.absolute=!0;this.last={};this.rawNode=a;this.segmented=!1},setAbsoluteMode:function(a){this._confirmSegmented();this.absolute="string"==typeof a?"absolute"==a:a;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;
var a=this.bbox,b=this._getRealMatrix();this.bbox=null;for(var f=0,g=this.segments.length;f<g;++f)this._updateWithSegment(this.segments[f],b);b=this.bbox;this.bbox=a;return this.tbbox=b?[{x:b.l,y:b.t},{x:b.r,y:b.t},{x:b.r,y:b.b},{x:b.l,y:b.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(a,b,h){h&&(b=f.multiplyPoint(h,a,b),a=b.x,b=b.y);this.bbox&&"l"in
this.bbox?(this.bbox.l>a&&(this.bbox.l=a),this.bbox.r<a&&(this.bbox.r=a),this.bbox.t>b&&(this.bbox.t=b),this.bbox.b<b&&(this.bbox.b=b)):this.bbox={l:a,b:b,r:a,t:b}},_updateWithSegment:function(a,b){var e=a.args,f=e.length,d;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(d=0;d<f;d+=2)this._updateBBox(e[d],e[d+1],b);this.last.x=e[f-2];this.last.y=e[f-1];this.absolute=!0;break;case "H":for(d=0;d<f;++d)this._updateBBox(e[d],this.last.y,b);this.last.x=e[f-1];this.absolute=!0;
break;case "V":for(d=0;d<f;++d)this._updateBBox(this.last.x,e[d],b);this.last.y=e[f-1];this.absolute=!0;break;case "m":d=0;"x"in this.last||(this._updateBBox(this.last.x=e[0],this.last.y=e[1],b),d=2);for(;d<f;d+=2)this._updateBBox(this.last.x+=e[d],this.last.y+=e[d+1],b);this.absolute=!1;break;case "l":case "t":for(d=0;d<f;d+=2)this._updateBBox(this.last.x+=e[d],this.last.y+=e[d+1],b);this.absolute=!1;break;case "h":for(d=0;d<f;++d)this._updateBBox(this.last.x+=e[d],this.last.y,b);this.absolute=!1;
break;case "v":for(d=0;d<f;++d)this._updateBBox(this.last.x,this.last.y+=e[d],b);this.absolute=!1;break;case "c":for(d=0;d<f;d+=6)this._updateBBox(this.last.x+e[d],this.last.y+e[d+1],b),this._updateBBox(this.last.x+e[d+2],this.last.y+e[d+3],b),this._updateBBox(this.last.x+=e[d+4],this.last.y+=e[d+5],b);this.absolute=!1;break;case "s":case "q":for(d=0;d<f;d+=4)this._updateBBox(this.last.x+e[d],this.last.y+e[d+1],b),this._updateBBox(this.last.x+=e[d+2],this.last.y+=e[d+3],b);this.absolute=!1;break;
case "A":for(d=0;d<f;d+=7)this._updateBBox(e[d+5],e[d+6],b);this.last.x=e[f-2];this.last.y=e[f-1];this.absolute=!0;break;case "a":for(d=0;d<f;d+=7)this._updateBBox(this.last.x+=e[d+5],this.last.y+=e[d+6],b);this.absolute=!1}var c=[a.action];for(d=0;d<f;++d)c.push(h.formatNumber(e[d],!0));if("string"==typeof this.shape.path)this.shape.path+=c.join("");else for(d=0,f=c.length;d<f;++d)this.shape.path.push(c[d])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(a,b){this.tbbox=
null;var e=this._validSegments[a.toLowerCase()];"number"==typeof e&&(e?b.length>=e&&(e={action:a,args:b.slice(0,b.length-b.length%e)},this.segments.push(e),this._updateWithSegment(e)):(e={action:a,args:[]},this.segments.push(e),this._updateWithSegment(e)))},_collectArgs:function(a,b){for(var e=0;e<b.length;++e){var f=b[e];"boolean"==typeof f?a.push(f?1:0):"number"==typeof f?a.push(f):f instanceof Array?this._collectArgs(a,f):"x"in f&&"y"in f&&a.push(f.x,f.y)}},moveTo:function(){this._confirmSegmented();
var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"M":"m",a);return this},lineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"L":"l",a);return this},hLineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"H":"h",a);return this},vLineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"V":"v",a);
return this},curveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"C":"c",a);return this},smoothCurveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"S":"s",a);return this},qCurveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"Q":"q",a);return this},qSmoothCurveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,
arguments);this._pushSegment(this.absolute?"T":"t",a);return this},arcTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"A":"a",a);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var a=this.shape.path;this.shape.path=[];this._setPath(a);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(a){a=k.isArray(a)?a:a.match(h.pathSvgRegExp);
this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(a){for(var b="",e=[],f=a.length,d=0;d<f;++d){var c=a[d],n=parseFloat(c);isNaN(n)?(b&&this._pushSegment(b,e),e=[],b=c):e.push(n)}this._pushSegment(b,e)}},setShape:function(a){this.inherited(arguments,["string"==typeof a?{path:a}:a]);this.segmented=!1;this.segments=[];h.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});a=a("dojox.gfx.path.TextPath",b,{constructor:function(a){"text"in this||(this.text=k.clone(h.defaultTextPath));
"fontStyle"in this||(this.fontStyle=k.clone(h.defaultFont))},getText:function(){return this.text},setText:function(a){this.text=h.makeParameters(this.text,"string"==typeof a?{text:a}:a);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?h.splitFontString(a):h.makeParameters(h.defaultFont,a);this._setFont();return this}});return h.path={Path:b,TextPath:a}})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],
function(h,k,a){function f(a){var b=Math.cos(a);a=Math.sin(a);var d={x:b+4/3*(1-b),y:a-4/3*b*(1-b)/a};return{s:{x:b,y:-a},c1:{x:d.x,y:-d.y},c2:d,e:{x:b,y:a}}}var b=2*Math.PI,e=Math.PI/4,l=Math.PI/8,m=e+l,g=f(l);return h.arc={unitArcAsBezier:f,curvePI4:g,arcAsBezier:function(d,c,h,k,t,r,v,u){t=!!t;r=!!r;var n=a._degToRad(k);k=c*c;var q=h*h,y=a.multiplyPoint(a.rotate(-n),{x:(d.x-v)/2,y:(d.y-u)/2}),A=y.x*y.x,z=y.y*y.y;k=Math.sqrt((k*q-k*z-q*A)/(k*z+q*A));isNaN(k)&&(k=0);k={x:k*c*y.y/h,y:-k*h*y.x/c};
t==r&&(k={x:-k.x,y:-k.y});k=a.multiplyPoint([a.translate((d.x+v)/2,(d.y+u)/2),a.rotate(n)],k);c=a.normalize([a.translate(k.x,k.y),a.rotate(n),a.scale(c,h)]);k=a.invert(c);d=a.multiplyPoint(k,d);u=a.multiplyPoint(k,v,u);v=Math.atan2(d.y,d.x);k=v-Math.atan2(u.y,u.x);r&&(k=-k);0>k?k+=b:k>b&&(k-=b);h=l;u=g;h=r?h:-h;d=[];for(t=k;0<t;t-=e)t<m&&(h=t/2,u=f(h),h=r?h:-h,t=0),y=a.normalize([c,a.rotate(v+h)]),r?(k=a.multiplyPoint(y,u.c1),n=a.multiplyPoint(y,u.c2),y=a.multiplyPoint(y,u.e)):(k=a.multiplyPoint(y,
u.c2),n=a.multiplyPoint(y,u.c1),y=a.multiplyPoint(y,u.s)),d.push([k.x,k.y,n.x,n.y,y.x,y.y]),v+=2*h;return d}}})},"dojox/gfx/decompose":function(){define(["./_base","dojo/_base/lang","./matrix"],function(h,k,a){function f(a,b){return Math.abs(a-b)<=1E-6*(Math.abs(a)+Math.abs(b))}function b(a,b,c,e){if(!isFinite(a))return c;if(!isFinite(c))return a;b=Math.abs(b);e=Math.abs(e);return(b*a+e*c)/(b+e)}function e(b){b=a.normalize(b);var d=-b.xx-b.yy,c=b.xx*b.yy-b.xy*b.yx,e=Math.sqrt(d*d-4*c),d=-(d+(0>d?
-e:e))/2,c=c/d,e=b.xy/(d-b.xx),g=1,l=b.xy/(c-b.xx),h=1;f(d,c)&&(e=1,l=g=0,h=1);isFinite(e)||(e=1,g=(d-b.xx)/b.xy,isFinite(g)||(e=(d-b.yy)/b.yx,g=1,isFinite(e)||(e=1,g=b.yx/(d-b.yy))));isFinite(l)||(l=1,h=(c-b.xx)/b.xy,isFinite(h)||(l=(c-b.yy)/b.yx,h=1,isFinite(l)||(l=1,h=b.yx/(c-b.yy))));b=Math.sqrt(e*e+g*g);var m=Math.sqrt(l*l+h*h);isFinite(e/=b)||(e=0);isFinite(g/=b)||(g=0);isFinite(l/=m)||(l=0);isFinite(h/=m)||(h=0);return{value1:d,value2:c,vector1:{x:e,y:g},vector2:{x:l,y:h}}}function l(a,d){var c=
0>a.xx*a.yy||0<a.xy*a.yx?-1:1,e=d.angle1=(Math.atan2(a.yx,a.yy)+Math.atan2(-c*a.xy,c*a.xx))/2,c=Math.cos(e),e=Math.sin(e);d.sx=b(a.xx/c,c,-a.xy/e,e);d.sy=b(a.yy/c,c,a.yx/e,e);return d}function m(a,d){var c=0>a.xx*a.yy||0<a.xy*a.yx?-1:1,e=d.angle2=(Math.atan2(c*a.yx,c*a.xx)+Math.atan2(-a.xy,a.yy))/2,c=Math.cos(e),e=Math.sin(e);d.sx=b(a.xx/c,c,a.yx/e,e);d.sy=b(a.yy/c,c,-a.xy/e,e);return d}return h.decompose=function(b){var d=a.normalize(b);b={dx:d.dx,dy:d.dy,sx:1,sy:1,angle1:0,angle2:0};if(f(d.xy,0)&&
f(d.yx,0))return k.mixin(b,{sx:d.xx,sy:d.yy});if(f(d.xx*d.yx,-d.xy*d.yy))return l(d,b);if(f(d.xx*d.xy,-d.yx*d.yy))return m(d,b);var c,g=new a.Matrix2D(d);c=k.mixin(g,{dx:0,dy:0,xy:g.yx,yx:g.xy});g=e([d,c]);c=e([c,d]);g=new a.Matrix2D({xx:g.vector1.x,xy:g.vector2.x,yx:g.vector1.y,yy:g.vector2.y});c=new a.Matrix2D({xx:c.vector1.x,xy:c.vector1.y,yx:c.vector2.x,yy:c.vector2.y});d=new a.Matrix2D([a.invert(g),d,a.invert(c)]);l(c,b);d.xx*=b.sx;d.yy*=b.sy;m(g,b);d.xx*=b.sx;d.yy*=b.sy;return k.mixin(b,{sx:d.xx,
sy:d.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(h){h=h.bezierutils={};h.tAtLength=function(b,h){var g=0,d=6==b.length,c=0,l=0,m=d?f:e,k=function(e,f){for(var n=0,q=0;q<e.length-2;q+=2)n+=a(e[q],e[q+1],e[q+2],e[q+3]);q=d?a(b[0],b[1],b[4],b[5]):a(b[0],b[1],b[6],b[7]);n-q>f||c+n>h+f?(++l,n=m(e,.5),k(n[0],f),Math.abs(c-h)<=f||k(n[1],f)):(c+=n,g+=1/(1<<l))};h&&k(b,.5);return g};var k=h.computeLength=function(e){for(var l=6==e.length,g=0,d=0;d<e.length-2;d+=2)g+=a(e[d],e[d+
1],e[d+2],e[d+3]);d=l?a(e[0],e[1],e[4],e[5]):a(e[0],e[1],e[6],e[7]);.1<g-d&&(e=l?f(e,.5):b(e,.5),g=k(e[0],l),g+=k(e[1],l));return g},a=h.distance=function(a,b,e,d){return Math.sqrt((e-a)*(e-a)+(d-b)*(d-b))},f=function(a,b){var e=1-b,d=e*e,c=b*b,f=a[0],l=a[1],h=a[2],m=a[3],k=a[4],u=a[5],w=d*f+2*e*b*h+c*k,d=d*l+2*e*b*m+c*u;return[[f,l,e*f+b*h,e*l+b*m,w,d],[w,d,e*h+b*k,e*m+b*u,k,u]]},b=function(a,b){var e=1-b,d=e*e,c=d*e,f=b*b,l=f*b,h=a[0],m=a[1],k=a[2],u=a[3],w=a[4],x=a[5],y=a[6],A=a[7],z=c*h+3*d*b*
k+3*e*f*w+l*y,c=c*m+3*d*b*u+3*e*f*x+l*A;return[[h,m,e*h+b*k,e*m+b*u,d*h+2*e*b*k+f*w,d*m+2*e*b*u+f*x,z,c],[z,c,d*k+2*e*b*w+f*y,d*u+2*e*b*x+f*A,e*w+b*y,e*x+b*A,y,A]]},e=h.splitBezierAtT=function(a,e){return 6==a.length?f(a,e):b(a,e)};return h})},"dojox/json/query":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojox","dojo/_base/array"],function(h,k,a){k.getObject("json",!0,a);a.json._slice=function(a,b,e,l){var f=a.length,g=[];e=e||f;b=0>b?Math.max(0,b+f):Math.min(f,b);for(e=0>e?Math.max(0,
e+f):Math.min(f,e);b<e;b+=l)g.push(a[b]);return g};a.json._find=function(a,b){function e(a){b&&(!0!==b||a instanceof Array?a[b]&&f.push(a[b]):f.push(a));for(var d in a){var c=a[d];b?c&&"object"==typeof c&&e(c):f.push(c)}}var f=[];if(b instanceof Array){if(1==b.length)return a[b[0]];for(var h=0;h<b.length;h++)f.push(a[b[h]])}else e(a);return f};a.json._distinctFilter=function(a,b){for(var e=[],f={},h=0,g=a.length;h<g;++h){var d=a[h];b(d,h,a)&&("object"==typeof d&&d?d.__included||(d.__included=!0,e.push(d)):
f[d+typeof d]||(f[d+typeof d]=!0,e.push(d)))}h=0;for(g=e.length;h<g;++h)e[h]&&delete e[h].__included;return e};return a.json.query=function(a,b){function e(a,b,c,d,e,f,g,l){return h[l].match(/[\*\?]/)||"~"==g?"/^"+h[l].substring(1,h[l].length-1).replace(/\\([btnfr\\"'])|([^\w\*\?])/g,"\\$1$2").replace(/([\*\?])/g,"[\\w\\W]$1")+("~"==g?"$/i":"$/")+".test("+b+")":a}var f=0,h=[];a=a.replace(/"(\\.|[^"\\])*"|'(\\.|[^'\\])*'|[\[\]]/g,function(a){f+="["==a?1:"]"==a?-1:0;return"]"==a&&0<f?"`]":'"'==a.charAt(0)||
"'"==a.charAt(0)?"`"+(h.push(a)-1):a});var g="";a.replace(/(\]|\)|push|pop|shift|splice|sort|reverse)\s*\(/,function(){throw Error("Unsafe function call");});a=a.replace(/([^<>=]=)([^=])/g,"$1\x3d$2").replace(/@|(\.\s*)?[a-zA-Z\$_]+(\s*:)?/g,function(a){return"."==a.charAt(0)?a:"@"==a?"$obj":(a.match(/:|^(\$|Math|true|false|null)$/)?"":"$obj.")+a}).replace(/\.?\.?\[(`\]|[^\]])*\]|\?.*|\.\.([\w\$_]+)|\.\*/g,function(a,b,c){return(b=a.match(/^\.?\.?(\[\s*\^?\?|\^?\?|\[\s*==)(.*?)\]?$/))?(c="",a.match(/^\./)&&
(g="dojox.json._find("+g,c=",true)"),g=(b[1].match(/\=/)?"dojo.map":b[1].match(/\^/)?"dojox.json._distinctFilter":"dojo.filter")+"("+g,c+",function($obj){return "+b[2]+"})"):(b=a.match(/^\[\s*([\/\\].*)\]/))?".concat().sort(function(a,b){"+b[1].replace(/\s*,?\s*([\/\\])\s*([^,\\\/]+)/g,function(a,b,c){return"var av\x3d "+c.replace(/\$obj/,"a")+",bv\x3d "+c.replace(/\$obj/,"b")+";if(av\x3ebv||bv\x3d\x3dnull){return "+("/"==b?1:-1)+";}\nif(bv\x3eav||av\x3d\x3dnull){return "+("/"==b?-1:1)+";}\n"})+"return 0;})":
(b=a.match(/^\[(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)\]/))?(g="dojox.json._slice("+g,","+(b[1]||0)+","+(b[2]||0)+","+(b[3]||1)+")"):a.match(/^\.\.|\.\*|\[\s*\*\s*\]|,/)?(g="dojox.json._find("+g,("."==a.charAt(1)?",'"+c+"'":a.match(/,/)?","+a:"")+")"):a}).replace(/(\$obj\s*((\.\s*[\w_$]+\s*)|(\[\s*`([0-9]+)\s*`\]))*)(==|~)\s*`([0-9]+)/g,e).replace(/`([0-9]+)\s*(==|~)\s*(\$obj\s*((\.\s*[\w_$]+)|(\[\s*`([0-9]+)\s*`\]))*)/g,function(a,b,c,d,f,g,h,l){return e(a,d,f,g,h,l,c,b)});a=g+("$"==a.charAt(0)?"":"$")+
a.replace(/`([0-9]+|\])/g,function(a,b){return"]"==b?"]":h[b]});for(var d=eval("1\x26\x26function($,$1,$2,$3,$4,$5,$6,$7,$8,$9){var $obj\x3d$;return "+a+"}"),c=0;c<arguments.length-1;c++)arguments[c]=arguments[c+1];return b?d.apply(this,arguments):d}})},"esri/tasks/PrintParameters":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.tasks.PrintParameters",map:null,template:null,outSpatialReference:null,extraParameters:null});
return a("extend-esri")&&k.setObject("tasks.PrintParameters",h,f),h})},"cmv/viewer/js/gis/dijit/Print/nls/resource":function(){define({root:{title:"Title",format:"Format",layout:"Layout",settings:"Settings",mapScaleExtent:"Map scale/extent",preserve:"Preserve",mapScale:"map scale",mapExtent:"map extent",fullLayoutOptions:"Full layout options",scaleBarUnits:"Scale bar units",miles:"Miles",kilometers:"Kilometers",meters:"Meters",feet:"Feet",includeLegend:"Include legend",printQualityOptions:"Print quality options",
dpiInput:{label:"DPI",invalidMessage:"Please enter a numeric value.",rangeMessage:"Please enter a value between 100 and 300."},mapOnlyOptions:"MAP_ONLY options",width:"Width",height:"Height",printButton:{busyLabel:"printing",label:"Print"},clearHistoryButton:{label:"Clear Print History"},printResults:{progressBar:{label:"Creating Print"},errorMessage:"Error, try again"}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],
function(h,k,a){return h("dijit.form.RadioButton",[k,a],{baseClass:"dijitRadio"})})},"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "),function(h,k,a,f,b,e){return k("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){var a=[];b("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(f.hitch(this,function(b){b.name==this.name&&b.form==this.focusNode.form&&
(b=e.getEnclosingWidget(b))&&a.push(b)}));return a},_setCheckedAttr:function(a){this.inherited(arguments);this._created&&a&&h.forEach(this._getRelatedWidgets(),f.hitch(this,function(a){a!=this&&a.checked&&a.set("checked",!1)}))},_getSubmitValue:function(a){return null==a?"on":a},_onClick:function(b){if(this.checked||this.disabled)return b.stopPropagation(),b.preventDefault(),!1;if(this.readOnly)return b.stopPropagation(),b.preventDefault(),h.forEach(this._getRelatedWidgets(),f.hitch(this,function(b){a.set(this.focusNode||
this.domNode,"checked",b.checked)})),!1;var e=!1,g;h.some(this._getRelatedWidgets(),function(a){return a.checked?(g=a,!0):!1});this.checked=!0;g&&(g.checked=!1);if(!1===this.onClick(b)||b.defaultPrevented)e=!0;this.checked=!1;g&&(g.checked=!0);e?b.preventDefault():this.set("checked",!0);return!e}})})},"cmv/viewer/js/gis/dijit/Directions":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin esri/dijit/Directions dojo/text!./Directions/templates/Directions.html dojo/_base/lang dijit/Menu dijit/MenuItem dijit/PopupMenuItem dijit/MenuSeparator esri/geometry/Point esri/SpatialReference dojo/topic dojo/i18n!./Directions/nls/resource dojo/dom-style".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r){return h([k,a],{templateString:b,i18n:t,postCreate:function(){this.inherited(arguments);this.directions=new f(e.mixin({map:this.map},this.options),this.directionsNode);this.directions.startup();this.directions._activateButton?r.set(this.directions._activateButton,"display","none"):this.directions._activateButtonNode&&(r.set(this.directions._activateButtonNode,"display","none"),r.set(this.directions._addDestinationNode,"float","inherit"),r.set(this.directions._optionsButtonNode,
{"float":"inherit",marginRight:"5px"}));this.mapRightClickMenu&&this.addRightClickMenu()},addRightClickMenu:function(){this.map.on("MouseDown",e.hitch(this,function(a){this.mapRightClickPoint=a.mapPoint}));this.menu=new l;this.menu.addChild(new m({label:this.i18n.labels.directionsFromHere,onClick:e.hitch(this,"directionsFrom")}));this.menu.addChild(new m({label:this.i18n.labels.directionsToHere,onClick:e.hitch(this,"directionsTo")}));this.menu.addChild(new d);this.menu.addChild(new m({label:this.i18n.labels.addStop,
onClick:e.hitch(this,"addStop")}));this.menu.addChild(new d);this.menu.addChild(new m({label:this.i18n.labels.useMyLocationAsStart,onClick:e.hitch(this,"getGeoLocation","directionsFrom")}));this.menu.addChild(new m({label:this.i18n.labels.useMyLocationAsEnd,onClick:e.hitch(this,"getGeoLocation","directionsTo")}));this.mapRightClickMenu.addChild(new g({label:this.i18n.labels.directions,popup:this.menu}))},clearStops:function(){this.directions.reset()},directionsFrom:function(){this.directions.updateStop(this.mapRightClickPoint,
0).then(e.hitch(this,"doRoute"))},directionsTo:function(){this.directions.updateStop(this.mapRightClickPoint,this.directions.stops.length-1).then(e.hitch(this,"doRoute"))},addStop:function(){this.directions.addStop(this.mapRightClickPoint,this.directions.stops.length-1).then(e.hitch(this,"doRoute"))},doRoute:function(){this.parentWidget&&!this.parentWidget.open&&this.parentWidget.toggle();this.directions.stops[0]&&this.directions.stops[1]&&this.directions.getDirections()},startAtMyLocation:function(){this.getGeoLocation("directionsFrom")},
endAtMyLocation:function(){this.getGeoLocation("directionsTo")},getGeoLocation:function(a){navigator&&navigator.geolocation?navigator.geolocation.getCurrentPosition(e.hitch(this,"locationSuccess",a),e.hitch(this,"locationError")):q.publish("growler/growl",{title:this.i18n.errors.geoLocation.title,message:this.i18n.errors.geoLocation.message,level:"default",timeout:1E4,opacity:1})},locationSuccess:function(a,b){this.mapRightClickPoint=new c(b.coords.longitude,b.coords.latitude,new n({wkid:4326}));
this[a]()},locationError:function(a){q.publish("growler/growl",{title:this.i18n.errors.location.title,message:this.i18n.errors.location.message+a.message,level:"default",timeout:1E4,opacity:1})}})})},"esri/dijit/Directions":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/_base/array dojo/_base/Color dijit/a11yclick dijit/_TemplatedMixin dijit/form/Select dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/TimeTextBox dojo/store/Memory dojo/data/ObjectStore dojo/keys dojo/has dojo/on dojo/mouse dojo/dom dojo/dom-geometry dojo/dom-style dojo/dom-class dojo/dom-attr dojo/query dojo/number dojo/i18n!../nls/jsapi dojo/text!./templates/Directions.html ./Search dojo/dom-construct dojo/promise/all dojo/Deferred dojo/dnd/Source dojo/json ../kernel ../urlUtils ../graphic ../units ../TimeExtent ../InfoTemplate ../SpatialReference ../layers/ArcGISDynamicMapServiceLayer ../layers/GraphicsLayer ../geometry/webMercatorUtils ../geometry/geodesicUtils ../arcgis/utils ../geometry/Point ../geometry/Extent ../geometry/Polyline ../geometry/mathUtils ../symbols/SimpleMarkerSymbol ../symbols/PictureMarkerSymbol ../symbols/CartographicLineSymbol ../symbols/TextSymbol ../renderers/UniqueValueRenderer ../symbols/Font ./_EventedWidget ../tasks/FeatureSet ../tasks/RouteTask ../tasks/RouteParameters ../tasks/GeometryService ../tasks/DistanceParameters ../tasks/PrintTask ../tasks/PrintParameters ../tasks/PrintTemplate ../toolbars/edit ../toolbars/draw ../config ../tasks/ProjectParameters dojo/uacss".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J,L,M,H,K,P,O,S,Q,R,aa,X,T,V,da,ga,la,Aa,ta,pa,wa,oa,ma,ia,ja,za,Ba,ra,ua,xa,Ha,Ia,Da,Ja,Ga,Na,Ta,Xa,Ma){var Oa=P.getProtocolForWebResource();k=k("esri.dijit.Directions",[Ba,m],{templateString:F,mapClickActive:!1,barrierToolActive:!1,_eventMap:{activate:!0,deactivate:!1,load:!0,"directions-start":!0,"directions-finish":["result"],"directions-clear":!0,"segment-select":["graphic"],"segment-highlight":["graphic"],error:["error"],"stops-update":["stops"],
"route-item-created":!0,"route-item-updated":!0,"feature-collection-created":!0},_emptyStop:{name:""},constructor:function(b,c){if(!b.map)throw Error('Required "map" parameter is missing. Cannot instantiate Directions Widget.');if(!c)throw Error('Required "srcNodeRef" parameter is missing. Cannot instantiate Directions Widget.');this._i18n=E;this._css={widgetContainerClass:"esriDirectionsContainer",searchSourceContainerClass:"esriSearchSourceContainer",stopsContainerClass:"esriStopsContainer",stopsTableContainerClass:"esriStopsTableContainer",
stopsTableCoverClass:"esriStopsTableCover",reverseStopsClass:"esriStopsReverse",addStopsClass:"esriStopsAdd",stopsClass:"esriStops",stopsRemovableClass:"esriStopsRemovable",stopsButtonContainerClass:"esriStopsButtons",stopsOptionsButtonClass:"esriStopsOptionsButton",stopsAddDestinationClass:"esriStopsAddDestination",stopsAddDestinationBtnClass:"esriStopsAddDestinationBtn",stopsGetDirectionsContainerClass:"esriStopsGetDirectionsContainer",stopsGetDirectionsClass:"esriStopsGetDirections",stopsClearDirectionsClass:"esriStopsClearDirections",
stopsInnerGeocoderClass:"esriInnerGeocoder",stopsOptionsOptionsEnabledClass:"esriStopsOptionsEnabled",stopsOptionsMenuClass:"esriStopsOptionsMenu",stopsFindOptimalOrderClass:"esriFindOptimalOrderOption",stopsUseTrafficClass:"esriUseTrafficOption",stopsReturnToStartClass:"esriReturnToStartOption",stopsOptionsCheckboxesClass:"esriOptionsCheckboxes",stopsOptionsToggleContainerClass:"esriOptionsToggleContainer",stopsOptionsUnitsContainerClass:"esriOptionsUnitsContainer",stopsOptionsUnitsMiClass:"esriOptionsUnitsMi",
stopsOptionsUnitsKmClass:"esriOptionsUnitsKm",stopsOptionsImpedanceContainerClass:"esriOptionsImpedanceContainer",stopsOptionsImpedanceTimeClass:"esriOptionsImpedanceTime",stopsOptionsImpedanceDistanceClass:"esriOptionsImpedanceDistance",stopClass:"esriStop",stopOriginClass:"esriStopOrigin",stopDestinationClass:"esriStopDestination",stopUnreachedFirstOrLastClass:"esriStopUnreachedFirstOrLast",stopUnreachedClass:"esriStopUnreached",esriStopGeocoderColumnClass:"esriStopGeocoderColumn",esriStopReverseColumnClass:"esriStopReverseColumn",
stopDnDHandleClass:"esriStopDnDHandle",stopDnDHandleClassHidden:"esriStopDnDHandleHidden",stopIconColumnClass:"esriStopIconColumn",stopIconClass:"esriStopIcon",stopIconRemoveColumnClass:"esriStopIconRemoveColumn",stopIconRemoveClass:"esriStopIconRemove",stopIconRemoveClassHidden:"esriStopIconRemoveHidden",resultsContainerClass:"esriResultsContainer",resultsLoadingClass:"esriResultsLoading",resultsPrintClass:"esriResultsPrint",resultsSaveClass:"esriResultsSave",resultsSummaryClass:"esriResultsSummary",
routesContainerClass:"esriRoutesContainer",routesClass:"esriRoutes",routesErrorClass:"esriRoutesError",routesInfoClass:"esriRoutesInfo",routeClass:"esriRoute",routeTextColumnClass:"esriRouteTextColumn",routeTextClass:"esriRouteText",routeLengthClass:"esriRouteLength",routeOriginClass:"esriDMTStopOrigin",routeDestinationClass:"esriDMTStopDestination",routeInfoClass:"esriRouteInfo",routeIconColumnClass:"esriRouteIconColumn",routeIconClass:"esriRouteIcon",infoWindowRouteClass:"esriInfoWindowRoute",routeZoomClass:"esriRouteZoom",
esriPrintPageClass:"esriPrintPage",esriPrintBarClass:"esriPrintBar",esriPrintButtonClass:"esriPrintButton",esriCloseButtonClass:"esriCloseButton",esriPrintMainClass:"esriPrintMain",esriPrintHeaderClass:"esriPrintHeader",esriPrintLogoClass:"esriPrintLogo",esriPrintMapClass:"esriPrintMap",esriPrintNameClass:"esriPrintName",esriPrintNotesClass:"esriPrintNotes",esriPrintLengthClass:"esriPrintLength",esriPrintDirectionsClass:"esriPrintDirections",esriPrintFooterClass:"esriPrintFooter",esriPrintStopLabelClass:"esriPrintStopLabel",
clearClass:"esriClear",dndDragBodyClass:"esriDndDragDirection",stopsButtonClass:"esriDirectionsButton",stopsButtonTabClass:"esriDirectionsTabButton",stopsButtonTabLastClass:"esriDirectionsTabLastButton",stopsPressedButtonClass:"esriDirectionsPressedButton",linkButtonClass:"esriLinkButton",activateButtonClass:"esriActivateButton",lineBarrierButtonClass:"esriLineBarrierButton",travelModesContainerClass:"esriTravelModesContainer"};this.options={map:null,autoSolve:!0,minStops:2,maxStops:20,theme:"simpleDirections",
alphabet:"1234567890",directions:null,returnToStart:!1,optimalRoute:!1,routeTaskUrl:Oa+"//route.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",printTaskUrl:Oa+"//utility.arcgisonline.com/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task",geometryTaskUrl:Oa+"//utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",routeParams:{},stops:["",""],searchOptions:{},stopsInfoTemplate:new R(E.widgets.directions.stop,"${address}${error}"),waypointInfoTemplate:new R(E.widgets.directions.maneuver,
E.widgets.directions.waypoint),segmentInfoTemplate:new R(E.widgets.directions.maneuver,'\x3cdiv class\x3d"${maneuverType}"\x3e\x3cdiv class\x3d"'+this._css.routeIconClass+" "+this._css.infoWindowRouteClass+'"\x3e\x3cstrong\x3e${step}.\x3c/strong\x3e ${formattedText}\x3c/div\x3e\x3c/div\x3e'),textSymbolFont:new za("11px",za.STYLE_NORMAL,za.VARIANT_NORMAL,za.WEIGHT_NORMAL,"Arial, Helvetica, sans-serif"),textSymbolColor:new e([255,255,255]),textSymbolOffset:{x:0,y:10.875},fromSymbol:(new oa({url:h.toUrl("./images/Directions/greenPoint.png"),
height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),fromSymbolDrag:(new oa({url:h.toUrl("./images/Directions/greenPointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),stopSymbol:(new oa({url:h.toUrl("./images/Directions/bluePoint.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),stopSymbolDrag:(new oa({url:h.toUrl("./images/Directions/bluePointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),toSymbol:(new oa({url:h.toUrl("./images/Directions/redPoint.png"),
height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),toSymbolDrag:(new oa({url:h.toUrl("./images/Directions/redPointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),unreachedSymbol:(new oa({url:h.toUrl("./images/Directions/grayPoint.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),unreachedSymbolDrag:(new oa({url:h.toUrl("./images/Directions/grayPointMove.png"),height:21.75,width:15.75,type:"esriPMS"})).setOffset(0,10.875),waypointSymbol:new wa({color:[255,
255,255,255],size:10,type:"esriSMS",style:"esriSMSCircle",outline:{color:[20,89,127,255],width:2.5,type:"esriSLS",style:"esriSLSSolid"}}),maneuverSymbol:new wa({color:[255,255,255,255],size:4,type:"esriSMS",style:"esriSMSCircle",outline:{color:[30,99,137,255],width:1,type:"esriSLS",style:"esriSLSSolid"}}),routeSymbol:(new ma).setColor(new e([20,89,127,1])).setWidth(10).setCap(ma.CAP_ROUND).setJoin(ma.JOIN_ROUND),segmentSymbol:(new ma).setColor(new e([255,255,255,1])).setWidth(6).setCap(ma.CAP_ROUND).setJoin(ma.JOIN_ROUND),
barrierRenderer:new ja({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{type:"esriPMS",imageData:"PHN2ZyB3aWR0aD0iMjIyIiBoZWlnaHQ9IjIyMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGc+CjxlbGxpcHNlIGZpbGw9IiNmZjAwMDAiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLXdpZHRoPSIyMCIgY3g9IjExMiIgY3k9IjExMSIgaWQ9InN2Z181IiByeD0iMTAwIiByeT0iMTAwIi8+CjxlbGxpcHNlIGZpbGw9IiNmZjAwMDAiIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLXdpZHRoPSIyMCIgY3g9IjExMiIgY3k9IjExMSIgaWQ9InN2Z182IiByeD0iOTUiIHJ5PSI5NSIvPgo8cmVjdCBmaWxsPSIjZmYwMDAwIiBzdHJva2Utd2lkdGg9IjIwIiB4PSI2NC41IiB5PSIxMDIiIHdpZHRoPSI5NSIgaGVpZ2h0PSIxOCIgaWQ9InN2Z183IiBzdHJva2U9IiNmZmZmZmYiLz4KPC9nPgo8L3N2Zz4\x3d",
contentType:"image/svg+xml",width:18,height:18},uniqueValueInfos:[{value:"2",symbol:{type:"esriPMS",imageData:"PHN2ZyB3aWR0aD0iMjg2IiBoZWlnaHQ9IjI1NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGc+CjxwYXRoIGZpbGw9IiNmZmYiIHN0cm9rZS13aWR0aD0iMTAiIGQ9Im04Ljc0OTk5MiwyNTEuNzQ5OTk3bDEzNC45OTk5OTgsLTI0MS45OTk5OThsMTM0Ljk5OTk5OCwyNDEuOTk5OTk4bC0yNjkuOTk5OTk1LDBsLTAuMDAwMDAxLDB6IiBpZD0ic3ZnXzEiIHN0cm9rZT0iIzAwMCIvPgo8cGF0aCBzdHJva2U9IiNmZmYiIGZpbGw9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMTUiIGQ9Im0yMy41MDAwMDQsMjQyLjUwMDAwNWwxMTkuOTk5OTkyLC0yMTUuOTk5OTk5bDExOS45OTk5OTIsMjE1Ljk5OTk5OWwtMjM5Ljk5OTk4MywwbC0wLjAwMDAwMSwweiIgaWQ9InN2Z18yIi8+Cjx0ZXh0IGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSIjZmZmZmZmIiBzdHJva2U9IiNmZjAwMDAiIHN0cm9rZS13aWR0aD0iMCIgeD0iMTA5IiB5PSIyMjIuNzUiIGlkPSJzdmdfNSIgZm9udC1zaXplPSIxODAiIGZvbnQtZmFtaWx5PSJHZW9yZ2lhLCBUaW1lcywgJ1RpbWVzIE5ldyBSb21hbicsIHNlcmlmIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIHhtbDpzcGFjZT0icHJlc2VydmUiPiE8L3RleHQ+CjwvZz4KPC9zdmc+",
contentType:"image/svg+xml",width:19,height:18}}]}),polylineBarrierRenderer:new ja({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{color:[255,0,0,184],width:7.5,type:"esriSLS",style:"esriSLSSolid"},uniqueValueInfos:[{value:"1",symbol:{color:[255,85,0,184],width:7.5,type:"esriSLS",style:"esriSLSSolid"}}]}),polygonBarrierRenderer:new ja({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{color:[255,0,0,156],outline:{color:[255,0,0,153],width:2.4,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",
style:"esriSFSSolid"},uniqueValueInfos:[{value:"1",symbol:{color:[255,170,0,156],outline:{color:[255,0,0,153],width:7.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}]}),printPage:"",printTemplate:"",focusOnNewStop:!0,dragging:!0,canModifyStops:!0,canModifyWaypoints:!0,directionsLengthUnits:null,directionsLanguage:null,traffic:!1,trafficLayer:null,showPrintPage:!0,showSaveButton:!1,showSegmentPopup:!1,showSegmentHighlight:!0,showReverseStopsButton:!0,showReturnToStartOption:!0,
showOptimalRouteOption:!0,showTravelModesOption:!0,showMilesKilometersOption:!0,showClearButton:!1,showActivateButton:!0,showBarriersButton:!0,loaded:!1,routeLayer:{itemId:null,title:null,isItemOwner:!0,ownerFolder:null},startTime:"now"};if(this.userOptions=b,this.defaults=a.mixin({},this.options,b,{_waypointName:"DWWP",_userDefinedStopName:"UserDefinedStopName",_solveInProgress:!1,_moveInProgress:!1,_stopSequence:1E3}),(!this.defaults.minStops||2>this.defaults.minStops)&&(this.defaults.minStops=
2),2<this.defaults.minStops&&this.defaults.stops&&","===this.defaults.stops.toString())for(var d=2;d<this.defaults.minStops;d++)this.defaults.stops.splice(0,0,"");this.domNode=c},postCreate:function(){this.inherited(arguments);this.own(u(this._activateButtonNode,l,a.hitch(this,function(){this.mapClickActive?this.deactivate():this.activate()})));this.own(u(this._lineBarrierButtonNode,l,a.hitch(this,function(){this.barrierToolActive?this.deactivateBarrierTool():this.activateBarrierTool()})));this.own(u(this._addDestinationNode,
l,a.hitch(this,this._addStopButton)));this.own(u(this._optionsButtonNode,l,a.hitch(this,this._toggleOptionsMenu)));this.own(u(this._saveMenuButton,l,a.hitch(this,this._toggleSaveMenu)));this.own(u(this._saveButton,l,a.hitch(this,function(){this._saveButton._enabled&&this._storeRouteUI()})));this.own(u(this._saveAsButton,l,a.hitch(this,function(){a.mixin(this.routeLayer,{itemId:null,title:null,ownerFolder:null});this._storeRouteUI()})));this.own(u(this._findOptimalOrderNode,l,a.hitch(this,this._toggleCheckbox)));
this.own(u(this._returnToStartNode,l,a.hitch(this,this._toggleCheckbox)));this.own(u(this._useTrafficNode,l,a.hitch(this,this._toggleCheckbox)));this.own(u(this._useMilesNode,l,a.hitch(this,this._toggleUnits)));this.own(u(this._useKilometersNode,l,a.hitch(this,this._toggleUnits)));this.own(u(this._getDirectionsButtonNode,l,a.hitch(this,this.getDirections)));this.own(u(this._clearDirectionsButtonNode,l,a.hitch(this,function(){this.clearDirections()})));var c=a.hitch(this,function(){clearTimeout(this._startTimeMenu._hideTimer);
this._startTimeMenu._hideTimer=setTimeout(a.hitch(this,function(){A.set(this._startTimeMenu,"display","none")}),100)});this.own(u(this._startTimeButtonNode,l,a.hitch(this,function(){this._startTimeButtonNode.disabled||"block"===A.get(this._startTimeMenu,"display")?A.set(this._startTimeMenu,"display","none"):(A.set(this._startTimeMenu,"display","block"),this[isNaN(this.startTime)?"_startTimeMenuLeaveNow":"_startTimeMenuDepartAt"].focus())})));this.own(u(this._startTimeMenuLeaveNow,"blur",c));this.own(u(this._startTimeMenuDepartAt,
"blur",c));this.own(u(this._startTimeMenuLeaveNow,"mousedown",a.hitch(this,function(){this.startTime="now";this._updateStartTimeUI();this._clearDisplayBeforeSolve()})));this.own(u(this._startTimeMenuDepartAt,"mousedown",a.hitch(this,function(){this.startTime=(new Date).getTime();this._updateStartTimeUI();this._clearDisplayBeforeSolve()})));this._symbolEventPaddingDirections=(new ma).setColor(new e([0,255,0,0])).setWidth(20).setCap(ma.CAP_ROUND);this._stopLayer=new T({id:"directions_stopLayer_"+this.id,
displayOnPan:!0});this._routeLayer=new T({id:"directions_routeLayer_"+this.id,displayOnPan:!0});this._waypointsEventLayer=new T({id:"directions_waypointsEventLayer_"+this.id,displayOnPan:!0});this._barriersLayer=new T({id:"directions_barriersLayer_"+this.id,displayOnPan:!0});this._polylineBarriersLayer=new T({id:"directions_polylineBarriersLayer_"+this.id,displayOnPan:!0});this._polygonBarriersLayer=new T({id:"directions_polygonBarriersLayer_"+this.id,displayOnPan:!0});this._barriersLayer.setRenderer(this.defaults.barrierRenderer);
this._polylineBarriersLayer.setRenderer(this.defaults.polylineBarrierRenderer);this._polygonBarriersLayer.setRenderer(this.defaults.polygonBarrierRenderer);this.map.addLayer(this._routeLayer);this.map.addLayer(this._polygonBarriersLayer);this.map.addLayer(this._polylineBarriersLayer);this.map.addLayer(this._barriersLayer);this.map.addLayer(this._stopLayer);this._snappingManager=this.map.enableSnapping({layerInfos:[{layer:this._waypointsEventLayer,snapToVertex:!1,snapToPoint:!0,snapToEdge:!0}],tolerance:15});
this._setWidgetProperties();var d=new O(null,this.waypointSymbol,{}),c=a.hitch(this,function(){this._moveInProgress||this._solveInProgress||!d._isShown()||(this.editToolbar.deactivate(),this._stopLayer.remove(d),clearTimeout(d._solveTimeout),d._solveTimeout=null,d.attributes.isWaypoint=!0,d._isStopIcon&&this.stopGraphics[d._index]&&(this._stopLayer.add(this.stopGraphics[d._index]),this._stopLayer.add(this.textGraphics[d._index])));d._showTooltip()});this._handle=a.mixin(d,{_isHandle:!0,_tooltip:I.create("div",
{className:this.theme+" esriDirectionsRouteTooltip",onmouseover:c},this.map.container),_showTooltip:a.hitch(this,function(a){d._tooltip.style.display=!a||a instanceof MouseEvent?"none":"inline";a&&(a="string"==typeof a?a:"\x3ctable class\x3d'esriRoutesTooltip'\x3e"+this._renderDirectionsItemTR(a)+"\x3c/table\x3e",d._tooltip.innerHTML!==a&&(d._tooltip.innerHTML=a))}),_isShown:a.hitch(this,function(){return-1<b.indexOf(this._stopLayer.graphics,d)}),_remove:c});this._activate(this.mapClickActive)},startup:function(){return this.inherited(arguments),
this._enqueue(this._init)},destroy:function(){this.deactivate();this.map.removeLayer(this._barriersLayer);this.map.removeLayer(this._polylineBarriersLayer);this.map.removeLayer(this._polygonBarriersLayer);this.map.removeLayer(this._routeLayer);this.map.removeLayer(this._stopLayer);this.map.removeLayer(this._waypointsEventLayer);this._disconnectEvents();I.empty(this.domNode);this.inherited(arguments)},activate:function(){return this._enqueue(function(){this.deactivateBarrierTool().then(a.hitch(this,
function(){this.set("mapClickActive",!0)}))})},deactivate:function(){return this._enqueue(function(){this.deactivateBarrierTool().then(a.hitch(this,function(){this.set("mapClickActive",!1)}))})},activateBarrierTool:function(){return this._enqueue(function(){this.set("mapClickActive",!1);this.set("barrierToolActive",!0)})},deactivateBarrierTool:function(){return this._enqueue(function(){this.set("mapClickActive",!1);this.set("barrierToolActive",!1)})},clearDirections:function(){return this._enqueue(function(){return this.clearMessages(),
this._clearDirections()})},reset:function(){return this._enqueue(this._reset)},modifyStopSequence:function(a,b){return this._enqueue(function(){return this._modifyStopSequence(a,b)})},onActivate:function(){},onDeactivate:function(){},onActivateBarrierTool:function(){},onDeactivateBarrierTool:function(){},onLoad:function(){this._enableButton(this._getDirectionsButtonNode)},onDirectionsStart:function(){this._clearDisplayBeforeSolve();this.set("solving",!0);this._showLoadingSpinner(!0)},onDirectionsFinish:function(){this._showLoadingSpinner(!1);
this.set("solving",!1)},onDirectionsClear:function(){},onSegmentSelect:function(){},onSegmentHighlight:function(){},onStopsUpdate:function(){},onRouteItemCreated:function(){},onRouteItemUpdated:function(){},onFeatureCollectionCreated:function(){},onError:function(){},removeStops:function(){return this.reset()},removeStop:function(a,b,c){return this._enqueue(function(){return this.clearMessages(),this._removeStop(a,b,c)})},updateStops:function(a){return this._enqueue(function(){return this._updateStops(a)})},
addStops:function(b,c){return this._enqueue(function(){return this._addStops(b,c)}).then(a.hitch(this,this.zoomToFullRoute))},addStop:function(a,b){return this._enqueue(function(){return this._addStop(a,b)},{_incrementalSolveStopRange:this._incrementalSolveStopRange})},updateStop:function(a,b,c){return this._enqueue(function(){return this._updateStop(a,b,c)},{_incrementalSolveStopRange:this._incrementalSolveStopRange})},clearMessages:function(){this.messages=[];this._msgNode&&(this._msgNode.innerHTML=
"")},getDirections:function(b){return this._enqueue(function(){return this._getDirections().then(a.hitch(this,function(){!0!==b&&this.zoomToFullRoute()}))})},selectSegment:function(a){if(!(!this.directions||!this.directions.features||0>a||a>=this.directions.features.length))for(var b=C("[data-segment]",this._resultsNode),c=0;c<b.length;c++){var d=parseInt(B.get(b[c],"data-segment"),10);if(a===d&&b[c]!==this._focusedDirectionsItem){this._focusedDirectionsItem=b[c];this.centerAtSegmentStart(a);this.onSegmentSelect(this.directions.features[a]);
b[c].focus();break}}},unhighlightSegment:function(a){var b=this._segmentGraphics;if(b&&(!this._focusedDirectionsItem||a)){for(a=0;a<b.length;a++)this._routeLayer.remove(b[a]);this._segmentGraphics=[]}},highlightSegment:function(b,c){if(!(this._focusedDirectionsItem&&!c||b>=this.directions.features.length)){b=b||0;var d=a.hitch(this,function(a){var b=this.map.toMap({x:0,y:0});return this.map.toScreen(b.offset(a,0)).x}),f=a.hitch(this,function(a){for(var b=0,c=0;c<a.length;c++)for(var e=1;e<a[c].length;e++)var f=
a[c][e-1],g=a[c][e],b=b+d(Math.sqrt((f[0]-g[0])*(f[0]-g[0])+(f[1]-g[1])*(f[1]-g[1])));return b}),g=a.hitch(this,function(a){var b=this.map.toMap({x:0,y:0});return this.map.toMap({x:a,y:0}).x-b.x}),h=function(a,b,c){b=Math.max(1,b);for(var e,f,g,h=c?a[0].length-1:0,l=0,m=[[a[0][c?h:0]]];c&&0<h||!c&&h<a[0].length-1;){if(f=a[0][c?h-1:h],g=a[0][c?h:h+1],e=d(Math.sqrt((f[0]-g[0])*(f[0]-g[0])+(f[1]-g[1])*(f[1]-g[1])))){if(!(b>l+e)){b=(b-l)/e;c?m[0].splice(0,0,[g[0]-(g[0]-f[0])*b,g[1]-(g[1]-f[1])*b]):m[0].push([f[0]+
(g[0]-f[0])*b,f[1]+(g[1]-f[1])*b]);break}c?m[0].splice(0,0,f):m[0].push(g);l+=e}h+=c?-1:1}return 0<l+e?m:a},l=this.get("directions").features[b],m=new ta(l.geometry),k=40*Math.PI/180;if(a.mixin(l.attributes,{_index:b}),b){var n=h(this.get("directions").features[b-1].geometry.paths,25,!0),q="esriDMTStop"!==l.attributes.maneuverType?h(m.paths,25,!1):n,n=q!==n?[n[0].concat(q[0])]:q,r=(new ta(q)).getExtent();if(1<q[0].length&&15<=d(Math.max(r.getWidth(),r.getHeight()))){for(var t,h=15*Math.cos(k/2),k=
15*Math.sin(k/2),u=q[0].length-2,f=q[0][u+1],r=0;0<=u&&!r;)t=q[0][u],r=d(Math.sqrt((t[0]-f[0])*(t[0]-f[0])+(t[1]-f[1])*(t[1]-f[1]))),u--;22>r&&(q=r+(22-r)/3,u=r+2*(22-r)/3,u=[t[0]+u/r*(f[0]-t[0]),t[1]+u/r*(f[1]-t[1])],t=[f[0]-q/r*(f[0]-t[0]),f[1]-q/r*(f[1]-t[1])],f=u,r=22);var v,w,q=h/r,h=[f[0]-(f[0]-t[0])*q,f[1]-(f[1]-t[1])*q];t[1]!==f[1]?(q=(f[0]-t[0])/(f[1]-t[1]),v=g(k/Math.sqrt(1+q*q)),w=q*v):(v=0,w=g(k));Math.abs(v)===1/0||Math.abs(w)===1/0||isNaN(v)||isNaN(w)||(n[0].push(f),n[0].push([h[0]-
v,h[1]+w]),n[0].push([h[0]+v,h[1]-w]),n[0].push(f))}else n=h(n,2*f(q),!0);m.paths=n}this.unhighlightSegment(this._segmentGraphics&&this._segmentGraphics.length);g=a.clone(this.routeSymbol).setWidth(this.segmentSymbol.width).setColor(new e([parseInt(.9*this.segmentSymbol.color.r),parseInt(.9*this.segmentSymbol.color.g),parseInt(.9*this.segmentSymbol.color.b)]));this._segmentGraphics=[new O(l.geometry,g,l.attributes,this.get("segmentInfoTemplate")),new O(m,this.routeSymbol,l.attributes,this.get("segmentInfoTemplate")),
new O(m,this.segmentSymbol,l.attributes,this.get("segmentInfoTemplate"))];this.get("showSegmentHighlight")&&(this._routeLayer.add(this._segmentGraphics[0]),this._routeLayer.add(this._segmentGraphics[1]),this._routeLayer.add(this._segmentGraphics[2]));l=a.hitch(this,function(a){if(0<a&&a<this.directions.features.length){a=this.directions.features[a]._associatedFeaturesWithWaypoints;for(var b=0;b<a.length;b++)a[b]._associatedSnapFeature&&a[b]._associatedSnapFeature.getDojoShape()&&a[b]._associatedSnapFeature.getDojoShape().moveToFront()}});
l(b-1);l(b);this.onSegmentHighlight(this.directions.features[b])}},zoomToSegment:function(b){var c,d=new L;return this.directions&&this.directions.features?(c=Math.max(0,Math.min(this.directions.features.length-1,b||0)),this.map.setExtent(this.get("directions").features[c].geometry.getExtent(),!0).promise.always(a.hitch(this,function(){this.highlightSegment(c);d.resolve()}))):d.reject(Error("No directions.")),d.promise},centerAtSegmentStart:function(b){var c,d=new L;if(this.directions&&this.directions.features){c=
Math.max(0,Math.min(this.directions.features.length-1,b||0));var e=this.directions.features[c];this.map.centerAt(e.geometry.getPoint(0,0)).promise.always(a.hitch(this,function(){this.highlightSegment(c,!0);this._showSegmentPopup(e,c);d.resolve()}))}else d.reject(Error("No directions."));return d.promise},zoomToFullRoute:function(){var a=new L;return this.directions&&this.directions.features?(this._clearInfoWindow(),this.unhighlightSegment(),this.get("map").setExtent(this.get("directions").extent,
!0).promise.always(a.resolve)):a.reject(Error("No directions.")),a.promise},setListIcons:function(){var a,b=this._dnd.getAllNodes();for(a=0;a<b.length;a++){var c=C("."+this._css.stopIconClass,b[a])[0];c&&(c.innerHTML=this._getLetter(a));z.remove(b[a],this._css.stopOriginClass+" "+this._css.stopDestinationClass+" "+this._css.stopUnreachedClass+" "+this._css.stopUnreachedFirstOrLastClass);c=this._getStopSymbol(this.stops[a]);c===this.fromSymbol?z.add(b[a],this._css.stopOriginClass):c===this.toSymbol?
z.add(b[a],this._css.stopDestinationClass):c===this.unreachedSymbol&&z.add(b[a],this._css.stopUnreachedClass)}a=C("[data-reverse-td]",this._dndNode)[0];I.destroy(a);this.get("showReverseStopsButton")&&I.create("td",{"data-reverse-td":"true",rowspan:b.length,className:this._css.esriStopReverseColumnClass,innerHTML:'\x3cdiv role\x3d"button" class\x3d"'+this._css.reverseStopsClass+'" data-reverse-stops\x3d"true" title\x3d"'+E.widgets.directions.reverseDirections+'"\x3e\x3c/div\x3e',onmouseover:function(a){a.stopPropagation()},
onmouseout:function(a){a.stopPropagation()}},b[0])},addRouteSymbols:function(){if(this.stopGraphics.length){this._moveLayersToFront();for(var a=0;a<this.stopGraphics.length;a++)if(this.stopGraphics[a]&&(!this._handle._isShown()||this._handle._isShown()&&this._handle._index!==a)){this._stopLayer.add(this.stopGraphics[a]);var b=this.stopGraphics[a].getDojoShape();b&&b.moveToFront();this._stopLayer.add(this.textGraphics[a]);(b=this.textGraphics[a].getDojoShape())&&b.moveToFront()}this._moveInProgress&&
!this._handle.attributes.isWaypoint&&this._handle.getDojoShape()&&this._handle.getDojoShape().moveToFront()}},createRouteSymbols:function(){this._clearStopGraphics();for(var b=this.stops,c=function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&0===c.indexOf("Attr_")&&(b[c]=a[c]);return b},d=0;d<b.length;d++){var e=b[d];if(e&&e.feature){var f=e.feature.attributes,g=f?f.Status:void 0,h=null;this._isStopAWaypoint(e)||(h=new ia(this._getLetter(d),this.get("textSymbolFont"),this.get("textSymbolColor")),
this.get("textSymbolOffset")&&h.setOffset(this.get("textSymbolOffset").x,this.get("textSymbolOffset").y));h=new O(e.feature.geometry,h,{address:e.name},this.get("stopsInfoTemplate"));h._isStopLabel=!0;h._index=d;e=new O(e.feature.geometry,this._getStopSymbol(e),a.mixin({address:e.name,Status:void 0===g?0:g,CurbApproach:f&&f.CurbApproach?f.CurbApproach:null,TimeWindowStart:f&&f.TimeWindowStart?f.TimeWindowStart:null,TimeWindowEnd:f&&f.TimeWindowEnd?f.TimeWindowEnd:null,isWaypoint:this._isStopAWaypoint(e)},
c(f)),this.get(this._isStopAWaypoint(e)?"waypointInfoTemplate":"stopsInfoTemplate"));e._isStopIcon=!0;e._index=d;this.stopGraphics[d]=e;this.textGraphics[d]=h}}this.set("stopGraphics",this.stopGraphics);this.set("textGraphics",this.textGraphics);this.addRouteSymbols();this.setListIcons()},setTravelMode:function(a){return this._enqueue(function(){return this.clearMessages(),this._travelModeSelector.setValue(a),this._setTravelMode(a)})},getSupportedTravelModeNames:function(){var a=[],b=this.serviceDescription;
if(b&&b.supportedTravelModes&&b.supportedTravelModes.length)for(var b=b.supportedTravelModes,c=0;c<b.length;c++)a.push(b[c].name);return a},setDirectionsLengthUnits:function(){var a=1===arguments.length?arguments[0]:this.get("directionsLengthUnits");return this._enqueue(function(){return this.clearMessages(),this._setDirectionsLengthUnits(a)})},setDirectionsLanguage:function(){var a=1===arguments.length?arguments[0]:this.get("directionsLanguage");return this._enqueue(function(){return this.clearMessages(),
this._setDirectionsLanguage(a)})},useMyCurrentLocation:function(a){return this.clearMessages(),this._createLocateButton(this.geocoders[a],!0,!0)},loadRoute:function(b){return this._enqueue(a.hitch(this,function(){return this._loadRoute(b)}))},_getStopsAttr:function(){return this.returnToStart&&this._returnToStartStop?this.stops.concat(this._returnToStartStop):this.stops},_getTravelModeNameAttr:function(){return this.routeParams&&this.routeParams.travelMode&&this.routeParams.travelMode.name},_reset:function(){var b=
this.mapClickActive||this.barrierToolActive;return this._clearBarriersGraphics(),this._setWidgetProperties(),this._init().then(a.hitch(this,function(){this.mapClickActive=!b;this.set("mapClickActive",b);this._searchSourceSelector&&this._searchSourceSelector.setValue("all")}))},_activate:function(){var b=this.get("mapClickActive"),c=a.hitch(this,function(a){for(var b=a?[this.textGraphics,this.stopGraphics,this.displayedManeuverPointGraphics,this.displayedRouteGraphics]:[this.displayedRouteGraphics,
this.displayedManeuverPointGraphics,this.stopGraphics,this.textGraphics],c=0;c<b.length;c++)for(var d=b[c],e=0;e<d.length;e++){var f=d[e].getDojoShape();f&&f[a?"moveToBack":"moveToFront"].call(f)}});this.drawToolbar&&(this.barrierToolActive=!1,this.drawToolbar.deactivate(),z.remove(this._lineBarrierButtonNode,this._css.stopsPressedButtonClass));this._addStopOnMapClickListener&&this._addStopOnMapClickListener.remove();b?(this.map.activeDirectionsWidget&&this.map.activeDirectionsWidget!==this&&this.map.activeDirectionsWidget.deactivate(),
this.map.activeDirectionsWidget=this,this._addStopOnMapClickListener=u(this.map,"click",a.hitch(this,function(a){this.canModifyStops&&!this._solveInProgress&&(this.map.infoWindow.hide(),this.addStop(new O(a.mapPoint)))})),this.map.addLayer(this._waypointsEventLayer),this._moveLayersToFront(),z.add(this._activateButtonNode,this._css.stopsPressedButtonClass),this.onActivate()):(this.map.removeLayer(this._waypointsEventLayer),z.remove(this._activateButtonNode,this._css.stopsPressedButtonClass),this.onDeactivate());
c(!b);this.emit("map-click-active",{mapClickActive:this.mapClickActive})},_activateBarrierTool:function(){this.get("barrierToolActive")?(this.map.activeDirectionsWidget&&this.map.activeDirectionsWidget!==this&&this.map.activeDirectionsWidget.deactivate(),this.map.activeDirectionsWidget=this,this.drawToolbar.activate(Ta.FREEHAND_POLYLINE),z.add(this._lineBarrierButtonNode,this._css.stopsPressedButtonClass),this.onActivateBarrierTool()):(this.drawToolbar.deactivate(),z.remove(this._lineBarrierButtonNode,
this._css.stopsPressedButtonClass),this.onDeactivateBarrierTool());this.emit("barrier-tool-active",{barrierToolActive:this.barrierToolActive})},_moveLayersToFront:function(){var a=this.get("map"),b=a.graphicsLayerIds.length-1;a.reorderLayer(this._routeLayer,b);a.reorderLayer(this._polygonBarriersLayer,b);a.reorderLayer(this._polylineBarriersLayer,b);a.reorderLayer(this._barriersLayer,b);a.reorderLayer(this._waypointsEventLayer,b);a.reorderLayer(this._stopLayer,b)},_destroyGeocoders:function(){for(;this.geocoders&&
this.geocoders.length;)this.geocoders[0]&&this.geocoders[0].destroy(),this.geocoders.splice(0,1);this.geocoders=[]},_disconnectEvents:function(){var a,b=this._clearDirections(!0);if(this._watchEvents&&this._watchEvents.length)for(a=0;a<this._watchEvents.length;a++)this._watchEvents[a].unwatch();if(this._onEvents&&this._onEvents.length)for(a=0;a<this._onEvents.length;a++)this._onEvents[a].remove();if(this._geocoderEvents)for(a=0;a<this._geocoderEvents.length;a++)this._geocoderEvents[a].value.unwatch(),
this._geocoderEvents[a].blur.remove(),this._geocoderEvents[a].select.remove(),this._geocoderEvents[a].suggest.remove();return this._onEvents=[],this._watchEvents=[],this._geocoderEvents=[],this._disconnectResults(),this._destroyGeocoders(),this._destroyGlobalGeocoder(),this._destroyDnD(),b},_getDirections:function(){var b=new L;return this._removeEmptyStops(),1<this._getStopCount()+this._getWaypointCount()&&this.loaded?(this.onDirectionsStart(),this.clearMessages(),this._dnd.sync(),this._sortGeocoders(),
this._getCandidates(this.stops).then(a.hitch(this,function(c){this.stops=c;this._setStops();this._configureRoute().always(a.hitch(this,function(a){b.resolve(a)}))}),a.hitch(this,function(a){this.set("directions",null);this._clearRouteGraphics();b.reject(a);this.onDirectionsFinish(a)}))):this._clearDirections(!0).always(a.hitch(this,function(){this.createRouteSymbols();b.reject(Error(this.loaded?E.widgets.directions.error.notEnoughStops:E.widgets.directions.error.notReady))})),b.promise},_clearDirections:function(){var a=
new L;return this._handle&&this._handle._remove(),this.get("routeParams")&&this.get("routeParams").stops?this.get("routeParams").stops.features.length?(this._clearBarriersGraphics(),this.get("routeParams").stops.features=[],this.onDirectionsClear(),a.resolve()):arguments.length?a.resolve():this._reset().then(a.resolve,a.reject):a.resolve(),this.set("directions",null),this._clearDisplayBeforeSolve(),this._clearDisplayAfterSolve(),this._routeLayer.clear(),this._waypointsEventLayer.clear(),this._stopLayer.clear(),
a.promise},_setTravelMode:function(a){var b,c=new L;b=this.serviceDescription;var d=function(){c.resolve(a)};if(b&&b.supportedTravelModes&&b.supportedTravelModes.length){var e=b.supportedTravelModes,f=!1;for(b=0;b<e.length;b++)if(e[b].name===a){f=!0;!this.routeParams.travelMode||this.routeParams.travelMode&&this.routeParams.travelMode.name!==a?(this.routeParams.travelMode=e[b].impedanceAttributeName?e[b]:e[b].itemId,this._checkStartTimeUIAvailability(),this._solveAndZoom().always(d)):d();this._travelModeSelector&&
this._travelModeSelector.domNode&&(this._travelModeSelector.domNode.title=e[b].description);break}f||c.reject(a)}else c.reject(a);return c.promise},_setDirectionsLengthUnits:function(a){this._clearDisplayBeforeSolve();var b=new L;return z.remove(this._useMilesNode,this._css.stopsPressedButtonClass),z.remove(this._useKilometersNode,this._css.stopsPressedButtonClass),a===S.KILOMETERS?z.add(this._useKilometersNode,this._css.stopsPressedButtonClass):a===S.MILES&&z.add(this._useMilesNode,this._css.stopsPressedButtonClass),
a===S.KILOMETERS||a===S.METERS||a===S.MILES||a===S.FEET||a===S.YARDS||a===S.NAUTICAL_MILES?(this.directionsLengthUnits=a,b.resolve(a)):b.reject(a),b.promise},_setDirectionsLanguage:function(a){this._clearDisplayBeforeSolve();var b=new L;return a=this._setDirectionsLanguageByLocale(a),this._solveAndZoom().always(function(){b.resolve(a)},b.reject),b.promise},_showLoadingSpinner:function(a){void 0===a&&(a=this._requestQueueTail&&!this._requestQueueTail.isFulfilled()||this._moveInProgress);a?(z.add(this._widgetContainer,
this._css.resultsLoadingClass),z.add(this._resultsNode,"esriRoutesContainerBusy")):(z.remove(this._widgetContainer,this._css.resultsLoadingClass),z.remove(this._resultsNode,"esriRoutesContainerBusy"))},_enqueue:function(b,c){var d=new L;return this._requestQueueTail||(this._requestQueueTail=new L,this._requestQueueTail.resolve()),this._requestQueueTail.promise.always(a.hitch(this,function(){try{a.mixin(this,{_incrementalSolveStopRange:null},c);var e=b.call(this);e&&"object"==typeof e&&e.hasOwnProperty("isFulfilled")?
e.then(a.hitch(this,function(a){d.resolve(a);this._showLoadingSpinner()}),a.hitch(this,function(a){d.reject(a);this._showLoadingSpinner()})):(d.resolve(e),this._showLoadingSpinner())}catch(Ra){d.reject(Ra),this._showLoadingSpinner()}})),this._requestQueueTail=d,this._showLoadingSpinner(),d.promise},_createDnD:function(){this._dnd=new M(this._dndNode,{skipForm:!0,withHandles:!0})},_destroyDnD:function(){I.empty(this._dndNode);this._dnd&&(this._dnd.destroy(),this._dnd=null)},_createDepartAtControls:function(){if(this._departAtTime)this.map&&
(this.map.timeExtent=null),this._useTrafficItemNode.title=E.widgets.directions.trafficLabelLive,z.remove(this._departAtContainer,"departAtContainerVisible"),this.startTime="now",this._updateStartTimeUI();else{var b=this,d=function(){this._keepDirections||b._clearDisplayBeforeSolve();this._keepDirections=!1},e=a.hitch(this,function(){this.map&&this.map.disableKeyboardNavigation()}),f=a.hitch(this,function(){this.map&&this.map.enableKeyboardNavigation()});this._departAtTime=new n({required:!0,value:new Date,
onChange:d,onFocus:e,onBlur:f},this._departAtTimeContainer);this._departAtDate=new c({required:!0,value:new Date,onChange:d,onFocus:e,onBlur:f,constraints:{min:new Date(864E5)}},this._departAtDateContainer)}},_setStartTime:function(a,b,c){if(isNaN(c))this.startTime="now";else{b=c instanceof Date?c:new Date(c);c=this.directions&&this.directions.features&&this.directions.features[0]&&this.directions.features[0].attributes;var d=6E4*-b.getTimezoneOffset();b=new Date(b-d+(c&&c.arriveTimeUTC?c.ETA-c.arriveTimeUTC:
d));this._departAtTime._keepDirections=!a;this._departAtDate._keepDirections=!a;this._departAtTime.setValue(b);this._departAtDate.setValue(b)}this._updateStartTimeUI()},_checkStartTimeUIAvailability:function(){var a=this._getImpedanceAttribute(),a=this._isTimeUnits(a?a.units:"");this._startTimeButtonNode.disabled=!a;z[a?"remove":"add"].apply(this,[this._startTimeButtonNodeContainer,"esriLinkButtonDisabled"]);z[a?"remove":"add"].apply(this,[this._startTimeDDLArrow,"esriDirectionsDDLArrowDisabled"]);
a||this.set("startTime","now")},_usingAGOL:function(a){return a||(a=this.routeTaskUrl),-1<a.search(/^(https?:)*\/\/*[^.]*\.arcgis\.com.*$/i)},_usingRouteAGOL:function(){return-1<this.get("routeTaskUrl").search(/^(https?:)*\/\/route*[^.]*\.arcgis\.com.*$/i)},_setSearchOptions:function(){var b={map:this.get("map"),autoNavigate:!1,enableInfoWindow:!1,enableHighlight:!1,enableSourcesMenu:!1};this.searchOptions=a.mixin({maxResults:1,locationToAddressDistance:100},this.defaults.searchOptions,b)},_setDefaultUnits:function(){if(!this.get("directionsLengthUnits")){var a=
"EN-US"===f.locale.toUpperCase()?S.MILES:S.KILOMETERS;this.defaults.directionsLengthUnits?a=this.defaults.directionsLengthUnits:this.userOptions.routeParams&&this.userOptions.routeParams.directionsLengthUnits&&(a=this.userOptions.routeParams.directionsLengthUnits);this.set("directionsLengthUnits",a)}this._setDirectionsLengthUnits(this.directionsLengthUnits)},_setTrafficOptions:function(){this._usingRouteAGOL()&&!this.trafficLayer&&(this.trafficLayer=new X(Oa+"//traffic.arcgis.com/arcgis/rest/services/World/Traffic/MapServer",
{opacity:.4}));this.trafficLayer&&this.trafficLayer.url&&this._usingAGOL(this.trafficLayer.url)&&(this._trafficAvailabilityButton.style.display="inline-block");this.set("showTrafficOption",(this.defaults.showTrafficOption||!this.defaults.hasOwnProperty("showTrafficOption"))&&this.trafficLayer);this._optionsMenu()},_updateCanModifyStops:function(a,b){this.canModifyStops||this.canModifyWaypoints||this.set("mapClickActive",!1);b||!this.canModifyStops||this.canModifyWaypoints||this.set("mapClickActive",
!0);this._showAddDestination();this._showMapClickActiveButton();this._stopsTableCover.style.display=this.canModifyStops?"none":"inline"},_updateCanAddWaypoints:function(a,b){this.canModifyStops||this.canModifyWaypoints||this.set("mapClickActive",!1);b||this.canModifyStops||!this.canModifyWaypoints||this.set("mapClickActive",!0);this._showMapClickActiveButton();this._handle._remove()},_updateStartTimeUI:function(){isNaN(this.startTime)?(this._startTimeButtonLabel.innerHTML=this._i18n.widgets.directions.leaveNow,
z.remove(this._startTimeButtonNodeContainer,"departAtButton"),z.remove(this._departAtContainer,"departAtContainerVisible")):(z.add(this._startTimeButtonNodeContainer,"departAtButton"),z.add(this._departAtContainer,"departAtContainerVisible"),this._startTimeButtonLabel.innerHTML=this._i18n.widgets.directions.departAt)},_setWidgetProperties:function(){this._disconnectEvents();this.set(this.defaults);this.routeLayer=a.clone(this.defaults.routeLayer);this._folderSelector&&(this._outputLayer.setValue(""),
this._outputLayer.set("disabled",!0),this._folderSelector.set("disabled",!0));this.set("stops",[]);this._updateCanModifyStops()},_updateStops:function(b){var c=new L;return b?this.get("loaded")?this._reset().then(a.hitch(this,function(){this._addStops(b).then(c.resolve,c.reject)}),c.reject):this._addStops(b).then(c.resolve,c.reject):c.reject(),c.promise},_removeStop:function(b,c,d,e){var f=new L,g=a.hitch(this,function(a){this.stops.splice(a,1);var b=this._dnd.getAllNodes()[a],c=this.get("geocoders");
this._geocoderEvents[b.id]&&(this._geocoderEvents[b.id].blur.remove(),this._geocoderEvents[b.id].select.remove(),this._geocoderEvents[b.id].suggest.remove(),this._geocoderEvents[b.id].value.unwatch());c[a].destroy();c.splice(a,1);this.set("geocoders",c);I.destroy(b);this._dnd.sync();this._stopsRemovable();this._optionsMenu();this._checkMaxStops();this.setListIcons();this._sortGeocoders()});(0>b||b>=this.stops.length||void 0===b)&&(b=this.stops.length-1);var h=!1;for(e=this.stopGraphics[b]&&this._isStopAWaypoint(this.stops[b])||
e;!h;)g(b),e?h=!0:(b-=0>=b||b<this.stops.length&&this._isStopAWaypoint(this.stops[b])?0:1,h=!this._isStopAWaypoint(this.stops[b]));for(;this.stops.length-this._getWaypointCount()<this.minStops;)this._addStop();return this._clearStopsStatusAttr(),this._setStops(),this.createRouteSymbols(),d?(this._clearDisplayBeforeSolve(),this._clearDisplayAfterSolve(),this.createRouteSymbols(),f.resolve()):this._solveAndZoom(c).then(f.resolve,f.reject),f.promise},_removeTrafficLayer:function(){this.trafficLayer&&
this.map&&this.map.removeLayer(this.trafficLayer);this._trafficLayerAdded=!1},_addStops:function(b,c){var d=new L,e=[],f=this.autoSolve;this.autoSolve=!1;void 0===c&&(c=this._getStopCount());for(var g=0;g<Math.min(b.length,this.maxStops-this._getStopCount());g++){var h=new L;this._addStop(b[g],c+g,!0).always(h.resolve);e.push(h)}return J(e).always(a.hitch(this,function(){this.autoSolve=f;this._getDirections().always(function(){d.resolve(b)})})),d.promise},_addStop:function(b,c,d){var e=new L;return this._checkMaxStops(),
this.maxStopsReached?(this._showMessage(E.widgets.directions.error.maximumStops),e.reject(Error(E.widgets.directions.error.maximumStops))):(void 0===b&&void 0===c&&(c=this.stops.length),b instanceof O&&b.attributes&&b.attributes.isWaypoint&&(!c||c===this.stops.length||2>this._getStopCount())&&!d?(this._showMessage(E.widgets.directions.error.waypointShouldBeInBetweenStops),e.reject(Error(E.widgets.directions.error.waypointShouldBeInBetweenStops))):this._getCandidate(b).then(a.hitch(this,function(a){this._insertStop(a,
c);this.autoSolve&&""!==a.name?this._getDirections().always(function(){e.resolve(a,c)}):e.resolve(a,c)}),a.hitch(this,function(a){e.reject(a)}))),e.promise},_removeEmptyStops:function(){for(var a=0,b=this.stops.length-this._getWaypointCount()-this.minStops;a<this.stops.length&&0<b;)this.stops[a]&&this.stops[a].name?a++:(this._removeStop(a,!0,!0,!0),b--,this._moveInProgress&&this._handle._index>=a&&this._handle._isStopIcon&&this._handle._index--)},_setReverseGeocode:function(b,c,d){if(b.feature.geometry&&
-1<d){var e={address:b.name};this.stopGraphics[d]&&(a.mixin(this.stopGraphics[d].attributes,e),this.stopGraphics[d].setGeometry(c));this.textGraphics[d]&&(a.mixin(this.textGraphics[d].attributes,e),this.textGraphics[d].setGeometry(c));this.set("stopGraphics",this.stopGraphics);this.set("textGraphics",this.textGraphics);e=this.geocoders[d];return e&&e.inputNode&&(e.value=b.name,e.inputNode.value=b.name),a.mixin(b.feature.attributes,this.stops[d].feature.attributes),this.stops[d]=b,this.stops[d].feature.setGeometry(c),
this._setStops(),this._enqueue(function(){return this._getDirections()})}},_insertStop:function(a,b){var c,d;if(void 0===b)for(c=0;c<this.geocoders.length;c++){if(!this.geocoders[c].get("value")){d=this.geocoders[c];break}}else c=b,this.geocoders[c]&&!this.geocoders[c].get("value")&&(d=this.geocoders[c]);!d||void 0!==b&&b!==c||this._isStopAWaypoint(a)?(void 0===b&&(b=this.geocoders.length),this.stops.splice(b,0,a),this._createGeocoder(a,b)):(this.stops[c]=a,d.set("value",a.name),d._stopReference=
a);this._optionsMenu()},_createGeocoder:function(c,d){var e=this._dnd.getAllNodes(),f=!1,g=!1,h=e.length;e[d]?(g=e[d],f=!0):(g=!1,f=!1);var l=a.hitch(this,function(a,b){var c=b?this._css.stopDnDHandleClass:this._css.stopDnDHandleClassHidden,d=b?this._css.stopDnDHandleClassHidden:this._css.stopDnDHandleClass;z.replace(a.children[0],c,d);2<this.geocoders.length&&(c=b?this._css.stopIconRemoveClass:this._css.stopIconRemoveClassHidden,d=b?this._css.stopIconRemoveClassHidden:this._css.stopIconRemoveClass,
z.replace(a.children[3].children[0],c,d))}),m=I.create("tr",{className:this._css.stopClass,style:this._isStopAWaypoint(c)?"display:none;":"",onmouseover:function(){l(this,!0)},onmouseout:function(){l(this,!1)}});I.create("td",{className:this._css.stopDnDHandleClassHidden+" dojoDndHandle"},m);e=I.create("td",{className:this._css.stopIconColumnClass},m);I.create("div",{className:this._css.stopIconClass+" dojoDndHandle",innerHTML:this._getLetter(h),"data-center-at":"true"},e);h=I.create("td",{className:this._css.esriStopGeocoderColumnClass},
m);h=I.create("div",{},h);e=I.create("td",{className:this._css.stopIconRemoveColumnClass},m);I.create("div",{className:this._css.stopIconRemoveClassHidden,role:"button","data-remove":"true"},e);this._dnd.insertNodes(!1,[m],f,g);var f=a.mixin({},this.get("searchOptions"),{value:c.name,activeSourceIndex:this._globalGeocoder.activeSourceIndex}),k=new G(f,h),n=a.hitch(this,function(a,c){this._enqueue(function(){if(c!==a&&k._stopReference&&k._stopReference.name!==c){var d=b.indexOf(this.stops,k._stopReference);
this.stops[d]={name:c};this._handle._remove();this._removeSomeWaypoints(this._markWPsForRemovalAfterUserChangedStopSequence(d));this._setStops();this._clearDisplayBeforeSolve();this._clearDisplayAfterSolve();this.createRouteSymbols()}})});k._tr=m;k._stopReference=c;k.startup();this.geocoders.splice(d,0,k);this._geocoderEvents[m.id]={blur:k.on("blur",function(){""!==this.value&&this._stopReference&&!this._stopReference.feature&&this.search()}),select:k.on("select-result",a.hitch(this,function(a){var c=
!0;if(a&&(a.results||a.result)){var d=this._dnd.getAllNodes(),d=b.indexOf(d,m),e=k.value,f=a.results&&a.results.results&&a.results.results.length?a.results.results[0]:a.result;f?(f.name=e,this.stops[d]=this._toPointGeometry(f),this.geocoders[d]._stopReference=this.stops[d],n("",e)):(this.removeStop(d),this.set("directions",null),this._showMessage(E.widgets.directions.error.unknownStop.replace("\x3cname\x3e",a.target.get("value"))),this._clearRouteGraphics(),c=!1);c&&this.getDirections()}})),suggest:k.on("suggest-results",
function(){if(document.activeElement===this.inputNode)for(var a=C("LI[role\x3d'menuitem']",this.suggestionsNode),b=0;b<a.length;b++)B.set(a[b],"tabindex",-1);else this._hideSuggestionsMenu()}),value:k.watch("value",function(a,b,c){n(b,c)})};this._checkMaxStops();this.setListIcons();this._stopsRemovable();this._optionsMenu();this._sortGeocoders()},_blurGeocoders:function(){if(document.activeElement)for(var a=0;a<this.geocoders.length;a++)if(this.geocoders[a].inputNode===document.activeElement){this.geocoders[a]._hideSuggestionsMenu();
this.geocoders[a].inputNode.blur();1<this._getStopCount()+this._getWaypointCount()&&this.getDirections(!0);break}},_decorateEmptyAGOLGeocoderResponse:function(a){return a&&", , "===a.name&&(a.feature&&a.feature.attributes&&a.feature.attributes.Match_addr?a.name=a.feature.attributes.Match_addr+("POI"===a.feature.attributes.Addr_type&&a.feature.attributes.City&&-1===a.feature.attributes.Match_addr.indexOf(a.feature.attributes.City)?", "+a.feature.attributes.City:""):a.name=""),a},_toPointGeometry:function(a){var b=
a.feature.geometry;b&&(b.getCentroid?a.feature.geometry=b.getCentroid():b.getExtent&&(b=b.getExtent())&&(a.feature.geometry=b.getCenter()));return a},_removeLocateButtonVisibilityEvents:function(){for(var a=0;a<this.geocoders.length;a++){var b=this.geocoders[a];b._onMouseEnter&&b._onMouseEnter.remove();b._onMouseOut&&b._onMouseOut.remove();b._onKeyPress&&b._onKeyPress.remove();b._locateButton&&(b._locateButton._onMouseEnter&&b._locateButton._onMouseEnter.remove(),b._locateButton._onMouseOut&&b._locateButton._onMouseOut.remove())}},
_setLocateButtonVisibilityEvents:function(){this._removeLocateButtonVisibilityEvents();for(var b=this,c=function(a){a instanceof FocusEvent?this._geocoder._lbShown_f=!0:this._geocoder._lbShown_g=!0;b._createLocateButton(this._geocoder,!0)},d=function(c){c instanceof FocusEvent?this._geocoder._lbShown_f=!1:this._geocoder._lbShown_g=!1;clearTimeout(this._destroyTimeout);this._destroyTimeout=setTimeout(a.hitch(this,function(){this._geocoder._lbShown_lb||this._geocoder._lbShown_f||b._destroyLocateButton(this._locateButton)}),
400)},e=function(){this._geocoder._lbShown_g=!0;clearTimeout(this._destroyTimeout);this._destroyTimeout=setTimeout(a.hitch(this,function(){""===this.value?b._createLocateButton(this._geocoder,!0):b._destroyLocateButton(this._locateButton)}),400)},f=function(){this._geocoder._lbShown_lb=!0;clearTimeout(this._geocoder._destroyTimeout)},g=function(){this._geocoder._lbShown_lb=!1;clearTimeout(this._geocoder._destroyTimeout);this._geocoder._destroyTimeout=setTimeout(a.hitch(this,function(){this._geocoder._lbShown_g||
this._geocoder._lbShown_f||b._destroyLocateButton(this._geocoder.inputNode._locateButton)}),400)},h=0;h<this.geocoders.length;h++){var l=this.geocoders[h];l&&l.inputNode&&(l.inputNode._geocoder=l,l._onMouseEnter=u(l.inputNode,w.enter,c),l._onMouseOut=u(l.inputNode,[w.leave,"blur"],d),l._onKeyPress=u(l.inputNode,"keydown",e),l.inputNode._locateButton)&&(l=l.inputNode._locateButton,l._onMouseEnter=u(l.domNode,w.enter,f),l._onMouseOut=u(l.domNode,w.leave,g))}},_createLocateButton:function(c,d,e){var f=
new L;return c.inputNode._locateButton&&c.inputNode._locateButton._locating?f.resolve():h(["./LocateButton"],a.hitch(this,function(g){if(this._destroyLocateButton(c.inputNode._locateButton),c&&!this._solveInProgress){var h=I.create("div",{},c.domNode);z.add(c.domNode,this._css.stopsInnerGeocoderClass);var m=new g({map:this.map,highlightLocation:!1,centerAt:!1,setScale:!1,useTracking:!1},h);m.startup();c.inputNode._locateButton=m;m.domNode._geocoder=c;this._setLocateButtonVisibilityEvents();g=a.hitch(this,
function(){m._locating=!0;c.set("value","");c.inputNode.placeholder=E.widgets.directions.retrievingMyLocation.toUpperCase()});m._onBeforeLocate=u(m._locateNode,l,g);m._onLocate=u(m,"locate",a.hitch(this,function(e){m._locating=!1;e.graphic?(d&&this._destroyLocateButton(c.inputNode._locateButton),this.updateStop(new O(e.graphic.geometry),b.indexOf(this.geocoders,c)).then(a.hitch(this,function(){1<this.stopGraphics.length?this.getDirections().always(function(){f.resolve(e)}):f.resolve(e)}))):(c.set("value",
""),c.inputNode.placeholder=E.widgets.directions.myLocationError.toUpperCase(),console.error(e.error),f.reject(e.error))}));e?(g(),m.locate().then(null,f.reject)):f.resolve()}else f.resolve()})),f.promise},_destroyLocateButton:function(b){if(b){var c=b.domNode._geocoder;clearTimeout(c._destroyTimeout);b._locating?c._destroyTimeout=setTimeout(a.hitch(this,function(){c._lbShown_lb||c._lbShown_f||this._destroyLocateButton(b)}),100):(b.clear(),b._onBeforeLocate.remove(),b._onLocate.remove(),b._onMouseEnter&&
b._onMouseEnter.remove(),b._onMouseOut&&b._onMouseOut.remove(),b.destroy(),c.inputNode&&(c.inputNode._locateButton=null,c._setPlaceholder(c.activeSourceIndex)))}},_sortStops:function(){this.stops.length&&(this.stops.sort(a.hitch(this,function(a,b){for(var c,d,e=0;e<this.get("geocoders").length;e++)this.geocoders[e]._stopReference===a?c=e:this.geocoders[e]._stopReference===b&&(d=e);return c>d?1:d>c?-1:0})),this._setStops())},_getCandidate:function(b){var c=new L,d=typeof b;b?"object"===d&&b.hasOwnProperty("feature")&&
b.hasOwnProperty("name")?(b.feature.attributes&&void 0!==b.feature.attributes.displayName&&!this._isStopAWaypoint(b)&&(b.name=b.feature.attributes.displayName,b.feature.attributes.Name=this._userDefinedStopName),b.name=this._isStopAWaypoint(b)?this._waypointName:String(b.name),"point"!==b.feature.geometry.type&&(b.feature.geometry=new la([b.feature.geometry.x,b.feature.geometry.y],this.map.spatialReference)),c.resolve(b)):"object"===d&&b.hasOwnProperty("address")&&b.hasOwnProperty("location")?(b=
this._globalGeocoder._hydrateResult(b),c.resolve(b)):"object"!==d||!b.hasOwnProperty("name")||null!==b.name&&""!==b.name?b instanceof O&&b.attributes&&(void 0!==b.attributes.Name||b.attributes.isWaypoint)?(d=this._addStopWrapperToGraphic(b,b.attributes.isWaypoint?this._waypointName:String(b.attributes.Name)),String(b.attributes.Name)&&(d.feature.attributes.Name=this._userDefinedStopName),c.resolve(d)):("object"===d&&b.hasOwnProperty("name")&&(b=String(b.name)),this._reverseGeocode(b).then(c.resolve,
c.reject)):c.resolve(a.clone(this._emptyStop)):c.resolve(a.clone(this._emptyStop));return c.promise},_reverseGeocode:function(b){var c,d=new L,e=b.geometry?b.geometry:b;if(this._globalGeocoder){var f=a.hitch(this,function(a){var b=new L,c=500;if(this.map){var d=this.map.toScreen(e);(d.x+=ga._calculateClickTolerance([a]),this.map.spatialReference.isWebMercator())?(c=Math.abs(this.map.toMap(d).x-e.x),b.resolve(c)):4326===this.map.spatialReference.wkid?(c=Math.abs(V.geographicToWebMercator(this.map.toMap(d)).x-
V.geographicToWebMercator(e).x),b.resolve(c)):this._geometryService&&(a=new Ia,a.distanceUnit=Ha.UNIT_METER,a.geometry1=e,a.geometry2=this.map.toMap(d),this._geometryService.distance(a,function(a){c=a;b.resolve(c)},function(){b.resolve(c)}))}return b.promise}),g=[],h=this._globalGeocoder.sources,l=function(){h[c].featureLayer&&g.push(f(h[c].featureLayer).then(a.hitch(h[c],function(b){this.searchQueryParams=a.mixin(this.searchQueryParams,{distance:b})})))};if("all"===this._globalGeocoder.activeSourceIndex)for(c=
0;c<h.length;c++)l();else c=this._globalGeocoder.activeSourceIndex,l();J(g).always(a.hitch(this,function(){this._globalGeocoder.search(e).then(a.hitch(this,function(a){var f=!1;if(a){var g,h=null;for(c=0;c<this._globalGeocoder.sources.length;c++)if(a[c]&&a[c].length){g=a[c];break}if(g.length&&(f=!0,h=g[0],this._globalGeocoder.sources[c].featureLayer))for(a=Number.POSITIVE_INFINITY,c=0;c<g.length;c++){g[c]=this._toPointGeometry(g[c]);var l=da.geodesicLengths([new ta({paths:[[V.xyToLngLat(e.x,e.y),
V.xyToLngLat(g[c].feature.geometry.x,g[c].feature.geometry.y)]],spatialReference:{wkid:this.map.spatialReference.wkid}})],"esriMeters")[0];a>l&&(a=l,h=g[c])}(h=this._decorateEmptyAGOLGeocoderResponse(h))&&""!==h.name&&null!==h.name&&void 0!==h.name?(h.name=String(h.name),isNaN(e.x)||isNaN(e.y)||this.map.spatialReference.wkid!==e.spatialReference.wkid?!h.feature.geometry||isNaN(h.feature.geometry.x)||isNaN(h.feature.geometry.y)?(this._showMessage(E.widgets.directions.error.locator),d.reject(Error(E.widgets.directions.error.locator))):
d.resolve(h):(h.feature.geometry=e,d.resolve(h))):f=!1}f||(b instanceof la?b=new O(b):b instanceof Array&&(b=new O(new la(b[0],b[1]))),b instanceof O?this._decorateUngeocodedStop(b).then(d.resolve,d.reject):(this._showMessage(E.widgets.directions.error.unknownStop.replace("\x3cname\x3e",b.toString())),d.reject(Error(E.widgets.directions.error.unknownStop.replace("\x3cname\x3e",b.toString())))))}))}))}else this._showMessage(E.widgets.directions.error.locatorUndefined),d.reject(Error(E.widgets.directions.error.locatorUndefined));
return d.promise},_updateStop:function(b,c,d){var e=new L;return this.stops&&this.stops[c]?b instanceof O&&b.attributes&&b.attributes.isWaypoint&&(!c||c===this.stops.length-1||2>this._getStopCount())?(this._showMessage(E.widgets.directions.error.waypointShouldBeInBetweenStops),e.reject(Error(E.widgets.directions.error.waypointShouldBeInBetweenStops))):this._getCandidate(b).then(a.hitch(this,function(a){var b=a.feature,b=b?b.geometry:null,f=this.stops[c].feature,f=f?f.geometry:null,b=b&&f&&(b.x!==
f.x||b.y!==f.y)||!b&&f;this.stops[c]=a;this.geocoders[c]||this._createGeocoder(a,c);f=this.geocoders[c];f._stopReference=a;f._tr.style.display=this._isStopAWaypoint(a)?"none":"";f.value=a.name;f.inputNode&&(f.inputNode.value=a.name);b&&this.autoSolve&&1<this._getStopCount()+this._getWaypointCount()||d?this._getDirections().then(e.resolve,e.reject):(this._setStops(),e.resolve(a))}),a.hitch(this,function(a){e.reject(a)})):(this._showMessage(E.widgets.directions.error.couldNotUpdateStop),e.reject(Error(E.widgets.directions.error.couldNotUpdateStop))),
this._optionsMenu(),e.promise},_renderDirections:function(){var c=this.get("directions"),d;this._resultsNode&&(d=""+('\x3cdiv class\x3d"'+this._css.clearClass+'"\x3e\x3c/div\x3e'),d+=this._renderDirectionsSummary(c),d+='\x3cdiv class\x3d"'+this._css.clearClass+'"\x3e\x3c/div\x3e',d+='\x3cdiv class\x3d"'+this._css.routesClass+'"\x3e',d+=this._renderDirectionsTable(c),d+="\x3cdiv class\x3d'esriPrintFooter'\x3e"+E.widgets.directions.printDisclaimer+"\x3c/div\x3e",this._resultsNode&&(this._resultsNode.innerHTML=
d+"\x3c/div\x3e"),this._disconnectResults(),(c=C("[data-segment]",this._resultsNode))&&c.length&&b.forEach(c,a.hitch(this,function(b){this._resultEvents.push(u(b,w.enter,a.hitch(this,function(){if(!this._focusedDirectionsItem){var a=parseInt(B.get(b,"data-segment"),10);this.highlightSegment(a)}})));this._resultEvents.push(u(b,"focusout",a.hitch(this,function(){this._focusedDirectionsItem=null;this.unhighlightSegment(!0)})));this._resultEvents.push(u(b,w.leave,this.unhighlightSegment));this._resultEvents.push(u(b,
"click, keydown",a.hitch(this,function(a){a&&("click"===a.type||"keydown"===a.type&&a.keyCode===r.ENTER)&&(this._focusedDirectionsItem!==b?this.selectSegment(parseInt(B.get(b,"data-segment"),10)):(b.blur(),this.map.infoWindow.hide(),this._focusedDirectionsItem=null,this.unhighlightSegment(!0)))})))})))},_renderDirectionsSummary:function(a){var b="";if(a.totalLength||a.totalTime){var c={},d=this._getImpedanceAttribute();if(b+="\x3cdiv class\x3d'"+this._css.resultsSummaryClass+"' data-full-route\x3d'true'\x3e\x3cdiv class\x3d'esriImpedanceCost'\x3e",
this._isTimeUnits(d.units)){for(var e=this._getCostAttribute(d.timeNeutralAttributeName)||{},f=0,g=0,h=this.get("stops"),l=h.length-1;0<=l;l--)if(null!==h[l].feature.attributes.ArriveCurbApproach){c=h[l].feature.attributes;break}for(var m in c)c.hasOwnProperty(m)&&(m==="Cumul_"+d.name&&(f=c[m]),m==="Cumul_"+e.name&&(g=c[m]));c="esriTrafficLabelHidden";h=E.widgets.directions.noTraffic;l=a.totalTime-a.totalDriveTime;l=(g-this._convertCostValue(l,d.units,e.units))/(f-l||1);0<l&&.8>l?(c="esriTrafficLabelHeavy",
h=E.widgets.directions.heavyTraffic):1===l?(c="esriTrafficLabelNone",h=E.widgets.directions.noTraffic):1.25<l&&(c="esriTrafficLabelLight",h=E.widgets.directions.ligthTraffic);e=this._formatTime(g,!1,e.units);b+=this._formatTime(f,!0,d.units)+"\x3cdiv class\x3d'esriImpedanceCostHrMin'\x3e\x3cdiv class\x3d'esriImpedanceCostHr'\x3e"+E.widgets.directions.time.hr+"\x3c/div\x3e\x3cdiv class\x3d'esriImpedanceCostMin'\x3e"+E.widgets.directions.time.min+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'esriOtherCosts'\x3e"+
(g?"\x3cdiv class\x3d'esriTrafficLabel "+c+"'\x3e"+h+"\x3c/div\x3e"+(1!==l&&e?e+" "+E.widgets.directions.onAverage+"\x3cbr\x3e":""):"")+this._formatDistance(a.totalLength)}else d=(d=E.widgets.directions.units[this.directionsLengthUnits])?d.name:"",b+=D.format(a.totalLength,{places:1})+"\x3cdiv class\x3d'esriImpedanceCostDist'\x3e"+d+"\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'esriOtherCosts'\x3e"+this._formatTime(a.totalTime);b+="\x3c/div\x3e\x3c/div\x3e"}return b},_renderDirectionsTable:function(a){for(var b=
0,c=0,d=0,e='\x3ctable summary\x3d"'+a.routeName+'"\x3e\x3ctbody role\x3d"menu"\x3e',f=0;f<a.features.length;f++){var g=a.features[f].attributes;"esriDMTDepart"===g.maneuverType&&(d=0,c=0);d+=g.length;c+=g.time;b+=g.time;e+=this._renderDirectionsItemTR(a.features[f],d,c,b)}return e+="\x3c/tbody\x3e\x3c/table\x3e"},_renderDirectionsItemTR:function(a,c,d,e){var f=this.directions,g=f?b.indexOf(f.features,a):-1;e="";var h=this._css.routeClass,l=a._associatedStopWithReturnToStart&&a._associatedStopWithReturnToStart.attributes,
m=a.attributes;if(-1<g){m&&(m.step=g+1);m.maneuverType&&(h+=" "+m.maneuverType);l&&null===l.ArriveCurbApproach&&null!==l.DepartCurbApproach?h+=" "+this._css.routeOriginClass:l&&null!==l.ArriveCurbApproach&&null===l.DepartCurbApproach&&(h+=" "+this._css.routeDestinationClass+" "+this._css.routeLastClass);e+='\x3ctr tabindex\x3d"0" role\x3d"menuitem" class\x3d"'+h+" "+this._css.routeZoomClass+'" data-segment\x3d"'+g+'"\x3e';e+='\x3ctd class\x3d"'+this._css.routeIconColumnClass+'"\x3e';e+='\x3cdiv class\x3d"'+
this._css.routeIconClass+'"\x3e';e+=this._getLetter(a._associatedStop);e=e+"\x3c/div\x3e\x3c/td\x3e"+('\x3ctd class\x3d"'+this._css.routeTextColumnClass+'"\x3e');e+='\x3cdiv class\x3d"'+this._css.routeInfoClass+'"\x3e';e+='\x3cdiv class\x3d"'+this._css.routeTextClass+'"\x3e';f=(f.strings[g]||[]).slice();if("esriDMTDepart"===m.maneuverType||"esriDMTStop"===m.maneuverType)for(a=0;a<this.stops.length;a++)this.stops[a]&&this.stops[a].name&&f.push({string:this.stops[a].name});if(f){h=m.text;for(a=0;a<
f.length;a++)h=this._boldText(h,f[a].string);m.formattedText=h}else m.formattedText=m.text;if("esriDMTStop"===m.maneuverType&&(c||d)||"esriDMTDepart"===m.maneuverType&&0===g)c=this._formatDistance(c-m.length,!0),d=this._formatTime(d-m.time),g=this._formatTime(m.time),a=this._formatDistance(m.length,!0),m.formattedText+="\x3cdiv class\x3d'esriRouteTextColumnCumulative'\x3e"+c+(c&&d?" \x26middot; ":"")+d+(c||d?"\x3cbr\x3e":"")+(g?E.widgets.directions.serviceTime+":\x26nbsp;"+g:"")+(g&&a?"\x3cbr\x3e":
"")+(a?E.widgets.directions.serviceDistance+":\x26nbsp;"+a:"")+"\x3c/div\x3e";e+="\x3cstrong\x3e"+D.format(m.step)+".\x3c/strong\x3e "+m.formattedText;e+="\x3c/div\x3e";c=this._formatDistance(m.length,!0);d=this._formatTime(m.time);"esriDMTStop"!==m.maneuverType&&"esriDMTDepart"!==m.maneuverType||!this.routeParams.startTime||-22091616E5===m.ETA?c&&(e+='\x3cdiv class\x3d"'+this._css.routeLengthClass+'"\x3e',e+=c,d&&(e+="\x26nbsp;\x26middot;\x3cwbr\x3e\x26nbsp;"+d),e+="\x3c/div\x3e"):e+='\x3cdiv class\x3d"'+
this._css.routeLengthClass+'"\x3e'+this._toSpatiallyLocalTimeString(m.arriveTimeUTC,m.ETA)+"\x3c/div\x3e";e+="\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e"}return e},_toSpatiallyLocalTimeString:function(a,b){var c=new Date(b),d=new Date(c.getTime()+6E4*c.getTimezoneOffset()),d=f.date.locale.format(d,{selector:"time"}),e="";a?(e=(b-a)/1E3/60/60,c=Math.floor(e),e=60*(e-c),c=E.widgets.directions.GMT+(0>c?"":"+")+D.format(c,{pattern:"00"})+D.format(e,{pattern:"00"}),e=d+" "+c):e="now"===this.startTime?f.date.locale.format(c,
{selector:"time"}):d;return e},_addStopWrapperToGraphic:function(a,b){return{extent:new Aa({xmin:a.geometry.x-.25,ymin:a.geometry.y-.25,xmax:a.geometry.x+.25,ymax:a.geometry.y+.25,spatialReference:a.geometry.spatialReference}),feature:a,name:b}},_clearBarriersGraphics:function(){this._barriersLayer.clear();this._polylineBarriersLayer.clear();this._polygonBarriersLayer.clear()},_showBarriers:function(){this._clearBarriersGraphics();var c=this.routeParams,d=c.polylineBarriers&&c.polylineBarriers.features||
[],e=c.polygonBarriers&&c.polygonBarriers.features||[];b.forEach(c.barriers&&c.barriers.features||[],a.hitch(this,function(a){this._barriersLayer.add(a)}));b.forEach(d,a.hitch(this,function(a){this._polylineBarriersLayer.add(a)}));b.forEach(e,a.hitch(this,function(a){this._polygonBarriersLayer.add(a)}))},_showRoute:function(a){this._clearDisplayAfterSolve();var b=a.routeResults[0].directions,c=new L;if(b){this.set("solveResult",a);this.set("directions",b);var d,e,f=a.routeResults[0].stops;if(f&&f.length){var g=
[];for(d=0;d<f.length;d++){var h=f[d];h.attributes.isWaypoint=h.attributes.Name===this._waypointName||h.attributes.isWaypoint;h=this._addStopWrapperToGraphic(h,h.attributes.Name);this.stops[d]&&this.stops[d].feature&&this.stops[d].feature.attributes&&this.stops[d].feature.attributes.Name===this._userDefinedStopName&&(h.feature.attributes.Name=this._userDefinedStopName);this._returnToStartStop&&this._returnToStartStop._resultsStopIndex===d?this._returnToStartStop=h:g.push(h)}if(this.stops.length>g.length)for(d=
0;d<this.stops.length;d++)this.stops[d].feature||""!==this.stops[d].name||g.splice(d,0,this._emptyStop);this.stops=g;for(d=0;d<this.stops.length;d++)this._updateStop(this.stops[d],d);this._setStops();this._setMenuNodeValues()}this.set("mergedRouteGraphic",new O(b.mergedGeometry,this.get("routeSymbol")));f=[];g=[];for(d=h=0;d<b.featuresWithWaypoints.length;d++){var l=b.featuresWithWaypoints[d];if("esriDMTDepart"===l.attributes.maneuverType)for(e=0;e<this.stops.length;e++)if(this.stops[e].feature===
l._associatedStop){h=e+1;break}l.setSymbol(this.get("routeSymbol"));this._routeLayer.add(l);f.push(l);(e=l.getDojoShape())&&e.moveToBack();e=new O(l.geometry,this._symbolEventPaddingDirections,l.attributes);if(e._nextStopIndex=h-.5,e._isSnapFeature=!0,l._associatedSnapFeature=e,this._waypointsEventLayer.add(e),"esriDMTDepart"!==l.attributes.maneuverType)if(e=l.geometry.getPoint(0,0))e=new O(e,this.maneuverSymbol),e._directionsFeature=l._associatedFeatureNoWaypoints,g.push(e),this._waypointsEventLayer.add(g[g.length-
1])}this.set("displayedRouteGraphics",f);this.set("displayedManeuverPointGraphics",g);this._renderDirections();for(d=0;d<this.stops.length;d++)if(this._isStopAWaypoint(this.stops[d])&&this._modifiedWaypointIndex===d){for(e=0;e<b.featuresWithWaypoints.length;e++)if(f=b.featuresWithWaypoints[e],f._associatedStop===this.stops[d].feature){("esriDMTStop"===f.attributes.maneuverType||"esriDMTDepart"===f.attributes.maneuverType)&&(this.stops[d].feature.geometry.x=f.geometry.paths[0][0][0],this.stops[d].feature.geometry.y=
f.geometry.paths[0][0][1]);break}this._modifiedWaypointIndex=null;break}A.set(this._savePrintBtnContainer,"display","inline-block");this.onDirectionsFinish(a)}else a=a.routeResults[0].route,a.setSymbol(this.routeSymbol),this._routeLayer.add(a),this._incrementalRouteSegment=a;c.resolve();return this._moveLayersToFront(),this.createRouteSymbols(),c.promise},_setGeocodersStopReference:function(){if(this.geocoders)for(var a=0;a<this.geocoders.length;a++)this.geocoders[a]&&this.stops[a]&&(this.geocoders[a]._stopReference=
this.stops[a])},_setStops:function(){this._setGeocodersStopReference();this.createRouteSymbols();this._set("stops",this.stops);this.onStopsUpdate(this.stops)},_getCandidates:function(a){var b=[];if(a&&a.length){for(var c=0;c<a.length;c++)b.push(this._getCandidate(a[c]));return J(b)}a=new L;return a.resolve([]),a.promise},_clearResultsHTML:function(){this._resultsNode.innerHTML="";A.set(this._savePrintBtnContainer,"display","none")},_showSegmentPopup:function(a){if(a&&this.get("showSegmentPopup")&&
this.get("map").infoWindow){var b=a.geometry.getPoint(0,0);a=new O(b,null,a.attributes,this.get("segmentInfoTemplate"));var c=this.get("map").infoWindow;c.setFeatures([a]);c.show(b)}},_addStopButton:function(){this.addStop().then(a.hitch(this,function(){this.get("focusOnNewStop")&&this.geocoders[this.stops.length-1].focus()}))},_sortGeocoders:function(){var c=this._dnd.getAllNodes();this.geocoders.sort(a.hitch(this,function(a,d){return a.domNode&&a.domNode.parentNode&&a.domNode.parentNode.parentNode&&
d.domNode&&d.domNode.parentNode&&d.domNode.parentNode.parentNode?b.indexOf(c,a.domNode.parentNode.parentNode)>b.indexOf(c,d.domNode.parentNode.parentNode)?1:-1:0}));this.stops.length===this.geocoders.length&&this._sortStops();for(var d=0;d<this.geocoders.length;d++)this.geocoders[d]&&this.geocoders[d].inputNode&&(this.geocoders[d].inputNode.title=E.widgets.directions.stopNoTitle+(d+1));this._setLocateButtonVisibilityEvents()},_disconnectResults:function(){if(this._resultEvents&&this._resultEvents.length)for(var a=
0;a<this._resultEvents.length;a++)this._resultEvents[a]&&this._resultEvents[a].remove();this._resultEvents=[]},_formatArbitraryCostsForRouteTooltip:function(a){var b="",c;for(c in a)if(0===c.indexOf("Total_")&&a.hasOwnProperty(c)){var d=this._getCostAttribute(c.substr(6));d&&(b+=this._isTimeUnits(d.units)?this._formatTime(a[c],!1,d.units):this._formatDistance(a[c],!0,d.units),b+=b?" \x26middot; ":"")}return b&&(b=E.widgets.directions.toNearbyStops+": \x3cb\x3e"+b.substr(0,b.length-10)+"\x3c/b\x3e"),
b},_formatTime:function(a,b,c){c||(c=(this._getDirectionsTimeAttribute()||{}).units);var d,e,f="";a=Math.round(this._convertCostValue(a,c,"esriNAUMinutes"));return d=Math.floor(a/60),e=Math.floor(a%60),b?f=D.format(d,{pattern:"00"})+":"+D.format(e,{pattern:"00"}):(d&&(f+=d+" "+E.widgets.directions.time.hr+" "),f+=d||e?e+" "+E.widgets.directions.time.min:""),f},_formatDistance:function(a,b,c){c||(c=this.directionsLengthUnits);var d=this.directionsLengthUnits,e=E.widgets.directions.units[d],f=d.replace("esri",
"").toLowerCase();a=this._convertCostValue(a,c,d);return e&&(f=b?e.abbr:e.name),a?D.format(a,{locale:"root",places:2})+" "+f:""},_createToolbars:function(){this.editToolbar||(this.editToolbar=new Na(this.map));this.drawToolbar||(this.drawToolbar=new Ta(this.map),E.toolbars.draw.freehand=E.widgets.directions.lineBarrierFreehand,this.drawToolbar.onDrawComplete=a.hitch(this,function(a){var b=new O(a.geometry,null,{BarrierType:0});1<da.geodesicLengths([a.geographicGeometry],S.METERS)[0]&&(this._polylineBarriersLayer.add(b),
this.routeParams.polylineBarriers||(this.routeParams.polylineBarriers=new ra),this.routeParams.polylineBarriers.features.push(b),this._clearStopsStatusAttr(),this.getDirections(!0))}))},_destroyGlobalGeocoder:function(){this._globalGeocoder&&(this._globalGeocoder.destroy(),this._globalGeocoder=null)},_createGlobalGeocoder:function(){var a=new L;return this._globalGeocoder=new G(this.get("searchOptions")),u.once(this._globalGeocoder,"load",a.resolve,a.reject),this._globalGeocoder.startup(),a.promise},
_init:function(){var b=new L;return this.set("loaded",!1),this._enableButton(this._getDirectionsButtonNode,!1),A.set(this._saveAsButton,"display","none"),this.clearMessages(),this.get("map").loaded?this._configure().always(b.resolve):u.once(this.get("map"),"load",a.hitch(this,function(){this._configure().always(b.resolve)})),b.promise},_setDefaultStops:function(){var b=new L;return this.defaults.stops&&this.defaults.stops.length?this._updateStops(this.defaults.stops).then(a.hitch(this,function(){this._removeEmptyStops();
b.resolve()}),b.reject):b.resolve(),b.promise},_configure:function(){var b=new L;return this._handle&&this._handle._remove(),this._createDnD(),this._createDepartAtControls(),this._setSearchOptions(),this._createGlobalGeocoder().then(a.hitch(this,function(){this._createToolbars();this._usingAGOL()||(this.geometryTaskUrl=null,this.printTaskUrl=null);this._createGeometryTask();this._createPrintTask();this._showActivateButton();this._showBarriersButton();this._createTravelModesDDL();this._createSearchSourceDDL();
var c=[this._createRouteTask(),this._setDefaultStops()];J(c).then(a.hitch(this,function(){this._setDefaultUnits();this._setTrafficOptions();this._setMenuNodeValues();this._setupEvents();var c=this.directionsLanguage||this.userOptions.routeParams&&this.userOptions.routeParams.directionsLanguage||f.locale.toLowerCase();this._setDirectionsLanguageByLocale(c);this._setupTravelModes().then(a.hitch(this,function(){this.set("loaded",!0);this.onLoad();b.resolve(!0)}),function(a){b.reject(a)})}),function(a){b.reject(a)})}),
function(a){b.reject(a)}),this._naRouteSharing=null,b.promise},_setDirectionsLanguageByLocale:function(a){var b=this.serviceDescription.directionsSupportedLanguages,c=function(a){if(b)for(var c=0;c<b.length;c++)if(b[c].toLowerCase().substr(0,2)===a)return b[c];return null},d=c(a);return d||(a=a.substr(0,2),d=c(a)),this.directionsLanguage=d,this.routeParams.directionsLanguage=d,d},_getStopSymbol:function(a,b){var c=a&&(a.feature&&a.feature.attributes||a.attributes),d=this.stopSymbol;return c&&(d=this._isStopAWaypoint(a)?
this.waypointSymbol:void 0===c.Status||0===c.Status||6===c.Status?null===c.ArriveCurbApproach&&null!==c.DepartCurbApproach?this.get(b?"fromSymbolDrag":"fromSymbol"):null!==c.ArriveCurbApproach&&null===c.DepartCurbApproach?this.get(b?"toSymbolDrag":"toSymbol"):this.get(b?"stopSymbolDrag":"stopSymbol"):this.get(b?"unreachedSymbolDrag":"unreachedSymbol")),d},_addTrafficLayer:function(){this.trafficLayer&&!this._trafficLayerAdded&&this.map&&(this.map.addLayer(this.trafficLayer),this.trafficLayer.show(),
this._trafficLayerAdded=!0)},_toggleUnits:function(a){a.target===this._useMilesNode?this.setDirectionsLengthUnits(S.MILES):a.target===this._useKilometersNode&&this.setDirectionsLengthUnits(S.KILOMETERS)},_toggleCheckbox:function(a){var b=B.get(a.target,"checked");a.target===this._findOptimalOrderNode?this.set("optimalRoute",b):a.target===this._useTrafficNode?this.set("traffic",b):a.target===this._returnToStartNode&&this.set("returnToStart",b)},_isStopLocated:function(a){return a&&a.feature&&a.feature.attributes&&
(!a.feature.attributes.Status||6===a.feature.attributes.Status)},_configureRouteOptions:function(){var a,c=this.get("routeParams");if(this.get("directionsLengthUnits")?c.directionsLengthUnits=this.get("directionsLengthUnits"):this.set("directionsLengthUnits",c.directionsLengthUnits),c.findBestSequence=this.get("optimalRoute"),c.findBestSequence)for(c.preserveFirstStop=this._isStopLocated(this.stops[0]),c.preserveLastStop=!this.returnToStart&&this._isStopLocated(this.stops[this.stops.length-1])||this.returnToStart&&
this._isStopLocated(this.stops[0]),a=0;a<this.stops.length;)this._isStopAWaypoint(this.stops[a])?this._removeStop(a,!0,!0):a++;if(!this.returnToStart&&this.stops.length&&this._isStopAWaypoint(this.stops[this.stops.length-1]))for(a=this.stops.length-1;0<a;)this._isStopAWaypoint(this.stops[a])&&this._removeStop(a,!0,!0),a--;if(this._isTimeUnits(this._getImpedanceAttribute().units))if(c.useTimeWindows=!0,"now"===this.startTime)c.timeWindowsAreUTC=!0,c.startTimeIsUTC=!0,c.startTime=new Date;else{c.timeWindowsAreUTC=
!1;c.startTimeIsUTC=!1;var d=this._departAtTime,e=6E4*d.getValue().getTimezoneOffset(),d=new Date(d.getValue().getTime()+this._departAtDate.getValue().getTime()-e),d=new Date(d.getTime()-6E4*d.getTimezoneOffset());c.startTime=d}else c.startTime=null,c.useTimeWindows=!1;var d=this._getImpedanceAttribute(),e=this._getCostAttribute(d.timeNeutralAttributeName),f=this.routeParams.accumulateAttributes||this.serviceDescription.accumulateAttributeNames;e&&-1===b.indexOf(f,e.name)&&f.push(e.name);this.routeParams.accumulateAttributes=
f;c.returnStops=!0;f=[];for(a=0;a<this.stopGraphics.length;a++)if(this.stopGraphics[a]&&(f.push(new O(this.stopGraphics[a].toJson())),a)){var g=f[0].attributes,h=f[a].attributes,l;for(l in h)h.hasOwnProperty(l)&&!g.hasOwnProperty(l)&&(g[l]=null)}this.get("returnToStart")&&this.stopGraphics.length&&this._isStopLocated(this.stops[0])?(l=new O(this.stopGraphics[0].toJson()),this._returnToStartStop=this._addStopWrapperToGraphic(l,l.attributes.Name),f.push(l)):this._returnToStartStop=null;if(c.stops.features=
f,e)for(a=0;a<f.length;a++)f[a].attributes["Attr_"+e.name]=this._convertCostValue(f[a].attributes["Attr_"+d.name],d.units,e.units);this.set("routeParams",c)},_configureRoute:function(){var b=new L;if(b.promise.always(a.hitch(this,function(){this._checkMaxStops()})),this.createRouteSymbols(),this._configureRouteOptions(),this.routeParams.returnRoutes&&this._incrementalSolveStopRange){var c=this._incrementalSolveStopRange;c.start<c.end?this.routeParams.stops.features=this.routeParams.stops.features.slice(c.start,
c.end+1):c.start>c.end&&(this.routeParams.stops.features=this.routeParams.stops.features.slice(c.start,this.routeParams.stops.features.length-1).concat(this.routeParams.stops.features.slice(0,c.end+1)))}else this._incrementalSolveStopRange=null;for(var d,e,f={},g=this.routeParams.stops.features,c=0;c<g.length;c++)e=g[c].attributes.address,d=(c===this._handle._index&&!this._handle.attributes.isWaypoint&&this._incrementalSolveStopRange?this._waypointName:e)+"_"+this._stopSequence++,g[c].attributes.Name=
d,f[d]=e,delete g[c].attributes.address,delete g[c].attributes.isWaypoint,delete g[c].attributes.Status;this._solveInProgress=!0;var h={_incrementalSolveStopRange:this._incrementalSolveStopRange};return this.routeTask.solve(this.routeParams,a.hitch(this,function(a){this._solveResultProcessing(a,f,h).then(b.resolve,b.reject)}),a.hitch(this,function(c){a.mixin(this,h);this._solveInProgress=!1;for(var d=0;d<this.stops.length;d++)this.stops[d].feature&&(this.stops[d].feature.attributes=a.mixin(this.stops[d].feature.attributes,
{Status:5}));this.set("directions",null);this._clearDisplayAfterSolve();this.createRouteSymbols();this._showBarriers();this._routeTaskError(c);b.reject(c)})),b.promise},_solveResultProcessing:function(b,c,d){var e=new L;a.mixin(this,d);this._solveInProgress=!1;var f;d=b.routeResults[0];var g=d.directions;d=d.stops;if(g){this._solverMessages=b.messages;var h=function(a){for(var b in c)if(a&&0===g.routeName.indexOf(b)||!a&&0<g.routeName.indexOf(b))return c[b];return""};f=h(!0);h=h(!1);g.routeName=(f!==
this._waypointName?f:E.widgets.directions.waypoint)+" \u2014 "+(h!==this._waypointName?h:E.widgets.directions.waypoint);for(f=0;f<g.features.length;f++)if(h=g.features[f].attributes,"esriDMTDepart"===h.maneuverType||"esriDMTStop"===h.maneuverType)for(var l in c)if(c.hasOwnProperty(l)&&-1<h.text.indexOf(l)){h.text=h.text.replace(l,c[l]);for(var m=0;m<d.length;m++)if(d[m].attributes.Name===l){a.mixin(g.features[f],{_associatedStop:d[this.returnToStart&&m===d.length-1?0:m],_associatedStopWithReturnToStart:d[m]});
break}}for(f=0;f<d.length;f++)this._returnToStartStop&&d[f].attributes.Name===this._returnToStartStop.feature.attributes.Name&&(this._returnToStartStop._resultsStopIndex=f),d[f].attributes.Name=c[d[f].attributes.Name];this._directionsPostprocessing(g);l=g.features[0].attributes;this._updateMapTimeExtent(l.arriveTimeUTC);this._useTrafficItemNode.title=E.widgets.directions.trafficLabelDepartAt+": "+this._toSpatiallyLocalTimeString(l.arriveTimeUTC,l.ETA)}return this._showRoute(b).always(a.hitch(this,
function(){this._incrementalSolveStopRange=null;e.resolve(b)})),this._showBarriers(),e.promise},_directionsPostprocessing:function(b){var c,d,e=function(a,c){var d=b.features[a]._associatedFeaturesWithWaypoints||[];d.push(b.featuresWithWaypoints[c]);b.features[a]._associatedFeaturesWithWaypoints=d;b.featuresWithWaypoints[c]._associatedFeatureNoWaypoints=b.features[a]};d=a.hitch(this,function(a){return"\x3cdiv class\x3d'"+this.theme+"'\x3e\x3ctable class\x3d'esriRoutesTooltip'\x3e"+this._renderDirectionsItemTR(a._associatedFeatureNoWaypoints)+
"\x3c/table\x3e\x3c/div\x3e"});b.featuresWithWaypoints=[];for(c=0;c<b.features.length;c++){var f=new O(b.features[c].toJson());f.setInfoTemplate(new R({title:this._i18n.widgets.directions.maneuver,content:d}));b.featuresWithWaypoints.push(f);b.featuresWithWaypoints[c]._associatedStop=b.features[c]._associatedStop;b.featuresWithWaypoints[c]._associatedStopWithReturnToStart=b.features[c]._associatedStopWithReturnToStart}b.stringsWithWaypoints=a.mixin([],b.strings);b.eventsWithWaypoints=a.mixin([],b.events);
for(d=c=0;c<b.features.length;)b.features[c]._associatedStop&&b.features[c]._associatedStop.attributes.Name===this._waypointName?(b.features.splice(c,c?2:1),b.strings.splice(c,c?2:1),b.events.splice(c,c?2:1),c&&b.features[c]&&"esriDMTStraight"===b.features[c].attributes.maneuverType)?(f=b.features.splice(c,1)[0],b.strings[c-1]=(b.strings[c-1]||[]).concat(b.strings.splice(c,1)[0]||[]),b.strings[c-1].length||(b.strings[c-1]=void 0),b.events[c-1]=(b.events[c-1]||[]).concat(b.events.splice(c,1)[0]||[]),
b.events[c-1].length||(b.events[c-1]=void 0),b.features[c-1].attributes.length+=f.attributes.length,b.features[c-1].attributes.time+=f.attributes.time,b.features[c-1].geometry.paths[0]=b.features[c-1].geometry.paths[0].concat(f.geometry.paths[0]),e(c-1,d++),e(c-1,d++),e(c-1,d++)):(c&&e(c-1,d++),c<b.features.length&&e(c,d++)):(e(c,d++),c++)},_boldText:function(a,b){return a.replace(new RegExp("(^|\\s|\\W)("+b+")(\\W|\\s|$)","ig"),"$1\x3cstrong\x3e$2\x3c/strong\x3e$3")},_clearStopGraphics:function(){if(this.stopGraphics&&
this.stopGraphics.length)for(var a=0;a<this.stopGraphics.length;a++)this._stopLayer.remove(this.stopGraphics[a]),this._stopLayer.remove(this.textGraphics[a]);this.set("stopGraphics",[]);this.set("textGraphics",[])},_updateMapTimeExtent:function(a){this.map&&(a=new Date(a),this.map.setTimeExtent(new Q(a,a)))},_clearRouteGraphics:function(){for(var a=this.displayedRouteGraphics,c=this.displayedManeuverPointGraphics,d=this._routeLayer,e=this._waypointsEventLayer,f=0,g=0,h=this._incrementalSolveStopRange?
this._incrementalSolveStopRange:{start:0,end:this.stops?this.stops.length:-1};a&&g<a.length;){if(a[g]._associatedStop)for(var l=0;l<this.stops.length;l++)if(this.stops[l].feature===a[g]._associatedStop){f=l;break}f>=h.start&&f<h.end||h.start>=h.end&&(f>=h.start||f<h.end)?(d.remove(a[g]),a.splice(g,1)):g++}d.remove(this._incrementalRouteSegment);this.set("displayedRouteGraphics",a?a:[]);c&&c.length&&b.forEach(c,function(a){e.remove(a)});this.set("displayedManeuverPointGraphics",[]);this._waypointsEventLayer.clear();
this.unhighlightSegment(!0)},_clearInfoWindow:function(){var a=this.get("map").infoWindow;a&&(a.hide(),a.clearFeatures())},_clearDisplayBeforeSolve:function(){this._toggleSaveMenu(!1);this._clearInfoWindow();this._clearResultsHTML()},_clearDisplayAfterSolve:function(){this._clearStopGraphics();this._clearRouteGraphics();this.clearMessages()},_getLetter:function(b){var c=this.alphabet,d="",e=function(a){var b="";return"0123456789"===c||"1234567890"===c?b=String(a+1):(a=a||0,a>=c.length&&(b=e(Math.floor(a/
c.length)-1),a%=c.length),b+=c[a]),b},f=b instanceof O?a.hitch(this,function(){for(var a=this.get("returnToStart")?0:-1,c=0;c<this.stops.length;c++)if(this.stops[c].feature===b){a=c;break}return a})():b;if(-1<f&&c&&c.length){c instanceof Array&&(c=c.toString().replace(/,/g,""));for(var d=-1,g=0;f>=g;g++)d+=this._isStopAWaypoint(this.stops[g])?0:1;d=e(d)}return d},_solveAndZoom:function(b){if(this.autoSolve)return this._getDirections().then(a.hitch(this,function(){b||this.zoomToFullRoute()}));var c=
new L;return c.resolve(),c.promise},_setupEvents:function(){this._onEvents.push(u(this.domNode,"[data-blur-on-click]:click",function(){this.blur()}));this._onEvents.push(u(this._dndNode,"[data-reverse-stops]:click, [data-reverse-stops]:keydown",a.hitch(this,function(a){a&&("click"===a.type||"keydown"===a.type&&a.keyCode===r.ENTER)&&this.modifyStopSequence()})));this._onEvents.push(u(this._printButton,"click, keydown",a.hitch(this,function(a){a&&("click"===a.type||"keydown"===a.type&&a.keyCode===r.ENTER)&&
this._printDirections()})));this._onEvents.push(u(this._resultsNode,"[data-full-route]:click, [data-full-route]:keydown",a.hitch(this,function(a){a&&("click"===a.type||"keydown"===a.type&&a.keyCode===r.ENTER)&&this.zoomToFullRoute()})));this._onEvents.push(u(this._dndNode,"[data-remove]:click, [data-remove]:keydown",a.hitch(this,function(a){if(a&&("click"===a.type||"keydown"===a.type&&a.keyCode===r.ENTER)){var c=C("[data-remove]",this._dndNode);a=b.indexOf(c,a.target);this.removeStop(a)}})));this._onEvents.push(u(this._dndNode,
"[data-center-at]:click, [data-center-at]:keydown",a.hitch(this,function(a){if(a&&("click"===a.type||"keydown"===a.type&&a.keyCode===r.ENTER)){var c=C("[data-center-at]",this._dndNode);a=b.indexOf(c,a.target);this.stops[a]&&this.stops[a].feature&&this.stops[a].feature.geometry&&this.map.centerAndZoom(this.stops[a].feature.geometry)}})));this._onEvents.push(u(this.map,"zoom-end",a.hitch(this,function(){var a=this._segmentGraphics;a&&a[0]&&void 0!==a[0].attributes._index&&this.highlightSegment(a[0].attributes._index,
!0)})));this._onEvents.push(u(this._dnd,"Drop",a.hitch(this,function(){this._dnd.sync();this.set("optimalRoute",!1);var a,c,d=!1,e=[],f=this._dnd.getAllNodes();for(a=0;a<this.geocoders.length;a++)if(c=b.indexOf(f,this.geocoders[a]._tr),-1<c&&a!==c&&a!==c-1){for(;0<c&&this._isStopAWaypoint(this.stops[c]);)c--;d=!0;break}d&&(e=this._markWPsForRemovalAfterUserChangedStopSequence(a,c));this._sortGeocoders();this.setListIcons();this._removeSomeWaypoints(e);this.stops[c].name&&this.getDirections()})));
this._onEvents.push(u(this._dnd,"DndStart",a.hitch(this,function(){var a=C("body")[0];z.add(a,this._css.dndDragBodyClass);this._removeLocateButtonVisibilityEvents()})));this._onEvents.push(u(this._dnd,"DndDrop, DndCancel",a.hitch(this,function(){var a=C("body")[0];z.remove(a,this._css.dndDragBodyClass);this._setLocateButtonVisibilityEvents()})));var c=this._handle,d=a.hitch(this,function(d){var e=a.hitch(this,function(a,b,e,f,g){var h=c._isShown();if(c.setGeometry(a),c._tooltip.style.left=d.screenPoint.x+
"px",c._tooltip.style.top=d.screenPoint.y+"px",!h||c._index===e&&c.attributes.isWaypoint===f||(c._remove(),h=!1),c.setSymbol(b),c._index=e,c._isStopIcon=c._index===Math.floor(c._index),c.attributes.isWaypoint=f,c._isStopIcon&&(c.attributes.address=this.stopGraphics[e].attributes.address,c.setInfoTemplate(this.stopGraphics[e].infoTemplate)),this.canModifyWaypoints||c._isStopIcon)h||(this._stopLayer.add(c),(a=c.getDojoShape())&&a[f?"moveToBack":"moveToFront"].call(a)),this.editToolbar.activate(Na.MOVE,
c);f=f?c._isStopIcon?E.widgets.directions.dragWaypoint:this.canModifyWaypoints?E.widgets.directions.dragRoute:"":E.widgets.directions.dragStop;c._showTooltip(g||f)});if(this.unhighlightSegment(),this.mapClickActive&&this.dragging&&!this._solveInProgress&&!this._moveInProgress&&!c._solveTimeout)if(clearTimeout(c._removeTimeout),(d.graphic._isStopIcon||d.graphic._isStopLabel)&&!d.graphic.attributes.isWaypoint&&this.canModifyStops||d.graphic._isStopIcon&&d.graphic.attributes.isWaypoint&&this.canModifyWaypoints){var f=
d.graphic._isStopLabel?this.stopGraphics[d.graphic._index]:d.graphic;e(f.geometry,this._getStopSymbol(this.stops[f._index],!0),f._index,!0===f.attributes.isWaypoint);this._stopLayer.remove(this.stopGraphics[f._index]);this._stopLayer.remove(this.textGraphics[f._index])}else(d.graphic._isSnapFeature||d.graphic._isHandle&&!d.graphic._isStopIcon)&&(this._snappingManager||(this._snappingManager=this.map.snappingManager),this._snappingManager.getSnappingPoint(d.screenPoint).then(a.hitch(this,function(a){if(!this.maxStopsReached&&
!this._moveInProgress&&a){for(var f=this.displayedManeuverPointGraphics,g=null,h=0;h<f.length;h++)if(f[h].geometry.x===a.x&&f[h].geometry.y===a.y){g=f[h]._directionsFeature;f=b.indexOf(this.directions.features,g);-1<f&&this.highlightSegment(f);break}e(a,d.graphic._isHandle?c.symbol:this.waypointSymbol,d.graphic._isHandle?c._index:d.graphic._nextStopIndex,d.graphic._isHandle?c.attributes.isWaypoint:!0,g)}})))}),e=a.hitch(this,function(){clearTimeout(c._removeTimeout);c._removeTimeout=setTimeout(c._remove,
100);this.unhighlightSegment()}),f=a.hitch(this,function(a){if(this.barrierToolActive){a=a.graphic;var c=this.routeParams,d=c.barriers?b.indexOf(c.barriers.features,a):-1,e=c.polygonBarriers?b.indexOf(c.polygonBarriers.features,a):-1,f=c.polylineBarriers?b.indexOf(c.polylineBarriers.features,a):-1;-1<d&&c.barriers.features.splice(d,1);-1<e&&c.polygonBarriers.features.splice(e,1);-1<f&&c.polylineBarriers.features.splice(f,1);this._barriersLayer.remove(a);this._polygonBarriersLayer.remove(a);this._polylineBarriersLayer.remove(a);
this._clearStopsStatusAttr();this.getDirections(!0)}});this._onEvents.push(this._waypointsEventLayer.on("mouse-move",d));this._onEvents.push(this._waypointsEventLayer.on("mouse-out",e));this._onEvents.push(this._stopLayer.on("mouse-move",d));this._onEvents.push(this._stopLayer.on("mouse-out",e));this._onEvents.push(this._polylineBarriersLayer.on("click",f));this._editToolbarEvents();this._watchEvents.push(this.watch("theme",this._updateThemeWatch));this._watchEvents.push(this.watch("canModifyStops",
this._updateCanModifyStops));this._watchEvents.push(this.watch("canModifyWaypoints",this._updateCanAddWaypoints));this._watchEvents.push(this.watch("showReturnToStartOption",this._optionsMenu));this._watchEvents.push(this.watch("showOptimalRouteOption",this._optionsMenu));this._watchEvents.push(this.watch("returnToStart",this._setMenuNodeValues));this._watchEvents.push(this.watch("optimalRoute",this._setMenuNodeValues));this._watchEvents.push(this.watch("startTime",this._setStartTime));this._watchEvents.push(this.watch("traffic",
this._setMenuNodeValues));this._watchEvents.push(this.watch("trafficLayer",this._trafficLayerUpdate));this._watchEvents.push(this.watch("routeTaskUrl",a.hitch(this,function(){this._createRouteTask();this._setTrafficOptions()})));this._watchEvents.push(this.watch("printTaskUrl",a.hitch(this,function(){this._createPrintTask()})));this._watchEvents.push(this.watch("geometryTaskUrl",a.hitch(this,function(){this._createGeometryTask()})));this._watchEvents.push(this.watch("routeParams",a.hitch(this,function(){this._createRouteParams();
this._setDefaultUnits()})));this._watchEvents.push(this.watch("searchOptions",a.hitch(this,function(){this._setSearchOptions();this._createGlobalGeocoder();var a=this.get("searchOptions").sources;if(a)for(var b=0;b<this.geocoders.length;b++)this.geocoders[b].set("sources",a)})));this._watchEvents.push(this.watch("showReverseStopsButton",this.setListIcons));this._watchEvents.push(this.watch("editToolbar",this._editToolbarEvents));this._watchEvents.push(this.watch("showTravelModesOption",this._showTravelModesOption));
this._watchEvents.push(this.watch("showMilesKilometersOption",this._showMilesKilometersOption));this._watchEvents.push(this.watch("showClearButton",this._showClearButton));this._watchEvents.push(this.watch("directionsLengthUnits",this.setDirectionsLengthUnits));this._watchEvents.push(this.watch("directionsLanguage",this.setDirectionsLanguage));this._watchEvents.push(this.watch("mapClickActive",this._activate));this._watchEvents.push(this.watch("barrierToolActive",this._activateBarrierTool));this._watchEvents.push(this.watch("showActivateButton",
this._showActivateButton));this._watchEvents.push(this.watch("showBarriersButton",this._showBarriersButton));this._watchEvents.push(this.watch("showPrintPage",function(){A.set(this._printButton,"display",this.showPrintPage?"inline-block":"none")}));this._watchEvents.push(this.watch("showSaveButton",function(){A.set(this._saveMenuButton,"display",this.showSaveButton&&this.owningSystemUrl?"inline-block":"none")}))},_editToolbarEvents:function(){var b=a.hitch(this,function(a){var b="";if((a=a.routeResults?
a.routeResults[0]:null)&&a.route){a=a.route.attributes;var c=this.routeParams.travelMode;if(c)var b=b+("\x3cb\x3e"+c.name+"\x3c/b\x3e "+E.widgets.directions.toNearbyStops+": "),d=void 0!==a["Total_"+c.timeAttributeName]?this._formatTime(a["Total_"+c.timeAttributeName],!1,this._getCostAttribute(c.timeAttributeName).units):"",b=b+((void 0!==a["Total_"+c.distanceAttributeName]?this._formatDistance(a["Total_"+c.distanceAttributeName],!0,this._getCostAttribute(c.distanceAttributeName).units):"")+(d?" \x26middot; "+
d:""));else b=this._formatArbitraryCostsForRouteTooltip(a)}this._handle._showTooltip(b)}),c=a.hitch(this,function(d,e){var f=new L,g=this._handle,h=this.map.toScreen(g._origPoint).offset(d.transform.dx+g.symbol.xoffset,d.transform.dy+g.symbol.yoffset);if(d.origMapPoint||(d.origMapPoint=this.map.toMap(h)),A.set(g._tooltip,"left",h.x+"px"),A.set(g._tooltip,"top",h.y+"px"),clearTimeout(g._solveTimeout),this._solveInProgress||!this._requestQueueTail.isFulfilled())g._solveTimeout=setTimeout(function(){c(d,
e).always(f.resolve)},100);else if(g._isStopIcon){var h=d.graphic._index,l=this.stops[h];(l=l?{name:l.name,extent:l.extent,feature:new O(l.feature.toJson())}:null)?(l.feature.setGeometry(d.origMapPoint),this._modifiedWaypointIndex=this._isStopAWaypoint(this.stops[h])?h:null,this._incrementalSolveStopRange={start:this.returnToStart?(this.stops.length+h-1)%this.stops.length:Math.max(0,h-1),end:this.returnToStart?(h+1)%this.stops.length:Math.min(this.stops.length-1,h+1)},this.updateStop(l,h,e).always(a.hitch(this,
function(a){g._solveTimeout=null;a.routeResults&&b(a);f.resolve()}))):f.resolve()}else f.resolve();return f.promise});this._onEvents.push(u(this.editToolbar,"graphic-click",a.hitch(this,function(b){if(b.graphic.attributes.isWaypoint)!b.graphic._isStopIcon||this._moveInProgress||this._solveInProgress||(this._handle._remove(),this._moveInProgress=!0,this.removeStop(b.graphic._index,!0).always(a.hitch(this,function(){this._moveInProgress=!1})));else{var c=this.get("map").infoWindow;c&&(c.setFeatures([b.graphic]),
c.show(b.graphic.geometry))}})));this._onEvents.push(u(this.editToolbar,"graphic-move-start",a.hitch(this,function(a){this._blurGeocoders();this._moveInProgress=!0;this._removeEmptyStops();this.routeParams.returnDirections=!1;this.routeParams.returnRoutes=!0;a=a.graphic;a._origPoint=new la(a.geometry.toJson());a._maxDeviation=0;a._solveHasHappened=!1;this.map.disableMapNavigation()})));this._onEvents.push(u(this.editToolbar,"graphic-move-stop",a.hitch(this,function(b){if(this.map.enableMapNavigation(),
this.routeParams.returnDirections=!0,this.routeParams.returnRoutes=!1,this._handle._isStopIcon)if(this._handle._solveHasHappened)if(this._handle.attributes.isWaypoint)c(b,!0).always(a.hitch(this,function(){this._moveInProgress=!1;this._handle._isStopIcon=!0;this._handle._remove();this._showLoadingSpinner()}));else{clearTimeout(this._handle._solveTimeout);this._handle._solveTimeout=null;var d=this.stops[b.graphic._index],e=(d&&d.feature&&d.feature.attributes&&d.feature.attributes.Name)===this._userDefinedStopName,
f=d&&d.name;this._reverseGeocode(new O(b.graphic.toJson())).then(a.hitch(this,function(c){e&&(c.name=f,c.feature.attributes.Name=this._userDefinedStopName);this._setReverseGeocode(c,c.feature.geometry,b.graphic._index).always(a.hitch(this,function(){this._moveInProgress=!1;this._handle._remove();this._showLoadingSpinner()}))}))}else this._moveInProgress=!1;else this._moveInProgress=!1})));this._onEvents.push(u(this.editToolbar,"graphic-move",a.hitch(this,function(a){var b=this._handle,d=a.transform;
if(d.dx&&d.dy&&(a.graphic._maxDeviation=Math.max(b._maxDeviation,Math.sqrt(d.dx*d.dx+d.dy*d.dy))),10<b._maxDeviation)(b._solveHasHappened=!0,a.graphic===b&&b.attributes.isWaypoint&&!b._isStopIcon)?(this.set("optimalRoute",!1),b._index+=.5,b._isStopIcon=!0,a.graphic._stopIndex=b._index,this._incrementalSolveStopRange={start:this.returnToStart?(this.stops.length+b._index-1)%this.stops.length:Math.max(0,b._index-1),end:this.returnToStart?(b._index+1)%(this.stops.length+1):Math.min(this.stops.length,
b._index+1)},this.addStop({name:this._waypointName,feature:new O(b.geometry,b.symbol,{isWaypoint:!0,CurbApproach:3})},a.graphic._stopIndex)):((b=a.graphic.getDojoShape())&&b.moveToFront(),c(a))})))},_isStopAWaypoint:function(a){return a&&a.feature&&a.feature.attributes&&a.feature.attributes.isWaypoint},_getStopCount:function(){var a,b=0;for(a=0;a<this.stops.length;a++)b+=!this._isStopAWaypoint(this.stops[a])&&this.stops[a].name?1:0;return b},_getWaypointCount:function(){var a,b=0;for(a=0;a<this.stops.length;a++)b+=
this._isStopAWaypoint(this.stops[a])?1:0;return b},_decorateUngeocodedStop:function(b){var c=new L,d=function(a,d){c.resolve({name:void 0===a?E.widgets.directions.unlocatedStop:a.toFixed(6)+" "+d.toFixed(6),feature:b})};if(b.geometry)if(b.geometry.spatialReference&&4326!==b.geometry.spatialReference.wkid)if(this.map&&this.map.spatialReference&&this.map.spatialReference.isWebMercator()){var e=V.xyToLngLat(b.geometry.x,b.geometry.y);d(e[0],e[1])}else this._geometryService?(e=new Ma,e.outSR=new aa(4326),
e.geometries=[b.geometry],this._geometryService.project(e).then(a.hitch(this,function(a){a&&a.length?d(a[0].x,a[0].y):d(b.geometry.x,b.geometry.y)}),a.hitch(this,function(){d()}))):d(b.geometry.x,b.geometry.y);else d(b.geometry.x,b.geometry.y);else d();return c.promise},_trafficLayerUpdate:function(a,b,c){a=this.get("map");b&&this._trafficLayerAdded&&(a.removeLayer(b),this._trafficLayerAdded=!1);c&&this.get("traffic")&&!this._trafficLayerAdded&&(a.addLayer(c),c.show(),this._trafficLayerAdded=!0)},
_routeTaskError:function(a){var b=E.widgets.directions.error.routeTask,c=a.details;c&&1===c.length&&("The distance between any inputs must be less than 50 miles (80 kilometers) when walking."===c[0]?b=E.widgets.directions.error.maxWalkingDistance:"Driving a truck is currently not supported outside of North America and Central America."===c[0]&&(b=E.widgets.directions.error.nonNAmTruckingMode));this._showMessage(b);this.onDirectionsFinish(a)},_showMessage:function(a,b){var c="";if(this.messages.push({msg:a,
error:!b}),this.messages.length){for(var c=c+"\x3cul\x3e",d=0;d<this.messages.length;d++)c+='\x3cli class\x3d"'+(this.messages[d].error?this._css.routesErrorClass:this._css.routesInfoClass)+'"\x3e'+this.messages[d].msg+"\x3c/li\x3e";c+="\x3c/ul\x3e"}this._msgNode&&(this._msgNode.innerHTML=c);b||this.onError(a)},_isTimeUnits:function(a){return"esriNAUSeconds"===a||"esriNAUMinutes"===a||"esriNAUHours"===a||"esriNAUDays"===a},_getImpedanceAttribute:function(){return this._getCostAttribute(this.routeParams&&
this.routeParams.travelMode&&this.routeParams.travelMode.impedanceAttributeName||this.routeParams.impedanceAttribute||this.serviceDescription.impedance)},_getDirectionsTimeAttribute:function(){return this._getCostAttribute(this.routeParams&&this.routeParams.travelMode&&this.routeParams.travelMode.timeAttributeName||this.routeParams.directionsTimeAttribute||this.serviceDescription.directionsTimeAttribute)},_getCostAttribute:function(a){for(var b,c=this.serviceDescription&&this.serviceDescription.networkDataset.networkAttributes||
[],d=0;d<c.length;d++)if(c[d].name===a&&"esriNAUTCost"===c[d].usageType){b=c[d];break}return b},_convertCostValue:function(a,b,c){var d=this._isTimeUnits(b),e=this._isTimeUnits(c);b=d?this._toMinutes(a,b):this._toMeters(a,b);return d===e?e?this._fromMinutes(b,c):this._fromMeters(b,c):a},_toMinutes:function(a,b,c){switch(a=a||0,b){case "esriNAUSeconds":a/=Math.pow(60,c?-1:1);break;case "esriNAUHours":a*=Math.pow(60,c?-1:1);break;case "esriNAUDays":a*=Math.pow(1440,c?-1:1)}return a},_fromMinutes:function(a,
b){return this._toMinutes(a,b,!0)},_toMeters:function(a,b,c){switch(a=a||0,(b||"").replace("esriNAU","esri")){case "esriInches":a*=Math.pow(.0254,c?-1:1);break;case "esriFeet":a*=Math.pow(.3048,c?-1:1);break;case "esriYards":a*=Math.pow(.9144,c?-1:1);break;case "esriMiles":a*=Math.pow(1609.344,c?-1:1);break;case "esriNauticalMiles":a*=Math.pow(1851.995396854,c?-1:1);break;case "esriMillimeters":a/=Math.pow(1E3,c?-1:1);break;case "esriCentimeters":a/=Math.pow(100,c?-1:1);break;case "esriKilometers":a*=
Math.pow(1E3,c?-1:1);break;case "esriDecimeters":a/=Math.pow(10,c?-1:1)}return a},_fromMeters:function(a,b){return this._toMeters(a,b,!0)},_createRouteTask:function(){var b=new L;return this.set("routeTask",new ua(this.get("routeTaskUrl"))),this._createRouteParams(),this.routeTask.getServiceDescription(this.travelModesServiceUrl,this.doNotFetchTravelModesFromOwningSystem).then(a.hitch(this,function(c){c.networkDataset?(this.set("serviceDescription",c),this.set("maxStops",parseInt(this.userOptions.maxStops||
c.serviceLimits&&c.serviceLimits.Route_MaxStops||this.defaults.maxStops)),this.defaults.portalUrl?(this.owningSystemUrl=this.defaults.portalUrl,b.resolve()):this.routeTask.getOwningSystemUrl().then(a.hitch(this,function(a){this.owningSystemUrl=a;b.resolve()}),b.reject)):(this._showMessage(E.widgets.directions.error.cantFindRouteServiceDescription),b.reject(Error(E.widgets.directions.error.cantFindRouteServiceDescription)))}),a.hitch(this,function(){this._showMessage(E.widgets.directions.error.cantFindRouteServiceDescription);
b.reject(Error(E.widgets.directions.error.cantFindRouteServiceDescription));this.mapClickActive=!1;this._activate()})),b.promise},_createSearchSourceDDL:function(){if(this._globalGeocoder&&this._globalGeocoder.sources&&1<this._globalGeocoder.sources.length){var b=a.hitch(this,function(a){this._searchSourceSelector.domNode.blur();this._globalGeocoder.set("activeSourceIndex",a);for(var b=0;b<this.geocoders.length;b++)this.geocoders[b].set("activeSourceIndex",a)});if(!this._searchSourceSelector){for(var c=
[{value:"all",label:E.widgets.Search.main.all,selected:!0}],d=0;d<this._globalGeocoder.sources.length;d++)c.push({value:String(d),label:this._globalGeocoder.sources[d].name});this._searchSourceSelector=new g({className:"esriSearchSourcesDDL",style:"width:100%;",options:c},this._searchSourceSelectorContainer);this._searchSourceSelector.startup();this._searchSourceSelector.on("change",b);this._searchSourceSelector.domNode.style.width=""}b("all")}else 2>this._globalGeocoder.sources.length&&(this._searchSourceContainerNode.style.display=
"none")},_createTravelModesDDL:function(){this._travelModeSelector||(this._travelModeSelector=new g({className:"esriTravelModesDDL",style:"width:100%;"},this._travelModeSelectorContainer),this._travelModeSelector.startup(),this._travelModeSelector._interractive=!0,this._travelModeSelector.on("change",a.hitch(this,function(b){this._travelModeSelector._interractive?this._enqueue(function(){return this._setTravelMode(b).always(a.hitch(this,function(){this._travelModeSelector._interractive=!0}))}):this._travelModeSelector._interractive=
!0})))},_setupTravelModes:function(){var a=this.get("serviceDescription"),b=a.supportedTravelModes,c=new L;if(b&&b.length&&this._travelModeSelector){for(var d=b[0].name,e=[],f=0;f<b.length;f++){for(var g="AUTOMOBILE"===b[f].type?"Driving":"TRUCK"===b[f].type?"Trucking":"WALK"===b[f].type?"Walking":"Other",h="",l=a.networkDataset.networkAttributes,m=0;m<l.length;m++){var k=l[m];if(k.name===b[f].impedanceAttributeName){"esriNAUCentimeters"===k.units||"esriNAUDecimalDegrees"===k.units||"esriNAUDecimeters"===
k.units||"esriNAUFeet"===k.units||"esriNAUInches"===k.units||"esriNAUKilometers"===k.units||"esriNAUMeters"===k.units||"esriNAUMiles"===k.units||"esriNAUMillimeters"===k.units||"esriNAUNauticalMiles"===k.units||"esriNAUYards"===k.units?h="Distance":("esriNAUDays"===k.units||"esriNAUHours"===k.units||"esriNAUMinutes"===k.units||"esriNAUSeconds"===k.units)&&(h="Time");break}}e.push({id:b[f].name,label:'\x3cdiv class\x3d"esriTravelModesDirectionsIcon esriTravelModesType'+g+h+'"\x3e\x26nbsp;\x3c/div\x3e\x3cdiv class\x3d"esriTravelModesTypeName" title\x3d"'+
b[f].description+'"\x3e'+b[f].name+"\x3c/div\x3e"});!a.defaultTravelMode||b[f].id!==a.defaultTravelMode&&b[f].itemId!==a.defaultTravelMode||(d=b[f].name)}this._showTravelModesOption();this._travelModeSelector.setStore(new t({objectStore:new q({data:e})}));this._travelModeSelector._interractive=!1;this._travelModeSelector.setValue(d);this._setTravelMode(d).always(c.resolve)}else this._checkStartTimeUIAvailability(),this.set("showTravelModesOption",!1),c.resolve();return c.promise},_createPrintTask:function(){this._printService=
(this.printTaskUrl=this._usingAGOL()?this.printTaskUrl:this.defaults.printTaskUrl)?new Da(this.printTaskUrl,{async:!1}):null;var a=new Ga;a.exportOptions={width:670,height:750,dpi:96};a.format="PNG32";a.layout="MAP_ONLY";a.preserveScale=!1;a.showAttribution=!1;var b=new Ja;b.map=this.map;b.outSpatialReference=this.map.spatialReference;b.template=a;this._printParams=b},_createGeometryTask:function(){this._geometryService=null;this._usingAGOL()?this._geometryService=new Ha(this.geometryTaskUrl):(this._geometryService=
this.defaults.geometryTaskUrl?new Ha(this.defaults.geometryTaskUrl):Xa.defaults.geometryService,this.geometryTaskUrl=this._geometryService?this._geometryService.url:null)},_showTravelModesOption:function(){var a=this.get("serviceDescription");A.set(this._travelModeContainerNode,"display",this.showTravelModesOption&&a&&a.supportedTravelModes&&a.supportedTravelModes.length&&!this.doNotFetchTravelModesFromOwningSystem?"block":"none")},_showMilesKilometersOption:function(){A.set(this._agolDistanceUnitsNode,
"display",this.showMilesKilometersOption?"block":"none")},_showClearButton:function(){A.set(this._clearDirectionsButtonNode,"display",this.showClearButton?"inline-block":"none")},_showActivateButton:function(){A.set(this._activateButtonNode,"display",this.showActivateButton?"inline-block":"none");this.showActivateButton||this.deactivate()},_showBarriersButton:function(){A.set(this._lineBarrierButtonNode,"display",this.showBarriersButton?"inline-block":"none");this.showBarriersButton||this.deactivateBarrierTool()},
_createRouteParams:function(){var b={returnDirections:!0,returnRoutes:!1,outputLines:"esriNAOutputLineTrueShape",preserveFirstStop:!0,preserveLastStop:!0,directionsOutputType:"complete",stops:new ra,ignoreInvalidLocations:!0,doNotLocateOnRestrictedElements:!0,outSpatialReference:this.get("map").spatialReference};this.get("routeParams")||(this.routeParams={});var c=new xa;this.routeParams=a.mixin(c,{outputGeometryPrecision:0,outputGeometryPrecisionUnits:"esriMeters",restrictUTurns:"esriNFSBAtDeadEndsOnly"},
this.get("routeParams"),b)},_markWPsForRemovalAfterUserChangedStopSequence:function(a,b){for(var c=a-1,d=[];0<=c&&this._isStopAWaypoint(this.stops[c]);)d.push(this.stops[c]),c--;for(c=a+1;c<this.stops.length&&this._isStopAWaypoint(this.stops[c]);)d.push(this.stops[c]),c++;if(b>a)for(c=b+1;c<this.stops.length&&this._isStopAWaypoint(this.stops[c]);)d.push(this.stops[c]),c++;else if(void 0!==b)for(c=b-1;0<=c&&this._isStopAWaypoint(this.stops[c]);)d.push(this.stops[c]),c--;else if(this.returnToStart&&
0===a)for(c=this.stops.length-1;0<=c&&this._isStopAWaypoint(this.stops[c]);)d.push(this.stops[c]),c--;return d},_removeSomeWaypoints:function(a){for(var c=new L,d=[],e=0;e<a.length;e++){var f=b.indexOf(this.stops,a[e]);-1<f&&d.push(this._removeStop(f,!0,!0))}return J(d).always(c.resolve),c.promise},_modifyStopSequence:function(b,c){var d,e=this._dnd.getAllNodes(),f=new L,g=[];if(e.length)if(this._removeLocateButtonVisibilityEvents(),arguments.length&&void 0!==b)if(0<=b&&0<=c&&b<this.stops.length&&
c<this.stops.length&&b!==c){var e=this._markWPsForRemovalAfterUserChangedStopSequence(b,c),h=this.stops.splice(b,1);this.stops.splice(c,0,h[0]);for(d=0;d<this.stops.length;d++)g.push(this._updateStop(this.stops[d],d));g.push(this._removeSomeWaypoints(e));J(g).always(a.hitch(this,function(){this._solveAndZoom().always(f.resolve)}))}else f.reject("Invalid From and To values.");else{for(d=0;d<this.stops.length;)this._isStopAWaypoint(this.stops[d])?g.push(this._removeStop(d,!0,!0)):d++;J(g).always(a.hitch(this,
function(){g=[];this.stops.reverse();for(d=0;d<this.stops.length;d++)g.push(this._updateStop(this.stops[d],d));J(g).always(a.hitch(this,function(){this._solveAndZoom().always(f.resolve)}))}))}else f.resolve();return f.promise},_setMenuNodeValues:function(a){"traffic"!==a&&this._clearDisplayBeforeSolve();a=this.get("optimalRoute");if(this._findOptimalOrderNode&&B.set(this._findOptimalOrderNode,"checked",a),this._returnToStartNode)a=this.returnToStart&&!this.maxStopsReached&&this.stops[0]&&(!this.stops[0].feature||
this._isStopLocated(this.stops[0])),B.set(this._returnToStartNode,"checked",a),this.set("returnToStart",a),this.maxStopsReached&&this.returnToStart&&this._showMessage(E.widgets.directions.error.maximumStops);if(!this.returnToStart&&!this._incrementalSolveStopRange&&this.directions)for(this._incrementalSolveStopRange={start:this.stops.length-1,end:this.stops.length},this._clearRouteGraphics(),this._incrementalSolveStopRange=null,a=this.stops.length;0<a--&&this._isStopAWaypoint(this.stops[a]);)this._removeSomeWaypoints([this.stops[a]]);
this._useTrafficNode&&(B.set(this._useTrafficNode,"checked",this.traffic),this.traffic?this._addTrafficLayer():this._removeTrafficLayer());switch(this.get("directionsLengthUnits")){case S.KILOMETERS:B.set(this._useKilometersNode,"checked",!0);B.set(this._useMilesNode,"checked",!1);break;case S.MILES:B.set(this._useKilometersNode,"checked",!1),B.set(this._useMilesNode,"checked",!0)}A.set(this._printButton,"display",this.showPrintPage?"inline-block":"none");A.set(this._saveMenuButton,"display",this.showSaveButton&&
this.owningSystemUrl?"inline-block":"none");this._showMilesKilometersOption();this._showClearButton()},_optionsMenu:function(){(this._useTrafficItemNode&&A.set(this._useTrafficItemNode,"display",this.get("showTrafficOption")?"block":"none"),this._returnToStartItemNode&&A.set(this._returnToStartItemNode,"display",this.get("showReturnToStartOption")?"block":"none"),this._findOptimalOrderItemNode&&A.set(this._findOptimalOrderItemNode,"display",this.get("showOptimalRouteOption")&&3<this._getStopCount()?
"block":"none"),this.stops.length>=this.get("minStops"))?z.add(this._widgetContainer,this._css.stopsOptionsOptionsEnabledClass):(z.remove(this._widgetContainer,this._css.stopsOptionsOptionsEnabledClass),this._optionsMenuNode)&&"block"===A.get(this._optionsMenuNode,"display")&&this._toggleOptionsMenu()},_stopsRemovable:function(){2<this._dnd.getAllNodes().length-this._getWaypointCount()?z.add(this._widgetContainer,this._css.stopsRemovableClass):z.remove(this._widgetContainer,this._css.stopsRemovableClass)},
_checkMaxStops:function(){this.set("maxStopsReached",this._getStopCount()+this._getWaypointCount()+(this.returnToStart?1:0)>=this.maxStops);this._showAddDestination()},_updateThemeWatch:function(a,b,c){z.remove(this.domNode,b);z.add(this.domNode,c)},_toggleOptionsMenu:function(){"block"===A.get(this._optionsMenuNode,"display")?(A.set(this._optionsMenuNode,"display","none"),z.remove(this._optionsButtonNode,"esriStopsOptionsOpen"),this._optionsButtonNode.innerHTML=E.widgets.directions.showOptions):
(A.set(this._optionsMenuNode,"display","block"),z.add(this._optionsButtonNode,"esriStopsOptionsOpen"),this._optionsButtonNode.innerHTML=E.widgets.directions.hideOptions)},_toggleSaveMenu:function(b){"block"===A.get(this._saveMenuNode,"display")||!1===b?(A.set(this._saveMenuNode,"display","none"),z.remove(this._saveMenuButton,this._css.stopsPressedButtonClass)):(this.clearMessages(),A.set(this._saveMenuNode,"display","block"),z.add(this._saveMenuButton,this._css.stopsPressedButtonClass),this._enableSharing().then(a.hitch(this,
function(){if(this._outputLayer.setValue(this.routeLayer.title?this.routeLayer.title:this.directions&&this.directions.routeName),this.routeLayer.ownerFolder)for(var a=this._folderSelector.store.objectStore.data,b=0;b<a.length;b++)if(a[b].folderId===this.routeLayer.ownerFolder){this._folderSelector.getValue()!==a[b].id&&(this._folderSelector._interractive=!1,this._folderSelector.setValue(a[b].id));break}this._enableButton(this._saveButton,this.routeLayer.isItemOwner||!this._userCanCreatePortalItem);
this._outputLayer.set("disabled",!1)})))},_showToolbar:function(){z[this.stops.length<this.maxStops&&this.canModifyStops||this.canModifyWaypoints?"add":"remove"].call(I,this._widgetContainer,this._css.addStopsClass)},_showAddDestination:function(){this._showToolbar();this._addDestinationNode.style.display=this.stops.length<this.maxStops&&this.canModifyStops?"inline":"none"},_showMapClickActiveButton:function(){this._showToolbar();this._activateButtonNode.style.display=this.canModifyStops||this.canModifyWaypoints?
"inline-block":"none"},_getAbsoluteUrl:function(a){return a=h.toUrl(a),/^https?\:/i.test(a)?a:/^\/\//i.test(a)?Oa+a:/^\//i.test(a)?Oa+"//"+window.location.host+a:a},_getManeuverImage:function(a){return a?"esriDMTStop"===a||"esriDMTDepart"===a?"":this._getAbsoluteUrl("./images/Directions/maneuvers/"+a+".png"):""},_loadPrintDirections:function(b){var c=this.get("printTemplate"),d=new L;this.directionsLengthUnits!==this.routeParams.directionsLengthUnits?this.getDirections().then(d.resolve,d.reject):
d.resolve();d.then(a.hitch(this,function(){if(!c&&this.directions){var a,d=this._getAbsoluteUrl("./css/Directions.css"),e=this._getAbsoluteUrl("./css/DirectionsPrint.css"),f=this._getAbsoluteUrl("./images/Directions/print-logo.png");a=y.isBodyLtr()?"ltr":"rtl";c="";c+="\x3c!DOCTYPE HTML\x3e";c+='\x3chtml lang\x3d"en" class\x3d"'+this.get("theme")+'" dir\x3d"'+a+'"\x3e';c+="\x3chead\x3e";c+='\x3cmeta charset\x3d"utf-8"\x3e';c+='\x3cmeta http-equiv\x3d"X-UA-Compatible" content\x3d"IE\x3dEdge,chrome\x3d1"\x3e';
c+="\x3ctitle\x3e"+this.get("directions").routeName+"\x3c/title\x3e";c+='\x3clink rel\x3d"stylesheet" media\x3d"screen" type\x3d"text/css" href\x3d"'+d+'" /\x3e';c+='\x3clink rel\x3d"stylesheet" media\x3d"print" type\x3d"text/css" href\x3d"'+e+'" /\x3e';c+="\x3c/head\x3e";c+='\x3cbody class\x3d"'+this._css.esriPrintPageClass+'"\x3e';c+='\x3cdiv class\x3d"'+this._css.esriPrintBarClass+'"\x3e';c+='\x3cdiv class\x3d"'+this._css.esriCloseButtonClass+'" title\x3d"'+E.common.close+'" onclick\x3d"window.close();"\x3e'+
E.common.close+"\x3c/div\x3e";c+='\x3cdiv id\x3d"printButton" class\x3d"'+this._css.esriPrintButtonClass+'" title\x3d"'+E.widgets.directions.print+'" onclick\x3d"window.print();"\x3e'+E.widgets.directions.print+"\x3c/div\x3e";c+="\x3c/div\x3e";c+='\x3cdiv class\x3d"'+this._css.esriPrintMainClass+'"\x3e';c+='\x3cdiv class\x3d"'+this._css.esriPrintHeaderClass+'"\x3e';c+='\x3cimg class\x3d"'+this._css.esriPrintLogoClass+'" src\x3d"'+f+'" /\x3e';c+='\x3cdiv class\x3d"'+this._css.esriPrintNameClass+'"\x3e'+
this.get("directions").routeName+"\x3c/div\x3e";c+=this._renderDirectionsSummary(this.directions);b&&(c+='\x3cdiv id\x3d"divMap" class\x3d"esriPrintMap esriPrintWait"\x3e\x3c/div\x3e',c+='\x3chr class\x3d"esriNoPrint"/\x3e');c+='\x3cdiv id\x3d"print_helper"\x3e\x3c/div\x3e';c+='\x3ctextarea onkeyup\x3d"document.getElementById(\'print_helper\').innerHTML\x3dthis.value;" id\x3d"print_area" class\x3d"'+this._css.esriPrintNotesClass+'" placeholder\x3d"'+E.widgets.directions.printNotes+'"\x3e\x3c/textarea\x3e';
c+='\x3cdiv class\x3d"'+this._css.clearClass+'"\x3e\x3c/div\x3e';c+="\x3c/div\x3e";c+='\x3cdiv class\x3d"'+this._css.esriPrintDirectionsClass+'"\x3e';c+=this._renderDirectionsTable(this.directions);c+="\x3c/div\x3e";c+='\x3cdiv class\x3d"'+this._css.esriPrintFooterClass+'"\x3e';c+="\x3cp\x3e"+E.widgets.directions.printDisclaimer+"\x3c/p\x3e";c+="\x3c/div\x3e";c+="\x3c/div\x3e";c+="\x3c/body\x3e";c+="\x3c/html\x3e"}this._printWindow.document.open("text/html","replace");this._printWindow.document.write(c);
this._printWindow.document.close()}))},_printDirections:function(){if(this.directions){var b=screen.width/2,c=screen.height/1.5,b="toolbar\x3dno, location\x3dno, directories\x3dno, status\x3dyes, menubar\x3dno, scrollbars\x3dyes, resizable\x3dyes, width\x3d"+b+", height\x3d"+c+", top\x3d"+(screen.height/2-c/2)+", left\x3d"+(screen.width/2-b/2);this.get("printPage")?(window.directions=this.get("directions"),window.open(this.get("printPage"),"directions_widget_print",b,!0)):(this._printWindow=window.open("",
"directions_widget_print",b,!0),this._loadPrintDirections(!!this._printService),this._printService&&h(["dojo/_base/window"],a.hitch(this,function(b){this.zoomToFullRoute().then(a.hitch(this,function(){this._printService.execute(this._printParams,a.hitch(this,function(a){b.withDoc(this._printWindow.document,function(){var b=x.byId("divMap");b&&(z.remove(b,"esriPrintWait"),z.add(b,"esriPageBreak"),I.create("img",{src:a.url,"class":"esriPrintMapImg"},b))})}),a.hitch(this,function(a){b.withDoc(this._printWindow.document,
function(){var a=x.byId("divMap");a&&z.remove(a,"esriPrintWait")});console.error("Error while calling print service:\n "+a)}))}))})))}},_enableButton:function(a,b){var c=b||void 0===b;z[c?"remove":"add"].apply(this,[a,"esriDisabledDirectionsButton"]);a._enabled=c},_clearStopsStatusAttr:function(){for(var a=0;a<this.stops.length;a++)this.stops[a].feature&&this.stops[a].feature.attributes&&(this.stops[a].feature.attributes.Status=void 0)},_enableSharing:function(){var b=new L;return!this._naRouteSharing&&
this.owningSystemUrl?h(["../tasks/NARouteSharing"],a.hitch(this,function(c){this._naRouteSharing=new c(this.owningSystemUrl,this.map.spatialReference);this._folderSelector||(this._folderSelector=new g({className:"esriFoldersDDL",style:"width: 100%;",sortByLabel:!1,disabled:!0,_interractive:!0,onChange:a.hitch(this,function(){this._folderSelector._interractive?this._enableButton(this._saveButton,!this.routeLayer.itemId):this._folderSelector._interractive=!0})},this._folderSelectorContainer),this._folderSelector.startup(),
this._outputLayer=new d({style:"width: 100%",required:!0,trim:!0,regExp:'[^\x26|\x3c|\x3e|%|#|?|\\|"|/|+]+',maxLength:98,disabled:!0,onKeyPress:a.hitch(this,function(){this._enableButton(this._saveButton,!this.routeLayer.itemId||!this._userCanCreatePortalItem)}),onFocus:a.hitch(this,function(){this.map&&this.map.disableKeyboardNavigation()}),onBlur:a.hitch(this,function(){this.map&&this.map.enableKeyboardNavigation()})},this._outputLayerContainer),this._outputLayer.startup());this._naRouteSharing.getFolders().then(a.hitch(this,
function(c){for(var d=[],e=0;e<c.length;e++)d.push({id:c[e].url,folderId:c[e].id,label:c[e].title});this._folderSelector.setStore(new t({objectStore:new q({data:d})}));this._naRouteSharing.canCreateItem().then(a.hitch(this,function(a){this._folderSelector.set("disabled",!a);this._userCanCreatePortalItem=a}));this._enableButton(this._saveButton);b.resolve()}),a.hitch(this,function(a){this._naRouteSharing=null;this._toggleSaveMenu(!1);b.reject(a)}))})):this.owningSystemUrl?b.resolve():(b.reject(Error("Owning system is not defined, or the Directions widget is not done initializing.")),
this._naRouteSharing=null),b.promise},_storeRouteUI:function(){var a=new L;return this._outputLayer&&this._outputLayer.isValid()?this._storeRoute(this._outputLayer.getValue(),this._folderSelector.getValue(),this._folderSelector.store.objectStore.get(this._folderSelector.getValue()).folderId).then(a.resolve,a.reject):(this._outputLayer&&this._outputLayer.focus(),a.reject(Error("Need result layer name specified."))),a.promise},_storeRoute:function(c,d,e){var f=new L,g=this.directions;if(this._savingRoute||
!this._naRouteSharing)return this._saveButton.blur(),f.reject(Error("Not ready to store route.")),f.promise;if(this.clearMessages(),f.then(null,a.hitch(this,function(a){this._showMessage(E.widgets.directions.error.cantSaveRoute)})),f.promise.always(a.hitch(this,function(){this._enableButton(this._saveButton);A.set(this._saveAsButton,"display",this.routeLayer.itemId&&this._userCanCreatePortalItem?"inline-block":"none");this._showLoadingSpinner();this._savingRoute=!1})),g&&g.features&&g.features.length&&
this.stops&&this.stops.length)if(this.owningSystemUrl)if(this.routeParams&&this.routeParams.travelMode)if(c&&d){var h,l,m;h=a.hitch(this,function(a){return this._naRouteSharing.getAttributeUnits(a,this.serviceDescription)});l=this.routeParams.travelMode.timeAttributeName;var k=this.routeParams.travelMode.distanceAttributeName,n=h(l),q=h(k),r=this.routeParams.directionsLengthUnits||this.serviceDescription.directionsLengthUnits,t=this._naRouteSharing.toMeters,u=this._naRouteSharing.toMinutes,v=function(a,
c,d){var e,f;for(f in a)a.hasOwnProperty(f)&&0===f.indexOf(c)&&-1===b.indexOf(d,f.substr(c.length))&&(e=e||{},e[f.substr(c.length)]=a[f]);return e},w=[],z=[],x=[];if(l&&n&&k&&q){var y=[],C=this.routeParams.accumulateAttributes||this.serviceDescription.accumulateAttributeNames||[],B=this.serviceDescription.networkDataset.networkAttributes;for(h=0;h<B.length;h++)"esriNAUTCost"===B[h].usageType&&-1===b.indexOf(C,B[h].name)&&B[h].name!==l&&B[h].name!==k&&y.push(B[h].name);var C=this.get("stops"),D={xmin:1/
0,ymin:1/0,xmax:-(1/0),ymax:-(1/0)};for(h=0;h<C.length;h++)if(C[h].feature&&C[h].feature.toJson){B=C[h].feature.toJson();m=B.attributes;var F=B.geometry,V=this._naRouteSharing.getUTCOffset(m.ArriveTime,m.ArriveTimeUTC),G=this._naRouteSharing.getUTCOffset(m.DepartTime,m.DepartTimeUTC);a.mixin(D,{xmin:D.xmin>F.x?F.x:D.xmin,ymin:D.ymin>F.y?F.y:D.ymin,xmax:D.xmax<F.x?F.x:D.xmax,ymax:D.ymax<F.y?F.y:D.ymax});B.attributes={__OBJECTID:h+1,CurbApproach:m.CurbApproach,ArrivalCurbApproach:m.ArriveCurbApproach,
DepartureCurbApproach:m.DepartCurbApproach,Name:m.Name===this._waypointName?E.widgets.directions.waypoint:m.Name===this._userDefinedStopName?C[h].name:m.Name,RouteName:g.routeName,Sequence:m.Sequence,Status:m.Status,LocationType:m.isWaypoint?1:0,TimeWindowStart:m.TimeWindowStart,TimeWindowEnd:m.TimeWindowEnd,TimeWindowStartUTCOffset:V,TimeWindowEndUTCOffset:V,ServiceMinutes:u(m["Attr_"+l],n),ServiceMeters:t(m["Attr_"+k],q),ServiceCosts:H.stringify(v(m,"Attr_",y)),CumulativeMinutes:u(m["Cumul_"+l],
n),CumulativeMeters:t(m["Cumul_"+k],q),CumulativeCosts:H.stringify(v(m,"Cumul_",y)),LateMinutes:u(m["Violation_"+l],n),WaitMinutes:u(m["Wait_"+l],n),ArrivalTime:this._naRouteSharing.toUTCTime(m.ArriveTime,V),DepartureTime:this._naRouteSharing.toUTCTime(m.DepartTime,G),ArrivalUTCOffset:V,DepartureUTCOffset:G};w.push(B)}k=0;q=function(a){try{a.strings=H.parse(a.strings)}catch(fb){I.strings=void 0}if(a.strings&&a.strings.length)for(var b=0;b<a.strings.length;b++)if("esriDSTGeneral"===a.strings[b].stringType)return a.strings[b].string};
C=function(a,b){for(var c=[],d=0;d<(a||[]).length;d++)a[d].stringType!==b&&b||c.push(a[d].string);return c.length?c.toString():void 0};B=function(a){switch(a){case "esriDMTStop":return"esriDPTManeuverArrive";case "esriDMTDepart":return"esriDPTManeuverDepart";case "esriDMTDoorPassage":return"esriDPTManeuverDoor";case "esriDMTBearLeft":return"esriDPTManeuverBearLeft";case "esriDMTBearRight":return"esriDPTManeuverBearRight";case "esriDMTElevator":return"esriDPTManeuverElevator";case "esriDMTEscalator":return"esriDPTManeuverEscalator";
case "esriDMTFerry":return"esriDPTManeuverFerryOn";case "esriDMTEndOfFerry":return"esriDPTManeuverFerryOff";case "esriDMTForkCenter":return"esriDPTManeuverForkCenter";case "esriDMTForkLeft":return"esriDPTManeuverForkLeft";case "esriDMTForkRight":return"esriDPTManeuverForkRight";case "esriDMTPedestrianRamp":return"esriDPTManeuverPedestrianRamp";case "esriDMTRampLeft":return"esriDPTManeuverRampLeft";case "esriDMTRampRight":return"esriDPTManeuverRampRight";case "esriDMTRoundabout":return"esriDPTManeuverRoundabout";
case "esriDMTTurnLeft":return"esriDPTManeuverTurnLeft";case "esriDMTLeftLeft":return"esriDPTManeuverTurnLeftLeft";case "esriDMTLeftRight":return"esriDPTManeuverTurnLeftRight";case "esriDMTTurnRight":return"esriDPTManeuverTurnRight";case "esriDMTRightLeft":return"esriDPTManeuverTurnRightLeft";case "esriDMTRightRight":return"esriDPTManeuverTurnRightRight";case "esriDMTSharpLeft":return"esriDPTManeuverSharpLeft";case "esriDMTSharpRight":return"esriDPTManeuverSharpRight";case "esriDMTStraight":return"esriDPTManeuverStraight";
case "esriDMTStrairs":return"esriDPTManeuverStairs";case "esriDMTUTurn":return"esriDPTManeuverUTurn"}return"esriDPTUnknown"};for(h=0;h<g.featuresWithWaypoints.length;h++){var J=g.featuresWithWaypoints[h],F=J.toJson(),V=F.attributes,G=F.geometry&&F.geometry.paths&&F.geometry.paths[0]||[];m=this._naRouteSharing.getUTCOffset(V.ETA,V.arriveTimeUTC);F.attributes={__OBJECTID:h+1,Sequence:++k,StopID:function(){var a=void 0,b=J._associatedStopWithReturnToStart&&J._associatedStopWithReturnToStart.attributes.Sequence;
if(b)for(var c=0;c<w.length;c++)if(w[c].attributes.Sequence===b){a=w[c].attributes.__OBJECTID;break}return a}(),DirectionPointType:B(V.maneuverType),DisplayText:J._associatedStopWithReturnToStart&&J._associatedStopWithReturnToStart.attributes.isWaypoint?V.text.replace(this._waypointName,E.widgets.directions.waypoint):V.text,ArrivalTime:this._naRouteSharing.toUTCTime(V.ETA,m),ArrivalUTCOffset:m,Azimuth:void 0,Name:C(g.stringsWithWaypoints[h],"esriDSTStreetName"),AlternateName:C(g.stringsWithWaypoints[h],
"esriDSTAltName"),ExitName:C(g.stringsWithWaypoints[h],"esriDSTExit"),IntersectingName:C(g.stringsWithWaypoints[h],"esriDSTCrossStreet"),BranchName:C(g.stringsWithWaypoints[h],"esriDSTBranch"),TowardName:C(g.stringsWithWaypoints[h],"esriDSTToward"),ShortVoiceInstruction:void 0,VoiceInstruction:void 0,Level:void 0};delete F.symbol;delete F.infoTemplate;G.length?F.geometry={x:G[0][0],y:G[0][1],spatialReference:F.geometry.spatialReference}:delete F.geometry;z.push(F);F=J.toJson();V=F.attributes;G=F.geometry&&
F.geometry.paths&&F.geometry.paths[0]||[];m=!0;for(l=0;l<G.length-1;l++)if(G[l][0]!==G[l+1][0]||G[l][1]!==G[l+1][1]){m=!1;break}m||(F.attributes={DirectionPointID:h+1,DirectionLineType:"esriDLTSegment",Meters:t(V.length,r),Minutes:u(V.time,n),FromLevel:void 0,ToLevel:void 0},delete F.symbol,delete F.infoTemplate,x.push(F));var I=g.eventsWithWaypoints[F.attributes.Sequence]||[];for(l=0;l<I.length;l++)F=I[l].toJson(),V=F.attributes,m=this._naRouteSharing.getUTCOffset(V.ETA,V.arriveTimeUTC),F.attributes=
{Sequence:++k,DirectionPointType:"esriDPTEvent",DisplayText:q(V),ArrivalTime:this._naRouteSharing.toUTCTime(V.ETA,m),ArrivalUTCOffset:m,Name:V.strings},z.push(F)}var q=this.routeParams.barriers&&this.routeParams.barriers.features||[],da=[];for(h=0;h<q.length;h++)l=q[h].toJson(),k=l.attributes,l.attributes={BarrierType:k.BarrierType||0,FullEdge:k.FullEdge||!1,AddedCost:k["Attr_"+this._getImpedanceAttribute().name]||0,Costs:H.stringify(v(k,"Attr_",y)),CurbApproach:k.CurbApproach||0,Name:k.Name},da.push(l);
var q=this.routeParams.polylineBarriers&&this.routeParams.polylineBarriers.features||[],O=[];for(h=0;h<q.length;h++)l=q[h].toJson(),k=l.attributes,l.attributes={BarrierType:k.BarrierType||0,ScaleFactor:k["Attr_"+this._getImpedanceAttribute().name]||1,Costs:H.stringify(v(k,"Attr_",y)),Name:k.Name},O.push(l);var q=this.routeParams.polygonBarriers&&this.routeParams.polygonBarriers.features||[],M=[];for(h=0;h<q.length;h++)l=q[h].toJson(),k=l.attributes,l.attributes={BarrierType:k.BarrierType||0,ScaleFactor:k["Attr_"+
this._getImpedanceAttribute().name]||1,Costs:H.stringify(v(k,"Attr_",y)),Name:k.Name},M.push(l);var ga={geometry:g.mergedGeometry,attributes:{RouteName:g.routeName,TotalMinutes:u(g.totalTime,n),TotalMeters:t(g.totalLength,r),TotalLateMinutes:function(){for(var a=0,b=0;b<w.length;b++)a+=w[b].attributes.LateMinutes||0;return a}(),TotalWaitMinutes:function(){for(var a=0,b=0;b<w.length;b++)a+=w[b].attributes.WaitMinutes||0;return a}(),TotalCosts:w[w.length-1].attributes.CumulativeCosts,StartTime:w[0].attributes.ArrivalTime,
EndTime:w[w.length-1].attributes.DepartureTime,StartUTCOffset:w[0].attributes.ArrivalUTCOffset,EndUTCOffset:w[w.length-1].attributes.DepartureUTCOffset,Messages:H.stringify(this._solverMessages),AnalysisSettings:H.stringify({travelMode:a.hitch(this,function(){var b=a.clone(this.routeParams.travelMode);return"\x26lt;"===b.name.substr(0,4)&&"\x26gt;"===b.name.substr(b.name.length-4,4)&&(b.name=b.name.substr(4,b.name.length-8)),b})(),directionsLanguage:this.routeParams.directionsLanguage||this.serviceDescription.directionsLanguage,
startTimeIsUTC:this.routeParams.startTimeIsUTC,timeWindowsAreUTC:this.routeParams.timeWindowsAreUTC,findBestSequence:this.routeParams.findBestSequence,preserveFirstStop:this.routeParams.preserveFirstStop,preserveLastStop:this.routeParams.preserveLastStop,accumulateAttributeNames:this.routeParams.accumulateAttributes||this.serviceDescription.accumulateAttributeNames})}};this._enableButton(this._saveButton,!1);this._savingRoute=!0;this._showLoadingSpinner(!0);a.hitch(this,function(){var b=new L;return this._printService?
this.zoomToFullRoute().then(a.hitch(this,function(){var a=this._printParams.template,c=a.exportOptions;a.exportOptions={width:200,height:133,dpi:96};this._printService.execute(this._printParams,function(d){a.exportOptions=c;b.resolve(d.url)},function(d){a.exportOptions=c;console.error("Error while calling print service:\n "+d);b.resolve()})})):b.resolve(),b.promise})().then(a.hitch(this,function(b){var h={folder:d,name:c,stops:w,directionPoints:z,directionLines:x,barriers:da,polylineBarriers:O,polygonBarriers:M,
extent:a.mixin(a.clone(g.extent),{xmin:D.xmin>g.extent.xmin?g.extent.xmin:D.xmin,ymin:D.ymin>g.extent.ymin?g.extent.ymin:D.ymin,xmax:D.xmax<g.extent.xmax?g.extent.xmax:D.xmax,ymax:D.ymax<g.extent.ymax?g.extent.ymax:D.ymax}),routeInfo:ga,thumbnail:b};this._userCanCreatePortalItem?this._naRouteSharing.store(h,this.routeLayer.itemId,"1.0.0").then(a.hitch(this,function(b){if(b.success){var c=this._naRouteSharing.portal,c="//"+(c.isPortal?c.portalHostname:c.urlKey+"."+c.customBaseUrl);this._toggleSaveMenu();
this._showMessage(E.widgets.directions.routeIsSaved+"\x3cbr/\x3e\x3ca class\x3d'esriLinkButton' target\x3d'_blank' href\x3d'"+c+"/home/item.html?id\x3d"+b.id+"'\x3e"+E.widgets.directions.share+"\x3c/a\x3e",!0);this.routeLayer.itemId?this.onRouteItemUpdated(b.id):this.onRouteItemCreated(b.id);a.mixin(this.routeLayer,{itemId:b.id,title:h.name,isItemOwner:!0,ownerFolder:e});f.resolve(b)}else f.reject(b)}),f.reject):this._naRouteSharing.createFeatureCollection(h).then(a.hitch(this,function(a){f.resolve(a);
this._toggleSaveMenu();this.onFeatureCollectionCreated(a)}),f.reject)}))}else f.reject(Error("Cannot deduce the impedance used."))}else f.reject(Error("Missing required parameter: layerName, folder must be specified."));else f.reject(Error("Shared route must be built using a Travel Mode."));else f.reject(Error("Cannot store route: owning system to store routes is not defined. Please specify Portal or ArcGIS Online Url in constructor."));else f.reject(Error("No route to share. Build a route first."));
return f.promise},_loadRoute:function(b){var c=new L;return c.promise.always(a.hitch(this,function(){this._showLoadingSpinner(!1);A.set(this._saveAsButton,"display",this.routeLayer.itemId&&this._userCanCreatePortalItem?"inline-block":"none");this._enableButton(this._saveButton,this.routeLayer.isItemOwner)})),this._reset().then(a.hitch(this,function(){this._showLoadingSpinner(!0);this._enableSharing().then(a.hitch(this,function(){var d,e,f,g,h=a.clone(this.serviceDescription),l=a.hitch(this,function(c){a.mixin(this.routeLayer,
{itemId:b,title:c.title,isItemOwner:c.isItemOwner,ownerFolder:c.ownerFolder})});h.directionsLengthUnits=this.directionsLengthUnits;this._naRouteSharing.load(b,h).then(a.hitch(this,function(b){if(b.routeParameters){a.mixin(this.routeParams,b.routeParameters);this.routeParams.accumulateAttributes=b.routeParameters.accumulateAttributeNames;this.set("optimalRoute",this.routeParams.findBestSequence);this.startTime=this.routeParams.startTime?this.routeParams.startTime:"now";this._setStartTime(void 0,void 0,
this.startTime);var m=b.routeParameters.travelMode,k=m?this._getCostAttribute(m.impedanceAttributeName):void 0,k=k?this._isTimeUnits(k.units)?"Time":"Distance":"";if(g=h.supportedTravelModes&&h.supportedTravelModes.length?this._travelModeSelector.store.objectStore.data.slice():[],k){var n="AUTOMOBILE"===m.type?"Driving":"TRUCK"===m.type?"Trucking":"WALK"===m.type?"Walking":"Other";m.name="\x26lt;"+m.name+"\x26gt;";this.serviceDescription.supportedTravelModes=(h.supportedTravelModes||[]).concat(m);
g.push({id:m.name,label:'\x3cdiv class\x3d"esriTravelModesDirectionsIcon esriTravelModesType'+n+k+'"\x3e\x26nbsp;\x3c/div\x3e\x3cdiv class\x3d"esriTravelModesTypeName"\x3e'+m.name+"\x3c/div\x3e"});this._travelModeSelector.setStore(new t({objectStore:new q({data:g})}));this._travelModeSelector._interractive=!1;this._travelModeSelector.setValue(m.name)}else if(console.warn("Cost attribute with such name was not found in the remote service, defaulting to the service travel mode."),m=h.defaultTravelMode,
g=h.supportedTravelModes,m&&g)for(d=0;d<g.length;d++){if(g[d].id===m){this.routeParams.travelMode=g[d].impedanceAttributeName?g[d]:g[d].itemId;break}}else this.routeParams.travelMode=null;this._checkStartTimeUIAvailability()}if(b.solveResult&&b.solveResult.routeResults){var r,u,v,n=1/0,w=-(1/0),m=b.solveResult.routeResults[0].stops,z=b.solveResult.routeResults[0].directions.features,k={};for(d=0;d<m.length;d++){var x=m[d].attributes;if(x.isWaypoint)for(e=0;e<z.length;e++)r=z[e].attributes,r._stopSequence===
x.Sequence&&(r.text=r.text.replace(x.Name,this._waypointName));f=x.Name+"_"+this._stopSequence++;k[f]=x.isWaypoint?this._waypointName:x.Name;x.Name=f;x.Sequence<n&&(null!==x.ArriveCurbApproach||null!==x.DepartCurbApproach)&&(u=x.Name,n=x.Sequence);x.Sequence>w&&(null!==x.ArriveCurbApproach||null!==x.DepartCurbApproach)&&(v=x.Name,w=x.Sequence)}f=u+" - "+v;b.solveResult.routeResults[0].routeName=f;b.solveResult.routeResults[0].directions.routeName=f;for(d=0;d<z.length;d++)if(r=z[d].attributes,void 0!==
r._stopSequence)for(e=0;e<m.length;e++)if(r._stopSequence===m[e].attributes.Sequence){f=m[e].attributes.Name;r.text=(r.text||"").replace(k[f],f);delete r._stopSequence;break}r=m[m.length-1];m[0].geometry.x===r.geometry.x&&m[0].geometry.y===r.geometry.y&&(this._returnToStartStop=this._addStopWrapperToGraphic(new O(r.geometry,null,r.attributes),k[r.attributes.Name]),this.set("returnToStart",!0));this._solveResultProcessing(b.solveResult,k).then(a.hitch(this,function(){this._setStartTime(void 0,void 0,
this.startTime);l(b);this.zoomToFullRoute();c.resolve(b)}),c.reject)}else{if(b.routeParameters){r=b.routeParameters.stops.features;this.stops=[];for(d=0;d<r.length;d++)this.stops.push(this._addStopWrapperToGraphic(r[d],r[d].attributes.Name)),this._updateStop(this.stops[d],d);this._setStops();this._showBarriers();b.loadMessages.push({message:E.widgets.directions.routeLayerStopsOnly,messageType:"Warning"})}else b.loadMessages.push({message:E.widgets.directions.routeLayerEmpty,messageType:"Warning"});
l(b);c.resolve(b)}for(d=0;d<b.loadMessages.length;d++)this._showMessage(b.loadMessages[d].message)}),a.hitch(this,function(a){c.reject(a);this._showMessage("GWM_0003"===a.messageCode?E.widgets.directions.error.accessDenied+this._naRouteSharing.portal.getPortalUser().username:E.widgets.directions.error.loadError)}))}),c.reject)}),c.reject),c.promise}});return v("extend-esri")&&a.setObject("dijit.Directions",k,K),k})},"dijit/form/Select":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x){function y(a){return function(b){this._isLoaded?this.inherited(a,arguments):this.loadDropDown(m.hitch(this,a,b))}}var A=k("dijit.form._SelectMenu",q,{autoFocus:!0,buildRendering:function(){this.inherited(arguments);this.domNode.setAttribute("role","listbox")},postCreate:function(){this.inherited(arguments);this.own(g(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}))},focus:function(){var a=!1,b=this.parentWidget.value;
m.isArray(b)&&(b=b[b.length-1]);b&&h.forEach(this.parentWidget._getChildren(),function(c){c.option&&b===c.option.value&&(a=!0,this.focusChild(c,!1))},this);a||this.inherited(arguments)}});b=k("dijit.form.Select"+(d("dojo-bidi")?"_NoBidi":""),[c,n,u],{baseClass:"dijitSelect dijitValidationTextBox",templateString:x,_buttonInputDisabled:d("ie")?"disabled":"",required:!1,state:"",message:"",tooltipPosition:[],emptyLabel:"\x26#160;",_isLoaded:!1,_childrenLoaded:!1,labelType:"html",_fillContent:function(){this.inherited(arguments);
if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this._set("value",this.options[0<=a?a:0].value)}this.dropDown=new A({id:this.id+"_menu",parentWidget:this});f.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "))},_getMenuItemForOption:function(a){if(a.value||a.label){var b=m.hitch(this,"_setValueAttr",a);a=new t({option:a,label:("text"===this.labelType?(a.label||"").toString().replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a.label)||this.emptyLabel,
onClick:b,ownerDocument:this.ownerDocument,dir:this.dir,textDir:this.textDir,disabled:a.disabled||!1});a.focusNode.setAttribute("role","option");return a}return new r({ownerDocument:this.ownerDocument})},_addOptionItem:function(a){this.dropDown&&this.dropDown.addChild(this._getMenuItemForOption(a))},_getChildren:function(){return this.dropDown?this.dropDown.getChildren():[]},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(z){}},focusChild:function(a){a&&this.set("value",
a.option)},_getFirst:function(){var a=this._getChildren();return a.length?a[0]:null},_getLast:function(){var a=this._getChildren();return a.length?a[a.length-1]:null},childSelector:function(a){return(a=w.byNode(a))&&a.getParent()==this.dropDown},onKeyboardSearch:function(a,b,c,d){a&&this.focusChild(a)},_loadChildren:function(a){if(!0===a)if(this.dropDown&&(delete this.dropDown.focusedChild,this.focusedChild=null),this.options.length)this.inherited(arguments);else{h.forEach(this._getChildren(),function(a){a.destroyRecursive()});
var b=new t({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(b)}else this._updateSelection();this._isLoaded=!1;this._childrenLoaded=!0;this._loadingStore||this._setValueAttr(this.value,!1)},_refreshState:function(){this._started&&this.validate(this.focused)},startup:function(){this.inherited(arguments);this._refreshState()},_setValueAttr:function(b){this.inherited(arguments);a.set(this.valueNode,"value",this.get("value"));this._refreshState()},_setNameAttr:"valueNode",
_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setOptionsAttr:function(a){this._isLoaded=!1;this._set("options",a)},_setDisplay:function(a){a=("text"===this.labelType?(a||"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a)||this.emptyLabel;this.containerNode.innerHTML='\x3cspan role\x3d"option" aria-selected\x3d"true" class\x3d"dijitReset dijitInline '+
this.baseClass.replace(/\s+|$/g,"Label ")+'"\x3e'+a+"\x3c/span\x3e"},validate:function(a){a=this.disabled||this.isValid(a);this._set("state",a?"":this._hasBeenBlurred?"Error":"Incomplete");this.focusNode.setAttribute("aria-invalid",a?"false":"true");var b=a?"":this._missingMsg;b&&this.focused&&this._hasBeenBlurred?v.show(b,this.domNode,this.tooltipPosition,!this.isLeftToRight()):v.hide(this.domNode);this._set("message",b);return a},isValid:function(){return!this.required||0===this.value||!/^\s*$/.test(this.value||
"")},reset:function(){this.inherited(arguments);v.hide(this.domNode);this._refreshState()},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=e.getLocalization("dijit.form","validate",this.lang).missingMessage},postCreate:function(){this.inherited(arguments);this.own(g(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}));this.domNode.setAttribute("aria-expanded","false");var a=this._keyNavCodes;delete a[l.LEFT_ARROW];delete a[l.RIGHT_ARROW]},_setStyleAttr:function(a){this.inherited(arguments);
f.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width)},isLoaded:function(){return this._isLoaded},loadDropDown:function(a){this._loadChildren(!0);this._isLoaded=!0;a()},destroy:function(a){this.dropDown&&!this.dropDown._destroyed&&(this.dropDown.destroyRecursive(a),delete this.dropDown);v.hide(this.domNode);this.inherited(arguments)},_onFocus:function(){this.validate(!0)},_onBlur:function(){v.hide(this.domNode);this.inherited(arguments);this.validate(!1)}});
d("dojo-bidi")&&(b=k("dijit.form.Select",b,{_setDisplay:function(a){this.inherited(arguments);this.applyTextDir(this.containerNode)}}));b._Menu=A;b.prototype._onContainerKeydown=y("_onContainerKeydown");b.prototype._onContainerKeypress=y("_onContainerKeypress");return b})},"dijit/form/_FormSelectWidget":function(){define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q){return b("dijit.form._FormSelectWidget",q,{multiple:!1,options:null,store:null,_setStoreAttr:function(a){this._created&&this._deprecatedSetStore(a)},query:null,_setQueryAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{query:a})},queryOptions:null,_setQueryOptionsAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{queryOptions:a})},labelAttr:"",onFetch:null,sortByLabel:!0,loadChildrenOnOpen:!1,
onLoadDeferred:null,getOptions:function(a){var b=this.options||[];if(null==a)return b;if(g.isArrayLike(a))return h.map(a,"return this.getOptions(item);",this);g.isString(a)&&(a={value:a});g.isObject(a)&&(h.some(b,function(b,c){for(var d in a)if(!(d in b)||b[d]!=a[d])return!1;a=c;return!0})||(a=-1));return 0<=a&&a<b.length?b[a]:null},addOption:function(a){h.forEach(g.isArrayLike(a)?a:[a],function(a){a&&g.isObject(a)&&this.options.push(a)},this);this._loadChildren()},removeOption:function(a){a=this.getOptions(g.isArrayLike(a)?
a:[a]);h.forEach(a,function(a){a&&(this.options=h.filter(this.options,function(b){return b.value!==a.value||b.label!==a.label}),this._removeOptionItem(a))},this);this._loadChildren()},updateOption:function(a){h.forEach(g.isArrayLike(a)?a:[a],function(a){var b=this.getOptions({value:a.value}),c;if(b)for(c in a)b[c]=a[c]},this);this._loadChildren()},setStore:function(a,b,c){m.deprecated(this.declaredClass+"::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
"","2.0");this._deprecatedSetStore(a,b,c)},_deprecatedSetStore:function(b,d,e){var l=this.store;e=e||{};if(l!==b){for(var m;m=this._notifyConnections.pop();)m.remove();b.get||(g.mixin(b,{_oldAPI:!0,get:function(a){var b=new k;this.fetchItemByIdentity({identity:a,onItem:function(a){b.resolve(a)},onError:function(a){b.reject(a)}});return b.promise},query:function(a,b){var c=new k(function(){d.abort&&d.abort()});c.total=new k;var d=this.fetch(g.mixin({query:a,onBegin:function(a){c.total.resolve(a)},
onComplete:function(a){c.resolve(a)},onError:function(a){c.reject(a)}},b));return new n(c)}}),b.getFeatures()["dojo.data.api.Notification"]&&(this._notifyConnections=[a.after(b,"onNew",g.hitch(this,"_onNewItem"),!0),a.after(b,"onDelete",g.hitch(this,"_onDeleteItem"),!0),a.after(b,"onSet",g.hitch(this,"_onSetItem"),!0)]));this._set("store",b)}this.options&&this.options.length&&this.removeOption(this.options);this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&
(this._observeHandle.remove(),this._observeHandle=null);e.query&&this._set("query",e.query);e.queryOptions&&this._set("queryOptions",e.queryOptions);b&&b.query&&(this._loadingStore=!0,this.onLoadDeferred=new k,this._queryRes=b.query(this.query,this.queryOptions),c(this._queryRes,g.hitch(this,function(a){if(this.sortByLabel&&!e.sort&&a.length)if(b.getValue)a.sort(f.createSortFunction([{attribute:b.getLabelAttributes(a[0])[0]}],b));else{var c=this.labelAttr;a.sort(function(a,b){return a[c]>b[c]?1:b[c]>
a[c]?-1:0})}e.onFetch&&(a=e.onFetch.call(this,a,e));h.forEach(a,function(a){this._addOptionForItem(a)},this);this._queryRes.observe&&(this._observeHandle=this._queryRes.observe(g.hitch(this,function(a,b,c){b==c?this._onSetItem(a):(-1!=b&&this._onDeleteItem(a),-1!=c&&this._onNewItem(a))}),!0));this._loadingStore=!1;this.set("value","_pendingValue"in this?this._pendingValue:d);delete this._pendingValue;this.loadChildrenOnOpen?this._pseudoLoadChildren(a):this._loadChildren();this.onLoadDeferred.resolve(!0);
this.onSetStore()}),g.hitch(this,function(a){console.error("dijit.form.Select: "+a.toString());this.onLoadDeferred.reject(a)})));return l},_setValueAttr:function(a,b){this._onChangeActive||(b=null);if(this._loadingStore)this._pendingValue=a;else if(null!=a){a=g.isArrayLike(a)?h.map(a,function(a){return g.isObject(a)?a:{value:a}}):g.isObject(a)?[a]:[{value:a}];a=h.filter(this.getOptions(a),function(a){return a&&a.value});var c=this.getOptions()||[];this.multiple||a[0]&&a[0].value||!c.length||(a[0]=
c[0]);h.forEach(c,function(b){b.selected=h.some(a,function(a){return a.value===b.value})});c=h.map(a,function(a){return a.value});if("undefined"!=typeof c&&"undefined"!=typeof c[0]){var d=h.map(a,function(a){return a.label});this._setDisplay(this.multiple?d:d[0]);this.inherited(arguments,[this.multiple?c:c[0],b]);this._updateSelection()}}},_getDisplayedValueAttr:function(){var a=h.map([].concat(this.get("selectedOptions")),function(a){return a&&"label"in a?a.label:a?a.value:null},this);return this.multiple?
a:a[0]},_setDisplayedValueAttr:function(a){this.set("value",this.getOptions("string"==typeof a?{label:a}:a))},_loadChildren:function(){this._loadingStore||(h.forEach(this._getChildren(),function(a){a.destroyRecursive()}),h.forEach(this.options,this._addOptionItem,this),this._updateSelection())},_updateSelection:function(){this.focusedChild=null;this._set("value",this._getValueFromOpts());var a=[].concat(this.value);if(a&&a[0]){var b=this;h.forEach(this._getChildren(),function(c){var d=h.some(a,function(a){return c.option&&
a===c.option.value});d&&!b.multiple&&(b.focusedChild=c);l.toggle(c.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),d);c.domNode.setAttribute("aria-selected",d?"true":"false")},this)}},_getValueFromOpts:function(){var a=this.getOptions()||[];if(!this.multiple&&a.length){var b=h.filter(a,function(a){return a.selected})[0];if(b&&b.value)return b.value;a[0].selected=!0;return a[0].value}return this.multiple?h.map(h.filter(a,function(a){return a.selected}),function(a){return a.value})||[]:""},
_onNewItem:function(a,b){b&&b.parent||this._addOptionForItem(a)},_onDeleteItem:function(a){this.removeOption({value:this.store.getIdentity(a)})},_onSetItem:function(a){this.updateOption(this._getOptionObjForItem(a))},_getOptionObjForItem:function(a){var b=this.store,c=this.labelAttr&&this.labelAttr in a?a[this.labelAttr]:b.getLabel(a);return{value:c?b.getIdentity(a):null,label:c,item:a}},_addOptionForItem:function(a){var b=this.store;b.isItemLoaded&&!b.isItemLoaded(a)?b.loadItem({item:a,onItem:function(a){this._addOptionForItem(a)},
scope:this}):(a=this._getOptionObjForItem(a),this.addOption(a))},constructor:function(a){this._oValue=(a||{}).value||null;this._notifyConnections=[]},buildRendering:function(){this.inherited(arguments);e.setSelectable(this.focusNode,!1)},_fillContent:function(){this.options||(this.options=this.srcNodeRef?d("\x3e *",this.srcNodeRef).map(function(a){return"separator"===a.getAttribute("type")?{value:"",label:"",selected:!1,disabled:!1}:{value:a.getAttribute("data-"+m._scopeName+"-value")||a.getAttribute("value"),
label:String(a.innerHTML),selected:a.getAttribute("selected")||!1,disabled:a.getAttribute("disabled")||!1}},this):[]);this.value?this.multiple&&"string"==typeof this.value&&this._set("value",this.value.split(",")):this._set("value",this._getValueFromOpts())},postCreate:function(){this.inherited(arguments);a.after(this,"onChange",g.hitch(this,"_updateSelection"));var b=this.store;b&&(b.getIdentity||b.getFeatures()["dojo.data.api.Identity"])&&(this.store=null,this._deprecatedSetStore(b,this._oValue,
{query:this.query,queryOptions:this.queryOptions}));this._storeInitialized=!0},startup:function(){this._loadChildren();this.inherited(arguments)},destroy:function(){for(var a;a=this._notifyConnections.pop();)a.remove();this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&(this._observeHandle.remove(),this._observeHandle=null);this.inherited(arguments)},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return[]},
_getSelectedOptionsAttr:function(){return this.getOptions({selected:!0})},_pseudoLoadChildren:function(){},onSetStore:function(){}})})},"dojo/data/ObjectStore":function(){define("../_base/lang ../Evented ../_base/declare ../_base/Deferred ../_base/array ../_base/connect ../regexp".split(" "),function(h,k,a,f,b,e,l){function m(a){return"*"==a?".*":"?"==a?".":a}return a("dojo.data.ObjectStore",[k],{objectStore:null,constructor:function(a){this._dirtyObjects=[];a.labelAttribute&&(a.labelProperty=a.labelAttribute);
h.mixin(this,a)},labelProperty:"label",getValue:function(a,b,c){return"function"===typeof a.get?a.get(b):b in a?a[b]:c},getValues:function(a,b){var c=this.getValue(a,b);return c instanceof Array?c:void 0===c?[]:[c]},getAttributes:function(a){var b=[],c;for(c in a)!a.hasOwnProperty(c)||"_"==c.charAt(0)&&"_"==c.charAt(1)||b.push(c);return b},hasAttribute:function(a,b){return b in a},containsValue:function(a,d,c){return-1<b.indexOf(this.getValues(a,d),c)},isItem:function(a){return"object"==typeof a&&
a&&!(a instanceof Date)},isItemLoaded:function(a){return a&&"function"!==typeof a.load},loadItem:function(a){var b;"function"===typeof a.item.load?f.when(a.item.load(),function(c){b=c;var d=c instanceof Error?a.onError:a.onItem;d&&d.call(a.scope,c)}):a.onItem&&a.onItem.call(a.scope,a.item);return b},close:function(a){return a&&a.abort&&a.abort()},fetch:function(a){function d(b){a.onError&&a.onError.call(e,b,a)}a=h.delegate(a,a&&a.queryOptions);var c=this,e=a.scope||c,g=a.query;if("object"==typeof g){var g=
h.delegate(g),k;for(k in g){var r=g[k];"string"==typeof r&&(g[k]=RegExp("^"+l.escapeString(r,"*?\\").replace(/\\.|\*|\?/g,m)+"$",a.ignoreCase?"mi":"m"),g[k].toString=function(a){return function(){return a}}(r))}}var v=this.objectStore.query(g,a);f.when(v.total,function(b){f.when(v,function(c){a.onBegin&&a.onBegin.call(e,b||c.length,a);if(a.onItem)for(var d=0;d<c.length;d++)a.onItem.call(e,c[d],a);a.onComplete&&a.onComplete.call(e,a.onItem?null:c,a);return c},d)},d);a.abort=function(){v.cancel&&v.cancel()};
v.observe&&(this.observing&&this.observing.cancel(),this.observing=v.observe(function(a,d,e){if(-1==b.indexOf(c._dirtyObjects,a))if(-1==d)c.onNew(a);else if(-1==e)c.onDelete(a);else for(var f in a)if(f!=c.objectStore.idProperty)c.onSet(a,f,null,a[f])},!0));this.onFetch(v);a.store=this;return a},getFeatures:function(){return{"dojo.data.api.Read":!!this.objectStore.get,"dojo.data.api.Identity":!0,"dojo.data.api.Write":!!this.objectStore.put,"dojo.data.api.Notification":!0}},getLabel:function(a){if(this.isItem(a))return this.getValue(a,
this.labelProperty)},getLabelAttributes:function(a){return[this.labelProperty]},getIdentity:function(a){return this.objectStore.getIdentity?this.objectStore.getIdentity(a):a[this.objectStore.idProperty||"id"]},getIdentityAttributes:function(a){return[this.objectStore.idProperty]},fetchItemByIdentity:function(a){var b;f.when(this.objectStore.get(a.identity),function(c){b=c;a.onItem.call(a.scope,c)},function(b){a.onError.call(a.scope,b)});return b},newItem:function(a,b){if(b){var c=this.getValue(b.parent,
b.attribute,[]),c=c.concat([a]);a.__parent=c;this.setValue(b.parent,b.attribute,c)}this._dirtyObjects.push({object:a,save:!0});this.onNew(a);return a},deleteItem:function(a){this.changing(a,!0);this.onDelete(a)},setValue:function(a,b,c){var d=a[b];this.changing(a);a[b]=c;this.onSet(a,b,d,c)},setValues:function(a,b,c){if(!h.isArray(c))throw Error("setValues expects to be passed an Array object as its value");this.setValue(a,b,c)},unsetAttribute:function(a,b){this.changing(a);var c=a[b];delete a[b];
this.onSet(a,b,c,void 0)},changing:function(a,b){a.__isDirty=!0;for(var c=0;c<this._dirtyObjects.length;c++){var d=this._dirtyObjects[c];if(a==d.object){b&&(d.object=!1,this._saveNotNeeded||(d.save=!0));return}}d=a instanceof Array?[]:{};for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);this._dirtyObjects.push({object:!b&&a,old:d,save:!this._saveNotNeeded})},save:function(a){a=a||{};var b,c=[],g=[],h=this,l=this._dirtyObjects,m=l.length;try{e.connect(a,"onError",function(){if(!1!==a.revertOnError){var b=
l;l=g;h.revert();h._dirtyObjects=b}else h._dirtyObjects=l.concat(g)});if(this.objectStore.transaction)var k=this.objectStore.transaction();for(var u=0;u<l.length;u++){var w=l[u],x=w.object,y=w.old;delete x.__isDirty;x?b=this.objectStore.put(x,{overwrite:!!y}):"undefined"!=typeof y&&(b=this.objectStore.remove(this.getIdentity(y)));g.push(w);l.splice(u--,1);f.when(b,function(b){--m||a.onComplete&&a.onComplete.call(a.scope,c)},function(b){m=-1;a.onError.call(a.scope,b)})}k&&k.commit()}catch(A){a.onError.call(a.scope,
value)}},revert:function(){for(var a=this._dirtyObjects,b=a.length;0<b;){b--;var c=a[b],e=c.object,c=c.old;if(e&&c){for(var f in c)c.hasOwnProperty(f)&&e[f]!==c[f]&&(this.onSet(e,f,e[f],c[f]),e[f]=c[f]);for(f in e)c.hasOwnProperty(f)||(this.onSet(e,f,e[f]),delete e[f])}else if(c)this.onNew(c);else this.onDelete(e);delete (e||c).__isDirty;a.splice(b,1)}},isDirty:function(a){return a?a.__isDirty:!!this._dirtyObjects.length},onSet:function(){},onNew:function(){},onDelete:function(){},onFetch:function(a){}})})},
"esri/dijit/Search":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/normalizeUtils ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J,L,M,H,K,P,O,S,Q,R,aa,X,T){k=k([w,x,y,b],{declaredClass:"esri.dijit.Search",templateString:u,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(b,c){this.css={searchGroup:"searchGroup",searchInput:"searchInput",searchInputGroup:"searchInputGroup",searchBtn:"searchBtn",searchSubmit:"searchSubmit",searchIcon:"searchIcon esri-icon-search",searchButtonText:"searchButtonText",searchToggle:"searchToggle",searchToggleIcon:"searchIcon esri-icon-down-arrow",
searchMenu:"searchMenu",searchMenuHeader:"menuHeader",searchClear:"searchClear",searchClearIcon:"searchIcon esri-icon-close searchClose",searchSpinner:"searchIcon esri-icon-loading-indicator searchSpinner",searchSourceName:"sourceName",suggestionsMenu:"suggestionsMenu",sourcesMenu:"sourcesMenu",activeSource:"active",hasValue:"hasValue",hasButtonMode:"hasButtonMode",hasMultipleSources:"hasMultipleSources",showSuggestions:"showSuggestions",showSources:"showSources",showNoResults:"showNoResults",searchLoading:"searchLoading",
latLonHeader:"searchLatLongHeader",searchMoreResults:"moreResults",searchMoreResultsList:"resultsList",searchMoreResultsHeader:"moreHeader",searchMoreResultsItem:"moreItem",searchMoreResultsListHeader:"popupHeader",searchShowMoreResults:"showMoreResults",searchNoResultsMenu:"noResultsMenu",searchNoResultsBody:"noResultsBody",searchNoResultsHeader:"noResultsHeader",searchNoValueIcon:"noValueIcon esri-icon-notice-triangle",searchNoValueText:"noValueText",searchNoResultsText:"noResultsText",searchExpandContainer:"searchExpandContainer",
searchAnimateContainer:"searchAnimate",searchExpanded:"searchExpanded",searchCollapsed:"searchCollapsed",searchClearFloat:"searchClearFloat"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this._sourceNames=[];this.defaultSource={locator:new R("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),singleLineFieldName:"SingleLine",outFields:["Addr_type","Match_addr","StAddr","City"],name:v.widgets.Search.main.esriLocatorName,localSearchOptions:{minScale:3E5,
distance:5E4},placeholder:v.widgets.Search.main.placeholder,highlightSymbol:(new I(h.toUrl("./Search/images/search-pointer.png"),36,36)).setOffset(9,18)};this.options={map:null,theme:"arcgisSearch",visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:150,enableSourcesMenu:!0,enableSuggestionsMenu:!0,enableInfoWindow:!0,showInfoWindowOnSelect:!0,enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,
graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,enableLabel:!1,labelSymbol:(new H).setColor(new X([181,56,46,.9])).setFont(new K("14px",K.STYLE_NORMAL,K.VARIANT_NORMAL,K.WEIGHT_BOLD,"Arial")),labelGraphic:null,infoTemplate:new C(v.widgets.Search.main.searchResult,'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),
searchResults:null,suggestResults:null,selectedResult:null,magicKey:null,selectedFeatureId:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:1,enableSearchingAll:!0};var d=a.mixin({},this.options,b);this.set(d);this._updateActiveSource();this._i18n=v;this._defaultSR=new E(4326);this.domNode=c},startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);this._mapLoaded().then(a.hitch(this,this._init))},postCreate:function(){var b=
this;this.inherited(arguments);this._moreResultsId=this.id+"_more_results";this.own(m(this.submitNode,A,a.hitch(this,this._searchButton)));this.own(m(this.sourcesBtnNode,A,a.hitch(this,this._toggleSourcesMenu)));this.own(m(this.inputNode,A,a.hitch(this,this._inputClick)));this.own(m(this.clearNode,A,a.hitch(this,this._clearButton)));this.own(m(this.formNode,"submit",a.hitch(this,function(a){a.preventDefault();this._cancelSuggest();this.search()})));this.own(m(this.inputNode,"keyup",a.hitch(this,function(a){this._inputKey(a)})));
this.own(m(this.sourcesBtnNode,"keyup",a.hitch(this,function(a){this._sourceBtnKey(a)})));this.own(m(this.suggestionsNode,"li:click, li:keyup",function(a){b._suggestionsEvent(a,this)}));this.own(m(this.sourcesNode,"li:click, li:keyup",function(a){b._sourcesEvent(a,this)}));this.own(m(this.inputNode,"input, paste",a.hitch(this,function(){this._suggestDelay()})));this.map&&this.map.infoWindow&&this.map.infoWindow.domNode&&this.enableInfoWindow&&(this.own(m(this.map.infoWindow.domNode,"#"+this._moreResultsId+
"_show:click",a.hitch(this,function(a){this._showMoreResultsClick(a)}))),this.own(m(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_list li a:click",a.hitch(this,function(a){this._moreResultsClick(a)}))),this.own(m(this.map.infoWindow.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",a.hitch(this,function(a){this._switchCoordinatesClick(a)}))));this.value&&this._checkStatus();this._hideMenus();this._updateVisible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);
this._updateButtonMode(this.enableButtonMode);this.toggle(this.expanded)},destroy:function(){this.clear();r.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();n.get(this.inputNode,"value")&&n.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);this.set("magicKey",null);this.set("selectedFeatureId",null);q.remove(this.containerNode,this.css.hasValue);n.set(this.clearNode,
"title","");this._hideMenus();this._closePopup();this._hideLoading();this.emit("clear-search")},show:function(){t.set(this.domNode,"display","block")},hide:function(){t.set(this.domNode,"display","none")},expand:function(){this.enableButtonMode&&(q.add(this.containerNode,this.css.searchExpanded),q.remove(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!0))},collapse:function(){this.enableButtonMode&&(q.remove(this.containerNode,this.css.searchExpanded),q.add(this.containerNode,
this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!1))},toggle:function(a){this.enableButtonMode&&("undefined"==typeof a&&(a=!this.expanded),a?this.expand():this.collapse())},search:function(b){var c=new e;return this._mapLoaded().then(a.hitch(this,function(){this._searchDeferred(b).then(a.hitch(this,function(a){var b=a.results;this.set("searchResults",b);0===a.numResults&&(this._noResults(a.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",a);this._selectFirstResult(b,
a.activeSourceIndex);c.resolve(b)}),a.hitch(this,function(a){c.reject(a)}))})),c.promise},suggest:function(b){var c=new e;return this._mapLoaded().then(a.hitch(this,function(){this._suggestDeferred(b).then(a.hitch(this,function(a){if(a){var b=a.results;this.set("suggestResults",b);this._insertSuggestions(b,a.value);this.emit("suggest-results",a);c.resolve(b)}}),a.hitch(this,function(a){c.reject(a)}))})),c.promise},select:function(b){var c,d=this._getDefaultSymbol(b),e=this.labelSymbol,f=this.sources,
g=this.activeSourceIndex,h=this.enableHighlight,l=this.enableLabel,m=this.autoNavigate,k=this.showInfoWindowOnSelect,n=this.enableInfoWindow,q=this.infoTemplate,r=new F(b.feature.toJson());if(g===this._allIndex){var t=this._getSourceIndexOfResult(b);null!==t&&(c=f[t],g=t)}else c=f[g];if(c&&(c.hasOwnProperty("highlightSymbol")&&(d=c.highlightSymbol),c.hasOwnProperty("labelSymbol")&&(e=c.labelSymbol),c.hasOwnProperty("enableHighlight")&&(h=c.enableHighlight),c.hasOwnProperty("enableLabel")&&(l=c.enableLabel),
c.hasOwnProperty("autoNavigate")&&(m=c.autoNavigate),c.hasOwnProperty("showInfoWindowOnSelect")&&(k=c.showInfoWindowOnSelect),c.hasOwnProperty("enableInfoWindow")&&(n=c.enableInfoWindow),c.hasOwnProperty("infoTemplate")?q=c.infoTemplate:c.featureLayer&&c.featureLayer.infoTemplate&&(q=c.featureLayer.infoTemplate)),this._hideMenus(),this._hideLoading(),r){var f=this.highlightGraphic,u=this.graphicsLayer,t=this.labelGraphic,v=a.mixin({},r.attributes,{searchTheme:this.theme,searchResult:this._searchResultHTML(b),
searchMoreResults:this.css.searchMoreResults,searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(b)}),w=null;if(n&&(w=q),t?(t.setGeometry(r.geometry),t.setAttributes(v),t.setSymbol(e),e&&"textsymbol"===e.type&&t.symbol.setText(b.name)):(t=new F(r.geometry,e,v),e&&"textsymbol"===e.type&&t.symbol.setText(b.name),l&&(u?u.add(t):this.map&&this.map.graphics&&this.map.graphics.add(t))),f?(f.setGeometry(r.geometry),f.setAttributes(v),
f.setInfoTemplate(w),f.setSymbol(d)):(f=new F(r.geometry,d,v,w),h&&(u?u.add(f):this.map&&this.map.graphics&&this.map.graphics.add(f))),f&&f.symbol&&"textsymbol"===f.symbol.type&&f.symbol.setText(b.name),this.map&&this.map.infoWindow&&n&&k)this.map.infoWindow.setFeatures([f]),d=this._getPointFromGeometry(f.geometry),this.map.infoWindow.show(d);this.map&&m&&b&&b.hasOwnProperty("extent")&&"function"==typeof this.map.setExtent&&this.map.setExtent(b.extent);this.set("highlightGraphic",f);this.set("labelGraphic",
t)}this.set("selectedResult",b);this.emit("select-result",{result:b,source:c,sourceIndex:g})},focus:function(){z.focus(this.inputNode)},blur:function(){this.inputNode.blur();z.curNode&&z.curNode.blur()},clearGraphics:function(){var a=this.highlightGraphic,b=this.graphicsLayer,c=this.labelGraphic;a&&(b?b.remove(a):this.map&&this.map.graphics&&this.map.graphics.remove(a));c&&(b?b.remove(c):this.map&&this.map.graphics&&this.map.graphics.remove(c));this.set("labelGraphic",null);this.set("highlightGraphic",
null)},_mapLoaded:function(){var b=new e;return this.map?this.map.loaded?b.resolve():m.once(this.map,"load",a.hitch(this,function(){b.resolve()})):b.resolve(),b.promise},_init:function(){this._getMapLayers().then(a.hitch(this,function(){this.set("loaded",!0);this.emit("load")}))},_clearButton:function(){this.clear();z.focus(this.inputNode)},_error:function(a){return Error(this.declaredClass+" "+a)},_searchDeferred:function(b){var c,d=new e,f=this.value,g=this.activeSourceIndex;b&&b.hasOwnProperty("index")&&
(g=b.index);this._showLoading();this._hideMenus();this._closePopup();this.clearGraphics();var h={magicKey:this.magicKey,text:f};return b?"string"==typeof b?(h.text=b,c=this._searchQueries(h)):c="object"==typeof b&&b.hasOwnProperty("magicKey")?this._searchQueries(b):"object"==typeof b&&b.hasOwnProperty("geometry")?this._searchQueries({geometry:b}):"object"==typeof b&&b.hasOwnProperty(this._objectIdIdentifier)?this._searchQueries(b):"object"==typeof b&&"point"===b.type?this._searchQueries({point:b}):
b instanceof Array&&2===b.length?this._searchQueries({latlon:b}):this._searchQueries(h):c=this._searchQueries(h),c.always(a.hitch(this,function(a){a=this._formatResults(a,g,f);d.resolve(a)})),d.promise},_suggestDeferred:function(b){var c,d=new e;this._deferreds.push(d);b||(b=this.value);var f=this.activeSourceIndex;return c=this._suggestQueries({text:b}),c.always(a.hitch(this,function(a){var c;if(a)for(var e=0;e<a.length;e++)a[e]&&(c=!0);c?(a=this._formatResults(a,f,b),d.resolve(a)):d.resolve()})),
d.promise},_getDefaultSymbol:function(a){var b,c,d,e;this.map&&(e=this.map.getBasemap());e||(e="topo");a&&a.feature&&a.feature.geometry&&(d=a.feature.geometry.type);"polyline"===d?d="line":"circle"===d||"extent"===d?d="polygon":"multipoint"===d&&(d="point");if(d&&((a=T.getSchemes({theme:"default",basemap:e,geometryType:d}))&&(c=a.primaryScheme),c)){c.color&&c.hasOwnProperty("opacity")&&(c.color.a=c.opacity);b=c;a=c.color;c=c.size;var f;switch(d){case "point":f=new J;f.setColor(a);f.setSize(null!==
c?c:b.size);d=new L;d.setColor(b.outline.color);d.setWidth(b.outline.width);f.setOutline(d);break;case "line":f=new L;f.setColor(a);f.setWidth(null!==c?c:b.width);break;case "polygon":f=new M,f.setColor(a),d=new L,d.setColor(b.outline.color),d.setWidth(b.outline.width),f.setOutline(d)}b=f}return b},_selectFirstResult:function(a,b){if(this.autoSelect&&a){var c;b===this._allIndex?c=this._getFirstResult(a):a[b]&&a[b][0]&&(c=a[b][0]);c&&this.select(c)}},_getSourceIndexOfResult:function(a){var b=this.searchResults;
if(b)for(var c in b)if(b[c]&&b[c].length)for(var d=0;d<b[c].length;d++)if(b[c][d]===a)return parseInt(c,10);return null},_getFirstResult:function(a){if(a)for(var b in a)if(a[b]&&a[b][0])return a[b][0];return!1},_onFocus:function(){this.map&&"function"==typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation();this.emit("focus");this.inherited(arguments)},_onBlur:function(){this._hideMenus();this.map&&"function"==typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();
this.enableButtonMode&&this.loaded&&this.collapse();this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var b=new e;if(this.addLayersFromMap&&this.map){var c=[],d=this.map.graphicsLayerIds;if(d&&d.length){for(var f=0;f<d.length;f++){var g=this.map.getLayer(d[f]);g&&c.push(this._featureLayerLoaded(g))}G(c).always(a.hitch(this,function(a){for(var c,d=this.sources,e=0;e<a.length;e++)a[e]&&a[e].loaded&&"Feature Layer"===a[e].type&&(d.push({featureLayer:a[e],enableSuggestions:!0}),c=
!0);c&&this.set("sources",d);b.resolve()}))}else b.resolve()}else b.resolve();return b.promise},_switchCoordinatesClick:function(a){a.preventDefault();(a=n.get(a.target,"data-switch-coordinates"))&&(this._cancelSuggest(),this.set("value",a),this.search())},_moreResultsClick:function(a){a.preventDefault();var b=a.target;a=parseInt(n.get(b,"data-source-index"),10);var b=parseInt(n.get(b,"data-index"),10),c=this.searchResults;c&&c[a]&&(a=c[a][b])&&this.select(a)},_showMoreResultsClick:function(a){a.preventDefault();
if(a=c.byId(this._moreResultsId)){q.toggle(a,this.css.searchShowMoreResults);var b=c.byId(this._moreResultsId+"_show");b&&(q.contains(a,this.css.searchShowMoreResults)?n.set(b,"textContent",v.widgets.Search.main.hideMoreResults):n.set(b,"textContent",v.widgets.Search.main.showMoreResults))}},_featureLayerLoaded:function(b){var c=new e;if(b.loaded)c.resolve(b);else if(b.loadError)c.reject(this._error("Layer failed to load."));else{var d,f;d=m.once(b,"load",a.hitch(this,function(){f.remove();c.resolve(b)}));
f=m.once(b,"error",a.hitch(this,function(){d.remove();c.reject(this._error("Layer could not be loaded."))}))}return c.promise},_getObjectSize:function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},_sourcesEvent:function(a,b){var c=n.get(b,"data-index"),d=g("li",this.sourcesNode),e=f.indexOf(d,b);c!==this._allIndex&&(c=parseInt(c,10));var h;"click"===a.type||a.keyCode===l.ENTER?(this.set("activeSourceIndex",c),z.focus(this.inputNode),this._hideSourcesMenu()):a.keyCode===l.UP_ARROW?(a.stopPropagation(),
a.preventDefault(),h=e-1,0>h?z.focus(this.sourcesBtnNode):z.focus(d[h])):a.keyCode===l.DOWN_ARROW?(a.stopPropagation(),a.preventDefault(),h=e+1,h>=d.length?z.focus(this.sourcesBtnNode):z.focus(d[h])):a.keyCode===l.ESCAPE&&(this._hideSourcesMenu(),z.focus(this.inputNode))},_suggestionsEvent:function(a,b){var c=n.get(b,"data-source-index"),d=parseInt(n.get(b,"data-index"),10),e=g("li",this.suggestionsNode),h=this.sources,m=f.indexOf(e,b);c!==this._allIndex&&(c=parseInt(c,10));var k;if(this._clearQueryTimeout(),
"click"===a.type||a.keyCode===l.ENTER){var q,e=this.suggestResults;if(e&&e[c]&&e[c][d]&&(q=e[c][d]),q)(q.index=c,h[c].featureLayer)?(c=h[c].featureLayer.objectIdField,q[this._objectIdIdentifier]=q.feature.attributes[c],this.set("value",this._getSuggestionName(q)),this.set("selectedFeatureId",q.feature.attributes[c])):q.magicKey&&q.text&&(this.set("value",q.text),this.set("magicKey",q.magicKey)),this.search(q),z.focus(this.inputNode)}else a.keyCode===l.BACKSPACE||a.keyCode===l.DELETE?z.focus(this.inputNode):
a.keyCode===l.UP_ARROW?(a.stopPropagation(),a.preventDefault(),k=m-1,0>k?z.focus(this.inputNode):z.focus(e[k])):a.keyCode===l.DOWN_ARROW?(a.stopPropagation(),a.preventDefault(),k=m+1,k>=e.length?z.focus(this.inputNode):z.focus(e[k])):a.keyCode===l.ESCAPE&&(this._hideMenus(),z.focus(this.inputNode))},_getResultName:function(a){var b;return a.hasOwnProperty("name")&&null!==a.name&&(b=a.name.toString()),b||(b=v.widgets.Search.main.untitledResult),b},_getSuggestionName:function(a){var b,c;return a.hasOwnProperty("name")&&
null!==a.name&&(c=a.name.toString()),b=a.text||c,b||(b=v.widgets.Search.main.untitledResult),b},_searchResultHTML:function(a){var b="";if(a.feature&&a.feature.attributes&&a.feature.attributes.Addr_type&&"LatLong"===a.feature.attributes.Addr_type){var c,d,e=a.name.split(" ");(2===e.length&&(c=e[0],d=e[1]),d&&c)?(a=parseFloat(c),d=parseFloat(d),c=d+", "+a,b+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e',b+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+v.widgets.Search.main.lonlat+
"\x3c/div\x3e",b=b+(a+", "+d)+"\x3c/div\x3e",b+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e',a===d||90<a||-90>a||180<d||-180>d||(b+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+v.widgets.Search.main.reverseLonLatHeader+"\x3c/div\x3e",b+='\x3ca data-switch-coordinates\x3d"'+c+'" tabindex\x3d"0" href\x3d"#"\x3e'+c+"\x3c/a\x3e",b+="\x3c/div\x3e")):b=a.name}else b=a.name;return b},_moreResultsHTML:function(a){var b="",c="",d=this.searchResults,e=this.sources,f=0;if(d){var c=c+('\x3cdiv class\x3d"'+
this.css.searchMoreResultsItem+'"\x3e'),c=c+('\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+v.widgets.Search.main.showMoreResults+"\x3c/a\x3e"),c=c+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsList+'"\x3e'),c=c+('\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e'),g;for(g in d)if(d[g]){var h=d[g].length;if(h){var l=1===h&&d[g][0]===a;if(1<this._getObjectSize(d)&&!l)var m=this._getSourceName(g),c=c+('\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+m+
"\x3c/div\x3e");if(h&&!l){c+="\x3cul\x3e";m=e[g].maxResults||this.maxResults;for(l=0;h>l&&m>l;++l)if(d[g][l]!==a){var k=this._getResultName(d[g][l]),c=c+('\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+l+'" data-source-index\x3d"'+g+'" href\x3d"#"\x3e'+k+"\x3c/a\x3e\x3c/li\x3e");f++}c+="\x3c/ul\x3e"}}}c+="\x3c/div\x3e\x3c/div\x3e"}return f&&(b+=c),b},_validField:function(a,b){return a.getField(b)},_validFields:function(a,b){if(a&&b&&b.length){for(var c=0;c<b.length;c++)if(!this._validField(a,b[c]))return!1;
return!0}return!1},_getCodedName:function(a,b){if(a&&a.length)for(var c=0,d=a.length;d>c;c++){var e=a[c];if(e.code===b)return e.name}},_getCodedValue:function(a,b,c){if(a&&a.length)for(var d=0,e=a.length;e>d;d++){var f=a[d],g=f.name,h=b;if(c||(g=g.toLowerCase(),h=h.toLowerCase()),g===h)return f.code}return!1},_whereClause:function(a,b,c,d){var e=null;if(a){var f="";if(this.reHostedFS.test(b.url)&&this._containsNonLatinCharacter(a)&&(f="N"),c&&c.length)for(var g=0,h=c.length;h>g;g++){var l="",m=a.replace(/\'/g,
"''"),l=c[g],k=b.getField(l),n=b.getDomain(l);if(n&&"codedValue"===n.type&&(m=this._getCodedValue(n.codedValues,m,d)),!1!==m)k=k.type,"esriFieldTypeString"===k||"esriFieldTypeDate"===k?l=d?l+" \x3d "+f+"'"+m+"'":"UPPER("+l+") LIKE "+f+"'%"+m.toUpperCase()+"%'":"esriFieldTypeOID"===k||"esriFieldTypeSmallInteger"===k||"esriFieldTypeInteger"===k||"esriFieldTypeSingle"===k||"esriFieldTypeDouble"===k?(m=parseFloat(m),l=isNaN(m)?!1:l+" \x3d "+m):l=l+" \x3d "+m,l&&(e?e+=" or ":e="",e+=l)}}return e},_suggest:function(b){b||
(b={index:this.activeSourceIndex,text:this.value});var c=new e,d=b.index,g=this.sources[d],h=this.enableSuggestions;g.hasOwnProperty("enableSuggestions")&&(h=g.enableSuggestions);var l,m=0;b.hasOwnProperty("text")&&b.text&&(l=a.trim(b.text),m=b.text.length);b=g.minCharacters||this.minCharacters;if(h&&l&&m>=b&&this._supportsPagination(g)){var k="";g.prefix&&(k+=g.prefix);k+=l;g.suffix&&(k+=g.suffix);var n=this._defaultSR;this.map&&(n=this.map.spatialReference);h={};if(g.locator){if(g.categories&&(h.categories=
g.categories),g.locator.outSpatialReference=n,this.map&&g.localSearchOptions&&g.localSearchOptions.hasOwnProperty("distance")&&g.localSearchOptions.hasOwnProperty("minScale"))l=this._getScale(),(!g.localSearchOptions.minScale||l&&l<=parseFloat(g.localSearchOptions.minScale))&&(h.location=this.map.extent.getCenter(),h.distance=g.localSearchOptions.distance);h.text=k;g.useMapExtent&&this.map&&this.map.extent&&(h.searchExtent=this.map.extent);g.searchExtent&&(h.searchExtent=g.searchExtent);h.maxSuggestions=
g.maxSuggestions||this.maxSuggestions;g.sourceCountry&&(h.countryCode=g.sourceCountry);g.countryCode&&(h.countryCode=g.countryCode);g.locator.suggestLocations(h).then(a.hitch(this,function(a){c.resolve(a)}),a.hitch(this,function(a){a||(a=this._error("Locator suggestLocations could not be performed."));c.reject(a)}))}else g.featureLayer?this._featureLayerLoaded(g.featureLayer).then(a.hitch(this,function(){var b=this._getDisplayField(g),e=g.searchFields||[b],h=[];g.suggestionTemplate?g.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,
function(a,b){h.push(b)}):h=[b];-1===f.indexOf(h,g.featureLayer.objectIdField)&&h.push(g.featureLayer.objectIdField);var b=this._validField(g.featureLayer,b),l=this._validFields(g.featureLayer,h),m=this._validFields(g.featureLayer,e);if(b&&l&&m){b=new aa;g.hasOwnProperty("suggestQueryParams")&&a.mixin(b,g.suggestQueryParams);b.outSpatialReference=n;b.returnGeometry=!1;b.num=g.maxSuggestions||this.maxSuggestions;b.outFields=h;g.useMapExtent&&this.map&&this.map.extent&&(b.geometry=this.map.extent);
g.searchExtent&&(b.geometry=g.searchExtent);var q;(e=this._whereClause(k,g.featureLayer,e,!1))&&(b.where=e,q=!0);q?g.featureLayer.queryFeatures(b,a.hitch(this,function(a){var b;(a=a.features)&&(b=this._hydrateResults(a,d,!0));c.resolve(b)}),a.hitch(this,function(a){a||(a=this._error("FeatureLayer queryFeatures errored with suggestions"));c.reject(a)})):c.resolve()}else c.reject(this._error("Invalid FeatureLayer field"))})):c.reject(this._error("Invalid source"))}else c.resolve();return c.promise},
_supportsPagination:function(a){var b;return a.locator?b=!0:a.featureLayer&&a.featureLayer.advancedQueryCapabilities&&a.featureLayer.advancedQueryCapabilities.supportsPagination&&(b=!0),b},_suggestQueries:function(a){var b,c=this.sources,d=this.activeSourceIndex,e=[];if(d===this._allIndex)for(d=0;d<c.length;d++)b=a,b.index=d,b=this._suggest(b),e.push(b);else a.index=d,b=this._suggest(a),e.push(b);return G(e)},_getPointFromGeometry:function(a){var b;switch(a.type){case "extent":b=a.getCenter();break;
case "multipoint":b=a.getPoint(0);break;case "point":b=a;break;case "polygon":b=a.getCentroid();break;case "polyline":b=a.getPoint(0,0)}return b},_searchQueries:function(a){a.hasOwnProperty("index")||(a.index=this.activeSourceIndex);var b,c=[];if(a.index===this._allIndex)for(var d=this.sources,e=0;e<d.length;e++)b=a,b.index=e,b=this._search(b),c.push(b);else a=this._search(a),c.push(a);return G(c)},_searchButton:function(){this.enableButtonMode&&!this.expanded?(this.expand(),z.focus(this.inputNode)):
(this._cancelSuggest(),this.search())},_search:function(b){b||(b={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});this.selectedFeatureId&&(b.text=null,b[this._objectIdIdentifier]=this.selectedFeatureId);var c,d,f=new e,g=b.index,h=this.sources[g];if(b.hasOwnProperty("text")&&b.text&&(d=a.trim(b.text)),h){var l="";h.prefix&&!b.magicKey&&(l+=h.prefix);l+=d;h.suffix&&!b.magicKey&&(l+=h.suffix);var m=this._defaultSR;if(this.map&&(m=this.map.spatialReference),
h.locator)if(b.hasOwnProperty("text")&&d){var k={};if(h.categories&&(k.categories=h.categories),m&&(h.locator.outSpatialReference=m),this.map&&h.localSearchOptions&&h.localSearchOptions.hasOwnProperty("distance")&&h.localSearchOptions.hasOwnProperty("minScale")){var n=this._getScale();(!h.localSearchOptions.minScale||n&&n<=parseFloat(h.localSearchOptions.minScale))&&(k.location=this.map.extent.getCenter(),k.distance=h.localSearchOptions.distance)}k.address={};k.maxLocations=h.maxResults||this.maxResults;
h.useMapExtent&&this.map&&this.map.extent&&(k.searchExtent=this.map.extent);h.searchExtent&&(k.searchExtent=h.searchExtent);h.sourceCountry&&(k.countryCode=h.sourceCountry);h.countryCode&&(k.countryCode=h.countryCode);b.magicKey&&(k.magicKey=b.magicKey);h.singleLineFieldName?k.address[h.singleLineFieldName]=l:k.address["Single Line Input"]=l;h.outFields&&(k.outFields=h.outFields);h.locator.addressToLocations(k).then(a.hitch(this,function(a){a=this._hydrateResults(a,g,!1);f.resolve(a)}),a.hitch(this,
function(a){a||(a=this._error("Locator addressToLocations could not be performed"));f.reject(a)}))}else b.geometry?(c=this._getPointFromGeometry(b.geometry.geometry))?this._reverseGeocodePoint(g,c).then(function(a){f.resolve(a)},function(a){f.reject(a)}):f.reject(this._error("Invalid point to reverse geocode")):b.point?this._reverseGeocodePoint(g,b.point).then(function(a){f.resolve(a)},function(a){f.reject(a)}):b.latlon?(k=new P(b.latlon,this._defaultSR),this._reverseGeocodePoint(g,k).then(function(a){f.resolve(a)},
function(a){f.reject(a)})):b.hasOwnProperty("text")&&!d?f.resolve([]):f.reject(this._error("Invalid query type for Locator"));else h.featureLayer?this._featureLayerLoaded(h.featureLayer).then(a.hitch(this,function(){var e=this._getDisplayField(h),k=h.searchFields||[e],e=this._validField(h.featureLayer,e),n=this._validFields(h.featureLayer,k);if(e&&n){e=new aa;if(h.hasOwnProperty("searchQueryParams")&&a.mixin(e,h.searchQueryParams),m)e.outSpatialReference=m,(n=Q.getUnitValueForSR(m))&&(e.maxAllowableOffset=
n);e.returnGeometry=!0;h.outFields&&(e.outFields=h.outFields);var q;b.hasOwnProperty(this._objectIdIdentifier)||(this._supportsPagination(h)&&(e.num=h.maxResults||this.maxResults),h.useMapExtent&&this.map&&this.map.extent&&(e.geometry=this.map.extent),h.searchExtent&&(e.geometry=h.searchExtent),q=h.exactMatch);var r;b.hasOwnProperty("text")&&d?(k=this._whereClause(l,h.featureLayer,k,q))?(e.where=k,r=!0):r=!1:b.hasOwnProperty(this._objectIdIdentifier)?(e.objectIds=[b[this._objectIdIdentifier]],r=!0):
b.geometry?(e.geometry=b.geometry,r=!0):b.point?(e.geometry=b.point,r=!0):b.latlon?(c=new P(b.latlon,this._defaultSR),e.geometry=c,r=!0):b.hasOwnProperty("text")&&!d?(f.resolve([]),r=!1):(f.reject(this._error("Invalid query type for FeatureLayer")),r=!1);r?h.featureLayer.queryFeatures(e,a.hitch(this,function(a){var b;(a=a.features)&&(b=this._hydrateResults(a,g,!1));f.resolve(b)}),a.hitch(this,function(a){a||(a=this._error("FeatureLayer queryFeatures could not be performed"));f.reject(a)})):f.resolve()}else f.reject(this._error("Invalid FeatureLayer field"))})):
f.reject(this._error("Invalid source"))}else f.reject(this._error("Source is undefined"));return f.promise},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_formatResults:function(a,b,c){c={activeSourceIndex:b,value:c,numResults:0,numErrors:0,errors:null,results:null};var d={},e={};if(a)if(b===this._allIndex)for(b=0;b<a.length;b++)a[b]&&(a[b]instanceof Error?(d[b]=a[b],c.numErrors++):(e[b]=a[b],c.numResults+=a[b].length));else a[0]&&(a[0]instanceof Error?(d[b]=a[0],
c.numErrors++):(e[b]=a[0],c.numResults+=a[0].length));return c.numErrors&&(c.errors=d),c.numResults&&(c.results=e),c},_reverseGeocodePoint:function(b,c){var d=new e,f=this.sources[b];if(c&&f){var g=f.locationToAddressDistance||this.locationToAddressDistance;f.locator.outSpatialReference=this._defaultSR;this.map&&(f.locator.outSpatialReference=this.map.spatialReference);f.locator.locationToAddress(c,g,a.hitch(this,function(a){a=this._hydrateResults([a],b,!1);d.resolve(a)}),a.hitch(this,function(a){a||
(a=this._error("Locator locationToAddress could not be performed"));d.reject(a)}))}else d.reject(this._error("No point or source defined for reverse geocoding"));return d.promise},_cancelDeferreds:function(){if(this._deferreds&&this._deferreds.length)for(var a=0;a<this._deferreds.length;a++)this._deferreds[a].cancel(this.declaredClass+" cancelling request");this._deferreds=[]},_sourceBtnKey:function(a){if(a){var b=g("li",this.sourcesNode);a.keyCode===l.UP_ARROW?(a.stopPropagation(),a.preventDefault(),
this._showSourcesMenu(),(a=b.length)&&z.focus(b[a-1])):a.keyCode===l.DOWN_ARROW&&(a.stopPropagation(),a.preventDefault(),this._showSourcesMenu(),b[0]&&z.focus(b[0]))}},_inputKey:function(a){if(a){var b=g("li",this.suggestionsNode),c=this.suggestResults;if(a.keyCode===l.TAB||a.keyCode===l.ESCAPE)this._cancelSuggest(),this._hideMenus();else if(a.keyCode===l.UP_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),c&&this._showSuggestionsMenu(),(a=b.length)&&z.focus(b[a-1]);else if(a.keyCode===
l.DOWN_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),c&&this._showSuggestionsMenu(),b[0]&&z.focus(b[0]);else{if(a.ctrlKey||a.metaKey||a.keyCode===l.copyKey||a.keyCode===l.LEFT_ARROW||a.keyCode===l.RIGHT_ARROW||a.keyCode===l.ENTER)return a;this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();this._changeValue();this._queryTimer=setTimeout(a.hitch(this,function(){this.suggest()}),this.suggestionDelay)},
_changeValue:function(){this.set("magicKey",null);this.set("selectedFeatureId",null);this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},_getSourceName:function(a){return this._sourceNames[a]},_loadSources:function(a){a=f.filter(a,function(a){return!!a.featureLayer});a=f.map(a,function(a){return this._featureLayerLoaded(a.featureLayer)},this);return G(a)},_createSourceNameMap:function(b){return this._loadSources(b).then(a.hitch(this,
function(){var a=f.map(b,function(a){return a.name||a.featureLayer&&a.featureLayer.name||v.widgets.Search.main.untitledSource});return this._preventDuplicateSourceNames(b,a),a}))},_getDuplicateSourceNameIndexes:function(a){var b={},c=[];return f.forEach(a,function(d,e){b.hasOwnProperty(d)?(-1===c.indexOf(b[d])&&c.push(b[d]),c.push(e)):a.lastIndexOf(d)!==e&&(b[d]=e)}),c},_preventDuplicateSourceNames:function(a,b){if(b&&1<b.length){var c=this._getDuplicateSourceNameIndexes(b);f.forEach(c,function(c){b[c]+=
this._getFieldsString(a[c])},this)}},_getFieldsString:function(a){var b="",c=a.featureLayer;if(c){a=a.searchFields||[this._getDisplayField(a)];for(var d=0;d<a.length;d++)var b=b+(0===d?": ":", "),e=a[d],f=c.getFieldLabel(e),b=b+(f||e)}return b},_insertSuggestions:function(a,b){if(this.enableSuggestionsMenu&&this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();var c,d=this.sources;if(a){c=r.create("div");for(var e in a)if(a[e]&&a[e].length){var f=this._getSourceName(e);1<d.length&&
this.activeSourceIndex===this._allIndex&&r.create("div",{className:this.css.searchMenuHeader,textContent:f},c);for(var f=r.create("ul",{role:"menu"},c),g=d[e].maxSuggestions||this.maxSuggestions,h=0;h<a[e].length&&g>h;++h)for(var l=r.create("li",{"data-index":h,"data-source-index":e,role:"menuitem",tabindex:0},f),m=new RegExp("("+b+")","gi"),m=this._getSuggestionName(a[e][h]).replace(m,"|$1|").split("|"),k=m.length,n=0;k>n;n++){var q=m[n];q.toLowerCase()===b.toLowerCase()?r.create("strong",{textContent:q},
l):(q=document.createTextNode(q),r.place(q,l))}}}c?(r.place(c,this.suggestionsNode,"only"),this._showSuggestionsMenu()):(r.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},_insertSources:function(a){if(this.enableSourcesMenu&&a&&1<a.length){var b,c,d=this.activeSourceIndex,e=r.create("ul",{role:"menu"});this.enableSearchingAll&&(b="",d===this._allIndex&&(b="active"),r.create("li",{"data-index":this._allIndex,role:"menuitem",className:b,tabIndex:0,textContent:v.widgets.Search.main.all},e));
for(c=0;c<a.length;c++){b="";c===d&&(b=this.css.activeSource);var f=this._getSourceName(c);r.create("li",{"data-index":c,role:"menuitem",className:b,tabIndex:0,textContent:f},e)}q.add(this.containerNode,this.css.hasMultipleSources);r.place(e,this.sourcesNode,"only")}else q.remove(this.containerNode,this.css.hasMultipleSources),r.empty(this.sourcesNode)},_showLoading:function(){q.add(this.containerNode,this.css.searchLoading)},_hideLoading:function(){q.remove(this.containerNode,this.css.searchLoading)},
_checkStatus:function(){this.value?(q.add(this.containerNode,this.css.hasValue),n.set(this.clearNode,"title",v.widgets.Search.main.clearButtonTitle)):this.clear()},_closePopup:function(){this.enableInfoWindow&&this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_noResults:function(b){var c;b&&(c=a.trim(b));var d=r.create("div",{className:this.css.searchNoResultsBody});b&&c?(r.create("div",{className:this.css.searchNoResultsHeader,textContent:v.widgets.Search.main.noResults},d),r.create("div",
{className:this.css.searchNoResultsText,textContent:B.substitute({value:'"'+b+'"'},v.widgets.Search.main.noResultsFound)},d)):(b=r.create("div",{},d),r.create("span",{"aria-hidden":"true",className:this.css.searchNoValueIcon},b),r.create("span",{className:this.css.searchNoValueText,textContent:v.widgets.Search.main.emptyValue},b));r.place(d,this.noResultsMenuNode,"only")},_hideMenus:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();this._hideNoResultsMenu()},_hideNoResultsMenu:function(){q.remove(this.containerNode,
this.css.showNoResults)},_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();q.add(this.containerNode,this.css.showNoResults)},_hideSourcesMenu:function(){q.remove(this.containerNode,this.css.showSources)},_hideSuggestionsMenu:function(){q.remove(this.containerNode,this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();q.add(this.containerNode,this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();
this._hideNoResultsMenu();q.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();q.toggle(this.containerNode,this.css.showSources)},_getFirstStringField:function(a){if(a&&(a=a.fields)&&a.length)for(var b=0;b<a.length;b++){var c=a[b];if("esriFieldTypeString"===c.type)return c.name}return""},_getDisplayField:function(a){return a.displayField||a.featureLayer.displayField||this._getFirstStringField(a.featureLayer)},_validExtent:function(a){return a&&
a.xmin&&"NaN"!==a.xmin&&a.ymin&&"NaN"!==a.ymin&&a.xmax&&"NaN"!==a.xmax&&a.ymax&&"NaN"!==a.ymax?!0:!1},_hydrateResult:function(a,b,c){var d,e={},f=this._defaultSR;b=this.sources[b];if(this.map&&(f=this.map.spatialReference),a.hasOwnProperty("text")&&a.hasOwnProperty("magicKey"))return a;if(a.hasOwnProperty("geometry"))d=new F(a.toJson()),e.feature=d,(d=e.feature.geometry)&&d.setSpatialReference(f);else if(a.hasOwnProperty("location")){var g=new P(a.location.x,a.location.y,f);d={};a.hasOwnProperty("attributes")&&
(d=a.attributes);a.hasOwnProperty("score")&&(d.score=a.score);e.feature=new F(g,null,d,null)}else e.feature=null;if(a.hasOwnProperty("extent")&&this._validExtent(a.extent))e.extent=new O(a.extent),e.extent.setSpatialReference(f);else if(e.feature&&e.feature.geometry)switch(e.feature.geometry.type){case "extent":e.extent=e.feature.geometry;break;case "multipoint":e.extent=S.getDenormalizedExtent(e.feature.geometry);break;case "polygon":e.extent=S.getDenormalizedExtent(e.feature.geometry);break;case "polyline":e.extent=
S.getDenormalizedExtent(e.feature.geometry);break;case "point":this.map?(f=this.zoomScale,b&&b.zoomScale&&(f=b.zoomScale),this._getScale()>f?e.extent=Q.getExtentForScale(this.map,f).centerAt(e.feature.geometry):e.extent=this.map.extent.centerAt(e.feature.geometry)):e.extent=new O({xmin:e.feature.geometry.x-.25,ymin:e.feature.geometry.y-.25,xmax:e.feature.geometry.x+.25,ymax:e.feature.geometry.y+.25,spatialReference:this._defaultSR})}else e.extent=null;(e.name="",b.featureLayer)?b.suggestionTemplate&&
c?e.name=B.substitute(a.attributes,b.suggestionTemplate):b.searchTemplate?e.name=B.substitute(a.attributes,b.searchTemplate):(c=this._getDisplayField(b),b=b.featureLayer.getDomain(c),c&&a.hasOwnProperty("attributes")&&a.attributes.hasOwnProperty(c)&&(a=a.attributes[c],b&&"codedValue"===b.type?e.name=this._getCodedName(b.codedValues,a):e.name=a)):a.address&&b.searchTemplate?e.name=B.substitute(a.address,b.searchTemplate):a.hasOwnProperty("name")?e.name=a.name:a.hasOwnProperty("attributes")&&"object"==
typeof a.attributes&&a.attributes.Match_addr?(e.name=a.attributes.Match_addr,a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&a.attributes.StAddr&&a.attributes.City&&(e.name+=" - "+a.attributes.StAddr+", "+a.attributes.City)):a.hasOwnProperty("address")&&"string"==typeof a.address?e.name=a.address:a.hasOwnProperty("address")&&"object"==typeof a.address&&a.address.hasOwnProperty("Address")?a.address.hasOwnProperty("Match_addr")?e.name=a.address.Match_addr:a.address.hasOwnProperty("Address")&&
(e.name=a.address.Address):e.feature&&e.feature.geometry&&(e.name=e.feature.geometry.x+","+e.feature.geometry.y);return e},_getScale:function(){var a;return this.map&&"function"==typeof this.map.getScale&&(a=this.map.getScale()),a},_hydrateResults:function(a,b,c,d){d=[];var e=0;if(a&&a.length)for(e;e<a.length;e++){var f=this._hydrateResult(a[e],b,c);d.push(f)}return d},_containsNonLatinCharacter:function(a){for(var b=0;b<a.length;b++)if(255<a.charCodeAt(b))return!0;return!1},_setPlaceholder:function(a){var b=
"",c=this.sources[a];a===this._allIndex?b=this.allPlaceholder||v.widgets.Search.main.allPlaceholder:c&&c.placeholder&&(b=c.placeholder);var d=v.widgets.Search.main.all;c&&(d=this._getSourceName(a));n.set(this.sourceNameNode,"textContent",d);n.set(this.inputNode,"placeholder",b);n.set(this.inputNode,"title",b)},_updateActiveSource:function(){var a,b=this.sources,c=this.activeSourceIndex;b&&b[c]&&(a=b[c]);a?this.set("activeSource",a):this.set("activeSource",null)},_updateVisible:function(){this.visible?
this.show():this.hide()},_updateButtonMode:function(a){a?(q.toggle(this.containerNode,this.css.searchExpanded,this.expanded),q.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),q.add(this.containerNode,this.css.hasButtonMode)):(q.remove(this.containerNode,this.css.searchExpanded),q.remove(this.containerNode,this.css.searchCollapsed),q.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(){var a=this.sources;a&&1===a.length||!this.enableSearchingAll?
this.set("activeSourceIndex",0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(a){this._set("enableSourcesMenu",a);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(a){this._set("enableSearchingAll",a);this._created&&(this._setDefaultActiveSourceIndex(),this._hideMenus(),this._insertSources(this.sources))},_setSourcesAttr:function(b){this._createSourceNameMap(b).then(a.hitch(this,function(a){this._sourceNames=a;this._created&&(this._setDefaultActiveSourceIndex(),
this._hideMenus(),this._insertSources(b))}));this._set("sources",b)},_setAllPlaceholderAttr:function(a){this._set("allPlaceholder",a);this._created&&this._setPlaceholder(this.activeSourceIndex)},_setActiveSourceIndexAttr:function(a){this._set("activeSourceIndex",a);this._updateActiveSource();this._created&&(this._setPlaceholder(a),this._hideMenus(),this._insertSources(this.sources))},_setMaxLengthAttr:function(a){this._set("maxLength",a);this._created&&n.set(this.inputNode,"maxLength",a)},_setValueAttr:function(a){this.set("magicKey",
null);this.set("selectedFeatureId",null);this._set("value",a);this._created&&(n.set(this.inputNode,"value",a),this._checkStatus())},_setVisibleAttr:function(a){this._set("visible",a);this._created&&this._updateVisible()},_setEnableButtonModeAttr:function(a){this._set("enableButtonMode",a);this._created&&this._updateButtonMode(a)},_setThemeAttr:function(a){this._created&&(q.remove(this.domNode,this.theme),q.add(this.domNode,a));this._set("theme",a)}});return d("extend-esri")&&a.setObject("dijit.Search",
k,D),k})},"esri/promiseList":function(){define(["dojo/_base/array","dojo/Deferred","dojo/when"],function(h,k,a){var f=h.forEach;return function(b){function e(a,b){g[b]=a;n.progress([a,b]);0===--q&&n.resolve(g)}var h,m;b instanceof Array?m=b:b&&"object"==typeof b&&(h=b);var g,d=[];if(h){m=[];for(var c in h)Object.hasOwnProperty.call(h,c)&&(d.push(c),m.push(h[c]));g={}}else m&&(g=[]);if(!m||!m.length)return(new k).resolve(g);var n=new k;n.promise.always(function(){g=d=null});var q=m.length;return f(m,
function(b,c){h||d.push(c);a(b,function(a){e(a,d[c])},function(a){e(a,d[c])})}),n.promise}})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),function(h,k,a,f,b,e,l,m,g,d,c){h=h(d,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],
"suggest-locations-complete":["suggestions"]},constructor:function(a){this._geocodeHandler=k.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=k.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=k.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},outSpatialReference:null,setOutSpatialReference:function(a){this.outSpatialReference=a},_geocodeHandler:function(a,b,d,e,f){try{var g,h,l,m=a.candidates;b=[];var k=m.length,n=a.spatialReference;for(h=0;k>
h;h++)g=m[h],(l=g.location)&&(l.spatialReference=n),b[h]=new c(g);this._successHandler([b],"onAddressToLocationsComplete",d,f)}catch(B){this._errorHandler(B,e,f)}},_geocodeAddressesHandler:function(a,b,d,e,f){try{var g,h,l=a.locations;b=[];var m=l.length,k=a.spatialReference;for(g=0;m>g;g++)(h=l[g].location)&&(h.spatialReference=k),b[g]=new c(l[g]);this._successHandler([b],"onAddressesToLocationsComplete",d,f)}catch(z){this._errorHandler(z,e,f)}},addressToLocations:function(a,c,d,e,h){var l,n,q,r,
t,v,B;a.address&&(e=d,d=c,c=a.outFields,h=a.searchExtent,B=a.countryCode,l=a.magicKey,n=a.distance,v=a.categories,a.location&&this.normalization&&(q=a.location.normalize()),r=a.maxLocations,t=a.forStorage,a=a.address);h&&(h=h.shiftCentralMeridian());var C=this.outSpatialReference;a=this._encode(k.mixin({},this._url.query,a,{f:"json",outSR:C&&b.toJson(C.toJson()),outFields:c&&c.join(",")||null,searchExtent:h&&b.toJson(h.toJson()),category:v&&v.join(",")||null,countryCode:B||null,magicKey:l||null,distance:n||
null,location:q||null,maxLocations:r||null,forStorage:t||null}));var D=this._geocodeHandler,E=this._errorHandler,F=new f(g._dfdCanceller);return F._pendingDfd=m({url:this._url.path+"/findAddressCandidates",content:a,callbackParamName:"callback",load:function(a,b){D(a,b,d,e,F)},error:function(a){E(a,e,F)}}),F},suggestLocations:function(a){var c;c=new f(g._dfdCanceller);a.hasOwnProperty("location")&&this.normalization&&(a.location=a.location.normalize());a.searchExtent&&(a.searchExtent=a.searchExtent.shiftCentralMeridian());
a=this._encode(k.mixin({},this._url.query,{f:"json",text:a.text,maxSuggestions:a.maxSuggestions,searchExtent:a.searchExtent&&b.toJson(a.searchExtent.toJson()),category:a.categories&&a.categories.join(",")||null,countryCode:a.countryCode||null,location:a.location||null,distance:a.distance||null},{f:"json"}));a=m({url:this._url.path+"/suggest",content:a,callbackParamName:"callback"});return c._pendingDfd=a,a.then(k.hitch(this,function(a){a=a.suggestions||[];this.onSuggestLocationsComplete(a);c.resolve(a)}),
k.hitch(this,function(a){this._errorHandler(a);c.reject(a)})),c},addressesToLocations:function(c,d,e){var h=this.outSpatialReference,l=[],n=c.categories,q=c.countryCode;a.forEach(c.addresses,function(a,b){l.push({attributes:a})});c=this._encode(k.mixin({},this._url.query,{category:n&&n.join(",")||null,sourceCountry:q||null},{addresses:b.toJson({records:l})},{f:"json",outSR:h&&b.toJson(h.toJson())}));var t=this._geocodeAddressesHandler,y=this._errorHandler,A=new f(g._dfdCanceller);return A._pendingDfd=
m({url:this._url.path+"/geocodeAddresses",content:c,callbackParamName:"callback",load:function(a,b){t(a,b,d,e,A)},error:function(a){y(a,e,A)}}),A},_reverseGeocodeHandler:function(a,b,d,e,f){try{var g=new c({address:a.address,location:a.location,score:100});this._successHandler([g],"onLocationToAddressComplete",d,f)}catch(w){this._errorHandler(w,e,f)}},locationToAddress:function(a,c,d,e){a&&this.normalization&&(a=a.normalize());var h=this.outSpatialReference;a=this._encode(k.mixin({},this._url.query,
{outSR:h&&b.toJson(h.toJson()),location:a&&b.toJson(a.toJson()),distance:c,f:"json"}));var l=this._reverseGeocodeHandler,n=this._errorHandler,q=new f(g._dfdCanceller);return q._pendingDfd=m({url:this._url.path+"/reverseGeocode",content:a,callbackParamName:"callback",load:function(a,b){l(a,b,d,e,q)},error:function(a){n(a,e,q)}}),q},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}});
return e("extend-esri")&&k.setObject("tasks.Locator",h,l),h})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(h,k,a,f,b){h=h(null,{declaredClass:"esri.tasks.AddressCandidate",constructor:function(a){k.mixin(this,a);this.location=new b(this.location)}});return a("extend-esri")&&k.setObject("tasks.AddressCandidate",h,f),h})},"esri/styles/basic":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/has",
"../kernel","../Color"],function(h,k,a,f,b){function e(a,d){var c;if(a)switch(c={},c.color=new b(a.color),c.opacity=a.opacity||1,d){case "point":c.outline={color:new b(a.outline.color),width:a.outline.width};c.size=a.size;break;case "line":c.width=a.width;break;case "polygon":c.outline={color:new b(a.outline.color),width:a.outline.width}}return c}function l(a){return"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?a="point":"esriGeometryPolyline"===a?a="line":"esriGeometryPolygon"===a&&(a="polygon"),
a}var m={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm".split(" "),dark:["satellite","hybrid","dark-gray"]},pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,255,1],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,1],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,1],width:1},size:8}]},dark:{primary:{color:[255,
255,255,1],outline:{color:[26,26,26,1],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,1],width:1},size:8},{color:[26,26,26,1],outline:{color:[178,178,178,1],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,77,77,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[255,255,255,1],width:2}]},dark:{primary:{color:[255,255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,
139,79,1],outline:{color:[255,255,255,1],width:1},opacity:.8},secondary:[{color:[128,128,128,1],outline:{color:[255,255,255,1],width:1},opacity:.8},{color:[255,255,255,1],outline:{color:[128,128,128,1],width:1},opacity:.8}]},dark:{primary:{color:[227,139,79,1],outline:{color:[51,51,51,1],width:1},opacity:.8},secondary:[{color:[178,178,178,1],outline:{color:[51,51,51,1],width:1},opacity:.8},{color:[26,26,26,1],outline:{color:[128,128,128,1],width:1},opacity:.8}]}}}},g={};(function(){var a,b,d,e,f,
h,l,k;for(a in m)for(e in b=m[a],d=b.basemapGroups,f=g[a]={basemaps:[].concat(d.light).concat(d.dark),point:{},line:{},polygon:{}},d)for(h=d[e],l=0;l<h.length;l++)k=h[l],b.pointSchemes&&(f.point[k]=b.pointSchemes[e]),b.lineSchemes&&(f.line[k]=b.lineSchemes[e]),b.polygonSchemes&&(f.polygon[k]=b.polygonSchemes[e])})();var d={getAvailableThemes:function(a){var b,c,d,e=[];for(b in m)c=m[b],d=g[b],a&&-1===h.indexOf(d.basemaps,a)||e.push({name:c.name,label:c.label,description:c.description,basemaps:d.basemaps.slice(0)});
return e},getSchemes:function(a){var b,c,d=a.theme,f=a.basemap,m=l(a.geometryType);a=g[d];return b=a&&a[m],b=b&&b[f],b&&(c={primaryScheme:e(b.primary,m),secondarySchemes:h.map(b.secondary,function(a){return e(a,m)})}),c},cloneScheme:function(a){var c;return a&&(c=k.mixin({},a),c.color&&(c.color=new b(c.color)),c.outline&&(c.outline={color:c.outline.color&&new b(c.outline.color),width:c.outline.width})),c}};return a("extend-esri")&&k.setObject("styles.basic",d,f),d})},"esri/arcgis/utils":function(){define("require dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/on dojo/DeferredList dojo/dom-construct dojo/sniff ../kernel ../config ../Color ../lang ../request ../SpatialReference ../map ../urlUtils ../geometry/ScreenPoint ../geometry/Extent ../geometry/webMercatorUtils ../symbols/jsonUtils ../renderers/jsonUtils ../dijit/PopupTemplate ../dijit/Popup ../tasks/query ../tasks/GeometryService ../layers/ArcGISTiledMapServiceLayer ../layers/FeatureLayer dojo/i18n!../nls/jsapi".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J,L){function M(a){return v({url:ha.arcgisUrl+"/"+a.itemId+"/data",content:{f:"json"},callbackParamName:"callback"},{disableIdentityLookup:!0,_preLookup:!0})}function H(a,b){var c={f:"json"};b&&(c.token=b);return v({url:a,content:c,callbackParamName:"callback"},{disableIdentityLookup:!0})}function K(a){!a.layerDefinition||a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.labelingInfo||(a.showLabels=!1);a.itemProperties.layerDefinition&&
(a.layerDefinition?(a.layerDefinition.drawingInfo||(a.layerDefinition.drawingInfo=a.itemProperties.layerDefinition.drawingInfo),r.isDefined(a.layerDefinition.definitionExpression)||(a.layerDefinition.definitionExpression=a.itemProperties.layerDefinition.definitionExpression),r.isDefined(a.layerDefinition.minScale)||(a.layerDefinition.minScale=a.itemProperties.layerDefinition.minScale),r.isDefined(a.layerDefinition.maxScale)||(a.layerDefinition.maxScale=a.itemProperties.layerDefinition.maxScale)):
a.layerDefinition=a.itemProperties.layerDefinition);!a.itemProperties.popupInfo||a.popupInfo||a.disablePopup||(a.popupInfo=a.itemProperties.popupInfo);r.isDefined(a.itemProperties.showLabels)&&!r.isDefined(a.showLabels)&&(a.showLabels=a.itemProperties.showLabels);r.isDefined(a.itemProperties.showLegend)&&!r.isDefined(a.showLegend)&&(a.showLegend=a.itemProperties.showLegend);r.isDefined(a.itemProperties.refreshInterval)&&!r.isDefined(a.refreshInterval)&&(a.refreshInterval=a.itemProperties.refreshInterval)}
function P(a){K(a);a.itemProperties.layerDefinition&&a.layerDefinition&&(!r.isDefined(a.layerDefinition.maximumTrackPoints)&&r.isDefined(a.itemProperties.layerDefinition.maximumTrackPoints)&&(a.layerDefinition.maximumTrackPoints=a.itemProperties.layerDefinition.maximumTrackPoints),!a.layerDefinition.definitionGeometry&&a.itemProperties.layerDefinition.definitionGeometry&&(a.layerDefinition.definitionGeometry=a.itemProperties.layerDefinition.definitionGeometry));a.itemProperties.purgeOptions&&!a.purgeOptions&&
(a.purgeOptions=a.itemProperties.purgeOptions)}function O(c,d){var e=new b,f=c.itemData,h=[],l=[];if(a.forEach(f.operationalLayers,function(a){if(a.itemId&&!a.type){var b=a.url.toLowerCase();-1<b.indexOf("/featureserver")||-1<b.indexOf("/mapserver/")?(l.push(a),h.push(M(a))):-1<b.indexOf("/mapserver")&&-1===b.indexOf("/mapserver/")&&(!a.layers||!r.isDefined(a.minScale)&&!r.isDefined(a.maxScale))?(l.push(a),h.push(M(a))):-1<b.indexOf("/imageserver")&&!r.isDefined(a.minScale)&&!r.isDefined(a.maxScale)?
(l.push(a),h.push(M(a))):-1<b.indexOf("/streamserver")&&(l.push(a),h.push(M(a)))}}),f.baseMap&&f.baseMap.baseMapLayers&&a.forEach(f.baseMap.baseMapLayers,function(a){a.itemId&&"VectorTileLayer"!==a.layerType&&(l.push(a),h.push(M(a)))}),0<h.length){var m={};(new g(h)).addCallback(function(b){a.forEach(l,function(c,d){var e=b[d][1];if(e&&!(e instanceof Error)&&(m[c.itemId]=e,!c.type)){var f=c.url.toLowerCase();(-1<f.indexOf("/featureserver")||-1<f.indexOf("/mapserver/"))&&e.layers?a.forEach(e.layers,
function(a){var b="/featureserver/"+a.id;(b=f.match(b+"$")==b)||(b="/mapserver/"+a.id,b=f.match(b+"$")==b);b&&(c.itemProperties=a,K(c))}):-1<f.indexOf("/streamserver")?(c.itemProperties=e,P(c)):-1<f.indexOf("/mapserver")?(e.layers&&!c.layers&&(c.layers=e.layers),r.isDefined(e.minScale)&&!r.isDefined(c.minScale)&&(c.minScale=e.minScale),r.isDefined(e.maxScale)&&!r.isDefined(c.maxScale)&&(c.maxScale=e.maxScale),r.isDefined(e.refreshInterval)&&!r.isDefined(c.refreshInterval)&&(c.refreshInterval=e.refreshInterval),
e.visibleLayers&&!c.visibleLayers&&(c.visibleLayers=e.visibleLayers)):-1<f.indexOf("/imageserver")&&(r.isDefined(e.minScale)&&!r.isDefined(c.minScale)&&(c.minScale=e.minScale),r.isDefined(e.maxScale)&&!r.isDefined(c.maxScale)&&(c.maxScale=e.maxScale),r.isDefined(e.refreshInterval)&&!r.isDefined(c.refreshInterval)&&(c.refreshInterval=e.refreshInterval),!e.popupInfo||c.popupInfo||c.disablePopup||(c.popupInfo=e.popupInfo),e.renderingRule&&!c.renderingRule&&(c.renderingRule=e.renderingRule,e.renderingRule.functionName&&
(c.renderingRule.rasterFunction=e.renderingRule.functionName)),e.bandIds&&!c.bandIds&&(c.bandIds=e.bandIds),e.mosaicRule&&!c.mosaicRule&&(c.mosaicRule=e.mosaicRule),e.format&&!c.format&&(c.format=e.format),r.isDefined(e.compressionQuality)&&!r.isDefined(c.compressionQuality)&&(c.compressionQuality=e.compressionQuality),!e.layerDefinition||!e.layerDefinition.definitionExpression||r.isDefined(c.layerDefinition)&&r.isDefined(c.layerDefinition.definitionExpression)||(c.layerDefinition=c.layerDefinition||
{},c.layerDefinition.definitionExpression=e.layerDefinition.definitionExpression))}});c.relatedItemsData=m;e.callback(c)})}else e.callback(c);return e}function S(a,c){var d=new b,e=a.itemData,g=e.baseMap.baseMapLayers[0];if("BingMapsAerial"===g.type||"BingMapsRoad"===g.type||"BingMapsHybrid"===g.type)if(g.portalUrl&&n.id)delete c.bingMapsKey,n.id.checkSignInStatus(x.urlToObject(ha.arcgisUrl).path).then(k.hitch(null,function(a,b,c,d,e){H(g.portalUrl,e.token).then(k.hitch(null,R,a,b,c,d),k.hitch(null,
aa,a,b,c,d))},a,c,e,d),k.hitch(null,function(a,b,c,d,e){H(g.portalUrl).then(k.hitch(null,R,a,b,c,d),k.hitch(null,aa,a,b,c,d))},a,c,e,d));else if(c.bingMapsKey){var h=new Wa({bingMapsKey:c.bingMapsKey,mapStyle:Wa.MAP_STYLE_AERIAL});f.connect(h,"onLoad",k.hitch(this,function(){d.callback([a,c])}));f.connect(h,"onError",function(b){delete c.bingMapsKey;a.itemData=X(e);g=a.itemData.baseMap.baseMapLayers[0];g.errors=[];g.errors.push({message:"The owner of the application has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});
d.callback([a,c])})}else a.itemData=X(e),g=a.itemData.baseMap.baseMapLayers[0],g.errors=[],g.errors.push({message:"The owner of the application has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."}),d.callback([a,c]);else d.callback([a,c]);return d}function Q(a){var c,d,e=new b;a=a.itemData;var f=a.baseMap&&a.baseMap.baseMapLayers;if(Ya&&!Ya.supported())for(a=0;a<f.length;a++){var g=f[a];if(!g.isReference){"VectorTileLayer"===g.layerType&&(c=g.itemId,d=a);break}}return c?
W(c,!1).addBoth(function(a){var b=/^https?:\/\/basemaps(dev)?\.arcgis\.com\/arcgis\/rest\/services\/World_Basemap\/VectorTileServer/i;a&&a.item&&b.test(a.item.url)&&(f[d]={id:"FB_"+g.id,layerType:"ArcGISTiledMapServiceLayer",opacity:"opacity"in g?g.opacity:1,visibility:"visibility"in g?g.visibility:!0,url:"http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer"});e.resolve()}):e.resolve(),e}function R(a,b,c,d,e){e.bingKey?(b.bingMapsKey=e.bingKey,e=new Wa({bingMapsKey:b.bingMapsKey,
mapStyle:Wa.MAP_STYLE_AERIAL}),f.connect(e,"onLoad",k.hitch(this,function(){d.callback([a,b])})),f.connect(e,"onError",function(e){delete b.bingMapsKey;a.itemData=X(c);e=a.itemData.baseMap.baseMapLayers[0];e.errors=[];e.errors.push({message:"The owner of the map has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});d.callback([a,b])})):aa(a,b,c,d)}function aa(a,b,c,d){delete b.bingMapsKey;a.itemData=X(c);c=a.itemData.baseMap.baseMapLayers[0];c.errors=[];c.errors.push({message:"The owner of the map has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."});
d.callback([a,b])}function X(a){return"BingMapsAerial"===a.baseMap.baseMapLayers[0].type?a.baseMap={title:"Imagery",baseMapLayers:[{id:"World_Imagery_2017",visibility:!0,opacity:1,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]}:"BingMapsRoad"===a.baseMap.baseMapLayers[0].type?a.baseMap={title:"Streets",baseMapLayers:[{id:"World_Street_Map_8421",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]}:a.baseMap=
{title:"Imagery with Labels",baseMapLayers:[{id:"World_Imagery_6611",opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{id:"World_Boundaries_and_Places_1145",isReference:!0,opacity:1,visibility:!0,url:"http://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer"}]},a}function T(b,c,d,e){var f=b.dynamicLayerInfos||b.layerInfos,g=c.layers;if(g&&f)if(e.usePopupManager){var h;a.forEach(f,function(a){var b=
a.id;if(!a.subLayerIds)for(a=0;a<g.length;a++){var c=g[a];if(c.id===b&&c.popupInfo){h||(h={});h[b]={infoTemplate:new d(c.popupInfo),layerUrl:c.layerUrl};break}}});h&&b.setInfoTemplates(h)}else{var l=[],m=[],k=[],n=[],q=[],t=[];a.forEach(f,function(c){var d=c.id;if(!c.subLayerIds&&-1!==a.indexOf(b.visibleLayers,d))for(c=0;c<g.length;c++){var e=g[c];if(e.id===d){m.push(d);l.push(e.popupInfo);k.push(e.layerUrl||"");e.layerDefinition&&e.layerDefinition.definitionExpression?n.push(e.layerDefinition.definitionExpression):
n.push("");q.push(r.isDefined(e.minScale)?e.minScale:null);t.push(r.isDefined(e.maxScale)?e.maxScale:null);break}}});l.length&&(b.__popups=l,b.__popupIds=m,b.__popupUrls=k,b.__popupWhereClauses=n,b.__popupMinScales=q,b.__popupMaxScales=t,b.__resourceInfo=c.resourceInfo)}}function V(a){if(!a)return!1;var b=(new l(ha.arcgisUrl)).authority;return-1!==a.indexOf(".arcgis.com/")||-1!==a.indexOf(b)}function da(a){return a?-1!==a.indexOf("/services.arcgisonline.com/")||-1!==a.indexOf("/server.arcgisonline.com/"):
!1}function ga(a){return"https:"===location.protocol&&(V(a)||da(a))&&(a=a.replace("http:","https:")),a}function la(b,c,d){var e,f=[];b.displayLevels||(f=a.map(b.resourceInfo.tileInfo.lods,function(a){return a.level}));b.exclusionAreas&&(e=k.clone(b.exclusionAreas),e=a.map(e,function(a){return a.geometry=new A(a.geometry),a}));e=new I(ga(b.url),{resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,displayLevels:b.displayLevels||f,id:b.id,minScale:b.minScale,maxScale:b.maxScale,refreshInterval:b.refreshInterval,
exclusionAreas:e});return d.ignorePopups||T(e,b,c,d),e}function Aa(a,b){if(!a||!b||0===b.length)return[];var c,d=","+b+",",e=[],f=",";for(c=0;c<a.length;c++)null!==a[c].subLayerIds?(-1===d.indexOf(","+a[c].id+",")||-1<f.indexOf(","+a[c].id+","))&&(f+=a[c].subLayerIds.toString()+","):-1<d.indexOf(","+a[c].id+",")&&-1===f.indexOf(","+a[c].id+",")&&e.push(a[c].id);return e}function ta(b,c,d){var e=new yb;e.format="png24";b.resourceInfo&&b.resourceInfo.supportedImageFormatTypes&&-1<b.resourceInfo.supportedImageFormatTypes.indexOf("PNG32")&&
(e.format="png32");var e=new N(ga(b.url),{resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,id:b.id,imageParameters:e,minScale:b.minScale,maxScale:b.maxScale,refreshInterval:b.refreshInterval}),f=b.visibleLayers;if(!b.visibleLayers){var g="";a.forEach(e.layerInfos,function(a){a.defaultVisibility&&(g+=(0<g.length?",":"")+a.id)});f=g}if(b.layers&&0<b.layers.length){var h,l,m,n=[],q=[],r=[];a.forEach(b.layers,function(c){if(c.layerDefinition&&c.layerDefinition.definitionExpression&&
(n[c.id]=c.layerDefinition.definitionExpression),c.layerDefinition&&c.layerDefinition.source){if(h=null,m=c.layerDefinition.source,"mapLayer"===m.type){var d=a.filter(b.resourceInfo.layers,function(a){return a.id===m.mapLayerId});d.length&&(h=k.mixin(d[0],c))}else h=k.mixin({},c);if(h){if(h.source=m,delete h.popupInfo,h=new ca(h),b.visibleLayers)d="string"==typeof b.visibleLayers?b.visibleLayers.split(","):b.visibleLayers,-1<a.indexOf(d,c.id)?h.defaultVisibility=!0:h.defaultVisibility=!1;q.push(h)}}c.layerDefinition&&
c.layerDefinition.source&&c.layerDefinition.drawingInfo&&(l=new Ua(c.layerDefinition.drawingInfo),r[c.id]=l)},this);0<n.length&&e.setLayerDefinitions(n);0<q.length?(e.setDynamicLayerInfos(q,!0),0<r.length&&e.setLayerDrawingOptions(r,!0)):(f=Aa(e.layerInfos,f),e.setVisibleLayers(f))}else f=Aa(e.layerInfos,f),e.setVisibleLayers(f);return d.ignorePopups||T(e,b,c,d),e}function pa(a,b,c){var d=new pb;if(d.bandIds=a.bandIds,null!=a.format&&(d.format=a.format,null!=a.compressionQuality&&(d.compressionQuality=
a.compressionQuality)),a.renderingRule&&a.renderingRule.rasterFunction){var e=new Ab(a.renderingRule);d.renderingRule=e}a.mosaicRule&&(e=new wb(a.mosaicRule),d.mosaicRule=e);r.isDefined(a.noData)&&(d.noData=a.noData);r.isDefined(a.noDataInterpretation)&&(d.noDataInterpretation=a.noDataInterpretation);r.isDefined(a.interpolation)&&(d.interpolation=a.interpolation);e=a.layerType?"ArcGISImageServiceVectorLayer"===a.layerType:!1;r.isDefined(a.layerType)||(e=a.resourceInfo.hasMultidimensions&&("esriImageServiceDataTypeVector-UV"===
a.resourceInfo.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===a.resourceInfo.serviceDataType));d={resourceInfo:a.resourceInfo,opacity:a.opacity,visible:a.visibility,id:a.id,imageServiceParameters:d,minScale:a.minScale,maxScale:a.maxScale,refreshInterval:a.refreshInterval};if(d=e?new ka(ga(a.url),d):new ea(ga(a.url),d),a.layerDefinition)a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&(e=C.fromJson(a.layerDefinition.drawingInfo.renderer),d.setRenderer(e)),a.layerDefinition.definitionExpression&&
d.setDefinitionExpression(a.layerDefinition.definitionExpression,!0);return!c.ignorePopups&&a.popupInfo&&d.setInfoTemplate(new b(a.popupInfo)),d}function wa(b,c,d){var e=[102113,102100,3857],f=d||new u(c[0].layerObject.fullExtent.spatialReference),g=new u(b.resourceInfo.fullExtent.spatialReference);return f.wkt==g.wkt&&(f.wkid==g.wkid||r.isDefined(f.latestWkid)&&f.latestWkid==g.wkid||r.isDefined(g.latestWkid)&&f.wkid==g.latestWkid||r.isDefined(f.latestWkid)&&f.latestWkid==g.latestWkid)?!0:f.wkid&&
g.wkid&&a.some(e,function(a){return a===g.wkid})&&a.some(e,function(a){return a===f.wkid})?!0:!1}function oa(a,b,c){if(!b[0].layerObject.tileInfo)return!1;a=a.resourceInfo.tileInfo;b=b[0].layerObject.tileInfo;c=c.width>c.height?c.width:c.height;for(var d=!1,e=!1,f=0;f<a.lods.length;f++){for(var g=a.lods[f].scale/a.dpi,h=0;h<b.lods.length;h++){var l=b.lods[h].scale/b.dpi;if(Math.abs(l-g)/l<1/c){if(d){e=!0;break}d=!0}}if(e)break}return e?!0:!d||1!==a.lods.length&&1!==b.lods.length?!1:!0}function ma(b,
c,d,g,h,l){var q,t,v=d._clazz;if("OpenStreetMap"===b.type)q=new rb({id:b.id,opacity:b.opacity,visible:null!==b.visibility&&void 0!==b.visibility?b.visibility:!0});else if("WFS"===b.type)g={customParameters:b.wfsInfo.customParameters,geometryType:b.layerDefinition.geometryType,id:b.id,labelingInfo:b.layerDefinition.drawingInfo.labelingInfo,maxFeatures:b.wfsInfo.maxFeatures,mode:b.mode,name:b.wfsInfo.name,showLabels:!0,swapXY:b.wfsInfo.swapXY,title:b.title,url:b.url,version:b.wfsInfo.version,visible:b.visibility,
wkid:b.layerDefinition.spatialReference.wkid},q=new Za,q.fromJson(g,function(){r.isDefined(b.opacity)&&q.setOpacity(b.opacity);r.isDefined(b.visibility)&&q.setVisibility(b.visibility);(b.minScale||b.maxScale)&&q.setScaleRange(b.minScale,b.maxScale);q.renderer=C.fromJson(b.layerDefinition.drawingInfo.renderer);!d.ignorePopups&&b.popupInfo&&q.setInfoTemplate(new v(b.popupInfo));q.emit("fromJsonComplete")});else if("WMS"===b.type){var w=[],z=[];a.forEach(b.layers,function(a){z.push(new Rb({name:a.name,
title:a.title,legendURL:a.legendURL,queryable:a.queryable,showPopup:a.showPopup}));w.push(a.name)},this);b.visibleLayers&&(w=b.visibleLayers);g=new A(b.extent[0][0],b.extent[0][1],b.extent[1][0],b.extent[1][1],new u({wkid:4326}));g={customLayerParameters:b.customLayerParameters,customParameters:b.customParameters,extent:g,layerInfos:z,version:b.version,maxWidth:b.maxWidth,maxHeight:b.maxHeight,featureInfoFormat:b.featureInfoFormat,getFeatureInfoURL:b.featureInfoUrl,getMapURL:b.mapUrl,spatialReferences:b.spatialReferences,
title:b.title,copyright:b.copyright,minScale:b.minScale||0,maxScale:b.maxScale||0,format:b.format};q=new eb(b.url,{id:b.id,visibleLayers:w,format:"png",transparent:b.firstLayer?!1:!0,opacity:b.opacity,visible:null!==b.visibility?b.visibility:!0,resourceInfo:g,refreshInterval:b.refreshInterval});q.spatialReference.wkid=g.spatialReferences[0]}else if("KML"===b.type){if(t=b.url,n.id){var y=n.id.findCredential(x.urlToObject(ha.arcgisUrl).path);if(y){var E=ha.arcgisUrl.substring(ha.arcgisUrl.indexOf("//")+
2,ha.arcgisUrl.indexOf("/",ha.arcgisUrl.indexOf("//")+3));c=E.split(".");c=c[c.length-2]+"."+c[c.length-1];h=t.indexOf(c);-1<h&&(t="https://"+E+t.substring(h+c.length),t+="?token\x3d"+y.token)}}q=new jb(t,{id:b.id,visible:null!==b.visibility?b.visibility:!0,outSR:g,refreshInterval:b.refreshInterval});f.connect(q,"onLoad",function(){(b.opacity||0===b.opacity)&&q.setOpacity(b.opacity);r.isDefined(b.minScale)&&r.isDefined(b.maxScale)&&q.setScaleRange(b.minScale,b.maxScale);b.visibleFolders&&a.forEach(q.folders,
function(c){-1<a.indexOf(b.visibleFolders,c.id)?q.setFolderVisibility(c,!0):q.setFolderVisibility(c,!1)},this)})}else if("WebTiledLayer"===b.type)q=new Ob(b.templateUrl,{id:b.id,visible:null!==b.visibility?b.visibility:!0,opacity:b.opacity,copyright:b.copyright,fullExtent:b.fullExtent&&new A(b.fullExtent),initialExtent:b.fullExtent&&new A(b.fullExtent),subDomains:b.subDomains,tileInfo:b.tileInfo?new hb(b.tileInfo):null,refreshInterval:b.refreshInterval,wmtsInfo:b.wmtsInfo}),(r.isDefined(b.minScale)||
r.isDefined(b.maxScale))&&(q.loaded?q.setScaleRange(b.minScale,b.maxScale):f.connect(q,"onLoad",function(){q.setScaleRange(b.minScale,b.maxScale)}));else if("GeoRSS"===b.type)q=new U(b.url,{id:b.id,opacity:b.opacity,outSpatialReference:g,refreshInterval:b.refreshInterval}),f.connect(q,"onLoad",function(){!1===b.visibility&&q.hide();r.isDefined(b.minScale)&&r.isDefined(b.maxScale)&&q.setScaleRange(b.minScale,b.maxScale);var c=q.getFeatureLayers();a.forEach(c,function(a){b.pointSymbol&&"esriGeometryPoint"===
a.geometryType?(a.renderer.symbol=B.fromJson(b.pointSymbol),1===c.length&&(q.pointSymbol=B.fromJson(b.pointSymbol))):b.lineSymbol&&"esriGeometryPolyline"===a.geometryType?(a.renderer.symbol=B.fromJson(b.lineSymbol),1===c.length&&(q.polylineSymbol=B.fromJson(b.lineSymbol))):b.polygonSymbol&&"esriGeometryPolygon"===a.geometryType&&(a.renderer.symbol=B.fromJson(b.polygonSymbol),1===c.length&&(q.polygonSymbol=B.fromJson(b.polygonSymbol)))})});else if("CSV"==b.type&&b.url)g={layerDefinition:b.layerDefinition,
columnDelimiter:b.columnDelimiter,id:b.id?b.id:null,visible:null!==b.visibility?b.visibility:!0,opacity:b.opacity,refreshInterval:b.refreshInterval},b.locationInfo&&(g.latitudeFieldName=b.locationInfo.latitudeFieldName,g.longitudeFieldName=b.locationInfo.longitudeFieldName),d.ignorePopups||(g.infoTemplate=new D(b.popupInfo?b.popupInfo:sa.generateDefaultPopupInfo(b))),q=new ba(b.url,g);else if("VectorTileLayer"===b.layerType&&b.styleUrl)q=new Ya(b.styleUrl,{id:b.id,minScale:b.minScale,maxScale:b.maxScale,
opacity:b.opacity,visible:b.visibility});else if(b.layerDefinition&&!b.url)g=e.fromJson(e.toJson(b)),delete g.id,delete g.opacity,delete g.visibility,q=new J(g,{id:b.id,opacity:b.opacity,visible:b.visibility,outFields:["*"],autoGeneralize:!0}),!d.ignorePopups&&g.popupInfo&&q.setInfoTemplate(new v(g.popupInfo)),Ba(q);else if("BingMapsAerial"===b.type||"BingMapsRoad"===b.type||"BingMapsHybrid"===b.type)d.bingMapsKey?(g=Wa.MAP_STYLE_AERIAL_WITH_LABELS,"BingMapsAerial"===b.type?g=Wa.MAP_STYLE_AERIAL:
"BingMapsRoad"===b.type&&(g=Wa.MAP_STYLE_ROAD),q=new Wa({bingMapsKey:d.bingMapsKey,mapStyle:g,opacity:b.opacity,id:b.id}),f.connect(q,"onError",k.hitch(this,function(a){a.errors=a.errors||[];a.errors.push({message:"This application does not have a valid Bing Key for the Bing layer that is included in this map. [type:"+a.type+"]"})},b))):(b.errors=b.errors||[],b.errors.push({message:"This application does not provide a Bing Key for the Bing layer that is included in this map. [type:"+b.type+"]"}));
else if(b.resourceInfo&&b.resourceInfo.mapName)q=!0===b.resourceInfo.singleFusedMapCache&&(b.baseMapLayer||wa(b,c,g)&&oa(b,h,l))?la(b,v,d):ta(b,v,d);else if(b.resourceInfo&&b.resourceInfo.pixelSizeX)q=!0===b.resourceInfo.singleFusedMapCache&&(b.baseMapLayer||wa(b,c,g)&&oa(b,h,l))?la(b,v,d):pa(b,v,d);else if(b.resourceInfo&&"Feature Layer"===b.resourceInfo.type){if(b.capabilities&&(b.resourceInfo.capabilities=b.capabilities),q=new J(ga(b.url),{resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,
id:b.id,mode:b.mode===J.MODE_SELECTION?J.MODE_SELECTION:J.MODE_AUTO,editable:!1===d.editable?!1:void 0,outFields:["*"],autoGeneralize:!0,refreshInterval:b.refreshInterval}),!d.ignorePopups&&b.popupInfo&&q.setInfoTemplate(new v(b.popupInfo)),b.layerDefinition)b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.renderer&&(g=C.fromJson(b.layerDefinition.drawingInfo.renderer),g.isMaxInclusive=!0,q.setRenderer(g)),b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.labelingInfo&&(g=a.map(b.layerDefinition.drawingInfo.labelingInfo,
function(a){return new zb(a)}),q.setLabelingInfo(g)),b.layerDefinition.definitionExpression&&q.setDefinitionExpression(b.layerDefinition.definitionExpression),r.isDefined(b.layerDefinition.minScale)&&q.setMinScale(b.layerDefinition.minScale),r.isDefined(b.layerDefinition.maxScale)&&q.setMaxScale(b.layerDefinition.maxScale);Ba(q)}else b.resourceInfo&&b.resourceInfo.streamUrls&&(g={resourceInfo:b.resourceInfo,opacity:b.opacity,visible:b.visibility,id:b.id},b.layerDefinition&&(y=b.layerDefinition.drawingInfo,
b.layerDefinition.definitionGeometry&&(t=t||{},t.geometry=b.layerDefinition.definitionGeometry),r.isDefined(b.layerDefinition.definitionExpression)&&(t=t||{},t.where=b.layerDefinition.definitionExpression),r.isDefined(b.layerDefinition.maximumTrackPoints)&&(g.maximumTrackPoints=b.layerDefinition.maximumTrackPoints)),t&&(g.filter=t),b.purgeOptions&&(g.purgeOptions=b.purgeOptions),q=new db(ga(b.url),g),y&&y.renderer&&(E=y.renderer,q.setRenderer(C.fromJson(E))),!d.ignorePopups&&b.popupInfo&&q.setInfoTemplate(new v(b.popupInfo)),
b.layerDefinition&&(r.isDefined(b.layerDefinition.minScale)&&q.setMinScale(b.layerDefinition.minScale),r.isDefined(b.layerDefinition.maxScale)&&q.setMaxScale(b.layerDefinition.maxScale)),m.once(q,"error",function(a){b.errors.push({message:"Error loading stream layer. Check websocket url"})}));return q&&(q.arcgisProps={title:b.title},b.baseMapLayer&&(b.isReference?(q.attr("data-reference",!0),q._basemapGalleryLayerType="reference"):q._basemapGalleryLayerType="basemap")),q}function ia(b,c,d,e,f){a.forEach(b,
function(a){a.layerObject=ma(a,b,c,d,e,f)});var g=a.filter(b,function(a){return!a.isReference}),h=a.filter(b,function(a){return!!a.isReference});return b=g.concat(h)}function ja(a){var b=null;a=a[0];return a.url&&!a.type?a.resourceInfo.spatialReference&&(b=new u,a.resourceInfo.spatialReference.wkid&&(b.wkid=a.resourceInfo.spatialReference.wkid),a.resourceInfo.spatialReference.wkt&&(b.wkt=a.resourceInfo.spatialReference.wkt)):a.type&&(-1<a.type.indexOf("BingMaps")||"OpenStreetMap"==a.type?b=new u({wkid:102100}):
"WMS"==a.type&&(b=new u({wkid:a.spatialReferences[0]}))),b}function za(b,c,d,e,f,g,h,l){return a.forEach(c,function(a){a.url&&!a.type&&(a.resourceInfo=b[a.deferredsPos][1],delete a.deferredsPos)}),g=g||ja(c),c=ia(c,d,g,h,l),f.callback(c),f}function Ba(a){!window.CanvasRenderingContext2D&&a.renderer&&"esri.renderer.HeatmapRenderer"===a.renderer.declaredClass&&a.setRenderer(C.fromJson({type:"simple",symbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",
outline:{color:[255,255,255,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}}}))}function ra(a,b){var c=ga(a);return v({url:c,content:{f:"json"},callbackParamName:"callback",error:function(a,d){a.message?a.message+=" [url:"+c+"]":a.message="[url:"+c+"]";b.push(a);q.defaults.io.errorHandler(a,d)}})}function ua(a){var b=ha.arcgisUrl+"/"+a.itemId+"/data";return v({url:b,content:{f:"json"},callbackParamName:"callback",error:function(c,d){c.message?c.message+=" [url:"+b+"]":c.message="[url:"+b+"]";
a.errors=a.errors||[];a.errors.push(c);q.defaults.io.errorHandler(c,d)}})}function xa(c,d,f){var g=new b;return f.featureCollection&&f.featureCollection.layers||f.layers?(f.layers&&(f.featureCollection={layers:f.layers},delete f.layers,r.isDefined(f.showLegend)&&(f.featureCollection.showLegend=f.showLegend,delete f.showLegend)),Ha(c,f.featureCollection,d).then(function(b){f.featureCollection=b;c.featureCollection&&c.featureCollection.layers?a.forEach(f.featureCollection.layers,function(a,b){var d=
c.featureCollection.layers[b];d.popupInfo||d.layerDefinition?d.layerDefinition?(r.isDefined(d.layerDefinition.minScale)&&r.isDefined(d.layerDefinition.maxScale)&&(d.layerDefinition.minScale!==a.layerDefinition.minScale||d.layerDefinition.maxScale!==a.layerDefinition.maxScale)&&(delete a.layerDefinition.minScale,delete a.layerDefinition.maxScale),d.layerDefinition.drawingInfo&&e.toJson(d.layerDefinition.drawingInfo)!==e.toJson(a.layerDefinition.drawingInfo)&&delete a.layerDefinition.drawingInfo,d.layerDefinition.showLegend!==
a.layerDefinition.showLegend&&delete a.layerDefinition.showLegend,d.layerDefinition=k.mixin(d.layerDefinition,a.layerDefinition)):d.layerDefinition=a.layerDefinition:(d.popupInfo=a.popupInfo,d.layerDefinition=a.layerDefinition);d.featureSet=a.featureSet;d.nextObjectId=a.nextObjectId}):(c.featureCollection=c.featureCollection||{},c.featureCollection=k.mixin(c.featureCollection,f.featureCollection));g.callback(c)}),g):(c.errors=c.errors||[],c.errors.push({message:"Invalid Feature Collection item data. [item id: "+
c.itemId+"]"}),g.errback(),g)}function Ha(c,d,e){var f=new b;return h(["./csv"],function(b){var h=[];a.forEach(d.layers,function(a){a.featureSet&&a.featureSet.features&&a.featureSet.features.length&&a.featureSet.features[0].geometry&&a.featureSet.features[0].geometry.spatialReference&&(a.deferredsPos=h.length,h.push(b.projectFeatureCollection(a,e,a.featureSet.features[0].geometry.spatialReference)))});(new g(h)).addCallback(function(){a.forEach(d.layers,function(a){r.isDefined(a.deferredsPos)&&(h[a.deferredsPos].results&&
h[a.deferredsPos].results.length?a=h[a.deferredsPos].results[0]:(a.errors=a.errors||[],a.errors.push({message:"Errors projecting feature collection. ["+c.title+" - "+a.layerDefinition.name+"]"})),delete a.deferredsPos)});f.callback(d)})}),f}function Ia(c,d,e,f,l){var n,q=new b,r=new b,t=[];return a.forEach(c.operationalLayers,function(a){a.itemId&&"Feature Collection"==a.type&&t.push(ua(a).then(k.hitch(null,xa,a,e)))}),0===t.length?Da(c,d,e,f,r,l):(n=new g(t),n.addCallback(function(a){Da(c,d,e,f,
r,l)})),r.then(function(c){if(t=[],a.forEach(c,function(a){var c;a=a.layerObject;a instanceof J&&!a.loaded&&!a.loadError?(c=new b,m.once(a,"load, error",function(){c.callback(a)}),t.push(c)):a&&"esri.layers.WFSLayer"===a.declaredClass&&!a.loadError&&(c=new b,m.once(a,"fromJsonComplete, error",function(b){c.callback(a)}),t.push(c))}),t.length){var d=new b;return n=new g(t),n.addCallback(function(){d.callback(c)}),d.promise}return c}).then(function(b){var c=[];a.forEach(b,function(a){var b=a.layerObject;
b instanceof J?b.loaded&&b.labelingInfo&&(a.showLabels||b._collection)&&c.push(b):b&&"esri.layers.WFSLayer"===b.declaredClass&&b.loaded&&b.labelingInfo&&c.push(b)});c.length?h(["../layers/LabelLayer"],function(d){var e=new d;a.forEach(c,function(a){e.addFeatureLayer(a)});b.push({layerObject:e});q.callback(b)}):q.callback(b)}),q}function Da(b,c,d,e,f,h){var l=[],m=[],k=[];(a.forEach(b.operationalLayers,function(b,c){if(b.featureCollection&&b.featureCollection.layers){var d=b.featureCollection.layers.length;
a.forEach(b.featureCollection.layers,function(e,f){var g=!0;b.visibleLayers&&-1==a.indexOf(b.visibleLayers,f)&&(g=!1);e.visibility=b.visibility&&g;e.opacity=b.opacity;e.id=(b.id||"operational"+c)+"_"+f;b.title&&(1!==d&&e.layerDefinition.name&&b.title!==e.layerDefinition.name?e.title=b.title+" - "+e.layerDefinition.name:e.title=b.title);k.push(e)},this)}else k.push(b)}),a.forEach(b.baseMap.baseMapLayers,function(a,b){a.baseMapLayer=!0;a.id=a.id||"base"+b;l.push(a)}),a.forEach(k,function(a,b){a.id=
a.id||"operational"+b;l.push(a)}),a.forEach(l,function(a){a.url&&!a.type&&(a.deferredsPos=m.length,a.errors=a.errors||[],m.push(ra(a.url,a.errors)))}),0===m.length)?(d=d||ja(l),l=ia(l,c,d,e,h),f.callback(l)):(new g(m)).addCallback(function(a){za(a,l,c,m,f,d,e,h)});return f}function Ja(b,c,d,e){var f=b.minScale,g=b.maxScale;if(10.1>=d.version&&c)for(b=c.length-1;0<=b;b--){if(c[b].id==e){if(0==f&&0<c[b].minScale?f=c[b].minScale:0<f&&0==c[b].minScale?f=d.minScale:0<f&&0<c[b].minScale&&(f=Math.min(f,
c[b].minScale)),g=Math.max(d.maxScale||0,c[b].maxScale||0),d.setScaleRange(f,g),!(-1<c[b].parentLayerId))break;e=c[b].parentLayerId}}else 10.1<d.version&&(a.forEach(b.layerInfos,function(a){a.id==e&&(0==f&&0<a.minScale?f=a.minScale:0<f&&0==a.minScale||0<f&&0<a.minScale&&(f=Math.min(f,a.minScale)),g=Math.max(g||0,a.maxScale||0))}),d.setScaleRange(f,g))}function Ga(b,c,d,e){var g=b.url,h=b.__popupIds,l=b.__popupUrls,m=b.__popupWhereClauses,n=b.__popupMinScales,q=b.__popupMaxScales,t=b.__resourceInfo,
u=[];if(a.forEach(b.__popups,function(e,k){if(e){var v,w=[];if(a.forEach(e.fieldInfos,function(a){"shape"!==a.fieldName.toLowerCase()&&w.push(a.fieldName)}),b.dynamicLayerInfos&&0<b.dynamicLayerInfos.length){var x=a.filter(b.dynamicLayerInfos,function(a){return h[k]==a.id})[0].source;v=new J(g+"/dynamicLayer",{id:b.id+"_"+h[k],source:x,outFields:w,mode:J.MODE_SELECTION,infoTemplate:e&&new d(e),drawMode:!1,visible:b.visible,autoGeneralize:!0});var z=function(a,d){if(0<m[a].length&&d.setDefinitionExpression(m[a]),
r.isDefined(n[a])||r.isDefined(q[a]))if(r.isDefined(b.minScale)||r.isDefined(b.maxScale)){var e=b.minScale,f=b.maxScale;0==e&&0<n[a]?e=n[a]:0<e&&0==n[a]||0<e&&0<n[a]&&(e=Math.min(e,n[a]));f=Math.max(f||0,q[a]||0);d.setScaleRange(e,f)}else d.setScaleRange(n[a],q[a]);else Ja(b,c||t.layers,d,h[a])};v.loaded?z(k,v):f.connect(v,"onLoad",function(a){z(k,v)})}else{var y=null,C=g+"/"+h[k];if(l[k].length)C=l[k];else if(c)for(x=0;x<c.length;x++)if(c[x].id===h[k]){y=c[x];break}v=new J(ga(C),{id:b.id+"_"+h[k],
outFields:w,mode:J.MODE_SELECTION,infoTemplate:e&&new d(e),drawMode:!1,visible:b.visible,resourceInfo:y,autoGeneralize:!0});v.loaded?(0<m[k].length&&v.setDefinitionExpression(m[k]),Ja(b,c||t.layers,v,h[k])):f.connect(v,"onLoad",function(a){0<m[k].length&&v.setDefinitionExpression(m[k]);Ja(b,c||t.layers,a,h[k])})}u.push(v)}}),0<u.length)f.connect(b,"onVisibilityChange",k.hitch(this,function(b,c){a.forEach(b,function(a){c?a.show():a.hide()})},u)),f.connect(e,"onLayerRemove",k.hitch(this,function(b,
c,d){b.id===d.id&&a.forEach(c,function(a){e.removeLayer(a)})},b,u));return delete b.__popups,delete b.__popupIds,delete b.__popupUrls,delete b.__popupWhereClauses,delete b.__popupMinScales,delete b.__popupMaxScales,delete b.__resourceInfo,u}function Na(a){return v({url:ga(a.url+"/layers"),content:{f:"json"},callbackParamName:"callback",error:function(){}})}function Ta(b,c,d){var e=[];a.forEach(b,function(a){var b=a.__popups;b&&1<b.length&&10<=a.version&&(a.__deferredsPos=e.length,e.push(Na(a)))});
var f=[];0<e.length?(new g(e)).addCallback(function(e){a.forEach(b,function(a){a.__popups&&0<a.__popups.length&&(a.__deferredsPos||0===a.__deferredsPos?(f=f.concat(Ga(a,e[a.__deferredsPos][1].layers,d,c)),delete a.__deferredsPos):f=f.concat(Ga(a,null,d,c)))});c.addLayers(f)}):(a.forEach(b,function(a){a.__popups&&0<a.__popups.length&&(f=f.concat(Ga(a,null,d,c)))}),c.addLayers(f))}function Xa(b){a.forEach(b,function(b){var c=b.layer;c.toJson&&(b=c.toJson(),b.featureSet&&c.name&&-1<c.name.indexOf("Text")&&
a.forEach(b.featureSet.features,function(a,b){if(a.attributes.TEXT){var d=c.graphics[b];d.symbol.setText(a.attributes.TEXT);a.symbol.horizontalAlignment&&(d.symbol.align=a.symbol.horizontalAlignment);d.setSymbol(d.symbol);d.setAttributes(a.attributes)}},this))})}function Ma(b){var c=6;return a.forEach(b,function(b){if(b=b.renderer)"esri.renderer.SimpleRenderer"===b.declaredClass?((b=b.symbol)&&b.xoffset&&(c=Math.max(c,Math.abs(b.xoffset))),b&&b.yoffset&&(c=Math.max(c,Math.abs(b.yoffset)))):"esri.renderer.UniqueValueRenderer"!==
b.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==b.declaredClass||a.forEach(b.infos,function(a){(a=a.symbol)&&a.xoffset&&(c=Math.max(c,Math.abs(a.xoffset)));a&&a.yoffset&&(c=Math.max(c,Math.abs(a.yoffset)))})}),c}function Oa(c){var d=this,e=d.infoWindow,f=c.graphic;if(d.loaded){e.hide();e.clearFeatures();var g=[];if(a.forEach(d.graphicsLayerIds,function(a){(a=d.getLayer(a))&&a instanceof J&&a.loaded&&a.visible&&(a.clearSelection(),a.infoTemplate&&!a.suspended&&g.push(a))}),a.forEach(d.layerIds,
function(a){(a=d.getLayer(a))&&-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")&&a.loaded&&a.visible&&a.infoTemplate&&g.push(a)}),f=f&&f.getInfoTemplate()?f:null,g.length||f){var h=Ma(g),l=c.screenPoint,m=d.toMap(new y(l.x-h,l.y+h)),h=d.toMap(new y(l.x+h,l.y-h)),m=new A(m.x,m.y,h.x,h.y,d.spatialReference),k=new F;k.geometry=m;k.timeExtent=d.timeExtent;var n=!0,m=a.map(g,function(a){var b;-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")?(k.geometry=c.mapPoint,n=!1,b=a.queryVisibleRasters(k,
{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),b.addCallback(function(){return a.getVisibleRasters()})):(b=a.selectFeatures(k),b.addCallback(function(){return a.getSelectedFeatures()}));return b});f&&(h=new b,h.callback([f]),m.splice(0,0,h));if(!a.some(m,function(a){return-1===a.fired})){var q=f?1:0;if(a.forEach(g,function(a){q+=-1!==a.declaredClass.indexOf("ArcGISImageServiceLayer")?a.getVisibleRasters().length:a.getSelectedFeatures().length}),!q)return}e.setFeatures(m);e.show(c.mapPoint,
{closestFirst:n})}}}function Y(a,b){var c,e=b.mapOptions||{};e.infoWindow||(c=new E({visibleWhenEmpty:!1},d.create("div")),e.infoWindow=c);r.isDefined(e.showInfoWindowOnClick)||b.usePopupManager||(e.showInfoWindowOnClick=!1);c=new w(a,e);return f.connect(c,"onLayersAddResult",Xa),c}function va(b,c,d,e,g,h){var l,m,k,n;e.map?(l=e.map,m=e.clickEventHandle,k=e.clickEventListener,n=e.errors):(l=Y(e,g),g.ignorePopups||g.disableClickBehavior||g.usePopupManager||(m=f.connect(l,"onClick",Oa),k=Oa));l.addLayers(b);
g.ignorePopups||g.usePopupManager||Ta(b,l,g._clazz);var q=n||[];a.forEach(c,function(a){a.errors&&(q=q.concat(a.errors))},this);l.loaded?h.callback({map:l,itemInfo:d,errors:q,clickEventHandle:m,clickEventListener:k}):f.connect(l,"onLoad",function(){h.callback({map:l,itemInfo:d,errors:q,clickEventHandle:m,clickEventListener:k})})}function Ca(b,c,d,e,f){var g=[];if(a.forEach(f,function(b){k.isArray(b.layerObject)?a.forEach(b.layerObject,function(a){g.push(a)}):g.push(b.layerObject)}),"BingMapsAerial"===
f[0].type||"BingMapsRoad"===f[0].type||"BingMapsHybrid"===f[0].type)var h=setInterval(function(){if(f[0].layerObject&&f[0].layerObject.loaded)clearInterval(h),fa(b,c,d,e,f,g);else if(f[0].errors){clearInterval(h);var a="";f[0].errors&&f[0].errors.length&&(a=" ("+f[0].errors[0].message+")");e.errback(Error(L.arcgis.utils.baseLayerError+a))}},10);else if(!g[0]&&f[0].baseMapLayer){var l="";f[0].errors&&f[0].errors.length&&(l=" ("+f[0].errors[0].message+")");e.errback(Error(L.arcgis.utils.baseLayerError+
l))}else fa(b,c,d,e,f,g)}function fa(b,c,d,e,f,g){try{var h=d.mapOptions||{};d.mapOptions=h;var l=b.item,m=b.itemData;if(!h.backgroundColor&&m.background&&m.background.color&&null!=m.background.color[0]&&(h.backgroundColor=t.toDojoColor(m.background.color)),g=a.filter(g,r.isDefined),l)if(l.extent&&l.extent.length)if(h.extent)va(g,f,b,c,d,e);else{var k=new A(l.extent[0][0],l.extent[0][1],l.extent[1][0],l.extent[1][1],new u({wkid:4326})),n=g[0].spatialReference;4326===n.wkid?(h.extent=k,va(g,f,b,c,
d,e)):102100===n.wkid||102113===n.wkid||3857===n.wkid?(k.xmin=Math.max(k.xmin,-180),k.xmax=Math.min(k.xmax,180),k.ymin=Math.max(k.ymin,-89.99),k.ymax=Math.min(k.ymax,89.99),h.extent=z.geographicToWebMercator(k),va(g,f,b,c,d,e)):d.geometryServiceURL||q.defaults.geometryService?(d.geometryServiceURL?new G(d.geometryServiceURL):q.defaults.geometryService).project([k],n,function(a){a=a[0];h.extent=h.extent||a;va(g,f,b,c,d,e)},function(){va(g,f,b,c,d,e)}):e.errback(Error(L.arcgis.utils.geometryServiceError))}else va(g,
f,b,c,d,e);else va(g,f,b,c,d,e)}catch(cb){e.errback(cb)}}function Ra(b){var c=[];return a.forEach(b.operationalLayers,function(a){a.featureCollection?c.push({featureCollection:a.featureCollection,visibility:a.visibility,title:a.title}):a.layerObject&&c.push({layer:a.layerObject,visibility:a.visibility,title:a.title})}),c}function qa(b){var c=[];b=b.baseMap.baseMapLayers.concat(b.operationalLayers);return a.forEach(b,function(b){var d={};if(b.featureCollection&&"CSV"!==b.type)!0===b.featureCollection.showLegend&&
a.forEach(b.featureCollection.layers,function(a){if(!1!==a.showLegend){var e=a.layerObject.renderer;d={layer:a.layerObject,title:b.title,defaultSymbol:e&&e.defaultSymbol&&e.defaultLabel?!0:!1};1<b.featureCollection.layers.length&&(d.title+=" - "+a.layerDefinition.name);c.push(d)}});else if(b.baseMapLayer&&!0===b.showLegend&&b.layerObject||!b.baseMapLayer&&!1!==b.showLegend&&b.layerObject&&!(b.layerObject instanceof J&&b.layerObject.mode===J.MODE_SELECTION)){var e=b.layerObject.renderer,f=b.layerObject.declaredClass,
e=!e||e&&e.defaultSymbol&&e.defaultLabel?!0:!1;if((10.1>b.layerObject.version&&("esri.layers.ArcGISDynamicMapServiceLayer"===f||"esri.layers.ArcGISTiledMapServiceLayer"===f)||"esri.layers.ArcGISImageServiceLayer"===f)&&(e=!0),d={layer:b.layerObject,title:b.title,defaultSymbol:e},b.layers)f=a.map(a.filter(b.layers,function(a){return!1===a.showLegend}),function(a){return a.id}),f.length&&(d.hideLayers=f);c.push(d)}}),c}function na(c,d){function e(b,c){a.forEach(b,function(a,b){switch(a){case fb:N=c[b];
break;case vb:ea=c[b];break;case Kb:ka=c[b];break;case xb:sa=c[b];break;case qb:ba=c[b];break;case Lb:ca=c[b];break;case Mb:U=c[b];break;case ib:yb=c[b];break;case Ka:pb=c[b];break;case Bb:jb=c[b];break;case kb:zb=c[b];break;case Cb:Ua=c[b];break;case $a:wb=c[b];break;case Eb:rb=c[b];break;case Sa:Ab=c[b];break;case Fb:db=c[b];break;case Gb:hb=c[b];break;case mb:Ya=c[b];break;case Ea:Wa=c[b];break;case Hb:Ob=c[b];break;case Ib:Za=c[b];break;case nb:eb=c[b];break;case Jb:Rb=c[b]}})}var f=new b,g=c.itemData,
l=[];g.baseMap&&g.baseMap.baseMapLayers&&(l=l.concat(g.baseMap.baseMapLayers));g.operationalLayers&&(l=l.concat(g.operationalLayers));for(var g=a.map(l,function(a){return a&&a.layerType}),m=[],k=[],l=!1,n=0;n<g.length;n++){switch(g[n]){case "ArcGISFeatureLayer":-1===a.indexOf(m,kb)&&m.push(kb);break;case "ArcGISImageServiceLayer":case "ArcGISTiledImageServiceLayer":-1===a.indexOf(m,vb)&&(m.push(vb),k.push(Ka),k.push($a),k.push(Sa));break;case "ArcGISImageServiceVectorLayer":-1===a.indexOf(m,Kb)&&
(m.push(Kb),k.push(Ka),k.push($a),k.push(Sa));break;case "ArcGISMapServiceLayer":case "ArcGISTiledMapServiceLayer":-1===a.indexOf(m,fb)&&(m.push(fb),k.push(Lb),k.push(ib),k.push(Cb));break;case "ArcGISStreamLayer":-1===a.indexOf(m,Fb)&&m.push(Fb);break;case "BingMapsAerial":case "BingMapsHybrid":case "BingMapsRoad":-1===a.indexOf(m,Ea)&&m.push(Ea);break;case "CSV":-1===a.indexOf(m,qb)&&(m.push(qb),k.push(xb));break;case "GeoRSS":-1===a.indexOf(m,Mb)&&m.push(Mb);break;case "KML":-1===a.indexOf(m,Bb)&&
m.push(Bb);break;case "OpenStreetMap":-1===a.indexOf(m,Eb)&&m.push(Eb);break;case "VectorTileLayer":-1===a.indexOf(m,mb)&&m.push(mb);break;case "WebTiledLayer":-1===a.indexOf(m,Hb)&&(m.push(Hb),k.push(Gb));break;case "WFS":-1===a.indexOf(m,Ib)&&m.push(Ib);break;case "WMS":-1===a.indexOf(m,nb)&&(m.push(nb),k.push(Jb));break;default:l=!0}if(l)break}return l&&(m=Nb,k=$b),m.length?h(m,function(){e(m,arguments);k.length?h(k,function(){e(k,arguments);f.resolve()}):f.resolve()}):f.resolve(),f}function Va(c,
d,e,f){var g=f.itemData;g.baseMap&&g.baseMap.baseMapLayers&&g.baseMap.baseMapLayers.length&&(g.baseMap.baseMapLayers[0].firstLayer=!0);var h=d.layerMixins,l=h&&h.length;if(l){var m=function(a){for(var b=0;l>b;b++){var c=h[b];if(c.mixin)if(c.hasOwnProperty("id")){if(a.id===c.id){k.mixin(a,c.mixin);break}}else if(a.url===c.url){k.mixin(a,c.mixin);break}}};a.forEach(g.baseMap&&g.baseMap.baseMapLayers,m);a.forEach(g.operationalLayers,m)}na(f,d).then(function(){return Q(f,d)}).then(function(){return S(f,
d)}).then(function(d){var f=d[0],g=d[1];if(f.itemData.operationalLayers&&0!==f.itemData.operationalLayers.length){var h=new b,l=f.itemData.baseMap.baseMapLayers.slice(),m=a.filter(f.itemData.baseMap.baseMapLayers,function(a){return!a.isReference});d={item:f.item,itemData:{baseMap:{baseMapLayers:m}}};f.itemData.baseMap.baseMapLayers=a.filter(f.itemData.baseMap.baseMapLayers,function(a){return a.isReference});O(d,g).addCallback(function(a){Ia(a.itemData,g).addCallback(k.hitch(null,Ca,a,c,g,h))});h.then(function(a){O(f,
g).addCallback(function(b){Ia(b.itemData,g,a.map.spatialReference,m,a.map).addCallback(function(c){b.itemData.baseMap.baseMapLayers=l;Ca(b,a,g,e,c)})})},k.hitch(e,e.errback))}else O(f,g).addCallback(function(a){Ia(a.itemData,g).addCallback(k.hitch(null,Ca,a,c,g,e))})})}function W(a,c){"undefined"==typeof c&&(c=!0);ha._arcgisUrl&&0<ha._arcgisUrl.length&&(ha.arcgisUrl=ha._arcgisUrl);var d=ha.arcgisUrl+"/"+a,e={},f=new b;return v({url:d,content:{f:"json"},callbackParamName:"callback",load:function(a){return e.item=
a,c?void v({url:d+"/data",content:{f:"json"},callbackParamName:"callback",load:function(a){e.itemData=a;f.callback(e)},error:function(a){f.errback(a)}}):void f.callback(e)},error:function(a){f.errback(a)}}),f}var ha,N,ea,ka,sa,ba,ca,U,yb,pb,jb,zb,Ua,wb,rb,Ab,db,hb,Ya,Wa,Ob,Za,eb,Rb,fb="../layers/ArcGISDynamicMapServiceLayer",vb="../layers/ArcGISImageServiceLayer",Kb="../layers/ArcGISImageServiceVectorLayer",xb="./csv",qb="../layers/CSVLayer",Lb="../layers/DynamicLayerInfo",Mb="../layers/GeoRSSLayer",
ib="../layers/ImageParameters",Ka="../layers/ImageServiceParameters",Bb="../layers/KMLLayer",kb="../layers/LabelClass",Cb="../layers/LayerDrawingOptions",$a="../layers/MosaicRule",Eb="../layers/OpenStreetMapLayer",Sa="../layers/RasterFunction",Fb="../layers/StreamLayer",Gb="../layers/TileInfo",mb="../layers/VectorTileLayer",Ea="../virtualearth/VETiledLayer",Hb="../layers/WebTiledLayer",Ib="../layers/WFSLayer",nb="../layers/WMSLayer",Jb="../layers/WMSLayerInfo",Nb=[fb,vb,Kb,qb,Mb,Bb,kb,Eb,Fb,mb,Ea,
Hb,Ib,nb],$b=[xb,Lb,ib,Ka,Cb,$a,Sa,Gb,Jb];return ha={arcgisUrl:x.getProtocolForWebResource()+"//www.arcgis.com/sharing/rest/content/items",getItem:W,createMap:function(a,c,d){var e=new b;d=d||{};var f=d.infoTemplateClass;return d._clazz=f&&(k.isObject(f)?f:k.getObject(f))||D,k.isString(a)?W(a).addCallback(k.hitch(null,Va,c,d,e)).addErrback(k.hitch(e,e.errback)):Va(c,d,e,a),e},getLayerList:function(a){return a&&a.itemInfo&&a.itemInfo.itemData?Ra(a.itemInfo.itemData):[]},getLegendLayers:function(a){return a&&
a.itemInfo&&a.itemInfo.itemData?qa(a.itemInfo.itemData):[]},_arcgisUrl:null,_getItemProps:O,_getItemData:M,_getBingKey:H,_portalUrlResponse:R,_portalUrlFailure:aa,_processFSItemProperties:K,_processSSItemProperties:P,_getLayers:Ia,_preBuildLayerObjects:za,_buildLayerObjects:ia,_preCreateMap:Ca,_getMapSR:ja,_createMap:va,_addSelectionLayers:Ta,_createSelectionFeatureLayers:Ga,_getServiceInfo:ra,_getFeatureCollectionItem:ua,_mergeFeatureCollectionItem:xa,_projectFeatureCollection:Ha,_getLayersInfo:Na,
_initLayer:ma,_loadAsCached:la,_loadAsDynamic:ta,_processPopups:T,_onLayersAddResult:Xa,_sameSpatialReferenceAsBasemap:wa,_sameTilingSchemeAsBasemap:oa,_showPopup:Oa,_calculateClickTolerance:Ma,_getVisibleFeatureLayers:Aa,_updateLayerScaleInfo:Ja,_checkUrl:ga,_isHostedService:V,_isAgolService:da,_getLegendLayers:qa},k.setObject("arcgis.utils",ha,n),ha})},"esri/tasks/RouteTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../request ../geometry/normalizeUtils ./Task ./RouteResult ./NAMessage ./NAServiceDescription".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n){h=h([g,n],{declaredClass:"esri.tasks.RouteTask",_eventMap:{"solve-complete":["result"]},constructor:function(a){this._url.orig=this._url.path;this._url.path+="/solve";this._handler=k.hitch(this,this._handler);this.registerConnectEvents()},__msigns:[{n:"solve",c:3,a:[{i:0,p:["stops.features","barriers.features","polylineBarriers.features","polygonBarriers.features"]}],e:2}],_handler:function(b,f,g,h,l){try{var m,k,n=[],q=[],r=b.directions||[],t=b.routes?b.routes.features:
[],u=b.stops?b.stops.features:[],v=b.barriers?b.barriers.features:[],E=b.polygonBarriers?b.polygonBarriers.features:[],F=b.polylineBarriers?b.polylineBarriers.features:[],G=b.messages,I=a.forEach,J=a.indexOf,L=!0,M=b.routes&&b.routes.spatialReference||b.stops&&b.stops.spatialReference||b.barriers&&b.barriers.spatialReference||b.polygonBarriers&&b.polygonBarriers.spatialReference||b.polylineBarriers&&b.polylineBarriers.spatialReference;this._chk=b.checksum;I(r,function(a){n.push(m=a.routeName);q[m]=
{directions:a}});I(t,function(a){-1===J(n,m=a.attributes.Name)&&(n.push(m),q[m]={});q[m].route=a});I(u,function(a){k=a.attributes;-1===J(n,m=k.RouteName||"esri.tasks.RouteTask.NULL_ROUTE_NAME")&&(n.push(m),q[m]={});"esri.tasks.RouteTask.NULL_ROUTE_NAME"!==m&&(L=!1);void 0===q[m].stops&&(q[m].stops=[]);q[m].stops.push(a)});0<u.length&&!0===L&&(q[n[0]].stops=q["esri.tasks.RouteTask.NULL_ROUTE_NAME"].stops,delete q["esri.tasks.RouteTask.NULL_ROUTE_NAME"],n.splice(a.indexOf(n,"esri.tasks.RouteTask.NULL_ROUTE_NAME"),
1));var H=[];I(n,function(a,b){q[a].routeName="esri.tasks.RouteTask.NULL_ROUTE_NAME"===a?null:a;q[a].spatialReference=M;H.push(new d(q[a]))});b=function(a){return I(a,function(b,c){b.geometry&&(b.geometry.spatialReference=M);a[c]=new e(b)}),a};I(G,function(a,b){G[b]=new c(a)});var K={routeResults:H,barriers:b(v),polygonBarriers:b(E),polylineBarriers:b(F),messages:G};this._successHandler([K],"onSolveComplete",g,l)}catch(P){this._errorHandler(P,h,l)}},solve:function(a,b,c,d){var e=d.assembly;a=this._encode(k.mixin({},
this._url.query,{f:"json"},a.toJson(e&&e[0]),this._chk?{checksum:this._chk}:{}));var f=this._handler,g=this._errorHandler;return l({url:this._url.path,content:a,callbackParamName:"callback",load:function(a,e){f(a,e,b,c,d.dfd)},error:function(a){g(a,c,d.dfd)}})},onSolveComplete:function(){}});return m._createWrappers(h),f("extend-esri")&&k.setObject("tasks.RouteTask",h,b),h})},"esri/tasks/RouteResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ./DirectionsFeatureSet".split(" "),
function(h,k,a,f,b,e,l){h=h(null,{declaredClass:"esri.tasks.RouteResult",constructor:function(b){var f=b.spatialReference,d=b.route;if(b.directions){var c=[],h=[],m=[];a.forEach(b.directions.features,function(a,b){h[b]=a.compressedGeometry;c[b]=a.strings;m[b]=a.events});b.directions.strings=c;b.directions.events=m;this.directions=new l(b.directions,h)}if(this.routeName=b.routeName,d&&(d.geometry&&(d.geometry.spatialReference=f),this.route=new e(d)),b.stops){var k=this.stops=[];a.forEach(b.stops,function(a,
b){a.geometry&&(a.geometry.spatialReference=f);k[a.attributes.Sequence-1]=new e(a)})}},routeName:null,directions:null,route:null,stops:null});return f("extend-esri")&&k.setObject("tasks.RouteResult",h,b),h})},"esri/tasks/DirectionsFeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/json ../kernel ../geometry/Extent ../geometry/Polyline ../geometry/Point ../graphic ./FeatureSet".split(" "),function(h,k,a,f,b,e,l,m,g,d,c){h=h(c,{declaredClass:"esri.tasks.DirectionsFeatureSet",
constructor:function(c,e){this.routeId=c.routeId;this.routeName=c.routeName;k.mixin(this,c.summary);this.extent=new l(this.envelope);var f=this._fromCompressedGeometry,h=this.features,m=this.extent.spatialReference,n=[];a.forEach(e,function(a,b){h[b].setGeometry(n[b]=a?f(a,m):h[b].geometry)});this.mergedGeometry=this._mergePolylinesToSinglePath(n,m);this.geometryType="esriGeometryPolyline";a.forEach(c.events,function(e,f){a.forEach(e,function(a,c){e[c]=new d(new g(a.point.x,a.point.y,m),null,{ETA:a.ETA,
strings:b.stringify(a.strings),arriveTimeUTC:a.arriveTimeUTC})});c.events[f]=e});delete this.envelope},_fromCompressedGeometry:function(b,c){var d,e,f,g,h,l,k,n,q=0,B=0,C=0,D=0,E=[],F=0,G=0,I=0;(h=b.match(/((\+|\-)[^\+\-\|]+|\|)/g),h||(h=[]),0===parseInt(h[F],32))?(F=2,d=parseInt(h[F],32),F++,l=parseInt(h[F],32),F++,1&d&&(G=a.indexOf(h,"|")+1,k=parseInt(h[G],32),G++),2&d&&(I=a.indexOf(h,"|",G)+1,n=parseInt(h[I],32),I++)):(l=parseInt(h[F],32),F++);for(;F<h.length&&"|"!==h[F];)d=parseInt(h[F],32)+q,
F++,q=d,e=parseInt(h[F],32)+B,F++,B=e,d=[d/l,e/l],G&&(g=parseInt(h[G],32)+C,G++,C=g,d.push(g/k)),I&&(f=parseInt(h[I],32)+D,I++,D=f,d.push(f/n)),E.push(d);f=new m({paths:[E],hasZ:0<G,hasM:0<I});return f.setSpatialReference(c),f},_mergePolylinesToSinglePath:function(b,c){var d=[];a.forEach(b,function(b){a.forEach(b.paths,function(a){d=d.concat(a)})});var e=[],f=[0,0];return a.forEach(d,function(a){(a[0]!==f[0]||a[1]!==f[1])&&(e.push(a),f=a)}),(new m({paths:[e]})).setSpatialReference(c)}});return f("extend-esri")&&
k.setObject("tasks.DirectionsFeatureSet",h,e),h})},"esri/tasks/NAMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(h,k,a,f){h=h(null,{declaredClass:"esri.tasks.NAMessage",constructor:function(a){k.mixin(this,a)}});return k.mixin(h,{TYPE_INFORMATIVE:0,TYPE_PROCESS_DEFINITION:1,TYPE_PROCESS_START:2,TYPE_PROCESS_STOP:3,TYPE_WARNING:50,TYPE_ERROR:100,TYPE_EMPTY:101,TYPE_ABORT:200}),a("extend-esri")&&k.setObject("tasks.NAMessage",h,f),h})},"esri/tasks/NAServiceDescription":function(){define(["dojo/_base/declare",
"dojo/json","dojo/Deferred","dojo/_base/lang","../request"],function(h,k,a,f,b){return h(null,{declaredClass:"esri.tasks._NAServiceDescription",_sd:null,getServiceDescription:function(e,h){var l=new a;if(this._sd)l.resolve(this._sd);else if(this._url&&this._url.orig){var g,d=this._url.orig,c=(this._url.path.match(/\/solve$/)||[]).length?"Route":(this._url.path.match(/\/solveClosestFacility$/)||[]).length?"ClosestFacility":"ServiceAreas",n=function(a){b({url:a+("/"===a[a.length-1]?"":"/")+"GetTravelModes/execute",
content:{f:"json",serviceName:c},callbackParamName:"callback"}).then(function(a){var b=[],c=null;if(a&&a.results&&a.results.length)for(var d=0;d<a.results.length;d++)if("supportedTravelModes"===a.results[d].paramName){if(a.results[d].value&&a.results[d].value.features)for(var e=0;e<a.results[d].value.features.length;e++)if(a.results[d].value.features[e].attributes){var f=k.parse(a.results[d].value.features[e].attributes.TravelMode);b.push(f)}}else"defaultTravelMode"===a.results[d].paramName&&(c=a.results[d].value);
g.supportedTravelModes=b;g.defaultTravelMode=c;l.resolve(g)},function(a){l.reject(a)})};b({url:d,content:{f:"json"},callbackParamName:"callback"}).then(function(a){g=a;g.supportedTravelModes||(g.supportedTravelModes=[]);for(a=0;a<g.supportedTravelModes.length;a++)g.supportedTravelModes[a].id||(g.supportedTravelModes[a].id=g.supportedTravelModes[a].itemId);h?l.resolve(g):e?n(e):10.4<=g.currentVersion?b({url:d+("/"===d[d.length-1]?"":"/")+"retrieveTravelModes",content:{f:"json"},callbackParamName:"callback"}).then(function(a){g.supportedTravelModes=
a.supportedTravelModes;g.defaultTravelMode=a.defaultTravelMode;l.resolve(g)},function(a){l.reject(a)}):b({url:d.substring(0,d.indexOf("/rest/")+6)+"info",content:{f:"json"},callbackParamName:"callback"}).then(function(a){a.owningSystemUrl?(d=a.owningSystemUrl,b({url:d+("/"===d[d.length-1]?"":"/")+"sharing/rest/portals/self",content:{f:"json"},callbackParamName:"callback"}).then(function(a){a&&a.helperServices&&a.helperServices.routingUtilities&&a.helperServices.routingUtilities.url?n(a.helperServices.routingUtilities.url):
l.resolve(g)},function(a){l.reject(a)})):l.resolve(g)},function(a){l.reject(a)})},function(a){l.reject(a)})}else l.reject("NA Task has no URL specified.");return l.then(f.hitch(this,function(a){this._sd=a}),f.hitch(this,function(){this._sd=null})),l.promise},getOwningSystemUrl:function(){var e=new a;if(this._url&&this._url.orig){var f=this._url.orig;b({url:f.substring(0,f.indexOf("/rest/")+6)+"info",content:{f:"json"},callbackParamName:"callback"}).promise.always(function(a){e.resolve(a.owningSystemUrl)})}else e.resolve(void 0);
return e.promise}})})},"esri/tasks/RouteParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang ../graphicsUtils ./NATypes".split(" "),function(h,k,a,f,b,e,l,m){h=h(null,{declaredClass:"esri.tasks.RouteParameters",accumulateAttributes:null,attributeParameterValues:null,barriers:null,directionsLanguage:null,directionsLengthUnits:null,directionsOutputType:null,directionsStyleName:null,directionsTimeAttribute:null,doNotLocateOnRestrictedElements:!0,
findBestSequence:null,ignoreInvalidLocations:null,impedanceAttribute:null,outputLines:"esriNAOutputLineTrueShape",outputGeometryPrecision:null,outputGeometryPrecisionUnits:null,outSpatialReference:null,polygonBarriers:null,polylineBarriers:null,preserveFirstStop:null,preserveLastStop:null,restrictionAttributes:null,restrictUTurns:null,returnBarriers:!1,returnDirections:!1,returnPolygonBarriers:!1,returnPolylineBarriers:!1,returnRoutes:!0,returnStops:!1,returnZ:!0,startTime:null,startTimeIsUTC:null,
timeWindowsAreUTC:null,stops:null,useHierarchy:null,useTimeWindows:null,travelMode:null,toJson:function(b){var d={returnDirections:this.returnDirections,returnRoutes:this.returnRoutes,returnZ:this.returnZ,returnStops:this.returnStops,returnBarriers:this.returnBarriers,returnPolygonBarriers:this.returnPolygonBarriers,returnPolylineBarriers:this.returnPolylineBarriers,attributeParameterValues:this.attributeParameterValues&&a.toJson(this.attributeParameterValues),outSR:this.outSpatialReference?this.outSpatialReference.wkid||
a.toJson(this.outSpatialReference.toJson()):null,outputLines:this.outputLines,findBestSequence:this.findBestSequence,preserveFirstStop:this.preserveFirstStop,preserveLastStop:this.preserveLastStop,useTimeWindows:this.useTimeWindows,startTime:this.startTime?this.startTime.getTime():null,startTimeIsUTC:this.startTimeIsUTC,timeWindowsAreUTC:this.timeWindowsAreUTC,accumulateAttributeNames:this.accumulateAttributes?this.accumulateAttributes.join(","):null,ignoreInvalidLocations:this.ignoreInvalidLocations,
impedanceAttributeName:this.impedanceAttribute,restrictionAttributeNames:this.restrictionAttributes?this.restrictionAttributes.join(","):null,restrictUTurns:this.restrictUTurns,useHierarchy:this.useHierarchy,directionsLanguage:this.directionsLanguage,outputGeometryPrecision:this.outputGeometryPrecision,outputGeometryPrecisionUnits:this.outputGeometryPrecisionUnits,directionsLengthUnits:m.LengthUnit[this.directionsLengthUnits],directionsTimeAttributeName:this.directionsTimeAttribute,directionsStyleName:this.directionsStyleName,
travelMode:"object"==typeof this.travelMode?a.toJson(this.travelMode):this.travelMode},c=this.stops;if("esri.tasks.FeatureSet"===c.declaredClass&&0<c.features.length?d.stops=a.toJson({type:"features",features:l._encodeGraphics(c.features,b&&b["stops.features"]),doNotLocateOnRestrictedElements:this.doNotLocateOnRestrictedElements}):"esri.tasks.DataLayer"===c.declaredClass?d.stops=c:"esri.tasks.DataFile"===c.declaredClass&&(d.stops=a.toJson({type:"features",url:c.url,doNotLocateOnRestrictedElements:this.doNotLocateOnRestrictedElements})),
this.directionsOutputType)switch(this.directionsOutputType.toLowerCase()){case "complete":d.directionsOutputType="esriDOTComplete";break;case "complete-no-events":d.directionsOutputType="esriDOTCompleteNoEvents";break;case "instructions-only":d.directionsOutputType="esriDOTInstructionsOnly";break;case "standard":d.directionsOutputType="esriDOTStandard";break;case "summary-only":d.directionsOutputType="esriDOTSummaryOnly";break;default:d.directionsOutputType=this.directionsOutputType}c=function(c,
d){return c?"esri.tasks.FeatureSet"===c.declaredClass?0<c.features.length?a.toJson({type:"features",features:l._encodeGraphics(c.features,b&&b[d])}):null:"esri.tasks.DataLayer"===c.declaredClass?c:"esri.tasks.DataFile"===c.declaredClass?a.toJson({type:"features",url:c.url}):a.toJson(c):null};return this.barriers&&(d.barriers=c(this.barriers,"barriers.features")),this.polygonBarriers&&(d.polygonBarriers=c(this.polygonBarriers,"polygonBarriers.features")),this.polylineBarriers&&(d.polylineBarriers=
c(this.polylineBarriers,"polylineBarriers.features")),e.filter(d,function(a){return null!==a?!0:void 0})}});return f("extend-esri")&&k.setObject("tasks.RouteParameters",h,b),h})},"esri/tasks/NATypes":function(){define(["dojo/_base/lang","dojo/has","../kernel"],function(h,k,a){var f={esriFeet:"esriNAUFeet",esriKilometers:"esriNAUKilometers",esriMeters:"esriNAUMeters",esriMiles:"esriNAUMiles",esriNauticalMiles:"esriNAUNauticalMiles",esriYards:"esriNAUYards"},b={NONE:"esriNAOutputLineNone",STRAIGHT:"esriNAOutputLineStraight",
TRUE_SHAPE:"esriNAOutputLineTrueShape",TRUE_SHAPE_WITH_MEASURE:"esriNAOutputLineTrueShapeWithMeasure"},e={ALLOW_BACKTRACK:"esriNFSBAllowBacktrack",AT_DEAD_ENDS_ONLY:"esriNFSBAtDeadEndsOnly",NO_BACKTRACK:"esriNFSBNoBacktrack",AT_DEAD_ENDS_AND_INTERSECTIONS:"esriNFSBAtDeadEndsAndIntersections"},l={NONE:"esriNAOutputPolygonNone",SIMPLIFIED:"esriNAOutputPolygonSimplified",DETAILED:"esriNAOutputPolygonDetailed"},m={FROM_FACILITY:"esriNATravelDirectionFromFacility",TO_FACILITY:"esriNATravelDirectionToFacility"},
g={LengthUnit:f,OutputLine:b,UTurn:e,OutputPolygon:l,TravelDirection:m};return k("extend-esri")&&(h.setObject("tasks._NALengthUnit",f,a),h.setObject("tasks.NAOutputLine",b,a),h.setObject("tasks.NAUTurn",e,a),h.setObject("tasks.NAOutputPolygon",l,a),h.setObject("tasks.NATravelDirection",m,a)),g})},"esri/tasks/DistanceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),function(h,k,a,f,b,e){h=h(null,{declaredClass:"esri.tasks.DistanceParameters",
geometry1:null,geometry2:null,distanceUnit:null,geodesic:null,toJson:function(){var b={},f=this.geometry1;f&&(b.geometry1=a.toJson({geometryType:e.getJsonType(f),geometry:f}));f=this.geometry2;return f&&(b.geometry2=a.toJson({geometryType:e.getJsonType(f),geometry:f})),b.sr=a.toJson(this.geometry1.spatialReference.toJson()),this.distanceUnit&&(b.distanceUnit=this.distanceUnit),this.geodesic&&(b.geodesic=this.geodesic),b}});return f("extend-esri")&&k.setObject("tasks.DistanceParameters",h,b),h})},
"cmv/viewer/js/gis/dijit/Directions/nls/resource":function(){define({root:{labels:{startAtMyLocation:"start at my location",endAtMyLocation:"end at my location",clearStops:"clear stops",addStop:"Add stop",directionsToHere:"Directions to here",directionsFromHere:"Directions from here",useMyLocationAsStart:"Use my location as start point",useMyLocationAsEnd:"Use my location as end point",directions:"Directions"},errors:{geoLocation:{title:"Error",message:"GeoLocation not supported by your browser."},
location:{title:"Error",message:"There was a problem getting your location: "}}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/Editor":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/dom-construct dojo/topic dojo/aspect dojo/text!./Editor/templates/Editor.html dojo/i18n!./Editor/nls/resource dijit/form/Button".split(" "),function(h,k,a,f,b,e,l,m,g,d){return h([k,a,f],{templateString:g,i18n:d,widgetsInTemplate:!0,
editor:null,isEdit:!1,mapClickMode:null,postCreate:function(){this.inherited(arguments);this.own(l.subscribe("mapClickMode/currentSet",b.hitch(this,"setMapClickMode")));this.parentWidget&&this.parentWidget.toggleable&&this.own(m.after(this.parentWidget,"toggle",b.hitch(this,function(){this.onLayoutChange(this.parentWidget.open)})))},toggleEditing:function(){if(this.isEdit)this.endEditing(),l.publish("mapClickMode/setDefault");else{var a=b.clone(this.settings);a.map=this.map;a.layerInfos=this.layerInfos;
var d=e.create("div",{innerHTML:'\x3cimg style\x3d"display:inline;" src\x3d"data:image/gif;base64,R0lGODlhIAAgALMAAP///7Ozs/v7+9bW1uHh4fLy8rq6uoGBgTQ0NAEBARsbG8TExJeXl/39/VRUVAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFBQAAACwAAAAAIAAgAAAE5xDISSlLrOrNp0pKNRCdFhxVolJLEJQUoSgOpSYT4RowNSsvyW1icA16k8MMMRkCBjskBTFDAZyuAEkqCfxIQ2hgQRFvAQEEIjNxVDW6XNE4YagRjuBCwe60smQUDnd4Rz1ZAQZnFAGDd0hihh12CEE9kjAEVlycXIg7BAsMB6SlnJ87paqbSKiKoqusnbMdmDC2tXQlkUhziYtyWTxIfy6BE8WJt5YEvpJivxNaGmLHT0VnOgGYf0dZXS7APdpB309RnHOG5gDqXGLDaC457D1zZ/V/nmOM82XiHQjYKhKP1oZmADdEAAAh+QQFBQAAACwAAAAAGAAXAAAEchDISasKNeuJFKoHs4mUYlJIkmjIV54Soypsa0wmLSnqoTEtBw52mG0AjhYpBxioEqRNy8V0qFzNw+GGwlJki4lBqx1IBgjMkRIghwjrzcDti2/Gh7D9qN774wQGAYOEfwCChIV/gYmDho+QkZKTR3p7EQAh+QQFBQAAACwBAAAAHQAOAAAEchDISWdANesNHHJZwE2DUSEo5SjKKB2HOKGYFLD1CB/DnEoIlkti2PlyuKGEATMBaAACSyGbEDYD4zN1YIEmh0SCQQgYehNmTNNaKsQJXmBuuEYPi9ECAU/UFnNzeUp9VBQEBoFOLmFxWHNoQw6RWEocEQAh+QQFBQAAACwHAAAAGQARAAAEaRDICdZZNOvNDsvfBhBDdpwZgohBgE3nQaki0AYEjEqOGmqDlkEnAzBUjhrA0CoBYhLVSkm4SaAAWkahCFAWTU0A4RxzFWJnzXFWJJWb9pTihRu5dvghl+/7NQmBggo/fYKHCX8AiAmEEQAh+QQFBQAAACwOAAAAEgAYAAAEZXCwAaq9ODAMDOUAI17McYDhWA3mCYpb1RooXBktmsbt944BU6zCQCBQiwPB4jAihiCK86irTB20qvWp7Xq/FYV4TNWNz4oqWoEIgL0HX/eQSLi69boCikTkE2VVDAp5d1p0CW4RACH5BAUFAAAALA4AAAASAB4AAASAkBgCqr3YBIMXvkEIMsxXhcFFpiZqBaTXisBClibgAnd+ijYGq2I4HAamwXBgNHJ8BEbzgPNNjz7LwpnFDLvgLGJMdnw/5DRCrHaE3xbKm6FQwOt1xDnpwCvcJgcJMgEIeCYOCQlrF4YmBIoJVV2CCXZvCooHbwGRcAiKcmFUJhEAIfkEBQUAAAAsDwABABEAHwAABHsQyAkGoRivELInnOFlBjeM1BCiFBdcbMUtKQdTN0CUJru5NJQrYMh5VIFTTKJcOj2HqJQRhEqvqGuU+uw6AwgEwxkOO55lxIihoDjKY8pBoThPxmpAYi+hKzoeewkTdHkZghMIdCOIhIuHfBMOjxiNLR4KCW1ODAlxSxEAIfkEBQUAAAAsCAAOABgAEgAABGwQyEkrCDgbYvvMoOF5ILaNaIoGKroch9hacD3MFMHUBzMHiBtgwJMBFolDB4GoGGBCACKRcAAUWAmzOWJQExysQsJgWj0KqvKalTiYPhp1LBFTtp10Is6mT5gdVFx1bRN8FTsVCAqDOB9+KhEAIfkEBQUAAAAsAgASAB0ADgAABHgQyEmrBePS4bQdQZBdR5IcHmWEgUFQgWKaKbWwwSIhc4LonsXhBSCsQoOSScGQDJiWwOHQnAxWBIYJNXEoFCiEWDI9jCzESey7GwMM5doEwW4jJoypQQ743u1WcTV0CgFzbhJ5XClfHYd/EwZnHoYVDgiOfHKQNREAIfkEBQUAAAAsAAAPABkAEQAABGeQqUQruDjrW3vaYCZ5X2ie6EkcKaooTAsi7ytnTq046BBsNcTvItz4AotMwKZBIC6H6CVAJaCcT0CUBTgaTg5nTCu9GKiDEMPJg5YBBOpwlnVzLwtqyKnZagZWahoMB2M3GgsHSRsRACH5BAUFAAAALAEACAARABgAAARcMKR0gL34npkUyyCAcAmyhBijkGi2UW02VHFt33iu7yiDIDaD4/erEYGDlu/nuBAOJ9Dvc2EcDgFAYIuaXS3bbOh6MIC5IAP5Eh5fk2exC4tpgwZyiyFgvhEMBBEAIfkEBQUAAAAsAAACAA4AHQAABHMQyAnYoViSlFDGXBJ808Ep5KRwV8qEg+pRCOeoioKMwJK0Ekcu54h9AoghKgXIMZgAApQZcCCu2Ax2O6NUud2pmJcyHA4L0uDM/ljYDCnGfGakJQE5YH0wUBYBAUYfBIFkHwaBgxkDgX5lgXpHAXcpBIsRADs\x3d"/\x3e',
style:"text-align:center;"},this.containerNode,"only");require(["esri/dijit/editing/Editor"],b.hitch(this,function(b){this.editor=new b({settings:a},d);this.editor.startup()}));this.toggleBTN.set("label",this.i18n.labels.stopEditing);this.toggleBTN.set("class","danger");this.isEdit=!0;l.publish("mapClickMode/setCurrent","editor")}},endEditing:function(){this.editor&&this.editor.destroyRecursive&&this.editor.destroyRecursive();this.toggleBTN.set("label",this.i18n.labels.startEditing);this.toggleBTN.set("class",
"success");this.isEdit=!1;this.editor=null},onLayoutChange:function(a){a||"editor"!==this.mapClickMode||(this.endEditing(),l.publish("mapClickMode/setDefault"))},setMapClickMode:function(a){this.mapClickMode=a;"editor"!==a&&this.endEditing()}})})},"cmv/viewer/js/gis/dijit/Editor/nls/resource":function(){define({root:{labels:{startEditing:"Start editing",stopEditing:"Stop editing"}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/StreetView":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/aspect dojo/topic esri/layers/GraphicsLayer esri/graphic esri/renderers/SimpleRenderer dojo/text!./StreetView/templates/StreetView.html esri/symbols/PictureMarkerSymbol dojo/dom-style dojo/dom-geometry esri/geometry/Point esri/SpatialReference dijit/MenuItem proj4js/proj4 dojo/i18n!./StreetView/nls/resource gis/plugins/Google dijit/form/ToggleButton xstyle/css!./StreetView/css/StreetView.css".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y){var A;return h([k,a,f],{widgetsInTemplate:!0,templateString:c,i18n:x,mapClickMode:null,panoOptions:null,proj4BaseURL:"https://epsg.io/",proj4Catalog:"EPSG",proj4CustomURL:null,postCreate:function(){this.inherited(arguments);y.load(b.hitch(this,function(a){A=a;this.panoOptions={addressControlOptions:{position:A.maps.ControlPosition.TOP_RIGHT},linksControl:!1,panControl:!1,zoomControlOptions:{style:A.maps.ZoomControlStyle.SMALL},enableCloseButton:!1};
this.createGraphicsLayer();this.map.on("click",b.hitch(this,"getStreetView"));this.own(l.subscribe("mapClickMode/currentSet",b.hitch(this,"setMapClickMode")));this.parentWidget&&(this.parentWidget.toggleable&&this.own(e.after(this.parentWidget,"toggle",b.hitch(this,function(){this.onLayoutChange(this.parentWidget.open)}))),this.own(e.after(this.parentWidget,"resize",b.hitch(this,"resize"))),this.own(l.subscribe(this.parentWidget.id+"/resize/resize",b.hitch(this,"resize"))));window.proj4||(window.proj4=
w);this.mapRightClickMenu&&this.addRightClickMenu()}))},createGraphicsLayer:function(){this.pointSymbol=new n(require.toUrl("gis/dijit/StreetView/images/blueArrow.png"),30,30);this.pointGraphics=new m({id:"streetview_graphics",title:"Street View"});this.pointRenderer=new d(this.pointSymbol);this.pointRenderer.label="Street View";this.pointRenderer.description="Street View";this.pointGraphics.setRenderer(this.pointRenderer);this.map.addLayer(this.pointGraphics)},addRightClickMenu:function(){this.map.on("MouseDown",
b.hitch(this,function(a){this.mapRightClickPoint=a.mapPoint}));this.mapRightClickMenu.addChild(new u({label:this.i18n.rightClickMenuItem.label,onClick:b.hitch(this,"streetViewFromMapRightClick")}))},onOpen:function(){this.pointGraphics.show();this.panorama&&this.panoramaService||(this.panorama=new A.maps.StreetViewPanorama(this.panoNode,this.panoOptions),this.panoramaService=new A.maps.StreetViewService)},onClose:function(){this.pointGraphics.hide();"streetview"===this.mapClickMode&&this.connectMapClick()},
onLayoutChange:function(a){if(a)this.onOpen();else this.onClose()},placePoint:function(){this.streetViewButtonDijit.get("checked")?this.disconnectMapClick():this.connectMapClick()},disconnectMapClick:function(){this.streetViewButtonDijit.set("checked",!0);this.map.setMapCursor("crosshair");l.publish("mapClickMode/setCurrent","streetview")},connectMapClick:function(){this.streetViewButtonDijit.set("checked",!1);this.map.setMapCursor("auto");l.publish("mapClickMode/setDefault")},clearGraphics:function(){this.pointGraphics.clear();
q.set(this.noStreetViewResults,"display","block")},enableStreetViewClick:function(){this.disconnectMapClick()},disableStreetViewClick:function(){this.connectMapClick()},getStreetView:function(a,c){if("streetview"===this.mapClickMode||c){var d=a.mapPoint;if(d){this.parentWidget&&!this.parentWidget.open&&this.parentWidget.toggle();var e=null,f=d.spatialReference.wkid;102100===f&&(f=3857);var g=this.proj4Catalog+":"+String(f);w.defs[g]?((d=w(w.defs[g]).inverse([d.x,d.y]))&&(e={x:d[0],y:d[1]}),q.set(this.streetViewInstructions,
"display","none"),e?(q.set(this.noStreetViewResults,"display","none"),this.getPanoramaLocation(e)):(this.setPanoPlace=null,this.clearGraphics(),q.set(this.noStreetViewResults,"display","block"))):require([this.proj4CustomURL||this.proj4BaseURL+String(f)+".js"],b.hitch(this,"getStreetView",a,!0))}}},getPanoramaLocation:function(a){var c=new A.maps.LatLng(a.y,a.x);this.panoramaService.getPanoramaByLocation(c,50,b.hitch(this,"getPanoramaByLocationComplete",a));A.maps.event.addListener(this.panorama,
"position_changed",b.hitch(this,"setPlaceMarkerPosition"));A.maps.event.addListener(this.panorama,"pov_changed",b.hitch(this,"setPlaceMarkerRotation"))},getPanoramaByLocationComplete:function(a,b,c){"OK"===c?(this.disableStreetViewClick(),this.setPanoPlace=a=new A.maps.LatLng(a.y,a.x),this.firstSet=!0,this.panorama.setPosition(a)):"ZERO_RESULTS"===c?(this.setPanoPlace=null,this.clearGraphics(),this.connectMapClick(),q.set(this.noStreetViewResults,"display","block")):(this.setPanoPlace=null,this.clearGraphics(),
l.publish("viewer/handleError",{source:"StreetView",error:"Unknown."}))},resize:function(a){a&&a.h&&t.setContentSize(this.containerNode,{h:a.h-2});this.panorama&&A.maps.event.trigger(this.panorama,"resize")},setPlaceMarkerPosition:function(){this.placeMarker&&0!==this.pointGraphics.graphics.length||(this.placeMarker=new g,this.pointGraphics.add(this.placeMarker));var a=this.panorama.getPosition(),c=a.lat(),d=a.lng();if(!isNaN(c)&&!isNaN(d)){var e=null,f=this.map.spatialReference.wkid;102100===f&&
(f=3857);e=this.proj4Catalog+":"+String(f);if(w.defs[e]){if(e=w(w.defs[e]).forward([d,c]))c=new r(e,new v({wkid:f})),this.placeMarker.setGeometry(c),this.setPanoPlace&&!this.firstSet?(a=A.maps.geometry.spherical.computeHeading(a,this.setPanoPlace),this.panorama.setPov({heading:a,pitch:0}),setTimeout(b.hitch(this,function(){this.setPanoPlace=null}),1E3)):this.firstSet=!1}else require([this.proj4CustomURL||this.proj4BaseURL+String(f)+".js"],b.hitch(this,"setPlaceMarkerPosition"))}},setPlaceMarkerRotation:function(){if(this.placeMarker){var a=
this.panorama.getPov();this.pointSymbol.setAngle(a.heading);this.pointGraphics.refresh()}},streetViewFromMapRightClick:function(){this.getStreetView({mapPoint:this.mapRightClickPoint},!0)},setMapClickMode:function(a){this.mapClickMode=a}})})},"app/vendor/proj4":function(){!function(h){if("object"==typeof exports)module.exports=h();else if("function"==typeof define&&define.amd)define(h);else{var k;"undefined"!=typeof window?k=window:"undefined"!=typeof global?k=global:"undefined"!=typeof self&&(k=
self);k.proj4=h()}}(function(){return function k(a,f,b){function e(g,d){if(!f[g]){if(!a[g]){var c="function"==typeof require&&require;if(!d&&c)return c(g,!0);if(l)return l(g,!0);throw Error("Cannot find module '"+g+"'");}c=f[g]={exports:{}};a[g][0].call(c.exports,function(b){var c=a[g][1][b];return e(c?c:b)},c,c.exports,k,a,f,b)}return f[g].exports}for(var l="function"==typeof require&&require,m=0;m<b.length;m++)e(b[m]);return e}({1:[function(k,a,f){function b(a,e,f){if(!(this instanceof b))return new b(a,
e,f);Array.isArray(a)?(this.x=a[0],this.y=a[1],this.z=a[2]||0):"object"==typeof a?(this.x=a.x,this.y=a.y,this.z=a.z||0):"string"==typeof a&&"undefined"==typeof e?(a=a.split(","),this.x=parseFloat(a[0],10),this.y=parseFloat(a[1],10),this.z=parseFloat(a[2],10)||0):(this.x=a,this.y=e,this.z=f||0);console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var e=k("mgrs");b.fromMGRS=function(a){return new b(e.toPoint(a))};b.prototype.toMGRS=function(a){return e.forward([this.x,this.y],
a)};a.exports=b},{mgrs:67}],2:[function(k,a,f){function b(a,d){if(!(this instanceof b))return new b(a);d=d||function(a){if(a)throw a;};var c=e(a);if("object"!=typeof c)return void d(a);var c=m(c),f=b.projections.get(c.projName);f?(l(this,c),l(this,f),this.init(),d(null,this)):d(a)}var e=k("./parseCode"),l=k("./extend");f=k("./projections");var m=k("./deriveConstants");b.projections=f;b.projections.start();a.exports=b},{"./deriveConstants":33,"./extend":34,"./parseCode":37,"./projections":39}],3:[function(k,
a,f){a.exports=function(a,e,f){var b,g,d,c=f.x,l=f.y,k=f.z||0;for(d=0;3>d;d++)if(!e||2!==d||void 0!==f.z)switch(0===d?(b=c,g="x"):1===d?(b=l,g="y"):(b=k,g="z"),a.axis[d]){case "e":f[g]=b;break;case "w":f[g]=-b;break;case "n":f[g]=b;break;case "s":f[g]=-b;break;case "u":void 0!==f[g]&&(f.z=b);break;case "d":void 0!==f[g]&&(f.z=-b);break;default:return null}return f}},{}],4:[function(k,a,f){var b=Math.PI/2,e=k("./sign");a.exports=function(a){return Math.abs(a)<b?a:a-e(a)*Math.PI}},{"./sign":21}],5:[function(k,
a,f){var b=2*Math.PI,e=k("./sign");a.exports=function(a){return 3.14159265359>=Math.abs(a)?a:a-e(a)*b}},{"./sign":21}],6:[function(k,a,f){a.exports=function(a){return 1<Math.abs(a)&&(a=1<a?1:-1),Math.asin(a)}},{}],7:[function(k,a,f){a.exports=function(a){return 1-.25*a*(1+a/16*(3+1.25*a))}},{}],8:[function(k,a,f){a.exports=function(a){return.375*a*(1+.25*a*(1+.46875*a))}},{}],9:[function(k,a,f){a.exports=function(a){return.05859375*a*a*(1+.75*a)}},{}],10:[function(k,a,f){a.exports=function(a){return 35/
3072*a*a*a}},{}],11:[function(k,a,f){a.exports=function(a,e,f){e*=f;return a/Math.sqrt(1-e*e)}},{}],12:[function(k,a,f){a.exports=function(a,e,f,m,g){var b,c;b=a/e;for(var l=0;15>l;l++)if(c=(a-(e*b-f*Math.sin(2*b)+m*Math.sin(4*b)-g*Math.sin(6*b)))/(e-2*f*Math.cos(2*b)+4*m*Math.cos(4*b)-6*g*Math.cos(6*b)),b+=c,1E-10>=Math.abs(c))return b;return 0/0}},{}],13:[function(k,a,f){var b=Math.PI/2;a.exports=function(a,f){if(1E-6>Math.abs(Math.abs(f)-(1-(1-a*a)/(2*a)*Math.log((1-a)/(1+a)))))return 0>f?-1*b:
b;for(var e,g,d,c,l=Math.asin(.5*f),k=0;30>k;k++)if(g=Math.sin(l),d=Math.cos(l),c=a*g,e=Math.pow(1-c*c,2)/(2*d)*(f/(1-a*a)-g/(1-c*c)+.5/a*Math.log((1-c)/(1+c))),l+=e,1E-10>=Math.abs(e))return l;return 0/0}},{}],14:[function(k,a,f){a.exports=function(a,e,f,m,g){return a*g-e*Math.sin(2*g)+f*Math.sin(4*g)-m*Math.sin(6*g)}},{}],15:[function(k,a,f){a.exports=function(a,e,f){a*=e;return f/Math.sqrt(1-a*a)}},{}],16:[function(k,a,f){var b=Math.PI/2;a.exports=function(a,f){for(var e,g,d=.5*a,c=b-2*Math.atan(f),
l=0;15>=l;l++)if(e=a*Math.sin(c),g=b-2*Math.atan(f*Math.pow((1-e)/(1+e),d))-c,c+=g,1E-10>=Math.abs(g))return c;return-9999}},{}],17:[function(k,a,f){a.exports=function(a){var b=[];b[0]=1-a*(.25+a*(.046875+a*(.01953125+.01068115234375*a)));b[1]=a*(.75-a*(.046875+a*(.01953125+.01068115234375*a)));var f=a*a;return b[2]=f*(.46875-a*(.013020833333333334+.007120768229166667*a)),f*=a,b[3]=f*(.3645833333333333-.005696614583333333*a),b[4]=f*a*.3076171875,b}},{}],18:[function(k,a,f){var b=k("./pj_mlfn");a.exports=
function(a,f,m){for(var e=1/(1-f),d=a,c=20;c;--c){var l=Math.sin(d),k=1-f*l*l;if(k=(b(d,l,Math.cos(d),m)-a)*k*Math.sqrt(k)*e,d-=k,1E-10>Math.abs(k))break}return d}},{"./pj_mlfn":19}],19:[function(k,a,f){a.exports=function(a,e,f,m){return f*=e,e*=e,m[0]*a-f*(m[1]+e*(m[2]+e*(m[3]+e*m[4])))}},{}],20:[function(k,a,f){a.exports=function(a,e){var b;return 1E-7<a?(b=a*e,(1-a*a)*(e/(1-b*b)-.5/a*Math.log((1-b)/(1+b)))):2*e}},{}],21:[function(k,a,f){a.exports=function(a){return 0>a?-1:1}},{}],22:[function(k,
a,f){a.exports=function(a,e){return Math.pow((1-a)/(1+a),e)}},{}],23:[function(k,a,f){a.exports=function(a){var b={x:a[0],y:a[1]};return 2<a.length&&(b.z=a[2]),3<a.length&&(b.m=a[3]),b}},{}],24:[function(k,a,f){var b=Math.PI/2;a.exports=function(a,f,m){m*=a;return m=Math.pow((1-m)/(1+m),.5*a),Math.tan(.5*(b-f))/m}},{}],25:[function(k,a,f){f.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};f.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};f.ggrs87={towgs84:"-199.87,74.79,246.62",
ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};f.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};f.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};f.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};f.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};f.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",
datumName:"Hermannskogel"};f.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};f.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};f.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};f.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};f.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",
datumName:"S-JTSK (Ferro)"};f.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};f.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};f.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],26:[function(k,a,f){f.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};f.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};f.GRS80={a:6378137,rf:298.257222101,
ellipseName:"GRS 1980(IUGG, 1980)"};f.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};f.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"};f.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};f.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};f.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"};f.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};f.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl \x26 S. Amer. 1969"};
f.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};f.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"};f.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};f.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"};f.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."};f.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"};f.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};f.delmbr=
{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};f.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"};f.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"};f.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"};f.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"};f.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"};f.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah \x26 Sarawak)"};f.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};
f.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};f.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};f.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};f.hough={a:6378270,rf:297,ellipseName:"Hough"};f.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};f.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};f.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};f.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};f.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"};
f.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};f.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};f.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"};f.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"};f.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};f.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};f.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};f.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};f.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r\x3d6370997)"}},
{}],27:[function(k,a,f){f.greenwich=0;f.lisbon=-9.131906111111;f.paris=2.337229166667;f.bogota=-74.080916666667;f.madrid=-3.687938888889;f.rome=12.452333333333;f.bern=7.439583333333;f.jakarta=106.807719444444;f.ferro=-17.666666666667;f.brussels=4.367975;f.stockholm=18.058277777778;f.athens=23.7163375;f.oslo=10.722916666667},{}],28:[function(k,a,f){f.ft={to_meter:.3048};f["us-ft"]={to_meter:1200/3937}},{}],29:[function(k,a,f){function b(a,b,e){var c;return Array.isArray(e)?(c=m(a,b,e),3===e.length?
[c.x,c.y,c.z]:[c.x,c.y]):m(a,b,e)}function e(a){return a instanceof l?a:a.oProj?a.oProj:l(a)}var l=k("./Proj"),m=k("./transform"),g=l("WGS84");a.exports=function(a,c,f){a=e(a);var d,l=!1;return"undefined"==typeof c?(c=a,a=g,l=!0):("undefined"!=typeof c.x||Array.isArray(c))&&(f=c,c=a,a=g,l=!0),c=e(c),f?b(a,c,f):(d={forward:function(d){return b(a,c,d)},inverse:function(d){return b(c,a,d)}},l&&(d.oProj=c),d)}},{"./Proj":2,"./transform":65}],30:[function(k,a,f){var b=Math.PI/2,e=function(a){if(!(this instanceof
e))return new e(a);if(this.datum_type=4,a){if(a.datumCode&&"none"===a.datumCode&&(this.datum_type=5),a.datum_params){for(var b=0;b<a.datum_params.length;b++)a.datum_params[b]=parseFloat(a.datum_params[b]);0===a.datum_params[0]&&0===a.datum_params[1]&&0===a.datum_params[2]||(this.datum_type=1);3<a.datum_params.length&&(0!==a.datum_params[3]||0!==a.datum_params[4]||0!==a.datum_params[5]||0!==a.datum_params[6])&&(this.datum_type=2,a.datum_params[3]*=4.84813681109536E-6,a.datum_params[4]*=4.84813681109536E-6,
a.datum_params[5]*=4.84813681109536E-6,a.datum_params[6]=a.datum_params[6]/1E6+1)}this.datum_type=a.grids?3:this.datum_type;this.a=a.a;this.b=a.b;this.es=a.es;this.ep2=a.ep2;this.datum_params=a.datum_params;3===this.datum_type&&(this.grids=a.grids)}};e.prototype={compare_datums:function(a){return this.datum_type!==a.datum_type?!1:this.a!==a.a||5E-11<Math.abs(this.es-a.es)?!1:1===this.datum_type?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===
a.datum_params[2]:2===this.datum_type?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===a.datum_params[2]&&this.datum_params[3]===a.datum_params[3]&&this.datum_params[4]===a.datum_params[4]&&this.datum_params[5]===a.datum_params[5]&&this.datum_params[6]===a.datum_params[6]:3===this.datum_type||3===a.datum_type?this.nadgrids===a.nadgrids:!0},geodetic_to_geocentric:function(a){var e,f,d,c,l,k,t,r=a.x,v=a.y,u=a.z?a.z:0;if(-b>v&&v>-1.001*b)v=-b;
else if(v>b&&1.001*b>v)v=b;else if(-b>v||v>b)return null;return r>Math.PI&&(r-=2*Math.PI),l=Math.sin(v),t=Math.cos(v),k=l*l,c=this.a/Math.sqrt(1-this.es*k),e=(c+u)*t*Math.cos(r),f=(c+u)*t*Math.sin(r),d=(c*(1-this.es)+u)*l,a.x=e,a.y=f,a.z=d,0},geocentric_to_geodetic:function(a){var e,f,d,c,l,k,t,r,v,u,w,x;d=a.x;u=a.y;var y=a.z?a.z:0;if(e=Math.sqrt(d*d+u*u),f=Math.sqrt(d*d+u*u+y*y),1E-12>e/this.a){if(u=0,1E-12>f/this.a)return w=b,void(x=-this.b)}else u=Math.atan2(u,d);d=y/f;f=e/f;c=1/Math.sqrt(1-this.es*
(2-this.es)*f*f);k=f*(1-this.es)*c;t=d*c;v=0;do v++,l=this.a/Math.sqrt(1-this.es*t*t),x=e*k+y*t-l*(1-this.es*t*t),l=this.es*l/(l+x),c=1/Math.sqrt(1-l*(2-l)*f*f),l=f*(1-l)*c,c*=d,r=c*k-l*t,k=l,t=c;while(1E-24<r*r&&30>v);return w=Math.atan(c/Math.abs(l)),a.x=u,a.y=w,a.z=x,a},geocentric_to_geodetic_noniter:function(a){var e,f,d,c,l,k,t,r,v,u,w,x,y,A,z,B,C,D=a.x,E=a.y,F=a.z?a.z:0;if(D=parseFloat(D),E=parseFloat(E),F=parseFloat(F),C=!1,0!==D)e=Math.atan2(E,D);else if(0<E)e=b;else if(0>E)e=-b;else if(C=
!0,e=0,0<F)f=b;else{if(!(0>F))return f=b,void(d=-this.b);f=-b}return l=D*D+E*E,c=Math.sqrt(l),k=1.0026*F,r=Math.sqrt(k*k+l),u=k/r,x=c/r,w=u*u*u,t=F+this.b*this.ep2*w,B=c-this.a*this.es*x*x*x,v=Math.sqrt(t*t+B*B),y=t/v,A=B/v,z=this.a/Math.sqrt(1-this.es*y*y),d=.3826834323650898<=A?c/A-z:-.3826834323650898>=A?c/-A-z:F/y+z*(this.es-1),!1===C&&(f=Math.atan(y/A)),a.x=e,a.y=f,a.z=d,a},geocentric_to_wgs84:function(a){if(1===this.datum_type)a.x+=this.datum_params[0],a.y+=this.datum_params[1],a.z+=this.datum_params[2];
else if(2===this.datum_type){var b=this.datum_params[3],e=this.datum_params[4],d=this.datum_params[5],c=this.datum_params[6],f=c*(d*a.x+a.y-b*a.z)+this.datum_params[1],b=c*(-e*a.x+b*a.y+a.z)+this.datum_params[2];a.x=c*(a.x-d*a.y+e*a.z)+this.datum_params[0];a.y=f;a.z=b}},geocentric_from_wgs84:function(a){if(1===this.datum_type)a.x-=this.datum_params[0],a.y-=this.datum_params[1],a.z-=this.datum_params[2];else if(2===this.datum_type){var b=this.datum_params[3],e=this.datum_params[4],d=this.datum_params[5],
c=this.datum_params[6],f=(a.x-this.datum_params[0])/c,l=(a.y-this.datum_params[1])/c,c=(a.z-this.datum_params[2])/c;a.x=f+d*l-e*c;a.y=-d*f+l+b*c;a.z=e*f-b*l+c}}};a.exports=e},{}],31:[function(k,a,f){a.exports=function(a,e,f){function b(a){return 1===a||2===a}var g,d,c;if(a.compare_datums(e)||5===a.datum_type||5===e.datum_type)return f;var l=a.a,k=a.es,t=e.a,r=e.es;g=a.datum_type;if(3===g)if(0===this.apply_gridshift(a,0,f))a.a=6378137,a.es=.006694379990141316;else{if(!a.datum_params)return a.a=l,a.es=
a.es,f;g=1;d=0;for(c=a.datum_params.length;c>d;d++)g*=a.datum_params[d];if(0===g)return a.a=l,a.es=a.es,f;g=3<a.datum_params.length?2:1}return 3===e.datum_type&&(e.a=6378137,e.es=.006694379990141316),(a.es!==e.es||a.a!==e.a||b(g)||b(e.datum_type))&&(a.geodetic_to_geocentric(f),b(a.datum_type)&&a.geocentric_to_wgs84(f),b(e.datum_type)&&e.geocentric_from_wgs84(f),e.geocentric_to_geodetic(f)),3===e.datum_type&&this.apply_gridshift(e,1,f),a.a=l,a.es=k,e.a=t,e.es=r,f}},{}],32:[function(k,a,f){function b(a){var f=
this;if(2===arguments.length){var d=arguments[1];b[a]="string"==typeof d?"+"===d.charAt(0)?e(arguments[1]):l(arguments[1]):d}else if(1===arguments.length){if(Array.isArray(a))return a.map(function(a){Array.isArray(a)?b.apply(f,a):b(a)});if("string"==typeof a){if(a in b)return b[a]}else"EPSG"in a?b["EPSG:"+a.EPSG]=a:"ESRI"in a?b["ESRI:"+a.ESRI]=a:"IAU2000"in a&&(b["IAU2000:"+a.IAU2000]=a)}}f=k("./global");var e=k("./projString"),l=k("./wkt");f(b);a.exports=b},{"./global":35,"./projString":38,"./wkt":66}],
33:[function(k,a,f){var b=k("./constants/Datum"),e=k("./constants/Ellipsoid"),l=k("./extend"),m=k("./datum");a.exports=function(a){if(a.datumCode&&"none"!==a.datumCode){var d=b[a.datumCode];d&&(a.datum_params=d.towgs84?d.towgs84.split(","):null,a.ellps=d.ellipse,a.datumName=d.datumName?d.datumName:a.datumCode)}a.a||l(a,e[a.ellps]?e[a.ellps]:e.WGS84);return a.rf&&!a.b&&(a.b=(1-1/a.rf)*a.a),(0===a.rf||1E-10>Math.abs(a.a-a.b))&&(a.sphere=!0,a.b=a.a),a.a2=a.a*a.a,a.b2=a.b*a.b,a.es=(a.a2-a.b2)/a.a2,a.e=
Math.sqrt(a.es),a.R_A&&(a.a*=1-a.es*(.16666666666666666+a.es*(.04722222222222222+.022156084656084655*a.es)),a.a2=a.a*a.a,a.b2=a.b*a.b,a.es=0),a.ep2=(a.a2-a.b2)/a.b2,a.k0||(a.k0=1),a.axis||(a.axis="enu"),a.datum||(a.datum=m(a)),a}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":30,"./extend":34}],34:[function(k,a,f){a.exports=function(a,e){a=a||{};var b,f;if(!e)return a;for(f in e)b=e[f],void 0!==b&&(a[f]=b);return a}},{}],35:[function(k,a,f){a.exports=function(a){a("EPSG:4326","+title\x3dWGS 84 (long/lat) +proj\x3dlonglat +ellps\x3dWGS84 +datum\x3dWGS84 +units\x3ddegrees");
a("EPSG:4269","+title\x3dNAD83 (long/lat) +proj\x3dlonglat +a\x3d6378137.0 +b\x3d6356752.31414036 +ellps\x3dGRS80 +datum\x3dNAD83 +units\x3ddegrees");a("EPSG:3857","+title\x3dWGS 84 / Pseudo-Mercator +proj\x3dmerc +a\x3d6378137 +b\x3d6378137 +lat_ts\x3d0.0 +lon_0\x3d0.0 +x_0\x3d0.0 +y_0\x3d0 +k\x3d1.0 +units\x3dm +nadgrids\x3d@null +no_defs");a.WGS84=a["EPSG:4326"];a["EPSG:3785"]=a["EPSG:3857"];a.GOOGLE=a["EPSG:3857"];a["EPSG:900913"]=a["EPSG:3857"];a["EPSG:102113"]=a["EPSG:3857"]}},{}],36:[function(k,
a,f){f=k("./core");f.defaultDatum="WGS84";f.Proj=k("./Proj");f.WGS84=new f.Proj("WGS84");f.Point=k("./Point");f.toPoint=k("./common/toPoint");f.defs=k("./defs");f.transform=k("./transform");f.mgrs=k("mgrs");f.version=k("../package.json").version;k("./includedProjections")(f);a.exports=f},{"../package.json":68,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":29,"./defs":32,"./includedProjections":"hTEDpn","./transform":65,mgrs:67}],37:[function(k,a,f){function b(a){return["GEOGCS","GEOCCS","PROJCS",
"LOCAL_CS"].reduce(function(b,c){return b+1+a.indexOf(c)},0)}var e=k("./defs"),l=k("./wkt"),m=k("./projString");a.exports=function(a){return"string"==typeof a?a in e?e[a]:b(a)?l(a):"+"===a[0]?m(a):void 0:a}},{"./defs":32,"./projString":38,"./wkt":66}],38:[function(k,a,f){var b=k("./constants/PrimeMeridian"),e=k("./constants/units");a.exports=function(a){var f={},g={};a.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).forEach(function(a){a=a.split("\x3d");a.push(!0);g[a[0].toLowerCase()]=
a[1]});var d,c,l={proj:"projName",datum:"datumCode",rf:function(a){f.rf=parseFloat(a)},lat_0:function(a){f.lat0=.017453292519943295*a},lat_1:function(a){f.lat1=.017453292519943295*a},lat_2:function(a){f.lat2=.017453292519943295*a},lat_ts:function(a){f.lat_ts=.017453292519943295*a},lon_0:function(a){f.long0=.017453292519943295*a},lon_1:function(a){f.long1=.017453292519943295*a},lon_2:function(a){f.long2=.017453292519943295*a},alpha:function(a){f.alpha=.017453292519943295*parseFloat(a)},lonc:function(a){f.longc=
.017453292519943295*a},x_0:function(a){f.x0=parseFloat(a)},y_0:function(a){f.y0=parseFloat(a)},k_0:function(a){f.k0=parseFloat(a)},k:function(a){f.k0=parseFloat(a)},a:function(a){f.a=parseFloat(a)},b:function(a){f.b=parseFloat(a)},r_a:function(){f.R_A=!0},zone:function(a){f.zone=parseInt(a,10)},south:function(){f.utmSouth=!0},towgs84:function(a){f.datum_params=a.split(",").map(function(a){return parseFloat(a)})},to_meter:function(a){f.to_meter=parseFloat(a)},units:function(a){f.units=a;e[a]&&(f.to_meter=
e[a].to_meter)},from_greenwich:function(a){f.from_greenwich=.017453292519943295*a},pm:function(a){f.from_greenwich=.017453292519943295*(b[a]?b[a]:parseFloat(a))},nadgrids:function(a){"@null"===a?f.datumCode="none":f.nadgrids=a},axis:function(a){3===a.length&&-1!=="ewnsud".indexOf(a.substr(0,1))&&-1!=="ewnsud".indexOf(a.substr(1,1))&&-1!=="ewnsud".indexOf(a.substr(2,1))&&(f.axis=a)}};for(d in g)a=g[d],d in l?(c=l[d],"function"==typeof c?c(a):f[c]=a):f[d]=a;return"string"==typeof f.datumCode&&"WGS84"!==
f.datumCode&&(f.datumCode=f.datumCode.toLowerCase()),f}},{"./constants/PrimeMeridian":27,"./constants/units":28}],39:[function(k,a,f){function b(a,b){var c=m.length;return a.names?(m[c]=a,a.names.forEach(function(a){l[a.toLowerCase()]=c}),this):!0}var e=[k("./projections/merc"),k("./projections/longlat")],l={},m=[];f.add=b;f.get=function(a){if(!a)return!1;a=a.toLowerCase();return"undefined"!=typeof l[a]&&m[l[a]]?m[l[a]]:void 0};f.start=function(){e.forEach(b)}},{"./projections/longlat":51,"./projections/merc":52}],
40:[function(k,a,f){var b=k("../common/msfnz"),e=k("../common/qsfnz"),l=k("../common/adjust_lon"),m=k("../common/asinz");f.init=function(){1E-10>Math.abs(this.lat1+this.lat2)||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=b(this.e3,this.sin_po,this.cos_po),this.qs1=e(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),
this.t2=this.sin_po,this.ms2=b(this.e3,this.sin_po,this.cos_po),this.qs2=e(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=e(this.e3,this.sin_po,this.cos_po),this.ns0=1E-10<Math.abs(this.lat1-this.lat2)?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)};f.forward=function(a){var b=a.x,c=a.y;this.sin_phi=
Math.sin(c);this.cos_phi=Math.cos(c);var c=e(this.e3,this.sin_phi,this.cos_phi),c=this.a*Math.sqrt(this.c-this.ns0*c)/this.ns0,b=this.ns0*l(b-this.long0),f=this.rh-c*Math.cos(b)+this.y0;return a.x=c*Math.sin(b)+this.x0,a.y=f,a};f.inverse=function(a){var b,c,e,f,g,m;return a.x-=this.x0,a.y=this.rh-a.y+this.y0,0<=this.ns0?(b=Math.sqrt(a.x*a.x+a.y*a.y),e=1):(b=-Math.sqrt(a.x*a.x+a.y*a.y),e=-1),f=0,0!==b&&(f=Math.atan2(e*a.x,e*a.y)),e=b*this.ns0/this.a,this.sphere?m=Math.asin((this.c-e*e)/(2*this.ns0)):
(c=(this.c-e*e)/this.ns0,m=this.phi1z(this.e3,c)),g=l(f/this.ns0+this.long0),a.x=g,a.y=m,a};f.phi1z=function(a,b){var c,d,e,f,g,l=m(.5*b);if(1E-10>a)return l;for(var k=a*a,w=1;25>=w;w++)if(c=Math.sin(l),d=Math.cos(l),e=a*c,f=1-e*e,g=.5*f*f/d*(b/(1-k)-c/f+.5/a*Math.log((1-e)/(1+e))),l+=g,1E-7>=Math.abs(g))return l;return null};f.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],41:[function(k,a,f){var b=k("../common/adjust_lon"),
e=Math.PI/2,l=k("../common/mlfn"),m=k("../common/e0fn"),g=k("../common/e1fn"),d=k("../common/e2fn"),c=k("../common/e3fn"),n=k("../common/gN"),q=k("../common/asinz"),t=k("../common/imlfn");f.init=function(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)};f.forward=function(a){var f,k,q,r,t,A,z,B,C,D,E,F,G,I,J,L,M,H,K,P,O,S,Q,R=a.y,aa=Math.sin(a.y),X=Math.cos(a.y),T=b(a.x-this.long0);return this.sphere?1E-10>=Math.abs(this.sin_p12-1)?(a.x=this.x0+this.a*(e-R)*Math.sin(T),a.y=this.y0-
this.a*(e-R)*Math.cos(T),a):1E-10>=Math.abs(this.sin_p12+1)?(a.x=this.x0+this.a*(e+R)*Math.sin(T),a.y=this.y0+this.a*(e+R)*Math.cos(T),a):(H=this.sin_p12*aa+this.cos_p12*X*Math.cos(T),L=Math.acos(H),M=L/Math.sin(L),a.x=this.x0+this.a*M*X*Math.sin(T),a.y=this.y0+this.a*M*(this.cos_p12*aa-this.sin_p12*X*Math.cos(T)),a):(f=m(this.es),k=g(this.es),q=d(this.es),r=c(this.es),1E-10>=Math.abs(this.sin_p12-1)?(t=this.a*l(f,k,q,r,e),A=this.a*l(f,k,q,r,R),a.x=this.x0+(t-A)*Math.sin(T),a.y=this.y0-(t-A)*Math.cos(T),
a):1E-10>=Math.abs(this.sin_p12+1)?(t=this.a*l(f,k,q,r,e),A=this.a*l(f,k,q,r,R),a.x=this.x0+(t+A)*Math.sin(T),a.y=this.y0+(t+A)*Math.cos(T),a):(z=aa/X,B=n(this.a,this.e,this.sin_p12),C=n(this.a,this.e,aa),D=Math.atan((1-this.es)*z+this.es*B*this.sin_p12/(C*X)),E=Math.atan2(Math.sin(T),this.cos_p12*Math.tan(D)-this.sin_p12*Math.cos(T)),K=0===E?Math.asin(this.cos_p12*Math.sin(D)-this.sin_p12*Math.cos(D)):1E-10>=Math.abs(Math.abs(E)-Math.PI)?-Math.asin(this.cos_p12*Math.sin(D)-this.sin_p12*Math.cos(D)):
Math.asin(Math.sin(T)*Math.cos(D)/Math.sin(E)),F=this.e*this.sin_p12/Math.sqrt(1-this.es),G=this.e*this.cos_p12*Math.cos(E)/Math.sqrt(1-this.es),I=F*G,J=G*G,P=K*K,O=P*K,S=O*K,Q=S*K,L=B*K*(1-P*J*(1-J)/6+O/8*I*(1-2*J)+S/120*(J*(4-7*J)-3*F*F*(1-7*J))-Q/48*I),a.x=this.x0+L*Math.sin(E),a.y=this.y0+L*Math.cos(E),a))};f.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var f,k,r,x,y,A,z,B,C,D,E,F,G,I,J,L,M,H,K,P,O,S,Q;return this.sphere?(f=Math.sqrt(a.x*a.x+a.y*a.y),f>2*e*this.a)?void 0:(k=f/this.a,r=Math.sin(k),
x=Math.cos(k),y=this.long0,1E-10>=Math.abs(f)?A=this.lat0:(A=q(x*this.sin_p12+a.y*r*this.cos_p12/f),z=Math.abs(this.lat0)-e,y=b(1E-10>=Math.abs(z)?0<=this.lat0?this.long0+Math.atan2(a.x,-a.y):this.long0-Math.atan2(-a.x,a.y):this.long0+Math.atan2(a.x*r,f*this.cos_p12*x-a.y*this.sin_p12*r))),a.x=y,a.y=A,a):(B=m(this.es),C=g(this.es),D=d(this.es),E=c(this.es),1E-10>=Math.abs(this.sin_p12-1)?(F=this.a*l(B,C,D,E,e),f=Math.sqrt(a.x*a.x+a.y*a.y),G=F-f,A=t(G/this.a,B,C,D,E),y=b(this.long0+Math.atan2(a.x,
-1*a.y)),a.x=y,a.y=A,a):1E-10>=Math.abs(this.sin_p12+1)?(F=this.a*l(B,C,D,E,e),f=Math.sqrt(a.x*a.x+a.y*a.y),G=f-F,A=t(G/this.a,B,C,D,E),y=b(this.long0+Math.atan2(a.x,a.y)),a.x=y,a.y=A,a):(f=Math.sqrt(a.x*a.x+a.y*a.y),L=Math.atan2(a.x,a.y),I=n(this.a,this.e,this.sin_p12),M=Math.cos(L),H=this.e*this.cos_p12*M,K=-H*H/(1-this.es),P=3*this.es*(1-K)*this.sin_p12*this.cos_p12*M/(1-this.es),O=f/I,S=O-K*(1+K)*Math.pow(O,3)/6-P*(1+3*K)*Math.pow(O,4)/24,Q=1-K*S*S/2-O*S*S*S/6,J=Math.asin(this.sin_p12*Math.cos(S)+
this.cos_p12*Math.sin(S)*M),y=b(this.long0+Math.asin(Math.sin(L)*Math.sin(S)/Math.cos(J))),A=Math.atan((1-this.es*Q*this.sin_p12/Math.sin(J))*Math.tan(J)/(1-this.es)),a.x=y,a.y=A,a))};f.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(k,a,f){var b=k("../common/mlfn"),e=k("../common/e0fn"),l=k("../common/e1fn"),m=
k("../common/e2fn"),g=k("../common/e3fn"),d=k("../common/gN"),c=k("../common/adjust_lon"),n=k("../common/adjust_lat"),q=k("../common/imlfn"),t=Math.PI/2;f.init=function(){this.sphere||(this.e0=e(this.es),this.e1=l(this.es),this.e2=m(this.es),this.e3=g(this.es),this.ml0=this.a*b(this.e0,this.e1,this.e2,this.e3,this.lat0))};f.forward=function(a){var e,f,g=a.x,l=a.y;if(g=c(g-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(l)*Math.sin(g)),f=this.a*(Math.atan2(Math.tan(l),Math.cos(g))-this.lat0);else{f=
Math.sin(l);var m=Math.cos(l),k=d(this.a,this.e,f),n=Math.tan(l)*Math.tan(l);e=g*Math.cos(l);var g=e*e,q=this.es*m*m/(1-this.es),l=this.a*b(this.e0,this.e1,this.e2,this.e3,l);e=k*e*(1-g*n*(1/6-(8-n+8*q)*g/120));f=l-this.ml0+k*f/m*g*(.5+(5-n+6*q)*g/24)}return a.x=e+this.x0,a.y=f+this.y0,a};f.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var b,e,f=a.x/this.a;b=a.y/this.a;if(this.sphere)e=b+this.lat0,b=Math.asin(Math.sin(e)*Math.cos(f)),e=Math.atan2(Math.tan(f),Math.cos(e));else{e=q(this.ml0/this.a+
b,this.e0,this.e1,this.e2,this.e3);if(1E-10>=Math.abs(Math.abs(e)-t))return a.x=this.long0,a.y=t,0>b&&(a.y*=-1),a;b=d(this.a,this.e,Math.sin(e));var g=Math.pow(Math.tan(e),2),f=f*this.a/b,l=f*f;b=e-b*Math.tan(e)/(b*b*b/this.a/this.a*(1-this.es))*f*f*(.5-(1+3*g)*f*f/24);e=f*(1-l*(g/3+(1+3*g)*g*l/15))/Math.cos(e)}return a.x=c(e+this.long0),a.y=n(b),a};f.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,
"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],43:[function(k,a,f){var b=k("../common/adjust_lon"),e=k("../common/qsfnz"),l=k("../common/msfnz"),m=k("../common/iqsfnz");f.init=function(){this.sphere||(this.k0=l(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))};f.forward=function(a){var d,c;c=a.y;d=b(a.x-this.long0);this.sphere?(d=this.x0+this.a*d*Math.cos(this.lat_ts),c=this.y0+this.a*Math.sin(c)/Math.cos(this.lat_ts)):(c=e(this.e,Math.sin(c)),d=this.x0+this.a*
this.k0*d,c=this.y0+this.a*c*.5/this.k0);return a.x=d,a.y=c,a};f.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var d,c;return this.sphere?(d=b(this.long0+a.x/this.a/Math.cos(this.lat_ts)),c=Math.asin(a.y/this.a*Math.cos(this.lat_ts))):(c=m(this.e,2*a.y*this.k0/this.a),d=b(this.long0+a.x/(this.a*this.k0))),a.x=d,a.y=c,a};f.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],44:[function(k,a,f){var b=k("../common/adjust_lon"),e=k("../common/adjust_lat");
f.init=function(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Equidistant Cylindrical (Plate Carre)";this.rc=Math.cos(this.lat_ts)};f.forward=function(a){var f=a.y,g=b(a.x-this.long0),f=e(f-this.lat0);return a.x=this.x0+this.a*g*this.rc,a.y=this.y0+this.a*f,a};f.inverse=function(a){var f=a.y;return a.x=b(this.long0+(a.x-this.x0)/(this.a*this.rc)),a.y=e(this.lat0+(f-this.y0)/this.a),a};f.names=["Equirectangular",
"Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],45:[function(k,a,f){var b=k("../common/e0fn"),e=k("../common/e1fn"),l=k("../common/e2fn"),m=k("../common/e3fn"),g=k("../common/msfnz"),d=k("../common/mlfn"),c=k("../common/adjust_lon"),n=k("../common/adjust_lat"),q=k("../common/imlfn");f.init=function(){1E-10>Math.abs(this.lat1+this.lat2)||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=b(this.es),
this.e1=e(this.es),this.e2=l(this.es),this.e3=m(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=g(this.e,this.sinphi,this.cosphi),this.ml1=d(this.e0,this.e1,this.e2,this.e3,this.lat1),1E-10>Math.abs(this.lat1-this.lat2)?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=g(this.e,this.sinphi,this.cosphi),this.ml2=d(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+
this.ms1/this.ns,this.ml0=d(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))};f.forward=function(a){var b,e=a.x;b=a.y;this.sphere||(b=d(this.e0,this.e1,this.e2,this.e3,b));b=this.a*(this.g-b);var e=this.ns*c(e-this.long0),f=this.y0+this.rh-b*Math.cos(e);return a.x=this.x0+b*Math.sin(e),a.y=f,a};f.inverse=function(a){a.x-=this.x0;a.y=this.rh-a.y+this.y0;var b,d,e,f;0<=this.ns?(d=Math.sqrt(a.x*a.x+a.y*a.y),b=1):(d=-Math.sqrt(a.x*a.x+a.y*a.y),b=-1);var g=0;return(0!==d&&(g=
Math.atan2(b*a.x,b*a.y)),this.sphere)?(f=c(this.long0+g/this.ns),e=n(this.g-d/this.a),a.x=f,a.y=e,a):(e=q(this.g-d/this.a,this.e0,this.e1,this.e2,this.e3),f=c(this.long0+g/this.ns),a.x=f,a.y=e,a)};f.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],46:[function(k,a,f){var b=Math.PI/4,e=k("../common/srat"),l=Math.PI/2;f.init=
function(){var a=Math.sin(this.lat0),f=Math.cos(this.lat0),f=f*f;this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a);this.C=Math.sqrt(1+this.es*f*f/(1-this.es));this.phic0=Math.asin(a/this.C);this.ratexp=.5*this.C*this.e;this.K=Math.tan(.5*this.phic0+b)/(Math.pow(Math.tan(.5*this.lat0+b),this.C)*e(this.e*a,this.ratexp))};f.forward=function(a){var f=a.x,d=a.y;return a.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*d+b),this.C)*e(this.e*Math.sin(d),this.ratexp))-l,a.x=this.C*f,a};f.inverse=function(a){for(var f=
a.x/this.C,d=a.y,c=Math.pow(Math.tan(.5*d+b)/this.K,1/this.C),m=20;0<m&&(d=2*Math.atan(c*e(this.e*Math.sin(a.y),-.5*this.e))-l,!(1E-14>Math.abs(d-a.y)));--m)a.y=d;return m?(a.x=f,a.y=d,a):null};f.names=["gauss"]},{"../common/srat":22}],47:[function(k,a,f){var b=k("../common/adjust_lon"),e=k("../common/asinz");f.init=function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1E3*this.a;this.rc=1};f.forward=function(a){var e,f,d,c,l,k,t,r=a.y;return d=b(a.x-this.long0),
e=Math.sin(r),f=Math.cos(r),c=Math.cos(d),l=this.sin_p14*e+this.cos_p14*f*c,0<l||1E-10>=Math.abs(l)?(k=this.x0+1*this.a*f*Math.sin(d)/l,t=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*f*c)/l):(k=this.x0+this.infinity_dist*f*Math.sin(d),t=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*f*c)),a.x=k,a.y=t,a};f.inverse=function(a){var f,g,d,c,l,k;return a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,(f=Math.sqrt(a.x*a.x+a.y*a.y))?(c=Math.atan2(f,this.rc),g=Math.sin(c),
d=Math.cos(c),k=e(d*this.sin_p14+a.y*g*this.cos_p14/f),l=Math.atan2(a.x*g,f*this.cos_p14*d-a.y*this.sin_p14*g),l=b(this.long0+l)):(k=this.phic0,l=0),a.x=l,a.y=k,a};f.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],48:[function(k,a,f){var b=k("../common/adjust_lon");f.init=function(){this.a=6377397.155;this.es=.006674372230614;this.e=Math.sqrt(this.es);this.lat0||(this.lat0=.863937979737193);this.long0||(this.long0=.4334234309119251);this.k0||(this.k0=.9999);this.s45=.785398163397448;
this.s90=2*this.s45;this.fi0=this.lat0;this.e2=this.es;this.e=Math.sqrt(this.e2);this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2));this.uq=1.04216856380474;this.u0=Math.asin(Math.sin(this.fi0)/this.alfa);this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2);this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g;this.k1=this.k0;this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),
2));this.s0=1.37008346281555;this.n=Math.sin(this.s0);this.ro0=this.k1*this.n0/Math.tan(this.s0);this.ad=this.s90-this.uq};f.forward=function(a){var e,f,g,d,c,k,q,t=a.y,r=b(a.x-this.long0);return e=Math.pow((1+this.e*Math.sin(t))/(1-this.e*Math.sin(t)),this.alfa*this.e/2),f=2*(Math.atan(this.k*Math.pow(Math.tan(t/2+this.s45),this.alfa)/e)-this.s45),g=-r*this.alfa,d=Math.asin(Math.cos(this.ad)*Math.sin(f)+Math.sin(this.ad)*Math.cos(f)*Math.cos(g)),c=Math.asin(Math.cos(f)*Math.sin(g)/Math.cos(d)),k=
this.n*c,q=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(d/2+this.s45),this.n),a.y=q*Math.cos(k)/1,a.x=q*Math.sin(k)/1,this.czech||(a.y*=-1,a.x*=-1),a};f.inverse=function(a){var b,e,f;b=a.x;a.x=a.y;a.y=b;this.czech||(a.y*=-1,a.x*=-1);b=Math.sqrt(a.x*a.x+a.y*a.y);f=Math.atan2(a.y,a.x)/Math.sin(this.s0);e=2*(Math.atan(Math.pow(this.ro0/b,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45);b=Math.asin(Math.cos(this.ad)*Math.sin(e)-Math.sin(this.ad)*Math.cos(e)*Math.cos(f));a.x=
this.long0-Math.asin(Math.cos(e)*Math.sin(f)/Math.cos(b))/this.alfa;f=b;var d=e=0;do a.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(b/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(f))/(1-this.e*Math.sin(f)),this.e/2))-this.s45),1E-10>Math.abs(f-a.y)&&(e=1),f=a.y,d+=1;while(0===e&&15>d);return 15<=d?null:a};f.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],49:[function(k,a,f){var b=Math.PI/2,e=Math.PI/4,l=k("../common/qsfnz"),m=k("../common/adjust_lon");f.S_POLE=1;f.N_POLE=
2;f.EQUIT=3;f.OBLIQ=4;f.init=function(){var a=Math.abs(this.lat0);if(this.mode=1E-10>Math.abs(a-b)?0>this.lat0?this.S_POLE:this.N_POLE:1E-10>Math.abs(a)?this.EQUIT:this.OBLIQ,0<this.es)switch(this.qp=l(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp);this.dd=1/this.rq;this.xmf=1;this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),a=Math.sin(this.lat0),
this.sinb1=l(this.e,a)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*a*a)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))};f.forward=function(a){var d,c,f,g,k,r,v,u,w;g=a.x;var x=a.y;if(g=m(g-this.long0),this.sphere)if(k=Math.sin(x),r=Math.cos(x),f=Math.cos(g),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c=this.mode===
this.EQUIT?1+r*f:1+this.sinph0*k+this.cosph0*r*f,1E-10>=c)return null;c=Math.sqrt(2/c);d=c*r*Math.sin(g);c*=this.mode===this.EQUIT?k:this.cosph0*k-this.sinph0*r*f}else{if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(f=-f),1E-10>Math.abs(x+this.phi0))return null;c=e-.5*x;c=2*(this.mode===this.S_POLE?Math.cos(c):Math.sin(c));d=c*Math.sin(g);c*=f}}else{switch(v=0,u=0,w=0,f=Math.cos(g),g=Math.sin(g),k=Math.sin(x),r=l(this.e,k),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&
(v=r/this.qp,u=Math.sqrt(1-v*v)),this.mode){case this.OBLIQ:w=1+this.sinb1*v+this.cosb1*u*f;break;case this.EQUIT:w=1+u*f;break;case this.N_POLE:w=b+x;r=this.qp-r;break;case this.S_POLE:w=x-b,r=this.qp+r}if(1E-10>Math.abs(w))return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:w=Math.sqrt(2/w);c=this.mode===this.OBLIQ?this.ymf*w*(this.cosb1*v-this.sinb1*u*f):(w=Math.sqrt(2/(1+u*f)))*v*this.ymf;d=this.xmf*w*u*g;break;case this.N_POLE:case this.S_POLE:0<=r?(d=(w=Math.sqrt(r))*g,c=f*(this.mode===
this.S_POLE?w:-w)):d=c=0}}return a.x=this.a*d+this.x0,a.y=this.a*c+this.y0,a};f.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var d,c,e,f,g,l;d=a.x/this.a;var k=a.y/this.a;if(this.sphere){l=g=0;if(e=Math.sqrt(d*d+k*k),c=.5*e,1<c)return null;switch(c=2*Math.asin(c),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(l=Math.sin(c),g=Math.cos(c)),this.mode){case this.EQUIT:c=1E-10>=Math.abs(e)?0:Math.asin(k*l/e);d*=l;k=g*e;break;case this.OBLIQ:c=1E-10>=Math.abs(e)?this.phi0:Math.asin(g*this.sinph0+k*
l*this.cosph0/e);d*=l*this.cosph0;k=(g-Math.sin(c)*this.sinph0)*e;break;case this.N_POLE:k=-k;c=b-c;break;case this.S_POLE:c-=b}d=0!==k||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(d,k):0}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(d/=this.dd,k*=this.dd,l=Math.sqrt(d*d+k*k),1E-10>l)return a.x=0,a.y=this.phi0,a;f=2*Math.asin(.5*l/this.rq);e=Math.cos(f);d*=f=Math.sin(f);this.mode===this.OBLIQ?(c=e*this.sinb1+k*f*this.cosb1/l,g=this.qp*c,k=l*this.cosb1*e-k*this.sinb1*
f):(c=k*f/l,g=this.qp*c,k=l*e)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(k=-k),g=d*d+k*k,!g)return a.x=0,a.y=this.phi0,a;c=1-g/this.qp;this.mode===this.S_POLE&&(c=-c)}d=Math.atan2(d,k);c=this.authlat(Math.asin(c),this.apa)}return a.x=m(this.long0+d),a.y=c,a};f.P00=.3333333333333333;f.P01=.17222222222222222;f.P02=.10257936507936508;f.P10=.06388888888888888;f.P11=.0664021164021164;f.P20=.016415012942191543;f.authset=function(a){var b,c=[];return c[0]=a*this.P00,
b=a*a,c[0]+=b*this.P01,c[1]=b*this.P10,b*=a,c[0]+=b*this.P02,c[1]+=b*this.P11,c[2]=b*this.P20,c};f.authlat=function(a,b){var c=a+a;return a+b[0]*Math.sin(c)+b[1]*Math.sin(c+c)+b[2]*Math.sin(c+c+c)};f.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],50:[function(k,a,f){var b=k("../common/msfnz"),e=k("../common/tsfnz"),l=Math.PI/2,m=k("../common/sign"),g=k("../common/adjust_lon"),d=k("../common/phi2z");f.init=function(){if(this.lat2||
(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(1E-10>Math.abs(this.lat1+this.lat2))){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var a=Math.sin(this.lat1),d=b(this.e,a,Math.cos(this.lat1)),f=e(this.e,this.lat1,a),g=Math.sin(this.lat2),l=b(this.e,g,Math.cos(this.lat2)),g=e(this.e,this.lat2,g),m=e(this.e,this.lat0,Math.sin(this.lat0));this.ns=1E-10<Math.abs(this.lat1-this.lat2)?Math.log(d/l)/Math.log(f/g):a;isNaN(this.ns)&&(this.ns=a);this.f0=d/(this.ns*Math.pow(f,
this.ns));this.rh=this.a*this.f0*Math.pow(m,this.ns);this.title||(this.title="Lambert Conformal Conic")}};f.forward=function(a){var b=a.x,c=a.y;1E-10>=Math.abs(2*Math.abs(c)-Math.PI)&&(c=m(c)*(l-2E-10));var d=Math.abs(Math.abs(c)-l);if(1E-10<d)c=e(this.e,c,Math.sin(c)),c=this.a*this.f0*Math.pow(c,this.ns);else{if(d=c*this.ns,0>=d)return null;c=0}b=this.ns*g(b-this.long0);return a.x=this.k0*c*Math.sin(b)+this.x0,a.y=this.k0*(this.rh-c*Math.cos(b))+this.y0,a};f.inverse=function(a){var b,c,e,f,m,k=(a.x-
this.x0)/this.k0,w=this.rh-(a.y-this.y0)/this.k0;0<this.ns?(b=Math.sqrt(k*k+w*w),c=1):(b=-Math.sqrt(k*k+w*w),c=-1);var x=0;if(0!==b&&(x=Math.atan2(c*k,c*w)),0!==b||0<this.ns){if(c=1/this.ns,e=Math.pow(b/(this.a*this.f0),c),f=d(this.e,e),-9999===f)return null}else f=-l;return m=g(x/this.ns+this.long0),a.x=m,a.y=f,a};f.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,
"../common/sign":21,"../common/tsfnz":24}],51:[function(k,a,f){function b(a){return a}f.init=function(){};f.forward=b;f.inverse=b;f.names=["longlat","identity"]},{}],52:[function(k,a,f){var b=k("../common/msfnz"),e=Math.PI/2,l=k("../common/adjust_lon"),m=Math.PI/4,g=k("../common/tsfnz"),d=k("../common/phi2z");f.init=function(){var a=this.b/this.a;this.es=1-a*a;"x0"in this||(this.x0=0);"y0"in this||(this.y0=0);this.e=Math.sqrt(this.es);this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):b(this.e,
Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)};f.forward=function(a){var b=a.x,c=a.y;if(90<57.29577951308232*c&&-90>57.29577951308232*c&&180<57.29577951308232*b&&-180>57.29577951308232*b||1E-10>=Math.abs(Math.abs(c)-e))return null;this.sphere?(b=this.x0+this.a*this.k0*l(b-this.long0),c=this.y0+this.a*this.k0*Math.log(Math.tan(m+.5*c))):(c=g(this.e,c,Math.sin(c)),b=this.x0+this.a*this.k0*l(b-this.long0),c=this.y0-this.a*this.k0*Math.log(c));return a.x=b,a.y=c,a};f.inverse=
function(a){var b,c,f=a.x-this.x0,g=a.y-this.y0;if(this.sphere)c=e-2*Math.atan(Math.exp(-g/(this.a*this.k0)));else if(c=d(this.e,Math.exp(-g/(this.a*this.k0))),-9999===c)return null;return b=l(this.long0+f/(this.a*this.k0)),a.x=b,a.y=c,a};f.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],53:[function(k,a,f){var b=k("../common/adjust_lon");f.init=
function(){};f.forward=function(a){var e=a.y,f=b(a.x-this.long0),e=this.y0+this.a*Math.log(Math.tan(Math.PI/4+e/2.5))*1.25;return a.x=this.x0+this.a*f,a.y=e,a};f.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var e=b(this.long0+a.x/this.a),f=2.5*(Math.atan(Math.exp(.8*a.y/this.a))-Math.PI/4);return a.x=e,a.y=f,a};f.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],54:[function(k,a,f){var b=k("../common/adjust_lon");f.init=function(){};f.forward=function(a){for(var e=a.y,f=b(a.x-this.long0),
g=e,d=Math.PI*Math.sin(e),c=0;;c++){var k=-(g+Math.sin(g)-d)/(1+Math.cos(g));if(g+=k,1E-10>Math.abs(k))break}g/=2;1E-10>Math.PI/2-Math.abs(e)&&(f=0);e=1.4142135623731*this.a*Math.sin(g)+this.y0;return a.x=.900316316158*this.a*f*Math.cos(g)+this.x0,a.y=e,a};f.inverse=function(a){var e;a.x-=this.x0;a.y-=this.y0;e=a.y/(1.4142135623731*this.a);.999999999999<Math.abs(e)&&(e=.999999999999);e=Math.asin(e);var f=b(this.long0+a.x/(.900316316158*this.a*Math.cos(e)));f<-Math.PI&&(f=-Math.PI);f>Math.PI&&(f=Math.PI);
e=(2*e+Math.sin(2*e))/Math.PI;1<Math.abs(e)&&(e=1);e=Math.asin(e);return a.x=f,a.y=e,a};f.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],55:[function(k,a,f){f.iterations=1;f.init=function(){this.A=[];this.A[1]=.6399175073;this.A[2]=-.1358797613;this.A[3]=.063294409;this.A[4]=-.02526853;this.A[5]=.0117879;this.A[6]=-.0055161;this.A[7]=.0026906;this.A[8]=-.001333;this.A[9]=6.7E-4;this.A[10]=-3.4E-4;this.B_re=[];this.B_im=[];this.B_re[1]=.7557853228;this.B_im[1]=0;this.B_re[2]=.249204646;this.B_im[2]=
.003371507;this.B_re[3]=-.001541739;this.B_im[3]=.04105856;this.B_re[4]=-.10162907;this.B_im[4]=.01727609;this.B_re[5]=-.26623489;this.B_im[5]=-.36249218;this.B_re[6]=-.6870983;this.B_im[6]=-1.1651967;this.C_re=[];this.C_im=[];this.C_re[1]=1.3231270439;this.C_im[1]=0;this.C_re[2]=-.577245789;this.C_im[2]=-.007809598;this.C_re[3]=.508307513;this.C_im[3]=-.112208952;this.C_re[4]=-.15094762;this.C_im[4]=.18200602;this.C_re[5]=1.01418179;this.C_im[5]=1.64497696;this.C_re[6]=1.9660549;this.C_im[6]=2.5127645;
this.D=[];this.D[1]=1.5627014243;this.D[2]=.5185406398;this.D[3]=-.03333098;this.D[4]=-.1052906;this.D[5]=-.0368594;this.D[6]=.007317;this.D[7]=.0122;this.D[8]=.00394;this.D[9]=-.0013};f.forward=function(a){var b,f=a.x-this.long0,m=(a.y-this.lat0)/4.84813681109536E-6*1E-5,g=1,d=0;for(b=1;10>=b;b++)g*=m,d+=this.A[b]*g;var c,g=d,d=1,k=c=0,q=0;for(b=1;6>=b;b++)m=d*g-c*f,c=c*g+d*f,d=m,k=k+this.B_re[b]*d-this.B_im[b]*c,q=q+this.B_im[b]*d+this.B_re[b]*c;return a.x=q*this.a+this.x0,a.y=k*this.a+this.y0,
a};f.inverse=function(a){var b,f,m,g=(a.y-this.y0)/this.a,d=(a.x-this.x0)/this.a,c=1,k=m=0,q=0;for(b=1;6>=b;b++)f=c*g-m*d,m=m*g+c*d,c=f,k=k+this.C_re[b]*c-this.C_im[b]*m,q=q+this.C_im[b]*c+this.C_re[b]*m;for(f=0;f<this.iterations;f++){var t,r,v=k;r=q;c=g;m=d;for(b=2;6>=b;b++)t=v*k-r*q,r=r*k+v*q,v=t,c+=(b-1)*(this.B_re[b]*v-this.B_im[b]*r),m+=(b-1)*(this.B_im[b]*v+this.B_re[b]*r);v=1;r=0;var u=this.B_re[1],w=this.B_im[1];for(b=2;6>=b;b++)t=v*k-r*q,r=r*k+v*q,v=t,u+=b*(this.B_re[b]*v-this.B_im[b]*r),
w+=b*(this.B_im[b]*v+this.B_re[b]*r);q=u*u+w*w;k=(c*u+m*w)/q;q=(m*u-c*w)/q}g=k;d=1;k=0;for(b=1;9>=b;b++)d*=g,k+=this.D[b]*d;b=this.lat0+.484813681109536*k;return a.x=this.long0+q,a.y=b,a};f.names=["New_Zealand_Map_Grid","nzmg"]},{}],56:[function(k,a,f){var b=k("../common/tsfnz"),e=k("../common/adjust_lon"),l=k("../common/phi2z"),m=Math.PI/2,g=Math.PI/4;f.init=function(){this.no_off=this.no_off||!1;this.no_rot=this.no_rot||!1;isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),c=Math.cos(this.lat0),
f=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(c,4));this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-f*f);a=b(this.e,this.lat0,a);c=this.bl/c*Math.sqrt((1-this.es)/(1-f*f));1>c*c&&(c=1);var g;if(isNaN(this.longc)){f=b(this.e,this.lat1,Math.sin(this.lat1));g=b(this.e,this.lat2,Math.sin(this.lat2));this.el=0<=this.lat0?(c+Math.sqrt(c*c-1))*Math.pow(a,this.bl):(c-Math.sqrt(c*c-1))*Math.pow(a,this.bl);var f=Math.pow(f,this.bl),l=Math.pow(g,this.bl);g=this.el/f;a=.5*(g-1/g);g=(this.el*
this.el-l*f)/(this.el*this.el+l*f);f=(l-f)/(l+f);l=e(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(g*Math.tan(.5*this.bl*l)/f)/this.bl;this.long0=e(this.long0);f=e(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*f)/a);this.alpha=Math.asin(c*Math.sin(this.gamma0))}else g=0<=this.lat0?c+Math.sqrt(c*c-1):c-Math.sqrt(c*c-1),this.el=g*Math.pow(a,this.bl),this.gamma0=Math.asin(Math.sin(this.alpha)/c),this.long0=this.longc-Math.asin(.5*(g-1/g)*Math.tan(this.gamma0))/
this.bl;this.uc=this.no_off?0:0<=this.lat0?this.al/this.bl*Math.atan2(Math.sqrt(c*c-1),Math.cos(this.alpha)):-1*this.al/this.bl*Math.atan2(Math.sqrt(c*c-1),Math.cos(this.alpha))};f.forward=function(a){var c,d;d=a.y;c=e(a.x-this.long0);if(1E-10>=Math.abs(Math.abs(d)-m))c=0<d?-1:1,d=this.al/this.bl*Math.log(Math.tan(g+c*this.gamma0*.5)),c=-1*c*m*this.al/this.bl;else{d=b(this.e,d,Math.sin(d));d=this.el/Math.pow(d,this.bl);var f=.5*(d-1/d),l=Math.sin(this.bl*c);d=(f*Math.sin(this.gamma0)-l*Math.cos(this.gamma0))/
(.5*(d+1/d));d=1E-10>=Math.abs(Math.abs(d)-1)?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-d)/(1+d))/this.bl;c=1E-10>=Math.abs(Math.cos(this.bl*c))?this.al*this.bl*c:this.al*Math.atan2(f*Math.cos(this.gamma0)+l*Math.sin(this.gamma0),Math.cos(this.bl*c))/this.bl}return this.no_rot?(a.x=this.x0+c,a.y=this.y0+d):(c-=this.uc,a.x=this.x0+d*Math.cos(this.alpha)+c*Math.sin(this.alpha),a.y=this.y0+c*Math.cos(this.alpha)-d*Math.sin(this.alpha)),a};f.inverse=function(a){var b,d;this.no_rot?(d=a.y-this.y0,
b=a.x-this.x0):(d=(a.x-this.x0)*Math.cos(this.alpha)-(a.y-this.y0)*Math.sin(this.alpha),b=(a.y-this.y0)*Math.cos(this.alpha)+(a.x-this.x0)*Math.sin(this.alpha),b+=this.uc);var f=Math.exp(-1*this.bl*d/this.al);d=.5*(f-1/f);var g=Math.sin(this.bl*b/this.al),f=(g*Math.cos(this.gamma0)+d*Math.sin(this.gamma0))/(.5*(f+1/f)),k=Math.pow(this.el/Math.sqrt((1+f)/(1-f)),1/this.bl);return 1E-10>Math.abs(f-1)?(a.x=this.long0,a.y=m):1E-10>Math.abs(f+1)?(a.x=this.long0,a.y=-1*m):(a.y=l(this.e,k),a.x=e(this.long0-
Math.atan2(d*Math.cos(this.gamma0)-g*Math.sin(this.gamma0),Math.cos(this.bl*b/this.al))/this.bl)),a};f.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],57:[function(k,a,f){var b=k("../common/e0fn"),e=k("../common/e1fn"),l=k("../common/e2fn"),m=k("../common/e3fn"),g=k("../common/adjust_lon"),d=k("../common/adjust_lat"),c=
k("../common/mlfn"),n=k("../common/gN");f.init=function(){this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=b(this.es);this.e1=e(this.es);this.e2=l(this.es);this.e3=m(this.es);this.ml0=this.a*c(this.e0,this.e1,this.e2,this.e3,this.lat0)};f.forward=function(a){var b,e,f,l=a.y,m=g(a.x-this.long0);(f=m*Math.sin(l),this.sphere)?1E-10>=Math.abs(l)?(b=this.a*m,e=-1*this.a*this.lat0):(b=this.a*Math.sin(f)/Math.tan(l),e=this.a*(d(l-this.lat0)+(1-Math.cos(f))/Math.tan(l))):
1E-10>=Math.abs(l)?(b=this.a*m,e=-1*this.ml0):(e=n(this.a,this.e,Math.sin(l))/Math.tan(l),b=e*Math.sin(f),e=this.a*c(this.e0,this.e1,this.e2,this.e3,l)-this.ml0+e*(1-Math.cos(f)));return a.x=b+this.x0,a.y=e+this.y0,a};f.inverse=function(a){var b,d,e,f,l,m,k;if(b=a.x-this.x0,e=a.y-this.y0,this.sphere)if(1E-10>=Math.abs(e+this.a*this.lat0))b=g(b/this.a+this.long0),d=0;else{f=this.lat0+e/this.a;l=b*b/this.a/this.a+f*f;m=f;var n;for(e=20;e;--e)if(n=Math.tan(m),k=-1*(f*(m*n+1)-m-.5*(m*m+l)*n)/((m-f)/n-
1),m+=k,1E-10>=Math.abs(k)){d=m;break}b=g(this.long0+Math.asin(b*Math.tan(m)/this.a)/Math.sin(d))}else if(1E-10>=Math.abs(e+this.ml0))d=0,b=g(this.long0+b/this.a);else{f=(this.ml0+e)/this.a;l=b*b/this.a/this.a+f*f;m=f;var q,B,C,D,E;for(e=20;e;--e)if(E=this.e*Math.sin(m),q=Math.sqrt(1-E*E)*Math.tan(m),B=this.a*c(this.e0,this.e1,this.e2,this.e3,m),C=this.e0-2*this.e1*Math.cos(2*m)+4*this.e2*Math.cos(4*m)-6*this.e3*Math.cos(6*m),D=B/this.a,k=(f*(q*D+1)-D-.5*q*(D*D+l))/(this.es*Math.sin(2*m)*(D*D+l-2*
f*D)/(4*q)+(f-D)*(q*C-2/Math.sin(2*m))-C),m-=k,1E-10>=Math.abs(k)){d=m;break}q=Math.sqrt(1-this.es*Math.pow(Math.sin(d),2))*Math.tan(d);b=g(this.long0+Math.asin(b*q/this.a)/Math.sin(d))}return a.x=b,a.y=d,a};f.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],58:[function(k,a,f){var b=k("../common/adjust_lon"),e=k("../common/adjust_lat"),l=k("../common/pj_enfn"),
m=k("../common/pj_mlfn"),g=k("../common/pj_inv_mlfn"),d=Math.PI/2,c=k("../common/asinz");f.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=l(this.es)};f.forward=function(a){var c,d;c=a.x;d=a.y;if(c=b(c-this.long0),this.sphere){if(this.m)for(var e=this.n*Math.sin(d),f=20;f;--f){var g=(this.m*d+Math.sin(d)-e)/(this.m+Math.cos(d));if(d-=g,1E-10>Math.abs(g))break}else d=1!==this.n?Math.asin(this.n*Math.sin(d)):d;c=this.a*
this.C_x*c*(this.m+Math.cos(d));d*=this.a*this.C_y}else e=Math.sin(d),f=Math.cos(d),d=this.a*m(d,e,f,this.en),c=this.a*c*f/Math.sqrt(1-this.es*e*e);return a.x=c,a.y=d,a};f.inverse=function(a){var f,l,m,k;return a.x-=this.x0,m=a.x/this.a,a.y-=this.y0,f=a.y/this.a,this.sphere?(f/=this.C_y,m/=this.C_x*(this.m+Math.cos(f)),this.m?f=c((this.m*f+Math.sin(f))/this.n):1!==this.n&&(f=c(Math.sin(f)/this.n)),m=b(m+this.long0),f=e(f)):(f=g(a.y/this.a,this.es,this.en),k=Math.abs(f),d>k?(k=Math.sin(f),l=this.long0+
a.x*Math.sqrt(1-this.es*k*k)/(this.a*Math.cos(f)),m=b(l)):d>k-1E-10&&(m=this.long0)),a.x=m,a.y=f,a};f.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],59:[function(k,a,f){f.init=function(){var a=this.lat0;this.lambda0=this.long0;var e=Math.sin(a),f=this.a,m=1/this.rf,m=2*m-Math.pow(m,2),g=this.e=Math.sqrt(m);this.R=this.k0*f*Math.sqrt(1-m)/(1-m*Math.pow(e,2));this.alpha=Math.sqrt(1+
m/(1-m)*Math.pow(Math.cos(a),4));this.b0=Math.asin(e/this.alpha);this.K=Math.log(Math.tan(Math.PI/4+this.b0/2))-this.alpha*Math.log(Math.tan(Math.PI/4+a/2))+this.alpha*g/2*Math.log((1+g*e)/(1-g*e))};f.forward=function(a){var b=2*(Math.atan(Math.exp(-this.alpha*(Math.log(Math.tan(Math.PI/4-a.y/2))+this.e/2*Math.log((1+this.e*Math.sin(a.y))/(1-this.e*Math.sin(a.y))))+this.K))-Math.PI/4),f=this.alpha*(a.x-this.lambda0),m=Math.atan(Math.sin(f)/(Math.sin(this.b0)*Math.tan(b)+Math.cos(this.b0)*Math.cos(f))),
b=Math.asin(Math.cos(this.b0)*Math.sin(b)-Math.sin(this.b0)*Math.cos(b)*Math.cos(f));return a.y=this.R/2*Math.log((1+Math.sin(b))/(1-Math.sin(b)))+this.y0,a.x=this.R*m+this.x0,a};f.inverse=function(a){for(var b=(a.x-this.x0)/this.R,f=2*(Math.atan(Math.exp((a.y-this.y0)/this.R))-Math.PI/4),m=Math.asin(Math.cos(this.b0)*Math.sin(f)+Math.sin(this.b0)*Math.cos(f)*Math.cos(b)),b=this.lambda0+Math.atan(Math.sin(b)/(Math.cos(this.b0)*Math.cos(b)-Math.sin(this.b0)*Math.tan(f)))/this.alpha,f=0,g=m,d=-1E3,
c=0;1E-7<Math.abs(g-d);){if(20<++c)return;f=1/this.alpha*(Math.log(Math.tan(Math.PI/4+m/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(g))/2));d=g;g=2*Math.atan(Math.exp(f))-Math.PI/2}return a.x=b,a.y=g,a};f.names=["somerc"]},{}],60:[function(k,a,f){var b=Math.PI/2,e=k("../common/sign"),l=k("../common/msfnz"),m=k("../common/tsfnz"),g=k("../common/phi2z"),d=k("../common/adjust_lon");f.ssfn_=function(a,d,e){return d*=e,Math.tan(.5*(b+a))*Math.pow((1-d)/(1+d),.5*e)};f.init=
function(){this.coslat0=Math.cos(this.lat0);this.sinlat0=Math.sin(this.lat0);this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&1E-10>=Math.abs(this.coslat0)&&(this.k0=.5*(1+e(this.lat0)*Math.sin(this.lat_ts))):(1E-10>=Math.abs(this.coslat0)&&(this.con=0<this.lat0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&1E-10>=Math.abs(this.coslat0)&&(this.k0=.5*this.cons*l(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/m(this.e,this.con*
this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=l(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-b,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))};f.forward=function(a){var c,e,f,g,l,k,w=a.x,x=a.y,y=Math.sin(x),A=Math.cos(x),z=d(w-this.long0);return 1E-10>=Math.abs(Math.abs(w-this.long0)-Math.PI)&&1E-10>=Math.abs(x+this.lat0)?(a.x=0/0,a.y=0/0,a):this.sphere?(c=2*this.k0/(1+this.sinlat0*y+this.coslat0*A*Math.cos(z)),a.x=this.a*c*A*
Math.sin(z)+this.x0,a.y=this.a*c*(this.coslat0*y-this.sinlat0*A*Math.cos(z))+this.y0,a):(e=2*Math.atan(this.ssfn_(x,y,this.e))-b,g=Math.cos(e),f=Math.sin(e),1E-10>=Math.abs(this.coslat0)?(l=m(this.e,x*this.con,this.con*y),k=2*this.a*this.k0*l/this.cons,a.x=this.x0+k*Math.sin(w-this.long0),a.y=this.y0-this.con*k*Math.cos(w-this.long0),a):(1E-10>Math.abs(this.sinlat0)?(c=2*this.a*this.k0/(1+g*Math.cos(z)),a.y=c*f):(c=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*f+this.cosX0*g*Math.cos(z))),a.y=
c*(this.cosX0*f-this.sinX0*g*Math.cos(z))+this.y0),a.x=c*g*Math.sin(z)+this.x0,a))};f.inverse=function(a){a.x-=this.x0;a.y-=this.y0;var c,e,f,l=Math.sqrt(a.x*a.x+a.y*a.y);if(this.sphere)return f=2*Math.atan(l/(.5*this.a*this.k0)),c=this.long0,e=this.lat0,1E-10>=l?(a.x=c,a.y=e,a):(e=Math.asin(Math.cos(f)*this.sinlat0+a.y*Math.sin(f)*this.coslat0/l),c=d(1E-10>Math.abs(this.coslat0)?0<this.lat0?this.long0+Math.atan2(a.x,-1*a.y):this.long0+Math.atan2(a.x,a.y):this.long0+Math.atan2(a.x*Math.sin(f),l*this.coslat0*
Math.cos(f)-a.y*this.sinlat0*Math.sin(f))),a.x=c,a.y=e,a);if(1E-10>=Math.abs(this.coslat0)){if(1E-10>=l)return e=this.lat0,c=this.long0,a.x=c,a.y=e,a;a.x*=this.con;a.y*=this.con;c=l*this.cons/(2*this.a*this.k0);e=this.con*g(this.e,c);c=this.con*d(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else e=2*Math.atan(l*this.cosX0/(2*this.a*this.k0*this.ms1)),c=this.long0,1E-10>=l?f=this.X0:(f=Math.asin(Math.cos(e)*this.sinX0+a.y*Math.sin(e)*this.cosX0/l),c=d(this.long0+Math.atan2(a.x*Math.sin(e),l*this.cosX0*
Math.cos(e)-a.y*this.sinX0*Math.sin(e)))),e=-1*g(this.e,Math.tan(.5*(b+f)));return a.x=c,a.y=e,a};f.names=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],61:[function(k,a,f){var b=k("./gauss"),e=k("../common/adjust_lon");f.init=function(){b.init.apply(this);this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title=
"Oblique Stereographic Alternative"))};f.forward=function(a){var f,g,d,c;return a.x=e(a.x-this.long0),b.forward.apply(this,[a]),f=Math.sin(a.y),g=Math.cos(a.y),d=Math.cos(a.x),c=this.k0*this.R2/(1+this.sinc0*f+this.cosc0*g*d),a.x=c*g*Math.sin(a.x),a.y=c*(this.cosc0*f-this.sinc0*g*d),a.x=this.a*a.x+this.x0,a.y=this.a*a.y+this.y0,a};f.inverse=function(a){var f,g,d,c;(a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,c=Math.sqrt(a.x*a.x+a.y*a.y))?(d=2*Math.atan2(c,this.R2),
f=Math.sin(d),g=Math.cos(d),d=Math.asin(g*this.sinc0+a.y*f*this.cosc0/c),f=Math.atan2(a.x*f,c*this.cosc0*g-a.y*this.sinc0*f)):(d=this.phic0,f=0);return a.x=f,a.y=d,b.inverse.apply(this,[a]),a.x=e(a.x+this.long0),a};f.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":46}],62:[function(k,a,f){var b=k("../common/e0fn"),e=k("../common/e1fn"),l=k("../common/e2fn"),m=k("../common/e3fn"),g=k("../common/mlfn"),
d=k("../common/adjust_lon"),c=Math.PI/2,n=k("../common/sign"),q=k("../common/asinz");f.init=function(){this.e0=b(this.es);this.e1=e(this.es);this.e2=l(this.es);this.e3=m(this.es);this.ml0=this.a*g(this.e0,this.e1,this.e2,this.e3,this.lat0)};f.forward=function(a){var b,c,e;e=a.y;var f=d(a.x-this.long0);b=Math.sin(e);var l=Math.cos(e);if(this.sphere){var m=l*Math.sin(f);if(1E-10>Math.abs(Math.abs(m)-1))return 93;c=.5*this.a*this.k0*Math.log((1+m)/(1-m));b=Math.acos(l*Math.cos(f)/Math.sqrt(1-m*m));0>
e&&(b=-b);e=this.a*this.k0*(b-this.lat0)}else{c=l*f;var f=Math.pow(c,2),l=this.ep2*Math.pow(l,2),m=Math.tan(e),k=Math.pow(m,2);b=1-this.es*Math.pow(b,2);b=this.a/Math.sqrt(b);e=this.a*g(this.e0,this.e1,this.e2,this.e3,e);c=this.k0*b*c*(1+f/6*(1-k+l+f/20*(5-18*k+Math.pow(k,2)+72*l-58*this.ep2)))+this.x0;e=this.k0*(e-this.ml0+b*m*f*(.5+f/24*(5-k+9*l+4*Math.pow(l,2)+f/30*(61-58*k+Math.pow(k,2)+600*l-330*this.ep2))))+this.y0}return a.x=c,a.y=e,a};f.inverse=function(a){var b,e,f,g;if(this.sphere){b=Math.exp(a.x/
(this.a*this.k0));e=.5*(b-1/b);var l=this.lat0+a.y/(this.a*this.k0);f=Math.cos(l);b=Math.sqrt((1-f*f)/(1+e*e));b=q(b);0>l&&(b=-b);e=0===e&&0===f?this.long0:d(Math.atan2(e,f)+this.long0)}else{var l=a.x-this.x0,m=a.y-this.y0;e=b=(this.ml0+m/this.k0)/this.a;for(g=0;f=(b+this.e1*Math.sin(2*e)-this.e2*Math.sin(4*e)+this.e3*Math.sin(6*e))/this.e0-e,e+=f,!(1E-10>=Math.abs(f));g++)if(6<=g)return 95;if(Math.abs(e)<c){f=Math.cos(e);var k=Math.tan(e);g=this.ep2*Math.pow(f,2);var m=Math.pow(g,2),t=Math.pow(k,
2),B=Math.pow(t,2);b=1-this.es*Math.pow(Math.sin(e),2);var C=this.a/Math.sqrt(b),l=l/(C*this.k0),D=Math.pow(l,2);b=e-C*k*D/(C*(1-this.es)/b)*(.5-D/24*(5+3*t+10*g-4*m-9*this.ep2-D/30*(61+90*t+298*g+45*B-252*this.ep2-3*m)));e=d(this.long0+l*(1-D/6*(1+2*t+g-D/20*(5-2*g+28*t-3*m+8*this.ep2+24*B)))/f)}else b=c*n(m),e=this.long0}return a.x=e,a.y=b,a};f.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,
"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],63:[function(k,a,f){var b=k("./tmerc");f.dependsOn="tmerc";f.init=function(){this.zone&&(this.lat0=0,this.long0=.017453292519943295*(6*Math.abs(this.zone)-183),this.x0=5E5,this.y0=this.utmSouth?1E7:0,this.k0=.9996,b.init.apply(this),this.forward=b.forward,this.inverse=b.inverse)};f.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":62}],64:[function(k,a,f){var b=k("../common/adjust_lon"),e=Math.PI/2,l=k("../common/asinz");
f.init=function(){this.R=this.a};f.forward=function(a){var f,d,c=a.y,m=b(a.x-this.long0);1E-10>=Math.abs(c)&&(f=this.x0+this.R*m,d=this.y0);var k=l(2*Math.abs(c/Math.PI));(1E-10>=Math.abs(m)||1E-10>=Math.abs(Math.abs(c)-e))&&(f=this.x0,d=0<=c?this.y0+Math.PI*this.R*Math.tan(.5*k):this.y0+Math.PI*this.R*-Math.tan(.5*k));var t=.5*Math.abs(Math.PI/m-m/Math.PI),r=t*t;f=Math.sin(k);var k=Math.cos(k),k=k/(f+k-1),v=k*(2/f-1),u=v*v,w=Math.PI*this.R*(t*(k-u)+Math.sqrt(r*(k-u)*(k-u)-(u+r)*(k*k-u)))/(u+r);0>
m&&(w=-w);f=this.x0+w;m=r+k;return w=Math.PI*this.R*(v*m-t*Math.sqrt((u+r)*(r+1)-m*m))/(u+r),d=0<=c?this.y0+w:this.y0-w,a.x=f,a.y=d,a};f.inverse=function(a){var e,d,c,f,l,m,k,v,u,w,x,y,A;return a.x-=this.x0,a.y-=this.y0,x=Math.PI*this.R,c=a.x/x,f=a.y/x,l=c*c+f*f,m=-Math.abs(f)*(1+l),k=m-2*f*f+c*c,v=-2*m+1+2*f*f+l*l,A=f*f/v+(2*k*k*k/v/v/v-9*m*k/v/v)/27,u=(m-k*k/3/v)/v,w=2*Math.sqrt(-u/3),x=3*A/u/w,1<Math.abs(x)&&(x=0<=x?1:-1),y=Math.acos(x)/3,d=0<=a.y?(-w*Math.cos(y+Math.PI/3)-k/3/v)*Math.PI:-(-w*
Math.cos(y+Math.PI/3)-k/3/v)*Math.PI,e=1E-10>Math.abs(c)?this.long0:b(this.long0+Math.PI*(l-1+Math.sqrt(1+2*(c*c-f*f)+l*l))/2/c),a.x=e,a.y=d,a};f.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],65:[function(k,a,f){var b=k("./datum_transform"),e=k("./adjust_axis"),l=k("./Proj"),m=k("./common/toPoint");a.exports=function d(a,f,k){var c;return Array.isArray(k)&&(k=m(k)),a.datum&&f.datum&&((1===a.datum.datum_type||2===a.datum.datum_type)&&"WGS84"!==
f.datumCode||(1===f.datum.datum_type||2===f.datum.datum_type)&&"WGS84"!==a.datumCode)&&(c=new l("WGS84"),d(a,c,k),a=c),"enu"!==a.axis&&e(a,!1,k),"longlat"===a.projName?(k.x*=.017453292519943295,k.y*=.017453292519943295):(a.to_meter&&(k.x*=a.to_meter,k.y*=a.to_meter),a.inverse(k)),a.from_greenwich&&(k.x+=a.from_greenwich),k=b(a.datum,f.datum,k),f.from_greenwich&&(k.x-=f.from_greenwich),"longlat"===f.projName?(k.x*=57.29577951308232,k.y*=57.29577951308232):(f.forward(k),f.to_meter&&(k.x/=f.to_meter,
k.y/=f.to_meter)),"enu"!==f.axis&&e(f,!0,k),k}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":31}],66:[function(k,a,f){function b(a,b,f){a[b]=f.map(function(a){var b={};return e(a,b),b}).reduce(function(a,b){return d(a,b)},{})}function e(a,d){var c;return Array.isArray(a)?(c=a.shift(),"PARAMETER"===c&&(c=a.shift()),1===a.length?Array.isArray(a[0])?(d[c]={},e(a[0],d[c])):d[c]=a[0]:a.length?"TOWGS84"===c?d[c]=a:(d[c]={},-1<["UNIT","PRIMEM","VERT_DATUM"].indexOf(c)?(d[c]={name:a[0].toLowerCase(),
convert:a[1]},3===a.length&&(d[c].auth=a[2])):"SPHEROID"===c?(d[c]={name:a[0],a:a[1],rf:a[2]},4===a.length&&(d[c].auth=a[3])):-1<"GEOGCS GEOCCS DATUM VERT_CS COMPD_CS LOCAL_CS FITTED_CS LOCAL_DATUM".split(" ").indexOf(c)?(a[0]=["name",a[0]],b(d,c,a)):a.every(function(a){return Array.isArray(a)})?b(d,c,a):e(a,d[c])):d[c]=!0,void 0):void(d[a]=!0)}function l(a){return a*g}function m(a){function b(b){var c=a.to_meter||1;return parseFloat(b,10)*c}"GEOGCS"===a.type?a.projName="longlat":"LOCAL_CS"===a.type?
(a.projName="identity",a.local=!0):a.projName="object"==typeof a.PROJECTION?Object.keys(a.PROJECTION)[0]:a.PROJECTION;a.UNIT&&(a.units=a.UNIT.name.toLowerCase(),"metre"===a.units&&(a.units="meter"),a.UNIT.convert&&(a.to_meter=parseFloat(a.UNIT.convert,10)));a.GEOGCS&&(a.datumCode=a.GEOGCS.DATUM?a.GEOGCS.DATUM.name.toLowerCase():a.GEOGCS.name.toLowerCase(),"d_"===a.datumCode.slice(0,2)&&(a.datumCode=a.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===a.datumCode||"new_zealand_1949"===a.datumCode)&&
(a.datumCode="nzgd49"),"wgs_1984"===a.datumCode&&("Mercator_Auxiliary_Sphere"===a.PROJECTION&&(a.sphere=!0),a.datumCode="wgs84"),"_ferro"===a.datumCode.slice(-6)&&(a.datumCode=a.datumCode.slice(0,-6)),"_jakarta"===a.datumCode.slice(-8)&&(a.datumCode=a.datumCode.slice(0,-8)),~a.datumCode.indexOf("belge")&&(a.datumCode="rnb72"),a.GEOGCS.DATUM&&a.GEOGCS.DATUM.SPHEROID&&(a.ellps=a.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===a.ellps.toLowerCase().slice(0,
13)&&(a.ellps="intl"),a.a=a.GEOGCS.DATUM.SPHEROID.a,a.rf=parseFloat(a.GEOGCS.DATUM.SPHEROID.rf,10)),~a.datumCode.indexOf("osgb_1936")&&(a.datumCode="osgb36"));a.b&&!isFinite(a.b)&&(a.b=a.a);[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],
["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",l],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",l],["x0","false_easting",b],["y0","false_northing",b],["long0","central_meridian",l],["lat0","latitude_of_origin",l],["lat0","standard_parallel_1",l],["lat1","standard_parallel_1",l],["lat2","standard_parallel_2",l],["alpha","azimuth",l],["srsCode","name"]].forEach(function(b){var c=b[0],d=b[1];!(c in a)&&d in a&&(a[c]=a[d],
3===b.length&&(a[c]=b[2](a[c])))});a.long0||!a.longc||"Albers_Conic_Equal_Area"!==a.projName&&"Lambert_Azimuthal_Equal_Area"!==a.projName||(a.long0=a.longc);a.lat_ts||!a.lat1||"Stereographic_South_Pole"!==a.projName&&"Polar Stereographic (variant B)"!==a.projName||(a.lat0=(0<a.lat1?90:-90)*g,a.lat_ts=a.lat1)}var g=.017453292519943295,d=k("./extend");a.exports=function(a,b){var c=JSON.parse((","+a).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]').replace(/,\["VERTCS".+/,
"")),f=c.shift(),g=c.shift();c.unshift(["name",g]);c.unshift(["type",f]);c.unshift("output");f={};return e(c,f),m(f.output),d(b,f.output)}},{"./extend":34}],67:[function(k,a,f){function b(a){var d=a.easting,c=a.zoneNumber;if(0>c||60<c)return null;var e,f,g,l,k;f=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562));g=a.northing;"N">a.zoneLetter&&(g-=1E7);g=g/.9996/6367449.145945056;k=g+(3*f/2-27*f*f*f/32)*Math.sin(2*g)+(21*f*f/16-55*f*f*f*f/32)*Math.sin(4*g)+151*f*f*f/96*Math.sin(6*g);e=6378137/Math.sqrt(1-
.00669438*Math.sin(k)*Math.sin(k));f=Math.tan(k)*Math.tan(k);g=.006739496752268451*Math.cos(k)*Math.cos(k);l=6335439.32722994/Math.pow(1-.00669438*Math.sin(k)*Math.sin(k),1.5);d=(d-5E5)/(.9996*e);e=k-e*Math.tan(k)/l*(d*d/2-(5+3*f+10*g-4*g*g-.06065547077041606)*d*d*d*d/24+(61+90*f+298*g+45*f*f-1.6983531815716497-3*g*g)*d*d*d*d*d*d/720);e=e/Math.PI*180;d=(d-(1+2*f+g)*d*d*d/6+(5-2*g+28*f-3*g*g+.05391597401814761+24*f*f)*d*d*d*d*d/120)/Math.cos(k);d=6*(c-1)-180+3+d/Math.PI*180;a.accuracy?(a=b({northing:a.northing+
a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber}),a={top:a.lat,right:a.lon,bottom:e,left:d}):a={lat:e,lon:d};return a}function e(a){a%=m;return 0===a&&(a=m),a}function l(a){var b;switch(a){case "C":b=11E5;break;case "D":b=2E6;break;case "E":b=28E5;break;case "F":b=37E5;break;case "G":b=46E5;break;case "H":b=55E5;break;case "J":b=64E5;break;case "K":b=73E5;break;case "L":b=82E5;break;case "M":b=91E5;break;case "N":b=0;break;case "P":b=8E5;break;case "Q":b=17E5;
break;case "R":b=26E5;break;case "S":b=35E5;break;case "T":b=44E5;break;case "U":b=53E5;break;case "V":b=62E5;break;case "W":b=7E6;break;case "X":b=79E5;break;default:b=-1}if(0<=b)return b;throw"Invalid zone letter: "+a;}var m=6;f.forward=function(a,b){var c,d,f,g,l,k,m=a[1];c=a[0];var w=Math.PI/180*m;g=Math.PI/180*c;k=Math.floor((c+180)/6)+1;180===c&&(k=60);56<=m&&64>m&&3<=c&&12>c&&(k=32);72<=m&&84>m&&(0<=c&&9>c?k=31:9<=c&&21>c?k=33:21<=c&&33>c?k=35:33<=c&&42>c&&(k=37));l=Math.PI/180*(6*(k-1)-180+
3);c=6378137/Math.sqrt(1-.00669438*Math.sin(w)*Math.sin(w));d=Math.tan(w)*Math.tan(w);f=.006739496752268451*Math.cos(w)*Math.cos(w);g=Math.cos(w)*(g-l);w=.9996*(6378137*(.9983242984503243*w-.002514607064228144*Math.sin(2*w)+2.639046602129982E-6*Math.sin(4*w)-3.4180461016968582E-9*Math.sin(6*w))+c*Math.tan(w)*(g*g/2+(5-d+9*f+4*f*f)*g*g*g*g/24+(61-58*d+d*d+600*f-2.2240339282485886)*g*g*g*g*g*g/720));0>m&&(w+=1E7);w=Math.round(w);f=Math.round(.9996*c*(g+(1-d+f)*g*g*g/6+(5-18*d+d*d+72*f-.39089081163157013)*
g*g*g*g*g/120)+5E5);g=k;k="Z";d=(84>=m&&72<=m?k="X":72>m&&64<=m?k="W":64>m&&56<=m?k="V":56>m&&48<=m?k="U":48>m&&40<=m?k="T":40>m&&32<=m?k="S":32>m&&24<=m?k="R":24>m&&16<=m?k="Q":16>m&&8<=m?k="P":8>m&&0<=m?k="N":0>m&&-8<=m?k="M":-8>m&&-16<=m?k="L":-16>m&&-24<=m?k="K":-24>m&&-32<=m?k="J":-32>m&&-40<=m?k="H":-40>m&&-48<=m?k="G":-48>m&&-56<=m?k="F":-56>m&&-64<=m?k="E":-64>m&&-72<=m?k="D":-72>m&&-80<=m&&(k="C"),k);m=b||5;k=""+f;c=""+w;d=g+d;l=e(g);f=Math.floor(f/1E5);g=Math.floor(w/1E5)%20;--l;w="AJSAJS".charCodeAt(l);
l="AFAFAF".charCodeAt(l);f=w+f-1;g=l+g;var x=!1;90<f&&(f=f-90+65-1,x=!0);(73===f||73>w&&73<f||(73<f||73>w)&&x)&&f++;(79===f||79>w&&79<f||(79<f||79>w)&&x)&&(f++,73===f&&f++);90<f&&(f=f-90+65-1);86<g?(g=g-86+65-1,x=!0):x=!1;(73===g||73>l&&73<g||(73<g||73>l)&&x)&&g++;(79===g||79>l&&79<g||(79<g||79>l)&&x)&&(g++,73===g&&g++);86<g&&(g=g-86+65-1);w=String.fromCharCode(f)+String.fromCharCode(g);return d+w+k.substr(k.length-5,m)+c.substr(c.length-5,m)};f.inverse=function(a){if((a=a.toUpperCase())&&0===a.length)throw"MGRSPoint coverting from nothing";
for(var d,c=a.length,f=null,g="",k=0;!/[A-Z]/.test(d=a.charAt(k));){if(2<=k)throw"MGRSPoint bad conversion from: "+a;g+=d;k++}d=parseInt(g,10);if(0===k||k+3>c)throw"MGRSPoint bad conversion from: "+a;g=a.charAt(k++);if("A">=g||"B"===g||"Y"===g||"Z"<=g||"I"===g||"O"===g)throw"MGRSPoint zone letter "+g+" not handled: "+a;var f=a.substring(k,k+=2),m=e(d),v;v=f.charAt(0);for(var u="AJSAJS".charCodeAt(m-1),w=1E5,x=!1;u!==v.charCodeAt(0);){if(u++,73===u&&u++,79===u&&u++,90<u){if(x)throw"Bad character: "+
v;u=65;x=!0}w+=1E5}v=w;f=f.charAt(1);if("V"<f)throw"MGRSPoint given invalid Northing "+f;m="AFAFAF".charCodeAt(m-1);u=0;for(w=!1;m!==f.charCodeAt(0);){if(m++,73===m&&m++,79===m&&m++,86<m){if(w)throw"Bad character: "+f;m=65;w=!0}u+=1E5}for(m=u;m<l(g);)m+=2E6;c-=k;if(0!==c%2)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+a;var y,A,z,B,C,u=c/2,f=c=0;a=(0<u&&(y=1E5/Math.pow(10,u),
A=a.substring(k,k+u),c=parseFloat(A)*y,z=a.substring(k+u),f=parseFloat(z)*y),B=c+v,C=f+m,{easting:B,northing:C,zoneLetter:g,zoneNumber:d,accuracy:y});y=b(a);return[y.left,y.bottom,y.right,y.top]};f.toPoint=function(a){a=f.inverse(a);return[(a[2]+a[0])/2,(a[3]+a[1])/2]}},{}],68:[function(k,a,f){a.exports={name:"proj4",version:"2.3.6",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",
directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},author:"",license:"MIT",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~3.24.5",
"grunt-browserify":"~1.3.0","grunt-contrib-uglify":"~0.3.2",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"0.0.0"}}},{}],"./includedProjections":[function(k,a,f){a.exports=k("hTEDpn")},{}],hTEDpn:[function(k,a,f){var b=[k("./lib/projections/tmerc"),k("./lib/projections/utm"),k("./lib/projections/sterea"),k("./lib/projections/stere"),k("./lib/projections/somerc"),k("./lib/projections/omerc"),k("./lib/projections/lcc"),k("./lib/projections/krovak"),k("./lib/projections/cass"),
k("./lib/projections/laea"),k("./lib/projections/aea"),k("./lib/projections/gnom"),k("./lib/projections/cea"),k("./lib/projections/eqc"),k("./lib/projections/poly"),k("./lib/projections/nzmg"),k("./lib/projections/mill"),k("./lib/projections/sinu"),k("./lib/projections/moll"),k("./lib/projections/eqdc"),k("./lib/projections/vandg"),k("./lib/projections/aeqd")];a.exports=function(a){b.forEach(function(b){a.Proj.projections.add(b)})}},{"./lib/projections/aea":40,"./lib/projections/aeqd":41,"./lib/projections/cass":42,
"./lib/projections/cea":43,"./lib/projections/eqc":44,"./lib/projections/eqdc":45,"./lib/projections/gnom":47,"./lib/projections/krovak":48,"./lib/projections/laea":49,"./lib/projections/lcc":50,"./lib/projections/mill":53,"./lib/projections/moll":54,"./lib/projections/nzmg":55,"./lib/projections/omerc":56,"./lib/projections/poly":57,"./lib/projections/sinu":58,"./lib/projections/somerc":59,"./lib/projections/stere":60,"./lib/projections/sterea":61,"./lib/projections/tmerc":62,"./lib/projections/utm":63,
"./lib/projections/vandg":64}]},{},[36])(36)})},"cmv/viewer/js/gis/dijit/StreetView/nls/resource":function(){define({root:{messages:{instructions:"Click the StreetView button then click the map at your desired location.",notAvailable:"Unfortunately, Google StreetView imagery is not yet available at that location."},rightClickMenuItem:{label:"Google StreetView here"}},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/LocateButton":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/LocateButton esri/renderers/SimpleRenderer esri/symbols/PictureMarkerSymbol esri/layers/GraphicsLayer esri/InfoTemplate dojo/topic".split(" "),
function(h,k,a,f,b,e,l,m){return h(null,{growlTemplate:"latitude: {latitude}\x3cbr/\x3elongitude: {longitude}\x3cbr/\x3eaccuracy: {accuracy}\x3cbr/\x3ealtitude: {altitude}\x3cbr/\x3ealtitude accuracy: {altitudeAccuracy}\x3cbr/\x3eheading: {heading}\x3cbr/\x3espeed: {speed}",constructor:function(a,b){this.options=a;this.parentNode=b},startup:function(){var g=new b("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABJhJREFUeNrcmN9PW2UYx7/n9ATKj7QMMUCxmSxlCRI3BzF6MRO9WOyVN5sJFxqvNCa7MmbphTG78Iprwx+weEMiF8bdLNFojBhNDEwu3ObWjo2uLUXKaIFSCqdnz7e8hx1WdOcUij+e5ElLOe3zyfd93ud9nlezLAte7LOv0S4vZ8VPi0eU72dx5bPiU+Jr9j8+fevpcTS3YALUIy/viUdRn10TvyK+cChgTwL5dOCZNqA7CARbgIB//+8VSkB+A8jmgdw6YFb2AgrcQt1gAsUli4m3E6gnAAx0A61N3qQqloE7WZGqsAvIZR0TuCnPYAJ1UV4u8H2oAzhZB9B+gLcFML2y+9GkwI27BhOomL10g71AfxcO1eaWgJuZx0srcGNPBbOV4tK9emInjxphzL9f7u4ubY1y+j45VV2+RkLR+NuMoeyCil0LpnZfzF6+RkI54RhLWUwx1CjGktDORD/snPo7YyzGZGzF8BhMkUaZV9x9R22M6duRKGqrpjvUqtapg5aEeowxGdvJoquzr6rWgEe1uJ8rFrSy+EYFOp3v+ZnlEW5gr2rthjqQq8eMF7UYvGRBL5jwFbZhFCs76rfqqAQMbAd8MP0aKroGy61qZFhcrf551lBdQvXs8wK1VoFvoYym+5vwT6ceBrMrq36YW+gOtJRGng/ljzej1NOEcrsO0y0cGRTYacNuW9yWB0agUoSaLpiBianfw5l7ydbBvle0Yi6Dn+IT1s8n+ouj588nR441F55rxmaLBlNzWT6URXbB/qpLqAETtbh8VGrih9nwYHi47e33TyErx3Lhfhc6Zl7Ufrs62TaxfiXc9eEHCS4rl1RzoZqDIaJ73UHbbGkkp64/WAqm/7jROvAacGtTzj5Zgrvii5YJq/N1pH/8tvX6rTtBPrtdx071DGaKYkz0zFLOf/LZF7TMn0BqXlqaJJBZLCOVzwEbq7CWwlpmPunns/yO1zhG3cVHEn0rn8bq3DBK0s4UimsoPlzZaboyImFB1tY06/55z4r5JFdYEno7g6W5+HfW9vwGyullbKSkl7knaiXyVdcqv1q9faESn/W53JUHAqPETOgz/eF8KDJYnPnmC6wncrASotRN6aFnRKnclwi9ca545tRQns8adSoWt3t0N8bdxeLJOjX6zrvJQMfq+vJXFy1c/Rz4fhz68kdW3zn/+ugnl5N8hs9qLhVzMMQNBRZh4+amZDCLuf1ZPEc6/YWuSx8npt+MBrMPUn5UKugOXSqNDL+0W2CrpcJD8+gE49wX5TQTPuZSZlGAFZ3Fk0t1/OWhUnFk6EBHEo0MymYNNYzGOGJxWHB7XjIgKzqDdxrYsksCE91QS+6lRjA2GZRN6dJrc5S6xt6bI5YX0xRgEyFFKTrf6x6haIyt+n8OJ2v2ruSEXC1BJD9qY0zGdrLo6i5hwVbtdvbowW6k96i18GQdI+kah1HOfUdljKVaHabUeE2BVaTVwZPDqGPrNswYwzH4jql8r6386i5hku85jDYSzh54HVcFU//NK4JGX6ow0VVOeb9U+VdfQzX44m7cmej/r6vOf+py+JEAAwDRMD/uB0XQuQAAAABJRU5ErkJggg\x3d\x3d",
38,38);this.graphics=new e({id:"GeoLocationGraphics"});g=new f(g);g.label="GPS Position";g.description="GPS Position";this.graphics.setRenderer(g);this.options.map.addLayer(this.graphics);this.options.graphicsLayer=this.graphics;this.options.infoTemplate=new l("GPS Position","${*}");this.options.symbol=null;this.locateButton=new a(this.options,this.parentNode);this.locateButton.startup();this.locateButton.on("locate",k.hitch(this,"_growlLocation"))},_growlLocation:function(a){a={accuracy:a.position.coords.accuracy?
a.position.coords.accuracy:"",altitude:a.position.coords.altitude?a.position.coords.altitude:"",altitudeAccuracy:a.position.coords.altitudeAccuracy?a.position.coords.altitudeAccuracy:"",heading:a.position.coords.heading?a.position.coords.heading:"",latitude:a.position.coords.latitude?a.position.coords.latitude:"",longitude:a.position.coords.longitude?a.position.coords.longitude:"",speed:a.position.coords.speed?a.position.coords.speed:""};0<this.graphics.graphics.length&&(this.graphics.graphics[0].attributes=
a);this.options.publishGPSPosition&&m.publish("growler/growl",{title:"GPS Position",message:k.replace(this.growlTemplate,a),level:"default",timeout:1E4,opacity:1})}})})},"esri/dijit/LocateButton":function(){define("require dojo/Evented dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../config dijit/_WidgetBase dijit/a11yclick dijit/_TemplatedMixin dojo/on dojo/Deferred dojo/text!./templates/LocateButton.html dojo/i18n!../nls/jsapi dojo/dom-class dojo/dom-style dojo/dom-attr ../geometry/webMercatorUtils ../geometry/Point ../SpatialReference ../graphic ../symbols/PictureMarkerSymbol ../tasks/ProjectParameters".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B){h=a("esri.dijit.LocateButton",[m,d,k],{templateString:q,options:{theme:"LocateButton",map:null,visible:!0,highlightLocation:!0,symbol:new z(h.toUrl("./images/sdk_gps_location.png"),28,28),infoTemplate:null,scale:null,useTracking:!1,clearOnTrackingStop:!1,setScale:!0,centerAt:!0,timeout:15E3,graphicsLayer:null,geolocationOptions:{maximumAge:0,timeout:15E3,enableHighAccuracy:!0}},constructor:function(a,b){var c=f.mixin({},this.options,a);this.domNode=
b;this._i18n=t;var d=navigator.geolocation,e=window.hasOwnProperty("isSecureContext");(e&&window.isSecureContext||!e&&"https:"===window.location.protocol)&&d||(c.visible=!1);this.set("map",c.map);this.set("theme",c.theme);this.set("visible",c.visible);this.set("scale",c.scale);this.set("highlightLocation",c.highlightLocation);this.set("symbol",c.symbol);this.set("infoTemplate",c.infoTemplate);this.set("geolocationOptions",c.geolocationOptions);this.set("useTracking",c.useTracking);this.set("setScale",
c.setScale);this.set("centerAt",c.centerAt);this.set("timeout",c.timeout);this.set("graphicsLayer",c.graphicsLayer);this.set("clearOnTrackingStop",c.clearOnTrackingStop);this.watch("theme",this._updateThemeWatch);this.watch("visible",this._visible);this.watch("tracking",this._locate);this.watch("useTracking",f.hitch(this,function(){this.get("tracking")&&!this.get("useTracking")&&this._stopTracking();this._setTitle()}));this._css={container:"locateContainer",locate:"zoomLocateButton",loading:"loading",
tracking:"tracking"}},postCreate:function(){this.inherited(arguments);this.own(c(this._locateNode,g,f.hitch(this,this.locate)))},startup:function(){this.inherited(arguments);this.get("map")||this.set("visible",!1);this.get("map").loaded?this._init():c.once(this.get("map"),"load",f.hitch(this,function(){this._init()}))},destroy:function(){this.clear();this._graphicsEvent&&this._graphicsEvent.remove();this._removeWatchPosition();this.inherited(arguments)},clear:function(){var a=this.get("highlightGraphic"),
b=this.get("graphicsLayer");a&&(b?b.remove(a):this.get("map").graphics.remove(a),this.set("highlightGraphic",null))},locate:function(){return this.get("useTracking")&&this.set("tracking",!this.get("tracking")),this._locate()},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},_setTitle:function(){this.get("useTracking")?this.get("tracking")?u.set(this._locateNode,"title",this._i18n.widgets.locateButton.locate.stopTracking):u.set(this._locateNode,"title",this._i18n.widgets.locateButton.locate.tracking):
u.set(this._locateNode,"title",this._i18n.widgets.locateButton.locate.title)},_removeWatchPosition:function(){this.get("watchId")&&(navigator.geolocation.clearWatch(this.get("watchId")),this.set("watchId",null));this._removePrivateVars()},_stopTracking:function(){r.remove(this._locateNode,this._css.tracking);this._removeWatchPosition();this.get("clearOnTrackingStop")&&this.clear();this._hideLoading()},_positionToObject:function(a){return a?{coords:f.mixin({},a.coords),timestamp:a.timestamp}:{}},_startTracking:function(){r.add(this._locateNode,
this._css.tracking);this._removeWatchPosition();var a=navigator.geolocation.watchPosition(f.hitch(this,function(a){a=this._positionToObject(a);this._setPosition(a).then(f.hitch(this,function(a){this._locateEvent(a)}),f.hitch(this,function(a){a||(a=Error("LocateButton::Error setting the position."));this._locateError(a)}))}),f.hitch(this,function(a){this.set("tracking",!1);a||(a=Error("LocateButton::Could not get tracking position."));this._locateError(a)}),this.get("geolocationOptions"));this.set("watchId",
a)},_removePrivateVars:function(){this._scale=this._position=this._graphic=null},_getCurrentPosition:function(){var a=new n;this._removePrivateVars();var b=setTimeout(f.hitch(this,function(){clearTimeout(b);a.reject(Error("LocateButton::time expired for getting location."))}),this.get("timeout"));return navigator.geolocation.getCurrentPosition(f.hitch(this,function(c){c=this._positionToObject(c);clearTimeout(b);this._setPosition(c).then(f.hitch(this,function(b){a.resolve(b)}),f.hitch(this,function(b){b||
(b=Error("LocateButton::Error setting map position."));a.reject(b)}))}),f.hitch(this,function(b){b||(b=Error("LocateButton::Could not get current position."));a.reject(b)}),this.get("geolocationOptions")),a.promise},_locate:function(){var a=new n;if(this._showLoading(),navigator.geolocation)this.get("useTracking")?this.get("tracking")?(this._startTracking(),a.resolve({tracking:!0})):(this._stopTracking(),a.resolve({tracking:!1})):this._getCurrentPosition().then(f.hitch(this,function(b){this._locateEvent(b);
a.resolve(b)}),f.hitch(this,function(b){b||(b=Error("LocateButton::Could not get current position."));this._locateError(b);a.reject(b)}));else{var b=Error("LocateButton::geolocation unsupported");this._locateError(b);a.reject(b)}return this._setTitle(),a.promise},_projectPoint:function(a){var b=new n,c=this.get("map").spatialReference,d=c.wkid;c.isWebMercator()?(a=w.geographicToWebMercator(a),b.resolve(a)):l.defaults.geometryService&&4326!==d?(d=new B,d.geometries=[a],d.outSR=c,l.defaults.geometryService.project(d).then(f.hitch(this,
function(a){a&&a.length?b.resolve(a[0]):b.reject(Error("LocateButton::Point was not projected."))}),function(a){a||(a=Error("LocateButton::please specify a geometry service on esri/config to project."));b.reject(a)})):b.resolve(a);return b.promise},_getScale:function(a){var b=this.get("scale");return a&&a.coords?b||a.coords.accuracy||5E4:b||5E4},_createPoint:function(a){var b;a&&a.coords&&(b=new x([a.coords.longitude,a.coords.latitude],new y({wkid:4326})));return b},_setPosition:function(a){var b,
c,d=new n;if(this._removePrivateVars(),this._position=a,a&&a.coords){var e=this._createPoint(a);e&&(c=this._createGraphic(e,a),this._graphic=c);var g=this._getScale(a);this._scale=g;e?this._projectPoint(e).then(f.hitch(this,function(b){this._graphic=c=this._createGraphic(b,a);var e={graphic:c,scale:g,position:a};this.get("setScale")&&this.get("map").setScale(g);this.get("centerAt")?this.get("map").centerAt(b).then(f.hitch(this,function(){d.resolve(e)}),f.hitch(this,function(a){a||(a=Error("LocateButton::Could not center map."));
d.reject(a)})):d.resolve(e)}),f.hitch(this,function(a){a||(a=Error("LocateButton::Error projecting point."));d.reject(a)})):(b=Error("LocateButton::Invalid point"),d.reject(b))}else b=Error("LocateButton::Invalid position"),d.reject(b);return d.promise},_createGraphic:function(a,b){var c;a&&(c={position:b},c=new A(a,this.get("symbol"),c,this.get("infoTemplate")));return c},_locateEvent:function(a){if(a.graphic){var b=this.get("highlightGraphic"),c=this.get("graphicsLayer");b?(b.setGeometry(a.graphic.geometry),
b.setAttributes(a.graphic.attributes),b.setInfoTemplate(a.graphic.infoTemplate),b.setSymbol(a.graphic.symbol)):(b=a.graphic,this.get("highlightLocation")&&(c?c.add(b):this.get("map").graphics.add(b)));this.set("highlightGraphic",b)}this._hideLoading();this.emit("locate",a)},_locateError:function(a){a={graphic:this._graphic,scale:this._scale,position:this._position,error:a};this._hideLoading();this.emit("locate",a)},_showLoading:function(){this.get("useTracking")||r.add(this._locateNode,this._css.loading)},
_hideLoading:function(){this.get("useTracking")||r.remove(this._locateNode,this._css.loading)},_init:function(){this._visible();this._setTitle();this.get("tracking")&&this.get("useTracking")&&this._locate();this.set("loaded",!0);this.emit("load",{})},_updateThemeWatch:function(a,b,c){r.remove(this.domNode,b);r.add(this.domNode,c)},_visible:function(){this.get("visible")?v.set(this.domNode,"display","block"):v.set(this.domNode,"display","none")}});return b("extend-esri")&&f.setObject("dijit.LocateButton",
h,e),h})},"cmv/viewer/js/gis/dijit/Locale":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/on dojo/dom-style dojo/_base/array dojo/_base/kernel dojo/io-query dijit/form/DropDownButton dijit/DropDownMenu dijit/MenuItem ./Locale/countries dojo/text!./Locale/templates/Locale.html dojo/i18n!./Locale/nls/resource xstyle/css!flag-icon-css/css/flag-icon.min.css xstyle/css!./Locale/css/Locale.css".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r){return h([k,
a],{templateString:t,i18n:r,baseClass:"cmvLocaleDijit",currentLocale:null,includeFlag:!0,includeCountry:!0,includeLanguage:!0,languages:{en:"English",es:"Espa\u00f1ol",fr:"Fran\u00e7ais",pt:"Portugu\u00eas"},locales:"es-ar es-bo pt-br en-ca fr-ca es-cl es-co es-cr es-do es-ec es-sv fr-FR es-gt fr-ht es-hn en-in es-mx es-pa es-pe es-pr pt-pt es-py es-es en-gb en-us es-us es-uy es-ve".split(" "),postCreate:function(){this.inherited(arguments);this.currentLocale=m.locale;this.parentWidget&&this.parentWidget.toggleable&&
e.set(this.localeLabelContainer,"display","block");var a=new c({baseClass:"localeMenu"});l.forEach(this.locales,f.hitch(this,function(b){var c=b.split("-"),d=this.languages[c[0]];if(d){var e="",g=null,h=null;c[1]&&(this.includeFlag&&(h="flag-icon flag-icon-"+c[1].toLowerCase()),(g=q[c[1].toUpperCase()])&&this.includeCountry&&(e=g));this.includeLanguage&&(0<e.length&&(e+=" - "),e+=d);b=new n({id:b,label:e,iconClass:h,onClick:f.hitch(this,"switchLocale",b)});a.addChild(b)}}));a.startup();var b=this.currentLocale.split("-"),
g=this.languages[b[0]],h="",k=null;b[1]&&(this.includeFlag&&(h='\x3cdiv class\x3d"flag-icon flag-icon-'+b[1].toLowerCase()+'"\x3e\x3c/div\x3e'),(k=q[b[1].toUpperCase()])&&this.includeCountry&&(h+=k),this.includeLanguage&&(k&&this.includeCountry&&(h+=" - "),h+=g));b=new d({label:h,dropDown:a});this.localeDropDownContainer.appendChild(b.domNode)},switchLocale:function(a){if(a!==this.currentLocale){var b=window.location.href,c={};-1<b.indexOf("?")&&(b=b.substring(b.indexOf("?")+1,b.length),c=g.queryToObject(b));
c.locale=a;window.location=window.location.pathname+"?"+g.objectToQuery(c)}}})})},"cmv/viewer/js/gis/dijit/Locale/countries":function(){define({AF:"Afghanistan",AX:"\u00c5land Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",
BT:"Bhutan",BO:"Bolivia",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, The Democratic Republic of the",CK:"Cook Islands",CR:"Costa Rica",
CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",
GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic Of",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"Democratic People's Republic of Korea",
KR:"Korea, Republic of",XK:"Kosovo",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia, The Former Yugoslav Republic of",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States of",MD:"Moldova, Republic of",
MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territory, Occupied",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",
PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",SH:"Saint Helena",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",ES:"Spain",
LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania, United Republic of",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Minor Outlying Islands",
UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"})},"cmv/viewer/js/gis/dijit/Locale/nls/resource":function(){define({root:{selectLocale:"Select Your Locale:"},es:!0,fr:!0,"pt-br":!0,"pt-pt":!0})},"cmv/viewer/js/gis/dijit/Legend":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/_base/lang","esri/dijit/Legend"],function(h,k,a,f){return h([k],
{startup:function(){this.inherited(arguments);this.legend=new f({arrangement:this.arrangement||f.ALIGN_LEFT,autoUpdate:this.autoUpdate||!0,id:this.id+"_legend",layerInfos:this.layerInfos,map:this.map,respectCurrentMapScale:this.respectCurrentMapScale||!0},this.domNode);this.legend.startup();this.map.on("update-end",a.hitch(this,function(){this.legend.refresh()}))}})})},"dojox/gfx/svg":function(){define("dojo/_base/lang dojo/_base/sniff dojo/_base/window dojo/dom dojo/_base/declare dojo/_base/array dojo/dom-geometry dojo/dom-attr dojo/_base/Color ./_base ./shape ./path".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n){function q(b,c){return a.doc.createElementNS?a.doc.createElementNS(b,c):a.doc.createElement(c)}function t(a,b,c,d){return a.setAttributeNS?a.setAttributeNS(b,c,d):a.setAttribute(c,d)}function r(b){return v.useSvgWeb?a.doc.createTextNode(b,!0):a.doc.createTextNode(b)}var v=d.svg={};v.useSvgWeb="undefined"!=typeof window.svgweb;var u=navigator.userAgent,w=k("ios"),x=k("android"),y=k("chrome")||x&&4<=x?"auto":"optimizeLegibility";v.xmlns={xlink:"http://www.w3.org/1999/xlink",
svg:"http://www.w3.org/2000/svg"};v.getRef=function(a){return a&&"none"!=a?a.match(/^url\(#.+\)$/)?f.byId(a.slice(5,-1)):a.match(/^#dojoUnique\d+$/)?f.byId(a.slice(1)):null:null};v.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};var A=0;v.Shape=b("dojox.gfx.svg.Shape",c.Shape,{destroy:function(){if(this.fillStyle&&"type"in this.fillStyle){var a=
this.rawNode.getAttribute("fill");(a=v.getRef(a))&&a.parentNode.removeChild(a)}this.clip&&(a=this.rawNode.getAttribute("clip-path"))&&(a=f.byId(a.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);c.Shape.prototype.destroy.apply(this,arguments)},setFill:function(a){if(!a)return this.fillStyle=null,this.rawNode.setAttribute("fill","none"),this.rawNode.setAttribute("fill-opacity",0),this;var b,c=function(a){this.setAttribute(a,b[a].toFixed(8))};if("object"==typeof a&&"type"in a){switch(a.type){case "linear":b=
d.makeParameters(d.defaultLinearGradient,a);a=this._setFillObject(b,"linearGradient");e.forEach(["x1","y1","x2","y2"],c,a);break;case "radial":b=d.makeParameters(d.defaultRadialGradient,a);a=this._setFillObject(b,"radialGradient");e.forEach(["cx","cy","r"],c,a);break;case "pattern":b=d.makeParameters(d.defaultPattern,a),a=this._setFillObject(b,"pattern"),e.forEach(["x","y","width","height"],c,a)}this.fillStyle=b;return this}this.fillStyle=b=d.normalizeColor(a);this.rawNode.setAttribute("fill",b.toCss());
this.rawNode.setAttribute("fill-opacity",b.a);this.rawNode.setAttribute("fill-rule","evenodd");return this},setStroke:function(a){var b=this.rawNode;if(!a)return this.strokeStyle=null,b.setAttribute("stroke","none"),b.setAttribute("stroke-opacity",0),this;if("string"==typeof a||h.isArray(a)||a instanceof g)a={color:a};a=this.strokeStyle=d.makeParameters(d.defaultStroke,a);a.color=d.normalizeColor(a.color);if(a){var c=0>a.width?0:a.width;b.setAttribute("stroke",a.color.toCss());b.setAttribute("stroke-opacity",
a.color.a);b.setAttribute("stroke-width",c);b.setAttribute("stroke-linecap",a.cap);"number"==typeof a.join?(b.setAttribute("stroke-linejoin","miter"),b.setAttribute("stroke-miterlimit",a.join)):b.setAttribute("stroke-linejoin",a.join);var e=a.style.toLowerCase();e in v.dasharray&&(e=v.dasharray[e]);if(e instanceof Array){var e=h._toArray(e),f;for(f=0;f<e.length;++f)e[f]*=c;if("butt"!=a.cap){for(f=0;f<e.length;f+=2)e[f]-=c,1>e[f]&&(e[f]=1);for(f=1;f<e.length;f+=2)e[f]+=c}e=e.join(",")}b.setAttribute("stroke-dasharray",
e);b.setAttribute("dojoGfxStrokeStyle",a.style)}return this},_getParentSurface:function(){for(var a=this.parent;a&&!(a instanceof d.Surface);a=a.parent);return a},_setFillObject:function(a,b){var c=v.xmlns.svg;this.fillStyle=a;var e=this._getParentSurface().defNode,f=this.rawNode.getAttribute("fill");if(f=v.getRef(f))if(f.tagName.toLowerCase()!=b.toLowerCase()){var g=f.id;f.parentNode.removeChild(f);f=q(c,b);f.setAttribute("id",g);e.appendChild(f)}else for(;f.childNodes.length;)f.removeChild(f.lastChild);
else f=q(c,b),f.setAttribute("id",d._base._getUniqueId()),e.appendChild(f);if("pattern"==b)f.setAttribute("patternUnits","userSpaceOnUse"),c=q(c,"image"),c.setAttribute("x",0),c.setAttribute("y",0),c.setAttribute("width",(0>a.width?0:a.width).toFixed(8)),c.setAttribute("height",(0>a.height?0:a.height).toFixed(8)),t(c,v.xmlns.xlink,"xlink:href",a.src),f.appendChild(c);else for(f.setAttribute("gradientUnits","userSpaceOnUse"),e=0;e<a.colors.length;++e){var g=a.colors[e],h=q(c,"stop"),l=g.color=d.normalizeColor(g.color);
h.setAttribute("offset",g.offset.toFixed(8));h.setAttribute("stop-color",l.toCss());h.setAttribute("stop-opacity",l.a);f.appendChild(h)}this.rawNode.setAttribute("fill","url(#"+f.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");this.rawNode.setAttribute("fill-rule","evenodd");return f},_applyTransform:function(){if(this.matrix){var a=this.matrix;this.rawNode.setAttribute("transform","matrix("+a.xx.toFixed(8)+","+a.yx.toFixed(8)+","+a.xy.toFixed(8)+","+a.yy.toFixed(8)+","+a.dx.toFixed(8)+
","+a.dy.toFixed(8)+")")}else this.rawNode.removeAttribute("transform");return this},setRawNode:function(a){a=this.rawNode=a;"image"!=this.shape.type&&a.setAttribute("fill","none");a.setAttribute("fill-opacity",0);a.setAttribute("stroke","none");a.setAttribute("stroke-opacity",0);a.setAttribute("stroke-width",1);a.setAttribute("stroke-linecap","butt");a.setAttribute("stroke-linejoin","miter");a.setAttribute("stroke-miterlimit",4);a.__gfxObject__=this},setShape:function(a){this.shape=d.makeParameters(this.shape,
a);for(var b in this.shape)if("type"!=b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}this.bbox=null;return this},_moveToFront:function(){this.rawNode.parentNode.appendChild(this.rawNode);return this},_moveToBack:function(){this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild);return this},setClip:function(a){this.inherited(arguments);var b=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;
if(a&&!b)return this;"polyline"===b&&(a=h.clone(a),a.points=a.points.join(","));var c,d=m.get(this.rawNode,"clip-path");d&&(c=f.byId(d.match(/gfx_clip[\d]+/)[0]))&&c.removeChild(c.childNodes[0]);a?(c?(b=q(v.xmlns.svg,b),c.appendChild(b)):(d="gfx_clip"+ ++A,this.rawNode.setAttribute("clip-path","url(#"+d+")"),c=q(v.xmlns.svg,"clipPath"),b=q(v.xmlns.svg,b),c.appendChild(b),this.rawNode.parentNode.insertBefore(c,this.rawNode),m.set(c,"id",d)),m.set(b,a)):(this.rawNode.removeAttribute("clip-path"),c&&
c.parentNode.removeChild(c));return this},_removeClipNode:function(){var a,b=m.get(this.rawNode,"clip-path");b&&(a=f.byId(b.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);return a}});v.Group=b("dojox.gfx.svg.Group",v.Shape,{constructor:function(){c.Container._init.call(this)},setRawNode:function(a){this.rawNode=a;this.rawNode.__gfxObject__=this},destroy:function(){this.clear(!0);v.Shape.prototype.destroy.apply(this,arguments)}});v.Group.nodeType="g";v.Rect=b("dojox.gfx.svg.Rect",[v.Shape,
c.Rect],{setShape:function(a){this.shape=d.makeParameters(this.shape,a);this.bbox=null;for(var b in this.shape)if("type"!=b&&"r"!=b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}null!=this.shape.r&&(this.rawNode.setAttribute("ry",this.shape.r),this.rawNode.setAttribute("rx",this.shape.r));return this}});v.Rect.nodeType="rect";v.Ellipse=b("dojox.gfx.svg.Ellipse",[v.Shape,c.Ellipse],{});v.Ellipse.nodeType="ellipse";v.Circle=b("dojox.gfx.svg.Circle",[v.Shape,
c.Circle],{});v.Circle.nodeType="circle";v.Line=b("dojox.gfx.svg.Line",[v.Shape,c.Line],{});v.Line.nodeType="line";v.Polyline=b("dojox.gfx.svg.Polyline",[v.Shape,c.Polyline],{setShape:function(a,b){a&&a instanceof Array?(this.shape=d.makeParameters(this.shape,{points:a}),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.shape=d.makeParameters(this.shape,a);this.bbox=null;this._normalizePoints();for(var c=[],e=this.shape.points,f=0;f<e.length;++f)c.push(e[f].x.toFixed(8),
e[f].y.toFixed(8));this.rawNode.setAttribute("points",c.join(" "));return this}});v.Polyline.nodeType="polyline";v.Image=b("dojox.gfx.svg.Image",[v.Shape,c.Image],{setShape:function(a){this.shape=d.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;for(var b in this.shape)if("type"!=b&&"src"!=b){var c=this.shape[b];if("width"===b||"height"===b)c=0>c?0:c;a.setAttribute(b,c)}a.setAttribute("preserveAspectRatio","none");t(a,v.xmlns.xlink,"xlink:href",this.shape.src);a.__gfxObject__=this;return this}});
v.Image.nodeType="image";v.Text=b("dojox.gfx.svg.Text",[v.Shape,c.Text],{setShape:function(a){this.shape=d.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;var b=this.shape;a.setAttribute("x",b.x);a.setAttribute("y",b.y);a.setAttribute("text-anchor",b.align);a.setAttribute("text-decoration",b.decoration);a.setAttribute("rotate",b.rotated?90:0);a.setAttribute("kerning",b.kerning?"auto":0);a.setAttribute("text-rendering",y);a.firstChild?a.firstChild.nodeValue=b.text:a.appendChild(r(b.text));
return this},getTextWidth:function(){var a=this.rawNode,b=a.parentNode,a=a.cloneNode(!0);a.style.visibility="hidden";var c=0,d=a.firstChild.nodeValue;b.appendChild(a);if(""!=d)for(;!c;)c=a.getBBox?parseInt(a.getBBox().width):68;b.removeChild(a);return c},getBoundingBox:function(){var a=null;if(this.getShape().text)try{a=this.rawNode.getBBox()}catch(D){a={x:0,y:0,width:0,height:0}}return a}});v.Text.nodeType="text";v.Path=b("dojox.gfx.svg.Path",[v.Shape,n.Path],{_updateWithSegment:function(a){this.inherited(arguments);
"string"==typeof this.shape.path&&this.rawNode.setAttribute("d",this.shape.path)},setShape:function(a){this.inherited(arguments);this.shape.path?this.rawNode.setAttribute("d",this.shape.path):this.rawNode.removeAttribute("d");return this}});v.Path.nodeType="path";v.TextPath=b("dojox.gfx.svg.TextPath",[v.Shape,n.TextPath],{_updateWithSegment:function(a){this.inherited(arguments);this._setTextPath()},setShape:function(a){this.inherited(arguments);this._setTextPath();return this},_setTextPath:function(){if("string"==
typeof this.shape.path){var a=this.rawNode;if(!a.firstChild){var b=q(v.xmlns.svg,"textPath"),c=r("");b.appendChild(c);a.appendChild(b)}b=(b=a.firstChild.getAttributeNS(v.xmlns.xlink,"href"))&&v.getRef(b);if(!b&&(c=this._getParentSurface())){var c=c.defNode,b=q(v.xmlns.svg,"path"),e=d._base._getUniqueId();b.setAttribute("id",e);c.appendChild(b);t(a.firstChild,v.xmlns.xlink,"xlink:href","#"+e)}b&&b.setAttribute("d",this.shape.path)}},_setText:function(){var a=this.rawNode;if(!a.firstChild){var b=q(v.xmlns.svg,
"textPath"),c=r("");b.appendChild(c);a.appendChild(b)}a=a.firstChild;b=this.text;a.setAttribute("alignment-baseline","middle");switch(b.align){case "middle":a.setAttribute("text-anchor","middle");a.setAttribute("startOffset","50%");break;case "end":a.setAttribute("text-anchor","end");a.setAttribute("startOffset","100%");break;default:a.setAttribute("text-anchor","start"),a.setAttribute("startOffset","0%")}a.setAttribute("baseline-shift","0.5ex");a.setAttribute("text-decoration",b.decoration);a.setAttribute("rotate",
b.rotated?90:0);a.setAttribute("kerning",b.kerning?"auto":0);a.firstChild.data=b.text}});v.TextPath.nodeType="text";var z=534<function(){var a=/WebKit\/(\d*)/.exec(u);return a?a[1]:0}();v.Surface=b("dojox.gfx.svg.Surface",c.Surface,{constructor:function(){c.Container._init.call(this)},destroy:function(){c.Container.clear.call(this,!0);this.defNode=null;this.inherited(arguments)},setDimensions:function(a,b){if(!this.rawNode)return this;var c=0>a?0:a,d=0>b?0:b;this.rawNode.setAttribute("width",c);this.rawNode.setAttribute("height",
d);z&&(this.rawNode.style.width=c,this.rawNode.style.height=d);return this},getDimensions:function(){return this.rawNode?{width:d.normalizedLength(this.rawNode.getAttribute("width")),height:d.normalizedLength(this.rawNode.getAttribute("height"))}:null}});v.createSurface=function(a,b,c){var e=new v.Surface;e.rawNode=q(v.xmlns.svg,"svg");e.rawNode.setAttribute("overflow","hidden");b&&e.rawNode.setAttribute("width",0>b?0:b);c&&e.rawNode.setAttribute("height",0>c?0:c);b=q(v.xmlns.svg,"defs");e.rawNode.appendChild(b);
e.defNode=b;e._parent=f.byId(a);e._parent.appendChild(e.rawNode);d._base._fixMsTouchAction(e);return e};k={_setFont:function(){var a=this.fontStyle;this.rawNode.setAttribute("font-style",a.style);this.rawNode.setAttribute("font-variant",a.variant);this.rawNode.setAttribute("font-weight",a.weight);this.rawNode.setAttribute("font-size",a.size);this.rawNode.setAttribute("font-family",a.family)}};var B=c.Container;b=v.Container={openBatch:function(){if(!this._batch){var b;b=v.useSvgWeb?a.doc.createDocumentFragment(!0):
a.doc.createDocumentFragment();this.fragment=b}++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this.fragment&&!this._batch&&(this.rawNode.appendChild(this.fragment),delete this.fragment);return this},add:function(a){this!=a.getParent()&&(this.fragment?this.fragment.appendChild(a.rawNode):this.rawNode.appendChild(a.rawNode),B.add.apply(this,arguments),a.setClip(a.clip));return this},remove:function(a,b){this==a.getParent()&&(this.rawNode==a.rawNode.parentNode&&
this.rawNode.removeChild(a.rawNode),this.fragment&&this.fragment==a.rawNode.parentNode&&this.fragment.removeChild(a.rawNode),a._removeClipNode(),B.remove.apply(this,arguments));return this},clear:function(){for(var a=this.rawNode;a.lastChild;)a.removeChild(a.lastChild);var b=this.defNode;if(b){for(;b.lastChild;)b.removeChild(b.lastChild);a.appendChild(b)}return B.clear.apply(this,arguments)},getBoundingBox:B.getBoundingBox,_moveChildToFront:B._moveChildToFront,_moveChildToBack:B._moveChildToBack};
n=v.Creator={createObject:function(a,b){if(!this.rawNode)return null;var c=new a,d=q(v.xmlns.svg,a.nodeType);c.setRawNode(d);c.setShape(b);this.add(c);return c}};h.extend(v.Text,k);h.extend(v.TextPath,k);h.extend(v.Group,b);h.extend(v.Group,c.Creator);h.extend(v.Group,n);h.extend(v.Surface,b);h.extend(v.Surface,c.Creator);h.extend(v.Surface,n);v.fixTarget=function(a,b){a.gfxTarget||(a.gfxTarget=w&&a.target.wholeText?a.target.parentElement.__gfxObject__:a.target.__gfxObject__);return!0};v.useSvgWeb&&
(v.createSurface=function(a,b,c){var e=new v.Surface;b=0>b?0:b;c=0>c?0:c;if(!b||!c){var g=l.position(a);b=b||g.w;c=c||g.h}a=f.byId(a);var g=a.id?a.id+"_svgweb":d._base._getUniqueId(),h=q(v.xmlns.svg,"svg");h.id=g;h.setAttribute("width",b);h.setAttribute("height",c);svgweb.appendChild(h,a);h.addEventListener("SVGLoad",function(){e.rawNode=this;e.isLoaded=!0;var a=q(v.xmlns.svg,"defs");e.rawNode.appendChild(a);e.defNode=a;if(e.onLoad)e.onLoad(e)},!1);e.isLoaded=!1;return e},v.Surface.extend({destroy:function(){var a=
this.rawNode;svgweb.removeChild(a,a.parentNode)}}),k={connect:function(a,b,c){"on"===a.substring(0,2)&&(a=a.substring(2));c=2==arguments.length?b:h.hitch(b,c);this.getEventSource().addEventListener(a,c,!1);return[this,a,c]},disconnect:function(a){this.getEventSource().removeEventListener(a[1],a[2],!1);delete a[0]}},h.extend(v.Shape,k),h.extend(v.Surface,k));return v})},"dojox/gfx/filters":function(){define(["dojo/_base/lang","dojo/_base/array"],function(h,k){var a={},f={x:"0%",y:"0%",width:"100%",
height:"100%"},b={};a.createFilter=function(a,b){var c=h.mixin({},f,a);c.primitives||(c.primitives=[]);b&&Array.prototype.push.apply(c.primitives,b);return c};var e=function(a,b,c){b instanceof Array&&(c=b,b=null);b=h.mixin({},b);b.children=c;b.tag=a;return b};k.forEach("feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feFlood feGaussianBlur feImage feMorphology feOffset feSpecularLighting feTile feTurbulence feDistantLight fePointLight feSpotLight feMergeNode feFuncA feFuncR feFuncG feFuncB".split(" "),
function(b){a[b]=function(a,c){return e(b,a,c)}});a.feMerge=function(b,c){if("string"===typeof b){for(var d=[],f=0;f<arguments.length;++f)d.push(a.feMergeNode({"in":arguments[f]}));return e("feMerge",{},d)}return e("feMerge",b,c)};var l=a.createFilter;b.convolutions=[l({_gfxName:"boxBlur3"},[a.feConvolveMatrix({"in":"SourceGraphic",order:3,divisor:9,kernelMatrix:"1,1,1,1,1,1,1,1,1"})]),l({_gfxName:"boxBlur5"},[a.feConvolveMatrix({"in":"SourceGraphic",order:5,divisor:25,kernelMatrix:"1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1"})]),
l({_gfxName:"verticalEdges",filterUnits:"objectBoundingBox"},[a.feConvolveMatrix({"in":"SourceGraphic",result:"kernel",order:3,divisor:1,kernelMatrix:"-1 0 1 -1 0 1 -1 0 1"}),a.feComponentTransfer({"in":"kernel"},[a.feFuncA({type:"table",tableValues:"1,1"})])]),l({_gfxName:"horizontalEdges",filterUnits:"objectBoundingBox"},[a.feConvolveMatrix({"in":"SourceGraphic",result:"kernel",order:3,divisor:1,kernelMatrix:"1 1 1 0 0 0 -1 -1 -1"}),a.feComponentTransfer({"in":"kernel"},[a.feFuncA({type:"table",
tableValues:"1,1"})])]),l({_gfxName:"allEdges3",filterUnits:"objectBoundingBox"},[a.feConvolveMatrix({"in":"SourceGraphic",result:"kernel",order:3,divisor:1,kernelMatrix:"-1 -1 -1 -1 8 -1 -1 -1 -1"}),a.feComponentTransfer({"in":"kernel"},[a.feFuncA({type:"table",tableValues:"1,1"})])]),l({_gfxName:"edgeEnhance",filterUnits:"objectBoundingBox"},[a.feConvolveMatrix({"in":"SourceGraphic",result:"kernel",order:3,divisor:-1,kernelMatrix:"0 1 0 1 -5 1 0 1 0"}),a.feComponentTransfer({"in":"kernel"},[a.feFuncA({type:"table",
tableValues:"1,1"})])])];k.forEach(b.convolutions,function(a){h.mixin(a,f)});b.shadows=[l({_gfxName:"fastSmallDropShadow"},[a.feColorMatrix({"in":"SourceAlpha",type:"matrix",result:"grey",values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0.7,0"}),a.feOffset({dx:3,dy:3,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),l({_gfxName:"fastDropShadow"},[a.feColorMatrix({"in":"SourceAlpha",type:"matrix",result:"grey",values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0.7,0"}),
a.feOffset({dx:5,dy:5,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),l({_gfxName:"fastDropShadowLight"},[a.feColorMatrix({"in":"SourceAlpha",type:"matrix",result:"grey",values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,0.4,0"}),a.feOffset({dx:5,dy:5,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),l({_gfxName:"dropShadow"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:4}),a.feOffset({dx:5,dy:5,result:"offsetBlur"}),a.feMerge("offsetBlur",
"SourceGraphic")]),l({_gfxName:"dropShadowLight"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:4,result:"blur"}),a.feComponentTransfer({"in":"blur",result:"lessblur"},[a.feFuncA({type:"linear",slope:.5})]),a.feOffset({"in":"lessblur",dx:5,dy:5,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),l({_gfxName:"smallDropShadow"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:3}),a.feOffset({dx:2,dy:2,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")]),l({_gfxName:"smallDropShadowLight"},
[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:3,result:"blur"}),a.feComponentTransfer({"in":"blur",result:"lessblur"},[a.feFuncA({type:"linear",slope:.5})]),a.feOffset({"in":"lessblur",dx:2,dy:2,result:"offsetBlur"}),a.feMerge("offsetBlur","SourceGraphic")])];var m={x:"-10%",y:"-10%",width:"125%",height:"125%"};k.forEach(b.shadows,function(a){h.mixin(a,m)});b.blurs=[l({_gfxName:"blur1",x:"-5%",y:"-5%",width:"110%",height:"110%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:1})]),l({_gfxName:"blur2",
x:"-15%",y:"-15%",width:"130%",height:"130%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:2})]),l({_gfxName:"blur4",x:"-15%",y:"-15%",width:"130%",height:"130%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:4})]),l({_gfxName:"blur8",x:"-20%",y:"-20%",width:"140%",height:"140%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:8})]),l({_gfxName:"glow",x:"-10%",y:"-10%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceGraphic",stdDeviation:2}),a.feComponentTransfer([a.feFuncA({type:"linear",
slope:10})])])];b.colors=[l({_gfxName:"negate"},[a.feComponentTransfer([a.feFuncR({type:"table",tableValues:"1,0"}),a.feFuncG({type:"table",tableValues:"1,0"}),a.feFuncB({type:"table",tableValues:"1,0"})])]),l({_gfxName:"sepia"},[a.feColorMatrix({result:"grey",values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,1,0"}),a.feComponentTransfer({"in":"grey"},[a.feFuncR({type:"linear",slope:.5,intercept:.5}),a.feFuncB({type:"table",tableValues:"0,0"})])]),l({_gfxName:"grayscale"},
[a.feColorMatrix({values:"0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0.2125,0.7154,0.0721,0,0,0,0,0,1,0"})]),l({_gfxName:"showRed"},[a.feComponentTransfer([a.feFuncG({type:"table",tableValues:"0,0"}),a.feFuncB({type:"table",tableValues:"0,0"})])]),l({_gfxName:"showGreen"},[a.feComponentTransfer([a.feFuncR({type:"table",tableValues:"0,0"}),a.feFuncB({type:"table",tableValues:"0,0"})])]),l({_gfxName:"showBlue"},[a.feComponentTransfer([a.feFuncR({type:"table",tableValues:"0,0"}),a.feFuncG({type:"table",
tableValues:"0,0"})])]),l({_gfxName:"hueRotate60"},[a.feColorMatrix({type:"hueRotate",values:60})]),l({_gfxName:"hueRotate120"},[a.feColorMatrix({type:"hueRotate",values:120})]),l({_gfxName:"hueRotate180"},[a.feColorMatrix({type:"hueRotate",values:180})]),l({_gfxName:"hueRotate270"},[a.feColorMatrix({type:"hueRotate",values:270})])];k.forEach(b.colors,function(a){h.mixin(a,f)});b.miscs=[l({_gfxName:"thinEmbossDropShadow",x:"-5%",y:"-5%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceAlpha",
stdDeviation:1,result:"blur"}),a.feOffset({"in":"blur",dx:6,dy:6,result:"offsetBlur"}),a.feSpecularLighting({"in":"blur",surfaceScale:8,specularConstant:1,specularExponent:12,result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",result:"litPaint",k1:0,k2:1,k3:1,k4:0}),a.feMerge("offsetBlur","litPaint")]),l({_gfxName:"embossDropShadow",
x:"-5%",y:"-5%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"4",result:"blur"}),a.feOffset({"in":"blur",dx:4,dy:4,result:"offsetBlur"}),a.feSpecularLighting({"in":"blur",surfaceScale:5,specularConstant:.75,specularExponent:20,"lighting-color":"#bbbbbb",result:"specOut"},[a.fePointLight({x:-5E3,y:-1E4,z:2E4})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,
k2:1,k3:1,k4:0,result:"litPaint"}),a.feMerge("offsetBlur","litPaint")]),l({_gfxName:"largeEmbossDropShadow",x:"-20%",y:"-20%",width:"140%",height:"140%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:5,result:"blur"}),a.feOffset({"in":"blur",dx:6,dy:6,result:"offsetBlur"}),a.feSpecularLighting({"in":"blur",surfaceScale:8,specularConstant:1,specularExponent:12,result:"spec"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"spec",in2:"SourceGraphic",operator:"in",result:"specOut"}),
a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",result:"litPaint",k1:0,k2:1,k3:1,k4:0}),a.feMerge("offsetBlur","litPaint")]),l({_gfxName:"thinEmbossDropShadowLight",x:"-5%",y:"-5%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:1,result:"blur"}),a.feComponentTransfer({"in":"blur",result:"lessblur"},[a.feFuncA({type:"linear",slope:"0.5"})]),a.feOffset({"in":"lessblur",dx:"6",dy:"6",result:"offsetBlur"}),a.feSpecularLighting({"in":"lessblur",surfaceScale:8,
specularConstant:1,specularExponent:"12",result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",result:"litPaint",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0}),a.feMerge("offsetBlur","litPaint")]),l({_gfxName:"embossDropShadowLight",x:"-5%",y:"-5%",width:"120%",height:"120%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"3",result:"blur"}),a.feComponentTransfer({"in":"blur",
result:"lessblur"},[a.feFuncA({type:"linear",slope:"0.5"})]),a.feOffset({"in":"lessblur",dx:"6",dy:"6",result:"offsetBlur"}),a.feSpecularLighting({"in":"lessblur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",result:"litPaint",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0"}),a.feMerge("offsetBlur",
"litPaint")]),l({_gfxName:"largeEmbossDropShadowLight",x:"-20%",y:"-20%",width:"140%",height:"140%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"5",result:"blur"}),a.feComponentTransfer({"in":"blur",result:"lessblur"},[a.feFuncA({type:"linear",slope:"0.5"})]),a.feOffset({"in":"lessblur",dx:"6",dy:"6",result:"offsetBlur"}),a.feSpecularLighting({"in":"blur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"spec"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"spec",
in2:"SourceGraphic",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0",result:"litPaint"}),a.feMerge("offsetBlur","litPaint")]),l({_gfxName:"fuzzy",x:"-10%",y:"-10%",width:"120%",height:"120%"},[a.feTurbulence({type:"fractalNoise",baseFrequency:"0.1",numOctaves:"1",result:"turb2"}),a.feDisplacementMap({"in":"SourceGraphic",in2:"turb2",result:"turb2",scale:"20",xChannelSelector:"R",yChannelSelector:"G"})]),l({_gfxName:"veryFuzzy",
x:"-20%",y:"-20%",width:"140%",height:"140%"},[a.feTurbulence({type:"fractalNoise",baseFrequency:"0.1",numOctaves:"1",result:"turb2"}),a.feDisplacementMap({"in":"SourceGraphic",in2:"turb2",result:"turb2",scale:"35",xChannelSelector:"R",yChannelSelector:"G"})]),l({_gfxName:"melting",x:"-10%",y:"-10%",width:"120%",height:"120%"},[a.feTurbulence({type:"fractalNoise",baseFrequency:"0.1",numOctaves:"2",result:"turb"}),a.feDisplacementMap({result:"bended","in":"SourceGraphic",in2:"turb",scale:"25",xChannelSelector:"R",
yChannelSelector:"G"}),a.feGaussianBlur({"in":"bended",stdDeviation:"1",result:"bb"}),a.feComponentTransfer({"in":"bb",result:"BendedSource"},[a.feFuncA({type:"linear",slope:10,intercept:"-1"})]),a.feComponentTransfer({"in":"BendedSource",result:"BendedAlpha"},[a.feFuncR({type:"linear",slope:"0",intercept:"0"}),a.feFuncG({type:"linear",slope:"0",intercept:"0"}),a.feFuncB({type:"linear",slope:"0",intercept:"0"}),a.feFuncA({type:"linear",slope:"1",intercept:"0"})]),a.feGaussianBlur({"in":"BendedAlpha",
stdDeviation:"1",result:"blur"}),a.feSpecularLighting({"in":"blur","lighting-color":"rgb(80%, 80%, 80%)",surfaceScale:"5",specularConstant:"1",specularExponent:"10",result:"specularOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"20000"})]),a.feComposite({"in":"specularOut",in2:"BendedAlpha",operator:"in",result:"specularOut"}),a.feComposite({"in":"BendedSource",in2:"specularOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0",result:"litPaint"})]),l({_gfxName:"impressionist",x:"0%",y:"0%",width:"100%",
height:"100%"},[a.feMorphology({"in":"SourceGraphic",operator:"dilate",radius:"2"})]),l({_gfxName:"holes",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feTurbulence({type:"fractalNoise",baseFrequency:"0.1",numOctaves:"1",result:"texture"}),a.feComponentTransfer({"in":"texture",result:"holes"},[a.feFuncA({type:"discrete",tableValues:"0,1"})]),a.feComposite({"in":"SourceGraphic",in2:"holes",operator:"out"})]),l({_gfxName:"holesComplement",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feTurbulence({type:"fractalNoise",
baseFrequency:"0.1",numOctaves:"1",result:"texture"}),a.feComponentTransfer({"in":"texture",result:"holes"},[a.feFuncA({type:"discrete",tableValues:"1,0"})]),a.feComposite({"in":"SourceGraphic",in2:"holes",operator:"out"})])];b.reliefs=[l({_gfxName:"bumpIn",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feColorMatrix({"in":"SourceGraphic",type:"luminanceToAlpha",result:"lumalpha"}),a.feComponentTransfer({"in":"lumalpha",result:"invertedalpha"},[a.feFuncA({type:"table",tableValues:"1,0"})]),a.feDiffuseLighting({"in":"invertedalpha",
"lighting-color":"rgb(60%, 60%, 60%)",result:"diffuse",surfaceScale:"5"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feSpecularLighting({"in":"invertedalpha",result:"specular",surfaceScale:"5",specularExponent:"6"},[a.feDistantLight({azimuth:"135",elevation:"30"})]),a.feComposite({"in":"diffuse",in2:"specular",operator:"arithmetic",k2:"1.0",k3:"1.0"})]),l({_gfxName:"bumpOut",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feColorMatrix({"in":"SourceGraphic",type:"luminanceToAlpha",result:"lumalpha"}),
a.feDiffuseLighting({"in":"lumalpha","lighting-color":"rgb(60%, 60%, 60%)",result:"diffuse",surfaceScale:"5"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feSpecularLighting({"in":"lumalpha",result:"specular",surfaceScale:"5",specularExponent:"6"},[a.feDistantLight({azimuth:"135",elevation:"30"})]),a.feComposite({"in":"diffuse",in2:"specular",operator:"arithmetic",k2:"1.0",k3:"1.0"})]),l({_gfxName:"thinEmboss",x:"-5%",y:"-5%",width:"110%",height:"110%"},[a.feGaussianBlur({"in":"SourceAlpha",
stdDeviation:"1",result:"blur"}),a.feSpecularLighting({"in":"blur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0"})]),l({_gfxName:"emboss",x:"-5%",y:"-5%",width:"110%",height:"110%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"3",
result:"blur"}),a.feSpecularLighting({"in":"blur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0"})]),l({_gfxName:"largeEmboss",x:"-5%",y:"-5%",width:"110%",height:"110%"},[a.feGaussianBlur({"in":"SourceAlpha",stdDeviation:"5",result:"blur"}),
a.feSpecularLighting({"in":"blur",surfaceScale:"8",specularConstant:"1",specularExponent:"12",result:"specOut"},[a.fePointLight({x:"-5000",y:"-10000",z:"12000"})]),a.feComposite({"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"}),a.feComposite({"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:"0",k2:"1",k3:"1",k4:"0"})])];b.textures=[l({_gfxName:"paper",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feTurbulence({type:"turbulence",baseFrequency:"0.01",numOctaves:"5",result:"texture"}),
a.feDiffuseLighting({"in":"texture",result:"diffuse",surfaceScale:"-10"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feComposite({"in":"diffuse",in2:"SourceGraphic",operator:"arithmetic",k1:"1",k2:"0",k3:"0",k4:"0"})]),l({_gfxName:"swirl",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feTurbulence({type:"turbulence",baseFrequency:"0.05",numOctaves:"1",result:"texture"}),a.feDiffuseLighting({"in":"texture",result:"diffuse",surfaceScale:"-10"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),
a.feComposite({"in":"diffuse",in2:"SourceGraphic",operator:"arithmetic",k1:"1",k2:"0",k3:"0",k4:"0"})]),l({_gfxName:"swirl2",x:"0%",y:"0%",width:"100%",height:"100%"},[a.feTurbulence({type:"turbulence",baseFrequency:"0.15",numOctaves:"1",result:"texture"}),a.feDiffuseLighting({"in":"texture",result:"diffuse",surfaceScale:"-10"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feComposite({"in":"diffuse",in2:"SourceGraphic",operator:"arithmetic",k1:"1",k2:"0",k3:"0",k4:"0"})]),l({_gfxName:"gold",
x:"-5%",y:"-5%",width:"115%",height:"110%"},[a.feTurbulence({baseFrequency:"0.2",numOctaves:"1",type:"turbulence",result:"turb"}),a.feComposite({"in":"SourceGraphic",in2:"turb",operator:"arithmetic",k2:"0.6",k3:"0.4",result:"turb"}),a.feComposite({"in":"turb",in2:"SourceGraphic",operator:"in",result:"bump"}),a.feDiffuseLighting({"in":"turb",surfaceScale:"6.0","lighting-color":"rgb(60%, 50%, 0%)",diffuseConstant:"1.0",result:"diffuse"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feSpecularLighting({"in":"bump",
surfaceScale:"6.0",specularConstant:"1.0",specularExponent:"10.0",result:"specularOut"},[a.feDistantLight({azimuth:"135",elevation:"60"})]),a.feComposite({"in":"specularOut",in2:"SourceGraphic",operator:"in",result:"specularOut"}),a.feComposite({"in":"bump",in2:"diffuse",operator:"arithmetic",k1:"0.7",k2:"0.3",result:"litPaint"}),a.feComposite({"in":"litPaint",in2:"specularOut",operator:"arithmetic",k2:"1.0",k3:"0.7",result:"litPaint"})])];for(var g in b)if(b.hasOwnProperty(g)){a[g]={};for(var d=
b[g],c=0;c<d.length;++c)(function(){var b=d[c];a[g][b._gfxName]=function(a){return h.delegate(b,a)}})()}return a})},"dojox/gfx/svgext":function(){define(["dojo/dom","dojo/_base/array","dojo/_base/window","./_base","./svg"],function(h,k,a,f,b){function e(a,f){var d=f.ownerDocument.createElementNS(b.xmlns.svg,a.tag);f.appendChild(d);for(var c in a)c in l||d.setAttribute(c,a[c]);a.children&&k.forEach(a.children,function(a){e(a,d)});return d}a=f.svgext={};var l={primitives:null,tag:null,children:null};
b.Shape.extend({addRenderingOption:function(a,b){this.rawNode.setAttribute(a,b);return this},setFilter:function(a){if(!a)return this.rawNode.removeAttribute("filter"),this.filter=null,this;this.filter=a;a.id=a.id||f._base._getUniqueId();var g=h.byId(a.id);if(!g){g=this.rawNode.ownerDocument.createElementNS(b.xmlns.svg,"filter");g.setAttribute("filterUnits","userSpaceOnUse");for(var d in a)d in l||g.setAttribute(d,a[d]);k.forEach(a.primitives,function(a){e(a,g)});(d=this._getParentSurface())&&d.defNode.appendChild(g)}this.rawNode.setAttribute("filter",
"url(#"+a.id+")");return this},getFilter:function(){return this.filter}});return a})},"esri/dijit/Attribution":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-geometry ../kernel ../lang ../SpatialReference ../geometry/webMercatorUtils ../geometry/Extent".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w){h=h(null,{declaredClass:"esri.dijit.Attribution",
itemDelimiter:" | ",listClass:"esriAttributionList",itemClass:"esriAttributionItem",lastItemClass:"esriAttributionLastItem",delimiterClass:"esriAttributionDelim",constructor:function(a,c){try{k.mixin(this,a);this._attributions={};this._pendingDfds={};this._activeLayers=[];this._sharedLayers=[];var d=this.domNode=m.byId(c),e=this.map,h="\x3cspan class\x3d'"+this.listClass+"'\x3e\x3c/span\x3e";if(d&&(g.set(d,"innerHTML",h),this.listNode=b.query(".esriAttributionList",d)[0],this.itemNodes={}),this._eventConnections=
[f.connect(e,"onLayerAdd",this,this._onLayerAdd),f.connect(e,"onLayerRemove",this,this._onLayerRemove),f.connect(e,"onLayerSuspend",this,this._onLayerSuspend),f.connect(e,"onLayerResume",this,this._onLayerResume),f.connect(e,"onResize",this,this._adjustFocus),f.connect(e,"onExtentChange",this,this._onExtentChange)],e.loaded){var l,n,q=e.layerIds.concat(e.graphicsLayerIds),r=q.length;for(n=0;r>n;n++)l=e.getLayer(q[n]),l.loaded&&this._onLayerAdd(l)}}catch(G){}},startup:function(){},destroy:function(){a.forEach(this._eventConnections,
f.disconnect);d.destroy(this.listNode);this.map=this.domNode=this._eventConnections=this.listNode=this._attributions=this._pendingDfds=this.itemNodes=this._activeLayers=this._lastItem=this._sharedLayers=null},_onLayerAdd:function(a){try{var b=this._attributions,c=a.id;if(!r.isDefined(b[c])&&a.showAttribution)if(a.hasAttributionData){var d=a.getAttributionData();this._pendingDfds[c]=1;b[c]=d;d.addBoth(k.partial(this._onAttributionLoad,this,a))}else b[c]=a.copyright||a.copyrightText||"",b[c]?(a.suspended||
this._activeLayers.push(c),this._createNode(c)):this._onLayerRemove(a)}catch(B){}},_onAttributionLoad:function(a,b,c){var d=a._attributions,e=a._pendingDfds,f=b.id;e&&e[f]&&(delete e[f],(!c||c instanceof Error)&&(c=""),c?d[f]=a._createIndexByLevel(c,-1!==b.declaredClass.toLowerCase().indexOf("vetiledlayer")):d[f]=b.copyright||b.copyrightText||"",d[f]?(b.suspended||a._activeLayers.push(f),a._createNode(f)):a._onLayerRemove(b))},_onLayerRemove:function(b){try{var c,e=b.id,f=this.itemNodes,g=-1;this._onLayerSuspend(b);
delete this._attributions[e];delete this._pendingDfds[e];c=this._getGroupIndex(e);-1!==c&&(g=a.indexOf(this._sharedLayers[c],e),-1!==g&&(this._sharedLayers[c].splice(g,1),1>=this._sharedLayers[c].length&&this._sharedLayers.splice(c,1)));f[e]&&-1===g&&d.destroy(f[e]);delete f[e];this._updateLastItem()}catch(C){}},_onLayerSuspend:function(b){try{var c=b.id;if(this._attributions[c]){var d=a.indexOf(this._activeLayers,c),e=this.itemNodes[c];-1!==d&&this._activeLayers.splice(d,1);e&&this._toggleItem(e,
!1,this._getGroupIndex(c))}}catch(B){}},_adjustFocus:function(){var a=this.domNode.scrollWidth>this.domNode.clientWidth,b=n.contains(this.domNode,"esriAttributionOpen");g.set(this.domNode,"tabIndex",a||b?"0":"")},_onLayerResume:function(b){try{var c=b.id,d=this._attributions[c],e=this.itemNodes[c];if(d&&(-1===a.indexOf(this._activeLayers,c)&&this._activeLayers.push(c),e)){var f=k.isString(d)?d:this._getContributorsList(d,this.map.extent,this.map.getLevel());k.isString(d)||g.set(e,"innerHTML",f?f+
this._getDelimiter():"");f&&this._toggleItem(e,!0,this._getGroupIndex(c))}}catch(C){}},_onExtentChange:function(a,b,c,d){try{var e,f,h,l,m=this._activeLayers,n=this._attributions,q=this.itemNodes,r=m.length||0;for(l=0;r>l;l++)if(f=m[l],h=n[f],e=q[f],e&&!k.isString(h)){var t=this._getContributorsList(h,a,d?d.level:-1);g.set(e,"innerHTML",t?t+this._getDelimiter():"");this._toggleItem(e,!!t,-1)}}catch(M){}this._adjustCursorStyle()},_createNode:function(a){if(this.domNode){var b,c=this._checkShareInfo(a),
e=c&&c.sharedWith,e=e&&this.itemNodes[e],f=this.map,g=this._attributions[a],g=k.isString(g)?g:this._getContributorsList(g,f.extent,f.getLevel()),f=!!g&&!f.getLayer(a).suspended;e?(this.itemNodes[a]=e,this._toggleItem(e,f,c.index)):(b=this.itemNodes[a]=d.create("span",{"class":this.itemClass,innerHTML:g?g+this._getDelimiter():"",style:{display:f?"inline":"none"}},this.listNode),f&&this._setLastItem(b));this._adjustCursorStyle()}},_checkShareInfo:function(b){var c,d,e,f=this._attributions,g=-1,h=f[b];
if(h&&k.isString(h)){for(d in f)if(c=f[d],d!==b&&c&&k.isString(c)&&c.length===h.length&&c.toLowerCase()===h.toLowerCase()){e=d;break}var l;c=this._sharedLayers;f=c.length;if(e){for(d=0;f>d;d++)if(l=c[d],-1!==a.indexOf(l,e)){g=d;l.push(b);break}-1===g&&(g=c.push([e,b])-1)}}return-1<g?{index:g,sharedWith:e}:null},_getGroupIndex:function(b){var c,d=this._sharedLayers,e=d.length,f=-1;for(c=0;e>c;c++)if(-1!==a.indexOf(d[c],b)){f=c;break}return f},_getDelimiter:function(){var a=this.itemDelimiter;return a?
"\x3cspan class\x3d'"+this.delimiterClass+"'\x3e"+a+"\x3c/span\x3e":""},_toggleItem:function(b,d,e){if(-1<e&&!d){var f=this._sharedLayers[e],g=f.length,h=this._activeLayers;for(e=0;g>e;e++)if(-1!==a.indexOf(h,f[e]))return}c.set(b,"display",d?"inline":"none");this._updateLastItem()},_updateLastItem:function(){var a,b,d=this.listNode.childNodes;if(a=d.length)for(--a;0<=a;a--)if(b=d[a],"none"!==c.get(b,"display")){this._setLastItem(b);break}this._adjustCursorStyle()},_setLastItem:function(a){var b=this.itemClass,
c=this.lastItemClass;this._lastItem&&n.replace(this._lastItem,b,c);a&&(n.replace(a,c,b),this._lastItem=a)},_createIndexByLevel:function(a,b){var c,d,e,f,g,h,l,k=a.contributors,m=k?k.length:0,n=new v(4326),q={};for(f=0;m>f;f++)for(c=k[f],h=(d=c.coverageAreas)?d.length:0,g=0;h>g;g++)for(e=d[g],l=e.bbox,l={extent:u.geographicToWebMercator(new w(l[1],l[0],l[3],l[2],n)),attribution:c.attribution||"",zoomMin:e.zoomMin-(b&&e.zoomMin?1:0),zoomMax:e.zoomMax-(b&&e.zoomMax?1:0),score:r.isDefined(e.score)?e.score:
100,objectId:f},e=l.zoomMin;e<=l.zoomMax;e++)q[e]=q[e]||[],q[e].push(l);return q},_getContributorsList:function(a,b,c){var d="";if(b&&r.isDefined(c)&&-1<c){a=a[c];var d=b.getCenter().normalize(),e=a?a.length:0,f=[],g={};for(c=0;e>c;c++)b=a[c],!g[b.objectId]&&b.extent.contains(d)&&(g[b.objectId]=1,f.push(b));f.sort(function(a,b){return b.score-a.score||a.objectId-b.objectId});e=f.length;for(c=0;e>c;c++)f[c]=f[c].attribution;d=f.join(", ")}return d},_adjustCursorStyle:function(){var a=q.position(this.listNode.parentNode,
!0).h;n.contains(this.listNode.parentNode,"esriAttributionOpen")?(n.remove(this.listNode.parentNode,"esriAttributionOpen"),a>q.position(this.listNode.parentNode,!0).h?(c.set(this.listNode.parentNode,"cursor","pointer"),n.add(this.listNode.parentNode,"esriAttributionOpen")):c.set(this.listNode.parentNode,"cursor","default")):(n.add(this.listNode.parentNode,"esriAttributionOpen"),a<q.position(this.listNode.parentNode,!0).h?c.set(this.listNode.parentNode,"cursor","pointer"):c.set(this.listNode.parentNode,
"cursor","default"),n.remove(this.listNode.parentNode,"esriAttributionOpen"));this._adjustFocus()}});return e("extend-esri")&&k.setObject("dijit.Attribution",h,t),h})},"esri/layers/VectorTileLayerImpl":function(){define("dojo/_base/lang dojo/has dojo/dom-construct dojo/dom-style dojo/io-query ../geometry/Extent ../geometry/screenUtils ../geometry/scaleUtils ../SpatialReference ../config ../lang ../domUtils ../urlUtils ../kernel ./layer ./TileInfo ./unitBezier ./vectorTiles/request ./vectorTiles/core/promiseUtils ./vectorTiles/core/urlUtils ./vectorTiles/layers/support/vectorTileLayerLoader ./vectorTiles/views/vectorTiles/style/StyleRepository ./vectorTiles/views/vectorTiles/VectorTileContainer ./vectorTiles/views/vectorTiles/TileHandler ./vectorTiles/views/2d/engine/StageGL ./vectorTiles/views/2d/FrameBudget ./vectorTiles/views/2d/layers/support/TileInfoView ./vectorTiles/views/2d/layers/support/TileStrategy ./vectorTiles/views/2d/layers/support/TileKey ./vectorTiles/views/webgl/webgl-utils".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J){var L=u.ease;l=r.createSubclass({declaredClass:"esri.layers.VectorTileLayer",_mapsWithAttribution:["World_Basemap"],_eventMap:{"style-change":["style"]},constructor:function(a,b){this._frame=this._frame.bind(this);this._params=b||{};b&&b.tileServers&&b.tileServers.length&&(this.tileServers=b.tileServers=b.tileServers.map(function(a){return q.getAbsoluteUrl(a)},this));this._viewState={scale:0,width:0,height:0,size:[0,0],rotation:0,
resolution:1,center:[0,0],toScreen:function(a,b){var c=this.center[1]+this.resolution*this.height*.5;return a[0]=(b[0]-(this.center[0]-this.resolution*this.width*.5))/this.resolution,a[1]=(c-b[1])/this.resolution,a},toMap:function(a,b){var c=this.center[1]+this.resolution*this.height*.5;return a[0]=this.center[0]-this.resolution*this.width*.5+b[0]*this.resolution,a[1]=c-b[1]*this.resolution,a}};this._budget=new E(6);this._renderParameters={budget:this._budget,state:this._viewState,devicePixelRatio:window.devicePixelRatio,
stationary:!0};this._updateParameters={budget:this._budget,state:this._viewState,devicePixelRatio:window.devicePixelRatio,stationary:!0};this.setStyle(a);this.registerConnectEvents()},setStyle:function(a){return this.loadStyle(a)},getStyle:function(){return this.currentStyleInfo&&this.currentStyleInfo.style||null},opacity:1,setOpacity:function(a){this.opacity!=a&&this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_pinching:!1,_refreshTS:null,_reCheckTS:/[\?\&]_ts=/gi,_reReplaceTS:/([\?\&]_ts=)[0-9]+/gi,
addTimestampToURL:function(a){var b=this._refreshTS;return b&&(this._reCheckTS.test(a)?a=a.replace(this._reReplaceTS,"$$$1"+b):a+=(-1===a.indexOf("?")?"?":"\x26")+"_ts\x3d"+b),a},getTileUrl:function(a,c,d){var e=this._getToken(),f=this._url&&this._url.query,g=this.tileServers[c%this.tileServers.length];return g=g.replace(/\{z\}/gi,a.toString()).replace(/\{level\}/gi,a.toString()).replace(/\{y\}/gi,c.toString()).replace(/\{row\}/gi,c.toString()).replace(/\{x\}/gi,d.toString()).replace(/\{col\}/gi,
d.toString()),f&&(g+="?"+b.objectToQuery(f)),!e||f&&f.token||(g+=(-1===g.indexOf("?")?"?":"\x26")+"token\x3d"+e),g=this.addTimestampToURL(g),q.addProxy(g)},loadStyle:function(a){if(this._loadingPromise&&"string"==typeof a&&this.url===a)return this._loadingPromise;this._stopDisplay();var b=this._loadingPromise;return this._loadingPromise=A.loadMetadata(a).then(function(a){this.url=a.url;this._url=a.parsedUrl;this.currentStyleInfo={serviceUrl:a.serviceUrl,styleUrl:a.styleUrl,style:a.style,layerDefinition:a.layerDefinition};
this.styleRepository=new z(a.style,a);this._read(a.layerDefinition);this.onStyleChange(this.getStyle())}.bind(this)).then(function(){this.loaded||(this.loaded=!0,this.onLoad(this));this.suspended||this._tileHandler||this._startDisplay()}.bind(this)).otherwise(function(a){throw this._errorHandler(a),a;}.bind(this)),b&&!b.isFulfilled()&&b.cancel(),this._loadingPromise},refresh:function(){this.suspended||(this._refreshTS=Date.now(),this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD))},
takeScreenshot:function(a){return this._stageGL?this._stageGL.takeScreenshot(a):x.reject("No valid GL context!")},_setMap:function(b,c,d){this.inherited(arguments);this._map=b;var e=this._div=a.create("div",null,c);if(f.set(e,{position:"absolute",width:b.width+"px",height:b.height+"px",overflow:"visible",opacity:this.opacity}),this._onResizeHandle=b.on("resize",h.hitch(this,this._onResizeHandler)),this._onOpacityHandle=this.on("opacity-change",h.hitch(this,this._opacityChangeHandler)),this._onScaleVisHandle=
this.on("scale-visibility-change",h.hitch(this,function(){})),this._onVisibilityHandle=this.on("visibility-change",h.hitch(this,function(){})),this._stageGL=new D,this._stageGL.setElement(this._stageGL.createElement()),this._div.appendChild(this._stageGL.element),this._stageGL.parent={requestChildRender:this._scheduleRender.bind(this)},this._stageGL.attach(this._renderParameters),this._startDisplay(),this.evaluateSuspension(),this.suspended&&!b.loaded)var g=b.on("load",h.hitch(this,function(){g.remove();
this.evaluateSuspension()}));return e},_unsetMap:function(b,c){this._map=null;this.suspended||this._stopDisplay();this._stageGL.detach(this._renderParameters);this._stageGL=null;a.destroy(this._div);this._div=null;this._handles&&this._handles.forEach(function(a){a.remove()});this._handles=null;this._onResizeHandle=this._onResizeHandle&&this._onResizeHandle.remove()&&null;this._onOpacityHandle=this._onOpacityHandle&&this._onOpacityHandle.remove()&&null;this._onScaleVisHandle=this._onScaleVisHandle&&
this._onScaleVisHandle.remove()&&null;this._onVisibilityHandle=this._onVisibilityHandle&&this._onVisibilityHandle.remove()&&null;this.inherited(arguments)},_read:function(a){this.version=a.currentVersion||a.version;this.fullExtent=new e(a.fullExtent);this.initialExtent=new e(a.initialExtent);this.spatialReference=this.fullExtent.spatialReference;this.tileInfo=new v(a.tileInfo);this.tileInfo.size=[this.tileInfo.cols,this.tileInfo.height];this.tileInfo.spatialReference.isWrappable=this.tileInfo.spatialReference._isWrappable();
this.tileInfo.scales=this.tileInfo.lods.map(function(a){return a.scale});this.tileInfo.scaleToZoom=function(a){for(var b=this.scales,c=b.length-1,d=0;c>d;d++){var e=b[d],f=b[d+1];if(a>=e)break;if(f===a)return d+1;if(e>a&&a>f)return d+1-(a-f)/(e-f)}return d};this._hasMin||this.setMinScale(a.minScale);this._hasMax||this.setMaxScale(a.maxScale);a.tileMap&&(this.tileIndexUrl=y.join(this.currentStyleInfo.serviceUrl,a.tileMap));this._params.tileServers||(this.currentStyleInfo.serviceUrl?this.tileServers=
a.tiles.map(function(a,b,c){return y.join(this.currentStyleInfo.serviceUrl,a)},this):this.tileServers=a.tiles);a=null;this.currentStyleInfo.serviceUrl&&(a=y.urlToObject(this.currentStyleInfo.serviceUrl),a=this._getDefaultAttribution(a.path));a?(this.attributionDataUrl=a,this.hasAttributionData=!0):(this.attributionDataUrl=null,this.hasAttributionData=!1)},_getDefaultAttribution:function(a){var b=a.match(/^https?:\/\/(basemaps|basemapsbeta)\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);
if(b&&(a=b[3])){var c,b=b[2]||"";a=a.toLowerCase();for(var d=0,e=this._mapsWithAttribution.length;e>d;d++)if(c=this._mapsWithAttribution[d],-1<c.toLowerCase().indexOf(a))return a=window.location.protocol,("http:"===a||"https:"===a?a:"https:")+"//static.arcgis.com/attribution/Vector"+b+"/"+c}},_startDisplay:function(){var a={styleRepository:this.styleRepository,tileIndexUrl:this.tileIndexUrl,tileInfo:this.tileInfo,fullExtent:{width:this.fullExtent.getWidth()},getTileUrl:this.getTileUrl.bind(this)};
this._renderParameters.devicePixelRatio=this._updateParameters.devicePixelRatio=window.devicePixelRatio;this._vectorTileContainer=new B;this._stageGL.addChild(this._vectorTileContainer);this._tileHandler=new C(a,this._scheduleUpdate.bind(this));this._tileInfoView=new F(this.tileInfo,this.fullExtent);this._tileHandler.updateTile.bind(this._tileHandler);this._tileHandler.start().then(function(){this._tileStrategy=new G({container:{addTile:this._vectorTileContainer.addChild.bind(this._vectorTileContainer),
removeTile:this._vectorTileContainer.removeChild.bind(this._vectorTileContainer),removeAllTiles:this._vectorTileContainer.removeAllChildren.bind(this._vectorTileContainer)},tileInfoView:this._tileInfoView,requestUpdate:this._scheduleUpdate.bind(this),fetchTile:function(a,b){return this._tileHandler.getVectorTile(I.from(a),b)}.bind(this)});this._vectorTileContainer.initialize(this._tileHandler.spriteMosaic,this._tileHandler.glyphMosaic,this.tileInfo,this._tileInfoView);this._scheduleUpdate()}.bind(this))},
_stopDisplay:function(){this._tileStrategy&&(this._renderRequested=!1,this._updateRequested=!1,this._frameRequested=!1,this._animation&&(this._animation.stop(),this._animation=null),this._vectorTileContainer.removeAllChildren(),this._stageGL.removeChild(this._vectorTileContainer),this._vectorTileContainer=null,this._tileHandler.stop(),this._tileHandler.destroy(),this._tileStrategy.destroy(),this._tileInfoView=this._tileHandler=this._tileStrategy=null)},_scheduleRender:function(){this._renderRequested=
!0;this._map&&this._tileStrategy&&this._scheduleFrame()},_scheduleUpdate:function(){this._updateRequested=!0;this._map&&this._tileStrategy&&this._scheduleFrame()},_scheduleFrame:function(){this._map&&(this._frameRequested||(this._frameRequested=!0,P(this._frame)))},_frame:function(){if(this._frameRequested){this._frameRequested=!1;this._renderParameters.devicePixelRatio!==window.devicePixelRatio&&(this._renderParameters.devicePixelRatio=this._updateParameters.devicePixelRatio=window.devicePixelRatio,
this._stopDisplay(),this._startDisplay());this._animation&&(this._animation.step(),this._animation.running||(this._animation=null));if(this._updateParameters.stationary=this._renderParameters.stationary=!this._animation&&!this._pinching&&!this._panning,this._budget.reset(),this._viewState.resolution=this._viewState.scale/(39.37*m.getUnitValueForSR(this.spatialReference)*96),this._renderRequested&&(this._renderRequested=!1,this._stageGL.render(this._renderParameters)),this._updateRequested){this._updateRequested=
!1;var a=this._tileHandler.updateTile.bind(this._tileHandler);this._tileStrategy.updateTiles(a,this._updateParameters);this._tileStrategy.update(this._updateParameters)}this._animation&&(this._scheduleRender(),this._scheduleUpdate())}},_setViewState:function(a){a=h.mixin(this._viewState,a);a.center.type&&(a.center=[a.center.x,a.center.y]);this._scheduleRender();this._scheduleUpdate()},_animateViewState:function(a,b){var c=b.immediate||0===d.defaults.map.zoomDuration;if(this._animation=null,c)return void this._setViewState(a);
var c=this._viewState,e=d.defaults.map.zoomDuration,f=H()+16,g=c.center[0],h=c.center[1],l=c.scale,k=Array.isArray(a.center)?a.center[0]:a.center.x,m=Array.isArray(a.center)?a.center[1]:a.center.y,n=a.scale||c.scale,q=this;this._animation={running:!0,stop:function(){this.running=!1},step:function(){if(this.running){var a=(H()+16-f)/e;1<=a&&(a=1,this.running=!1);a=L(a);q._setViewState({center:[g+(k-g)*a,h+(m-h)*a],scale:l+(n-l)*a})}}};this._scheduleRender();this._scheduleUpdate()},onStyleChange:function(a){},
_opacityChangeHandler:function(a){this._div&&(this._div.style.opacity=a.opacity)},_onResizeHandler:function(a){var b=this._div&&this._div.style;b&&(b.width=a.width+"px",b.height=a.height+"px",this._map,this._setViewState({center:a.extent.getCenter(),width:a.width,height:a.height,size:[a.width,a.height]}))},onResume:function(){var a=this._map;this.inherited(arguments);n.show(this._div);this._setViewState({center:a.extent.getCenter(),scale:a.getScale(),width:a.width,height:a.height,size:[a.width,a.height]});
this._handles=[a.on("pan-end",h.hitch(this,this._onPanEndHandler)),a.on("pan",h.hitch(this,this._onPanExtentChangeHandler)),a.on("extent-change",h.hitch(this,this._onExtentChangeHandler)),a.on("scale",h.hitch(this,this._onScaleHandler))]},onSuspend:function(){this.inherited(arguments);n.hide(this._div);this._handles.forEach(function(a){a.remove()});this._handles=null},_onPanEndHandler:function(a){this._panning=!1;this._setViewState({center:a.extent.getCenter(),scale:this._map.getScale()})},_onPanExtentChangeHandler:function(a){this._panning=
!0;this._animation&&(this._animation.stop(),this._animation=null);this._setViewState({center:a.extent.getCenter(),scale:this._map.getScale()})},_onExtentChangeHandler:function(a){var b=this._pinching||a.immediate;this._animateViewState({center:a.extent.getCenter(),scale:a.lod.scale},{immediate:b});this._pinching=!1},_onScaleHandler:function(a){this._animation&&(this._animation.stop(),this._animation=null);var b=this._map;if(b._zoomAnimDiv.extent)return this._panning=!1,this._pinching=!1,void this._animateViewState({center:b._zoomAnimDiv.extent.getCenter(),
scale:b._zoomAnimDiv.newLod.scale},{immediate:a.immediate});var c,d,e,f,g;a=b.navigationManager;var h=a._dragOrigin,l=b.extent.getCenter(),k=h.x-.5*b.width,h=h.y-.5*b.height,m=b.extent.getWidth()/b.width;a._pinchScale?(this._pinching=!0,c=a._pinchScale,d=m/c,e=k*(d-m),f=h*(d-m),l.x-=e,l.y+=f,g=b.__LOD.scale/c,this._setViewState({center:l,scale:g})):a._zoomEndExtent&&(this._pinching=!1,c=b.getScale()/b.navigationManager._zoomEndLod.scale,d=m/c,e=k*(d-m),f=h*(d-m),l.x-=e,l.y+=f,g=b.navigationManager._zoomEndLod.scale,
this._animateViewState({center:l,scale:g},{immediate:!1}))}});l.ACCESS_TOKEN=null;l.supported=function(){return J.detectWebGL()[0]};var M,H=function(){var a,b=window.performance||{},c=b.now||b.webkitNow||b.msNow||b.oNow||b.mozNow;return void 0!==c?function(){return c.call(b)}:(a=window.performance&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.timing.navigationStart:(new Date).getTime(),function(){return(new Date).getTime()-a})}();g=k("ff");c=k("ie");t=k("webkit");
k=k("opera");var K=(new Date).getTime(),P=window.requestAnimationFrame;return P||(M=t&&"webkit"||g&&"moz"||k&&"o"||c&&"ms",P=window[M+"RequestAnimationFrame"],P||(P=function(a){var b=H(),c=Math.max(0,16-(b-K)),d=window.setTimeout(function(){a(H())},c);return K=b+c,d})),l})},"esri/layers/unitBezier":function(){define([],function(){var h=function(a,f,b,e){function h(a,b){var c,e,f,h,l;b=null==b?1E-6:b;f=a;for(l=0;8>l;l++){if(h=((d*f+g)*f+k)*f-a,Math.abs(h)<b)return f;if(e=(3*d*f+2*g)*f+k,1E-6>Math.abs(e))break;
f-=h/e}if(c=0,e=1,f=a,c>f)return c;if(f>e)return e;for(;e>c&&!(h=((d*f+g)*f+k)*f,Math.abs(h-a)<b);)a>h?c=f:e=f,f=.5*(e-c)+c;return f}var k=3*a,g=3*(b-a)-k,d=1-k-g,c=3*f,n=3*(e-f)-c,q=1-c-n;return function(a,b){var d=h(a,b);return((q*d+n)*d+c)*d}},k=/^cubic-bezier\((.*)\)/;return h.parse=function(a){var f=h[a]||null;!f&&(a=k.exec(a))&&(a=a[1].split(",").map(function(a){return parseFloat(a.trim())}),4!==a.length||a.some(function(a){return isNaN(a)})||(f=h.apply(h,a)));return f},h.ease=h(.25,.1,.25,
1),h.linear=h(0,0,1,1),h.easeIn=h["ease-in"]=h(.42,0,1,1),h.easeOut=h["ease-out"]=h(0,0,.58,1),h.easeInOut=h["ease-in-out"]=h(.42,0,.58,1),h})},"esri/layers/vectorTiles/request":function(){define(["require","exports","esri/request","dojo/_base/lang"],function(h,k,a,f){return function(b,e){var h=f.mixin({},{url:b,failOk:!0},e);return"array-buffer"===e.responseType?(h.handleAs="arraybuffer",delete h.responseType):e.responseType&&(h.handleAs=e.responseType,delete h.responseType),null!==e.query&&(h.content=
h.query,delete h.query),a(h).then(function(a){return{data:a}})}})},"esri/layers/vectorTiles/core/promiseUtils":function(){define(["require","exports","dojo/Deferred","./Error"],function(h,k,a,f){function b(e){if(e){if("function"!=typeof e.forEach){var f=Object.keys(e),h=f.map(function(a){return e[a]});return b(h).then(function(a){var b={};return f.forEach(function(c,d){return b[c]=a[d]}),b})}var g=new a,d=[],c=e.length;return 0===c&&g.resolve(d),e.forEach(function(a){var b={promise:a};d.push(b);a.then(function(a){b.value=
a}).otherwise(function(a){b.error=a}).then(function(){--c;0===c&&g.resolve(d)})}),g.promise}}k.eachAlways=b;k.create=function(b){var e=new a;return b(function(a){return void 0===a&&(a=null),e.resolve(a)},e.reject),e.promise};k.reject=function(b){var e=new a;return e.reject(b),e.promise};k.resolve=function(b){void 0===b&&(b=null);var e=new a;return e.resolve(b),e.promise};k.after=function(b,f){void 0===f&&(f=null);var e=0,g=new a(function(){e&&(clearTimeout(e),e=0)});return e=setTimeout(function(){g.resolve(f)},
b),g.promise};k.timeout=function(b,h,k){var e=0,d=new a(b.cancel);return b.then(function(a){d.isFulfilled()||(d.resolve(a),e&&(clearTimeout(e),e=0))}),b.otherwise(function(a){d.isFulfilled()||(d.reject(a),e&&(clearTimeout(e),e=0))}),e=setTimeout(function(){var a=k||new f("promiseUtils:timeout","The wrapped promise did not resolve within "+h+" ms");d.reject(a)},h),d.promise};k.wrapCallback=function(b){var e=!1,f=new a(function(){return e=!0});return b(function(a){e||f.resolve(a)}),f.promise}})},"esri/layers/vectorTiles/core/Error":function(){define(["require",
"exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","./Message"],function(h,k,a,f,b){h=function(b){function e(a,f,d){var c=b.call(this,a,f,d)||this;return c instanceof e?c:new e(a,f,d)}return a(e,b),e}(b);return h.prototype.type="error",h})},"esri/layers/vectorTiles/core/tsSupport/extendsHelper":function(){define([],function(){return function(h,k){function a(){this.constructor=h}for(var f in k)k.hasOwnProperty(f)&&(h[f]=k[f]);h.prototype=null===k?Object.create(k):(a.prototype=k.prototype,
new a)}})},"esri/layers/vectorTiles/core/tsSupport/decorateHelper":function(){define([],function(){return function(h,k,a,f){var b,e=arguments.length,l=3>e?k:null===f?f=Object.getOwnPropertyDescriptor(k,a):f;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(h,k,a,f);else for(var m=h.length-1;0<=m;m--)(b=h[m])&&(l=(3>e?b(l):3<e?b(k,a,l):b(k,a))||l);return 3<e&&l&&Object.defineProperty(k,a,l),l}})},"esri/layers/vectorTiles/core/Message":function(){define(["require",
"exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","dojo/string"],function(h,k,a,f,b){return function(){function a(e,f,g){this instanceof a&&(this.name=e,this.message=f&&b.substitute(f,g,function(a){return null==a?"":a})||"",this.details=g)}return a.prototype.toString=function(){return"["+this.name+"]: "+this.message},a}()})},"esri/layers/vectorTiles/core/urlUtils":function(){define(["require","exports","esri/urlUtils","dojo/_base/url"],function(h,k,a,f){function b(a){return e(a)||
c.test(a)}function e(a){return a&&"/"===a[0]&&"/"===a[1]}function l(a){return"string"==typeof a?new f(m(a)):(a.scheme||(a.scheme=k.appUrl.scheme),a)}function m(a,b){void 0===b&&(b=k.appBaseUrl);var d;if(e(a))d="file"===k.appUrl.scheme?"https:"+a:k.appUrl.scheme+":"+a;else if(c.test(a))d=a;else{d=g;var f;if("/"===a[0]){f=b;var h=f.indexOf("//"),h=f.indexOf("/",h+2);f=-1===h?f:f.slice(0,h)}else f=b;d=d(f,a)}return d}function g(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];if(a&&a.length){c=
[];if(b(a[0])){var e=a[0],f=e.indexOf("//");c.push(e.slice(0,f+1));d.test(a[0])&&(c[0]+="/");a[0]=e.slice(f+2)}else"/"===a[0][0]&&c.push("");a=a.reduce(function(a,b){return a.concat(b.split("/"))},[]);for(e=0;e<a.length;e++)f=a[e],".."===f&&0<c.length?c.pop():!f||"."===f&&0!==c.length||c.push(f);return c.join("/")}}k.normalize=function(b){return a.normalize(b)};k.canUseXhr=function(b){return a.canUseXhr(b)};h=Function("return this")();k.appUrl=new f(h.location);k.appBaseUrl=function(){var a=k.appUrl.path,
a=a.substring(0,a.lastIndexOf(a.split("/")[a.split("/").length-1]));return""+(k.appUrl.scheme+"://"+k.appUrl.host+(null!=k.appUrl.port?":"+k.appUrl.port:""))+a}();var d=/^\s*file:/i,c=/^\s*[a-z][a-z0-9-+.]*:[^0-9]/i;k.isAbsolute=b;k.urlToObject=function(b){return a.urlToObject(b)};k.getOrigin=function(a){if("data:"===a.slice(0,5))return null;var b=a.indexOf("://");if(-1===b&&e(a))b=2;else{if(-1===b)return null;b+=3}b=a.indexOf("/",b);return-1===b?a:a.slice(0,b)};k.makeAbsolute=m;k.hasSameOrigin=function(a,
b,c){void 0===c&&(c=!1);a=l(a);b=l(b);return c||a.scheme===b.scheme?a.host.toLowerCase()===b.host.toLowerCase()&&a.port===b.port:!1};k.join=g})},"esri/layers/vectorTiles/layers/support/vectorTileLayerLoader":function(){define("require exports dojo/has dojo/_base/lang ../../core/promiseUtils ../../core/urlUtils ../../config ../../request".split(" "),function(h,k,a,f,b,e,l,m){function g(a){if(a){var b=e.getOrigin(a);return e.canUseXhr(b)||-1!==v.indexOf(b)||v.push(b),a}}function d(a,b,d){if(null!=b.sources){d&&
-1!==d.path.indexOf("root.json")&&(d.path=d.path.substr(0,d.path.indexOf("root.json")),a.styleUrl=d.path);var f=q(b,d),g=b.sprite,h=b.glyphs;f&&f.url&&(f=d&&d.path?d.path:f.url,b.sprite&&!e.isAbsolute(b.sprite)&&(g=e.join(f,b.sprite)),b.glyphs&&!e.isAbsolute(b.glyphs)&&(h=e.join(f,b.glyphs)));return a.style=b,a.spriteUrl=g,a.glyphsUrl=h,n(a,b,d)}return b.hasOwnProperty("tileInfo")?(a.layerDefinition=b,a.serviceUrl=d.path,c(a,b,d)):void 0}function c(a,b,c){if(r&&!b.hasOwnProperty("defaultStyles"))throw Error("Service definition must have 'defaultStyles' element!");
b=b.defaultStyles;return e.isAbsolute(b)?a.styleUrl=e.normalize(b):a.styleUrl=e.normalize(e.join(c.path,b)),g(a.styleUrl),m(e.join(a.styleUrl,"root.json"),{responseType:"json"}).then(function(b){var c=b.data.sprite,d=b.data.glyphs;return c&&!e.isAbsolute(c)&&(c=e.join(a.styleUrl,c)),d&&!e.isAbsolute(d)&&(d=e.join(a.styleUrl,d)),a.spriteUrl=c,a.glyphsUrl=d,a.style=b.data,b.data})}function n(a,c,d){c=q(c,d);return c||b.reject("Source isn't available in the syle object!"),c.url?(a.serviceUrl=c.url,e.isAbsolute(a.serviceUrl)||
(a.serviceUrl=e.join(d.path,a.serviceUrl)),g(a.serviceUrl),m(a.serviceUrl,{query:{f:"json"},responseType:"json"}).then(function(b){return a.layerDefinition=t(b.data),a})):(a.layerDefinition=t(c),b.resolve(a))}function q(a,b){if(!a.sources)return null;var c=a.sources,d=null;if(c.esri){if(d=c.esri,b&&d.url&&!e.isAbsolute(d.url))c=b.path.substring(0,b.path.lastIndexOf("/")),d.url=e.join(c,d.url)}else{for(var f=0,g=Object.keys(c);f<g.length;f++){var h=g[f];if(-1!==h.toLocaleLowerCase().indexOf("street")&&
"vector"===d.type){d=c[h];break}}if(!d)for(f=0,g=Object.keys(c);f<g.length&&(h=g[f],d=c[h],"vector"!==d.type);f++);}return d}function t(a){if(a.hasOwnProperty("tileInfo"))return a;for(var b={xmin:-2.0037507067161843E7,ymin:-2.0037507067161843E7,xmax:2.0037507067161843E7,ymax:2.0037507067161843E7,spatialReference:{wkid:102100}},c=(b.xmax-b.xmin)/512,d=[],e=a.hasOwnProperty("minzoom")?parseFloat(a.minzoom):0,f=a.hasOwnProperty("maxzoom")?parseFloat(a.maxzoom):16;f>e;e++){var h=c/Math.pow(2,e);d.push({level:e,
scale:Math.floor(3779.527559055118*h),resolution:h})}return a.tiles.forEach(g),{capabilities:"TilesOnly",initialExtent:b,fullExtent:b,minScale:d[0].scale,maxScale:d[d.length-1].scale,tiles:a.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-2.0037508342787E7,y:2.0037508342787E7},lods:d,spatialReference:{wkid:102100}}}}var r=a("dojo-debug-messages"),v=l.defaults&&l.defaults.io.corsEnabledServers||l.request.corsEnabledServers;k.loadMetadata=function(a){if(!a)return b.reject("invalid input URL!");
var c={layerDefinition:null,parsedUrl:null,serviceUrl:null,style:null,styleUrl:null,url:null,spriteUrl:null,glyphsUrl:null};if("string"!=typeof a)return d(c,a,null).then(function(){return c});a=c.url=e.normalize(a);var h=c.parsedUrl=e.urlToObject(a);return g(a),m(h.path,{responseType:"json",query:f.mixin({f:"json"},h.query)}).then(function(a){return d(c,a.data,h)}).then(function(){return c})}})},"esri/layers/vectorTiles/config":function(){define(["require","exports","esri/config"],function(h,k,a){return Object.defineProperty(a,
"workers",{get:function(){return a.defaults.workers},set:function(f){return a.defaults.workers=f}}),a})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleRepository":function(){define(["require","exports","./StyleLayer"],function(h,k,a){return function(){function f(a,e){this.styleJSON=a;this.version=parseFloat(a.version);this.sprite=e?e.spriteUrl:a.sprite;this.glyphs=e?e.glyphsUrl:a.glyphs;this.layers=(a.layers||[]).map(f._create);this._identifyRefLayers()}return f.prototype._identifyRefLayers=
function(){for(var a=[],e=[],f=0,h=this.layers;f<h.length;f++){var g=h[f];if(1===g.type){var d=g.sourceLayer,d=d+("|"+JSON.stringify(g.minzoom)),d=d+("|"+JSON.stringify(g.maxzoom)),d=d+("|"+JSON.stringify(g.filter));a.push({key:d,layer:g})}2===g.type&&(d=g.sourceLayer,d+="|"+JSON.stringify(g.minzoom),d+="|"+JSON.stringify(g.maxzoom),d+="|"+JSON.stringify(g.filter),d+="|"+JSON.stringify(g.layout["line-cap"]),d+="|"+JSON.stringify(g.layout["line-join"]),e.push({key:d,layer:g}))}this._assignRefLayers(a);
this._assignRefLayers(e)},f.prototype._assignRefLayers=function(a){a.sort(function(a,b){return a.key<b.key?-1:a.key>b.key?1:0});for(var b,f,h=a.length,g=0;h>g;g++){var d=a[g];if(d.key===b)d.layer.refLayerId=f;else if(b=d.key,f=d.layer.id,1===d.layer.type&&!d.layer.hasPaintProperty("fill-outline-color"))for(var c=g+1;h>c;c++){var k=a[c];if(k.key!==b)break;if(k.layer.hasPaintProperty("fill-outline-color")){a[g]=k;a[c]=d;f=k.layer.id;break}}}},f._create=function(b,e,f){e=1-1/(f.length+1)*(1+e);switch(b.type){case "background":return new a.StyleLayer(0,
b,e);case "fill":return new a.StyleLayer(1,b,e);case "line":return new a.StyleLayer(2,b,e);case "symbol":return new a.StyleLayer(3,b,e);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":throw Error("Unsupported vector tile circle layer");}throw Error("Unknown vector tile layer");},f}()})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleLayer":function(){define(["require","exports","./StyleDefinition","./StyleProperty","./Filter"],function(h,k,a,f,b){h=function(){function e(b,
e,f){switch(this.type=b,this.id=e.id,this.source=e.source,this.sourceLayer=e["source-layer"],this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,this.filter=e.filter,this.layout=e.layout,this.paint=e.paint,this.z=f,b){case 0:this._layoutDefinition=a.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=a.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=a.StyleDefinition.fillLayoutDefinition;this._paintDefinition=a.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=
a.StyleDefinition.lineLayoutDefinition;this._paintDefinition=a.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=a.StyleDefinition.symbolLayoutDefinition,this._paintDefinition=a.StyleDefinition.symbolPaintDefinition}this._layoutProperties=this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}return e.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=b.createFilter(this.filter)},e.prototype.hasLayoutProperty=
function(a){var b=this._layoutProperties;return b&&b[a]?!0:!1},e.prototype.hasPaintProperty=function(a){var b=this._paintProperties;return b?void 0!==b[a]:!1},e.prototype.getLayoutValue=function(a,b){var e,d=this._layoutProperties;d&&(d=d[a])&&(e=d.getValue(b));d=this._layoutDefinition[a];return void 0===e&&(e=d["default"]),"enum"===d.type&&(e=d.values.indexOf(e)),e},e.prototype.getPaintValue=function(a,b){var e,d=this._paintProperties;d&&(d=d[a])&&(e=d.getValue(b));d=this._paintDefinition[a];return void 0===
e&&(e=d["default"]),"enum"===d.type&&(e=d.values.indexOf(e)),e},e.prototype._parseLayout=function(a){var b={},e;for(e in a)b[e]=new f(this._layoutDefinition[e],a[e]);return b},e.prototype._parsePaint=function(a){var b={},e;for(e in a)b[e]=new f(this._paintDefinition[e],a[e]);return b},e}();k.StyleLayer=h;h=function(){return function(a,b){this.cap=a.getLayoutValue("line-cap",b);this.join=a.getLayoutValue("line-join",b);this.miterLimit=a.getLayoutValue("line-miter-limit",b);this.roundLimit=a.getLayoutValue("line-round-limit",
b)}}();k.LineLayout=h;h=function(){return function(a,b,f){this.allowOverlap=a.getLayoutValue("icon-allow-overlap",b);this.ignorePlacement=a.getLayoutValue("icon-ignore-placement",b);this.optional=a.getLayoutValue("icon-optional",b);this.rotationAlignment=a.getLayoutValue("icon-rotation-alignment",b);this.size=a.getLayoutValue("icon-size",b);this.rotate=a.getLayoutValue("icon-rotate",b);this.padding=a.getLayoutValue("icon-padding",b);this.keepUpright=a.getLayoutValue("icon-keep-upright",b);this.offset=
a.getLayoutValue("icon-offset",b);f&&1===this.rotationAlignment&&!a.hasLayoutProperty("icon-rotation-alignment")&&(this.rotationAlignment=0)}}();k.IconLayout=h;h=function(){return function(a,b,f){this.allowOverlap=a.getLayoutValue("text-allow-overlap",b);this.ignorePlacement=a.getLayoutValue("text-ignore-placement",b);this.optional=a.getLayoutValue("text-optional",b);this.rotationAlignment=a.getLayoutValue("text-rotation-alignment",b);this.font=a.getLayoutValue("text-font",b);this.maxWidth=a.getLayoutValue("text-max-width",
b);this.lineHeight=a.getLayoutValue("text-line-height",b);this.letterSpacing=a.getLayoutValue("text-letter-spacing",b);this.justify=a.getLayoutValue("text-justify",b);this.anchor=a.getLayoutValue("text-anchor",b);this.maxAngle=a.getLayoutValue("text-max-angle",b);this.size=a.getLayoutValue("text-size",b);this.rotate=a.getLayoutValue("text-rotate",b);this.padding=a.getLayoutValue("text-padding",b);this.keepUpright=a.getLayoutValue("text-keep-upright",b);this.transform=a.getLayoutValue("text-transform",
b);this.offset=a.getLayoutValue("text-offset",b);f&&1===this.rotationAlignment&&!a.hasLayoutProperty("text-rotation-alignment")&&(this.rotationAlignment=0)}}();k.TextLayout=h})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(h,k){var a=function(){return function(){}}();a.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"}};a.fillLayoutDefinition={visibility:{type:"enum",values:["visible",
"none"],"default":"visible"}};a.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"line-cap":{type:"enum",values:["butt","round","square"],"default":"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],"default":"miter"},"line-miter-limit":{type:"number","default":2},"line-round-limit":{type:"number","default":1.05}};a.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"symbol-placement":{type:"enum",
values:["point","line"],"default":"point"},"symbol-spacing":{type:"number",minimum:1,"default":250},"symbol-avoid-edges":{type:"boolean","default":!1},"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean","default":!1},"icon-ignore-placement":{type:"boolean","default":!1},"icon-optional":{type:"boolean","default":!1},"icon-rotation-alignment":{type:"enum",values:["map","viewport"],"default":"viewport"},"icon-size":{type:"number",minimum:0,"default":1},"icon-rotate":{type:"number","default":0},
"icon-padding":{type:"number",minimum:0,"default":2},"icon-keep-upright":{type:"boolean","default":!0},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport"],"default":"viewport"},"text-font":{type:"array",value:"string","default":["Open Sans Regular","Arial Unicode MS Regular"]},"text-size":{type:"number",minimum:0,"default":16},"text-max-width":{type:"number",minimum:0,"default":10},"text-line-height":{type:"number",
"default":1.2},"text-letter-spacing":{type:"number","default":0},"text-justify":{type:"enum",values:["left","center","right"],"default":"center"},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),"default":"center"},"text-max-angle":{type:"number",minimum:0,"default":45},"text-rotate":{type:"number","default":0},"text-padding":{type:"number",minimum:0,"default":2},"text-keep-upright":{type:"boolean","default":!0},"text-transform":{type:"enum",
values:["none","uppercase","lowercase"],"default":"none"},"text-offset":{type:"array",value:"number",length:2,"default":[0,0]},"text-allow-overlap":{type:"boolean","default":!1},"text-ignore-placement":{type:"boolean","default":!1},"text-optional":{type:"boolean","default":!1}};a.backgroundPaintDefinition={"background-opacity":{type:"number",minimum:0,maximum:1,"default":1},"background-color":{type:"color","default":[0,0,0,1]},"background-pattern":{type:"string"}};a.fillPaintDefinition={"fill-opacity":{type:"number",
minimum:0,maximum:1,"default":1},"fill-antialias":{type:"boolean","default":!0},"fill-color":{type:"color","default":[0,0,0,1]},"fill-outline-color":{type:"color","default":[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"fill-pattern":{type:"string"}};a.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,"default":1},"line-color":{type:"color","default":[0,0,0,1]},
"line-translate":{type:"array",value:"number",length:2,"default":[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"line-width":{type:"number",minimum:0,"default":1},"line-gap-width":{type:"number",minimum:0,"default":0},"line-offset":{type:"number","default":0},"line-blur":{type:"number",minimum:0,"default":0},"line-dasharray":{type:"array",value:"number","default":[]},"line-pattern":{type:"string"}};a.symbolPaintDefinition={"icon-opacity":{type:"number",minimum:0,
maximum:1,"default":1},"icon-color":{type:"color","default":[0,0,0,1]},"icon-halo-color":{type:"color","default":[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,"default":0},"icon-halo-blur":{type:"number",minimum:0,"default":0},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"text-opacity":{type:"number",minimum:0,maximum:1,"default":1},"text-color":{type:"color","default":[0,0,0,1]},"text-halo-color":{type:"color",
"default":[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,"default":0},"text-halo-blur":{type:"number",minimum:0,"default":0},"text-translate":{type:"array",value:"number",length:2,"default":[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}};a.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,"default":1},"raster-hue-rotate":{type:"number","default":0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,"default":0},"raster-brightness-max":{type:"number",
minimum:0,maximum:1,"default":1},"raster-saturation":{type:"number",minimum:-1,maximum:1,"default":0},"raster-contrast":{type:"number",minimum:-1,maximum:1,"default":0},"raster-fade-duration":{type:"number",minimum:0,"default":300}};a.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,"default":1},"circle-radius":{type:"number",minimum:0,"default":5},"circle-color":{type:"color","default":[0,0,0,1]},"circle-blur":{type:"number",minimum:0,"default":0},"circle-translate":{type:"array",
value:"number",length:2,"default":[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}};k.StyleDefinition=a})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleProperty":function(){define(["require","exports","../../../Color","../GeometryUtils"],function(h,k,a,f){return function(){function b(a,f){var e;switch(a.type){case "number":e=!0;break;case "color":e=!0;f=b._parseColor(f);break;case "array":e="number"===a.value;break;default:e=!1}e?this.getValue=this._interpolate(f):
this.getValue=this._piecewise(f)}return b.prototype._piecewise=function(a){var b=a.stops;return b?function(a){var e=b.length;if(0!==e){for(var d=0,c=0;e>c&&b[c][0]<=a;c++)d=c;return b[d][1]}}:function(){return a}},b.prototype._interpolate=function(a){var b=a.stops;if(b){var e=a.base||1;return function(a){for(var d,c,g=b.length,h=0;g>h;h++){var l=b[h];if(!(l[0]<=a)){c=l;break}d=l}if(d&&c){h=c[0]-d[0];a-=d[0];a=1===e?a/h:(Math.pow(e,a)-1)/(Math.pow(e,h)-1);if(Array.isArray(d[1])){d=d[1];c=c[1];g=[];
for(h=0;h<d.length;h++)g.push(f.interpolate(d[h],c[h],a));return g}return f.interpolate(d[1],c[1],a)}return d?d[1]:c?c[1]:void 0}}return function(){return a}},b._parseColor=function(e){if(Array.isArray(e))return e;if("string"==typeof e)return e=new a(e),[e.r/255,e.g/255,e.b/255,e.a||1];if(e&&e.stops)return e.stops=e.stops.map(function(a){return[a[0],b._parseColor(a[1])]}),e;throw Error("Incorrect color definition "+e);},b}()})},"esri/layers/vectorTiles/Color":function(){define(["require","exports",
"esri/Color"],function(h,k,a){return function(){return function(f){return new a(f)}}()})},"esri/layers/vectorTiles/views/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(h,k){function a(a,e){return a%=e,0<=a?a:a+e}k.C_INFINITY=Number.POSITIVE_INFINITY;k.C_PI=Math.PI;k.C_2PI=2*k.C_PI;k.C_PI_BY_2=k.C_PI/2;k.C_RAD_TO_256=128/k.C_PI;k.C_256_TO_RAD=k.C_PI/128;k.C_DEG_TO_256=256/360;k.C_DEG_TO_RAD=k.C_PI/180;k.C_SQRT2=1.414213562;k.C_SQRT2_INV=1/k.C_SQRT2;var f=1/Math.LN2;k.positiveMod=
a;k.radToByte=function(b){return a(b*k.C_RAD_TO_256,256)};k.degToByte=function(b){return a(b*k.C_DEG_TO_256,256)};k.log2=function(a){return Math.log(a)*f};k.sqr=function(a){return a*a};k.clamp=function(a,e,f){return Math.min(Math.max(a,e),f)};k.interpolate=function(a,e,f){return a*(1-f)+e*f};k.between=function(a,e,f){return a>=e&&f>=a||a>=f&&e>=a}})},"esri/layers/vectorTiles/views/vectorTiles/style/Filter":function(){define(["require","exports"],function(h,k){var a=function(){function a(b,e,f){this._op=
b;"$type"===e?(f instanceof Array?this._val=f.map(function(b){return a._types.indexOf(b)}):this._val=a._types.indexOf(f),this._op+=11):(this._key=e,this._val=f)}return a.prototype.filter=function(a){switch(this._op){case 0:return this._val;case 1:return a.values[this._key]===this._val;case 2:return a.values[this._key]!==this._val;case 3:return a.values[this._key]<this._val;case 4:return a.values[this._key]>this._val;case 5:return a.values[this._key]<=this._val;case 6:return a.values[this._key]>=this._val;
case 7:return-1!==this._val.indexOf(a.values[this._key]);case 8:return-1===this._val.indexOf(a.values[this._key]);case 9:for(var b=0,f=this._val;b<f.length;b++){var h=f[b];if(h.filter(a))return!0}return!1;case 10:b=0;for(f=this._val;b<f.length;b++)if(h=f[b],!h.filter(a))return!1;return!0;case 11:b=0;for(f=this._val;b<f.length;b++)if(h=f[b],h.filter(a))return!1;return!0;case 12:return a.type===this._val;case 13:return a.type!==this._val;case 14:return a.type<this._val;case 15:return a.type>this._val;
case 16:return a.type>=this._val;case 17:return a.type<=this._val;case 18:return-1!==this._val.indexOf(a.type);case 19:return-1===this._val.indexOf(a.type)}},a.createFilter=function(b){if(!b)return new a(0,void 0,!0);var e=b[0];if(1>=b.length)return new a(0,void 0,"any"!==e);switch(e){case "\x3d\x3d":return new a(1,b[1],b[2]);case "!\x3d":return new a(2,b[1],b[2]);case "\x3e":return new a(4,b[1],b[2]);case "\x3c":return new a(3,b[1],b[2]);case "\x3e\x3d":return new a(6,b[1],b[2]);case "\x3c\x3d":return new a(5,
b[1],b[2]);case "in":return new a(7,b[1],b.slice(2));case "!in":return new a(8,b[1],b.slice(2));case "any":return new a(9,void 0,b.slice(1).map(a.createFilter.bind(this)));case "all":return new a(10,void 0,b.slice(1).map(a.createFilter.bind(this)));case "none":return new a(11,void 0,b.slice(1).map(a.createFilter.bind(this)));default:throw Error("invalid operator: "+e);}},a}();return a._types=["Unknown","Point","LineString","Polygon"],a})},"esri/layers/vectorTiles/views/vectorTiles/VectorTileContainer":function(){define("require exports ../../core/tsSupport/extendsHelper dojo/has ../../core/libs/gl-matrix/vec3 ../../core/libs/gl-matrix/mat4 ../2d/engine/Container ./renderers/Renderer ./GeometryUtils ./StencilClipGenerator".split(" "),
function(h,k,a,f,b,e,l,m,g,d){return function(c){function h(){var a=c.call(this)||this;return a.isInitialized=!1,a._displayWidth=0,a._displayHeight=0,a._clip=new d,a._tileCoordinateScale=b.create(),a._orientationVec=b.create(),a._displayScale=b.create(),a._orientationVec.set([0,0,1]),a._defaultTransform=e.create(),a}return a(h,c),h.prototype.initialize=function(a,b,c,d){this._renderer=new m;this._renderer.initialize(a,b);this._tileInfoView=d;this._tileInfo=c;this.isInitialized=!0},h.prototype.prepareChildrenRenderParameters=
function(a){var b=a.state;return b&&this._tileInfo&&this.isInitialized?(a.displayLevel=this._tileInfo.scaleToZoom(b.scale),a.requiredLevel=this._tileInfoView.getClosestInfoForScale(b.scale).level,a.renderer=this._renderer,a):a},h.prototype.renderChildren=function(a){if(0!==this.children.length&&this.isInitialized&&a&&a.state){this.sortChildren(function(a,b){return b.resolution-a.resolution});this._clip.update(this.children);this._updateTilesTransform(a.state,this._tileInfoView.getClosestInfoForScale(a.state.scale).level);
var b=a.context;if(b.setDepthWriteEnabled(!0),this._renderer.setStateParams(a.state,a.devicePixelRatio,a.displayLevel),this._renderer.drawClippingMasks(b,this.children),b.setStencilWriteMask(0),b.setBlendFunctionSeparate(1,771,1,771),b.setStencilOp(7680,7680,7681),b.setDepthFunction(515),b.setBlendingEnabled(!1),b.setStencilTestEnabled(!0),b.setDepthTestEnabled(!0),b.setDepthWriteEnabled(!0),a.drawphase=0,c.prototype.renderChildren.call(this,a),b.setDepthWriteEnabled(!1),b.setBlendingEnabled(!0),
a.drawphase=1,c.prototype.renderChildren.call(this,a),a.drawphase=2,c.prototype.renderChildren.call(this,a),b.setStencilTestEnabled(!1),b.setDepthTestEnabled(!1),f("esri-vector-tiles-debug")){a=0;for(var d=this.children;a<d.length;a++){var e=d[a];e.attached&&e.visible&&this._renderer.renderTileInfo(b,e)}}this._renderer.needsRedraw()&&this.requestRender()}},h.prototype.attachChild=function(a,b){return a.attach(b)},h.prototype.detachChild=function(a,b){a.detach(b)},h.prototype.renderChild=function(a,
b){a.render(b)},h.prototype._updateTilesTransform=function(a,b){var c=1/a.width,d=1/a.height,e=[0,0];this._calculateRelativeViewProjMat(this._tileInfo.lods[b].resolution,a.resolution,a.rotation,this._tileInfo.size[1],4096,a.width,a.height,this._defaultTransform);for(var f=0,g=this.children;f<g.length;f++){var h=g[f];a.toScreen(e,h.topLeft);e[1]=a.height-e[1];h.tileTransform.displayCoord[0]=2*e[0]*c-1;h.tileTransform.displayCoord[1]=2*e[1]*d-1;h.key.level===b&&4096===h.coordRange?h.tileTransform.transform.set(this._defaultTransform):
this._calculateRelativeViewProjMat(this._tileInfo.lods[h.key.level].resolution,a.resolution,a.rotation,this._tileInfo.size[1],h.coordRange,a.width,a.height,h.tileTransform.transform)}},h.prototype._calculateRelativeViewProjMat=function(a,b,c,d,f,h,l,k){var m=.125;512!==d&&4096!==f&&(m=d/f);a=a/b*m;this._tileCoordinateScale.set([a,a,1]);(h!==this._displayWidth||l!==this._displayHeight)&&(this._displayScale.set([2/h,-2/l,1]),this._displayWidth=h,this._displayHeight=l);e.identity(k);e.scale(k,k,this._tileCoordinateScale);
e.rotate(k,k,-c*g.C_DEG_TO_RAD,this._orientationVec);e.scale(k,k,this._displayScale);e.transpose(k,k)},h}(l)})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec3":function(){define(["./common"],function(h){var k={};return k.create=function(){var a=new h.ARRAY_TYPE(3);return a[0]=0,a[1]=0,a[2]=0,a},k.clone=function(a){var f=new h.ARRAY_TYPE(3);return f[0]=a[0],f[1]=a[1],f[2]=a[2],f},k.fromValues=function(a,f,b){var e=new h.ARRAY_TYPE(3);return e[0]=a,e[1]=f,e[2]=b,e},k.copy=function(a,f){return a[0]=
f[0],a[1]=f[1],a[2]=f[2],a},k.set=function(a,f,b,e){return a[0]=f,a[1]=b,a[2]=e,a},k.add=function(a,f,b){return a[0]=f[0]+b[0],a[1]=f[1]+b[1],a[2]=f[2]+b[2],a},k.subtract=function(a,f,b){return a[0]=f[0]-b[0],a[1]=f[1]-b[1],a[2]=f[2]-b[2],a},k.sub=k.subtract,k.multiply=function(a,f,b){return a[0]=f[0]*b[0],a[1]=f[1]*b[1],a[2]=f[2]*b[2],a},k.mul=k.multiply,k.divide=function(a,f,b){return a[0]=f[0]/b[0],a[1]=f[1]/b[1],a[2]=f[2]/b[2],a},k.div=k.divide,k.ceil=function(a,f){return a[0]=Math.ceil(f[0]),
a[1]=Math.ceil(f[1]),a[2]=Math.ceil(f[2]),a},k.floor=function(a,f){return a[0]=Math.floor(f[0]),a[1]=Math.floor(f[1]),a[2]=Math.floor(f[2]),a},k.min=function(a,f,b){return a[0]=Math.min(f[0],b[0]),a[1]=Math.min(f[1],b[1]),a[2]=Math.min(f[2],b[2]),a},k.max=function(a,f,b){return a[0]=Math.max(f[0],b[0]),a[1]=Math.max(f[1],b[1]),a[2]=Math.max(f[2],b[2]),a},k.round=function(a,f){return a[0]=Math.round(f[0]),a[1]=Math.round(f[1]),a[2]=Math.round(f[2]),a},k.scale=function(a,f,b){return a[0]=f[0]*b,a[1]=
f[1]*b,a[2]=f[2]*b,a},k.scaleAndAdd=function(a,f,b,e){return a[0]=f[0]+b[0]*e,a[1]=f[1]+b[1]*e,a[2]=f[2]+b[2]*e,a},k.distance=function(a,f){var b=f[0]-a[0],e=f[1]-a[1],h=f[2]-a[2];return Math.sqrt(b*b+e*e+h*h)},k.dist=k.distance,k.squaredDistance=function(a,f){var b=f[0]-a[0],e=f[1]-a[1],h=f[2]-a[2];return b*b+e*e+h*h},k.sqrDist=k.squaredDistance,k.length=function(a){var f=a[0],b=a[1];a=a[2];return Math.sqrt(f*f+b*b+a*a)},k.len=k.length,k.squaredLength=function(a){var f=a[0],b=a[1];a=a[2];return f*
f+b*b+a*a},k.sqrLen=k.squaredLength,k.negate=function(a,f){return a[0]=-f[0],a[1]=-f[1],a[2]=-f[2],a},k.inverse=function(a,f){return a[0]=1/f[0],a[1]=1/f[1],a[2]=1/f[2],a},k.normalize=function(a,f){var b=f[0],e=f[1],h=f[2],b=b*b+e*e+h*h;return 0<b&&(b=1/Math.sqrt(b),a[0]=f[0]*b,a[1]=f[1]*b,a[2]=f[2]*b),a},k.dot=function(a,f){return a[0]*f[0]+a[1]*f[1]+a[2]*f[2]},k.cross=function(a,f,b){var e=f[0],h=f[1];f=f[2];var k=b[0],g=b[1];b=b[2];return a[0]=h*b-f*g,a[1]=f*k-e*b,a[2]=e*g-h*k,a},k.lerp=function(a,
f,b,e){var h=f[0],k=f[1];f=f[2];return a[0]=h+e*(b[0]-h),a[1]=k+e*(b[1]-k),a[2]=f+e*(b[2]-f),a},k.hermite=function(a,f,b,e,h,k){var g=k*k,d=g*(2*k-3)+1,c=g*(k-2)+k,l=g*(k-1);k=g*(3-2*k);return a[0]=f[0]*d+b[0]*c+e[0]*l+h[0]*k,a[1]=f[1]*d+b[1]*c+e[1]*l+h[1]*k,a[2]=f[2]*d+b[2]*c+e[2]*l+h[2]*k,a},k.bezier=function(a,f,b,e,h,k){var g=1-k,d=g*g,c=k*k,l=d*g,d=3*k*d,g=3*c*g;k*=c;return a[0]=f[0]*l+b[0]*d+e[0]*g+h[0]*k,a[1]=f[1]*l+b[1]*d+e[1]*g+h[1]*k,a[2]=f[2]*l+b[2]*d+e[2]*g+h[2]*k,a},k.random=function(a,
f){f=f||1;var b=2*h.RANDOM()*Math.PI,e=2*h.RANDOM()-1,l=Math.sqrt(1-e*e)*f;return a[0]=Math.cos(b)*l,a[1]=Math.sin(b)*l,a[2]=e*f,a},k.transformMat4=function(a,f,b){var e=f[0],h=f[1];f=f[2];var k=b[3]*e+b[7]*h+b[11]*f+b[15];return k=k||1,a[0]=(b[0]*e+b[4]*h+b[8]*f+b[12])/k,a[1]=(b[1]*e+b[5]*h+b[9]*f+b[13])/k,a[2]=(b[2]*e+b[6]*h+b[10]*f+b[14])/k,a},k.transformMat3=function(a,f,b){var e=f[0],h=f[1];f=f[2];return a[0]=e*b[0]+h*b[3]+f*b[6],a[1]=e*b[1]+h*b[4]+f*b[7],a[2]=e*b[2]+h*b[5]+f*b[8],a},k.transformQuat=
function(a,f,b){var e=f[0],h=f[1],k=f[2];f=b[0];var g=b[1],d=b[2];b=b[3];var c=b*e+g*k-d*h,n=b*h+d*e-f*k,q=b*k+f*h-g*e,e=-f*e-g*h-d*k;return a[0]=c*b+e*-f+n*-d-q*-g,a[1]=n*b+e*-g+q*-f-c*-d,a[2]=q*b+e*-d+c*-g-n*-f,a},k.rotateX=function(a,f,b,e){var h=[],k=[];return h[0]=f[0]-b[0],h[1]=f[1]-b[1],h[2]=f[2]-b[2],k[0]=h[0],k[1]=h[1]*Math.cos(e)-h[2]*Math.sin(e),k[2]=h[1]*Math.sin(e)+h[2]*Math.cos(e),a[0]=k[0]+b[0],a[1]=k[1]+b[1],a[2]=k[2]+b[2],a},k.rotateY=function(a,f,b,e){var h=[],k=[];return h[0]=f[0]-
b[0],h[1]=f[1]-b[1],h[2]=f[2]-b[2],k[0]=h[2]*Math.sin(e)+h[0]*Math.cos(e),k[1]=h[1],k[2]=h[2]*Math.cos(e)-h[0]*Math.sin(e),a[0]=k[0]+b[0],a[1]=k[1]+b[1],a[2]=k[2]+b[2],a},k.rotateZ=function(a,f,b,e){var h=[],k=[];return h[0]=f[0]-b[0],h[1]=f[1]-b[1],h[2]=f[2]-b[2],k[0]=h[0]*Math.cos(e)-h[1]*Math.sin(e),k[1]=h[0]*Math.sin(e)+h[1]*Math.cos(e),k[2]=h[2],a[0]=k[0]+b[0],a[1]=k[1]+b[1],a[2]=k[2]+b[2],a},k.forEach=function(){var a=k.create();return function(f,b,e,h,k,g){b||(b=3);e||(e=0);for(h=h?Math.min(h*
b+e,f.length):f.length;h>e;e+=b)a[0]=f[e],a[1]=f[e+1],a[2]=f[e+2],k(a,a,g),f[e]=a[0],f[e+1]=a[1],f[e+2]=a[2];return f}}(),k.angle=function(a,f){var b=k.fromValues(a[0],a[1],a[2]),e=k.fromValues(f[0],f[1],f[2]);k.normalize(b,b);k.normalize(e,e);b=k.dot(b,e);return 1<b?0:Math.acos(b)},k.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"},k.exactEquals=function(a,f){return a[0]===f[0]&&a[1]===f[1]&&a[2]===f[2]},k.equals=function(a,f){var b=a[0],e=a[1],l=a[2],k=f[0],g=f[1],d=f[2];return Math.abs(b-
k)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(k))&&Math.abs(e-g)<=h.EPSILON*Math.max(1,Math.abs(e),Math.abs(g))&&Math.abs(l-d)<=h.EPSILON*Math.max(1,Math.abs(l),Math.abs(d))},k})},"esri/layers/vectorTiles/core/libs/gl-matrix/common":function(){define([],function(){var h={EPSILON:1E-6};h.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array;h.RANDOM=Math.random;h.ENABLE_SIMD=!1;h.SIMD_AVAILABLE=h.ARRAY_TYPE===Float32Array&&"SIMD"in this;h.USE_SIMD=h.ENABLE_SIMD&&h.SIMD_AVAILABLE;h.setMatrixArrayType=
function(a){h.ARRAY_TYPE=a};var k=Math.PI/180;return h.toRadian=function(a){return a*k},h.equals=function(a,f){return Math.abs(a-f)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))},h})},"esri/layers/vectorTiles/core/libs/gl-matrix/mat4":function(){define(["./common"],function(h){var k={scalar:{},SIMD:{}};return k.create=function(){var a=new h.ARRAY_TYPE(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},k.clone=function(a){var f=
new h.ARRAY_TYPE(16);return f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],f[4]=a[4],f[5]=a[5],f[6]=a[6],f[7]=a[7],f[8]=a[8],f[9]=a[9],f[10]=a[10],f[11]=a[11],f[12]=a[12],f[13]=a[13],f[14]=a[14],f[15]=a[15],f},k.copy=function(a,f){return a[0]=f[0],a[1]=f[1],a[2]=f[2],a[3]=f[3],a[4]=f[4],a[5]=f[5],a[6]=f[6],a[7]=f[7],a[8]=f[8],a[9]=f[9],a[10]=f[10],a[11]=f[11],a[12]=f[12],a[13]=f[13],a[14]=f[14],a[15]=f[15],a},k.fromValues=function(a,f,b,e,l,k,g,d,c,n,q,t,r,v,u,w){var m=new h.ARRAY_TYPE(16);return m[0]=a,
m[1]=f,m[2]=b,m[3]=e,m[4]=l,m[5]=k,m[6]=g,m[7]=d,m[8]=c,m[9]=n,m[10]=q,m[11]=t,m[12]=r,m[13]=v,m[14]=u,m[15]=w,m},k.set=function(a,f,b,e,h,k,g,d,c,n,q,t,r,v,u,w,x){return a[0]=f,a[1]=b,a[2]=e,a[3]=h,a[4]=k,a[5]=g,a[6]=d,a[7]=c,a[8]=n,a[9]=q,a[10]=t,a[11]=r,a[12]=v,a[13]=u,a[14]=w,a[15]=x,a},k.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},k.scalar.transpose=function(a,f){if(a===f){var b=f[1],e=f[2],
h=f[3],k=f[6],g=f[7],d=f[11];a[1]=f[4];a[2]=f[8];a[3]=f[12];a[4]=b;a[6]=f[9];a[7]=f[13];a[8]=e;a[9]=k;a[11]=f[14];a[12]=h;a[13]=g;a[14]=d}else a[0]=f[0],a[1]=f[4],a[2]=f[8],a[3]=f[12],a[4]=f[1],a[5]=f[5],a[6]=f[9],a[7]=f[13],a[8]=f[2],a[9]=f[6],a[10]=f[10],a[11]=f[14],a[12]=f[3],a[13]=f[7],a[14]=f[11],a[15]=f[15];return a},k.SIMD.transpose=function(a,f){var b,e,h,k,g,d,c,n,q,t;return b=SIMD.Float32x4.load(f,0),e=SIMD.Float32x4.load(f,4),h=SIMD.Float32x4.load(f,8),k=SIMD.Float32x4.load(f,12),g=SIMD.Float32x4.shuffle(b,
e,0,1,4,5),d=SIMD.Float32x4.shuffle(h,k,0,1,4,5),c=SIMD.Float32x4.shuffle(g,d,0,2,4,6),n=SIMD.Float32x4.shuffle(g,d,1,3,5,7),SIMD.Float32x4.store(a,0,c),SIMD.Float32x4.store(a,4,n),g=SIMD.Float32x4.shuffle(b,e,2,3,6,7),d=SIMD.Float32x4.shuffle(h,k,2,3,6,7),q=SIMD.Float32x4.shuffle(g,d,0,2,4,6),t=SIMD.Float32x4.shuffle(g,d,1,3,5,7),SIMD.Float32x4.store(a,8,q),SIMD.Float32x4.store(a,12,t),a},k.transpose=h.USE_SIMD?k.SIMD.transpose:k.scalar.transpose,k.scalar.invert=function(a,f){var b=f[0],e=f[1],h=
f[2],k=f[3],g=f[4],d=f[5],c=f[6],n=f[7],q=f[8],t=f[9],r=f[10],v=f[11],u=f[12],w=f[13],x=f[14],y=f[15],A=b*d-e*g,z=b*c-h*g,B=b*n-k*g,C=e*c-h*d,D=e*n-k*d,E=h*n-k*c,F=q*w-t*u,G=q*x-r*u,I=q*y-v*u,J=t*x-r*w,L=t*y-v*w,M=r*y-v*x,H=A*M-z*L+B*J+C*I-D*G+E*F;return H?(H=1/H,a[0]=(d*M-c*L+n*J)*H,a[1]=(h*L-e*M-k*J)*H,a[2]=(w*E-x*D+y*C)*H,a[3]=(r*D-t*E-v*C)*H,a[4]=(c*I-g*M-n*G)*H,a[5]=(b*M-h*I+k*G)*H,a[6]=(x*B-u*E-y*z)*H,a[7]=(q*E-r*B+v*z)*H,a[8]=(g*L-d*I+n*F)*H,a[9]=(e*I-b*L-k*F)*H,a[10]=(u*D-w*B+y*A)*H,a[11]=
(t*B-q*D-v*A)*H,a[12]=(d*G-g*J-c*F)*H,a[13]=(b*J-e*G+h*F)*H,a[14]=(w*z-u*C-x*A)*H,a[15]=(q*C-t*z+r*A)*H,a):null},k.SIMD.invert=function(a,f){var b,e,h,k,g,d,c,n,q,t,r=SIMD.Float32x4.load(f,0),v=SIMD.Float32x4.load(f,4),u=SIMD.Float32x4.load(f,8),w=SIMD.Float32x4.load(f,12);return g=SIMD.Float32x4.shuffle(r,v,0,1,4,5),e=SIMD.Float32x4.shuffle(u,w,0,1,4,5),b=SIMD.Float32x4.shuffle(g,e,0,2,4,6),e=SIMD.Float32x4.shuffle(e,g,1,3,5,7),g=SIMD.Float32x4.shuffle(r,v,2,3,6,7),k=SIMD.Float32x4.shuffle(u,w,2,
3,6,7),h=SIMD.Float32x4.shuffle(g,k,0,2,4,6),k=SIMD.Float32x4.shuffle(k,g,1,3,5,7),g=SIMD.Float32x4.mul(h,k),g=SIMD.Float32x4.swizzle(g,1,0,3,2),d=SIMD.Float32x4.mul(e,g),c=SIMD.Float32x4.mul(b,g),g=SIMD.Float32x4.swizzle(g,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,g),d),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,g),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),g=SIMD.Float32x4.mul(e,h),g=SIMD.Float32x4.swizzle(g,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(k,g),d),q=SIMD.Float32x4.mul(b,g),
g=SIMD.Float32x4.swizzle(g,2,3,0,1),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(k,g)),q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,g),q),q=SIMD.Float32x4.swizzle(q,2,3,0,1),g=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,2,3,0,1),k),g=SIMD.Float32x4.swizzle(g,1,0,3,2),h=SIMD.Float32x4.swizzle(h,2,3,0,1),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,g),d),n=SIMD.Float32x4.mul(b,g),g=SIMD.Float32x4.swizzle(g,2,3,0,1),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(h,g)),n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,g),
n),n=SIMD.Float32x4.swizzle(n,2,3,0,1),g=SIMD.Float32x4.mul(b,e),g=SIMD.Float32x4.swizzle(g,1,0,3,2),n=SIMD.Float32x4.add(SIMD.Float32x4.mul(k,g),n),q=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,g),q),g=SIMD.Float32x4.swizzle(g,2,3,0,1),n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(k,g),n),q=SIMD.Float32x4.sub(q,SIMD.Float32x4.mul(h,g)),g=SIMD.Float32x4.mul(b,k),g=SIMD.Float32x4.swizzle(g,1,0,3,2),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(h,g)),n=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,g),n),g=SIMD.Float32x4.swizzle(g,
2,3,0,1),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,g),c),n=SIMD.Float32x4.sub(n,SIMD.Float32x4.mul(e,g)),g=SIMD.Float32x4.mul(b,h),g=SIMD.Float32x4.swizzle(g,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(k,g),c),q=SIMD.Float32x4.sub(q,SIMD.Float32x4.mul(e,g)),g=SIMD.Float32x4.swizzle(g,2,3,0,1),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(k,g)),q=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,g),q),t=SIMD.Float32x4.mul(b,d),t=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(t,2,3,0,1),t),t=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(t,
1,0,3,2),t),g=SIMD.Float32x4.reciprocalApproximation(t),t=SIMD.Float32x4.sub(SIMD.Float32x4.add(g,g),SIMD.Float32x4.mul(t,SIMD.Float32x4.mul(g,g))),(t=SIMD.Float32x4.swizzle(t,0,0,0,0))?(SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(t,d)),SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(t,c)),SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(t,n)),SIMD.Float32x4.store(a,12,SIMD.Float32x4.mul(t,q)),a):null},k.invert=h.USE_SIMD?k.SIMD.invert:k.scalar.invert,k.scalar.adjoint=function(a,f){var b=f[0],e=f[1],h=f[2],
k=f[3],g=f[4],d=f[5],c=f[6],n=f[7],q=f[8],t=f[9],r=f[10],v=f[11],u=f[12],w=f[13],x=f[14],y=f[15];return a[0]=d*(r*y-v*x)-t*(c*y-n*x)+w*(c*v-n*r),a[1]=-(e*(r*y-v*x)-t*(h*y-k*x)+w*(h*v-k*r)),a[2]=e*(c*y-n*x)-d*(h*y-k*x)+w*(h*n-k*c),a[3]=-(e*(c*v-n*r)-d*(h*v-k*r)+t*(h*n-k*c)),a[4]=-(g*(r*y-v*x)-q*(c*y-n*x)+u*(c*v-n*r)),a[5]=b*(r*y-v*x)-q*(h*y-k*x)+u*(h*v-k*r),a[6]=-(b*(c*y-n*x)-g*(h*y-k*x)+u*(h*n-k*c)),a[7]=b*(c*v-n*r)-g*(h*v-k*r)+q*(h*n-k*c),a[8]=g*(t*y-v*w)-q*(d*y-n*w)+u*(d*v-n*t),a[9]=-(b*(t*y-v*
w)-q*(e*y-k*w)+u*(e*v-k*t)),a[10]=b*(d*y-n*w)-g*(e*y-k*w)+u*(e*n-k*d),a[11]=-(b*(d*v-n*t)-g*(e*v-k*t)+q*(e*n-k*d)),a[12]=-(g*(t*x-r*w)-q*(d*x-c*w)+u*(d*r-c*t)),a[13]=b*(t*x-r*w)-q*(e*x-h*w)+u*(e*r-h*t),a[14]=-(b*(d*x-c*w)-g*(e*x-h*w)+u*(e*c-h*d)),a[15]=b*(d*r-c*t)-g*(e*r-h*t)+q*(e*c-h*d),a},k.SIMD.adjoint=function(a,f){var b,e,h,k,g,d,c,n,q,t,r,v,u;b=SIMD.Float32x4.load(f,0);e=SIMD.Float32x4.load(f,4);h=SIMD.Float32x4.load(f,8);k=SIMD.Float32x4.load(f,12);return q=SIMD.Float32x4.shuffle(b,e,0,1,4,
5),d=SIMD.Float32x4.shuffle(h,k,0,1,4,5),g=SIMD.Float32x4.shuffle(q,d,0,2,4,6),d=SIMD.Float32x4.shuffle(d,q,1,3,5,7),q=SIMD.Float32x4.shuffle(b,e,2,3,6,7),n=SIMD.Float32x4.shuffle(h,k,2,3,6,7),c=SIMD.Float32x4.shuffle(q,n,0,2,4,6),n=SIMD.Float32x4.shuffle(n,q,1,3,5,7),q=SIMD.Float32x4.mul(c,n),q=SIMD.Float32x4.swizzle(q,1,0,3,2),t=SIMD.Float32x4.mul(d,q),r=SIMD.Float32x4.mul(g,q),q=SIMD.Float32x4.swizzle(q,2,3,0,1),t=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,q),t),r=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,
q),r),r=SIMD.Float32x4.swizzle(r,2,3,0,1),q=SIMD.Float32x4.mul(d,c),q=SIMD.Float32x4.swizzle(q,1,0,3,2),t=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,q),t),u=SIMD.Float32x4.mul(g,q),q=SIMD.Float32x4.swizzle(q,2,3,0,1),t=SIMD.Float32x4.sub(t,SIMD.Float32x4.mul(n,q)),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,q),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),q=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,3,0,1),n),q=SIMD.Float32x4.swizzle(q,1,0,3,2),c=SIMD.Float32x4.swizzle(c,2,3,0,1),t=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,
q),t),v=SIMD.Float32x4.mul(g,q),q=SIMD.Float32x4.swizzle(q,2,3,0,1),t=SIMD.Float32x4.sub(t,SIMD.Float32x4.mul(c,q)),v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,q),v),v=SIMD.Float32x4.swizzle(v,2,3,0,1),q=SIMD.Float32x4.mul(g,d),q=SIMD.Float32x4.swizzle(q,1,0,3,2),v=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,q),v),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,q),u),q=SIMD.Float32x4.swizzle(q,2,3,0,1),v=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,q),v),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(c,q)),q=SIMD.Float32x4.mul(g,
n),q=SIMD.Float32x4.swizzle(q,1,0,3,2),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(c,q)),v=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,q),v),q=SIMD.Float32x4.swizzle(q,2,3,0,1),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,q),r),v=SIMD.Float32x4.sub(v,SIMD.Float32x4.mul(d,q)),q=SIMD.Float32x4.mul(g,c),q=SIMD.Float32x4.swizzle(q,1,0,3,2),r=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,q),r),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(d,q)),q=SIMD.Float32x4.swizzle(q,2,3,0,1),r=SIMD.Float32x4.sub(r,SIMD.Float32x4.mul(n,
q)),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,q),u),SIMD.Float32x4.store(a,0,t),SIMD.Float32x4.store(a,4,r),SIMD.Float32x4.store(a,8,v),SIMD.Float32x4.store(a,12,u),a},k.adjoint=h.USE_SIMD?k.SIMD.adjoint:k.scalar.adjoint,k.determinant=function(a){var f=a[0],b=a[1],e=a[2],h=a[3],k=a[4],g=a[5],d=a[6],c=a[7],n=a[8],q=a[9],t=a[10],r=a[11],v=a[12],u=a[13],w=a[14];a=a[15];return(f*g-b*k)*(t*a-r*w)-(f*d-e*k)*(q*a-r*u)+(f*c-h*k)*(q*w-t*u)+(b*d-e*g)*(n*a-r*v)-(b*c-h*g)*(n*w-t*v)+(e*c-h*d)*(n*u-q*v)},k.SIMD.multiply=
function(a,f,b){var e=SIMD.Float32x4.load(f,0),h=SIMD.Float32x4.load(f,4),k=SIMD.Float32x4.load(f,8);f=SIMD.Float32x4.load(f,12);var g=SIMD.Float32x4.load(b,0),g=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,1,1,1,1),h),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,2,2,2,2),k),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,3,3,3,3),f))));SIMD.Float32x4.store(a,0,g);g=SIMD.Float32x4.load(b,4);
g=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,1,1,1,1),h),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,2,2,2,2),k),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,3,3,3,3),f))));SIMD.Float32x4.store(a,4,g);g=SIMD.Float32x4.load(b,8);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,1,1,1,1),h),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,
2,2,2,2),k),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,3,3,3,3),f))));SIMD.Float32x4.store(a,8,g);b=SIMD.Float32x4.load(b,12);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,1,1,1,1),h),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,2,2,2,2),k),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b,3,3,3,3),f))));return SIMD.Float32x4.store(a,12,e),a},k.scalar.multiply=function(a,f,b){var e=f[0],h=f[1],
k=f[2],g=f[3],d=f[4],c=f[5],n=f[6],q=f[7],t=f[8],r=f[9],v=f[10],u=f[11],w=f[12],x=f[13],y=f[14];f=f[15];var A=b[0],z=b[1],B=b[2],C=b[3];return a[0]=A*e+z*d+B*t+C*w,a[1]=A*h+z*c+B*r+C*x,a[2]=A*k+z*n+B*v+C*y,a[3]=A*g+z*q+B*u+C*f,A=b[4],z=b[5],B=b[6],C=b[7],a[4]=A*e+z*d+B*t+C*w,a[5]=A*h+z*c+B*r+C*x,a[6]=A*k+z*n+B*v+C*y,a[7]=A*g+z*q+B*u+C*f,A=b[8],z=b[9],B=b[10],C=b[11],a[8]=A*e+z*d+B*t+C*w,a[9]=A*h+z*c+B*r+C*x,a[10]=A*k+z*n+B*v+C*y,a[11]=A*g+z*q+B*u+C*f,A=b[12],z=b[13],B=b[14],C=b[15],a[12]=A*e+z*d+
B*t+C*w,a[13]=A*h+z*c+B*r+C*x,a[14]=A*k+z*n+B*v+C*y,a[15]=A*g+z*q+B*u+C*f,a},k.multiply=h.USE_SIMD?k.SIMD.multiply:k.scalar.multiply,k.mul=k.multiply,k.scalar.translate=function(a,f,b){var e,h,k,g,d,c,n,q,t,r,v,u,w=b[0],x=b[1];b=b[2];return f===a?(a[12]=f[0]*w+f[4]*x+f[8]*b+f[12],a[13]=f[1]*w+f[5]*x+f[9]*b+f[13],a[14]=f[2]*w+f[6]*x+f[10]*b+f[14],a[15]=f[3]*w+f[7]*x+f[11]*b+f[15]):(e=f[0],h=f[1],k=f[2],g=f[3],d=f[4],c=f[5],n=f[6],q=f[7],t=f[8],r=f[9],v=f[10],u=f[11],a[0]=e,a[1]=h,a[2]=k,a[3]=g,a[4]=
d,a[5]=c,a[6]=n,a[7]=q,a[8]=t,a[9]=r,a[10]=v,a[11]=u,a[12]=e*w+d*x+t*b+f[12],a[13]=h*w+c*x+r*b+f[13],a[14]=k*w+n*x+v*b+f[14],a[15]=g*w+q*x+u*b+f[15]),a},k.SIMD.translate=function(a,f,b){var e=SIMD.Float32x4.load(f,0),h=SIMD.Float32x4.load(f,4),k=SIMD.Float32x4.load(f,8),g=SIMD.Float32x4.load(f,12);b=SIMD.Float32x4(b[0],b[1],b[2],0);f!==a&&(a[0]=f[0],a[1]=f[1],a[2]=f[2],a[3]=f[3],a[4]=f[4],a[5]=f[5],a[6]=f[6],a[7]=f[7],a[8]=f[8],a[9]=f[9],a[10]=f[10],a[11]=f[11]);e=SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(b,
0,0,0,0));h=SIMD.Float32x4.mul(h,SIMD.Float32x4.swizzle(b,1,1,1,1));k=SIMD.Float32x4.mul(k,SIMD.Float32x4.swizzle(b,2,2,2,2));f=SIMD.Float32x4.add(e,SIMD.Float32x4.add(h,SIMD.Float32x4.add(k,g)));return SIMD.Float32x4.store(a,12,f),a},k.translate=h.USE_SIMD?k.SIMD.translate:k.scalar.translate,k.scalar.scale=function(a,f,b){var e=b[0],h=b[1];b=b[2];return a[0]=f[0]*e,a[1]=f[1]*e,a[2]=f[2]*e,a[3]=f[3]*e,a[4]=f[4]*h,a[5]=f[5]*h,a[6]=f[6]*h,a[7]=f[7]*h,a[8]=f[8]*b,a[9]=f[9]*b,a[10]=f[10]*b,a[11]=f[11]*
b,a[12]=f[12],a[13]=f[13],a[14]=f[14],a[15]=f[15],a},k.SIMD.scale=function(a,f,b){var e,h,k;b=SIMD.Float32x4(b[0],b[1],b[2],0);return e=SIMD.Float32x4.load(f,0),SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(b,0,0,0,0))),h=SIMD.Float32x4.load(f,4),SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(h,SIMD.Float32x4.swizzle(b,1,1,1,1))),k=SIMD.Float32x4.load(f,8),SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(k,SIMD.Float32x4.swizzle(b,2,2,2,2))),a[12]=f[12],a[13]=f[13],a[14]=f[14],a[15]=
f[15],a},k.scale=h.USE_SIMD?k.SIMD.scale:k.scalar.scale,k.rotate=function(a,f,b,e){var l,k,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E,F,G,I,J,L=e[0],M=e[1];e=e[2];var H=Math.sqrt(L*L+M*M+e*e);return Math.abs(H)<h.EPSILON?null:(H=1/H,L*=H,M*=H,e*=H,l=Math.sin(b),k=Math.cos(b),g=1-k,d=f[0],c=f[1],n=f[2],q=f[3],t=f[4],r=f[5],v=f[6],u=f[7],w=f[8],x=f[9],y=f[10],A=f[11],z=L*L*g+k,B=M*L*g+e*l,C=e*L*g-M*l,D=L*M*g-e*l,E=M*M*g+k,F=e*M*g+L*l,G=L*e*g+M*l,I=M*e*g-L*l,J=e*e*g+k,a[0]=d*z+t*B+w*C,a[1]=c*z+r*B+x*C,a[2]=
n*z+v*B+y*C,a[3]=q*z+u*B+A*C,a[4]=d*D+t*E+w*F,a[5]=c*D+r*E+x*F,a[6]=n*D+v*E+y*F,a[7]=q*D+u*E+A*F,a[8]=d*G+t*I+w*J,a[9]=c*G+r*I+x*J,a[10]=n*G+v*I+y*J,a[11]=q*G+u*I+A*J,f!==a&&(a[12]=f[12],a[13]=f[13],a[14]=f[14],a[15]=f[15]),a)},k.scalar.rotateX=function(a,f,b){var e=Math.sin(b);b=Math.cos(b);var h=f[4],k=f[5],g=f[6],d=f[7],c=f[8],n=f[9],q=f[10],t=f[11];return f!==a&&(a[0]=f[0],a[1]=f[1],a[2]=f[2],a[3]=f[3],a[12]=f[12],a[13]=f[13],a[14]=f[14],a[15]=f[15]),a[4]=h*b+c*e,a[5]=k*b+n*e,a[6]=g*b+q*e,a[7]=
d*b+t*e,a[8]=c*b-h*e,a[9]=n*b-k*e,a[10]=q*b-g*e,a[11]=t*b-d*e,a},k.SIMD.rotateX=function(a,f,b){var e=SIMD.Float32x4.splat(Math.sin(b));b=SIMD.Float32x4.splat(Math.cos(b));f!==a&&(a[0]=f[0],a[1]=f[1],a[2]=f[2],a[3]=f[3],a[12]=f[12],a[13]=f[13],a[14]=f[14],a[15]=f[15]);var h=SIMD.Float32x4.load(f,4);f=SIMD.Float32x4.load(f,8);return SIMD.Float32x4.store(a,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(h,b),SIMD.Float32x4.mul(f,e))),SIMD.Float32x4.store(a,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,b),SIMD.Float32x4.mul(h,
e))),a},k.rotateX=h.USE_SIMD?k.SIMD.rotateX:k.scalar.rotateX,k.scalar.rotateY=function(a,f,b){var e=Math.sin(b);b=Math.cos(b);var h=f[0],k=f[1],g=f[2],d=f[3],c=f[8],n=f[9],q=f[10],t=f[11];return f!==a&&(a[4]=f[4],a[5]=f[5],a[6]=f[6],a[7]=f[7],a[12]=f[12],a[13]=f[13],a[14]=f[14],a[15]=f[15]),a[0]=h*b-c*e,a[1]=k*b-n*e,a[2]=g*b-q*e,a[3]=d*b-t*e,a[8]=h*e+c*b,a[9]=k*e+n*b,a[10]=g*e+q*b,a[11]=d*e+t*b,a},k.SIMD.rotateY=function(a,f,b){var e=SIMD.Float32x4.splat(Math.sin(b));b=SIMD.Float32x4.splat(Math.cos(b));
f!==a&&(a[4]=f[4],a[5]=f[5],a[6]=f[6],a[7]=f[7],a[12]=f[12],a[13]=f[13],a[14]=f[14],a[15]=f[15]);var h=SIMD.Float32x4.load(f,0);f=SIMD.Float32x4.load(f,8);return SIMD.Float32x4.store(a,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,b),SIMD.Float32x4.mul(f,e))),SIMD.Float32x4.store(a,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(h,e),SIMD.Float32x4.mul(f,b))),a},k.rotateY=h.USE_SIMD?k.SIMD.rotateY:k.scalar.rotateY,k.scalar.rotateZ=function(a,f,b){var e=Math.sin(b);b=Math.cos(b);var h=f[0],k=f[1],g=f[2],d=f[3],
c=f[4],n=f[5],q=f[6],t=f[7];return f!==a&&(a[8]=f[8],a[9]=f[9],a[10]=f[10],a[11]=f[11],a[12]=f[12],a[13]=f[13],a[14]=f[14],a[15]=f[15]),a[0]=h*b+c*e,a[1]=k*b+n*e,a[2]=g*b+q*e,a[3]=d*b+t*e,a[4]=c*b-h*e,a[5]=n*b-k*e,a[6]=q*b-g*e,a[7]=t*b-d*e,a},k.SIMD.rotateZ=function(a,f,b){var e=SIMD.Float32x4.splat(Math.sin(b));b=SIMD.Float32x4.splat(Math.cos(b));f!==a&&(a[8]=f[8],a[9]=f[9],a[10]=f[10],a[11]=f[11],a[12]=f[12],a[13]=f[13],a[14]=f[14],a[15]=f[15]);var h=SIMD.Float32x4.load(f,0);f=SIMD.Float32x4.load(f,
4);return SIMD.Float32x4.store(a,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(h,b),SIMD.Float32x4.mul(f,e))),SIMD.Float32x4.store(a,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,b),SIMD.Float32x4.mul(h,e))),a},k.rotateZ=h.USE_SIMD?k.SIMD.rotateZ:k.scalar.rotateZ,k.fromTranslation=function(a,f){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=f[0],a[13]=f[1],a[14]=f[2],a[15]=1,a},k.fromScaling=function(a,f){return a[0]=f[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=
f[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=f[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},k.fromRotation=function(a,f,b){var e,l,k,g=b[0],d=b[1];b=b[2];var c=Math.sqrt(g*g+d*d+b*b);return Math.abs(c)<h.EPSILON?null:(c=1/c,g*=c,d*=c,b*=c,e=Math.sin(f),l=Math.cos(f),k=1-l,a[0]=g*g*k+l,a[1]=d*g*k+b*e,a[2]=b*g*k-d*e,a[3]=0,a[4]=g*d*k-b*e,a[5]=d*d*k+l,a[6]=b*d*k+g*e,a[7]=0,a[8]=g*b*k+d*e,a[9]=d*b*k-g*e,a[10]=b*b*k+l,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)},k.fromXRotation=function(a,f){var b=Math.sin(f),
e=Math.cos(f);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=e,a[6]=b,a[7]=0,a[8]=0,a[9]=-b,a[10]=e,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},k.fromYRotation=function(a,f){var b=Math.sin(f),e=Math.cos(f);return a[0]=e,a[1]=0,a[2]=-b,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=b,a[9]=0,a[10]=e,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},k.fromZRotation=function(a,f){var b=Math.sin(f),e=Math.cos(f);return a[0]=e,a[1]=b,a[2]=0,a[3]=0,a[4]=-b,a[5]=e,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=
0,a[14]=0,a[15]=1,a},k.fromRotationTranslation=function(a,f,b){var e=f[0],h=f[1],k=f[2],g=f[3],d=e+e,c=h+h,n=k+k;f=e*d;var q=e*c,e=e*n,t=h*c,h=h*n,k=k*n,d=g*d,c=g*c,g=g*n;return a[0]=1-(t+k),a[1]=q+g,a[2]=e-c,a[3]=0,a[4]=q-g,a[5]=1-(f+k),a[6]=h+d,a[7]=0,a[8]=e+c,a[9]=h-d,a[10]=1-(f+t),a[11]=0,a[12]=b[0],a[13]=b[1],a[14]=b[2],a[15]=1,a},k.getTranslation=function(a,f){return a[0]=f[12],a[1]=f[13],a[2]=f[14],a},k.getRotation=function(a,f){var b=f[0]+f[5]+f[10],e=0;return 0<b?(e=2*Math.sqrt(b+1),a[3]=
.25*e,a[0]=(f[6]-f[9])/e,a[1]=(f[8]-f[2])/e,a[2]=(f[1]-f[4])/e):f[0]>f[5]&f[0]>f[10]?(e=2*Math.sqrt(1+f[0]-f[5]-f[10]),a[3]=(f[6]-f[9])/e,a[0]=.25*e,a[1]=(f[1]+f[4])/e,a[2]=(f[8]+f[2])/e):f[5]>f[10]?(e=2*Math.sqrt(1+f[5]-f[0]-f[10]),a[3]=(f[8]-f[2])/e,a[0]=(f[1]+f[4])/e,a[1]=.25*e,a[2]=(f[6]+f[9])/e):(e=2*Math.sqrt(1+f[10]-f[0]-f[5]),a[3]=(f[1]-f[4])/e,a[0]=(f[8]+f[2])/e,a[1]=(f[6]+f[9])/e,a[2]=.25*e),a},k.fromRotationTranslationScale=function(a,f,b,e){var h=f[0],k=f[1],g=f[2],d=f[3],c=h+h,n=k+k,
q=g+g;f=h*c;var t=h*n,h=h*q,r=k*n,k=k*q,g=g*q,c=d*c,n=d*n,d=d*q,q=e[0],v=e[1];e=e[2];return a[0]=(1-(r+g))*q,a[1]=(t+d)*q,a[2]=(h-n)*q,a[3]=0,a[4]=(t-d)*v,a[5]=(1-(f+g))*v,a[6]=(k+c)*v,a[7]=0,a[8]=(h+n)*e,a[9]=(k-c)*e,a[10]=(1-(f+r))*e,a[11]=0,a[12]=b[0],a[13]=b[1],a[14]=b[2],a[15]=1,a},k.fromRotationTranslationScaleOrigin=function(a,f,b,e,h){var l=f[0],g=f[1],d=f[2],c=f[3],k=l+l,q=g+g,t=d+d;f=l*k;var r=l*q,l=l*t,v=g*q,g=g*t,d=d*t,k=c*k,q=c*q,c=c*t,t=e[0],u=e[1];e=e[2];var w=h[0],x=h[1];h=h[2];return a[0]=
(1-(v+d))*t,a[1]=(r+c)*t,a[2]=(l-q)*t,a[3]=0,a[4]=(r-c)*u,a[5]=(1-(f+d))*u,a[6]=(g+k)*u,a[7]=0,a[8]=(l+q)*e,a[9]=(g-k)*e,a[10]=(1-(f+v))*e,a[11]=0,a[12]=b[0]+w-(a[0]*w+a[4]*x+a[8]*h),a[13]=b[1]+x-(a[1]*w+a[5]*x+a[9]*h),a[14]=b[2]+h-(a[2]*w+a[6]*x+a[10]*h),a[15]=1,a},k.fromQuat=function(a,f){var b=f[0],e=f[1],h=f[2],k=f[3],g=b+b,d=e+e,c=h+h,b=b*g,n=e*g,e=e*d,q=h*g,t=h*d,h=h*c,g=k*g,d=k*d,k=k*c;return a[0]=1-e-h,a[1]=n+k,a[2]=q-d,a[3]=0,a[4]=n-k,a[5]=1-b-h,a[6]=t+g,a[7]=0,a[8]=q+d,a[9]=t-g,a[10]=1-
b-e,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},k.frustum=function(a,f,b,e,h,k,g){var d=1/(b-f),c=1/(h-e),l=1/(k-g);return a[0]=2*k*d,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*k*c,a[6]=0,a[7]=0,a[8]=(b+f)*d,a[9]=(h+e)*c,a[10]=(g+k)*l,a[11]=-1,a[12]=0,a[13]=0,a[14]=g*k*2*l,a[15]=0,a},k.perspective=function(a,f,b,e,h){f=1/Math.tan(f/2);var l=1/(e-h);return a[0]=f/b,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(h+e)*l,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*h*e*l,a[15]=0,a},k.perspectiveFromFieldOfView=
function(a,f,b,e){var h=Math.tan(f.upDegrees*Math.PI/180),k=Math.tan(f.downDegrees*Math.PI/180),g=Math.tan(f.leftDegrees*Math.PI/180);f=Math.tan(f.rightDegrees*Math.PI/180);var d=2/(g+f),c=2/(h+k);return a[0]=d,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=c,a[6]=0,a[7]=0,a[8]=-((g-f)*d*.5),a[9]=(h-k)*c*.5,a[10]=e/(b-e),a[11]=-1,a[12]=0,a[13]=0,a[14]=e*b/(b-e),a[15]=0,a},k.ortho=function(a,f,b,e,h,k,g){var d=1/(f-b),c=1/(e-h),l=1/(k-g);return a[0]=-2*d,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*c,a[6]=0,a[7]=0,a[8]=
0,a[9]=0,a[10]=2*l,a[11]=0,a[12]=(f+b)*d,a[13]=(h+e)*c,a[14]=(g+k)*l,a[15]=1,a},k.lookAt=function(a,f,b,e){var l,m,g,d,c,n,q,t,r,v,u=f[0],w=f[1];f=f[2];var x=e[0],y=e[1];e=e[2];var A=b[0],z=b[1];b=b[2];return Math.abs(u-A)<h.EPSILON&&Math.abs(w-z)<h.EPSILON&&Math.abs(f-b)<h.EPSILON?k.identity(a):(q=u-A,t=w-z,r=f-b,v=1/Math.sqrt(q*q+t*t+r*r),q*=v,t*=v,r*=v,l=y*r-e*t,m=e*q-x*r,g=x*t-y*q,v=Math.sqrt(l*l+m*m+g*g),v?(v=1/v,l*=v,m*=v,g*=v):(l=0,m=0,g=0),d=t*g-r*m,c=r*l-q*g,n=q*m-t*l,v=Math.sqrt(d*d+c*c+
n*n),v?(v=1/v,d*=v,c*=v,n*=v):(d=0,c=0,n=0),a[0]=l,a[1]=d,a[2]=q,a[3]=0,a[4]=m,a[5]=c,a[6]=t,a[7]=0,a[8]=g,a[9]=n,a[10]=r,a[11]=0,a[12]=-(l*u+m*w+g*f),a[13]=-(d*u+c*w+n*f),a[14]=-(q*u+t*w+r*f),a[15]=1,a)},k.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"},k.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))},k.add=function(a,f,b){return a[0]=f[0]+b[0],a[1]=f[1]+b[1],a[2]=f[2]+b[2],a[3]=f[3]+b[3],a[4]=f[4]+b[4],a[5]=f[5]+b[5],a[6]=f[6]+b[6],a[7]=f[7]+b[7],a[8]=f[8]+b[8],a[9]=f[9]+b[9],a[10]=f[10]+b[10],a[11]=f[11]+b[11],a[12]=f[12]+b[12],a[13]=f[13]+b[13],a[14]=f[14]+b[14],a[15]=f[15]+b[15],
a},k.subtract=function(a,f,b){return a[0]=f[0]-b[0],a[1]=f[1]-b[1],a[2]=f[2]-b[2],a[3]=f[3]-b[3],a[4]=f[4]-b[4],a[5]=f[5]-b[5],a[6]=f[6]-b[6],a[7]=f[7]-b[7],a[8]=f[8]-b[8],a[9]=f[9]-b[9],a[10]=f[10]-b[10],a[11]=f[11]-b[11],a[12]=f[12]-b[12],a[13]=f[13]-b[13],a[14]=f[14]-b[14],a[15]=f[15]-b[15],a},k.sub=k.subtract,k.multiplyScalar=function(a,f,b){return a[0]=f[0]*b,a[1]=f[1]*b,a[2]=f[2]*b,a[3]=f[3]*b,a[4]=f[4]*b,a[5]=f[5]*b,a[6]=f[6]*b,a[7]=f[7]*b,a[8]=f[8]*b,a[9]=f[9]*b,a[10]=f[10]*b,a[11]=f[11]*
b,a[12]=f[12]*b,a[13]=f[13]*b,a[14]=f[14]*b,a[15]=f[15]*b,a},k.multiplyScalarAndAdd=function(a,f,b,e){return a[0]=f[0]+b[0]*e,a[1]=f[1]+b[1]*e,a[2]=f[2]+b[2]*e,a[3]=f[3]+b[3]*e,a[4]=f[4]+b[4]*e,a[5]=f[5]+b[5]*e,a[6]=f[6]+b[6]*e,a[7]=f[7]+b[7]*e,a[8]=f[8]+b[8]*e,a[9]=f[9]+b[9]*e,a[10]=f[10]+b[10]*e,a[11]=f[11]+b[11]*e,a[12]=f[12]+b[12]*e,a[13]=f[13]+b[13]*e,a[14]=f[14]+b[14]*e,a[15]=f[15]+b[15]*e,a},k.exactEquals=function(a,f){return a[0]===f[0]&&a[1]===f[1]&&a[2]===f[2]&&a[3]===f[3]&&a[4]===f[4]&&
a[5]===f[5]&&a[6]===f[6]&&a[7]===f[7]&&a[8]===f[8]&&a[9]===f[9]&&a[10]===f[10]&&a[11]===f[11]&&a[12]===f[12]&&a[13]===f[13]&&a[14]===f[14]&&a[15]===f[15]},k.equals=function(a,f){var b=a[0],e=a[1],l=a[2],k=a[3],g=a[4],d=a[5],c=a[6],n=a[7],q=a[8],t=a[9],r=a[10],v=a[11],u=a[12],w=a[13],x=a[14],y=a[15],A=f[0],z=f[1],B=f[2],C=f[3],D=f[4],E=f[5],F=f[6],G=f[7],I=f[8],J=f[9],L=f[10],M=f[11],H=f[12],K=f[13],P=f[14],O=f[15];return Math.abs(b-A)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(A))&&Math.abs(e-z)<=
h.EPSILON*Math.max(1,Math.abs(e),Math.abs(z))&&Math.abs(l-B)<=h.EPSILON*Math.max(1,Math.abs(l),Math.abs(B))&&Math.abs(k-C)<=h.EPSILON*Math.max(1,Math.abs(k),Math.abs(C))&&Math.abs(g-D)<=h.EPSILON*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(d-E)<=h.EPSILON*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(c-F)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(n-G)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(G))&&Math.abs(q-I)<=h.EPSILON*Math.max(1,Math.abs(q),Math.abs(I))&&Math.abs(t-J)<=h.EPSILON*
Math.max(1,Math.abs(t),Math.abs(J))&&Math.abs(r-L)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(L))&&Math.abs(v-M)<=h.EPSILON*Math.max(1,Math.abs(v),Math.abs(M))&&Math.abs(u-H)<=h.EPSILON*Math.max(1,Math.abs(u),Math.abs(H))&&Math.abs(w-K)<=h.EPSILON*Math.max(1,Math.abs(w),Math.abs(K))&&Math.abs(x-P)<=h.EPSILON*Math.max(1,Math.abs(x),Math.abs(P))&&Math.abs(y-O)<=h.EPSILON*Math.max(1,Math.abs(y),Math.abs(O))},k})},"esri/layers/vectorTiles/views/2d/engine/Container":function(){define(["require","exports",
"../../../core/tsSupport/extendsHelper","./DisplayObject"],function(h,k,a,f){var b;!function(a){a[a.BEFORE=0]="BEFORE";a[a.ATTACHING=1]="ATTACHING";a[a.DETACHING=2]="DETACHING";a[a.RENDERING=3]="RENDERING";a[a.AFTER=4]="AFTER";a[a.DONE=5]="DONE"}(b||(b={}));return function(e){function f(){var a=null!==e&&e.apply(this,arguments)||this;return a._childrenSet=new Set,a._childrenToAttach=[],a._childrenToDetach=[],a._renderPhase=b.DONE,a.children=[],a}return a(f,e),Object.defineProperty(f.prototype,"numChildren",
{get:function(){return this.children.length},enumerable:!0,configurable:!0}),f.prototype.attach=function(a){return!0},f.prototype.detach=function(a){var b=this.children;a=this.prepareChildrenRenderParameters(a);for(var d=b.length,c=0;d>c;c++){var e=b[c];e.attached&&(this.detachChild(e,a),e.attached=!1,e.parent=null)}},f.prototype.render=function(a){var e=this.prepareChildrenRenderParameters(a);this._renderPhase=b.BEFORE;this.beforeRenderChildren(a,e);this._renderPhase=b.ATTACHING;this.attachChildren(e)||
this.requestRender();this._renderPhase=b.DETACHING;for(var d=this._childrenToDetach;0<d.length;){var c=d.shift();this.detachChild(c,e);c.attached=!1;c.parent=null}this._renderPhase=b.RENDERING;this.renderChildren(e);this._renderPhase=b.AFTER;this.afterRenderChildren(a,e);this._renderPhase=b.DONE},f.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)},f.prototype.addChildAt=function(a,e){if((void 0===e&&(e=this.numChildren),!a)||this.contains(a))return a;var d=a.parent;d&&
d!==this&&d.removeChild(a);e>=this.numChildren?this.children.push(a):this.children.splice(e,0,a);this._childrenSet.add(a);d=this._childrenToDetach.indexOf(a);return-1<d&&this._childrenToDetach.splice(d,1),this._childrenToAttach.push(a),this._renderPhase>=b.RENDERING&&this.requestRender(),a},f.prototype.contains=function(a){return this._childrenSet.has(a)},f.prototype.getChildIndex=function(a){return this.children.indexOf(a)},f.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:
this.children[a]},f.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)},f.prototype.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.getChildIndex(a)):a},f.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet["delete"](a);if(a.attached)this._childrenToDetach.push(a),this._renderPhase>=b.RENDERING&&this.requestRender();else{var e=this._childrenToAttach.indexOf(a);
-1<e&&this._childrenToAttach.splice(e,1)}return a},f.prototype.requestChildRender=function(a){a&&a.parent===this&&this._renderPhase>=b.RENDERING&&this.requestRender()},f.prototype.setChildIndex=function(a,e){var d=this.getChildIndex(a);-1<d&&(this.children.splice(d,1),this.children.splice(e,0,a),this._renderPhase>=b.RENDERING&&this.requestRender())},f.prototype.sortChildren=function(a){return this._renderPhase>b.RENDERING&&this.requestRender(),this.children.sort(a)},f.prototype.attachChildren=function(a){var b=
this._childrenToAttach;if(0===b.length)return!0;for(var d=0===b.length;!d;)d=b.shift(),this.attachChild(d,a)&&(d.attached=!0,d.parent=this),d=0===b.length;return 0===b.length},f.prototype.renderChildren=function(a){for(var b=this.children,d=b.length,c=0;d>c;c++){var e=b[c];e.attached&&this.renderChild(e,a)}},f.prototype.beforeRenderChildren=function(a,b){},f.prototype.afterRenderChildren=function(a,b){},f}(f)})},"esri/layers/vectorTiles/views/2d/engine/DisplayObject":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper"],function(h,k,a){var f=0;return function(){function a(){this.attached=!1;this._opacity=1;this._visible=!0;Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-do-"+f++})}return Object.defineProperty(a.prototype,"opacity",{get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"visible",
{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0}),a.prototype.requestRender=function(){this.parent&&this.parent.requestChildRender(this)},a.prototype.dispose=function(){},a}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/Renderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../GeometryUtils ./BackgroundRenderer ./LineRenderer ./FillRenderer ./SymbolRenderer ./TileInfoRenderer ./FadeRecorder".split(" "),
function(h,k,a,f,b,e,l,m,g,d){return function(){function c(){this._extrudeRotateVector=new Float32Array([0,0,1]);this._extrudeScaleVector=new Float32Array([1,1,1]);this._state={rotation:0,width:0,height:0};this._cachedRotation=this._cachedHeight=this._cachedWidth=0;this._pixelRatio=1}return c.prototype.initialize=function(a,c,f){void 0===f&&(f=!0);this._SpriteMosaic=a;this._glyphMosaic=c;this._ignoreSpeed=!f;this._backgroundRenderer=new b;this._lineRenderer=new e;this._fillRenderer=new l;this._symbolRenderer=
new m;this._tileInfoRenderer=new g;this._fadeRecorder=new d.FadeRecorder(300);this._extrudeMatrix=new Float32Array(16);this._extrudeNoRotationMatrix=new Float32Array(16);this._backgroundColor=new Float32Array([1,0,0,1])},c.prototype.setStateParams=function(b,c,d){this._pixelRatio=c;this._fadeRecorder.recordLevel(d);this._state=b;(this._state.width!==this._cachedWidth||this._state.height!==this._cachedHeight||this._state.rotation!==this._cachedRotation)&&(this._extrudeScaleVector[0]=2/b.width,this._extrudeScaleVector[1]=
-2/b.height,a.identity(this._extrudeMatrix),a.rotate(this._extrudeMatrix,this._extrudeMatrix,-b.rotation*f.C_DEG_TO_RAD,this._extrudeRotateVector),a.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector),a.transpose(this._extrudeMatrix,this._extrudeMatrix),a.identity(this._extrudeNoRotationMatrix),a.scale(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix,this._extrudeScaleVector),a.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix),this._cachedWidth=
this._state.width,this._cachedHeight=this._state.height,this._cachedRotation=this._state.rotation)},c.prototype.drawClippingMasks=function(a,b){if(0!==b.length){a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setClearStencil(0);a.clear(a.gl.STENCIL_BUFFER_BIT);for(var c=0;c<b.length;c++){var d=b[c];d.attached&&d.visible&&(a.setStencilFunctionSeparate(1032,519,d.stencilData.reference,
d.stencilData.mask),a.setStencilWriteMask(d.stencilData.mask),this._backgroundRenderer.renderSolidColor(a,{u_matrix:d.tileTransform.transform,u_normalized_origin:d.tileTransform.displayCoord,u_coord_range:d.coordRange,u_depth:0,u_color:this._backgroundColor}))}a.setColorMask(!0,!0,!0,!0);a.setBlendingEnabled(!0);a.setStencilWriteMask(255)}},c.prototype.renderDebug=function(a,b){var c=b.key;this._backgroundColor.set([c.col%2,c.row%2,0===c.col%2&&0===c.row%2?1:0,.5]);this._backgroundRenderer.renderSolidColor(a,
{u_matrix:b.tileTransform.transform,u_normalized_origin:b.tileTransform.displayCoord,u_coord_range:b.coordRange,u_depth:0,u_color:this._backgroundColor})},c.prototype.renderBucket=function(a,b,c,d,e,f,g,h){switch(b.type){case 0:2!==e&&this._renderBackground(a,c,e,f,g,h);break;case 1:2!==e&&this._renderFill(a,b,c,e,f,g,h);break;case 2:1===e&&this._renderLine(a,b,c,f,g,h);break;case 3:2===e&&this._renderSymbol(a,b,c,d,f,g,h)}},c.prototype.renderTileInfo=function(a,b){this._tileInfoRenderer.render(a,
b)},c.prototype.needsRedraw=function(){return this._fadeRecorder.needsRedraw()},c.prototype._renderBackground=function(a,b,c,d,e,f){this._backgroundRenderer.render(a,b,c,d,e,this._SpriteMosaic,this._SpriteMosaic.pixelRatio,f)},c.prototype._renderLine=function(a,b,c,d,e,f){this._lineRenderer.render(a,b,c,this._state,d,e,this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio,f)},c.prototype._renderFill=function(a,b,c,d,e,f,g){this._fillRenderer.render(a,b,c,this._state.rotation,d,e,f,
this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio,g)},c.prototype._renderSymbol=function(a,b,c,d,e,f,g){var h=!0;d===e.key.level&&(h=!1);a.setStencilTestEnabled(h);this._symbolRenderer.render(a,b,c,this._state.rotation,this._fadeRecorder.getFadeValues(this._ignoreSpeed),e,f,this._SpriteMosaic,this._glyphMosaic,this._extrudeMatrix,this._extrudeNoRotationMatrix,this._SpriteMosaic.pixelRatio,g)},c}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/BackgroundRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject ./vtShaderSnippets".split(" "),
function(h,k,a,f,b,e,l,m){return function(){function g(){this._patternMatrix=a.create();this._color=f.create();this._initialized=!1}return g.prototype.renderSolidColor=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix4fv("u_transformMatrix",b.u_matrix);this._solidProgram.setUniform2fv("u_normalized_origin",b.u_normalized_origin);this._solidProgram.setUniform1f("u_coord_range",b.u_coord_range||
4096);this._solidProgram.setUniform1f("u_depth",b.u_depth||0);this._solidProgram.setUniform4fv("u_color",b.u_color||new Float32Array([1,0,0,1]));a.drawArrays(5,0,4);a.bindVAO()},g.prototype.render=function(b,c,e,f,g,h,l,k){this._initialized||this._initialize(b);var d=g.getPaintValue("background-color",c);k*=g.getPaintValue("background-opacity",c);var m=g.getPaintValue("background-pattern",c),n=void 0!==m,q=d[3]*k,r=n||1>q;if(!(r&&0===e||!r&&1===e)){if(n){b.bindVAO(this._patternVertexArrayObject);
b.bindProgram(this._patternProgram);e=h.getMosaicItemPosition(m,!0);if(!e)return;c=f.coordRange/512/Math.pow(2,Math.floor(c)-f.key.level)/l;a.identity(this._patternMatrix);l=1/(e.size[1]*c);this._patternMatrix[0]=1/(e.size[0]*c);this._patternMatrix[4]=l;h.bind(b,9729,0);this._patternProgram.setUniformMatrix4fv("u_transformMatrix",f.tileTransform.transform);this._patternProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord);this._patternProgram.setUniform1f("u_depth",g.z);this._patternProgram.setUniformMatrix3fv("u_pattern_matrix",
this._patternMatrix);this._patternProgram.setUniform1f("u_opacity",k);this._patternProgram.setUniform2f("u_pattern_tl",e.tl[0],e.tl[1]);this._patternProgram.setUniform2f("u_pattern_br",e.br[0],e.br[1]);this._patternProgram.setUniform1i("u_texture",0)}else this._color[0]=q*d[0],this._color[1]=q*d[1],this._color[2]=q*d[2],this._color[3]=q,b.bindVAO(this._solidVertexArrayObject),b.bindProgram(this._solidProgram),this._solidProgram.setUniformMatrix4fv("u_transformMatrix",f.tileTransform.transform),this._solidProgram.setUniform2fv("u_normalized_origin",
f.tileTransform.displayCoord),this._solidProgram.setUniform1f("u_coord_range",f.coordRange),this._solidProgram.setUniform1f("u_depth",g.z||0),this._solidProgram.setUniform4fv("u_color",this._color);b.drawArrays(5,0,4);b.bindVAO()}},g.prototype._initialize=function(a){if(this._initialized)return!0;var c={a_pos:0},d=new b(a,m.backgroundVS,m.backgroundFS,c);if(!d)return!1;var f=new b(a,m.patternFillShaderVS,m.patternFillShaderFS,c);if(!f)return!1;var g={geometry:[{name:"a_pos",count:2,type:5120,offset:0,
stride:2,normalized:!1,divisor:0}]},h=new Int8Array([0,0,1,0,0,1,1,1]),k=l.createVertex(a,35044,h),k=new e(a,c,g,{geometry:k}),h=new Int16Array([0,0,4096,0,0,4096,4096,4096]),h=l.createVertex(a,35044,h);a=new e(a,c,{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:h});return this._solidProgram=d,this._patternProgram=f,this._vertexAttributes=g,this._solidVertexArrayObject=k,this._patternVertexArrayObject=a,this._initialized=!0,!0},g}()})},"esri/layers/vectorTiles/core/libs/gl-matrix/mat3":function(){define(["./common"],
function(h){var k={};return k.create=function(){var a=new h.ARRAY_TYPE(9);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},k.fromMat4=function(a,f){return a[0]=f[0],a[1]=f[1],a[2]=f[2],a[3]=f[4],a[4]=f[5],a[5]=f[6],a[6]=f[8],a[7]=f[9],a[8]=f[10],a},k.clone=function(a){var f=new h.ARRAY_TYPE(9);return f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],f[4]=a[4],f[5]=a[5],f[6]=a[6],f[7]=a[7],f[8]=a[8],f},k.copy=function(a,f){return a[0]=f[0],a[1]=f[1],a[2]=f[2],a[3]=f[3],a[4]=f[4],a[5]=
f[5],a[6]=f[6],a[7]=f[7],a[8]=f[8],a},k.fromValues=function(a,f,b,e,l,k,g,d,c){var m=new h.ARRAY_TYPE(9);return m[0]=a,m[1]=f,m[2]=b,m[3]=e,m[4]=l,m[5]=k,m[6]=g,m[7]=d,m[8]=c,m},k.set=function(a,f,b,e,h,k,g,d,c,n){return a[0]=f,a[1]=b,a[2]=e,a[3]=h,a[4]=k,a[5]=g,a[6]=d,a[7]=c,a[8]=n,a},k.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},k.transpose=function(a,f){if(a===f){var b=f[1],e=f[2],h=f[5];a[1]=f[3];a[2]=f[6];a[3]=b;a[5]=f[7];a[6]=e;a[7]=h}else a[0]=
f[0],a[1]=f[3],a[2]=f[6],a[3]=f[1],a[4]=f[4],a[5]=f[7],a[6]=f[2],a[7]=f[5],a[8]=f[8];return a},k.invert=function(a,f){var b=f[0],e=f[1],h=f[2],k=f[3],g=f[4],d=f[5],c=f[6],n=f[7],q=f[8],t=q*g-d*n,r=-q*k+d*c,v=n*k-g*c,u=b*t+e*r+h*v;return u?(u=1/u,a[0]=t*u,a[1]=(-q*e+h*n)*u,a[2]=(d*e-h*g)*u,a[3]=r*u,a[4]=(q*b-h*c)*u,a[5]=(-d*b+h*k)*u,a[6]=v*u,a[7]=(-n*b+e*c)*u,a[8]=(g*b-e*k)*u,a):null},k.adjoint=function(a,f){var b=f[0],e=f[1],h=f[2],k=f[3],g=f[4],d=f[5],c=f[6],n=f[7],q=f[8];return a[0]=g*q-d*n,a[1]=
h*n-e*q,a[2]=e*d-h*g,a[3]=d*c-k*q,a[4]=b*q-h*c,a[5]=h*k-b*d,a[6]=k*n-g*c,a[7]=e*c-b*n,a[8]=b*g-e*k,a},k.determinant=function(a){var f=a[3],b=a[4],e=a[5],h=a[6],k=a[7],g=a[8];return a[0]*(g*b-e*k)+a[1]*(-g*f+e*h)+a[2]*(k*f-b*h)},k.multiply=function(a,f,b){var e=f[0],h=f[1],k=f[2],g=f[3],d=f[4],c=f[5],n=f[6],q=f[7];f=f[8];var t=b[0],r=b[1],v=b[2],u=b[3],w=b[4],x=b[5],y=b[6],A=b[7];b=b[8];return a[0]=t*e+r*g+v*n,a[1]=t*h+r*d+v*q,a[2]=t*k+r*c+v*f,a[3]=u*e+w*g+x*n,a[4]=u*h+w*d+x*q,a[5]=u*k+w*c+x*f,a[6]=
y*e+A*g+b*n,a[7]=y*h+A*d+b*q,a[8]=y*k+A*c+b*f,a},k.mul=k.multiply,k.translate=function(a,f,b){var e=f[0],h=f[1],k=f[2],g=f[3],d=f[4],c=f[5],n=f[6],q=f[7];f=f[8];var t=b[0];b=b[1];return a[0]=e,a[1]=h,a[2]=k,a[3]=g,a[4]=d,a[5]=c,a[6]=t*e+b*g+n,a[7]=t*h+b*d+q,a[8]=t*k+b*c+f,a},k.rotate=function(a,f,b){var e=f[0],h=f[1],k=f[2],g=f[3],d=f[4],c=f[5],n=f[6],q=f[7];f=f[8];var t=Math.sin(b);b=Math.cos(b);return a[0]=b*e+t*g,a[1]=b*h+t*d,a[2]=b*k+t*c,a[3]=b*g-t*e,a[4]=b*d-t*h,a[5]=b*c-t*k,a[6]=n,a[7]=q,a[8]=
f,a},k.scale=function(a,f,b){var e=b[0];b=b[1];return a[0]=e*f[0],a[1]=e*f[1],a[2]=e*f[2],a[3]=b*f[3],a[4]=b*f[4],a[5]=b*f[5],a[6]=f[6],a[7]=f[7],a[8]=f[8],a},k.fromTranslation=function(a,f){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=f[0],a[7]=f[1],a[8]=1,a},k.fromRotation=function(a,f){var b=Math.sin(f),e=Math.cos(f);return a[0]=e,a[1]=b,a[2]=0,a[3]=-b,a[4]=e,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},k.fromScaling=function(a,f){return a[0]=f[0],a[1]=0,a[2]=0,a[3]=0,a[4]=f[1],a[5]=0,a[6]=0,a[7]=0,
a[8]=1,a},k.fromMat2d=function(a,f){return a[0]=f[0],a[1]=f[1],a[2]=0,a[3]=f[2],a[4]=f[3],a[5]=0,a[6]=f[4],a[7]=f[5],a[8]=1,a},k.fromQuat=function(a,f){var b=f[0],e=f[1],h=f[2],k=f[3],g=b+b,d=e+e,c=h+h,b=b*g,n=e*g,e=e*d,q=h*g,t=h*d,h=h*c,g=k*g,d=k*d,k=k*c;return a[0]=1-e-h,a[3]=n-k,a[6]=q+d,a[1]=n+k,a[4]=1-b-h,a[7]=t-g,a[2]=q-d,a[5]=t+g,a[8]=1-b-e,a},k.normalFromMat4=function(a,f){var b=f[0],e=f[1],h=f[2],k=f[3],g=f[4],d=f[5],c=f[6],n=f[7],q=f[8],t=f[9],r=f[10],v=f[11],u=f[12],w=f[13],x=f[14],y=f[15],
A=b*d-e*g,z=b*c-h*g,B=b*n-k*g,C=e*c-h*d,D=e*n-k*d,E=h*n-k*c,F=q*w-t*u,G=q*x-r*u,q=q*y-v*u,I=t*x-r*w,t=t*y-v*w,r=r*y-v*x;return(v=A*r-z*t+B*I+C*q-D*G+E*F)?(v=1/v,a[0]=(d*r-c*t+n*I)*v,a[1]=(c*q-g*r-n*G)*v,a[2]=(g*t-d*q+n*F)*v,a[3]=(h*t-e*r-k*I)*v,a[4]=(b*r-h*q+k*G)*v,a[5]=(e*q-b*t-k*F)*v,a[6]=(w*E-x*D+y*C)*v,a[7]=(x*B-u*E-y*z)*v,a[8]=(u*D-w*B+y*A)*v,a):null},k.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"},k.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))},k.add=function(a,f,b){return a[0]=f[0]+b[0],a[1]=f[1]+b[1],a[2]=f[2]+b[2],a[3]=f[3]+b[3],a[4]=f[4]+b[4],a[5]=f[5]+b[5],a[6]=f[6]+b[6],a[7]=f[7]+b[7],a[8]=f[8]+b[8],a},k.subtract=function(a,f,b){return a[0]=f[0]-b[0],a[1]=f[1]-b[1],a[2]=f[2]-b[2],a[3]=f[3]-b[3],a[4]=f[4]-b[4],a[5]=f[5]-b[5],a[6]=f[6]-b[6],a[7]=f[7]-b[7],a[8]=f[8]-b[8],a},k.sub=k.subtract,k.multiplyScalar=
function(a,f,b){return a[0]=f[0]*b,a[1]=f[1]*b,a[2]=f[2]*b,a[3]=f[3]*b,a[4]=f[4]*b,a[5]=f[5]*b,a[6]=f[6]*b,a[7]=f[7]*b,a[8]=f[8]*b,a},k.multiplyScalarAndAdd=function(a,f,b,e){return a[0]=f[0]+b[0]*e,a[1]=f[1]+b[1]*e,a[2]=f[2]+b[2]*e,a[3]=f[3]+b[3]*e,a[4]=f[4]+b[4]*e,a[5]=f[5]+b[5]*e,a[6]=f[6]+b[6]*e,a[7]=f[7]+b[7]*e,a[8]=f[8]+b[8]*e,a},k.exactEquals=function(a,f){return a[0]===f[0]&&a[1]===f[1]&&a[2]===f[2]&&a[3]===f[3]&&a[4]===f[4]&&a[5]===f[5]&&a[6]===f[6]&&a[7]===f[7]&&a[8]===f[8]},k.equals=function(a,
f){var b=a[0],e=a[1],l=a[2],k=a[3],g=a[4],d=a[5],c=a[6],n=a[7],q=a[8],t=f[0],r=f[1],v=f[2],u=f[3],w=f[4],x=f[5],y=a[6],A=f[7],z=f[8];return Math.abs(b-t)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(t))&&Math.abs(e-r)<=h.EPSILON*Math.max(1,Math.abs(e),Math.abs(r))&&Math.abs(l-v)<=h.EPSILON*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(k-u)<=h.EPSILON*Math.max(1,Math.abs(k),Math.abs(u))&&Math.abs(g-w)<=h.EPSILON*Math.max(1,Math.abs(g),Math.abs(w))&&Math.abs(d-x)<=h.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))&&
Math.abs(c-y)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(n-A)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(q-z)<=h.EPSILON*Math.max(1,Math.abs(q),Math.abs(z))},k})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec4":function(){define(["./common"],function(h){var k={};return k.create=function(){var a=new h.ARRAY_TYPE(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a},k.clone=function(a){var f=new h.ARRAY_TYPE(4);return f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],f},k.fromValues=function(a,
f,b,e){var l=new h.ARRAY_TYPE(4);return l[0]=a,l[1]=f,l[2]=b,l[3]=e,l},k.copy=function(a,f){return a[0]=f[0],a[1]=f[1],a[2]=f[2],a[3]=f[3],a},k.set=function(a,f,b,e,h){return a[0]=f,a[1]=b,a[2]=e,a[3]=h,a},k.add=function(a,f,b){return a[0]=f[0]+b[0],a[1]=f[1]+b[1],a[2]=f[2]+b[2],a[3]=f[3]+b[3],a},k.subtract=function(a,f,b){return a[0]=f[0]-b[0],a[1]=f[1]-b[1],a[2]=f[2]-b[2],a[3]=f[3]-b[3],a},k.sub=k.subtract,k.multiply=function(a,f,b){return a[0]=f[0]*b[0],a[1]=f[1]*b[1],a[2]=f[2]*b[2],a[3]=f[3]*
b[3],a},k.mul=k.multiply,k.divide=function(a,f,b){return a[0]=f[0]/b[0],a[1]=f[1]/b[1],a[2]=f[2]/b[2],a[3]=f[3]/b[3],a},k.div=k.divide,k.ceil=function(a,f){return a[0]=Math.ceil(f[0]),a[1]=Math.ceil(f[1]),a[2]=Math.ceil(f[2]),a[3]=Math.ceil(f[3]),a},k.floor=function(a,f){return a[0]=Math.floor(f[0]),a[1]=Math.floor(f[1]),a[2]=Math.floor(f[2]),a[3]=Math.floor(f[3]),a},k.min=function(a,f,b){return a[0]=Math.min(f[0],b[0]),a[1]=Math.min(f[1],b[1]),a[2]=Math.min(f[2],b[2]),a[3]=Math.min(f[3],b[3]),a},
k.max=function(a,f,b){return a[0]=Math.max(f[0],b[0]),a[1]=Math.max(f[1],b[1]),a[2]=Math.max(f[2],b[2]),a[3]=Math.max(f[3],b[3]),a},k.round=function(a,f){return a[0]=Math.round(f[0]),a[1]=Math.round(f[1]),a[2]=Math.round(f[2]),a[3]=Math.round(f[3]),a},k.scale=function(a,f,b){return a[0]=f[0]*b,a[1]=f[1]*b,a[2]=f[2]*b,a[3]=f[3]*b,a},k.scaleAndAdd=function(a,f,b,e){return a[0]=f[0]+b[0]*e,a[1]=f[1]+b[1]*e,a[2]=f[2]+b[2]*e,a[3]=f[3]+b[3]*e,a},k.distance=function(a,f){var b=f[0]-a[0],e=f[1]-a[1],h=f[2]-
a[2],k=f[3]-a[3];return Math.sqrt(b*b+e*e+h*h+k*k)},k.dist=k.distance,k.squaredDistance=function(a,f){var b=f[0]-a[0],e=f[1]-a[1],h=f[2]-a[2],k=f[3]-a[3];return b*b+e*e+h*h+k*k},k.sqrDist=k.squaredDistance,k.length=function(a){var f=a[0],b=a[1],e=a[2];a=a[3];return Math.sqrt(f*f+b*b+e*e+a*a)},k.len=k.length,k.squaredLength=function(a){var f=a[0],b=a[1],e=a[2];a=a[3];return f*f+b*b+e*e+a*a},k.sqrLen=k.squaredLength,k.negate=function(a,f){return a[0]=-f[0],a[1]=-f[1],a[2]=-f[2],a[3]=-f[3],a},k.inverse=
function(a,f){return a[0]=1/f[0],a[1]=1/f[1],a[2]=1/f[2],a[3]=1/f[3],a},k.normalize=function(a,f){var b=f[0],e=f[1],h=f[2],k=f[3],g=b*b+e*e+h*h+k*k;return 0<g&&(g=1/Math.sqrt(g),a[0]=b*g,a[1]=e*g,a[2]=h*g,a[3]=k*g),a},k.dot=function(a,f){return a[0]*f[0]+a[1]*f[1]+a[2]*f[2]+a[3]*f[3]},k.lerp=function(a,f,b,e){var h=f[0],k=f[1],g=f[2];f=f[3];return a[0]=h+e*(b[0]-h),a[1]=k+e*(b[1]-k),a[2]=g+e*(b[2]-g),a[3]=f+e*(b[3]-f),a},k.random=function(a,f){return f=f||1,a[0]=h.RANDOM(),a[1]=h.RANDOM(),a[2]=h.RANDOM(),
a[3]=h.RANDOM(),k.normalize(a,a),k.scale(a,a,f),a},k.transformMat4=function(a,f,b){var e=f[0],h=f[1],k=f[2];f=f[3];return a[0]=b[0]*e+b[4]*h+b[8]*k+b[12]*f,a[1]=b[1]*e+b[5]*h+b[9]*k+b[13]*f,a[2]=b[2]*e+b[6]*h+b[10]*k+b[14]*f,a[3]=b[3]*e+b[7]*h+b[11]*k+b[15]*f,a},k.transformQuat=function(a,f,b){var e=f[0],h=f[1],k=f[2],g=b[0],d=b[1],c=b[2];b=b[3];var n=b*e+d*k-c*h,q=b*h+c*e-g*k,t=b*k+g*h-d*e,e=-g*e-d*h-c*k;return a[0]=n*b+e*-g+q*-c-t*-d,a[1]=q*b+e*-d+t*-g-n*-c,a[2]=t*b+e*-c+n*-d-q*-g,a[3]=f[3],a},
k.forEach=function(){var a=k.create();return function(f,b,e,h,k,g){b||(b=4);e||(e=0);for(h=h?Math.min(h*b+e,f.length):f.length;h>e;e+=b)a[0]=f[e],a[1]=f[e+1],a[2]=f[e+2],a[3]=f[e+3],k(a,a,g),f[e]=a[0],f[e+1]=a[1],f[e+2]=a[2],f[e+3]=a[3];return f}}(),k.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},k.exactEquals=function(a,f){return a[0]===f[0]&&a[1]===f[1]&&a[2]===f[2]&&a[3]===f[3]},k.equals=function(a,f){var b=a[0],e=a[1],l=a[2],k=a[3],g=f[0],d=f[1],c=f[2],n=f[3];return Math.abs(b-
g)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(g))&&Math.abs(e-d)<=h.EPSILON*Math.max(1,Math.abs(e),Math.abs(d))&&Math.abs(l-c)<=h.EPSILON*Math.max(1,Math.abs(l),Math.abs(c))&&Math.abs(k-n)<=h.EPSILON*Math.max(1,Math.abs(k),Math.abs(n))},k})},"esri/layers/vectorTiles/views/webgl/Program":function(){define(["require","exports","dojo/has"],function(h,k,a){var f=a("dojo-debug-messages");h=function(){function a(b,f,h,g,d){this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=
!1;this._fShader=this._vShader=null;this._defines=void 0;this._nameToUniformLocation={};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};b||console.error("RenderingContext isn't initialized!");0===f.length&&console.error("Shaders source should not be empty!");this._context=b;this._vertexShaderSource=f;this._fragmentShaderSource=h;this._defines=d;this._id=a._nextId++;
this._locations=g}return Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){var a=this._context.gl;this._vShader&&(a.deleteShader(this._vShader),this._vShader=null);this._fShader&&(a.deleteShader(this._fShader),
this._fShader=null);this._glName&&(a.deleteProgram(this._glName),this._glName=null)},a.prototype.initialize=function(){if(!this._initialized){this._vShader=this._loadShader(35633);this._fShader=this._loadShader(35632);this._vShader&&this._fShader||console.error("Error loading shaders!");var a=this._context.gl,b=a.createProgram();a.attachShader(b,this._vShader);a.attachShader(b,this._fShader);for(var f in this._locations)a.bindAttribLocation(b,this._locations[f],f);a.linkProgram(b);a.getProgramParameter(b,
a.LINK_STATUS)||console.error("Could not initialize shader\nVALIDATE_STATUS: "+a.getProgramParameter(b,a.VALIDATE_STATUS)+", gl error ["+a.getError()+"]infoLog: "+a.getProgramInfoLog(b));this._glName=b;this._initialized=!0}},a.prototype.getUniformLocation=function(a){return this.initialize(),void 0===this._nameToUniformLocation[a]&&(this._nameToUniformLocation[a]=this._context.gl.getUniformLocation(this._glName,a)),this._nameToUniformLocation[a]},a.prototype.hasUniform=function(a){return null!==this.getUniformLocation(a)},
a.prototype.getAttribLocation=function(a){return this.initialize(),void 0===this._nameToAttribLocation[a]&&(this._nameToAttribLocation[a]=this._context.gl.getAttribLocation(this._glName,a)),this._nameToAttribLocation[a]},a.prototype.setUniform1i=function(a,b){var e=this._nameToUniform1[a];if(void 0===e||b!==e)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(a),b),this._nameToUniform1[a]=b},a.prototype.setUniform1f=function(a,b){var e=this._nameToUniform1[a];if(void 0===
e||b!==e)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(a),b),this._nameToUniform1[a]=b},a.prototype.setUniform1fv=function(b,f){var e=this._nameToUniform2[b];void 0!==e&&a._arraysEqual(f,e)||(this._context.bindProgram(this),this._context.gl.uniform1fv(this.getUniformLocation(b),f),void 0===e?this._nameToUniform2[b]=new Float32Array(f):e.set(f))},a.prototype.setUniform2f=function(a,b,f){var e=this._nameToUniform2[a];if(void 0===e||b!==e[0]||f!==e[1])this._context.bindProgram(this),
this._context.gl.uniform2f(this.getUniformLocation(a),b,f),void 0===e?this._nameToUniform2[a]=new Float32Array([b,f]):(e[0]=b,e[1]=f)},a.prototype.setUniform2fv=function(b,h){f&&0!==h.length%2&&console.error("Value array must have even number of elements!");var e=this._nameToUniform2[b];void 0!==e&&a._arraysEqual(h,e)||(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(b),h),void 0===e?this._nameToUniform2[b]=new Float32Array(h):e.set(h))},a.prototype.setUniform3f=
function(a,b,f,g){var d=this._nameToUniform3[a];if(void 0===d||b!==d[0]||f!==d[1]||g!==d[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(a),b,f,g),void 0===d?this._nameToUniform3[a]=new Float32Array([b,f,g]):(d[0]=b,d[1]=f,d[2]=g)},a.prototype.setUniform3fv=function(b,h){f&&0!==h.length%3&&console.error("Value array must contain sets of three values!");var e=this._nameToUniform3[b];void 0!==e&&a._arraysEqual(h,e)||(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(b),
h),void 0===e?this._nameToUniform3[b]=new Float32Array(h):e.set(h))},a.prototype.setUniform4f=function(a,b,f,g,d){var c=this._nameToUniform4[a];if(void 0===c||b!==c[0]||f!==c[1]||g!==c[2]||d!==c[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(a),b,f,g,d),void 0===c?this._nameToUniform4[a]=new Float32Array([b,f,g,d]):(c[0]=b,c[1]=f,c[2]=g,c[3]=d)},a.prototype.setUniform4fv=function(b,h){f&&0!==h.length%4&&console.error("Value array must contain sets of four values!");
var e=this._nameToUniform4[b];void 0!==e&&a._arraysEqual(h,e)||(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(b),h),void 0===e?this._nameToUniform4[b]=new Float32Array(h):e.set(h))},a.prototype.setUniformMatrix3fv=function(b,h,k){void 0===k&&(k=!1);f&&0!==h.length%9&&console.error("Matrix array must contain sets ot 9 elements!");var e=this._nameToUniformMatrix3[b];void 0!==e&&(9===e.length?a._matrix3Equal(e,h):a._arraysEqual(h,e))||(this._context.bindProgram(this),
this._context.gl.uniformMatrix3fv(this.getUniformLocation(b),k,h),void 0===e?this._nameToUniformMatrix3[b]=new Float32Array(h):e.set(h))},a.prototype.setUniformMatrix4fv=function(b,h,k){void 0===k&&(k=!1);f&&0!==h.length%16&&console.error("Matrix array must contain sets ot 16 elements!");var e=this._nameToUniformMatrix4[b];void 0!==e&&(16===e.length?a._matrix4Equal(e,h):a._arraysEqual(h,e))||(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(b),k,h),void 0===
e?this._nameToUniformMatrix4[b]=new Float32Array(h):e.set(h))},a._padToThree=function(a){var b=a.toString();return 1E3>a&&(b=("  "+a).slice(-3)),b},a.prototype._addLineNumbers=function(b){var e=2;return b.replace(/\n/g,function(){return"\n"+a._padToThree(e++)+":"})},a.prototype._loadShader=function(a){var b=35633===a?this._vertexShaderSource:this._fragmentShaderSource;if(void 0!==this._defines){var e="";if(Array.isArray(this._defines))for(var f=0,d=this._defines;f<d.length;f++)var c=d[f],e=e+("#define "+
c+"\n");else for(c in this._defines)e+="#define "+c+"\n";b=e+b}e=this._context.gl;a=e.createShader(a);return e.shaderSource(a,b),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)||(console.error(e.getShaderInfoLog(a)),console.error(this._addLineNumbers(b))),a},a._matrix4Equal=function(a,b){return f&&(16!==a.length||16!==b.length)&&console.error("Matrix object must contain 16 elements!"),a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&
a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]},a._matrix3Equal=function(a,b){return f&&(9!==a.length||9!==b.length)&&console.error("Matrix object must contain 16 elements!"),a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]},a._arraysEqual=function(a,b){if(a.length!==b.length)return!1;for(var e=0;e<a.length;++e)if(a[e]!==b[e])return!1;return!0},a}();return h._nextId=
0,h})},"esri/layers/vectorTiles/views/webgl/VertexArrayObject":function(){define(["require","exports"],function(h,k){var a=function(){function a(b,e,f,h,g){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=!1;this._context=b;this._layout=f;this._buffers=h;this._locations=e;g&&(this._indexBuffer=g);this._id=a._nextId++}return Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,
"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},
enumerable:!0,configurable:!0}),a.prototype.dispose=function(a){void 0===a&&(a=!0);var b=this._context.extensions.vao;b&&this._glName&&(b.deleteVertexArrayOES(this._glName),this._glName=null);if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),a){for(var f in this._buffers)this._buffers[f].dispose(),delete this._buffers[f];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}},a.prototype.initialize=function(){if(!this._initialized){var a=this._context.extensions.vao;
if(a){var e=a.createVertexArrayOES();a.bindVertexArrayOES(e);this._bindLayout();a.bindVertexArrayOES(null);this._glName=e}this._initialized=!0}},a.prototype.bind=function(){this.initialize();var a=this._context.extensions.vao;a?a.bindVertexArrayOES(this.glName):(this._context.bindVAO(null),this._bindLayout())},a.prototype._bindLayout=function(){var a=this._buffers,e=this._context.extensions.vao,f=this._layout,h=this._indexBuffer;a||console.error("Vertex buffer dictionary is empty!");var g,d,c=this._context.gl,
k=0,q;for(q in a)for((g=a[q])||console.error("Vertex buffer is uninitialized!"),(d=f[q])||console.error("Vertex element descriptor is empty!"),this._context.bindBuffer(g),k=0;k<d.length;++k){g=d[k];var t=this._locations[g.name],r=g.baseInstance?g.baseInstance*g.stride:0;if(void 0===t&&console.error("There is no location for vertex attribute '"+g.name+"' defined."),g.baseInstance&&!g.divisor&&console.error("Vertex attribute '"+g.name+"' uses baseInstanceOffset without divisor."),4>=g.count){if(c.enableVertexAttribArray(t),
c.vertexAttribPointer(t,g.count,g.type,g.normalized,g.stride,g.offset+r),g.divisor&&0<g.divisor){var v=this._context.extensions.angleInstancedArrays;v&&v.vertexAttribDivisorANGLE(t,g.divisor)}}else if(16===g.count&&5126===g.type)for(var u=0;4>u;u++)(c.enableVertexAttribArray(t+u),c.vertexAttribPointer(t+u,4,g.type,g.normalized,g.stride,g.offset+16*u+r),g.divisor&&0<g.divisor)&&(v=this._context.extensions.angleInstancedArrays)&&v.vertexAttribDivisorANGLE(t+u,g.divisor);else console.error("Unsupported vertex attribute element count: "+
g.count)}h&&(e?c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,h.glName):this._context.bindBuffer(h))},a.prototype.unbind=function(){this.initialize();var a=this._context.extensions.vao;a?a.bindVertexArrayOES(null):this._unbindLayout()},a.prototype._unbindLayout=function(){var a=this._buffers,e=this._layout,f=this._locations,h=this._context;a||console.error("Vertex buffer dictionary is empty!");var g,d,c,k=h.gl,q=0,t=0,r;for(r in a){(g=a[r])||console.error("Vertex buffer is uninitialized!");d=e[r];q=0;for(t=
d.length;t>q;++q)c=d[q],k.disableVertexAttribArray(f[c.name]);h.unbindBuffer(g.bufferType)}(a=this._indexBuffer)&&h.unbindBuffer(a.bufferType)},a}();return a._nextId=0,a})},"esri/layers/vectorTiles/views/webgl/BufferObject":function(){define(["require","exports"],function(h,k){var a=function(){function a(b,e,f,h){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=b;this._bufferType=e;this._usage=f;this._id=a._nextId++;this._glName=
this._context.gl.createBuffer();h&&this.setData(h)}return a.createIndex=function(b,e,f){return new a(b,34963,e,f)},a.createVertex=function(b,e,f){return new a(b,34962,e,f)},Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,
"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0}),a.prototype.dispose=
function(){this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null)},a.prototype.setData=function(a){if(a){if("number"==typeof a)0>a&&console.error("Buffer size cannot be negative!"),this._size=a;else{var b=a.byteLength;a instanceof Uint16Array&&(b/=2,this._indexType=5123);a instanceof Uint32Array&&(b/=4,this._indexType=5125);this._size=b}b=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,a,this._usage);
this._context.bindVAO(b)}},a.prototype.setSubData=function(a,e,f,h){if(void 0===e&&(e=0),void 0===f&&(f=0),a){(0>e||e>=this._size)&&console.error("offset is out of range!");var b=e,d=f,c=h,l=a.byteLength;a instanceof Uint16Array&&(l/=2,b*=2,d*=2,c*=2);a instanceof Uint32Array&&(l/=4,b*=4,d*=4,c*=2);void 0===h&&(h=l-1);f>=h&&console.error("end must be bigger than start!");e+f-h>this._size&&console.error("An attempt to write beyond the end of the buffer!");e=this._context.getBoundVAO();this._context.bindVAO(null);
this._context.bindBuffer(this);this._context.gl.bufferSubData(this._bufferType,b,(a instanceof ArrayBuffer?a:a.buffer).slice(d,c));this._context.bindVAO(e)}},a}();return a._nextId=0,a})},"esri/layers/vectorTiles/views/vectorTiles/renderers/vtShaderSnippets":function(){define("require exports ../../webgl/ShaderSnippets dojo/text!./Shaders.xml dojo/text!./shaders/background.vs.glsl dojo/text!./shaders/background.fs.glsl dojo/text!./shaders/lineShader.vs.glsl dojo/text!./shaders/lineShader.fs.glsl dojo/text!./shaders/patternLineShader.vs.glsl dojo/text!./shaders/patternLineShader.fs.glsl dojo/text!./shaders/lineJoinShader.vs.glsl dojo/text!./shaders/lineJoinShader.fs.glsl dojo/text!./shaders/lineJoinQuadShader.vs.glsl dojo/text!./shaders/lineJoinQuadShader.fs.glsl dojo/text!./shaders/solidFillShader.vs.glsl dojo/text!./shaders/solidFillShader.fs.glsl dojo/text!./shaders/patternFillShader.vs.glsl dojo/text!./shaders/patternFillShader.fs.glsl dojo/text!./shaders/fillOutlineShader.vs.glsl dojo/text!./shaders/fillOutlineShader.fs.glsl dojo/text!./shaders/iconShader.vs.glsl dojo/text!./shaders/iconShader.fs.glsl dojo/text!./shaders/sdfShader.vs.glsl dojo/text!./shaders/sdfShader.fs.glsl dojo/text!./shaders/tileInfo.vs.glsl dojo/text!./shaders/tileInfo.fs.glsl".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u,w,x,y,A,z,B,C,D,E){function F(a,b){G+='\x3csnippet name\x3d"'+a+'"\x3e\x3c![CDATA[';G+=b;G+="]]\x3e\x3c/snippet\x3e"}var G="",G=G+'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e',G=G+"\x3csnippets\x3e";F("backgroundVS",b);F("backgroundFS",e);F("lineShaderVS",l);F("lineShaderFS",m);F("patternLineShaderVS",g);F("patternLineShaderFS",d);F("lineJoinShaderVS",c);F("lineJoinShaderFS",n);F("lineJoinQuadShaderVS",q);F("lineJoinQuadShaderFS",t);F("solidFillShaderVS",
r);F("solidFillShaderFS",v);F("patternFillShaderVS",u);F("patternFillShaderFS",w);F("fillOutlineShaderVS",x);F("fillOutlineShaderFS",y);F("iconShaderVS",A);F("iconShaderFS",z);F("sdfShaderVS",B);F("sdfShaderFS",C);F("tileInfoVS",D);F("tileInfoFS",E);G+="\x3c/snippets\x3e";h=new a;return a.parse(G,h),a.parse(f,h),h})},"esri/layers/vectorTiles/views/webgl/ShaderSnippets":function(){define(["require","exports","dojox/xml/parser"],function(h,k,a){return function(){function f(a){if(a)for(var b in a)this[a[b]]=
a[b]}return f.parse=function(b,e){for(var f=a.parse(b).getElementsByTagName("snippet"),h=/\$[a-zA-Z][a-zA-Z0-9]*(?:\([^\(\)]*\))?[ \t]*/,g=/[\$\s]+/g,d=/\(([^\(\)]*)\)/,c=0;c<f.length;c++){for(var k=f[c].getAttribute("name"),q=f[c].textContent,t=void 0;null!==(t=q.match(h));){var r=t[0].replace(g,""),v=r.match(d),u=void 0;v&&(u=v[1].split(",").map(function(a){return a.trim()}));r=r.replace(d,"");u=e._instantiate(r,u);q=q.replace(t[0],u)}e[k]=q}},f.prototype._instantiate=function(a,e){var b=this[a];
e||(e=[]);for(var f;f=b.match(/\$(\d+)/);)var g=parseInt(f[1],10),b=b.replace(f[0],e[g]);return b},f}()})},"dojox/xml/parser":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(h){h.getObject("xml.parser",!0,dojox);dojox.xml.parser.parse=function(k,a){var f=h.doc,b;a=a||"text/xml";if(k&&h.trim(k)&&"DOMParser"in h.global){b=(new DOMParser).parseFromString(k,a);f=b.documentElement;if("parsererror"==f.nodeName&&"http://www.mozilla.org/newlayout/xml/parsererror.xml"==
f.namespaceURI){var e=f.getElementsByTagNameNS("http://www.mozilla.org/newlayout/xml/parsererror.xml","sourcetext")[0];e&&(e=e.firstChild.data);throw Error("Error parsing text "+f.firstChild.data+" \n"+e);}return b}if("ActiveXObject"in h.global){f=function(a){return"MSXML"+a+".DOMDocument"};f=["Microsoft.XMLDOM",f(6),f(4),f(3),f(2)];h.some(f,function(a){try{b=new ActiveXObject(a)}catch(g){return!1}return!0});if(k&&b&&(b.async=!1,b.loadXML(k),f=b.parseError,0!==f.errorCode))throw Error("Line: "+f.line+
"\nCol: "+f.linepos+"\nReason: "+f.reason+"\nError Code: "+f.errorCode+"\nSource: "+f.srcText);if(b)return b}else if(f.implementation&&f.implementation.createDocument){if(k&&h.trim(k)&&f.createElement){e=f.createElement("xml");e.innerHTML=k;var l=f.implementation.createDocument("foo","",null);h.forEach(e.childNodes,function(a){l.importNode(a,!0)});return l}return f.implementation.createDocument("","",null)}return null};dojox.xml.parser.textContent=function(k,a){if(1<arguments.length)return dojox.xml.parser.replaceChildren(k,
(k.ownerDocument||h.doc).createTextNode(a)),a;if(void 0!==k.textContent)return k.textContent;var f="";k&&h.forEach(k.childNodes,function(a){switch(a.nodeType){case 1:case 5:f+=dojox.xml.parser.textContent(a);break;case 3:case 2:case 4:f+=a.nodeValue}});return f};dojox.xml.parser.replaceChildren=function(k,a){var f=[];h.isIE&&h.forEach(k.childNodes,function(a){f.push(a)});dojox.xml.parser.removeChildren(k);h.forEach(f,h.destroy);h.isArray(a)?h.forEach(a,function(a){k.appendChild(a)}):k.appendChild(a)};
dojox.xml.parser.removeChildren=function(h){for(var a=h.childNodes.length;h.hasChildNodes();)h.removeChild(h.firstChild);return a};dojox.xml.parser.innerXML=function(h){return h.innerXML?h.innerXML:h.xml?h.xml:"undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(h):null};return dojox.xml.parser})},"esri/layers/vectorTiles/views/vectorTiles/renderers/LineRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 ../../../core/libs/gl-matrix/vec2 ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils ./vtShaderSnippets".split(" "),
function(h,k,a,f,b,e,l,m,g,d){return function(){function c(){this._triangleAttributeLocations={a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2};this._initialized=!1;this._viewProjMat=a.create();this._offsetVector=b.create();this._screenSize=e.create();this._color=f.create();this._dashArray=e.create()}return c.prototype.render=function(b,c,d,e,f,h,l,k,m,A){if(0!==c.triangleElementCount){this._initialized||this._initialize(b);var n=f.tileTransform.transform,q=f.coordRange/512,r=h.getPaintValue("line-translate",
d);if(0!==r[0]||0!==r[1]){a.copy(this._viewProjMat,f.tileTransform.transform);var n=r[0],r=r[1],t=0,u=0,u=(1<<f.key.level)/Math.pow(2,d)*q,t=e.rotation;if(1===h.getPaintValue("line-translate-anchor",d)){e=Math.sin(g.C_DEG_TO_RAD*-t);var v=Math.cos(g.C_DEG_TO_RAD*-t),t=u*(n*v-r*e),u=u*(n*e+r*v)}else t=u*n,u*=r;this._offsetVector[0]=t;this._offsetVector[1]=u;this._offsetVector[2]=0;a.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);n=this._viewProjMat}e=h.getPaintValue("line-pattern",
d);t=void 0!==e;r=1/m;m=h.getPaintValue("line-blur",d)+r;u=h.getPaintValue("line-width",d);r=.5*(u+r);A*=h.getPaintValue("line-opacity",d);var v=h.getPaintValue("line-color",d),w=v[3]*A;this._color[0]=w*v[0];this._color[1]=w*v[1];this._color[2]=w*v[2];this._color[3]=w;if(v=this._getTrianglesVAO(b,f))(b.bindVAO(v),t)?(d=l.getMosaicItemPosition(e,!0))&&(l.bind(b,9729,d.page,1),b.bindProgram(this._patternLineProgram),this._patternLineProgram.setUniformMatrix4fv("u_transformMatrix",n),this._patternLineProgram.setUniformMatrix4fv("u_extrudeMatrix",
k),this._patternLineProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),this._patternLineProgram.setUniform1f("u_depth",h.z),this._patternLineProgram.setUniform1f("u_lineHalfWidth",r),this._patternLineProgram.setUniform1f("u_blur",m),this._patternLineProgram.setUniform1f("u_opacity",A),this._patternLineProgram.setUniform2f("u_pattern_tl",d.tl[0],d.tl[1]),this._patternLineProgram.setUniform2f("u_pattern_br",d.br[0],d.br[1]),this._patternLineProgram.setUniform2f("u_spriteSize",
q*d.size[0],d.size[1]),this._patternLineProgram.setUniform1i("u_texture",1)):(l=h.getPaintValue("line-dasharray",d),2>l.length&&(l=[1,-1]),q*=u,this._dashArray[0]=q*l[0],this._dashArray[1]=q*l[1],b.bindProgram(this._triangleslProgram),this._triangleslProgram.setUniformMatrix4fv("u_transformMatrix",n),this._triangleslProgram.setUniformMatrix4fv("u_extrudeMatrix",k),this._triangleslProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),this._triangleslProgram.setUniform1f("u_depth",
h.z),this._triangleslProgram.setUniform4fv("u_color",this._color),this._triangleslProgram.setUniform1f("u_lineHalfWidth",r),this._triangleslProgram.setUniform2fv("u_dasharray",this._dashArray),this._triangleslProgram.setUniform1f("u_blur",m)),b.drawElements(4,c.triangleElementCount,5125,12*c.triangleElementStart),b.bindVAO()}},c.prototype._initialize=function(a){if(this._initialized)return!0;var b=new l(a,d.lineShaderVS,d.lineShaderFS,this._triangleAttributeLocations);a=new l(a,d.patternLineShaderVS,
d.patternLineShaderFS,this._triangleAttributeLocations);return this._triangleslProgram=b,this._patternLineProgram=a,this._trianglesVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:1,type:5122,offset:8,stride:12,normalized:!1,divisor:0}]},this._initialized=!0,!0},c.prototype._getTrianglesVAO=function(a,b){if(b.lineTrianglesVertexArrayObject)return b.lineTrianglesVertexArrayObject;
var c=b.lineVertexBuffer,d=b.lineTrianglesIndexBuffer;return c&&d?(b.lineTrianglesVertexArrayObject=new m(a,this._triangleAttributeLocations,this._trianglesVertexAttributes,{geometry:c},d),b.lineTrianglesVertexArrayObject):null},c}()})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec2":function(){define(["./common"],function(h){var k={};return k.create=function(){var a=new h.ARRAY_TYPE(2);return a[0]=0,a[1]=0,a},k.clone=function(a){var f=new h.ARRAY_TYPE(2);return f[0]=a[0],f[1]=a[1],f},k.fromValues=
function(a,f){var b=new h.ARRAY_TYPE(2);return b[0]=a,b[1]=f,b},k.copy=function(a,f){return a[0]=f[0],a[1]=f[1],a},k.set=function(a,f,b){return a[0]=f,a[1]=b,a},k.add=function(a,f,b){return a[0]=f[0]+b[0],a[1]=f[1]+b[1],a},k.subtract=function(a,f,b){return a[0]=f[0]-b[0],a[1]=f[1]-b[1],a},k.sub=k.subtract,k.multiply=function(a,f,b){return a[0]=f[0]*b[0],a[1]=f[1]*b[1],a},k.mul=k.multiply,k.divide=function(a,f,b){return a[0]=f[0]/b[0],a[1]=f[1]/b[1],a},k.div=k.divide,k.ceil=function(a,f){return a[0]=
Math.ceil(f[0]),a[1]=Math.ceil(f[1]),a},k.floor=function(a,f){return a[0]=Math.floor(f[0]),a[1]=Math.floor(f[1]),a},k.min=function(a,f,b){return a[0]=Math.min(f[0],b[0]),a[1]=Math.min(f[1],b[1]),a},k.max=function(a,f,b){return a[0]=Math.max(f[0],b[0]),a[1]=Math.max(f[1],b[1]),a},k.round=function(a,f){return a[0]=Math.round(f[0]),a[1]=Math.round(f[1]),a},k.scale=function(a,f,b){return a[0]=f[0]*b,a[1]=f[1]*b,a},k.scaleAndAdd=function(a,f,b,e){return a[0]=f[0]+b[0]*e,a[1]=f[1]+b[1]*e,a},k.distance=
function(a,f){var b=f[0]-a[0],e=f[1]-a[1];return Math.sqrt(b*b+e*e)},k.dist=k.distance,k.squaredDistance=function(a,f){var b=f[0]-a[0],e=f[1]-a[1];return b*b+e*e},k.sqrDist=k.squaredDistance,k.length=function(a){var f=a[0];a=a[1];return Math.sqrt(f*f+a*a)},k.len=k.length,k.squaredLength=function(a){var f=a[0];a=a[1];return f*f+a*a},k.sqrLen=k.squaredLength,k.negate=function(a,f){return a[0]=-f[0],a[1]=-f[1],a},k.inverse=function(a,f){return a[0]=1/f[0],a[1]=1/f[1],a},k.normalize=function(a,f){var b=
f[0],e=f[1],b=b*b+e*e;return 0<b&&(b=1/Math.sqrt(b),a[0]=f[0]*b,a[1]=f[1]*b),a},k.dot=function(a,f){return a[0]*f[0]+a[1]*f[1]},k.cross=function(a,f,b){f=f[0]*b[1]-f[1]*b[0];return a[0]=a[1]=0,a[2]=f,a},k.lerp=function(a,f,b,e){var h=f[0];f=f[1];return a[0]=h+e*(b[0]-h),a[1]=f+e*(b[1]-f),a},k.random=function(a,f){f=f||1;var b=2*h.RANDOM()*Math.PI;return a[0]=Math.cos(b)*f,a[1]=Math.sin(b)*f,a},k.transformMat2=function(a,f,b){var e=f[0];f=f[1];return a[0]=b[0]*e+b[2]*f,a[1]=b[1]*e+b[3]*f,a},k.transformMat2d=
function(a,f,b){var e=f[0];f=f[1];return a[0]=b[0]*e+b[2]*f+b[4],a[1]=b[1]*e+b[3]*f+b[5],a},k.transformMat3=function(a,f,b){var e=f[0];f=f[1];return a[0]=b[0]*e+b[3]*f+b[6],a[1]=b[1]*e+b[4]*f+b[7],a},k.transformMat4=function(a,f,b){var e=f[0];f=f[1];return a[0]=b[0]*e+b[4]*f+b[12],a[1]=b[1]*e+b[5]*f+b[13],a},k.forEach=function(){var a=k.create();return function(f,b,e,h,k,g){b||(b=2);e||(e=0);for(h=h?Math.min(h*b+e,f.length):f.length;h>e;e+=b)a[0]=f[e],a[1]=f[e+1],k(a,a,g),f[e]=a[0],f[e+1]=a[1];return f}}(),
k.str=function(a){return"vec2("+a[0]+", "+a[1]+")"},k.exactEquals=function(a,f){return a[0]===f[0]&&a[1]===f[1]},k.equals=function(a,f){var b=a[0],e=a[1],l=f[0],k=f[1];return Math.abs(b-l)<=h.EPSILON*Math.max(1,Math.abs(b),Math.abs(l))&&Math.abs(e-k)<=h.EPSILON*Math.max(1,Math.abs(e),Math.abs(k))},k})},"esri/layers/vectorTiles/views/vectorTiles/renderers/FillRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils ./vtShaderSnippets".split(" "),
function(h,k,a,f,b,e,l,m,g,d){var c=1/65536;return function(){function h(){this._outlineAttributeLocations={a_pos:0,a_offset:1,a_xnormal:2};this._fillAttributeLocations={a_pos:0};this._initialized=!1;this._viewProjMat=a.create();this._offsetVector=e.create();this._patternMatrix=f.create();this._color=b.create();this._outlineColor=b.create()}return h.prototype.render=function(b,d,e,h,l,k,m,n,A,z,B){this._initialized||this._initialize(b);var q=m.getPaintValue("fill-pattern",e),r=void 0!==q;if(!r||0!==
l){var t=m.getPaintValue("fill-antialias",e)&&!r;B*=m.getPaintValue("fill-opacity",e);var u=m.getPaintValue("fill-color",e),v=!1;if(!r){var w=u[3]*B;1===w&&0===l&&(v=!0);1>w&&1===l&&(v=!0)}if(v||0!==l){var x=k.tileTransform.transform,w=k.coordRange/512,y=m.getPaintValue("fill-translate",e);if(0!==y[0]||0!==y[1]){a.copy(this._viewProjMat,k.tileTransform.transform);var x=y[0],y=y[1],M=0,H=0,w=(1<<k.key.level)/Math.pow(2,e)*w;1===m.getPaintValue("fill-translate-anchor",e)?(H=Math.sin(g.C_DEG_TO_RAD*
-h),h=Math.cos(g.C_DEG_TO_RAD*-h),M=w*(x*h-y*H),H=w*(x*H+y*h)):(M=w*x,H=w*y);this._offsetVector[0]=M;this._offsetVector[1]=H;this._offsetVector[2]=0;a.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);x=this._viewProjMat}if(h=this._getTrianglesVAO(b,k))if(r?1===l&&(q=n.getMosaicItemPosition(q,!0))&&(w=k.coordRange/512/Math.pow(2,Math.round(e)-k.key.level)/z,f.identity(this._patternMatrix),r=1/(q.size[1]*w),this._patternMatrix[0]=1/(q.size[0]*w),this._patternMatrix[4]=r,b.bindVAO(h),
n.bind(b,9729,q.page,1),b.bindProgram(this._patternFillProgram),this._patternFillProgram.setUniformMatrix4fv("u_transformMatrix",x),this._patternFillProgram.setUniform2fv("u_normalized_origin",k.tileTransform.displayCoord),this._patternFillProgram.setUniform1f("u_depth",m.z),this._patternFillProgram.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix),this._patternFillProgram.setUniform1f("u_opacity",B),this._patternFillProgram.setUniform2f("u_pattern_tl",q.tl[0],q.tl[1]),this._patternFillProgram.setUniform2f("u_pattern_br",
q.br[0],q.br[1]),this._patternFillProgram.setUniform1i("u_texture",1),b.drawElements(4,d.triangleElementCount,5125,12*d.triangleElementStart),b.bindVAO()):v&&(w=u[3]*B,this._color[0]=w*u[0],this._color[1]=w*u[1],this._color[2]=w*u[2],this._color[3]=w,b.bindVAO(h),b.bindProgram(this._solidFillProgram),this._solidFillProgram.setUniformMatrix4fv("u_transformMatrix",x),this._solidFillProgram.setUniform2fv("u_normalized_origin",k.tileTransform.displayCoord),this._solidFillProgram.setUniform1f("u_depth",
m.z+c),this._solidFillProgram.setUniform4fv("u_color",this._color),b.drawElements(4,d.triangleElementCount,5125,12*d.triangleElementStart),b.bindVAO()),t&&0<d.outlineElementCount&&1===l){e=m.getPaintValue("fill-outline-color",e);if(0===e[3]){if(1!==this._color[3])return;e=u}z=.75/z;B*=e[3];this._outlineColor[0]=B*e[0];this._outlineColor[1]=B*e[1];this._outlineColor[2]=B*e[2];this._outlineColor[3]=B;if(B=this._getOutlineVAO(b,k))b.bindVAO(B),b.bindProgram(this._outlineProgram),this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",
x),this._outlineProgram.setUniformMatrix4fv("u_extrudeMatrix",A),this._outlineProgram.setUniform2fv("u_normalized_origin",k.tileTransform.displayCoord),this._outlineProgram.setUniform1f("u_depth",m.z),this._outlineProgram.setUniform1f("u_outline_width",z),this._outlineProgram.setUniform4fv("u_color",this._outlineColor),b.drawElements(4,d.outlineElementCount,5125,12*d.outlineElementStart),b.bindVAO()}}}},h.prototype._initialize=function(a){if(this._initialized)return!0;var b=new l(a,d.solidFillShaderVS,
d.solidFillShaderFS,{a_pos:0});if(!b)return!1;var c=new l(a,d.patternFillShaderVS,d.patternFillShaderFS,this._fillAttributeLocations);if(!c)return!1;a=new l(a,d.fillOutlineShaderVS,d.fillOutlineShaderFS,this._outlineAttributeLocations);return this._solidFillProgram=b,this._patternFillProgram=c,this._trianglesVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},this._outlineProgram=a,this._outlineVertexAttributes={geometry:[{name:"a_pos",count:2,
type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]},this._initialized=!0,!0},h.prototype._getTrianglesVAO=function(a,b){if(b.polygonTrianglesVertexArrayObject)return b.polygonTrianglesVertexArrayObject;var c=b.polygonTrianglesVertexBuffer,d=b.polygonTrianglesIndexBuffer;return c&&d?(b.polygonTrianglesVertexArrayObject=new m(a,this._fillAttributeLocations,
this._trianglesVertexAttributes,{geometry:c},d),b.polygonTrianglesVertexArrayObject):null},h.prototype._getOutlineVAO=function(a,b){if(b.polygonOutlineVertexArrayObject)return b.polygonOutlineVertexArrayObject;var c=b.polygonOutlinesVertexBuffer,d=b.polygonOutlinesIndexBuffer;return c&&d?(b.polygonOutlineVertexArrayObject=new m(a,this._outlineAttributeLocations,this._outlineVertexAttributes,{geometry:c},d),b.polygonOutlineVertexArrayObject):null},h}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/SymbolRenderer":function(){define(["require",
"exports","./IconRenderer","./SDFRenderer"],function(h,k,a,f){return function(){function b(){this._iconRenderer=new a;this._sdfRenderer=new f}return b.prototype.render=function(a,b,f,g,d,c,h,k,t,r,v,u,w){b.hasData()&&(0<b.markerPerPageElementsMap.size&&(b.isSDF||this._iconRenderer.render(a,b,f,g,d,c,h,k,r,v,w)),0<b.textElementCount&&this._sdfRenderer.render(a,b,f,g,d,c,h,t,r,v,u,w))},b}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/IconRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec3 ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils ./vtShaderSnippets".split(" "),
function(h,k,a,f,b,e,l,m){return function(){function g(){this._attributeLocations={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._spritesTextureSize=new Float32Array(2);this._initialized=!1;this._extrudeMat=a.create();this._scaleVec=f.create()}return g.prototype.render=function(b,c,e,f,g,h,k,m,w,x,y){var d=this;this._initialized||this._initialize(b);y*=k.getPaintValue("icon-opacity",e);var n=k.getLayoutValue("icon-rotation-alignment",e);1===n&&(1!==k.getLayoutValue("symbol-placement",e)||k.hasLayoutProperty("icon-rotation-alignment")||
(n=0));var q=0===n,n=k.getLayoutValue("icon-keep-upright",e)&&q,r=k.getLayoutValue("icon-size",e);f=l.degToByte(f);q?a.copy(this._extrudeMat,w):a.copy(this._extrudeMat,x);1!==r&&(this._scaleVec[0]=r,this._scaleVec[1]=r,this._scaleVec[2]=1,a.scale(this._extrudeMat,this._extrudeMat,this._scaleVec));b.bindProgram(this._iconProgram);(w=this._getIconVAO(b,h))&&(b.bindVAO(w),this._iconProgram.setUniformMatrix4fv("u_transformMatrix",h.tileTransform.transform),this._iconProgram.setUniformMatrix4fv("u_extrudeMatrix",
this._extrudeMat),this._iconProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._iconProgram.setUniform1f("u_depth",k.z),this._iconProgram.setUniform1f("u_mapRotation",f),this._iconProgram.setUniform1f("u_keepUpright",n?1:0),this._iconProgram.setUniform1f("u_level",10*e),this._iconProgram.setUniform1f("u_fadeSpeed",10*g.fadeSpeed),this._iconProgram.setUniform1f("u_minfadeLevel",10*g.minfadeLevel),this._iconProgram.setUniform1f("u_maxfadeLevel",10*g.maxfadeLevel),this._iconProgram.setUniform1f("u_fadeChange",
10*(e+g.fadeChange)),this._iconProgram.setUniform1f("u_opacity",y),this._iconProgram.setUniform1i("u_texture",1),c.markerPerPageElementsMap.forEach(function(a,c){d._spritesTextureSize[0]=m.getWidth(c)/4;d._spritesTextureSize[1]=m.getHeight(c)/4;d._iconProgram.setUniform2fv("u_mosaicSize",d._spritesTextureSize);m.bind(b,9729,c,1);b.drawElements(4,a[1],5125,12*a[0])}),b.bindVAO())},g.prototype._initialize=function(a){return this._initialized?!0:(this._iconProgram=new b(a,m.iconShaderVS,m.iconShaderFS,
this._attributeLocations),this._iconVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]},this._initialized=!0,!0)},g.prototype._getIconVAO=function(a,b){if(b.iconVertexArrayObject)return b.iconVertexArrayObject;
var c=b.iconVertexBuffer,d=b.iconIndexBuffer;return c&&d?(b.iconVertexArrayObject=new e(a,this._attributeLocations,this._iconVertexAttributes,{geometry:c},d),b.iconVertexArrayObject):null},g}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/SDFRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils ./vtShaderSnippets".split(" "),function(h,
k,a,f,b,e,l,m,g){return function(){function d(){this._attributeLocations={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._initialized=!1;this._extrudeMat=a.create();this._haloColor=f.create();this._sdfColor=f.create();this._scaleVec=b.create()}return d.prototype.render=function(b,d,e,f,g,h,l,k,x,y,A,z){this._initialized||this._initialize(b);var c=l.getLayoutValue("text-size",e),n=c/24;f=m.degToByte(f);var q=l.getLayoutValue("text-rotation-alignment",e);1===q&&(1!==l.getLayoutValue("symbol-placement",
e)||l.hasLayoutProperty("text-rotation-alignment")||(q=0));var r=0===q,q=l.getLayoutValue("text-keep-upright",e)&&r;A=.1*24/c/A;z*=l.getPaintValue("text-opacity",e);this._glyphTextureSize||(this._glyphTextureSize=new Float32Array([k.width/4,k.height/4]));r?a.copy(this._extrudeMat,x):a.copy(this._extrudeMat,y);this._scaleVec[0]=n;this._scaleVec[1]=n;this._scaleVec[2]=1;a.scale(this._extrudeMat,this._extrudeMat,this._scaleVec);k.bind(b,9729,0);b.bindProgram(this._sdfProgram);if(k=this._getSDFVAO(b,
h))b.bindVAO(k),this._sdfProgram.setUniformMatrix4fv("u_transformMatrix",h.tileTransform.transform),this._sdfProgram.setUniformMatrix4fv("u_extrudeMatrix",this._extrudeMat),this._sdfProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._sdfProgram.setUniform1f("u_depth",l.z),this._sdfProgram.setUniform2fv("u_mosaicSize",this._glyphTextureSize),this._sdfProgram.setUniform1f("u_mapRotation",f),this._sdfProgram.setUniform1f("u_keepUpright",q?1:0),this._sdfProgram.setUniform1f("u_level",
10*e),this._sdfProgram.setUniform1f("u_fadeSpeed",10*g.fadeSpeed),this._sdfProgram.setUniform1f("u_minfadeLevel",10*g.minfadeLevel),this._sdfProgram.setUniform1f("u_maxfadeLevel",10*g.maxfadeLevel),this._sdfProgram.setUniform1f("u_fadeChange",10*(e+g.fadeChange)),this._sdfProgram.setUniform1f("u_opacity",z),this._sdfProgram.setUniform1i("u_texture",0),g=l.getPaintValue("text-halo-color",e),0<g[3]&&(h=g[3]*z,this._haloColor[0]=h*g[0],this._haloColor[1]=h*g[1],this._haloColor[2]=h*g[2],this._haloColor[3]=
h,g=A+l.getPaintValue("text-halo-blur",e)/n/8,n=.75-l.getPaintValue("text-halo-width",e)/n/8,this._sdfProgram.setUniform4fv("u_color",this._haloColor),this._sdfProgram.setUniform1f("u_edgeDistance",n),this._sdfProgram.setUniform1f("u_edgeWidth",g),b.drawElements(4,d.textElementCount,5125,12*d.textElementStart)),e=l.getPaintValue("text-color",e),0<e[3]&&(l=e[3]*z,this._sdfColor[0]=l*e[0],this._sdfColor[1]=l*e[1],this._sdfColor[2]=l*e[2],this._sdfColor[3]=l,this._sdfProgram.setUniform4fv("u_color",
this._sdfColor),this._sdfProgram.setUniform1f("u_edgeDistance",.75),this._sdfProgram.setUniform1f("u_edgeWidth",A),b.drawElements(4,d.textElementCount,5125,12*d.textElementStart)),b.bindVAO()},d.prototype._initialize=function(a){return this._initialized?!0:(this._sdfProgram=new e(a,g.sdfShaderVS,g.sdfShaderFS,this._attributeLocations),this._sdfVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,
normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]},this._initialized=!0,!0)},d.prototype._getSDFVAO=function(a,b){if(b.textVertexArrayObject)return b.textVertexArrayObject;var c=b.textVertexBuffer,d=b.textIndexBuffer;return c&&d?(b.textVertexArrayObject=new l(a,this._attributeLocations,this._sdfVertexAttributes,{geometry:c},d),b.textVertexArrayObject):null},d}()})},
"esri/layers/vectorTiles/views/vectorTiles/renderers/TileInfoRenderer":function(){define("require exports ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject ../../webgl/Texture ../GeometryUtils ./vtShaderSnippets".split(" "),function(h,k,a,f,b,e,l,m){return function(){function g(){this._initialized=!1;this._maxWidth=0;this._color=new Float32Array([1,0,0,1])}return g.prototype.render=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._outlineVertexArrayObject);
a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform);this._outlineProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord);this._outlineProgram.setUniform1f("u_coord_range",b.coordRange);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.setLineWidth(2);a.drawArrays(3,0,4);a.bindVAO();var c=this._getTexture(a,b);c&&(a.bindVAO(this._tileInfoVertexArrayObject),
a.bindProgram(this._tileInfoProgram),a.bindTexture(c,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform1f("u_coord_ratio",b.coordRange/512),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",c.descriptor.width,c.descriptor.height),a.drawArrays(5,
0,4),a.bindVAO())},g.prototype._initialize=function(d){if(this._initialized)return!0;var c={a_pos:0},e=new a(d,m.backgroundVS,m.backgroundFS,c),g=new a(d,m.tileInfoVS,m.tileInfoFS,c),h={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},l=new Int8Array([0,0,1,0,1,1,0,1]),l=b.createVertex(d,35044,l),l=new f(d,c,h,{geometry:l}),k=new Int8Array([0,0,1,0,0,1,1,1]),k=b.createVertex(d,35044,k);d=new f(d,c,h,{geometry:k});return this._outlineProgram=e,this._tileInfoProgram=
g,this._vertexAttributes=h,this._outlineVertexArrayObject=l,this._tileInfoVertexArrayObject=d,this._initialized=!0,!0},g.prototype._getTexture=function(a,b){if(b.texture)return b.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var c=b.key.id,d=this._canvas.getContext("2d");d.font="24px sans-serif";d.textAlign=
"left";d.textBaseline="middle";var f=d.measureText(c),f=Math.pow(2,Math.ceil(l.log2(f.width+2)));f>this._maxWidth&&(this._maxWidth=f);return d.clearRect(0,0,this._maxWidth,32),d.fillStyle=b.key.level>b.refKey.level?"red":"blue",d.fillText(c,0,16),b.texture=new e(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},this._canvas),b.texture},g}()})},"esri/layers/vectorTiles/views/webgl/Texture":function(){define(["require","exports"],function(h,k){var a=function(){function a(b,e,f){this._glName=
this._context=null;this._id=-1;this._desc=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._context=b;this._desc={pixelFormat:e.pixelFormat,dataType:e.dataType,target:e.target?e.target:3553,samplingMode:e.samplingMode?e.samplingMode:9729,wrapMode:e.wrapMode?e.wrapMode:10497,maxAnisotropy:e.maxAnisotropy,flipped:void 0!==e.flipped?e.flipped:!1,hasMipmap:void 0!==e.hasMipmap?e.hasMipmap:!1,level:void 0!==e.level?e.level:0,unpackAlignment:e.unpackAlignment?e.unpackAlignment:4,width:e.width,
height:e.height};this._id=++a._nextId;this.setData(f)}return Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this._context&&this._glName&&(this._context.gl.deleteTexture(this._glName),this._glName=
null)},a.prototype.resize=function(a,e){var b=this._desc;b.width===a&&b.height===e||(b.width=a,b.height=e,this.setData(null))},a.prototype.setData=function(b){var e=this._context.gl;this._glName||(this._glName=e.createTexture());void 0===b&&(b=null);null===b&&(this._desc.width=this._desc.width||4,this._desc.height=this._desc.height||4);var f=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var h=this._desc;a._validateTexture(h);e.pixelStorei(e.UNPACK_ALIGNMENT,h.unpackAlignment);
e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,h.flipped?1:0);b instanceof ImageData||b instanceof HTMLImageElement||b instanceof HTMLCanvasElement||b instanceof HTMLVideoElement?(e.texImage2D(e.TEXTURE_2D,h.level,h.pixelFormat,h.pixelFormat,h.dataType,b),void 0===this._desc.width&&(this._desc.width=b.width),void 0===this._desc.height&&(this._desc.height=b.height)):((null==h.width||null==h.height)&&console.error("Width and height must be specified!"),e.texImage2D(e.TEXTURE_2D,h.level,h.pixelFormat,h.width,h.height,
0,h.pixelFormat,h.dataType,b));h.hasMipmap&&this.generateMipmap();a._applySamplingMode(e,this._desc);a._applyWrapMode(e,this._desc);a._applyAnisotropicFilteringParameters(this._context,this._desc);this._context.bindTexture(f,0)},a.prototype.updateData=function(a,e,f,h,g,d){d||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");var b=this._context.gl,l=this._desc,k=this._context.getBoundTexture(0);this._context.bindTexture(this,
0);(0>e||0>f||h>l.width||g>l.height||e+h>l.width||f+g>l.height)&&console.error("An attempt to update out of bounds of the texture!");d instanceof ImageData||d instanceof HTMLImageElement||d instanceof HTMLCanvasElement||d instanceof HTMLVideoElement?b.texSubImage2D(b.TEXTURE_2D,a,e,f,l.pixelFormat,l.dataType,d):b.texSubImage2D(b.TEXTURE_2D,a,e,f,h,g,l.pixelFormat,l.dataType,d);this._context.bindTexture(k,0)},a.prototype.generateMipmap=function(){var b=this._desc;b.hasMipmap||(b.hasMipmap=!0,a._validateTexture(b));
9729===b.samplingMode?(this._samplingModeDirty=!0,b.samplingMode=9985):9728===b.samplingMode&&(this._samplingModeDirty=!0,b.samplingMode=9984);b=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var e=this._context.gl;e.generateMipmap(e.TEXTURE_2D);this._context.bindTexture(b,0)},a.prototype.setSamplingMode=function(b){b!==this._desc.samplingMode&&(this._desc.samplingMode=b,a._validateTexture(this._desc),this._samplingModeDirty=!0)},a.prototype.setWrapMode=function(b){b!==this._desc.wrapMode&&
(this._desc.wrapMode=b,a._validateTexture(this._desc),this._wrapModeDirty=!0)},a.prototype.applyChanges=function(){var b=this._context.gl,e=this._desc;this._samplingModeDirty&&(a._applySamplingMode(b,e),this._samplingModeDirty=!1);this._wrapModeDirty&&(a._applyWrapMode(b,e),this._wrapModeDirty=!1)},a._isPowerOfTwo=function(a){return 0===(a&a-1)},a._validateTexture=function(b){(0>b.width||0>b.height)&&console.error("Negative dimension parameters are not allowed!");a._isPowerOfTwo(b.width)&&a._isPowerOfTwo(b.height)||
(33071!==b.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),b.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))},a._applySamplingMode=function(a,e){var b=e.samplingMode;9985===b||9987===b?b=9729:(9984===b||9986===b)&&(b=9728);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,b);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,e.samplingMode)},a._applyWrapMode=function(a,e){a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,e.wrapMode);
a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,e.wrapMode)},a._applyAnisotropicFilteringParameters=function(a,e){if(null!=e.maxAnisotropy){var b=a.extensions.textureFilterAnisotropic;if(b){var f=a.gl;f.texParameterf(f.TEXTURE_2D,b.TEXTURE_MAX_ANISOTROPY_EXT,e.maxAnisotropy)}}},a}();return a._nextId=0,a})},"esri/layers/vectorTiles/views/vectorTiles/renderers/FadeRecorder":function(){define(["require","exports","../../../core/now"],function(h,k,a){h=(function(){return function(a,b){this.level=a;this.now=
b}}(),function(){return function(a,b,e,h){this.fadeSpeed=a;this.minfadeLevel=b;this.maxfadeLevel=e;this.fadeChange=h}}());k.FadeProperties=h;h=function(){function f(a){void 0===a&&(a=300);this._levelSnapshots=[];this._duration=a}return f.prototype.recordLevel=function(b){var e=a(),f=this._levelSnapshots;0===f.length&&(f.push({level:b,now:0}),f.push({level:b,now:0}));2!==f.length&&f[0].level===b||f.push({level:b,now:e})},f.prototype.needsRedraw=function(){if(0===this._levelSnapshots.length)return!1;
for(var a=this._duration,e=this._levelSnapshots,f=e.length,h=e[f-1],g=-1;f>g+1&&e[g+1].now+a<h.now;)g++;for(0>g&&(g=0);f>g;g++)if(e[g].level!==h.level)return!0;return!1},f.prototype.getFadeValues=function(b){void 0===b&&(b=!1);for(var e=this._duration,f=a(),h=this._levelSnapshots;3<h.length&&h[1].now+e<f;)h.shift();h[1].now+e<f&&(h[0].level=h[1].level);var g=h[0].level,d=h[h.length-1],c=d.level,k=Math.min(g,c),g=Math.max(g,c),h=(d.level-h[1].level)/((d.now-h[1].now)/e),e=(f-d.now)/e*h;return b?{fadeSpeed:0,
minfadeLevel:k,maxfadeLevel:g,fadeChange:0}:{fadeSpeed:h,minfadeLevel:k,maxfadeLevel:g,fadeChange:e}},f}();k.FadeRecorder=h})},"esri/layers/vectorTiles/core/now":function(){define(["require","exports","./global"],function(h,k,a){return function(){var f=a.performance||{};if(f.now)return function(){return f.now()};if(f.webkitNow)return function(){return f.webkitNow()};if(f.mozNow)return function(){return f.mozNow()};if(f.msNow)return function(){return f.msNow()};if(f.oNow)return function(){return f.oNow()};
var b;return b=f.timing&&f.timing.navigationStart?f.timing.navigationStart:Date.now(),function(){return Date.now()-b}}()})},"esri/layers/vectorTiles/core/global":function(){define(["require","exports"],function(h,k){return"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{}})},"esri/layers/vectorTiles/views/vectorTiles/StencilClipGenerator":function(){define(["require","exports","./GeometryUtils"],function(h,k,a){var f=function(){function a(a){this.children=
[];this.stageTile=a}return a.prototype.tryAdd=function(b){if(a.isChildOf(b,this.stageTile.key)){for(var e=0,f=this.children;e<f.length;e++)if(a.isChildOf(b,f[e]))return;this.children.push(b)}},a.prototype.equals=function(a){if(this.stageTile.key.id!==a.stageTile.key.id||this.children.length!==a.children.length)return!1;for(var b=0;b<this.children.length;b++)if(this.children[b].id!==a.children[b].id)return!1;return!0},a.isChildOf=function(a,b){if(a.level<=b.level)return!1;var e=a.level-b.level,f=a.col>>
e;return a.row>>e===b.row&&f===b.col},a}();return function(){function b(){this._tileGroups=[];this._bitOffset=0}return b.prototype.update=function(b){if(this._tileGroups=[],this._bitOffset=0,0!==b.length){for(var e=[],h=b.length,g=0;h>g;g++)if(b[g].attached&&b[g].visible){for(var d=new f(b[g]),c=g+1;h>c;c++)d.tryAdd(b[c].key);d.children.sort(function(a,b){return a.level<b.level?-1:1});this._reuseExisting(d)||e.push(d)}if(0<e.length){b=Math.ceil(a.log2(e.length+1));h=(1<<b)-1<<this._bitOffset;g=1;
d=void 0;for(c=0;c<e.length;c++){var k=e[c],d=g++<<this._bitOffset;k.stageTile.stencilData.mask=h;k.stageTile.stencilData.reference=d}this._bitOffset+=b;this._tileGroups.push(e)}}},b.prototype._reuseExisting=function(a){for(var b=0,e=this._tileGroups;b<e.length;b++)for(var f=0,d=e[b];f<d.length;f++){var c=d[f];if(c.equals(a)&&c.stageTile.stencilData.mask===a.stageTile.stencilData.mask&&c.stageTile.stencilData.reference===a.stageTile.stencilData.reference)return!0}return!1},b}()})},"esri/layers/vectorTiles/views/vectorTiles/TileHandler":function(){define("require exports module dojo/Deferred dojo/promise/all ../../core/workers ../../core/promiseUtils ../../core/requireUtils ../../request ../2d/layers/support/TileKey ./TileIndex ./SpriteMosaic ./SpriteSource ./GlyphMosaic ./GlyphSource ./VectorTileDisplayObject ./GeometryUtils".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u){return function(){function k(a,b,c,d){void 0===d&&(d=!1);this.devicePixelRatio=c;this.allowUpdates=d;this._tileIndex=this._connection=this._glyphMosaic=this._spriteMosaic=null;this._ongoingRequests={};this._vectorTileLayer=a;this._styleRepository=a.styleRepository;this._requestUpdate=b}return k.prototype.destroy=function(){this.stop();this._vectorTileLayer=this._requestUpdate=this._styleRepository=null},Object.defineProperty(k.prototype,"spriteMosaic",{get:function(){return this._spriteMosaic},
enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"glyphMosaic",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0}),k.prototype.start=function(){var c=this;this.stop();var d=this._styleRepository,g=new q(d.sprite,this.devicePixelRatio);g.devicePixelRatio=devicePixelRatio;var l=g.load().then(function(){c._spriteMosaic=new n(1024,1024,250);c._spriteMosaic.setSpriteSource(g)}),k=new r(d.glyphs);this._glyphMosaic=new t(1024,1024,k);var u=this._fetchTileMap(this._vectorTileLayer.tileIndexUrl),
v=e.open(this,m.getAbsMid("./WorkerTileHandler",h,a)).then(function(a){c._connection=a}),w=new f(function(a){l.isFulfilled()||l.cancel();u.isFulfilled()||u.cancel();v.isFulfilled()||v.cancel()});return b([l,u,v]).then(function(a){b(c._connection.broadcast("setLayers",d.styleJSON)).then(function(){w.resolve()})}),this._broadcastPromise=w.promise,this._broadcastPromise},k.prototype.stop=function(){this._broadcastPromise&&!this._broadcastPromise.isFulfilled()&&this._broadcastPromise.cancel();for(var a in this._ongoingRequests)this._ongoingRequests[a].cancel("cancel");
this._connection&&(this._connection.close(),this._connection=null)},k.prototype.updateTile=function(a,b){if(this.allowUpdates){if(!this._broadcastPromise.isFulfilled()||!this._connection)return l.reject(Error("no connection"));var c=Math.round(u.degToByte(b.state.rotation));return a.rotation===c?null:(a.rotation=c,this._connection.invoke("update",{key:a.id,rotation:c},[],{id:a.workerID}).then(function(b){return a.updateSymbolData(b),a}))}},k.prototype.getVectorTileWithLRC=function(a,b,c,e){return void 0===
e&&(e=0),this.getVectorTile(d.from(a,b,c,0),{state:{rotation:e}})},k.prototype.getVectorTile=function(a,b){var c=this;if(!this._broadcastPromise.isFulfilled()||!this._connection)return l.reject(Error("no connection"));var d=this._vectorTileLayer.tileInfo,e=Math.round(b?b.state.rotation:0);if(d.lods.length<=a.level)return l.reject("Cannot create tile for the requested level");var f=this._tileIndex?this._tileIndex.dataKey(a):a;return f?this._getTileData(this._connection,a,f,e).then(function(b){if(!b||
!b.tileData)return l.reject("No data");var g=d.size[0]*d.lods[a.level].resolution,h=d.origin,k=h.x+a.col*g+a.world*c._vectorTileLayer.fullExtent.width,m=k+g,h=h.y-a.row*g,g=h-g;return c._requestUpdate(),new v(a,f,[k,h,m,g],c._vectorTileLayer.tileInfo.size[1],4096,e,b.tileData,c._styleRepository,c._glyphMosaic,c.allowUpdates?b.workerId:-1,c._connection)}):l.reject(Error("no data"))},k.prototype.fetchTileData=function(a){a=d.pool.acquire(a);var b=this._vectorTileLayer.getTileUrl(a.level,a.row,a.col);
return d.pool.release(a),g(b,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){return{data:{protobuff:a.data},buffers:[a.data]}})},k.prototype.getSprites=function(a){return l.resolve({data:{spriteItems:this._spriteMosaic.getSpriteItems(a.sprites)}})},k.prototype.getGlyphs=function(a){return this._glyphMosaic.getGlyphItems(a.tileID,a.font,a.codePoints).then(function(a){return{data:{glyphItems:a}}})},k.prototype.getStyleRepository=function(){return this._styleRepository},
k.prototype.getTileIndex=function(){return this._tileIndex},k.prototype._getTileData=function(a,b,c,d){var e=this,f={id:null};return(a=this._ongoingRequests[b.id])?a:(a=this._connection.invoke("getTile",{key:b.id,refKey:c.id,rotation:d,cacheTile:this.allowUpdates},[],f).then(function(a){return delete e._ongoingRequests[b.id],{tileData:a,workerId:f.id}}).otherwise(function(a){return delete e._ongoingRequests[b.id],e.allowUpdates&&e._connection.invoke("destructTileData",{key:b.id},[],f),l.reject(a)}),
this._ongoingRequests[b.id]=a,a)},k.prototype._fetchTileMap=function(a){var b=this;return a?g(a,{callbackParamName:"callback",responseType:"json"}).then(function(a){b._tileIndex=new c(a.data)}):null},k}()})},"esri/layers/vectorTiles/core/workers":function(){define(["require","exports","./workers/workers"],function(h,k,a){for(var f in a)k.hasOwnProperty(f)||(k[f]=a[f])})},"esri/layers/vectorTiles/core/workers/workers":function(){define("require exports dojo/Deferred dojo/promise/all ../promiseUtils ./Connection ./JobProxy".split(" "),
function(h,k,a,f,b,e,l){function m(a,b){for(var c=[],d=0;d<q.length;d++)c.push(q[d].openConnection(a,b));return f(c).then(function(a){})}function g(a){if((t[a]=!0,!n)&&t.every(function(a){return a})){for(var b in w)(a=u[b])&&w[b].resolve(a);w={};n=!0}}function d(b){var c=v++;b=new e(b,c);var d=new a;return u[c]=b,n?d.resolve(b):w[c]=d,d.promise}var c=Math.max((navigator.hardwareConcurrency||2)-1,2),n=!1,q=[],t=[],r=0,v=0,u={},w={},x=!1;k.open=function(a,e){if(!1===x){for(var f=0;c>f;++f){var h=new l(u,
f,g);q.push(h);t.push(!1)}x=!0}return d(a).then(function(a){return m(e,a.id).then(function(){return a}).otherwise(function(a){return b.reject(a)})})};k.terminate=function(){for(var a=0;a<q.length;a++)q[a].terminate();q=[];t=[];n=!1};k.closeConnection=function(a){if(a)if(u[a.id]&&delete u[a.id],n)for(var b=0;b<q.length;b++)q[b].closeConnection(a.id);else(b=w[a.id])&&(b.promise.cancel(),delete w[a.id])};k.invoke=function(a,c,d,e,f){var g=null;if(e&&(g=e.id),null===g&&(g=r=(r+1)%q.length,!t[g]&&!q.some(function(a,
b,c){return g=(g+1)%c.length,t[g]})))return b.reject(Error("No worker available"));a=q[g].invoke(a,c,d,f);return e&&(e.id=g),a};k.broadcast=function(a,b,c,d){for(var e=[],f=0;f<q.length;f++)t[f]&&e.push(q[f].invoke(a,b,c,d));return e}})},"esri/layers/vectorTiles/core/workers/Connection":function(){define(["require","exports","./workers"],function(h,k,a){return function(){function f(a,e){this.client=a;this.id=e}return f.prototype.invoke=function(b,e,f,h){return a.invoke(b,e,f,h,this.id)},f.prototype.broadcast=
function(b,e,f){return a.broadcast(b,e,f,this.id)},f.prototype.close=function(){a.closeConnection(this)},f}()})},"esri/layers/vectorTiles/core/workers/JobProxy":function(){define("require exports dojo/_base/kernel dojo/_base/lang dojo/_base/url dojo/Deferred ../../kernel ../../config ../../request ../Logger ../urlUtils ./WorkerFallbackImpl".split(" "),function(h,k,a,f,b,e,l,m,g,d,c,n){function q(){if(!x){var a=void 0;try{a=new Worker(v)}catch(B){r.warn("Failed to create Worker. Fallback to execute module in main thread",
event),a=new n}return t(a)}if(!y){var a=new b(v),c=m.defaults?m.defaults.io.corsEnabledServers:m.request.corsEnabledServers;-1===c.indexOf(a.host)&&c.push(a.host);y=g(v,{responseType:"text"})}return y.then(function(a){var b;try{b=new Worker(URL.createObjectURL(new Blob([a.data],{type:"text/javascript"})))}catch(D){r.warn("Failed to create Worker. Fallback to execute module in main thread",D),b=new n}return t(b)})}function t(b){function c(e){if(e&&e.data&&e.data.type)if(e=e.data.type,"\x3cworker-loaded\x3e"===
e){e=b;var h;null!=m["default"]?(h=f.mixin({},m),delete h["default"],h=JSON.parse(JSON.stringify(h))):h=JSON.parse(JSON.stringify(m));var l={async:!0,baseUrl:w,locale:a.locale,has:{},paths:{}};f.mixin(l,m.workers.loaderConfig);l.has=f.mixin({"esri-cors":1,"dojo-test-sniff":0,"config-deferredInstrumentation":0},l.has);l.paths=f.mixin({esri:"esri",dojo:"dojo",dojox:"dojox",dstore:"dstore",moment:"moment"},l.paths);e.postMessage({type:"\x3cconfigure\x3e",configure:{esriConfig:h,dojoConfig:l,loaderUrl:u}})}else"\x3cworker-configured\x3e"===
e&&(b.removeEventListener("message",c),b.removeEventListener("error",d),g.resolve(b))}function d(a){a.preventDefault();b.removeEventListener("message",c);b.removeEventListener("error",d);r.warn("Failed to create Worker. Fallback to execute module in main thread",a);b=new n;b.addEventListener("message",c);b.addEventListener("error",d)}var g=new e;return b.addEventListener("message",c),b.addEventListener("error",d),g.promise}var r=d.getLogger("esri.core.workers"),v=c.makeAbsolute(h.toUrl("./worker.js")),
u=c.makeAbsolute(h.toUrl("./worker-init.js")),w=c.makeAbsolute("../../../../../../",u)+"/",x=!c.hasSameOrigin(v,location.href),y=null;return function(){function a(a,b,c){var d=this;this.connections=a;this.index=b;this.workerInitCallback=c;this.msgCount=0;this.outgoingJobs={};this.incomingJobs={};this.incomingStaticJobs={};q().then(function(a){d.worker=a;d.worker.addEventListener("message",d.message.bind(d));d.worker.addEventListener("error",function(a){a.preventDefault();r.error(a)});d.workerInitCallback(d.index)})}
return a.prototype.terminate=function(){this.worker.terminate()},a.prototype.openConnection=function(a,b){return this.invoke("\x3copen-connection\x3e",{path:a},void 0,b)},a.prototype.closeConnection=function(a){this.invoke("\x3cclose-connection\x3e",void 0,void 0,a)},a.prototype.invoke=function(a,b,c,d){var f=this,g=++this.msgCount,h=new e(function(a){f.worker.postMessage({type:"\x3ccancel\x3e",id:g,connection:d,data:{reason:a}});f.outgoingJobs[g]&&delete f.outgoingJobs[g]});return this.outgoingJobs[g]=
h,this.worker.postMessage({type:a,id:g,connection:d,data:b},c),h.promise},a.prototype.message=function(a){var b=this;if(a&&a.data){var c=a.data.type;if(c){var d=a.data,e=a.data.id;if("\x3cresponse\x3e"===c&&e){if(a=this.outgoingJobs[e])delete this.outgoingJobs[e],d.error?a.reject(d.error):a.resolve(d.data)}else if("\x3ccancel\x3e"===c&&e)a=this.incomingJobs[e],(a&&a.cancel(d.data.reason),d.staticMsg)&&(a=this.incomingStaticJobs[e])&&a.cancel(d.data.reason);else if("\x3cstatic-message\x3e"===c){var f=
d.staticMsg;a=l.workerMessages[f];if(!a||"function"!=typeof a)return void this.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:f,id:e,error:a+" message type is not available on the kernel!"});d=a.call(this,d.data);this.incomingStaticJobs[e]=d;d.then(function(a){b.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:f,id:e,data:a.data},a.buffers)}).otherwise(function(a){a||(a="Error encountered at method"+f);a.dojoType&&"cancel"===a.dojoType||b.worker.postMessage({type:"\x3cstatic-message\x3e",
staticMsg:f,id:e,error:a})}).always(function(){delete b.incomingStaticJobs[e]})}else{var g=d.connection;if(a=this.connections[g])if(a=a.client){var h=a[c];"function"==typeof h&&(d=h.call(a,d.data),this.incomingJobs[e]=d,d.then(function(a){b.worker.postMessage({type:"\x3cresponse\x3e",id:e,connection:g,error:a.error,data:a.data},a.buffers)}).otherwise(function(a){a||(a="Error encountered at method"+c);a.dojoType&&"cancel"===a.dojoType||b.worker.postMessage({type:"\x3cresponse\x3e",id:e,connection:g,
error:a})}).always(function(){delete b.incomingJobs[e]}))}}}}},a}()})},"esri/layers/vectorTiles/kernel":function(){define(["require","exports","esri/kernel","./identity/IdentityManager"],function(h,k,a,f){h=function(){function b(){}return Object.defineProperty(b,"id",{get:function(){return a.id?f:null},enumerable:!0,configurable:!0}),b}();return h.workerMessages={},h})},"esri/layers/vectorTiles/identity/IdentityManager":function(){define(["require","exports","esri/IdentityManager"],function(h,k,a){k.findCredential=
function(f){return a.findCredential(f)}})},"esri/layers/vectorTiles/core/Logger":function(){define(["require","exports","dojo/has"],function(h,k,a){var f={info:0,warn:1,error:2};h=function(){function a(b){void 0===b&&(b={});this.module=b.module||"";this.writer=b.writer||null;this.level=b.level||null;null!=b.enabled&&(this.enabled=!!b.enabled);a._loggers[this.module]=this;b=this.module.lastIndexOf(".");-1!==b&&(this.parent=a.getLogger(this.module.slice(0,b)))}return a.prototype.log=function(a){for(var b=
[],e=1;e<arguments.length;e++)b[e-1]=arguments[e];this._isEnabled()&&this._matchLevel(a)&&(e=this._inheritedWriter())&&e.apply(void 0,[a,this.module].concat(b))},a.prototype.error=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.log.apply(this,["error"].concat(a))},a.prototype.warn=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.log.apply(this,["warn"].concat(a))},a.prototype.info=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];
this.log.apply(this,["info"].concat(a))},a.prototype.getLogger=function(b){return a.getLogger(this.module+"."+b)},a.getLogger=function(b){var e=a._loggers[b];return e||(e=new a({module:b})),e},a.prototype._parentWithMember=function(a,b){for(var e=this;e&&null==e[a];)e=e.parent;return e?e[a]:b},a.prototype._inheritedWriter=function(){return this._parentWithMember("writer",this._consoleWriter)},a.prototype._consoleWriter=function(a,b){for(var e=[],f=2;f<arguments.length;f++)e[f-2]=arguments[f];console[a].apply(console,
["["+b+"]"].concat(e))},a.prototype._matchLevel=function(a){return f[this._parentWithMember("level","error")]<=f[a]},a.prototype._isEnabled=function(){return this._parentWithMember("enabled",!0)},a}();h._loggers={};k=h.getLogger("esri");return a("dojo-debug-messages")?k.level="info":k.level="warn",h})},"esri/layers/vectorTiles/core/workers/WorkerFallbackImpl":function(){define(["require","exports"],function(h,k){var a=function(){return this}(),f=function(){return function(){var a=this,b=document.createDocumentFragment();
["addEventListener","dispatchEvent","removeEventListener"].forEach(function(e){a[e]=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return b[e].apply(b,a)}})}}(),b=a.MutationObserver||a.WebKitMutationObserver,e=function(){var e;if(a.process&&a.process.nextTick)e=function(b){a.process.nextTick(b)};else if(a.Promise)e=function(b){a.Promise.resolve().then(b)};else if(b){var f=[],g=document.createElement("div");(new b(function(){for(;0<f.length;)f.shift()()})).observe(g,{attributes:!0});
e=function(a){f.push(a);g.setAttribute("queueStatus","1")}}return e}();return function(){function a(){this._dispatcher=new f;this._connections={};this._outgoingStaticMessages={};this._isInitialized=!1;this._workerPostMessage({type:"\x3cworker-loaded\x3e"})}return a.prototype.terminate=function(){this._connections={}},Object.defineProperty(a.prototype,"onmessage",{get:function(){return this._onmessageHandler},set:function(a){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler);
(this._onmessageHandler=a)&&this.addEventListener("message",a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onerror",{get:function(){return this._onerrorHandler},set:function(a){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler);(this._onerrorHandler=a)&&this.addEventListener("error",a)},enumerable:!0,configurable:!0}),a.prototype.postMessage=function(a,b){var d=this;e(function(){d._workerMessageHandler(new MessageEvent("message",{data:a}))})},a.prototype.dispatchEvent=
function(a){return this._dispatcher.dispatchEvent(a)},a.prototype.addEventListener=function(a,b,d){this._dispatcher.addEventListener(a,b,d)},a.prototype.removeEventListener=function(a,b,d){this._dispatcher.removeEventListener(a,b,d)},a.prototype._workerPostMessage=function(a,b){var d=this;e(function(){d.dispatchEvent(new MessageEvent("message",{data:a}))})},a.prototype._workerMessageHandler=function(a){var b=this,d=a.data;if(d){var c=d.connection,e=d.type;if("\x3cconfigure\x3e"===e)this._isInitialized||
this._workerPostMessage({type:"\x3cworker-configured\x3e"});else if("\x3copen-connection\x3e"===e){a=d.data.path;var f=d.id;if(this._connections[c])return void this._workerPostMessage({type:"\x3cresponse\x3e",id:f,connection:c});h(["./WorkerConnection",a],function(a,d){b._connections[c]=new a(d,{postMessage:function(a,c){return b._workerPostMessage(a,c)}},c);b._workerPostMessage({type:"\x3cresponse\x3e",id:f,data:{connection:c},error:void 0})})}else"\x3cclose-connection\x3e"===e?this._connections[c]&&
delete this._connections[c]:"\x3cstatic-message\x3e"===e?(a=d.id,this._outgoingStaticMessages[a]&&(e=this._outgoingStaticMessages[a],delete this._outgoingStaticMessages[a],d.error?e.reject(d.error):e.resolve(d.data))):e&&(d=this._connections[c])&&d.proxy.message(a)}},a}()})},"esri/layers/vectorTiles/core/requireUtils":function(){define(["require","exports","dojo/Deferred"],function(h,k,a){function f(b,e){if(Array.isArray(e)){var h=new a;return b(e,function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=
arguments[b];h.resolve(a)}),h.promise}return f(b,[e]).then(function(a){return a[0]})}k.when=f;k.getAbsMid=function(a,e,f){return e.toAbsMid?e.toAbsMid(a):f.id.replace(/\/[^\/]*$/gi,"/")+a}})},"esri/layers/vectorTiles/views/2d/layers/support/TileKey":function(){define(["require","exports","../../../../core/ObjectPool"],function(h,k,a){h=function(){function a(a,e,f,h){"string"==typeof a?(a=a.split("/"),e=a[1],f=a[2],h=a[3],this.level=+a[0],this.row=+e,this.col=+f,this.world=+h||0):a&&"object"==typeof a?
(this.level=a.level||0,this.row=a.row||0,this.col=a.col||0,this.world=a.world||0):(this.level=+a||0,this.row=+e||0,this.col=+f||0,this.world=+h||0)}return a.from=function(b,e,f,h){return a.pool.acquire(b,e,f,h)},a.getId=function(a,e,f,h){return"object"==typeof a?a.level+"/"+a.row+"/"+a.col+"/"+a.world:a+"/"+e+"/"+f+"/"+h},Object.defineProperty(a.prototype,"id",{get:function(){return a.getId(this)},enumerable:!0,configurable:!0}),a.prototype.equals=function(a){return this.level===a.level&&this.row===
a.row&&this.col===a.col&&this.world===a.world},a.prototype.release=function(){this.world=this.col=this.row=this.level=0},a.prototype.set=function(a,e,f,h){var b=typeof a;if("object"===b)return a;"string"===b?(a=a.split("/"),e=a[1],f=a[2],h=a[3],this.level=parseFloat(a[0]),this.row=parseFloat(e),this.col=parseFloat(f),this.world=parseFloat(h)):(this.level=a,this.row=e,this.col=f,this.world=h);return this},a.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world},a}();
return h.pool=new a(h,!0,null,25,50),h})},"esri/layers/vectorTiles/core/ObjectPool":function(){define(["require","exports"],function(h,k){var a=function(){return function(){}}();return function(){function f(a,e,f,h,g){void 0===h&&(h=1);void 0===g&&(g=0);this.classConstructor=a;this.acquireFunctionOrWithConstructor=e;this.releaseFunction=f;this.growthSize=h;!0===e?this.acquireFunction=this._constructorAcquireFunction:"function"==typeof e&&(this.acquireFunction=e);this._pool=Array(g);this._set=new Set;
for(a=0;g>a;a++)this._pool[a]=new this.classConstructor;this.growthSize=Math.max(h,1)}return f.prototype.acquire=function(){for(var b=[],e=0;e<arguments.length;e++)b[e]=arguments[e];var f,e=this.classConstructor||a;if(0===this._pool.length)for(var h=this.growthSize,g=0;h>g;g++)this._pool[g]=new e;return f=this._pool.shift(),this.acquireFunction?this.acquireFunction.apply(this,[f].concat(b)):f&&f.acquire&&"function"==typeof f.acquire&&f.acquire.apply(f,b),this._set["delete"](f),f},f.prototype.release=
function(a){a&&!this._set.has(a)&&(this.releaseFunction?this.releaseFunction(a):a&&a.release&&"function"==typeof a.release&&a.release(),this._pool.push(a),this._set.add(a))},f.prototype._constructorAcquireFunction=function(a){for(var b=[],f=1;f<arguments.length;f++)b[f-1]=arguments[f];(h=this.classConstructor).call.apply(h,[a].concat(b));var h},f}()})},"esri/layers/vectorTiles/views/vectorTiles/TileIndex":function(){define(["require","exports","../2d/layers/support/TileKey"],function(h,k,a){return function(){function f(a){if(!("index"in
a))throw Error("The tilemap is missing the 'index' property.");this._tilemap=a.index}return f.prototype.dataKey=function(b){var e=[b];if(0>b.level||0>b.row||0>b.col||0<b.row>>b.level||0<b.col>>b.level)return null;for(;0!==b.level;)b=new a(b.level-1,b.row>>1,b.col>>1,b.world),e.push(b);var f,h=this._tilemap,g=e.pop();if(1===h)return g;for(;e.length;){b=e.pop();f=g.level+1;var d=2*g.row,c=2*g.col;if(f=[a.getId(f,d,c,b.world),a.getId(f,d,c+1,b.world),a.getId(f,d+1,c,b.world),a.getId(f,d+1,c+1,b.world)].indexOf(b.id),
h){if(0===h[f]){g=null;break}if(1===h[f]){g=b;break}g=b;h=h[f]}}return g},f.prototype.forEach=function(a,e,f,h,g){this._callback=g;this._maxLevel=e+a;this._forEach(this._tilemap,e,f,h)},f.prototype._forEach=function(a,e,f,h){0!==a&&(this._callback(e,f,h),e!==this._maxLevel&&"object"==typeof a&&(this._forEach(a[0],e+1,2*f,2*h),this._forEach(a[1],e+1,2*f,2*h+1),this._forEach(a[2],e+1,2*f+1,2*h),this._forEach(a[3],e+1,2*f+1,2*h+1)))},f}()})},"esri/layers/vectorTiles/views/vectorTiles/SpriteMosaic":function(){define("require exports ./Rect ./GeometryUtils ./RectangleBinPack ../webgl/Texture".split(" "),
function(h,k,a,f,b,e){return function(){function h(a,e,d){void 0===d&&(d=0);this._size=[];this._mosaicsData=[];this._textures=[];this._dirties=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects={};this.pixelRatio=1;(0>=a||0>=e)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=a;this._pageHeight=e;0<d&&(this._maxItemSize=d);this._binPack=new b(a,e)}return h.prototype.getWidth=function(a){return a>=this._size.length?
-1:this._size[a][0]},h.prototype.getHeight=function(a){return a>=this._size.length?-1:this._size[a][1]},h.prototype.setSpriteSource=function(a){if(this._dispose(),this.pixelRatio=a.devicePixelRatio,0===this._mosaicsData.length)this._binPack=new b(this._pageWidth,this._pageHeight),this._mosaicsData[0]=new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight)),this._dirties.push(!0),this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0);this._sprites=a},h.prototype.getSpriteItem=
function(a,b){void 0===b&&(b=!1);var d=this._mosaicRects[a];if(d)return d;if(!this._sprites||"loaded"!==this._sprites.loadStatus)return null;var c=this._sprites.getSpritePosition(a);if(!c||!c.width||!c.height)return null;var e=this._allocateImage(c.width,c.height),f=e[0],g=e[1],e=e[2];return 0>=f.width?null:(d={rect:f,width:c.width,height:c.height,sdf:c.sdf,pixelRatio:c.pixelRatio,page:g},this._copy(f,c,g,e,b),this._mosaicRects[a]=d,d)},h.prototype.getSpriteItems=function(a){for(var b={},d=0;d<a.length;d++){var c=
a[d];b[c]=this.getSpriteItem(c)}return b},h.prototype.getMosaicItemPosition=function(a,b){var d=this.getSpriteItem(a,b),c=d&&d.rect;if(!c)return null;c.width=d.width;c.height=d.height;return{size:[d.width,d.height],tl:[(c.x+1)/this._size[d.page][0],(c.y+1)/this._size[d.page][1]],br:[(c.x+1+d.width)/this._size[d.page][0],(c.y+1+d.height)/this._size[d.page][1]],page:d.page}},h.prototype.bind=function(a,b,d,c){void 0===d&&(d=0);void 0===c&&(c=0);this._textures[d]||(this._textures[d]=new e(a,{pixelFormat:6408,
dataType:5121,width:this._size[d][0],height:this._size[d][1]},new Uint8Array(this._mosaicsData[d].buffer)));var f=this._textures[d];f.setSamplingMode(b);a.bindTexture(f,c);this._dirties[d]&&f.setData(new Uint8Array(this._mosaicsData[d].buffer));this._dirties[d]=!1},h._copyBits=function(a,b,d,c,e,f,h,l,k,u,w){var g=c*b+d;h=l*f+h;if(w)for(h-=f,w=-1;u>=w;w++,g=((w+u)%u+c)*b+d,h+=f)for(l=-1;k>=l;l++)e[h+l]=a[g+(l+k)%k];else for(w=0;u>w;w++){for(l=0;k>l;l++)e[h+l]=a[g+l];g+=b;h+=f}},h.prototype._copy=
function(a,b,d,c,e){if(this._sprites&&"loaded"===this._sprites.loadStatus&&!(d>=this._mosaicsData.length)){var f=new Uint32Array(this._sprites.image.buffer),g=this._mosaicsData[d];g&&f||console.error("Source or target images are uninitialized!");h._copyBits(f,this._sprites.width,b.x,b.y,g,c[0],a.x+1,a.y+1,b.width,b.height,e);this._dirties[d]=!0}},h.prototype._allocateImage=function(e,g){e+=2;g+=2;var d=Math.max(e,g);if(this._maxItemSize&&this._maxItemSize<d){var d=Math.pow(2,Math.ceil(f.log2(e))),
c=Math.pow(2,Math.ceil(f.log2(g))),h=new a(0,0,e,g);return this._mosaicsData.push(new Uint32Array(d*c)),this._dirties.push(!0),this._size.push([d,c]),this._textures.push(void 0),[h,this._mosaicsData.length-1,[d,c]]}d=this._binPack.allocate(e+(e%4?4-e%4:0),g+(g%4?4-g%4:0));return 0>=d.width?(this._dirties[this._currentPage]||(this._mosaicsData[this._currentPage]=null),this._currentPage=this._mosaicsData.length,this._mosaicsData.push(new Uint32Array(this._pageWidth*this._pageHeight)),this._dirties.push(!0),
this._size.push([this._pageWidth,this._pageHeight]),this._textures.push(void 0),this._binPack=new b(this._pageWidth,this._pageHeight),this._allocateImage(e,g)):[d,this._currentPage,[this._pageWidth,this._pageHeight]]},h.prototype._dispose=function(){this._binPack=null;this._mosaicRects={}},h}()})},"esri/layers/vectorTiles/views/vectorTiles/Rect":function(){define(["require","exports"],function(h,k){return function(){function a(a,b,e,h){void 0===a&&(a=0);void 0===b&&(b=0);void 0===e&&(e=0);void 0===
h&&(h=0);this.x=a;this.y=b;this.width=e;this.height=h}return Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0}),a}()})},"esri/layers/vectorTiles/views/vectorTiles/RectangleBinPack":function(){define(["require","exports","./Rect"],function(h,k,a){return function(){function f(b,e){this._height=this._width=0;this._free=[];this._width=b;this._height=e;this._free.push(new a(0,0,b,e))}return f.prototype.allocate=function(b,e){for(var f=
null,h=-1,g=0;g<this._free.length;++g){var d=this._free[g];b<=d.width&&e<=d.height&&(null===f||d.y<=f.y&&d.x<=f.x)&&(f=d,h=g)}return null===f?new a:(this._free.splice(h,1),f.width<f.height?(f.width>b&&this._free.push(new a(f.x+b,f.y,f.width-b,e)),f.height>e&&this._free.push(new a(f.x,f.y+e,f.width,f.height-e))):(f.width>b&&this._free.push(new a(f.x+b,f.y,f.width-b,f.height)),f.height>e&&this._free.push(new a(f.x,f.y+e,b,f.height-e))),new a(f.x,f.y,b,e))},f.prototype.release=function(a){for(var b=
0;b<this._free.length;++b){var f=this._free[b];if(f.y===a.y&&f.height===a.height&&f.x+f.width===a.x)f.width+=a.width;else if(f.x===a.x&&f.width===a.width&&f.y+f.height===a.y)f.height+=a.height;else if(a.y===f.y&&a.height===f.height&&a.x+a.width===f.x)f.x=a.x,f.width+=a.width;else{if(a.x!==f.x||a.width!==f.width||a.y+a.height!==f.y)continue;f.y=a.y;f.height+=a.height}this._free.splice(b,1);this.release(a)}this._free.push(a)},f}()})},"esri/layers/vectorTiles/views/vectorTiles/SpriteSource":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper dojo/Deferred dojo/promise/all ../../request ../../kernel ../../core/promiseUtils".split(" "),
function(h,k,a,f,b,e,l,m,g){return function(){function a(a,b){this.baseURL=a;this.devicePixelRatio=b;this._isRetina=!1;this._spritesData={};this.height=this.width=this.image=null;this.loadStatus="not-loaded"}return a.prototype.getSpritePosition=function(a){return this._spritesData[a]},a.prototype.load=function(){var a=this;return this.loadStatus="loading",this.baseURL?this._loadSprites().then(function(){return a.loadStatus="loaded",a}).otherwise(function(b){return a.loadStatus="failed",a}):g.resolve(this)},
a.prototype._loadSprites=function(){var a=this;this._isRetina=1.15<this.devicePixelRatio?!0:!1;var d=this.baseURL,f=this._isRetina?"@2x":"",g=l(d+f+".json",{callbackParamName:"callback",responseType:"json"}).then(function(b){a._spritesData=b.data}),h=new b,k=new Image;k.crossOrigin="anonymous";k.onload=function(){k.onload=null;a.width=k.width;a.height=k.height;var b=document.createElement("canvas");b.width=k.width;b.height=k.height;b=b.getContext("2d");b.drawImage(k,0,0,k.width,k.height);for(var b=
b.getImageData(0,0,k.width,k.height),c=new Uint8Array(b.data),d=0;d<c.length;d+=4)b=c[d+3]/255,c[d]*=b,c[d+1]*=b,c[d+2]*=b;a.image=c;h.resolve()};d=""+d+f+".png";m.id&&(f=m.id.findCredential(d))&&f.token&&(d+="?token\x3d"+f.token);return k.src=d,e([g,h.promise])},a}()})},"esri/layers/vectorTiles/views/vectorTiles/GlyphMosaic":function(){define("require exports dojo/promise/all dojo/Deferred ./Rect ../webgl/Texture ./RectangleBinPack".split(" "),function(h,k,a,f,b,e,l){return function(){function h(a,
b,c){this.height=this.width=0;this._dirty=!1;this._glyphIndex={};this._rangePromises={};(0>=a||0>=b)&&console.error("Glyph mosaic width and height must be greater than zero!");this.width=a;this.height=b;this._glyphSource=c;this._binPack=new l(a,b);this._glyphData=new Uint8Array(a*b)}return h.prototype.getGlyphItems=function(e,d,c){for(var g=this,h=[],l=this._glyphSource,k=new Set,m=1/256,u=0;u<c.length;u++)k.add(Math.floor(c[u]*m));var w=[];return k.forEach(function(a){if(256>=a){var b=new f;w.push(b.promise);
var c=d+a,e=g._rangePromises[c];e?e.push(b):(g._rangePromises[c]=[b],l.getRange(d,a).then(function(){var a=g._rangePromises[c];delete g._rangePromises[c];for(var b=0;b<a.length;b++)a[b].resolve()}))}}),a(w).then(function(a){(a=g._glyphIndex[d])||(a={},g._glyphIndex[d]=a);for(var f=0;f<c.length;f++){var k=c[f],m=a[k];if(m)m.tileIDs.add(e),h[k]={rect:m.rect,metrics:m.metrics};else{var n=l.getGlyph(d,k);if(n&&n.metrics){var m=n.metrics,q=void 0;if(0===m.width)q=new b(0,0,0,0);else{var r=m.width+6,t=
m.height+6,q=g._binPack.allocate(r+(r%4?4-r%4:0),t+(t%4?4-t%4:0));0>=q.width&&(q=new b(0,0,0,0));var n=n.bitmap,u=void 0,v=void 0;if(n)for(var w=0;t>w;w++)for(var u=r*w,v=g.width*(q.y+w)+q.x,x=0;r>x;x++)g._glyphData[v+x]=n[u+x]}r=new Set;r.add(e);a[k]={rect:q,metrics:m,tileIDs:r};h[k]={rect:q,metrics:m};g._dirty=!0}}}return h})},h.prototype.removeGlyphs=function(a){for(var b in this._glyphIndex){var c=this._glyphIndex[b];if(c){var e=void 0,f;for(f in c)if(e=c[f],e.tileIDs["delete"](a),0===e.tileIDs.size){for(var g=
e.rect,h=void 0,l=void 0,k=0;k<g.height;k++)for(h=this.width*(g.y+k)+g.x,l=0;l<g.width;l++)this._glyphData[h+l]=0;delete c[f];this._dirty=!0}}}},h.prototype.bind=function(a,b,c){void 0===c&&(c=0);this._texture||(this._texture=new e(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));this._texture.setSamplingMode(b);a.bindTexture(this._texture,c);this._dirty&&this._texture.setData(this._glyphData);this._dirty=!1},h}()})},"esri/layers/vectorTiles/views/vectorTiles/GlyphSource":function(){define(["require",
"exports","../../core/promiseUtils","../../request","../../core/pbf"],function(h,k,a,f,b){var e=function(){function a(a){this._metrics=[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:for(var b=a.getMessage();b.next();)switch(b.tag()){case 3:for(var c=b.getMessage(),e=void 0,f=void 0,g=void 0,h=void 0,l=void 0,k=void 0,m=void 0;c.next();)switch(c.tag()){case 1:e=c.getUInt32();break;case 2:f=c.getBytes();break;case 3:g=c.getUInt32();break;case 4:h=c.getUInt32();break;case 5:l=c.getSInt32();
break;case 6:k=c.getSInt32();break;case 7:m=c.getUInt32();break;default:c.skip()}e&&(this._metrics[e]={width:g,height:h,left:l,top:k,advance:m},this._bitmaps[e]=f);break;default:b.skip()}break;default:a.skip()}}return a.prototype.getMetrics=function(a){return this._metrics[a]},a.prototype.getBitmap=function(a){return this._bitmaps[a]},a}(),l=function(){function a(){this._ranges=[]}return a.prototype.getRange=function(a){return this._ranges[a]},a.prototype.addRange=function(a,b){this._ranges[a]=b},
a}();return function(){function h(a){this._glyphInfo={};this._baseURL=a}return h.prototype.getRange=function(g,d){var c=this._getFontStack(g);if(c.getRange(d))return a.resolve();var h=256*d,l=h+255,h=this._baseURL.replace("{fontstack}",g).replace("{range}",h+"-"+l);return f(h,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){c.addRange(d,new e(new b(new Uint8Array(a.data),new DataView(a.data))))})},h.prototype.getGlyph=function(a,b){var c=this._getFontStack(a);if(c){var d=
Math.floor(b/256);if(!(256<d)&&(c=c.getRange(d)))return{metrics:c.getMetrics(b),bitmap:c.getBitmap(b)}}},h.prototype._getFontStack=function(a){var b=this._glyphInfo[a];return b||(b=this._glyphInfo[a]=new l),b},h}()})},"esri/layers/vectorTiles/core/pbf":function(){define(["require","exports"],function(h,k){return function(){function a(a,b,e,h){this._tag=0;this._dataType=99;this._data=a;this._dataView=b;this._pos=e||0;this._end=h||a.byteLength}return a.prototype.clone=function(){return new a(this._data,
this._dataView,this._pos,this._end)},a.prototype.next=function(a){for(;;){if(this._pos===this._end)return!1;var b=this._decodeVarint();if(this._tag=b>>3,this._dataType=7&b,!a||a===this._tag)break;this.skip()}return!0},a.prototype.empty=function(){return this._pos>=this._end},a.prototype.tag=function(){return this._tag},a.prototype.getInt32=function(){return this._decodeVarint()},a.prototype.getInt64=function(){return this._decodeVarint()},a.prototype.getUInt32=function(){return this._decodeVarint()},
a.prototype.getUInt64=function(){return this._decodeVarint()},a.prototype.getSInt32=function(){return this._decodeSVarint()},a.prototype.getSInt64=function(){return this._decodeSVarint()},a.prototype.getBool=function(){var a=0!==this._data[this._pos];return this._skip(1),a},a.prototype.getEnum=function(){return this._decodeVarint()},a.prototype.getFixed64=function(){var a=this._dataView,b=this._pos,a=a.getUint32(b,!0)+4294967296*a.getUint32(b+4,!0);return this._skip(8),a},a.prototype.getSFixed64=
function(){var a=this._dataView,b=this._pos,a=a.getUint32(b,!0)+4294967296*a.getInt32(b+4,!0);return this._skip(8),a},a.prototype.getDouble=function(){var a=this._dataView.getFloat64(this._pos,!0);return this._skip(8),a},a.prototype.getFixed32=function(){var a=this._dataView.getUint32(this._pos,!0);return this._skip(4),a},a.prototype.getSFixed32=function(){var a=this._dataView.getInt32(this._pos,!0);return this._skip(4),a},a.prototype.getFloat=function(){var a=this._dataView.getFloat32(this._pos,
!0);return this._skip(4),a},a.prototype.getString=function(){var a=this._getLength(),b=this._pos,b=this._toString(this._data,b,b+a);return this._skip(a),b},a.prototype.getBytes=function(){var a=this._getLength(),b=this._pos,b=this._toBytes(this._data,b,b+a);return this._skip(a),b},a.prototype.getMessage=function(){var f=this._getLength(),b=this._pos,b=new a(this._data,this._dataView,b,b+f);return this._skip(f),b},a.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;
case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw Error("Invalid data type!");}},a.prototype._skip=function(a){if(this._pos+a>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=a},a.prototype._decodeVarint=function(){var a,b=this._data,e=this._pos,h=0;if(10<=this._end-e){if(a=b[e++],h|=127&a,0!==(128&a))if(a=b[e++],h|=(127&a)<<7,0!==(128&a))if(a=b[e++],h|=(127&a)<<14,0!==(128&a))if(a=b[e++],h|=(127&a)<<21,0!==(128&
a))if(a=b[e++],h+=268435456*(127&a),0!==(128&a))if(a=b[e++],h+=34359738368*(127&a),0!==(128&a))if(a=b[e++],h+=4398046511104*(127&a),0!==(128&a))if(a=b[e++],h+=562949953421312*(127&a),0!==(128&a))if(a=b[e++],h+=72057594037927936*(127&a),0!==(128&a))if(a=b[e++],h+=0x7fffffffffffffff*(127&a),0!==(128&a))throw Error("Varint too long!");}else{for(var k=1;e!==this._end&&(a=b[e],0!==(128&a));)++e,h+=(127&a)*k,k*=128;if(e===this._end)throw Error("Varint overrun!");++e;h+=a*k}return this._pos=e,h},a.prototype._decodeSVarint=
function(){var a=this._decodeVarint();return a%2?-(a+1)/2:a/2},a.prototype._getLength=function(){if(2!==this._dataType)throw Error("Not a delimited data type!");return this._decodeVarint()},a.prototype._toString=function(a,b,e){var f="",h="";for(e=Math.min(this._end,e);e>b;++b){var g=a[b];128&g?h+="%"+g.toString(16):(f+=decodeURIComponent(h)+String.fromCharCode(g),h="")}return h.length&&(f+=decodeURIComponent(h)),f},a.prototype._toBytes=function(a,b,e){return e=Math.min(this._end,e),new Uint8Array(a.buffer,
b,e-b)},a}()})},"esri/layers/vectorTiles/views/vectorTiles/VectorTileDisplayObject":function(){define("require exports ../../core/tsSupport/extendsHelper ../webgl/BufferObject ../2d/engine/DisplayObject ../../core/libs/gl-matrix/vec2 ../../core/libs/gl-matrix/mat4 ./RenderBucket".split(" "),function(h,k,a,f,b,e,l,m){return function(b){function d(a,d,f,g,h,k,m,w,x,y,A){var c=b.call(this)||this;return c._renderBuckets=[],c._vectorTileData=null,c._symbolUpdateData=null,c.topLeft=[0,0],c.bottomRight=
[0,0],c.tileTransform={transform:Float32Array[16],displayCoord:Float32Array[2]},c.stencilData={mask:0,reference:0},c.key=a,c.refKey=d,c.topLeft[0]=f[0],c.topLeft[1]=f[1],c.bottomRight[0]=f[2],c.bottomRight[1]=f[3],c.widthInPixels=g,c.coordRange=h,c.rotation=k,c._vectorTileData=m,c.styleLayers=w,c._glyphsMosaic=x,c.workerID=y,c._connection=A,c.id=a.id,c.status=3,c.tileTransform.transform=l.create(),c.tileTransform.displayCoord=e.create(),c}return a(d,b),d.prototype.updateSymbolData=function(a){a&&
(this._symbolUpdateData=a,this.requestRender())},d.prototype.dispose=function(){-1!==this.workerID&&this._connection&&6!==this.status&&7!==this.status&&this._connection.broadcast("destructTileData",{key:this.id,worker:this.workerID},[]);this.polygonTrianglesVertexArrayObject&&(this.polygonTrianglesVertexArrayObject.dispose(),this.polygonTrianglesVertexArrayObject=null);this.polygonOutlineVertexArrayObject&&(this.polygonOutlineVertexArrayObject.dispose(),this.polygonOutlineVertexArrayObject=null);
this.lineTrianglesVertexArrayObject&&(this.lineTrianglesVertexArrayObject.dispose(),this.lineTrianglesVertexArrayObject=null);this.lineJoinsVertexArrayObject&&(this.lineJoinsVertexArrayObject.dispose(),this.lineJoinsVertexArrayObject=null);this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this.polygonTrianglesVertexBuffer&&(this.polygonTrianglesVertexBuffer.dispose(),
this.polygonTrianglesVertexBuffer=null);this.polygonTrianglesIndexBuffer&&(this.polygonTrianglesIndexBuffer.dispose(),this.polygonTrianglesIndexBuffer=null);this.polygonOutlinesVertexBuffer&&(this.polygonOutlinesVertexBuffer.dispose(),this.polygonOutlinesVertexBuffer=null);this.polygonOutlinesIndexBuffer&&(this.polygonOutlinesIndexBuffer.dispose(),this.polygonOutlinesIndexBuffer=null);this.lineVertexBuffer&&(this.lineVertexBuffer.dispose(),this.lineVertexBuffer=null);this.lineTrianglesIndexBuffer&&
(this.lineTrianglesIndexBuffer.dispose(),this.lineTrianglesIndexBuffer=null);this.lineJoinVertexBuffer&&(this.lineJoinVertexBuffer.dispose(),this.lineJoinVertexBuffer=null);this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null);
this._renderBuckets=[];this.status=7},d.prototype.attach=function(a){if(this.status=3,!this._vectorTileData)return!1;if(0===this._renderBuckets.length)for(var b=new Uint32Array(this._vectorTileData.bucketDataInfo),c=b.length,d=0;c>d;){var e=b[d],g=b[d+1];if(0===g)g=new m.BackgroundRenderBucket,g.layerID=e,this._renderBuckets.push(g),d+=2;else if(1===g)g=new m.FillRenderBucket,g.layerID=e,g.triangleElementStart=b[d+2],g.triangleElementCount=b[d+3],g.outlineElementStart=b[d+4],g.outlineElementCount=
b[d+5],this._renderBuckets.push(g),d+=6;else if(2===g)g=new m.LineRenderBucket,g.layerID=e,g.triangleElementStart=b[d+2],g.triangleElementCount=b[d+3],g.joinStart=b[d+4],g.joinCount=b[d+5],this._renderBuckets.push(g),d+=6;else if(3===g){g=new m.SymbolRenderBucket;g.layerID=e;g.textElementStart=b[d+2];g.textElementCount=b[d+3];g.isSDF=0!==b[d+4];e=b[d+5];if(0<e)for(var h=d+6,l=void 0,k=void 0,y=void 0,A=0;e>A;A++)l=b[h],k=b[h+1],y=b[h+2],g.markerPerPageElementsMap.set(l,[k,y]),h+=3;this._renderBuckets.push(g);
d+=6+3*e}else console.error("Bad bucket type!")}b=a.context;a=a.budget;c=new Uint32Array(this._vectorTileData.bufferDataInfo);d=c.length;for(e=g=0;d>e;e+=2,g++)if(h=c[e],l=c[e+1],!(0>=l||0===this._vectorTileData.bufferData[g].byteLength)){if(a&&a.done)return!1;switch(h){case 2:this.polygonTrianglesVertexBuffer||(this.polygonTrianglesVertexBuffer=f.createVertex(b,35044,this._vectorTileData.bufferData[g]));break;case 6:this.polygonTrianglesIndexBuffer||(this.polygonTrianglesIndexBuffer=f.createIndex(b,
35044,new Uint32Array(this._vectorTileData.bufferData[g],0,l/4)));break;case 3:this.polygonOutlinesVertexBuffer||(this.polygonOutlinesVertexBuffer=f.createVertex(b,35044,this._vectorTileData.bufferData[g]));break;case 7:this.polygonOutlinesIndexBuffer||(this.polygonOutlinesIndexBuffer=f.createIndex(b,35044,new Uint32Array(this._vectorTileData.bufferData[g],0,l/4)));break;case 0:this.lineVertexBuffer||(this.lineVertexBuffer=f.createVertex(b,35044,this._vectorTileData.bufferData[g]));break;case 8:this.lineTrianglesIndexBuffer||
(this.lineTrianglesIndexBuffer=f.createIndex(b,35044,this._vectorTileData.bufferData[g]));break;case 1:this.lineJoinVertexBuffer||(this.lineJoinVertexBuffer=f.createVertex(b,35044,this._vectorTileData.bufferData[g]));break;case 4:this.iconVertexBuffer||(this.iconVertexBuffer=f.createVertex(b,35044,this._vectorTileData.bufferData[g]));break;case 9:this.iconIndexBuffer||(this.iconIndexBuffer=f.createIndex(b,35044,new Uint32Array(this._vectorTileData.bufferData[g],0,l/4)));break;case 5:this.textVertexBuffer||
(this.textVertexBuffer=f.createVertex(b,35044,this._vectorTileData.bufferData[g]));break;case 10:this.textIndexBuffer||(this.textIndexBuffer=f.createIndex(b,35044,new Uint32Array(this._vectorTileData.bufferData[g],0,l/4)))}}return this.status=4,!0},d.prototype.detach=function(a){},d.prototype.render=function(a){if(this.visible&&4===this.status){var b=a.context,c=a.renderer;if(b&&c){var d=a.drawphase;this._symbolUpdateData&&this._updateSymbolData(a);b.setStencilFunction(514,this.stencilData.reference,
this.stencilData.mask);var e=this.styleLayers,f=void 0!==a.layerOpacity?a.layerOpacity:1;if(0!==f){var g,h=this._renderBuckets.length,l=0;if(0===d)for(l=h-1;0<=l;l--)g=this._renderBuckets[l],3!==g.type&&g.hasData()&&c.renderBucket(b,g,a.displayLevel,a.requiredLevel,d,this,e.layers[g.layerID],f);else for(l=0;h>l;l++)g=this._renderBuckets[l],g.hasData()&&c.renderBucket(b,g,a.displayLevel,a.requiredLevel,d,this,e.layers[g.layerID],f)}}}},d.prototype._updateSymbolData=function(a){var b=new Uint32Array(this._symbolUpdateData.bucketDataInfo),
c=b.length;if(0===c)return this._symbolUpdateData=null,!0;if(1>a.budget.remaining)return this.requestRender(),!1;a=a.context;a.bindVAO(null);for(var d=new Uint32Array(this._symbolUpdateData.bufferDataInfo),e=d.length,g=0,h=0;e>h;h+=2,g++){var l=d[h],k=d[h+1];if(!(0>=k||0===this._symbolUpdateData.bufferData[g].byteLength))switch(l){case 4:this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconVertexBuffer=f.createVertex(a,35044,this._symbolUpdateData.bufferData[g]);
break;case 9:this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.iconIndexBuffer=f.createIndex(a,35044,new Uint32Array(this._symbolUpdateData.bufferData[g],0,k/4));break;case 5:this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textVertexBuffer=f.createVertex(a,35044,this._symbolUpdateData.bufferData[g]);break;case 10:this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null),this.textIndexBuffer=f.createIndex(a,
35044,new Uint32Array(this._symbolUpdateData.bufferData[g],0,k/4))}}a=this._renderBuckets.length;for(d=0;a>d;d++)this._renderBuckets[d]instanceof m.SymbolRenderBucket&&(e=this._renderBuckets[d],e.markerPerPageElementsMap.clear(),e.textElementStart=0,e.textElementCount=0);for(a=0;c>a;){g=b[a];e=-1;h=this._renderBuckets.length;for(d=0;h>d;d++)if(this._renderBuckets[d].layerID===g){e=d;break}if(d=this._renderBuckets[e]){d.textElementStart=b[a+2];d.textElementCount=b[a+3];for(var e=b[a+5],g=a+6,k=l=h=
void 0,y=0;e>y;y++)h=b[g],l=b[g+1],k=b[g+2],d.markerPerPageElementsMap.set(h,[l,k]),g+=3;a+=6+3*e}else a+=7}return this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null),this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null),this._symbolUpdateData=null,!0},d}(b)})},"esri/layers/vectorTiles/views/vectorTiles/RenderBucket":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper"],
function(h,k,a,f){h=function(){return function(a){this.type=a}}();k.RenderBucket=h;f=function(b){function e(){var a=b.call(this,2)||this;return a.triangleElementStart=0,a.triangleElementCount=0,a.joinStart=0,a.joinCount=0,a}return a(e,b),e.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.joinCount},e}(h);k.LineRenderBucket=f;f=function(b){function e(){var a=b.call(this,1)||this;return a.triangleElementStart=0,a.triangleElementCount=0,a.outlineElementStart=0,a.outlineElementCount=
0,a}return a(e,b),e.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.outlineElementCount},e}(h);k.FillRenderBucket=f;f=function(b){function e(){var a=b.call(this,3)||this;return a.markerPerPageElementsMap=new Map,a.textElementStart=0,a.textElementCount=0,a.isSDF=!1,a}return a(e,b),e.prototype.hasData=function(){return 0<this.markerPerPageElementsMap.size||0<this.textElementCount},e}(h);k.SymbolRenderBucket=f;h=function(b){function e(){return b.call(this,0)||this}return a(e,
b),e.prototype.hasData=function(){return!0},e}(h);k.BackgroundRenderBucket=h})},"esri/layers/vectorTiles/views/2d/engine/StageGL":function(){define("require exports ../../../core/tsSupport/extendsHelper ./../math/vec2 ./../math/mat2d ./webgl/BitBlitRenderer ../../support/screenshotUtils ../../../core/promiseUtils ../math/common ./Container ../../webgl/RenderingContext ../../webgl/FramebufferObject ../../webgl/webgl-utils ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject ./webgl/glShaderSnippets".split(" "),
function(h,k,a,f,b,e,l,m,g,d,c,n,q,t,r,v,u){function w(a){return{budget:a.budget,state:a.state,devicePixelRatio:a.devicePixelRatio,stationary:a.stationary}}var x={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"};return function(d){function h(){var a=null!==d&&d.apply(this,arguments)||this;return a._clipData=new Float32Array(8),a._upperLeft=f.create(),a._upperRight=f.create(),a._lowerLeft=f.create(),a._lowerRight=f.create(),a._mat2=b.create(),a._clipRendererInitialized=!1,a}return a(h,d),h.prototype.createElement=
function(){var a=document.createElement("canvas");return a.setAttribute("class","esri-display-object"),a},h.prototype.setElement=function(a){this.element=a},h.prototype.attach=function(a){this._resizeCanvas(a);var b=q.setupWebGL(this.element,{alpha:!0,antialias:!1,depth:!0,stencil:!0});return this._renderingContext=new c(b[0]),this.attached=!0,this._cachedRenderParams=w(a),d.prototype.attach.call(this,a)},h.prototype.detach=function(a){d.prototype.detach.call(this,a);this._cachedRenderParams=this._renderingContext=
null},h.prototype.beforeRenderChildren=function(a,c){var d=a.state;if(!(d.spatialReference&&(d.spatialReference._isWrappable?d.spatialReference._isWrappable():d.spatialReference.isWrappable)))return void(this._clipFrame=!1);var e=d.width,h=d.height,l=d.rotation,k=this._renderingContext,e=e*a.devicePixelRatio,h=h*a.devicePixelRatio,m=g.toRadian(l),q=Math.abs(Math.cos(m)),r=Math.abs(Math.sin(m)),t=Math.round(d.worldScreenWidth);if(t>=Math.round(e*q+h*r))return void(this._clipFrame=!1);this._clipFBO&&
this._clipFBO.width===e&&this._clipFBO.height===h||(this._clipFBO=new n(k,{colorTarget:0,depthStencilTarget:3,width:e,height:h}));var u=.5*e,v=.5*h,d=1/e,w=1/h,t=.5*t*a.devicePixelRatio,x=.5*(e*r+h*q),e=this._upperLeft,q=this._upperRight,r=this._lowerLeft,z=this._lowerRight;f.set(e,-t,-x);f.set(q,t,-x);f.set(r,-t,x);f.set(z,t,x);b.identity(this._mat2);b.translate(this._mat2,this._mat2,[u,v]);0!==l&&b.rotate(this._mat2,this._mat2,m);f.transformMat2d(e,e,this._mat2);f.transformMat2d(q,q,this._mat2);
f.transformMat2d(r,r,this._mat2);f.transformMat2d(z,z,this._mat2);l=this._clipData;l.set([2*r[0]*d-1,2*(h-r[1])*w-1,2*z[0]*d-1,2*(h-z[1])*w-1,2*e[0]*d-1,2*(h-e[1])*w-1,2*q[0]*d-1,2*(h-q[1])*w-1]);this._clipRendererInitialized||this._initializeClipRenderer(k);this._clipVBO.setData(l);k.bindFramebuffer(this._clipFBO);k.setDepthWriteEnabled(!0);k.setStencilWriteMask(255);k.setClearColor(0,0,0,0);k.setClearDepth(1);k.setClearStencil(0);k.clear(k.gl.COLOR_BUFFER_BIT|k.gl.DEPTH_BUFFER_BIT|k.gl.STENCIL_BUFFER_BIT);
this._clipFrame=!0},h.prototype.afterRenderChildren=function(a,b){if(this._clipFrame&&this._clipRendererInitialized){var c=this._renderingContext;c.bindFramebuffer();c.bindVAO(this._clipVAO);c.bindProgram(this._clipStencilProgram);c.setDepthWriteEnabled(!1);c.setDepthTestEnabled(!1);c.setStencilTestEnabled(!0);c.setBlendingEnabled(!1);c.setColorMask(!1,!1,!1,!1);c.setStencilOp(7680,7680,7681);c.setStencilWriteMask(255);c.setStencilFunction(519,1,255);c.drawElements(4,6,5123,0);c.bindVAO();c.setColorMask(!0,
!0,!0,!0);c.setBlendingEnabled(!0);c.setStencilWriteMask(255);c.setStencilFunction(514,1,255);this._blitRenderer.render(c,this._clipFBO.colorTexture,9728,1);c.setStencilTestEnabled(!1)}},h.prototype.render=function(a){var b=this.element.style;return this.visible?(b.display="block",b.opacity=""+this.opacity,this._resizeCanvas(a),d.prototype.render.call(this,a),void(this._cachedRenderParams=w(a))):void(b.display="none")},h.prototype.takeScreenshot=function(a){var b=this._cachedRenderParams.devicePixelRatio,
c=b*this._cachedRenderParams.state.width,d=b*this._cachedRenderParams.state.height,e=0,f=0,g=c,h=d,k=c,q=d,k=a.area;(k&&(e=b*k.x,f=b*k.y,g=b*k.width,h=b*k.height),void 0!==a.width&&void 0!==a.height)?(k=a.width/a.height,h*k<g?(k*=h,e+=Math.floor((g-k)/2),g=Math.floor(k)):(k=g/k,f+=Math.floor((h-k)/2),h=Math.floor(k)),k=a.width,q=a.height):(k=g,q=h);b=document.createElement("canvas");b.width=k;b.height=q;var r=b.getContext("2d"),t=new Uint8Array(g*h*4),u=this._renderingContext,v=n.create(u,{colorTarget:1,
depthStencilTarget:3,width:c,height:d});u.bindFramebuffer(v);u.setViewport(0,0,c,d);this._cachedRenderParams.budget&&this._cachedRenderParams.budget.reset(Number.MAX_VALUE);var w=this._cachedRenderParams,z=this._renderingContext.gl;this._renderingContext.setClearColor(0,0,0,0);this._renderingContext.setClearDepth(1);this._renderingContext.setClearStencil(0);this._renderingContext.clear(z.COLOR_BUFFER_BIT|z.DEPTH_BUFFER_BIT|z.STENCIL_BUFFER_BIT);w.context=this._renderingContext;this.renderChildren(w);
v.readPixels(e,d-(f+h),g,h,6408,5121,t);u.bindFramebuffer();u=r.getImageData(0,0,k,q);if(0!==e||0!==f||g!==c||h!==d||k!==c||q!==d)l.resampleHermite(t,g,h,u.data,k,q,!0);else{for(var c=h-1,d=0,g=4*g,y=z=w=v=h=f=e=void 0;c>d;){z=d*g;y=c*g;for(e=0;g>e;e+=4)f=t[z+e],h=t[z+e+1],v=t[z+e+2],w=t[z+e+3],t[z+e]=t[y+e],t[z+e+1]=t[y+e+1],t[z+e+2]=t[y+e+2],t[z+e+3]=t[y+e+3],t[y+e]=f,t[y+e+1]=h,t[y+e+2]=v,t[y+e+3]=w;d++;c--}g=u.data;c=t.length;for(d=0;c>d;d++)g[d]=t[d]}r.putImageData(u,0,0);r=x[a.format?a.format.toLowerCase():
"png"];t=1;void 0!==a.quality&&(t=a.quality/100);a=b.toDataURL(r,t);return m.resolve({dataURL:a,x:0,y:0,width:k,height:q})},h.prototype.prepareChildrenRenderParameters=function(a){if(!this.attached||!this._renderingContext)return null;var b=this._renderingContext,c=b.gl;return b.setDepthWriteEnabled(!0),b.setStencilWriteMask(255),b.setClearColor(0,0,0,0),b.setClearDepth(1),b.setClearStencil(0),b.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT|c.STENCIL_BUFFER_BIT),b.setViewport(0,0,this.element.width,
this.element.height),b.setDepthWriteEnabled(!1),a.context=b,a},h.prototype.attachChild=function(a,b){return a.attach(b)},h.prototype.detachChild=function(a,b){return a.detach(b)},h.prototype.renderChild=function(a,b){return a.render(b)},h.prototype._resizeCanvas=function(a){var b=this.element,c=b.style,d=a.state,e=a.devicePixelRatio;a=d.width*e;e*=d.height;(b.width!==a||b.height!==e)&&(b.width=a,b.height=e,c.width=d.width+"px",c.height=d.height+"px")},h.prototype._initializeClipRenderer=function(a){if(this._clipRendererInitialized)return!0;
this._blitRenderer=new e;var b={a_pos:0},c=new t(a,u.stencilVS,u.stencilFS,b);if(!c)return!1;var d=v.createVertex(a,35040,32),f=new Uint16Array([0,1,2,2,1,3]),f=v.createIndex(a,35044,f);a=new r(a,b,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:d},f);return this._clipStencilProgram=c,this._clipVBO=d,this._clipVAO=a,this._clipRendererInitialized=!0,!0},h}(d)})},"esri/layers/vectorTiles/views/2d/math/vec2":function(){define(["./common"],function(h){var k=
h.GLMAT_ARRAY_TYPE,a=h.GLMAT_RANDOM,f={};return f.create=function(){var a=new k(2);return a[0]=0,a[1]=0,a},f.clone=function(a){var b=new k(2);return b[0]=a[0],b[1]=a[1],b},f.fromValues=function(a,e){var b=new k(2);return b[0]=a,b[1]=e,b},f.copy=function(a,e){return a[0]=e[0],a[1]=e[1],a},f.set=function(a,e,f){return a[0]=e,a[1]=f,a},f.add=function(a,e,f){return a[0]=e[0]+f[0],a[1]=e[1]+f[1],a},f.subtract=function(a,e,f){return a[0]=e[0]-f[0],a[1]=e[1]-f[1],a},f.sub=f.subtract,f.multiply=function(a,
e,f){return a[0]=e[0]*f[0],a[1]=e[1]*f[1],a},f.mul=f.multiply,f.divide=function(a,e,f){return a[0]=e[0]/f[0],a[1]=e[1]/f[1],a},f.div=f.divide,f.min=function(a,e,f){return a[0]=Math.min(e[0],f[0]),a[1]=Math.min(e[1],f[1]),a},f.max=function(a,e,f){return a[0]=Math.max(e[0],f[0]),a[1]=Math.max(e[1],f[1]),a},f.scale=function(a,e,f){return a[0]=e[0]*f,a[1]=e[1]*f,a},f.scaleAndAdd=function(a,e,f,h){return a[0]=e[0]+f[0]*h,a[1]=e[1]+f[1]*h,a},f.distance=function(a,e){var b=e[0]-a[0],f=e[1]-a[1];return Math.sqrt(b*
b+f*f)},f.dist=f.distance,f.squaredDistance=function(a,e){var b=e[0]-a[0],f=e[1]-a[1];return b*b+f*f},f.sqrDist=f.squaredDistance,f.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)},f.len=f.length,f.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a},f.sqrLen=f.squaredLength,f.negate=function(a,e){return a[0]=-e[0],a[1]=-e[1],a},f.inverse=function(a,e){return a[0]=1/e[0],a[1]=1/e[1],a},f.normalize=function(a,e){var b=e[0],f=e[1],b=b*b+f*f;return 0<b&&(b=1/Math.sqrt(b),a[0]=e[0]*
b,a[1]=e[1]*b),a},f.dot=function(a,e){return a[0]*e[0]+a[1]*e[1]},f.cross=function(a,e,f){e=e[0]*f[1]-e[1]*f[0];return a[0]=a[1]=0,a[2]=e,a},f.lerp=function(a,e,f,h){var b=e[0];e=e[1];return a[0]=b+h*(f[0]-b),a[1]=e+h*(f[1]-e),a},f.random=function(b,e){e=e||1;var f=2*a()*Math.PI;return b[0]=Math.cos(f)*e,b[1]=Math.sin(f)*e,b},f.transformMat2=function(a,e,f){var b=e[0];e=e[1];return a[0]=f[0]*b+f[2]*e,a[1]=f[1]*b+f[3]*e,a},f.transformMat2d=function(a,e,f){var b=e[0];e=e[1];return a[0]=f[0]*b+f[2]*
e+f[4],a[1]=f[1]*b+f[3]*e+f[5],a},f.transformMat3=function(a,e,f){var b=e[0];e=e[1];return a[0]=f[0]*b+f[3]*e+f[6],a[1]=f[1]*b+f[4]*e+f[7],a},f.transformMat4=function(a,e,f){var b=e[0];e=e[1];return a[0]=f[0]*b+f[4]*e+f[12],a[1]=f[1]*b+f[5]*e+f[13],a},f.forEach=function(){var a=f.create();return function(b,f,h,g,d,c){f||(f=2);h||(h=0);for(g=g?Math.min(g*f+h,b.length):b.length;g>h;h+=f)a[0]=b[h],a[1]=b[h+1],d(a,a,c),b[h]=a[0],b[h+1]=a[1];return b}}(),f.str=function(a){return"vec2("+a[0]+", "+a[1]+
")"},f})},"esri/layers/vectorTiles/views/2d/math/common":function(){define([],function(){if(!h)var h=1E-6;if(!k)var k="undefined"!=typeof Float32Array?Float32Array:Array;if(!a)var a=Math.random;var f={GLMAT_EPSILON:h,GLMAT_ARRAY_TYPE:k,GLMAT_RANDOM:a,setMatrixArrayType:function(a){f.GLMAT_ARRAY_TYPE=a}},b=Math.PI/180,e=180/Math.PI;return f.toRadian=function(a){return a*b},f.toDegree=function(a){return a*e},f.setMatrixArrayType(Array),f})},"esri/layers/vectorTiles/views/2d/math/mat2d":function(){define(["./common"],
function(h){var k=h.GLMAT_ARRAY_TYPE;h={};return h.create=function(){var a=new k(6);return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},h.clone=function(a){var f=new k(6);return f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],f[4]=a[4],f[5]=a[5],f},h.copy=function(a,f){return a[0]=f[0],a[1]=f[1],a[2]=f[2],a[3]=f[3],a[4]=f[4],a[5]=f[5],a},h.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},h.invert=function(a,f){var b=f[0],e=f[1],h=f[2],k=f[3],g=f[4],d=f[5],c=b*k-e*h;return c?(c=1/c,
a[0]=k*c,a[1]=-e*c,a[2]=-h*c,a[3]=b*c,a[4]=(h*d-k*g)*c,a[5]=(e*g-b*d)*c,a):null},h.determinant=function(a){return a[0]*a[3]-a[1]*a[2]},h.multiply=function(a,f,b){var e=f[0],h=f[1],k=f[2],g=f[3],d=f[4];f=f[5];var c=b[0],n=b[1],q=b[2],t=b[3],r=b[4];b=b[5];return a[0]=e*c+k*n,a[1]=h*c+g*n,a[2]=e*q+k*t,a[3]=h*q+g*t,a[4]=e*r+k*b+d,a[5]=h*r+g*b+f,a},h.mul=h.multiply,h.rotate=function(a,f,b){var e=f[0],h=f[1],k=f[2],g=f[3],d=f[4];f=f[5];var c=Math.sin(b);b=Math.cos(b);return a[0]=e*b+k*c,a[1]=h*b+g*c,a[2]=
e*-c+k*b,a[3]=h*-c+g*b,a[4]=d,a[5]=f,a},h.scale=function(a,f,b){var e=f[1],h=f[2],k=f[3],g=f[4],d=f[5],c=b[0];b=b[1];return a[0]=f[0]*c,a[1]=e*c,a[2]=h*b,a[3]=k*b,a[4]=g,a[5]=d,a},h.translate=function(a,f,b){var e=f[0],h=f[1],k=f[2],g=f[3],d=f[4];f=f[5];var c=b[0];b=b[1];return a[0]=e,a[1]=h,a[2]=k,a[3]=g,a[4]=e*c+k*b+d,a[5]=h*c+g*b+f,a},h.fromRotation=function(a,f){var b=Math.sin(f),e=Math.cos(f);return a[0]=e,a[1]=b,a[2]=-b,a[3]=e,a[4]=0,a[5]=0,a},h.fromScaling=function(a,f){return a[0]=f[0],a[1]=
0,a[2]=0,a[3]=f[1],a[4]=0,a[5]=0,a},h.fromTranslation=function(a,f){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=f[0],a[5]=f[1],a},h.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"},h.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)},h})},"esri/layers/vectorTiles/views/2d/engine/webgl/BitBlitRenderer":function(){define("require exports ../../../webgl/Program ../../../webgl/VertexArrayObject ../../../webgl/BufferObject ./glShaderSnippets".split(" "),
function(h,k,a,f,b,e){return function(){function h(){this._initialized=!1}return h.prototype.render=function(a,b,d,c){a&&b&&(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),b.setSamplingMode(d),a.bindTexture(b,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",c),a.drawArrays(5,0,4),a.bindVAO())},h.prototype._initialize=function(h){if(this._initialized)return!0;var g={a_pos:0,
a_tex:1},d=new a(h,e.bitblitVS,e.bitblitFS,g);if(!d)return!1;var c=new Int8Array(16);c[0]=-1;c[1]=-1;c[2]=0;c[3]=0;c[4]=1;c[5]=-1;c[6]=1;c[7]=0;c[8]=-1;c[9]=1;c[10]=0;c[11]=1;c[12]=1;c[13]=1;c[14]=1;c[15]=1;h=new f(h,g,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:b.createVertex(h,35044,c)});return this._program=d,this._vertexArrayObject=h,this._initialized=!0,!0},h}()})},
"esri/layers/vectorTiles/views/2d/engine/webgl/glShaderSnippets":function(){define("require exports ../../../webgl/ShaderSnippets dojo/text!./Shaders.xml dojo/text!./bitblit.vs.glsl dojo/text!./bitblit.fs.glsl dojo/text!./stencil.vs.glsl dojo/text!./stencil.fs.glsl".split(" "),function(h,k,a,f,b,e,l,m){function g(a,b){d+='\x3csnippet name\x3d"'+a+'"\x3e\x3c![CDATA[';d+=b;d+="]]\x3e\x3c/snippet\x3e"}var d="",d=d+'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e',d=d+"\x3csnippets\x3e";g("bitblitVS",
b);g("bitblitFS",e);g("stencilVS",l);g("stencilFS",m);d+="\x3c/snippets\x3e";h=new a;return a.parse(d,h),a.parse(f,h),h})},"esri/layers/vectorTiles/views/support/screenshotUtils":function(){define(["require","exports","dojo/_base/lang"],function(h,k,a){k.adjustScreenshotSettings=function(f,b){f=a.mixin({format:"png",quality:100},f||{});var e,h;f.includePadding?(e=b.width,h=b.height):(e=b.width-b.padding.left-b.padding.right,h=b.height-b.padding.top-b.padding.bottom);var k=e/h;return void 0!==f.width&&
void 0===f.height?f.height=f.width/k:void 0!==f.height&&void 0===f.width&&(f.width=k*f.height),void 0!==f.height&&(f.height=Math.floor(f.height)),void 0!==f.width&&(f.width=Math.floor(f.width)),f.area||f.includePadding||(f.area={x:b.padding.left,y:b.padding.top,width:e,height:h}),f};k.resampleHermite=function(a,b,e,h,k,g,d){void 0===d&&(d=!0);var c=b/k;e/=g;for(var f=Math.ceil(c/2),l=Math.ceil(e/2),m=0;g>m;m++)for(var r=0;k>r;r++){for(var v=4*(r+(d?g-m-1:m)*k),u=0,w=0,x=0,y=0,A=0,z=0,B=0,C=(m+.5)*
e,D=Math.floor(m*e);(m+1)*e>D;D++)for(var E=Math.abs(C-(D+.5))/l,F=(r+.5)*c,E=E*E,G=Math.floor(r*c);(r+1)*c>G;G++){var I=Math.abs(F-(G+.5))/f,J=Math.sqrt(E+I*I);-1<=J&&1>=J&&(u=2*J*J*J-3*J*J+1,0<u&&(I=4*(G+D*b),B+=u*a[I+3],x+=u,255>a[I+3]&&(u=u*a[I+3]/250),y+=u*a[I],A+=u*a[I+1],z+=u*a[I+2],w+=u))}h[v]=y/w;h[v+1]=A/w;h[v+2]=z/w;h[v+3]=B/x}}})},"esri/layers/vectorTiles/views/webgl/RenderingContext":function(){define(["require","exports","./enums","./Extensions"],function(h,k,a,f){h=function(){function b(a,
b){this.gl=null;this._extensions=void 0;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState={r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=
!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=1;this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680};this._lineWidth=1;this._clearColor={r:0,g:0,b:0,a:0};this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap=
{};this.gl=a;this._extensions=new f(a,b);var e=a.getParameter(a.VIEWPORT);this._viewport={x:e[0],y:e[1],width:e[2],height:e[3]};e=this.extensions.textureFilterAnisotropic;this._parameters={versionString:a.getParameter(a.VERSION),maxVertexTextureImageUnits:a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:a.getParameter(a.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:e?a.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):void 0,maxTextureImageUnits:a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS)};
this.enforceState()}return Object.defineProperty(b.prototype,"extensions",{get:function(){return this._extensions},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"parameters",{get:function(){return this._parameters},enumerable:!0,configurable:!0}),b.prototype.setBlendingEnabled=function(a){this._blendEnabled!==a&&(!0===a?this.gl.enable(this.gl.BLEND):
this.gl.disable(this.gl.BLEND),this._blendEnabled=a)},b.prototype.setBlendColor=function(a,b,f,g){(a!==this._blendColorState.r||b!==this._blendColorState.g||f!==this._blendColorState.b||g!==this._blendColorState.a)&&(this.gl.blendColor(a,b,f,g),this._blendColorState.r=a,this._blendColorState.g=b,this._blendColorState.b=f,this._blendColorState.a=g)},b.prototype.setBlendFunction=function(a,b){(a!==this._blendFunctionState.srcRGB||b!==this._blendFunctionState.dstRGB)&&(this.gl.blendFunc(a,b),this._blendFunctionState.srcRGB=
a,this._blendFunctionState.srcAlpha=a,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=b)},b.prototype.setBlendFunctionSeparate=function(a,b,f,g){(this._blendFunctionState.srcRGB!==a||this._blendFunctionState.srcAlpha!==f||this._blendFunctionState.dstRGB!==b||this._blendFunctionState.dstAlpha!==g)&&(this.gl.blendFuncSeparate(a,b,f,g),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=f,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=g)},b.prototype.setBlendEquation=
function(a){this._blendEquationState.mode!==a&&(this.gl.blendEquation(a),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=a)},b.prototype.setBlendEquationSeparate=function(a,b){(this._blendEquationState.mode!==a||this._blendEquationState.modeAlpha!==b)&&(this.gl.blendEquationSeparate(a,b),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=b)},b.prototype.setColorMask=function(a,b,f,g){(this._colorMaskState.r!==a||this._colorMaskState.g!==b||this._colorMaskState.b!==
f||this._colorMaskState.a!==g)&&(this.gl.colorMask(a,b,f,g),this._colorMaskState.r=a,this._colorMaskState.g=b,this._colorMaskState.b=f,this._colorMaskState.a=g)},b.prototype.setClearColor=function(a,b,f,g){(this._clearColor.r!==a||this._clearColor.g!==b||this._clearColor.b!==f||this._clearColor.a!==g)&&(this.gl.clearColor(a,b,f,g),this._clearColor.r=a,this._clearColor.g=b,this._clearColor.b=f,this._clearColor.a=g)},b.prototype.setFaceCullingEnabled=function(a){this._polygonCullingEnabled!==a&&(!0===
a?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=a)},b.prototype.setPolygonOffsetFillEnabled=function(a){this._polygonOffsetFillEnabled!==a&&(!0===a?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=a)},b.prototype.setPolygonOffset=function(a,b){this._polygonOffset[0]===a&&this._polygonOffset[1]===b||(this._polygonOffset[0]=a,this._polygonOffset[1]=b,this.gl.polygonOffset(a,b))},
b.prototype.setCullFace=function(a){this._cullFace!==a&&(this.gl.cullFace(a),this._cullFace=a)},b.prototype.setFrontFace=function(a){this._frontFace!==a&&(this.gl.frontFace(a),this._frontFace=a)},b.prototype.setScissorTestEnabled=function(a){this._scissorTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=a)},b.prototype.setScissorRect=function(a,b,f,g){(this._scissorRect.x!==a||this._scissorRect.y!==b||this._scissorRect.width!==
f||this._scissorRect.height!==g)&&(this.gl.scissor(a,b,f,g),this._scissorRect.x=a,this._scissorRect.y=b,this._scissorRect.width=f,this._scissorRect.height=g)},b.prototype.setDepthTestEnabled=function(a){this._depthTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=a)},b.prototype.setClearDepth=function(a){this._clearDepth!==a&&(this.gl.clearDepth(a),this._clearDepth=a)},b.prototype.setDepthFunction=function(a){this._depthFunction!==
a&&(this.gl.depthFunc(a),this._depthFunction=a)},b.prototype.setDepthWriteEnabled=function(a){this._depthWriteEnabled!==a&&(this.gl.depthMask(a),this._depthWriteEnabled=a)},b.prototype.setDepthRange=function(a,b){(this._depthRange.zNear!==a||this._depthRange.zFar!==b)&&(this.gl.depthRange(a,b),this._depthRange.zNear=a,this._depthRange.zFar=b)},b.prototype.setStencilTestEnabled=function(a){this._stencilTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),
this._stencilTestEnabled=a)},b.prototype.setClearStencil=function(a){a!==this._clearStencil&&(this.gl.clearStencil(a),this._clearStencil=a)},b.prototype.setStencilFunction=function(a,b,f){(this._stencilFunction.func!==a||this._stencilFunction.ref!==b||this._stencilFunction.mask!==f)&&(this.gl.stencilFunc(a,b,f),this._stencilFunction.face=1032,this._stencilFunction.func=a,this._stencilFunction.ref=b,this._stencilFunction.mask=f)},b.prototype.setStencilFunctionSeparate=function(a,b,f,g){(this._stencilFunction.face!==
a||this._stencilFunction.func!==b||this._stencilFunction.ref!==f||this._stencilFunction.mask!==g)&&(this.gl.stencilFuncSeparate(a,b,f,g),this._stencilFunction.face=a,this._stencilFunction.func=b,this._stencilFunction.ref=f,this._stencilFunction.mask=g)},b.prototype.setStencilWriteMask=function(a){this._stencilWriteMask!==a&&(this.gl.stencilMask(a),this._stencilWriteMask=a)},b.prototype.setStencilOp=function(a,b,f){(this._stencilOperation.fail!==a||this._stencilOperation.zFail!==b||this._stencilOperation.zPass!==
f)&&(this.gl.stencilOp(a,b,f),this._stencilOperation.face=1032,this._stencilOperation.fail=a,this._stencilOperation.zFail=b,this._stencilOperation.zPass=f)},b.prototype.setStencilOpSeparate=function(a,b,f,g){(this._stencilOperation.face!==a||this._stencilOperation.fail!==b||this._stencilOperation.zFail!==f||this._stencilOperation.zPass!==g)&&(this.gl.stencilOpSeparate(a,b,f,g),this._stencilOperation.face=a,this._stencilOperation.face=a,this._stencilOperation.fail=b,this._stencilOperation.zFail=f,
this._stencilOperation.zPass=g)},b.prototype.setLineWidth=function(a){var b=this._lineWidth;return this._lineWidth!==a&&(this.gl.lineWidth(a),this._lineWidth=a),b},b.prototype.setActiveTexture=function(b){var e=this._activeTextureUnit;return 0<=b&&b!==this._activeTextureUnit&&(this.gl.activeTexture(a.BASE_TEXTURE_UNIT+b),this._activeTextureUnit=b),e},b.prototype.clear=function(a){a&&this.gl.clear(a)},b.prototype.drawArrays=function(a,b,f){this.gl.drawArrays(a,b,f)},b.prototype.drawElements=function(a,
b,f,g){return 5123===f?void this.gl.drawElements(a,b,f,g):void(5125===f&&this._extensions.elementIndexUint?this.gl.drawElements(a,b,f,g):console.warn("Data type is uint however extension OES_Element_index_unit is not supported therefore this draw call cannot be made"))},b.prototype.drawArraysInstanced=function(a,b,f,g){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawArraysInstancedANGLE(a,b,f,g):console.error("Extension ANGLE_instanced_arrays isn't supported!")},b.prototype.drawElementsInstanced=
function(a,b,f,g,d){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawElementsInstancedANGLE(a,b,f,g,d):console.error("Extension ANGLE_instanced_arrays isn't supported!")},b.prototype.setViewport=function(a,b,f,g){var d=this._viewport;d.x===a&&d.y===b&&d.width===f&&d.height===g||(d.x=a,d.y=b,d.width=f,d.height=g,this.gl.viewport(a,b,f,g))},b.prototype.getViewport=function(){return this._viewport},b.prototype.bindProgram=function(a){return a?void(this._activeShaderProgram!==
a&&(a.initialize(),this.gl.useProgram(a.glName),this._activeShaderProgram=a)):(this.gl.useProgram(null),void(this._activeShaderProgram=null))},b.prototype.bindTexture=function(a,f){void 0===f&&(f=0);-1===b._MAX_TEXTURE_IMAGE_UNITS&&(b._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));(f>=b._MAX_TEXTURE_IMAGE_UNITS||0>f)&&console.error("Input texture unit is out of range of available units!");var e=this._textureUnitMap[f];return this.setActiveTexture(f),null==a?(null!=
e&&this.gl.bindTexture(e.descriptor.target,null),void(this._textureUnitMap[f]=null)):e&&e.id===a.id?void a.applyChanges():(this.gl.bindTexture(a.descriptor.target,a.glName),a.applyChanges(),void(this._textureUnitMap[f]=a))},b.prototype.bindFramebuffer=function(a){return a?void(this._activeFramebuffer!==a&&(a.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.glName),this._activeFramebuffer=a)):(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),void(this._activeFramebuffer=null))},b.prototype.bindBuffer=
function(a){a&&(34962===a.bufferType?this._activeVertexBuffer=b._bindBuffer(this.gl,a,a.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=b._bindBuffer(this.gl,a,a.bufferType,this._activeIndexBuffer))},b.prototype.unbindBuffer=function(a){34962===a?this._activeVertexBuffer=b._bindBuffer(this.gl,null,a,this._activeVertexBuffer):this._activeIndexBuffer=b._bindBuffer(this.gl,null,a,this._activeIndexBuffer)},b.prototype.bindVAO=function(a){return a?void(this._activeVertexArrayObject&&this._activeVertexArrayObject.id===
a.id||(a.bind(),this._activeVertexArrayObject=a)):void(this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null))},b.prototype.getBoundTexture=function(a){return this._textureUnitMap[a]},b.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer},b.prototype.getBoundVAO=function(){return this._activeVertexArrayObject},b.prototype.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);
this.unbindBuffer(34963);for(var a=0;a<this.parameters.maxTextureImageUnits;a++)this.bindTexture(null,a);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);
this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)},b.prototype.enforceState=function(){var b=this.gl,f=this._extensions.vao;f&&f.bindVertexArrayOES(null);for(var h=0;h<this.parameters.maxVertexAttributes;h++)b.disableVertexAttribArray(h);
if(this._activeVertexBuffer?b.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):b.bindBuffer(34962,null),this._activeIndexBuffer?b.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):b.bindBuffer(34963,null),f&&this._activeVertexArrayObject)(f=this._activeVertexArrayObject)&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null),this.bindVAO(f);b.bindFramebuffer(b.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:
null);b.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);b.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);!0===this._blendEnabled?b.enable(this.gl.BLEND):b.disable(this.gl.BLEND);b.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);b.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);
b.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);b.clearDepth(this._clearDepth);b.clearStencil(this._clearStencil);b.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);b.cullFace(this._cullFace);b.depthFunc(this._depthFunction);b.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST);b.depthMask(this._depthWriteEnabled);b.frontFace(this._frontFace);
b.lineWidth(this._lineWidth);!0===this._polygonCullingEnabled?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE);b.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?b.enable(b.POLYGON_OFFSET_FILL):b.disable(b.POLYGON_OFFSET_FILL);b.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?b.enable(b.SCISSOR_TEST):b.disable(b.SCISSOR_TEST);b.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,
this._stencilFunction.mask);b.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST);b.stencilMask(this._stencilWriteMask);for(f=0;f<this.parameters.maxTextureImageUnits;f++)b.activeTexture(a.BASE_TEXTURE_UNIT+f),b.bindTexture(3553,null),(h=this._textureUnitMap[f])&&b.bindTexture(h.descriptor.target,h.glName);b.activeTexture(a.BASE_TEXTURE_UNIT+
this._activeTextureUnit);b.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)},b._bindBuffer=function(a,b,f,g){return b?g===b?g:(a.bindBuffer(f,b.glName),b):(a.bindBuffer(f,null),null)},b}();return h._MAX_TEXTURE_IMAGE_UNITS=-1,h})},"esri/layers/vectorTiles/views/webgl/enums":function(){define(["require","exports"],function(h,k){k.BASE_TEXTURE_UNIT=33984})},"esri/layers/vectorTiles/views/webgl/Extensions":function(){define(["require","exports"],function(h,k){return function(){function a(a,
b){if(this._vaoInit=!1,this._angleInstancedArraysInit=!1,this._standardDerivativesInit=!1,this._elementIndexUintInit=!1,this._depthTextureInit=!1,this._textureFilterAnisotropicInit=!1,this._shaderTextureLODInit=!1,this._compressedTextureS3TCInit=!1,this._gl=a,b&&b.disabledExtensions){var e=b.disabledExtensions;e.vao&&(this._vao=null,this._vaoInit=!0);e.angleInstancedArrays&&(this._angleInstancedArrays=null,this._angleInstancedArraysInit=!0);e.standardDerivatives&&(this._standardDerivatives=null,this._standardDerivativesInit=
!0);e.elementIndexUint&&(this._elementIndexUint=null,this._elementIndexUintInit=!0);e.depthTexture&&(this._depthTexture=null,this._depthTextureInit=!0);e.textureFilterAnisotropic&&(this._textureFilterAnisotropic=null,this._textureFilterAnisotropicInit=!0);e.compressedTextureS3TC&&(this._compressedTextureS3TC=null,this._compressedTextureS3TCInit=!0);e.shaderTextureLOD&&(this._shaderTextureLOD=null,this._shaderTextureLODInit=!0)}}return Object.defineProperty(a.prototype,"vao",{get:function(){return this._vaoInit||
(this._vao=this._gl.getExtension("OES_vertex_array_object")||this._gl.getExtension("MOZ_OES_vertex_array_object")||this._gl.getExtension("WEBKIT_OES_vertex_array_object"),this._vaoInit=!0),this._vao},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"angleInstancedArrays",{get:function(){return this._angleInstancedArraysInit||(this._angleInstancedArrays=this._gl.getExtension("ANGLE_instanced_arrays"),this._angleInstancedArraysInit=!0),this._angleInstancedArrays},enumerable:!0,configurable:!0}),
Object.defineProperty(a.prototype,"standardDerivatives",{get:function(){return this._standardDerivativesInit||(this._standardDerivatives=this._gl.getExtension("OES_standard_derivatives"),this._standardDerivativesInit=!0),this._standardDerivatives},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"elementIndexUint",{get:function(){return this._elementIndexUintInit||(this._elementIndexUint=this._gl.getExtension("OES_element_index_uint"),this._elementIndexUintInit=!0),this._elementIndexUint},
enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"depthTexture",{get:function(){return this._depthTextureInit||(this._depthTexture=this._gl.getExtension("WEBGL_depth_texture")||this._gl.getExtension("MOZ_WEBGL_depth_texture")||this._gl.getExtension("WEBKIT_WEBGL_depth_texture"),this._depthTextureInit=!0),this._depthTexture},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"textureFilterAnisotropic",{get:function(){return this._textureFilterAnisotropicInit||(this._textureFilterAnisotropic=
this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this._textureFilterAnisotropicInit=!0),this._textureFilterAnisotropic},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"shaderTextureLOD",{get:function(){return this._shaderTextureLODInit||(this._shaderTextureLOD=this._gl.getExtension("EXT_shader_texture_lod"),this._shaderTextureLODInit=!0),this._shaderTextureLOD},
enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"compressedTextureS3TC",{get:function(){return this._compressedTextureS3TCInit||(this._compressedTextureS3TC=this._gl.getExtension("WEBGL_compressed_texture_s3tc"),this._compressedTextureS3TCInit=!0),this._compressedTextureS3TC},enumerable:!0,configurable:!0}),a}()})},"esri/layers/vectorTiles/views/webgl/FramebufferObject":function(){define(["require","exports","./Texture"],function(h,k,a){h=function(){function f(b,e,h,k){if(this._context=
null,this._glName=null,this._depthAttachment=null,this._stencilAttachment=null,this._colorAttachment=null,this._initialized=!1,this._context=b,this._desc={colorTarget:e.colorTarget,depthStencilTarget:e.depthStencilTarget,width:e.width,height:e.height,multisampled:e.multisampled},this._id=f._nextId++,h)b=void 0,h instanceof a?(this._colorAttachment=h,b=h.descriptor):(b=h,this._colorAttachment=new a(this._context,b)),0!==this._desc.colorTarget&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),
f._validateTextureDimensions(b,this._desc);k&&(this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),h=void 0,k instanceof a?(this._depthStencilTexture=k,h=this._depthStencilTexture.descriptor):(h=k,this._depthStencilTexture=new a(this._context,h)),f._validateTextureDimensions(h,this._desc))}return f.create=function(a,e){return new f(a,e)},f.createWithAttachments=function(a,
e,h,k){return new f(a,h,e,k)},Object.defineProperty(f.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"colorTexture",{get:function(){return this._colorAttachment instanceof a?this._colorAttachment:null},enumerable:!0,
configurable:!0}),Object.defineProperty(f.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"width",{get:function(){return this._desc.width},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"height",{get:function(){return this._desc.height},enumerable:!0,configurable:!0}),f.prototype.dispose=function(){this._context&&this._glName&&(this._disposeColorAttachment(),this._disposeDepthStencilAttachments(),
this._context.gl.deleteFramebuffer(this._glName),this._glName=null)},f.prototype.attachColorTexture=function(a){if(a){if(f._validateTextureDimensions(a.descriptor,this._desc),this._disposeColorAttachment(),this._initialized){this._context.bindFramebuffer(this);var b=this._context.gl;b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,a.glName,0)}this._colorAttachment=a}},f.prototype.detachColorTexture=function(){var b=void 0;if(this._colorAttachment instanceof a){if(b=this._colorAttachment,
this._initialized){this._context.bindFramebuffer(this);var e=this._context.gl;this._context.gl.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}this._colorAttachment=null}return b},f.prototype.attachDepthStencilTexture=function(a){if(a){var b=a.descriptor;if(34041!==b.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!"),34042!==b.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8_WEBGL!"),this._context.extensions.depthTexture||
console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!"),f._validateTextureDimensions(b,this._desc),4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4),this._disposeDepthStencilAttachments(),this._initialized)this._context.bindFramebuffer(this),b=this._context.gl,b.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,a.glName,0);this._depthStencilTexture=a}},f.prototype.detachDepthStencilTexture=
function(){var a=this._depthStencilTexture;if(a&&this._initialized){this._context.bindFramebuffer(this);var e=this._context.gl;this._context.gl.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,null,0)}return this._depthStencilTexture=null,a},f.prototype.copyToTexture=function(a,e,f,h,g,d,c){(0>a||0>e||0>g||0>d)&&console.error("Offsets cannot be negative!");(0>=f||0>=h)&&console.error("Copy width and height must be greater than zero!");var b=this._desc,l=c.descriptor;3553!==
c.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");(a+f>b.width||e+h>b.height||g+f>l.width||d+h>l.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");b=this._context;b.bindTexture(c);b.bindFramebuffer(this);b.gl.copyTexSubImage2D(3553,0,g,d,a,e,f,h)},f.prototype.readPixels=function(a,e,f,h,g,d,c){(0>=f||0>=h)&&console.error("Copy width and height must be greater than zero!");c||console.error("Target memory is not initialized!");
this._context.bindFramebuffer(this);this._context.gl.readPixels(a,e,f,h,g,d,c)},f.prototype.resize=function(b,e){var h=this._desc;if(h.width!==b||h.height!==e){if(!this._initialized){if(h.width=b,h.height=e,this._colorAttachment instanceof a)h=this._colorAttachment,h.resize(b,e);return void(this._depthStencilTexture&&this._depthStencilTexture.resize(b,e))}if(h.width=b,h.height=e,this._colorAttachment instanceof a){var h=this._colorAttachment,k=h.descriptor;k.width=b;k.height=e;this._colorAttachment=
new a(this._context,k);f._validateTextureDimensions(h.descriptor,this._desc)}else this._colorAttachment=null;null!=this._depthStencilTexture&&(k=this._depthStencilTexture.descriptor,k.width=b,k.height=e,this._depthStencilTexture=new a(this._context,k));this._initialized=!1}},f.prototype.initialize=function(){if(this._initialized)return!1;var b=this._context.gl,e=b.createFramebuffer(),f=this._desc;if(b.bindFramebuffer(b.FRAMEBUFFER,e),!this._colorAttachment)if(0===f.colorTarget)this._colorAttachment=
new a(this._context,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:f.width,height:f.height});else{var h=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,h);b.renderbufferStorage(b.RENDERBUFFER,b.RGBA4,f.width,f.height);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.RENDERBUFFER,h);this._colorAttachment=h}this._colorAttachment instanceof a&&b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,this._colorAttachment.glName,0);
switch(f.depthStencilTarget){case 1:case 3:h=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,h);var g=1===f.depthStencilTarget?b.DEPTH_ATTACHMENT:b.DEPTH_STENCIL_ATTACHMENT;b.renderbufferStorage(b.RENDERBUFFER,1===f.depthStencilTarget?b.DEPTH_COMPONENT16:b.DEPTH_STENCIL,f.width,f.height);b.framebufferRenderbuffer(b.FRAMEBUFFER,g,b.RENDERBUFFER,h);this._depthAttachment=h;break;case 2:h=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,h);b.renderbufferStorage(b.RENDERBUFFER,b.STENCIL_INDEX8,
f.width,f.height);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.STENCIL_ATTACHMENT,b.RENDERBUFFER,h);this._stencilAttachment=h;break;case 4:this._depthStencilTexture||(this._context.extensions.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),this._depthStencilTexture=new a(this._context,{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:f.width,height:f.height})),
b.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,this._depthStencilTexture.glName,0)}return b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!"),this._glName=e,this._initialized=!0,!0},f.prototype._disposeColorAttachment=function(){if(this._colorAttachment instanceof a){var b=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var e=this._context.gl;e.framebufferTexture2D(e.FRAMEBUFFER,
e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}b.dispose()}else this._colorAttachment instanceof WebGLRenderbuffer&&(b=this._colorAttachment,e=this._context.gl,this._initialized&&(this._context.bindFramebuffer(this),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(b));this._colorAttachment=null},f.prototype._disposeDepthStencilAttachments=function(){var a=this._context.gl;if(this._depthAttachment){if(this._initialized){this._context.bindFramebuffer(this);
var e=this._context.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,1===this._desc.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,null)}a.deleteRenderbuffer(this._depthAttachment);this._depthAttachment=null}this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),e=this._context.gl,e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,null)),a.deleteRenderbuffer(this._stencilAttachment),this._stencilAttachment=null);this._depthStencilTexture&&
(this._initialized&&(this._context.bindFramebuffer(this),a=this._context.gl,a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)},f._validateTextureDimensions=function(a,e){3553!==a.target&&console.error("Texture type must be TEXTURE_2D!");void 0!==e.width&&0<=e.width&&void 0!==e.height&&0<=e.height?(e.width!==a.width||e.height!==a.height)&&console.error("Color attachment texture must match the framebuffer's!"):
(e.width=a.width,e.height=a.height)},f}();return h._nextId=0,h})},"esri/layers/vectorTiles/views/webgl/webgl-utils":function(){define([],function(){var h=function(a,b){for(var e=["webgl","experimental-webgl","webkit-3d","moz-webgl"],f=null,h=0;h<e.length;++h){try{f=a.getContext(e[h],b)}catch(g){}if(f)break}return f},k=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){return window.setTimeout(a,
1E3/60)}).bind(window),a=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout).bind(window);return{create3DContext:h,setupWebGL:function(a,b){function e(b){var e=a.parentNode;e&&(e.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+
b+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}if(!window.WebGLRenderingContext)return e('This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),[null,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'];var f=h(a,b);return f?[f]:(e('It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'),
[null,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'])},detectWebGL:function(){var a;try{a=window.WebGLRenderingContext}catch(e){a=[!1,0]}var b;try{b=h(document.createElement("canvas"))}catch(e){b=[!1,1]}a?b?(a=b,a=[!0,{VERSION:a.getParameter(a.VERSION),SHADING_LANGUAGE_VERSION:a.getParameter(a.SHADING_LANGUAGE_VERSION),VENDOR:a.getParameter(a.VENDOR),RENDERER:a.getParameter(a.RENDERER),
EXTENSIONS:a.getSupportedExtensions(),MAX_TEXTURE_SIZE:a.getParameter(a.MAX_TEXTURE_SIZE),MAX_RENDERBUFFER_SIZE:a.getParameter(a.MAX_RENDERBUFFER_SIZE),MAX_VERTEX_TEXTURE_IMAGE_UNITS:a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}]):a=[!1,1]:a=[!1,0];return a},requestAnimFrame:k,cancelAnimFrame:a}})},"esri/layers/vectorTiles/views/2d/FrameBudget":function(){define(["require","exports","../../core/now"],function(h,k,a){return function(){function f(a){void 0===a&&(a=Number.MAX_VALUE);this._budget=
this._begin=0;this.enabled=!0;this.reset(a)}return f.now=function(){return a()},Object.defineProperty(f.prototype,"done",{get:function(){return this.enabled&&this.elapsed>=this._budget},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"elapsed",{get:function(){return a()-this._begin},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"remaining",{get:function(){return Math.max(this._budget-this.elapsed,0)},enumerable:!0,configurable:!0}),f.prototype.reset=function(b){void 0===
b&&(b=Number.MAX_VALUE);this._begin=a();this._budget=this.enabled?b:Number.MAX_VALUE},f}()})},"esri/layers/vectorTiles/views/2d/layers/support/TileInfoView":function(){define("require exports ./LODInfo ./TileKey ./TileSpan ./TileCoverage".split(" "),function(h,k,a,f,b,e){var l=function(){function a(a,b,e,f,g,h,k,l){this.x=a;this.ymin=b;this.ymax=e;this.invM=f;this.leftAdjust=g;this.rightAdjust=h;this.leftBound=k;this.rightBound=l}return a.create=function(b,c){b[1]>c[1]&&(d=[c,b],b=d[0],c=d[1]);var d=
b[0],e=b[1],f=c[0],g=c[1],h=f-d,k=g-e,k=0!==k?h/k:0,l=(Math.ceil(e)-e)*k,m=(Math.floor(e)-e)*k;return new a(d,Math.floor(e),Math.ceil(g),k,0>h?l:m,0>h?m:l,0>h?f:d,0>h?d:f);var d},a.prototype.incrRow=function(){this.x+=this.invM},a.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)},a.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)},a}(),m=[[0,0],[0,0],[0,0],[0,0]];return function(){function g(b,c){var d=this;this.scales=
[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var e=b.lods.slice();e.sort(function(a,b){return b.scale-a.scale});var f=this._lodInfos=e.map(function(d){return a.create(b,d,c)});e.forEach(function(a,b){d._infoByLevel[a.level]=f[b];d._infoByScale[a.scale]=f[b];d.scales[b]=a.scale},this);this._wrap=b.spatialReference.isWrappable}return g.prototype.getTileTopLeft=function(a,b){var c=this._infoByLevel[b.level];return c?c.getTileTopLeft(a,b):a},g.prototype.getTileBottomRight=function(a,
b){var c=this._infoByLevel[b.level];return c?c.getTileBottomRight(a,b):a},g.prototype.getTileResolution=function(a){return(a=this._infoByLevel[a.level])?a.resolution:-1},g.prototype.getTileParentId=function(a){a=f.pool.acquire(a);var b=this._lodInfos.indexOf(this._infoByLevel[a.level])-1;if(0>b)return f.pool.release(a),null;b=this.getTileIdAtParent(this._lodInfos[b],a);return f.pool.release(a),b},g.prototype.getTileIdAtParent=function(a,b){var c=f.pool.acquire(b),d=this._infoByLevel[c.level];if(a.resolution<
d.resolution)throw Error("Cannot calculate parent tile. destination LOD's resolution "+a.resolution+" is not a parent resolution of "+d.resolution);return a.resolution===d.resolution?c.id:f.getId(a.level,Math.floor(c.row*d.resolution/a.resolution+.01),Math.floor(c.col*d.resolution/a.resolution+.01),c.world)},g.prototype.getTileCoverage=function(a){var c,d,f,g=this.getClosestInfoForScale(a.scale),h=e.pool.acquire(g),k=this._wrap;c=+(1/0);var u=-(1/0),w=h.spans;m[0][0]=m[0][1]=m[1][1]=m[3][0]=0;m[1][0]=
m[2][0]=a.size[0];m[2][1]=m[3][1]=a.size[1];for(var x=0;x<m.length;x++){var y=m[x];a.toMap(y,y);y[0]=g.getColumnForX(y[0]);y[1]=g.getRowForY(y[1])}a=[];y=3;for(x=0;4>x;x++){if(m[x][1]!==m[y][1]){var A=l.create(m[x],m[y]);c=Math.min(A.ymin,c);u=Math.max(A.ymax,u);void 0===a[A.ymin]&&(a[A.ymin]=[]);a[A.ymin].push(A)}y=x}if(null==c||null==u||100<u-c)return null;for(y=[];u>c;){null!=a[c]&&(y=y.concat(a[c]));d=+(1/0);f=-(1/0);for(x=y.length-1;0<=x;x--)A=y[x],d=Math.min(d,A.getLeftCol()),f=Math.max(f,A.getRightCol());
if(d=Math.floor(d),f=Math.floor(f),c>=g.first[1]&&c<=g.last[1])if(k)if(g.size[0]<g.worldSize[0])for(A=Math.floor(f/g.worldSize[0]),x=Math.floor(d/g.worldSize[0]);A>=x;x++)w.push(new b(c,Math.max(g.getFirstColumnForWorld(x),d),Math.min(g.getLastColumnForWorld(x),f)));else w.push(new b(c,d,f));else d>g.last[0]||f<g.first[0]||(d=Math.max(d,g.first[0]),f=Math.min(f,g.last[0]),w.push(new b(c,d,f)));c+=1;for(x=y.length-1;0<=x;x--)A=y[x],A.ymax>=c?A.incrRow():y.splice(x,1)}return h},g.prototype.intersects=
function(a,b){var c=f.pool.acquire(b),d=this._infoByLevel[c.level],e=a.lodInfo;if(e.resolution>d.resolution){var g=f.pool.acquire(this.getTileIdAtParent(e,c)),h=e.denormalizeCol(g.col,g.world),k=a.spans.some(function(a){return a.row===g.row&&a.colFrom<=h&&a.colTo>=h});return f.pool.release(c),f.pool.release(g),k}if(e.resolution<d.resolution){var l=a.spans.reduce(function(a,b){return a[0]=Math.min(a[0],b.row),a[1]=Math.max(a[1],b.row),a[2]=Math.min(a[2],b.colFrom),a[3]=Math.max(a[3],b.colTo),a},[+(1/
0),-(1/0),+(1/0),-(1/0)]),k=l[0],m=l[1],y=l[2],l=l[3],A=d.denormalizeCol(c.col,c.world),z=e.getColumnForX(d.getXForColumn(A)),B=e.getRowForY(d.getYForRow(c.row)),A=e.getColumnForX(d.getXForColumn(A+1))-1,d=e.getRowForY(d.getYForRow(c.row+1))-1;return f.pool.release(c),!(z>l||y>A||B>m||k>d)}var C=e.denormalizeCol(c.col,c.world),k=a.spans.some(function(a){return a.row===c.row&&a.colFrom<=C&&a.colTo>=C});return f.pool.release(c),k},g.prototype.getClosestInfoForScale=function(a){var b=this.scales;return this._infoByScale[a]?
this._infoByScale[a]:(a=b.reduce(function(b,c,d,e){return Math.abs(c-a)<Math.abs(b-a)?c:b},b[0]),this._infoByScale[a])},g}()})},"esri/layers/vectorTiles/views/2d/layers/support/LODInfo":function(){define(["require","exports","./TileKey","../../../../geometry/support/spatialReferenceUtils"],function(h,k,a,f){function b(a,b,f){return a[0]=b,a[1]=f,a}return function(){function e(a,b,e,d,c,f,h,k,r,v,u){this.level=a;this.resolution=b;this.origin=e;this.first=d;this.last=c;this.size=f;this.norm=h;this.worldStart=
k;this.worldEnd=r;this.worldSize=v;this.wrap=u}return e.create=function(a,h,g){var d=f.getInfo(a.spatialReference),c=[a.origin.x,a.origin.y],k=[a.size[0]*h.resolution,a.size[1]*h.resolution],l=[-(1/0),-(1/0)],m=[+(1/0),+(1/0)],r=[+(1/0),+(1/0)];g&&(b(l,Math.max(0,Math.floor((g.xmin-c[0])/k[0])),Math.max(0,Math.floor((c[1]-g.ymax)/k[1]))),b(m,Math.max(0,Math.floor((g.xmax-c[0])/k[0])),Math.max(0,Math.floor((c[1]-g.ymin)/k[1]))),b(r,m[0]-l[0]+1,m[1]-l[1]+1));var v,u,w,x;return d?(v=[Math.ceil(Math.round(2*
d.origin[1]/h.resolution)/a.size[0]),r[1]],u=[Math.floor((d.origin[0]-c[0])/k[0]),l[1]],w=[v[0]-u[0]-1,m[1]],x=!0):(u=l,w=m,v=r,x=!1),new e(h.level,h.resolution,c,l,m,r,k,u,w,v,x)},e.prototype.normalizeCol=function(a){if(!this.wrap)return a;var b=this.worldSize[0];return 0>a?b-1-Math.abs((a+1)%b):a%b},e.prototype.denormalizeCol=function(a,b){return this.wrap?this.worldSize[0]*b+a:a},e.prototype.getWorldForColumn=function(a){return this.wrap?Math.floor(a/this.worldSize[0]):0},e.prototype.getFirstColumnForWorld=
function(a){return a*this.worldSize[0]+this.first[0]},e.prototype.getLastColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]+this.size[0]-1},e.prototype.getColumnForX=function(a){return(a-this.origin[0])/this.norm[0]},e.prototype.getXForColumn=function(a){return this.origin[0]+a*this.norm[0]},e.prototype.getRowForY=function(a){return(this.origin[1]-a)/this.norm[1]},e.prototype.getYForRow=function(a){return this.origin[1]-a*this.norm[1]},e.prototype.getTileTopLeft=function(e,f){var g=
a.pool.acquire(f);return b(e,this.getXForColumn(this.denormalizeCol(g.col,g.world)),this.getYForRow(g.row)),a.pool.release(g),e},e.prototype.getTileBottomRight=function(e,f){var g=a.pool.acquire(f);return b(e,this.getXForColumn(this.denormalizeCol(g.col,g.world)+1),this.getYForRow(g.row+1)),a.pool.release(g),e},e}()})},"esri/layers/vectorTiles/geometry/support/spatialReferenceUtils":function(){define(["require","exports","./WKIDUnitConversion"],function(h,k,a){k.isGeographic=function(b){return b.wkid?
null==a[b.wkid]:b.wkt?/^\s*GEOGCS/i.test(b.wkt):!1};k.getInfo=function(a){return a.wkid?f[a.wkid]:null};h=[-2.0037508342788905E7,2.0037508342788905E7];k=[-2.0037508342787E7,2.0037508342787E7];var f={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:h,origin:k,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:h,origin:k,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:h,origin:k,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:h,origin:k,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}}})},"esri/layers/vectorTiles/geometry/support/WKIDUnitConversion":function(){define([],function(){var h,k={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5E4,15E4],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,
2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,
3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,
3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,
3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,
5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,
6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,
6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,
6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,
6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,
7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,
7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,
26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53034:0,
53048:0,53049:0,54034:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,
103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,
103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,
103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,
103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103695:2};for(h=2E3;2045>=h;h++)k[h]=0;for(h=2056;2065>=h;h++)k[h]=0;for(h=2067;2135>=h;h++)k[h]=0;for(h=2137;2154>=h;h++)k[h]=0;for(h=2161;2170>=h;h++)k[h]=0;for(h=2172;2193>=h;h++)k[h]=0;for(h=2195;2198>=h;h++)k[h]=0;for(h=2200;2203>=h;h++)k[h]=0;for(h=2205;2217>=h;h++)k[h]=0;for(h=2222;2224>=h;h++)k[h]=1;for(h=2225;2250>=h;h++)k[h]=
2;for(h=2251;2253>=h;h++)k[h]=1;for(h=2257;2264>=h;h++)k[h]=2;for(h=2274;2279>=h;h++)k[h]=2;for(h=2280;2282>=h;h++)k[h]=1;for(h=2283;2289>=h;h++)k[h]=2;for(h=2290;2292>=h;h++)k[h]=0;for(h=2308;2313>=h;h++)k[h]=0;for(h=2315;2491>=h;h++)k[h]=0;for(h=2494;2866>=h;h++)k[h]=0;for(h=2867;2869>=h;h++)k[h]=1;for(h=2870;2888>=h;h++)k[h]=2;for(h=2891;2895>=h;h++)k[h]=2;for(h=2896;2898>=h;h++)k[h]=1;for(h=2902;2908>=h;h++)k[h]=2;for(h=2915;2920>=h;h++)k[h]=2;for(h=2921;2923>=h;h++)k[h]=1;for(h=2924;2930>=h;h++)k[h]=
2;for(h=2931;2962>=h;h++)k[h]=0;for(h=2964;2968>=h;h++)k[h]=2;for(h=2969;2973>=h;h++)k[h]=0;for(h=2975;2991>=h;h++)k[h]=0;for(h=2995;3051>=h;h++)k[h]=0;for(h=3054;3079>=h;h++)k[h]=0;for(h=3081;3088>=h;h++)k[h]=0;for(h=3092;3101>=h;h++)k[h]=0;for(h=3106;3138>=h;h++)k[h]=0;for(h=3146;3151>=h;h++)k[h]=0;for(h=3153;3166>=h;h++)k[h]=0;for(h=3168;3172>=h;h++)k[h]=0;for(h=3174;3203>=h;h++)k[h]=0;for(h=3294;3358>=h;h++)k[h]=0;for(h=3367;3403>=h;h++)k[h]=0;for(h=3408;3416>=h;h++)k[h]=0;for(h=3417;3438>=h;h++)k[h]=
2;for(h=3441;3446>=h;h++)k[h]=2;for(h=3447;3450>=h;h++)k[h]=0;for(h=3451;3459>=h;h++)k[h]=2;for(h=3460;3478>=h;h++)k[h]=0;for(h=3554;3559>=h;h++)k[h]=0;for(h=3560;3570>=h;h++)k[h]=2;for(h=3571;3581>=h;h++)k[h]=0;for(h=3594;3597>=h;h++)k[h]=0;for(h=3601;3604>=h;h++)k[h]=0;for(h=3637;3639>=h;h++)k[h]=0;for(h=3665;3667>=h;h++)k[h]=0;for(h=3693;3695>=h;h++)k[h]=0;for(h=3701;3727>=h;h++)k[h]=0;for(h=3728;3739>=h;h++)k[h]=2;for(h=3740;3751>=h;h++)k[h]=0;for(h=3753;3760>=h;h++)k[h]=2;for(h=3761;3773>=h;h++)k[h]=
0;for(h=3775;3777>=h;h++)k[h]=0;for(h=3779;3781>=h;h++)k[h]=0;for(h=3783;3785>=h;h++)k[h]=0;for(h=3788;3791>=h;h++)k[h]=0;for(h=3797;3802>=h;h++)k[h]=0;for(h=3814;3816>=h;h++)k[h]=0;for(h=3825;3829>=h;h++)k[h]=0;for(h=3832;3841>=h;h++)k[h]=0;for(h=3844;3852>=h;h++)k[h]=0;for(h=3873;3885>=h;h++)k[h]=0;for(h=3890;3893>=h;h++)k[h]=0;for(h=3907;3912>=h;h++)k[h]=0;for(h=3942;3950>=h;h++)k[h]=0;for(h=3968;3970>=h;h++)k[h]=0;for(h=3973;3976>=h;h++)k[h]=0;for(h=3986;3989>=h;h++)k[h]=0;for(h=3994;3997>=h;h++)k[h]=
0;for(h=4048;4051>=h;h++)k[h]=0;for(h=4056;4063>=h;h++)k[h]=0;for(h=4093;4096>=h;h++)k[h]=0;for(h=4390;4398>=h;h++)k[h]=0;for(h=4399;4413>=h;h++)k[h]=2;for(h=4418;4433>=h;h++)k[h]=2;for(h=4455;4457>=h;h++)k[h]=2;for(h=4484;4489>=h;h++)k[h]=0;for(h=4491;4554>=h;h++)k[h]=0;for(h=4568;4589>=h;h++)k[h]=0;for(h=4652;4656>=h;h++)k[h]=0;for(h=4766;4800>=h;h++)k[h]=0;for(h=5014;5016>=h;h++)k[h]=0;for(h=5069;5072>=h;h++)k[h]=0;for(h=5105;5130>=h;h++)k[h]=0;for(h=5173;5188>=h;h++)k[h]=0;for(h=5253;5259>=h;h++)k[h]=
0;for(h=5269;5275>=h;h++)k[h]=0;for(h=5292;5311>=h;h++)k[h]=0;for(h=5329;5331>=h;h++)k[h]=0;for(h=5343;5349>=h;h++)k[h]=0;for(h=5355;5357>=h;h++)k[h]=0;for(h=5387;5389>=h;h++)k[h]=0;for(h=5459;5463>=h;h++)k[h]=0;for(h=5479;5482>=h;h++)k[h]=0;for(h=5518;5520>=h;h++)k[h]=0;for(h=5530;5539>=h;h++)k[h]=0;for(h=5550;5552>=h;h++)k[h]=0;for(h=5562;5583>=h;h++)k[h]=0;for(h=5623;5625>=h;h++)k[h]=2;for(h=5631;5639>=h;h++)k[h]=0;for(h=5649;5653>=h;h++)k[h]=0;for(h=5663;5680>=h;h++)k[h]=0;for(h=5682;5685>=h;h++)k[h]=
0;for(h=5875;5877>=h;h++)k[h]=0;for(h=5921;5940>=h;h++)k[h]=0;for(h=6050;6125>=h;h++)k[h]=0;for(h=6244;6275>=h;h++)k[h]=0;for(h=6328;6348>=h;h++)k[h]=0;for(h=6350;6356>=h;h++)k[h]=0;for(h=6366;6372>=h;h++)k[h]=0;for(h=6381;6387>=h;h++)k[h]=0;for(h=6393;6404>=h;h++)k[h]=0;for(h=6480;6483>=h;h++)k[h]=0;for(h=6511;6514>=h;h++)k[h]=0;for(h=6579;6581>=h;h++)k[h]=0;for(h=6619;6624>=h;h++)k[h]=0;for(h=6625;6627>=h;h++)k[h]=2;for(h=6628;6632>=h;h++)k[h]=0;for(h=6634;6637>=h;h++)k[h]=0;for(h=6669;6692>=h;h++)k[h]=
0;for(h=6707;6709>=h;h++)k[h]=0;for(h=6720;6723>=h;h++)k[h]=0;for(h=6732;6738>=h;h++)k[h]=0;for(h=6931;6933>=h;h++)k[h]=0;for(h=6956;6959>=h;h++)k[h]=0;for(h=7005;7007>=h;h++)k[h]=0;for(h=7057;7070>=h;h++)k[h]=2;for(h=7074;7082>=h;h++)k[h]=0;for(h=7109;7118>=h;h++)k[h]=0;for(h=7119;7127>=h;h++)k[h]=1;for(h=7374;7376>=h;h++)k[h]=0;for(h=7528;7586>=h;h++)k[h]=0;for(h=7587;7645>=h;h++)k[h]=2;for(h=7845;7859>=h;h++)k[h]=0;for(h=20002;20032>=h;h++)k[h]=0;for(h=20062;20092>=h;h++)k[h]=0;for(h=20135;20138>=
h;h++)k[h]=0;for(h=20248;20258>=h;h++)k[h]=0;for(h=20348;20358>=h;h++)k[h]=0;for(h=20436;20440>=h;h++)k[h]=0;for(h=20822;20824>=h;h++)k[h]=0;for(h=20934;20936>=h;h++)k[h]=0;for(h=21035;21037>=h;h++)k[h]=0;for(h=21095;21097>=h;h++)k[h]=0;for(h=21148;21150>=h;h++)k[h]=0;for(h=21413;21423>=h;h++)k[h]=0;for(h=21473;21483>=h;h++)k[h]=0;for(h=21780;21782>=h;h++)k[h]=0;for(h=21891;21894>=h;h++)k[h]=0;for(h=21896;21899>=h;h++)k[h]=0;for(h=22171;22177>=h;h++)k[h]=0;for(h=22181;22187>=h;h++)k[h]=0;for(h=22191;22197>=
h;h++)k[h]=0;for(h=22234;22236>=h;h++)k[h]=0;for(h=22521;22525>=h;h++)k[h]=0;for(h=22991;22994>=h;h++)k[h]=0;for(h=23028;23038>=h;h++)k[h]=0;for(h=23830;23853>=h;h++)k[h]=0;for(h=23866;23872>=h;h++)k[h]=0;for(h=23877;23884>=h;h++)k[h]=0;for(h=23886;23894>=h;h++)k[h]=0;for(h=23946;23948>=h;h++)k[h]=0;for(h=24311;24313>=h;h++)k[h]=0;for(h=24342;24347>=h;h++)k[h]=0;for(h=24370;24374>=h;h++)k[h]=10;for(h=24375;24381>=h;h++)k[h]=0;for(h=24718;24721>=h;h++)k[h]=0;for(h=24817;24821>=h;h++)k[h]=0;for(h=24877;24882>=
h;h++)k[h]=0;for(h=24891;24893>=h;h++)k[h]=0;for(h=25391;25395>=h;h++)k[h]=0;for(h=25828;25838>=h;h++)k[h]=0;for(h=26191;26195>=h;h++)k[h]=0;for(h=26391;26393>=h;h++)k[h]=0;for(h=26701;26722>=h;h++)k[h]=0;for(h=26729;26799>=h;h++)k[h]=2;for(h=26801;26803>=h;h++)k[h]=2;for(h=26811;26813>=h;h++)k[h]=2;for(h=26847;26870>=h;h++)k[h]=2;for(h=26891;26899>=h;h++)k[h]=0;for(h=26901;26923>=h;h++)k[h]=0;for(h=26929;26946>=h;h++)k[h]=0;for(h=26948;26998>=h;h++)k[h]=0;for(h=27037;27040>=h;h++)k[h]=0;for(h=27205;27232>=
h;h++)k[h]=0;for(h=27258;27260>=h;h++)k[h]=0;for(h=27391;27398>=h;h++)k[h]=0;for(h=27561;27564>=h;h++)k[h]=0;for(h=27571;27574>=h;h++)k[h]=0;for(h=27581;27584>=h;h++)k[h]=0;for(h=27591;27594>=h;h++)k[h]=0;for(h=28191;28193>=h;h++)k[h]=0;for(h=28348;28358>=h;h++)k[h]=0;for(h=28402;28432>=h;h++)k[h]=0;for(h=28462;28492>=h;h++)k[h]=0;for(h=29118;29122>=h;h++)k[h]=0;for(h=29168;29172>=h;h++)k[h]=0;for(h=29177;29185>=h;h++)k[h]=0;for(h=29187;29195>=h;h++)k[h]=0;for(h=29900;29903>=h;h++)k[h]=0;for(h=30161;30179>=
h;h++)k[h]=0;for(h=30491;30494>=h;h++)k[h]=0;for(h=30729;30732>=h;h++)k[h]=0;for(h=31251;31259>=h;h++)k[h]=0;for(h=31265;31268>=h;h++)k[h]=0;for(h=31275;31279>=h;h++)k[h]=0;for(h=31281;31297>=h;h++)k[h]=0;for(h=31461;31469>=h;h++)k[h]=0;for(h=31491;31495>=h;h++)k[h]=0;for(h=31917;31922>=h;h++)k[h]=0;for(h=31965;32E3>=h;h++)k[h]=0;for(h=32001;32003>=h;h++)k[h]=2;for(h=32005;32031>=h;h++)k[h]=2;for(h=32033;32060>=h;h++)k[h]=2;for(h=32064;32067>=h;h++)k[h]=2;for(h=32074;32077>=h;h++)k[h]=2;for(h=32081;32086>=
h;h++)k[h]=0;for(h=32107;32130>=h;h++)k[h]=0;for(h=32133;32158>=h;h++)k[h]=0;for(h=32164;32167>=h;h++)k[h]=2;for(h=32180;32199>=h;h++)k[h]=0;for(h=32201;32260>=h;h++)k[h]=0;for(h=32301;32360>=h;h++)k[h]=0;for(h=32601;32662>=h;h++)k[h]=0;for(h=32664;32667>=h;h++)k[h]=2;for(h=32701;32761>=h;h++)k[h]=0;for(h=53001;53004>=h;h++)k[h]=0;for(h=53008;53019>=h;h++)k[h]=0;for(h=53021;53032>=h;h++)k[h]=0;for(h=53042;53046>=h;h++)k[h]=0;for(h=53074;53080>=h;h++)k[h]=0;for(h=54001;54004>=h;h++)k[h]=0;for(h=54008;54019>=
h;h++)k[h]=0;for(h=54021;54032>=h;h++)k[h]=0;for(h=54042;54046>=h;h++)k[h]=0;for(h=54048;54053>=h;h++)k[h]=0;for(h=54074;54080>=h;h++)k[h]=0;for(h=102001;102040>=h;h++)k[h]=0;for(h=102042;102063>=h;h++)k[h]=0;for(h=102065;102067>=h;h++)k[h]=0;for(h=102070;102117>=h;h++)k[h]=0;for(h=102122;102216>=h;h++)k[h]=0;for(h=102221;102377>=h;h++)k[h]=0;for(h=102382;102388>=h;h++)k[h]=0;for(h=102389;102398>=h;h++)k[h]=2;for(h=102399;102444>=h;h++)k[h]=0;for(h=102445;102447>=h;h++)k[h]=2;for(h=102448;102458>=
h;h++)k[h]=0;for(h=102459;102468>=h;h++)k[h]=2;for(h=102469;102496>=h;h++)k[h]=0;for(h=102500;102519>=h;h++)k[h]=1;for(h=102520;102524>=h;h++)k[h]=0;for(h=102525;102529>=h;h++)k[h]=2;for(h=102530;102561>=h;h++)k[h]=0;for(h=102570;102588>=h;h++)k[h]=0;for(h=102590;102598>=h;h++)k[h]=0;for(h=102601;102603>=h;h++)k[h]=0;for(h=102605;102628>=h;h++)k[h]=0;for(h=102629;102646>=h;h++)k[h]=2;for(h=102648;102700>=h;h++)k[h]=2;for(h=102701;102703>=h;h++)k[h]=0;for(h=102707;102730>=h;h++)k[h]=2;for(h=102733;102758>=
h;h++)k[h]=2;for(h=102767;102798>=h;h++)k[h]=0;for(h=102965;102969>=h;h++)k[h]=0;for(h=102971;102973>=h;h++)k[h]=0;for(h=102975;102989>=h;h++)k[h]=0;for(h=102990;102992>=h;h++)k[h]=1;for(h=102997;103002>=h;h++)k[h]=0;for(h=103003;103008>=h;h++)k[h]=2;for(h=103009;103011>=h;h++)k[h]=0;for(h=103012;103014>=h;h++)k[h]=2;for(h=103019;103021>=h;h++)k[h]=0;for(h=103022;103024>=h;h++)k[h]=2;for(h=103029;103031>=h;h++)k[h]=0;for(h=103032;103034>=h;h++)k[h]=2;for(h=103065;103068>=h;h++)k[h]=0;for(h=103074;103076>=
h;h++)k[h]=0;for(h=103077;103079>=h;h++)k[h]=1;for(h=103080;103082>=h;h++)k[h]=0;for(h=103083;103085>=h;h++)k[h]=2;for(h=103090;103093>=h;h++)k[h]=0;for(h=103097;103099>=h;h++)k[h]=0;for(h=103100;103102>=h;h++)k[h]=2;for(h=103107;103109>=h;h++)k[h]=0;for(h=103110;103112>=h;h++)k[h]=2;for(h=103113;103116>=h;h++)k[h]=0;for(h=103117;103120>=h;h++)k[h]=2;for(h=103153;103157>=h;h++)k[h]=0;for(h=103158;103162>=h;h++)k[h]=2;for(h=103163;103165>=h;h++)k[h]=0;for(h=103166;103168>=h;h++)k[h]=1;for(h=103169;103171>=
h;h++)k[h]=2;for(h=103186;103188>=h;h++)k[h]=0;for(h=103189;103191>=h;h++)k[h]=2;for(h=103192;103195>=h;h++)k[h]=0;for(h=103196;103199>=h;h++)k[h]=2;for(h=103200;103224>=h;h++)k[h]=0;for(h=103225;103227>=h;h++)k[h]=1;for(h=103232;103237>=h;h++)k[h]=0;for(h=103238;103243>=h;h++)k[h]=2;for(h=103244;103246>=h;h++)k[h]=0;for(h=103247;103249>=h;h++)k[h]=2;for(h=103254;103256>=h;h++)k[h]=0;for(h=103257;103259>=h;h++)k[h]=2;for(h=103264;103266>=h;h++)k[h]=0;for(h=103267;103269>=h;h++)k[h]=2;for(h=103300;103375>=
h;h++)k[h]=0;for(h=103381;103383>=h;h++)k[h]=0;for(h=103384;103386>=h;h++)k[h]=1;for(h=103387;103389>=h;h++)k[h]=0;for(h=103390;103392>=h;h++)k[h]=2;for(h=103397;103399>=h;h++)k[h]=0;for(h=103400;103471>=h;h++)k[h]=2;for(h=103476;103478>=h;h++)k[h]=0;for(h=103479;103481>=h;h++)k[h]=2;for(h=103486;103488>=h;h++)k[h]=0;for(h=103489;103491>=h;h++)k[h]=2;for(h=103492;103495>=h;h++)k[h]=0;for(h=103496;103499>=h;h++)k[h]=2;for(h=103528;103543>=h;h++)k[h]=0;for(h=103544;103548>=h;h++)k[h]=2;for(h=103549;103551>=
h;h++)k[h]=0;for(h=103552;103554>=h;h++)k[h]=1;for(h=103555;103557>=h;h++)k[h]=2;for(h=103558;103560>=h;h++)k[h]=0;for(h=103571;103573>=h;h++)k[h]=0;for(h=103574;103576>=h;h++)k[h]=2;for(h=103577;103580>=h;h++)k[h]=0;for(h=103581;103583>=h;h++)k[h]=2;for(h=103600;103694>=h;h++)k[h]=0;for(h=103700;103793>=h;h++)k[h]=2;for(h=103794;103871>=h;h++)k[h]=0;for(h=103900;103971>=h;h++)k[h]=2;return k})},"esri/layers/vectorTiles/views/2d/layers/support/TileSpan":function(){define(["require","exports","../../../../core/ObjectPool"],
function(h,k,a){h=function(){return function(a,b,e){this.row=a;this.colFrom=b;this.colTo=e}}();return h.pool=new a(h,!0),h})},"esri/layers/vectorTiles/views/2d/layers/support/TileCoverage":function(){define(["require","exports","../../../../core/ObjectPool","../../../../core/ArrayPool","./TileSpan"],function(h,k,a,f,b){h=function(){function a(a){this.lodInfo=a;this.spans=f.acquire()}return a.prototype.release=function(){for(var a=0,e=this.spans;a<e.length;a++)b.pool.release(e[a]);f.release(this.spans)},
a}();return h.pool=new a(h,!0),h})},"esri/layers/vectorTiles/core/ArrayPool":function(){define(["require","exports","./ObjectPool"],function(h,k,a){var f=Array.prototype.splice;h=function(){function e(b,e){void 0===b&&(b=50);void 0===e&&(e=50);this._pool=new a(Array,!1,function(a){return a.length=0},e,b)}return e.prototype.acquire=function(){return this._pool.acquire()},e.prototype.copy=function(a){var b=this.acquire();return a.unshift(0,0),f.apply(b,a),a.splice(0,2),b},e.prototype.release=function(a){this._pool.release(a)},
e.acquire=function(){return b.acquire()},e.copy=function(a){return b.copy(a)},e.release=function(a){return b.release(a)},e}();var b=new h(100);return h})},"esri/layers/vectorTiles/views/2d/layers/support/TileStrategy":function(){define(["require","exports","../../../../core/LRUCache","./TileKey"],function(h,k,a,f){function b(a,b){a["delete"](b)}var e=[],l=[],m=[null,null],g=[],d=new a(30),c=new f(0,0,0,0);return function(){function a(a){this._tiles=new Map;this._tilesToRender=new Map;this._requests=
new Map;this._updates=new Map;this._prevResolution=Number.POSITIVE_INFINITY;this._isStationary=!1;this.tileFilter=null;this.container=a.container;this.tileInfoView=a.tileInfoView;this.requestUpdate=a.requestUpdate;this.fetchTile=a.fetchTile;this.tileFilter=a.tileFilter}return a.prototype.destroy=function(){this._requests&&(this._requests.forEach(function(a){a.isFulfilled()||a.cancel()}),this._requests=null,this._tilesToRender=null)},Object.defineProperty(a.prototype,"updating",{get:function(){return 0!==
this._requests.size||0!==this._updates.size},enumerable:!0,configurable:!0}),a.prototype.update=function(a){var f=this,h=this._tiles,k=this._tilesToRender,l=this._requests,m=this._updates,n=this.tileInfoView.getTileCoverage(a.state);if(n){var q=n.lodInfo.level,A=a.state.resolution>this._prevResolution;this._createCoverageList(e,n);var z=this.tileFilter?this.tileFilter([],e):e;k.clear();for(var B=0,C=0;C<z.length;C++){var D=z[C];if(h.has(D)){var E=h.get(D);if(k.set(D,E),B++,E.attached)continue}else d.has(D)?
B++:l.has(D)||this._getTile(D,a);A||this._addParentTile(D,k)}var F=B===z.length;!this._isStationary&&a.stationary&&this.requestUpdate();this._isStationary=a.stationary;var G=[],I=[];h.forEach(function(a,b){c.set(b);k.has(b)||(!A&&F||!f.tileInfoView.intersects(n,c)?(c.level>q||!f.tileInfoView.intersects(n,c))&&G.push(b):I.push(b))});for(E=0;E<I.length;E++)D=I[E],k.set(D,h.get(D));for(a=0;a<G.length;a++)D=G[a],m.has(D)&&(m.get(D).cancel(D),b(m,D)),E=h.get(D),E.dispose(),b(h,D);this.container.removeAllTiles();
k.forEach(function(a){return f.container.addTile(a)});l.forEach(function(a,b){c.set(b);(c.level>q||!f.tileInfoView.intersects(n,c))&&(a.cancel(),g.push(b))});for(h=0;h<g.length;h++)D=g[h],b(l,D);g.length=0}},a.prototype.updateTiles=function(a,c){var d=this;this._tilesToRender.forEach(function(e,f){if(e.attached){var g=a(e,c);g&&(d._updates.has(f)&&(d._updates.get(f).cancel(),b(d._updates,f)),g.then(function(a){b(d._updates,f);d._tilesToRender.has(f)&&d._tilesToRender.set(f,a);d.requestUpdate()}).otherwise(function(a){if(b(d._updates,
f),d.requestUpdate(),a&&"cancel"!==a.dojoType)throw a;}),d._updates.set(f,g))}})},a.prototype._addParentTile=function(a,b){this._getAvailableParentTile(m,a);m[0]&&!b.has(m[0])&&b.set(m[0],m[1])},a.prototype._getTile=function(a,e){var f=this,g=this.fetchTile(a,e).then(function(d){c.set(a);f.tileInfoView.getTileTopLeft(d.topLeft,c);f.tileInfoView.getTileBottomRight(d.bottomRight,c);d.resolution=f.tileInfoView.getTileResolution(c);f._tiles.set(a,d);b(f._requests,a);f.requestUpdate()}).otherwise(function(c){c&&
"no data"===c.message&&d.insert(a,a);b(f._requests,a)});this._requests.set(a,g)},a.prototype._getAvailableParentTile=function(a,b){a[0]=null;a[1]=null;for(var c=b;c=this.tileInfoView.getTileParentId(c);)if(this._tiles.has(c)){a[0]=c;a[1]=this._tiles.get(c);break}return a},a.prototype._createCoverageList=function(a,b){a.length=0;l.length=0;var d=b.spans;if(0!==d.length){for(var e=0,f=0,g=1/0,h=-(1/0),e=d[0].row,f=d[d.length-1].row,k=0;k<d.length;k++)for(var m=d[k],n=m.colFrom,q=m.colTo;q>=n;n++)g=
Math.min(g,n),h=Math.max(h,n);k=b.lodInfo;m=k.level;f=e+Math.floor(.5*(f-e));g+=Math.floor(.5*(h-g));n=f-e;0<=n&&n<d.length&&(c.set(m,f,k.normalizeCol(g),k.getWorldForColumn(g)),l.push({dist:0,id:c.id}));for(var t,e=0;e<d.length;e++)for(q=d[e],h=q.row,n=q.colFrom,q=q.colTo;q>=n;n++)t=Math.abs(n-g)+Math.abs(h-f),0!==t&&(c.set(m,h,k.normalizeCol(n),k.getWorldForColumn(n)),l.push({dist:t,id:c.id}));l.sort(function(a,b){return a.dist-b.dist});for(d=0;d<l.length;d++)a.push(l[d].id)}},a}()})},"esri/layers/vectorTiles/core/LRUCache":function(){define(["require",
"exports"],function(h,k){return function(){function a(a){if(this._cache={},this._lruQueue=[],0>=a)throw Error("LRU cache size must be bigger than zero!");this._maxSize=a}return a.prototype.has=function(a){return void 0!==this._cache[a]},a.prototype.insert=function(a,b){return null!==this.use(a)?void(this._cache[a]=b):(this._collect(),this._cache[a]=b,void this._lruQueue.unshift(a))},a.prototype.use=function(a){var b=this._cache[a];return b?(this._lruQueue.splice(this._lruQueue.indexOf(a),1),this._lruQueue.unshift(a),
b):null},a.prototype.print=function(){for(var a=0,b=this._lruQueue;a<b.length;a++);},a.prototype._collect=function(){if(!(this._lruQueue.length<this._maxSize)){var a=this._lruQueue.pop(),b=this._cache[a];b&&b.release&&b.release();delete this._cache[a]}},a}()})},"dgrid/util/touch":function(){define(["dojo/on","dojo/query"],function(h,k){function a(a,e,k,m){if(!(1<k.targetTouches.length)){var b=k.changedTouches[0],d=b.screenX,c=b.screenY;m&&k.preventDefault();var l=h(a,"touchend",function(a){var b=
a.changedTouches[0];a.targetTouches.length||(Math.abs(b.screenX-d)<f.tapRadius&&Math.abs(b.screenY-c)<f.tapRadius&&(m&&a.preventDefault(),e.call(this,a)),l.remove())})}}var f={tapRadius:10,dbltapTime:250,selector:function(a,e,f){return function(b,g){var d=e.bubble;d?e=d:!1!==f&&(f=!0);return h(b,e,function(c){var d=c.target;3==d.nodeType&&(d=d.parentNode);for(;!k.matches(d,a,b);)if(d==b||!f||!(d=d.parentNode))return;return g.call(d,c)})}},countCurrentTouches:function(a,e){if(!("touches"in a))return-1;
var b,f,g;for(f=b=0;g=a.touches[b];++b)e.contains(g.target)&&++f;return f},tap:function(b,e){return h(b,"touchstart",function(f){a(b,e,f)})},dbltap:function(b,e){var k,m;return h(b,"touchstart",function(g){k?a(b,function(a){if(k){var b=a.changedTouches[0];Math.abs(b.screenX-k.screenX)<f.tapRadius&&Math.abs(b.screenY-k.screenY)<f.tapRadius&&(m&&clearTimeout(m),k=m=null,e.call(this,a))}},g,!0):a(b,function(a){k=a.changedTouches[0];m=setTimeout(function(){k=m=null},f.dbltapTime)},g)})}};return f})},
"dgrid/TouchScroll":function(){define("dojo/_base/declare dojo/on ./util/touch ./util/has-css3 put-selector/put xstyle/css!./css/TouchScroll.css".split(" "),function(h,k,a,f,b){function e(a,b,c,d){var e=a.touchNode,f=t[a.id],g,h;"object"!==typeof b?(h=b,g=c,b=d,d=c=!0):(d="x"in b,c="y"in b,d&&c||(g=a.getScrollPosition()),h=d?b.x:g.x,g=c?b.y:g.y);e.style[B]=C+-h+"px,"+-g+"px"+D;f&&d&&a._scrollbarXNode&&(a._scrollbarXNode.style[B]=C+h*f.parentWidth/f.scrollWidth+"px,0"+D);f&&c&&a._scrollbarYNode&&(a._scrollbarYNode.style[B]=
C+"0,"+g*f.parentHeight/f.scrollHeight+"px"+D);k.emit(a.touchNode.parentNode,"scroll",{scrollLeft:h,scrollTop:g})}function l(a){return t[a.id]?u.exec(window.getComputedStyle(a.touchNode)[B]):v.exec(a.touchNode.style[B])}function m(a){var c=this.widget,c=[this.node,c._scrollbarXNode,c._scrollbarYNode],d=c.length;this.timer&&(clearTimeout(this.timer),this.timer=null);for(this.transitionHandler&&this.transitionHandler.remove();d--;)c[d]&&(c[d].style[z+"Duration"]="0");a&&a.preserveScrollbars||b(this.node.parentNode,
".touchscroll-fadeout");delete this.resetEffects}function g(b){var c=b.widget,d=c.touchNode,e=c.id,f=0,g=0,h;if(a.countCurrentTouches(b,d)===c.touchesToScroll){if(h=l(c))f=+h[1],g=+h[2];if(h=t[e])h.resetEffects&&h.resetEffects({preserveScrollbars:!0}),d.style[B]=C+f+"px,"+g+"px"+D,r[e]=h;b=b.targetTouches[0];h=t[e]={widget:c,node:d,startX:f-b.pageX,startY:g-b.pageY,lastX:f,lastY:g,pageX:b.pageX,pageY:b.pageY,tickFunc:function(){var a=t[e],b,c;a&&((b=v.exec(a.node.style[B]))?(c=+b[1],b=+b[2],a.velX=
c-a.lastX,a.velY=b-a.lastY,a.lastX=c,a.lastY=b):a.lastX=a.lastY=0,a.timer=setTimeout(a.tickFunc,50))}};h.timer=setTimeout(h.tickFunc,50)}}function d(c){var d=c.widget,f=d.id,g=d.touchesToScroll,h=t[f],k,l;if(h&&(k=a.countCurrentTouches(c,d.touchNode))===g){k=c.targetTouches;g=k[0];if(!h.scrollbarsShown&&(r[f]||Math.abs(g.pageX-h.pageX)>d.scrollThreshold||Math.abs(g.pageY-h.pageY)>d.scrollThreshold)){var f=d.touchNode,m=f.parentNode,n=m.offsetWidth-8,q=m.offsetHeight-8,u=h.scrollWidth=f.scrollWidth,
v=h.scrollHeight=f.scrollHeight,w=h.parentWidth=m.offsetWidth,x=h.parentHeight=m.offsetHeight;u>w?(d._scrollbarXNode||(l=b(m,"div.touchscroll-x")),l=d._scrollbarXNode=d._scrollbarXNode||b(l,"div.touchscroll-bar"),l.style.width=n*n/u+"px",l.style.left=f.offsetLeft+"px",b(m,".touchscroll-scrollable-x"),h.scrollableX=!0):b(m,"!touchscroll-scrollable-x");v>x?(d._scrollbarYNode||(l=b(m,"div.touchscroll-y")),l=d._scrollbarYNode=d._scrollbarYNode||b(l,"div.touchscroll-bar"),l.style.height=q*q/v+"px",l.style.top=
f.offsetTop+"px",b(m,".touchscroll-scrollable-y"),h.scrollableY=!0):b(m,"!touchscroll-scrollable-y");b(m,"!touchscroll-fadeout");h.scrollbarsShown=!0;for(l=k.length;l--;)k[l].touchScrolled=!0}h.scrollbarsShown&&(h.scrollableX||h.scrollableY)&&(c.preventDefault(),c=h.scrollableX?h.startX+g.pageX:0,g=h.scrollableY?h.startY+g.pageY:0,l=h.scrollableX?-(h.scrollWidth-h.parentWidth):0,h=h.scrollableY?-(h.scrollHeight-h.parentHeight):0,0<c?c/=2:c<l&&(c=l-(l-c)/2),0<g?g/=2:g<h&&(g=h-(h-g)/2),e(d,-c,-g))}else k>
g&&d.cancelTouchScroll()}function c(b){var c=b.widget,d=c.id;t[d]&&a.countCurrentTouches(b,c.touchNode)==c.touchesToScroll-1&&q(d)}function n(a,b,c){function d(){delete e.transitionHandler;e.resetEffects();delete t[a]}var e=t[a],f=e.widget,g=e.node,h=e.scrollableX?Math.max(Math.min(0,b),-(e.scrollWidth-e.parentWidth)):b,l=e.scrollableY?Math.max(Math.min(0,c),-(e.scrollHeight-e.parentHeight)):c;delete e.timer;h!=b||l!=c?(e.transitionHandler=k.once(g,x,d),g.style[z+"Duration"]=f.bounceDuration+"ms",
g.style[B]=C+h+"px,"+l+"px"+D,h!=b&&e.scrollableX&&(g=e.widget._scrollbarXNode,g.style[z+"Duration"]=f.bounceDuration+"ms",g.style[B]=b>h?C+"0,0"+D:C+(g.parentNode.offsetWidth-g.offsetWidth)+"px,0"+D),l!=c&&e.scrollableY&&(g=e.widget._scrollbarYNode,g.style[z+"Duration"]=f.bounceDuration+"ms",g.style[B]=c>l?C+"0,0"+D:C+"0,"+(g.parentNode.offsetHeight-g.offsetHeight)+"px"+D)):d()}function q(a){var b=t[a],c=r[a],d,f;delete r[a];b.timer&&clearTimeout(b.timer);b.resetEffects=m;(d=v.exec(b.node.style[B]))?
(f=+d[1],d=+d[2]):f=d=0;!b.velX&&!b.velY||(0<=f||f<=-(b.scrollWidth-b.parentWidth))&&(0<=d||d<=-(b.scrollHeight-b.parentHeight))?n(a,f,d):(c&&(c.velX||c.velY)&&(0>=b.velX&&0>=c.velX||0<=b.velX&&0<=c.velX)&&(0>=b.velY&&0>=c.velY||0<=b.velY&&0<=c.velY)&&(b.velX=1.15*(b.velX+c.velX),b.velY=1.15*(b.velY+c.velY)),b.lastX=f,b.lastY=d,b.calcFunc=function(){var b=t[a],c,d,f,g,h,k;if(b)if(c=b.widget,h=c.glideDecel(b.velX),k=c.glideDecel(b.velY),1<=Math.abs(h)||1<=Math.abs(k)){f=b.lastX+h;g=b.lastY+k;if(0<
f||f<-(b.scrollWidth-b.parentWidth))for(d=6;d--;)h=c.glideDecel(h);if(0<g||g<-(b.scrollHeight-b.parentHeight))for(d=6;d--;)k=c.glideDecel(k);e(c,-f,-g);b.lastX=f;b.lastY=g;b.velX=h;b.velY=k;b.timer=setTimeout(b.calcFunc,30)}else n(a,b.lastX,b.lastY)},b.timer=setTimeout(b.calcFunc,30))}var t={},r={},v=/^translate(?:3d)?\((-?\d+)(?:\.\d*)?(?:px)?, (-?\d+)/,u=/^matrix\(1, 0, 0, 1, (-?\d+)(?:\.\d*)?(?:px)?, (-?\d+)/,w=f("css-transitions"),x=f("transitionend"),y=f("css-transforms");f=f("css-transforms3d");
var A,z,B,C,D;f?(C="translate3d(",D=",0)"):y&&(C="translate(",D=")");if(!w||!C)return console.warn("CSS3 features unavailable for touch scroll effects."),function(){};B=f||y;B=!0===B?"transform":B+"Transform";z=!0===w?"transition":w+"Transition";A=!0===y?"":"-"+y.toLowerCase()+"-";return h("dgrid.TouchScroll",null,{touchesToScroll:1,touchNode:null,scrollThreshold:10,bounceDuration:300,postCreate:function(){this._initTouch();this.inherited(arguments)},_initTouch:function(){function a(){f.cancelTouchScroll()}
function b(b){return function(c){c.widget=f;c.cancelTouchScroll=a;b.call(this,c)}}var e=this.touchNode=this.touchNode||this.containerNode,f=this,h;e&&e.parentNode?(h=e.parentNode,h.style.overflow="hidden",e.style[z+"Property"]=A+"transform",e.style[z+"TimingFunction"]="cubic-bezier(0.33, 0.66, 0.66, 1)",this._touchScrollListeners=[k(h,"touchstart",b(g)),k(h,"touchmove",b(d)),k(h,"touchend,touchcancel",b(c))]):console.warn("TouchScroll requires a nested node upon which to operate.")},destroy:function(){for(var a=
this._touchScrollListeners.length;a--;)this._touchScrollListeners[a].remove();delete t[this.id];this.inherited(arguments)},scrollTo:function(a){var b=t[this.id],c=this.touchNode,d=c.parentNode;!a.preserveMomentum&&b&&b.resetEffects&&b.resetEffects();a.x&&(a.x=Math.max(0,Math.min(a.x,c.scrollWidth-d.offsetWidth)));a.y&&(a.y=Math.max(0,Math.min(a.y,c.scrollHeight-d.offsetHeight)));e(this,a)},getScrollPosition:function(){var a=l(this);return a?{x:-a[1],y:-a[2]}:{x:0,y:0}},cancelTouchScroll:function(){var a=
t[this.id];a&&(a.resetEffects?a.resetEffects():(a.timer&&clearTimeout(a.timer),b(a.node.parentNode,".touchscroll-fadeout")),delete t[this.id])},glideDecel:function(a){return.9*a}})})},"dgrid/util/has-css3":function(){define(["dojo/has"],function(h){function k(f,b){var e=f.style,h;if(b in e)return!0;b=b.slice(0,1).toUpperCase()+b.slice(1);for(h=a.length;h--;)if(a[h]+b in e)return a[h];return!1}var a=["ms","O","Moz","Webkit"];h.add("css-transitions",function(a,b,e){return k(e,"transitionProperty")});
h.add("css-transforms",function(a,b,e){return k(e,"transform")});h.add("css-transforms3d",function(a,b,e){return k(e,"perspective")});h.add("transitionend",function(){var a=h("css-transitions");return a?!0===a?"transitionend":{ms:"MSTransitionEnd",O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[a]:!1});return h})},"url:cmv/viewer/js/viewer/templates/mapOverlay.html":'\x3cdiv style\x3d"position:absolute;bottom:0;left:0;z-index:40;"\x3e\n    \x3cdiv id\x3d"mapInfoDijit"\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n\x3cdiv style\x3d"position:absolute;top:20px;right:20px;z-index:40;"\x3e\n    \x3cdiv id\x3d"basemapsDijit"\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n\x3cdiv style\x3d"position:absolute;top:60px;right:20px;z-index:40;width:250px;"\x3e\n    \x3cdiv id\x3d"growlerDijit"\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n\x3cdiv style\x3d"position: absolute;left:19px;top:94px;z-index:40;"\x3e\n    \x3cdiv id\x3d"homeButton"\x3e\n    \x3c/div\x3e\n    \x3cdiv id\x3d"locateButton"\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n\x3cdiv style\x3d"position:absolute;top:20px;left:64px;z-index:40;"\x3e\n    \x3cdiv id\x3d"geocoderButton"\x3e\n    \x3c/div\x3e\n\x3c/div\x3e',
"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\n\t\t\x3c/span\x3e\n\t\x3c/div\x3e\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\n\t${!actionBarTemplate}\n\x3c/div\x3e\n\n',
"url:dijit/form/templates/Button.html":'\x3cspan class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" role\x3d"presentation"\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\n\t\t\t\tid\x3d"${id}_label"\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\n\t\t\t\x3e\x3c/span\n\t\t\x3e\x3c/span\n\t\x3e\x3c/span\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen"\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\n\t\ttabIndex\x3d"-1" aria-hidden\x3d"true" data-dojo-attach-point\x3d"valueNode"\n/\x3e\x3c/span\x3e\n',
"url:dijit/form/templates/TextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"presentation"\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',"url:dijit/templates/Tooltip.html":'\x3cdiv class\x3d"dijitTooltip dijitTooltipLeft" id\x3d"dojoTooltip" data-dojo-attach-event\x3d"mouseenter:onMouseEnter,mouseleave:onMouseLeave"\n\t\x3e\x3cdiv class\x3d"dijitTooltipConnector" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitTooltipContainer dijitTooltipContents" data-dojo-attach-point\x3d"containerNode" role\x3d\'alert\'\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"url:dijit/form/templates/ValidationTextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tid\x3d"widget_${id}" role\x3d"presentation"\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\n\t   cellspacing\x3d"0"\x3e\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\n\x3c/table\x3e\n',"url:dijit/templates/TitlePane.html":'\x3cdiv\x3e\n\t\x3cdiv data-dojo-attach-event\x3d"ondijitclick:_onTitleClick, onkeydown:_onTitleKey"\n\t\t\tclass\x3d"dijitTitlePaneTitle" data-dojo-attach-point\x3d"titleBarNode" id\x3d"${id}_titleBarNode"\x3e\n\t\t\x3cdiv class\x3d"dijitTitlePaneTitleFocus" data-dojo-attach-point\x3d"focusNode"\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"arrowNode" class\x3d"dijitInline dijitArrowNode" role\x3d"presentation"\x3e\x3c/span\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"arrowNodeInner" class\x3d"dijitArrowNodeInner"\x3e\x3c/span\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitTitlePaneTextNode"\x3e\x3c/span\x3e\n\t\t\x3c/div\x3e\n\t\x3c/div\x3e\n\t\x3cdiv class\x3d"dijitTitlePaneContentOuter" data-dojo-attach-point\x3d"hideNode" role\x3d"presentation"\x3e\n\t\t\x3cdiv class\x3d"dijitReset" data-dojo-attach-point\x3d"wipeNode" role\x3d"presentation"\x3e\n\t\t\t\x3cdiv class\x3d"dijitTitlePaneContentInner" data-dojo-attach-point\x3d"containerNode" role\x3d"region" id\x3d"${id}_pane" aria-labelledby\x3d"${id}_titleBarNode"\x3e\n\t\t\t\t\x3c!-- nested divs because wipeIn()/wipeOut() doesn\'t work right on node w/padding etc.  Put padding on inner div. --\x3e\n\t\t\t\x3c/div\x3e\n\t\t\x3c/div\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e\n',
"url:dojox/layout/resources/ResizeHandle.css":{},"url:cmv/viewer/js/gis/dijit/FloatingTitlePane/css/FloatingTitlePane.css":{},"url:app/css/main.css":{},"url:cmv/viewer/js/gis/dijit/LayerControl/css/LayerControl.css":{},"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\n\t\t\x3c/span\x3e\n\t\x3c/td\x3e\n\x3c/tr\x3e\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\n\t\x3c/td\x3e\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\n\t\x3c/td\x3e\n\x3c/tr\x3e\n',
"url:dijit/templates/TooltipDialog.html":'\x3cdiv role\x3d"alertdialog" tabIndex\x3d"-1"\x3e\n\t\x3cdiv class\x3d"dijitTooltipContainer" role\x3d"presentation"\x3e\n\t\t\x3cdiv data-dojo-attach-point\x3d"contentsNode" class\x3d"dijitTooltipContents dijitTooltipFocusNode"\x3e\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\n\t\t\t${!actionBarTemplate}\n\t\t\x3c/div\x3e\n\t\x3c/div\x3e\n\t\x3cdiv class\x3d"dijitTooltipConnector" role\x3d"presentation" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\x3e\n\x3c/div\x3e\n',
"url:dijit/form/templates/HorizontalSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown, onkeyup:_onKeyUp"\n\trole\x3d"presentation"\n\t\x3e\x3ctr class\x3d"dijitReset"\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\x3e\x3c/tr\n\t\x3e\x3ctr class\x3d"dijitReset"\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset"\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\n\t\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitSliderBarContainerH" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" data-dojo-attach-event\x3d"press:_onBarClick"\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\n\t\t\t\t\t\x3e\x3c/div\n\t\t\t\t\x3e\x3c/div\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c/div\n\t\t\t\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\x3e\x3c/tr\n\t\x3e\x3ctr class\x3d"dijitReset"\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\x3e\x3c/tr\n\x3e\x3c/table\x3e\n',
"url:cmv/viewer/js/gis/dijit/LayerControl/controls/templates/Control.html":'\x3cdiv class\x3d"layerControl"\x3e\n    \x3ctable class\x3d"layerControlTable"\x3e\n        \x3ctr data-dojo-attach-point\x3d"expandClickNode"\x3e\n            \x3ctd class\x3d"layerControlTableExpand"\x3e\n                \x3ci data-dojo-attach-point\x3d"expandIconNode" class\x3d"fa ${icons.expand} layerControlIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableCheck"\x3e\n                \x3ci data-dojo-attach-point\x3d"checkNode" class\x3d"fa ${icons.unchecked} layerControlIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableLabel"\x3e\n                \x3cspan data-dojo-attach-point\x3d"labelNode"\x3e\x3c/span\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableUpdate"\x3e\n                \x3ci data-dojo-attach-point\x3d"layerUpdateNode" class\x3d"fa ${icons.update} fa-spin layerControlUpdateIcon" style\x3d"display:none;"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd data-dojo-attach-point\x3d"menuClickNode" class\x3d"layerControlTableMenu"\x3e\n                \x3ci data-dojo-attach-point\x3d"menuNode" class\x3d"fa ${icons.menu} layerControlMenuIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n        \x3c/tr\x3e\n    \x3c/table\x3e\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"layerControlIndent layerControlExpand" style\x3d"display:none;"\x3e\x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/LayerControl/controls/templates/Sublayer.html":'\x3cdiv class\x3d"layerControl layerControlSublayer"\x3e\n    \x3ctable class\x3d"layerControlTable"\x3e\n        \x3ctr data-dojo-attach-point\x3d"expandClickNode"\x3e\n            \x3ctd class\x3d"layerControlTableExpand"\x3e\n                \x3ci data-dojo-attach-point\x3d"expandIconNode" class\x3d"fa ${icons.expand} layerControlIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableCheck"\x3e\n                \x3ci data-dojo-attach-point\x3d"checkNode" class\x3d"fa ${icons.unchecked} layerControlIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableLabel"\x3e\n                \x3cspan data-dojo-attach-point\x3d"labelNode"\x3e\x3c/span\x3e\n                \x3cspan data-dojo-attach-point\x3d"iconNode" class\x3d"icon-extra"\x3e\x3c/span\x3e\n            \x3ctd class\x3d"layerControlTableUpdate"\x3e\n                \x3ci data-dojo-attach-point\x3d"layerUpdateNode" class\x3d"fa ${icons.update} fa-spin layerControlUpdateIcon" style\x3d"display:none;"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd data-dojo-attach-point\x3d"menuClickNode" class\x3d"layerControlTableMenu"\x3e\n                \x3ci data-dojo-attach-point\x3d"menuNode" class\x3d"fa ${icons.menu} layerControlMenuIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n        \x3c/tr\x3e\n    \x3c/table\x3e\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"layerControlIndent layerControlExpand" style\x3d"display:none;"\x3e\x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/LayerControl/controls/templates/Folder.html":'\x3cdiv class\x3d"layerControl layerControlFolder"\x3e\n    \x3ctable class\x3d"layerControlTable"\x3e\n        \x3ctr data-dojo-attach-point\x3d"expandClickNode"\x3e\n            \x3ctd class\x3d"layerControlTableExpand"\x3e\n                \x3ci data-dojo-attach-point\x3d"expandIconNode" class\x3d"fa ${icons.folder} layerControlIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableCheck"\x3e\n                \x3ci data-dojo-attach-point\x3d"checkNode" class\x3d"fa ${icons.unchecked} layerControlIcon"\x3e\x3c/i\x3e\n            \x3c/td\x3e\n            \x3ctd class\x3d"layerControlTableLabel"\x3e\n                \x3cspan data-dojo-attach-point\x3d"labelNode"\x3e\x3c/span\x3e\n            \x3c/td\x3e\n        \x3c/tr\x3e\n    \x3c/table\x3e\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"layerControlIndent" style\x3d"display:none;"\x3e\x3c/div\x3e\n\x3c/div\x3e\n',
"url:esri/dijit/templates/HomeButton.html":'\x3cdiv class\x3d"${theme}" role\x3d"presentation"\x3e\n    \x3cdiv class\x3d"${_css.container}"\x3e\n            \x3cdiv data-dojo-attach-point\x3d"_homeNode" title\x3d"${_i18n.widgets.homeButton.home.title}" role\x3d"button" class\x3d"${_css.home}" tabindex\x3d"0"\x3e\x3cspan\x3e${_i18n.widgets.homeButton.home.button}\x3c/span\x3e\x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e',"url:esri/dijit/templates/OverviewMap.html":'\x3cdiv class\x3d"esriOverviewMap"\x3e\n  \x3cdiv class\x3d"ovwContainer" dojoattachpoint\x3d"_body" style\x3d"width: ${width}px; height: ${height}px;"\x3e\n    \x3cdiv id\x3d"${id}-map" style\x3d"width: 100%; height: 100%;"\x3e\n      \x3cdiv class\x3d"ovwHighlight" dojoattachpoint\x3d"_focusDiv" title\x3d"${NLS_drag}" style\x3d"border: 1px solid ${color}; background-color: ${color};"\x3e\x3c/div\x3e\n    \x3c/div\x3e\n  \x3c/div\x3e\n  \x3cdiv class\x3d"ovwButton ovwController" title\x3d"${NLS_show}" dojoattachpoint\x3d"_controllerDiv" dojoattachevent\x3d"onclick: _visibilityHandler"\x3e\n  \x3c/div\x3e\n  \x3cdiv class\x3d"ovwButton ovwMaximizer" title\x3d"${NLS_maximize}" dojoattachpoint\x3d"_maximizerDiv" dojoattachevent\x3d"onclick: _maximizeHandler"\x3e\n  \x3c/div\x3e\n\x3c/div\x3e\n',
"url:dijit/form/templates/DropDownButton.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\n\t\x3e\x3cspan class\x3d\'dijitReset dijitInline dijitButtonNode\'\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" data-dojo-attach-point\x3d"_buttonNode"\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\n\t\t\tdata-dojo-attach-point\x3d"focusNode,titleNode,_arrowWrapperNode,_popupStateNode"\n\t\t\trole\x3d"button" aria-haspopup\x3d"true" aria-labelledby\x3d"${id}_label"\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon"\n\t\t\t\tdata-dojo-attach-point\x3d"iconNode"\n\t\t\t\x3e\x3c/span\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\n\t\t\t\tid\x3d"${id}_label"\n\t\t\t\x3e\x3c/span\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonInner"\x3e\x3c/span\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonChar"\x3e\x26#9660;\x3c/span\n\t\t\x3e\x3c/span\n\t\x3e\x3c/span\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1"\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick" data-dojo-attach-point\x3d"valueNode" aria-hidden\x3d"true"\n/\x3e\x3c/span\x3e\n',
"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\n\t\x3e\x3c/div\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\n\x3e\x3c/div\x3e\n',
"url:esri/dijit/editing/templates/AttachmentEditor.html":"\x3cdiv class\x3d\"attachmentEditor\"\x3e\n    \x3cbr /\x3e\n    \x3cdiv\x3e\n        \x3cb\x3e${NLS_attachments}\x3c/b\x3e\n        \x3chr /\x3e\n        \x3cdiv dojoAttachPoint\x3d\"_attachmentError\" style\x3d'color:red;display:none'\x3e\x3c/div\x3e\n        \x3cbr /\x3e\n        \x3cspan dojoAttachPoint\x3d'_attachmentList' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e\n        \x3cbr\x3e\x3cbr\x3e\n        \x3cdiv data-dojo-type\x3d\"dijit/ProgressBar\" dojoAttachPoint\x3d\"_attachmentProgress\" indeterminate\x3d\"true\" style\x3d'display:none'\x3e\x3c/div\x3e\n        \x3cbr /\x3e        \n        \x3cform dojoAttachPoint\x3d'_uploadForm'\x3e ${NLS_add}:\x26nbsp;\x26nbsp;\x3cinput type\x3d'file' name\x3d'attachment' dojoAttachPoint\x3d'_uploadField' /\x3e \x3c/form\x3e\n    \x3c/div\x3e\n\x3c/div\x3e",
"url:dijit/templates/Calendar.html":'\x3cdiv class\x3d"dijitCalendarContainer dijitInline" role\x3d"presentation" aria-labelledby\x3d"${id}_mddb ${id}_year"\x3e\n\t\x3cdiv class\x3d"dijitReset dijitCalendarMonthContainer" role\x3d"presentation"\x3e\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarDecrementArrow\' data-dojo-attach-point\x3d"decrementMonth"\x3e\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"/\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\n\t\t\x3c/div\x3e\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarIncrementArrow\' data-dojo-attach-point\x3d"incrementMonth"\x3e\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"/\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\n\t\t\x3c/div\x3e\n\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode" class\x3d"dijitInline"\x3e\x3c/div\x3e\n\t\x3c/div\x3e\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"grid" data-dojo-attach-point\x3d"gridNode"\x3e\n\t\t\x3cthead\x3e\n\t\t\t\x3ctr role\x3d"row"\x3e\n\t\t\t\t${!dayCellsHtml}\n\t\t\t\x3c/tr\x3e\n\t\t\x3c/thead\x3e\n\t\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\n\t\t\t\t${!dateRowsHtml}\n\t\t\x3c/tbody\x3e\n\t\x3c/table\x3e\n\t\x3cdiv class\x3d"dijitReset dijitCalendarYearContainer" role\x3d"presentation"\x3e\n\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\n\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\n\t\t\x3c/div\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e\n',
"url:dijit/form/templates/DropDownBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tid\x3d"widget_${id}"\n\trole\x3d"combobox"\n\taria-haspopup\x3d"true"\n\tdata-dojo-attach-point\x3d"_popupStateNode"\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\n\t\tdata-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\n\t\t\t${_buttonInputDisabled}\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' ${!nameAttrSetting} type\x3d"${type}" autocomplete\x3d"off"\n\t\t\tdata-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"url:dijit/form/templates/Spinner.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tid\x3d"widget_${id}" role\x3d"presentation"\n\t\x3e\x3cdiv class\x3d"dijitReset dijitButtonNode dijitSpinnerButtonContainer"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitSpinnerButtonInner" type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton"\n\t\t\tdata-dojo-attach-point\x3d"upArrowNode"\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9650; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/\x3e\x3c/div\n\t\t\x3e\x3c/div\n\t\t\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton"\n\t\t\tdata-dojo-attach-point\x3d"downArrowNode"\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/\x3e\x3c/div\n\t\t\x3e\x3c/div\n\t\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' data-dojo-attach-point\x3d"textbox,focusNode" type\x3d"${type}" data-dojo-attach-event\x3d"onkeydown:_onKeyDown"\n\t\t\trole\x3d"spinbutton" autocomplete\x3d"off" ${!nameAttrSetting}\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"url:esri/dijit/templates/AttributeInspector.html":'\x3cdiv class\x3d"esriAttributeInspector"\x3e\n    \x3cdiv class\x3d"atiLayerName" dojoAttachPoint\x3d"layerName"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"atiAttributes" dojoAttachPoint\x3d"attributeTable"\x3e\x3c/div\x3e\n    \x3cdiv dojoAttachPoint\x3d"attachmentEditor"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"atiEditorTrackingInfo" dojoAttachPoint\x3d"editorTrackingInfoDiv"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"atiButtons" dojoAttachPoint\x3d"editButtons"\x3e\n        \x3cbutton  dojoType\x3d"dijit.form.Button" class\x3d"atiButton atiDeleteButton"  dojoAttachPoint\x3d"deleteBtn" dojoAttachEvent\x3d"onClick: onDeleteBtn" showLabel\x3d"true" type\x3d"button"\x3e${NLS_deleteFeature}\x3c/button\x3e\n        \x3cdiv class\x3d"atiNavButtons" dojoAttachPoint\x3d"navButtons"\x3e\n            \x3cdiv class\x3d"atiNavMessage" dojoAttachPoint\x3d"navMessage"\x3e\x3c/div\x3e\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiFirstIcon" dojoAttachPoint\x3d"firstFeatureButton" dojoAttachEvent\x3d"onClick: onFirstFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_first}\x3c/button\x3e\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiPrevIcon" dojoAttachPoint\x3d"prevFeatureButton" dojoAttachEvent\x3d"onClick: onPreviousFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_previous}\x3c/button\x3e\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiNextIcon" dojoAttachPoint\x3d"nextFeatureButton" dojoAttachEvent\x3d"onClick: onNextFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_next}\x3c/button\x3e\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiLastIcon" dojoAttachPoint\x3d"lastFeatureButton" dojoAttachEvent\x3d"onClick: onLastFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_last}\x3c/button\x3e\n        \x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:dijit/form/templates/ComboButton.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tcellspacing\x3d\'0\' cellpadding\x3d\'0\' role\x3d"presentation"\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonNode" data-dojo-attach-point\x3d"buttonNode" data-dojo-attach-event\x3d"ondijitclick:__onClick,onkeydown:_onButtonKeyDown"\n\t\t\x3e\x3cdiv id\x3d"${id}_button" class\x3d"dijitReset dijitButtonContents"\n\t\t\tdata-dojo-attach-point\x3d"titleNode"\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode" role\x3d"presentation"\x3e\x3c/div\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitButtonText" id\x3d"${id}_label" data-dojo-attach-point\x3d"containerNode" role\x3d"presentation"\x3e\x3c/div\n\t\t\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd id\x3d"${id}_arrow" class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton\'\n\t\t\tdata-dojo-attach-point\x3d"_popupStateNode,focusNode,_buttonNode"\n\t\t\tdata-dojo-attach-event\x3d"onkeydown:_onArrowKeyDown"\n\t\t\ttitle\x3d"${optionsTitle}"\n\t\t\trole\x3d"button" aria-haspopup\x3d"true"\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonInner" role\x3d"presentation"\x3e\x3c/div\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonChar" role\x3d"presentation"\x3e\x26#9660;\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd style\x3d"display:none !important;"\n\t\t\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" data-dojo-attach-point\x3d"valueNode"\n\t\t\t\tclass\x3d"dijitOffScreen" aria-hidden\x3d"true" data-dojo-attach-event\x3d"onclick:_onClick"\n\t\t/\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\n\x3e\x3c/table\x3e\n',
"url:dojox/grid/resources/View.html":'\x3cdiv class\x3d"dojoxGridView" role\x3d"presentation"\x3e\n\t\x3cdiv class\x3d"dojoxGridHeader" dojoAttachPoint\x3d"headerNode" role\x3d"presentation"\x3e\n\t\t\x3cdiv dojoAttachPoint\x3d"headerNodeContainer" style\x3d"width:9000em" role\x3d"presentation"\x3e\n\t\t\t\x3cdiv dojoAttachPoint\x3d"headerContentNode" role\x3d"row"\x3e\x3c/div\x3e\n\t\t\x3c/div\x3e\n\t\x3c/div\x3e\n\t\x3cinput type\x3d"checkbox" class\x3d"dojoxGridHiddenFocus" dojoAttachPoint\x3d"hiddenFocusNode" aria-hidden\x3d"true" /\x3e\n\t\x3cinput type\x3d"checkbox" class\x3d"dojoxGridHiddenFocus" aria-hidden\x3d"true" /\x3e\n\t\x3cdiv class\x3d"dojoxGridScrollbox" dojoAttachPoint\x3d"scrollboxNode" role\x3d"presentation"\x3e\n\t\t\x3cdiv class\x3d"dojoxGridContent" dojoAttachPoint\x3d"contentNode" hidefocus\x3d"hidefocus" role\x3d"presentation"\x3e\x3c/div\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e\n',
"url:dijit/templates/CheckedMenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"${role}" tabIndex\x3d"-1" aria-checked\x3d"${checked}"\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\n\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuItemIcon dijitCheckedMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\t\x3cspan class\x3d"dijitMenuItemIconChar dijitCheckedMenuItemIconChar"\x3e${!checkedChar}\x3c/span\x3e\n\t\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,labelNode,textDirNode"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\x26#160;\x3c/td\x3e\n\x3c/tr\x3e\n',
"url:dojox/grid/resources/_Grid.html":'\x3cdiv hidefocus\x3d"hidefocus" role\x3d"grid" dojoAttachEvent\x3d"onmouseout:_mouseOut"\x3e\n\t\x3cdiv class\x3d"dojoxGridMasterHeader" dojoAttachPoint\x3d"viewsHeaderNode" role\x3d"presentation"\x3e\x3c/div\x3e\n\t\x3cdiv class\x3d"dojoxGridMasterView" dojoAttachPoint\x3d"viewsNode" role\x3d"presentation"\x3e\x3c/div\x3e\n\t\x3cdiv class\x3d"dojoxGridMasterMessages" style\x3d"display: none;" dojoAttachPoint\x3d"messagesNode"\x3e\x3c/div\x3e\n\t\x3cspan dojoAttachPoint\x3d"lastFocusNode" tabindex\x3d"0"\x3e\x3c/span\x3e\n\x3c/div\x3e\n',
"url:esri/dijit/editing/templates/TemplatePicker.html":'\x3cdiv class\x3d"templatePicker"\x3e\n\n  \x3ctable dojoType\x3d"dojox.grid.DataGrid" noDataMessage\x3d"${emptyMessage}" selectionMode\x3d"none" autoHeight\x3d"${_rows}" autoWidth\x3d"${_autoWidth}"\n         query\x3d"{ query: \'*\' }" dojoAttachPoint\x3d"grid" class\x3d"grid"\x3e\n  \x3c/table\x3e\n  \n\x3c/div\x3e',"url:esri/dijit/editing/templates/Editor.html":'\x3cdiv class\x3d"esriEditor"\x3e\n    \x3cdiv class\x3d"esriTemplatePicker" dojoAttachPoint\x3d"templatePickerDiv"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"esriDrawingToolbar" dojoAttachPoint\x3d"drawingToolbarDiv"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"progressBar" dojoAttachPoint\x3d"progressBar" indeterminate\x3d"true" dojoType\x3d"dijit.ProgressBar" /\x3e\n\x3c/div\x3e',
"url:cmv/viewer/js/gis/dijit/Growler/css/Growler.css":{},"url:esri/dijit/templates/BasemapGallery.html":'\x3cdiv class\x3d"esriBasemapGallery"\x3e\n  \x3cdiv dojoAttachPoint\x3d"flowContainer"\x3e\n  \x3c/div\x3e\n\x3c/div\x3e',"url:cmv/viewer/js/gis/dijit/Basemaps/templates/Basemaps.html":'\x3cdiv\x3e\n    \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton" data-dojo-props\x3d"iconClass:\'basemapsIcon\'" data-dojo-attach-point\x3d"dropDownButton"\x3e\n        \x3cspan\x3e\n            ${title}\n        \x3c/span\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/Basemaps/css/Basemaps.css":{},"url:cmv/viewer/js/gis/dijit/Help/templates/HelpDialog.html":'\x3cdiv class\x3d"helpDijit"\x3e\n    \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" data-dojo-attach-point\x3d"containerNode" class\x3d"helpContainer"\x3e\n        \x3cdiv class\x3d"helpNode"\x3e\n            \x3cdiv data-dojo-type\x3d"dijit/layout/TabContainer" class\x3d"helpTabContainer"\x3e\n                \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${i18n.navigation.title}"\x3e\n                    \x3ctable\x3e\n                        \x3ctbody\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${i18n.navigation.description}\n                                    \x3cul class\x3d"listdbootstrapFix"\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.pan1}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.recenter}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomIn1}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomOut1}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomIn2}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomOut2}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.pan2}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomInLevel}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomOutLevel}\n                                        \x3c/li\x3e\n                                        \x3cli\x3e\n                                            ${i18n.navigation.zoomCenter}\n                                        \x3c/li\x3e\n                                    \x3c/ul\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/tbody\x3e\n                    \x3c/table\x3e\n                \x3c/div\x3e\n                \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${i18n.search.title}"\x3e\n                    ${i18n.search.description}\n                    \x3cul class\x3d"listdbootstrapFix"\x3e\n                        \x3cli\x3e\n                            ${i18n.search.address}\n                        \x3c/li\x3e\n                        \x3cli\x3e\n                            ${i18n.search.place}\n                        \x3c/li\x3e\n                        \x3cli\x3e\n                            ${i18n.search.etc}\n                        \x3c/li\x3e\n                    \x3c/ul\x3e\n                \x3c/div\x3e\n                \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${i18n.tools.title}"\x3e\n                    ${i18n.tools.description}\n                    \x3cul class\x3d"listdbootstrapFix"\x3e\n                        \x3cli\x3e\n                            ${i18n.tools.measure.title}\n                        \x3c/li\x3e\n                        \x3cdiv\x3e\n                            ${i18n.tools.measure.description}\n                        \x3c/div\x3e\n                        \x3cli\x3e\n                            ${i18n.tools.print.title}\n                        \x3c/li\x3e\n                        \x3cdiv\x3e\n                            ${i18n.tools.print.description}\n                        \x3c/div\x3e\n                    \x3c/ul\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n        \x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:dijit/layout/templates/TabContainer.html":'\x3cdiv class\x3d"dijitTabContainer"\x3e\n\t\x3cdiv class\x3d"dijitTabListWrapper" data-dojo-attach-point\x3d"tablistNode"\x3e\x3c/div\x3e\n\t\x3cdiv data-dojo-attach-point\x3d"tablistSpacer" class\x3d"dijitTabSpacer ${baseClass}-spacer"\x3e\x3c/div\x3e\n\t\x3cdiv class\x3d"dijitTabPaneWrapper ${baseClass}-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\n\x3c/div\x3e\n',"url:dijit/layout/templates/_TabButton.html":'\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"titleNode,innerDiv,tabContent" class\x3d"dijitTabInner dijitTabContent"\x3e\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTabButtonIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\x3cspan data-dojo-attach-point\x3d\'containerNode,focusNode\' class\x3d\'tabLabel\'\x3e\x3c/span\x3e\n\t\x3cspan class\x3d"dijitInline dijitTabCloseButton dijitTabCloseIcon" data-dojo-attach-point\x3d\'closeNode\'\n\t\t  role\x3d"presentation"\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d\'closeText\' class\x3d\'dijitTabCloseText\'\x3e[x]\x3c/span\n\t\t\t\t\x3e\x3c/span\x3e\n\x3c/div\x3e\n',
"url:dijit/layout/templates/ScrollingTabController.html":'\x3cdiv class\x3d"dijitTabListContainer-${tabPosition}" style\x3d"visibility:hidden"\x3e\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerMenuButton"\n\t\t class\x3d"tabStripButton-${tabPosition}"\n\t\t id\x3d"${id}_menuBtn"\n\t\t data-dojo-props\x3d"containerId: \'${containerId}\', iconClass: \'dijitTabStripMenuIcon\',\n\t\t\t\t\tdropDownPosition: [\'below-alt\', \'above-alt\']"\n\t\t data-dojo-attach-point\x3d"_menuBtn" showLabel\x3d"false" title\x3d""\x3e\x26#9660;\x3c/div\x3e\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\n\t\t class\x3d"tabStripButton-${tabPosition}"\n\t\t id\x3d"${id}_leftBtn"\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideLeftIcon\', showLabel:false, title:\'\'"\n\t\t data-dojo-attach-point\x3d"_leftBtn" data-dojo-attach-event\x3d"onClick: doSlideLeft"\x3e\x26#9664;\x3c/div\x3e\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\n\t\t class\x3d"tabStripButton-${tabPosition}"\n\t\t id\x3d"${id}_rightBtn"\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideRightIcon\', showLabel:false, title:\'\'"\n\t\t data-dojo-attach-point\x3d"_rightBtn" data-dojo-attach-event\x3d"onClick: doSlideRight"\x3e\x26#9654;\x3c/div\x3e\n\t\x3cdiv class\x3d\'dijitTabListWrapper\' data-dojo-attach-point\x3d\'tablistWrapper\'\x3e\n\t\t\x3cdiv role\x3d\'tablist\' data-dojo-attach-event\x3d\'onkeydown:onkeydown\'\n\t\t\t data-dojo-attach-point\x3d\'containerNode\' class\x3d\'nowrapTabStrip\'\x3e\x3c/div\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e',
"url:dijit/layout/templates/_ScrollingTabControllerButton.html":'\x3cdiv data-dojo-attach-event\x3d"ondijitclick:_onClick" class\x3d"dijitTabInnerDiv dijitTabContent dijitButtonContents"  data-dojo-attach-point\x3d"focusNode" role\x3d"button"\x3e\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitTabStripIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\x3cspan data-dojo-attach-point\x3d"containerNode,titleNode" class\x3d"dijitButtonText"\x3e\x3c/span\x3e\n\x3c/div\x3e',"url:cmv/viewer/js/gis/dijit/Help/css/Help.css":{},
"url:cmv/viewer/js/gis/dijit/Bookmarks/css/Bookmarks.css":{},"url:dgrid/css/dgrid.css":{},"url:dgrid/css/extensions/ColumnResizer.css":{},"url:cmv/viewer/js/gis/dijit/Find/templates/Find.html":'\x3cdiv class\x3d"gis_AdvancedFindDijit" \x3e\n    \x3cdiv class\x3d"formContainer"\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"searchFormDijit"\x3e\n            \x3cdiv data-dojo-attach-point\x3d"querySelectDom"\x3e\n                \x3clabel\x3e${i18n.selectQuery}:\x3c/label\x3e\x3cbr/\x3e\n    \t\t\t\x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"name:\'query\',autoComplete:true,required:true,searchAttr:\'description\',\'class\':\'querySelect\'" data-dojo-attach-point\x3d"querySelectDijit" data-dojo-attach-event\x3d"onChange:_onQueryChange"/\x3e\n            \x3c/div\x3e\n            \x3cdiv data-dojo-attach-point\x3d"queryTextDom"\x3e\n                \x3clabel\x3e${i18n.searchText.label}:\x3c/label\x3e\x3cbr/\x3e\n    \t\t\t\x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"searchTextDijit" data-dojo-props\x3d"name:\'searchText\',trim:true,required:true,value:\'\',placeholder:\'${i18n.searchText.placeholder}\',\'class\':\'searchText\'" /\x3e\x3cbr/\x3e\n            \x3c/div\x3e\n            \x3cdiv data-dojo-attach-point\x3d"queryContainsDom"\x3e\n                \x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"containsSearchText" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"\'class\':\'optionsCheckBox\'"/\x3e\n                \x3clabel\x3e${i18n.exactMatches}\x3c/label\x3e\n            \x3c/div\x3e\n\n            \x3cdiv class\x3d"buttonActionBar"\x3e\n\n                \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'fa fa-history fa-fw\',\'class\':\'clearButton actionBarButton\'" data-dojo-attach-event\x3d"onClick:clearResults" data-dojo-attach-point\x3d"clearButtonDijit"\x3e\n                    ${i18n.clearButton.label}\n                \x3c/div\x3e\n\n                \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"busyLabel:\'${i18n.searchButton.busyLabel}\',iconClass:\'fa fa-search fa-fw\',\'class\':\'searchButton actionBarButton\'" data-dojo-attach-event\x3d"onClick:search" data-dojo-attach-point\x3d"searchButtonDijit"\x3e\n                    ${i18n.searchButton.label}\n                \x3c/div\x3e\n\n                \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton" data-dojo-props\x3d"iconClass:\'fa fa-cog fa-fw\',showLabel:true,\'class\':\'actionBarButton\',style:\'display:none;\'" data-dojo-attach-point\x3d"optionsDropDownDijit"\x3e\n                    \x3cspan\x3e\n                        ${i18n.optionsLabel}\n                    \x3c/span\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog"\x3e\n                        \x3cdiv style\x3d"width:260px;"\x3e\n                            \x3cdiv data-dojo-attach-point\x3d"zoomOptionsSelectDom"\x3e\n                                \x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"zoomOptionsSelect" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"\'class\':\'optionsCheckBox\',\'checked\':${zoomOptions.select}" data-dojo-attach-event\x3d"onChange:onZoomOptionsSelectChange"/\x3e\n                                \x3clabel\x3e${i18n.zoomOnSelect}\x3c/label\x3e\n                            \x3c/div\x3e\n                            \x3cdiv data-dojo-attach-point\x3d"zoomOptionsDeselectDom"\x3e\n                                \x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"zoomOptionsDeselect" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"\'class\':\'optionsCheckBox\',\'checked\':${zoomOptions.deselect}" data-dojo-attach-event\x3d"onChange:onZoomOptionsDeselectChange"/\x3e\n                                \x3clabel\x3e${i18n.zoomOnDeselect}\x3c/label\x3e\n                            \x3c/div\x3e\n                        \x3c/div\x3e\n                    \x3c/div\x3e\n                \x3c/div\x3e\n\n            \x3c/div\x3e\n\n\n    \t\x3c/div\x3e\n\t\x3c/div\x3e\n\n    \x3cdiv data-dojo-attach-point\x3d"findResultsNode" class\x3d"resultsContainer"\x3e\x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"findResultsGrid" class\x3d"resultsGrid"\x3e\x3c/div\x3e\n\x3c/div\x3e',
"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\n\t\x3e\x3cinput\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\n\t\tdata-dojo-attach-point\x3d"focusNode"\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\n/\x3e\x3c/div\x3e\n',"url:cmv/viewer/js/gis/dijit/Find/css/Find.css":{},"url:cmv/viewer/js/gis/dijit/Identify/templates/Identify.html":'\x3cdiv class\x3d"gis_IdentifyDijit"\x3e\n    \x3cdiv class\x3d"formContainer"\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"identifyFormDijit"\x3e\n            \x3clabel\x3e${i18n.labels.selectLayer}\x3c/label\x3e\x3cbr/\x3e\n            \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"name:\'identifyLayer\',autoComplete:true,required:true,searchAttr:\'name\',maxHeight:250,\'class\':\'identifySelect\'"\n                data-dojo-attach-point\x3d"identifyLayerDijit" /\x3e\n        \x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/Identify/css/Identify.css":{},"url:cmv/viewer/js/gis/dijit/Draw/templates/Draw.html":'\x3cdiv class\x3d"gis_DrawDijit"\x3e\n    \x3cdiv class\x3d"formContainer"\x3e\n        \x3cul class\x3d"list-unstyled outerList"\x3e\n            \x3cli\x3e\n                \x3cul class\x3d"list-inline list-unstyled"\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'adw-icon-point fa fa-fw\',showLabel:false"\n                                data-dojo-attach-event\x3d"onClick:drawPoint"\n                                class\x3d"drawButton"\n                                title\x3d"${i18n.labels.point}"\x3e\n                            ${i18n.labels.point}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'adw-icon-circle fa fa-fw\',showLabel:false,drawType:\'CIRCLE\'"\n                                data-dojo-attach-event\x3d"onClick:drawCircle"\n                                class\x3d"drawButton"\n                                title\x3d"${i18n.labels.circle}"\x3e\n                            ${i18n.labels.circle}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'adw-icon-polyline fa fa-fw\',showLabel:false"\n                                data-dojo-attach-event\x3d"onClick:drawLine"\n                                class\x3d"drawButton"\n                                title\x3d"${i18n.labels.polyline}"\x3e\n                            ${i18n.labels.polyline}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'adw-icon-freehand-polyline fa fa-fw\',showLabel:false"\n                                data-dojo-attach-event\x3d"onClick:drawFreehandLine"\n                                class\x3d"drawButton"\n                                title\x3d"${i18n.labels.freehandPolyline}"\x3e\n                            ${i18n.labels.freehandPolyline}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'adw-icon-polygon fa fa-fw\',showLabel:false"\n                                data-dojo-attach-event\x3d"onClick:drawPolygon"\n                                class\x3d"drawButton"\n                                title\x3d"${i18n.labels.polygon}"\x3e\n                            ${i18n.labels.polygon}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'adw-icon-freehand-polygon fa fa-fw\',showLabel:false"\n                                data-dojo-attach-event\x3d"onClick:drawFreehandPolygon"\n                                class\x3d"drawButton"\n                                title\x3d"${i18n.labels.freehandPolygon}"\x3e\n                            ${i18n.labels.freehandPolygon}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button"\n                             data-dojo-attach-point\x3d"stopDrawingButton"\n                             data-dojo-props\x3d"iconClass:\'fa fa-stop fa-fw\',showLabel:false,disabled:true"\n                             data-dojo-attach-event\x3d"onClick:stopDrawing"\n                             class\x3d"drawButton"\n                             title\x3d"${i18n.labels.stopDrawing}"\x3e\n                            ${i18n.labels.stopDrawing}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                    \x3cli\x3e\n                        \x3cbutton data-dojo-type\x3d"dijit/form/Button"\n                             data-dojo-attach-point\x3d"eraseDrawingButton"\n                             data-dojo-props\x3d"iconClass:\'fa fa-history fa-fw\',showLabel:false,disabled:true"\n                             data-dojo-attach-event\x3d"onClick:clearGraphics"\n                             class\x3d"drawButton"\n                             title\x3d"${i18n.labels.clearDrawing}"\x3e\n                            ${i18n.labels.clearDrawing}\n                        \x3c/button\x3e\n                    \x3c/li\x3e\n                \x3c/ul\x3e\n            \x3c/li\x3e\n            \x3cli\x3e\n                \x3cdiv class\x3d"drawModeIndicatorNode"\x3e\n                    \x3cspan style\x3d"font-weight: bold"\x3e${i18n.labels.currentDrawMode}\x3c/span\x3e\n                    \x3cspan data-dojo-attach-point\x3d"drawModeTextNode"\x3e${i18n.labels.currentDrawModeNone}\x3c/span\x3e\n                \x3c/div\x3e\n            \x3c/li\x3e\n\n        \x3c/ul\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/Draw/css/Draw.css":{},"url:cmv/viewer/js/gis/dijit/Draw/css/adw-icons.css":{},"url:esri/dijit/templates/Measurement.html":"\x3cdiv class\x3d\"esriMeasurement\"\x3e\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' class\x3d'esriMeasurementButtonContainer'\x3e\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'_areaButton' iconClass\x3d'areaIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:_areaButtonToggle'\x3e\x3c/div\x3e\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'_distanceButton' iconClass\x3d'distanceIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:_distanceButtonToggle'\x3e\x3c/div\x3e\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'_locationButton' iconClass\x3d'locationIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:_locationButtonToggle'\x3e\x3c/div\x3e\n    \x3cdiv class\x3d\"esriMeasurementSeparator\"\x3e|\x3c/div\x3e\n    \x3cbutton dojoType\x3d'dijit.form.DropDownButton' baseClass\x3d'esriToggleButton' dojoAttachPoint\x3d'_unitDropDown' label\x3d'unit' value\x3d'unit' style\x3d'visibility:hidden;'\x3e\x3c/button\x3e\n  \x3c/div\x3e\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultLabel' class\x3d'resultLabel esriMeasurementResultLabel'\x3e\x3c/div\x3e\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultValueContainer' align\x3d'leading' class\x3d\"esriMeasurementResultValue\"\x3e\n    \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultValue' class\x3d'result'\x3e\x26nbsp;\x3c/div\x3e\n  \x3c/div\x3e\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultTable' align\x3d'leading' class\x3d\"resultTable esriMeasurementTableContainer\" style\x3d\"display:none;\"\x3e\n    \x3ctable class\x3d\"esriMeasurementResultTable\"\x3e\n      \x3ctr\x3e\n        \x3ctd class\x3d\"esriMeasurementTableHeader\" colspan\x3d\"2\"\x3e${_NLS_Lat}\x3c/td\x3e\x3ctd class\x3d\"esriMeasurementTableHeader\"\x3e${_NLS_Lon}\x3c/td\x3e\n      \x3c/tr\x3e\n      \x3ctr class\x3d\"esriMeasurementTableRow\" dojoAttachPoint\x3d\"_mouseRow\"\x3e\n        \x3ctd dojoAttachPoint\x3d\"mouseCell\"\x3e\x3c/td\x3e\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\n          \x3cspan dojoAttachPoint\x3d\"mouseLatitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\n        \x3c/td\x3e\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\n          \x3cspan dojoAttachPoint\x3d\"mouseLongitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\n        \x3c/td\x3e\n      \x3c/tr\x3e\n      \x3ctr class\x3d\"esriMeasurementTableRow\"\x3e\n        \x3ctd dojoAttachPoint\x3d\"pinCell\"\x3e\x3c/td\x3e\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\n          \x3cspan dojoAttachPoint\x3d\"markerLatitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\n        \x3c/td\x3e\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\n          \x3cspan dojoAttachPoint\x3d\"markerLongitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\n        \x3c/td\x3e\n      \x3c/tr\x3e\n    \x3c/table\x3e\n  \x3c/div\x3e\n\x3c/div\x3e",
"url:cmv/viewer/js/gis/dijit/Print/templates/Print.html":'\x3cdiv class\x3d"gis_PrintDijit"\x3e\n    \x3cdiv class\x3d"formContainer"\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"printSettingsFormDijit"\x3e\n            \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\n                \x3ctr\x3e\n                    \x3ctd style\x3d"width:50px;"\x3e\n                        ${i18n.title}:\n                    \x3c/td\x3e\n                    \x3ctd\x3e\n                        \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'title\',trim:true,required:true,style:\'width:100%;\',value:\'${defaultTitle}\'" /\x3e\n                    \x3c/td\x3e\n                \x3c/tr\x3e\n                \x3ctr\x3e\n                    \x3ctd\x3e\n                        ${i18n.format}:\n                    \x3c/td\x3e\n                    \x3ctd\x3e\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"name:\'format\',autoComplete:true,required:true,searchAttr:\'name\',style:\'width:100%;\'" data-dojo-attach-point\x3d"formatDijit" /\x3e\n                    \x3c/td\x3e\n                \x3c/tr\x3e\n                \x3ctr\x3e\n                    \x3ctd\x3e\n                        ${i18n.layout}:\n                    \x3c/td\x3e\n                    \x3ctd\x3e\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"name:\'layout\',autoComplete:true,required:true,searchAttr:\'name\',style:\'width:100%;\'" data-dojo-attach-point\x3d"layoutDijit" /\x3e\n                    \x3c/td\x3e\n                \x3c/tr\x3e\n            \x3c/table\x3e\n        \x3c/div\x3e\n    \x3c/div\x3e\n    \x3cdiv class\x3d"buttonActionBar"\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton" data-dojo-props\x3d"iconClass:\'fa fa-cog fa-fw\',showLabel:true" data-dojo-attach-point\x3d"layoutDropDownDijit"\x3e\n            \x3cspan\x3e\n                ${i18n.settings}\n            \x3c/span\x3e\n            \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog"\x3e\n                \x3cdiv style\x3d"width:260px;"\x3e\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\n                        ${i18n.mapScaleExtent}:\n                    \x3c/div\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"preserveFormDijit"\x3e\n                        \x3ctable cellspacing\x3d"5"\x3e\n                            \x3ctr\x3e\n                                \x3ctd style\x3d"vertical-align:top;"\x3e\n                                    ${i18n.preserve}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',checked:true,value:\'true\'" /\x3e\n                                    ${i18n.mapScale}\x3cbr/\x3e\n                                    \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'false\'" /\x3e\n                                    ${i18n.mapExtent}\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${i18n.mapScale}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'outScale\',required:false,style:\'width:100px;\'" /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/table\x3e\n                    \x3c/div\x3e\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\n                        ${i18n.fullLayoutOptions}:\n                    \x3c/div\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutFormDijit"\x3e\n                        \x3ctable cellspacing\x3d"5"\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${i18n.scaleBarUnits}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cselect data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d"name:\'scalebarUnit\',style:\'width:100px;\'"\x3e\n                                        \x3coption value\x3d"Miles" selected\x3d"selected"\x3e\n                                            ${i18n.miles}\n                                        \x3c/option\x3e\n                                        \x3coption value\x3d"Kilometers"\x3e\n                                            ${i18n.kilometers}\n                                        \x3c/option\x3e\n                                        \x3coption value\x3d"Meters"\x3e\n                                            ${i18n.meters}\n                                        \x3c/option\x3e\n                                        \x3coption value\x3d"Feet"\x3e\n                                            ${i18n.feet}\n                                        \x3c/option\x3e\n                                    \x3c/select\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${i18n.includeLegend}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'legend\',value:true,checked:true" /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/table\x3e\n                    \x3c/div\x3e\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\n                        ${i18n.printQualityOptions}:\n                    \x3c/div\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapQualityFormDijit"\x3e\n                        \x3ctable cellspacing\x3d"5"\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${i18n.dpiInput.label}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'dpi\',required:true,value:150,constraints:{min:100,max:300,places:0},invalidMessage:\'${i18n.dpiInput.invalidMessage}\',rangeMessage:\'${i18n.dpiInput.rangeMessage}\',style:\'width:100px;\'" /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/table\x3e\n                    \x3c/div\x3e\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\n                        ${i18n.mapOnlyOptions}:\n                    \x3c/div\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapOnlyFormDijit"\x3e\n                        \x3ctable cellspacing\x3d"5"\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${i18n.width}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'width\',required:true,value:3300,style:\'width:100px;\'" /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${i18n.height}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'height\',required:true,value:2550,style:\'width:100px;\'" /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/table\x3e\n                    \x3c/div\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n        \x3c/div\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"busyLabel:\'${i18n.printButton.busyLabel}\',iconClass:\'fa fa-print fa-fw\'" data-dojo-attach-event\x3d"onClick:print" data-dojo-attach-point\x3d"printButtonDijit"\x3e\n            ${i18n.printButton.label}\n        \x3c/div\x3e\n    \x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"printResultsNode" class\x3d"resultsContainer"\x3e\n    \x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"clearActionBarNode" class\x3d"buttonActionBar" style\x3d"display:none;padding:0;"\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'fa fa-history fa-fw\'" data-dojo-attach-event\x3d"onClick:clearResults"\x3e\n            ${i18n.clearHistoryButton.label}\n        \x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/Print/templates/PrintResult.html":'\x3cdiv class\x3d"printResult" data-dojo-attach-point\x3d"resultNode" data-dojo-attach-event\x3d"onclick:_openPrint"\x3e\n    \x3ctable class\x3d"printResultTable"\x3e\n        \x3ctr\x3e\n            \x3ctd width\x3d"25px"\x3e\n                \x3cspan class\x3d"bold"\x3e${count}.\x3c/span\x3e\n            \x3c/td\x3e\n            \x3ctd width\x3d"30px"\x3e\n                \x3cimg src\x3d"${icon}"\x3e\n            \x3c/td\x3e\n            \x3ctd data-dojo-attach-point\x3d"nameNode"\x3e\n                \x3cdiv data-dojo-type\x3d"dijit/ProgressBar" data-dojo-props\x3d"value:Infinity,label:\'${i18n.printResults.progressBar.label}\'"\x3e\n                \x3c/div\x3e\n            \x3c/td\x3e\n        \x3c/tr\x3e\n    \x3c/table\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/Print/css/Print.css":{},"url:dijit/form/templates/Select.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\n\trole\x3d"listbox" aria-haspopup\x3d"true"\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t/\x3e\x3c/div\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\n\t\t/\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t\t${_buttonInputDisabled}\n\t\t/\x3e\x3c/td\n\t\x3e\x3c/tr\x3e\x3c/tbody\n\x3e\x3c/table\x3e\n',
"url:esri/dijit/templates/Directions.html":'\x3cdiv class\x3d"${options.theme}" role\x3d"presentation"\x3e\n    \x3cdiv data-dojo-attach-point\x3d"_widgetContainer" class\x3d"${_css.widgetContainerClass}" role\x3d"presentation"\x3e\n        \x3cdiv class\x3d"${_css.stopsContainerClass}" role\x3d"presentation"\x3e\n            \x3cdiv id\x3d"search-source-container" class\x3d"${_css.searchSourceContainerClass}" data-dojo-attach-point\x3d"_searchSourceContainerNode"\x3e\n                \x3cdiv data-dojo-attach-point\x3d"_searchSourceSelectorContainer"\x3e\x3c/div\x3e\n            \x3c/div\x3e\n            \x3cdiv class\x3d"${_css.stopsTableContainerClass}"\x3e\n                \x3ctable class\x3d"${_css.stopsClass}" data-dojo-attach-point\x3d"_dndNode"\x3e\x3c/table\x3e\n                \x3cdiv class\x3d"${_css.stopsTableCoverClass}" data-dojo-attach-point\x3d"_stopsTableCover"\x3e\x3c/div\x3e\n            \x3c/div\x3e\n            \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\n            \x3cdiv class\x3d"${_css.stopsButtonContainerClass}"\x3e\n                \x3cdiv class\x3d"${_css.stopsAddDestinationClass}"\x3e\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" data-dojo-attach-point\x3d"_activateButtonNode" title\x3d"${_i18n.widgets.directions.activate}" class\x3d"${_css.activateButtonClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass} ${_css.stopsPressedButtonClass}" data-blur-on-click\x3d"true"\x3e\x3c/div\x3e\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" data-dojo-attach-point\x3d"_lineBarrierButtonNode" title\x3d"${_i18n.widgets.directions.lineBarrier}" class\x3d"${_css.lineBarrierButtonClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass}" data-blur-on-click\x3d"true"\x3e\x3c/div\x3e\n                    \x3cdiv role\x3d"button" tabindex\x3d"0" class\x3d"${_css.linkButtonClass} ${_css.stopsAddDestinationBtnClass}" data-dojo-attach-point\x3d"_addDestinationNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.addDestination}\x3c/div\x3e\n                \x3c/div\x3e\n                \x3cdiv class\x3d"${_css.travelModesContainerClass}" data-dojo-attach-point\x3d"_travelModeContainerNode"\x3e\n                    \x3cdiv data-dojo-attach-point\x3d"_travelModeSelectorContainer"\x3e\x3c/div\x3e\n                \x3c/div\x3e\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.linkButtonClass} startTimeMenuButton" data-blur-on-click\x3d"true" data-dojo-attach-point\x3d"_startTimeButtonNodeContainer"\x3e\n                    \x3cdiv data-dojo-attach-point\x3d"_startTimeButtonNode"\x3e\n                        \x3cspan data-dojo-attach-point\x3d"_startTimeButtonLabel"\x3e${_i18n.widgets.directions.leaveNow}\x3c/span\x3e\n                        \x3cdiv data-dojo-attach-point\x3d"_startTimeDDLArrow" class\x3d"esriDirectionsDDLArrow"\x3e\x3c/div\x3e\n                    \x3c/div\x3e\n                    \x3cdiv class\x3d"startTimeMenu" data-dojo-attach-point\x3d"_startTimeMenu"\x3e\n                        \x3cul role\x3d"menu"\x3e\n                            \x3cli data-dojo-attach-point\x3d"_startTimeMenuLeaveNow" tabindex\x3d"0" class\x3d"esriRouteZoom startTimeMenuItem" role\x3d"menuitemradio" aria-checked\x3d"true"\x3e${_i18n.widgets.directions.leaveNow}\x3c/li\x3e\n                            \x3cli data-dojo-attach-point\x3d"_startTimeMenuDepartAt" tabindex\x3d"0" class\x3d"esriRouteZoom startTimeMenuItem" role\x3d"menuitemradio"\x3e${_i18n.widgets.directions.departAt}\x3c/li\x3e\n                        \x3c/ul\x3e\n                    \x3c/div\x3e\n                \x3c/div\x3e\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.linkButtonClass} ${_css.stopsOptionsButtonClass}" data-dojo-attach-point\x3d"_optionsButtonNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.showOptions}\x3c/div\x3e\n            \t\x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\n                \x3cdiv class\x3d"departAtContainer" data-dojo-attach-point\x3d"_departAtContainer"\x3e\n                    \x3cdiv id\x3d"${id}_directionsDepartAtTime" data-dojo-attach-point\x3d"_departAtTimeContainer"\x3e\x3c/div\x3e\n                    \x3cdiv id\x3d"${id}_directionsDepartAtDate" data-dojo-attach-point\x3d"_departAtDateContainer"\x3e\x3c/div\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n            \x3cdiv role\x3d"presentation" class\x3d"${_css.stopsOptionsMenuClass}" data-dojo-attach-point\x3d"_optionsMenuNode"\x3e\n                \x3cdiv class\x3d"${_css.stopsOptionsCheckboxesClass}"\x3e\n                    \x3cul\x3e\n                        \x3cli class\x3d"${_css.stopsFindOptimalOrderClass}" data-dojo-attach-point\x3d"_findOptimalOrderItemNode"\x3e\x3cinput tabindex\x3d"0" data-dojo-attach-point\x3d"_findOptimalOrderNode" type\x3d"checkbox" id\x3d"${id}_find_optimal_order" /\x3e\x3clabel for\x3d"${id}_find_optimal_order"\x3e${_i18n.widgets.directions.findOptimalOrder}\x3c/label\x3e\x3c/li\x3e\n                        \x3cli class\x3d"${_css.stopsReturnToStartClass}" data-dojo-attach-point\x3d"_returnToStartItemNode"\x3e\x3cinput tabindex\x3d"0" data-dojo-attach-point\x3d"_returnToStartNode" type\x3d"checkbox" id\x3d"${id}_stopsReturnToStart" /\x3e\x3clabel for\x3d"${id}_stopsReturnToStart"\x3e${_i18n.widgets.directions.returnToStart}\x3c/label\x3e\x3c/li\x3e\n                        \x3cli class\x3d"${_css.stopsUseTrafficClass}" data-dojo-attach-point\x3d"_useTrafficItemNode" title\x3d"${_i18n.widgets.directions.trafficLabelLive}"\x3e\n                            \x3cinput tabindex\x3d"0" data-dojo-attach-point\x3d"_useTrafficNode" type\x3d"checkbox" id\x3d"${id}_stopsUseTraffic" /\x3e\x3clabel for\x3d"${id}_stopsUseTraffic"\x3e${_i18n.widgets.directions.useTraffic}\x3c/label\x3e\n                            \x3ca data-dojo-attach-point\x3d"_trafficAvailabilityButton" style\x3d"display: none;" href\x3d"http://www.arcgis.com/home/item.html?id\x3db7a893e8e1e04311bd925ea25cb8d7c7" target\x3d"_blank"\x3e\x3cdiv class\x3d"esriTrafficAvailabilityButton" title\x3d"${_i18n.widgets.directions.seeTrafficAvailability}"\x3e\x3c/div\x3e\x3c/a\x3e\n                        \x3c/li\x3e\n                    \x3c/ul\x3e\n                \x3c/div\x3e\n                \x3cdiv class\x3d"${_css.stopsOptionsToggleContainerClass}"\x3e\n                    \x3cdiv class\x3d"${_css.stopsOptionsUnitsContainerClass}"  data-dojo-attach-point\x3d"_agolDistanceUnitsNode"\x3e\n                        \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsOptionsUnitsMiClass} ${_css.stopsButtonClass}" data-dojo-attach-point\x3d"_useMilesNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.units.esriMiles.abbr}\x3c/div\x3e\n                        \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsOptionsUnitsKmClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabLastClass} ${_css.stopsPressedButtonClass}" data-dojo-attach-point\x3d"_useKilometersNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.units.esriKilometers.abbr}\x3c/div\x3e\n                        \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\n                    \x3c/div\x3e\n                    \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\n                \x3c/div\x3e\n                \x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\n            \x3c/div\x3e\n            \x3cdiv class\x3d"${_css.stopsGetDirectionsContainerClass}"\x3e\n                \x3cdiv class\x3d"getDirectionsBtnContainer"\x3e\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsButtonClass} ${_css.stopsGetDirectionsClass} esriDisabledDirectionsButton" data-dojo-attach-point\x3d"_getDirectionsButtonNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.getDirections}\x3c/div\x3e\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.linkButtonClass} ${_css.stopsClearDirectionsClass}" data-dojo-attach-point\x3d"_clearDirectionsButtonNode" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.clearDirections}\x3c/div\x3e\n                \x3c/div\x3e\n                \x3cdiv class\x3d"savePrintBtnContainer" data-dojo-attach-point\x3d"_savePrintBtnContainer"\x3e\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.resultsSaveClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass}" data-blur-on-click\x3d"true" data-dojo-attach-point\x3d"_saveMenuButton" title\x3d"${_i18n.widgets.directions.saveTitle}" \x3e\x3c/div\x3e\n                    \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.resultsPrintClass} ${_css.stopsButtonClass} ${_css.stopsButtonTabClass}" data-blur-on-click\x3d"true" data-dojo-attach-point\x3d"_printButton" title\x3d"${_i18n.widgets.directions.print}" \x3e\x3c/div\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n            \x3cdiv role\x3d"presentation" class\x3d"${_css.stopsOptionsMenuClass} esriSaveContainer" data-dojo-attach-point\x3d"_saveMenuNode"\x3e\n                \x3cdiv class\x3d"esriLayerNameLabel"\x3e${_i18n.widgets.directions.layerName}\x3c/div\x3e\n                \x3cinput type\x3d"text" data-dojo-attach-point\x3d"_outputLayerContainer"\x3e\n                \x3cdiv data-dojo-attach-point\x3d"_folderSelectorContainer"\x3e\x3c/div\x3e\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"${_css.stopsButtonClass} esriSaveButton esriDisabledDirectionsButton" data-dojo-attach-point\x3d"_saveButton" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.save}\x3c/div\x3e\n                \x3cdiv tabindex\x3d"0" role\x3d"button" class\x3d"esriLinkButton esriSaveAsButton" data-dojo-attach-point\x3d"_saveAsButton" data-blur-on-click\x3d"true"\x3e${_i18n.widgets.directions.saveAs}\x3c/div\x3e\n            \x3c/div\x3e\n    \t\x3c/div\x3e\n    \t\x3cdiv class\x3d"${_css.clearClass}"\x3e\x3c/div\x3e\n    \t\x3cdiv data-dojo-attach-point\x3d"_msgNode" role\x3d"presentation"\x3e\x3c/div\x3e\n    \t\x3cdiv class\x3d"${_css.resultsContainerClass}" role\x3d"presentation"\x3e\n        \t\x3cdiv class\x3d"${_css.routesContainerClass}" data-dojo-attach-point\x3d"_resultsNode" role\x3d"presentation"\x3e\x3c/div\x3e\n    \t\x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e',
"url:esri/dijit/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\n        \x3c/div\x3e\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\n          \x3c/form\x3e\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\n          \x3c/div\x3e\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\n        \x3c/div\x3e\n      \x3c/div\x3e\n    \x3c/div\x3e\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\n    \x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\n  \x3c/div\x3e\n\x3c/div\x3e',
"url:cmv/viewer/js/gis/dijit/Directions/templates/Directions.html":'\x3cdiv\x3e\n\t\x3cdiv style\x3d"text-align:right;font-size:11px;"\x3e\n\t\t\x3ca href\x3d"#" data-dojo-attach-event\x3d"onclick:startAtMyLocation"\x3e${i18n.labels.startAtMyLocation}\x3c/a\x3e | \x3ca href\x3d"#" data-dojo-attach-event\x3d"onclick:endAtMyLocation"\x3e${i18n.labels.endAtMyLocation}\x3c/a\x3e | \x3ca href\x3d"#" data-dojo-attach-event\x3d"onclick:clearStops"\x3e${i18n.labels.clearStops}\x3c/a\x3e\n\t\x3c/div\x3e\n\t\x3cdiv data-dojo-attach-point\x3d"directionsNode"\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e',
"url:cmv/viewer/js/gis/dijit/Editor/templates/Editor.html":'\x3cdiv\x3e\n    \x3cdiv style\x3d"text-align:center;"\x3e\n\n        \x3cbutton data-dojo-type\x3d"dijit/form/Button"\n                data-dojo-attach-event\x3d"onClick:toggleEditing" \n                data-dojo-props\x3d"label:\'${i18n.labels.startEditing}\',\'class\':\'success\'"\n                data-dojo-attach-point\x3d"toggleBTN"\x3e\x3c/button\x3e\n\n    \x3c/div\x3e\n    \n    \x3cdiv class\x3d"editDijit" \n         style\x3d"margin-top:5px;" \n         data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\n\n\x3c/div\x3e',
"url:cmv/viewer/js/gis/dijit/StreetView/templates/StreetView.html":'\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"gis_StreetView"\x3e\n    \x3cdiv data-dojo-attach-point\x3d"panoNode" class\x3d"streetViewPano"\x3e\n        \x3cbutton data-dojo-type\x3d"dijit/form/ToggleButton" class\x3d"streetViewButton" data-dojo-attach-point\x3d"streetViewButtonDijit" data-dojo-props\x3d"iconClass:\'fa fa-street-view fa-fw\',showLabel:false" data-dojo-attach-event\x3d"onClick:placePoint"\x3e\x3c/button\x3e\n        \x3cspan data-dojo-attach-point\x3d"streetViewInstructions" class\x3d"streetViewInstructions"\x3e\n            \x3cdiv class\x3d"streetViewInstructionsText"\x3e\n                ${i18n.messages.instructions}\n            \x3c/div\x3e\n        \x3c/span\x3e\n    \t\x3cspan data-dojo-attach-point\x3d"noStreetViewResults" class\x3d"noStreetViewResults"\x3e\n            \x3cdiv class\x3d"noStreetViewResultsText"\x3e\n                ${i18n.messages.notAvailable}\n            \x3c/div\x3e\n        \x3c/span\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:cmv/viewer/js/gis/dijit/StreetView/css/StreetView.css":{},"url:esri/dijit/templates/LocateButton.html":'\x3cdiv class\x3d"${theme}" role\x3d"presentation"\x3e\n    \x3cdiv class\x3d"${_css.container}"\x3e\n            \x3cdiv data-dojo-attach-point\x3d"_locateNode" role\x3d"button" class\x3d"${_css.locate}" tabindex\x3d"0"\x3e\x3cspan\x3e${_i18n.widgets.locateButton.locate.button}\x3c/span\x3e\x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',"url:cmv/viewer/js/gis/dijit/Locale/templates/Locale.html":'\x3cdiv class\x3d"cmvLocaleDijit"\x3e\n    \x3cdiv data-dojo-attach-point\x3d"localeLabelContainer" style\x3d"display:none;"\x3e\n        \x3clabel\x3e${i18n.selectLocale}\x3c/label\x3e\n    \x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"localeDropDownContainer"\x3e\x3c/div\x3e\n\x3c/div\x3e',
"url:flag-icon-css/css/flag-icon.min.css":{},"url:cmv/viewer/js/gis/dijit/Locale/css/Locale.css":{},"url:esri/layers/vectorTiles/views/vectorTiles/renderers/Shaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\x3c!--\n  Add your GLSL snippets to this file. You should start from\n  importing your old GLSL files. For instance, if you have a\n  file such as myShader.vs.glsl you should create a new \x3csnippet name\x3d"myShaderVS"\x3e\n  and then copy and paste the GLSL source as the content. You will then convert your\n  code to use the {@link module:esri/views/vectorTiles/renderers/vtShaderSnippets vtShaderSnippets}\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\n--\x3e\n\x3csnippets\x3e\n\n  \x3csnippet name\x3d"foobarVS"\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"foobarFS"\x3e\n  \x3c/snippet\x3e\n\n\x3c/snippets\x3e\n\n',
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/background.vs.glsl":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform mediump vec2 u_normalized_origin;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n\nvoid main() {\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\n}\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/background.fs.glsl":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineShader.vs.glsl":"/* The implementation of the renderer is based on the article and implementation of MB described here:\n* https://www.mapbox.com/blog/drawing-antialiased-lines/\n*/\n\nattribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute float a_accumulatedDistance;\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n// the z of the layer. Given by the order of the layers in the style\nuniform mediump float u_depth;\n// the inset and outset of the line\nuniform mediump float u_lineHalfWidth;\n// the interpolated normal to the line. the information is packed into the two LSBs of the vertex coordinate\nvarying mediump vec2 v_normal;\n// the accumulated distance along the line. We need this information in order to render the dashes.\nvarying highp float v_accumulatedDistance;\n\nconst float scale \x3d 1.0 / 31.0;\n\nvoid main()\n{\n  v_normal \x3d a_offsetAndNormal.zw;\n\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\n  mediump vec2 dist \x3d u_lineHalfWidth * a_offsetAndNormal.xy * scale;\n\n  // transform the vertex\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\n\n  // the accumulated distance will be used to calculate the dashes (or the no-data...)\n  v_accumulatedDistance \x3d a_accumulatedDistance;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineShader.fs.glsl":"/* The implementation of the renderer is based on the article and implementation of MB described here:\n* https://www.mapbox.com/blog/drawing-antialiased-lines/\n*/\n\nuniform mediump float u_lineHalfWidth;\nuniform lowp vec4 u_color;\nuniform mediump vec2 u_dasharray;\nuniform lowp float u_blur;\n\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\n\nvoid main()\n{\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\n  mediump float fragDist \x3d length(v_normal) * u_lineHalfWidth;\n\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\n  // We need to count for both sides of the line.\n  lowp float alpha \x3d clamp( min(fragDist + u_blur + 1.0, u_lineHalfWidth - fragDist) / u_blur, 0.0, 1.0);\n\n  // now calculate the dashes given the accumulated distance of the line:\n  // start with calculating a normalized position along the line\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, u_dasharray.x + u_dasharray.y);\n\n  // calculate the contribution to the alpha of the dash part. It is provided by the shortest portion of the position along the dash.\n  // we must clamp since the value might be bigger than 1 or smaller than zero (when over a dash).\n  //   | \x3c--- pos along the dash part\n  // -------_______-------_______\n  // when the dashPos is over the 'gap' part of the dash u_dasharray.x - dashPos is negative and therefore the alpha will\n  // get clamped to zero.\n  // when u_dasharray.x - dashPos is positive, or when dashPos is smaller than 1.0, it gives us a soft edge to each dash part.\n  // along the direction of the line.\n  lowp float dashAlpha \x3d clamp( min(dashPos, u_dasharray.x - dashPos), 0.0, 1.0);\n\n  // if we don't have a no-data part to the dash then it is a solid line\n  dashAlpha \x3d max(sign(-u_dasharray.y), dashAlpha); //sign(-u_dasharray.y) \x3e 0.0 ? 1.0 : dashAlpha;\n  // finally multiply the fragment's alpha by the calculated dash-alpha\n  alpha *\x3d dashAlpha;\n\n  // output the fragment color\n gl_FragColor \x3d alpha * u_color;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/patternLineShader.vs.glsl":"attribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute float a_accumulatedDistance;\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n// the z of the layer. Given by the order of the layers in the style\nuniform mediump float u_depth;\n// the inset and outset of the line\nuniform mediump float u_lineHalfWidth;\n// the interpolated normal to the line. the information is packed into the two LSBs of the vertex coordinate\nvarying mediump vec2 v_normal;\n// the accumulated distance along the line. We need this information in order to render the dashes.\nvarying highp float v_accumulatedDistance;\n\nconst float scale \x3d 1.0 / 31.0;\n\nvoid main()\n{\n  v_normal \x3d a_offsetAndNormal.zw;\n\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\n  mediump vec2 dist \x3d u_lineHalfWidth * a_offsetAndNormal.xy * scale;\n\n  // transform the vertex\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\n\n  // the accumulated distance will be used to calculate the dashes (or the no-data...)\n  v_accumulatedDistance \x3d a_accumulatedDistance;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/patternLineShader.fs.glsl":"uniform mediump float u_lineHalfWidth;\nuniform lowp float u_blur;\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\n\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\n\nvoid main()\n{\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\n  mediump float fragDist \x3d length(v_normal) * u_lineHalfWidth;\n\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\n  // We need to count for both sides of the line.\n  lowp float alpha \x3d clamp( min(fragDist + u_blur + 1.0, u_lineHalfWidth - fragDist) / u_blur, 0.0, 1.0);\n  // add the line's opacity to the alpha\n  alpha *\x3d u_opacity;\n\n  // we need to calculate the relative portion of the line texture along the line given the accumulated distance aliong the line\n  // The computed value should is anumber btween 0 and 1 which will later be used to interpolate btween the BR and TL values\n  mediump float relativeTexX \x3d mod(v_accumulatedDistance / u_spriteSize.x, 1.0);\n\n  // in order to calculate the texture coordinates prependicular to the line (Y axis), we use the interpolated normal values\n  // which range from -1.0 to 1.0. On the line's centerline, the value of the interpolated normal is 0.0, however the relative\n  // texture value shpould be 0.5 (given that at the bottom of the line, the texture coordinate must be equal to 0.0)\n  // (TL) ---------------------------      --\x3e left edge of line. Interpolatedf normal is 1.0\n  //              | -\x3e linwe-width / 2\n  //      - - - - - - - - - - - - - -\n  //              | -\x3e linwe-width / 2\n  //      ---------------------------- (BR)--\x3e right edge of line. Interpolatedf normal is -1.0\n\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * u_lineHalfWidth / (0.5 * u_spriteSize.y));\n\n  // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n\n  // get the color from the texture\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n\n  // 'un-premultiply' the color\n  lowp float inv_alpha \x3d (1.0 / clamp(color.a, 0.00390625, 1.0));\n  // finally write the fragment value\n  gl_FragColor \x3d alpha * color;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineJoinShader.vs.glsl":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform highp vec2 u_normalized_origin;\nuniform highp float u_depth;\nuniform highp vec2 u_screen;\nuniform mediump float u_size;\nuniform mediump float u_pixelRatio;\n\nvarying mediump vec2 v_vertexPosition;\n\nvoid main()\n{\n  gl_PointSize \x3d u_pixelRatio * u_size;\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\n\n  // calculate the vertex position in pixels (we need to add one in order to shift the origin from the center of the viewport)\n  v_vertexPosition \x3d (gl_Position.xy + 1.0) * u_screen;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineJoinShader.fs.glsl":"uniform lowp vec4 u_color;\nuniform mediump float u_lineHalfWidth;\nuniform mediump float u_oneOverPixelRatio;\n\nvarying mediump vec2 v_vertexPosition;\n\nvoid main()\n{\n  // get the distance of the current fragment from the actual vertex\n  mediump float fragDist \x3d length(v_vertexPosition - u_oneOverPixelRatio * gl_FragCoord.xy);\n\n  // rounding the quare: calculate the alpha given the difference between the line-width and the distance of the fragment\n  // from the center-line. We will end up with a nice round circle with a soft edge.\n  lowp float alpha \x3d clamp(u_lineHalfWidth - fragDist, 0.0, 1.0);\n\n  // finally output the fragment color\n  gl_FragColor \x3d alpha * u_color;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineJoinQuadShader.vs.glsl":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\n\nuniform highp mat4 u_transformMatrix;\nuniform highp mat4 u_extrudeMatrix;\nuniform highp vec2 u_normalized_origin;\nuniform highp float u_depth;\n// The width/height of the screen\nuniform mediump vec2 u_screen;\n// u_size is the diameter of the join in tile units\nuniform mediump float u_size;\n\nvarying mediump vec2 v_fragmentOffset;\n\nvoid main()\n{\n  // calculate the offset in pixels from the join's center to the vertex\n  highp vec2 dist \x3d u_size * a_vertexOffset;\n\n  // calculate the position of the join's center in normalized coordinates\n  highp vec4 center_pos \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\n\n  // offset in normalized display units\n  highp vec4 vertex_offset \x3d u_extrudeMatrix * vec4(dist, 0.0, 0.0);\n\n  // calculate the vertex offset in windows coordinates\n  v_fragmentOffset \x3d u_screen * vertex_offset.xy;\n\n  // finally calculate the vertex position\n  gl_Position \x3d center_pos + vertex_offset;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineJoinQuadShader.fs.glsl":"uniform lowp vec4 u_color;\nuniform mediump float u_lineHalfWidth;\n\nvarying mediump vec2 v_fragmentOffset;\n\nvoid main()\n{\n  // Calculate the antialiasing fade factor\n  lowp float alpha \x3d clamp(u_lineHalfWidth * u_lineHalfWidth - dot(v_fragmentOffset, v_fragmentOffset), 0.0, 1.0);\n  //lowp float alpha  \x3d 1.0 - smoothstep(u_lineHalfWidth - 0.25, u_lineHalfWidth + 0.25, dist);\n  // YF: if needed w can also use a smoothstep around the edge of the circle and use a single pixel or so as the edge width\n\n  // finally output the fragment color\n  gl_FragColor \x3d alpha * u_color;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/solidFillShader.vs.glsl":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform highp vec2 u_normalized_origin;\nuniform mediump float u_depth;\n\nvoid main()\n{\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0, 1.0);\n}\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/solidFillShader.fs.glsl":"uniform lowp vec4 u_color;\nvoid main()\n{\n  gl_FragColor \x3d u_color;\n}",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/patternFillShader.vs.glsl":"uniform highp mat4 u_transformMatrix;\nuniform highp vec2 u_normalized_origin;\nuniform mediump float u_depth;\nuniform mediump mat3 u_pattern_matrix; // can we use meduim precision??\n\nattribute vec2 a_pos;\n\nvarying mediump vec2 v_tileTextureCoord;\n\nvoid main()\n{\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\n  // calculate the texture coordinates of the current vertex. It will of course get interpolated.\n  // The pattern matrix is a 3x3 scale matrix which 'tiles' the texture inside the tile, translating from tile coordinates\n  // (-4k to 8k -1) to texture coordinates.\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/patternFillShader.fs.glsl":"uniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\n\nvarying mediump vec2 v_tileTextureCoord;\n\nvoid main()\n{\n  // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\n  // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\n  // we need to only sample from area that has our sprite in the mosaic.\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  // sample the sprite mosaic\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/fillOutlineShader.vs.glsl":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n\nuniform highp mat4 u_transformMatrix;\nuniform highp mat4 u_extrudeMatrix;\nuniform highp vec2 u_normalized_origin;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\n\nvarying lowp vec2 v_normal;\n\nconst float scale \x3d 1.0 / 15.0;\n\nvoid main()\n{\n  v_normal \x3d a_xnormal;\n\n   // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\n    // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\n  mediump vec4 dist \x3d vec4(u_outline_width * a_offset * scale, 0.0, 0.0);\n\n  // Remove the texture normal bit of the position before scaling it with the\n  // model/view matrix. Add the extrusion vector *after* the model/view matrix\n  // because we're extruding the line in pixel space, regardless of the current\n  // tile's zoom level.\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * dist;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/fillOutlineShader.fs.glsl":"uniform lowp vec4 u_color;\nvarying mediump vec2 v_normal;\n\nvoid main()\n{\n  // Calculate the distance of the pixel from the line in pixels.\n  lowp float dist \x3d abs(v_normal.y);\n\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * u_color;\n}\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/iconShader.vs.glsl":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n// the size of the mosaic given in pixels\nuniform vec2 u_mosaicSize;\n// the z of the layer. Given by the order of the layers in the style\nuniform mediump float u_depth;\n// the map's rotation from the north\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\n// indicate whether the current set of iconst should be kept upright when the map is rotated\nuniform lowp float u_keepUpright;\n// the rate of the change in the opacity (fade) of the icons\nuniform mediump float u_fadeSpeed;\n// the low level we transition (to/from)\nuniform mediump float u_minfadeLevel;\n// the high level we transition (to/from)\nuniform mediump float u_maxfadeLevel;\n// the amount of fade given teh current time past the last recorded level\nuniform mediump float u_fadeChange;\n// the opacity of the layer given by the painter\nuniform mediump float u_opacity;\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\nvarying lowp vec2 v_tex;\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n// opacity of the layer given by the painter\nvarying lowp float v_transparency;\n\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\n// by 16 and then at the shader devide by the same number\nconst float offsetPrecision \x3d 1.0 / 32.0;\n\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle        \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\n  mediump float delta_z \x3d 0.0;\n\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\n  mediump float rotated \x3d mod(a_angle - u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright,0.0)) * step(65.0,rotated) * (1.0 - step(193.0,rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (65 \x3c\x3d rotated) \x26\x26 (rotated \x3c 193)\n\n  // u_level is the current service level adjusted for the change in font size\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\n  delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\n\n  // calculate the alpha given the change in the fade and the fade-speed\n  lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\n\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n      v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n      v_transparency \x3d 1.0;\n  }\n\n  // if label had been faded out, clip it\n  delta_z +\x3d step(v_transparency, 0.0);\n\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n\n  v_transparency *\x3d u_opacity;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/iconShader.fs.glsl":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\n\nvoid main()\n{\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_transparency * color;\n}\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/sdfShader.vs.glsl":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n\n// attribute bool a_visible; // --\x3e a one bit controlling the visibility of the vertex\n\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\n// relative to the tile's upper left corner\n// the extrusion vector.\nuniform highp mat4 u_transformMatrix;\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\nuniform highp mat4 u_extrudeMatrix;\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\nuniform highp vec2 u_normalized_origin;\n// the size of the mosaic given in pixels\nuniform vec2 u_mosaicSize;\n// the z of the layer. Given by the order of the layers in the style\nuniform mediump float u_depth;\n// the map's rotation from the north\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\n// indicate whether the current set of iconst should be kept upright when the map is rotated\nuniform lowp float u_keepUpright;\n// the rate of the change in the opacity (fade) of the icons\nuniform mediump float u_fadeSpeed;\n// the low level we transition (to/from)\nuniform mediump float u_minfadeLevel;\n// the high level we transition (to/from)\nuniform mediump float u_maxfadeLevel;\n// the amount of fade given teh current time past the last recorded level\nuniform mediump float u_fadeChange;\n// the opacity of the layer given by the painter\nuniform mediump float u_opacity;\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\nvarying lowp vec2 v_tex;\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\n// opacity of the layer given by the painter\nvarying lowp float v_transparency;\n\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\n// by 16 and then at the shader devide by the same number\nconst float offsetPrecision \x3d 1.0 / 32.0;\n\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle        \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\n  mediump float delta_z \x3d 0.0;\n\n  // TODO: force clipping the vertex in case that the vertex isn't visible\n  //delta_z +\x3d a_visible ? 0.0 : 1.0;\n\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\n  mediump float rotated \x3d mod(a_angle - u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(65.0, rotated) * (1.0 - step(193.0, rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (65 \x3c\x3d rotated) \x26\x26 (rotated \x3c 193)\n\n  // u_level is the current service level adjusted for the change in font size\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\n  delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\n\n  // calculate the alpha given the change in the fade and the fade-speed\n  lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\n\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n      v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n      v_transparency \x3d 1.0;\n  }\n\n  // if label has been faded out, clip it\n  delta_z +\x3d step(v_transparency, 0.0);\n\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n\n  v_transparency *\x3d u_opacity;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/sdfShader.fs.glsl":"uniform lowp sampler2D u_texture;\nuniform lowp vec4 u_color;\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeWidth;\n\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\n\n// this is taken from http://www.valvesoftware.com/publications/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\n// and https://www.mapbox.com/blog/text-signed-distance-fields/\n// http://metalbyexample.com/rendering-text-in-metal-with-signed-distance-fields/\n\nvoid main()\n{\n  // read the distance from the SDF texture\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  // use a smooth-step in order to calculate the geometry of the shape given by the distance field\n  mediump float alpha \x3d smoothstep(u_edgeDistance - u_edgeWidth, u_edgeDistance + u_edgeWidth, dist) * v_transparency;\n\n  gl_FragColor \x3d alpha * u_color;\n\n// YF: this code allow having both a fill and an outline colors combined in a single pass\n//  lowp float geometryAlpha \x3d smoothstep(0.75 - 0.21, 0.75 + 0.21, dist) * v_transparency;\n//  lowp vec4 geometryColor \x3d vec4(u_color.rgb, geometryAlpha * u_color.a);\n//\n//  if (true) {\n//    lowp float haloAlpha \x3d smoothstep(0.0 - 0.1, 0.0 + 0.1, dist) * v_transparency;\n//    lowp vec4 haloColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n//    haloColor \x3d vec4(haloColor.rgb, haloAlpha);\n//\n//    // calculate the composite color\n//    lowp float compositeAlpha \x3d geometryColor.a + haloColor.a * (1.0 - geometryColor.a);\n//    lowp vec3 compositeColor \x3d vec3(geometryColor) * geometryColor.a + vec3(haloColor) * haloColor.a * (1.0 - geometryColor.a);\n//    compositeColor /\x3d compositeAlpha;\n//    gl_FragColor \x3d vec4(compositeColor, compositeAlpha);\n//  }\n//  else {\n//    gl_FragColor \x3d geometryColor;\n//  }\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/tileInfo.vs.glsl":"attribute vec2 a_pos;\n\nuniform highp mat4 u_transformMatrix;\nuniform mediump vec2 u_normalized_origin;\nuniform mediump float u_depth;\nuniform mediump float u_coord_ratio;\nuniform mediump vec2 u_delta; // in tile coordinates\nuniform mediump vec2 u_dimensions; // in tile coordinates\n\nvarying mediump vec2 v_tex;\n\nvoid main() {\n  mediump vec2 offests \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\n\n  v_tex \x3d a_pos;\n}\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/tileInfo.fs.glsl":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\n\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}\n","url:esri/layers/vectorTiles/views/2d/engine/webgl/Shaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n\x3c!--\n  Add your GLSL snippets to this file. You should start from\n  importing your old GLSL files. For instance, if you have a\n  file such as myShader.vs.glsl you should create a new \x3csnippet name\x3d"myShaderVS"\x3e\n  and then copy and paste the GLSL source as the content. You will then convert your\n  code to use the {@link esri/views/2d/engine/webgl/glShaderSnippets glShaderSnippets}\n  instance to access the GLSL code, instead of importing it directly with require("dojo/text!...").\n--\x3e\n\x3csnippets\x3e\n\n  \x3csnippet name\x3d"foobarVS"\x3e\n  \x3c/snippet\x3e\n\n  \x3csnippet name\x3d"foobarFS"\x3e\n  \x3c/snippet\x3e\n\n\x3c/snippets\x3e\n\n',
"url:esri/layers/vectorTiles/views/2d/engine/webgl/bitblit.vs.glsl":"attribute vec2 a_pos;\nattribute vec2 a_tex;\n\nvarying mediump vec2 v_uv;\n\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}\n","url:esri/layers/vectorTiles/views/2d/engine/webgl/bitblit.fs.glsl":"\tuniform lowp sampler2D u_tex;\n\tuniform lowp float u_opacity;\n\n\tvarying mediump vec2 v_uv;\n\n\tvoid main() {\n\t\tlowp vec4 color \x3d texture2D(u_tex, v_uv);\n\n    // Note: output in pre-multiplied alpha for correct alpha compositing\n\t\tgl_FragColor \x3d color *  u_opacity;\n\t}\n",
"url:esri/layers/vectorTiles/views/2d/engine/webgl/stencil.vs.glsl":"attribute vec2 a_pos;\n\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}\n","url:esri/layers/vectorTiles/views/2d/engine/webgl/stencil.fs.glsl":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}\n","url:dgrid/css/TouchScroll.css":{},"*now":function(h){h(['dojo/i18n!*preload*dojo/nls/dojo*["ar","ca","cs","da","de","el","en-gb","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ru","sk","sl","sv","th","tr","zh-tw","zh-cn"]'])},
"*noref":1}});(function(){var h=this.require;h({cache:{}});!h.async&&h(["dojo"]);h.boot&&h.apply(null,h.boot)})();